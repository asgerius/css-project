[{"tags": ["c", "pthreads", "malloc", "glibc", "ld-preload"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1547682503, "post_id": 54227001, "comment_id": 95280192, "body": "That depends on whether the functions invoked by the <code>malloc</code> hooks are thread-safe, doesn&#39;t it?  The core code in <code>malloc()</code> has to be thread-safe; it can&#39;t control whether the code called for the hooks are thread-safe, but the code so written should be."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1547682542, "post_id": 54227001, "comment_id": 95280201, "body": "Are you wrapping <code>malloc</code> using LD_PRELOAD tricks, as per tags and question text, or are you using the <code>__malloc_hook</code> stuff from glibc?"}, {"owner": {"reputation": 11, "user_id": 10925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/621dce9eaf9c2a98f84762473843c5b2?s=128&d=identicon&r=PG&f=1", "display_name": "gg123", "link": "https://stackoverflow.com/users/10925122/gg123"}, "edited": false, "score": 0, "creation_date": 1547683040, "post_id": 54227001, "comment_id": 95280310, "body": "I am using __malloc_hook fomr glibc"}], "answers": [{"comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1547710485, "post_id": 54227421, "comment_id": 95286866, "body": "And the problem is that if you want to <i>wrap</i> the existing malloc, you cannot do so because once you disable the hooks, other threads will no longer call into your wrapper."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 3, "last_activity_date": 1547686608, "last_edit_date": 1547686608, "creation_date": 1547685242, "answer_id": 54227421, "question_id": 54227001, "link": "https://stackoverflow.com/questions/54227001/why-are-malloc-hooks-unsafe-with-pthreads/54227421#54227421", "title": "Why are malloc hooks unsafe with pthreads?", "body": "<p><code>__malloc_hook</code> is called right after entering <code>__libc_malloc</code> in <a href=\"https://github.com/lattera/glibc/blob/master/malloc/malloc.c#L3011\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>void *\n__libc_malloc (size_t bytes)\n{\n  mstate ar_ptr;\n  void *victim;\n\n  void *(*hook) (size_t, const void *)\n    = atomic_forced_read (__malloc_hook);\n  if (__builtin_expect (hook != NULL, 0))\n    return (*hook)(bytes, RETURN_ADDRESS (0));\n</code></pre>\n\n<p>while the thread locking is implemented in <code>__libc_malloc</code> 20 lines below, in <a href=\"https://github.com/lattera/glibc/blob/master/malloc/malloc.c#L3039\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>  if (SINGLE_THREAD_P)\n    {\n      victim = _int_malloc (&amp;main_arena, bytes);\n      assert (!victim || chunk_is_mmapped (mem2chunk (victim)) ||\n          &amp;main_arena == arena_for_chunk (mem2chunk (victim)));\n      return victim;\n    }\n\n  arena_get (ar_ptr, bytes);\n</code></pre>\n\n<p><code>arena_get</code> is constructing the arena for the thread or choosing the arena and locking the arena, declared <a href=\"https://github.com/lattera/glibc/blob/master/malloc/arena.c#L105\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>So when designing your own <code>__malloc_hook</code> the developer is responsible for everything, including threads locking (if needed).</p>\n"}, {"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 3, "last_activity_date": 1547688876, "creation_date": 1547688876, "answer_id": 54227795, "question_id": 54227001, "link": "https://stackoverflow.com/questions/54227001/why-are-malloc-hooks-unsafe-with-pthreads/54227795#54227795", "title": "Why are malloc hooks unsafe with pthreads?", "body": "<p>You shouldn't use them anyways; they're deprecated.  See the \"Notes\" section of any recent copy of <a href=\"https://linux.die.net/man/3/__malloc_hook\" rel=\"nofollow noreferrer\"><code>the malloc_hook(3) man page</code></a>:</p>\n\n<blockquote>\n  <p>The use of these hook functions is not safe in multithreaded programs, and they are now deprecated. Programmers should instead preempt calls to the relevant functions by defining and exporting functions such as \"malloc\" and \"free\". </p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 10925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/621dce9eaf9c2a98f84762473843c5b2?s=128&d=identicon&r=PG&f=1", "display_name": "gg123", "link": "https://stackoverflow.com/users/10925122/gg123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547688876, "creation_date": 1547681848, "last_edit_date": 1547682417, "question_id": 54227001, "link": "https://stackoverflow.com/questions/54227001/why-are-malloc-hooks-unsafe-with-pthreads", "title": "Why are malloc hooks unsafe with pthreads?", "body": "<p>I am trying to build a wrapper for <code>malloc</code> and wondering whether <code>malloc</code> hooks would be thread-safe under pthreads.</p>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 5, "creation_date": 1547679969, "post_id": 54226619, "comment_id": 95279487, "body": "Use <code>offsetof</code> rather than arithmetic on phony &quot;members of structs at the null pointer&quot; anyway.  For this, you just need more than one <code>offsetof</code> computed.  (Yes, sometimes <code>offsetof</code> is implemented like that, but only if and because the compiler team knows it will work for that compiler.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1547687018, "post_id": 54226619, "comment_id": 95281077, "body": "The line should be <code>offset = offsetof(struct a, y.j);</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1547687076, "post_id": 54226619, "comment_id": 95281084, "body": "@xing technically UB but would probably work"}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 2, "last_activity_date": 1547679718, "creation_date": 1547679718, "answer_id": 54226687, "question_id": 54226619, "link": "https://stackoverflow.com/questions/54226619/lvalue-required-as-unary-operand-while-finding-offset-of-a-structure-variabl/54226687#54226687", "title": "lvalue required as unary &#39;&amp;&#39; operand while finding offset of a structure variable inside an another structure", "body": "<p><code>&amp;</code> can only be used on variables (including array elements or struct members) - more formally called <em>lvalues</em>. Essentially, you can use it on anything that could be on the left side of an <code>=</code> (this is how lvalues got their name). You can't do, for example, <code>&amp;(1 + 1)</code>. You also can't do <code>&amp;(&amp;some_variable)</code> for the same reason: <code>&amp;some_variable</code> is not an lvalue.</p>\n\n<p>It's easy to see these are not lvalues, as you couldn't do <code>1 + 1 = something;</code> or <code>&amp;some_variable = something;</code>.</p>\n\n<p>You have <code>&amp;((struct c*)(&amp;((struct a*)0)-&gt;y)-&gt;j)</code>. Or simplified, <code>&amp;(&amp;(something))</code>. This is not valid. I don't know what the function is trying to do, but perhaps you've used two <code>&amp;</code>s instead of one by a simple mistake.</p>\n"}], "owner": {"reputation": 351, "user_id": 7698766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F289S.jpg?s=128&g=1", "display_name": "Shubham Yadav", "link": "https://stackoverflow.com/users/7698766/shubham-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547679718, "creation_date": 1547679297, "question_id": 54226619, "link": "https://stackoverflow.com/questions/54226619/lvalue-required-as-unary-operand-while-finding-offset-of-a-structure-variabl", "title": "lvalue required as unary &#39;&amp;&#39; operand while finding offset of a structure variable inside an another structure", "body": "<p>I am trying to access elements i, f and ch of the following structure.</p>\n\n<pre><code>struct a{\n    struct b{\n        int i;\n        float f;\n        char ch;\n    }x;\n\n    struct c{\n        int j;\n        float g;\n        char ch;\n    }y;\n};\n</code></pre>\n\n<p>This has to be done by passing the address of structure c to a function and calculating its offset to access structure b</p>\n\n<pre><code>struct a z;\nfun(&amp;z.y);\n</code></pre>\n\n<p>The function is as follows:</p>\n\n<pre><code>fun(struct c *p){\n\n    int offset;\n    struct b *address;\n    offset = (char *) &amp;((struct c*)(&amp;((struct a*)0)-&gt;y)-&gt;j) - (char *)((struct a*)0);\n    address = (struct b*)((char *)&amp;(p-&gt;j)-offset);\n    address-&gt;i = 400;\n    address-&gt;f = 3.14;\n    address-&gt;ch = 'c';\n\n}\n</code></pre>\n\n<p>Despite trying a lot, it always gives an error of <code>lvalue required as unary '&amp;' operand</code></p>\n\n<p>I know the meaning of the error, but isn't able to get it done here. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 3, "creation_date": 1547678771, "post_id": 54226519, "comment_id": 95279068, "body": "Can you print r as well?  Perhaps it is not getting set properly."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1547678831, "post_id": 54226519, "comment_id": 95279086, "body": "0 area or 0 circumference? Or 0 both?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 5, "creation_date": 1547678877, "post_id": 54226519, "comment_id": 95279104, "body": "Why are you using <code>scanf(&quot;%.2f&quot;,&amp;r);</code> instead of <code>scanf(&quot;%f&quot;,&amp;r);</code>?"}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 1, "creation_date": 1547679061, "post_id": 54226519, "comment_id": 95279168, "body": "Yes, with <code>scanf(&quot;%f&quot;,&amp;r);</code> your code will work."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1547679353, "post_id": 54226519, "comment_id": 95279258, "body": "Try rising the warning level and check the return value of <code>scanf</code>: <a href=\"https://wandbox.org/permlink/dorT1xljDQl7zlEy\" rel=\"nofollow noreferrer\">wandbox.org/permlink/dorT1xljDQl7zlEy</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547679664, "post_id": 54226519, "comment_id": 95279351, "body": "The course value for pi reminds me of <a href=\"https://en.wikipedia.org/wiki/Indiana_Pi_Bill\" rel=\"nofollow noreferrer\">\u03c0, such as 3.2</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9019746"}, "edited": false, "score": 0, "creation_date": 1547679737, "post_id": 54226519, "comment_id": 95279372, "body": "it was a typing mistake .. I&#39;m emberassed , sorry for unnecessary question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1547679842, "post_id": 54226519, "comment_id": 95279420, "body": "@user9019746 The real mistake is not the typo. but not using a good compiler with <a href=\"https://stackoverflow.com/questions/54226519/calculation-in-c-program-always-results-in-0#comment95279258_54226519\">enough warnings enabled</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547680326, "post_id": 54226519, "comment_id": 95279609, "body": "The recipe for <i>Undefined Behavior</i> - failure to check the return of <code>scanf</code> is..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1547680519, "post_id": 54226519, "comment_id": 95279671, "body": "<code>%.2f</code> is simply an invalid <code>scanf()</code> conversion specification, starting at the <code>.</code> \u2014 see the POSIX specification for <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/scanf.html\" rel=\"nofollow noreferrer\"><code>scanf()</code></a>, which is a superset of the one for the C standard.  So, if anyone checked the return value from <code>scanf()</code> as you should, you&#39;d find that it reported an error.  And hence you get whatever you get in the value read \u2014 no assignment takes place because the conversion failed because the conversion specification was invalid.  Always test that your I/O calls succeed (especially input)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9019746"}, "edited": false, "score": 0, "creation_date": 1547681563, "post_id": 54226519, "comment_id": 95279952, "body": "Which  C compiler can you advice me ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547682502, "post_id": 54226519, "comment_id": 95280191, "body": "@user9019746 <a href=\"https://gcc.gnu.org/install/download.html\" rel=\"nofollow noreferrer\">gcc</a> is quite good."}], "answers": [{"comments": [{"owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547679854, "post_id": 54226577, "comment_id": 95279431, "body": "@chux my apologies, I didn&#39;t explain myself well. I updated my answer to have a bit of a better explanation - but if you want to suggest an edit, I&#39;d be glad to improve the answer =)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547680029, "post_id": 54226577, "comment_id": 95279507, "body": "The <code>&quot;.&quot;</code> in <code>&quot;%.2f&quot;</code> makes the specifier invalid.  The rest of the specifier is irrelevant.  The <code>&quot;2&quot;</code> is not the width because of that pesky <code>&quot;.&quot;</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547680139, "post_id": 54226577, "comment_id": 95279534, "body": "Would provide a much more thorough learning experience with <code>if (scanf(&quot;%f&quot;,&amp;r) != 1) { fputs (&quot;error: invalid input.\\n&quot;, stderr); return 1; }</code> to handle <i>matching failures</i>....(or the user canceling input by generating a manual <code>EOF</code>) (nit: no need for <code>&#39;\\n&#39;</code> at the end of the prompt -- that will be provided by pressing <code>[Enter]</code>)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547682361, "post_id": 54226577, "comment_id": 95280164, "body": "@DavidC.Rankin  Note: <code>&#39;\\n&#39;</code> helps insure flushing of <code>stdout</code> when it is line buffered.  Of course <code>fflush(stdout)</code> is best."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547682470, "post_id": 54226577, "comment_id": 95280188, "body": "Very true, but the call to <code>scanf</code> also forces the flush while it blocks for input."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547682632, "post_id": 54226577, "comment_id": 95280215, "body": "@DavidC.Rankin &quot;scanf also forces the flush&quot; --&gt; news to me.  Any ref to support that?  Sounds  implementation specific."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547682777, "post_id": 54226577, "comment_id": 95280245, "body": "Hmm... Now you have me curious. I&#39;ll have to find the reference and it may very well be implementation defined. (but it is the reason <code>printf (&quot;prompt: &quot;);</code> works without <code>fflush</code> on 99% of the systems."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547684634, "post_id": 54226577, "comment_id": 95280638, "body": "@chux, I was specifically recalling <a href=\"https://www.gnu.org/software/libc/manual/html_node/Flushing-Buffers.html\" rel=\"nofollow noreferrer\">GNU libc - 12.20.2 Flushing Buffers</a> which would make it implementation defined."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547685121, "post_id": 54226577, "comment_id": 95280729, "body": "@chux Also applicable is <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.3p3\" rel=\"nofollow noreferrer\">C11 Standard - 7.21.3 Files(p3)</a> which has the same effect, <i>&quot;characters are intended to be transmitted as a block to the host environment when a buffer is filled... or when input is requested on a line buffered stream that requires the transmission of characters from the host environment.&quot;</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547690299, "post_id": 54226577, "comment_id": 95281669, "body": "@DavidC.Rankin ... Support for these characteristics is implementation-defined,"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547692825, "post_id": 54226577, "comment_id": 95282102, "body": "@chux so let me pick your brain a bit more to make sure I&#39;m clear on what you are saying. The standard specifies how input functions affect <i>line buffered</i> streams, but it is up to the implementation to determine the default buffering for the standard streams, e.g. whether <code>stdout</code> is <i>line buffered</i>, <i>fully buffered</i> or <i>unbuffered</i>."}], "tags": [], "owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1547680082, "last_edit_date": 1547680082, "creation_date": 1547679070, "answer_id": 54226577, "question_id": 54226519, "link": "https://stackoverflow.com/questions/54226519/calculation-in-c-program-always-results-in-0/54226577#54226577", "title": "calculation in C program always results in 0", "body": "<p>If there's no reason you want to use %.2f to scan, just using %f will work </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\n#define PI 3.14\nint main() {\n    float r,a,c;\n    printf(\"enter radius: \\n\");\n    scanf(\"%f\",&amp;r);\n    c = r * PI * 2;\n    a = r * r * PI;\n    printf(\"area:%.2f circumference:%.2f \\n\",c,a );\n    return 0;\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>daniel@daniel-FX503VM:~/Documents/test$ ./zero \nenter radius: \n1\narea:6.28 circumference:3.14 \n</code></pre>\n\n<p>The .2 in the printf is a printing format specifier, and shouldn't have an impact on a scanf</p>\n\n<p>Where you're putting the .2 in the scanf is actually the width field,which specifies the maximum number of characters to be read in the current reading operation (optionally). However, in this context, .2 characters as a width is not a meaningful sentiment, seeing as the width is required to be an integer. </p>\n\n<p>If what you're actually trying to do is only read 2 characters, you could say</p>\n\n<pre><code>scanf(\"%2f\", &amp;r);\n</code></pre>\n\n<p>But be warned that the '.' would also count as a character.If you specifically just want the output to be two decimal places, then the proposed code above should suffice. If you want to round it internally, I'd suggest you read <a href=\"https://stackoverflow.com/questions/1343890/rounding-number-to-2-decimal-places-in-c\">this post</a></p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 4, "last_activity_date": 1547681380, "creation_date": 1547681380, "answer_id": 54226929, "question_id": 54226519, "link": "https://stackoverflow.com/questions/54226519/calculation-in-c-program-always-results-in-0/54226929#54226929", "title": "calculation in C program always results in 0", "body": "<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2\" rel=\"nofollow noreferrer\">C11 7.21.6.2p3</a> says the following of <code>fscanf</code> et al:</p>\n\n<blockquote>\n  <p>3 [...] Each conversion specification is introduced\n  by the character <code>%</code>. After the <code>%</code>, the following appear in sequence:</p>\n  \n  <ul>\n  <li>An optional assignment-suppressing character <code>*</code>.</li>\n  <li>An optional decimal integer greater than zero that specifies the maximum field width (in characters).</li>\n  <li>An optional length modifier that specifies the size of the receiving object.</li>\n  <li>A conversion specifier character that specifies the type of conversion to be applied.</li>\n  </ul>\n</blockquote>\n\n<p>The length modifier means the extra letter(s) such as <code>l</code> in <code>%lf</code> meaning <code>double</code>. Notice that while <code>%2f</code> would be valid and would mean that only to 2 characters of input can be consumed, it is nowhere said that you can write <code>%.2f</code>, i.e. <code>%.2f</code> is an invalid conversion specification, and hence the behaviour is undefined (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p13\" rel=\"nofollow noreferrer\">C11 7.2.6.2p13</a>).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9019746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547681380, "creation_date": 1547678657, "last_edit_date": 1547678783, "question_id": 54226519, "link": "https://stackoverflow.com/questions/54226519/calculation-in-c-program-always-results-in-0", "title": "calculation in C program always results in 0", "body": "<p>This always results in 0 for me and I don't know why...\nOther examples on internet generally cause of division.</p>\n\n<p>in Codeblocks same code results normally but in Atom I have this problem.\nplease help. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\n#define PI 3.14\nint main() {\n    float r,a,c;\n    printf(\"enter radius: \\n\");\n    scanf(\"%.2f\",&amp;r);\n    c = r * PI * 2;\n    a = r * r * PI;\n    printf(\"area:%.2f circumference:%.2f \\n\",c,a );\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "error-handling", "exit", "execvp"], "comments": [{"owner": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 0, "creation_date": 1547678525, "post_id": 54226466, "comment_id": 95278996, "body": "I have just found out that when <code>exit(1)</code> is called the child process is destroyed and so are the alterations on the variables that took place in it. Could that be the answer?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1547682136, "post_id": 54226466, "comment_id": 95280111, "body": "You really don&#39;t want the <code>WUNTRACED</code> option in <code>waitpid()</code>.  Not in the code you show, anyway.  A job control shell might use it, but a shell doing so would also pay attention to the return value and status information.  Use <code>0</code> for the last argument to <code>waitpid()</code> unless you want to see whether there&#39;s a terminated process, in which case <code>WNOHANG</code> becomes relevant and useful."}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 0, "creation_date": 1547679651, "post_id": 54226613, "comment_id": 95279346, "body": "The<code>fork()</code> is called inside the <code>foo</code> function. I don&#39;t think that <code>foo</code> function &quot;no longer exists&quot; when child exits."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 1, "creation_date": 1547679803, "post_id": 54226613, "comment_id": 95279403, "body": "Then you are wrong, @johngonidelis.  If the child&#39;s <code>execvp</code> call succeeds then indeed <code>foo</code> no longer exists in that process, unless whichever program replaces the original one has <i>its own</i> <code>foo</code>.  And even in that case, execution would still commence in <code>main</code>, not in <code>foo</code>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 0, "creation_date": 1547683100, "post_id": 54226613, "comment_id": 95280325, "body": "@johngonidelis It doesn&#39;t exist in the child. It still exists in the master because they are separate."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1547679273, "creation_date": 1547679273, "answer_id": 54226613, "question_id": 54226466, "link": "https://stackoverflow.com/questions/54226466/execvp-exit-return-value-in-function/54226613#54226613", "title": "execvp() - exit() return value in function", "body": "<p><code>execvp</code> <em>overwrites your whole process</em> with the one you're <code>exec</code>ing.</p>\n\n<p>If <code>execvp</code> succeeds, the <code>fail</code> variable no longer exists in the child. The <code>foo</code> function no longer exists in the child. The function that called <code>foo</code> no longer exists in the child. If <code>execvp</code> succeeds then the child is now running a <em>different program's</em> <code>main</code> function.</p>\n\n<p>Eventually that program will exit, and then the child process exits. It never goes back to your program. (That's why you need to create a separate process to call <code>execvp</code> in - if you used the original process, you'd never get it back)</p>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 0, "creation_date": 1547679981, "post_id": 54226647, "comment_id": 95279492, "body": "Thanks a lot. In which case does -1 return?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 1, "creation_date": 1547680062, "post_id": 54226647, "comment_id": 95279516, "body": "As I said, @johngonidelis, &quot;if <code>foo()</code> does return then it returns 0.&quot; In <b><i>no</i></b> case does the given <code>foo</code> return -1."}, {"owner": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 0, "creation_date": 1547680291, "post_id": 54226647, "comment_id": 95279594, "body": "What if the <code>fail</code> variable is replaced by the <code>status</code> variable? Would I be able to detect if <code>execvp()</code> succeeded or no?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "edited": false, "score": 0, "creation_date": 1547680582, "post_id": 54226647, "comment_id": 95279686, "body": "Not directly, @johngonidelis, no.  But in the event that the child exits normally -- whether or not its <code>execvp</code> succeeds -- the <code>status</code> set by <code>waitpid</code> encodes its <i>exit status</i>, among other things.  You may be able to choose an exist status in the <code>execlp</code> failure case that would never be emitted by the program you&#39;re trying to <code>exec</code>, and in that way distinguish between the two cases.  Details of examining the status are presented on <a href=\"https://linux.die.net/man/2/waitpid\" rel=\"nofollow noreferrer\">the <code>waitpid()</code> manual page</a>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1547680273, "last_edit_date": 1547680273, "creation_date": 1547679466, "answer_id": 54226647, "question_id": 54226466, "link": "https://stackoverflow.com/questions/54226466/execvp-exit-return-value-in-function/54226647#54226647", "title": "execvp() - exit() return value in function", "body": "<blockquote>\n  <p>The question is: what is the output of function foo?</p>\n</blockquote>\n\n<p>You seem to be asking what is the <em>return value</em> of <code>foo()</code>.  \"Output\" usually refers to data written to the terminal or an external file.  But the question remains: in which process?  Supposing that the <code>fork()</code> succeeds, you then have two virtually identical processes, both executing <code>foo()</code>.</p>\n\n<blockquote>\n  <blockquote>\n<pre><code>1)If execvp succeeds, it does not return any value.\n</code></pre>\n  </blockquote>\n</blockquote>\n\n<p>If <code>execvp()</code> succeeds, it does not return <em>at all</em>.</p>\n\n<blockquote>\n  <blockquote>\n    <p>If it fails it returns -1 (I think this return value does not have to do anything\n    with my foo function).</p>\n  </blockquote>\n</blockquote>\n\n<p>Yes.  Only your child process executes <code>execvp()</code>, however, and in the event that it returns, the process ends up calling <code>exit()</code>.</p>\n\n<blockquote>\n  <blockquote>\n<pre><code>2)exit(1) kills the child process and returns the control flow to the parent.\n</code></pre>\n  </blockquote>\n</blockquote>\n\n<p>That terminates the process before it ever returns from <code>foo()</code>, so in the child process <code>foo()</code> never returns, whether <code>execvp</code> succeeds or not.  Control <em>does not</em> return to the parent.  Forking a process is not at all the same as calling a function.  The parent can learn about the child's exit code via the <code>waitpid()</code> call it makes.</p>\n\n<p><strong>In the parent</strong>, if the <code>fork()</code> fails then that process, too, calls <code>exit()</code> and therefore does not return from <code>foo()</code>.  Supposing that the <code>fork()</code> succeeds, on the other hand, the parent waits until the child terminates.  The child is a separate process, with its own copy of all the variables, so whatever it may have done to its copy of <code>fail</code> has no effect on the parent.  That is, forking a child process is not like launching a thread in the same process, either.</p>\n\n<p>Since the parent does not itself modify <code>fail</code>, it still has its initial value, 10, if it reaches</p>\n\n<blockquote>\n<pre><code>    if (fail == 1){\n</code></pre>\n</blockquote>\n\n<p>10 != 1, so if <code>foo()</code> does return then it returns 0.</p>\n"}], "owner": {"reputation": 575, "user_id": 8242494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZWeg.png?s=128&g=1", "display_name": "gonidelis", "link": "https://stackoverflow.com/users/8242494/gonidelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 54226647, "answer_count": 2, "score": 0, "last_activity_date": 1547680273, "creation_date": 1547678352, "last_edit_date": 1592644375, "question_id": 54226466, "link": "https://stackoverflow.com/questions/54226466/execvp-exit-return-value-in-function", "title": "execvp() - exit() return value in function", "body": "<p>I have been fighting with the following concept lately and I am still unable to understand it. I have this block of code</p>\n<pre><code>int foo(int f){\n    int fail = 10;  //some random initialization value\n    int status;\n    pid_t child_pid;\n    child_pid = fork();\n\n    if(child_pid == 0) {\n        /* This is done by the child process. */\n\n        if (execvp(tokens2[0], tokens2)&lt;0){\n            fail =1;\n            perror(tokens2[0]); \n            exit(1);\n        }\n    }else if(child_pid&lt;0){\n        perror(&quot;Fork failed&quot;);\n        exit(1);\n    } else {\n        waitpid(child_pid, &amp;status, WUNTRACED);\n    }\n\n    //handle execvp error return value\n    if (fail == 1){\n        return -1;\n    }else{\n        return 0;\n    }\n    \n}\n</code></pre>\n<p>It does not make a lot of sense (don't mind <code>tokens2[]</code> array, it is declared properly and it works just fine) because it is on an abstract form in order for it to be audible and easy to understand. The question is: what is the output of function <code>foo</code>? This is what I have come to get so far:</p>\n<blockquote>\n<p>1)If <code>execvp</code> succeeds, it does not return any value. If it fails it returns <code>-1</code> (I think this return value does not have to do anything with my <code>foo</code> function).</p>\n<p>2)<code>exit(1)</code> kills the child process and returns the control flow to the parent.</p>\n</blockquote>\n<p>In my understanding, if <code>execvp</code> succeeds, the <code>foo</code> should return <code>-1</code>(according to variable <code>fail</code>), if it fails it should return <code>0</code>, but that is not what my <code>printf</code> checks on the main function show. Actually the outcome is always the opposite of what I expect.</p>\n<p>PS: I found something about <code>execvp</code> error handling using the good old <em>shelf-pipe</em> trick but it is too noisy for me. I want a simpler way to handle the error.</p>\n"}, {"tags": ["c", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547678256, "post_id": 54226393, "comment_id": 95278913, "body": "Because for multiple concatenations you don&#39;t have to scan the <i>whole</i> string that is being built. The downside is it is easier to lose track of whether there is enough space to call the inherently dangerous <code>strcat</code> or its equivalent."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1547678354, "post_id": 54226393, "comment_id": 95278945, "body": "<code>strcpy()</code> doesn&#39;t scan for the null terminator before copying.  <code>strcat()</code> does.  The author is avoiding <code>strcat(s1, s2)</code> by using <code>strcpy(s1 += strlen(s1), s2)</code> instead. But, <code>strlen()</code> scans for the null terminator, so this does not really gain anything. But, if you can avoid <code>strlen()</code>, then this becomes more useful"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1547678424, "post_id": 54226393, "comment_id": 95278966, "body": "Message from the boss:<a href=\"https://www.joelonsoftware.com/2001/12/11/back-to-basics/\" rel=\"nofollow noreferrer\">joelonsoftware.com/2001/12/11/back-to-basics</a>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1547680203, "post_id": 54226393, "comment_id": 95279560, "body": "@Ry- It is a &quot;solution&quot; for the same &quot;problem&quot;."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1547680418, "post_id": 54226393, "comment_id": 95279634, "body": "@wildplasser: Sorry, commented on the wrong question. :P"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1547681671, "post_id": 54226393, "comment_id": 95279987, "body": "Note that some care is required to make sure you aren&#39;t running past the end of the target buffer \u2014 such care is always required in C.  The code fragment shown is the core of good way of doing it (it avoids the quadratic behaviour that repeated string concatenation with <code>strcat()</code> incurs \u2014 see Shlemiel the Painter; Google knows if you don&#39;t, and see the Joel on Software link above).  But it isn&#39;t &quot;safe&quot; unless there is knowledge of the bigger context in which it is being used."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547678573, "post_id": 54226478, "comment_id": 95279005, "body": "&quot;<i>Note that <code>strcpy()</code> doesn&#39;t &quot;loop though s1 to find the Null&quot;</i>&quot; - true, but <code>strlen()</code> does, so <code>strcat(s1, s2)</code> and <code>strcpy(s1 += strlen(s1), s2)</code> are effectively the same in terms of performance. Both scan <code>s1</code> to determine where to append <code>s2</code>"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547678689, "post_id": 54226478, "comment_id": 95279047, "body": "@RemyLebeau Yep - just addressing the line in the question where OP implies (by my reading) that strcpy &quot;looks for Null&quot;"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547679175, "post_id": 54226478, "comment_id": 95279199, "body": "@RemyLebeau But now <code>s1</code> points to the end of the (original) string, rather than the start of it, so a subsequent call will only have to iterate to the end of the newly concatenated portion.  It is not as efficient as it could be, but it is an improvement."}], "tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": true, "score": 5, "last_activity_date": 1547678408, "creation_date": 1547678408, "answer_id": 54226478, "question_id": 54226393, "link": "https://stackoverflow.com/questions/54226393/concatenate-strings-in-c-strcpys1-strlens1-s2/54226478#54226478", "title": "Concatenate Strings in C - `strcpy(s1 += strlen(s1), s2)`", "body": "<p>Yes: <code>s1 += strlen(s1)</code> is going to give you a pointer to the terminating 0, so <code>strcpy(..., s2)</code> is going to work like <code>strcat()</code> - appending <code>s2</code> to <code>s1</code> (assuming there is enough space in <code>s1</code>. Note that <code>strcpy()</code> doesn't \"loop though s1 to find the Null\" - it just writes at the location given <code>strcat</code> does find the Null though.</p>\n\n<p>The key to the optimization is the <code>+=</code> we are actually changing <code>s1</code> (you better have taken a copy of the original value). So we only take the length of the last string added and not the length from the start of the first string (which is what a <code>strcat</code>solution would do).</p>\n"}, {"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1547678958, "post_id": 54226529, "comment_id": 95279129, "body": "The idea is the <code>s1 += strlen(s1)</code> also retains some memory of the <code>strlen</code> operation (in <code>s1</code>) reducing the cost for subsequent operations.  It&#39;s not perfect, but it does prevent the traversal amount from compounding on each successive concatenation."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1547683214, "post_id": 54226529, "comment_id": 95280354, "body": "@ChristianGibbons Okay, doing the <code>strlen</code> notion, is [somewhat] better [I&#39;ve edited my answer]. But, this is the first time I&#39;ve ever seen it (either in description or working code), so if it were worth the complexity, IMO, it would be in more widespread usage."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 1, "last_activity_date": 1547704015, "last_edit_date": 1547704015, "creation_date": 1547678760, "answer_id": 54226529, "question_id": 54226393, "link": "https://stackoverflow.com/questions/54226393/concatenate-strings-in-c-strcpys1-strlens1-s2/54226529#54226529", "title": "Concatenate Strings in C - `strcpy(s1 += strlen(s1), s2)`", "body": "<p>The <code>strcpy(s1 + strlen(s1),s2)</code> <em>does</em> limit the amount of rescan of <code>s1</code> with repeated calculations to the additional length of a given <code>s2</code> on the next round.</p>\n\n<p>But, IMO, instead of this <em>trick</em>, it's better to just write a function that doesn't require <em>any</em> rescan:</p>\n\n<pre><code>char *\nxstrcat(char *s1,const char *s2)\n{\n\n    for (;  *s1 != 0;  ++s1);\n\n    for (;  *s2 != 0;  ++s1, ++s2)\n        *s1 = *s2;\n    *s1 = 0;\n\n    return s1;\n}\n\nvoid\nfunc(char *s1,const char *s2,const char *s3,const char *s4)\n{\n\n    s1 = xstrcat(s1,s2);\n    s1 = xstrcat(s1,s3);\n    s1 = xstrcat(s1,s4);\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10915417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1273103a61694a052c22c5521356065f?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/10915417/m-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 54226478, "answer_count": 2, "score": 2, "last_activity_date": 1547704015, "creation_date": 1547677931, "question_id": 54226393, "link": "https://stackoverflow.com/questions/54226393/concatenate-strings-in-c-strcpys1-strlens1-s2", "title": "Concatenate Strings in C - `strcpy(s1 += strlen(s1), s2)`", "body": "<p>I am trying to understand a method to concatenate strings as proposed in \"The Standard C Library\". </p>\n\n<p>After discussing how to concatenate two strings, s1 and s2. The author proposes that for multiple strings (more than 2), </p>\n\n<blockquote>\n  <p>\"...favour a form such as <code>strcpy(s1 += strlen(s1), s2)</code>That saves repeated, and ever-lengthening, rescans of the initial part of the string...\" (pg. 395)</p>\n</blockquote>\n\n<p>I'm having trouble making sense of this code snippet. My understanding is that he's adding the length of <code>s1</code> to the pointer in order to pass the index of the Null character to strcpy, so that strcpy will not have to loop through s1 to find the Null character and can just start copying s2 into s1, is that correct?</p>\n\n<p>If my understanding is correct, how does this cause any efficiency when in place of strcpy, strlen will still have to loop through the string to determine its length?</p>\n"}, {"tags": ["c++", "c", "visual-studio-2015", "clr"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1547679331, "post_id": 54226278, "comment_id": 95279246, "body": "That is the correct way to do it.  Standard reason to still get the error is forgetting to make this setting change for all configurations and all platforms.  The two combo-boxes at the top of the dialog."}], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 131166, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b139a6d5ea2ed82bcba6d23ea9e4e27c?s=128&d=identicon&r=PG", "display_name": "Sam Skuce", "link": "https://stackoverflow.com/users/131166/sam-skuce"}, "is_accepted": true, "score": -1, "last_activity_date": 1547840227, "creation_date": 1547840227, "answer_id": 54260404, "question_id": 54226278, "link": "https://stackoverflow.com/questions/54226278/getting-error-d8045-cannot-compile-c-file-file-with-clr-option-even-after-t/54260404#54260404", "title": "Getting error D8045 &quot;cannot compile C file &lt;file&gt; with /clr option&quot; even after turning off CLR option", "body": "<p>It cleared up on its own eventually.  I had restarted Visual Studio a few times and it kept happening, which is why I asked this question.  I guess some cache somewhere wasn't being updated or got corrupt or something.</p>\n"}], "owner": {"reputation": 1637, "user_id": 131166, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b139a6d5ea2ed82bcba6d23ea9e4e27c?s=128&d=identicon&r=PG", "display_name": "Sam Skuce", "link": "https://stackoverflow.com/users/131166/sam-skuce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 54260404, "answer_count": 1, "score": -1, "last_activity_date": 1547840227, "creation_date": 1547677268, "question_id": 54226278, "link": "https://stackoverflow.com/questions/54226278/getting-error-d8045-cannot-compile-c-file-file-with-clr-option-even-after-t", "title": "Getting error D8045 &quot;cannot compile C file &lt;file&gt; with /clr option&quot; even after turning off CLR option", "body": "<p>This is in Visual Studio 2015.  </p>\n\n<p>I have a native C library that I'm using from my .NET Visual C++ code.  I'm aware that I have to change the \"Common Language Runtime Support\" option to \"No Common Language Runtime Support\" on the property page for each .c file, per <a href=\"https://stackoverflow.com/questions/880413/d8045-cannot-compile-c-file-serialcommands-c-with-the-clr-option\">this question</a>.  However, even after I have turned that option off, I am still receiving error D8045 when I attempt to compile those files.  </p>\n\n<p>Is this a known issue in VS2015, or am I missing something?</p>\n"}, {"tags": ["c", "console"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1547676243, "post_id": 54226055, "comment_id": 95278074, "body": "Please show all the code which is around the problem you have. Define the 2D array. Init it. Output it before. Write a comment &quot;here to be filled randomly&quot;. Output it again. This helps us to judge how much you understand the background of your problem."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1547676312, "post_id": 54226055, "comment_id": 95278108, "body": "Add a function to return a random value in the right ranges (width of the board and length of the board)."}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547676350, "post_id": 54226055, "comment_id": 95278126, "body": "I&#39;m not sure what exactly you need. Can you be more specific? We also need some code. If your table is 2D array, inserting number is straightforward."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1547676415, "post_id": 54226055, "comment_id": 95278164, "body": "Are you going to react to the comments? If not your question will stay to borad to be answered. If you intend to react delete the question temporarily, <a href=\"https://stackoverflow.com/posts/54226055/edit\">edit</a> it, then undelete it when it is upvotable."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1547676456, "post_id": 54226055, "comment_id": 95278180, "body": "Generally this info might help to use StackOverflow as intended. <a href=\"https://stackoverflow.com/tour\">tour</a>, <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>."}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547677351, "post_id": 54226055, "comment_id": 95278557, "body": "&quot;now I want to insert this number created randomly into the table&quot; Okay. And what&#39;s wrong with <code>ar[x][y]=z;</code>?"}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547677428, "post_id": 54226055, "comment_id": 95278589, "body": "Your table is <code>ar[][]</code> right? All you need to do is to print that 2D array with some formatting?"}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1547677471, "post_id": 54226055, "comment_id": 95278615, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/186816/discussion-between-mare70-and-yunnosch\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1, "user_id": 10727084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bUKIV1cKVeU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gBiQC-pAqmyJRv8H0x3FQl9kmxlQ/mo/photo.jpg?sz=128", "display_name": "TaRaNeH", "link": "https://stackoverflow.com/users/10727084/taraneh"}, "reply_to_user": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547677649, "post_id": 54226055, "comment_id": 95278697, "body": "@Mare70 the table is generated somewhere else it&#39;s like this |------|------| |       |       | |------|------| in those blank spaces, z must be printed."}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547677761, "post_id": 54226055, "comment_id": 95278739, "body": "Okay, but im still not sure what you need? If you want value z in that table you can just use <code>ar[x][y]=z;</code>? And print whole table later?"}, {"owner": {"reputation": 1, "user_id": 10727084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bUKIV1cKVeU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gBiQC-pAqmyJRv8H0x3FQl9kmxlQ/mo/photo.jpg?sz=128", "display_name": "TaRaNeH", "link": "https://stackoverflow.com/users/10727084/taraneh"}, "reply_to_user": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547677887, "post_id": 54226055, "comment_id": 95278785, "body": "@Mare70 the value z has to be printed in the table every time the player rolls the dices"}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547678216, "post_id": 54226055, "comment_id": 95278904, "body": "So just print whole table after every dice roll?"}, {"owner": {"reputation": 1, "user_id": 10727084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bUKIV1cKVeU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gBiQC-pAqmyJRv8H0x3FQl9kmxlQ/mo/photo.jpg?sz=128", "display_name": "TaRaNeH", "link": "https://stackoverflow.com/users/10727084/taraneh"}, "reply_to_user": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547678313, "post_id": 54226055, "comment_id": 95278933, "body": "@Mare70 the table is printed first. each time a player rolls the dice the value z is add to its place in the table. i think if a print the table every time , i&#39;ll lose the previous value of z"}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547678472, "post_id": 54226055, "comment_id": 95278979, "body": "Well, you need to post whole code and much better explanation on what exactly you want to achieve, and whats the problem. We can&#39;t help you like this."}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547678547, "post_id": 54226055, "comment_id": 95279001, "body": "Nothing will be lost with printing, printing should just print current state of the board. So you have starting state of board (empty i guess) and after each roll you add values and print whole table."}, {"owner": {"reputation": 1, "user_id": 10727084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bUKIV1cKVeU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gBiQC-pAqmyJRv8H0x3FQl9kmxlQ/mo/photo.jpg?sz=128", "display_name": "TaRaNeH", "link": "https://stackoverflow.com/users/10727084/taraneh"}, "reply_to_user": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547678795, "post_id": 54226055, "comment_id": 95279077, "body": "@Mare70 that&#39;s what i&#39;m trying to do. how should it print value z in the empty space in the table. I&#39;ve assigned 0 to all the elements of the array and z is supposed to replace it. the problem is how do i print it in the empty space. what should i do?"}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547679173, "post_id": 54226055, "comment_id": 95279198, "body": "All you need to do is to print 2D array with some formatting, you want me to post code for a function that will properly print your table?"}, {"owner": {"reputation": 1, "user_id": 10727084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bUKIV1cKVeU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gBiQC-pAqmyJRv8H0x3FQl9kmxlQ/mo/photo.jpg?sz=128", "display_name": "TaRaNeH", "link": "https://stackoverflow.com/users/10727084/taraneh"}, "reply_to_user": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1547679245, "post_id": 54226055, "comment_id": 95279221, "body": "that would be prefect. thank you @Mare70"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1547712962, "post_id": 54226769, "comment_id": 95288007, "body": "This does not answer the question. It gives a piece of code for the background of the question. This will either be ignored by OP or used to ask for more parts of the program OP wants. OP seems unable to partifcipate in  clarifying the question. Otherwise you will end up giving OP the whole program without them understanding it. In order to get a decent answer OP should focus on the most basic part they cannot handle. Which might be this array handling, but I doubt it. What OP needs seems to be hand-holding from HelloWorld, via Tutorials to a foundation for this question. Take my hint: Don&#39;t."}], "tags": [], "owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "is_accepted": false, "score": 0, "last_activity_date": 1547680264, "creation_date": 1547680264, "answer_id": 54226769, "question_id": 54226055, "link": "https://stackoverflow.com/questions/54226055/how-to-write-a-2d-array-in-a-table-with-c-language/54226769#54226769", "title": "how to write a 2D array in a table with c language", "body": "<p>Here is the code you wanted to see.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\n#define SIZE 4\n\nint ar[SIZE][SIZE]=\n{\n    {1, 0, 3, 8},\n    {4, 0, 5, 0},\n    {9, 0, 2, 1},\n    {1, 0, 6, 2}\n};\n\nint main() {\n    printTable();\n\n    return 0;\n}\nprintTable(){\n    int i;\n    int j;\n\n    for(i = 0; i&lt;SIZE+1;i++){\n        for(j=0; j&lt;SIZE+1;j++){\n            if(i==0 || j==0 || j==SIZE || i==SIZE)\n                printf(\" * \");\n            else if(j==SIZE-1)\n                printf(\"%d\",ar[i][j]);\n            else\n                printf(\"%d - \",ar[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>So as you can see this prints 2D array as a table, its also possible to pass that array as a parameter to function <code>printTable()</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10727084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bUKIV1cKVeU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gBiQC-pAqmyJRv8H0x3FQl9kmxlQ/mo/photo.jpg?sz=128", "display_name": "TaRaNeH", "link": "https://stackoverflow.com/users/10727084/taraneh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547714603, "creation_date": 1547676030, "last_edit_date": 1547714603, "question_id": 54226055, "link": "https://stackoverflow.com/questions/54226055/how-to-write-a-2d-array-in-a-table-with-c-language", "title": "how to write a 2D array in a table with c language", "body": "<p>I have a project which is like this:\nits a game to between two players in a randomly generated square table from 4 to 10. players roll 3 dices. the first dice and second are used for the location and the 3rd dice is the value which will be put into a table made of '-' and '*'. the table looks like a checkers board. now i want to insert this number created randomly into the table. I don't know how.\nin other words, how do you insert an array into a table that was made before?\nas you can see the code is below, since this is a shared project with a friend i don't have the table ready but i'll post it as soon as possible. this function is supposed to find the randomize the location and the value. also the size of the array is randomized in another function. it's a mess .</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint rolldice(int p)\n{\n   int x,y,z;\n   int ar[p][p];\n   x=1+rand%6;\n   y=1+rand%6;\n   if(z==0){\n      z=1+rand%6;\n      ar[x][y]=z;\n   }\n   else {\n      printf(\"other player roll please\");\n   }\n   return z;\n}\nint table(int n);\nint main(){\n\nint size,t;\nsrand(time (NULL));\nsize = 4 + ( rand() % 7);\nint array[size][size];\ntable(size);\nrolldice(size)\n}\nint table(int n){\nint k,a,m;\nint ar[n][n];\nfor (m=1;m&lt;=n;m++){\nprintf(\" __\");\n}\nfor (k=1;k&lt;=n;k++){\n    printf(\"\\n\");   \n    for (a=1;a&lt;=n;a++){\n        printf(\"|__\");\n        printf(\"%c\",ar[k][a]);\n        if(a==n){\n            printf(\"|\");\n        }\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1547677151, "post_id": 54225723, "comment_id": 95278447, "body": "Yes...  Take a look at <i><a href=\"http://www.doxygen.nl/\" rel=\"nofollow noreferrer\">Doxygen</a></i>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1547677232, "post_id": 54225723, "comment_id": 95278494, "body": "<i>Why</i> do you want it?"}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1547737402, "post_id": 54225723, "comment_id": 95301893, "body": "@wildplasser: I&#39;m guessing, it&#39;s to encourage programmers to write millions of single-line functions (to artificially inflate their &quot;number of conceptual units&quot; scores). ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 0, "last_activity_date": 1547675052, "creation_date": 1547675052, "answer_id": 54225859, "question_id": 54225723, "link": "https://stackoverflow.com/questions/54225723/counting-the-number-of-functions-and-data-structures-in-a-c-codebase/54225859#54225859", "title": "Counting the number of functions and data structures in a C codebase", "body": "<p>On a Linux environment, you'll want to look at a tool like <a href=\"https://www.systutorials.com/docs/linux/man/1-objdump/\" rel=\"nofollow noreferrer\"><code>objdump</code></a>, that will show you a bunch of information about the compiled output.</p>\n\n<p>There are pages that explain some of its complicated output, such as <a href=\"https://www.howtoforge.com/linux-objdump-command/\" rel=\"nofollow noreferrer\">this</a>.\nBut perhaps one of the simplest is <code>objdump -T</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1547728961, "last_edit_date": 1547728961, "creation_date": 1547677616, "answer_id": 54226347, "question_id": 54225723, "link": "https://stackoverflow.com/questions/54225723/counting-the-number-of-functions-and-data-structures-in-a-c-codebase/54226347#54226347", "title": "Counting the number of functions and data structures in a C codebase", "body": "<p>It sounds like you are in need of perusing your source code.  <em><a href=\"http://www.doxygen.nl/download.html\" rel=\"nofollow noreferrer\">Doxygen</a></em> is an excellent tool for summarizing just about every aspect of a C project.  (and many other languages).  It is OpenSource, and easily downloaded.  Additionally, the <em><a href=\"http://mcs.une.edu.au/doc/doxygen/html/features.html\" rel=\"nofollow noreferrer\">list of features</a></em> is extensive.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547728961, "creation_date": 1547674350, "question_id": 54225723, "link": "https://stackoverflow.com/questions/54225723/counting-the-number-of-functions-and-data-structures-in-a-c-codebase", "title": "Counting the number of functions and data structures in a C codebase", "body": "<p>Is there a way to take a C file (or a directory/project) and count the number of functions + data structures? This is similar to counting the LOC but instead is focused on counting the number of \"conceptual units\" the program handles as a way to measure its complexity.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1547675396, "post_id": 54225712, "comment_id": 95277730, "body": "The behaviour of <code>scanf()</code> has not changed significantly \u2014 to change it would be to break working code (lots of working code)."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1571295162, "post_id": 54225813, "comment_id": 103194461, "body": "The behavior of <code>scanf</code> also changed between C89 and C99.  In C89, using <code>%f</code> or <code>%g</code> to read a floating-point number that was followed by any letter other than <code>E</code> or <code>e</code> would read the numeric portion and leave the letter (and everything that follows) pending.  C99&#39;s <code>%f</code> and <code>%g</code> will now treat <code>0x</code> as a hex prefix, and will also consume and accept <code>INF</code> or <code>INFINITE</code>, and will consume without accepting any prefix of <code>INFINITE</code> followed by something other than the proper next character."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1571316274, "post_id": 54225813, "comment_id": 103206380, "body": "@supercat True. Other oddities include &quot;INF or INFINITY, <b>ignoring case</b>&quot;, &quot;NAN or NAN(n-char-sequence opt), <b>ignoring case</b> in the NAN&quot; (so now we have locale and payload concerns). Rump input like <code>&quot;0x\\n&quot;</code>  (consumes &quot;0&quot;, leaves &quot;x&quot;), &quot;<code>%a&quot;</code>, &quot;<code>%Le&quot;</code>, etc."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1547677151, "last_edit_date": 1547677151, "creation_date": 1547674843, "answer_id": 54225813, "question_id": 54225712, "link": "https://stackoverflow.com/questions/54225712/scanf-what-remains-on-the-input-stream-after-failer/54225813#54225813", "title": "scanf what remains on the input stream after failer", "body": "<p><code>scanf()</code> is evil - use <code>fgets()</code> and then parse.  </p>\n\n<hr>\n\n<p>The detail is not that <code>scanf()</code> is completely bad.</p>\n\n<p>1) The format specifiers are often used in a weak manner</p>\n\n<pre><code>char buf[100];\nscanf(\"%s\", buf); // bad - no width limit\n</code></pre>\n\n<p>2) The return value is errantly not checked</p>\n\n<pre><code>scanf(\"%99[\\n]\", buf); // what if use entered `\"\\n\"`?\nputs(buf); \n</code></pre>\n\n<p>3) When input is not as expected, it is not clear what remains in <code>stdin</code>.</p>\n\n<pre><code>if (scanf(\"%d %d %d\", &amp;i, &amp;j, &amp;k) != 3) {\n  // OK, not what is in `stdin`?\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>you can have baffling problems if you try to intermix calls to scanf with calls to getchar or getline.</p>\n</blockquote>\n\n<p>Yes.  Many <code>scanf()</code> calls leave a trailing <code>'\\n'</code> in <code>stdin</code> that are then read as an empty line by <code>getline(), fgets()</code>.  <code>scanf()</code> is <strong>not</strong> for reading <em>lines</em>.  <code>getline()</code> and <code>fgets()</code> are much better suited to read a <em>line</em>.</p>\n\n<hr>\n\n<blockquote>\n  <p>Has scanf changed much since the quotes above were written?</p>\n</blockquote>\n\n<p>Only so much change can happen without messing up the code base. <a href=\"https://stackoverflow.com/questions/54225712/scanf-what-remains-on-the-input-stream-after-failer#comment95277730_54225712\">@Jonathan Leffler</a></p>\n\n<p><code>scanf()</code> remains troublesome.  <code>scanf()</code> is unable to accept an argument (after the format) to indicate how many characters to accept into a <code>char *</code> destination.</p>\n\n<p>Some systems have added additional format options to help.</p>\n\n<p>A fundamental issues is this:</p>\n\n<p>User input is <em>evil</em>.  It is more robust to get the text input as one step, qualify input, then parse and assess its success than trying to do all this in one function.</p>\n\n<hr>\n\n<p><strong>Security</strong></p>\n\n<p>The weakness of <code>scanf()</code> and coder tendency to code <code>scanf()</code> poorly has been a gold mine for hackers.</p>\n\n<p>IMO, C lacks a robust user input function set.</p>\n"}], "owner": {"reputation": 388, "user_id": 7892010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb22306a8bdbe2dfcfa54ec6e0edca5?s=128&d=identicon&r=PG&f=1", "display_name": "Manny_Mar", "link": "https://stackoverflow.com/users/7892010/manny-mar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 54225813, "answer_count": 1, "score": 2, "last_activity_date": 1547678543, "creation_date": 1547674288, "last_edit_date": 1547678543, "question_id": 54225712, "link": "https://stackoverflow.com/questions/54225712/scanf-what-remains-on-the-input-stream-after-failer", "title": "scanf what remains on the input stream after failer", "body": "<p>I learned C a few years ago using K&amp;R 2nd edition ANSI C. I\u2019ve been reviewing my notes, while I\u2019m learning more modern C from 2 other books.</p>\n\n<p>I notice that K&amp;R never use scanf in the book, except on the one section where they introduce it. They mainly use a getline function which they write in the book, which they change later in the book, once they introduce pointers. There getline is different then gcc getline, which caused me some problems until i change the name of getline to ggetline. </p>\n\n<p>Reviewing my notes i found this quote:</p>\n\n<blockquote>\n  <p>This simplification is convenient and superficially attractive, and it\n  works, as far as it goes. The problem is that scanf does not work well\n  in more complicated situations. In section 7.1, we said that calls to\n  putchar and printf could be interleaved. The same is not always true\n  of scanf: you can have baffling problems if you try to intermix calls\n  to scanf with calls to getchar or getline. Worse, it turns out that\n  scanf's error handling is inadequate for many purposes. It tells you\n  whether a conversion succeeded or not (more precisely, it tells you\n  how many conversions succeeded), but it doesn't tell you anything more\n  than that (unless you ask very carefully). Like atoi and atof, scanf\n  stops reading characters when it's processing a %d or %f input and it\n  finds a non-numeric character. Suppose you've prompted the user to\n  enter a number, and the user accidentally types the letter 'x'. scanf\n  might return 0, indicating that it couldn't convert a number, but the\n  unconvertable text (the 'x') remains on the input stream unless you\n  figure out some other way to remove it.</p>\n  \n  <p>For these reasons (and several others, which I won't bother to\n  mention) it's generally recommended that scanf not be used for\n  unstructured input such as user prompts. It's much better to read\n  entire lines with something like getline (as we've been doing all\n  along) and then process the line somehow. If the line is supposed to\n  be a single number, you can use atoi or atof to convert it. If the\n  line has more complicated structure, you can use sscanf (which we'll\n  meet in a minute) to parse it. (It's better to use sscanf than scanf\n  because when sscanf fails, you have complete control over what you do\n  next. When scanf fails, on the other hand, you're at the mercy of\n  where in the input stream it has left you.)</p>\n</blockquote>\n\n<p>At first i thought this quote was from K&amp;R, but i cannot find it in the book. Then i realized thats it's from lecture notes i got online, for someone who taught a course years ago using K&amp;R book.</p>\n\n<p><a href=\"http://www.eskimo.com/~scs/cclass/krnotes/sx10d.html\" rel=\"nofollow noreferrer\">lecture notes</a></p>\n\n<p>I know that K&amp;R book is 30 years old now, so it is dated is some ways. </p>\n\n<p>This quote is very old, so i was wondering if scanf still has this behavior or has it changed?</p>\n\n<p>Does scanf still leave stuff in the input stream when it fails? for example above:</p>\n\n<blockquote>\n  <p>Suppose you've prompted the user to enter a number, and the user\n  accidentally types the letter 'x'. scanf might return 0, indicating\n  that it couldn't convert a number, but the unconvertable text (the\n  'x') remains on the input stream.</p>\n</blockquote>\n\n<p>Is the following still true?</p>\n\n<blockquote>\n  <p>putchar and printf could be interleaved. The same is not always true\n  of scanf: you can have baffling problems if you try to intermix calls\n  to scanf with calls to getchar or getline.</p>\n</blockquote>\n\n<p>Has scanf changed much since the quotes above were written? Or are they still true today?</p>\n\n<p>The reason i ask, in the newer books i am reading, no one mentions these issues.</p>\n"}, {"tags": ["c", "arguments", "fork", "argc"], "comments": [{"owner": {"reputation": 823, "user_id": 1211581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TYVpV.jpg?s=128&g=1", "display_name": "mbj", "link": "https://stackoverflow.com/users/1211581/mbj"}, "edited": false, "score": 0, "creation_date": 1547674355, "post_id": 54225622, "comment_id": 95277281, "body": "On what operating system is this going to run?"}, {"owner": {"reputation": 61, "user_id": 9710937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LucaW", "link": "https://stackoverflow.com/users/9710937/lucaw"}, "reply_to_user": {"reputation": 823, "user_id": 1211581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TYVpV.jpg?s=128&g=1", "display_name": "mbj", "link": "https://stackoverflow.com/users/1211581/mbj"}, "edited": false, "score": 0, "creation_date": 1547674623, "post_id": 54225622, "comment_id": 95277395, "body": "On Linux, gonna add it to the post"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9710937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LucaW", "link": "https://stackoverflow.com/users/9710937/lucaw"}, "edited": false, "score": 2, "creation_date": 1547712887, "post_id": 54225857, "comment_id": 95287974, "body": "Thank you, this solution worked! Thanks for the great explanation as well, made it really easy to understand."}], "tags": [], "owner": {"reputation": 823, "user_id": 1211581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TYVpV.jpg?s=128&g=1", "display_name": "mbj", "link": "https://stackoverflow.com/users/1211581/mbj"}, "is_accepted": true, "score": 4, "last_activity_date": 1547694036, "last_edit_date": 1547694036, "creation_date": 1547675042, "answer_id": 54225857, "question_id": 54225622, "link": "https://stackoverflow.com/questions/54225622/starting-program-using-execv-and-passing-arguments-with-out-raising-argc/54225857#54225857", "title": "Starting program using execv and passing arguments with out raising argc", "body": "<p>Okay, I figured this out now, after some experimenting of my own.</p>\n\n<p>Since passing an array that starts with <code>NULL</code> (<code>0</code>) to <code>execv</code> results in the program printing out <code>LC_MEASUREMENT=de_DE.UTF-8</code>, I realized that it must means that <code>argv[3]</code> is referring to an element in the process <em>environment</em> (LC_MEASUREMENT is one of the environment variables used to configure locale settings in Linux). </p>\n\n<h3>Solution with <code>execv</code></h3>\n\n<p>Since <code>execv</code> will copy the current environment to the new program, we just have to modify the environment and put the string <code>\"Hello World!\"</code> in the correct spot before calling <code>execv</code>. It turns out that the string which gets printed is the one pointed to by index 2 of the environment. </p>\n\n<p>To access the current environment, we need to declare the <code>environ</code> variable outside of <code>main</code>:\n</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>external char **environ;\n\nint main() \n{\n    ...\n</code></pre>\n\n<p>And then do this before calling <code>execv</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>        char *argv[] = { NULL };\n        environ[2] = \"Hello world!\";\n        execv(\"filepath\", argv);\n</code></pre>\n\n<h3>Simpler solution with <code>execve</code></h3>\n\n<p>Instead of declaring <code>external char **environ</code> and modifying the current environment before calling <code>execv</code>, we can use the <code>execve</code> function, which lets us pass in a new array of strings to use as the environment for the program:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>        char *argv[] = { NULL };\n        char *envp[] = { \"foo\", \"bar\", \"Hello World!\", NULL };\n        execve(\"filepath\", argv, envp);\n</code></pre>\n\n<p>As the above code snippet shows, <code>\"Hello World!\"</code> needs to be at index <code>2</code> of the environment, regardless of which method we use.</p>\n\n<h3>How it works</h3>\n\n<p>The reason this works is that there's a standard for how command-line arguments and the environment are laid out in process memory when a program is executed: The environment array of char pointers is placed right after the command-line arguments array. </p>\n\n<p>Since these arrays are terminated with a NULL entry, it will look like this:\n</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>+---------+---------------------------------------+ \n| Args    | Environment                           |\n+---------+---------+---------+---------+---------+\n|  NULL   | envp[0] | envp[1] | envp[2] |  NULL   | \n+---------+---------+---------+---------+---------+\n    ^         ^                   ^                     \n    |         |                   |\n argv[0]    argv[1]     ...     argv[3]\n</code></pre>\n\n<p>I hope the ASCII art helps you understand why <code>argv[3]</code> means the same thing as <code>environ[2]</code> when we execute the program like this.</p>\n"}], "owner": {"reputation": 61, "user_id": 9710937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LucaW", "link": "https://stackoverflow.com/users/9710937/lucaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "accepted_answer_id": 54225857, "answer_count": 1, "score": 2, "last_activity_date": 1612105960, "creation_date": 1547673942, "last_edit_date": 1612105960, "question_id": 54225622, "link": "https://stackoverflow.com/questions/54225622/starting-program-using-execv-and-passing-arguments-with-out-raising-argc", "title": "Starting program using execv and passing arguments with out raising argc", "body": "<p>Ive been given this code in class:</p>\n<pre><code>    int main(int argc, char **argv)\n    {\n        if(argc)\n        {\n            return 1;\n        }\n\n        puts(argv[3]);\n        return 0;\n    }\n</code></pre>\n<p>Now, Im supposed to write a second program which executes this and makes it print &quot;Hello World!&quot;. So I have to find a way to pass in arguments (I assume with execv) while having argc stay at 0.</p>\n<p>This is what I have so far:</p>\n<pre class=\"lang-c prettyprint-override\"><code>int main()\n{\n    pid_t pid = fork();\n\n    if(pid == 0)\n    {\n        char *argv[] = { &quot;filepath&quot;, &quot;placeholder&quot;,\n                            &quot;placeholder&quot;, &quot;Hello World!&quot; };\n        execv(&quot;filepath&quot;, argv);\n        exit(0);\n    }\n    else\n    {\n        waitpid(pid, 0, 0);\n    }\n    \n    return 0;\n}\n</code></pre>\n<p>This is going to run on Linux.</p>\n<p>I tried mbj's original suggestion to pass a 0 in the arguments array, which sadly didnt work. However if I put 0 as the first argument, argc becomes 0, but then I get the output &quot;LC_MEASUREMENT=de_DE.UTF-8&quot; when trying to print the arguments. Googling this didnt really help me either.</p>\n<p>Im at a total loss here, so any help is appreciated.</p>\n"}, {"tags": ["c", "gcc", "raspberry-pi", "kernighan-and-ritchie"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1547671506, "post_id": 54225045, "comment_id": 95275991, "body": "What do you think the size of the <code>s</code> array?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547672266, "post_id": 54225045, "comment_id": 95276324, "body": "Why not use <code>fgets()</code> to read a line of input, instead of writing your own loop?"}, {"owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547672296, "post_id": 54225045, "comment_id": 95276336, "body": "@EugeneSh. I have run <code>sizeof(s)</code>, noticed it is showing as 0, but, the point is, why does <code>atoi(s)</code> is showing as 0, because, as <code>printf(&quot;%i&quot;, atoi(&quot; -123junk&quot;))</code>, it looks like, &quot;-123junk&quot; is the same string as <code>s</code> in <code>atoi(s)</code>, isn&#39;t it?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1547672378, "post_id": 54225045, "comment_id": 95276376, "body": "The size of <code>s</code> is indeterminate, since you never assigned anything to <code>i</code> before declaring <code>char s[i]</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1547672481, "post_id": 54225045, "comment_id": 95276420, "body": "@readonly The main point here is that by using an array like your program has an <i>undefined behavior</i> and may produce <i>any</i> results."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547672874, "post_id": 54225045, "comment_id": 95276599, "body": "You multiply by 10 to accumulate each digit in the next power of 10 in the final number. If the number is <code>123</code>, you start with <code>n = 0</code>. Then you multiply by 10 and add 1 to get 1. Then you multiply by 10 and add 2 to get 12. Multiply this by 10 and add 3 and you get 123. This is grade school arithmetic."}, {"owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547679753, "post_id": 54225045, "comment_id": 95279378, "body": "@Barmar, but, when the function <code>atoi</code> has been called once, the <code>n=0</code>, then <code>n = 10 * n + (s[i] - &#39;0&#39;);</code>, however, then, the loop ends and the call to this function from the function <code>main()</code> is end, and during the next call to the same function, the compiler should read from top to bottom, hence, assignment <code>n=0</code> would be seen, right???"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1547680997, "post_id": 54225045, "comment_id": 95279819, "body": "What are you talking about? <code>atoi</code> isn&#39;t called once for each digit. It&#39;s called once for the whole string, and it loops over the digits within the string. Before adding each digit into the result it multiplies by 10."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547704306, "post_id": 54225045, "comment_id": 95284602, "body": "The posted code will output everything, jammed together, on a single line.  Suggest, changing the format string: <code>&quot;%d&quot;</code>  to <code>&quot;%d\\n&quot;</code>  in each call to <code>printf()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547704581, "post_id": 54225045, "comment_id": 95284686, "body": "BTW: the K&amp;R book is decades old and doesn&#39;t really match the current c language"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547704692, "post_id": 54225045, "comment_id": 95284715, "body": "suggest reading the MAN page for <code>atoi()</code> as it (amongst other things) will tell you what that function returns"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547704867, "post_id": 54225045, "comment_id": 95284770, "body": "regarding: <code>int c, i;     char s[i];</code>  since the variable <code>i</code> has not been initialized to a known value, it is undefined behavior to access that variable when declaring the array <code>s[]</code>"}, {"owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547714011, "post_id": 54225045, "comment_id": 95288469, "body": "@user3629249 What would you suggest as an alternative to K&amp;R, as I believe, many of the examples given in this book are very ease to follow just using book and fast to learn?"}, {"owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547715164, "post_id": 54225045, "comment_id": 95289047, "body": "@Barmar Understood."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547745622, "post_id": 54225045, "comment_id": 95306726, "body": "@user3629249 It looks like it&#39;s been updated somewhat, since the example he quoted uses modern parameter declarations rather than the original syntax."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547745665, "post_id": 54225045, "comment_id": 95306749, "body": "@readonly See <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">The Definitive C Book Guide and List</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547673729, "post_id": 54225237, "comment_id": 95277003, "body": "Note: <code>if (s[i] &gt;= &#39;1&#39; &amp;&amp; s[i] &lt;= &#39;9&#39;) {         n = s[i++] - &#39;0&#39;;</code> not needed in last code - can be dropped."}, {"owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "edited": false, "score": 0, "creation_date": 1547679932, "post_id": 54225237, "comment_id": 95279471, "body": "@chqrlie Have just tried to run the code you have mentioned, and, noticed, that when I use string like <code>&quot;123242someletters12321&quot;</code>as an input, I am getting only first digits as an output, is it expected??"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "edited": false, "score": 1, "creation_date": 1547680778, "post_id": 54225237, "comment_id": 95279748, "body": "@readonly - what happens when the test condition in <code>while (s[i] &gt;= &#39;0&#39; &amp;&amp; s[i] &lt;= &#39;9&#39;)</code> is no longer <code>TRUE</code>?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547698267, "post_id": 54225237, "comment_id": 95283157, "body": "@chux: of course the code you mention can be dropped, but it does save a multiplication, which is precisely the purpose of this alternate function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547705412, "post_id": 54225237, "comment_id": 95284913, "body": "regarding: <code>while (s[i] == &#39;0&#39;)</code>  what if the leading characters were white space? what if the leading character was &#39;+&#39;.  what if the leading character was &#39;-&#39;?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547705538, "post_id": 54225237, "comment_id": 95284960, "body": "regarding: <code>while (s[i] &gt;= &#39;0&#39; &amp;&amp; s[i] &lt;= &#39;9&#39;)</code>  This would be much better written as: <code>#include &lt;ctypes.h&gt;</code>  and <code>while( isdigit( s[i] ) )</code>"}, {"owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547713510, "post_id": 54225237, "comment_id": 95288237, "body": "@DavidC.Rankin I suppose, the loop ends, hence, as per mentioned input,&quot;123242someletters12321&quot;, everything after &quot;123242&quot; would be omitted, right?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547790572, "post_id": 54225237, "comment_id": 95320848, "body": "@user3629249: yes, <code>&lt;ctype.h&gt;</code> macros could be used, but the correct way to do so is to write <code>while( isdigit((unsigned char)s[i]))</code> as <code>isdigit()</code> is only defined for a subset of type <code>int</code> comprising the values of of <code>unsigned char</code> and the value <code>EOF</code>. passing it negative <code>char</code> values has undefined behavior."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1547795333, "last_edit_date": 1547795333, "creation_date": 1547672115, "answer_id": 54225237, "question_id": 54225045, "link": "https://stackoverflow.com/questions/54225045/string-of-digits-into-its-numeric-equivalent-example-not-working-properly-as-p/54225237#54225237", "title": "&quot;string of digits into its numeric equivalent&quot; example not working properly as per K&amp;R", "body": "<p>Q1) your version of <code>atoi()</code> is too simple, the standard version ignores leading whitespace characters and handles an optional sign before the number. <code>atoi(\" -123junk\")</code> should evaluate to <code>-123</code>.</p>\n\n<p>Q2) <code>atoi</code> is a standard function defined with the prototype <code>int atoi(const char *s);</code> it returns an integer.</p>\n\n<p>Q3) There are a few mistakes in <code>Code 2</code>:</p>\n\n<ul>\n<li>you specify the size of the <code>char</code> array <code>s</code> as <code>i</code>, which is uninitialized. you should instead define the array with a reasonably large value such as <code>64</code>,</li>\n<li>you should test for potential buffer overflow in the loop,</li>\n<li>you should check for <code>EOF</code> to stop the loop in case end of file is encountered without a newline.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char s[64];\n    size_t i;\n    int c;\n    for (i = 0; i &lt; sizeof(s) - 1 &amp;&amp; (c = getchar()) != EOF;) {\n       s[i++] = c;\n       if (c == '\\n')\n           break;\n    }\n    s[i] = '\\0';\n    printf(\"%i\", atoi(s));\n    return 0;\n}\n</code></pre>\n\n<p>Q4) the expression <code>n = 10 * n + (s[i] - '0')</code> is evaluated for each new digit found in the string. It is indeed slightly inefficient to multiply the current value by 10 as long as no non-zero digit has been encountered, but writing the function this way is simple.</p>\n\n<p>To avoid these useless multiplications, here is an alternative:</p>\n\n<pre><code>int atoi(const char *s) {\n    int n = 0;\n    size_t i = 0;\n\n    while (s[i] == '0')\n        i++;\n    if (s[i] &gt;= '1' &amp;&amp; s[i] &lt;= '9') {\n        n = s[i++] - '0';\n        while (s[i] &gt;= '0' &amp;&amp; s[i] &lt;= '9')\n            n = 10 * n + (s[i++] - '0');\n    }\n    return n;\n}\n</code></pre>\n\n<p>But this function is more cumbersome and might actually be less efficient that the simple version. Try and benchmark both on your system.</p>\n\n<p>For completeness, here is a full portable version using <code>ctype.h&gt;</code> that handles optional initial whitespace, and an optional sign. It also handles overflow with defined behavior, although the standard version of <code>atoi()</code> is not required to do so.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\nint atoi(const char *s) {\n    int n = 0, d;\n\n    /* skip optional initial white space */\n    while (isspace((unsigned char)*s))\n        s++;\n    if (*s == '-') {\n        /* convert negative number */\n        s++;\n        while (isdigit((unsigned char)*s)) {\n            d = (*s++ - '0');\n            /* check for potential arithmetic overflow */\n            if (n &lt; INT_MIN / 10 || (n == INT_MIN / 10 &amp;&amp; -d &lt; INT_MIN % 10)) {\n                n = INT_MIN;\n                break;\n            }\n            n = n * 10 - d;\n        }\n    } else {\n        /* ignore optional positive sign */\n        if (*s == '+')\n            s++;\n        while (isdigit((unsigned char)*s)) {\n            d = (*s++ - '0');\n            /* check for potential arithmetic overflow */\n            if (n &gt; INT_MAX / 10 || (n == INT_MAX / 10 &amp;&amp; d &gt; INT_MAX % 10)) {\n                n = INT_MAX;\n                break;\n            }\n            n = n * 10 + d;\n        }\n    }\n    return n;\n}\n\nint main(int argc, char *argv[]) {\n    int i, n;\n\n    for (i = 1; i &lt; argc; i++) {\n        n = atoi(argv[i]);\n        printf(\"\\\"%s\\\" -&gt; %d\\n\", argv[i], n);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8109658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyNSA.png?s=128&g=1", "display_name": "readonly", "link": "https://stackoverflow.com/users/8109658/readonly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 54225237, "answer_count": 1, "score": 1, "last_activity_date": 1547795333, "creation_date": 1547671317, "last_edit_date": 1547680408, "question_id": 54225045, "link": "https://stackoverflow.com/questions/54225045/string-of-digits-into-its-numeric-equivalent-example-not-working-properly-as-p", "title": "&quot;string of digits into its numeric equivalent&quot; example not working properly as per K&amp;R", "body": "<p>I am trying to figure out the function <code>atoi()</code> from <code>stdlib.h</code>. As per K&amp;R, it looks like the following:</p>\n\n<pre><code>int atoi(char s[]) {\n   int n, i;\n\n   n = 0;\n   for (i = 0; s[i] &gt;= '0' &amp;&amp; s[i] &lt;= '9'; ++i)\n        n = 10 * n + (s[i] - '0');\n   return n;\n}\n</code></pre>\n\n<p>As I understand, the <code>atoi()</code> function, from <code>stdlib.h</code>, should get the string of any characters as an input and literally output only digits like the following:</p>\n\n<p>Code 1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    printf(\"%i\", atoi(\" -123junk\"));\n    printf(\"%i\", atoi(\"0\"));\n    printf(\"%i\", atoi(\"junk\"));         // no conversion can be performed\n    printf(\"%i\", atoi(\"2147483648\"));   // UB: out of range of int\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>-123\n0\n0\n-2147483648\n</code></pre>\n\n<p>However, in my program, I am trying to provide the string as input and get the digits only as output:</p>\n\n<p>Code 2:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int c, i;\n    char s[i];\n    for (i = 0; (c = getchar()) != '\\n'; ++i)\n       s[i] = c;\n    s[i] = '\\n';\n    s[++i] = '\\0';\n    printf(\"%i\", atoi(s));\n}\n</code></pre>\n\n<p>When executing on machine:</p>\n\n<pre><code>pi@host:~/new$ cc new.c\npi@host:~/new$ a.out\n21412421How it is\n0\n</code></pre>\n\n<p>I am getting incorrect values as an output.</p>\n\n<p>Questions:</p>\n\n<p>1) As per Code 1, <code>printf(\"%i\", atoi(\" -123junk\"))</code>, it looks like the function <code>atoi()</code> can receive string as an argument and return single integer number that represents concatenation of numeric values of the digits in the input string, isn't it?</p>\n\n<p>2) What does the <code>atoi()</code>, from <code>stdlib.h</code>, return? </p>\n\n<p>3) How to fix the function <code>main()</code> from Code 2, in order to get characters from <code>stdin</code>, write into the array, call the function <code>atoi()</code>, provide array as an argument, receive, literally, digits in output?</p>\n\n<p>4) As per K&amp;R example of the function <code>atoi()</code>, \"the expression <code>(s[i] - '0')</code> is the numeric value of the character stored in <code>s[i]</code>\", but, why do we need to add <code>10 * n</code> part, moreover, to assign <code>n</code> to <code>0</code> before it, as <code>n * 0 = 0</code>, hence, <code>n * 10 = 0</code>, which means, that the <code>n * 10</code> will always be zero in the assignment statement <code>n = 10 * n + (s[i] - '0');</code>, hence, why do we need it?</p>\n\n<p>5) If the atoi() is returning one integer, how can the result of <code>printf(\"%i\", atoi(\" -123junk\"));</code> return a string with numbers <code>-123</code>? In other words, am I understand it correctly: The function <code>atoi()</code> is called within function <code>printf()</code> with the <code>\" -123junk\"</code> as an argument. Function <code>atoi()</code> returns integer, ONLY one integer, which is something like <code>n = 10 * n + (s[i] - '0');</code> than, how it can be expanded in <code>-123</code>??</p>\n"}, {"tags": ["c", "multithreading", "signals"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1547671374, "post_id": 54224992, "comment_id": 95275934, "body": "See usage example: <a href=\"http://pubs.opengroup.org/onlinepubs/009696699/functions/pthread_cond_wait.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009696699/functions/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547671436, "post_id": 54224992, "comment_id": 95275956, "body": "Note that although <code>pthread_cond_signal()</code> has &quot;signal&quot; in its name, it hasn&#39;t much to do with &quot;signals&quot; as that term is normally used in C context.  But that doesn&#39;t mean that a condition variable won&#39;t do the job you want."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1547671492, "post_id": 54224992, "comment_id": 95275985, "body": "Your code is broken. If <code>counter</code> is protected by the mutex, you can&#39;t access it without holding the mutex. Yet your <code>while</code> loop does exactly that. This mistake, in practice, allows the compiler to &quot;optimize&quot; <code>while (counter != threads);</code> to <code>if (counter != threads) while(1);</code>."}, {"owner": {"reputation": 124, "user_id": 6438359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e85e5b3614e75c70f38d39736f72d02?s=128&d=identicon&r=PG&f=1", "display_name": "Tianjiao Huang", "link": "https://stackoverflow.com/users/6438359/tianjiao-huang"}, "edited": false, "score": 0, "creation_date": 1547671539, "post_id": 54224992, "comment_id": 95276010, "body": "Use <code>pthread_cond_broadcast</code> to signal all threads that are waiting on <code>pthread_cond_wait</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1547671891, "post_id": 54224992, "comment_id": 95276174, "body": "However you happened upon the idea, combining a condition variable with your mutex is a good way to go.  HOWEVER, if your example is representative of what you want to do in that you want to wait for a specific number of threads to all reach the same point, then release all of them to proceed, then you might also look into using a <a href=\"https://linux.die.net/man/3/pthread_barrier_wait\" rel=\"nofollow noreferrer\">barrier</a>."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1547671926, "post_id": 54224992, "comment_id": 95276197, "body": "If the code is then optimised to &#180;if (counter != threads) while(1);`, then why is the code then still working &quot;properly&quot;? I am aware it&#39;s not necessarily good, but for learning purposes well enough."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1547672032, "post_id": 54224992, "comment_id": 95276238, "body": "It&#39;s working &quot;properly&quot; if you didn&#39;t expect this optimization and improperly if you did expect the optimization. I think it&#39;s actually unfortunate that it happened to do what you happened to want because that can cause you to learn that it&#39;s okay to access an object that&#39;s protected by a mutex without holding that mutex. It&#39;s not -- the results are unpredictable and what you think is &quot;working properly&quot; may not agree with what I think or, worse, what the compiler things."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547672049, "post_id": 54224992, "comment_id": 95276241, "body": "@Imago, it is <i>not</i> good for learning purposes!  Quite the opposite.  Learn good habits and proper practices from the start, so that you do not need to <i>un</i>learn bad ones later."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547672317, "post_id": 54224992, "comment_id": 95276346, "body": "@JohnBollinger, that is the reason I ask. I have not yet enough experience to write code by good habit and proper practice, in particular, because I don&#39;t know yet, what is all possible.  + I strongly believe, that you can learn from errors and bad code, if someone more experienced shows weaknesses and offers improvements."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547672639, "post_id": 54224992, "comment_id": 95276490, "body": "Sure, @Imago, you can learn from errors, including coding errors.  But if someone who knows better points out such errors to you, and you respond by saying it&#39;s good enough for learning purposes, that conveys to me that you are not interested in learning from them, or that you do not perceive them as the errors they are."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547673266, "post_id": 54224992, "comment_id": 95276793, "body": "@JohnBollinger, If I am not interested in learning from my errors or not perceiving my errors as such, then why did I ask for help in the first place? I don&#39;t care about my ego, I just want to become better, even if it means putting myself in the lion&#39;s den by asking on SO."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 2, "creation_date": 1547673335, "post_id": 54224992, "comment_id": 95276821, "body": "Re, &quot;If the code is optimized...why is it still working?&quot; That optimization is <i>allowed</i> by the language standard, but it is not <i>required</i>.  When threads in your program share a variable with no <i>synchronization</i>, then we say that your program depends on <i><a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a></i> (UB).  A program that depends on UB may work just fine in one instance, but it may fail to work if you change the OS, if you change the hardware platform, if you change which compiler or which compiler options you use, if you change any line of code, etc."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 2, "creation_date": 1547673633, "post_id": 54224992, "comment_id": 95276954, "body": "Put another way.  A program that depends on UB is <i>wrong</i>. period. Even if it happens to work for you today, there&#39;s no guarantee that it will work for you tomorrow or, that it will work for anybody else."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1547673942, "post_id": 54224992, "comment_id": 95277109, "body": "@DavidSchwartz and Solomon Slow: Interesting. Falling into the trap of undefined behaviour happens scarily easy. Good to know."}], "answers": [{"comments": [{"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1547673610, "post_id": 54225041, "comment_id": 95276941, "body": "I tried that, but couldn&#39;t get the threads to block. Will try again. But thank you."}, {"owner": {"reputation": 31, "user_id": 10527854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571ddb27d943648fffc8264b7b29cfa2?s=128&d=identicon&r=PG&f=1", "display_name": "GDogg", "link": "https://stackoverflow.com/users/10527854/gdogg"}, "reply_to_user": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1547675227, "post_id": 54225041, "comment_id": 95277664, "body": "@Imago Yeah, good luck. I couldn&#39;t get condition variables to work on one of my personal projects, probably a deadlock was occurring somewhere during creation."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1547731289, "post_id": 54225041, "comment_id": 95298196, "body": "I appended my try using pthread_cond_wait, however my output is still bad. Do you know how I could fix it?"}, {"owner": {"reputation": 31, "user_id": 10527854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571ddb27d943648fffc8264b7b29cfa2?s=128&d=identicon&r=PG&f=1", "display_name": "GDogg", "link": "https://stackoverflow.com/users/10527854/gdogg"}, "reply_to_user": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1547760893, "post_id": 54225041, "comment_id": 95313760, "body": "You signal once to wake up a single thread. The single thread wakes up and goes out of scope, the rest of the threads are just waiting. Add a pthread_cond_signal(&amp;cv); at the end of the handler method."}], "tags": [], "owner": {"reputation": 31, "user_id": 10527854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571ddb27d943648fffc8264b7b29cfa2?s=128&d=identicon&r=PG&f=1", "display_name": "GDogg", "link": "https://stackoverflow.com/users/10527854/gdogg"}, "is_accepted": false, "score": 2, "last_activity_date": 1547781445, "last_edit_date": 1547781445, "creation_date": 1547671295, "answer_id": 54225041, "question_id": 54224992, "link": "https://stackoverflow.com/questions/54224992/can-i-signal-multiple-threads-simultaneously-with-pthread-cond-wait/54225041#54225041", "title": "Can I signal multiple threads simultaneously with pthread_cond_wait(,)?", "body": "<p>use <code>broadcast()</code>?</p>\n\n<p><a href=\"http://pubs.opengroup.org/onlinepubs/009696699/functions/pthread_cond_broadcast.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/009696699/functions/pthread_cond_broadcast.html</a></p>\n\n<p>The <code>pthread_cond_broadcast()</code> function shall unblock all threads currently blocked on the specified condition variable <code>cond</code>.</p>\n\n<p>The <code>pthread_cond_signal()</code> function shall unblock at least one of the threads that are blocked on the specified condition variable <code>cond</code> (if any threads are blocked on <code>cond</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1547671580, "post_id": 54225094, "comment_id": 95276029, "body": "Calling <code>pthread_cond_wait</code> unconditionally is almost always an error. Your <code>thread</code> function acquires, but does not release, the mutex. And calling <code>pthread_cond_wait</code> exactly once is almost always an error because, at minimum, it doesn&#39;t handle a spurious wakeup. Is <code>footprint</code> protected by the mutex or not? If so, <code>main</code> is broken. If not, what&#39;s the predicate?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1547671706, "post_id": 54225094, "comment_id": 95276082, "body": "It&#39;s posted as an example to someone who doesn&#39;t know how to use a condition variable properly, and it misuses condition variables fundamentally in at least three ways."}], "tags": [], "owner": {"reputation": 7, "user_id": 10924590, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n01uB3opHbA/AAAAAAAAAAI/AAAAAAAAA9M/OpTYwSL2jAw/photo.jpg?sz=128", "display_name": "\u0415\u0440\u0438\u043a \u0441\u043d\u0430\u0458\u043f\u0435\u0440", "link": "https://stackoverflow.com/users/10924590/%d0%95%d1%80%d0%b8%d0%ba-%d1%81%d0%bd%d0%b0%d1%98%d0%bf%d0%b5%d1%80"}, "is_accepted": false, "score": -2, "last_activity_date": 1547671539, "creation_date": 1547671539, "answer_id": 54225094, "question_id": 54224992, "link": "https://stackoverflow.com/questions/54224992/can-i-signal-multiple-threads-simultaneously-with-pthread-cond-wait/54225094#54225094", "title": "Can I signal multiple threads simultaneously with pthread_cond_wait(,)?", "body": "<p>Try posting the matching remove_from_buffer code.</p>\n\n<p>Better yet, Short, Self Contained, Correct Example\nMake a short main() with two threads.\nOne thread adds to the buffer at random intervals.\nThe other thread removes from the buffer at random intervals.</p>\n\n<p><em>Example</em></p>\n\n<blockquote>\n  <p>CELEBP22</p>\n</blockquote>\n\n<pre><code>/* CELEBP22 */                                   \n#define _OPEN_THREADS                                                           \n#include &lt;pthread.h&gt;                                                            \n#include &lt;stdio.h&gt;                                                              \n#include &lt;time.h&gt;                                                               \n#include &lt;unistd.h&gt;                                                             \n\npthread_cond_t cond;                                                            \npthread_mutex_t mutex;                                                          \n\nint footprint = 0;                                                              \n\nvoid *thread(void *arg) {                                                       \n  time_t T;                                                                     \n\n  if (pthread_mutex_lock(&amp;mutex) != 0) {                                        \n    perror(\"pthread_mutex_lock() error\");                                       \n    exit(6);                                                                    \n  }                                                                             \n  time(&amp;T);                                                                     \n  printf(\"starting wait at %s\", ctime(&amp;T));                                     \n  footprint++;                                                                  \n\n  if (pthread_cond_wait(&amp;cond, &amp;mutex) != 0) {                                  \n    perror(\"pthread_cond_timedwait() error\");                                   \n    exit(7);                                                                    \n  }                                                                             \n  time(&amp;T);                                                                     \n  printf(\"wait over at %s\", ctime(&amp;T));                                         \n}                                                                               \n\nmain() {                                                                        \n  pthread_t thid;                                                               \n  time_t T;                                                                     \n  struct timespec t;                                                            \n\n  if (pthread_mutex_init(&amp;mutex, NULL) != 0) {                                  \n    perror(\"pthread_mutex_init() error\");                                       \n    exit(1);                                                                    \n  }                                                                             \n\n  if (pthread_cond_init(&amp;cond, NULL) != 0) {                                    \n    perror(\"pthread_cond_init() error\");                                        \n    exit(2);                                                                    \n  }                                                                             \n\n  if (pthread_create(&amp;thid, NULL, thread, NULL) != 0) {                         \n    perror(\"pthread_create() error\");                                           \n    exit(3);                                                                    \n  }                                                                             \n\n  while (footprint == 0)                                                        \n    sleep(1);                                                                   \n\n  puts(\"IPT is about ready to release the thread\");                             \n  sleep(2);                                                                     \n\n  if (pthread_cond_signal(&amp;cond) != 0) {                                        \n    perror(\"pthread_cond_signal() error\");                                      \n    exit(4);                                                                    \n  }                                                                             \n\n  if (pthread_join(thid, NULL) != 0) {                                          \n    perror(\"pthread_join() error\");                                             \n    exit(5);                                                                    \n  }                                                                             \n}       \n</code></pre>\n\n<p><em>OUTPUT</em>    </p>\n\n<blockquote>\n  <p>starting wait at Fri Jun 16 10:54:06 2006 IPT is about ready to\n  release the thread wait over at Fri Jun 16 10:54:09 2006</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 0, "last_activity_date": 1547804445, "creation_date": 1547804445, "answer_id": 54251193, "question_id": 54224992, "link": "https://stackoverflow.com/questions/54224992/can-i-signal-multiple-threads-simultaneously-with-pthread-cond-wait/54251193#54251193", "title": "Can I signal multiple threads simultaneously with pthread_cond_wait(,)?", "body": "<p>An alternative solution to <code>pthread_cond_broadcast()</code> might be the following.</p>\n\n<p>You define a read-write mutex and lock it in write in the main thread before creating the other threads. The other threads will try to acquire a read-lock but since the main thread have a write-lock they will be blocked.</p>\n\n<p>After the creation of all thread the main-thread releases the lock. All the other threads will be waken up and since many read-locks can coexist the will execute simultaneously (i.e. no one will be locked).</p>\n\n<p>Code might be something like:</p>\n\n<pre><code>pthread_rwlock_t lock; \n\nvoid handler(void *v) {\n    if ((res = pthread_rwlock_rdlock(&amp;lock)!=0)\n    {\n        exit(1);\n    }\n    printf(\"I am first! %d\\n\", v); \n    pthread_rwlock_unlock(&amp;lock);\n}\n\n\nint main() {\n    pthread_t t[threads];\n    //First acquire the write lock:\n    if ((res = pthread_rwlock_wrlock(&amp;lock)!=0)\n    {\n        exit(1);\n    }        \n    for(int i =0; i &lt; threads; i++)\n    { \n        pthread_create(&amp;t[i], NULL, handler, (void*) i); \n        //it is not clear if you want sleep inside the loop or not\n        // You indented it as if to be inside but not put brackets\n        sleep(2); \n    }\n    pthread_rwlock_unlock(&amp;lock); \n    for(int i =0; i &lt; threads; i++) \n        pthread_join(t[i], NULL);\n    pthread_rwlock_destroy(&amp;lock);\n    return 0; \n}\n</code></pre>\n"}], "owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1460, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1547804445, "creation_date": 1547671058, "last_edit_date": 1547744377, "question_id": 54224992, "link": "https://stackoverflow.com/questions/54224992/can-i-signal-multiple-threads-simultaneously-with-pthread-cond-wait", "title": "Can I signal multiple threads simultaneously with pthread_cond_wait(,)?", "body": "<p>I am writing various code snippets and see what happens. The code below was intended to delay all threads until all reached a certain point in the code and then make each print a distinctive number. Since the threads all do that, the numbers should occur in a random order.</p>\n\n<p>My current problem is that I keep they threads busy waiting. If the number of threads gets big, the program slows down significantly. </p>\n\n<p>I would like to change that by using signals, I found <code>pthread_cond_wait()</code> for that, however I don't see how one would use that to signal all threads that they would please wake up.</p>\n\n<pre><code>#include &lt;pthread.h&gt; \n#include &lt;stdio.h&gt; \n#include &lt;unistd.h&gt; \n\n#define threads 10\n\nint counter=0; \npthread_mutex_t lock; \n\nvoid handler(void *v) {\n\n    pthread_mutex_lock(&amp;lock);  \n    counter++;\n    printf(\"%d\\n\", counter); \n    pthread_mutex_unlock(&amp;lock);   \n    while(counter != threads); // busy waiting\n\n    printf(\"I am first! %d\\n\", v); \n\n}\n\n\nint main() {\n\n    pthread_t t[threads]; \n    for(int i =0; i &lt; threads; i++) {       \n    pthread_create(&amp;t[i], NULL, handler, (void*) i); \n    }\n    for(int i =0; i &lt; threads; i++) {       \n    pthread_join(t[i], NULL); \n    }\n\n    return 0; \n}\n</code></pre>\n\n<p>EDIT: I changed the code to the following, however, it still does not work :/</p>\n\n<pre><code>pthread_mutex_t lock; \npthread_cond_t cv; \n\nvoid handler(void *v) {\n    pthread_mutex_lock(&amp;lock);\n    pthread_cond_wait(&amp;cv, &amp;lock);\n    printf(\"I am first! %d\\n\", v); \n    pthread_mutex_unlock(&amp;lock);\n}\n\n\nint main() {\n    pthread_t t[threads]; \n    for(int i =0; i &lt; threads; i++) \n        pthread_create(&amp;t[i], NULL, handler, (void*) i); \n        sleep(2); \n    pthread_cond_signal(&amp;cv); \n    for(int i =0; i &lt; threads; i++) \n        pthread_join(t[i], NULL); \n    return 0; \n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1547671005, "post_id": 54224956, "comment_id": 95275787, "body": "<code>*str1</code> is the first <code>char</code> of the array pointed to by that pointer, it&#39;s not a <code>char**</code>. This compares the first character of the strings, which both contain the same thing. You may have been thinking of <code>if(&amp;str1 == &amp;str2)</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1547671025, "post_id": 54224956, "comment_id": 95275801, "body": "Because both are <code>*(char*)&#39;H&#39;</code>. Which is not making any sense, yet the same."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1547671122, "post_id": 54224956, "comment_id": 95275836, "body": "@EugeneSh. No they aren&#39;t. They&#39;re both <code>&#39;H&#39;</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547671157, "post_id": 54224956, "comment_id": 95275850, "body": "@Barmar <code>*strx</code> are <code>&#39;H&#39;</code>. <code>**strx</code> are not."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1547671193, "post_id": 54224956, "comment_id": 95275863, "body": "But <code>**strx</code> doesn&#39;t appear anywhere in the code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547671209, "post_id": 54224956, "comment_id": 95275865, "body": "@Barmar Then I guess it is a typo, but a consistent one. Given the title, it is even more confusing."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1547671217, "post_id": 54224956, "comment_id": 95275869, "body": "@Barmar no only in the question, which is right the code or the question? It&#39;s tricky."}], "answers": [{"tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": false, "score": 4, "last_activity_date": 1547671086, "creation_date": 1547671086, "answer_id": 54224998, "question_id": 54224956, "link": "https://stackoverflow.com/questions/54224956/why-do-char-and-char-have-the-same-value/54224998#54224998", "title": "Why do char * and char ** have the same value?", "body": "<p><code>str1</code> points to \"Hey, you\".</p>\n\n<p><code>str2</code> points to \"Hey! you\"</p>\n\n<p><code>*str1</code> is the <code>char</code> <em>at that address</em>. Which is essentially the first letter of the string: 'H'.  The first letter of str2 is also 'H'.  Hence <code>(*str1 == *str2)</code> is a true expression because ('H' == 'H')</p>\n\n<p>To compare two strings:</p>\n\n<p><code>strcmp(str1, str2)</code> - returns 0 if the same contents, non-zero otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 5, "last_activity_date": 1547671399, "last_edit_date": 1547671399, "creation_date": 1547671095, "answer_id": 54224999, "question_id": 54224956, "link": "https://stackoverflow.com/questions/54224956/why-do-char-and-char-have-the-same-value/54224999#54224999", "title": "Why do char * and char ** have the same value?", "body": "<p>Nowhere in your code do you have <code>**str1 and **str2</code>. I guess you are asking why is this true <code>if (*str1 == *str2)</code>? That code tests the <em>character</em> pointed to by <code>str1</code> and <code>str2</code>. Since that's is <code>'H'</code> in both cases the expression evaluates to true.</p>\n\n<p>If you want to compare C style strings you use <code>strcmp</code> which returns zero if two strings are equal.</p>\n\n<pre><code>if (strcmp(str1, str2) == 0)\n{\n    printf (\"HoHoHo!\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1547673459, "creation_date": 1547673459, "answer_id": 54225514, "question_id": 54224956, "link": "https://stackoverflow.com/questions/54224956/why-do-char-and-char-have-the-same-value/54225514#54225514", "title": "Why do char * and char ** have the same value?", "body": "<p>the <code>*</code> before the symbol means something completely different in the declaration and in the function body.</p>\n\n<p><code>int *x;</code>  - declares the pointer to the <code>int</code> object</p>\n\n<p><code>y = *x;</code> - the <code>*</code> dereferences the pointer <code>x</code> it is the opposite to its meaning in the declaration. It takes out one level of indirection, when in the declaration it adds one level. </p>\n\n<p>I think that is reason of your confusion.</p>\n\n<p>in your example <code>if (*str1 == *str2)</code> the <code>*</code> \"removes\" indirection and the result is the char itself (not the pointer to pointer)</p>\n"}], "owner": {"reputation": 29, "user_id": 7877749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb76211e915d41f2f71a7aa5785ffce?s=128&d=identicon&r=PG&f=1", "display_name": "MMtn", "link": "https://stackoverflow.com/users/7877749/mmtn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1547673459, "creation_date": 1547670895, "last_edit_date": 1547673163, "question_id": 54224956, "link": "https://stackoverflow.com/questions/54224956/why-do-char-and-char-have-the-same-value", "title": "Why do char * and char ** have the same value?", "body": "<p>I have written this code which is simple, \nSo what I do not understand is why <code>**str1</code> and <code>**str2</code> are the same?   </p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    char *str1 = \"Hey, you\";\n    char *str2 = malloc(11);\n    strcpy(str2, \"Hey! You\");\n\n    if (*str1 == *str2) {\n        printf (\"HoHoHo!\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1547669799, "post_id": 54224658, "comment_id": 95275206, "body": "Dynamic memory allocation."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1547670051, "post_id": 54224658, "comment_id": 95275345, "body": "If you haven&#39;t yet used pointers (comment below) you can use the same length for each and just leave the excess unused. <code>char arr[10][MAXLENG+1] = {0};</code>"}, {"owner": {"reputation": 53, "user_id": 10620363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1872867342750737/picture?type=large", "display_name": "Lidor Cohen", "link": "https://stackoverflow.com/users/10620363/lidor-cohen"}, "edited": false, "score": 0, "creation_date": 1547670274, "post_id": 54224658, "comment_id": 95275455, "body": "Yes that is actually really smart! but how do I write it? like how do I remove those excess empty (or 0) &quot;slots&quot; ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547670588, "post_id": 54224658, "comment_id": 95275598, "body": "You don&#39;t: you just leave the memory unused after the <code>&#39;\\0&#39;</code> string terminator at the end of each name."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547682031, "post_id": 54224658, "comment_id": 95280078, "body": "A 2D array requires <i>both</i> indexes be specified. That can be provided through an initializer (e.g. <code>char array[][10] = { &quot;my&quot;, &quot;dog&quot;, &quot;has&quot;, &quot;fleas&quot; };</code> or by explicit use of an integer constant. (e.g. <code>char array[10][10];</code>). Regardless which you use, the number of characters (columns) must be specified. (there are also uses of <code>&#39;*&#39;</code> specified in the C-standard for parameters not relevant here). Otherwise you will dynamically allocate memory - which results in a usable block of memory that can be indexed as a 2D array, but is not a technical &#39;array&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 310, "user_id": 5666808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a2fd91126cff4d5a3cd36caa2c042e?s=128&d=identicon&r=PG&f=1", "display_name": "serpixo", "link": "https://stackoverflow.com/users/5666808/serpixo"}, "is_accepted": false, "score": 1, "last_activity_date": 1547671158, "creation_date": 1547671158, "answer_id": 54225007, "question_id": 54224658, "link": "https://stackoverflow.com/questions/54224658/c-can-i-make-a-2d-array-without-specifying-the-size-of-each-slot/54225007#54225007", "title": "C - Can I make a 2d array without specifying the size of each slot", "body": "<p>If you haven't learned about pointers then the easiest method is Weather Vane's recommendation to decide on a maximum length for the name and use that for every subarray in your 2d array.</p>\n\n<p>You do not need to \"remove those excess empty (or 0) 'slots' \" because when you write a string in c, or when you are using scanf or printf with strings, the strings are null-terminated.   This means when you put the name into the subarray, the name will probably already have a null termination (a value of 0) to signify the end of the string.  Every value after that null termination is ignored when working with functions that deal with null-terminated strings.</p>\n\n<p>For example.  </p>\n\n<pre><code>char name[] = \"Bob\";\n</code></pre>\n\n<p>is actually equivalent to doing either of these:</p>\n\n<pre><code>char name[] = { 'B', 'o', 'b', '\\0'};  //'\\0' is a null termination\nchar name[] = {0x42, 0x6F, 0x62, 0x0}; // ascii hex codes, '\\0' translates to 0x0\n</code></pre>\n\n<p>(it doesn't matter how big name[] is if the string is null-terminated and the functions you are using know that).\nYou can manually insert a null termination if for some reason when you put in the name it doesn't already have it.</p>\n"}], "owner": {"reputation": 53, "user_id": 10620363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1872867342750737/picture?type=large", "display_name": "Lidor Cohen", "link": "https://stackoverflow.com/users/10620363/lidor-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547671158, "creation_date": 1547669644, "question_id": 54224658, "link": "https://stackoverflow.com/questions/54224658/c-can-i-make-a-2d-array-without-specifying-the-size-of-each-slot", "title": "C - Can I make a 2d array without specifying the size of each slot", "body": "<p>In my homework, I have been asked to write a program and a part of it was to make a 2d array and get 10 names into it.\nNow they didn't specify the size of each name, now my question is how do I make a 2d array without specifying each name size?\n<code>char arr[10][?] = {0};</code></p>\n"}, {"tags": ["c", "pointers", "types", "casting", "void-pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1547667523, "post_id": 54224140, "comment_id": 95274182, "body": "No, it is not necessary. Any object pointer can be silently converted back and forth to and from <code>void*</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1547668633, "post_id": 54224140, "comment_id": 95274691, "body": "@EugeneSh. Perhaps not always silently. <code>void my_func(int a, void *b); int main(void) {   const char *x;   my_func(1,x); }</code> --&gt; &quot;warning: passing argument 2 of &#39;my_func&#39; discards &#39;const&#39; qualifier from pointer target type [-Wdiscarded-qualifiers]&quot;  Yet agree in this case, no cast needed."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1547674239, "post_id": 54224140, "comment_id": 95277246, "body": "Specially when gcc flag <code>-pendantic</code> is used .  Compilation command: <code>gcc -Wall -pendantic main.c -o main</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1547667682, "post_id": 54224188, "comment_id": 95274252, "body": "No warnings should be ever produced without the cast."}], "tags": [], "owner": {"reputation": 1033, "user_id": 4386974, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh3.googleusercontent.com/-zWto43mK2A8/AAAAAAAAAAI/AAAAAAAAAuo/4oNNcjf4kmI/photo.jpg?sz=128", "display_name": "markzz", "link": "https://stackoverflow.com/users/4386974/markzz"}, "is_accepted": false, "score": 1, "last_activity_date": 1547667852, "last_edit_date": 1547667852, "creation_date": 1547667656, "answer_id": 54224188, "question_id": 54224140, "link": "https://stackoverflow.com/questions/54224140/typecast-to-void-when-passing-pointer-to-object/54224188#54224188", "title": "typecast to (void *) when passing pointer to object", "body": "<p>No, it is not required, it just makes the code clearer on what exactly is being passed to the function.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 2, "last_activity_date": 1547668044, "last_edit_date": 1547668044, "creation_date": 1547667668, "answer_id": 54224198, "question_id": 54224140, "link": "https://stackoverflow.com/questions/54224140/typecast-to-void-when-passing-pointer-to-object/54224198#54224198", "title": "typecast to (void *) when passing pointer to object", "body": "<p>you do not have to with some exceptions as you may get the warning if the object which reference you pass to the function is <code>volatile</code> or <code>const</code> - generally has different attribute.</p>\n\n<pre><code>void ee(void *q)\n{\n    pritntf(\"%p\", q);\n}\n\nvolatile int g;\nconst int f;\n\nint main()\n{\n\n    ee(&amp;g);\n    ee(&amp;f);\n}\n</code></pre>\n\n<p>gives this warnings:</p>\n\n<pre><code>&lt;source&gt;: In function 'main':\n\n&lt;source&gt;:17:8: warning: passing argument 1 of 'ee' discards 'volatile' qualifier from pointer target type [-Wdiscarded-qualifiers]\n\n     ee(&amp;g);\n\n        ^~\n\n&lt;source&gt;:6:15: note: expected 'void *' but argument is of type 'volatile int *'\n\n void ee(void *q)\n\n         ~~~~~~^\n\n&lt;source&gt;:18:8: warning: passing argument 1 of 'ee' discards 'const' qualifier from pointer target type [-Wdiscarded-qualifiers]\n\n     ee(&amp;f);\n\n        ^~\n\n&lt;source&gt;:6:15: note: expected 'void *' but argument is of type 'const int *'\n\n void ee(void *q)\n\n         ~~~~~~^\n\nCompiler returned: 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547667861, "post_id": 54224206, "comment_id": 95274328, "body": "the is no conversion on any modern system (except the 8 bits systems with named address spaces or far pointers). The times of the"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547668003, "post_id": 54224206, "comment_id": 95274393, "body": "@P__J__ &quot;Conversion&quot; is not a system specific thing, but a term that the standard is using."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547668116, "post_id": 54224206, "comment_id": 95274441, "body": "IMO it is wrong - the word cast should be used. Conversion and cast mean something different."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547668222, "post_id": 54224206, "comment_id": 95274487, "body": "Casting is the operation which is performing conversion - <i>Preceding an expression by a parenthesized type name converts the value of the expression to the named type. This construction is called a cast.</i> - <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.4p5\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.4p5</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1547668281, "post_id": 54224206, "comment_id": 95274514, "body": "@P__J__ Referencing your answer, that has nothing to do with <code>void *</code> and everything to do with qualifiers.  You&#39;ll get the same if you pass a <code>const int *</code> when a <code>int *</code> is expected."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547668463, "post_id": 54224206, "comment_id": 95274615, "body": "Yes - but from the practical point of view,, it does not matter. It is considered a good practice (and most companies do) to treat warnings as errors. So if someone will follow your advice - the code want compile."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1547668638, "last_edit_date": 1547668638, "creation_date": 1547667720, "answer_id": 54224206, "question_id": 54224140, "link": "https://stackoverflow.com/questions/54224140/typecast-to-void-when-passing-pointer-to-object/54224206#54224206", "title": "typecast to (void *) when passing pointer to object", "body": "<p>A pointer to any type may be freely converted to or from a <code>void *</code> without a cast.</p>\n\n<p>Section 6.3.2.3p1 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> states:</p>\n\n<blockquote>\n  <p>A pointer to void may be converted to or from a pointer to any object\n  type.  A pointer to any object  type  may  be  converted  to  a \n  pointer  to void and  back  again;  the  result  shall compare equal\n  to the original pointer.</p>\n</blockquote>\n\n<p>The only time a cast is needed is if you pass a pointer to a variadic function like <code>printf</code> where an implicit conversion can't occur, since it won't know what the exact type being passed in is.</p>\n\n<p>Note that, as with any pointer type, you can't \"remove\" a qualifier such as <code>const</code> when passing to a function without a cast.  Sections 6.3.2.3p2 states:</p>\n\n<blockquote>\n  <p>For any  qualifier <em>q</em>, a pointer  to  a  non-<em>q</em>-qualified  type  may  be  converted  to  a  pointer  to the <em>q</em>-qualified version of the type; the values stored in the original and converted pointers shall compare equal.</p>\n</blockquote>\n"}], "owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 54224198, "answer_count": 3, "score": 4, "last_activity_date": 1547669054, "creation_date": 1547667433, "last_edit_date": 1547669054, "question_id": 54224140, "link": "https://stackoverflow.com/questions/54224140/typecast-to-void-when-passing-pointer-to-object", "title": "typecast to (void *) when passing pointer to object", "body": "<p>Consider the following snippet:</p>\n\n<pre><code>void my_func(int a, void *b);\n...\n\nstruct my_struct s = { };\nmy_func(10, (void *)&amp;s);\n</code></pre>\n\n<p>Is it necessary to typecast to <code>(void *)</code> when passing <code>&amp;s</code> to the function?</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1547666759, "post_id": 54223966, "comment_id": 95273822, "body": "You could pass <code>i</code> to the recursive call and start from it maybe."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547666992, "post_id": 54223966, "comment_id": 95273933, "body": "To directly answer your question - you can make it <code>static</code>. But I think the real answer would be to fix you algorithm to eliminate the need in this workaround.."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1547667766, "post_id": 54223966, "comment_id": 95274285, "body": "Normally, a recursive function has arguments to help it make progress towards the solution. No arguments means using global variables to control progress. Your function, therefore, is misdesigned. You should have one or more base cases that can be resolved without recursion, plus one or more other cases that invoke the function with arguments to make progress towards one of the base cases. For example \u2014 Ackermann&#39;s Function: <code>uint64_t ackermann(uint64_t m, uint64_t n) { if (m == 0) return n + 1; else if (n == 0) return(ackermann(m-1, 1)); else return(ackermann(m-1, ackermann(m, n-1))); }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1547667455, "creation_date": 1547667455, "answer_id": 54224143, "question_id": 54223966, "link": "https://stackoverflow.com/questions/54223966/recursion-how-do-i-keep-a-changing-variable-in-a-for-loop-from-changing-during/54224143#54224143", "title": "Recursion: How do I keep a changing variable in a for-loop from changing during recursion?", "body": "<p>It almost sounds like you might want to move the <code>i</code> loop out of <code>function</code>, and pass it in.</p>\n\n<p>E.g., if you had something like:</p>\n\n<pre><code>void someOtherFunction()\n{\n    function();\n}\nvoid function(){\n  int x = 1;\n  for (int i = 0; i &lt; 10; i++){\n     //Something happens here...\n     for (int j = 0; j &lt; 10; j++){\n        //Something happens here...\n        array[0][x] += i;\n        //Recursion\n        function();\n     }\n  }\n}\n</code></pre>\n\n<p>You might change it to:</p>\n\n<pre><code>void someOtherFunction()\n{\n    for (int i=0; i&lt;10; ++i)\n        function(i);\n}\nvoid function(int i){\n  int x = 1;\n //Something happens here...\n for (int j = 0; j &lt; 10; j++){\n    //Something happens here...\n    array[0][x] += i; \n    //Recursion\n    function(i);\n  }\n}\n</code></pre>\n\n<p>with perhaps a better, more descriptive name for <code>i</code> in this case.</p>\n"}], "owner": {"reputation": 35, "user_id": 10160857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc645333c23bd37f74baf452a968c29?s=128&d=identicon&r=PG&f=1", "display_name": "nemes", "link": "https://stackoverflow.com/users/10160857/nemes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 54224143, "answer_count": 1, "score": 1, "last_activity_date": 1547668027, "creation_date": 1547666674, "last_edit_date": 1547668027, "question_id": 54223966, "link": "https://stackoverflow.com/questions/54223966/recursion-how-do-i-keep-a-changing-variable-in-a-for-loop-from-changing-during", "title": "Recursion: How do I keep a changing variable in a for-loop from changing during recursion?", "body": "<p>I have a for-loop within a recursive function. The index i in my code changes every time a for-loop completes, however it resets when the recursion starts.\nIs it possible to keep the value saved via another variable or anything of that sort? I need a variable that keeps the 'i' value of the first recursion step (or rather the 'i' value that I have before any recursion starts). \nMy actual code seems rather complicated so I just pasted a sample code to explain my problem.</p>\n\n<p>I have tried using other variables, also global variables. Unfortunately they also change whenever the recursion happens because I need to save the 'i' value to them somehow.</p>\n\n<pre><code>   int array[2][10];\n   void function(){\n      int x = 1;\n      for (int i = 0; i &lt; 10; i++){\n         //Something happens here... (The base cases are in here)\n         for (int j = 0; j &lt; 10; j++){\n            //Something happens here...(More base cases are in here)\n            array[0][x] += i; //When function() starts, i is 0. I need it to \n                              //remain 0, while it\n                              //runs through all the recursion steps (limited \n                              //by a recursion counter).\n                              //After the recursion returns to the first level, \n                              //the for loop will continue.\n                              //'i' will be 1 and then I need this value to \n                              //stay the same throughout all the\n                              //recursion steps once again. How do I do that?\n            //Recursion\n            function();\n         }\n      }\n   }\n</code></pre>\n\n<p>I wanted 'i' to stay the same but instead it is reset everytime the recursion restarts the for-loop.</p>\n"}, {"tags": ["c", "endianness"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1547664654, "post_id": 54223407, "comment_id": 95272842, "body": "C++ variables that you operate on are always going to behave as big endian. If you do bit manipulation on a <code>int</code> it is going to be the same result regardless of whether the underlying architecture is big or little (or even mixed) endian. Only when you export/import data from/to byte arrays outside your program do you need to care."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1547664685, "post_id": 54223407, "comment_id": 95272862, "body": "I don&#39;t think such <code>#ifdef</code> is necessary at all. The author of that code probably missed to use the <a href=\"https://stackoverflow.com/questions/36924598/understanding-htonl-and-ntohl\">htonx()/ntohx()</a> functions to deal with the endianess in a transparent way in the c / c++ code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1547664837, "post_id": 54223407, "comment_id": 95272933, "body": "this question is about C++, not C.  Please remove the &#39;c&#39; tag"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1547664902, "post_id": 54223407, "comment_id": 95272971, "body": "@user3629249 How is that question specific for c++ only?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1547664998, "post_id": 54223407, "comment_id": 95273026, "body": "The name/title of the question.  The first sentence of the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547665080, "post_id": 54223407, "comment_id": 95273061, "body": "[c] tagged removed as OP&#39;s stated interest here and history are only about C++.  The rules about bit fields tend to be arcane - so  focusing on  one language adds clarity. -- Oh well, OP has edited and  narrowed to C only now."}, {"owner": {"reputation": 4395, "user_id": 316487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XdPYQ.jpg?s=128&g=1", "display_name": "bleater", "link": "https://stackoverflow.com/users/316487/bleater"}, "edited": false, "score": 0, "creation_date": 1547695458, "post_id": 54223407, "comment_id": 95282637, "body": "Bit fields are ANSI C and there is nothing in the question that is C++ specific."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1547664848, "post_id": 54223493, "comment_id": 95272941, "body": "I don&#39;t see the benefit doing so at all tho. There already (POSIX) functions available, to deal with the network byte order correctly."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1547664928, "post_id": 54223493, "comment_id": 95272990, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6  This is dealing with bit order, not byte order.  I&#39;m not sure if OP&#39;s code comes from a system header file, but the definition of <code>struct iphdr</code> in /usr/include/netinet/ip.h does the same thing."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1547666045, "post_id": 54223493, "comment_id": 95273505, "body": "Yeah, I think the only reasonable interpretation is that the original coder wanted to ensure that the order of the bits would be the same regardless of endian-ness."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1547665491, "last_edit_date": 1547665491, "creation_date": 1547664678, "answer_id": 54223493, "question_id": 54223407, "link": "https://stackoverflow.com/questions/54223407/bit-field-extract-with-struct-and-endianness-in-c/54223493#54223493", "title": "Bit field extract with struct and endianness in C", "body": "<p>Endianness can also affect bits, not just bytes, however the only time you typically see the effects is in a bitfield.  This is one reason why the ordering of bitfields in a struct, and which byte offsets they live at, is implementation defined.</p>\n\n<p>Looking at this definition, it seems to imply that for the given implementation that bitfields are physically placed in order on big endian systems and in the reverse order for each byte on a little endian system.  </p>\n\n<p>In particular, the first 4 bitfields occupy 8 bits and the next 2 bitfields occupy 8 bits.  So in the case of little endian the order of the first 4 bitfields are reversed with each other and the last 2 bitfields are reversed with each other.</p>\n\n<p>Code like this is common in system header files.  For example, /usr/include/netinet/in.h on Linux contains the following struct to model an IP header:</p>\n\n<pre><code>struct iphdr\n  {\n#if __BYTE_ORDER == __LITTLE_ENDIAN\n    unsigned int ihl:4;\n    unsigned int version:4;\n#elif __BYTE_ORDER == __BIG_ENDIAN\n    unsigned int version:4;\n    unsigned int ihl:4;\n#else\n# error \"Please fix &lt;bits/endian.h&gt;\"\n#endif\n    u_int8_t tos;\n    u_int16_t tot_len;\n    u_int16_t id;\n    u_int16_t frag_off;\n    u_int8_t ttl;\n    u_int8_t protocol;\n    u_int16_t check;\n    u_int32_t saddr;\n    u_int32_t daddr;\n    /*The options start here. */\n  };\n</code></pre>\n\n<p>Presumably, the idea is that a buffer containing a raw network packet can use <code>memcpy</code> to copy the bytes into an instance of this struct (or just have a pointer to this struct point to the buffer, if it's aligned correctly) to simplify serialization / deserialization.  You'll still need to call the <code>htonx</code>/<code>ntohx</code> family of function to properly read integer fields occupying more than one byte however.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1547698176, "creation_date": 1547698176, "answer_id": 54228879, "question_id": 54223407, "link": "https://stackoverflow.com/questions/54223407/bit-field-extract-with-struct-and-endianness-in-c/54228879#54228879", "title": "Bit field extract with struct and endianness in C", "body": "<p>On top of the endianness issues, you have no way of knowing where each bitfield will be.</p>\n\n<p>Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p11\" rel=\"nofollow noreferrer\"><strong>6.7.2 Type specifiers</strong>, paragraph 11 of the C Standard</a>:</p>\n\n<blockquote>\n  <p>An implementation may allocate any addressable storage unit large enough to hold a bit- field. If enough space remains, a bit-field that immediately follows another bit-field in a structure shall be packed into adjacent bits of the same unit. If insufficient space remains, <strong>whether a bit-field that does not fit is put into the next unit or overlaps adjacent units is implementation-defined. The order of allocation of bit-fields within a unit (high-order to low-order or low-order to high-order) is implementation-defined. The alignment of the addressable storage unit is unspecified</strong>.</p>\n</blockquote>\n\n<p>If you need to know exactly where a bit is in your data, use of bitfields is <strong>entirely</strong> non-portable, even between different compilers on the same platform.</p>\n"}], "owner": {"reputation": 631, "user_id": 2057014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1958eadc7b381d4e81e174be61cfd3e?s=128&d=identicon&r=PG", "display_name": "getsoubl", "link": "https://stackoverflow.com/users/2057014/getsoubl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 54223493, "answer_count": 2, "score": 0, "last_activity_date": 1547698176, "creation_date": 1547664231, "last_edit_date": 1547695190, "question_id": 54223407, "link": "https://stackoverflow.com/questions/54223407/bit-field-extract-with-struct-and-endianness-in-c", "title": "Bit field extract with struct and endianness in C", "body": "<p>I  need to clarify how the endianness affects the bit extract field in a C struct.</p>\n\n<p>The following struct declares the rtp header:</p>\n\n<pre><code>typedef struct {\n #if BYTE_ORDER == BIG_ENDIAN\n    unsigned int version:2; /* protocol version */\n    unsigned int p:1;       /* padding flag */\n    unsigned int x:1;       /* header extension flag */\n    unsigned int cc:4;      /* CSRC count */\n    unsigned int m:1;       /* marker bit */\n    unsigned int pt:7;      /* payload type */\n#else\n   unsigned int cc:4;      /* CSRC count */\n   unsigned int x:1;       /* header extension flag */\n   unsigned int p:1;       /* padding flag */\n   unsigned int version:2; /* protocol version */\n   unsigned int pt:7;      /* payload type */\n   unsigned int m:1;       /* marker bit */\n#endif\n  unsigned int seq:16;    /* sequence number */\n  uint32_t ts;        /* timestamp */\n  uint32_t ssrc;      /* synchronization source */\n  uint32_t csrc[0];       /* optional CSRC list */\n} rtp_hdr_t;\n</code></pre>\n\n<p>Due to the fact that endianess affect the byte ordering in memory, I hardly undestand why the struct is defined in this way in little endian architecture</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "lcd", "state-machine"], "comments": [{"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 1, "creation_date": 1547662671, "post_id": 54222945, "comment_id": 95271936, "body": "another way to do state machines is to use a switch with the different states e.g. <code>switch (mystate) { case 1: if (somecond) mystate=2; break; ... }</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1547664851, "post_id": 54222945, "comment_id": 95272942, "body": "For a state machine with a limited number of states (say:20) and transitions (say:50), it is often simpler to just hardcode the whole thing into a giant <code>switch()</code>"}, {"owner": {"reputation": 45, "user_id": 10446546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9e8309958ecbc6ce7a968179f795fc?s=128&d=identicon&r=PG&f=1", "display_name": "mannen", "link": "https://stackoverflow.com/users/10446546/mannen"}, "edited": false, "score": 0, "creation_date": 1547996984, "post_id": 54222945, "comment_id": 95377438, "body": "thank you for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1547664162, "post_id": 54223041, "comment_id": 95272623, "body": "Gonna drop my two cents here, I think it&#39;s useful to add a bit of explanation. Seeing as OP is possibly newer to C programming, I really doubt they are aware of the uses of the modulus. Maybe a small note as to what (i + 1) % 5 means?"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 4, "last_activity_date": 1547664670, "last_edit_date": 1547664670, "creation_date": 1547662567, "answer_id": 54223041, "question_id": 54222945, "link": "https://stackoverflow.com/questions/54222945/c-programming-for-loop-with-multiple-conditions/54223041#54223041", "title": "c programming for loop with multiple conditions", "body": "<p>Instead of the messy <code>int a</code> etc you can do</p>\n\n<pre><code>menu_statetop[(i + 1) % 5].pText;\nmenu_statetop[(i + 2) % 5].pText;\nmenu_statetop[(i + 3) % 5].pText;\n</code></pre>\n\n<p>and so on.</p>\n\n<p>EDIT:\nThis also takes care of the menu overflow by ensuring it \"wraps\" back to the start. As well as accessing the next menu item(s) with <code>i + 1</code> etc it uses the modulus (or remainder) operator <code>%</code> to achieve this. </p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 10917549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15f81df1e71ed4363b1c1d56e51588f?s=128&d=identicon&r=PG&f=1", "display_name": "The_Average_Engineer", "link": "https://stackoverflow.com/users/10917549/the-average-engineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1547666269, "creation_date": 1547666269, "answer_id": 54223873, "question_id": 54222945, "link": "https://stackoverflow.com/questions/54222945/c-programming-for-loop-with-multiple-conditions/54223873#54223873", "title": "c programming for loop with multiple conditions", "body": "<p>I would just use one single variable to control your for loop increment :</p>\n\n<pre><code>    for (i=0; menu_statetop[i].state; i++)\n</code></pre>\n\n<p>As answered by Weather Vane, you can then handle the array index offset in the body of the for loop. This is much clearer and more robust.</p>\n\n<p>I would also be careful with the variable that you use as a condition for your for loop.\nin you code you use the menu_statetop[i].state variable which seems to be an integer/enum.\nIf there were no \"break;\" in the loop, the for loop would be executed as long as the value contained in menu_statetop[i].state is not equal to 0.</p>\n"}], "owner": {"reputation": 45, "user_id": 10446546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9e8309958ecbc6ce7a968179f795fc?s=128&d=identicon&r=PG&f=1", "display_name": "mannen", "link": "https://stackoverflow.com/users/10446546/mannen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547666269, "creation_date": 1547662201, "last_edit_date": 1547665206, "question_id": 54222945, "link": "https://stackoverflow.com/questions/54222945/c-programming-for-loop-with-multiple-conditions", "title": "c programming for loop with multiple conditions", "body": "<p>I have an foor loop in a finite state machine: </p>\n\n<pre><code>if (nextstate != state)\n{\n    state = nextstate;\n    for (i=0; menu_state[i].state; i++)\n    {\n        if (menu_state[i].state == state)\n        {\n            statetext =  menu_state[i].pText;\n            pStateFunc = menu_state[i].pFunc;\n            break;\n        }\n    }\n\n}\n</code></pre>\n\n<p>The state machine is use for showing an menu on a LCD display. (I have used an example I found online for the state machine and adapted it for my micocontroler system).</p>\n\n<p>Everyting works fine and the menu system works, but I would now like to add the adjacent textlines in the menu (to make it easier to see where you are in the menu). \n(the original menu was for an 1 row display and I have a 5 row display).</p>\n\n<p>So my conclusion is that I need to adapt this for loop. </p>\n\n<p>This is what I came up with:</p>\n\n<pre><code>if (nextstate != state)\n{\n    state = nextstate;\n\n    for (i=0,a=1,b=2,c=3,d=4; menu_statetop[i].state; i++,a++,b++,c++,d++)\n    {\n\n        if (menu_statetop[i].state == state)\n        {\n            statetext=  menu_statetop[i].pText;\n            statetext2=  menu_statetop[a].pText;\n            statetext3=  menu_statetop[b].pText;\n            statetext4=  menu_statetop[c].pText;\n            statetext5=  menu_statetop[d].pText;\n\n            pStateFunc = menu_statetop[i].pFunc;\n            break;\n        }\n    }\n\n}\n</code></pre>\n\n<p>This seems to work more or less... but the problem is the boundary. Because in the look up table there are 5 lines. \nand when the variabels are becoming bigger than this MAX (4) value they are outside valid lookuptable MAX value and shows garbage. </p>\n\n<p>I am trying to find a elegant solution for this. Any ideas?\nI have considered using if statements but all look so...messy...\nbig and clumpsy code...</p>\n\n<p>So what I am trying to achieve is for example when \"a\" becomes 4 it should become 0. and next time the for loop runs it should become 1. \nsame for b, c and d. and they should maintain the same \"distance\" from each other(when b is 2 c should be 3, d should be 4 etc.) </p>\n\n<p>Same idea but oposite for the MIN(0) value. </p>\n\n<p>Anyone have any ideas how to do something like this in a good way?</p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1547662402, "post_id": 54222940, "comment_id": 95271814, "body": "Instead of describing your code, please <i>show</i> it. Try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that you can show us. Also tell us what you have tried, how it worked or didn&#39;t work. And of course, please re-read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 2, "creation_date": 1547662805, "post_id": 54222940, "comment_id": 95271997, "body": "pass a union of the two structs"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1547662920, "post_id": 54222940, "comment_id": 95272049, "body": "Are you trying to emulate inheritance in C?"}, {"owner": {"reputation": 2949, "user_id": 1151746, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb694394b6a57f0036e1f14498158962?s=128&d=identicon&r=PG", "display_name": "Rog Matthews", "link": "https://stackoverflow.com/users/1151746/rog-matthews"}, "reply_to_user": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1547663003, "post_id": 54222940, "comment_id": 95272095, "body": "@Anders Unions are not allowed as per MISRA C."}, {"owner": {"reputation": 2949, "user_id": 1151746, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb694394b6a57f0036e1f14498158962?s=128&d=identicon&r=PG", "display_name": "Rog Matthews", "link": "https://stackoverflow.com/users/1151746/rog-matthews"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1547663081, "post_id": 54222940, "comment_id": 95272145, "body": "@SergeyA I want to have common APIs to avoid duplication of 1000 lines of code"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1547663808, "post_id": 54222940, "comment_id": 95272464, "body": "Look for inspiration into what <a href=\"http://gtk.org/\" rel=\"nofollow noreferrer\">GTK</a> is doing, notably with its <a href=\"https://developer.gnome.org/gobject/stable/index.html\" rel=\"nofollow noreferrer\">GObject</a>s; it probably is not MISRA C compliant, but it could give you some ideas. Are you allowed to use <i>generated</i> C code?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 1, "creation_date": 1547664181, "post_id": 54222940, "comment_id": 95272634, "body": "My impression from the MISRA C guidelines is that what you are wanting to do is not compatible with the guidelines. The purpose of the guidelines is to specify how to write C source code that will probably have fewer defects and be easier to test and to debug. Not sure that what you are wanting to do meets those goals. Your examples seem a bit contrived as I would expect some kind of an indication as to which struct with some kind of a struct id in the layout, usually the first member of the struct."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 2, "creation_date": 1547665008, "post_id": 54222940, "comment_id": 95273030, "body": "This question is really too abstract and broad to provide a specific approach. You need to add more details about the two different types of structs, the APIs, and what makes the APIs similar and different. How the functionality that deals with each of the struct types can be allocated to different source code functions or blocks will be governed by the various similarities and differences as well as the dependencies between the various pieces of functionality and the structs themselves."}, {"owner": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1547665065, "post_id": 54222940, "comment_id": 95273052, "body": "It is not clear to me what you want. Are you say that <code>struct B</code> is a subset of <code>struct A</code>? Or <code>set_b</code> only works with the <code>b</code> field of any structs?"}, {"owner": {"reputation": 2949, "user_id": 1151746, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb694394b6a57f0036e1f14498158962?s=128&d=identicon&r=PG", "display_name": "Rog Matthews", "link": "https://stackoverflow.com/users/1151746/rog-matthews"}, "reply_to_user": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1547665136, "post_id": 54222940, "comment_id": 95273086, "body": "@Amadeus Struct B is a subset but offsets of its members are different"}, {"owner": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1547665236, "post_id": 54222940, "comment_id": 95273141, "body": "@RogMatthews if <code>set_b</code> only works on a specific field, decompose it. <code>void set_b(int, int);</code>, for example, and calls <code>set_b(A.b, 0);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1547663280, "post_id": 54223166, "comment_id": 95272256, "body": "It is a perfect way to make your code undebuggable  and error prone."}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547663492, "post_id": 54223166, "comment_id": 95272345, "body": "That&#39;s a bit use-case dependent, but maybe, yeah."}, {"owner": {"reputation": 2949, "user_id": 1151746, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb694394b6a57f0036e1f14498158962?s=128&d=identicon&r=PG", "display_name": "Rog Matthews", "link": "https://stackoverflow.com/users/1151746/rog-matthews"}, "edited": false, "score": 0, "creation_date": 1547664003, "post_id": 54223166, "comment_id": 95272549, "body": "@CarlNorum Really appreciate you reply but I don&#39;t think this will be appropriate for this specific use case as I have around 1000 Lines of code with 30+ APIs. Debugging will be tough :("}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 2, "last_activity_date": 1547663479, "last_edit_date": 1547663479, "creation_date": 1547663124, "answer_id": 54223166, "question_id": 54222940, "link": "https://stackoverflow.com/questions/54222940/combining-common-api-for-similar-but-different-data-structures-in-c/54223166#54223166", "title": "Combining common API for similar but different data structures in C", "body": "<p>C11 supports type-generic expressions, which should do what you're looking for:</p>\n\n<pre><code>#define Set_b(X, y) _Generic((X), A: Set_b_A,\\\n                                  B: Set_b_B \\\n                            )((X), (y))\n</code></pre>\n\n<p>Then just implement <code>Set_b_A</code> and <code>Set_b_B</code> for the appropriate types.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1547665060, "last_edit_date": 1547665060, "creation_date": 1547664696, "answer_id": 54223500, "question_id": 54222940, "link": "https://stackoverflow.com/questions/54222940/combining-common-api-for-similar-but-different-data-structures-in-c/54223500#54223500", "title": "Combining common API for similar but different data structures in C", "body": "<p>I would do it this way. It is debuggable and does not generate too much code (memcpy will be optimized out from the  actual code on any level of optimization) <a href=\"https://godbolt.org/z/lMShik\" rel=\"nofollow noreferrer\">https://godbolt.org/z/lMShik</a></p>\n\n<p>BTW in this case IMO the unsafe version is same safe as IMO it does break the strict aliasing rules. </p>\n\n<pre><code>typedef enum\n{\n    TYPE_A,\n    TYPE_B,\n    TYPE_C\n}Types;\n\n\nstruct a \n{\n    int a;\n    int b;\n    int c;\n    int d;    \n};\n\nstruct b \n{\n    int a;\n    int b;\n    int c;\n};\n\nstruct c \n{\n    int a;\n    int b;\n};\n\nvoid inline __attribute__((always_inline)) Set_a(void *ptr, Types type, int value)\n{\n    struct a a;\n    struct b b;\n    struct c c;\n\n    switch(type)\n    {\n        case TYPE_A:\n            memcpy(&amp;a, ptr, sizeof(a));\n            a.a = value;\n            memcpy(ptr, &amp;a, sizeof(a));\n            break;\n        case TYPE_B:\n            memcpy(&amp;b, ptr, sizeof(b));\n            b.a = value;\n            memcpy(ptr, &amp;b, sizeof(b));\n            break;\n        case TYPE_C:\n            memcpy(&amp;c, ptr, sizeof(c));\n            c.a = value;\n            memcpy(ptr, &amp;c, sizeof(c));\n            break;\n    }\n}\n\n\nvoid inline __attribute__((always_inline)) Set_a_unsafe(void *ptr, Types type, int value)\n{\n    struct a a;\n    struct b b;\n    struct c c;\n\n    switch(type)\n    {\n        case TYPE_A:\n            ((struct a *)ptr) -&gt; a = value;\n            break;\n        case TYPE_B:\n            ((struct b *)ptr) -&gt; a = value;\n            break;\n        case TYPE_C:\n            ((struct c *)ptr) -&gt; a = value;\n            break;\n    }\n}\n\n    struct a x,y;\n\n\nint main()\n{\n    Set_a(&amp;x, TYPE_A, 45);\n    Set_a_unsafe(&amp;y, TYPE_B, 100);\n\n    printf(\"%d\\n\", x.a);\n    printf(\"%d\\n\", y.a);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "is_accepted": false, "score": 1, "last_activity_date": 1547664734, "creation_date": 1547664734, "answer_id": 54223511, "question_id": 54222940, "link": "https://stackoverflow.com/questions/54222940/combining-common-api-for-similar-but-different-data-structures-in-c/54223511#54223511", "title": "Combining common API for similar but different data structures in C", "body": "<p>You can create an interface. For example,</p>\n\n<pre><code>struct A {};                          // As you have defined                                                               \nvoid set_b_for_A(struct A, int) {}    // function that works with A                                          \n\n// interface                                                                          \nstruct helper {                                                                 \n    void *ptr;                        // pointer to your structs variants (A, ...)                                                         \n    void (*set_b)(struct helper *, int);   // helper to dispatch to correct worker                                          \n};                                                                              \n\n\nvoid set_b_helper_for_A(struct helper *pointer, int i) {   // helper for worker A                            \n    struct A *s = (struct A *) pointer-&gt;ptr;                                    \n    set_b_for_A(*s, i);                                                         \n} \n\nstruct helper helper_A {/* A struct */, set_b_helper_for_A};\n</code></pre>\n\n<p>Now your API</p>\n\n<pre><code>void set_b(struct helper *ptr, int i) {\n     ptr-&gt;set_b(ptr, i);\n}\n</code></pre>\n\n<p>and you call, for example:</p>\n\n<pre><code>set_b(&amp;helper_A, 0);\n</code></pre>\n\n<p>Do the same for others structs</p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 1, "last_activity_date": 1547915927, "last_edit_date": 1547915927, "creation_date": 1547691406, "answer_id": 54228074, "question_id": 54222940, "link": "https://stackoverflow.com/questions/54222940/combining-common-api-for-similar-but-different-data-structures-in-c/54228074#54228074", "title": "Combining common API for similar but different data structures in C", "body": "<p>There are a couple of different alternative approaches that could be used however it depends on what you own and can determine versus what you do not own and can not modify or change. The actual implementation may depend on how often <code>structA</code> is used with the API versus <code>structB</code>. You really do not provide sufficient information for a definitive suggested approach.</p>\n\n<p>It appears that your posting can be restated as follows.</p>\n\n<p>There are two structs, <code>structA</code> and <code>structB</code> which have members in common. These common members store the same type of data and on inspection the entirety of <code>structB</code> is contained in <code>structA</code> as in:</p>\n\n<pre><code>typedef struct {\n    int a;\n    int b;      // beginning of portion that is same as structB below.\n    int c;\n    int d;      // end of portion that is same as structB below.\n    int e;\n} structA;\n\ntypedef struct {\n    int b;       // same type of data as in b member of structA above\n    int c;       // same type of data as in c member of structA above\n    int d;       // same type of data as in d member of structA above\n} structB;\n</code></pre>\n\n<p>For a concrete example, <code>structA</code> describes an object in some 3D space whose location is an x,y,z tuple which is specified in the <code>structA</code> members <code>b</code>, <code>c</code>, and <code>d</code> and <code>structB</code> is used to store a location only as an x,y,z tuple.</p>\n\n<p>You have an API that works with the data in <code>structB</code> and since the same data is in <code>structA</code> you are faced with the problem that you have to have an API composed of a set of functions that is duplicated, one version of the API that takes as an argument <code>structB</code> and the other takes as an argument <code>structA</code>.</p>\n\n<p>To extend our concrete example of the objects in 3D space, you have an API that contains a function <code>translate()</code> which translates coordinates by some distance. Because you have the two different structs according to MISRA C you will need to have two different versions of this function, <code>translate_structA()</code> which takes as an argument a <code>structA</code> and a second one <code>translate_structB()</code> which takes as an argument a <code>structB</code>.</p>\n\n<p>So you are faced with have to write two versions of each function in your API and you do not want to do that.</p>\n\n<p><strong>Alternative 1 - replace cloned members with actual struct</strong></p>\n\n<p>Use good software engineering and rather than having this <code>structB</code> data type in the <code>structA</code> as a cloned set of members, instead replace those cloned members with a <code>structB</code>.</p>\n\n<pre><code>typedef struct {\n    int b;       // same type of data as in b member of structA above\n    int c;       // same type of data as in c member of structA above\n    int d;       // same type of data as in d member of structA above\n} structB;\n\ntypedef struct {\n    int a;\n    structB xyz;    // replace the cloned members with an actual structB\n    int e;\n} structA;\n</code></pre>\n\n<p>Then you write the API that works with a <code>structB</code> only in terms of <code>structB</code>. In those places where you are using a <code>structA</code>, you would just use the <code>xyz</code> member in the function call interface.</p>\n\n<p>The nice thing about this approach is that should additional, new data types be added that require a <code>structB</code>, you just plop in the <code>structB</code> member rather than clone the members and the API using the <code>structB</code> can be used with the new data types.</p>\n\n<p>However in order to take this approach you will need to own the technology and be able to make this kind of change. On the other hand this is the most straightforward and simplest and most readable alternative I can think of. It should also have quite good run time efficiency as well.</p>\n\n<p><strong>A Note About the Next Two Alternatives</strong></p>\n\n<p>Before I go into the next two alternatives, you should consider the basic flaw in both of these.</p>\n\n<p>If the dependency of <code>structA</code> on <code>structB</code> is not specified as a kind of contract by using <code>structB</code> within <code>structA</code>, you introduce a kind of logical or cognitive <a href=\"https://en.wikipedia.org/wiki/Coupling_(computer_programming)\" rel=\"nofollow noreferrer\">intermodule coupling</a> in which you have a common component which is source code itself rather than a software component derived from source code.</p>\n\n<p>Maintenance becomes a hassle because now the two structs must be changed together. And unless the linkage between the two areas is documented in the source code and the struct definitions themselves, a programmer new to the code will probably miss this.</p>\n\n<p>And if new data types that use the <code>structB</code> data are introduced, the cloning step needs to be done again and you are just expanding the surface of complex linkages.</p>\n\n<p><strong>Alternative 2 - marshalling to/from an interface object</strong></p>\n\n<p>If you do not have control over the structs then another alternative is to perform marshalling of data to and from <code>structA</code> into a <code>structB</code> and then write the API in terms of <code>structB</code> only. Then any place where a <code>structA</code> needs to use the API, you would have a marshalling or transformation in which the particular data in <code>structA</code> is picked out to create a temporary <code>structB</code> which is then used with the function. If the function modifies the data in <code>structB</code> then you will need to copy the data from the <code>structB</code> back into the <code>structA</code> before eliminating the temporary.</p>\n\n<p><strong>Alternatively</strong> you could decide to do the API in terms of <code>structA</code> with marshalling in those cases where you want to use a <code>structB</code> with the API. This alternative may be preferable if most of the API uses <code>structA</code> with only a few using <code>structB</code>.</p>\n\n<p>There are a couple of ways to do this approach of marshalling mainly determined by whether the API interfaces will return a changed data object or not.</p>\n\n<p>The first is to have a duplicate set of functions which are called using a <code>structA</code> and this duplicate set of functions handles the marshaling of data between a temporary <code>structB</code> which is then used in a call to the actual API which takes a <code>structB</code>.</p>\n\n<p>So something like:</p>\n\n<pre><code>int funcThing (structB thing);\n\nint funcThing_structA (structA thing) {\n    structB temp = {0};\n    temp.b = thing.b;\n    temp.c = thing.c;\n    temp.d = thing.d;\n    return funcThing (temp);\n}\n</code></pre>\n\n<p>An alternative to the above would be something like:</p>\n\n<pre><code>int funcThing1 (structB thing);\nint funcThing2 (structB thing);\nint funcThing3 (structB thing);\n\nint funcThingSet_structA (structA thing, int (*f)(structB thing)) {\n    structB temp = {0};\n    temp.b = thing.b;\n    temp.c = thing.c;\n    temp.d = thing.d;\n    return f (temp);\n}\n\n// and the above is used like\nstructA thingA;\n//  \u2026  code\ni = funcThingSet_structA (thingA, funcThing1);  // call funcThing1() with the structA data\ni = funcThingSet_structA (thingA, funcThing2);  // call funcThing2() with the structA data\n\ni = funcThingSet_structA (thingA, funcThing3);  // call funcThing3() with the structA data\n</code></pre>\n\n<p>If the functions may change the data then you will need to make sure that <code>structA</code> is updated as in:</p>\n\n<pre><code>int funcThing1 (structB *thing);\nint funcThing2 (structB *thing);\nint funcThing3 (structB *thing);\n\nint funcThingSet_structA (structA *thing, int (*f)(structB *thing)) {\n    structB temp = {0};\n    int iRetVal = 0;\n\n    temp.b = thing-&gt;b;\n    temp.c = thing-&gt;c;\n    temp.d = thing-&gt;d;\n\n    iRetVal = f (&amp;temp);\n\n    thing-&gt;b = temp.b;\n    thing-&gt;c = temp.c;\n    thing-&gt;d = temp.d;\n    return iRetVal;\n}\n\n// and the above is used like\nstructA thingA;\n//  \u2026  code\ni = funcThingSet_structA (&amp;thingA, funcThing1);  // call funcThing1() with the structA data\ni = funcThingSet_structA (&amp;thingA, funcThing2);  // call funcThing2() with the structA data\n\ni = funcThingSet_structA (&amp;thingA, funcThing3);  // call funcThing3() with the structA data\n</code></pre>\n\n<p>You may also have the API in terms of <code>structB</code> and use interface helper functions such as:</p>\n\n<pre><code>structB *AssignAtoB (structB *pB, structA A) {\n    pB-&gt;b = A.b;\n    pB-&gt;c = A.c;\n    pB-&gt;d = A.d;\n    return pB;\n}\n\nstructB ConvertAtoB (structA A) {\n    structB B = {0};\n    B.b = A.b;\n    B.c = A.c;\n    B.d = A.d;\n    return B;\n}\n\nvoid AssignBtoA (structA *pA, structB B) {\n    pA-&gt;b = B.b;\n    pA-&gt;c = B.c;\n    pA-&gt;d = B.d;\n}\n</code></pre>\n\n<p>Then you could do something like:</p>\n\n<pre><code>int funcThing1 (structB thing);\nint funcThing2 (structB thing);\nint funcThing3 (structB thing);\n\n\nstructA aThing;\n//  \u2026. code\n{  // create a local scope for this temporary bThing.\n    structB bThing = ConvertAtoB (aThing);\n    i = funcThing1(bThing);\n    // other operations on bThing and then finally.\n    AssignBtoA (&amp;aThing, bThing);\n}\n</code></pre>\n\n<p>Or your API functions could return a <code>structB</code> in which case you could do something like:</p>\n\n<pre><code>structB funcThing1 (structB thing);\nstructB funcThing2 (structB thing);\nstructB funcThing3 (structB thing);\n\nstructA aThing;\n//  \u2026. code\n{  // create a local scope for this temporary bThing.\n    structB bThing = ConvertAtoB (aThing);\n    bThing = funcThing1(bThing);\n    bThing = funcThing2(bThing);\n    AssignBtoA (&amp;aThing, bThing);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>{  // create a local scope for this temporary bThing.\n    structB bThing = ConvertAtoB (aThing);\n    AssignBtoA (&amp;aThing, funcThing2(funcThing1(bThing)));\n}\n</code></pre>\n\n<p>or even just</p>\n\n<pre><code>AssignBtoA (&amp;aThing, funcThing2(funcThing1(ConvertAtoB (aThing))))\n</code></pre>\n\n<p><strong>Alternative 3 - use pointers in a fragile way</strong></p>\n\n<p>Another alternative is create a pointer whose address starts with the <code>structB</code> portion of <code>structA</code>. While I am only vaguely familiar with MISRA, I have little doubt that this approach is against the rules since it is pretty much an abomination. However here it is anyway as I've seen it done in old code written by people without proper software engineering training.</p>\n\n<p>With the above two structs, create a helper function or a macro that will generate a pointer to the offset in <code>structA</code> where the <code>structB</code> data begins. For instance:</p>\n\n<pre><code>structB MakeClone (structA thing) {\n    return *(structB *)&amp;thing.b;   // return a copy of the structB part of structA\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>structB *MakePointer (structA *pThing) {\n    return (structB *)&amp;thing.b;    // return a pointer to the structB part of structA\n}\n</code></pre>\n\n<p>A Preprocessor macro may also be used to generate the pointer of the second case as in:</p>\n\n<pre><code>#define MAKEPOINTER(pThing) ((structB *)&amp;((pThing)-&gt;b))\n</code></pre>\n\n<p>I have also seen where rather than using a helper function with an assignment as in:</p>\n\n<pre><code>int funcThing (structB *pBthing);\n\n//  then in code want to use the above function with a structA\nstructA  aThing = {0};\n\n// do things with aThing then call our function that wants a structB\n\nfuncThing (MAKEPOINTER(&amp;aThing));\n</code></pre>\n\n<p>they will instead just hardcode the pointer as in which makes it really hard to find where this has been done during maintenance:</p>\n\n<pre><code>funcThing ((structB *)&amp;(aThing.b));\n</code></pre>\n\n<p>I've also seen the pointer approach used with assignment using <code>memcpy()</code> to do the assignment. So if we have code like:</p>\n\n<pre><code>structA aThing = {0};\nstructB bThing = {0};\n\n// somewhere in code we have\nmemcpy (&amp;bThing, &amp;aThing.b, sizeof(structB));  // assign the structB part of aThing to a structB\n// more code to modify bThing then call our function\nfuncThing (&amp;bThing);\nmemcpy (&amp;aThing.b, &amp;bThing, sizeof(structB));  // assign the structB back into the structB part of aThing\n</code></pre>\n\n<p>Using the pointer approach is fragile because if <code>structA</code> layout or <code>structB</code> layout should change things will probably break. The worse part is they could break with no indication as to why and the root cause.</p>\n"}, {"tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": 0, "last_activity_date": 1547917446, "creation_date": 1547917446, "answer_id": 54269391, "question_id": 54222940, "link": "https://stackoverflow.com/questions/54222940/combining-common-api-for-similar-but-different-data-structures-in-c/54269391#54269391", "title": "Combining common API for similar but different data structures in C", "body": "<p>First of all it recommended to pass a pointer to a structure rather than full copy by value.</p>\n\n<p><strong>Method 1:</strong>\nThere is one method that is widely used in Linux kernel programming and that is <code>container_of</code> macro. If you give it a pointer to an element as input it will give you the structure containing that element. You can do something similar inside the functions <code>set_b()</code>, <code>set_c()</code>, <code>set_d()</code>.</p>\n\n<p><strong>Method 2:</strong>\nTaking the example of <code>set_b()</code>, You can add 1 more extra argument to tell about the structure type and also make the first pointer a <code>void *</code>. The signature will become:</p>\n\n<p><code>set_b(void * str, int num, int str_type)</code></p>\n\n<p>You can use <code>str_type</code> as <code>1</code> for <code>struct A</code> and <code>0</code> for <code>struct B</code>. Now inside the function definition, you have to check for the type and recast the <code>void</code> pointer again to the proper <code>struct</code> type</p>\n"}], "owner": {"reputation": 2949, "user_id": 1151746, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb694394b6a57f0036e1f14498158962?s=128&d=identicon&r=PG", "display_name": "Rog Matthews", "link": "https://stackoverflow.com/users/1151746/rog-matthews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1547917446, "creation_date": 1547662181, "last_edit_date": 1547665096, "question_id": 54222940, "link": "https://stackoverflow.com/questions/54222940/combining-common-api-for-similar-but-different-data-structures-in-c", "title": "Combining common API for similar but different data structures in C", "body": "<p>I have two structures: <strong>A</strong> containing <strong>a,b,c,d</strong> as members and <strong>B</strong> containing <strong>b,c,d</strong> as members. I have multiple APIs that can be be passed either <strong>A</strong> or <strong>B</strong>.</p>\n\n<pre><code>typedef struct {\n    int a;\n    int b;\n    int c;\n    int d;\n} A;\n\ntypedef struct {\n    int b;\n    int c;\n    int d;\n} B;\n\nSet_b(struct A, int);\nSet_c(struct A, int);\nSet_d(struct A, int);\n\nSet_b'(struct B, int);\nSet_c'(struct B, int);\nSet_d'(struct B, int);\n</code></pre>\n\n<p>What will be the easiest method to achieve common APIs for the same in C. E.g.</p>\n\n<pre><code>Set_b(X, int);\nSet_c(X, int);\nSet_d(X, int);\n</code></pre>\n\n<p>I\u2019m not allowed to use a <code>union</code> as the code must conform to MISRA C. </p>\n"}, {"tags": ["c", "windows", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 2641, "user_id": 4397753, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2cf1a782244585a33dc35fd6f0070eb5?s=128&d=identicon&r=PG&f=1", "display_name": "Jenix", "link": "https://stackoverflow.com/users/4397753/jenix"}, "edited": false, "score": 0, "creation_date": 1569401752, "post_id": 54222226, "comment_id": 102581701, "body": "Can&#39;t directly answer your question, but in my test, even as administrator, pthread_attr_setschedpolicy() returned some error code when called with SCHED_FIFO or SCHED_RR. The same test code worked well on Linux."}], "owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547660814, "creation_date": 1547659274, "last_edit_date": 1547660814, "question_id": 54222226, "link": "https://stackoverflow.com/questions/54222226/does-sched-fifo-and-sched-rr-do-anything-on-windows-10", "title": "Does SCHED_FIFO and SCHED_RR do anything on Windows 10", "body": "<p>I've spent some time optimizing a multi-threaded application under Ubuntu 16.04 (using the pthread library). In the end I got the best performance by explicitly setting the scheduling and priority thread attributes to a combination of <code>SCHED_FIFO</code> and <code>SCHED_RR</code> at varying priorities between <code>sched_get_priority_min()</code> and <code>sched_get_priority_max()</code>.</p>\n\n<p>This application is also ported to Windows10 using a win32 pthread library implementation. Does the underlying OS respect these 'real-time' scheduling policies? Or in other words, does specifying them actually do anything under Windows10?</p>\n"}, {"tags": ["c", "numbers", "reverse"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 4, "creation_date": 1547657165, "post_id": 54221595, "comment_id": 95269116, "body": "Coul you try to phrase your question a bit more clear? <code>rev</code> does not actually calculate the reverse number it only prints it. Also note that if you reverse an integer it could be out of <code>int</code> range."}, {"owner": {"reputation": 1405, "user_id": 1764528, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6da340d12df3f5e4c7a53681a9ac91e?s=128&d=identicon&r=PG", "display_name": "DollarAkshay", "link": "https://stackoverflow.com/users/1764528/dollarakshay"}, "edited": false, "score": 1, "creation_date": 1547657200, "post_id": 54221595, "comment_id": 95269136, "body": "The <code>rev()</code> function does not reverse the number. Please check"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1547657401, "post_id": 54221595, "comment_id": 95269240, "body": "A single statement is no code. Please provide a complete sample or at least a complete function. The variables are not defined. What should they contain? How should it get there? When will the loop stop...."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1547657564, "post_id": 54221595, "comment_id": 95269320, "body": "Doesn\u2019t produce the same output without extra work when the number ends with zeros."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547657680, "post_id": 54221595, "comment_id": 95269390, "body": "Regarding the question title, what is the reverse of <code>100</code>? It is the same reason why we store telephone and card numbers as strings, not integers: any leading zeros are significant and unless they are stated <i>you don&#39;t know how many there are</i>."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1547657818, "post_id": 54221595, "comment_id": 95269469, "body": "rev fails for 0.  It should be <code>do .. while</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1547665178, "post_id": 54221595, "comment_id": 95273108, "body": "OT: when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful"}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "is_accepted": true, "score": 1, "last_activity_date": 1547657504, "creation_date": 1547657504, "answer_id": 54221753, "question_id": 54221595, "link": "https://stackoverflow.com/questions/54221595/why-is-reverse-of-a-number-c-program-written-with-the-concept-of-digits-places-i/54221753#54221753", "title": "Why is reverse of a number c program written with the concept of digits places instead like the below one which I posted?", "body": "<p>Because you actually didn't reverse number, you are just printing it. If you want to store reversed number and use it later, you have to to do <code>reverse = reverse * 10 + remainder;</code></p>\n"}, {"comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547661504, "post_id": 54222624, "comment_id": 95271347, "body": "But be careful, not every <code>int</code> can be reversed this way, for example <code>1000000009</code> would lead to an <code>int</code> overflow."}, {"owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547664955, "post_id": 54222624, "comment_id": 95273000, "body": "you can use <b>long long</b> in that case. and if it overflow the long long than using string is the obvious way"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547666071, "post_id": 54222624, "comment_id": 95273515, "body": "Yes, if <code>long long</code> is wider than <code>int</code> it can not overflow, it was just a side node to your solution."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547666322, "post_id": 54222624, "comment_id": 95273619, "body": "@NiloyRashid you have only addressed the actual question (see its title) in your comment. Your solution will give the reverse of <code>100</code> as <code>1</code>, not <code>001</code>."}, {"owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547667514, "post_id": 54222624, "comment_id": 95274176, "body": "@Weather Vane if you want those leading zero&#39;s and still want to use the reverse number than using string is the only way"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547667662, "post_id": 54222624, "comment_id": 95274242, "body": "Yes I know, that&#39;s why I posted my other comment under the question, earlier. Are you sure you know what OP was asking?"}, {"owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547709448, "post_id": 54222624, "comment_id": 95286447, "body": "You make a good point @WeatherVane. I update the answer. Thank You brother"}], "tags": [], "owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "is_accepted": false, "score": 0, "last_activity_date": 1547710933, "last_edit_date": 1547710933, "creation_date": 1547660756, "answer_id": 54222624, "question_id": 54221595, "link": "https://stackoverflow.com/questions/54221595/why-is-reverse-of-a-number-c-program-written-with-the-concept-of-digits-places-i/54222624#54222624", "title": "Why is reverse of a number c program written with the concept of digits places instead like the below one which I posted?", "body": "<p>What will you do if someone ask you to add a integer <strong>X</strong> with the reverse of the given number? Counting the reverse number always is a good idea than just printing it form last digit to first. This small change in your code may be very useful:</p>\n\n<pre><code>void rev(long long n){\n    long long rem = 0;\n    printf(\"reverse of that number is:\");\n    while(n&gt;0)\n    {\n        rem= rem*10+(n%10);\n        n=n/10;\n    }\n    printf(\"%lld\",rem);\n}\n</code></pre>\n\n<p>Here you can also return the value of <strong><em>rem</em></strong> for further use.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>As @Weather Vane says, what if user want to see the reverse number with leading zeros(if there any), the only way then to input the number as string. and reverse it. A string can reverse using <strong>strrev()</strong> function from <code>&lt;string.h&gt;</code></p>\n\n<pre><code>strrev(string_name);\n</code></pre>\n\n<p>If it is a <em>STL String</em> than using <strong>reverse()</strong> function from <code>&lt;algorithm&gt;</code> will be useful.</p>\n\n<pre><code>reverse(string_name.begin(), string_name.end());\n</code></pre>\n\n<p>If you want to get the <em>integer from the string</em> you can do this like this:</p>\n\n<pre><code>long long str_to_num(string s)\n{\n    long long integer = 0;\n    for(int i = 0; i &lt; s.size(); i++){\n        integer = integer*10+(s[i]-'0');\n    }\n    return integer;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9382420"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 54221753, "answer_count": 2, "score": -2, "last_activity_date": 1547750795, "creation_date": 1547656931, "last_edit_date": 1547750795, "question_id": 54221595, "link": "https://stackoverflow.com/questions/54221595/why-is-reverse-of-a-number-c-program-written-with-the-concept-of-digits-places-i", "title": "Why is reverse of a number c program written with the concept of digits places instead like the below one which I posted?", "body": "<pre><code>void rev(int n){\n        int rem;\n        printf(\"reverse of that number is:\");\n        while(n&gt;0)\n        {\n            rem=n%10;\n            n=n/10;\n            printf(\"%d\",rem);\n        }\n    }\n    int main()\n    {\n        int n;\n        printf(\"enter a number of more than two digits\");\n        scanf(\"%d\",&amp;n);\n        rev(n);\n        return 0;\n    }\n</code></pre>\n\n<p>This code without writing a piece of code for digits places i.e., </p>\n\n<pre><code>reverse = reverse * 10 + remainder;\n</code></pre>\n\n<p>also returns the same. \nplease explain if there is any mistake in my perspective.\nregards.</p>\n"}, {"tags": ["c", "linux", "debugging", "coredump"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1547651939, "post_id": 54220130, "comment_id": 95265984, "body": "Signal 9 is <code>SIGKILL</code> which means it was deliberately killed instead of crashed. What is the memory usage of the program when it&#39;s killed? Of the system in general? Things like this usually happens when a Linux system runs low on memory."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1547652543, "post_id": 54220130, "comment_id": 95266353, "body": "The <code>SIGKILL</code> is likely coming from something like the OOM killer.  Does your system have a <code>&#47;var&#47;log&#47;messages</code> or similar?  <code>grep -i oom &#47;var&#47;log&#47;messages</code> might be useful.  In any case, you should be checking files like <code>&#47;var&#47;log&#47;messages</code> for information around the time(s) your process gets killed."}, {"owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "edited": false, "score": 0, "creation_date": 1547653324, "post_id": 54220130, "comment_id": 95266804, "body": "Good call, it&#39;s a memory issue, I added the /var/log/messages info"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1547653418, "post_id": 54220130, "comment_id": 95266876, "body": "Since the log mentions <code>oom-killer</code>, your program&#39;s being stopped because it uses too much memory.  You probably have a memory leak."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1547655979, "post_id": 54220130, "comment_id": 95268403, "body": "This appears relevant:  <a href=\"https://lwn.net/Articles/104185/\" rel=\"nofollow noreferrer\">lwn.net/Articles/104185</a>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1547657338, "post_id": 54220130, "comment_id": 95269207, "body": "@Jonathan - Linux design leads to unexplained OOM kills as a normal course of business. It regularly overcommits memory. That is, it returns success on an allocation request when it should return failure. No leak required. I see it all the time on a GoDaddy VM with 1 GB of RAM acting as a web server. The OOM killer hits the MySQL process and corrupts our database on occasion. To avoid the broken allocator, then switch to Solaris. It does not oversubscribe memory."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1547665596, "post_id": 54220130, "comment_id": 95273305, "body": "you can use <code>gdb</code> &#39;remotely&#39; by running a <code>gdb</code> server along with the embedded program  Then have your local <code>gdb</code> connect to it.  The details are in the <code>gdb</code> manual"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1548061234, "post_id": 54220130, "comment_id": 95393765, "body": "IMHO nothing in the system kills your process with a <code>SIGKILL</code>, but I can be wrong.  It must be a program what kills your process."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1547652734, "post_id": 54220204, "comment_id": 95266442, "body": "Given the question, disabling overcommitting should be the first thing to do."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1547654417, "last_edit_date": 1547654417, "creation_date": 1547652043, "answer_id": 54220204, "question_id": 54220130, "link": "https://stackoverflow.com/questions/54220130/crashing-program-does-not-generate-core-dump/54220204#54220204", "title": "Crashing program does not generate core dump", "body": "<blockquote>\n  <p>What else can I try ?</p>\n</blockquote>\n\n<p>I recommend to try <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/Remote-Debugging.html\" rel=\"nofollow noreferrer\">remote <code>gdb</code> debugging</a>. And you'll better use Linux on the debugging host (that is, your development laptop).</p>\n\n<p>(you could even cross-build your program with the <a href=\"https://en.wikipedia.org/wiki/DWARF\" rel=\"nofollow noreferrer\">DWARF</a> debugging information sitting in another file; I know it is possible, but I forgot the details).</p>\n\n<p>If your embedded system runs Linux, be sure to disable <a href=\"https://en.wikipedia.org/wiki/Memory_overcommitment\" rel=\"nofollow noreferrer\">memory over-commitment</a>.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/q/15227017/841108\">this</a>.</p>\n"}], "owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1550079103, "creation_date": 1547651800, "last_edit_date": 1550079103, "question_id": 54220130, "link": "https://stackoverflow.com/questions/54220130/crashing-program-does-not-generate-core-dump", "title": "Crashing program does not generate core dump", "body": "<p>I wrote a C program that sometimes dies after a few days. It runs on embedded equipment so it's difficult to debug the problem properly (no local gdb, no valgrind, but I have strace).\nIt does not generate a core file when it dies, even though <code>ulimit -c unlimited</code> is used.</p>\n\n<p>When it dies, all that is being displayed on the console is 'killed'. Logs from the program itself do not help.\nI suspect either a buffer overflow, a memory overflow (a missing <code>free</code>) or a multithreading issue.</p>\n\n<p>I do not use a signal handler in the code (could that help ?). Where does this <code>kill -9</code> come from ?!?</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>$ ./MyProg\nkilled\n\n$ time -v ./MyProg\n    Command terminated by signal 9\nCommand being timed: \"./MyProg\"\nUser time (seconds): 762.04\nSystem time (seconds): 1360.74\nPercent of CPU this job got: 2%\nElapsed (wall clock) time (h:mm:ss or m:ss): 23h 4m 23s\nAverage shared text size (kbytes): 0\nAverage unshared data size (kbytes): 0\nAverage stack size (kbytes): 0\nAverage total size (kbytes): 0\nMaximum resident set size (kbytes): 0\nAverage resident set size (kbytes): 0\nMajor (requiring I/O) page faults: 40\nMinor (reclaiming a frame) page faults: 29567\nVoluntary context switches: 4742276\nInvoluntary context switches: 187702\nSwaps: 0\nFile system inputs: 0\nFile system outputs: 0\nSocket messages sent: 0\nSocket messages received: 0\nSignals delivered: 0\nPage size (bytes): 4096\nExit status: 0\n\n$ cat /proc/PID/smaps # Shortly before the crash\n10000000-10042000 r-xp 00000000 00:0b 203162716  /root/MyProg\nSize:                264 kB\nRss:                 224 kB\nPss:                 224 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:       224 kB\nPrivate_Dirty:         0 kB\nReferenced:          120 kB\n10052000-10055000 rwxp 00042000 00:0b 203162716  /root/MyProg\nSize:                 12 kB\nRss:                  12 kB\nPss:                  12 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:        12 kB\nReferenced:           12 kB\n10055000-1706a000 rwxp 10055000 00:00 0          [heap]\nSize:             114772 kB\nRss:              114716 kB\nPss:              114716 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:    114716 kB\nReferenced:       114716 kB\n30000000-30005000 r-xp 00000000 00:0b 135513112  /lib/ld-uClibc-0.9.29.so\nSize:                 20 kB\nRss:                  20 kB\nPss:                   1 kB\nShared_Clean:         20 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:           20 kB\n30005000-30006000 rw-p 30005000 00:00 0 \nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n30014000-30015000 r--p 00004000 00:0b 135513112  /lib/ld-uClibc-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n30015000-30016000 rwxp 00005000 00:0b 135513112  /lib/ld-uClibc-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n30016000-30027000 r-xp 00000000 00:0b 135513124  /lib/libm-0.9.29.so\nSize:                 68 kB\nRss:                  12 kB\nPss:                   1 kB\nShared_Clean:         12 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:           12 kB\n30027000-30036000 ---p 30027000 00:00 0 \nSize:                 60 kB\nRss:                   0 kB\nPss:                   0 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n30036000-30037000 r--p 00010000 00:0b 135513124  /lib/libm-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   0 kB\nShared_Clean:          4 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            4 kB\n30037000-30038000 rwxp 00011000 00:0b 135513124  /lib/libm-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n30038000-30043000 r-xp 00000000 00:0b 135513129  /lib/libpthread-0.9.29.so\nSize:                 44 kB\nRss:                  44 kB\nPss:                  44 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:        44 kB\nPrivate_Dirty:         0 kB\nReferenced:           20 kB\n30043000-30052000 ---p 30043000 00:00 0 \nSize:                 60 kB\nRss:                   0 kB\nPss:                   0 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n30052000-30053000 r--p 0000a000 00:0b 135513129  /lib/libpthread-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n30053000-30058000 rwxp 0000b000 00:0b 135513129  /lib/libpthread-0.9.29.so\nSize:                 20 kB\nRss:                   8 kB\nPss:                   8 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         8 kB\nReferenced:            8 kB\n30058000-3005a000 rwxp 30058000 00:00 0 \nSize:                  8 kB\nRss:                   0 kB\nPss:                   0 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n3005a000-3005b000 r-xp 00000000 00:0b 135513131  /lib/librt-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   2 kB\nShared_Clean:          4 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n3005b000-3006a000 ---p 3005b000 00:00 0 \nSize:                 60 kB\nRss:                   0 kB\nPss:                   0 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n3006a000-3006b000 r--p 00000000 00:0b 135513131  /lib/librt-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   2 kB\nShared_Clean:          4 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n3006b000-3006c000 rwxp 00001000 00:0b 135513131  /lib/librt-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n3006c000-30079000 r-xp 00000000 00:0b 135513120  /lib/libgcc_s.so.1\nSize:                 52 kB\nRss:                  28 kB\nPss:                  21 kB\nShared_Clean:          8 kB\nShared_Dirty:          0 kB\nPrivate_Clean:        20 kB\nPrivate_Dirty:         0 kB\nReferenced:           20 kB\n30079000-30088000 ---p 30079000 00:00 0 \nSize:                 60 kB\nRss:                   0 kB\nPss:                   0 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n30088000-30089000 rwxp 0000c000 00:0b 135513120  /lib/libgcc_s.so.1\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n30089000-300d0000 r-xp 00000000 00:0b 135513132  /lib/libuClibc-0.9.29.so\nSize:                284 kB\nRss:                 188 kB\nPss:                  22 kB\nShared_Clean:        180 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         8 kB\nPrivate_Dirty:         0 kB\nReferenced:          164 kB\n300d0000-300df000 ---p 300d0000 00:00 0 \nSize:                 60 kB\nRss:                   0 kB\nPss:                   0 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         0 kB\nReferenced:            0 kB\n300df000-300e0000 r--p 00046000 00:0b 135513132  /lib/libuClibc-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n300e0000-300e1000 rwxp 00047000 00:0b 135513132  /lib/libuClibc-0.9.29.so\nSize:                  4 kB\nRss:                   4 kB\nPss:                   4 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:         4 kB\nReferenced:            4 kB\n300e1000-300e6000 rwxp 300e1000 00:00 0 \nSize:                 20 kB\nRss:                  16 kB\nPss:                  16 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:        16 kB\nReferenced:           16 kB\n7f3fc000-7f400000 rwxp 7f3fc000 00:00 0 \nSize:                 16 kB\nRss:                  16 kB\nPss:                  16 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:        16 kB\nReferenced:           16 kB\n7faf8000-7fb0d000 rwxp 7ffeb000 00:00 0          [stack]\nSize:                 84 kB\nRss:                  12 kB\nPss:                  12 kB\nShared_Clean:          0 kB\nShared_Dirty:          0 kB\nPrivate_Clean:         0 kB\nPrivate_Dirty:        12 kB\nReferenced:           12 kB\n</code></pre>\n\n<p>From /var/log/messages:</p>\n\n<pre><code>user.warn kernel: dropbear invoked oom-killer: gfp_mask=0x1201d2, order=0, oomkilladj=0\nuser.warn kernel: Call Trace:\nuser.warn kernel: show_stack+0x50/0x184 (unreliable)\nuser.warn kernel: oom_kill_process+0x54/0x1ac\nuser.warn kernel: out_of_memory+0x1a8/0x1dc\nuser.warn kernel: __alloc_pages+0x24c/0x2dc\nuser.warn kernel: __do_page_cache_readahead+0xc4/0x220\nuser.warn kernel: filemap_fault+0x150/0x37c\nuser.warn kernel: __do_fault+0x6c/0x40c\nuser.warn kernel: do_page_fault+0x274/0x3ec\nuser.warn kernel: handle_page_fault+0xc/0x80\nuser.warn kernel: Mem-info:\nuser.warn kernel: DMA per-cpu:\nuser.warn kernel: CPU    0: hi:   42, btch:   7 usd:  31\nuser.warn kernel: Active:29872 inactive:194 dirty:0 writeback:0 unstable:0\nuser.warn kernel:  free:356 slab:1392 mapped:84 pagetables:65 bounce:0\nuser.warn kernel: DMA free:1424kB min:1440kB low:1800kB high:2160kB active:119488kB inactive:776kB present:130048kB pages_scanned:194475 all_unreclaimable? yes\nuser.warn kernel: lowmem_reserve[]: 0 0 0\nuser.warn kernel: DMA: 0*4kB 0*8kB 1*16kB 0*32kB 0*64kB 1*128kB 1*256kB 0*512kB 1*1024kB 0*2048kB 0*4096kB = 1424kB\nuser.warn kernel: 204 total pagecache pages\nuser.warn kernel: Free swap:            0kB\nuser.warn kernel: 32768 pages of RAM\nuser.warn kernel: 0 pages of HIGHMEM\nuser.warn kernel: 1236 free pages\nuser.warn kernel: 770 reserved pages\nuser.warn kernel: 112 pages shared\nuser.warn kernel: 0 pages swap cached\nuser.err kernel: Out of memory: kill process 206 (MyProg) score 623 or a child\nuser.err kernel: Killed process 206 (MyProg)\n</code></pre>\n\n<p>What else can I try ? Thanks</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547651895, "post_id": 54220082, "comment_id": 95265964, "body": "Pointers have not only values but types as well. Even if numerical value of two pointers is the same, it doesn&#39;t mean they are interchangeable or compatible. You need to use proper types."}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1547651921, "post_id": 54220082, "comment_id": 95265977, "body": "FYI most c++ compilers make base a value field instead of a pointer field. that way sizeof(derived) = sizeof(base) + sizeof(derived fields). In case you are trying to mimic that behavior."}, {"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547652010, "post_id": 54220082, "comment_id": 95266025, "body": "@EugeneSh. Can i make it work. What cast i need to in display(BASE(peacockptr)); to make it work. I tried even like this display((struct animal *)BASE(peacockptr)); But did not work"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1547654567, "post_id": 54220082, "comment_id": 95267596, "body": "You can also use <code>void</code> pointers: <a href=\"https://wandbox.org/permlink/SCugBZgzP5vrS8ad\" rel=\"nofollow noreferrer\">wandbox.org/permlink/SCugBZgzP5vrS8ad</a>"}, {"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1547656026, "post_id": 54220082, "comment_id": 95268436, "body": "@bob thanks for the solution."}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1547652247, "post_id": 54220169, "comment_id": 95266150, "body": "<code>peacockptr</code> is still not pointing to a <code>struct animal</code>, because <code>base</code> is a pointer. Shouldn&#39;t it be <code>peacockptr.base</code>? So if OP wants to mimic classes he should make base a value field. then the cast would be valid."}, {"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547652267, "post_id": 54220169, "comment_id": 95266166, "body": "@dbush I tried this display((struct animal *)BASE(peacockptr));    But i get error can&#39;t convert to pointer type error"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547652380, "post_id": 54220169, "comment_id": 95266243, "body": "@Vipin  That&#39;s because <code>peacockptr</code> is not a pointer to <code>struct bird</code>.  It&#39;s an <i>instance</i> of <code>struct bird</code> and <code>peacock</code> is a pointer.  You confused yourself by using names that didn&#39;t reflect what they were.  Switch the names."}, {"owner": {"reputation": 858, "user_id": 3093427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tlDuy.png?s=128&g=1", "display_name": "gmoshkin", "link": "https://stackoverflow.com/users/3093427/gmoshkin"}, "reply_to_user": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547652471, "post_id": 54220169, "comment_id": 95266305, "body": "@Vipin either change <code>peacockptr</code> to be a pointer or pass it this way <code>display((struct animal *) &amp;peacockptr)</code>"}, {"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "reply_to_user": {"reputation": 858, "user_id": 3093427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tlDuy.png?s=128&g=1", "display_name": "gmoshkin", "link": "https://stackoverflow.com/users/3093427/gmoshkin"}, "edited": false, "score": 0, "creation_date": 1547652527, "post_id": 54220169, "comment_id": 95266349, "body": "@gmoshkin sorry i did not understand. Can you please update the example in answer part."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547653225, "post_id": 54220169, "comment_id": 95266743, "body": "<code>display((struct animal *)BASE(peacockptr));</code>. <code>peacockptr</code> is of type <code>struct bird</code>. Aren&#39;t you casting a <code>struct bird</code> to <code>struct animal *</code> here?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547653771, "post_id": 54220169, "comment_id": 95267110, "body": "@Vipin I added an update to show where the confusion is."}, {"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547653832, "post_id": 54220169, "comment_id": 95267146, "body": "@osiris Yes. i am trying to cast the address of first member using address of the struct. Because both the address are same."}, {"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547653933, "post_id": 54220169, "comment_id": 95267201, "body": "@dbush thanks for finding it. But i tried  display((struct animal *) &amp;peacockptr) this suggestion. It was giving some different value. Is it like it is not possible in c."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547654226, "post_id": 54220169, "comment_id": 95267364, "body": "@Vipin It&#39;s not working because the first member of <code>struct bird</code> is a pointer to <code>struct animal</code>, not an instance of <code>struct animal</code>.  You need to either dereference the casted pointer or change <code>struct bird</code> to contain an instance of <code>struct animal</code> instead of a pointer."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1547653739, "last_edit_date": 1547653739, "creation_date": 1547651940, "answer_id": 54220169, "question_id": 54220082, "link": "https://stackoverflow.com/questions/54220082/in-c-accessing-first-element-of-the-struct-using-address-of-the-struct-and-point/54220169#54220169", "title": "In c accessing first element of the struct using address of the struct and pointers", "body": "<p>It's true that the address of a struct is the same as the address of its first member.  However, they have different <strong>types</strong>.  One has type <code>struct animal *</code> and the other has type <code>struct base *</code>.</p>\n\n<p>You are allowed to convert between the two in this case, however you need an explicit cast to do so.</p>\n\n<pre><code>display((struct animal *)BASE(peacockptr));   \n</code></pre>\n\n<p>Also, regarding the way you have your <code>BASE</code> macro defined:</p>\n\n<pre><code>#define BASE(class) *(&amp;class)\n</code></pre>\n\n<p>The <code>*</code> and <code>&amp;</code> operators cancel each other out, so this is effectively a no-op.  <code>BASE(peacockptr)</code> is equivalent to <code>peacockptr</code>.</p>\n\n<p>The reason it fails for you now with the cast, is because you have <code>peacockptr</code> defined as an <em>instance</em> and <code>pecock</code> as a <em>pointer</em>, i.e. you confused yourself with the naming.  Switch the names to reflect the usage:</p>\n\n<pre><code>struct bird peacock;\nstruct animal base;\nbase.hear=1;\nbase.walk=1;\npeacock.base= &amp;base;\n\nstruct bird *peacockptr =&amp;peacock;\npeacockptr-&gt;fly=1;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "edited": false, "score": 0, "creation_date": 1547654213, "post_id": 54220811, "comment_id": 95267357, "body": "I got now my mistake @Osiris. Thank you so much all."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1547658179, "post_id": 54220811, "comment_id": 95269678, "body": "I think its better to add <code>(void *)</code> for casting %p argument in both of <code>printf()</code>  to resolve this warning: <code>warning: format \u2018%p\u2019 expects argument of type \u2018void *\u2019, but argument 2 has type \u2018struct animal *\u2019 [-Wformat=]</code>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1547658226, "post_id": 54220811, "comment_id": 95269703, "body": "<code>(void*)*(struct animal **)peacockptr</code> and <code>(void*) &amp;base</code>"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1547659398, "post_id": 54220811, "comment_id": 95270324, "body": "@EsmaeelE Not only better, it would be undefined behavior otherwise. Thank you, good catch."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": true, "score": 2, "last_activity_date": 1547659350, "last_edit_date": 1547659350, "creation_date": 1547654089, "answer_id": 54220811, "question_id": 54220082, "link": "https://stackoverflow.com/questions/54220082/in-c-accessing-first-element-of-the-struct-using-address-of-the-struct-and-point/54220811#54220811", "title": "In c accessing first element of the struct using address of the struct and pointers", "body": "<p>As already mentioned you can drop your <code>BASE</code> macro as the operators cancel out on pointers.</p>\n\n<p>I cleared up and corrected your code a bit and explained where you where going wrong:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct animal\n{\n    int walk;\n    int hear;\n};\n\nstruct bird\n{\n    struct animal *base;\n    int fly;\n};\n\nvoid display(struct animal *common)\n{\n    printf(\"All animal details hear=%d  walk=%d\\n\",common-&gt;hear, common-&gt;walk);\n}\n\nint main()\n{\n    struct bird peacock; // removed ptr suffix, since it is not a pointer\n    struct animal base ;\n\n    base.hear=1;\n    base.walk=1;\n\n    peacock.base= &amp;base;\n\n    struct bird *peacockptr = &amp;peacock;\n    peacockptr-&gt;fly=1;\n\n    printf(\"base address using peacock struct %p\\n\",  (void *)*(struct animal **)peacockptr); //This is the address of base using peackockptr\n    printf(\"base address animal %p\\n\", (void *)&amp;base); //This is the address of base\n\n    display(&amp;base);\n    display(*(struct animal **)peacockptr);\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that the adress of <code>peackock</code> equals the address of the first element of the struct which is a <code>struct animal *</code>. So you have to cast <code>peacockptr</code> to <code>struct animal **</code> (because it is pointing to the first element which is of type <code>struct animal *</code>) and then dereference it to get the address of <code>base</code>.</p>\n"}], "owner": {"reputation": 788, "user_id": 8446934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-O3VXiD4ddPA/AAAAAAAAAAI/AAAAAAAABDg/Iv83w53heE8/photo.jpg?sz=128", "display_name": "Vipin", "link": "https://stackoverflow.com/users/8446934/vipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 1, "accepted_answer_id": 54220811, "answer_count": 2, "score": 2, "last_activity_date": 1547662769, "creation_date": 1547651651, "last_edit_date": 1547662769, "question_id": 54220082, "link": "https://stackoverflow.com/questions/54220082/in-c-accessing-first-element-of-the-struct-using-address-of-the-struct-and-point", "title": "In c accessing first element of the struct using address of the struct and pointers", "body": "<p>I noticed that the <code>struct</code> address and the first element address look to be same.\nSo I tried to access the first element of <code>struct</code> using address of the main <code>struct</code>.\nBut I am getting an error.</p>\n\n<p>In compatible type of argument 1 of the display.</p>\n\n<p>What mistake I am making here?</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define BASE(class) *(&amp;class)\n\nstruct animal {\n    int walk;\n    int hear;\n};\n\nstruct bird {\n    struct animal *base;\n    int fly;\n};\n\nvoid display(struct animal *common) {\n    printf(\"All animal details hear=%d  walk=%d \", common-&gt;hear, common-&gt;walk);\n}\n\nint main() {\n    struct bird peacockptr;\n    struct animal base;\n    base.hear = 1;\n    base.walk = 1;\n    peacockptr.base = &amp;base;\n\n    struct bird *pecock = &amp;peacockptr;\n    pecock-&gt;fly = 1;\n\n    printf(\"base address using peacock struct %d\\n\",\n       BASE(peacockptr));  // both are printing same address\n    printf(\"base address animal %d\\n\",\n       &amp;base);  // both are printing same address\n\n    display(&amp;base);     // here it work\n    display(BASE(peacockptr));  // getting error\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 3, "creation_date": 1547652714, "post_id": 54219952, "comment_id": 95266430, "body": "I think the problem may be that <code>sleep()</code> takes an <code>int</code>, so <code>0.1</code> gets converted to <code>0</code>.  So the <code>sleep()</code> doesn&#39;t do anything, and the first thread finishes before the next gets a chance to do anything."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547655610, "post_id": 54219952, "comment_id": 95268184, "body": "In <code>main</code>, you can just pass <code>(void *) i</code> as the last argument and, in <code>add</code>, do <code>int id = (int) input</code>. Also, instead of <code>pthread_mutex_trylock</code> in a loop, just do <code>pthread_mutex_lock</code> without a loop. The trylock version will burn huge amounts of CPU needlessly. The lock version will give up the CPU until the lock has been released."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1547660737, "post_id": 54219952, "comment_id": 95270987, "body": "Use <i><a href=\"http://man7.org/linux/man-pages/man3/usleep.3.html\" rel=\"nofollow noreferrer\"><code>usleep()</code></a></i> to sleep for intervals smaller than one second on any unix-like (e.g., Linux) operating system."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9046610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f396778dffe356557d69ee7a6ac30dcb?s=128&d=identicon&r=PG&f=1", "display_name": "aqamn", "link": "https://stackoverflow.com/users/9046610/aqamn"}, "edited": false, "score": 0, "creation_date": 1547653946, "post_id": 54220388, "comment_id": 95267210, "body": "Thank you, you helped more than you think :)"}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 0, "last_activity_date": 1547652654, "creation_date": 1547652654, "answer_id": 54220388, "question_id": 54219952, "link": "https://stackoverflow.com/questions/54219952/how-can-i-accomplish-multiple-threads-to-join-multiple-times-into-a-process-pt/54220388#54220388", "title": "How can I accomplish multiple threads to join multiple times into a process? (pthread_mutex_lock)", "body": "<p>I found two problems.</p>\n\n<p>When I tried this on Windows with MSys2 my output was</p>\n\n<pre><code>The 1. thread got 101 points!\nThe 1. thread got 101 points!\nThe 2. thread got 0 points!\nThe 3. thread got 0 points!\nThe 5. thread got 0 points!\nThe 6. thread got 0 points!\nThe 6. thread got 0 points!\nThe 8. thread got 0 points!\nThe 9. thread got 0 points!\nThe 0. thread got 0 points!\n</code></pre>\n\n<p>You pass the address of your loop counter <code>i</code> to the threads. This variable is not constant, that's why the threads may read a value that has already changed. To fix thisI created an array <code>int ids[10]</code> and passed every thread its own ID array element.</p>\n\n<p>Function <code>sleep</code> uses an <code>unsigned int</code> argument, so you effectively call <code>sleep(0)</code>. With <code>sleep(1)</code> the program runs slower but works as expected. You can use <code>usleep</code> if you want to sleep for fractions of a second.</p>\n\n<p>Modified program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n#include &lt;errno.h&gt;\n\npthread_mutex_t mutex;\nint arr[10];\nint sum = 0;\n\nvoid *add (void* input){\n\n    int *id = (int*) input, x, s;\n    int ind = *id;\n    while (sum &lt; 100){\n        while (1){\n            if (pthread_mutex_trylock(&amp;mutex) != EBUSY)\n                break;\n        }\n        if (sum &lt; 100){\n            x = rand() % 3;\n            arr[ind] = arr[ind] + x;\n            sum += x;\n        }\n        pthread_mutex_unlock(&amp;mutex);\n        usleep(100000);\n    }\n    printf(\"The %d. thread got %d points!\\n\", ind, arr[ind]);\n    return NULL;\n}\n\nint main (void){\n\n    int i;\n    pthread_t threads[10];\n    int ids[10];\n    pthread_mutex_init(&amp;mutex, NULL);\n    srand(time(NULL));\n    for (i = 0; i &lt; 10; i++){\n        ids[i] = i;\n        if (pthread_create(&amp;threads[i], NULL, add, &amp;ids[i])){\n            perror(\"pthread_create\");\n            exit(1);\n        }\n    }\n    for (i = 0; i &lt; 10; i++){\n        if (pthread_join (threads[i], NULL)){\n            perror(\"pthread_join\");\n        }\n    }\n    pthread_mutex_destroy(&amp;mutex);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1547654147, "creation_date": 1547654147, "answer_id": 54220823, "question_id": 54219952, "link": "https://stackoverflow.com/questions/54219952/how-can-i-accomplish-multiple-threads-to-join-multiple-times-into-a-process-pt/54220823#54220823", "title": "How can I accomplish multiple threads to join multiple times into a process? (pthread_mutex_lock)", "body": "<p>You have several problems in your code, with varying degrees of relevance to the specific issue you asked about.  Before we go further, one output <em>I</em> get from running your code as written may be illustrative:</p>\n\n<blockquote>\n<pre><code>The 2. thread got 100 points!\nThe 8. thread got 0 points!\nThe 9. thread got 0 points!\nThe 5. thread got 0 points!\nThe 5. thread got 0 points!\nThe 6. thread got 0 points!\nThe 7. thread got 0 points!\nThe 2. thread got 100 points!\nThe 4. thread got 0 points!\nThe 1. thread got 0 points!\n</code></pre>\n</blockquote>\n\n<p>Note that some threads got the same counter index.  This can happen because you have a data race between the main thread and each child thread: the main thread passes a pointer to its local variable <code>i</code>, and then proceeds to modify the value of that variable.  Meanwhile the child thread reads the value of the variable via the pointer.  These actions are not synchronized, so the behavior is undefined.</p>\n\n<p>This particular problem has several solutions.  The simplest is probably to <em>cast</em> <code>i</code> to <code>void *</code> and pass the result (by value).  This is in fact pretty common where you just want to pass an integer:</p>\n\n<pre><code>        if (pthread_create(&amp;threads[i], NULL, add, (void *)i)) {\n            // ...\n</code></pre>\n\n<p>Of course, the thread function needs to convert it back:</p>\n\n<pre><code>void *add (void* input) {\n    int /*no need for 'id' */ x, s;\n    int ind = (int) input;\n    // ...\n</code></pre>\n\n<p>Next, observe that you have <em>another</em> data race among all your child threads where you read the value of <code>sum</code> in the condition of the <code>while</code> loop.  That one does not seem to be biting you at the moment, but it could do at any time.  Since the threads, as a group, both read and modify <code>sum</code>, you must ensure that all such accesses are synchronized -- for example, by performing them only while holding the mutex locked.</p>\n\n<p>Skipping a bit (we'll come back), you have a problem with your <code>sleep()</code> call.  That function's parameter is of type <code>int</code>, so your actual argument, the <code>double</code> 0.1, is converted to <code>int</code>, yielding 0.  The compiler might optimize that out altogether, and if it doesn't, then it might effectively be a no-op.  <strong>Even more importantly</strong>, however.  <code>sleep()</code> is simply the wrong tool for this job, or for pretty much any job related to inter-thread synchronization and timing.</p>\n\n<p>Recognizing now that there is no sleeping, you should see that your outer <code>while</code> loop is quite tight, in that a thread that has just unlocked the mutex will immediately try to lock it again.  It is quite common for such a re-locking attempt to succeed on the first try, because default mutex behavior makes no promises about thread scheduling fairness.</p>\n\n<p>Additionally, you gain no particular benefit from the peculiar busy loop around <code>pthread_mutex_trylock()</code>.  Just use <code>pthread_mutex_lock()</code> if otherwise all you're going to do when the mutex is busy is re-try.  This will save you CPU time and does not have appreciably different semantics.</p>\n\n<p>Overall, though, you have a strategy problem.  Mutexes do not generally provide any guarantees around fair scheduling.  Usually for a tight multithread interaction such as this one, you need to perform some kind of scheduling management manually, and that typically benefits greatly from adding a condition variable to the mix.</p>\n\n<p>It looks like you don't want to force the threads to take turns, but perhaps it would be sufficient to ensure that the thread that just ran does not immediately get selected again.  In that case, you could add a shared variable that records the index of the thread that just ran, and use that to prevent it from being selected again as the next thread.  Schematically, the thread function might then look something like this</p>\n\n<ul>\n<li>loop indefinitely:\n\n<ul>\n<li>lock the mutex</li>\n<li>loop indefinitely:\n\n<ul>\n<li>compare the last thread index to my index</li>\n<li>if it is different, break from the (inner) loop</li>\n<li>else wait on the condition variable</li>\n</ul></li>\n<li>set my index as the last thread index</li>\n<li>(still holding the mutex locked) broadcast to or signal the CV</li>\n<li>if <code>sum</code> is less than 100\n\n<ul>\n<li>update <code>sum</code></li>\n<li>unlock the mutex</li>\n</ul></li>\n<li>otherwise (<code>sum</code> is >= 100)\n\n<ul>\n<li>unlock the mutex</li>\n<li>break from the (outer) loop</li>\n</ul></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 9046610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f396778dffe356557d69ee7a6ac30dcb?s=128&d=identicon&r=PG&f=1", "display_name": "aqamn", "link": "https://stackoverflow.com/users/9046610/aqamn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54220823, "answer_count": 2, "score": -1, "last_activity_date": 1547654147, "creation_date": 1547651207, "question_id": 54219952, "link": "https://stackoverflow.com/questions/54219952/how-can-i-accomplish-multiple-threads-to-join-multiple-times-into-a-process-pt", "title": "How can I accomplish multiple threads to join multiple times into a process? (pthread_mutex_lock)", "body": "<p>I want to write a program, what counts to 100. I want to accomplish this with 10 threads, using pthread lock. When the program steps into a thread it generates a number between 0-2, this value will be added to it's index of array and also to the global variable sum. When the sum value reaches 100, every thread should print it's own value of array (the ammount of the entire array should be equal with the sum variable).</p>\n\n<p>My problem is the following: Always the first thread locks the mutex variable, but I want to distrub the task between all threads (arr[1] = 100, every other = 0, but I want for example arr[1] = 14, arr[2] = 8, etc. up to 100). Where am I wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n#include &lt;errno.h&gt;\n\npthread_mutex_t mutex;\nint arr[10];\nint sum = 0;\n\nvoid *add (void* input){\n\n    int *id = (int*) input, x, s;\n    int ind = *id;\n    while (sum &lt; 100){\n        while (1){\n            if (pthread_mutex_trylock(&amp;mutex) != EBUSY)\n                break;\n        }\n        if (sum &lt; 100){\n            x = rand() % 3;\n            arr[ind] = arr[ind] + x;\n            sum += x;\n        }\n        pthread_mutex_unlock(&amp;mutex);\n        sleep(0.1);\n    }\n    printf(\"The %d. thread got %d points!\\n\", ind, arr[ind]);\n    return NULL;\n}\n\nint main (void){\n\n    int i;\n    pthread_t threads[10];\n    pthread_mutex_init(&amp;mutex, NULL);\n    srand(time(NULL));\n    for (i = 0; i &lt; 10; i++){\n        if (pthread_create(&amp;threads[i], NULL, add, &amp;i)){\n            perror(\"pthread_create\");\n            exit(1);\n        }\n    }\n    for (i = 0; i &lt; 10; i++){\n        if (pthread_join (threads[i], NULL)){\n            perror(\"pthread_join\");\n        }\n    }\n    pthread_mutex_destroy(&amp;mutex);\n    return 0;\n}\n</code></pre>\n\n<p>The output:</p>\n\n<p>The 1. thread got 100 points!</p>\n\n<p>The 2. thread got 0 points!</p>\n\n<p>The 3. thread got 0 points!</p>\n\n<p>The 4. thread got 0 points!</p>\n\n<p>The 5. thread got 0 points!</p>\n\n<p>The 6. thread got 0 points!</p>\n\n<p>The 7. thread got 0 points!</p>\n\n<p>The 8. thread got 0 points!</p>\n\n<p>The 9. thread got 0 points!</p>\n\n<p>The 0. thread got 0 points!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1547651188, "post_id": 54219720, "comment_id": 95265547, "body": "The contents of your source file could be relevant.  Please present a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem."}, {"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 1, "creation_date": 1547652753, "post_id": 54219720, "comment_id": 95266451, "body": "That is a linker error. Check your build tools. linker is not able to find the symbol WinMain@16"}, {"owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "edited": false, "score": 0, "creation_date": 1547665122, "post_id": 54219720, "comment_id": 95273081, "body": "Need some code to look at..."}, {"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1611706645, "post_id": 54219720, "comment_id": 116536638, "body": "Looks like it is trying to compile a gui app instead of a console app. The compiler / linker flags and settings"}], "answers": [{"tags": [], "owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "is_accepted": false, "score": 0, "last_activity_date": 1547664963, "creation_date": 1547664963, "answer_id": 54223559, "question_id": 54219720, "link": "https://stackoverflow.com/questions/54219720/compile-c-collect2-exe-error-ld-returned-1-exit-status/54223559#54223559", "title": "Compile C: collect2.exe: error: ld returned 1 exit status", "body": "<p>With no code... my best guess would be you don't have <code>int main()</code> at the beginning of your program OR <code>main()</code> is named something other than <code>main</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1597695838, "creation_date": 1597695838, "answer_id": 63458128, "question_id": 54219720, "link": "https://stackoverflow.com/questions/54219720/compile-c-collect2-exe-error-ld-returned-1-exit-status/63458128#63458128", "title": "Compile C: collect2.exe: error: ld returned 1 exit status", "body": "<p>Never tried gcc for Windows, but I would compile only with:</p>\n<pre><code>gcc hello.c\n</code></pre>\n<p>or may be with:</p>\n<pre><code>gcc hello.c -o program.exe\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10771505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c5d3ead13c4df2672e9e7cfd172c50?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/10771505/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8840, "favorite_count": 0, "protected_date": 1597699332, "closed_date": 1611705965, "answer_count": 2, "score": 1, "last_activity_date": 1611705820, "creation_date": 1547650521, "last_edit_date": 1609085821, "question_id": 54219720, "link": "https://stackoverflow.com/questions/54219720/compile-c-collect2-exe-error-ld-returned-1-exit-status", "closed_reason": "Duplicate", "title": "Compile C: collect2.exe: error: ld returned 1 exit status", "body": "<p>I'm a totally beginner.</p>\n<p>I wanted to compile C by MinGW in Visual Studio Code,\nbut I got an error code at the terminal in Visual Studio Code.\nAt first, I created a file just under Windows (C:).</p>\n<p>Source code</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    printf(&quot;Hello World!&quot;);\n    return 0;\n}\n</code></pre>\n<p>Terminal</p>\n<pre><code>PS C:\\vscode&gt; gcc hello.c\ningw32/bin/ld.exe: c:/mingw/bin/../lib/gcc/mingw32/8.2.0/../../../libmingw32.a(main.o):(c:/mingw/bin/../lib/gcc/mingw32/8.2.0/../../../../mn@16'\ningw32/bin/ld.exe: c:/mingw/bin/../lib/gcc/mingw32/8.2.0/../../../libmingw32.a(main.o):(.text.startup+0xb0): undefined reference to `WinMain@16'\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 4, "creation_date": 1547649710, "post_id": 54219440, "comment_id": 95264602, "body": "Way, waaaay too much code."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1547649744, "post_id": 54219440, "comment_id": 95264630, "body": "Have you tried running under a debugger? It&#39;ll generally take you to the point where the segmentation fault occurred, with a complete snapshot of the program state at that time. If you can&#39;t do that for some reason, you can set <code>ulimit -c</code> to allow a core dump, and debug the core file instead."}, {"owner": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "edited": false, "score": 0, "creation_date": 1547649983, "post_id": 54219440, "comment_id": 95264774, "body": "there are too many places for this to go wrong. However have you changed that slice and grid_size are reasonable. even after that check there plenty of array refs that can go astray.  And these lines:   if (my_rank = A_proc)  will not do what you want them to"}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1547650099, "post_id": 54219440, "comment_id": 95264832, "body": "I would suggest using Valgrind to help determine the violation that is causing your segmentation fault"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1547650318, "post_id": 54219440, "comment_id": 95264960, "body": "Note the word <i>minimal</i> in <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Try to center the code you post around the specific problem you are asking about, even if you have to carve it up some to illustrate."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1547651065, "post_id": 54219440, "comment_id": 95265466, "body": "<i>At line 206 I send data between processors using</i> <code>MPI_Isend</code> <i>and</i> <code>MPI_Irecv</code>. <i>When testing the code i get a segmentation fault</i>.  Line 206 is hard to find.  Please mark location of seg fault in your posted code. (preferably in ALL CAPS so it is easy to find. :)"}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "edited": false, "score": 0, "creation_date": 1547651806, "post_id": 54219440, "comment_id": 95265916, "body": "edited to only include relevant bit of code and gives explanation of the variables used"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1547651824, "post_id": 54219440, "comment_id": 95265925, "body": "Now this is Minimal but no more Complete"}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1547653733, "post_id": 54219440, "comment_id": 95267081, "body": "The most obvious candidate for a crash is <code>MPI_Irecv(phi[slice+1][0] (...)</code> depending on the value of slice."}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1547654412, "post_id": 54219440, "comment_id": 95267489, "body": "Now that you&#39;ve updated the code, I&#39;d check how the calculation <code>slice = grid_size&#47;my_size;</code> turns out."}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "reply_to_user": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1547654791, "post_id": 54219440, "comment_id": 95267724, "body": "@brothir In the case of 2 processors, the value of slice was 50 as expected"}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1547655231, "post_id": 54219440, "comment_id": 95267956, "body": "@Aaron Do you know which process crashes? Put some printf before, after and in between the sends and recvs to see how far you get before it crashes."}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "reply_to_user": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1547655911, "post_id": 54219440, "comment_id": 95268372, "body": "@brothir I added a print statement after all the sends and receives. They were all printed but the error message still appears"}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "reply_to_user": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 1, "creation_date": 1547656681, "post_id": 54219440, "comment_id": 95268813, "body": "@brothir i added print statements before the each wait statements. The one place between the wait  for sreqD was not printed. Maybe a problem with MPI_Wait?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547656771, "post_id": 54219440, "comment_id": 95268867, "body": "<code>grid_res_x</code> and <code>grid_res_y</code> are <i>unitialized</i> and have random values. Particularly, this can cause <code>xboundary</code> to be [maximally] negative. This causes a segfault in <code>for (x = xboundary; x &lt; grid_size; x++) phi[y][x] = phi_0;</code>"}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547657035, "post_id": 54219440, "comment_id": 95269025, "body": "@CraigEstey I have tried initialising those variables. No change"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547657193, "post_id": 54219440, "comment_id": 95269131, "body": "Initializing those values may not be the <i>only</i> fix you need, but it <i>is</i> the first one. I&#39;m running your code here. So, what initialization values are you using?"}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547657310, "post_id": 54219440, "comment_id": 95269194, "body": "@CraigEstey I have used grid_res_x = 0.1 and grid_res_y = 0. 2."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547657664, "post_id": 54219440, "comment_id": 95269380, "body": "When I add that, I get <code>xboundary</code> is 10 and <code>yboundary</code> is 25. The program exits normally (i.e. <i>no</i> segfault). There are no <code>printf</code> for results so it&#39;s hard to say beyond that point."}, {"owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547657760, "post_id": 54219440, "comment_id": 95269438, "body": "@CraigEstey I will add the entire error message to the post and see if that helps"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1547663643, "post_id": 54219440, "comment_id": 95272398, "body": "@brothir It&#39;s <i>not</i> too much code. This is the minimal amount that actually shows the real problem."}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547668762, "post_id": 54219440, "comment_id": 95274741, "body": "@CraigEstey, the code you see in the question has been edited many times. The initial code posted was hundreds of lines."}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1547682305, "post_id": 54223141, "comment_id": 95280154, "body": "As a matter of style, you can declare an array of 4 requests <b>all</b> set to <code>MPI_REQUEST_NULL</code> at the beginning of each iteration, and then <code>MPI_Wait all(4, ...)</code>. Or you can set <code>up</code> and <code>down</code> to <code>MPI_PROC_NULL</code> on the first and last ranks and always <code>MPI_Isend()</code> and <code>MPI_Irecv()</code>."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 1, "last_activity_date": 1547663040, "creation_date": 1547663040, "answer_id": 54223141, "question_id": 54219440, "link": "https://stackoverflow.com/questions/54219440/segmentation-fault-when-using-mpi-isend/54223141#54223141", "title": "Segmentation Fault when using MPI_Isend", "body": "<p>You're faulting in the <em>first</em> <code>MPI_Wait</code> (for rank 0). This is step 7 in the example code below.</p>\n\n<p>Using <code>mpirun -np 2 ./whatever</code>:</p>\n\n<p>It appears that <code>sReqD</code> is <em>not</em> being set correctly. This is set at step 5 by rank 1.</p>\n\n<p>But, step 7 is being executed by rank 0, which does <em>not</em> set <code>sReqD</code>.</p>\n\n<p>So, you need to adjust your <code>if</code> statements to match up correctly for which rank does which <code>MPI_Wait</code>, etc.</p>\n\n<hr>\n\n<p>Here is your code with some debug <code>printf</code> statements:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;mpi.h&gt;\n\nint\nmain(int argc, char *argv[])\n{\n    /* MPI Specific Variables */\n    int my_size,\n     my_rank,\n     up,\n     down;\n    MPI_Request reqU,\n     reqD,\n     sreqU,\n     sreqD;\n    MPI_Status rUstatus,\n     rDstatus,\n     sUstatus,\n     sDstatus;\n\n    /* Physical Dimensions */\n    double Linner = 5.0;                /* mm */\n    double Rinner = 1.0;                /* mm */\n    double phi_0 = 1000.0;\n\n    /*V*/\n        /* Other Variables */\n    int grid_size = 100;\n    int slice;\n    int x,\n     y;\n    double grid_res_y = 0.2;\n    double grid_res_x = 0.1;\n\n    int xboundary,\n     yboundary;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;my_rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;my_size);\n\n    /* Determining neighbours */\n    /* if statemets used to stop highest and lowest rank neighbours arent\n    outside 0 - my_size-1 range of ranks */\n    if (my_rank != 0) {\n        up = my_rank - 1;\n    }\n    else {\n        up = 0;\n    }\n\n    if (my_rank != my_size - 1) {\n        down = my_rank + 1;\n    }\n    else {\n        down = my_size - 1;\n    }\n\n    printf(\"my_rank=%d my_size=%d up=%d down=%d\\n\",my_rank,my_size,up,down);\n\n    /* cross-check: presumed my_size is a factor of gridsize else there are\n    odd sized slices and this is not coded for */\n    if (grid_size % my_size != 0) {\n        printf(\"ERROR - number of procs =  %d, this is not a factor of grid_size %d\\n\", my_size, grid_size);\n        exit(0);\n    }\n\n    /* Set Up Distributed Data Approach */\n    slice = grid_size / my_size;\n\n    /* y grid index of inner conductor wall */\n    yboundary = Linner / grid_res_y;\n    /* x grid and individual array index of inner conductor wall */\n    xboundary = Rinner / grid_res_x;\n\n    if (my_rank == 0) {\n        printf(\"Linner=%g grid_res_y=%g yboundary=%d\\n\",\n            Linner,grid_res_y,yboundary);\n        printf(\"Rinner=%g grid_res_x=%g xboundary=%d\\n\",\n            Rinner,grid_res_x,xboundary);\n        printf(\"slice=%d grid_size=%d phi=%ld\\n\",\n            slice,grid_size,sizeof(double) * (slice + 2) * grid_size);\n    }\n\n    /* extra 2 rows to allow for halo data */\n    double phi[slice + 2][grid_size];\n\n    for (y = 0; y &lt; slice + 2; y++) {\n        for (x = 0; x &lt; grid_size; x++) {\n            phi[y][x] = 0.0;\n        }\n    }\n\n    /* Boundary Containing rank does 2 loops. One over part with inner\n    conductor and one over part without inner conductor */\n    if (my_rank == 0) {\n        for (y = 0; y &lt; slice + 1; y++) {\n            for (x = xboundary; x &lt; grid_size; x++) {\n                phi[y][x] = phi_0;\n            }\n        }\n    }\n\n    if (my_rank &lt; my_size - 1) {\n        /* send top most strip up one node to be recieved as bottom halo */\n        printf(\"1: my_rank=%d MPI_Isend\\n\",my_rank);\n        MPI_Isend(&amp;phi[1][0], grid_size, MPI_DOUBLE, down, 1, MPI_COMM_WORLD,\n            &amp;sreqU);\n\n        /* recv top halo from up one node */\n        printf(\"2: my_rank=%d MPI_Irecv\\n\",my_rank);\n        MPI_Irecv(&amp;phi[slice + 1][0], grid_size, MPI_DOUBLE, down, 2,\n            MPI_COMM_WORLD, &amp;reqU);\n\n        printf(\"3: my_rank=%d\\n\",my_rank);\n    }\n\n    if (my_rank &gt; 0) {\n        /* recv top halo from down one node */\n        printf(\"4: my_rank=%d MPI_Irecv\\n\",my_rank);\n        MPI_Irecv(&amp;phi[0][0], grid_size, MPI_DOUBLE, up, 2, MPI_COMM_WORLD,\n            &amp;reqD);\n\n        /* send bottom most strip down one node to be recieved as top halo */\n        printf(\"5: my_rank=%d MPI_Isend\\n\",my_rank);\n        MPI_Isend(&amp;phi[slice][0], grid_size, MPI_DOUBLE, up, 1, MPI_COMM_WORLD,\n            &amp;sreqD);\n\n        printf(\"6: my_rank=%d\\n\",my_rank);\n    }\n\n    if (my_rank &lt; my_size - 1) {\n        /* Wait for send to down one rank to complete */\n        printf(\"7: my_rank=%d\\n\",my_rank);\n        MPI_Wait(&amp;sreqD, &amp;sDstatus);\n        printf(\"8: my_rank=%d\\n\",my_rank);\n\n        /* Wait for recieve from up one rank to complete */\n        printf(\"9: my_rank=%d\\n\",my_rank);\n        MPI_Wait(&amp;reqD, &amp;rDstatus);\n        printf(\"10: my_rank=%d\\n\",my_rank);\n    }\n\n    if (my_rank &gt; 0) {\n        /* Wait for send to up down one rank to complete */\n        printf(\"11: my_rank=%d\\n\",my_rank);\n        MPI_Wait(&amp;sreqU, &amp;sUstatus);\n        printf(\"12: my_rank=%d\\n\",my_rank);\n\n        /* Wait for recieve from down one rank to complete */\n        printf(\"12: my_rank=%d\\n\",my_rank);\n        MPI_Wait(&amp;reqU, &amp;rUstatus);\n        printf(\"13: my_rank=%d\\n\",my_rank);\n    }\n\n    MPI_Finalize();\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Here is the output. Notice that step 7 prints (which is <em>before</em> the first <code>MPI_Wait</code> for rank 0). But, rank 0 never gets to step 8 (the <code>printf</code> <em>after</em> that call)</p>\n\n<pre><code>my_rank=0 my_size=2 up=0 down=1\nLinner=5 grid_res_y=0.2 yboundary=25\nRinner=1 grid_res_x=0.1 xboundary=10\nslice=50 grid_size=100 phi=41600\n1: my_rank=0 MPI_Isend\n2: my_rank=0 MPI_Irecv\n3: my_rank=0\n7: my_rank=0\nmy_rank=1 my_size=2 up=0 down=1\n4: my_rank=1 MPI_Irecv\n5: my_rank=1 MPI_Isend\n6: my_rank=1\n11: my_rank=1\n[manderly:230404] *** Process received signal ***\n[manderly:230403] *** Process received signal ***\n[manderly:230403] Signal: Segmentation fault (11)\n[manderly:230403] Signal code: Address not mapped (1)\n[manderly:230403] Failing at address: 0x58\n[manderly:230404] Signal: Segmentation fault (11)\n[manderly:230404] Signal code: Address not mapped (1)\n[manderly:230404] Failing at address: 0x58\n[manderly:230403] [ 0] [manderly:230404] [ 0] /lib64/libpthread.so.0(+0x121c0)/lib64/libpthread.so.0(+0x121c0)[0x7fa5478341c0]\n[0x7fa0ebe951c0]\n[manderly:230404] [ 1] [manderly:230403] [ 1] /usr/lib64/openmpi/lib/libmpi.so.20(ompi_request_default_wait+0x31)[0x7fa0ec0e9a81]\n[manderly:230404] [ 2] /usr/lib64/openmpi/lib/libmpi.so.20(ompi_request_default_wait+0x31)[0x7fa547a88a81]\n[manderly:230403] [ 2] /usr/lib64/openmpi/lib/libmpi.so.20(PMPI_Wait+0x60)[0x7fa0ec12c350]\n[manderly:230404] [ 3] ./fix2[0x400f93]\n[manderly:230404] [ 4] /usr/lib64/openmpi/lib/libmpi.so.20(PMPI_Wait+0x60)[0x7fa547acb350]\n[manderly:230403] [ 3] ./fix2[0x400ef7]\n/lib64/libc.so.6(__libc_start_main+0xea)[0x7fa0ebaedfea]\n[manderly:230404] [ 5] ./fix2[0x40081a[manderly:230403] [ 4] ]\n[manderly:230404] *** End of error message ***\n/lib64/libc.so.6(__libc_start_main+0xea)[0x7fa54748cfea]\n[manderly:230403] [ 5] ./fix2[0x40081a]\n[manderly:230403] *** End of error message ***\n--------------------------------------------------------------------------\nmpirun noticed that process rank 0 with PID 0 on node manderly exited on signal 11 (Segmentation fault).\n--------------------------------------------------------------------------\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4567523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VUoR0.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4567523/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 54223141, "answer_count": 1, "score": 1, "last_activity_date": 1547663040, "creation_date": 1547649550, "last_edit_date": 1547657876, "question_id": 54219440, "link": "https://stackoverflow.com/questions/54219440/segmentation-fault-when-using-mpi-isend", "title": "Segmentation Fault when using MPI_Isend", "body": "<p>The aim of my program is calculate the electrostatic potential between an inner conductor and an outer conductor by splitting it up into a grid and then into grid slices. Each processor gets a slice and runs the calculations on each slice. I send data between processors using MPI_Isend and MPI_Irecv. When testing the code I get a segmentation fault:</p>\n\n<pre><code>[physnode5:81440] *** Process received signal ***\n[physnode5:81440] Signal: Segmentation fault (11)\n[physnode5:81440] Signal code: Address not mapped (1)\n[physnode5:81440] Failing at address: 0x58\n[physnode5:81440] [ 0] /lib64/libpthread.so.0(+0xf5d0)[0x2ab8069df5d0]\n[physnode5:81440] [ 1] /opt/yarcc/libraries/openmpi/2.1.0/1/default/lib/libmpi.so.20(ompi_request_default_wait+0xd)[0x2ab8066495ed]\n[physnode5:81440] [ 2] /opt/yarcc/libraries/openmpi/2.1.0/1/default/lib/libmpi.so.20(MPI_Wait+0x5d)[0x2ab80667a00d]\n[physnode5:81440] [ 3] ./mpi_tezt.exe[0x400ffc]\n[physnode5:81440] [ 4] /lib64/libc.so.6(__libc_start_main+0xf5)[0x2ab806c0e3d5]\n[physnode5:81440] [ 5] ./mpi_tezt.exe[0x4009b9]\n[physnode5:81440] *** End of error message ***\n</code></pre>\n\n<p>when this bit of code is executed. please not i have ssh'ed into a cluster. The file name is mpi_tezt.exe (yes i mispelled it).\nI have checked the arrays I want to send are correctly allocated and the send and recv are not sending or receiving data that isn't there (i.e sending data outside range of array.\nMy code for the MPI_Isend and MPI_Irecv is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;mpi.h&gt;\n\nint main(int argc, char *argv[])\n{\n  /*MPI Specific Variables*/\n  int my_size, my_rank, up, down;\n  MPI_Request reqU, reqD, sreqU, sreqD;\n  MPI_Status rUstatus, rDstatus, sUstatus, sDstatus;\n\n   /*Physical Dimensions*/\n  double Linner = 5.0;/*mm*/\n  double Rinner = 1.0;/*mm*/\n  double phi_0 = 1000.0;/*V*/\n\n  /*Other Variables*/\n  int grid_size = 100;\n  int slice;\n  int x,y;\n  double grid_res_y = 0.2;\n  double grid_res_x = 0.1;\n  int xboundary, yboundary;\n\n  MPI_Init(&amp;argc, &amp;argv);\n  MPI_Comm_rank(MPI_COMM_WORLD, &amp;my_rank);\n  MPI_Comm_size(MPI_COMM_WORLD, &amp;my_size);\n\n  /*Determining neighbours*/\n  if (my_rank != 0) /*if statemets used to stop highest and lowest rank neighbours arent outside 0 - my_size-1 range of ranks*/\n    {\n      up = my_rank-1;\n    }\n  else\n    {\n      up = 0;\n    }\n\n  if(my_rank != my_size-1)\n    {\n      down = my_rank+1;\n    }\n  else\n    {\n      down = my_size-1;\n    }\n\n  /*cross-check: presumed my_size is a factor of gridsize else there are odd sized slices and this is not coded for*/\n  if (grid_size%my_size != 0)\n    {\n      printf(\"ERROR - number of procs =  %d, this is not a factor of grid_size %d\\n\", my_size, grid_size);\n      exit(0);\n    }\n\n  /*Set Up Distributed Data Approach*/\n  slice = grid_size/my_size;\n\n  yboundary = Linner/grid_res_y; /*y grid index of inner conductor wall*/ \n  xboundary = Rinner/grid_res_x; /*x grid and individual array index of inner conductor wall*/\n\n\n  double phi[slice+2][grid_size]; /*extra 2 rows to allow for halo data*/\n\n  for (y=0; y &lt; slice+2; y++)\n    {\n      for (x=0; x &lt; grid_size; x++)\n        { \n          phi[y][x] = 0.0;\n        }\n    }\n\n  if(my_rank == 0) /*Boundary Containing rank does 2 loops. One over part with inner conductor and one over part without inner conductor*/\n    {\n      for(y=0; y &lt; slice+1; y++)\n        {\n          for(x=xboundary; x &lt; grid_size; x++)\n            {\n              phi[y][x] = phi_0;\n            }\n        }   \n    }\n\n\n  if (my_rank &lt; my_size-1)\n    {\n      /*send top most strip up one node to be recieved as bottom halo*/\n      MPI_Isend(&amp;phi[1][0], grid_size  , MPI_DOUBLE, down, 1, MPI_COMM_WORLD, &amp;sreqU);  \n      /*recv top halo from up one node*/\n      MPI_Irecv(&amp;phi[slice+1][0], grid_size, MPI_DOUBLE, down, 2, MPI_COMM_WORLD, &amp;reqU);\n    }\n\n  if (my_rank &gt; 0)\n    {\n      /*recv top halo from down one node*/\n      MPI_Irecv(&amp;phi[0][0], grid_size , MPI_DOUBLE, up, 2, MPI_COMM_WORLD, &amp;reqD);\n      /*send bottom most strip down one node to be recieved as top halo*/\n      MPI_Isend(&amp;phi[slice][0], grid_size , MPI_DOUBLE, up, 1, MPI_COMM_WORLD, &amp;sreqD);\n    }\n\n  if (my_rank&lt;my_size-1)\n    {\n      /*Wait for send to down one rank to complete*/\n      MPI_Wait(&amp;sreqD, &amp;sDstatus);\n      /*Wait for recieve from up one rank to complete*/\n      MPI_Wait(&amp;reqD, &amp;rDstatus);\n    }\n\n  if (my_rank&gt;0)\n    {\n      /*Wait for send to up down one rank to complete*/\n      MPI_Wait(&amp;sreqU, &amp;sUstatus);\n      /*Wait for recieve from down one rank to complete*/\n      MPI_Wait(&amp;reqU, &amp;rUstatus);\n    }\n\n\n  MPI_Finalize();\n\n  return 0;\n}\n</code></pre>\n\n<p>I have been testing on 2 processors (ranks 0 and 1) with the hope of extending it to more.</p>\n\n<p>Any ideas where the fault may lie?</p>\n"}, {"tags": ["c", "pointers", "int", "malloc", "realloc"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547669193, "post_id": 54219248, "comment_id": 95274939, "body": "regarding: <code>int scanf_result = scanf(&quot;%i&quot;, &amp;value);     if (scanf_result)</code>  the returned value from &#39;this&#39; call to <code>scanf()</code>  can return 0, 1, or EOF.  So the <code>if()</code> statement is not valid.  It should be: <code>if( scanf_result == 1 )</code>  Any other returned value indicates an error occurred."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547669517, "post_id": 54219248, "comment_id": 95275072, "body": "regarding: <code>array = (int*) realloc (array, lastIndex * sizeof(int));</code>  1) in C, the returned value from <code>malloc</code>, <code>calloc</code> and <code>realloc</code>  has type <code>void*</code> which can be assigned to any pointer,   Casting just clutters the code, making it more difficult to understand, debug, etc.  2) When calling <code>realloc()</code>, never assign the returned value directly to the target pointer.  Rather assign to a &#39;temp&#39; variable, then check (!=NULL) and if successful, then assign the target pointer from the temp pointer.  Otherwise when <code>realloc()</code> fails the original pointer is lost, resulting in a memory leak"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547669970, "post_id": 54219248, "comment_id": 95275304, "body": "regarding: <code>printf (&quot;Insert a positive number. Insert a negative number or \\&quot;e\\&quot; to exit:  &quot;);</code>  which suggests to enter &#39;e&#39;.  That &#39;e&#39; will never by input by the statement: <code>if (scanf_result) {</code> due to the format string: &quot;%i&quot;.  However, that may be handled correctly by the program.  However, if the user enters &lt;ctrl-d&gt; (or &lt;ctrl-z&gt;) depending on the OS, that will be seen as a valid input"}], "answers": [{"tags": [], "owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "is_accepted": false, "score": 0, "last_activity_date": 1547649283, "creation_date": 1547649283, "answer_id": 54219351, "question_id": 54219248, "link": "https://stackoverflow.com/questions/54219248/recursive-realloc-throw-invalid-next-size-after-the-7th-cicle/54219351#54219351", "title": "Recursive realloc() throw &quot;invalid next size&quot; after the 7th cicle", "body": "<p>Fix your <code>realloc</code>:</p>\n\n<pre><code>array = (int*) realloc (array, (lastIndex + 1) * sizeof(int))\n</code></pre>\n\n<p>You are allocating one item less than you need to.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1547649321, "creation_date": 1547649321, "answer_id": 54219357, "question_id": 54219248, "link": "https://stackoverflow.com/questions/54219248/recursive-realloc-throw-invalid-next-size-after-the-7th-cicle/54219357#54219357", "title": "Recursive realloc() throw &quot;invalid next size&quot; after the 7th cicle", "body": "<p>You're not reallocating enough memory:</p>\n\n<pre><code>array = (int*) realloc (array, lastIndex * sizeof(int));\n</code></pre>\n\n<p>On the first iteration of the loop, <code>lastIndex</code> is incremented from 0 to 1, then you run the above <code>realloc</code> call.  Since <code>lastIndex</code> is 1, you still only have enough space for 1 element.  As a result, you write past the end of allocated memory on the next iteration.  </p>\n\n<p>This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which in your case manifests as appearing to work properly for the first 6 iterations and failing on the 7th.  It could have just as easily crashed on the first or second iteration.</p>\n\n<p>Add one to the size you're allocating:</p>\n\n<pre><code>array = realloc(array, (lastIndex + 1) * sizeof(int));\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don't cast the return value of <code>malloc</code>/<code>realloc</code></a>.</p>\n"}], "owner": {"reputation": 41, "user_id": 10829865, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tkh-dRMqRJs/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbXrNNqUxMItn-kQ6mnLPsdNhLGvQ/mo/photo.jpg?sz=128", "display_name": "Porcospino Puzzolente", "link": "https://stackoverflow.com/users/10829865/porcospino-puzzolente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 54219357, "answer_count": 2, "score": 2, "last_activity_date": 1547649321, "creation_date": 1547648913, "last_edit_date": 1547649071, "question_id": 54219248, "link": "https://stackoverflow.com/questions/54219248/recursive-realloc-throw-invalid-next-size-after-the-7th-cicle", "title": "Recursive realloc() throw &quot;invalid next size&quot; after the 7th cicle", "body": "<p>So, I have a pointer which need to increase it's \"length\" until the user insert a negative number or \"e\". It starts with the length of \"1\", via a <code>malloc()</code> then I use into a <code>do{...} while(...)</code> loop the <code>realloc()</code> function to increase its lenght. Here's the code:</p>\n\n<pre><code>int *array = malloc (sizeof(int) * 1);\nbool exit = false;\nint lastIndex = 0, value;\n\ndo {\n    printf (\"Insert a positive number. Insert a negative number or \\\"e\\\" to exit:  \");\n\n    int scanf_result = scanf(\"%i\", &amp;value);\n    if (scanf_result) {\n      if (value &gt;= 0) {\n        array[lastIndex] = value;\n        lastIndex++;\n        array = (int*) realloc (array, lastIndex * sizeof(int));\n      } else {\n        exit = true;\n      }\n    } else {\n      exit = true;\n    }\n} while (!exit);\n</code></pre>\n\n<p>I can't figure out why after the 7th cicle it exit with the error <code>realloc(): invalid next size</code>.</p>\n\n<p>Any idea? Thanks in advice for help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 7, "creation_date": 1547648548, "post_id": 54219110, "comment_id": 95263804, "body": "What do you envision that cast should do then?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 4, "creation_date": 1547648626, "post_id": 54219110, "comment_id": 95263856, "body": "An <code>&#236;nt</code> can&#39;t hold fractions. This comes from the definition of what an &quot;integer&quot; is in math and is kept that way in computer science. <a href=\"https://www.mathsisfun.com/definitions/integer.html\" rel=\"nofollow noreferrer\">mathsisfun.com/definitions/integer.html</a>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1547648636, "post_id": 54219110, "comment_id": 95263864, "body": "Note:a double has 53bits mantissa. (and a range that exceeds INT_MIN -- INT_MAX)"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1547648755, "post_id": 54219110, "comment_id": 95263942, "body": "@wildplasser ... in the most common (IEEE) representation"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1547648886, "post_id": 54219110, "comment_id": 95264023, "body": "@TobySpeight  yes. (I don&#39;t assume the OP is living on a VAX or a CRAY)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1547649236, "post_id": 54219110, "comment_id": 95264278, "body": "It is truncated, not rounded. If you need floating point, then why do you cast to fixed point?"}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 1, "creation_date": 1547649475, "post_id": 54219110, "comment_id": 95264453, "body": "it&#39;s truncated, and to obtain it rounded just do: <code>v = (int)(decpart * 1000. + 0.5);</code> - The OP would like to get 3 digits fractional part as an int. Some adjustment needed to handle negative numbers probably."}, {"owner": {"reputation": 303, "user_id": 9750048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21cfd026d734661c84cbd0ab78bf0e0?s=128&d=identicon&r=PG&f=1", "display_name": "7hsk", "link": "https://stackoverflow.com/users/9750048/7hsk"}, "reply_to_user": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1547650741, "post_id": 54219110, "comment_id": 95265264, "body": "@Sigismondo This solution also works perfectly, i no understand the purpose of <code>+ 0.5</code>"}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1547652461, "post_id": 54219110, "comment_id": 95266298, "body": "since it works perfectly, what were you asking for??? I mean, with + 0.5 you get correct <i>rounding</i> instead of <i>truncation</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1547656246, "post_id": 54219110, "comment_id": 95268579, "body": "@Sigismondo <code>(int)(decpart * 1000. + 0.5)</code> fails for various cases; the worst of which when <code>decpart &gt; 0.9995</code> as <code>10.9996</code> would print  as 10.1000.  It fails to round the right direction for -0.xxx5, Also fails the corner case of the value just below 0.5 due to rounding."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547656613, "post_id": 54219110, "comment_id": 95268787, "body": "@7hsk To print a <code>double</code> with 3 places right of the decimal point, use <code>printf(&quot;%0.3f&quot;, nb);</code>.  Or is this code only for investigation purposes?"}, {"owner": {"reputation": 303, "user_id": 9750048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21cfd026d734661c84cbd0ab78bf0e0?s=128&d=identicon&r=PG&f=1", "display_name": "7hsk", "link": "https://stackoverflow.com/users/9750048/7hsk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547660293, "post_id": 54219110, "comment_id": 95270780, "body": "@chux I&#39;m trying to replicate the fonction"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1547649122, "creation_date": 1547649122, "answer_id": 54219302, "question_id": 54219110, "link": "https://stackoverflow.com/questions/54219110/cast-double-to-int-without-rounding/54219302#54219302", "title": "cast double to int without rounding", "body": "<p>A <code>double</code> cannot exactly encoded all numbers.  It can exactly encoded about 2<sup>64</sup> different values.  <code>-10.754</code> is not one of them.  Instead a nearby value is used just less than expected.</p>\n\n<pre><code>printf(\"%.24f\", -10.754);\n// -10.753999999999999559463504\n</code></pre>\n\n<p>The <code>decpart * 1000</code> part introduces some imprecision yet the product is still below 754.0 and then the <code>(int)</code> cast makes that 753.</p>\n"}], "owner": {"reputation": 303, "user_id": 9750048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21cfd026d734661c84cbd0ab78bf0e0?s=128&d=identicon&r=PG&f=1", "display_name": "7hsk", "link": "https://stackoverflow.com/users/9750048/7hsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 54219302, "answer_count": 1, "score": 2, "last_activity_date": 1547655452, "creation_date": 1547648484, "last_edit_date": 1547655452, "question_id": 54219110, "link": "https://stackoverflow.com/questions/54219110/cast-double-to-int-without-rounding", "title": "cast double to int without rounding", "body": "<p>i don't understand why when i try to cast my double to int the values \u200b\u200bafter the commas are rounded..</p>\n\n<pre><code>void print_float(double nb)\n{\n    int negative;\n    int intpart;\n    double decpart = -10.754;\n    int v;\n\n    negative = (nb &lt; 0.0f);\n    intpart = (int)nb;\n    decpart = nb - intpart;\n    v = (int)(decpart * 1000);\n\n    if (negative) {\n        v *= -1;\n    }\n\n    printf(\"%i.%i\", intpart, v); // output: -10.753\n}\n</code></pre>\n\n<p>I guess after thinking that the worries come from the cast, but I do not understand the problem..</p>\n"}, {"tags": ["c", "stm32", "ethernet", "arp"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547647622, "post_id": 54218490, "comment_id": 95263183, "body": "The ethernet protocol type ETH_P_ARP follows the hardware address type, which is 0x0001 (ethernet), not 0x0002."}, {"owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547648560, "post_id": 54218490, "comment_id": 95263812, "body": "I wrote here 0x02 but i am using 0x01 but again can not success"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1547654374, "post_id": 54218490, "comment_id": 95267463, "body": "ARP gives you MAC from IP, not IP from MAC.  Unless the target has the target IP, it should not answer."}, {"owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "edited": false, "score": 0, "creation_date": 1547704502, "post_id": 54218490, "comment_id": 95284658, "body": "how can I get the IP for Stm32 with enc28j60 ?"}, {"owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1547706493, "post_id": 54218490, "comment_id": 95285277, "body": "@stark But the MAC address has already known because two devices connected same ethernet line. Is that true ? Stm32 and my computer connect with ethernet cable, so Have they same address ?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1547768369, "post_id": 54218490, "comment_id": 95316217, "body": "Two devices with the same MAC canot communicate.  How would you know which device you are addressing?"}, {"owner": {"reputation": 281, "user_id": 5719169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d9aca7110c69ad4ee2b05dd2812f894?s=128&d=identicon&r=PG&f=1", "display_name": "NetworkStudent", "link": "https://stackoverflow.com/users/5719169/networkstudent"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1548140177, "post_id": 54218490, "comment_id": 95425336, "body": "@stark How can I find IP addres for my stm32 ? If my computer connect with wi fi and I send to my computer arp protocole is that a true way?"}], "owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547648518, "creation_date": 1547646545, "last_edit_date": 1547648518, "question_id": 54218490, "link": "https://stackoverflow.com/questions/54218490/how-to-get-ip-for-stm32", "title": "How to get IP for stm32?", "body": "<p>I want to get IP adress for my STM32.So I am using ARP ethernet protocole frame.</p>\n\n<p>X-> refer to my MAC\nY->Refer to IP address</p>\n\n<p>I connected ethernet cable between the stm32 and computer so, mac address are same for both of them. I choose empty IP addres for STM32 (yy.yy.yy.3 example) \nAnd than I use \"ping yy.yy.yy.3\" command line at the terminal so start the ARP requests. And I want to answer this request but any answer couldnt see on wireshark. Where is my mistake ?</p>\n\n<p>Send answer with this line </p>\n\n<pre><code>   while (1)\n            {\n                enc28_packetSend(ARP_req, 42);\n            }\n</code></pre>\n\n<p>This is ARP ethernet  packet:</p>\n\n<pre><code>unsigned char ARP_req[42] = {\n    0xxx, 0xxx, 0xxx, 0xxx, 0xxx, 0xxx, /* ff:ff:ff:ff:ff:ff dst mac */\n    0xxx, 0xxx, 0xxx, 0xxx, 0xxx, 0xxx, /* src mac */\n    0x08, 0x06,                         /* ETH_P_ARP */\n    0x00, 0x01,                         /*  ANSWER  */\n    0x08, 0x00,                         /* ETH_P_IP */\n    0x06,                               /* ETH_ALEN */\n    0x04,                               /* 4 */\n    0x00, 0x02,                         /* ARPOP_REQUEST */\n    0xxx, 0xxx, 0xxx, 0xxx, 0xxx, 0xxx /* ar_sha */\n    0xyy, 0xyy, 0xyy, 0x03,             /* i\n    0xxx, 0xxx, 0xxx, 0xxx, 0xxx, 0xxx, /* ff:ff:ff:ff:ff:ff ar_tha */\n    0x0a, 0x2a, 0x00, 0x01              /* */\n};\n</code></pre>\n\n<p>And this is send function for enc28j60</p>\n\n<pre><code>void enc28_packetSend(unsigned char *packet, unsigned int len)\n{\n\n\n    uint8_t retry = 0;\n\n    while (1)\n    {\n        enc28_writeOp(ENC28J60_BIT_FIELD_SET, ECON1, ECON1_TXRST);\n        enc28_writeOp(ENC28J60_BIT_FIELD_CLR, ECON1, ECON1_TXRST);\n        enc28_writeOp(ENC28J60_BIT_FIELD_CLR, EIR, EIR_TXERIF | EIR_TXIF);\n        if (retry == 0)\n        {\n            enc28_write(EWRPTL, TXSTART_INIT &amp; 0xFF);\n            enc28_write(EWRPTH, TXSTART_INIT &gt;&gt; 8);\n\n            enc28_write(ETXNDL, (TXSTART_INIT + len) &amp; 0xFF);\n            enc28_write(ETXNDH, (TXSTART_INIT + len) &gt;&gt; 8);\n\n            enc28_writeOp(ENC28J60_WRITE_BUF_MEM, 0, 0x00);\n\n            enc28_writeBuf(packet, len);\n        }\n        enc28_writeOp(ENC28J60_BIT_FIELD_SET, ECON1, ECON1_TXRTS);\n        uint16_t count = 0;\n        while ((enc28_read(EIR) &amp; (EIR_TXIF | EIR_TXERIF)) == 0 &amp;&amp; ++count &lt; 1000U)\n            //  GPIO_SetBits(GPIOE, GPIO_Pin_9);\n\n            ;\n        if (!(enc28_read(EIR) &amp; EIR_TXERIF) &amp;&amp; count &lt; 1000U)\n        {\n\n            //no error start new trasnmission\n            // GPIO_SetBits(GPIOE, GPIO_Pin_9);\n            break;\n        }\n        enc28_writeOp(ENC28J60_BIT_FIELD_CLR, ECON1, ECON1_TXRTS);\n        break;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "io"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1547645438, "post_id": 54218063, "comment_id": 95261844, "body": "It works fine for me if I have <code>char *formattedTime = &quot;Wed Jan 16&quot;;</code>.  Please update your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that reproduces the problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1547645452, "post_id": 54218063, "comment_id": 95261849, "body": "Can you please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us? Something we can copy-paste to try ourselves?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1547645665, "post_id": 54218063, "comment_id": 95261977, "body": "What is the exact value of <code>formattedTime</code> and how is it obtained?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1547646038, "post_id": 54218063, "comment_id": 95262207, "body": "You need to check the return value of <code>strftime</code> too. If it returns 0 the contents of the buffer are undefined."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1547646530, "post_id": 54218063, "comment_id": 95262505, "body": "The <code>read</code> call doesn&#39;t att the null-terminator to the string you read. Because of that you will have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a> when calling <code>strftime</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1547646611, "post_id": 54218063, "comment_id": 95262565, "body": "Furthermore, <i>never</i> read format strings from a user. That is an enormous security hole."}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 3, "last_activity_date": 1547646000, "last_edit_date": 1547646000, "creation_date": 1547645534, "answer_id": 54218195, "question_id": 54218063, "link": "https://stackoverflow.com/questions/54218063/semantically-identical-codes-give-different-results/54218195#54218195", "title": "Semantically identical codes give different results", "body": "<p>If you really have that behavior this probably means the null character is missing in <em>formattedTime</em> and by chance <em>n</em> is just after in the stack and introduces a null char by its presence, or an equivalent because of the data saved in the stack</p>\n"}, {"comments": [{"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "edited": false, "score": 0, "creation_date": 1547646676, "post_id": 54218404, "comment_id": 95262605, "body": "Alright then, I just wanna get this out of the way: When I input <code>%a %b %d[ENTER KEY]</code> what does <code>read</code> actually read ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "edited": false, "score": 0, "creation_date": 1547646804, "post_id": 54218404, "comment_id": 95262689, "body": "@monolith937 It reads a total of 9 characters (the 8 characters of the format plus a newline) and puts that into <code>format</code>.  It does <i>not</i> write a null byte because it doesn&#39;t know it&#39;s reading a string."}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "edited": false, "score": 0, "creation_date": 1547646947, "post_id": 54218404, "comment_id": 95262777, "body": "so when using <code>read</code> to fetch something that I need as a string for later, I should always (manually) insert a <code>\\0</code> byte at the end ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "edited": false, "score": 1, "creation_date": 1547647020, "post_id": 54218404, "comment_id": 95262829, "body": "@monolith937 Correct.  As such, you should instead use something like <code>fgets</code> which it intended to read strings, ex. <code>fgets(format, sizeof(format), stdin);</code>"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1547646300, "creation_date": 1547646300, "answer_id": 54218404, "question_id": 54218063, "link": "https://stackoverflow.com/questions/54218063/semantically-identical-codes-give-different-results/54218404#54218404", "title": "Semantically identical codes give different results", "body": "<p>The <code>read</code> function is primarily intended to read binary data, not strings.  As such, it reads only the characters you enter (i.e. a sequence of characters followed by a newline) without adding a null terminating byte.  As a result, you don't have a properly formatted string, so using <code>strftime</code> can read past what was written into bytes that were not initialized and possibly past the end of the array.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>The \"right version\" seems to work because you got \"lucky\".  That's one of the ways undefined behavior can manifest itself.  Other people could see the opposite results of what you see.</p>\n\n<p>You need to capture how many bytes were read and manually add a terminating null byte to the array:</p>\n\n<pre><code>int rval;\n\nif ((rval=read(STDIN_FILENO, format, 49)) &lt; 0)\n    fatalError(\"read() error\");\n\n format[rval] = 0;\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1547656105, "accepted_answer_id": 54218404, "answer_count": 2, "score": -1, "last_activity_date": 1547646300, "creation_date": 1547645132, "last_edit_date": 1547645747, "question_id": 54218063, "link": "https://stackoverflow.com/questions/54218063/semantically-identical-codes-give-different-results", "closed_reason": "Not suitable for this site", "title": "Semantically identical codes give different results", "body": "<p>I couldn't wrap my head around this one, hope the title isn't too misleading. Why does <code>write</code> behave differently when it comes to it's third argument <code>count</code> in the two snippets of code? It would seem that calling a function instead of specifying a number in <code>write</code> is a bad thing, but it doesn't seem like a big deal. </p>\n\n<p>Wrong version:</p>\n\n<pre><code>   int main(int argc, char const *argv[])\n{\n\n    char    format[50];         \n    char    formattedTime[50];  \n    time_t      t;              \n\n\n\n    if (read(STDIN_FILENO, format, 50) &lt; 0)\n        fatalError(\"read() error\");\n\n\n\n    time(&amp;t);   \n\n    strftime(formattedTime, 50, format, localtime(&amp;t));\n\n\n    if (write(STDOUT_FILENO, formattedTime, strlen(formattedTime) + 1) != strlen(formattedTime) + 1)\n        fatalError(\"write() error\");\n\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Right version:</p>\n\n<pre><code>   int main(int argc, char const *argv[])\n{\n\n    char    format[50];         //zeljeni format\n    char    formattedTime[50];  //formatirano vreme\n    time_t      t;              // trenutno vreme\n\n    // citamo s ulaza zeljeni format vremena\n\n    if (read(STDIN_FILENO, format, 50) &lt; 0)\n        fatalError(\"read() error\");\n\n\n    // zapisujemo trenutno vreme\n    time(&amp;t);   \n\n    strftime(formattedTime, 50, format, localtime(&amp;t));\n\n    int n;\n    n = strlen(formattedTime) + 1;\n\n    // ispisujemo na izlaz\n    if (write(STDOUT_FILENO, formattedTime, n) != n)\n        fatalError(\"write() error\");\n\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Right output:</p>\n\n<pre><code>%a %b %d\nWed Jan 16\n</code></pre>\n\n<p>Wrong output:</p>\n\n<pre><code>%a %b %d\nWed Jan 16\n0\n</code></pre>\n\n<p>Why would calcuating <code>n</code> just a step before the call to <code>write</code> make all the difference?</p>\n\n<p><strong>EDIT:</strong>\nHope this satisfies all the info. The gibberish is different every time, but the point remains.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547666692, "post_id": 54217746, "comment_id": 95273790, "body": "going above the 1 meg mark overflows the stack area in Windows"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10922188, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kx8WibK68Fo/AAAAAAAAAAI/AAAAAAAAAG8/DOxaN5uMkN8/photo.jpg?sz=128", "display_name": "stein66", "link": "https://stackoverflow.com/users/10922188/stein66"}, "edited": false, "score": 0, "creation_date": 1548168801, "post_id": 54223738, "comment_id": 95441595, "body": "I have been playing some more with COFF object files, and from my observations it seems that symbols marked as &quot;Common&quot; should have their symbol value interpreted as the symbol size, not the symbol address. Unless some heuristics are used by llvm-nm/llvm-readobj to derive the size information from address information..."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "reply_to_user": {"reputation": 1, "user_id": 10922188, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kx8WibK68Fo/AAAAAAAAAAI/AAAAAAAAAG8/DOxaN5uMkN8/photo.jpg?sz=128", "display_name": "stein66", "link": "https://stackoverflow.com/users/10922188/stein66"}, "edited": false, "score": 0, "creation_date": 1548179618, "post_id": 54223738, "comment_id": 95447749, "body": "@stein66 The COFF spec says that the value is an address (or, rather, an offset). A rationale is that the compiler tries to minimize the reloc info, and resolves as much relocations at the compile time as possible. For that it must define the symbol offsets, and the linker doesn&#39;t need to know anything else. If this comment is too terse let me know and I&#39;ll edit the answer."}, {"owner": {"reputation": 1, "user_id": 10922188, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kx8WibK68Fo/AAAAAAAAAAI/AAAAAAAAAG8/DOxaN5uMkN8/photo.jpg?sz=128", "display_name": "stein66", "link": "https://stackoverflow.com/users/10922188/stein66"}, "edited": false, "score": 0, "creation_date": 1548237755, "post_id": 54223738, "comment_id": 95467767, "body": "My conclusion is based on my current understanding of the concept of Common linker symbols. The concept of common linker symbols is present in many (all?) object file formats, and probably originated way back with FORTRAN. The same Common symbol may be introduced by several object files. This is usually not allowed because a name is supposed to uniquely reference something in the object file. Not so for uninitialized arrays (they have no content stored in the object file). There is no need to use the symbol value as an address - it is instead used as symbol size so the loader can zero-init."}], "tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 0, "last_activity_date": 1547665689, "creation_date": 1547665689, "answer_id": 54223738, "question_id": 54217746, "link": "https://stackoverflow.com/questions/54217746/unexpected-symbol-value-for-uninitialized-arrays-larger-than-64k-in-coff-object/54223738#54223738", "title": "Unexpected symbol value for uninitialized arrays larger than 64K in COFF object files", "body": "<p>COFF doesn't keep the array sizes. A value associated with the array symbol is its starting address. To infer the size of the array <code>dumpbin</code> must use some heuristic, e.g. by looking at the neighboring symbols, end of section, etc. Apparently, the heuristic fails. Only the compiler knows why BSS is larger than one would expect.</p>\n"}], "owner": {"reputation": 1, "user_id": 10922188, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kx8WibK68Fo/AAAAAAAAAAI/AAAAAAAAAG8/DOxaN5uMkN8/photo.jpg?sz=128", "display_name": "stein66", "link": "https://stackoverflow.com/users/10922188/stein66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547665689, "creation_date": 1547644069, "last_edit_date": 1547651340, "question_id": 54217746, "link": "https://stackoverflow.com/questions/54217746/unexpected-symbol-value-for-uninitialized-arrays-larger-than-64k-in-coff-object", "title": "Unexpected symbol value for uninitialized arrays larger than 64K in COFF object files", "body": "<p><strong>EDIT: I made a mistake when testing with the clang compiler. This works as expected with clang. The unexpected results are produced with Visual Studio 2015. My conclusion is that there is something fishy with Visual Studio 2015.</strong></p>\n\n<p>I have made an observation I cannot explain regarding the value of object file symbols that represent uninitialized C arrays in COFF object files produced by Visual Studio 2015. That value is supposed to represent the size of the array in bytes, but this is not what I observe. My hope is that someone can explain what is going on here.</p>\n\n<p>Consider the source file testdata_works.c</p>\n\n<pre><code>  char testb[0x10002];\n</code></pre>\n\n<p>Consider the source file testdata_fails.c:</p>\n\n<pre><code>  char testa[0x10001];\n  char testb[0x10002];\n</code></pre>\n\n<p>Now compile:</p>\n\n<pre><code>cl -c testdata_works.c\ncl -c testdata_fails.c\n</code></pre>\n\n<p>Now run \"dumpbin /symbols\" on both object files and pay attention to how <strong>the\nvalue of the symbol \"testb\" differs between the two object files(!)</strong> See below\nfor the gory details.</p>\n\n<pre><code>dumpbin /symbols testdata_works.obj\n\n006 00010002 UNDEF  notype       External     | testb\n</code></pre>\n\n<p>Now for testdata_fails.obj</p>\n\n<pre><code>dumpbin /symbols testdata_fails.obj\n\n006 00010001 UNDEF  notype       External     | testa\n007 00010041 UNDEF  notype       External     | testb\n</code></pre>\n\n<p><strong>We note that the symbol testb has the expected value 0x10002 in\ntestdata_works.obj but has the unexpected value 0x10041 in testdata_fails.obj.</strong></p>\n\n<p>I have saved the really strange part for last, which may trigger the\nproverbial \"a-ha\" in those who are well versed in the COFF object file\nformat:</p>\n\n<p>Decrease the size of the arrays in testdata_fails.c to below\n0x10000, for example: </p>\n\n<pre><code>  char testa[0x0001];\n  char testb[0x0002];\n</code></pre>\n\n<p>and compile</p>\n\n<pre><code>cl -c testdata_fails.c\n</code></pre>\n\n<p><strong>The dumpbin command now produces the expected results for symbols testa and\ntestb:</strong></p>\n\n<pre><code>006 00000001 UNDEF  notype       External     | testa\n007 00000002 UNDEF  notype       External     | testb\n</code></pre>\n\n<p>Any suggestions as to what is going on here and how to fix it so it produces the expected results for symbol values larger than 64K?</p>\n\n<p>Final remarks: </p>\n\n<p>I have reproduced this using clang/llvm-nm 7.0.1 instead of Visual\nStudio 2015/dumpbin, so it may be related to the COFF format?</p>\n\n<p>You may rightfully ask how I stubled across this. I was studying the BSD\nkernel genassym.sh script, and decided to write a small C++ STL program that\nachieved the same task from any object file format that can be read by the LLVM libraries. I have this program built, but it does not work properly because the data in the object files is not as expected.</p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1547641840, "post_id": 54217035, "comment_id": 95259817, "body": "look at <a href=\"https://stackoverflow.com/questions/7989039/use-of-cudamalloc-why-the-double-pointer\">Use of cudamalloc(). Why the double pointer?</a> if the answer is not enough for you"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1547642295, "post_id": 54217035, "comment_id": 95260058, "body": "@bruno Yep, one of the answers is the correct one: &quot;This is simply a horrible, horrible API design&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10889578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78476bc1c02eb1723c94d8439406cf12?s=128&d=identicon&r=PG&f=1", "display_name": "zaphod", "link": "https://stackoverflow.com/users/10889578/zaphod"}, "edited": false, "score": 0, "creation_date": 1547642059, "post_id": 54217098, "comment_id": 95259934, "body": "Oh! It&#39;s true. I had not thought about it because it was already a pointer. I&#39;m a beginner with CUDA. I have already done it the right way in the past but, this time, it slipped off my mind. Thanks!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547642189, "post_id": 54217098, "comment_id": 95260001, "body": "This is undefined behavior... and unfortunately the modestly talented person who designed the CUDA API enforces you to write code that relies on UB. <code>void**</code> is not a generic pointer type and is not compatible with <code>float**</code>. Never was. This is a known bug in CUDA. For standard C applications, you should never do casts like these."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547642487, "post_id": 54217098, "comment_id": 95260152, "body": "@Lundin you could use <code>void *a; cudaMalloc(&amp;a, 100); float *fa = a;</code> of course..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547642518, "post_id": 54217098, "comment_id": 95260171, "body": "@Ctx Not only could but must."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547642575, "post_id": 54217098, "comment_id": 95260195, "body": "@Lundin no, if it works, I don&#39;t have to. That depends on how portable the code needs to be."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547642688, "post_id": 54217098, "comment_id": 95260255, "body": "@Ctx Undefined behavior isn&#39;t a portability issue... unless you <i>know</i> that your compiler has well-defined non-standard extensions for this specific case."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547642756, "post_id": 54217098, "comment_id": 95260298, "body": "@Lundin I know, what assembler code it produces, this is enough"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547643150, "post_id": 54217098, "comment_id": 95260539, "body": "Actually this is not just UB but a C language violation. I have posted a correct answer, since this code here won&#39;t compile in C."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547643429, "post_id": 54217098, "comment_id": 95260699, "body": "@Lundin compiles here without problems"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547643748, "post_id": 54217098, "comment_id": 95260889, "body": "Doesn&#39;t compile in gcc, clang or icc. It does compile in VS but that compiler isn&#39;t conforming to the C standard so no surprise there."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547646084, "post_id": 54217098, "comment_id": 95262238, "body": "@Ctx Passing argument from incompatible pointer type. <a href=\"https://godbolt.org/z/mHN_ID\" rel=\"nofollow noreferrer\">godbolt.org/z/mHN_ID</a>. This even without any warnings, <code>-pedantic</code> or <code>-std=c17</code> enabled."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547646374, "post_id": 54217098, "comment_id": 95262417, "body": "@Lundin This is a warning, &quot;won&#39;t compile&quot; means there is an error. Where is the error?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547648330, "post_id": 54217098, "comment_id": 95263656, "body": "@Ctx No, it is a <i>diagnostic message</i>. The C standard does not speak of errors and warnings, but diagnostic messages. If a standard violation is found, it is sufficient if the compiler gives some manner of message. The state of the generated binary, if any, is then completely undefined. If you wish gcc to give you an error for standard C violations, you must compile with <code>gcc -std=c17 -pedantic-errors</code>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547648580, "post_id": 54217098, "comment_id": 95263826, "body": "@Lundin If you feed gcc with this code, it will compile and omit a diagnostic message. You claimed, it <i>won&#39;t</i> compile with gcc. This was obviously wrong. Why are you not admitting to that but trying to discuss this fact away with very flimsy arguments?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547648861, "post_id": 54217098, "comment_id": 95264010, "body": "It won&#39;t compile <i>cleanly</i>, as there are standard C constraint violations. Which is the only thing that should matter. If you manage to get a compiler to produce a binary despite violating the C language, then there is no telling what said binary will do."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547649430, "post_id": 54217098, "comment_id": 95264410, "body": "@Lundin People who know their development environment usually <i>can</i> tell what said binary will do. Especially for the above example, I can perfectly say that it will work as I expect in all build environments I ever got in touch with."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547649808, "post_id": 54217098, "comment_id": 95264671, "body": "@Ctx And what exactly will gcc do when you convert between incompatible pointer types? I can&#39;t find any documented behavior here: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Extensions.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/C-Extensions.html</a>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1547650449, "post_id": 54217098, "comment_id": 95265051, "body": "@Lundin Please, save your trick questions to other people, you exactly know what happens (or at least you should, if you&#39;re worth your salt). It produces the same assembler code, with or without a intermediate void* pointer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547650702, "post_id": 54217098, "comment_id": 95265234, "body": "@Ctx No, I don&#39;t know that and there appears to be no guarantees about non-standard extensions. There is no trick question, you are simply assuming that your code relying on undefined behavior somehow has well-defined behavior and can provide no other argument than &quot;it works&quot;. On your specific compiler and system, today."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1547650931, "post_id": 54217098, "comment_id": 95265388, "body": "@Lundin Even if a non-standard extension for this was documented, you couldn&#39;t rely on it being present in the next version, so what? If one wants to play it safe, of course, use the intermediate void pointer. But anyone with a bit experience knows, that this construct will never be a problem in practice (you are free to show a real-world example to counter that claim)."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 6, "last_activity_date": 1547641710, "creation_date": 1547641710, "answer_id": 54217098, "question_id": 54217035, "link": "https://stackoverflow.com/questions/54217035/segmentation-fault-after-second-cudamalloc/54217098#54217098", "title": "Segmentation fault after second cudaMalloc", "body": "<p>You have to pass a pointer to the pointer like this:</p>\n\n<pre><code>float2* a;\ncudaMalloc(&amp;a, n*sizeof(float2));\nfloat2* b;\ncudaMalloc(&amp;b, n*sizeof(float2));\n</code></pre>\n\n<p>otherwise, you just cast a dangling pointer to a \"pointer to pointer\" and the library dereferences a garbage address leading to a segfault.</p>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547643248, "post_id": 54217475, "comment_id": 95260590, "body": "Note, that cuda does not specify that a <code>NULL</code> pointer is stored into the pointer on failure. So you have to evaluate the return value of cudaMalloc and return a NULL pointer on error &quot;manually&quot;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547643345, "post_id": 54217475, "comment_id": 95260642, "body": "@Ctx Added a fix for that."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": -1, "last_activity_date": 1547643328, "last_edit_date": 1547643328, "creation_date": 1547643116, "answer_id": 54217475, "question_id": 54217035, "link": "https://stackoverflow.com/questions/54217035/segmentation-fault-after-second-cudamalloc/54217475#54217475", "title": "Segmentation fault after second cudaMalloc", "body": "<p>Because of the broken CUDA API, the correct answer is to write a wrapper around their trash:</p>\n\n<pre><code>void* saneMalloc (size_t n)\n{\n  void* tmp;\n  if (cudaMalloc(&amp;tmp, n) == cudaSuccess)\n    return tmp;\n  return NULL;\n}\n\n...\n\nfloat* a = saneMalloc(n);\n</code></pre>\n\n<p>You have to do this because the only generic pointer type in C is <code>void*</code>. You can convert from any pointer-to-type to  <code>void*</code>, but that does <em>not</em> apply to <code>void**</code>. So if you have a <code>float</code>, you <em>cannot</em> pass on <code>float**</code> to a function expecting a <code>void**</code>. This is an incompatible pointer type.</p>\n\n<p>Specifically, when passing parameters to function, they are copied as per the rules of simple assignment (C17 6.5.16.1). Passing a <code>float**</code> to a function expecting a <code>void**</code> is a constraint violation of the simple assignment rule. The code is not allowed to compile cleanly, as it is a C standard violation.</p>\n"}], "owner": {"reputation": 101, "user_id": 10889578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78476bc1c02eb1723c94d8439406cf12?s=128&d=identicon&r=PG&f=1", "display_name": "zaphod", "link": "https://stackoverflow.com/users/10889578/zaphod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 54217098, "answer_count": 2, "score": 0, "last_activity_date": 1547643328, "creation_date": 1547641452, "question_id": 54217035, "link": "https://stackoverflow.com/questions/54217035/segmentation-fault-after-second-cudamalloc", "title": "Segmentation fault after second cudaMalloc", "body": "<p>I obtain a segmentation fault after the second cudaMalloc.</p>\n\n<pre><code>#include &lt;cuda.h&gt;\n#include &lt;cuda_runtime.h&gt;\n\nint main(){\n\n  int n=16;\n\n  float2* a;\n  cudaMalloc((void **) a, n*sizeof(float2));\n  float2* b;\n  cudaMalloc((void **) b, n*sizeof(float2));\n\n  return 0;\n}\n</code></pre>\n\n<p>However, if I comment out any of the 2 cudaMallocs, the code runs fine.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1547639157, "post_id": 54216196, "comment_id": 95258358, "body": "Add a space before <code>%</code>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1547639574, "post_id": 54216196, "comment_id": 95258579, "body": "@JonathonReinhart The issue is different, the space will do nothing good"}, {"owner": {"reputation": 330, "user_id": 9398337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608948709174104/picture?type=large", "display_name": "Ionut Eugen", "link": "https://stackoverflow.com/users/9398337/ionut-eugen"}, "edited": false, "score": 0, "creation_date": 1547639612, "post_id": 54216196, "comment_id": 95258602, "body": "In this case at least it had no effect :/ I tried using %s instead of 99 but then it was reading each word separately and it was running the loop a few time to print all of the printf&#39;s and still skipping the scanf :/"}], "answers": [{"comments": [{"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 1, "creation_date": 1547640402, "post_id": 54216569, "comment_id": 95259067, "body": "Note that you don&#39;t need to put space before <code>%s</code> --&gt; <code>scanf(&quot; %s&quot;, to);</code>, the <code>%s</code> format specifier skip all whitespace."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547657283, "post_id": 54216569, "comment_id": 95269178, "body": "Likely OP will want a <code>&quot; &quot;</code> before <code>&quot;%99[^.]&quot;</code> to consume the prior <code>scanf(&quot;%s&quot;, to);</code> left over trailing white-space."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1547640604, "last_edit_date": 1547640604, "creation_date": 1547639788, "answer_id": 54216569, "question_id": 54216196, "link": "https://stackoverflow.com/questions/54216196/scanf-not-getting-called/54216569#54216569", "title": "scanf not getting called", "body": "<p>The problem is here:</p>\n\n<pre><code>scanf(\"%99[^.]\", msg);\n</code></pre>\n\n<p>This statement reads up to 99 characters, but only until the next non-matching character. Now if you put</p>\n\n<blockquote>\n  <p>Hello mister him!.</p>\n</blockquote>\n\n<p>into the input buffer, you indeed have</p>\n\n<pre><code>\"Hello mister him!.\\n\"\n</code></pre>\n\n<p>in the stdin input stream buffer. Now, the scanf processes everything up to (but not including) the dot, so the dot and the newline remains in the input buffer. The next call to <code>scanf()</code></p>\n\n<pre><code>scanf(\"%s\", to);\n</code></pre>\n\n<p>now fetches the dot and the newline from the output buffer, which automatically concludes the next line to read. Now the input buffer is empty and the following scanf waits for the next message.</p>\n\n<p>To fix this, you can skip the dot and the newline like this:</p>\n\n<pre><code>scanf(\"%99[^.]\", msg);\ngetchar(); // Pacman (Eat the dot)\n</code></pre>\n\n<p><s>and in the other scanf use</s></p>\n\n<pre><code>// scanf(\" %s\", to); // Skip the preceding newline\n</code></pre>\n\n<p>(this is unnecessary, as H.S. pointed out)</p>\n\n<p>Please note, that the case of an input message >99 chars is not handled properly yet.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547657435, "post_id": 54219870, "comment_id": 95269259, "body": "<code>scanf(&quot;%[^\\n]&quot;, to);</code> 1) fails to read anything into <code>to</code> when the line of input is <code>&quot;\\n&quot;</code>, leaving <code>to</code> in an uninitialized state.  2) The lack of a <i>width</i> like <code>&quot;%99[^\\n]&quot;</code> renders this code as bad a <code>gets()</code>."}], "tags": [], "owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "is_accepted": false, "score": 0, "last_activity_date": 1547650984, "creation_date": 1547650984, "answer_id": 54219870, "question_id": 54216196, "link": "https://stackoverflow.com/questions/54216196/scanf-not-getting-called/54219870#54219870", "title": "scanf not getting called", "body": "<p>If you wants to read a whole line using scanf you can use %[^\\n] instead of %99[^.]. And make sure to add a getchar() if any 'enter' is pressed just before scanning with %[^\\n]. \nThe changes showed in the code bellow may be useful: </p>\n\n<pre><code>while (1)\n{\n    printf(\"[]:Msg to ? :\");\n    scanf(\"%[^\\n]\", to);\n    getchar();\n    printf(\"[]:Msg: \");\n    scanf(\"%[^\\n]\", msg);\n    getchar();\n    printf(\"Sending %s\\n\", msg);\n}\n</code></pre>\n"}], "owner": {"reputation": 330, "user_id": 9398337, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608948709174104/picture?type=large", "display_name": "Ionut Eugen", "link": "https://stackoverflow.com/users/9398337/ionut-eugen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 54216569, "answer_count": 2, "score": 1, "last_activity_date": 1547650984, "creation_date": 1547638377, "last_edit_date": 1592644375, "question_id": 54216196, "link": "https://stackoverflow.com/questions/54216196/scanf-not-getting-called", "title": "scanf not getting called", "body": "<p>I'm trying to read a whole line using scanf multiple times and for some reasons it only works the first time.\nThe second time the loop runs the compiler ignores the scanf function</p>\n<p>Here is my code:</p>\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char msg[100];\n    char to[100];\n    while (1)\n    {\n        printf(&quot;[]:Msg to ? :&quot;);\n        scanf(&quot;%s&quot;, to);\n        printf(&quot;[]:Msg: &quot;);\n        scanf(&quot;%99[^.]&quot;, msg);\n        printf(&quot;Sending %s\\n&quot;, msg);\n    }\n    return 0;\n}\n</code></pre>\n<p>And this is the output Im given:</p>\n<blockquote>\n<p>[]:Msg to ? :Him   []:Msg: Hello mister him!.  Sending  Hello mister</p>\n<p>him!  []:Msg to ? :[]:Msg:</p>\n</blockquote>\n<p>And here I was expecting to be able to change the variable to ...\nAdding a space before %s for some reason has no effect here</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1547637945, "post_id": 54215966, "comment_id": 95257593, "body": "<a href=\"https://stackoverflow.com/questions/9914007/string-literals-causing-small-memory-leak\" title=\"string literals causing small memory leak\">stackoverflow.com/questions/9914007/&hellip;</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1547641987, "post_id": 54215966, "comment_id": 95259892, "body": "&quot;<i>I would get an error.</i>&quot; - strictly, you might, you might not; it is undefined.  Any run-time error you get is down to OS or target platform behaviour rather than C run-time behaviour.  Better to get a compile-time error by <code>const char *string = &quot;mystring&quot;;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 0, "creation_date": 1547638210, "post_id": 54216033, "comment_id": 95257755, "body": "I wanted to go into the specifics of OP&#39;s example, such as changing the pointer from one read-only memory location to another, what happens and why that works despite his observation of the &quot;string&quot; not being modifiable."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1547637876, "creation_date": 1547637876, "answer_id": 54216033, "question_id": 54215966, "link": "https://stackoverflow.com/questions/54215966/in-c-what-is-the-difference-between-char-and-char/54216033#54216033", "title": "In C, what is the difference between char* and char[]?", "body": "<blockquote>\n  <p>what about the char*? is it saved on the heap? or on the stack?</p>\n</blockquote>\n\n<p>The <code>char*</code> is saved on the stack. But that's just one pointer. The actual string data will be stored in your program's executable (this happens when the program is compiled, it's not the <code>char *string = \"mystring\";</code> that puts it there). The assignment to the <code>char*</code> initializes it with the address of <code>\"mystring\"</code> in your program's binary.</p>\n\n<blockquote>\n  <p>it worked, but what happened to the old \"mystring\" array? is there a memory leak caused by doing this?</p>\n</blockquote>\n\n<p>Your executable will contain the content of both the <code>\"mystring\";</code> and the <code>\"mystring2\"</code>. When you do the <code>string = \"mystring2\";</code>, you make that pointer change from pointing to one to pointing to another. There's no memory leak here.</p>\n"}], "owner": {"reputation": 115, "user_id": 9245513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eceea6aa0d280e65feacd3797f13e95e?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/9245513/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "closed_date": 1547637884, "answer_count": 1, "score": -1, "last_activity_date": 1547641642, "creation_date": 1547637658, "last_edit_date": 1547641642, "question_id": 54215966, "link": "https://stackoverflow.com/questions/54215966/in-c-what-is-the-difference-between-char-and-char", "closed_reason": "Duplicate", "title": "In C, what is the difference between char* and char[]?", "body": "<p>I know that many people asked this but I still have some questions about it.\nI read that writing:</p>\n\n<p><code>char *string = \"mystring\";</code></p>\n\n<p>Makes it a read only array of characters, if I were trying to do:</p>\n\n<p><code>string[0] = 'l';</code></p>\n\n<p>I would get an error.\nWhen I write:</p>\n\n<p><code>char string[] = \"mystring\";</code></p>\n\n<p>it is saved on the stack, just on the current scope.\nwhat about the char*? is it saved on the heap? or on the stack?</p>\n\n<p>And when I tried writing:</p>\n\n<p><code>char *string = \"mystring\";</code></p>\n\n<p>And then:</p>\n\n<p><code>string = \"mystring2\";</code></p>\n\n<p>it worked, but what happened to the old \"mystring\" array? is there a memory leak caused by doing this?</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 1121, "user_id": 8652760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yFbhM.jpg?s=128&g=1", "display_name": "Jasmeet", "link": "https://stackoverflow.com/users/8652760/jasmeet"}, "edited": false, "score": 0, "creation_date": 1547636771, "post_id": 54215582, "comment_id": 95256936, "body": "What is the input that you are getting? i.e the value of &#39;n&#39;."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "reply_to_user": {"reputation": 1121, "user_id": 8652760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yFbhM.jpg?s=128&g=1", "display_name": "Jasmeet", "link": "https://stackoverflow.com/users/8652760/jasmeet"}, "edited": false, "score": 0, "creation_date": 1547636902, "post_id": 54215582, "comment_id": 95257024, "body": "Input is any number between 1 and 1000."}, {"owner": {"reputation": 1121, "user_id": 8652760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yFbhM.jpg?s=128&g=1", "display_name": "Jasmeet", "link": "https://stackoverflow.com/users/8652760/jasmeet"}, "edited": false, "score": 0, "creation_date": 1547636979, "post_id": 54215582, "comment_id": 95257067, "body": "What does it signify?"}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547637437, "post_id": 54215582, "comment_id": 95257313, "body": "for n = 5 and n = 7 it fails after adding +1 to printf. Please don&#39;t suggest hardcoding. It must work for 1&lt;n&lt;1000."}, {"owner": {"reputation": 941, "user_id": 6061216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sRsZ4.png?s=128&g=1", "display_name": "DevilaN", "link": "https://stackoverflow.com/users/6061216/devilan"}, "edited": false, "score": 0, "creation_date": 1547637531, "post_id": 54215582, "comment_id": 95257355, "body": "What is your input when you are expecting output from your question?"}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "edited": false, "score": 0, "creation_date": 1547637564, "post_id": 54215582, "comment_id": 95257374, "body": "You are just decrementing the &#39;n&#39; value and assigning it to the outer loop on every cycle. The row and column counter are not decrementing. The middle values are garbage values."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547637971, "post_id": 54215582, "comment_id": 95257611, "body": "@Santosh - row and col values are changing. please see. After 1 complete spiral sweep the value of n changes. I am going from left-&gt;right-&gt;bottom-&gt;left-&gt;top in 1 spiral sweep, decreasing the value of n and repeating the spiral."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "reply_to_user": {"reputation": 941, "user_id": 6061216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sRsZ4.png?s=128&g=1", "display_name": "DevilaN", "link": "https://stackoverflow.com/users/6061216/devilan"}, "edited": false, "score": 0, "creation_date": 1547638022, "post_id": 54215582, "comment_id": 95257643, "body": "@DevilaN - input is taken in variable n. 1&lt;n&lt;1000."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547638179, "post_id": 54215582, "comment_id": 95257738, "body": "Here a refined version - <a href=\"https://github.com/abcool/C_training/blob/Hackerrank-C_Practice/pattern_printing_loops\" rel=\"nofollow noreferrer\">github.com/abcool/C_training/blob/Hackerrank-C_Practice/&hellip;</a>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547638389, "post_id": 54215582, "comment_id": 95257880, "body": "Since it&#39;s not actually a spiral pattern, you don&#39;t need the array or all those <code>while</code> loops. You could do it with just those two <code>for</code> loops"}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547638788, "post_id": 54215582, "comment_id": 95258125, "body": "@chris turner - how?"}, {"owner": {"reputation": 941, "user_id": 6061216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sRsZ4.png?s=128&g=1", "display_name": "DevilaN", "link": "https://stackoverflow.com/users/6061216/devilan"}, "edited": false, "score": 0, "creation_date": 1547639082, "post_id": 54215582, "comment_id": 95258310, "body": "@ArvindBakshi: So you input any number between 1 and 1000 and you got your expected output (3x3 square with 1s and 2s)?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547639407, "post_id": 54215582, "comment_id": 95258510, "body": "If I told you how, that would defeat the point of the challenge - you&#39;re meant to be solving this yourself."}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547640482, "post_id": 54216499, "comment_id": 95259109, "body": "No it works. All you need is a screen to view (100*2)-1=199 number in a single line."}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547640571, "post_id": 54216499, "comment_id": 95259169, "body": "For such number, forward the output to a text file. With word Warp unchecked, you can view it."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547640632, "post_id": 54216499, "comment_id": 95259191, "body": "see I have uploaded a cleaner code but ur logic is not working with it."}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547640844, "post_id": 54216499, "comment_id": 95259314, "body": "Dude. you are repeating the same thing. You are decrementing the n value and changing only the outer loop."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547641460, "post_id": 54216499, "comment_id": 95259642, "body": "what&#39;s the purpose of using x?"}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547641693, "post_id": 54216499, "comment_id": 95259747, "body": "x is to the decrement the spiral frame. Do you understand the concept?"}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547641752, "post_id": 54216499, "comment_id": 95259779, "body": "for that I had used n--."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547641883, "post_id": 54216499, "comment_id": 95259846, "body": "inside while loop is the whole 1 complete rotation clockwise and n-- repaets it shrinking the frame size. so why x?"}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547641951, "post_id": 54216499, "comment_id": 95259875, "body": "yeah... u are reducing only the &#39;n&#39; value,this doesn&#39;t decreased not the row or column count...also it doesn&#39;t reduces the frame size. please understand... To reduce the row and column count, I used &#39;x-n&#39; everytime."}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547642060, "post_id": 54216499, "comment_id": 95259935, "body": "just see the difference by running both the codes, to understand step-by-step compilation process, use turbo c compiler(F7)."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547642089, "post_id": 54216499, "comment_id": 95259948, "body": "I am using minGW."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547657472, "post_id": 54216499, "comment_id": 95269277, "body": "@santosh- while I was comparing to begin array index 0 you replaced it by x-n. Also u added size-(x-n) to conditions. Also you are storing initial value of n in x. Still x-n is confusing."}, {"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "reply_to_user": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547701642, "post_id": 54216499, "comment_id": 95283869, "body": "I&#39;m using (x-n) as buffer that changes in every loop. for example, take input as 4-&gt; you need to start from 0,0(x-n is 0), for the second time you need to start from 1,1(now x-n is 1). If you begin index with 0, your frame rotates only on the outer loop. That&#39;s why im using varying x-n. this make frame to rotate to the inner loop on every cycle."}, {"owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "edited": false, "score": 0, "creation_date": 1547792434, "post_id": 54216499, "comment_id": 95321373, "body": "@Santosh- <a href=\"https://github.com/abcool/C_training/blob/Hackerrank-C_Practice/digit_freq\" rel=\"nofollow noreferrer\">github.com/abcool/C_training/blob/Hackerrank-C_Practice/&hellip;</a>"}], "tags": [], "owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "is_accepted": true, "score": 0, "last_activity_date": 1547641335, "last_edit_date": 1547641335, "creation_date": 1547639519, "answer_id": 54216499, "question_id": 54215582, "link": "https://stackoverflow.com/questions/54215582/printing-pattern-using-loops/54216499#54216499", "title": "Printing Pattern using Loops", "body": "<p>Check this code.\n<a href=\"https://onlinegdb.com/S1th-snM4\" rel=\"nofollow noreferrer\">Online compiler</a>\nI used your same code with an extra buffer 'x'. This makes the frame to move across the loop in decreasing spiral.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() \n{\n  int n,row,col,size;\n  scanf(\"%d\", &amp;n);\n  // Complete the code to print the pattern.\n  size=2*n;\n  int x = n;\n  int arr[size-1][size-1];\n  //n=n+1;\n  while(n&gt;0){\n    row=x-n;\n    col=x-n;\n    while(col&lt;size-(x-n)-2){\n      arr[row][col] = n;\n      col++;\n    }\n    col=size-(x-n)-2;\n    row=x-n;\n    while(row&lt;size-(x-n)-1){\n      arr[row][col]=n;\n      row++;\n    }\n    row = size-(x-n)-2;\n    col = size-(x-n)-2;\n    while (col &gt;x-n) {\n      arr[row][col] = n;\n      col--;\n    }\n    col = x-n;\n    row = size-(x-n)-2;\n    while (row &gt; x-n) {\n      arr[row][col] = n;\n      row--;\n    }\n    n--;\n  }\n  for(row=0;row&lt;size-1;row++){\n    for(col=0;col&lt;size-1;col++){\n      printf(\"%d \",arr[row][col]);\n    }\n    printf(\"\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p><br>\nThese are your expected outputs.\n<a href=\"https://i.stack.imgur.com/gZfRv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gZfRv.png\" alt=\"for input 2\"></a>\n<a href=\"https://i.stack.imgur.com/fFeBX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fFeBX.png\" alt=\"for input 4\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "is_accepted": false, "score": 0, "last_activity_date": 1547650955, "creation_date": 1547650955, "answer_id": 54219864, "question_id": 54215582, "link": "https://stackoverflow.com/questions/54215582/printing-pattern-using-loops/54219864#54219864", "title": "Printing Pattern using Loops", "body": "<p>If performance and \"overwriting\" doesn't matter, you can try this intuitive short version.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() \n{\n  int n, size;\n  scanf(\"%d\", &amp;n);\n  size=2*n-1;\n  int arr[size][size];\n\n  for(int i=0; i&lt;n;i++)\n      for(int row=i; row&lt;size-i; row++)\n          for(int col=i; col&lt;size-i; col++)\n            arr[row][col] = n-i;\n\n  for(int row=0; row&lt;size; row++) {\n    for(int col=0; col&lt;size; col++)\n      printf(\"%d \",arr[row][col]);\n    printf(\"\\n\");\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10637926, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FKLBi2Ph89Y/AAAAAAAAAAI/AAAAAAAAAEM/AF_FglJiWX8/photo.jpg?sz=128", "display_name": "Abdul Alim", "link": "https://stackoverflow.com/users/10637926/abdul-alim"}, "is_accepted": false, "score": 1, "last_activity_date": 1570395679, "creation_date": 1570395679, "answer_id": 58261186, "question_id": 54215582, "link": "https://stackoverflow.com/questions/54215582/printing-pattern-using-loops/58261186#58261186", "title": "Printing Pattern using Loops", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int n;\n    scanf(\"%d\", &amp;n);\n\n    for(int i = n; i &gt;= 1; i--){\n        for(int j = n; j &gt; i; j--)\n            printf(\"%d \", j);\n        for(int j = 1; j &lt;= 2 * i - 1; j++)\n            printf(\"%d \", i);\n        for(int j = i + 1; j &lt;= n; j++)\n            printf(\"%d \", j);\n        printf(\"\\n\");\n    }\n\n    for(int i = 1; i &lt; n; i++){\n        for(int j = n; j &gt; i; j--)\n            printf(\"%d \", j);\n        for(int j = 1; j &lt;= 2 * i - 1; j++)\n            printf(\"%d \", i + 1);\n        for(int j = i + 1; j &lt;= n; j++)\n            printf(\"%d \", j);\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6475857, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SQplP3y35hw/AAAAAAAAAAI/AAAAAAAAAKs/eimSTtyU_z4/photo.jpg?sz=128", "display_name": "Arvind Bakshi", "link": "https://stackoverflow.com/users/6475857/arvind-bakshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4394, "favorite_count": 0, "accepted_answer_id": 54216499, "answer_count": 3, "score": -3, "last_activity_date": 1570395679, "creation_date": 1547636382, "last_edit_date": 1547640570, "question_id": 54215582, "link": "https://stackoverflow.com/questions/54215582/printing-pattern-using-loops", "title": "Printing Pattern using Loops", "body": "<p>I am solving a challenge on hackerrank. It's printing a number in spiral pattern decreasing it's value at each circle completion.</p>\n\n<p>4 4 4 4 4 4 4<br>\n   4 3 3 3 3 3 4<br>\n   4 3 2 2 2 3 4<br>\n   4 3 2 1 2 3 4<br>\n   4 3 2 2 2 3 4<br>\n   4 3 3 3 3 3 4<br>\n   4 4 4 4 4 4 4</p>\n\n<pre><code>//Printing Pattern using Loops\n/* for eg. for n = 4 \n  4 4 4 4 4 4 4\n  4 3 3 3 3 3 4\n  4 3 2 2 2 3 4\n  4 3 2 1 2 3 4\n  4 3 2 2 2 3 4\n  4 3 3 3 3 3 4\n  4 4 4 4 4 4 4\n */\n //Author: Arvind Bakshi\n #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;\n #include &lt;math.h&gt;\n #include &lt;stdlib.h&gt;\n\nint main() \n{\n\nint n,row,col,size;\nscanf(\"%d\", &amp;n);\n// Complete the code to print the pattern.\nsize=2*n-1;\n  int arr[size][size];\n  //n=n+1;\n    while(n&gt;0){\n        row=0;\n        col=0;\n        while(col&lt;size){\n          arr[row][col] = n;\n          col++;\n        }\n        col=size-1;\n        row=0;\n        while(row&lt;size){\n            arr[row][col]=n;\n            row++;\n        }\n        row = size-1;\n        col = size-1;\n        while (col &gt;=0) {\n          arr[row][col] = n;\n          col--;\n        }\n        col = 0;\n        row = size-1;\n        while (row &gt;=0) {\n          arr[row][col] = n;\n          row--;\n        }\n        n--;\n    }\n    for(row=0;row&lt;size;row++){\n        for(col=0;col&lt;size;col++){\n            printf(\"%d\",arr[row][col]);\n        }\n        printf(\"\\n\");\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>Expected output is </p>\n\n<pre><code> 2 2 2 \n 2 1 2 \n 2 2 2\n</code></pre>\n\n<p>I am getting</p>\n\n<pre><code>111\n101\n111\n</code></pre>\n\n<p>There is numerous code available for it online, I just want to know my mistake, where I am doing wrong. Please don't mark it as a repeat.</p>\n"}, {"tags": ["c", "information-hiding"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1547637441, "post_id": 54215492, "comment_id": 95257315, "body": "Move the struct definition to <code>Payload_Manager.h</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547637551, "post_id": 54215492, "comment_id": 95257368, "body": "Or define a function to get a pointer to the name from the struct in <code>Payload_Manager.c</code>"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1547637555, "post_id": 54215492, "comment_id": 95257369, "body": "Since you are accessing <code>ATEIS_Payload</code> members inside <code>DNMManager_Ctor</code>, you should either make it public by placing the struct inside the header, or should move this function elsewhere where this struct is known, or implement several getter functions like <code>Payload_getName</code>, <code>Payload_getSerial</code>, <code>Payload_getSubnet</code>, etc. Whenever you use opaque struct pointers, you will need extern functions which operate on their internal members."}], "answers": [{"tags": [], "owner": {"reputation": 359, "user_id": 7839690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/277446997e35bd19b67a21bd7e10d641?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Lin", "link": "https://stackoverflow.com/users/7839690/andy-lin"}, "is_accepted": true, "score": 0, "last_activity_date": 1552476379, "creation_date": 1552476379, "answer_id": 55140807, "question_id": 54215492, "link": "https://stackoverflow.com/questions/54215492/how-to-dereference-member-from-struct-in-which-the-definition-is-hid-from-user/55140807#55140807", "title": "How to dereference member from struct in which the definition is hid from user?", "body": "<p>As Groo suggested, the implementer must offer functions to user to manipulate members. Here is a snippet from my code:</p>\n\n<pre><code>uint32_t PayloadManager_GetAddr(ATEIS_Payload_s* this)\n{\n    return this-&gt;Addr;\n}\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 7839690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/277446997e35bd19b67a21bd7e10d641?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Lin", "link": "https://stackoverflow.com/users/7839690/andy-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55140807, "answer_count": 1, "score": 0, "last_activity_date": 1552476379, "creation_date": 1547636050, "last_edit_date": 1552476073, "question_id": 54215492, "link": "https://stackoverflow.com/questions/54215492/how-to-dereference-member-from-struct-in-which-the-definition-is-hid-from-user", "title": "How to dereference member from struct in which the definition is hid from user?", "body": "<p>Payload_Manager.h</p>\n\n<pre><code>typedef struct ATEIS_Payload_s* pATEIS_Payload;\n</code></pre>\n\n<p>Payload_Manager.c</p>\n\n<pre><code>#include \"Payload_Manager.h\"\n\nstruct __attribute__((__packed__))ATEIS_Payload_s   //payload\n{\n    uint32_t Addr;\n    uint16_t Cmd;\n    uint16_t Len;\n    uint8_t Data[]; \n};\n</code></pre>\n\n<p>DNM_Manager.h</p>\n\n<pre><code>#include \"Payload_Manager.h\"\n\ntypedef struct DNM_s* pDNM;\n\npDNM DNMManager_Ctor(pDNM this, pATEIS_Payload src);\n</code></pre>\n\n<p>DNM_Manager.c</p>\n\n<pre><code>#include \"Payload_Manager.h\"\n\nstruct DNM_s\n{\n    uint32_t Addr;\n    uint32_t SerialNo;\n    uint32_t SubnetMask;\n    uint16_t Tick;\n    uint8_t Name[NAME_SIZE];\n}DNMSet[SET_SIZE], DNMTemp;\n\npDNM DNMManager_Ctor(pDNM this, pATEIS_Payload src)\n{\n    memcpy(this-&gt;Name, &amp;src-&gt;Data[NAME], NAME_SIZE);    //ptr to incomplete class type is not allowed\n    this-&gt;Addr = src-&gt;Addr;    //ditto\n    this-&gt;SerialNo = *(uint32_t*)&amp;src-&gt;Data[SN];    //ditto\n    this-&gt;SubnetMask = *(uint32_t*)&amp;src-&gt;Data[SUBMASK];    //ditto\n    this-&gt;Tick = 0;\n    return this;\n}\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include \"Payload_Manager.h\"\n#include \"DNM_Manager.h\"\n\npDNM DNM_temp = NULL;\nDNM_temp = DNMManager_New();    //get one DNM\nDNM_temp = DNMManager_Ctor(DNM_temp, pl_p);    //init DNM_temp by pl_p\n</code></pre>\n\n<p>The file DNM_Manager.c needs to know declaration of ATEIS_Payload_s, otherwise it cannot dereference it.</p>\n\n<p>How can I do except that declare ATEIS_Payload_s again in DNM_Manager.c?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "dictionary", "cs50"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 2, "creation_date": 1547632695, "post_id": 54214378, "comment_id": 95254648, "body": "you call sizeH(NULL)."}, {"owner": {"reputation": 527, "user_id": 689106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/22ef5ea2bedfb2a3575ac22fe06d6c72?s=128&d=identicon&r=PG", "display_name": "Melon", "link": "https://stackoverflow.com/users/689106/melon"}, "edited": false, "score": 5, "creation_date": 1547632708, "post_id": 54214378, "comment_id": 95254655, "body": "Edit your code to include the <code>node</code> struct. Edit your code to show how <code>root</code> is allocated. Generally just add the code that one can compile."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1547633133, "post_id": 54214378, "comment_id": 95254927, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Probably <code>root</code> is <code>NULL</code> for some reason."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1547650915, "post_id": 54214378, "comment_id": 95265378, "body": "Your error message doesn&#39;t match the code (line 120 doesn&#39;t exist)."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1547635690, "creation_date": 1547635690, "answer_id": 54215401, "question_id": 54214378, "link": "https://stackoverflow.com/questions/54214378/c-segmentation-fault-function-reference/54215401#54215401", "title": "C Segmentation fault function reference", "body": "<p>There's a couple of fundamental problems with your <code>sizeH</code> function. Firstly it doesn't check that the <code>ptr</code> that is passed in is not <code>NULL</code>. This is very likely to happen as your function is recursive and you have this loop that is called for each child node.</p>\n\n<pre><code>    for(int x = 0; x &lt; N; x++){\n        return 0 + sizeH(ptr-&gt;children[x]);\n\n    }\n</code></pre>\n\n<p>Except that the code in the loop is wrong and it'll only ever be called for the first child, which is the second issue. Because you use <code>return</code> inside the loop, it'll only ever run once. Instead you should tally up the values returned for each child node and then return that.</p>\n\n<p>Making the two changes above would leave your function looking like this.</p>\n\n<pre><code>unsigned int sizeH(node *ptr) {\n    if(ptr==NULL) {\n        return 0;\n    } else if(ptr-&gt;is_word) {\n        return 1;\n    } else {\n        unsigned int ret = 0;\n        for(int x = 0; x &lt; N; x++) {\n            ret += sizeH(ptr-&gt;children[x]);\n        }\n        return ret;\n    }\n    // return 0; This isn't needed - the code will never reach here.\n}\n</code></pre>\n\n<p>It's also worth picking one coding formatting style and sticking to it rather than using a mixture as it makes for neater code. </p>\n"}], "owner": {"reputation": 71, "user_id": 8074162, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k2RVx7E-hSc/AAAAAAAAAAI/AAAAAAAAA90/GnRMYwtiZEM/photo.jpg?sz=128", "display_name": "ISpam Ossama", "link": "https://stackoverflow.com/users/8074162/ispam-ossama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "closed_date": 1547669301, "accepted_answer_id": 54215401, "answer_count": 1, "score": -1, "last_activity_date": 1561825170, "creation_date": 1547632392, "last_edit_date": 1561825170, "question_id": 54214378, "link": "https://stackoverflow.com/questions/54214378/c-segmentation-fault-function-reference", "closed_reason": "Not suitable for this site", "title": "C Segmentation fault function reference", "body": "<p>The <code>if(ptr-&gt;is_word)</code> on the <code>sizeH(node *ptr)</code> function is causing a segmentation fault.</p>\n\n<pre><code>dictionary.c:120:13: runtime error: member access within null pointer of type 'node' (aka 'struct node')\ndictionary.c:120:13: runtime error: load of null pointer of type '_Bool'\nSegmentation fault\n</code></pre>\n\n<p>If I add an <code>if</code> condition to return a specific value before this if-condition, the code executes and I make sure the root isn't null\nso I guess the problem is the <code>ptr</code> isn't passed correctly to the <code>sizeH</code> function.</p>\n\n<pre><code>unsigned int size(void)\n{\n    node *ptr = root;\n    printf(ptr-&gt;is_word ? \"true\" : \"false\");\n    unsigned int count = sizeH(ptr);\n    printf(\"COUNTER IN SIZE %d\\n\" , count);\n    return 0;\n}\n\nunsigned int sizeH(node *ptr){\n    if(ptr-&gt;is_word)\n    {\n        return 1;\n    }\n    else\n    {\n        for(int x = 0; x &lt; N; x++){\n            return 0 + sizeH(ptr-&gt;children[x]);\n\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "kernel", "driver", "tty"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547632319, "post_id": 54214270, "comment_id": 95254413, "body": "Any process opening /dev/ttyn, as for example init, which then in turn starts a getty or similar. And there&#39;s <code>openvt</code>, which allocates and opens a vt and starts a shell on it."}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 2, "last_activity_date": 1547634745, "creation_date": 1547634745, "answer_id": 54215130, "question_id": 54214270, "link": "https://stackoverflow.com/questions/54214270/who-call-tty-open-in-linux-kernel/54215130#54215130", "title": "who call tty_open() in linux kernel?", "body": "<blockquote>\n  <p>When I check CentOS 7, text mode only, in VirtualBox, I didn't see X after executed lsof /dev/input/event2 (keyboard), but my keyboard still works</p>\n</blockquote>\n\n<p>That is because you use the <a href=\"https://en.wikipedia.org/wiki/Virtual_console\" rel=\"nofollow noreferrer\">virtual console</a> then, one of the <code>/dev/ttyN</code> devices. These are directly wired to the Linux input event subsystem inside the kernel itself (by the <code>vt</code> module); essentially all keyboard-like devices act as inputs to the currently active virtual terminal.</p>\n\n<p>X itself uses a virtual console, just so that the kernel can switch between it and any text-based virtual consoles.</p>\n\n<blockquote>\n  <p>How about <code>tty_open()</code>?</p>\n</blockquote>\n\n<p>If you run <code>sudo lsof /dev/tty[0-9]</code>, you can see which processes are accessing a virtual console.</p>\n\n<p>The processes with <code>getty</code> in their name are the ones that provide login terminals. (The ones that are used with serial terminals are very similar; in fact, many getty programs can handle both virtual consoles and serial terminals just fine.)\nWhen you log in, that getty launches <code>login</code> (program!), which in turn starts the default shell defined for that user (see <code>getent passwd username</code>; it is the last field, and it must be one that is listed in <code>/etc/shells</code> to be allowed).</p>\n\n<p>The kernel itself supports switching to a different virtual console via <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Fn</kbd> (F1 for tty1, F2 for tty2, and so on). If you use suitable graphics drivers, you can even switch between Xorg and virtual consoles. (Usually, Xorg is run on tty6 or tty7, but that varies from distribution to distribution.)  The <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>\u2190</kbd> and <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>\u2192</kbd> can also usually be used to switch to the previous or next virtual console.</p>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 5518300, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PeMDlGROv_g/AAAAAAAAAAI/AAAAAAAAlto/MDId6DM4cC0/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/5518300/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1547705458, "creation_date": 1547705458, "answer_id": 54229969, "question_id": 54214270, "link": "https://stackoverflow.com/questions/54214270/who-call-tty-open-in-linux-kernel/54229969#54229969", "title": "who call tty_open() in linux kernel?", "body": "<p>Thanks for Nominal Animal for the information.</p>\n\n<p>I am tracing linux 2.0 ( <a href=\"https://mirrors.edge.kernel.org/pub/linux/kernel/v2.0/\" rel=\"nofollow noreferrer\">https://mirrors.edge.kernel.org/pub/linux/kernel/v2.0/</a> ), thing maybe a little different.\nSorry, I can't find an online Linux 2.0 source to link reference.</p>\n\n<p>For keyboard, in text mode, I think no one calling 'open' in kernel, \nIn 'int tty_init(void)' ( tty_io.c ), it will call  'kbd_init();'\nthen we can see:</p>\n\n<pre><code>request_irq(KEYBOARD_IRQ, keyboard_interrupt, 0, \"keyboard\", NULL);\n</code></pre>\n\n<p>therefore, keyboard HW can work with this IRQ &amp; callback ('keyboard_interrupt').</p>\n\n<p>For tty_open(), I finally see it in main.c </p>\n\n<pre><code>open(\"/dev/tty1\",O_RDWR,0);\n</code></pre>\n\n<p>For the newer version of kernel, I think this part migrated to getty application, that's why I can't find it in kernel source.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1548061061, "creation_date": 1548061061, "answer_id": 54286346, "question_id": 54214270, "link": "https://stackoverflow.com/questions/54214270/who-call-tty-open-in-linux-kernel/54286346#54286346", "title": "who call tty_open() in linux kernel?", "body": "<p><code>tty_</code>* routines are UNIX hardware independent code to implement the terminal interface in the kernel.  They are responsible of the tty disciplines, the job control stuff and the linemode processing of characters (including the generation of signals on <code>Ctrl-C</code> for example)  They also implement the interface to tty/pty pairs and the like.</p>\n\n<p>This is common code to include all the common functionality of the terminal drivers into any kind of hardware you can have attached for (console keyboard/display is just one example, but you have, at least, uart RS-232C interfaces, usb serial dongles, PCI serial line multiplexors, etc)</p>\n\n<p>Terminal functionality dates from the ancient v7 unix, and has many improvements coming from BSD unix (like job control)</p>\n\n<p>By the way, linux implementation of serial interface is not very good, you should look at the BSD implementation for a good one.</p>\n"}], "owner": {"reputation": 313, "user_id": 5518300, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PeMDlGROv_g/AAAAAAAAAAI/AAAAAAAAlto/MDId6DM4cC0/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/5518300/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 54215130, "answer_count": 3, "score": 0, "last_activity_date": 1548061061, "creation_date": 1547632063, "question_id": 54214270, "link": "https://stackoverflow.com/questions/54214270/who-call-tty-open-in-linux-kernel", "title": "who call tty_open() in linux kernel?", "body": "<p>For mouse, keyboard and joystick drivers, it may X call the 'open' then using these drivers. </p>\n\n<p>( when I check CentOS 7 (text mode only) in VirtualBox, I didn't see X after executed lsof /dev/input/event2 ( keyboard ), but my keyboard still working )</p>\n\n<p>How about tty_open() ?</p>\n\n<p>According to a call trace, we can roughly know the sequence:\n( at least, we know someone called 'sys_open' )\n<a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=630464\" rel=\"nofollow noreferrer\">https://bugzilla.redhat.com/show_bug.cgi?id=630464</a></p>\n\n<p>However, I still don't know who calls the 'open'?</p>\n"}, {"tags": ["c++", "c", "macos", "qt", "native"], "comments": [{"owner": {"reputation": 11609, "user_id": 233944, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/231ea4f1017c30d4fabcda7671c91f27?s=128&d=identicon&r=PG", "display_name": "TheNextman", "link": "https://stackoverflow.com/users/233944/thenextman"}, "edited": false, "score": 0, "creation_date": 1547655064, "post_id": 54214268, "comment_id": 95267865, "body": "The crash reports are in ~/Library/Logs/DiagnosticReports, you can read them from there. It&#39;s not a &quot;hard way&quot; :)"}], "answers": [{"tags": [], "owner": {"reputation": 753, "user_id": 6229173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20c8a9b53939417106f864f2d347038?s=128&d=identicon&r=PG&f=1", "display_name": "markus-nm", "link": "https://stackoverflow.com/users/6229173/markus-nm"}, "is_accepted": true, "score": 0, "last_activity_date": 1547639829, "creation_date": 1547639829, "answer_id": 54216585, "question_id": 54214268, "link": "https://stackoverflow.com/questions/54214268/retrieve-crash-report-programmatically-on-macos/54216585#54216585", "title": "Retrieve crash report programmatically on macOS", "body": "<p>Yes, but only if you publish your software via App Store. Crash reports are then gathered by the OS and can be retrieved on the App-Store-developer site. The user has the last say in whether the reports are delivered to Apple/you however.</p>\n"}], "owner": {"reputation": 35, "user_id": 10804781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7e77282e0cb612c2b79e3c3963a72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ivelin Krastev", "link": "https://stackoverflow.com/users/10804781/ivelin-krastev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 54216585, "answer_count": 1, "score": 0, "last_activity_date": 1547639829, "creation_date": 1547632061, "question_id": 54214268, "link": "https://stackoverflow.com/questions/54214268/retrieve-crash-report-programmatically-on-macos", "title": "Retrieve crash report programmatically on macOS", "body": "<p>I am implementing my own C/C++ app using the Qt framework.\nI want to retrieve the last crash log of my app at the time it crashes and send it to my API.\nIs there a Apple native or terminal way to retrieve the log or do I have to retrieve it the hard way?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1547629935, "post_id": 54213600, "comment_id": 95252980, "body": "That can vary wildly - it might even go up in a few cases. You&#39;ll have to measure."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547629939, "post_id": 54213600, "comment_id": 95252984, "body": "You save the function call overhead. So for a complex function, this is irrelevant, but for trivial functions this might be well about 90% of its execution time. Branching itself is often expensive for modern CPUs (pipeline flushing, caching issues etc pp), so it can be quite a gain to avoid it."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1547629979, "post_id": 54213600, "comment_id": 95253011, "body": "Have you tried writing a simple example program, disabling optimizations and timing the results? Either way it&#39;s going to depend heavily on circumstances that are out of the control of your program, such as the processor architecture."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547630133, "post_id": 54213600, "comment_id": 95253102, "body": "@Mark. It may same you only the function call."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1547630188, "post_id": 54213600, "comment_id": 95253140, "body": "<a href=\"https://en.cppreference.com/w/c/language/inline\" rel=\"nofollow noreferrer\">The <code>inline</code> function specifier</a> is only a <b><i>hint</i></b> that the compiler is allowed to inline the function. The compiler might not do it anyway. And it can decide to inline functions which are <i>not</i> marked as <code>inline</code> as well."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547630325, "post_id": 54213600, "comment_id": 95253221, "body": "Indeed the compiler is always allowed to inline a function call"}], "answers": [{"comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1547630186, "post_id": 54213706, "comment_id": 95253136, "body": "Bottom line: if you don&#39;t know how to use it - don&#39;t use it."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1547632188, "post_id": 54213706, "comment_id": 95254320, "body": "<code>As shown above, procedural integration</code>....<code>above</code> has to have a link!!"}], "tags": [], "owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "is_accepted": true, "score": 4, "last_activity_date": 1547632216, "last_edit_date": 1547632216, "creation_date": 1547630136, "answer_id": 54213706, "question_id": 54213600, "link": "https://stackoverflow.com/questions/54213600/how-much-speed-gain-if-using-inline/54213706#54213706", "title": "How much speed gain if using __INLINE__?", "body": "<p>Ripped from <a href=\"http://www.cs.technion.ac.il/users/yechiel/c++-faq/inline-and-perf.html\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<p>Yes and no. Sometimes. Maybe.</p>\n\n<p>There are no simple answers. inline functions might make the code faster, they might make it slower. They might make the executable larger, they might make it smaller. They might cause thrashing, they might prevent thrashing. And they might be, and often are, totally irrelevant to speed.</p>\n\n<p><strong>inline functions might make it faster</strong>: As shown <a href=\"http://www.cs.technion.ac.il/users/yechiel/c++-faq/procedural-integration.html\" rel=\"nofollow noreferrer\">above</a>, procedural integration might remove a bunch of unnecessary instructions, which might make things run faster.</p>\n\n<p><strong>inline functions might make it slower</strong>: Too much inlining might cause code bloat, which might cause \"thrashing\" on demand-paged virtual-memory systems. In other words, if the executable size is too big, the system might spend most of its time going out to disk to fetch the next chunk of code.</p>\n\n<p><strong>inline functions might make it larger</strong>: This is the notion of code bloat, as described above. For example, if a system has 100 inline functions each of which expands to 100 bytes of executable code and is called in 100 places, that's an increase of 1MB. Is that 1MB going to cause problems? Who knows, but it is possible that that last 1MB could cause the system to \"thrash,\" and that could slow things down.</p>\n\n<p><strong>inline functions might make it smaller</strong>: The compiler often generates more code to push/pop registers/parameters than it would by inline-expanding the function's body. This happens with very small functions, and it also happens with large functions when the optimizer is able to remove a lot of redundant code through procedural integration \u2014 that is, when the optimizer is able to make the large function small.</p>\n\n<p><strong>inline functions might cause thrashing</strong>: Inlining might increase the size of the binary executable, and that might cause thrashing.</p>\n\n<p><strong>inline functions might prevent thrashing</strong>: The working set size (number of pages that need to be in memory at once) might go down even if the executable size goes up. When f() calls g(), the code is often on two distinct pages; when the compiler procedurally integrates the code of g() into f(), the code is often on the same page.</p>\n\n<p><strong>inline functions might increase the number of cache misses</strong>: Inlining might cause an inner loop to span across multiple lines of the memory cache, and that might cause thrashing of the memory-cache.</p>\n\n<p><strong>inline functions might decrease the number of cache misses</strong>: Inlining usually improves locality of reference within the binary code, which might decrease the number of cache lines needed to store the code of an inner loop. This ultimately could cause a CPU-bound application to run faster.</p>\n\n<p><strong>inline functions might be irrelevant to speed</strong>: Most systems are not CPU-bound. Most systems are I/O-bound, database-bound or network-bound, meaning the bottleneck in the system's overall performance is the file system, the database or the network. Unless your \"CPU meter\" is pegged at 100%, inline functions probably won't make your system faster. (Even in CPU-bound systems, inline will help only when used within the bottleneck itself, and the bottleneck is typically in only a small percentage of the code.)</p>\n\n<p><strong>There are no simple answers</strong>: You have to play with it to see what is best. Do not settle for simplistic answers like, \"Never use inline functions\" or \"Always use inline functions\" or \"Use inline functions if and only if the function is less than N lines of code.\" These one-size-fits-all rules may be easy to write down, but they will produce sub-optimal results.</p>\n\n<p>Copyright (C) Marshall Cline</p>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 2, "last_activity_date": 1547630147, "creation_date": 1547630147, "answer_id": 54213710, "question_id": 54213600, "link": "https://stackoverflow.com/questions/54213600/how-much-speed-gain-if-using-inline/54213710#54213710", "title": "How much speed gain if using __INLINE__?", "body": "<p>Using <code>inline</code> makes the system use the <a href=\"https://www.cs.cornell.edu/courses/cs3110/2013sp/lectures/lec06-subst-model/lec06.html\" rel=\"nofollow noreferrer\">substitution model of evaluation</a>, but this is not guaranteed to be used all the time.  If this is used, the generated code will be longer and may be faster, but if some optimizations are active, the sustitution model is not faster not all the time.</p>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547632447, "post_id": 54214372, "comment_id": 95254492, "body": "To point 3: I think, &quot;static&quot; alone is enough so the compiler can skip the function if it is unused"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547632527, "post_id": 54214372, "comment_id": 95254555, "body": "@Ctx: <code>gcc -Wall</code> will issue a warning if a <code>static</code> function is not used, but not about if a <code>static inline</code> function is not used.  Should I clarify that in the point?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547632570, "post_id": 54214372, "comment_id": 95254577, "body": "Why not? This is new to me ;) I wonder, what the reason is for the different warning behaviour?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547632760, "post_id": 54214372, "comment_id": 95254688, "body": "@Ctx: I always use <code>-Wall</code>. It enables <code>-Wunused-function</code>: <i>&quot;Warn whenever a static function is declared but not defined or a non-inline static function is unused.&quot;</i>"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547633060, "post_id": 54214372, "comment_id": 95254870, "body": "As to why one would want the warning with a static but non-inline function, and not with a static inline function, is probably because they think along similar lines as I do on those four points.  Or maybe there is some obscure C standard wording regarding inline and non-inline functions with internal linkage that I&#39;ve missed, that makes the warning useful.  Or perhaps GCC folks have some other reason, I dunno.  But I&#39;d like to think most veteran C programmers agree with those points. :)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1547635533, "last_edit_date": 1547635533, "creation_date": 1547632372, "answer_id": 54214372, "question_id": 54213600, "link": "https://stackoverflow.com/questions/54213600/how-much-speed-gain-if-using-inline/54214372#54214372", "title": "How much speed gain if using __INLINE__?", "body": "<p>The reason I use <code>inline</code> function specifier (specifically, <code>static inline</code>), is not because of \"speed\", but because</p>\n\n<ol>\n<li><p><code>static</code> part tells the compiler the function is only visible in the current translation unit (the current file being compiled and included header files)</p></li>\n<li><p><code>inline</code> part tells the compiler it can include the implementation of the function at the call site, if it wants to</p></li>\n<li><p><code>static inline</code> tells the compiler that it can skip the function completely if it is not used at all in the current translation unit</p>\n\n<p>(Specifically, the compiler that I use most with the options I use most, <code>gcc -Wall</code>, does issue a warning if a function marked <code>static</code> is unused; but will not issue a warning if a function marked <code>static inline</code> is unused.)</p></li>\n<li><p><code>static inline</code> tells us humans that the function is a macro-like helper function, in addition adding type-checker to the same behavior as macro's.</p></li>\n</ol>\n\n<p>Thus, in my opinion, the assumption that <code>inline</code> has anything to do with <em>speed</em> per se, is incorrect.  Answering the stated question with a straight answer would be misleading.</p>\n\n<hr>\n\n<p>In my code, you see them associated with some data structures, or occasionally global variables.</p>\n\n<p>A typical example is when I want to implement a <a href=\"https://en.wikipedia.org/wiki/Xorshift\" rel=\"nofollow noreferrer\">Xorshift pseudorandom number generator</a> in my own C code:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n\nstatic uint64_t  prng_state = 1; /* Any nonzero uint64_t seed is okay */\n\nstatic inline uint64_t  prng_u64(void)\n{\n    uint64_t  state;\n\n    state = prng_state;\n    state ^= state &gt;&gt; 12;\n    state ^= state &lt;&lt; 25;\n    state ^= state &gt;&gt; 27;\n    prng_state = state;\n\n    return state * UINT64_C(2685821657736338717);\n}\n</code></pre>\n\n<p>The <code>static uint64_t  prng_state = 1;</code> means that <code>prng_state</code> is a variable of type <code>uint64_t</code>, visible only in the current compilation unit, and initialized to 1.  The <code>prng_u64()</code> function returns an unsigned 64-bit pseudorandom integer. However, if you do not use <code>prng_u64()</code>, the compiler will not generate code for it either.</p>\n\n<p>Another typical use case is when I have data structures, and they need accessor functions. For example,</p>\n\n<pre><code>#ifndef   GRID_H\n#define   GRID_H\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    int            rows;\n    int            cols;\n    unsigned char *cell;\n} grid;\n#define  GRID_INIT { 0, 0, NULL }\n\n#define  GRID_OUTSIDE -1\n\nstatic inline int grid_get(grid *const g, const int row, const int col)\n{\n    if (!g || row &lt; 0 || col &lt; 0 || row &gt;= g-&gt;rows || col &gt;= g-&gt;cols)\n        return GRID_OUTSIDE;\n    return g-&gt;cell[row * (size_t)(g-&gt;cols) + col];\n}\n\nstatic inline int grid_set(grid *const g, const int row, const int col,\n                           const unsigned char value)\n{\n    if (!g || row &lt; 0 || col &lt; 0 || row &gt;= g-&gt;rows || col &gt;= g-&gt;cols)\n        return GRID_OUTSIDE;\n    return g-&gt;cell[row * (size_t)(g-&gt;cols) + col] = value;\n}\n\nstatic inline void grid_init(grid *g)\n{\n    g-&gt;rows = 0;\n    g-&gt;cols = 0;\n    g-&gt;cell = NULL;\n}\n\nstatic inline void grid_free(grid *g)\n{\n    free(g-&gt;cell);\n    g-&gt;rows = 0;\n    g-&gt;cols = 0;\n    g-&gt;cell = NULL;\n}\n\nint grid_create(grid *g, const int rows, const int cols,\n                const unsigned char initial_value);\n\nint grid_load(grid *g, FILE *handle);\n\nint grid_save(grid *g, FILE *handle);\n\n#endif /* GRID_H */\n</code></pre>\n\n<p>That header file defines some useful helper functions, and declares the functions <code>grid_create()</code>, <code>grid_load()</code>, and <code>grid_save()</code>, that would be implemented in a separate .c file.</p>\n\n<p>(Yes, those three functions <em>could</em> be implemented in the header file just as well, but it would make the header file quite large. If you had a large project, spread over many translation units (.c source files), each one including the header file would get their own local copies of the functions.  The accessor functions defined as <code>static inline</code> above are short and trivial, so it is perfectly okay for them to be copied here and there.  The three functions I omitted are much larger.)</p>\n"}], "owner": {"reputation": 313, "user_id": 5518300, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PeMDlGROv_g/AAAAAAAAAAI/AAAAAAAAlto/MDId6DM4cC0/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/5518300/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 54213706, "answer_count": 3, "score": 0, "last_activity_date": 1547635533, "creation_date": 1547629748, "question_id": 54213600, "link": "https://stackoverflow.com/questions/54213600/how-much-speed-gain-if-using-inline", "title": "How much speed gain if using __INLINE__?", "body": "<p>In my understanding, <strong>INLINE</strong> can speed up code execution, is it?</p>\n\n<p>How much speed can we gain from it?</p>\n"}, {"tags": ["c", "function", "multidimensional-array"], "comments": [{"owner": {"reputation": 106, "user_id": 6354987, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Wt8Fh0WmeE/AAAAAAAAAAI/AAAAAAAAAB0/Vy8MbaoxzGw/photo.jpg?sz=128", "display_name": "Santhosh Arun", "link": "https://stackoverflow.com/users/6354987/santhosh-arun"}, "edited": false, "score": 4, "creation_date": 1547628958, "post_id": 54213300, "comment_id": 95252454, "body": "you are passing only one number square_matrix[4][4]. Pass it as x=Symmetrie(square_matrix);"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1547629157, "post_id": 54213300, "comment_id": 95252550, "body": "This shouldn&#39;t even <i>compile</i>, at least not without warnings. You&#39;re passing an <code>int</code> in place of an array, and you&#39;re accessing an array out of bounds. See the warnings at <a href=\"https://godbolt.org/z/MRSJWC\" rel=\"nofollow noreferrer\">godbolt.org/z/MRSJWC</a>. Also, why do you have <code>max</code> if you&#39;re hardcoding a 4x4 matrix?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547674680, "post_id": 54213300, "comment_id": 95277429, "body": "regarding: <code>x= Symmetrie(square_matrix[4][4]);</code>  This is passing an element that one row and one element past the end of the actual matrix.  Suggest: <code>x= Symmetrie(square_matrix);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11196, "user_id": 1079907, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7c69e39fbec2c781db5f27b40f63023?s=128&d=identicon&r=PG", "display_name": "Sunil Bojanapally", "link": "https://stackoverflow.com/users/1079907/sunil-bojanapally"}, "is_accepted": false, "score": 1, "last_activity_date": 1547629024, "creation_date": 1547629024, "answer_id": 54213395, "question_id": 54213300, "link": "https://stackoverflow.com/questions/54213300/check-if-a-matrix-is-symmetric-and-i-get-always-the-same-result/54213395#54213395", "title": "check if a matrix is symmetric and i get always the same result", "body": "<p>The below statement should be changed</p>\n\n<p><code>x= Symmetrie(square_matrix[4][4]);</code></p>\n\n<p>to</p>\n\n<p><code>x= Symmetrie(square_matrix);</code></p>\n\n<p><code>square_matrix[4][4]</code> is just a single element at provided indexes. Pass the address instead. </p>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 6, "last_activity_date": 1547629290, "last_edit_date": 1547629290, "creation_date": 1547629026, "answer_id": 54213396, "question_id": 54213300, "link": "https://stackoverflow.com/questions/54213300/check-if-a-matrix-is-symmetric-and-i-get-always-the-same-result/54213396#54213396", "title": "check if a matrix is symmetric and i get always the same result", "body": "<p>Change this:</p>\n\n<pre><code>x= Symmetrie(square_matrix[4][4]);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>x = Symmetrie(square_matrix);\n</code></pre>\n\n<p>since your method expects the whole matrix as its parameter, not just an element.</p>\n\n<p><code>square_matrix[4][4]</code> is a single element of the matrix, i.e. the element in 5th row and 5th column. Of course this invokes <em>Undefined Behavior (UB)</em>, since your matrix has 4 rows.</p>\n\n<p>More importantly, don't ignore the warnings generated. In GCC for example you would get something like this:</p>\n\n<pre><code>prog.c: In function 'main':\nprog.c:24:32: warning: passing argument 1 of 'Symmetrie' makes pointer from integer without a cast [-Wint-conversion]\n   24 |   x= Symmetrie(square_matrix[4][4]);\n      |                ~~~~~~~~~~~~~~~~^~~\n      |                                |\n      |                                int\nprog.c:5:20: note: expected 'int (*)[100]' but argument is of type 'int'\n    5 | int Symmetrie (int matrix[][max]) {\n      |                ~~~~^~~~~~~~~~~~~\n</code></pre>\n\n<p>as you can see in the <kbd><a href=\"https://wandbox.org/permlink/w8dURYQICnBg6L5E\" rel=\"noreferrer\">Live Demo</a></kbd>.</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "edited": false, "score": 0, "creation_date": 1547629467, "post_id": 54213399, "comment_id": 95252725, "body": "mmm why the ampersand ? i don&#39;t understand  passing the adress of the elements"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "edited": false, "score": 1, "creation_date": 1547629515, "post_id": 54213399, "comment_id": 95252761, "body": "If you don&#39;t use the ampersand @Amerov, then it would similar to passing <code>square_matrix[4][4]</code>, as you did in your code, with the only difference of passing a different element. The method expects the whole matrix, not just an element!"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1547630065, "post_id": 54213399, "comment_id": 95253066, "body": "@gsamaras so if I wirte it in that way Symmetrie(square_matrix[4][4])  as a parameter  here I&#39;m passing just one element right?"}], "tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": false, "score": 2, "last_activity_date": 1547629033, "creation_date": 1547629033, "answer_id": 54213399, "question_id": 54213300, "link": "https://stackoverflow.com/questions/54213300/check-if-a-matrix-is-symmetric-and-i-get-always-the-same-result/54213399#54213399", "title": "check if a matrix is symmetric and i get always the same result", "body": "<p>Modify your call </p>\n\n<p><code>x= Symmetrie(square_matrix[4][4]);</code></p>\n\n<p>to </p>\n\n<p><code>x= Symmetrie(&amp;square_matrix[0][0]);</code></p>\n"}, {"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1547629259, "post_id": 54213435, "comment_id": 95252608, "body": "Also adding <code>-Wall</code> to the compilation line (you don&#39;t even need <code>-Wextra</code> or <code>-pedantic</code>, which I also recommend) would catch the error."}, {"owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1547629351, "post_id": 54213435, "comment_id": 95252661, "body": "@DanielH, tnx, added"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1547629405, "post_id": 54213435, "comment_id": 95252687, "body": "@DanielH, check my <a href=\"https://stackoverflow.com/a/54213396/2411320\">answer</a>. There is no need for the warning flag...Although it&#39;s shouldn&#39;t hurt ofc ;)"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1547678406, "post_id": 54213435, "comment_id": 95278958, "body": "@gsamaras Oh, you&#39;re right. I already had <code>-Wall</code> on when I compiled, and it did expose another warning (array access out of bounds), but I didn&#39;t try it without any warnings."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1547709066, "post_id": 54213435, "comment_id": 95286284, "body": "@DanielH with GCC 9 and <code>-Wall</code> I do not get a warning of out bounds, see the <a href=\"https://wandbox.org/permlink/vbZOGm1vj5JhfO5t\" rel=\"nofollow noreferrer\">Live demo</a>."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1547709981, "post_id": 54213435, "comment_id": 95286641, "body": "@gsamaras I should have double-checked what I did. With <a href=\"https://wandbox.org/permlink/jrTzmGqtV7XW1Qid\" rel=\"nofollow noreferrer\"><code>-O3</code> in addition to <code>-Wall</code></a>, I get a warning from GCC that element 4 of the outer array isn&#39;t initialized; it looks like GCC doesn&#39;t see that without optimization. In Clang, even without <code>-Wall</code>, <a href=\"https://wandbox.org/permlink/3gHwgVG4H8q11Vc0\" rel=\"nofollow noreferrer\">I instead get</a> the error I mentioned about 4 being out-of-bounds for the inner array."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1547710745, "post_id": 54213435, "comment_id": 95286986, "body": "Fascinating stuff @DanielH about the optimization flag, I got the same with O1, O2 too. In Clang you mean you got the <i>warning</i> about the out of bounds, not the error. :)"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1547729627, "post_id": 54213435, "comment_id": 95297299, "body": "@gsamaras Yes, but I usually don&#39;t try to hard to distinguish them because in most cases I try to get warning-free builds. If you usually compile with <code>-Werror</code>, you don&#39;t always notice which word the compiler prints before it complains that you messed up."}], "tags": [], "owner": {"reputation": 6050, "user_id": 1030410, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e13caf6116a45714153bd145754fd292?s=128&d=identicon&r=PG", "display_name": "Daniel Trugman", "link": "https://stackoverflow.com/users/1030410/daniel-trugman"}, "is_accepted": false, "score": 3, "last_activity_date": 1547629600, "last_edit_date": 1547629600, "creation_date": 1547629151, "answer_id": 54213435, "question_id": 54213300, "link": "https://stackoverflow.com/questions/54213300/check-if-a-matrix-is-symmetric-and-i-get-always-the-same-result/54213435#54213435", "title": "check if a matrix is symmetric and i get always the same result", "body": "<p>Like others said, you should change:</p>\n\n<pre><code>x = Symmetrie(square_matrix[4][4]);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>x = Symmetrie(square_matrix);\n</code></pre>\n\n<p><strong>But</strong>, I would like to add and say that you could've found it very easily on your own by simply adding a small print.</p>\n\n<p>A simple <code>printf(\"%d =?= %d\", matrix[i][j], matrix[j][i])</code> right above the <code>if</code> would've shown you that the numbers are all gibberish.</p>\n\n<p><strong>Or</strong>, as @DanielH suggested, some compilers consider this as a warning, and you should not ignore these. For other compilers, adding <code>-Wall</code> as a compilation flag would have helped you catch this as well.</p>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 1, "last_activity_date": 1547629957, "creation_date": 1547629957, "answer_id": 54213659, "question_id": 54213300, "link": "https://stackoverflow.com/questions/54213300/check-if-a-matrix-is-symmetric-and-i-get-always-the-same-result/54213659#54213659", "title": "check if a matrix is symmetric and i get always the same result", "body": "<p>The other answers already show the issue, but I'd like to point out that, using VLA syntax, it is possible to pass the actual size of the array to the function.\nIt's also worth noting that the loops can be limited to only one half of the \"matrix\":</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool is_symmetric(size_t n, int matrix[n][n])\n{\n  for(size_t i = 0; i &lt; n; ++i) {\n    for(size_t j = 0; j &lt; i; ++j) {\n      //              ^^^^^\n      if (matrix[i][j] != matrix[j][i]) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nint main(void) {\n  int  square_matrix[][4] = {\n     {1,2,3,4}\n    ,{2,2,5,6}\n    ,{3,5,3,7}\n    ,{4,6,7,4}\n  };\n\n  if( is_symmetric(4, square_matrix) ) {\n    puts(\"The matrix is symmetric\");\n  } else {\n    puts(\"The matrix is not symmetric\");\n  }\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54213396, "answer_count": 5, "score": 2, "last_activity_date": 1547629957, "creation_date": 1547628702, "last_edit_date": 1547629795, "question_id": 54213300, "link": "https://stackoverflow.com/questions/54213300/check-if-a-matrix-is-symmetric-and-i-get-always-the-same-result", "title": "check if a matrix is symmetric and i get always the same result", "body": "<p>I wrote a function that checks if the matrix is Symmetric . If it is, it will return 1, otherwise 0 .\nIt always returns zero. I tried to figure out where the mistake is, but everything seems correct to me.</p>\n\n<p>My code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define max 100\n\nint Symmetrie (int matrix[][max]) {\n  int i,j;\n  for(i=0;i&lt;4;i++) {\n    for(j=0;j&lt;4;j++) {\n      if(matrix[i][j] != matrix[j][i]) {\n        return 0;\n      }\n    }\n  }\n  return 1;\n}\n\nint main() {\n  int x;\n  int  square_matrix[][max]={{1,2,3,4}\n    ,{2,2,5,6}\n    ,{3,5,3,7}\n    ,{4,6,7,4}\n  };\n  x= Symmetrie(square_matrix[4][4]);\n  if(x==1) {\n    printf(\"1\");\n  } else {\n    printf(\"0\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The function should return 1, but it returns zero. What am I missing?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1547628659, "post_id": 54213211, "comment_id": 95252316, "body": "Arrays start with index <code>0</code> and go to index <code>n - 1</code>. You&#39;re considering <code>listId[1]</code> through <code>listId[10]</code> ... ignoring <code>listId[0]</code> and trying to access the inexistent <code>listId[10]</code> (the same for <code>listScore[]</code>). Same error with <code>students[]</code> in <code>output()</code> and <code>summary()</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547628766, "post_id": 54213211, "comment_id": 95252367, "body": "...similarly when initialising <code>listScore</code>."}, {"owner": {"reputation": 2292, "user_id": 4502035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38a1b21c3e83f9d10aaa56c93f6150a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/4502035/andreas"}, "edited": false, "score": 0, "creation_date": 1547628855, "post_id": 54213211, "comment_id": 95252408, "body": "Now would be a good time for you to learn how to use a debugging tool"}], "answers": [{"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1547629091, "post_id": 54213241, "comment_id": 95252512, "body": "This is probably the immediate cause of the infinite loop. @OP: read the comments and mind them!"}, {"owner": {"reputation": 770, "user_id": 4782751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ab48491eb7504c27c15277c7337bd?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Vadehra", "link": "https://stackoverflow.com/users/4782751/manoj-vadehra"}, "edited": false, "score": 0, "creation_date": 1547629946, "post_id": 54213241, "comment_id": 95252992, "body": "Sorry.. Didn&#39;t have enough rep to comment."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5718, "user_id": 10584605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1", "display_name": "ETO", "link": "https://stackoverflow.com/users/10584605/eto"}, "edited": false, "score": 0, "creation_date": 1547631669, "post_id": 54213241, "comment_id": 95253994, "body": "@ETO well, I think it does. Ending the answer with a question is probably a poor wording, but all in all, it <b>is</b> an answer."}, {"owner": {"reputation": 5718, "user_id": 10584605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1", "display_name": "ETO", "link": "https://stackoverflow.com/users/10584605/eto"}, "edited": false, "score": 0, "creation_date": 1547631899, "post_id": 54213241, "comment_id": 95254132, "body": "@ManojVadehra Alright. Pls avoid asking questions in your answers. Write a comment if you want to clarify something."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5718, "user_id": 10584605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1", "display_name": "ETO", "link": "https://stackoverflow.com/users/10584605/eto"}, "edited": false, "score": 0, "creation_date": 1547631949, "post_id": 54213241, "comment_id": 95254162, "body": "@ETO FYI - this is not &quot;my&quot; answer. :)"}, {"owner": {"reputation": 5718, "user_id": 10584605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1", "display_name": "ETO", "link": "https://stackoverflow.com/users/10584605/eto"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1547632058, "post_id": 54213241, "comment_id": 95254226, "body": "@SouravGhosh, Yup :)"}], "tags": [], "owner": {"reputation": 770, "user_id": 4782751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ab48491eb7504c27c15277c7337bd?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Vadehra", "link": "https://stackoverflow.com/users/4782751/manoj-vadehra"}, "is_accepted": false, "score": 5, "last_activity_date": 1547632200, "last_edit_date": 1547632200, "creation_date": 1547628490, "answer_id": 54213241, "question_id": 54213211, "link": "https://stackoverflow.com/questions/54213211/no-output-from-running-this-code-is-there-an-infinite-loop/54213241#54213241", "title": "no output from running this code, is there an infinite loop?", "body": "<p>Looks like you're incrementing wrong variable here</p>\n\n<pre><code>for(j=1; j &lt;= 100; k++) {\n    listScore[j]= -1;\n}\n</code></pre>\n\n<p>Try using <code>j++</code> instead of <code>k++</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "is_accepted": false, "score": 0, "last_activity_date": 1547649611, "creation_date": 1547649611, "answer_id": 54219456, "question_id": 54213211, "link": "https://stackoverflow.com/questions/54213211/no-output-from-running-this-code-is-there-an-infinite-loop/54219456#54219456", "title": "no output from running this code, is there an infinite loop?", "body": "<p>in 158th line you increment the wrong variable causing the loop running infinite time.</p>\n\n<pre><code>for(j=1; j&lt;=100;k++)\n{listScore[j]= -1;}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10609592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1547649611, "creation_date": 1547628385, "question_id": 54213211, "link": "https://stackoverflow.com/questions/54213211/no-output-from-running-this-code-is-there-an-infinite-loop", "title": "no output from running this code, is there an infinite loop?", "body": "<p>It seems I have an infinite loop in here, nothing seems to happen when I run it. I'm not sure if I am even starting the process right because nothing happens.</p>\n\n<p>objective->\n1. Write a function struct student* allocate () that allocates memory for ten students and returns the pointer.\n2. Write a function void generate (struct student* students) that generates random IDs and scores for each of the ten students and stores them\nin the array of students. Ensure that IDs are unique also and between 1 and 10 (both inclusive) and scores are between 0 and 100 (both\ninclusive). To generate unique IDs you can either use the brute-force random/check/repeat (generate a random integer between 1- 10 and then\nconfirm that it hasn't been used yet for a student ID) or you can use the Fisher Yates shuffle -(<a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Fisher%E2%80%</a>\n93Yates_shuffle).\n3. Write a function void output (struct student* students) that prints the IDs and scores of all the students. The output of the function needs not\nto be sorted.\n4. Write a function void summary (struct student* students) that prints the minimum score, maximum score and average score of the ten\nstudents.\n5. Write a function void deallocate (struct student* stud) that frees the memory allocated to students. Check that students is not NULL (NULL\n== 0) before you attempt to free it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\nstruct student{\n    int id;\n    int score;\n};\n\nstruct student* allocate(){\n     /*Allocate memory for ten students*/\n     struct student * students = malloc(10* sizeof(struct student));\n    return students;\n     /*Return the pointer*/\n}\n\nvoid generate(struct student* students){\n     /*Generate random and unique IDs and random scores for ten students, \nIDs being between 1 and 10, scores between 0 and 100*/\n    int j;\n    int k;\n    int i;\n    int listScore[100];\n    int listId[10];\n\n    for(k=1; k&lt;=10;k++)\n        {listId[k]= -1;}    \n    for(j=1; j&lt;=100;k++)\n        {listScore[j]= -1;}\n    for(i=0;i&lt;10;i++)\n    {\n     int y = i+(rand() % (10-i));\n     int temp = listId[i];\n     listId[i] = listId[j];\n     listId[j]=temp;\n    }\n    for(i=0;i&lt;10;i++)\n    {\n        students[i].id = listId[i];  \n    }\n    for(i=0;i&lt;100;i++)\n    {\n     int y = i+(rand() % (100-i));\n     int temp = listScore[i];\n     listScore[i] = listScore[j];\n     listScore[j]=temp;\n    }\n    for(i=0;i&lt;10;i++)\n    {\n        students[i].score = listScore[i];  \n    }\n}\n\nvoid output(struct student* students){\n    int i;\n    printf(\"ID1 Score%d\\n\",students[1].score);\n    for(i=2; i&lt;=10; i++ )\n    {\n        printf(\"ID%d score%d\\n\", i, students[i].score);\n    }\n    /*Output information about the ten students in the format:\n              ID1 Score1\n              ID2 score2\n              ID3 score3\n              ...\n              ID10 score10*/\n}\n\nvoid summary(struct student* students){\n    int i;\n    int min = students[1].score;\n    int max= students[1].score;\n    int sum = 0;\n    for(i=2;i&lt;=10;i++)\n    {\n        if(students[i].score &lt; min)\n        {\n            min = students[i].score;\n        }\n    }\n    for(i=2;i&lt;=10;i++)\n    {\n        if(students[i].score &gt;max)\n        {\n            max = students[i].score;\n        }\n    }\n    for(i=1; i&lt;=10; i++)\n    {\n        sum += students[i].score;\n    }\n    sum /=10;\n    printf(\"Minimum score = %d\\nMaximum score = %d\\nAverage score = %d\",min,max,sum);\n    /*Compute and print the minimum, maximum and average scores of the \nten students*/\n\n}\n\nvoid deallocate(struct student* stud){\n     /*Deallocate memory from stud*/\n    if(stud != NULL)\n    {\n        free(stud);\n    }\n}\nint main(){\n    srand(time(0));\n    struct student* stud = NULL;\n\n    /*Call allocate*/\n    stud = allocate();\n    /*Call generate*/\n    generate(stud);\n    /*Call output*/\n    output(stud);\n    /*Call summary*/\n    summary(stud);\n    /*Call deallocate*/\n    deallocate(stud);\n    return 0;\n}\n\n/* CS261- Assignment 1 - Q.1*/\n/* Name:\n * Date:\n * Solution description:\n */\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\nstruct student{\n    int id;\n    int score;\n};\n\nstruct student* allocate(){\n     /*Allocate memory for ten students*/\n     struct student * students = malloc(10* sizeof(struct student));\n    return students;\n     /*Return the pointer*/\n}\n\nvoid generate(struct student* students){\n     /*Generate random and unique IDs and random scores for ten students, \nIDs being between 1 and 10, scores between 0 and 100*/\n    int j;\n    int k;\n    int i;\n    int listScore[100];\n    int listId[10];\n\n    for(k=1; k&lt;=10;k++)\n        {listId[k]= -1;}    \n    for(j=1; j&lt;=100;k++)\n        {listScore[j]= -1;}\n    for(i=0;i&lt;10;i++)\n    {\n     int y = i+(rand() % (10-i));\n     int temp = listId[i];\n     listId[i] = listId[j];\n     listId[j]=temp;\n    }\n    for(i=0;i&lt;10;i++)\n    {\n        students[i].id = listId[i];  \n    }\n    for(i=0;i&lt;100;i++)\n    {\n     int y = i+(rand() % (100-i));\n     int temp = listScore[i];\n     listScore[i] = listScore[j];\n     listScore[j]=temp;\n    }\n    for(i=0;i&lt;10;i++)\n    {\n        students[i].score = listScore[i];  \n    }\n}\n\nvoid output(struct student* students){\n    int i;\n    printf(\"ID1 Score%d\\n\",students[1].score);\n    for(i=2; i&lt;=10; i++ )\n    {\n        printf(\"ID%d score%d\\n\", i, students[i].score);\n    }\n    /*Output information about the ten students in the format:\n              ID1 Score1\n              ID2 score2\n              ID3 score3\n              ...\n              ID10 score10*/\n}\n\nvoid summary(struct student* students){\n    int i;\n    int min = students[1].score;\n    int max= students[1].score;\n    int sum = 0;\n    for(i=2;i&lt;=10;i++)\n    {\n        if(students[i].score &lt; min)\n        {\n            min = students[i].score;\n        }\n    }\n    for(i=2;i&lt;=10;i++)\n    {\n        if(students[i].score &gt;max)\n        {\n            max = students[i].score;\n        }\n    }\n    for(i=1; i&lt;=10; i++)\n    {\n        sum += students[i].score;\n    }\n    sum /=10;\n    printf(\"Minimum score = %d\\nMaximum score = %d\\nAverage score = %d\",min,max,sum);\n    /*Compute and print the minimum, maximum and average scores of the \nten students*/\n\n}\n\nvoid deallocate(struct student* stud){\n     /*Deallocate memory from stud*/\n    if(stud != NULL)\n    {\n        free(stud);\n    }\n}\nint main(){\n    srand(time(0));\n    struct student* stud = NULL;\n\n    /*Call allocate*/\n    stud = allocate();\n    /*Call generate*/\n    generate(stud);\n    /*Call output*/\n    output(stud);\n    /*Call summary*/\n    summary(stud);\n    /*Call deallocate*/\n    deallocate(stud);\n    return 0;\n}\n</code></pre>\n\n<p>enter code here</p>\n"}, {"tags": ["c", "arrays", "sorting", "bubble-sort"], "comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1547626786, "post_id": 54212804, "comment_id": 95251446, "body": "It doesn&#39;t look correct, in your if condition you are comparing a[j] with a[j-1] but swapping a[j] with a[j+1] should the swap also be the same as the condition ?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547626876, "post_id": 54212804, "comment_id": 95251491, "body": "<code>for(j=n;j&lt;i+1;</code> - If <code>j = n</code> and <code>i &lt; n</code>, how can <code>j</code> be smaller than <code>i</code>? Your inner loop makes no sense."}, {"owner": {"reputation": 33, "user_id": 10912889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gy72E.jpg?s=128&g=1", "display_name": "pustiul500", "link": "https://stackoverflow.com/users/10912889/pustiul500"}, "edited": false, "score": 0, "creation_date": 1547627443, "post_id": 54212804, "comment_id": 95251754, "body": "Well, I thought so too. But doesn&#39;t the pseudocode say that? I mean line 2: j=a.length.  By the way, what &#39;downto&#39; refers to? &quot;&lt;&quot;?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547669937, "post_id": 54212804, "comment_id": 95275282, "body": "@pustiul500 It means the loop counts down instead of up. Instead of incrementing the loop variable after each iteration, it decrements it, and the target value is not an upper bound, but a lower bound. For example, <code>for i = 1 to 10</code> counts from 1 to 10 (1, 2, 3, ...), but <code>for i = 10 downto 1</code> counts from 10 down to 1 (10, 9, 8, ...)."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10912889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gy72E.jpg?s=128&g=1", "display_name": "pustiul500", "link": "https://stackoverflow.com/users/10912889/pustiul500"}, "edited": false, "score": 0, "creation_date": 1547627615, "post_id": 54212903, "comment_id": 95251838, "body": "As far as I know, Cormen is starting all his for&#39;s from 1, ignoring 0.  I made the changes suggested by you, altough I let the for starting from 1, and it know works.  One question, if you please: Did I intrerpretate the pseudocode correctly? If so, why it didn&#39;t work and instead of &quot;j&lt;i+1;j++&quot; the correct code is &quot;j&gt;i;j--&quot;?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547631826, "post_id": 54212903, "comment_id": 95254089, "body": "No, pustiul, it <b>won&#39;t</b> work when starting from 1. The example uses arrays <code>1..n</code> but, as said, C arrays are <code>0..n-1</code>. Don&#39;t try to be clever; just try to learn."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 33, "user_id": 10912889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gy72E.jpg?s=128&g=1", "display_name": "pustiul500", "link": "https://stackoverflow.com/users/10912889/pustiul500"}, "edited": false, "score": 0, "creation_date": 1547632018, "post_id": 54212903, "comment_id": 95254201, "body": "@pustiul500, you did not interpret the pseudo code correctly, In particular, you changed the word <i>downto</i> to <i>upto</i> (Melpomene&#39;s 2nd comment)."}, {"owner": {"reputation": 33, "user_id": 10912889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gy72E.jpg?s=128&g=1", "display_name": "pustiul500", "link": "https://stackoverflow.com/users/10912889/pustiul500"}, "edited": false, "score": 0, "creation_date": 1547632913, "post_id": 54212903, "comment_id": 95254773, "body": "I do try to learn. But this is the way we were teached the whole semester, to start for&#39;s from 1, based on Cormen&#39;s book, in order to not confuse us later on.  I&#39;ll revise everything again and try to look at it from another angle."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1547627127, "creation_date": 1547627127, "answer_id": 54212903, "question_id": 54212804, "link": "https://stackoverflow.com/questions/54212804/bubble-sort-not-sorting-in-c-cormens-pseudocode/54212903#54212903", "title": "Bubble-Sort not sorting in C (Cormen&#39;s pseudocode)", "body": "<p>There are at least three issues:</p>\n\n<ol>\n<li><p>The pseudocode assumes array indices go from <code>1</code> to <code>length</code>. In C arrays are indexed from <code>0</code> to <code>length-1</code>; your code doesn't correct for that.</p></li>\n<li><p>The inner loop in the pseudocode goes <em><code>downto</code></em> <code>i+1</code>, but your inner loop tries to count <em>up</em>:</p>\n\n<pre><code>for(j=n;j&lt;i+1;j++)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>for (j = n; j &gt; i; j--)\n</code></pre></li>\n<li><p>The pseudocode swaps <code>A[j]</code> and <code>A[j-1]</code>, but your C code swaps <code>A[j]</code> and <code>A[j+1]</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 7927200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a94c975d5ce0fe1b5f06edf3dc043a?s=128&d=identicon&r=PG&f=1", "display_name": "Niloy Rashid", "link": "https://stackoverflow.com/users/7927200/niloy-rashid"}, "is_accepted": false, "score": 0, "last_activity_date": 1547669796, "last_edit_date": 1547669796, "creation_date": 1547653236, "answer_id": 54220541, "question_id": 54212804, "link": "https://stackoverflow.com/questions/54212804/bubble-sort-not-sorting-in-c-cormens-pseudocode/54220541#54220541", "title": "Bubble-Sort not sorting in C (Cormen&#39;s pseudocode)", "body": "<p>Mistakes in your implementation:</p>\n\n<ol>\n<li>You start counting your array from 1th index. But in C programing a array start with 0th position. [you should right i = 0 instead of i = 1]</li>\n<li>The inner loop must run from <strong><em>j = n-1</em></strong> from <strong><em>j = i+1</em></strong> and the value of <strong><em>j</em></strong> must be decreasing.</li>\n<li>You compare  <strong><em>a[j]</em></strong> with <strong><em>a[j-1]</em></strong> but u swap <strong><em>a[j]</em></strong> with <strong><em>a[j+1]</em></strong>. you should have swap <strong><em>a[j]</em></strong> with <strong><em>a[j-1]</em></strong></li>\n</ol>\n\n<p>See the changes in the code below. Hope it will be useful: </p>\n\n<pre><code>int i, j, aux;\nfor(i=0;i&lt;n-1;i++){\n    for(j=n-1;j&gt;=i+1;j--){\n        if(a[j]&lt;a[j-1]){\n            aux=a[j];\n            a[j]=a[j-1];\n            a[j-1]=aux;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10912889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gy72E.jpg?s=128&g=1", "display_name": "pustiul500", "link": "https://stackoverflow.com/users/10912889/pustiul500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 54212903, "answer_count": 2, "score": -1, "last_activity_date": 1547673389, "creation_date": 1547626662, "last_edit_date": 1547673389, "question_id": 54212804, "link": "https://stackoverflow.com/questions/54212804/bubble-sort-not-sorting-in-c-cormens-pseudocode", "title": "Bubble-Sort not sorting in C (Cormen&#39;s pseudocode)", "body": "<p>So I was trying to implement <a href=\"https://i.imgur.com/X0Flieg.png\" rel=\"nofollow noreferrer\">Cormen's pseudocode</a> for bubble sorting but I can't seem to get it to work.</p>\n\n<p>This is my approach on Cormen's pseudocode:</p>\n\n<pre><code>void BUBBLE_SORT(int a[200], int n) {\n    int i, j, aux;\n\n    for (i = 1; i &lt;= n - 1; i++) {\n        for (j = n; j &lt; i + 1; j++) {\n            if (a[j] &lt; a[j - 1]) {\n                aux = a[j];\n                a[j] = a[j + 1];\n                a[j + 1] = aux;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I tried another piece of code found on the internet but the result was not different:</p>\n\n<pre><code>void bubbleSort(int arr[], int n) {\n    int i, j;     \n    for (i = 0; i &lt; n - 1; i++)          \n        for (j = 0; j &lt; n - i - 1; j++)  \n            if (arr[j] &gt; arr[j + 1]) \n                swap(&amp;arr[j], &amp;arr[j + 1]);  \n}\n</code></pre>\n\n<p>I would love to know where my comprehension failed in understanding Cormen's implementation and to get the bubble sorting to work!</p>\n"}, {"tags": ["c", "multithreading", "affinity", "aio"], "comments": [{"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "edited": false, "score": 0, "creation_date": 1547631532, "post_id": 54212444, "comment_id": 95253906, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53542815/how-to-assign-threads-to-different-cores-in-c\">How to assign threads to different cores in C?</a>"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1547632604, "post_id": 54212444, "comment_id": 95254597, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1407786/how-to-set-cpu-affinity-of-a-particular-pthread\">how to set CPU affinity of a particular pthread?</a>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1547644939, "post_id": 54212444, "comment_id": 95261537, "body": "This will make your writing slower as the data will always have to be handed off from the core that&#39;s only doing AIO initiation to whatever core is running the code that actually does the I/O. Perhaps worse, it&#39;ll also have to be handed off from the core that received the packet to the core that&#39;s running the AIO code first. You don&#39;t know better than the OS which core is the best one to run this code on. Why force its hand?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1547645047, "post_id": 54212444, "comment_id": 95261604, "body": "How much data in total are you trying to write? What&#39;s your disk&#39;s sequential speed? How fast is the data coming in? How much RAM are you willing to use for buffering?"}, {"owner": {"reputation": 2626, "user_id": 300290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wI1od.png?s=128&g=1", "display_name": "Mike Andrews", "link": "https://stackoverflow.com/users/300290/mike-andrews"}, "edited": false, "score": 0, "creation_date": 1547673366, "post_id": 54212444, "comment_id": 95276832, "body": "If by &quot;libaio&quot;, you&#39;re talking <code>io_submit</code>, then there&#39;s nothing automatic with threading.  You&#39;ll have to roll your own thread and get the data over there. <code>io_submit</code> is not really non-blocking.  You can expect to be in that call for several microseconds or longer, depending on the situation.  So depending on your design, it can be beneficial to sequester it in its own thread."}, {"owner": {"reputation": 73, "user_id": 10921015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f930784d7988313922bf7fad4c2583?s=128&d=identicon&r=PG&f=1", "display_name": "Resist", "link": "https://stackoverflow.com/users/10921015/resist"}, "edited": false, "score": 0, "creation_date": 1547870843, "post_id": 54212444, "comment_id": 95351908, "body": "Actually I have analyzed the program via htop which showed me up that packets lost would occur when loads on responsible CPU core increase to 100 percent. So I have been deciding to persuade OS to create a specific thread in AIO as writer and assign a specific CPU core to it. My program read rate is more than 1.1 MB per second and I&#39;m sure that program bottleneck is it&#39;s writing speed which occurs as aforementioned."}], "owner": {"reputation": 73, "user_id": 10921015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f930784d7988313922bf7fad4c2583?s=128&d=identicon&r=PG&f=1", "display_name": "Resist", "link": "https://stackoverflow.com/users/10921015/resist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547635155, "creation_date": 1547625034, "last_edit_date": 1547635155, "question_id": 54212444, "link": "https://stackoverflow.com/questions/54212444/how-to-create-separate-thread-as-writer-in-aio-and-bind-it-to-specific-cpu-core", "title": "How to create separate thread as writer in aio and bind it to specific CPU core?", "body": "<p>I read the packets from NIC in high rate and my writing speed is my program bottleneck would be caused packet losts. I browsed the web for solutions, and have reformed my code with AIO solutions and neither POSIX nor Linux-libaio satisfy my requirement for high rate writing with no lost.</p>\n\n<p>Now I want to have a specific thread as writer in AIO which is bound to specific CPU core which is separated from program's main core.I tried to do that with POSIX and Linux-libaio but failed. POSIX creates two threads while program execution but both of them are on same CPU. </p>\n\n<p>It will be appreciated if anyone help me to know that <strong>is there any possibility to persuade OS to create a specific thread in AIO as writer and assign a specific CPU core to it?</strong></p>\n\n<p><strong><em>Note: my programming language is C on Linux</em></strong></p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1547622405, "post_id": 54211886, "comment_id": 95249729, "body": "It&#39;s got its second argument for a reason. This is an idiomatic C-way to try avoid overflows."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1547622991, "post_id": 54211886, "comment_id": 95249962, "body": "@bipll But if we do not allocate enough we will face underflow... So the rest of the string will be silently truncated"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1547623305, "post_id": 54211886, "comment_id": 95250104, "body": "There is no &quot;silent&quot; truncation, see <a href=\"http://man7.org/linux/man-pages/man3/snprintf.3p.html\" rel=\"nofollow noreferrer\">snprintf.3p - Linux manual page</a> paying careful attention to the <code>&quot;RETURN&quot;</code> portion. You validate the return against the buffer size."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 2, "creation_date": 1547624335, "post_id": 54211886, "comment_id": 95250528, "body": "by definition   <code>sizeof(char)</code> is 1"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1547625173, "post_id": 54211886, "comment_id": 95250850, "body": "One reason that what you show is not necessarily what people do is that there is a perceived cost to formatting the data twice, once to find out how long it will be and a second time to actually do the formatting.  In your example with short fixed-length strings, the cost is not great.  With more complex formats, more arguments, and especially longer string arguments, there is some cause for concern (but measurement would still be a good idea \u2014 how slow is it really?).  Some systems (Linux, GNU C Library) have <code>asprintf()</code> and <code>vasprintf()</code>; using these can be a good idea."}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 1, "creation_date": 1547625803, "post_id": 54211886, "comment_id": 95251064, "body": "Agree on previous comment and just small addition - your approach requires to specify the same formatting string twice, which in case of complex string is error-prone because declaring format strings with preprocessor defines is also a bad practice."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1547662848, "last_edit_date": 1547662848, "creation_date": 1547662134, "answer_id": 54222924, "question_id": 54211886, "link": "https://stackoverflow.com/questions/54211886/snprintf-usage-for-making-up-formatted-strings/54222924#54222924", "title": "snprintf usage for making up formatted strings", "body": "<p>The 2x call to <code>snprintf()</code> is a common idiom.</p>\n\n<blockquote>\n  <p>... has another problem?</p>\n</blockquote>\n\n<p>Problems lie in the corners</p>\n\n<p><strong>Format maintenance</strong></p>\n\n<p>The below suffers from a repeated format - prone to breaking as code ages and and only one line is changed.</p>\n\n<pre><code>// Oops!\nint need_space = snprintf(NULL, 0, \"abs %s\", \"fgh\") + 1;\nchar *const str = malloc(need_space * sizeof(char));\nint written = snprintf(str, need_space, \"abs %s \", \"fgh\");\n</code></pre>\n\n<p>Did you notice the difference?</p>\n\n<p>Better to state the format once.</p>\n\n<pre><code>#define FMT_ABS_S \"abs %s\"\nint need_space = snprintf(NULL, 0, FMT_ABS_S, \"fgh\");\nchar *const str = malloc(sizeof *str * (need_space + 1u));\nint written = snprintf(str, need_space, FMT_ABS_S, \"fgh\");\n</code></pre>\n\n<p><strong>Volatility</strong></p>\n\n<p>Code needs to insure the values do not change (non-<code>volatile</code>) between the 2 calls and special concern arise in multi-threaded applications.</p>\n\n<p><strong>Error checking</strong></p>\n\n<p>Code lacked checks.  Yet even with checks, how to even handle unexpected results - perhaps just bail?</p>\n\n<pre><code>static const char *fmt_s = \"abs %s\";\nint need_space = snprintf(NULL, 0, fmt_s, \"fgh\");\nif (need_space &lt; 0) {\n  Handle_EncodingError();\n}\nchar *const str = malloc(sizeof *str * (need_space + 1u));\nif (str == NULL) {\n  Handle_OutOfMemory();\n}\nint written = snprintf(str, need_space, fmt_s, \"fgh\");\nif (written &lt; 0 || written &gt; need_space) {\n  Handle_Error();\n}\n</code></pre>\n\n<p><strong>Going twice though</strong></p>\n\n<p>2 calls can be wasteful in select situations, yet commonly the impact is less than thought. <a href=\"https://stackoverflow.com/questions/54211886/snprintf-usage-for-making-up-formatted-strings/54222924#comment95250850_54211886\">@Jonathan Leffler</a></p>\n\n<p>Yet for me, the \"what to do if allocation fails\" is a show stopper anyways and code reports the error and maybe exit.  </p>\n\n<p><strong>Selectively, once is enough</strong></p>\n\n<p>When the <code>s*printf()</code> format is tightly controlled, I see 1 call as sufficient.</p>\n\n<pre><code>// int to string\n\n#define LOG2_N 28\n#define LOG2_D 93\n// Number of char needed for a string of INT_MIN is log10(bit width) + 3\n#define INT_LEN ((sizeof(int)*CHAR_BIT-1)*LOG2_N/LOG2_D + 3)\n\nchar s[INT_LEN * 2];  // I like to use 2x to handle locale issues, no need to be stingy here.\n\nint len = snprintf(s, sizeof s, \"%d\", i);\n\nif (len &lt; 0 || len &gt;= sizeof s) {\n  Handle_VeryUnusualFailure();\n}\n</code></pre>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 54222924, "answer_count": 1, "score": 3, "last_activity_date": 1547662848, "creation_date": 1547622166, "question_id": 54211886, "link": "https://stackoverflow.com/questions/54211886/snprintf-usage-for-making-up-formatted-strings", "title": "snprintf usage for making up formatted strings", "body": "<p>I'm trying to learn about the <code>snprintf</code> and found <a href=\"https://stackoverflow.com/a/12065309/2786156\">this answer</a> with the example:</p>\n\n<pre><code>char buf[20] = \"\";\nchar *cur = buf, * const end = buf + sizeof buf;\ncur += snprintf(cur, end-cur, \"%s\", \"foo\");\nprintf(\"%s\\n\", buf);\nif (cur &lt; end) {\n    cur += snprintf(cur, end-cur, \"%s\", \" bar\");\n}\nprintf(\"%s\\n\", buf);\nfree(str);\n</code></pre>\n\n<p>The thing that is not clear to me is that we allocate a fixed hardcoded buffer size which seems suffer from buffer overflow. In the N1570 I found that  (7.21.6.5)</p>\n\n<blockquote>\n  <p>1</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint snprintf(char * restrict s, size_t n,\nconst char * restrict format, ...);\n</code></pre>\n  \n  <p>2 The snprintf function is equivalent to fprintf, except that the\n  output is written into an array (specified by argument s) rather than\n  to a stream. If n is zero, nothing is written, and s may be a null\n  pointer.</p>\n</blockquote>\n\n<p>So to me it appears as the idiomatic usage would be as follows:</p>\n\n<pre><code>int need_space = snprintf(NULL, 0, \"abs %s\", \"fgh\") + 1; //How much to allocate?\nchar *const str = malloc(need_space * sizeof(char)); //allocate\nint written = snprintf(str, need_space, \"abs %s\", \"fgh\"); //do format\nprintf(\"Need space = %d, written = %d\\n\", need_space, written);\nprintf(\"%s\\n\", str);\n</code></pre>\n\n<p>Or this is not common and has another problem?</p>\n"}, {"tags": ["c", "linux", "sockets", "ubuntu", "tcp"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1547627555, "post_id": 54211683, "comment_id": 95251805, "body": "You don&#39;t have to add <code>master_socket</code> to <code>writefds</code> because you only use it for <code>accept()</code>. You may want to add the client sockets to <code>writefds</code> because you probably will use it for <code>read</code> and <code>write</code>. I noticed that you use <code>if (FD_ISSET(master_socket, &amp;readfds))</code> twice. This is probably not what you want. After <code>new_socket = accept(...)</code> you call <code>read(new_socket, ...)</code> If this blocks because the client might not have sent any data yet, it will prevent your server from accepting the next connection."}, {"owner": {"reputation": 1, "user_id": 6321380, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZRxtGsq3T-4/AAAAAAAAAAI/AAAAAAAAAGg/wIfQNKIkd3o/photo.jpg?sz=128", "display_name": "Tragend", "link": "https://stackoverflow.com/users/6321380/tragend"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1547633632, "post_id": 54211683, "comment_id": 95255216, "body": "Thanks. I added client socket to writefds and it works. Another issue I have is the server stops sending/receiving after the client sent data to the server or if it is connected to a second client. I want the server to be able to send and receive messages continuously, broadcast to all clients and also able to customize messages to individual client. What do I do to make this happen?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1547641879, "post_id": 54211683, "comment_id": 95259844, "body": "Please update the code in your question to show your modification. Your server code can block in <code>getchar()</code>. You would have to use non-blocking input as well. See <a href=\"https://stackoverflow.com/questions/448944/c-non-blocking-keyboard-input\" title=\"c non blocking keyboard input\">stackoverflow.com/questions/448944/&hellip;</a> . You would need to add the input file desriptor to <code>readfds</code> together with the sockets and handle the input parallel to the socket communication until you decide that it&#39;s time to send it. You would have to handle partial <code>read</code>s and <code>write</code>s as well. Using <code>fork</code> to use a separate process per connection might be easier."}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1547638598, "last_edit_date": 1547638598, "creation_date": 1547638110, "answer_id": 54216115, "question_id": 54211683, "link": "https://stackoverflow.com/questions/54211683/how-do-i-use-both-writefds-and-readfds-for-multiple-client-server-communication/54216115#54216115", "title": "How do I use both writefds and readfds for multiple client server communication program in C language?", "body": "<p>As side node, it appears that you expect <code>read</code> to zero-terminate received data. That is not the case. The length of received data is in the return value of <code>read</code>, it must not be ignored.</p>\n\n<p>It also appears that you expect <code>write</code> to find the end of the string you are sending. That doesn't happen. You must specify the exact length of the data you are sending, rather than the length of the buffer that contains the data.</p>\n\n<p><code>send/write</code> and <code>recv/read</code> functions work on binary data rather than zero-terminated strings and can send/receive less than the specified size or may return an error. Learn how to use these functions correctly by not ignoring the return value and handling errors and partial reads and writes.</p>\n"}], "owner": {"reputation": 1, "user_id": 6321380, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZRxtGsq3T-4/AAAAAAAAAAI/AAAAAAAAAGg/wIfQNKIkd3o/photo.jpg?sz=128", "display_name": "Tragend", "link": "https://stackoverflow.com/users/6321380/tragend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547638598, "creation_date": 1547621024, "last_edit_date": 1547628553, "question_id": 54211683, "link": "https://stackoverflow.com/questions/54211683/how-do-i-use-both-writefds-and-readfds-for-multiple-client-server-communication", "title": "How do I use both writefds and readfds for multiple client server communication program in C language?", "body": "<p>I am currently trying to create a multiple client-server which enables server to perform both read and write functions in C language. I am able to read the data from the client using readfds and putting it as parameter in SELECT. When I added in writefds, the client fails to connect to the server. I am not sure what is the issue behind it, whether this is the correct method to transmit and receive data</p>\n\n<p>This is the code for my server</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;   //strlen\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;   //close\n#include &lt;arpa/inet.h&gt;    //close\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;sys/time.h&gt; //FD_SET, FD_ISSET, FD_ZERO macros\n\n#define TRUE   1\n#define FALSE  0\n#define PORT 8080\n\nint main(int argc , char *argv[])\n{\n    int opt = TRUE;\n    int master_socket , addrlen , new_socket , client_socket[30] ,\n        max_clients = 2 , activity, i , valread , sd;\n    int max_sd;\n    struct sockaddr_in address;\n\n    char buffer[1025];  //data buffer of 1K\n\n    fd_set readfds;\n    fd_set writefds;\n\n\n    char *message = \"Welcome to Server\\r\\n\";\n\n    //initialise all client_socket[] to 0 so not checked\n    for (i = 0; i &lt; max_clients; i++)\n    {\n        //client_socket[i] = 0;\n    }\n\n    //create a master socket\n    if( (master_socket = socket(AF_INET , SOCK_STREAM , 0)) == 0)\n    {\n        perror(\"socket failed\");\n        exit(EXIT_FAILURE);\n    }\n\n    if( setsockopt(master_socket, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;opt,\n          sizeof(opt)) &lt; 0 )\n    {\n        perror(\"setsockopt\");\n        exit(EXIT_FAILURE);\n    }\n\n    //type of socket created\n    address.sin_family = AF_INET;\n    address.sin_addr.s_addr = INADDR_ANY;\n    address.sin_port = htons( PORT );\n\n    //bind the socket to localhost port 8888\n    if (bind(master_socket, (struct sockaddr *)&amp;address, sizeof(address))&lt;0)\n    {\n        perror(\"bind failed\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"Listener on port %d \\n\", PORT);\n\n    if (listen(master_socket, 3) &lt; 0)\n    {\n        perror(\"listen\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    addrlen = sizeof(address);\n    puts(\"Waiting for connections ...\");\n\n    for(;;)\n    {\n\n        //clear the socket set\n        FD_ZERO(&amp;readfds);\n        FD_ZERO(&amp;writefds);\n\n        //add master socket to set\n        FD_SET(master_socket, &amp;readfds);\n        FD_SET(master_socket, &amp;writefds);\n\n\n        max_sd = master_socket;\n\n        //add child sockets to set\n        for ( i = 0 ; i &lt; max_clients ; i++)\n        {\n            //socket descriptor\n            sd = client_socket[i];\n\n            //if valid socket descriptor then add to read list\n            if(sd &gt; 0)\n                FD_SET( sd , &amp;readfds);\n\n            //highest file descriptor number, need it for the select function\n            if(sd &gt; max_sd)\n                max_sd = sd;\n        }\n\n        //wait for an activity on one of the sockets , timeout is NULL ,\n        //so wait indefinitely\n        activity = select( max_sd + 1 , &amp;readfds , &amp;writefds, NULL , NULL);\n\n        if ((activity &lt; 0) &amp;&amp; (errno!=EINTR))\n        {\n            printf(\"select error\");\n        }\n\n\n        if (FD_ISSET(master_socket, &amp;readfds))\n        {\n            if ((new_socket = accept(master_socket,\n                (struct sockaddr *)&amp;address, (socklen_t*)&amp;addrlen))&lt;0)\n            {\n                perror(\"accept\");\n                exit(EXIT_FAILURE);\n            }\n\n            else {\n\n                printf(\"Connected to socket \\n\");\n\n            }\n            bzero(buffer, 1025);\n\n            int n=0;\n\n            read(new_socket, buffer,       sizeof(buffer));\n\n            printf(\"From client: %s\\t To client: \", buffer);\n\n            bzero(buffer, 1025);\n\n            //add new socket to array of sockets\n            for (i = 0; i &lt; max_clients; i++)\n            {\n                //if position is empty\n                if( client_socket[i] == 0 )\n                {\n                    client_socket[i] = new_socket;\n                    printf(\"Adding to list of sockets as %d\\n\" , i+1);\n                }\n            }\n        }\n\n        else if(FD_ISSET(master_socket, &amp;readfds)) {\n\n            printf(\"From client: %s\\t To client : \", buffer);\n            bzero(buffer, 1025);\n\n            // copy server message in the buffer\n            while ((buffer[n++] = getchar()) != '\\n')\n                                        ;\n\n            write(new_socket, buffer, sizeof(buffer));\n\n        }\n\n\n        else{\n            //else its some IO operation on some other socket\n            for (i = 0; i &lt; max_clients; i++)\n            {\n                sd = client_socket[i];\n\n                if (FD_ISSET( sd , &amp;readfds))\n                {\n                    //Check if it was for closing , and also read the\n                    //incoming message\n                    if ((valread = read( sd , buffer, 1024)) == 0)\n                    {\n\n                        close( sd );\n                        client_socket[i] = 0;\n                    }\n\n                    //Echo back the message that came in\n                    else\n                    {\n\n\n                    }\n                }\n            }\n        }//else\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This is the code for the client</p>\n\n<pre><code>#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n\n#define MAX 1000\n#define PORT 8080\n#define SA struct sockaddr\n\nvoid func(int sockfd)\n{\n    char buff[MAX];\n    int n;\n    int firstConnect = 1;\n\n    for (;;)\n    {\n\n        bzero(buff, sizeof(buff));\n        n = 0;\n\n        if(firstConnect==1) {\n            printf(\"Enter the string : \");\n            firstConnect = 0;\n\n            while ((buff[n++] = getchar()) != '\\n')\n                ;\n            write(sockfd, buff, sizeof(buff));\n\n        }\n\n\n        bzero(buff, sizeof(buff));\n\n        read(sockfd, buff, sizeof(buff));\n\n        printf(\"From Server: %s\\t To Server : \", buff);\n\n\n        while ((buff[n++] = getchar()) != '\\n');\n        write(sockfd, buff, sizeof(buff));\n\n        if ((strncmp(buff, \"exit\", 4)) == 0)\n        {\n            printf(\"Client Exit...\\n\");\n            break;\n        }\n    }\n}\n\n\nint main()\n{\n\n    printf(\"CLIENT\");\n    int sockfd, connfd;\n    struct sockaddr_in servaddr, cli;\n\n    // socket create and varification\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sockfd == -1)\n    {\n        printf(\"socket creation failed...\\n\");\n        exit(0);\n    }\n    else\n        printf(\"Socket successfully created..\\n\");\n\n    bzero(&amp;servaddr, sizeof(servaddr));\n\n    // assign IP, PORT\n    servaddr.sin_family = AF_INET;\n\n    // servaddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    servaddr.sin_addr.s_addr = inet_addr(\"127.8.1.0\");\n\n    servaddr.sin_port = htons(PORT);\n\n    // connect the client socket to server socket\n    if (connect(sockfd, (SA*)&amp;servaddr, sizeof(servaddr)) != 0)\n    {\n        printf(\"connection with the server failed...\\n\");\n        exit(0);\n    }\n    else\n        printf(\"connected to the server..\\n\");\n\n    // function for chat\n    func(sockfd);\n\n    // close the socket\n    close(sockfd);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls", "glibc"], "comments": [{"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1547621153, "post_id": 54211637, "comment_id": 95249275, "body": "The <code>ptid</code> parameter which is of type <code>pid_t</code> already contains the ID of the child thread."}, {"owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1547621553, "post_id": 54211637, "comment_id": 95249420, "body": "@P.W Yes, but since it also returns the thread ID of the child process, why shouldn&#39;t it be <code>pid_t</code> instead of <code>int</code>?"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1547622265, "post_id": 54211637, "comment_id": 95249683, "body": "The type of <code>pid_t</code> is implementation defined. It does not have to be signed. If it is unsigned it cannot return -1."}, {"owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1547622405, "post_id": 54211637, "comment_id": 95249730, "body": "@P.W If <code>pid_t</code> is unsigned, <code>fork()</code> and <code>vfork()</code> will be broken because they both return <code>-1</code> on  failure and use <code>pid_t</code> as return type."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1547623461, "post_id": 54211637, "comment_id": 95250181, "body": "Does the return value of clone always match what is stored in ptid?"}, {"owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1547624068, "post_id": 54211637, "comment_id": 95250431, "body": "@P.W For that to work, <code>CLONE_PARENT_SETTID</code> must be or-ed into the <code>flag</code>. So no, it does not always match."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1547663249, "post_id": 54211637, "comment_id": 95272239, "body": "@P.W Linux requires a signed <code>pid_t</code>; <a href=\"https://stackoverflow.com/a/1931823/2410359\">ref</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547663502, "post_id": 54211637, "comment_id": 95272347, "body": "Hmmm given &quot;*nix&quot; requirement of &quot;The implementation shall support one or more programming environments in which the widths of blksize_t, pid_t, size_t, ssize_t, suseconds_t, and useconds_t are no greater than the width of type long.&quot;, I&#39;d expect  <code>clone()</code> to return <code>pid_t</code> or <code>long</code>.  &quot;Why clone does not return pid_t, instead returns int?&quot; --&gt; appears to be a not completely thought out design. I do not see an <code>int</code> advantage/rational."}, {"owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547781049, "post_id": 54211637, "comment_id": 95318796, "body": "@chux I agree with you on that. On the <code>Note</code> of the manpage of <code>clone</code>, it is shown that the underlying syscall <code>clone</code> returns <code>long</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547781161, "post_id": 54211637, "comment_id": 95318823, "body": "@JiaHaoXu Perhaps it is worth submitting to GNU/Linux a request for change?"}, {"owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547782409, "post_id": 54211637, "comment_id": 95319059, "body": "@chux It is. But how to? I haven&#39;t done anything like that before."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547784196, "post_id": 54211637, "comment_id": 95319446, "body": "@JiaHaoXu I do not know either."}, {"owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547787507, "post_id": 54211637, "comment_id": 95320141, "body": "@chux Maybe <a href=\"https://sourceware.org/glibc/wiki/FilingBugs\" rel=\"nofollow noreferrer\">FilingBug - glibc wiki</a>"}], "owner": {"reputation": 1526, "user_id": 8375400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b4137a39b4c1a7f0f08d017a10b785d?s=128&d=identicon&r=PG&f=1", "display_name": "JiaHao Xu", "link": "https://stackoverflow.com/users/8375400/jiahao-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1547620689, "creation_date": 1547620689, "question_id": 54211637, "link": "https://stackoverflow.com/questions/54211637/why-clone-returns-int-not-pid-t", "title": "Why clone returns int, not pid_t?", "body": "<p>From <a href=\"http://man7.org/linux/man-pages/man2/clone.2.html\" rel=\"nofollow noreferrer\">man 2 clone</a>:</p>\n\n<blockquote>\n  <p>SYNOPSIS    </p>\n\n<pre><code>   /* Prototype for the glibc wrapper function */\n\n   #define _GNU_SOURCE\n   #include &lt;sched.h&gt;\n\n\n   int clone(int (*fn)(void *), void *child_stack,\n             int flags, void *arg, ...\n             /* pid_t *ptid, void *newtls, pid_t *ctid */ );\n</code></pre>\n  \n  <p>RETURN VALUE<br>\n         On success, the thread ID of the child process is returned in the\n         caller's thread of execution.  On failure, -1 is returned in the\n         caller's context, no child process will be created, and errno will be\n         set appropriately.</p>\n</blockquote>\n\n<p>Since using <code>pid_t</code> as the return type </p>\n\n<ol>\n<li>improve the readability</li>\n<li>improve the maintainability</li>\n<li>is also capable of returning <code>-1</code> when an error occurs</li>\n</ol>\n\n<p>Why <code>clone</code> does not return <code>pid_t</code>, instead returns <code>int</code>?</p>\n"}, {"tags": ["c++", "c", "malloc", "dynamic-memory-allocation", "allocator"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1547618343, "post_id": 54211148, "comment_id": 95248319, "body": "the only solution is to allocate a <i>single</i> block with <code>malloc</code> or <code>new</code> and manage it manually. Or use a pre-allocated <code>vector</code>."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1547618365, "post_id": 54211148, "comment_id": 95248323, "body": "Write your own allocator?"}, {"owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1547618449, "post_id": 54211148, "comment_id": 95248346, "body": "seems that you have to manage all information related to objects (size, location...)"}, {"owner": {"reputation": 165, "user_id": 9856528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032264c7831034f27927f8c5eedc84f1?s=128&d=identicon&r=PG&f=1", "display_name": "Saswat Mishra", "link": "https://stackoverflow.com/users/9856528/saswat-mishra"}, "reply_to_user": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1547619104, "post_id": 54211148, "comment_id": 95248560, "body": "@duong_dajgja yeah, the class tracks the amount of bytes already used up, and the max byte capacity. What I am unsure of how to do is track location. The allocation method returns a tuple of a pointer to the beginning of the contiguous memory block (in case it changed from the previous allocation because of buffer overflow), and a pointer to the start of the new location. When new memory is added to it, however, I want to be able to take the beginning pointer and increment by size to get where each object ends and another one starts, which is why I want to know how i can test for continuity"}, {"owner": {"reputation": 165, "user_id": 9856528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032264c7831034f27927f8c5eedc84f1?s=128&d=identicon&r=PG&f=1", "display_name": "Saswat Mishra", "link": "https://stackoverflow.com/users/9856528/saswat-mishra"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1547619486, "post_id": 54211148, "comment_id": 95248677, "body": "@Jean-Fran&#231;oisFabre Yes, the method allocates a buffer from a single malloc until the buffer overflows (N+1 bytes requested from a buffer of size N). In the case of overflow, the class moves the data onto a new buffer with enough size. I want to be able to retrieve the position of each object from just the size of each object and the starting position, which should be straightforward - just add the cumulative preceding sizes to the start. However, not sure if this works for fragmented memory, so is there a way I can check for fragmentation, or is that not a problem with a single malloc buffer?"}, {"owner": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1547619518, "post_id": 54211148, "comment_id": 95248686, "body": "@SaswatMishra You should have a map that maps some object ID to some offset in the pool? Based on the map you could check if objects are located contiguously right?"}, {"owner": {"reputation": 165, "user_id": 9856528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032264c7831034f27927f8c5eedc84f1?s=128&d=identicon&r=PG&f=1", "display_name": "Saswat Mishra", "link": "https://stackoverflow.com/users/9856528/saswat-mishra"}, "reply_to_user": {"reputation": 3868, "user_id": 2589553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/490f0b6836112dc8929c72ed3f03bf68?s=128&d=identicon&r=PG", "display_name": "duong_dajgja", "link": "https://stackoverflow.com/users/2589553/duong-dajgja"}, "edited": false, "score": 0, "creation_date": 1547619705, "post_id": 54211148, "comment_id": 95248750, "body": "@duong_dajgja That is close to what I have, and that works fine until the buffer-shift that I mentioned, when all the addresses shift. The method returns the new beginning position, and I should be able to derive the new positions by going (begin + sizeof(previous_objects) ), but I am unsure of if this technique works for memory that is fragmented, which can occur when allocating large blocks of memory."}, {"owner": {"reputation": 165, "user_id": 9856528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032264c7831034f27927f8c5eedc84f1?s=128&d=identicon&r=PG&f=1", "display_name": "Saswat Mishra", "link": "https://stackoverflow.com/users/9856528/saswat-mishra"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1547619761, "post_id": 54211148, "comment_id": 95248772, "body": "@P.W yes, this tool is to help ensure that memory assigned for a different class i am using is properly aligned as well as contiguous. Essentially an allocator."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1547625584, "post_id": 54211148, "comment_id": 95250979, "body": "Methinks this is too broad for the site, but note that a typical Java Virtual Machine does all this stuff rather well. (I&#39;m also not convinced you can do this in portable C or C++). Why not study one that&#39;s written in C or C++?"}, {"owner": {"reputation": 182, "user_id": 9662186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4618e6a8b7712aabdd70f33b1bfece0?s=128&d=identicon&r=PG&f=1", "display_name": "wooooooooosh", "link": "https://stackoverflow.com/users/9662186/wooooooooosh"}, "edited": false, "score": 0, "creation_date": 1547627555, "post_id": 54211148, "comment_id": 95251806, "body": "What do you mean by fragmented memory? Malloc always return continuous block of memory. Do you mean the memory is fragmented after some use or the memory malloc returned is fragmented?"}], "answers": [{"tags": [], "owner": {"reputation": 914, "user_id": 661526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1104b30026c34d94580715a79fed46?s=128&d=identicon&r=PG", "display_name": "csd", "link": "https://stackoverflow.com/users/661526/csd"}, "is_accepted": false, "score": 0, "last_activity_date": 1547668140, "creation_date": 1547668140, "answer_id": 54224305, "question_id": 54211148, "link": "https://stackoverflow.com/questions/54211148/malloc-memory-check-if-contiguous/54224305#54224305", "title": "Malloc memory check if contiguous", "body": "<p>If I understand your question, you're asking if you can have multiple calls to malloc return contiguous memory. </p>\n\n<p>The answer is no, memory will not be contiguous across multiple mallocs as most memory managers will put head/tail data around the allocated memory for both their own management and to put protection markers around the edges to detect overruns - the details are heavily implementation dependent.</p>\n\n<p>for your own memory management you need to allocate a big enough block with malloc and then split it and manage the internals yourself.</p>\n\n<p>You can look at this github proj as an example of the management required:\n<a href=\"https://github.com/bcorriveau/memblock\" rel=\"nofollow noreferrer\">https://github.com/bcorriveau/memblock</a></p>\n"}], "owner": {"reputation": 165, "user_id": 9856528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032264c7831034f27927f8c5eedc84f1?s=128&d=identicon&r=PG&f=1", "display_name": "Saswat Mishra", "link": "https://stackoverflow.com/users/9856528/saswat-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1547668140, "creation_date": 1547618125, "question_id": 54211148, "link": "https://stackoverflow.com/questions/54211148/malloc-memory-check-if-contiguous", "title": "Malloc memory check if contiguous", "body": "<p>I am implementing a memory pool - type class. One of the methods allocates B bytes of memory and returns a void pointer to it, while internally handling buffers and moving around older memory to ensure all memory managed by the object during its lifetime is contiguous (similar to how a std::vector will have a pre allocated buffer and allocate extra space once the buffer runs out, copying the information from the old buffer to the new one to ensure all memory is contiguous). My question is, how do I ensure, or check for, all the allocated memory being continuous? If I wish to jump from object to object manually, using </p>\n\n<pre><code>static_cast&lt;desired_type*&gt;(buffer_pointer + N)\n</code></pre>\n\n<p>This method is naturally going to fail if the location for an object is offset by some amount that isn't just the sum of the sizes of the previous objects. I am new to writing custom memory pools, so I am just wondering, how do I either ensure allocated memory is non fragmented, or access the location of the new fragment so that I can still manually index through a block of malloc()-ed memory? Thank you.</p>\n"}, {"tags": ["c", "assembly", "x86", "calling-convention", "gcc8"], "comments": [{"owner": {"reputation": 299, "user_id": 668574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c191b86fe6acfce96c2213fd80e51bcc?s=128&d=identicon&r=PG", "display_name": "araruna", "link": "https://stackoverflow.com/users/668574/araruna"}, "edited": false, "score": 1, "creation_date": 1547616568, "post_id": 54210828, "comment_id": 95247796, "body": "Now that I think of it, I believe the <code>char</code>s placement is indeed because of word alignment. Is it?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1547616595, "post_id": 54210828, "comment_id": 95247803, "body": "Why not build with optimizations on?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1547616820, "post_id": 54210828, "comment_id": 95247866, "body": "<code>Looking ate the assembly column</code>...dangerous, don&#39;t look, run away!! :P"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1547617671, "post_id": 54210828, "comment_id": 95248122, "body": "Interesting. Even if you enable optimization and change the args to <code>volatile char a</code> and so on (<a href=\"https://godbolt.org/z/ul--bv\" rel=\"nofollow noreferrer\">godbolt.org/z/ul--bv</a>), they&#39;re still copied to separate locations on the stack instead of using the arg-passing slot as their permanent location.  And they&#39;re still kept in different dwords.  Also, only the <code>char</code> args are copied, unless you <code>b++</code> the int. This looks like a gcc missed optimization. The title question is a simple duplicate that&#39;s been asked many times (<b>the i386 System V ABI requires 16-byte stack alignment before a <code>call</code></b>), but the <code>char</code> packing is slightly interesting."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1547617673, "post_id": 54210828, "comment_id": 95248123, "body": "What makes you assume the compiler will not waste space and time, if you don&#39;t allow it to optimize? (<code>-O0</code>). Actually even if you would allow it to optimize, what makes you assume the compiler will have enough time to compute the perfect solution? (and let&#39;s ignore there may be not even single &quot;perfect&quot; solution for any medium+ size source code) The amount of time the compiler has is very small (seconds/minutes), so it does only scratch the total amount of possible outcomes, and thankfully to compiler design even that tiny scratch will often perform excellently well, but &quot;wasting&quot; a bit..."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1547617876, "post_id": 54210828, "comment_id": 95248187, "body": "about char align ... depends if you optimize for size or for speed, alignment helps with speed at the cost of space. So that one is not &quot;wasted&quot;, that&#39;s intended, as it makes most of the SW under common circumstances &quot;better&quot;."}, {"owner": {"reputation": 299, "user_id": 668574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c191b86fe6acfce96c2213fd80e51bcc?s=128&d=identicon&r=PG", "display_name": "araruna", "link": "https://stackoverflow.com/users/668574/araruna"}, "edited": false, "score": 1, "creation_date": 1547618267, "post_id": 54210828, "comment_id": 95248297, "body": "Just to clarify. I am studying C calling convention. It wouldn&#39;t make sense to allow the compiler to optimize the code, as I wouldn&#39;t see the function call. But the question arose because I cound&#39;t understand the reasons why those decisions were made. After some of the bitter and unforgiving comments, I&#39;m now enlightened. Thank you."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1547631319, "post_id": 54210828, "comment_id": 95253769, "body": "Please put the code into your question.  Stack Overflow wants all your questions to be self contained in case external sites go down."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1547632566, "post_id": 54210828, "comment_id": 95254573, "body": "I think you get the answer <a href=\"https://stackoverflow.com/questions/45697594/what-is-the-calling-convention-for-the-main-function-in-c\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1547633150, "post_id": 54211310, "comment_id": 95254942, "body": "Putting bytes in separate words looks like a missed optimization to me.  GCC doesn&#39;t do that for locals, only for args, so probably it&#39;s just some left-over gcc internal attribute from them originally being passed as bytes padded to dwords on the stack.  It only copies them into the function&#39;s own stack frame in the first place because of <code>-O0</code>, or if you use <code>volatile</code>.  Anyway, Byte loads+stores within the same dword or not makes no performance difference when they&#39;re both in the same cache line, AFAIK on Intel or AMD CPUs.  See <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1547633361, "post_id": 54211310, "comment_id": 95255070, "body": "See also <a href=\"https://stackoverflow.com/q/46721075\">Can modern x86 hardware not store a single byte to memory?</a> (actually x86 can, so can everything else).  Also other links in <a href=\"https://stackoverflow.com/tags/x86/info\">stackoverflow.com/tags/x86/info</a>"}], "tags": [], "owner": {"reputation": 299, "user_id": 668574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c191b86fe6acfce96c2213fd80e51bcc?s=128&d=identicon&r=PG", "display_name": "araruna", "link": "https://stackoverflow.com/users/668574/araruna"}, "is_accepted": false, "score": 2, "last_activity_date": 1547619001, "creation_date": 1547619001, "answer_id": 54211310, "question_id": 54210828, "link": "https://stackoverflow.com/questions/54210828/why-stack-grows-by-16-bytes-in-this-disassembly-when-i-only-have-one-4-byte-loc/54211310#54211310", "title": "Why stack grows by 16 bytes in this disassembly, when I only have one 4 byte local variable?", "body": "<p>So, by the comments, I could figure out that the stack growth issue is due to the i386 SystemV ABI requirements, as stated by @PeterCordes.</p>\n\n<p>The reason why the chars are word aligned may be due to GCC's default behavior to improve speed, as maybe inferenced from @Ped7g's comment. Although not definite, this is a good enough answer for me.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1548081381, "post_id": 54286106, "comment_id": 95404862, "body": "Intel since Pentium-M and AMD since Bulldozer have a &quot;stack engine&quot; that tracks the updates to ESP/RSP, avoiding a data-dependency chain through the stack pointer from multiple push/pop instructions.  (And letting them be single-uop instructions, unlike on earlier P6-family CPUs).  This is why gcc used to use <code>mov</code> stores/loads for saving/restoring registers, and for writing function args to the stack (if there are any), but these days when tuning for modern CPUs it once again uses push/pop.  <a href=\"https://stackoverflow.com/q/36631576\">What is the stack engine in the Sandybridge microarchitecture?</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1548081640, "post_id": 54286106, "comment_id": 95405027, "body": "Maintaining stack alignment before a <code>call</code> lets functions allocate aligned storage (e.g. for SSE vectors) cheaply.  Compilers typically choose to always aim for 16-byte stack alignment when allocating more stack.  But it&#39;s actually a missed-optimization that they don&#39;t use <code>push</code> for <i>initialized</i> locals that they were going to spill right away.  See my answer on <a href=\"https://stackoverflow.com/q/49485395\">What C/C++ compiler can use push pop instructions for creating local variables, instead of just increasing esp once?</a> for an example.  But unwind info needs metadata for each ESP/RSP change."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1548060117, "creation_date": 1548060117, "answer_id": 54286106, "question_id": 54210828, "link": "https://stackoverflow.com/questions/54210828/why-stack-grows-by-16-bytes-in-this-disassembly-when-i-only-have-one-4-byte-loc/54286106#54286106", "title": "Why stack grows by 16 bytes in this disassembly, when I only have one 4 byte local variable?", "body": "<p>It's common today to acquire stack space in multiples of this size, for several reasons:</p>\n\n<ul>\n<li>cache lines favor this behaviour by maintaining the whole data in the cache.</li>\n<li>space for temporaries is preallocated, avoiding push and pop instructions to be used in case some temporary storage is needed out of the cpu.</li>\n<li>individual push and pop instructions degrade pipeline execution, by requiring data to be updated before next instruction is executed.  This decouples the data dependencies between consecutive instructions and allow them to run faster.</li>\n</ul>\n\n<p>For this reasons, actual compilers specify ABIs to be designed in this way.</p>\n"}], "owner": {"reputation": 299, "user_id": 668574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c191b86fe6acfce96c2213fd80e51bcc?s=128&d=identicon&r=PG", "display_name": "araruna", "link": "https://stackoverflow.com/users/668574/araruna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1548060117, "creation_date": 1547615925, "last_edit_date": 1547663174, "question_id": 54210828, "link": "https://stackoverflow.com/questions/54210828/why-stack-grows-by-16-bytes-in-this-disassembly-when-i-only-have-one-4-byte-loc", "title": "Why stack grows by 16 bytes in this disassembly, when I only have one 4 byte local variable?", "body": "<p>I'm having trouble understanding why the compiler chose to offset the stack space in the way it did with the code I wrote.</p>\n\n<p>I was toying with Godbolt's Compiler Explorer in order to study the C calling convention, when I came up with a simple code that puzzled me by its choices.</p>\n\n<p>The code is found in <a href=\"https://godbolt.org/z/henODt\" rel=\"nofollow noreferrer\">this link</a>. I selected GCC 8.2 x86-64, but am targetting x86 processors and this is important. Bellow is the transcription of the C code and the generated assembly reported by the Compiler Explorer.</p>\n\n<pre><code>// C code\nint testing(char a, int b, char c) {\n    return 42;\n}\n\nint main() {\n    int x = testing('0', 0, '7');\n\n    return 0;\n}\n</code></pre>\n\n<pre><code>; Generated assembly\ntesting(char, int, char):\n        push    ebp\n        mov     ebp, esp\n        sub     esp, 8\n        mov     edx, DWORD PTR [ebp+8]\n        mov     eax, DWORD PTR [ebp+16]\n        mov     BYTE PTR [ebp-4], dl\n        mov     BYTE PTR [ebp-8], al\n        mov     eax, 42\n        leave\n        ret\nmain:\n        push    ebp\n        mov     ebp, esp\n        sub     esp, 16\n        push    55\n        push    0\n        push    48\n        call    testing(char, int, char)\n        add     esp, 12\n        mov     DWORD PTR [ebp-4], eax\n        mov     eax, 0\n        leave\n        ret\n</code></pre>\n\n<p>Looking at the assembly column from now on, as I understood, line 15 is responsible for reserving space in the stack for the local variables. The problem is that I have only one local <code>int</code> and the offset was by 16 bytes instead of 4. This feels like wasted space.</p>\n\n<p>Is this somewhat related to word alignment? But even if it is, if the sizes of the general purpose registers are 4 bytes, shouldn't this alignment be with regards to 4 bytes?</p>\n\n<p>One other strange thing I see is with respect to the placement of the local <code>char</code>s of the <code>testing</code> function. They seem to be taking 4 bytes each in the stack, as seen in lines 7-8, but only the lower bytes are manipulated. Why not use only 1 byte each?</p>\n\n<p>These choices are probably well intended, and I would really like to understand their purpose (or whether there is no purpose). Or maybe I'm just confused and didn't quite get it.</p>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 2658, "user_id": 3264295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtN8l.png?s=128&g=1", "display_name": "mukunda", "link": "https://stackoverflow.com/users/3264295/mukunda"}, "edited": false, "score": 0, "creation_date": 1547615930, "post_id": 54210803, "comment_id": 95247646, "body": "See here, <a href=\"https://stackoverflow.com/questions/15229411/input-validation-of-an-integer-using-atoi\" title=\"input validation of an integer using atoi\">stackoverflow.com/questions/15229411/&hellip;</a>"}, {"owner": {"reputation": 2292, "user_id": 4502035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38a1b21c3e83f9d10aaa56c93f6150a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/4502035/andreas"}, "edited": false, "score": 0, "creation_date": 1547617373, "post_id": 54210803, "comment_id": 95248002, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15229411/input-validation-of-an-integer-using-atoi\">Input validation of an Integer using atoi()</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1547617645, "post_id": 54210803, "comment_id": 95248110, "body": "Carefully review <a href=\"http://man7.org/linux/man-pages/man3/strtod.3.html\" rel=\"nofollow noreferrer\">strtod(3) - Linux manual page</a> <i>noting</i> the <i>&quot;RETURN VALUE&quot;</i> section and then craft your <b>validations</b> to check for each, e.g. <code>nptr != endptr</code>, that <code>errno</code> is zero and in particular whether <code>(*endptr &amp;&amp; *endptr != &#39;\\n&#39;)</code> -- the final telling you that non-digit characters remain after the conversion was completed."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1547646544, "post_id": 54210803, "comment_id": 95262512, "body": "First, we need to know what you mean by \u201cnumeric(float)\u201d. If we follow the C definition of floating-point constants, we might accept \u201cdigits optional-period digits optional-exponent\u201d, where one of the two \u201cdigits\u201d must be non-empty, and the optional exponent is \u201ce optional-sign non-empty-digits\u201d or \u201cE\u201d instead of \u201ce\u201d. We might also accept a hyphen as a minus sign before the number (C does not, in source code, for technical reasons involving the syntax and grammar, but maybe you want to. Or not; we do not know; you need to say.) Maybe you also want to accept hexadecimal floating-point numbers."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1547646772, "post_id": 54210803, "comment_id": 95262668, "body": "There is also a question of what to do if the input is syntactically a valid number but is mathematically too large (or small) to represent. Do you want to reject that in this code, or perhaps accept it but take its value as infinity or report an error (of size rather than syntax) to the user?"}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547699085, "post_id": 54210803, "comment_id": 95283296, "body": "Numeric(float) means that input may be float but it should be valid for example  3.45638 is valid and 3.4S638 is not (becuase it contains a charecter in it &quot;S&quot;) so i want to display this as a erro message"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1547699616, "post_id": 54210803, "comment_id": 95283419, "body": "(a) Can the number have a <code>-</code> before it; is <code>-3</code> a valid input? (b) Is <code>3.</code> a valid input? (c) Is <code>.3</code> a valid input? (d) Can the number have an exponent; is <code>3e4</code> a valid input? (e) Can the exponent use a capital E instead of lowercase; is <code>3E4</code> a valid input? (f) Can the number have an <code>f</code> of <code>F</code> suffix as in C source code; is <code>3f</code> a valid input? (g) Can the number have an <code>l</code> or <code>L</code> suffix as in C source code; is <code>3.L</code> a valid input? (h) Can the number use hexadecimal floating-point format; is <code>0x3.4a5p-7</code> a valid input? (i) Are any other forms acceptable?"}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547707387, "post_id": 54210803, "comment_id": 95285604, "body": "thank you for your time sir a) Yes,` -3` is valid. b)No, <code>3.</code> is not valid c)Yes,  <code>.3</code> is valid and should apend a <code>0</code> before it d)No, number cannot be exponential e)No f)I am unable to get these points g) this is also I am not getting h) No its only decimal i)As for now only these point I am considering"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576972684, "post_id": 54210803, "comment_id": 105065195, "body": "sachin mirajkar, Need anything else for an acceptable answer?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547618588, "post_id": 54210906, "comment_id": 95248388, "body": "but my consern is to detect that extra charecter and hold it invalid for the program"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547619289, "post_id": 54210906, "comment_id": 95248613, "body": "@sachinmirajkar yes, you need to check the content of <code>*endptr</code> - in case of success, it should point to the terminating null, as there would be nothing left in the input to be converted. In case the conversion failed midway - it will not be pointing to a null character."}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547620003, "post_id": 54210906, "comment_id": 95248862, "body": "@saurav Ghosh It would be helpful if you can demostrate with a small example or any reference to find example thank you"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547620049, "post_id": 54210906, "comment_id": 95248878, "body": "Disagree with <a href=\"https://stackoverflow.com/questions/54210803/how-to-check-if-input-is-numericfloat-or-it-is-some-character/54211144#comment95248613_54210906\">comment</a> &quot;In case the conversion failed midway - it will not be pointing to a null character &quot; has an exception: <code>strtof(&quot;&quot;, &amp;endptr)</code>. Best to test the <code>endptr</code> against <code>nptr</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547620436, "post_id": 54210906, "comment_id": 95249021, "body": "@chux Just updated the answer to clarify, hope this should be okay now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547620690, "post_id": 54210906, "comment_id": 95249093, "body": "Better, yet &quot;The return value is not <code>HUGE_VAL</code>.&quot; is amiss.  That concern does not apply when <code>errno</code> remains 0.  Also <code>errno == ERANGE</code> means the conversion worked in that input is numeric, just out of range.  Up to OP if that is &quot;valid&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547620794, "post_id": 54210906, "comment_id": 95249137, "body": "Also note <code>errno == ERANGE</code> and <code>fabs(result) &lt;= DBL_MIN</code> can occur.  <code>strtod()</code> is a mess in the small corners."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1547620356, "last_edit_date": 1592644375, "creation_date": 1547616400, "answer_id": 54210906, "question_id": 54210803, "link": "https://stackoverflow.com/questions/54210803/how-to-check-if-input-is-numericfloat-or-it-is-some-character/54210906#54210906", "title": "How to check if input is numeric(float) or it is some character?", "body": "<p>You need to take the input as a <em>string</em> and then, make use of <a href=\"https://linux.die.net/man/3/strtod\" rel=\"nofollow noreferrer\"><code>strtod()</code></a> to parse the input.</p>\n<p>Regarding the return values, from the <a href=\"https://linux.die.net/man/3/strtod\" rel=\"nofollow noreferrer\">man page</a>:</p>\n<blockquote>\n<pre><code>double strtod(const char *nptr, char **endptr);\n</code></pre>\n<p>These functions return the converted value, if any.</p>\n<p>If <code>endptr</code> is not NULL, a pointer to the character after the last character used in the conversion is stored in the location referenced by <code>endptr</code>.</p>\n<p>If no conversion is performed, zero is returned and the value of <code>nptr</code> is stored in the location referenced by <code>endptr</code>.</p>\n</blockquote>\n<p>Getting to the point of detection of errors, couple of points:</p>\n<ul>\n<li>Ensure the <code>errno</code> is set to <code>0</code> before the call and it still is <code>0</code> after the call.</li>\n<li>The return value is not <code>HUGE_VAL</code>.</li>\n<li>The content pointed to by <code>*endptr</code> is not null and not equal to <code>nptr</code> (i.e., no conversation has been preformed).</li>\n</ul>\n<p>The above checks, combined together will ensure a successful conversion.</p>\n<p>In your case, the last point is essential, as if there is an invalid character present in the input, the <code>*endptr</code> would not be pointing to a null, instead it would hold the address of that (first) invalid character in the input.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1547621289, "last_edit_date": 1547621289, "creation_date": 1547618095, "answer_id": 54211144, "question_id": 54210803, "link": "https://stackoverflow.com/questions/54210803/how-to-check-if-input-is-numericfloat-or-it-is-some-character/54211144#54211144", "title": "How to check if input is numeric(float) or it is some character?", "body": "<blockquote>\n  <p>to check input is numeric(float)</p>\n</blockquote>\n\n<p>1) Take input as a string <code>char buf[Big_Enough]</code>. I'd expect 160 digits will handle all but the most arcane \"float\" strings<sup>1</sup>.</p>\n\n<pre><code>#define N 160\nchar buf[N];\nif (fgets, buf, sizeof buf, stdin) {\n</code></pre>\n\n<p>2) Apply <code>float strtof()</code> for <code>float</code>, (<code>strtod()</code> for <code>double</code>, <code>strtold()</code> for <code>long double</code>). </p>\n\n<pre><code>  char *endptr;  \n  errno = 0;\n  float d = strtof(buf, &amp;endptr);\n  // endptr now points to the end of the conversion, if any.\n</code></pre>\n\n<p>3) Check results.</p>\n\n<pre><code>    if (buf == endptr) return \"No_Conversion\";\n    // Recommend to tolerate trailing white-space.\n    //   as leading white-spaces are already allowed by `strtof()`\n    while (isspace((unsigned char)*endptr) {\n      endptr++;\n    }\n    if (*endptr) return \"TrailingJunkFound\";\n    return \"Success\";\n</code></pre>\n\n<p>4) Tests for extremes, if desired.</p>\n\n<p>At this point, the input is numeric.  The question remains if the \"finite string\" an be well represented by a finite <code>float</code>: if a the |result| is in range of <code>0</code> or <code>[FLT_TRUE_MIN...FLT_MAX]</code>.</p>\n\n<p>This involves looking at <code>errno</code>.</p>\n\n<p>The conversion \"succeed\" yet finite string values outside the <code>float</code> range become <code>HUGE_VALF</code> which may be infinity or <code>FLT_MAX</code>.</p>\n\n<p>Wee |values| close to 0.0, but not 0.0 become something in the range <code>[0.0 ...  INT_MIN]</code>.</p>\n\n<p>Since the goal is to detect is a conversion succeeded (it did), I'll leave these details for a question that wants to get into the gory bits of what <em>value</em>.</p>\n\n<hr>\n\n<p>An alternative is to use <code>fscanf()</code> to directly read and convert, yet the error handling there has its troubles too and hard to portably control.</p>\n\n<hr>\n\n<p><sup>1</sup> <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">Typical <code>float</code></a> range is +/- 10<sup>38</sup>.  So allowing for 40 or so characters makes sense.  An <em>exact</em> print of <code>FLT_TRUE_MIN</code> can take ~150 characters.  To distinguish a <em>arbitrarily</em> \"float\" string from  <code>FLT_TRUE_MIN</code> from the next larger one needs about that many digits.</p>\n\n<p>If \"float\" strings are not arbitrary, but only come from the output of a printed <code>float</code>, then far few digits are needed - about 40.</p>\n\n<p>Of course it is wise to allow for extra leading/trailing spaces and zeros.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547633143, "post_id": 54214573, "comment_id": 95254934, "body": "i did this any suggession or improvement needed ?\\"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1547646173, "post_id": 54214573, "comment_id": 95262284, "body": "This code has undefined behavior if the input line exceeds 14 characters. (There is almost no proper use of <code>gets</code>; do not use it.) This code assumes ASCII, and unnecessarily so, as one could compare with <code>&#39;0&#39;</code> and <code>&#39;9&#39;</code> or simply use <code>isdigit</code> from <code>&lt;ctype.h&gt;</code>. This code does not recognize numbers with minus signs or exponents."}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1547661866, "post_id": 54214573, "comment_id": 95271544, "body": "as I am a beginner I am not able to understand the above solutions is there any simpler explanation in any article or vedio for reference"}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1547707759, "post_id": 54214573, "comment_id": 95285768, "body": "sir I have checked <code>isdigit</code> function from <code>&lt;ctype.h&gt;</code> but it not suitable for me beacuase it only works for <code>integers</code> not <code>float</code> variables"}], "tags": [], "owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1547632907, "creation_date": 1547632907, "answer_id": 54214573, "question_id": 54210803, "link": "https://stackoverflow.com/questions/54210803/how-to-check-if-input-is-numericfloat-or-it-is-some-character/54214573#54214573", "title": "How to check if input is numeric(float) or it is some character?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid main(){\nchar num1[15];\nfloat number1;\nint dot_check1=0,check=0,i;\nprintf(\"enter the numbers :\\n\");\ngets(num1);\ni=0;\nwhile(num1[i]){\n    if(num1[i]&gt;'/' &amp;&amp; num1[i]&lt;':')\n        ;\n    else { if(dot_check1==0){\n            if(num1[i]=='.')\n                dot_check1=1;\n            else {\n                check=1;\n                break;\n                }\n            }\n            else  {\n                check=1;\n                break;\n                }\n        }\n    i++;\n}\nif(check){\n    printf(\"please check the number you have entered\");\n}\nelse{\n    number1=atof(num1);\n    printf(\"you entered number is %f\",number1);\n}\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547783070, "post_id": 54237191, "comment_id": 95319209, "body": "<code>if (*p == &#39;.&#39;)     {         if (!isdigit(*p))             return 0;         ThereIsAPeriod = 1;         do             ++p;         while (isdigit(*p));     } </code>"}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547783154, "post_id": 54237191, "comment_id": 95319227, "body": "here you are testing for no digit i.e a charecter it could be anything like any chareecter not only <code>.</code> so for that what to do?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547784963, "post_id": 54237191, "comment_id": 95319601, "body": "@sachinmirajkar: There was a <code>++p</code> missing. I have edited it. After a period is recognized, the code tests whether the next character is a digit. If it is not, it reports an error. If it is, it accepts that character and the following digit characters."}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547786543, "post_id": 54237191, "comment_id": 95319946, "body": "can i use this after scanf"}, {"owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "edited": false, "score": 0, "creation_date": 1547786590, "post_id": 54237191, "comment_id": 95319956, "body": "It will be helpful if you demonstrate with an example"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1547784868, "last_edit_date": 1547784868, "creation_date": 1547732385, "answer_id": 54237191, "question_id": 54210803, "link": "https://stackoverflow.com/questions/54210803/how-to-check-if-input-is-numericfloat-or-it-is-some-character/54237191#54237191", "title": "How to check if input is numeric(float) or it is some character?", "body": "<p>Here is untested code to check whether a string meets the requested specification.</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n\n\n/*  IsFloatNumeral returns true (1) if the string pointed to by p contains a\n    valid numeral and false (0) otherwise.  A valid numeral:\n\n        Starts with optional white space.\n        Has an optional hyphen as a minus sign.\n        Contains either digits, a period followed by digits, or both.\n        Ends with optional white space.\n\n    Notes:\n\n        It is unusual not to accept \"3.\" for a float literal, but this was\n        specified in a comment, so the code here is written for that.\n\n        The question does not state that leading or trailing white space\n        should be accepted (and ignored), but that is included here.  To\n        exclude such white space, simply delete the relevant lines.\n*/\n_Bool IsFloatNumeral(const char *p)\n{\n    _Bool ThereAreInitialDigits = 0;\n    _Bool ThereIsAPeriod = 0;\n\n    //  Skip initial spaces.  (Not specified in question; removed if undesired.)\n    while (isspace(*p))\n        ++p;\n\n    //  Allow an initial hyphen as a minus sign.\n    if (*p == '-')\n        ++p;\n\n    //  Allow initial digits.\n    if (isdigit(*p))\n    {\n        ThereAreInitialDigits = 1;\n        do\n            ++p;\n        while (isdigit(*p));\n    }\n\n    //  Allow a period followed by digits.  Require at least one digit to follow the period.\n    if (*p == '.')\n    {\n        ++p;\n        if (!isdigit(*p))\n            return 0;\n        ThereIsAPeriod = 1;\n        do\n            ++p;\n        while (isdigit(*p));\n    }\n\n    /*  If we did not see either digits or a period followed by digits,\n        reject the string (return 0).\n    */\n    if (!ThereAreInitialDigits &amp;&amp; !ThereIsAPeriod)\n        return 0;\n\n    //  Skip trailing spaces.  (Not specified in question; removed if undesired.)\n    while (isspace(*p))\n        ++p;\n\n    /*  If we are now at the end of the string (the null terminating\n        character), accept the string (return 1).  Otherwise, reject it (return\n        0).\n    */\n    return *p == 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10920453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C8TjJRu2nwQ/AAAAAAAAAAI/AAAAAAAAACM/5kpE_7Q3UBM/photo.jpg?sz=128", "display_name": "sachin mirajkar", "link": "https://stackoverflow.com/users/10920453/sachin-mirajkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1547784868, "creation_date": 1547615659, "last_edit_date": 1547620473, "question_id": 54210803, "link": "https://stackoverflow.com/questions/54210803/how-to-check-if-input-is-numericfloat-or-it-is-some-character", "title": "How to check if input is numeric(float) or it is some character?", "body": "<p>I was asked to write a program to find sum of two inputs in my college so I should first check whether the input is valid. </p>\n\n<p>For example, if I input <code>2534.11s35</code> the program should detect that it is not a valid input for this program because of <code>s</code> in the input.</p>\n"}, {"tags": ["c", "function", "pipe"], "comments": [{"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1547614610, "post_id": 54210537, "comment_id": 95247331, "body": "You&#39;ll have to use OS specific functions for that (unless there is something for it in the new standards coming out. I don&#39;t see it in filesystem.) Should come up on a search if you know your OS."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1547615643, "post_id": 54210537, "comment_id": 95247587, "body": "POSIX defines <code>popen()</code>.  You should have that available on Mac and Linux.  Windows has <code>_popen()</code>, but with caveats.  Other alternatives exist, too, but none in the C standard library. Do take care to read the appropriate docs."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1547621315, "post_id": 54210537, "comment_id": 95249325, "body": "As an aside, the Python snippet is (nominally) buggy: you want <code>Popen([&quot;ls&quot;])</code> or <code>Popen(&quot;ls&quot;, shell=True)</code> but not any compromise where the shell receives a list of tokens, or you pass in a bare string without <code>shell=True</code>.  It currently happens to work, but this is an implementation detail which could - and even perhaps should - change.  Also, for this particular use case, you want <code>subprocess.check_output()</code> or the modern replacement <code>subprocess.run()</code> rather than bare <code>Popen()</code> with the associated plumbing you have to do to reimplement <code>check_output()</code> (incompletely)."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 2, "creation_date": 1547621426, "post_id": 54210537, "comment_id": 95249371, "body": "Extra points for having a folder called <code>Destkop</code> to befuddle your enemies."}], "answers": [{"tags": [], "owner": {"reputation": 1194, "user_id": 4782513, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2834b0654459b57ca36c59d90e1848?s=128&d=identicon&r=PG&f=1", "display_name": "newkid", "link": "https://stackoverflow.com/users/4782513/newkid"}, "is_accepted": true, "score": 0, "last_activity_date": 1547621982, "creation_date": 1547621982, "answer_id": 54211843, "question_id": 54210537, "link": "https://stackoverflow.com/questions/54210537/piping-stdout-in-c/54211843#54211843", "title": "Piping stdout in C", "body": "<p>You can try this using popen as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define PATH_MAX 1000\n\nint main( ) {\n\n    FILE *fp;\n    int status;\n    char path[PATH_MAX];\n\n\n    fp = popen(\"ls *\", \"r\");\n    if (fp == NULL)\n    /* Handle error */;\n\n\n    while (fgets(path, PATH_MAX, fp) != NULL)\n        printf(\"%s\", path);\n\n\n    status = pclose(fp);\n    if (status == -1) {\n        /* Error reported by pclose() */\n        printf(\"Error, reported\");\n    } else {\n        /* Use macros described under wait() to inspect `status' in order\n         to determine success/failure of command executed by popen() */\n        printf(\"Done running\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>You'll find more information <a href=\"https://pubs.opengroup.org/onlinepubs/009696799/functions/popen.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 9642326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761ef07157ef1c2f478004d5d7944211?s=128&d=identicon&r=PG&f=1", "display_name": "Rablidad", "link": "https://stackoverflow.com/users/9642326/rablidad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54211843, "answer_count": 1, "score": 0, "last_activity_date": 1547622202, "creation_date": 1547613702, "last_edit_date": 1547622202, "question_id": 54210537, "link": "https://stackoverflow.com/questions/54210537/piping-stdout-in-c", "title": "Piping stdout in C", "body": "<p>I would like to know how can I pipe stdout in c. Here is an example of piping the stdout of the command 'ls' from linux, storing it in a variable, and then printing the value of the variable:</p>\n\n<pre><code>import subprocess\n#Piping stdout of the command 'ls' from linux\ntest = subprocess.Popen(\"ls\", stdout = subprocess.PIPE)\nstdoutpiped = test.stdout.read().decode('utf-8')\nprint(stdoutpiped)\n</code></pre>\n\n<p>Results from the running code:</p>\n\n<pre><code>Destkop\nDocuments\nImages\nVideos\nDownloads\nMyCodes\npasswords.txt\n</code></pre>\n\n<p>How would you do this in <code>c</code>? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 12572, "user_id": 8534008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2af9937cac66f08b6ee6e4219cc0d?s=128&d=identicon&r=PG&f=1", "display_name": "GBlodgett", "link": "https://stackoverflow.com/users/8534008/gblodgett"}, "edited": false, "score": 0, "creation_date": 1547598875, "post_id": 54208781, "comment_id": 95244111, "body": "Welcome to Stack Overflow Liu! In the future please tag your question with the language you are writing in. This allows people to find your question :)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1547599587, "post_id": 54208781, "comment_id": 95244256, "body": "Fyi, <code>merge_List</code> != <code>merge_list</code>. Related, stop hiding pointer types in typedef aliases. It brings absolutely no clarity to this code, and makes it <i>less</i> (not more) obvious where things are broken. There are two cases where aliased pointer types are sensible (callback function types and black-box &quot;handle&quot; architectures) and this is neither of those cases. Trust me, you want to <i>see</i> those asterisks as you&#39;re coding."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1547619884, "post_id": 54208781, "comment_id": 95248818, "body": "Note the discussion in <a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to typedef pointers?</a> \u2014 the TL;DR version is &quot;No, except perhaps for function pointers&quot;."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1547639054, "post_id": 54208781, "comment_id": 95258294, "body": "&quot;The code doesn&#39;t work until I dynamically allocate the memory for pointer C in merge_List function.&quot; Where should the pointer point to if you do not allocate any memory? You dereference <code>c</code> in your <code>while</code> loop. That doesn&#39;t work without having legal memory location. Or do you assume your other option <code>list c;</code> will allocate the required memory on the stack?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547675616, "post_id": 54208781, "comment_id": 95277826, "body": "regarding: <code>typedef struct Node {    struct Node *next;    int value; }Node,*list;</code>  it is very poor programming practice to hide a pointer in a <code>typedef</code>"}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1547736944, "post_id": 54208781, "comment_id": 95301610, "body": "WHY?? And how should I normalize it?"}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1547601651, "post_id": 54208937, "comment_id": 95244678, "body": "This is a natural result of the code using <code>typedef struct { ... } Node, *list;</code>. That means <code>Node</code> refers to the struct itself, while <code>list</code> refers to a pointer to the struct. It&#39;s the same way <code>typedef int *pint;</code> makes <code>pint</code> mean pointer to <code>int</code>."}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1547819388, "post_id": 54208937, "comment_id": 95334546, "body": "I have another question, as we know if we dynamically allocate the memory in a function, after the function is done, the memory eliminates. In my code, I created many &quot;new&quot; pointers, then why after the function create_Node(), those Nodes still exist."}, {"owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "edited": false, "score": 0, "creation_date": 1547832396, "post_id": 54208937, "comment_id": 95341617, "body": "The memory does not eliminate after the function is done if it&#39;s dynamically allocated. You have to manually free it or wait for the end of the program."}], "tags": [], "owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1547600151, "last_edit_date": 1547600151, "creation_date": 1547599794, "answer_id": 54208937, "question_id": 54208781, "link": "https://stackoverflow.com/questions/54208781/memory-leaked-in-c/54208937#54208937", "title": "Memory leaked in C", "body": "<p>It took a bit of inspection, but this is the struct's type is</p>\n\n<pre><code>list {aka struct Node *}\n</code></pre>\n\n<p>According to the compiler. In other words, list is a pointer, and calling malloc will allocate memory for the pointer. </p>\n\n<p>You did this before in your function create_Node(), on the line right after</p>\n\n<pre><code>list head = (list)malloc(sizeof(Node));\n</code></pre>\n\n<p>If you don't do this, you're performing actions on an uninitialized pointer, which is undefined behavior and shouldn't work since you don't clearly have a spot in memory you're using. </p>\n\n<p>What malloc specifically does in this context, will allocate the sizeof a Node's bytes, and return a void pointer, which you cast to a list (or Node *). List will no longer be uninitialized and no longer has undefined behaviour, which is why it works. </p>\n"}], "owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547600151, "creation_date": 1547598472, "last_edit_date": 1547598830, "question_id": 54208781, "link": "https://stackoverflow.com/questions/54208781/memory-leaked-in-c", "title": "Memory leaked in C", "body": "<p>The code doesn't work until I dynamically allocate the memory for pointer C in merge_List function.</p>\n\n<p>If I uncomment <code>list c = (list)malloc(sizeof(Node));</code> and comment \n<code>list c;</code>, the code works.\n   I don't know why. Can anyone explain to me?\n   The code is very straightforward, so not much comment.\n   Thank you!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct Node\n{\n   struct Node *next;\n   int value;\n}Node,*list;\nlist create_Node()\n{  \n   list head = (list)malloc(sizeof(Node));\n   if(!head) exit(-1);\n   list tail = head;\n   int len;\n   int val;\n   printf(\"Please enter the length of the list:\\n \");\n   scanf(\"%d\",&amp;len);\n   for(int i=0;i&lt;len;i++)\n   {\n      list new = (list)malloc(sizeof(Node));\n      if(!new) exit(-1);\n      printf(\"Please enter the value of the node:\\n \");\n      scanf(\" %d\",&amp;val);\n      new-&gt;value=val;\n      tail-&gt;next= new; \n      tail =new;\n   }\n   return head;\n}\n\nlist merge_list(list a, list b)\n{\n    if(a==NULL||b==NULL) exit(-1);\n    //list c = (list)malloc(sizeof(Node));\n    list c;\n    list d = c;\n    while(a&amp;&amp;b)\n    {\n       if(a-&gt;value&lt;=b-&gt;value)\n       {\n          c-&gt;next=a;\n          c=a;\n          a=a-&gt;next;\n       }\n       else\n       {\n          c-&gt;next = b;\n          c=b;\n          b=b-&gt;next;\n       }\n     }\n     c-&gt;next = a?a:b;\n     return d;\n}\nint main() {\n\n   list  l = create_Node();\n   l=l-&gt;next;\n   list j = create_Node();\n   j=j-&gt;next;\n   list n =merge_List(l,j);\n   n=n-&gt;next;\n   while(n)\n   {\n      printf(\"%d\\n\",n-&gt;value);\n      n=n-&gt;next;\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "nvidia", "glx"], "answers": [{"comments": [{"owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "edited": false, "score": 0, "creation_date": 1547852246, "post_id": 54241531, "comment_id": 95349084, "body": "Thanks for the answer! Seems to be a no go still. I added the GLX_DRAWABLE_TYPE attrib with a mask containing GLX_PIXMAP_BIT, and there are still no FBConfigs returned. I also tried with the same attributes list from this example, and it still returns no configs: <a href=\"https://www.khronos.org/opengl/wiki/Programming_OpenGL_in_Linux:_Using_texture_from_pixmap_extension\" rel=\"nofollow noreferrer\">khronos.org/opengl/wiki/&hellip;</a>"}, {"owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "edited": false, "score": 0, "creation_date": 1571088840, "post_id": 54241531, "comment_id": 103116687, "body": "I&#39;ve discovered the actual cause of this, and posted an answer, in case you&#39;re still curious."}], "tags": [], "owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "is_accepted": false, "score": 0, "last_activity_date": 1547747200, "creation_date": 1547747200, "answer_id": 54241531, "question_id": 54208703, "link": "https://stackoverflow.com/questions/54208703/glxchoosefbconfig-w-glx-bind-to-texture-ext-returning-no-fbconfigs-on-nvidia/54241531#54241531", "title": "glXChooseFBConfig w/ GLX_BIND_TO_TEXTURE_*_EXT returning no FBConfigs on Nvidia driver", "body": "<p>I think the issue comes from the attributes list passed to glXChooseFBConfig (your pixmap_config[]).</p>\n\n<p>I guess some driver may fill required fields with default values, and then compare its internal configurations with the requested one.</p>\n\n<p>The problem is that <code>EXT_texture_from_pixmap</code> only works with pixmaps, not windows.\n<br>So, you should set the <code>GLX_DRAWABLE_TYPE</code> field with a mask containing <code>GLX_PIXMAP_BIT</code> and not the default <code>GLX_WINDOW_BIT</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "is_accepted": true, "score": 0, "last_activity_date": 1571088770, "creation_date": 1571088770, "answer_id": 58384321, "question_id": 54208703, "link": "https://stackoverflow.com/questions/54208703/glxchoosefbconfig-w-glx-bind-to-texture-ext-returning-no-fbconfigs-on-nvidia/58384321#58384321", "title": "glXChooseFBConfig w/ GLX_BIND_TO_TEXTURE_*_EXT returning no FBConfigs on Nvidia driver", "body": "<p>To quote the <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glXChooseFBConfig.xml\" rel=\"nofollow noreferrer\">spec</a>:</p>\n\n<pre><code>attrib_list\n    Specifies a list of attribute/value pairs. The last attribute must be None.\n</code></pre>\n\n<p>Some GL implementations, such as Mesa, are more permissive, and will accept <code>GLX_NONE</code> (0x8000) terminating this list of attributes. However, the Nvidia driver does not, and will return NULL. Specifying Xlib's <code>None</code> (0) works. This is also the case for <code>glXCreatePixmap</code>.</p>\n"}], "owner": {"reputation": 3949, "user_id": 136846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf038c69f2219bf87bd92dd568582d77?s=128&d=identicon&r=PG", "display_name": "jakogut", "link": "https://stackoverflow.com/users/136846/jakogut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 58384321, "answer_count": 2, "score": 0, "last_activity_date": 1571088770, "creation_date": 1547597905, "question_id": 54208703, "link": "https://stackoverflow.com/questions/54208703/glxchoosefbconfig-w-glx-bind-to-texture-ext-returning-no-fbconfigs-on-nvidia", "title": "glXChooseFBConfig w/ GLX_BIND_TO_TEXTURE_*_EXT returning no FBConfigs on Nvidia driver", "body": "<p>I have an application that uses the GLX extension <code>texture_from_pixmap</code>, which requires a color buffer created using an FBConfig with GLX_BIND_TO_TEXTURE_RGB_EXT, or GLX_BIND_TO_TEXTURE_RGBA_EXT, per the spec.</p>\n\n<blockquote>\n  <p>Only a color buffer of a GLX pixmap created using an FBConfig with\n  attribute GLX_BIND_TO_TEXTURE_RGB_EXT or GLX_BIND_TO_TEXTURE_RGBA_EXT\n  set to TRUE can be bound as a texture.</p>\n</blockquote>\n\n<p><a href=\"https://www.khronos.org/registry/OpenGL/extensions/EXT/GLX_EXT_texture_from_pixmap.txt\" rel=\"nofollow noreferrer\">https://www.khronos.org/registry/OpenGL/extensions/EXT/GLX_EXT_texture_from_pixmap.txt</a></p>\n\n<p>My application does this, and works fine with Mesa and the Intel i965 driver, but not with the proprietary Nvidia driver.</p>\n\n<p>When using glXChooseFBConfig with the Nvidia driver, no matching FBConfigs are returned, and I can't seem to figure out why.</p>\n\n<p>I've made a minimal code sample that reproduces this problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;X11/Xlib.h&gt;\n#include &lt;GL/glx.h&gt;\n\nint main()\n{\n        Display *display = XOpenDisplay(NULL);\n\n        if (!display) {\n                printf(\"Unable to connect to display.\\n\");\n                return 1;\n        }\n\n        int pixmap_config[] = {\n                GLX_BIND_TO_TEXTURE_RGB_EXT, True,\n                GLX_NONE\n        };\n\n        int c = 0;\n        GLXFBConfig *configs = glXChooseFBConfig(display, 0, pixmap_config, &amp;c);\n        if (!configs) {\n                printf(\"No appropriate GLX FBConfig available!\\n\");\n        } else {\n                printf(\"Number of matching configs: %i\\n\", c);\n        }\n\n        return 0;\n}\n</code></pre>\n\n<p>On any Nvidia graphics card I test using the proprietary driver, I get:</p>\n\n<blockquote>\n  <p>No appropriate GLX FBConfig available!</p>\n</blockquote>\n\n<p>Using Intel Graphics with Mesa, I get:</p>\n\n<blockquote>\n  <p>Number of matching configs: 82</p>\n</blockquote>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c", "pointers", "memory", "c-strings"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1547600336, "post_id": 54208698, "comment_id": 95244388, "body": "<code>sc</code> and <code>s</code> are not const.  They point to things which might be const."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10915417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1273103a61694a052c22c5521356065f?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/10915417/m-o"}, "edited": false, "score": 0, "creation_date": 1547599019, "post_id": 54208778, "comment_id": 95244135, "body": "&quot;The const applies to the pointed variable...&quot;, so in the case of <code>sc=s</code>, does the const from <code>const char sc</code> apply to <code>s</code> or the value of <code>s</code>. In my answer I presumed both const declarations apply to the ultimate value of the pointers but now I am not so sure.  Ie if it were to apply to s, then after declaring <code>sc=s</code> it would become illegal to change what s points to."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "reply_to_user": {"reputation": 79, "user_id": 10915417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1273103a61694a052c22c5521356065f?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/10915417/m-o"}, "edited": false, "score": 0, "creation_date": 1547604342, "post_id": 54208778, "comment_id": 95245159, "body": "@M.O. The assignment shouldn&#39;t change anything. Both variables are declared as pointers to constant chars, so the value they point to is constant while the pointers themselves aren&#39;t. Since the assignment assigns the pointers and not the memory they point to, the code is legal. To make the pointers constant, you would put <code>const</code> after the <code>*</code>."}], "tags": [], "owner": {"reputation": 3276, "user_id": 746547, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iL90.jpg?s=128&g=1", "display_name": "Louen", "link": "https://stackoverflow.com/users/746547/louen"}, "is_accepted": false, "score": 2, "last_activity_date": 1547598456, "creation_date": 1547598456, "answer_id": 54208778, "question_id": 54208698, "link": "https://stackoverflow.com/questions/54208698/understanding-of-strlen-function-assignment-of-const-char-s-to-const-char-sc/54208778#54208778", "title": "Understanding of strlen function - Assignment of const char *s to const char *sc", "body": "<p>You are correct. </p>\n\n<p><code>const char * sc</code> declares a pointer to a <code>const char</code>. In essence, it means that sc points to a variable of type <code>char</code> (or in that case, a contiguous array of <code>char</code>s) <strong>and</strong> that you cannot use <code>sc</code> to modify the pointed variable. See it live <a href=\"https://ideone.com/xkj16T\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Note that <code>sc</code> itself is <strong>not</strong> a <code>const</code> variable. The <code>const</code> applies to the pointed variable, and not to the pointer. You can thus change the value <em>of the pointer</em>, i.e. the variable to which it points.</p>\n\n<p>Follow this answer to have more insight about the different uses of <code>const</code> and pointers : <a href=\"https://stackoverflow.com/questions/1143262/what-is-the-difference-between-const-int-const-int-const-and-int-const\">What is the difference between const int*, const int * const, and int const *?</a></p>\n"}, {"tags": [], "owner": {"reputation": 1049, "user_id": 1247248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13083c646d62cbec35b5f2c50d8ef644?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1247248/marc"}, "is_accepted": true, "score": 5, "last_activity_date": 1547778436, "last_edit_date": 1547778436, "creation_date": 1547599432, "answer_id": 54208892, "question_id": 54208698, "link": "https://stackoverflow.com/questions/54208698/understanding-of-strlen-function-assignment-of-const-char-s-to-const-char-sc/54208892#54208892", "title": "Understanding of strlen function - Assignment of const char *s to const char *sc", "body": "<p>I think what you are asking is what the <strong>const</strong> keyword means. If not please clarify your question.</p>\n\n<p>The way I like to think of it is any const variable can be stored in ROM (Read Only Memory) and variables that are not declared const can be stored in RAM (Random Access Memory). This kind of depends on the kind of computer you are working with so the const data may not actually be stored in ROM but it could be.</p>\n\n<p>So you can do anything you want with the pointer itself but you can not change the data in the memory it points to.</p>\n\n<p>This means you can reference the pointer and pass that around as much as you like. Also you can assign a different value to the pointer.</p>\n\n<p>Say you have this code</p>\n\n<pre><code>const char* foo = \"hello\";\nconst char* bar = \"world\";\n</code></pre>\n\n<p>Its perfectly legal to do</p>\n\n<pre><code>foo = bar;\n</code></pre>\n\n<p>Now both point \"world\"</p>\n\n<p>Its also legal to do</p>\n\n<pre><code>const char *myPtr = bar;\nmyPtr = foo;\n</code></pre>\n\n<p>What you are not allowed to do is change the actual data memory so you are not allowed to do</p>\n\n<pre><code>foo[0] = 'J';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1547611156, "post_id": 54208953, "comment_id": 95246521, "body": "<code>*sc = &#39;x&#39;;</code> is a constraint violation (6.5.16/2) reagardless of whar <code>sc</code> points at. A diagnostic must be produced. <code>*(char *)sc = &#39;x&#39;;</code> is UB if whatever <code>sc</code> points at was originally defined with a <code>const</code> modifier; otherwise it&#39;s perfectly legal. (6.7.3/6) (I know you know that. And perhaps the distinction isn&#39;t necessary for this question, but it might not hurt.)"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1547612097, "last_edit_date": 1547612097, "creation_date": 1547599931, "answer_id": 54208953, "question_id": 54208698, "link": "https://stackoverflow.com/questions/54208698/understanding-of-strlen-function-assignment-of-const-char-s-to-const-char-sc/54208953#54208953", "title": "Understanding of strlen function - Assignment of const char *s to const char *sc", "body": "<blockquote>\n  <p>Is my understanding of the legality of sc = s correct?</p>\n</blockquote>\n\n<p>Yes, only some detail on the last part needed.</p>\n\n<blockquote>\n  <p>... but any assignment (or reference?) to <code>*s</code> or <code>sc</code> would be illegal.</p>\n</blockquote>\n\n<p>(I suspect OP means \"... or <code>*sc</code> would be illegal.\")</p>\n\n<p>Referencing what <code>s</code> or <code>sc</code> points to is OK as in <code>char ch = *sc;</code></p>\n\n<p>Attempting to <em>change</em> the value of <code>*s</code> or <code>*sc</code> is <em>undefined behavior</em> (UB), not \"illegal\" as in <code>*sc = 'x';</code><br>\n(See <a href=\"https://stackoverflow.com/questions/54208698/understanding-of-strlen-function-assignment-of-const-char-s-to-const-char-sc/54208953?noredirect=1#comment95246521_54208953\">good additional detail by @rici</a>)</p>\n\n<p>With UB, the assignment <em>may</em> work, it might not on Tuesdays, code may crash, etc.  It is not defined by C what happens.  Certainty code should not attempt it.</p>\n"}], "owner": {"reputation": 79, "user_id": 10915417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1273103a61694a052c22c5521356065f?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/10915417/m-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 54208892, "answer_count": 3, "score": 4, "last_activity_date": 1547778436, "creation_date": 1547597839, "last_edit_date": 1547599327, "question_id": 54208698, "link": "https://stackoverflow.com/questions/54208698/understanding-of-strlen-function-assignment-of-const-char-s-to-const-char-sc", "title": "Understanding of strlen function - Assignment of const char *s to const char *sc", "body": "<p>Below is the implementation of strlen.c as per \"The Standard C Library,</p>\n\n<pre><code>size_t strlen(const char *s){\n   const char *sc;\n   for(sc = s; *sc != '\\0'; ++sc)\n\n   return (sc-s);  }\n</code></pre>\n\n<p>Is my understanding of the legality of <code>sc = s</code> correct?</p>\n\n<p><code>sc=s</code> is a legal assignment because since both variables are declared as <code>const</code>, both protect the object that is pointed to by s. In this case, it is legal to change where sc or s both point to but any assignment (or reference?) to <code>*s</code> or <code>sc</code> would be illegal. </p>\n"}, {"tags": ["c#", "c", "interop", "marshalling"], "comments": [{"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1547630337, "post_id": 54208467, "comment_id": 95253230, "body": "<code>uint32_t</code> in C# would just be a <code>uint</code>, so your <code>GpioPulse</code> C# class should just be as simple as the C version, e.g. <code>public struct GpioPulse { uint gpioOn; uint gpioOff; uint usDelay; }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7174042, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210157597849786/picture?type=large", "display_name": "Rene Steen", "link": "https://stackoverflow.com/users/7174042/rene-steen"}, "is_accepted": false, "score": 0, "last_activity_date": 1547715320, "creation_date": 1547715320, "answer_id": 54232140, "question_id": 54208467, "link": "https://stackoverflow.com/questions/54208467/signature-is-not-interop-compatible-calling-c-methods-from-c/54232140#54232140", "title": "Signature is not Interop compatible - calling c methods from c#", "body": "<p>Solution:\nuint32_t in C# would just be a uint, so your GpioPulse C# class should just be as simple as the C version, e.g. public struct GpioPulse { uint gpioOn; uint gpioOff; uint usDelay; }</p>\n"}], "owner": {"reputation": 1, "user_id": 7174042, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210157597849786/picture?type=large", "display_name": "Rene Steen", "link": "https://stackoverflow.com/users/7174042/rene-steen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547715320, "creation_date": 1547596094, "question_id": 54208467, "link": "https://stackoverflow.com/questions/54208467/signature-is-not-interop-compatible-calling-c-methods-from-c", "title": "Signature is not Interop compatible - calling c methods from c#", "body": "<p>Im trying to make use of interop functionality to use create a .net wrapper for the c written pigpio library. However i seem to be stuck with the following error:\n\"<strong>Cannot marshal 'parameter #2': Signature is not Interop compatible</strong>\". The C method has the following signature:</p>\n\n<pre><code>int gpioWaveAddGeneric(unsigned numPulses, gpioPulse_t *pulses);\n</code></pre>\n\n<p>where as gpioPulse_t is: </p>\n\n<pre><code>typedef struct\n{\n   uint32_t gpioOn;\n   uint32_t gpioOff;\n   uint32_t usDelay;\n} gpioPulse_t;\n</code></pre>\n\n<p>i assumed that this would be the signature to invoke the class:</p>\n\n<pre><code> [DllImport(Constants.PiGpioLibrary, CallingConvention = CallingConvention.Cdecl, EntryPoint = \"gpioWaveAddGeneric\")]\n public static extern int GpioWaveAddGeneric(uint numPulses, [In, MarshalAs(UnmanagedType.LPArray)] GpioPulse[] pulses);\n</code></pre>\n\n<p>where GpioPulse[] is</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential, Pack = 1)]\npublic class GpioPulse\n{\n    private BitMask m_GpioOn;\n    private BitMask m_GpioOff;\n    private uint m_DelayMicroseconds;\n    public BitMask GpioOn { get =&gt; m_GpioOn; set =&gt; m_GpioOn = value; }\n    public BitMask GpioOff { get =&gt; m_GpioOff; set =&gt; m_GpioOff = value; }\n    public uint DurationMicroSecs { get =&gt; m_DelayMicroseconds; set =&gt; m_DelayMicroseconds = value; }\n}\n</code></pre>\n\n<p>and BitMask:</p>\n\n<pre><code>[Flags]\npublic enum BitMask : uint\n{\n    None = 0x00000000,\n    All = 0xFFFFFFFF,\n    Bit00 = 0x00000001,\n    Bit01 = 0x00000002,\n    Bit02 = 0x00000004,\n    Bit03 = 0x00000008,\n}\n</code></pre>\n\n<p>any Idea what I am doing wrong?</p>\n"}, {"tags": ["c", "linux", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1547596228, "post_id": 54208216, "comment_id": 95243535, "body": "If you <i>know</i> the array dimensions (e.g. <code>int array[YMAX * XMAX]</code>), the linear/absolute index can be converted back to row/column: <code>yidx = absidx &#47; XMAX; xidx = absidx % XMAX;</code> This even works with <code>int array[YMAX][XMAX];</code>. If the individual indexes are: <code>xidx</code> and <code>yidx</code>, then compute: <code>absidx = (yidx * YMAX) + xidx;</code> Send this back. Then, recover the row/column from the first method"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547598448, "post_id": 54208216, "comment_id": 95244010, "body": "Correction: The last equation should be: <code>absidx = (yidx * XMAX) + xidx;</code>"}, {"owner": {"reputation": 39, "user_id": 8156652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2cdY92hGjA4/AAAAAAAAAAI/AAAAAAAAAFo/_ElFwBkLQKY/photo.jpg?sz=128", "display_name": "george nikitas", "link": "https://stackoverflow.com/users/8156652/george-nikitas"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1547599355, "post_id": 54208216, "comment_id": 95244210, "body": "This is what I needed dude, thank you!!! In array you have YMAX and then XMAX, so the absidx was correct in the first comment :D"}], "owner": {"reputation": 39, "user_id": 8156652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2cdY92hGjA4/AAAAAAAAAAI/AAAAAAAAAFo/_ElFwBkLQKY/photo.jpg?sz=128", "display_name": "george nikitas", "link": "https://stackoverflow.com/users/8156652/george-nikitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547596083, "creation_date": 1547594158, "last_edit_date": 1547596083, "question_id": 54208216, "link": "https://stackoverflow.com/questions/54208216/mpi-reduce-minloc-double-index", "title": "MPI_Reduce MINLOC double index?", "body": "<p>So I have an array of intengers to each processor and I want to find the minimum element to each one and save the index of row and column.</p>\n\n<p>After I find the minimum element to each individual processor I need to call MPI_reduce to find the minimum and send the I,j index.</p>\n\n<p>I saw that MINLOC can help if there is only one index in the struct like the following:</p>\n\n<pre><code>struct {\n     int min;\n     int index_i;\n} in, out;\n</code></pre>\n\n<p>But what if I want to send both row and column index?\nan array in struct does not solve the problem.</p>\n\n<p>Is there another way to achieve this?\nI am writing in C.</p>\n\n<p>Thanks for your time :D.</p>\n"}, {"tags": ["c", "fgets"], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1547599137, "post_id": 54208185, "comment_id": 95244161, "body": "Rather than <code>ID[strlen(ID)-1] != &#39;\\n&#39;</code>, suggest <code>strchr(ID, &#39;\\n&#39;) == NULL</code> to prevent UB when the first character read by <code>fget()</code> is a <i>null character</i>."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 2, "last_activity_date": 1547594487, "last_edit_date": 1547594487, "creation_date": 1547593965, "answer_id": 54208185, "question_id": 54208148, "link": "https://stackoverflow.com/questions/54208148/my-very-simple-program-seems-to-exhibit-weird-behavior-when-my-fgets-input-exc/54208185#54208185", "title": "My (very simple) program seems to exhibit weird behavior when my fgets input exceeds the specified buffer size", "body": "<p>The reason is, that the rest of the line is not fetched by <code>fgets()</code> if it's larger than the passed buffer and hence remains in the input buffer of your stdin filestream; subsequently the conversions of <code>scanf()</code> fail.</p>\n\n<p>You would have to detect this case (for example by checking, if the last character in your just-read string is not a newline) and empty the input buffer up to the next newline, for example by calling <code>getchar()</code> in a loop up to a newline (or EOF). Then call <code>scanf()</code>.</p>\n\n<p>Example code (untested and EOF-check still missing):</p>\n\n<pre><code>fgets(ID, sizeof(ID), stdin);\nif (ID[strlen(ID)-1] != '\\n') {\n    while (getchar() != '\\n')\n        ;\n}\n</code></pre>\n\n<p>And remember to check the return values of your <code>scanf()</code> calls to see, if the conversions succeeded!</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1547599416, "post_id": 54208644, "comment_id": 95244227, "body": "Better to use <code>int ch</code> than <code>char ch</code> to properly detect <code>c != EOF</code>."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1547597391, "creation_date": 1547597391, "answer_id": 54208644, "question_id": 54208148, "link": "https://stackoverflow.com/questions/54208148/my-very-simple-program-seems-to-exhibit-weird-behavior-when-my-fgets-input-exc/54208644#54208644", "title": "My (very simple) program seems to exhibit weird behavior when my fgets input exceeds the specified buffer size", "body": "<p>The behaviour you observe is because if the newline is not written to ID because there is no room, it remains in the input buffer, which the subsequent two <code>scanf()</code> calls do not consume due to the format specifier string not reading white space.</p>\n\n<p><code>fgets()</code> returns when a newline is entered, <em>and</em> the newline is written to the buffer.  That being the case you requiire a buffer of 12 characters - the accommodate the newline and the nul terminator.  It is a good idea to zero initialise the buffer too.</p>\n\n<pre><code>char ID[11] = {0} ;\n</code></pre>\n\n<p>After the <code>fgets()</code>, you may need to replace the newline with a nul.</p>\n\n<p>To replace the newline with nul or discard the input buffer data where the newline remains:</p>\n\n<pre><code>char* end = strrchr( ID, `\\n` ) ;\nif( end != NULL) \n{ \n    *end = `\\0` \n}\nelse\n{\n    char c ;\n    do\n    {\n        c = getchar() ;\n    } while( c != '\\n' &amp;&amp; c != EOF ) ;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9067604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d397b33cf79b51460fb2276d4493ff?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robar", "link": "https://stackoverflow.com/users/9067604/joshua-robar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1547597391, "creation_date": 1547593732, "last_edit_date": 1547593983, "question_id": 54208148, "link": "https://stackoverflow.com/questions/54208148/my-very-simple-program-seems-to-exhibit-weird-behavior-when-my-fgets-input-exc", "title": "My (very simple) program seems to exhibit weird behavior when my fgets input exceeds the specified buffer size", "body": "<p>I'm just getting started with C and I've written a very simple program that takes an Employee ID, hours worked and salary and outputs the wage earned and ID given.</p>\n\n<p>I'm capturing the ID with fgets, however, when I enter a string of characters longer than the specified buffer size (of 10 here) my program seems to \"crash\". It prints the next two printf's on the same line, skipping taking input for the first, which obviously breaks the program. </p>\n\n<p>When the ID captured with fgets is &lt;= the buffer size it works fine. A little confused as to what the issue is. FWIW I'm using codeblocks with the GNU GCC Compiler.</p>\n\n<p>Thank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    // Initialize variables\n    char ID[11];\n    float hrs, sal;\n\n    // Get Employee's ID from user input\n    printf(\"Input the Employee's ID(Max. 10 chars): \");\n    fgets(ID, sizeof(ID), stdin);\n\n    // Get working hours as float from user input\n    printf(\"Input the working hrs: \");\n    scanf(\"%f\", &amp;hrs);\n\n    // Get hourly salary as float from user input\n    printf(\"Salary amount/hr: \");\n    scanf(\"%f\", &amp;sal);\n\n    // Print Employee's ID\n    printf(\"Employee's ID: %s\", ID);\n\n    // Print wage based on hours worked and salary\n    printf(\"Salary = U$ %.2f\", sal * hrs);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1547591934, "post_id": 54207824, "comment_id": 95242406, "body": "<a href=\"https://code.woboq.org/userspace/glibc/stdio-common/isoc99_fscanf.c.html\" rel=\"nofollow noreferrer\">isoc99_fscanf.c</a> has some macro on line 30, but it&#39;s unknown if it&#39;s that version. And it doesn&#39;t seem like it would fail. Why do you have debug information included with glibc? What OS are you running? What glibc version do you have? Btw. <code>fscanf(file, &quot;%d&quot;, &amp;pid)</code> returns 1 on success, you should probably ignore cases when it returns 0."}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1547592062, "post_id": 54207824, "comment_id": 95242442, "body": "I did get a warning asking me if I meant <code>fopen</code> instead of <code>fdopen</code>, not sure if that helps, but I certainly didn&#39;t mean the former"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1547592126, "post_id": 54207824, "comment_id": 95242469, "body": "Did you get a warning that the function is implicit declared? <code>warning: implicit declaration of function ...</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1547592662, "post_id": 54207824, "comment_id": 95242651, "body": "OT:  If an <code>exec*()</code> function fails after a <code>fork()</code>, you almost certainly don&#39;t want to call <code>exit()</code> afterwards - that will flush any buffered data copied from the parent&#39;s address space to the child&#39;s address space into the parent&#39;s files.  It will also call all exit handlers registered by the parent process.  <code>_exit()</code> exists for a reason."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547675228, "post_id": 54207824, "comment_id": 95277665, "body": "OT: regarding: <code>int main(int argc, char *argv[])</code>  When the parameters to <code>main()</code> are not going to be used, then use the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547675466, "post_id": 54207824, "comment_id": 95277755, "body": "strongly suggest reading the MAN page for <code>fdopen()</code>  especially the part about  &quot;Feature Test Macro Requirements for glibc&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1547592269, "creation_date": 1547592269, "answer_id": 54207928, "question_id": 54207824, "link": "https://stackoverflow.com/questions/54207824/fscanf-causes-segmentation-fault/54207928#54207928", "title": "fscanf causes segmentation fault", "body": "<p>In C  if no previous declaration of function exist it is assumed the function returns an <code>int</code>. If the compiler assumes the function returns an <code>int</code> while it returns <code>FILE *</code> and if <code>sizeof(FILE*) &lt; sizeof(int)</code> the return value is truncated and is invalid. Thus you get internal glibc errors as the pointer passed to <code>fscanf</code> is truncated and invalid.</p>\n\n<p>From <a href=\"https://linux.die.net/man/3/fdopen\" rel=\"nofollow noreferrer\">man fdopen</a> you can read:</p>\n\n<pre><code>fdopen(): _POSIX_C_SOURCE &gt;= 1 || _XOPEN_SOURCE || _POSIX_SOURCE\n</code></pre>\n\n<p>These are the macros that you need to define to have <code>fdopen()</code> declaration in your program. You need to define them <em>before</em> any inclusion. I usually just define <code>_GNU_SOURCE</code> which defines <code>_POSIX_C_SOURCE</code> etc. in <code>features.h</code>.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/types.h&gt;\n\n.. rest of the program ...\n</code></pre>\n\n<p>For more information see <a href=\"https://linux.die.net/man/7/feature_test_macros\" rel=\"nofollow noreferrer\">future test macros</a>. </p>\n\n<p>When using <code>gcc</code> you can also do <code>gcc -std=gnu11</code> or other <code>-std=gnu*</code>. <code>-std=c11</code> is the same as <code>-std=gnu11</code> except the macro <code>_GNU_SOURCE</code> is predefined when compiling.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 2, "last_activity_date": 1547592551, "creation_date": 1547592551, "answer_id": 54207973, "question_id": 54207824, "link": "https://stackoverflow.com/questions/54207824/fscanf-causes-segmentation-fault/54207973#54207973", "title": "fscanf causes segmentation fault", "body": "<p>Per the <a href=\"http://man7.org/linux/man-pages/man3/fdopen.3.html\" rel=\"nofollow noreferrer\">Linux man page for <code>fdopen()</code></a>, Linux/glibc requires definition of the <code>_POSIX_C_SOURCE</code> macro: </p>\n\n<blockquote>\n  <p>Feature Test Macro Requirements for glibc (see\n  <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">feature_test_macros(7)</a>):</p>\n\n<pre><code>   fdopen(): _POSIX_C_SOURCE\n</code></pre>\n</blockquote>\n\n<p>Otherwise, you get an implicit declaration, which as already noted means the function is assumed to return <code>int</code>.  And the pointer that <code>fdopen()</code> actually returns likely doesn't fit into that <code>int</code>, so it's truncated.</p>\n"}], "owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 54207928, "answer_count": 2, "score": 0, "last_activity_date": 1547592551, "creation_date": 1547591633, "last_edit_date": 1547592211, "question_id": 54207824, "link": "https://stackoverflow.com/questions/54207824/fscanf-causes-segmentation-fault", "title": "fscanf causes segmentation fault", "body": "<p>I'm writing a code that will count the number of processes who parent process is <code>init</code>. Called fork and had the child use an <code>exec</code> function and pass its output through a pipe back to the parent. All seemed fine on that end, but when I used <code>fdopen</code> on the parent's read-end of the pipe, followed by <code>fscanf</code> the program crashed, even though the <code>FILE</code> stream is not <code>NULL</code>. I placed checks on every function call. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/types.h&gt;\n\nstatic void     fatalError(char *message);\n\nint main(int argc, char *argv[])\n{\n\n    int     total, initCount = 0;\n    int     pipeToParent[2];\n    pid_t   pid;\n    FILE    *file;\n\n\n\n    if (pipe(pipeToParent) &lt; 0)\n        fatalError(\"pipe() error\");\n\n    if ((pid = fork()) &lt; 0)\n        fatalError(\"fork() error\");\n    else if (pid == 0) {\n\n        if (close(pipeToParent[0]) &lt; 0)\n            fatalError(\"close() error\");\n\n        if (dup2(pipeToParent[1], STDOUT_FILENO) &lt; 0)\n            fatalError(\"dup2() error\");\n\n        execlp(\"ps\", \"ps\", \"ahxo\", \"ppid\", NULL);\n        fatalError(\"exec() error\");\n\n    }\n\n\n    if (close(pipeToParent[1]) &lt; 0)\n        fatalError(\"close() error\");\n\n    wait(NULL);\n\n    if ((file = fdopen(pipeToParent[0], \"r\")) == NULL)\n        fatalError(\"fdopen() error\");\n\n\n    for (total = 0; fscanf(file, \"%d\", &amp;pid) != EOF; total++)\n        if (pid == 1)\n            initCount++;\n\n    if (fclose(file) &lt; 0)\n        fatalError(\"fclose() error\");\n\n    printf(\"%.2f%%\\n\", (float) initCount * 100 / total);\n    exit(EXIT_SUCCESS);\n\n\n}\n\n\nstatic void     fatalError(char *message) {\n    perror(message);\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>Running GDB gave this:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n__isoc99_fscanf (stream=0x55757260, format=0x555555554c44 \"%d\") at isoc99_fscanf.c:30\n30  isoc99_fscanf.c: No such file or directory.\n</code></pre>\n\n<p>And the Makefile warnings:</p>\n\n<pre><code>gcc -std=c11 -g -Wall -pedantic    init.c   -o init\ninit.c: In function \u2018main\u2019:\ninit.c:55:14: warning: implicit declaration of function \u2018fdopen\u2019; did you mean \u2018fopen\u2019? [-Wimplicit-function-declaration]\n  if ((file = fdopen(pipeToParent[0], \"r\")) == NULL)\n              ^~~~~~\n              fopen\ninit.c:55:12: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n  if ((file = fdopen(pipeToParent[0], \"r\")) == NULL)\n            ^\n</code></pre>\n"}, {"tags": ["c", "recursion", "parameters", "parameter-passing"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1547588517, "post_id": 54207244, "comment_id": 95241108, "body": "In the second you <i>shadow</i> the global variable <code>c</code>, you have <i>two different and distinct</i> variables named <code>c</code> inside the function. And there is <i>no</i> way to access the global variable."}], "answers": [{"tags": [], "owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "is_accepted": true, "score": 7, "last_activity_date": 1547588556, "creation_date": 1547588556, "answer_id": 54207281, "question_id": 54207244, "link": "https://stackoverflow.com/questions/54207244/why-do-these-two-similar-recursive-c-codes-give-different-outputs/54207281#54207281", "title": "Why do these two similar recursive C-codes give different outputs?", "body": "<p>When you declare the parameter <code>int c</code> in the second <code>func</code>, it <a href=\"https://en.wikipedia.org/wiki/Variable_shadowing\" rel=\"noreferrer\">shadows</a> the global <code>c</code>, so all further changes within the scope of the function only apply to the local <code>c</code> instead of the global one.</p>\n"}], "owner": {"reputation": 79, "user_id": 10173282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCtCi.jpg?s=128&g=1", "display_name": "ripfreeworld", "link": "https://stackoverflow.com/users/10173282/ripfreeworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 54207281, "answer_count": 1, "score": 1, "last_activity_date": 1547588556, "creation_date": 1547588379, "question_id": 54207244, "link": "https://stackoverflow.com/questions/54207244/why-do-these-two-similar-recursive-c-codes-give-different-outputs", "title": "Why do these two similar recursive C-codes give different outputs?", "body": "<p>I've been thinking about it for hours...</p>\n\n<p>I try to explain it, but if you feel it's not clear, just try my codes...</p>\n\n<p>The first code follows i = 1,1,1,2,3,2,3,2,3, and c follows 0-->1-->2-->3.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint c = 0;\nvoid func (int a){\n    c = a + 1;\n    printf(\"%d\", c+100);\n    for (int i = 1; i &lt;= 3; i++)\n    {\n        printf(\"%d\", i );\n        if (c &lt;= 2){\n            func(c);\n        }\n    }\n}\nint main(int argc, const char *argv[]){\n    func(c);\n    return 0;\n}\n</code></pre>\n\n<p>The second code follows i = 1,1,1,2,3,2,1,2,3,3,1,2,3,2,1,1,2,3...(39 i in total), and c follows 0-->1-->2-->3-->2-->3-->2-->3.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint c = 0;\nvoid func (int c){\n    c = c + 1;\n    printf(\"%d\", c+100);\n    for (int i = 1; i &lt;= 3; i++)\n    {\n        printf(\"%d\", i );\n        if (c &lt;= 2){\n            func(c);\n        }\n    }\n}\nint main(int argc, const char *argv[]){\n    func(c);\n    return 0;\n}\n</code></pre>\n\n<p>The only difference is parameter in func(), namely \"void func (int a)\" and \"c = a + 1\".</p>\n\n<p>Could you explain the reason why in the first code the \"c\" behave as a global variable, but in the second code after \"c\" becomes 3 it can still jump back to 2 and lead to a further recursion. </p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["c#", "c", "dll", "native", "marshalling"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 790889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d25331cccf63649daacd0181f255c?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/790889/luca"}, "edited": false, "score": 0, "creation_date": 1547619921, "post_id": 54207641, "comment_id": 95248831, "body": "Thank you very much for your exhaustive and informative answer."}, {"owner": {"reputation": 53, "user_id": 790889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d25331cccf63649daacd0181f255c?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/790889/luca"}, "edited": false, "score": 0, "creation_date": 1547620456, "post_id": 54207641, "comment_id": 95249030, "body": "I just would like to ask you if you can elaborate a bit about my doubt about pointers. The struct modbus_t contains two pointers, so to my understanding when I save it on C# side I have two addresses to memory stored pointing to a part of memory that I have not allocated with AllocHGlobal, so I don\u2019t understand why it works. Why isn\u2019t it possible that that part of memory is reused by something else between calls?"}, {"owner": {"reputation": 12248, "user_id": 235660, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/98ef0371256aeebaa378d1acc31ff4a8?s=128&d=identicon&r=PG", "display_name": "Alois Kraus", "link": "https://stackoverflow.com/users/235660/alois-kraus"}, "reply_to_user": {"reputation": 53, "user_id": 790889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d25331cccf63649daacd0181f255c?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/790889/luca"}, "edited": false, "score": 0, "creation_date": 1547629452, "post_id": 54207641, "comment_id": 95252715, "body": "@Luca: The memory of the pointer in your outer structure is allocated by the modbus driver itself. It will be deallocated by modbus when you destroy the context. You do not own that memory because you did not allocate it. It is the responsibility of the driver to delete all nested substructures when you destroy the context after you are done with modbus things."}, {"owner": {"reputation": 53, "user_id": 790889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d25331cccf63649daacd0181f255c?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/790889/luca"}, "edited": false, "score": 0, "creation_date": 1547631799, "post_id": 54207641, "comment_id": 95254065, "body": "ok, so even between calls that part of memory that is not owned by &quot;me&quot; will be still reserved to the driver dll? What if I need two instances of the driver? In that case potentially nothing is preventing the second context to initialize its modbus_backend_t over the first, correct?  Sorry I clearly lack insight of how memory is managed, especially when it comes do dlls... any reference to educate myself about this topic would be much appreciated"}, {"owner": {"reputation": 12248, "user_id": 235660, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/98ef0371256aeebaa378d1acc31ff4a8?s=128&d=identicon&r=PG", "display_name": "Alois Kraus", "link": "https://stackoverflow.com/users/235660/alois-kraus"}, "reply_to_user": {"reputation": 53, "user_id": 790889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d25331cccf63649daacd0181f255c?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/790889/luca"}, "edited": false, "score": 0, "creation_date": 1547654717, "post_id": 54207641, "comment_id": 95267685, "body": "@Luca: That should be no problem since you can create as many modbus contexts as you want.These contexts should be independent and not interfere as long as you are talking to different devices."}], "tags": [], "owner": {"reputation": 12248, "user_id": 235660, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/98ef0371256aeebaa378d1acc31ff4a8?s=128&d=identicon&r=PG", "display_name": "Alois Kraus", "link": "https://stackoverflow.com/users/235660/alois-kraus"}, "is_accepted": true, "score": 1, "last_activity_date": 1547654766, "last_edit_date": 1547654766, "creation_date": 1547590391, "answer_id": 54207641, "question_id": 54207177, "link": "https://stackoverflow.com/questions/54207177/pass-complex-datastructures-from-c-to-native-dll/54207641#54207641", "title": "Pass complex datastructures from C# to native dll", "body": "<p>As long as you do not want to modify the data you can wrap the data as an void * or IntPtr safely. You allocate the data via AllocHGlobal which returns data from the local process heap via LocalAlloc which ultimately calls into RtlAllocateHeap. For C# that pointer is a black box and will never write or modify it. As long as you do not free data to early everything will be fine. </p>\n\n<p>The C programing rules apply: You need to manage memory manually and pay attention who owns the data and who is responsible to delete it.</p>\n\n<p>Problems can only arise if you try to map that pointer to managed classes which partially try to give access to some fields. Then you need to take care that the struct member alignment is the same as in the C header file and you need to get the offsets right for the data you want to skip. You can then cast the IntPtr to a C# struct as pointer with unsafe code which should just work if you got the offsets and alingment right. </p>\n\n<p>Things are completely different if C++ classes are part of the header file which contain STL datatypes. These things are not wrappable at all since the member alignment depends on the shipped STL version with your current compiler which imposes a tight contract between private member fields which can change between C++/STL versions. For that you would need a C wrapper which wraps helper methods as plain C methods with the usual structures which internally calls then the C++ methods. Managed C++ is a rather dated technology and should not be used anymore. </p>\n\n<p>To sum it up: Your current approach is fine and will work. It will become more work if you want to access modify the data from the byte blob but that is also doable once you know how to declare wrapper structures in C# which contain only primitive types (no strings, dictionaries or pointers to managed heap structures.</p>\n"}], "owner": {"reputation": 53, "user_id": 790889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d25331cccf63649daacd0181f255c?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/790889/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 54207641, "answer_count": 1, "score": 2, "last_activity_date": 1547654766, "creation_date": 1547588098, "question_id": 54207177, "link": "https://stackoverflow.com/questions/54207177/pass-complex-datastructures-from-c-to-native-dll", "title": "Pass complex datastructures from C# to native dll", "body": "<p>I'm calling a third party library written in C from a NetCore application.\nThe problem is that in order to use this library, I first need to make a call and configure a complex struct that must later be passed to all subsequent calls.</p>\n\n<pre><code>void createCtx(modbus_t ** ctx)\n{\n    *ctx = modbus_new_tcp(\"192.168.1.175\", 502);\n\n    //configure the context here ....\n\n    int res = modbus_connect(*ctx);\n}\n\nint pollData(modbus_t * ctx)\n{\n    //....\n    modbus_read_bits(ctx, addr, 1, tab_rp_bits);\n    //....\n}\n</code></pre>\n\n<p>My approach would be to create the modbus_t object on the caller application (C#), configure it by calling createCtx once and then pass it to pollData at regular intervals.\nI've read about StructLayout but since I don't need to access the data in the modbusContext object I would just like to reserve a chunk of memory for the context and let C# be oblivious of what's inside.</p>\n\n<p>This is what I've come up with</p>\n\n<pre><code>static IntPtr modbusContext;\n\nstatic class ModbusDriver\n{\n            [DllImport(\"modbusdriver\",EntryPoint = \"createCtx\")]\n\n            public static extern void CreateCtx(ref IntPtr modbusContext);\n\n            [DllImport(\"modbusdriver\",EntryPoint = \"pollData\")]\n\n            public static extern uint PollData(IntPtr modbusContext)\n\n        }\n\n\n        static void Main(string[] args)\n        {\n            int ctxSize = ModbusDriver.GetCtxSize();\n\n            modbusContext = Marshal.AllocHGlobal(80 * Marshal.SizeOf(typeof(byte))); //&lt;--- 80 is the result of sizeof(modbus_t)\n            ModbusDriver.CreateCtx(ref modbusContext);\n\n            while(true)\n            {\n                ModbusDriver.PollData(modbusContext);\n                Thread.Sleep(1000);\n            }\n        }\n    }\n</code></pre>\n\n<p>All this seems to work, but it doesn't really feel right, especially because the modbus_t structure is quite complex</p>\n\n<pre><code>struct modbus_t {\n    /* Slave address */\n    int slave;\n    /* Socket or file descriptor */\n    int s;\n    int debug;\n    int error_recovery;\n    struct timeval response_timeout;\n    struct timeval byte_timeout;\n    struct timeval indication_timeout;\n    const modbus_backend_t *backend;\n    void *backend_data;\n};\n\ntypedef struct _modbus_backend {\n    unsigned int backend_type;\n    unsigned int header_length;\n    unsigned int checksum_length;\n    unsigned int max_adu_length;\n    int (*set_slave) (modbus_t *ctx, int slave);\n    int (*build_request_basis) (modbus_t *ctx, int function, int addr,\n                                int nb, uint8_t *req);\n    int (*build_response_basis) (sft_t *sft, uint8_t *rsp);\n    int (*prepare_response_tid) (const uint8_t *req, int *req_length);\n    int (*send_msg_pre) (uint8_t *req, int req_length);\n    ssize_t (*send) (modbus_t *ctx, const uint8_t *req, int req_length);\n    int (*receive) (modbus_t *ctx, uint8_t *req);\n    ssize_t (*recv) (modbus_t *ctx, uint8_t *rsp, int rsp_length);\n    int (*check_integrity) (modbus_t *ctx, uint8_t *msg,\n                            const int msg_length);\n    int (*pre_check_confirmation) (modbus_t *ctx, const uint8_t *req,\n                                   const uint8_t *rsp, int rsp_length);\n    int (*connect) (modbus_t *ctx);\n    void (*close) (modbus_t *ctx);\n    int (*flush) (modbus_t *ctx);\n    int (*select) (modbus_t *ctx, fd_set *rset, struct timeval *tv, int msg_length);\n    void (*free) (modbus_t *ctx);\n} modbus_backend_t;\n</code></pre>\n\n<p>So my question is, is my approach correct?\nSpecifically, modbus_t contains pointers. I managed to retain the modbus_t struct in C# and it seems to work, but is it really safe to assume that the memory referenced by the pointers contained in the struct will not be corrupted between calls? It doesn't feel right.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 682, "user_id": 5436259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84f0035c8c02b5ca04d3675ff63f3937?s=128&d=identicon&r=PG&f=1", "display_name": "infinitezero", "link": "https://stackoverflow.com/users/5436259/infinitezero"}, "edited": false, "score": 9, "creation_date": 1547587194, "post_id": 54206923, "comment_id": 95240575, "body": "Please state what your problem is."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 4, "creation_date": 1547587491, "post_id": 54206923, "comment_id": 95240687, "body": "I think the point of a book that&#39;s supposed to teach you C is that you try the code out and go through the process of debugging it, rather than just asking what&#39;s wrong online. If you did try anything, then you should share that in the question. Show us your debugging steps and error messages or bad output you encountered."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 2, "creation_date": 1547588541, "post_id": 54206923, "comment_id": 95241119, "body": "Nothing is wrong with that code. Unless you tell us what this code is supposed to do which it isn&#39;t doing, there is nothing wrong with it. One thing that <b>might</b> be wrong with it (just guessing) is that <code>printf</code> is not starting a new line unless you tell it to do so, so the last two prints print on the same single line. If <code>printf</code> is supposed to start a new line, it requires you to print a newline character (<code>&quot;\\n&quot;</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 5, "last_activity_date": 1547587072, "creation_date": 1547587072, "answer_id": 54206945, "question_id": 54206923, "link": "https://stackoverflow.com/questions/54206923/what-is-wrong-with-this-code-this-code-is-from-a-book-about-learning-c/54206945#54206945", "title": "What is wrong with this Code? This Code is from a Book about learning C", "body": "<p>It's a typo:</p>\n\n<p>Instead of </p>\n\n<pre><code>scanf(\"&amp;lf\", &amp;price);\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>scanf(\"%lf\", &amp;price);\n</code></pre>\n\n<p>And instead of </p>\n\n<pre><code>printf(\"Price &amp;lf Dollar\", price);\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>printf(\"Price %lf Dollar\", price);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10919139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54206945, "answer_count": 1, "score": 0, "last_activity_date": 1547589275, "creation_date": 1547586983, "last_edit_date": 1547588932, "question_id": 54206923, "link": "https://stackoverflow.com/questions/54206923/what-is-wrong-with-this-code-this-code-is-from-a-book-about-learning-c", "title": "What is wrong with this Code? This Code is from a Book about learning C", "body": "<p>I'm new to C and as I mentioned above there is a problem in the Code and I don't know what causes this problem. This is not my Code the Code is from a Book about C.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    /* Declaration */\n    int amount;\n    double price;\n\n    /* Input 1 */\n    printf(\"Amount: \");\n    scanf(\"%d\", &amp;amount);\n\n    /* Input 2 */\n    printf(\"Price in Dollar: \");\n    scanf(\"&amp;lf\", &amp;price);\n\n    /* Print */\n    printf(\"Amount: &amp;d\", amount);\n    printf(\"Price &amp;lf Dollar\", price);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1547586105, "post_id": 54206724, "comment_id": 95240125, "body": "what are the sources of <code>attack()</code> <code>receiveAttack()</code> <code>printPlayer()</code> and <code>newPlayer()</code> ? at which <i>exactly</i> line does the seg failt occur? You can even get to that information using printf...."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1547586202, "post_id": 54206724, "comment_id": 95240163, "body": "That&#39;s <code>LOSER</code>, not <code>LOOSER</code>, by the way."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1547586380, "post_id": 54206724, "comment_id": 95240239, "body": "Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us, including the functions (or shortened down versions of them, not forgetting <code>newPlayer</code>). Also please try to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">debug your program</a>, at the very least try to locate when and where the crash happens (and tell us about it). Lastly please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1547586751, "post_id": 54206724, "comment_id": 95240399, "body": "&quot;<i>My tests show that is the p-&gt;action</i>&quot; that means <i>p</i> contains a non valid address. Look at <i>valgrind</i> to find your problem"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1547588781, "post_id": 54206724, "comment_id": 95241206, "body": "When <code>p-&gt;action == NOTHING</code> this executes: <code>else{ p-&gt;action = WAIT;}</code> so is the <code>struct</code> set up correctly for this state change?"}, {"owner": {"reputation": 448, "user_id": 10839242, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e-JvFSR3BW8/AAAAAAAAAAI/AAAAAAAAAEU/XRiM53wwxL0/photo.jpg?sz=128", "display_name": "Louis Singer", "link": "https://stackoverflow.com/users/10839242/louis-singer"}, "edited": false, "score": 0, "creation_date": 1547589134, "post_id": 54206724, "comment_id": 95241349, "body": "I add some code and an execution instance. You can also look at the git repo for the sources. I&#39;ll look for Valgrind. The <code>action</code> member is initialized at ATTACK or WAIT (it depends which player plays first). Thanks to all of you."}], "answers": [{"comments": [{"owner": {"reputation": 10586, "user_id": 170383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d9f7a30948dca1bbd05eaf27f277ae6?s=128&d=identicon&r=PG", "display_name": "David R Tribble", "link": "https://stackoverflow.com/users/170383/david-r-tribble"}, "edited": false, "score": 0, "creation_date": 1547589872, "post_id": 54207467, "comment_id": 95241659, "body": "Declaring <code>msg[]</code> as only two chars wide is just asking for trouble, especially since it&#39;s on the stack. If you must use <code>scanf()</code>, at least declare it to be something safer, such as <code>msg[80+1]</code>."}, {"owner": {"reputation": 448, "user_id": 10839242, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e-JvFSR3BW8/AAAAAAAAAAI/AAAAAAAAAEU/XRiM53wwxL0/photo.jpg?sz=128", "display_name": "Louis Singer", "link": "https://stackoverflow.com/users/10839242/louis-singer"}, "edited": false, "score": 0, "creation_date": 1547624097, "post_id": 54207467, "comment_id": 95250444, "body": "Okay I replace my <code>bzero</code> and it works!  thanks! But I have one more question: when use <code>bzero</code>?"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 448, "user_id": 10839242, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e-JvFSR3BW8/AAAAAAAAAAI/AAAAAAAAAEU/XRiM53wwxL0/photo.jpg?sz=128", "display_name": "Louis Singer", "link": "https://stackoverflow.com/users/10839242/louis-singer"}, "edited": false, "score": 0, "creation_date": 1548469686, "post_id": 54207467, "comment_id": 95564642, "body": "@LouisSinger That is but a design choice with no strict triggers."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 2, "last_activity_date": 1547589460, "creation_date": 1547589460, "answer_id": 54207467, "question_id": 54206724, "link": "https://stackoverflow.com/questions/54206724/segmentation-fault-occurs-when-im-accessing-a-structs-member/54207467#54207467", "title": "Segmentation fault occurs when I&#39;m accessing a struct&#39;s member", "body": "<pre><code>char msg[2];\nbzero(msg, strlen(msg));\n</code></pre>\n\n<p>Okay, so here you try to calculate the length of an uninitialized string, a typical source of page faults (and kernel vulnerabilities). <code>strlen</code> does not know your array's size, it simply looks for a zero character and is likely to get out of your page very soon. Even if the program does not crash at this point, <code>bzero</code> will do the trick as it is likely to <em>write</em> memory out of your reach.</p>\n\n<p>Note that a cell is usually described with at least two characters (\"C4\" or so), so <code>scanf</code> will write the terminating zero character past the end of <code>msg</code> (again, this could be even out of your available memory). Increase <code>msg</code>'s size so that it can accommodate at least valid inputs (at least three chars, the more the better). And you don't need to call <code>strlen</code> here; if you want to pre-clear your array, the simplest way would be to initialize it properly: <code>char msg[256] = {'\\0'};</code>.</p>\n\n<p>Next, you haven't shown your <code>NewPlayer()</code>'s code, but your struct contains three pointer fields, please double-check they are allocated, and initialized, properly.</p>\n"}], "owner": {"reputation": 448, "user_id": 10839242, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e-JvFSR3BW8/AAAAAAAAAAI/AAAAAAAAAEU/XRiM53wwxL0/photo.jpg?sz=128", "display_name": "Louis Singer", "link": "https://stackoverflow.com/users/10839242/louis-singer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54207467, "answer_count": 1, "score": 0, "last_activity_date": 1547589460, "creation_date": 1547585943, "last_edit_date": 1547588857, "question_id": 54206724, "link": "https://stackoverflow.com/questions/54206724/segmentation-fault-occurs-when-im-accessing-a-structs-member", "title": "Segmentation fault occurs when I&#39;m accessing a struct&#39;s member", "body": "<p>A <code>segmentation fault</code> occurs when I want to access or modify the value of a struct member in C programming language.</p>\n\n<p>I actually write a battleship networked game in C language (it is a student project). I have a structure named <code>Player</code>:</p>\n\n<pre><code>enum state{PLAYING = 0, WINNER = 1, LOOSER = 2};\nenum action{ATTACK = 1, WAIT = 0, NOTHING = -1};\ntypedef struct Player Player;\nstruct Player\n{\n    enum action action;\n    enum state state;\n    char name[25];\n    int isFirstPlayer;\n    Client* client;\n    Server* server;\n    Boards* boards;\n};\n</code></pre>\n\n<p>the main function.</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    if(argc &lt; 2)\n    {\n        errorUsage();\n    }\n\n    // Initialise player\n    Player player = newPlayer();\n    // I removed the network initialization here.\n\n    // play game\n    play_game(&amp;player);\n}\n</code></pre>\n\n<p>the <code>segmentation fault</code> occurs in the function <code>play_game(Player* p)</code>:</p>\n\n<pre><code>void attack(Player* p)\n{\n    char msg[2];\n    bzero(msg, strlen(msg));\n    printf(\"Where do you want to fire?\");\n    scanf(\"%s\", msg);\n\n    while(verifyEntryAttack(msg) != 1)\n    {\n        printf(\"ERROR Entry:\\nFormat = A4, C9, ...\\nColumns = A B C D E F G H I J\\nRows = 0 1 2 3 4 5 6 7 8 9\\n\");\n        printf(\"please try again: \");\n        scanf(\"%s\", msg);\n    }\n    sendData(p, msg);\n    Box my_attack_box;\n    my_attack_box.abs = msg[0];\n    my_attack_box.ord = msg[1]-'0';\n    updateMarkBoard(p, my_attack_box);\n}\n\nvoid receiveAttack(Player* p)\n{\n    char received_attack[2];\n    receiveData(p, received_attack);\n    printf(\"I have received the attack: %s\\n\", received_attack);\n    Box my_attack_box;\n    my_attack_box.abs = received_attack[0];\n    my_attack_box.ord = received_attack[1]-'0';\n    endureAttack(my_attack_box, p);\n}\n\nvoid play_game(Player* p)\n{\n    while(p-&gt;state == PLAYING){\n        printPlayer(p); //print the game boards.\n        if(p-&gt;action == ATTACK){\n            printf(\"Your turn to attack.\\n\");\n            attack(p); //attack the ennemy\n            printf(\"end of attack turn.\\n\");\n        } else if(p-&gt;action == WAIT){\n            printf(\"wait for an attack...\\n\");\n            receiveAttack(p); //receive the attack from the ennemy.\n            printf(\"end of waiting turn.\\n\");\n        }\n\n        if(p-&gt;action == WAIT){\n            p-&gt;action = ATTACK;\n        } \n        else{\n            p-&gt;action = WAIT;\n        }\n    }\n}\n</code></pre>\n\n<p>After one turn in the while loop, the program says \"segmentation fault\". My tests show that is the <code>p-&gt;action</code> which is the problem.</p>\n\n<p>See below the program output that shows the problem: <a href=\"https://i.stack.imgur.com/BLGtk.png\" rel=\"nofollow noreferrer\">outputs screenshot</a>.\nThe entire code is available here: <a href=\"https://gitlab.com/RicodeL/battlesheep\" rel=\"nofollow noreferrer\">GitLab repo link</a>.\nIt's like my program can't access the <code>action</code> member of my player.</p>\n\n<p>Does anyone have any ideas?</p>\n"}, {"tags": ["c", "scheduler", "freertos"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1547585970, "post_id": 54206614, "comment_id": 95240074, "body": "Google &quot;<b>preemptive multitasking</b>&quot;. From the <a href=\"https://en.wikipedia.org/wiki/FreeRTOS#Key_features\" rel=\"nofollow noreferrer\">wikipedia page</a>: <i>&quot;Scheduler can be configured for both preemptive or cooperative operation.&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5636628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uTJLfELvLqk/AAAAAAAAAAI/AAAAAAAAABU/tRE-LR42Xfc/photo.jpg?sz=128", "display_name": "Upgrade", "link": "https://stackoverflow.com/users/5636628/upgrade"}, "edited": false, "score": 0, "creation_date": 1547591578, "post_id": 54207024, "comment_id": 95242279, "body": "Great. One more thing, how does the alocation of variables before loop affects the for loop, when scheduler &quot;restart&quot; the task? Thanks"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 35, "user_id": 5636628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uTJLfELvLqk/AAAAAAAAAAI/AAAAAAAAABU/tRE-LR42Xfc/photo.jpg?sz=128", "display_name": "Upgrade", "link": "https://stackoverflow.com/users/5636628/upgrade"}, "edited": false, "score": 0, "creation_date": 1547591680, "post_id": 54207024, "comment_id": 95242318, "body": "it does not matter. it is just normal function. Standard C rules."}, {"owner": {"reputation": 35, "user_id": 5636628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uTJLfELvLqk/AAAAAAAAAAI/AAAAAAAAABU/tRE-LR42Xfc/photo.jpg?sz=128", "display_name": "Upgrade", "link": "https://stackoverflow.com/users/5636628/upgrade"}, "edited": false, "score": 0, "creation_date": 1547593264, "post_id": 54207024, "comment_id": 95242840, "body": "Does that mean that I am overriding the values of the variable that was saved before task switching?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 35, "user_id": 5636628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uTJLfELvLqk/AAAAAAAAAAI/AAAAAAAAABU/tRE-LR42Xfc/photo.jpg?sz=128", "display_name": "Upgrade", "link": "https://stackoverflow.com/users/5636628/upgrade"}, "edited": false, "score": 0, "creation_date": 1547598635, "post_id": 54207024, "comment_id": 95244050, "body": "No because you never exit the function. The task is all the time the same"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1547589677, "last_edit_date": 1547589677, "creation_date": 1547587495, "answer_id": 54207024, "question_id": 54206614, "link": "https://stackoverflow.com/questions/54206614/stopping-and-starting-an-task/54207024#54207024", "title": "Stopping and Starting an task", "body": "<p>The tasks have their own stacks so the local variables values are retained.</p>\n\n<p>RTOSes work completely different way than the \"normal\" OS-es.</p>\n\n<p>If there is only one task with the highest priority (and many others with the lower priorities) it has to give the control back to the system. It happens when the task enters the Suspended or Blocked state. Otherwise it will <strong>never</strong> be preempted. (Of course the interrupts will be triggered).</p>\n\n<p>As an example: if you start tasks <strong>A</strong> and <strong>B</strong> an the priority of the task <strong>A</strong> is higher then <strong>B</strong> if the task <strong>A</strong> will not give control back to the system by entering the Suspended or Blocked state (for example by waiting for the notification, semaphore, mutex or something else) the task <strong>A</strong> will have 100% of the execution time and the task <strong>B</strong> 0% (zero)</p>\n\n<p>If there are more than one task with the same highest priority the round robin preemption will happen. It is anyway very uncommon situation in the embedded RTOS development. </p>\n"}], "owner": {"reputation": 35, "user_id": 5636628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uTJLfELvLqk/AAAAAAAAAAI/AAAAAAAAABU/tRE-LR42Xfc/photo.jpg?sz=128", "display_name": "Upgrade", "link": "https://stackoverflow.com/users/5636628/upgrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 54207024, "answer_count": 1, "score": 0, "last_activity_date": 1547589677, "creation_date": 1547585482, "question_id": 54206614, "link": "https://stackoverflow.com/questions/54206614/stopping-and-starting-an-task", "title": "Stopping and Starting an task", "body": "<p>So. It is an abstract question.<br>\nWhile learning about FreeRTOS I got stuck in some problems. </p>\n\n<p>As an background, I tried to blink a led from a function, and it blinks regarding if it is inside for(;;) or outside, which somewhat is not adding up with the fact that a task is running only inside for(;;) loop after initialization/first run through it.</p>\n\n<p>Trying to be as clear as posible:</p>\n\n<blockquote>\n  <p>Task functions should never return so are typically implemented as a continuous loop.</p>\n</blockquote>\n\n<p>An task is defined as:</p>\n\n<pre><code>void vATaskFunction( void *pvParameters )\n{\n    for( ;; )\n    {\n        -- Task application code here. --\n    }\n\n    /* Tasks must not attempt to return from their implementing\n    function or otherwise exit.  In newer FreeRTOS port\n    attempting to do so will result in an configASSERT() being\n    called if it is defined.  If it is necessary for a task to\n    exit then have the task call vTaskDelete( NULL ) to ensure\n    its exit is clean. */\n    vTaskDelete( NULL );\n}\n</code></pre>\n\n<p>Knowing that, my question is: </p>\n\n<ul>\n<li>If a task is an infinite loop, how does the scheduler suspends it (switch to another task)?</li>\n<li>What happens to current values inside the local variables?</li>\n<li>While switching back to our task, does the task jumps directly inside the for(;;) loop, or goes normally through the function, as normal?</li>\n</ul>\n"}, {"tags": ["python", "c", "arrays", "list", "swig"], "comments": [{"owner": {"reputation": 1194, "user_id": 4782513, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2834b0654459b57ca36c59d90e1848?s=128&d=identicon&r=PG&f=1", "display_name": "newkid", "link": "https://stackoverflow.com/users/4782513/newkid"}, "edited": false, "score": 0, "creation_date": 1547638220, "post_id": 54206438, "comment_id": 95257762, "body": "Could you kindly share in pseudo code what it is that you intended to achieve in python and what your c file and interface file looks like?"}, {"owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "reply_to_user": {"reputation": 1194, "user_id": 4782513, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2834b0654459b57ca36c59d90e1848?s=128&d=identicon&r=PG&f=1", "display_name": "newkid", "link": "https://stackoverflow.com/users/4782513/newkid"}, "edited": false, "score": 0, "creation_date": 1548423686, "post_id": 54206438, "comment_id": 95546662, "body": "Does the edit help???"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "edited": false, "score": 0, "creation_date": 1547633792, "post_id": 54206582, "comment_id": 95255301, "body": "Maybe I was not clear or I didn&#39;t understand you&#39;re answer... My point is not with C but rather on what is the object I should pass from python. How should I call from python a function that create in C my struct? I do not even need to allocate a[0] and a[1] since if I know their size i nC I&#39;m perfectly able to navigate them without storinng more memory..."}], "tags": [], "owner": {"reputation": 1194, "user_id": 4782513, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ca2834b0654459b57ca36c59d90e1848?s=128&d=identicon&r=PG&f=1", "display_name": "newkid", "link": "https://stackoverflow.com/users/4782513/newkid"}, "is_accepted": false, "score": 0, "last_activity_date": 1547591903, "last_edit_date": 1547591903, "creation_date": 1547585312, "answer_id": 54206582, "question_id": 54206438, "link": "https://stackoverflow.com/questions/54206438/how-to-pass-from-python-to-c-a-list-of-differently-sized-arrays/54206582#54206582", "title": "How to pass from python to C a list of differently sized arrays?", "body": "<p>To do this you need an interface helper function. See <a href=\"http://www.swig.org/Doc1.3/SWIG.html#SWIG_nn26\" rel=\"nofollow noreferrer\">reference</a></p>\n\n<pre><code>    // Some array helpers\n%inline %{\n  /* Create any sort of [size] array */\n  int *int_array(int size) {\n     return (int *) malloc(size*sizeof(int));\n  }\n  /* Create a two-dimension array [size][10] */\n  int (*int_array_10(int size))[10] {\n     return (int (*)[10]) malloc(size*10*sizeof(int));\n  }\n%}\n</code></pre>\n\n<p>Also, your <code>a</code> needs to be a jagged array like this:</p>\n\n<pre><code>double *a[100];\n\na[0] = malloc(sizeof(double) * N1);\na[1] = malloc(sizeof(double) * N2);\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8721540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72feeb311b74a06d2525a26a635c6621?s=128&d=identicon&r=PG&f=1", "display_name": "acini", "link": "https://stackoverflow.com/users/8721540/acini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548423646, "creation_date": 1547584547, "last_edit_date": 1548423646, "question_id": 54206438, "link": "https://stackoverflow.com/questions/54206438/how-to-pass-from-python-to-c-a-list-of-differently-sized-arrays", "title": "How to pass from python to C a list of differently sized arrays?", "body": "<p>In python (3.5) I have a list of N arrays each of different size. For N=2 for ex.:</p>\n\n<pre><code>v = [ np.array((0., 2., 4.)), np.array((0., 3.)) ]\n</code></pre>\n\n<p>Where N itself is not fixed.\nFrom C I would like to access the n-th element of the i-th element of the list, e.g. v[0][1] = 2. .\nAs interface from python to C I'm using SWIG.</p>\n\n<p>In C I have a structure like:</p>\n\n<pre><code>struct timestamps\n  {\n     int N;\n     double **a;\n     int *lengths;\n  };\n</code></pre>\n\n<p>Where N is the number of elements in the list. \nI would like a to be an array of N places each containing the pointer to the n-th array of the original list. And lenghts to be an array of N places each containing the length of the n-th array of the original list.</p>\n\n<p>For ex. in C I have a function that simply prints the value of the elements I want to access:</p>\n\n<pre><code>void print (int N, double **a, int *lenghts) {\n    int i, j;\n    struct timestamps T;\n    T.N = N;\n    T.a = a;\n    T.lenghts = lenghts;\n    for ( i = 0; i &lt; T.N; i++ ) {\n        for (j = 0, j &lt; T.lenghts[i]; j++ ) {\n            printf(\"%lf\\t\", *(T.a[i] + j));\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>I would like to call print from python script and obtain the output:</p>\n\n<pre><code>0.  2.  4.\n0.  3.\n</code></pre>\n\n<p>My problem is that the native object is a list of numpy array that was created in python. \nWhat's the best way to do it? (I've done a couple of attempt but they're all \"c - based\" in nthe sense that I tried to create an array of pointer in python as I would have done in C but had no success)</p>\n\n<p>Thank you so much I was really not able to find any \"easy to understand for C person\" reference...</p>\n"}, {"tags": ["c", "casting", "pic", "xc8"], "comments": [{"owner": {"reputation": 135, "user_id": 2057576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d548f6e4698f98517121224c1fbd7c77?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2057576/andy"}, "edited": false, "score": 0, "creation_date": 1547581815, "post_id": 54205885, "comment_id": 95238410, "body": "A note from the MPLAB documentation on shifting signed values:  If the operand is SIGNED, a shift right performs an ARITHMETIC shift right, in which the vacant bits are filled with whatever the value of the most significant bit was before the shift. This is done to perform a sign extend when working with signed binary values"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547581966, "post_id": 54205885, "comment_id": 95238474, "body": "shifting signed numbers is a can of worms. divide by 256."}, {"owner": {"reputation": 135, "user_id": 2057576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d548f6e4698f98517121224c1fbd7c77?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2057576/andy"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547582430, "post_id": 54205885, "comment_id": 95238677, "body": "The documentation would seem to indicate that there wouldn&#39;t be problem with the right shift. There is the same 8 bit shift happening with the signed 16 bit which is working, yet with the signed 32 bit it&#39;s not..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547587683, "post_id": 54205885, "comment_id": 95240758, "body": "Is <code>SERIAL_WRITE()</code> properly declared before  <code>MOVING_AVERAGE_ADC()</code> calls it?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547588107, "post_id": 54205885, "comment_id": 95240933, "body": "Why does the &quot;fixed&quot; one change <code>USARTRxLSB = 7</code> to <code>USARTRxLSB = 6</code>?"}, {"owner": {"reputation": 135, "user_id": 2057576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d548f6e4698f98517121224c1fbd7c77?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2057576/andy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547589209, "post_id": 54205885, "comment_id": 95241389, "body": "@chux, I&#39;ve edited to change both to 6. In the full code USARTRxLSB is read in from a serial input (after validating the value). I&#39;ve just used 6 as an example here. SERIAL_WRITE is indeed properly defined prior"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547591328, "post_id": 54205885, "comment_id": 95242178, "body": "Andy, &quot;You can see the spikes where an overflow(?) has occurred in the raw data values on the right hand axis&quot; ---&gt; To be clear, the ADC is the red (hard to see) or the white?  As red, the problem is certainly on some ADC value near 16K which hints to an issue with  <code>*4</code>.  You mentioned valid ADC values, good, but what range of values occur?  If ADC is 0 to 64K-1 or so, I&#39;d stick with unsigned math for the conditioning.  Yet I still do not see the code fault - I smell a compiler bug.  (Oh, is SERIAL_WRITE a macro? - if so, please post)."}, {"owner": {"reputation": 5566, "user_id": 530160, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xRnFS.jpg?s=128&g=1", "display_name": "Nick ODell", "link": "https://stackoverflow.com/users/530160/nick-odell"}, "edited": false, "score": 0, "creation_date": 1547592117, "post_id": 54205885, "comment_id": 95242467, "body": "Why compute a rolling average? If I&#39;m understanding this right, you take six sensor readings all at once. Why not average them the normal way?"}, {"owner": {"reputation": 828, "user_id": 10085080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79e26083ea7b8473578d079ecc11c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Dan1138", "link": "https://stackoverflow.com/users/10085080/dan1138"}, "edited": false, "score": 0, "creation_date": 1547606557, "post_id": 54205885, "comment_id": 95245601, "body": "I cannot see what the code you posted accomplishes but whatever it does it is NOT A MOVING AVERAGE. Should you like to see code that does a moving average of ADC readings using a PIC please specify the target part number you need an example for."}, {"owner": {"reputation": 135, "user_id": 2057576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d548f6e4698f98517121224c1fbd7c77?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2057576/andy"}, "edited": false, "score": 0, "creation_date": 1547618367, "post_id": 54205885, "comment_id": 95248324, "body": "Readings are for separate channels. It IS a moving average, just an exponentially weighted one."}, {"owner": {"reputation": 135, "user_id": 2057576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d548f6e4698f98517121224c1fbd7c77?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2057576/andy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1547622969, "post_id": 54205885, "comment_id": 95249956, "body": "@chux It is indeed the red line. I&#39;ve edited my post to include a snapshot of when it is working - you see values are around 16140. ADCOutput is -32768 to 32767. I&#39;ve also included the full SERIAL_WRITE functon"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1547623208, "post_id": 54205885, "comment_id": 95250059, "body": "Why not work with a union?"}, {"owner": {"reputation": 828, "user_id": 10085080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79e26083ea7b8473578d079ecc11c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Dan1138", "link": "https://stackoverflow.com/users/10085080/dan1138"}, "edited": false, "score": 0, "creation_date": 1547752440, "post_id": 54205885, "comment_id": 95309937, "body": "The code you posted evaluates this expression: <code>Fo = ( (Fo * 4 - Fo) + Fi ) &#47; 4</code> There are issues when this is evaluated using integer arithmetic. When <code>Fi-Fo</code> is <code>&gt; 0</code> and <code>&lt; 4</code> then <code>Fo</code> does not change, when <code>Fi-Fo</code> is <code>&lt; 0</code> and <code>&gt; -4</code> then <code>F0</code> decrements by 1. I do not know what kind of filter this is but it&#39;s not any kind of moving average I&#39;m familiar with."}], "owner": {"reputation": 135, "user_id": 2057576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d548f6e4698f98517121224c1fbd7c77?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2057576/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1547622622, "creation_date": 1547581721, "last_edit_date": 1547622622, "question_id": 54205885, "link": "https://stackoverflow.com/questions/54205885/problems-implicitly-casting-a-signed-long-with-bitshift-into-an-unsigned-8-bit-v", "title": "Problems implicitly casting a signed long with bitshift into an unsigned 8 bit value", "body": "<p>I'm having a problem with incorrect uint8 values after passing a signed long to a function. You can see the spikes where an overflow(?) has occurred in the raw data values on the right hand axis</p>\n\n<p><a href=\"https://i.stack.imgur.com/pXi4w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pXi4w.png\" alt=\"enter image description here\"></a> </p>\n\n<p>I'm writing this for PIC using MPLABX 5.0 and the XC8 compiler. A simplified version of my code is below:</p>\n\n<pre><code>int16_t ADCOutput[6];\nsigned long ADCOutputAvg[6];\nuint8_t USARTRxLSB = 6;\n\nvoid MOVING_AVERAGE_ADC(void)                                       \n{\n        READ_ADC();\n        for ( int i = 0 ; i &lt; 6 ; ++i)                            \n        {\n            ADCOutputAvg[i] = (ADCOutputAvg[i]*4) - ADCOutputAvg[i];\n            ADCOutputAvg[i] += ADCOutput[i];\n            ADCOutputAvg[i] = ADCOutputAvg[i] /4;\n\n\n        }\nSERIAL_WRITE(0x45,(ADCOutputAvg[(USARTRxLSB-1)]&gt;&gt;8), (ADCOutputAvg[(USARTRxLSB-1)]));\n}\n</code></pre>\n\n<p>SERIAL_WRITE is the function:</p>\n\n<pre><code>    void SERIAL_WRITE(uint8_t Control, uint8_t MSB, uint8_t LSB)\n{\n    uint8_t Checksum = 0;\n    Checksum = NextHeader ^ Control ^ MSB ^ LSB;            \n    EUSART1_Write(NextHeader);                          \n    EUSART1_Write(Control);                             \n    EUSART1_Write(MSB);                                \n    EUSART1_Write(LSB);                                 \n    EUSART1_Write(Checksum);                                \n    if(NextHeader == 0x5A)                              \n    {\n        NextHeader = 0xA5;                              \n    }\n    else\n    {\n        NextHeader = 0x5A;          \n    }\n\n}\n</code></pre>\n\n<p>I have managed to fix it by modifying it as follows:</p>\n\n<pre><code>int16_t ADCOutput[6];\nsigned long ADCOutputAvg[6];\nuint8_t USARTRxLSB = 6;\nint16_t ADCOutputAvgHolder[6];\n\nvoid MOVING_AVERAGE_ADC(void)                                       \n{\n        READ_ADC();\n        for ( int i = 0 ; i &lt; 6 ; ++i)                            \n        {\n            ADCOutputAvg[i] = (ADCOutputAvg[i]*4) - ADCOutputAvg[i];\n            ADCOutputAvg[i] += ADCOutput[i];\n            ADCOutputAvg[i] = ADCOutputAvg[i] /4;\n            ADCOutputAvgHolder[i] = (int16_t) ADCOutputAvg[i];\n\n        }\nSERIAL_WRITE(0x45,(ADCOutputAvgHolder[(USARTRxLSB-1)]&gt;&gt;8), (ADCOutputAvgHolder[(USARTRxLSB-1)]));\n}\n</code></pre>\n\n<p>This now gives the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h70Hg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h70Hg.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem is, I don't understand how it has fixed it. In the first instance I have a 32 bit signed integer (which is only ever 16 bits max; it had to go into a 32 bit due to the multiplication on it, but this is later negated with division), which is bitshifted eight right and then implicitly cast into a uint8_t. </p>\n\n<p>The second version has a 32 bit integer, which is explicitly cast into an int16_t, which is then bitshifted eight right and then implicitly cast into a uint8_t. What is different in these methods that give different results?</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 1, "creation_date": 1547581659, "post_id": 54205383, "comment_id": 95238337, "body": "Your code give the expected output when I run it on my machine.  You will need to give some more details about your setup (os, mpi version) to help find the problem"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1547626602, "post_id": 54205383, "comment_id": 95251375, "body": "does it say &#39;rank X out of 24 processors&#39; ? try <code>mpiexec -n 4 .&#47;mpi_hello_world</code> and/or <code>mpirun -np 4 .&#47;mpi_hello_world</code>."}, {"owner": {"reputation": 25, "user_id": 10918658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af2856a3ea3cb12840056335b1cdf76?s=128&d=identicon&r=PG&f=1", "display_name": "dfrw4r3", "link": "https://stackoverflow.com/users/10918658/dfrw4r3"}, "reply_to_user": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 0, "creation_date": 1547668218, "post_id": 54205383, "comment_id": 95274486, "body": "@ptb updated the question."}, {"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 0, "creation_date": 1547676876, "post_id": 54205383, "comment_id": 95278347, "body": "Your code is fine but something is wrong with the mpi/os/scheduler setup.  I would suggest talking to your cluster admin.  To gather more data points, you could find and run an mpi test suite for the implementation you are using."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1547692717, "post_id": 54205383, "comment_id": 95282084, "body": "which MPI library (vendor &amp; version) ? are you runing under a batch manager ? which one ? can you copy/paste both your command line and (trimmed) output ? <code>np - 36</code> does not make sense here, it would be <code>mpirun -np 36 .&#47;mpi_hello_world</code>."}], "owner": {"reputation": 25, "user_id": 10918658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af2856a3ea3cb12840056335b1cdf76?s=128&d=identicon&r=PG&f=1", "display_name": "dfrw4r3", "link": "https://stackoverflow.com/users/10918658/dfrw4r3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547668184, "creation_date": 1547579425, "last_edit_date": 1547668184, "question_id": 54205383, "link": "https://stackoverflow.com/questions/54205383/output-from-more-processes-than-specified-in-arguments", "title": "Output from more processes than specified in arguments", "body": "<p>I am new to mpi and rerunning the code given here : <a href=\"http://mpitutorial.com/tutorials/mpi-hello-world/\" rel=\"nofollow noreferrer\">http://mpitutorial.com/tutorials/mpi-hello-world/</a></p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main(int argc, char** argv) {\n\n// Initialize the MPI environment\nMPI_Init(NULL, NULL);\n\n// Get the number of processes\nint world_size;\nMPI_Comm_size(MPI_COMM_WORLD, &amp;world_size);\n\n// Get the rank of the process\nint world_rank;\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;world_rank);\n\n// Get the name of the processor\nchar processor_name[MPI_MAX_PROCESSOR_NAME];\nint name_len;\nMPI_Get_processor_name(processor_name, &amp;name_len);\n\n// Print off a hello world message\nprintf(\"Hello world from processor %s, rank %d out of %d processors\\n\",\n       processor_name, world_rank, world_size);\n\n// Finalize the MPI environment.\nMPI_Finalize();\n}\n</code></pre>\n\n<p>Compiling that using <code>mpicc -o mpi_hello_world mpi_hello_world.c</code> and running <code>mpiexec -np 4 ./mpi_hello_world</code></p>\n\n<p>I expect similar results given on the webpage </p>\n\n<pre><code>Hello world from processor cetus2, rank 1 out of 4 processors\nHello world from processor cetus1, rank 0 out of 4 processors\nHello world from processor cetus4, rank 3 out of 4 processors\nHello world from processor cetus3, rank 2 out of 4 processors\n</code></pre>\n\n<p>But instead of getting output from 4 processes, I get from 24. It is something like this. </p>\n\n<pre><code>Hello world from processor cetus3, rank &lt;n&gt; out of 24 processors\n</code></pre>\n\n<p><code>n</code> is from 0 to 23. I am using linux cluster remotely. Similar result using <code>mpirun</code>. If I specify <code>np - 36</code>, I get the same result for 24 processes. Can someone tell what is going wrong?</p>\n"}, {"tags": ["c", "file", "data-structures", "uber-api"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1547577803, "post_id": 54205032, "comment_id": 95236768, "body": "Have you tried anything?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1547578087, "post_id": 54205032, "comment_id": 95236881, "body": "That really depends on the format of your file, if you don&#39;t have gaps between id&#39;s you can load the data into an array, in other case you need another type of data structure, i.e. a hashmap."}, {"owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "edited": false, "score": 0, "creation_date": 1547578335, "post_id": 54205032, "comment_id": 95236989, "body": "There&#39;s insufficient information for a meaningful answer - how many cities are there? What have you tried? Where exactly would the user be inputting the code?   If you&#39;re simply trying to relate a city to some integer code, some sort of <a href=\"https://en.wikipedia.org/wiki/Associative_array\" rel=\"nofollow noreferrer\">associative array</a> or map would be a good option."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1547578623, "post_id": 54205032, "comment_id": 95237102, "body": "Using some sort of database like sqlite instead of CSV files would be a good idea."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 9638875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b919e301f23579f368c52a9f11b4f2e4?s=128&d=identicon&r=PG&f=1", "display_name": "Duke", "link": "https://stackoverflow.com/users/9638875/duke"}, "is_accepted": false, "score": 0, "last_activity_date": 1547590465, "creation_date": 1547590465, "answer_id": 54207653, "question_id": 54205032, "link": "https://stackoverflow.com/questions/54205032/ubereats-system-in-c-file-handling/54207653#54207653", "title": "UberEats System in C - File Handling", "body": "<p>you could read the file and make a matrix of 2xno_cities, and when the user puts a number, you just do </p>\n\n<pre><code>array[input-given-by-user][1]\n</code></pre>\n\n<p>since the first [] would be for the row, and the second one for the column, which is where you save the cities, </p>\n"}], "owner": {"reputation": 25, "user_id": 10916803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d5e9d391222f9b304b3ac2e1c87a05d?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Cunha", "link": "https://stackoverflow.com/users/10916803/bruno-cunha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1547590465, "creation_date": 1547577728, "question_id": 54205032, "link": "https://stackoverflow.com/questions/54205032/ubereats-system-in-c-file-handling", "title": "UberEats System in C - File Handling", "body": "<p>So, i have a school project to build the uberEats management system in C.</p>\n\n<p>I have a csv file that contains the cities where the system is available and their respective code. Eg: 1, New York.</p>\n\n<p>And i need to read that file, so when the user inserts one code, it associates to the specific city. Can anyone help me how to do that?</p>\n"}, {"tags": ["c", "backtracking", "traveling-salesman"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1547577504, "post_id": 54204959, "comment_id": 95236621, "body": "<i>came into a wall</i> - is not a valid description of a problem in this context."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1547577588, "post_id": 54204959, "comment_id": 95236657, "body": "Please make an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Provide sample input, output, desired output and an explanation of what the &quot;wall&quot; is you have hit."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1547577653, "post_id": 54204959, "comment_id": 95236683, "body": "This code is really rough in terms of formatting. I&#39;ve tried to clean it up a little, but it&#39;s still a big jumble."}, {"owner": {"reputation": 1, "user_id": 10918523, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-32NhwIVh_E4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb8367qTQPraxSzRsWy9FTVrzdqSg/mo/photo.jpg?sz=128", "display_name": "Elad Par", "link": "https://stackoverflow.com/users/10918523/elad-par"}, "edited": false, "score": 0, "creation_date": 1547581540, "post_id": 54204959, "comment_id": 95238294, "body": "hey guys! thank you so much for the replies! as you see i&#39;m only at the beginning but Ill clean it up and edit my question thanks!"}, {"owner": {"reputation": 1, "user_id": 10918523, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-32NhwIVh_E4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb8367qTQPraxSzRsWy9FTVrzdqSg/mo/photo.jpg?sz=128", "display_name": "Elad Par", "link": "https://stackoverflow.com/users/10918523/elad-par"}, "edited": false, "score": 0, "creation_date": 1547620198, "post_id": 54204959, "comment_id": 95248924, "body": "I tried to clear it up . is it better?"}], "owner": {"reputation": 1, "user_id": 10918523, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-32NhwIVh_E4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb8367qTQPraxSzRsWy9FTVrzdqSg/mo/photo.jpg?sz=128", "display_name": "Elad Par", "link": "https://stackoverflow.com/users/10918523/elad-par"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547620570, "creation_date": 1547577381, "last_edit_date": 1547620570, "question_id": 54204959, "link": "https://stackoverflow.com/questions/54204959/tsp-problem-in-c-using-simple-backtracking-solution", "title": "TSP problem in C using simple backtracking Solution", "body": "<p>I was trying to solve the travel salesman program im stuck at the recursive part of moving from one city to another.</p>\n\n<p><strong>Sample input &amp; output:</strong></p>\n\n<pre><code>    Please enter the roads 4X4 matrix row by row:\n    0 2 -1 2\n    -1 0 2 -1\n    1 -1 0 2\n    2 1 -1 0\n    The shortest path is of length: 6\n</code></pre>\n\n<p><strong>Main Objective</strong></p>\n\n<p>each number at the matrice roads[N][N] (currently N=4)\nis the distance as following:\nlocation (i,j) the number represents distance from city i to city j.\nand the objective is to get from city number 0 (line 0 in matrice) through all cities back to city 0 at shortest path.</p>\n\n<p><strong>My Solution</strong>\nCreate a shell function ShortestFullPath() with all first parameters.\nand seconed backtracking function short_path\n where i check stopping conditions (such as same city => 0 or no city => -1 or finished going through all cites)</p>\n\n<p>A array visited is as the size of number of cities.\neach city I visit, I flag the matching index in the array as true or false, and check all options in the city to other cities.</p>\n\n<p><strong>Side Notes</strong> </p>\n\n<p>checkvisited() checks if array visited is all true;</p>\n\n<p>min() checks minimun between current_path and the best path so far.</p>\n\n<pre><code>int ShortestFullPath(int roads[N][N])\n\n\nbool visited[N];\nfor(int i = 0; i &lt; N; i++)\n{\n    visited[i] = false;\n}\nint shortest_path = 9999;\nint current_path = 0;\nint city = 0;\nint j = 0; //destinaton city\nvisited [0] = true;\nif(short_path(roads, city, j, current_path, &amp;shortest_path, visited))\n    Print(shortest_path);\nelse\n    Print(NO_PATH);\nreturn 0;\n\n\n\nbool short_path(int roads[N][N], int city, int j, int current_path,\nint *shortest_path, bool visited[N])\n{\n\n    if(check_visited(visited))\n    {\n        *(shortest_path) = min(current_path, *shortest_path);\n        current_path = 0;\n        return true;\n    }\n    if((roads[city][j] == -1) ||(roads[city][j] == 0)){\n          return false;}\n    if(visited[city] == true)\n        return false;\n\n    visited[city] = true;\n    current_path = current_path + roads[city][j];\n\n\n    for(int j =0; j&lt; N; j++)\n    {\n        short_path(roads, city, j, current_path, shortest_path, visited);\n    }\n    visited[city] = false;\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 160, "user_id": 6529424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AehrV.png?s=128&g=1", "display_name": "eagle33322", "link": "https://stackoverflow.com/users/6529424/eagle33322"}, "edited": false, "score": 1, "creation_date": 1547573302, "post_id": 54203978, "comment_id": 95234737, "body": "You should put parens around your if statement, this formatting could use some love."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1547573360, "post_id": 54203978, "comment_id": 95234764, "body": "First of all, <a href=\"https://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> return an <code>int</code>. This is actually very important for the <code>EOF</code> check."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1547573486, "post_id": 54203978, "comment_id": 95234824, "body": "As for understanding the code, do some research about <i>emulating pass by reference in C</i>, and <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug small programs</a>."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 1, "creation_date": 1547573618, "post_id": 54203978, "comment_id": 95234884, "body": "<code>struct el **l</code> is a pointer on a pointer variable. So, you should use it like this <code>struct el *l;  add(&quot;file&quot;, &amp;el);</code> Then <code>el</code> will  contain root of the linked list, if function returns 1, otherwise function fails and l is undefined (so you don&#39;t need to free list nodes by calling free)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1547574552, "post_id": 54203978, "comment_id": 95235335, "body": "<i>&quot;In this case, &quot;l&quot; shouldn&#39;t be pointing to the first node only?&quot;</i> - no, it points the the <i>pointer</i> that is pointing to the first node. And given that, you don&#39;t actually need <code>temp</code> or <code>last</code> in this code if you configure and manage <code>l</code> throughout the function properly. Removing those actually makes the function <i>easier</i> to implement and understand, so think about it. This looks like a straight-up forward-chained linked list."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1547574560, "post_id": 54203978, "comment_id": 95235339, "body": "Draw the pointers on a piece of paper, it will help immensely."}, {"owner": {"reputation": 437, "user_id": 5308157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ITfDp.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5308157/kevin"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1547574777, "post_id": 54203978, "comment_id": 95235451, "body": "@rustyx I did, and I figured out that the pointers &quot;temp&quot; and &quot;last&quot; were pointing dynamically, whereas &quot;l&quot; was <i>pointing the pointer that is pointing to the first node</i>."}, {"owner": {"reputation": 437, "user_id": 5308157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ITfDp.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5308157/kevin"}, "edited": false, "score": 0, "creation_date": 1547574880, "post_id": 54203978, "comment_id": 95235508, "body": "Maybe I am just wrong, but I couldn&#39;t understand what is the correct way to pass the list &quot;l&quot;."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1547574958, "post_id": 54203978, "comment_id": 95235542, "body": "@Kevin If you mean how do you pass the global <code>list</code> to this function, the caller would do something like <code>int res = add(fname, &amp;list);</code> within whatever function you&#39;re calling this from, assuming <code>fname</code> is whatever filename you&#39;re using. Btw, you also have a potential file leak in this function. <code>if (temp==NULL) return 0;</code> leaves <code>f</code> opened and orphaned into the ether. That&#39;s not good."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1547575388, "post_id": 54203978, "comment_id": 95235731, "body": "Regarding what I said before (removing <code>temp</code> and <code>last</code>), as well as fixing the orphaned file pointer, consider <a href=\"https://pastebin.com/NWEeb9Nn\" rel=\"nofollow noreferrer\">something like this</a>. It frankly still has a hole in that it can return a partial list on an error condition, but it is hopefully easier to understand, and worthy of stepping though in a debugger."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547576026, "post_id": 54203978, "comment_id": 95236007, "body": "&quot;I can&#39;t understand how it returns the list <code>&quot;l&quot;</code>&quot;: The code does not return <code>l</code>.  It returns an <code>int</code>.  The function <code>add (char *name, struct el **l)</code> receives a pointer to <code>struct el *</code>.  The code can then change the pointer <code>l</code> points to."}, {"owner": {"reputation": 437, "user_id": 5308157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ITfDp.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5308157/kevin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547576333, "post_id": 54203978, "comment_id": 95236151, "body": "@chux Yes, maybe instead of int, it could just be a void. The function is supposed to receive an empty linked list and then add nodes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547576493, "post_id": 54203978, "comment_id": 95236211, "body": "Kevin, certainly <code>add()</code> should <b>not</b> receive &quot;an empty linked list&quot; (<code>struct el *</code>), but receive a pointer  to  &quot;an empty linked list&quot; (<code>struct el **</code>)."}, {"owner": {"reputation": 437, "user_id": 5308157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ITfDp.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5308157/kevin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547576744, "post_id": 54203978, "comment_id": 95236317, "body": "@chux, @WhozCraig I think I figured out the error. Maybe adding <code>*l=last;</code> under <code>last=temp;</code> <code>else{         last-&gt;next=temp;         last=temp;     }</code> solves the problem?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547577289, "post_id": 54203978, "comment_id": 95236535, "body": "@Kevin Post the code that calls <code>add()</code> to understand how it returns the list <code>&quot;l&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 5308157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ITfDp.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5308157/kevin"}, "edited": false, "score": 0, "creation_date": 1547586533, "post_id": 54205913, "comment_id": 95240298, "body": "Yes, that&#39;s exactly the answer I was looking for. Thanks!"}], "tags": [], "owner": {"reputation": 130, "user_id": 10413429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d6da5636e0c1a262804debc06a971c?s=128&d=identicon&r=PG&f=1", "display_name": "SCORP.io", "link": "https://stackoverflow.com/users/10413429/scorp-io"}, "is_accepted": true, "score": 1, "last_activity_date": 1547581812, "creation_date": 1547581812, "answer_id": 54205913, "question_id": 54203978, "link": "https://stackoverflow.com/questions/54203978/how-to-correctly-add-a-node-to-a-linked-list-from-the-right/54205913#54205913", "title": "How to correctly add a node to a linked list from the right", "body": "<p>The function <code>add</code> takes two parameters: the name of a file and a pointer to a pointer of <code>struct el</code> (list of lists).  It's worth noting that the function <strong><em>only</em></strong> operates on the first \"list\" or <code>*l</code> or <code>l[0]</code></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (*l==NULL){     // if no characters in the first list of l then\n  last=temp;       //   initialize the list with the first character\n  *l=temp;\n}\nelse{              // else the first list of l has been initialized so\n  last-&gt;next=temp; //   add new reference and data to current end node\n  last=temp;\n}\n</code></pre>\n\n<p>Since you initialize the first list <code>*l</code> with the same pointer as <code>last</code>, you're still creating the link when assigning your current <code>struct el</code> pointer to <code>last-&gt;next</code> while maintaining <code>*l</code>'s pointer to the root node.</p>\n"}], "owner": {"reputation": 437, "user_id": 5308157, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ITfDp.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5308157/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 54205913, "answer_count": 1, "score": 2, "last_activity_date": 1547581812, "creation_date": 1547573230, "last_edit_date": 1547573470, "question_id": 54203978, "link": "https://stackoverflow.com/questions/54203978/how-to-correctly-add-a-node-to-a-linked-list-from-the-right", "title": "How to correctly add a node to a linked list from the right", "body": "<p>I want to write a function that, passed by two parameters (the name of a file and a global list), does the following: if the list is empty and the file exists, the function starts reading the content of the file. For each character, it generates a node in the linked list where is stored the character, and then adds the node to the list from the right. Finally, the function returns, as parameters, the list created and the value 1, otherwise, it ends the execution of the function, and returns 0 as a parameter.</p>\n\n<p>The following is the solution provided by my textbook of the exercise, but I can't understand how it returns the list \"l\". In this case, \"l\" shouldn't be pointing to the first node only?</p>\n\n<pre><code>struct el {\nstruct el *next;\nchar data;\n};\nstruct el *list=NULL;\n\nint add (char *name, struct el **l) {\n   FILE *f; char c;\n   struct el *temp, *last = NULL; \n   f= fopen(name, \"r\");\n   if (f==NULL || (*l)!=NULL){\n   printf(\"errf\");\n   return 0;\n   }\n   c=fgetc(f);\n   while (c!=EOF) {\n      temp= (struct el *) malloc(sizeof(struct el));\n      if (temp==NULL) return 0;\n      temp-&gt;data=c;\n      temp-&gt;next=NULL;\n      if (*l==NULL){\n        last=temp;\n        *l=temp;\n      }\n      else{\n        last-&gt;next=temp;\n        last=temp;\n    }\n   c=fgetc(f);\n   }\n  fclose(f);\n  return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "api-design"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547574002, "post_id": 54203959, "comment_id": 95235079, "body": "Does the user need to see <i>any</i> of the fields of the handle at all? If not, I would opt for a <code>void*</code> handle."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547575927, "post_id": 54203959, "comment_id": 95235959, "body": "If the handle is supposed to be opaque, then only the first of the two alternatives really fits the bill.  To the extent that the user has to worry about different handle types, you no longer have opacity."}], "owner": {"reputation": 25, "user_id": 5621998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425d690961fa19a5120a42fbf79bfb00?s=128&d=identicon&r=PG&f=1", "display_name": "adrift", "link": "https://stackoverflow.com/users/5621998/adrift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547573145, "creation_date": 1547573145, "question_id": 54203959, "link": "https://stackoverflow.com/questions/54203959/api-design-dilemma-opaque-handles", "title": "API Design Dilemma: Opaque Handles", "body": "<p>I'm in the process of designing a library that tries to unify the platform specific details under a single generic handle (1), or a set thereof (2).</p>\n\n<p>To make the question more concrete, I'll provide excerpts of the two implementations and a sample usage.</p>\n\n<p>(1) Tagged union; a catch-it-all type:</p>\n\n<pre><code>enum tb_handle_kind {};\n\n/* These two are never exposed to the user: */\nstruct tb_dir {\n    struct _WIN32_FIND_DATAW find_data;\n    HANDLE search_handle;\n};\n\nstruct tb_file {\n    HANDLE native_handle;\n};\n\nstruct tb_handle {\n    enum tb_handle_kind kind;\n\n    union {\n        struct tb_file file;\n        struct tb_dir dir;\n    };\n};\n</code></pre>\n\n<p>Which you would use in the following way:</p>\n\n<pre><code>file_open(struct tb_handle *, const char *);\nhandle_close(struct tb_handle *);\n\nstruct tb_handle file;\nfile_open(&amp;file, \"path/to/file\");\n\n...\n\nhandle_close(&amp;file); /* No need for a cast, or a file-specfic function. */\n</code></pre>\n\n<p>(2) Generic handle as the base class for others:</p>\n\n<pre><code>struct tb_handle {\n    /* Fields shared by each handle. */\n};\n\nstruct tb_dir {\n    struct tb_handle base; /* Now a \"base class\" of tb_dir. */\n    struct _WIN32_FIND_DATAW find_data;\n    HANDLE search_handle;\n};\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>/* Either a pair of init/close functions. */\nint dir_open(struct tb_dir *, const char *);\nint dir_close(struct tb_dir *);\n\n/* Or handle_close from the previous example, that now requires a cast: */\nhandle_close((struct tb_handle *) &amp;some_dir);\n</code></pre>\n\n<p>As far I can tell, (1) offers an easier API to use at the expense of type safety whereas (2) makes for more mental gymnastics with improved safety (you can't pass a handle of the wrong kind to a function).</p>\n\n<p>Which one would you rather use from the perspective of the user?</p>\n"}, {"tags": ["c", "function", "pointers", "linked-list", "reference"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547573145, "post_id": 54203907, "comment_id": 95234664, "body": "How do you change the value of <code>head</code> when appending? Maybe that way could be used for deleting too..."}, {"owner": {"reputation": 93, "user_id": 6903605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpn1z.jpg?s=128&g=1", "display_name": "volkang", "link": "https://stackoverflow.com/users/6903605/volkang"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547573724, "post_id": 54203907, "comment_id": 95234929, "body": "I do not change the value of head, it always stays the same. I only add new nodes to the list."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547573815, "post_id": 54203907, "comment_id": 95234985, "body": "If you never change the value of <code>head</code>, it would be <code>NULL</code> and your list would be empty...so your <code>append</code> function must be changing it somehow"}, {"owner": {"reputation": 93, "user_id": 6903605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpn1z.jpg?s=128&g=1", "display_name": "volkang", "link": "https://stackoverflow.com/users/6903605/volkang"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547574089, "post_id": 54203907, "comment_id": 95235122, "body": "Correct. I do this by <code>head_ref</code> in <code>append</code>. However, in <code>freeList</code>, I free head ,which complicates the situation."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1547575382, "post_id": 54203907, "comment_id": 95235728, "body": "If you would pass the address of <code>head</code> to <code>freeList</code> you could set it to NULL in <code>freeList</code>. Otherwise you would have to do <code>head = NULL;</code> after calling <code>clearList</code>. You could also create a preprocessor macro, e.g. <code>clearListNull</code> that does both."}, {"owner": {"reputation": 93, "user_id": 6903605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpn1z.jpg?s=128&g=1", "display_name": "volkang", "link": "https://stackoverflow.com/users/6903605/volkang"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1547575729, "post_id": 54203907, "comment_id": 95235878, "body": "@Bodo Would you explain how to do that exactly please? My problem is I know that it could be done by manipulating addresses, but cannot make it work.  I kinda find an alternative solution but would like to learn to do it right."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547576182, "post_id": 54204558, "comment_id": 95236080, "body": "Aside: Why the unneeded cast in <code>new_node = (struct Node*) malloc(sizeof(struct Node))</code>?  Consider <code>new_node = malloc(sizeof *new_node)</code>. <code>arr = malloc(sizeof *arr * 10);</code> etc.  instead.  Easier to code right, review and maintain."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1547624586, "post_id": 54204558, "comment_id": 95250627, "body": "I think idk&#39;s solution is better because nothing prevents you from calling <code>freeList(head);</code> or even <code>(void)freeList(head);</code> in your code."}], "tags": [], "owner": {"reputation": 93, "user_id": 6903605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpn1z.jpg?s=128&g=1", "display_name": "volkang", "link": "https://stackoverflow.com/users/6903605/volkang"}, "is_accepted": false, "score": 0, "last_activity_date": 1547575613, "creation_date": 1547575613, "answer_id": 54204558, "question_id": 54203907, "link": "https://stackoverflow.com/questions/54203907/assigning-null-to-the-head-node-in-a-linked-list-in-c/54204558#54204558", "title": "Assigning NULL to the head node in a linked list in C", "body": "<p>I realized it is possible to change the <code>freeList</code> function so that it will return a NULL value. See the updated code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;  \n#include \"gurobi_c.h\"\n#include &lt;stdlib.h&gt;\n\n//Gurobi variables\nGRBenv   *env = NULL;\nGRBmodel *model = NULL;\n//Gurobi variables\n\nstruct Node \n{ \n  int data; \n  struct Node *next;\n  struct Node *end;\n};\n\nvoid append(struct Node** head_ref, int new_data) \n    { \n    struct Node *last = *head_ref;  \n    struct Node* new_node = (struct Node*) malloc(sizeof(struct Node));  \n    new_node-&gt;data  = new_data; \n    new_node-&gt;next = NULL;\n    new_node-&gt;end = new_node;\n    if (*head_ref == NULL) \n    { \n       *head_ref = new_node;\n       //printf(\"  ..Init Append %d\\n\",new_data);\n       return; \n    } \n    last = (*head_ref)-&gt;end; \n    last-&gt;next = new_node;  \n    (*head_ref)-&gt;end=new_node;\n    //printf(\"  ..Append %d\\n\",new_data);\n    return; \n} \n\nvoid clearList(struct Node *node, double *arr) \n    { \n    int i;\n    if(node!=NULL)\n        {\n        struct Node tmp;\n        tmp=*(node-&gt;end);\n        while (node != NULL) \n            {  \n            i=node-&gt;data;\n            arr[i]=0;\n            //printf(\"   ..clear %d \\n\", node-&gt;data,(node-&gt;end)-&gt;data);\n            node = node-&gt;next; \n            }\n        }\n    }\n\nNode* freeList(struct Node *node) \n    { \n    struct Node *tmp;\n    while (node != NULL) \n        { \n        tmp=node;\n        node = node-&gt;next; \n        printf(\"  ..Free %d \\n\", tmp-&gt;data);      \n        free(tmp);\n        } \n    return NULL;\n    }\n\nint main (){\n    Node *head;     \n    double *arr = (double *) malloc(sizeof(double) * 10);\n    for(int i=0;i&lt;10;i++)\n        arr[i]=i;\n\n    head=NULL;\n    printf(\"Head:  %s -&gt; null as expected\\n\", head);\n    append(&amp;head,2);\n    append(&amp;head,4);\n    clearList(head,arr);\n    for(int i=0;i&lt;10;i++)\n        printf(\"No %d : %.2f\\n\",i,arr[i]);\n\n    printf(\"Head:  %s -&gt; Not null as linkedlist is not freed\\n\", head);\n    head=freeList(head);\n    printf(\"Head:  %s -&gt; Again null as expected\\n\", head);\n    free(arr);\n    printf(\"%s\", head);\n    getchar();\n    return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5052095, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-__oUrv8oZZA/AAAAAAAAAAI/AAAAAAAAASY/qiE2qxdeYzk/photo.jpg?sz=128", "display_name": "idk", "link": "https://stackoverflow.com/users/5052095/idk"}, "is_accepted": true, "score": 3, "last_activity_date": 1547576439, "creation_date": 1547576439, "answer_id": 54204747, "question_id": 54203907, "link": "https://stackoverflow.com/questions/54203907/assigning-null-to-the-head-node-in-a-linked-list-in-c/54204747#54204747", "title": "Assigning NULL to the head node in a linked list in C", "body": "<p>You're already changing the value of head in your <code>append</code> function so you basically need to do the same thing in <code>freeList</code>:</p>\n\n<pre><code>void freeList(struct Node **head_ref) \n    { \n    struct Node *tmp,*node;\n    node=*head_ref;\n    while (node != NULL) \n        { \n        tmp=node;\n        node = node-&gt;next; \n        //printf(\"  ..Free %d \\n\", tmp-&gt;data);      \n        free(tmp);\n        } \n    *head_ref=NULL;\n    }\n\nint main (){\n    /* do stuff */\n    freeList(&amp;head);\n    /* do stuff */\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 1, "last_activity_date": 1547625264, "creation_date": 1547625264, "answer_id": 54212494, "question_id": 54203907, "link": "https://stackoverflow.com/questions/54203907/assigning-null-to-the-head-node-in-a-linked-list-in-c/54212494#54212494", "title": "Assigning NULL to the head node in a linked list in C", "body": "<p>Just for completeness: Another possible option would be to use a wrapper macro for <code>freeList()</code>.</p>\n\n<pre><code>void freeList(struct Node *node) \n{ \n    /* ... */\n}\n\n#define freeListNull(node) do { \\\n    freeList(node); \\\n    node = NULL; \\\n} while(0)\n\nint main () {\n    /* ... */\n    freeListNull(head);\n    /* ... */\n}\n</code></pre>\n\n<p>This solution has a similar disadvantage as the version that returns the modified pointer. You can simply forget to use the right call <code>freeListNull(head);</code> and call <code>freeList(head);</code> instead. The best solution is a function <code>freeList()</code> that takes the address of the <code>head</code> pointer as in idk's answer.</p>\n"}], "owner": {"reputation": 93, "user_id": 6903605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpn1z.jpg?s=128&g=1", "display_name": "volkang", "link": "https://stackoverflow.com/users/6903605/volkang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 0, "accepted_answer_id": 54204747, "answer_count": 3, "score": 1, "last_activity_date": 1547625264, "creation_date": 1547572922, "question_id": 54203907, "link": "https://stackoverflow.com/questions/54203907/assigning-null-to-the-head-node-in-a-linked-list-in-c", "title": "Assigning NULL to the head node in a linked list in C", "body": "<p>Please see the full code below. </p>\n\n<p>I have an initial array named <code>arr</code>.\nI'm using a linked list to store some indices via the <code>append</code> function. After I got the indices, I store them in linked list and use <code>clearList</code> to change the corresponding values to 0 (In this example arr[2] and arr[4]). \nFinally, I free the memory by calling <code>freeList</code> since i'm done with the linked list.  </p>\n\n<p>However, to be able to do same thing again and again, I need to set <code>head</code> to NULL whenever I call <code>freeList</code>. But I cannot. Any idea how to solve this? \nThank you. </p>\n\n<pre><code>#include &lt;stdio.h&gt;  \n#include \"gurobi_c.h\"\n#include &lt;stdlib.h&gt;\n\n//Gurobi variables\nGRBenv   *env = NULL;\nGRBmodel *model = NULL;\n//Gurobi variables\n\nstruct Node \n{ \n  int data; \n  struct Node *next;\n  struct Node *end;\n};\n\nvoid append(struct Node** head_ref, int new_data) \n    { \n    struct Node *last = *head_ref;  \n    struct Node* new_node = (struct Node*) malloc(sizeof(struct Node));  \n    new_node-&gt;data  = new_data; \n    new_node-&gt;next = NULL;\n    new_node-&gt;end = new_node;\n    if (*head_ref == NULL) \n    { \n       *head_ref = new_node;\n       //printf(\"  ..Init Append %d\\n\",new_data);\n       return; \n    } \n    last = (*head_ref)-&gt;end; \n    last-&gt;next = new_node;  \n    (*head_ref)-&gt;end=new_node;\n    //printf(\"  ..Append %d\\n\",new_data);\n    return; \n} \n\nvoid clearList(struct Node *node, double *arr) \n    { \n    int i;\n    if(node!=NULL)\n        {\n        struct Node tmp;\n        tmp=*(node-&gt;end);\n        while (node != NULL) \n            {  \n            i=node-&gt;data;\n            arr[i]=0;\n            //printf(\"   ..clear %d \\n\", node-&gt;data,(node-&gt;end)-&gt;data);\n            node = node-&gt;next; \n            }\n        }\n    }\n\nvoid freeList(struct Node *node) \n    { \n    struct Node *tmp,*hd;\n    hd=node;\n    while (node != NULL) \n        { \n        tmp=node;\n        node = node-&gt;next; \n        //printf(\"  ..Free %d \\n\", tmp-&gt;data);      \n        free(tmp);\n        } \n    hd=NULL;\n    }\n\nint main (){\n    Node *head;     \n    double *arr = (double *) malloc(sizeof(double) * 10);\n    for(int i=0;i&lt;10;i++)\n        arr[i]=i;\n\n    head=NULL;\n    printf(\"Head:  %s\\n\", head);\n    append(&amp;head,2);\n    append(&amp;head,4);\n    clearList(head,arr);\n    for(int i=0;i&lt;10;i++)\n        printf(\"No %d : %.2f\\n\",i,arr[i]);\n    freeList(head);\n\n    free(arr);\n\n    printf(\"%s\", head);\n    getchar();\n    return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "operating-system", "ubuntu-16.04", "scheduling"], "comments": [{"owner": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1547573234, "post_id": 54203872, "comment_id": 95234705, "body": "@EugeneSh.: 1. (i+1), 2. (at[i]), 3. (bt[i]),4. (ct[i]), 5. (tat[i]) and 6. (wt[i])    It&#39;s easy to lose track, but it appears there&#39;s 6 parameters"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 864, "user_id": 10913596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cf12cce6499d0cf89a03500f0808ab?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10913596/daniel"}, "edited": false, "score": 0, "creation_date": 1547573280, "post_id": 54203872, "comment_id": 95234723, "body": "@Daniel Indeed. Thank you."}, {"owner": {"reputation": 162, "user_id": 10395587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b548dbfa2977701ebe0b35d9ed8207?s=128&d=identicon&r=PG&f=1", "display_name": "manoliar", "link": "https://stackoverflow.com/users/10395587/manoliar"}, "edited": false, "score": 0, "creation_date": 1547573629, "post_id": 54203872, "comment_id": 95234886, "body": "By the way, it is better to use : int main(void)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10514825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b54ede1d87d34a619aa918f292f803?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Gupta", "link": "https://stackoverflow.com/users/10514825/rajesh-gupta"}, "edited": false, "score": 0, "creation_date": 1547573994, "post_id": 54203997, "comment_id": 95235073, "body": "Hello Ctx! Thanks a lot for replying. It worked! I&#39;m so grateful to you!"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 2, "last_activity_date": 1547573286, "creation_date": 1547573286, "answer_id": 54203997, "question_id": 54203872, "link": "https://stackoverflow.com/questions/54203872/why-is-my-programme-showing-segmentation-fault-on-ubuntu-but-working-fine-on-gee/54203997#54203997", "title": "Why is my programme showing Segmentation Fault on Ubuntu but working fine on Geeks IDE?", "body": "<p>Here:</p>\n\n<pre><code>int priority[n],min=at_copy[0],k,j;\nfor(j=0;j&lt;n;j++){\n    min=at_copy[0];\n    for(i=0;i&lt;n;i++){\n        if(at_copy[i]&lt;min){\n            min=at_copy[i];\n            k=i;\n        }\n    }\n    at_copy[k]=999;\n    ...\n</code></pre>\n\n<p>Imagine what happens, when <code>at_copy[0]</code> is the minimal value. Then, the condition <code>atcopy[i]&lt;min</code> is never true and k remains uninitialized resulting in an out-of-bounds access here:</p>\n\n<pre><code>    at_copy[k]=999;\n</code></pre>\n\n<p>You have to initialize k with <code>0</code>, since you assume in the first iteration, that <code>at_copy[0]</code> is the minimum.</p>\n\n<pre><code>int priority[n],min=at_copy[0],k=0,j;\n</code></pre>\n\n<p>With Geeks-IDE, you might have been \"lucky\" and k had the value 0 without being initialized.</p>\n"}], "owner": {"reputation": 21, "user_id": 10514825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b54ede1d87d34a619aa918f292f803?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Gupta", "link": "https://stackoverflow.com/users/10514825/rajesh-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547574056, "creation_date": 1547572778, "last_edit_date": 1547574056, "question_id": 54203872, "link": "https://stackoverflow.com/questions/54203872/why-is-my-programme-showing-segmentation-fault-on-ubuntu-but-working-fine-on-gee", "title": "Why is my programme showing Segmentation Fault on Ubuntu but working fine on Geeks IDE?", "body": "<p>Experts, this is the program I made for First Come First Serve Scheduling in C language. \n<br>\nFor the inputs like - <br>\n4<br>\n0 0 0 0<br>\n1 2 3 4 <br></p>\n\n<p>and inputs like - <br>\n5<br>\n0 1 2 3 4<br>\n4 3 1 2 5<br></p>\n\n<p>My program is giving Segmentation fault (Core dumped) when I tried running it on my Ubuntu but it worked fine on GeeksForGeeks IDE.\n<br>\nAnd for the inputs like -<br>\n6<br>\n4 3 2 1 2 3<br>\n4 3 2 3 4 5<br>\n<br>\nMy program is working fine on my Ubuntu as well as on GeeksForGeeks IDE.<br></p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid main(){\n    int n,i;\n    printf(\"\\nEnter the number of jobs:\\n\");\n    scanf(\"%d\",&amp;n);\n    int at[n],bt[n],at_copy[n];\n    printf(\"\\nEnter the arrival time:\\n\");\n    for(i=0;i&lt;n;i++){\n        scanf(\"%d\",&amp;at[i]);\n        at_copy[i]=at[i];   \n    }    \n    printf(\"\\nEnter the burst time:\\n\");\n    for(i=0;i&lt;n;i++)\n        scanf(\"%d\",&amp;bt[i]);\n    int priority[n],min=at_copy[0],k,j;\n    for(j=0;j&lt;n;j++){\n        min=at_copy[0];\n        for(i=0;i&lt;n;i++){\n            if(at_copy[i]&lt;min){\n                min=at_copy[i];\n                k=i;\n            }\n        }\n        at_copy[k]=999;\n        priority[j]=k;\n    }\n    int ct[n],wt[n],tat[n],t=0;\n    for(i=0;i&lt;n;i++){\n        if(at[i]&lt;t)\n            k=0;\n        else\n            k=at[i];\n        t+=bt[i]+k;\n        ct[i]=t;\n        tat[i]=ct[i]-at[i];\n        wt[i]=tat[i]-bt[i];\n    }\n    printf(\"\\nProcess\\tAT\\tBT\\tCT\\tTAT\\tWT\\n\");\n    for(i=0;i&lt;n;i++){\n       printf(\"P%d\\t%d\\t%d\\t%d\\t%d\\t%d\\n\",i+1,at[i],bt[i],ct[i],tat[i],wt[i]);\n    }\n}\n</code></pre>\n\n<p>In the output, I am expecting a table like structure displaying the arrival time, burst time, completion time, burst time, turnaround time and waiting time of all the processes.</p>\n"}, {"tags": ["c", "csv", "struct", "complex-numbers"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547572501, "post_id": 54203786, "comment_id": 95234337, "body": "Your problem is that <code>data</code> is not initialized, and therefore pointing nowhere valid."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1547572530, "post_id": 54203786, "comment_id": 95234356, "body": "You are not asking the right question. In order to point something, this something has to exist. While your <code>data</code> is not allocated at all."}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1547572886, "post_id": 54203786, "comment_id": 95234527, "body": "Does the csv file only contain the real part?"}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1547573063, "post_id": 54203786, "comment_id": 95234626, "body": "Anyhow, the prototype should be either <code>void csvread(char *filename, complex *data_out);</code> in the case you allocate the array before <code>csvread</code> call, or <code>void csvread(char *filename, complex **data_out);</code> in the case you allocate the data in the <code>csvread</code>."}, {"owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "reply_to_user": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1547573857, "post_id": 54203786, "comment_id": 95235009, "body": "@DaBler yes, the csv file contains only the real part. I will try updating my code as you have stated."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547573713, "post_id": 54203952, "comment_id": 95234922, "body": "@EugeneSh. Noted. I have edited my code as ranu has stated, but I am still getting an output of 0.00000."}, {"owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547574569, "post_id": 54203952, "comment_id": 95235347, "body": "Thanks for the edit, I will show you my csv read code, as I stated under Johnny&#39;s answer."}], "tags": [], "owner": {"reputation": 479, "user_id": 2763060, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yBb54.png?s=128&g=1", "display_name": "ranu", "link": "https://stackoverflow.com/users/2763060/ranu"}, "is_accepted": false, "score": 0, "last_activity_date": 1547648835, "last_edit_date": 1547648835, "creation_date": 1547573118, "answer_id": 54203952, "question_id": 54203786, "link": "https://stackoverflow.com/questions/54203786/how-to-correctly-point-to-a-struct-member-in-c/54203952#54203952", "title": "How to correctly point to a struct member in C?", "body": "<p>In java this would be seen as a <em>NullPointerException</em>, you don't get this kinds of errors in C, but that comes with a responsibility as well. Deferencing a null pointer in C (as you did) may respond in many ways. As the comments had said you need to allocate  the <code>data</code> pointer.</p>\n\n<pre><code>complex *data = malloc(sizeof(complex));\n</code></pre>\n\n<p>And you should free the memory allocated with <code>malloc</code> as well, so in the end of the code just before returning the status of your program to the OS (which you didn't) you should do:</p>\n\n<pre><code>free(data);\n</code></pre>\n\n<p>I'm not sure of how your csvread works but it might not work using nothing less than an array of complex structures. The code below allocates 10 complex numbers initializing them all, inside the <code>csvread</code> function you might have to do some modifications to iterate over them as you showed that with simple array declarations your code works.</p>\n\n<pre><code>complex *data = calloc(10, sizeof(complex));\n</code></pre>\n\n<p>The code above allocates 10 <em>complex structures</em> and the pointer points to the first one allocated. To iterate over them you could index them with numbers (e.g <code>data[0].real = 4</code>) or use pointer arithmetic. I have a strong feeling that you will have to modify the way you iterate over the <code>data_out</code> pointer inside the <code>csvread</code> function.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547574518, "post_id": 54204180, "comment_id": 95235320, "body": "This makes sense to me, but I will also need to store the imaginary data as well. I suppose that if I was to rewrite my csvread, I could add a parameter that could deal with this. I will update my post to show how I am reading. It is very basic."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547574651, "post_id": 54204180, "comment_id": 95235379, "body": "@user15 I&#39;m not sure what you mean by <i>store the imaginary data as well</i>. Do mean in the csv file?"}, {"owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547575760, "post_id": 54204180, "comment_id": 95235893, "body": "there are multiple csv files. One file contains the real data set, while the other contains the imaginary data set. I will need to read both eventually. With my csvread function, I had intended to call it twice so that I would have both data sets in one struct."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547576593, "post_id": 54204180, "comment_id": 95236252, "body": "@user15 You can do that. When you call it the 2nd time, don&#39;t <code>realloc</code> anything. Just store the data in <code>imag</code>. Or modify to parse both files at the same time."}, {"owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547577281, "post_id": 54204180, "comment_id": 95236532, "body": "ok, thanks for the help! Do you think that modification of reading two files can be done with what I currently have or would you recommend a total rewrite of my function (disregarding the writing to file portion)? I also have a special case where I have a dataset with only real values. Would you recommend writing a seperate function for that or do you think it would be a simple addition?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "edited": false, "score": 0, "creation_date": 1547578849, "post_id": 54204180, "comment_id": 95237217, "body": "@user15 I&#39;ve updated my answer. This is one way to do it - may or may not be the best. Hopefully it will give you some good ideas."}], "tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": true, "score": 5, "last_activity_date": 1547578797, "last_edit_date": 1547578797, "creation_date": 1547573942, "answer_id": 54204180, "question_id": 54203786, "link": "https://stackoverflow.com/questions/54203786/how-to-correctly-point-to-a-struct-member-in-c/54204180#54204180", "title": "How to correctly point to a struct member in C?", "body": "<p>You can't allocate just the <code>real</code> part. You need to alloc the entire struct - even if you just use the <code>real</code> part. If you were using an array, it would be like:</p>\n\n<pre><code>complex data[10];\ndata[0].real = 1.0;\ndata[1].real = 2.0;\n// etc..\n</code></pre>\n\n<p>But you will have to dynamically allocate the <code>complex</code> array since the number of items in the file is not known ahead of time (I assume). You can allocate 1 <code>complex</code> object at a time, resizing the array as you go.</p>\n\n<pre><code>// Prototype has changed to pointer-to-pointer complex\n// Return value is the number of items read\nint csvread(char *filename, complex **data);\n\nint main(void)\n{\n   complex *data = NULL;\n   int num_records = csvread(\"test.txt\", &amp;data);\n   for(int i = 0; i &lt; num_records; i++)\n   {\n       printf(\"%f\\n\", data[i].real);\n   }\n   free(data);\n}  \n\n// This function reads csv files\nint csvread(char *filename, complex **data_out)\n{\n    // This will be used to avoid always having to dereference\n    // the data_out parameter\n    complex *array = NULL;\n    int num_records = 0;\n\n    while (1) {\n        double value = // read a value from the file.....\n        // If error or end of file break out of loop\n\n        // Allocate space for another complex object\n        array = realloc(array, sizeof(complex) * (num_records + 1));\n        if (NULL == array) // handle error\n\n        // Store just the real part\n        array[num_records].real = value;\n        // Also, you can initialize imag here but not required\n        array[num_records].imag = 0;\n        num_records += 1;\n    }\n\n    // Store and return\n    *data_out = array;\n    return num_records;\n}\n</code></pre>\n\n<hr>\n\n<p>Based on updated comments: Off the top of my head, here's one way to handle multiple files. First, create 2 functions: one to read the entire contents of a file, and one to replace <code>strtok</code>. The reason we need the second one is because of the way <code>strtok</code> works, you can only use it on one string at a time and we want to use it on two. Then, change the <code>readcsv</code> function to take 2 file names. This is untested and may have errors.</p>\n\n<pre><code>// Create a function that just opens and reads a file\nchar *load_file(const char *path) {\n    // TODO:\n    // Open the file and read entire contents\n    // return string with contents\n\n    // If path is NULL, must return NULL\n\n    // Must return NULL if file does not exist\n    // or read error\n}\n\n// Use this function instead of strok so you \n// can use on 2 string simultaneously\ndouble get_next_value(char **string)\n{\n    char *start = *string;\n    char *end   = *string;\n\n    // Loop until comma or end of string\n    while (*end &amp;&amp; *end != ',') end++;\n    // If comma, terminate and increment\n    if (*end) *end++ = 0;\n    // Update for next time\n    *string = end;\n    return atof(start);\n}\n\n// This function reads csv files\nint csvread(char *real_filename, char *imag_filename, complex **data_out)\n{\n    // This will be used to avoid always having to dereference\n    // the data_out parameter\n    complex *array = NULL;\n    int num_records = 0;\n\n    // Load each file into a string. May be NULL\n    char *real_data_orig = load_file(real_filename);\n    char *imag_data_orig = load_file(imag_filename);\n\n    // Temporary copies of the pointers. Keep the originals\n    // to free() later. These will be modified\n    char *real_data = real_data_orig;\n    char *imag_data = imag_data_orig;\n\n    while (1) {\n        // Check for data. Make sure pointer is not\n        // NULL and it is still pointing to something\n        // that is not '\\0'\n        bool has_real = real_data &amp;&amp; *real_data;\n        bool has_imag = imag_data &amp;&amp; *imag_data;\n\n        // No data? Done.\n        if (!has_real &amp;&amp; !has_imag) break;\n\n        // Allocate space for another complex object\n        array = realloc(array, sizeof(complex) * (num_records + 1));\n        if (NULL == array) // handle error\n\n        // Store the real part (if there is one)\n        if (has_real) {\n            array[num_records].real = get_next_value(&amp;real_data);\n        }\n        // Store the imag part (if there is one)\n        if (has_imag) {\n            array[num_records].imag = get_next_value(&amp;imag_data);\n        }\n        num_records += 1;\n    }\n\n    // Free the file contents\n    free(real_data_orig);\n    free(imag_data_orig);\n\n    // Store and return\n    *data_out = array;\n    return num_records;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10918036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630c2d96e341beb4255ba97d2a1d0be0?s=128&d=identicon&r=PG&f=1", "display_name": "user15", "link": "https://stackoverflow.com/users/10918036/user15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 1, "accepted_answer_id": 54204180, "answer_count": 2, "score": 3, "last_activity_date": 1547651349, "creation_date": 1547572432, "last_edit_date": 1547651349, "question_id": 54203786, "link": "https://stackoverflow.com/questions/54203786/how-to-correctly-point-to-a-struct-member-in-c", "title": "How to correctly point to a struct member in C?", "body": "<p>I have created a very simple \"csvread\" function in C, which will read from CSV files as implied. (In this case, for testing, I have edited it slightly so that I can write dummy data to a file and then read it). I have created a struct to store complex data. However, my psuedo-csv file only contains the real part of the data I need to use. I would like to store this data into a \"data.real\" array. However, I can't seem to get the correct syntax down. (Although, admittedly this is probably more of an issue of understanding pointers completely rather than just syntax). Any help would be appreciated!</p>\n\n<p>In the below code, I know that the following function call is the problem:</p>\n\n<pre><code> csvread(\"test.txt\", &amp;data-&gt;real);\n</code></pre>\n\n<p>However, I have tried multiple variations of the second argument, and this is the only one I can come up with that compiles.</p>\n\n<p>I have gotten my code to work when data is not a structure. For example, if data was declared:</p>\n\n<pre><code>double data[10];\n</code></pre>\n\n<p>So, as you can (hopefully) see I am having trouble with understanding pointers to structure members. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE 10\n\ntypedef struct Complex\n{\n   double real;\n   double imag;\n}complex;\n\nvoid csvread(char *filename, double *data_out);\n\nint main(void)\n{\n   complex *data;\n   csvread(\"test.txt\", &amp;data-&gt;real);\n   for(int i = 0; i&lt;SIZE; i++)\n   {\n       printf(\"%f\\n\", data[i].real);\n   }\n}  \n\n// This function reads csv files\nvoid csvread(char *filename, double *data_out)\n{\n    FILE *file;\n    char *no_commas; // character buffer to store strings without comma parse\n    double *buffer; // character data converted to double type\n    const char comma[2] = \",\";\n    char *csv;\n    char *token;\n    int file_size;\n    int i = 0;\n\n    // Read CSV file\n    file = fopen(filename,\"w+\"); // change to \"r\" if read only\n    if(file == NULL)\n    {\n        printf(\"\\n The file requested cannot be found.\");\n        exit(1);\n    }\n    fprintf(file, \"%s\", \"1.18493,0.68594,-7.65962,9.84941,10.34054,7.86571,0.04500,11.49505,-8.49410,-0.54901\"); \n    fseek(file, 0, SEEK_SET); // return to beginning of the file\n\n    // Find the file size in bytes \n    fseek(file, 0, SEEK_END); // go to end of file\n    file_size = ftell(file);\n    fseek(file, 0, SEEK_SET); //  return to beginning of file\n\n    // Allocate buffer memory\n    no_commas = malloc((file_size) * sizeof(char));\n    buffer = malloc((file_size) * sizeof(double));\n\n    if (no_commas == NULL || buffer == NULL)\n    {\n        printf(\"Failed to allocate memory when reading %s.\\n\\n\", filename);\n        exit(1);\n    }\n\n    while ((csv = fgets(no_commas, (file_size + 1), file)) != NULL) // fgets is used as file has no newline characters\n    {\n        // Remove Commas from string\n        token = strtok(csv, comma);\n        while (token != NULL)\n        {\n            //printf(\"%s\\n\", token); \n            buffer[i] = atof(strdup(token));\n            token = strtok(NULL, comma);\n            //printf(\"%f\\n\", buffer[i]); \n            i++;\n        }\n    }\n    data_out = buffer;\n    fclose(file);\n    free(no_commas);\n    free(buffer);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n0.000000\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code> 1.18493\n 0.68594\n-7.65962\n 9.84941\n10.34054\n 7.86571\n 0.04500\n11.49505\n-8.49410\n-0.54901\n</code></pre>\n\n<p><strong>EDIT</strong>: Thank you all for your comments and help! I have marked Johnny Mopp's answer as most helpful. This question evolved into more about allocating memory than intended, which ended up being very informative and helpful. </p>\n"}, {"tags": ["c++", "mysql", "c", "mysql-connector"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1547572977, "post_id": 54203780, "comment_id": 95234577, "body": "We need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> but at a guess your <code>get_mysql_session()</code> method is returning a temproary session object which is destroyed at the end of the line which then makes the result object invalid."}, {"owner": {"reputation": 795, "user_id": 1514605, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/54c431271692cbfefd02db488ba1d061?s=128&d=identicon&r=PG&f=1", "display_name": "SagunKho", "link": "https://stackoverflow.com/users/1514605/sagunkho"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1547574797, "post_id": 54203780, "comment_id": 95235469, "body": "@AlanBirtles I think you&#39;re right, thanks."}, {"owner": {"reputation": 795, "user_id": 1514605, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/54c431271692cbfefd02db488ba1d061?s=128&d=identicon&r=PG&f=1", "display_name": "SagunKho", "link": "https://stackoverflow.com/users/1514605/sagunkho"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1547575297, "post_id": 54203780, "comment_id": 95235694, "body": "@AlanBirtles I don&#39;t understand how that works though, could you please elaborate? I&#39;ve added in the code I changed which made it work. How is it so shortlived?"}], "answers": [{"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 2, "last_activity_date": 1547576419, "creation_date": 1547576419, "answer_id": 54204744, "question_id": 54203780, "link": "https://stackoverflow.com/questions/54203780/closed-cursor-error-mysql-connector-c-8-0/54204744#54204744", "title": "Closed cursor error mysql connector c++ 8.0", "body": "<p><code>server-&gt;get_mysql_session()</code> returns a temporary <code>Session</code> object. All temporaries are destroyed at the end of the statement in which they were created.</p>\n\n<p>As the session is destroyed before you call <code>fetchOne</code> it fails.</p>\n\n<p>For example this code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct A\n{\n    A() { std::cout &lt;&lt; \"A()\\n\"; }\n    ~A() { std::cout &lt;&lt; \"~A()\\n\"; }\n};\n\nstd::ostream&amp; operator &lt;&lt; (std::ostream&amp; os, const A&amp; a) { os &lt;&lt; \"\\nA&lt;&lt;\"; return os; }\n\nint main()\n{\n    std::cout &lt;&lt; \"line1\\n\";\n    std::cout &lt;&lt; \"line2\" &lt;&lt; A() &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"line3\\n\";\n}\n</code></pre>\n\n<p>produces the following output:</p>\n\n<pre><code>line1\nA()\nline2\nA&lt;&lt;\n~A()\nline3\n</code></pre>\n"}], "owner": {"reputation": 795, "user_id": 1514605, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/54c431271692cbfefd02db488ba1d061?s=128&d=identicon&r=PG&f=1", "display_name": "SagunKho", "link": "https://stackoverflow.com/users/1514605/sagunkho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 54204744, "answer_count": 1, "score": 0, "last_activity_date": 1547580276, "creation_date": 1547572400, "last_edit_date": 1547580276, "question_id": 54203780, "link": "https://stackoverflow.com/questions/54203780/closed-cursor-error-mysql-connector-c-8-0", "title": "Closed cursor error mysql connector c++ 8.0", "body": "<p>I'm using mysql connector 8.0 and the below code throws a Closed cursor error when trying to fetch the row.</p>\n\n<pre><code>        std::string query = \"SELECT `id`, `username`, `password`, `gender`, `email`, `group_id`, `state`, `unban_time`, `expiration_time`, `last_login`, `last_ip`, `birth_date`, `character_slots`, `pincode`, `pincode_expiry` FROM `game_account` WHERE username = ?;\";\n\n        mysqlx::RowResult res = server-&gt;get_mysql_session().sql(query).bind(username).execute();\n\n        try {\n            mysqlx::Row record = res.fetchOne();\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>CDK Error: get_rows: Closed cursor\n</code></pre>\n"}, {"tags": ["c", "serial-communication"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10900473"}, "edited": false, "score": 0, "creation_date": 1547572181, "post_id": 54203672, "comment_id": 95234168, "body": "full code: <a href=\"https://pastebin.com/CmtHB2s7\" rel=\"nofollow noreferrer\">pastebin.com/CmtHB2s7</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10900473"}, "edited": false, "score": 0, "creation_date": 1547572247, "post_id": 54203672, "comment_id": 95234186, "body": "termios: <a href=\"http://man7.org/linux/man-pages/man3/termios.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/termios.3.html</a>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547572297, "post_id": 54203672, "comment_id": 95234216, "body": "Your receiver code doesn&#39;t appear to be in a loop? How are you expecting to receive more if you don&#39;t try again?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10900473"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547572500, "post_id": 54203672, "comment_id": 95234335, "body": "I want to receive all of datas in once time, this is just a testing"}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 3, "creation_date": 1547572838, "post_id": 54203672, "comment_id": 95234508, "body": "You want but you cannot. You specify maximum size to be read from descriptor, but the amount of data read does not depend on you. It is only guaranteed to be not greater than you specified. So in any case you need a loop"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547598214, "post_id": 54203672, "comment_id": 95243953, "body": "regarding: <code>int  bytes_written  = 0;      bytes_written = write(fd,write_buffer,sizeof(write_buffer);</code>   the function: <code>write()</code> returns a <code>ssize_t</code> not a <code>int</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547598441, "post_id": 54203672, "comment_id": 95244007, "body": "regarding: <code>printf(&quot;\\n\\n  Bytes Rxed: %d&quot;, bytes_read);</code> this will result in a compiler warning because <code>bytes_read</code> is unsigned and <code>&#39;%d&#39; is expecting a signed value.  However, the function: </code>read()` returns a <code>ssize_t</code> not a <code>uint32_t</code>  The use of the output format specifier &#39;%lu&#39; or (better) &#39;%zu&#39;  should be used when printing a <code>ssize_t</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1547598619, "post_id": 54203672, "comment_id": 95244046, "body": "The <code>receiver</code> functionality should be calling <code>read()</code> in a loop and appending the results into a buffer until the returned value from <code>read()</code> is 0 ( or &lt;0, indicating an error occurred )"}], "answers": [{"tags": [], "owner": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "is_accepted": true, "score": 0, "last_activity_date": 1547577974, "creation_date": 1547577974, "answer_id": 54205088, "question_id": 54203672, "link": "https://stackoverflow.com/questions/54203672/serial-communication-rx-size-limitations/54205088#54205088", "title": "Serial communication RX size limitations", "body": "<p>The <code>read</code> system call is not guaranteed to return the number of bytes requested. See <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\">this</a> link for a full reference.</p>\n\n<p>If <code>read</code> returns a non-negative value this value indicates the amount of bytes read, in your case 960 bytes.</p>\n\n<p>To make sure that all bytes are read successfully you will need to put the call to <code>read</code> inside some form of loop. Perhaps something similar to this:</p>\n\n<pre><code>char buffer[4000 + 1]; /* +1 to leave space for null-terminator */\n\nmemset(buffer, 0, sizeof(buffer)); /* Clear buffer */\n\nsize_t bytesToRead = 4000;\nsize_t bytesRead = 0;\nwhile (bytesToRead &gt; 0)\n{\n    const ssize_t retVal = read(fd, buffer + bytesRead, bytesToRead);\n    if (retVal &lt; 0)\n    {\n        /* Handle error */\n    }\n\n    const size_t bytes = (size_t) retVal;\n    bytesRead += bytes;\n    bytesToRead -= bytes;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10900473"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54205088, "answer_count": 1, "score": 0, "last_activity_date": 1547634378, "creation_date": 1547572043, "last_edit_date": 1547634378, "question_id": 54203672, "link": "https://stackoverflow.com/questions/54203672/serial-communication-rx-size-limitations", "title": "Serial communication RX size limitations", "body": "<p>I can`t receive all of bytes what i send out. (Raspberry Pi 3B+ / Raspbian)</p>\n\n<p>I tried to send 4000 bytes and receive only 960 bytes at 9600bit/s. When I increased speed, increased the received bytes. I tries to set VTIME and VMIN values in c_cc array, but not change everything.</p>\n\n<p>How can I receive all of bytes?</p>\n\n<pre><code>transmitter:\n\nchar write_buffer[4000];    /* Buffer containing characters to write into port       */\n\n        for(uint32_t i=0;i&lt;4000;i++)\n        {\n            write_buffer[i] = i;\n        }\n\n        int  bytes_written  = 0;    /* Value for storing the number of bytes written to the port */ \n\n        bytes_written = write(fd,write_buffer,sizeof(write_buffer));/* use write() to send data to port                                            */\n                                         /* \"fd\"                   - file descriptor pointing to the opened serial port */\n                                         /* \"write_buffer\"         - address of the buffer containing data              */\n                                         /* \"sizeof(write_buffer)\" - No of bytes to write                               */  \n        printf(\"\\n  %s written to ttyUSB0\",write_buffer);\n        printf(\"\\n  %d Bytes written to ttyUSB0\", bytes_written);\n        printf(\"\\n +----------------------------------+\\n\\n\");\n\nreceiver:\n\n/*------------------------------- Read data from serial port -----------------------------*/\n\n        char read_buffer[4000];   /* Buffer to store the data received              */\n        uint32_t  bytes_read = 0;    /* Number of bytes read by the read() system call */\n        int i = 0;\n\n        bytes_read = read(fd,&amp;read_buffer,4000); /* Read the data                   */\n\n        printf(\"\\n\\n  Bytes Rxed: %d\", bytes_read); /* Print the number of bytes read */\n        printf(\"\\n\\n  \");\n\n        for(i=0;i&lt;bytes_read;i++)    /*printing only the received characters*/\n            printf(\"%c\",read_buffer[i]);\n\n        printf(\"\\n +----------------------------------+\\n\\n\\n\");\n</code></pre>\n\n<p>output:</p>\n\n<pre><code> +----------------------------------+\n |        Serial Port Write         |\n +----------------------------------+\n  ttyUSB0 Opened Successfully \n  BaudRate = 9600 \n  StopBits = 1 \n  Parity   = none\n   written to ttyUSB0\n  4000 Bytes written to ttyUSB0\n +----------------------------------+\n\n\n\n  Bytes Rxed: 960\n\n\n\n\n !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\n\n !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\n\n !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\n\n !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n +----------------------------------+\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "edited": false, "score": 1, "creation_date": 1547570830, "post_id": 54203290, "comment_id": 95233478, "body": "&quot;Round brackets&quot;, I love it! You just added a new word to my vocabulary :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1547570938, "post_id": 54203290, "comment_id": 95233530, "body": "The ternary operator follows the standard <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence and associativity</a>, like any other operator."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1547570940, "post_id": 54203290, "comment_id": 95233533, "body": "They are called &quot;parentheses&quot;, or &quot;parens&quot; for short."}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 2, "last_activity_date": 1547571120, "creation_date": 1547571120, "answer_id": 54203416, "question_id": 54203290, "link": "https://stackoverflow.com/questions/54203290/behavior-of-conditional-operator-in-arithmetic-operation/54203416#54203416", "title": "Behavior of Conditional Operator in arithmetic operation", "body": "<p>Case 1: <code>int t2=temp%100 + temp&gt;99?2000:1900;</code> be re-written for clarity as: <code>int t2=(temp%100 + temp)&gt;99 ? 2000 : 1900;</code></p>\n\n<p>And that expression: <code>temp%100 + temp</code> is 140, which is bigger than 99, so the expression has value <code>2000</code>.</p>\n\n<hr>\n\n<p>Case 2: <code>int t2=temp%100 + (temp&gt;99?2000:1900);</code></p>\n\n<p><code>temp</code> is not GreaterThan <code>99</code>, so the expression is <code>1900</code>, and added to <code>temp%100</code>, resulting in <code>1970</code></p>\n\n<hr>\n\n<p>Case 3: <code>int t2= temp&gt;99?2000:1900 +temp%100;</code></p>\n\n<p><code>temp</code> is not GreaterThan <code>99</code>, so the expression is <code>1900+70</code>, resulting in 1970</p>\n\n<hr>\n\n<p>This is all Order of Operations; just as <code>*</code> and <code>/</code> take precedence over <code>+</code> and <code>-</code>, all operators have a precedence.</p>\n"}, {"comments": [{"owner": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "reply_to_user": {"reputation": 36, "user_id": 5971600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3gPbQ1SEJhI/AAAAAAAAAAI/AAAAAAAAAE8/Gcl1u-NTOS8/photo.jpg?sz=128", "display_name": "Chinmay Joshi", "link": "https://stackoverflow.com/users/5971600/chinmay-joshi"}, "edited": false, "score": 0, "creation_date": 1547572475, "post_id": 54203431, "comment_id": 95234312, "body": "@ChinmayJoshi, if you&#39;re happy with my answer please accept it :)"}], "tags": [], "owner": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "is_accepted": true, "score": 3, "last_activity_date": 1547574736, "last_edit_date": 1547574736, "creation_date": 1547571159, "answer_id": 54203431, "question_id": 54203290, "link": "https://stackoverflow.com/questions/54203290/behavior-of-conditional-operator-in-arithmetic-operation/54203431#54203431", "title": "Behavior of Conditional Operator in arithmetic operation", "body": "<p>The value of <code>t2</code> is dependent on the operator precedence of the modulus <code>%</code>, addition <code>+</code> and ternary <code>?:</code> operators.</p>\n\n<p>You can find the full list of C operator precedence by following <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">this</a> link.</p>\n\n<p>In your case, the modulus operator has highest precedence, followed by addition and then the ternary operator.</p>\n"}], "owner": {"reputation": 36, "user_id": 5971600, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3gPbQ1SEJhI/AAAAAAAAAAI/AAAAAAAAAE8/Gcl1u-NTOS8/photo.jpg?sz=128", "display_name": "Chinmay Joshi", "link": "https://stackoverflow.com/users/5971600/chinmay-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 54203431, "answer_count": 2, "score": 0, "last_activity_date": 1547574736, "creation_date": 1547570725, "question_id": 54203290, "link": "https://stackoverflow.com/questions/54203290/behavior-of-conditional-operator-in-arithmetic-operation", "title": "Behavior of Conditional Operator in arithmetic operation", "body": "<p>This question is about how conditional operator works in arithmetic operation and assignment statement. </p>\n\n<p>Tested on gcc, arm-gcc.</p>\n\n<pre><code>//gcc 5.4.0\n\n#include  &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello, world!\\n\");\n    int temp=70;\n    int t2=temp%100 + temp&gt;99?2000:1900;\n    printf(\"t2=%d\",t2);\n    return 0;\n}\n//This code returns answer 2000.\n//gcc 5.4.0\n\n#include  &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello, world!\\n\");\n    int temp=70;\n    int t2=temp%100 + (temp&gt;99?2000:1900);\n    printf(\"t2=%d\",t2);\n    return 0;\n}\n//This code returns answer 1970.\n//gcc 5.4.0\n\n#include  &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello, world!\\n\");\n    int temp=70;\n    int t2= temp&gt;99?2000:1900 +temp%100;\n    printf(\"t2=%d\",t2);\n    return 0;\n}\n// Answer is 1970\n//gcc 5.4.0\n\n#include  &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello, world!\\n\");\n    int temp=70;\n    int t2= 5+ temp&gt;99?2000:1900 +temp%100;\n    printf(\"t2=%d\",t2);\n    return 0;\n}\n// Answer is, 1970!\n</code></pre>\n\n<p>Once arithmetic statement encounters conditional operation, it ignores left part of statement. (I think anything after conditional operation in order of execution is ignored) </p>\n\n<p>Also, we can mitigate this by using round brackets (), or having conditional operation at left most.\nCan anyone explain this behavior? Is there any undefined behavior problem introduced by using conditional operation inside arithmetic statement?</p>\n\n<p>Also surprised that this is not being asked before. If it is, please provide link.\nThanks a lot!</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1547579390, "post_id": 54202914, "comment_id": 95237446, "body": "Your &quot;new&quot; IP header is not using bitfields correctly for the new flag fields you added.  The <code>ip_off</code> field needs to be 13 bits instead of 5 bits, and you should be using <code>unsigned short int</code> instead of <code>unsigned int</code> for the 3 flag fields, to match <code>ip_off</code>. Also, the placement of bits is not guaranteed across platforms so you may have an endian issue to deal with, too."}, {"owner": {"reputation": 7, "user_id": 10674626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7951c7f61bd93a0931bb2ed804cbbd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10674626/sebastian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547644544, "post_id": 54202914, "comment_id": 95261314, "body": "@Remy Lebeau it helps a little... next Problem is that, if i set the Ip flags, so Reserved bit, Dont fragment , Morefragment flags and send it to my localhost, and catch it with wireshark i see that the protocol is a Ipv4, but it should be TCP with all TCP headers. In wireshark it says protocol TCP (6) but it dont show me the header. While i dont set the ip flags, so i use a value of 0, wireshark shows me the Packet with all data i used.  Actually if i set the flags to 1, the flags did not change, so it told &quot;not set&quot;, only the Fragment offset changed if i set the ipflags."}, {"owner": {"reputation": 7, "user_id": 10674626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7951c7f61bd93a0931bb2ed804cbbd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10674626/sebastian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547646464, "post_id": 54202914, "comment_id": 95262466, "body": "@RemyLebeau i wasn able to mention your name :D so i did it here ^"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547659242, "post_id": 54202914, "comment_id": 95270248, "body": "That still should like you are not setting up the bits correctly. For instance, if you have endian backwards. Also, please show your actual code for creating and sending the packets. Looking at your header definitions alone is really not enough to diagnose your problems."}, {"owner": {"reputation": 7, "user_id": 10674626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7951c7f61bd93a0931bb2ed804cbbd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10674626/sebastian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547668181, "post_id": 54202914, "comment_id": 95274467, "body": "@RemyLebeau got it, i edited my post again. This ist just for TCP and IP, later i will, if i am earn the experience why the Packet is not send correctly, write a same programm which sends UDP + IP and IICMP + IP"}, {"owner": {"reputation": 7, "user_id": 10674626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7951c7f61bd93a0931bb2ed804cbbd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10674626/sebastian"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1547676372, "post_id": 54202914, "comment_id": 95278141, "body": "@RemyLebeau I did not know what i did wrong.. I actually control the header again.. but i did not found the problem.... Have you any information for me?"}], "owner": {"reputation": 7, "user_id": 10674626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7951c7f61bd93a0931bb2ed804cbbd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10674626/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547668285, "creation_date": 1547569483, "last_edit_date": 1592644375, "question_id": 54202914, "link": "https://stackoverflow.com/questions/54202914/send-raw-tcp-ipv4-packet-did-not-work-different-output-from-wireshark", "title": "Send Raw TCP + IPV4 Packet Did not Work. Different Output from Wireshark", "body": "<p>I have a Programm which sends TCP/Ipv4 Packet to my Localhost adress.</p>\n<p>I try to expand my Programm so i edit / set the Ip Flags in the Ip Header. After I do that and start the Programm i only receive  in Wireshark a packet with ipv4 Protocol, so it did not send the tcp packet with the Ip packet.</p>\n<p>The Programm is work if i used my old Ip Header, so without the Ip Flags.</p>\n<p>Did you know, why the program did not send ipv4+tcp packet?</p>\n<hr />\n<h1>Maybe you will understand my Problem, if you look at my Headers and Output from Wireshark for each Input below.</h1>\n<hr />\n<p>My Old Ip Header:</p>\n<pre><code>struct ipheader {\n    unsigned char ip_hl :4, ip_v :4;\n    unsigned char ip_tos;\n    unsigned short int ip_len;\n    unsigned short int ip_id;\n    unsigned short int ip_off;\n\n    unsigned char ip_ttl;\n    unsigned char ip_p;\n    unsigned short int ip_sum;\n    unsigned int ip_src;\n    unsigned int ip_dst;\n};\n</code></pre>\n<p>My Old Tcp Header:</p>\n<pre><code>struct tcpheader {\n    unsigned short int th_sport;\n    unsigned short int th_dport;\n    unsigned int th_seq;\n    unsigned int th_acknum;\n    unsigned char th_reserved :4, th_off :4;\n    unsigned int th_fin :1, th_syn :1, th_rst :1, th_psh :1, th_ack :1,\n            th_urg :1, th_cwr :1, th_ece :1, th_ns :1;\n    unsigned short int th_win;\n    unsigned short int th_sum;\n    unsigned short int th_urp;\n};\n</code></pre>\n<hr />\n<p>My New IP Header</p>\n<pre><code>struct ipheader {\n    unsigned char ip_hl :4, ip_v :4;\n    unsigned char ip_tos:8;\n    unsigned short int ip_len:16;\n    unsigned short int ip_id:16;\n\n    unsigned short int ip_moreFrag:1,\n         ip_doNotFrag :1, ip_reserved :1;\n\n\n    unsigned short int ip_off:13;\n\n\n    unsigned char ip_ttl:8;\n    unsigned char ip_p:8;\n    unsigned short int ip_sum:16;\n    unsigned int ip_src:32;\n    unsigned int ip_dst:32;\n};\n</code></pre>\n<p>My NEW TCP - Header:</p>\n<pre><code>struct tcpheader {\n    unsigned short int th_sport:16;\n    unsigned short int th_dport:16;\n    unsigned int th_seq:32;\n    unsigned int th_acknum:32;\n    unsigned char th_reserved :4, th_off :4;\n//  unsigned char th_flags;\n//  unsigned int tcp_res1 :4, th_hlen :4;\n    unsigned int th_fin :1, th_syn :1, th_rst :1, th_psh :1, th_ack :1,\n            th_urg :1, th_cwr :1, th_ece :1; //th_ns :1;\n    unsigned short int th_win:16;\n    unsigned short int th_sum:16;\n    unsigned short int th_urp:16;\n};\n</code></pre>\n<hr />\n<p>First Input:</p>\n<pre><code>   &quot;ip_v&quot;: &quot;4&quot;,\n      &quot;ip_hl&quot;: &quot;5&quot; ,\n\n      &quot;ip_type&quot;: &quot;16&quot; ,\n      &quot;ip_off&quot;: &quot;0&quot;,\n\n\n      &quot;ip_reserved&quot; : &quot;0&quot;,\n      &quot;ip_DoNotFragment&quot;: &quot;1&quot;,\n      &quot;ip_MoreFragment&quot;: &quot;1&quot;,\n\n\n\n      &quot;ip_len&quot;: &quot;200&quot;,\n      &quot;ip_id&quot;: &quot;4321&quot;,\n\n      &quot;ip_ttl&quot;: &quot;255&quot;,\n      &quot;ip_proto&quot;: &quot;6&quot;,\n     \n      &quot;ip_sum&quot;: &quot;0&quot;, \n      &quot;ip_src&quot;: &quot;1.2.3.4&quot;,\n      &quot;ip_dest&quot;:&quot;127.0.0.1&quot;,\n      &quot;ip_data&quot;: &quot;------&quot; ,\n\n      &quot;tcp_sourcePort&quot;: &quot;1000&quot;, \n      &quot;tcp_destPort&quot;: &quot;1000&quot;,\n\n      &quot;tcp_seqnum&quot; : &quot;0&quot;,\n      &quot;tcp_acknum&quot; : &quot;0&quot;,\n\n      &quot;tcp_reserved&quot; : &quot;4&quot;,\n      &quot;tcp_offset&quot; : &quot;5&quot;,\n\n\n      &quot;tcp_fin&quot; : &quot;0&quot;,\n      &quot;tcp_syn&quot; : &quot;1&quot;,\n      &quot;tcp_rst&quot; : &quot;0&quot;,\n      &quot;tcp_psh&quot; : &quot;0&quot;,\n      &quot;tcp_ack&quot; : &quot;1&quot;,\n      &quot;tcp_urg&quot; : &quot;0&quot;,\n\n\n      &quot;tcp_cwr&quot; : &quot;1&quot;,\n      &quot;tcp_ece&quot; : &quot;1&quot;,\n    \n\n      &quot;tcp_win&quot; : &quot;32767&quot;,\n      &quot;tcp_sum&quot;: &quot;0&quot;, \n      &quot;tcp_urp&quot; : &quot;0&quot;\n</code></pre>\n<hr />\n<p>Second Imput is the same. The different between first and the second Input is that i set for the ip flags a value of 0 instead of 1</p>\n<p>So if I use the First input i get in Wireshark somethink like this:</p>\n<p><a href=\"https://i.stack.imgur.com/Qc5Ig.png\" rel=\"nofollow noreferrer\">Output Wireshark for First Input</a></p>\n<hr />\n<p>If i use the Second Input, so for all Ip Flags the value 0, i get in Wireshark this output:</p>\n<p><a href=\"https://i.stack.imgur.com/2j8S9.png\" rel=\"nofollow noreferrer\">Output Wireshark for Second Input</a></p>\n<hr />\n<h1>SOURCE Code for Programm</h1>\n<pre><code>// Run as root or SUID 0,\n\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/ip.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/tcp.h&gt;\n\n// Packet length\n#define PCKT_LEN 8192\n\nstruct ipheader {\n    unsigned char ip_hl :4, ip_v :4;\n    unsigned char ip_tos :8;\n    unsigned short int ip_len :16;\n    unsigned short int ip_id :16;\n    unsigned short int ip_off :13;\n\n    unsigned short int ip_moreFrag :1, ip_doNotFrag:1, ip_reserved : 1;\n\n    unsigned char ip_ttl :8;\n    unsigned char ip_p :8;\n    unsigned short int ip_sum :16;\n    unsigned int iph_sourceip :32;\n    unsigned int iph_destip :32;\n};\n\n\n/* Structure of a TCP header */\nstruct tcpheader {\n    unsigned short int th_sport :16;\n    unsigned short int th_dport :16;\n    unsigned int th_seq :32;\n    unsigned int th_acknum :32;\n    unsigned char th_reserved :4, th_off :4;\n\n\n    unsigned short int th_fin :1, th_syn :1, th_rst :1, th_psh :1, th_ack :1,\n            th_urg :1, th_cwr :1, th_ece :1;\n\n\n    unsigned short int th_win :16;\n    unsigned short int th_sum :16;\n    unsigned short int th_urp :16;\n};\n\n\nunsigned short csum(unsigned short *buf, int len) {\n    unsigned long sum;\n    for (sum = 0; len &gt; 0; len--)\n        sum += *buf++;\n    sum = (sum &gt;&gt; 16) + (sum &amp; 0xffff);\n    sum += (sum &gt;&gt; 16);\n    return (unsigned short) (~sum);\n}\n\nint main(int argc, char *argv[]) {\n    int sd;\n\n    // No data, just datagram\n    char buffer[PCKT_LEN];\n\n    // The size of the headers\n    struct ipheader *ip = (struct ipheader *) buffer;\n    struct tcpheader *tcp = (struct tcpheader *) (buffer\n            + sizeof(struct ipheader));\n    struct sockaddr_in sin, din;\n\n    int one = 1;\n    const int *val = &amp;one;\n    memset(buffer, 0, PCKT_LEN);\n\n    sd = socket(PF_INET, SOCK_RAW, IPPROTO_RAW);\n    if (sd &lt; 0) {\n        perror(&quot;socket() error&quot;);\n        exit(-1);\n    } else\n        printf(&quot;socket()-SOCK_RAW and tcp protocol is OK.\\n&quot;);\n\n    // The source is redundant, may be used later if needed\n    // Address family\n    sin.sin_family = AF_INET;\n    din.sin_family = AF_INET;\n\n    // Source port, can be any, modify as needed\n    sin.sin_port = htons(atoi(&quot;1000&quot;));\n    din.sin_port = htons(atoi(&quot;1000&quot;));\n\n    // Source IP, can be any, modify as needed\n    sin.sin_addr.s_addr = inet_addr(&quot;1.2.3.4&quot;);\n    din.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;);\n\n    // IP structure\n    ip-&gt;ip_v = 4;\n    ip-&gt;ip_hl = 5;\n\n    ip-&gt;ip_tos = 16;\n    ip-&gt;ip_off = 0;\n\n    ip-&gt;ip_reserved = 1;\n    ip-&gt;ip_doNotFrag = 1;\n    ip-&gt;ip_moreFrag = 1;\n\n    ip-&gt;ip_len = htons(sizeof(struct ipheader) + sizeof(struct tcpheader));\n    ip-&gt;ip_id = htons(54321);\n    ip-&gt;ip_ttl = 255;\n    ip-&gt;ip_p = 6; // TCP\n    ip-&gt;ip_sum = 0; // Done by kernel\n\n    ip-&gt;iph_sourceip = inet_addr(&quot;1.2.3.4&quot;);\n\n    ip-&gt;iph_destip = inet_addr(&quot;127.0.0.1&quot;);\n\n    tcp-&gt;th_sport = htons(atoi(&quot;1000&quot;));\n\n    tcp-&gt;th_dport = htons(atoi(&quot;1000&quot;));\n    tcp-&gt;th_seq = htonl(0);\n    tcp-&gt;th_acknum = 0;\n    tcp-&gt;th_reserved = 4;\n    tcp-&gt;th_off = 5;\n\n\n    tcp-&gt;th_fin = 1;\n\n    tcp-&gt;th_syn = 1;\n    tcp-&gt;th_rst = 1;\n    tcp-&gt;th_psh = 1;\n    tcp-&gt;th_ack = 1;\n    tcp-&gt;th_urg = 1;\n    tcp-&gt;th_cwr = 1;\n\n    tcp-&gt;th_ece = 1;\n\n    tcp-&gt;th_win = htons(32767);\n    tcp-&gt;th_sum = 0; // Done by kernel\n    tcp-&gt;th_urp = 0;\n\n    // IP checksum calculation\n    ip-&gt;ip_sum = htons(\n            csum((unsigned short *) buffer,\n                    (sizeof(struct ipheader) + sizeof(struct tcpheader))));\n\n    // Inform the kernel do not fill up the headers' structure, we fabricated our own\n    if (setsockopt(sd, IPPROTO_IP, IP_HDRINCL, val, sizeof(one)) &lt; 0) {\n        perror(&quot;setsockopt() error&quot;);\n        exit(-1);\n    } else\n        printf(&quot;setsockopt() is OK\\n&quot;);\n\n    unsigned int count;\n\n    if (sendto(sd, buffer, ip-&gt;ip_len, 0, (struct sockaddr *) &amp;din, sizeof(din))\n            &lt; 0)\n            // Verify\n            {\n        perror(&quot;sendto() error&quot;);\n        exit(-1);\n    } else\n        printf(&quot;Count #%u - sendto() is OK\\n&quot;, count);\n\n    close(sd);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "nxp-microcontroller"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 2, "creation_date": 1547569261, "post_id": 54202812, "comment_id": 95232659, "body": "<code>&amp;</code> here is bitwise AND, you can rewrite it like <code>LPUART_GetStatusFlags(DEMO_LPUART) &amp; (kLPUART_RxDataRegFullFlag)</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547641867, "post_id": 54202812, "comment_id": 95259834, "body": "It might be clearer if we drop the crappy coding style with parenthesis disease: <code>if (kLPUART_RxDataRegFullFlag &amp; LPUART_GetStatusFlags(DEMO_LPUART))</code>. Now, if the question is what <code>flag_register &amp; mask</code> is supposed to do, then the answer is to study the bitwise operators."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 10917549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15f81df1e71ed4363b1c1d56e51588f?s=128&d=identicon&r=PG&f=1", "display_name": "The_Average_Engineer", "link": "https://stackoverflow.com/users/10917549/the-average-engineer"}, "edited": false, "score": 0, "creation_date": 1547663595, "post_id": 54203258, "comment_id": 95272377, "body": "Thank you for your answer, I got it now. It was mainly the syntax which was not clear for me. The fact that the &#39;&amp;&#39; character is stuck to the function name is very confusing."}], "tags": [], "owner": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "is_accepted": true, "score": 1, "last_activity_date": 1547570629, "creation_date": 1547570629, "answer_id": 54203258, "question_id": 54202812, "link": "https://stackoverflow.com/questions/54202812/calling-function-with-a-in-front-of-the-function-name/54203258#54203258", "title": "Calling function with a &#39;&amp;&#39; in front of the function name", "body": "<p>The ampersand is used in this case to invoke the bitwise AND operator between the return value of the <code>LPUART_GetStatusFlags</code> function and the constant <code>LPUART_STAT_RDRF_MASK</code>.</p>\n\n<p>Using the bitwise AND operator like this is a common way to test whether a specific flag is set.</p>\n\n<p>In your case the value of <code>kLPUART_RxDataRegFullFlag</code> is <code>0x200000</code> corresponding to the bit pattern <code>0000 0000 0010 0000 0000 0000 0000 0000</code>.</p>\n\n<p>So, the bitwise AND operation will evaluate to zero if bit number 22 is NOT set in the 32-bit return value of the <code>LPUART_GetStatusFlags</code> function. If it is set, the result will be non-zero and the code protected by the if-clause will be executed.</p>\n\n<p>By introducing a helper function such as this, the intent of the if-clause will be easier to understand.</p>\n\n<pre><code>static int RxDataRegisterIsFull(LPUART_Type *const uart)\n{\n    const uint32_t flags = LPUART_GetStatusFlags(uart);\n    const uint32_t mask = kLPUART_RxDataRegFullFlag;\n    return (flags &amp; mask) ? 1 : 0;\n}\n\n/* If new data arrived. */\nif (RxDataRegisterIsFull(DEMO_LPUART))\n{\n    ...\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 10917549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15f81df1e71ed4363b1c1d56e51588f?s=128&d=identicon&r=PG&f=1", "display_name": "The_Average_Engineer", "link": "https://stackoverflow.com/users/10917549/the-average-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 54203258, "answer_count": 1, "score": 1, "last_activity_date": 1547570629, "creation_date": 1547569074, "question_id": 54202812, "link": "https://stackoverflow.com/questions/54202812/calling-function-with-a-in-front-of-the-function-name", "title": "Calling function with a &#39;&amp;&#39; in front of the function name", "body": "<p>I am using the NXP SDK for a project.\nThe SDK contains several sample codes.\nOne of this sample is called \"lpuart_interrupt\".\nIn this example, the LPUART_GetStatusFlags function is used as following:</p>\n\n<pre><code>    /* If new data arrived. */\n    if ((kLPUART_RxDataRegFullFlag)&amp;LPUART_GetStatusFlags(DEMO_LPUART))\n    {\n      ...\n</code></pre>\n\n<p>What I do not understand is why there is a '&amp;' character in front of the function name ?\nHow the function is supposed to work when it is called in such a way ?</p>\n\n<p>The prototype of the function is as following:</p>\n\n<pre><code>    uint32_t LPUART_GetStatusFlags(LPUART_Type *base);\n</code></pre>\n\n<p>kLPUART_RxDataRegFullFlag is part of the following enum :</p>\n\n<pre><code>    enum _lpuart_flags\n    {\n        kLPUART_TxDataRegEmptyFlag = (LPUART_STAT_TDRE_MASK),\n        kLPUART_TransmissionCompleteFlag = (LPUART_STAT_TC_MASK),\n        kLPUART_RxDataRegFullFlag = (LPUART_STAT_RDRF_MASK),\n        ...\n    }\n</code></pre>\n\n<p>and LPUART_STAT_RDRF_MASK is defined as following:</p>\n\n<pre><code>    #define LPUART_STAT_RDRF_MASK (0x200000U)\n</code></pre>\n"}, {"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 10803, "user_id": 2548147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cfKie.jpg?s=128&g=1", "display_name": "Raymond Nijland", "link": "https://stackoverflow.com/users/2548147/raymond-nijland"}, "edited": false, "score": 0, "creation_date": 1547568829, "post_id": 54202564, "comment_id": 95232440, "body": "&quot;I&#39;m compiling from terminal this is the result&quot; which OS and compiler do you use and what command did you use.."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1547569103, "post_id": 54202564, "comment_id": 95232584, "body": "<a href=\"https://stackoverflow.com/questions/4379775/why-do-i-keep-getting-undefined-symbols-when-compiling-a-simple-mysql-c-applicat\" title=\"why do i keep getting undefined symbols when compiling a simple mysql c applicat\">stackoverflow.com/questions/4379775/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10286876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ae597fee51aa6e99e820bf1508c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "chicory__", "link": "https://stackoverflow.com/users/10286876/chicory"}, "edited": false, "score": 0, "creation_date": 1547577933, "post_id": 54202564, "comment_id": 95236819, "body": "I already tried to do it but this is the result <code>clang: error: argument to &#39;-l&#39; is missing (expected 1 value)</code>"}, {"owner": {"reputation": 1, "user_id": 10286876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ae597fee51aa6e99e820bf1508c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "chicory__", "link": "https://stackoverflow.com/users/10286876/chicory"}, "reply_to_user": {"reputation": 10803, "user_id": 2548147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cfKie.jpg?s=128&g=1", "display_name": "Raymond Nijland", "link": "https://stackoverflow.com/users/2548147/raymond-nijland"}, "edited": false, "score": 0, "creation_date": 1547633244, "post_id": 54202564, "comment_id": 95255007, "body": "@RaymondNijland hi, i&#39;m using macOS Mojave, my compiler is iTerm and I used this <code>gcc test.c</code>"}], "owner": {"reputation": 1, "user_id": 10286876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ae597fee51aa6e99e820bf1508c5b1?s=128&d=identicon&r=PG&f=1", "display_name": "chicory__", "link": "https://stackoverflow.com/users/10286876/chicory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1547568230, "creation_date": 1547568230, "question_id": 54202564, "link": "https://stackoverflow.com/questions/54202564/error-when-connect-my-c-script-to-a-mysql-online-database", "title": "Error when connect my C script to a MySQL online Database", "body": "<p>I'm trying to write a simple C script that can connect to an online MySQL Database. I have tried to use Connector/C (libmysqlclient) downloaded by <a href=\"https://dev.mysql.com/downloads/connector/c/\" rel=\"nofollow noreferrer\">https://dev.mysql.com/downloads/connector/c/</a> but don't work.\nLibrary  is recognized but when I'm compiling from terminal this is the result: <code>Undefined symbols for architecture x86_64: \"_mysql_init\", referenced from: _main in test.o ld: symbol(s) not found for architecture x86_64</code></p>\n\n<p>I tried to correct the error described above, but I can not solve the problem with any help.\nThis is my code test.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;mysql.h&gt;\n#define SIZE  30\n\n int main(int argc, char** argv) {\n /* connect to database */\n MYSQL mysql;   \n\n  if(mysql_init(&amp;mysql) == NULL){\n    printf(\"Error\\n\");\n    return 0;\n }\n\n /* other code */\n\n return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1547567682, "post_id": 54202271, "comment_id": 95231783, "body": "What have you tried so far to implement &quot;coluna&quot;? One simple and naive solution is to move all non-zero columns to the left."}, {"owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "reply_to_user": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1547641251, "post_id": 54202271, "comment_id": 95259531, "body": "hmmm, yes that should work! how could i do that?? because i only want to move the column when it becomes full of zeros not when it has one or more."}, {"owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "reply_to_user": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1547641316, "post_id": 54202271, "comment_id": 95259573, "body": "I&#39;ve tried to use the position given by the player to see if that column is full of zeros or not, but that would just move one column, and itwon&#39;t work..."}, {"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1547641876, "post_id": 54202271, "comment_id": 95259841, "body": "Well, check if the column is full of zeros, and if it is you just need to copy the contents of the immediately right column to it. This is the basic idea, but you may need to consider cases in which two or more subsequently columns are zero."}, {"owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "reply_to_user": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1547643291, "post_id": 54202271, "comment_id": 95260614, "body": "yes that&#39;s the problem... how would i fix that problme of 2 or more columns?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "edited": false, "score": 0, "creation_date": 1547641035, "post_id": 54202714, "comment_id": 95259421, "body": "Yes but the column should move to the left not down, you are cheking it for the rows not the colums"}, {"owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "edited": false, "score": 0, "creation_date": 1547641416, "post_id": 54202714, "comment_id": 95259619, "body": "Thank you for trying to help btw!"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1547569159, "last_edit_date": 1547569159, "creation_date": 1547568784, "answer_id": 54202714, "question_id": 54202271, "link": "https://stackoverflow.com/questions/54202271/i-cant-think-how-to-move-the-column/54202714#54202714", "title": "I can&#39;t think how to move the column", "body": "<p>How about the following:</p>\n\n<pre><code>int coluna(int sz, int tabuleiro[sz][sz])\n{\n    int i, j, k, m;\n    i= 0;\n    m= sz;\n    while (i&lt;m) {\n        int allzeroes= 1;\n        for (j=0; j&lt;sz; j++) {\n            if (tabuleiro[i][j]!=0) {\n                allzeroes= 0;\n                break;\n            }\n        }\n        if (allzeroes) {    // col i is all zeroes\n            // move all remaining cols down 1 col\n            for (j=i; j&lt;m-1; j++)\n                for (k=0; k&lt;sz; k++)\n                    tabuleiro[j][k]= tabuleiro[j+1][k];\n\n            // zero last column\n            for (k=0; k&lt;sz; k++)\n                tabuleiro[m-1][j]= 0;\n\n            // new last col that is not zero\n            m--;\n        }\n        else i++;\n    }\n    return 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "edited": false, "score": 0, "creation_date": 1547834686, "post_id": 54219348, "comment_id": 95342618, "body": "Thank you so much!"}, {"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "reply_to_user": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "edited": false, "score": 0, "creation_date": 1548094873, "post_id": 54219348, "comment_id": 95411875, "body": "@Miketue accept the answer if this solves your problem."}], "tags": [], "owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "is_accepted": true, "score": 0, "last_activity_date": 1547649280, "creation_date": 1547649280, "answer_id": 54219348, "question_id": 54202271, "link": "https://stackoverflow.com/questions/54202271/i-cant-think-how-to-move-the-column/54219348#54219348", "title": "I can&#39;t think how to move the column", "body": "<p>How about this (comments explain the code):</p>\n\n<pre><code>void coluna(int size, int board[size][size]){\n    int not_zeros[size]; // Use to save the index of columns that contain at \n                         // least one number different than zero.\n    int i, j;\n    for(i=0; i&lt;size; i++){\n        not_zeros[i] = -1; //initialize the array.\n\n    for (i=0; i&lt;size; i++){\n        int foundNotZero = 0;\n        for (j=0; j&lt;size; j++){\n            if(board[j][i] != 0){ //line j, column i.\n                foundNotZero = 1;\n                break;\n            }\n        }\n        if (foundNotZero == 1){ //at least one element of the column i is not zero.\n            not_zeros[i] = i;\n        }\n    }\n    int start = 0;\n    for(i=0; i&lt;size; i++){\n        if (not_zeros[i] &gt;= 0){ //copy column i to column start.\n            for(j = 0; j&lt;size; j++){\n                board[j][start] = board[j][not_zeros[i]];\n            }\n            start++; //increment start.\n        }\n    }\n    for(i=start; i&lt;size; i++){\n        for(j=0; j&lt;size; j++){\n            board[j][i] = 0; //fill the remaining columns with zeros.\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10917760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2436531dcc06d4af3cbcaecaefe11cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Miketue", "link": "https://stackoverflow.com/users/10917760/miketue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 54219348, "answer_count": 2, "score": 0, "last_activity_date": 1547649280, "creation_date": 1547567276, "question_id": 54202271, "link": "https://stackoverflow.com/questions/54202271/i-cant-think-how-to-move-the-column", "title": "I can&#39;t think how to move the column", "body": "<p>So i am making a game for my final work, its like \"the sample game\".\nI already made almost all the code but i can't find a solution for my last function, the fuction must see if the column is empty (full of zeros) and if so, send it to the right of all the other columns. here is my code (all the function must start with the arguments they have, its a part of the work) the fuction i am having problems is called \"colunas\":</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;//para poder usar char's e strings\n#include &lt;stdbool.h&gt;//para poder usar o while true\n#include &lt;time.h&gt;//para poder usar seeds diferentes na fun\u00e7ao srand\n\nint marcar(int sz, int tabuleiro[sz][sz], int x, int y)//vai contar o numero de quadrados do grupo\n{\n  int num=0;\n  for (x = 0; x &lt; sz; x++)\n  {\n    for (y = 0; y &lt; sz; y++)\n    {\n      if(tabuleiro[x][y] == 9)//os ciclos vao percorrer o tabuleiro e vao verificar os 0s\n      {\n        num=num+1;//num vai contar o numero de 0s\n      }\n    }\n  }\n  return num;//retornar o numero de 0s\n}\n\n//pontuacao\nint pontuacao(int num_quadrados)\n{\n  int pontos;\n  pontos=(num_quadrados*(num_quadrados + 1))/2;\n  return pontos;\n}\n\n\n//gravidade\n/*\nvoid gravidade(int sz, int tabuleiro[sz][sz])\n{\n  for (int i = 0; i &lt; sz+1; i++)\n  {\n    for (int j = 0; j &lt; sz; j++)\n    {\n      if (tabuleiro[i][j] == 9)\n      {\n        tabuleiro[i][j] = tabuleiro[i-1][j];\n        tabuleiro[i-1][j] = 9;\n      }\n    }\n  }\n}\n*/\n\nvoid gravidade(int sz, int tabuleiro[sz][sz])\n{\n  int c = 0;\n  while(c &lt; sz)//utilizamos esta variavel apra percorrer o ciclo todas as vezes necessarias para fazer todos os 9s subir\n  {\n    for (int i = 0; i &lt; sz-1; i++)//percorre as linhas\n    {\n      for (int j = 0; j &lt; sz; j++)//percorre as colunas\n      {\n        if (tabuleiro[i][j] == 9 &amp;&amp; i &lt; sz-1)\n        {\n          tabuleiro[i][j] = tabuleiro[i+1][j];//muda o valor do zero para o valor acima \n          tabuleiro[i+1][j] = 9;//muda o valor que esta acima do valor copiado, para 0\n        }\n      }\n    }\n  c++;\n  }\n}\n\n\n//jogada\nint jogada(int sz, int tabuleiro[sz][sz], int x, int y)\n{\n  if((x&gt;=0 &amp;&amp; x&lt;sz) &amp;&amp; (y&gt;=0  &amp;&amp; y&lt;sz))//definimos o limite do x e do y\n  {\n    int temp = tabuleiro[x][y];\n    tabuleiro[x][y] = 9;  //alterar o valor de tabuleiro para impedir as chamadas infinitas da recursividade\n    if(tabuleiro[x+1][y] == temp)//para verificar a direita\n    {\n      jogada(sz, tabuleiro, x+1, y);//chamar a fun\u00e7\u00e3o recursivamente\n    }\n    if (tabuleiro[x-1][y] == temp)//para verificar a esquerda\n    {\n      jogada(sz, tabuleiro, x-1, y);\n    }\n    if (tabuleiro[x][y+1] == temp)//para verificar em cima\n    {\n      jogada(sz, tabuleiro, x, y+1);\n    } if(tabuleiro[x][y-1] == temp)//para verificar em baixo\n    {\n      jogada(sz, tabuleiro, x, y-1);\n    }\n  }\n  return 0;\n}\n\nvoid troca(int sz, int tabuleiro[sz][sz])//mudar o zero para o proximo ciclo ele nao contar com os zeros da jogada anterior\n{\n  for (int x = 0; x &lt; sz; x++)\n  {\n    for (int y = 0; y &lt; sz; y++)\n    {\n      if(tabuleiro[x][y] == 9)//os ciclos vao percorrer o tabuleiro e vao verificar os 0s\n      {\n        tabuleiro[x][y] = 0;//vao passar os 9 todos a 0\n      }\n    }\n  }\n}\n\n//mover as colunas vazias\nint coluna(int sz, int tabuleiro[sz][sz])\n{\n  //this is the function i cant solve\n}\n\n//Mostra o tabuleiro\nvoid mostrar(int sz, int tabuleiro[sz][sz])\n{\n  for (int i = sz-1; i &gt;= 0; i--)//for para o numero de linhas, usamos o sz-1 pois o indice do array come\u00e7a no 0 e i&gt;=0 para poder chegar ao indice 0\n  {\n    for (int j = 0; j &lt; sz; j++) //for para o numero de colunas\n    {\n      printf(\"%d\", tabuleiro[i][j]); //print das linhas\n    }\n    printf(\"\\n\");//baixar a linha quando chega a coluna n-1\n  }\n}\n\n//main\nint main()\n{\n  //defini\u00e7\u00e3o do tabuleiro\n  int sz;//size do tabuleiro\n  printf(\"Escolha o valor de n (da matriz n*n):\\n\");\n  scanf(\"%d\", &amp;sz);//scan do size\n  printf(\"\\n\");\n  int tabuleiro[sz][sz];//o size \u00e9 igual para as colunas como para as linhas pois a matriz \u00e9 n*n\n  srand(time(NULL));//fun\u00e7\u00e3o utilizada para alterar a seed do rand (gerador de valores aleat\u00f3rios)\n  for (int i = 0; i &lt; sz; i++)//for para o numero de linhas, usamos o sz-1 pois o indice do array come\u00e7a no 0 e i&gt;=0 para poder chegar ao indice 0\n  {\n    for (int j = 0; j &lt; sz; j++)//for para o numero de colunas\n    {\n      tabuleiro[i][j] = rand() %4 + 1;//gerar a matriz com valores aleat\u00f3rios\n    }\n  } \n\n  int jx, jy, mx, my, pontos;\n  pontos=0;\n\n  while(true)\n  {\n    for (int i = 0; i &lt; sz; i++)\n    {\n      for (int j = 0; j &lt; sz; j++)\n      {\n          mostrar(sz, tabuleiro);\n          printf(\"\\n\");\n\n          printf(\"(0,0) e o canto inferior esquerdo\\n\");\n          printf(\"Escolha o x (lembrando que x = x+1 linhas exemplo x(1) = linha 2):\\n\");//acontece devido ao \u00edndice come\u00e7ar no 0 e n\u00e3o no 1\n          scanf(\"%d\", &amp;jx);\n          printf(\"\\n\");\n\n          printf(\"Escolha o y (lembrando que y = y+1 colunas exemplo y(1) = coluna 2):\\n\");//acontece devido ao \u00edndice come\u00e7ar no 0 e n\u00e3o no 1\n          scanf(\"%d\", &amp;jy);\n\n          if(tabuleiro[jx][jy] != 0) //utilizamos este if para condicionar a posicao pois se escolher 0 ele contava os pontos de todos os zeros juntos\n          {\n            jogada(sz, tabuleiro, jx, jy);\n            printf(\"\\n\");\n\n            gravidade(sz, tabuleiro);//assim sempre que uma jogada \u00e9 executada ele faz a fun\u00e7ao gravidade\n\n            int p = marcar(sz, tabuleiro, mx, my);\n            pontuacao(p);\n\n            pontos=pontos+pontuacao(p);\n\n            printf(\"Pontos:\\n\");\n            printf(\"%d\\n\", pontos);\n            printf(\"\\n\");\n\n            troca(sz, tabuleiro);\n          }\n          else\n          {\n            printf(\"\\n\");\n            printf(\"Nao e possivel escolher uma posicao onde o valor de tabuleiro[x][y] seja 0\\n\");\n            printf(\"\\n\");\n          }\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>i am hoping for help,\nthank you for the time spent.</p>\n"}, {"tags": ["c", "unicode", "io", "text-files", "special-characters"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547563256, "post_id": 54200889, "comment_id": 95228946, "body": "Your call to <code>fgets</code> is wrong - should be <code>fgets(wyp-&gt;line, 200*sizeof(wchar_t), dyktando)</code> as <code>sizeof(dyk)</code> includes the &quot;next&quot; as well"}, {"owner": {"reputation": 29, "user_id": 9185485, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vqeF1lr6bP0/AAAAAAAAAAI/AAAAAAAAADM/sT3E_Wq1zNU/photo.jpg?sz=128", "display_name": "Amatheon", "link": "https://stackoverflow.com/users/9185485/amatheon"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547564130, "post_id": 54200889, "comment_id": 95229534, "body": "@ChrisTurner thank you! I solved problem about printing text on screen, but have quetion, why there is 200 not 100, and why there&#39;s no &amp; near wyp-&gt;line?  And there&#39;s problem with strcmp, 2 strings show same character fe. \u017c, but result is still -1"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547564372, "post_id": 54200889, "comment_id": 95229698, "body": "It is 200 as that is the size of your array in <code>dyk</code>. <code>strcmp</code> is designed to work with <code>char</code> so I&#39;m not sure if it&#39;ll work with multibyte characters. You don&#39;t need the &amp; as the array will turn into a pointer"}, {"owner": {"reputation": 29, "user_id": 9185485, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vqeF1lr6bP0/AAAAAAAAAAI/AAAAAAAAADM/sT3E_Wq1zNU/photo.jpg?sz=128", "display_name": "Amatheon", "link": "https://stackoverflow.com/users/9185485/amatheon"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547564700, "post_id": 54200889, "comment_id": 95229893, "body": "oh right, thanks. Don&#39;t you know if there&#39;s smth I can switch with this <code>strcmp</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9185485, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vqeF1lr6bP0/AAAAAAAAAAI/AAAAAAAAADM/sT3E_Wq1zNU/photo.jpg?sz=128", "display_name": "Amatheon", "link": "https://stackoverflow.com/users/9185485/amatheon"}, "edited": false, "score": 0, "creation_date": 1547565928, "post_id": 54201628, "comment_id": 95230662, "body": "ohhh, now I understand something. I used <code>fgets</code>, because <code>fgetws</code> gave me bad result. But all of that is because <code>fgetws</code> want length in characters, so <code>sizeof</code> won&#39;t work properly! Could you navigate me how should proper <code>fgetws</code> looks like?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 29, "user_id": 9185485, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vqeF1lr6bP0/AAAAAAAAAAI/AAAAAAAAADM/sT3E_Wq1zNU/photo.jpg?sz=128", "display_name": "Amatheon", "link": "https://stackoverflow.com/users/9185485/amatheon"}, "edited": false, "score": 0, "creation_date": 1547565967, "post_id": 54201628, "comment_id": 95230677, "body": "@Amatheon Hint: Given the length of a <code>wchar_t</code> buffer in bytes, how would you translate that to the length in <code>wchar_t</code>s?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 29, "user_id": 9185485, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vqeF1lr6bP0/AAAAAAAAAAI/AAAAAAAAADM/sT3E_Wq1zNU/photo.jpg?sz=128", "display_name": "Amatheon", "link": "https://stackoverflow.com/users/9185485/amatheon"}, "edited": false, "score": 0, "creation_date": 1547567893, "post_id": 54201628, "comment_id": 95231920, "body": "The size of an array in elements can be determined by using <code>sizeof(buffer)&#47;sizeof(data_type)</code>"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1547581095, "last_edit_date": 1547581095, "creation_date": 1547564963, "answer_id": 54201628, "question_id": 54200889, "link": "https://stackoverflow.com/questions/54200889/polish-characters-in-c-using-files-and-lists/54201628#54201628", "title": "Polish characters in C using files and lists", "body": "<p>You are not using <code>wchar_t</code> compatible functions everywhere in your code. In particular:</p>\n\n<pre><code>fgets(&amp;wyp-&gt;line, sizeof(dyk), dyktando);           //reading from file and send to the list\n</code></pre>\n\n<p>The <code>wchar_t</code> compatible version is <a href=\"http://www.cplusplus.com/reference/cwchar/fgetws/\" rel=\"nofollow noreferrer\"><code>fgetws</code></a>. Also, <code>wyp-&gt;line</code> (without the <code>&amp;</code> operator) is the correct argument.</p>\n\n<pre><code>int n=strcmp(yt, wyp-&gt;line);                        //str compare\n</code></pre>\n\n<p><a href=\"http://www.cplusplus.com/reference/cwchar/wcscmp/\" rel=\"nofollow noreferrer\"><code>wcscmp</code></a> should be used instead.</p>\n\n<p>Also note that <code>sizeof</code> on a <code>wchar_t</code> array is not correct when a function expects length in <em>characters</em> rather than <em>bytes</em> (like <code>fgetws</code> does).</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1547605642, "creation_date": 1547605642, "answer_id": 54209591, "question_id": 54200889, "link": "https://stackoverflow.com/questions/54200889/polish-characters-in-c-using-files-and-lists/54209591#54209591", "title": "Polish characters in C using files and lists", "body": "<p>A comment OP (Amatheon) made indicates that the true underlying problem is how to properly read files using wide-character functions.</p>\n\n<p>To ensure maximum compatibility and portability, let's restrict to C99. Consider the following example program:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;wctype.h&gt;\n#include &lt;errno.h&gt;\n\n#ifdef   USE_ERRNO_CONSTANTS\n#define  SET_ERRNO(value)  (errno = (value))\n#else\n#define  SET_ERRNO(value)\n#endif\n\nssize_t get_wide_delimited(wchar_t **lineptr, size_t *sizeptr, wint_t delim, FILE *stream)\n{\n    wchar_t  *line = NULL;\n    size_t    size = 0;\n    size_t    used = 0;\n    wint_t    wc;\n\n    if (!lineptr || !sizeptr || !stream) {\n        /* Invalid function parameters. NULL pointers are not allowed. */\n        SET_ERRNO(EINVAL);\n        return -1;\n    }\n    if (ferror(stream)) {\n        /* Stream is already in error state. */        \n        SET_ERRNO(EIO);\n        return -1;\n    }\n\n    if (*sizeptr &gt; 0) {\n        line = *lineptr;\n        size = *sizeptr;\n    } else {\n        *lineptr = NULL;\n    }\n\n    while (1) {\n\n        wc = fgetwc(stream);\n        if (wc == WEOF || wc == delim)\n            break;\n\n        if (used + 1 &gt; size) {\n            /* Growth policy.  We wish to allocate a chunk of memory at once,\n               so we don't need to do realloc() too often as it is a bit slow,\n               relatively speaking.  On the other hand, we don't want to do\n               too large allocations, because that would waste memory.\n               Anything that makes 'size' larger than 'used' will work.\n            */\n            if (used &lt; 254)\n                size = 256;\n            else\n            if (used &lt; 65536)\n                size = 2 * used;\n            else\n                size = (used | 65535) + 65521;\n\n            line = realloc(line, size * sizeof (wchar_t));\n            if (!line) {\n                /* Out of memory. */\n                SET_ERRNO(ENOMEM);\n                return -1;\n            }\n\n            *lineptr = line;\n            *sizeptr = size;\n        }\n\n        line[used++] = wc;\n    }\n\n    if (wc == WEOF) {\n        /* Verify that the WEOF did not indicate a read error. */\n        if (ferror(stream)) {\n            /* Read error. */\n            SET_ERRNO(EIO);\n            return -1;\n        }\n    }\n\n    /* Ensure there is enough room for the delimiter and end-of-string mark. */\n    if (used + 2 &gt; size) {\n        /* We could reuse the reallocation policy here,\n           with the exception that the minimum is used + 2, not used + 1.\n           For simplicity, we use the minimum reallocation instead.\n        */\n        size = used + 2;\n        line = realloc(line, size * sizeof (wchar_t));\n        if (!line) {\n            /* Out of memory. */\n            SET_ERRNO(ENOMEM);\n            return -1;\n        }\n        *lineptr = line;\n        *sizeptr = size;\n    }\n\n    /* Append the delimiter, unless end-of-stream mark. */\n    if (wc != WEOF)\n        line[used++] = wc;\n\n    /* Append the end-of-string nul wide char,\n       but do not include it in the returned length. */\n    line[used] = L'\\0';\n\n    /* Success! */\n    return (ssize_t)used;\n}\n\nssize_t get_wide_line(wchar_t **lineptr, size_t *sizeptr, FILE *stream)\n{\n    return get_wide_delimited(lineptr, sizeptr, L'\\n', stream);\n}\n\nint main(int argc, char *argv[])\n{\n    wchar_t       *line = NULL, *p;\n    size_t         size = 0;\n    unsigned long  linenum;\n    FILE          *in;\n    int            arg;\n\n    if (!setlocale(LC_ALL, \"\"))\n        fprintf(stderr, \"Warning: Your C library does not support your current locale.\\n\");\n    if (fwide(stdout, 1) &lt; 1)\n        fprintf(stderr, \"Warning: Your C library does not support wide standard output.\\n\");\n\n    if (argc &lt; 2 || !strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\")) {\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"Usage: %s [ -h | --help ]\\n\", argv[0]);\n        fprintf(stderr, \"       %s FILENAME [ FILENAME ... ]\\n\", argv[0]);\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"This program will output the named files, using wide I/O.\\n\");\n        fprintf(stderr, \"\\n\");\n        return EXIT_FAILURE;\n    }\n\n    for (arg = 1; arg &lt; argc; arg++) {\n\n        in = fopen(argv[arg], \"r\");\n        if (!in) {\n            fprintf(stderr, \"%s: %s.\\n\", argv[arg], strerror(errno));\n            return EXIT_FAILURE;\n        }\n\n        if (fwide(in, 1) &lt; 1) {\n            fprintf(stderr, \"%s: Wide input is not supported from this file.\\n\", argv[arg]);\n            fclose(in);\n            return EXIT_FAILURE;\n        }\n\n        linenum = 0;\n\n        while (get_wide_line(&amp;line, &amp;size, in) &gt; 0) {\n            linenum++;\n\n            /* We use another pointer to the line for simplicity.\n               We must not modify 'line' (except via 'free(line); line=NULL; size=0;'\n               or a similar reallocation), because it points to dynamically allocated buffer. */\n            p = line;\n\n            /* Remove leading whitespace. */\n            while (iswspace(*p))\n                p++;\n\n            /* Trim off the line at the first occurrence of newline or carriage return.\n               (The line will also end at the first embedded nul wide character, L'\\0',\n                if the file contains any.) */\n            p[wcscspn(p, L\"\\r\\n\")] = L'\\0';\n\n            wprintf(L\"%s: Line %lu: '%ls', %zu characters.\\n\", argv[arg], linenum, p, wcslen(p));\n        }\n\n        if (ferror(in)) {\n            fprintf(stderr, \"%s: Read error.\\n\", argv[arg]);\n            fclose(in);\n            return EXIT_FAILURE;\n        }\n        if (fclose(in)) {\n            fprintf(stderr, \"%s: Delayed read error.\\n\", argv[arg]);\n            return EXIT_FAILURE;\n        }\n\n        wprintf(L\"%s: Total %lu lines read.\\n\", argv[arg], linenum);\n        fflush(stdout);\n    }\n\n    free(line);\n    line = NULL;\n    size = 0;\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Because the <code>EINVAL</code>, <code>EIO</code>, and <code>ENOMEM</code> errno constants are not defined in the C standards, the <code>get_wide_line()</code> and <code>get_wide_delimited()</code> only set <code>errno</code> if you define the <code>USE_ERRNO_CONSTANTS</code> preprocessor value.</p>\n\n<p>The <code>get_wide_line()</code> and <code>get_wide_delimited()</code> are reimplementations of the <code>getwline()</code> and <code>getwdelim()</code> functions from ISO/IEC TR 24731-2:2010; the wide-character equivalents of the POSIX.1 <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> and <a href=\"http://man7.org/linux/man-pages/man3/getdelim.3.html\" rel=\"nofollow noreferrer\"><code>getdelim()</code></a> functions. Unlike <code>fgets()</code> or <code>fgetws()</code>, these use a dynamically allocated buffer to hold the line, so there is no fixed line length limits, other than available memory.</p>\n\n<p>I've explicitly marked the code to be under <a href=\"https://creativecommons.org/share-your-work/public-domain/cc0/\" rel=\"nofollow noreferrer\">Creative Commons Zero</a> license: <em>No Rights Reserved</em>. It means you can use it in your own code, under whatever license you want.</p>\n\n<p>Note: I would really love users to push their vendors and C standard committee members to get these included in the bog-standard C library part in the next version of the C standard.  As you can see from above, they can be implemented in standard C already; it is just that the C library itself can do the same much more efficiently.  The GNU C library is a perfect example of that (although even they are stalling with the implementation, because lack of standardization).  Just think how many buffer overflow bugs would be avoided if people used <code>getline()</code>/<code>getdelim()</code>/<code>getwline()</code>/<code>getwdelim()</code> instead of <code>fgets()</code>/<code>fgetws()</code>! And avoid having to think about what the maximum reasonable line length in each instance would be to, too.  Win-win!</p>\n\n<p>(In fact, we could switch the return type to <code>size_t</code>, and use <code>0</code> instead of <code>-1</code> as the error indicator.  That would limit the changes to the text of the C standard to the addition of the four functions.  It saddens and irritates me to no end, to have such a significant group of trivial functions so callously and ignorantly overlooked, for no sensible reason.  Please, bug your vendors and any C standards committee members you have access to about this, as incessantly and relentlessly as you can manage. Both you and they deserve it.)</p>\n\n<p>The essential parts of the program are</p>\n\n<ul>\n<li><p><code>if (!setlocale(LC_ALL, \"\"))</code></p>\n\n<p>This tells the C library to use the locale the user has specified.</p>\n\n<p>Please, do not hardcode the locale value into your programs.  In most operating systems, all you need to do is to change the <code>LANG</code> or <code>LC_ALL</code> environment variable to the locale you want to use, before running your program.</p>\n\n<p>You might think that <em>\"well, I can hardcode it this time, because this is the locale used for this data\"</em>, but even that can be a mistake, because new locales can be created at any time.  This is particularly annoying when the character set part is hardcoded. For example, the ISO 8859 single-byte character set used in Western Europe is ISO 8859-15, not ISO 8859-1, because ISO 8859-15 has the \u20ac character in it, whereas ISO 8859-1 does not.  If you have hardcoded ISO 8859-1 in your program, then it cannot correctly handle the \u20ac character at all.<br>&nbsp;</p></li>\n<li><p><code>if (fwide(stream, 1) &lt; 1)</code> for both <code>stdout</code> and file handles</p>\n\n<p>While the C library does internally do an equivalent of the <a href=\"http://man7.org/linux/man-pages/man3/fwide.3.html\" rel=\"nofollow noreferrer\"><code>fwide()</code></a> call based on which type of I/O function you use on the file handle the very first time, the explicit check is much better.</p>\n\n<p>In particular, if the C library cannot support wide I/O to the file or stream represented by the handle, <code>fwide()</code> will return negative. (Unless the second parameter is also zero, it should never return zero; because of the issues in standardization, I recommend a strict return value check approach in this case, to catch vendors who decide to try to make life as difficult as possible for programmers trying to write portable code while technically still fulfilling the standard text, like Microsoft is doing.  They even stuffed the C standard committee with their own representatives, so they could tweak C11 away from C99 features they didn't want to support, plus get a stamp of approval of their own nonstandard extensions nobody used before, to help create barriers for developers writing portable C code. Yeah, I don't trust their behaviour at all.)<br>&nbsp;</p></li>\n<li><p><code>ssize_t len = get_wide_line(&amp;line, &amp;size, handle);</code></p>\n\n<p>If you initialize <code>wchar_t *line = NULL;</code> and <code>size_t  size = 0;</code> prior to first call to <code>get_wide_line()</code> or <code>get_wide_delimited()</code>, the function will dynamically resize the buffer as needed.</p>\n\n<p>The return value is negative if and only if an error occurs. (The functions should never return zero.)</p>\n\n<p>When a line is read successfully, the return value reflects the number of wide characters in the buffer, including the delimiter (newline, <code>L'\\n'</code> for <code>get_wide_delimited()</code>), and is always positive (greater than zero). The contents in the buffer will have a terminating end-of-wide-string character, <code>L'\\0'</code>, but it is not counted in the return value.</p>\n\n<p>Note that when the delimiter is not <code>L'\\0'</code>, the buffer may contain embedded wide nul characters, <code>L'\\0'</code>. In that case, <code>len &gt; wcslen(line)</code>.</p>\n\n<p>The above example programs skips any leading whitespace on each input line, and trims off the line at the first linefeed (<code>L'\\n'</code>), carriage return (<code>L'\\r'</code>), or nul (<code>L'\\0'</code>). Because of this, the return value <code>len</code> is only checked for success (a positive return value greater than zero).<br>&nbsp;</p></li>\n<li><p><code>free(line); line = NULL; size = 0;</code></p>\n\n<p>It is okay to discard the line at any point its contents are no longer needed.  I recommend explicitly setting the line pointer to NULL, and the size to zero, to avoid use-after-free bugs.  Furthermore, that allows any following <code>get_wide_line()</code> or <code>get_wide_delimited()</code> to correctly dynamically allocate a new buffer.<br>&nbsp;</p></li>\n<li><p><code>ferror(handle)</code> after a wide input function fails</p>\n\n<p>Just like with narrow streams and EOF, there are two cases why wide input functions might return <code>WEOF</code> (or return -1, depending on the function): because there is no more input, or because a read error occurred.</p>\n\n<p>There is no reason whatsoever to write computer programs that ignore read or write errors, without reporting them to the user.  Sure, they are rare, but not so rare that a programmer can sanely expect them to never occur.  (In fact, with Flash memory on flimsy circuits stored in weak plastic housings and subjected to human-sized stresses (I've sat on mine time and time again), the errors aren't that rare.)  It is just evil, rather similar to food preparers being too lazy to wash their hands, causing fecal bacteria outbreaks every now and then.  Don't be a fecal bacteria spreader equivalent programmer.</p></li>\n</ul>\n\n<hr>\n\n<p>Let's say you have a harebrained lecturer who does not allow you to use the above <code>get_wide_line()</code> or <code>get_wide_delimited()</code> functions.</p>\n\n<p>Don't worry. We can implement the same program using <a href=\"http://man7.org/linux/man-pages/man3/fgetws.3.html\" rel=\"nofollow noreferrer\"><code>fgetws()</code></a>, if we restrict line to some fixed upper limit (of wide characters). Lines longer than that will read as two or more lines instead:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;wctype.h&gt;\n#include &lt;errno.h&gt;\n\n#ifndef  MAX_WIDE_LINE_LEN\n#define  MAX_WIDE_LINE_LEN  1023\n#endif\n\nint main(int argc, char *argv[])\n{\n    wchar_t        line[MAX_WIDE_LINE_LEN + 1], *p;\n    unsigned long  linenum;\n    FILE          *in;\n    int            arg;\n\n    if (!setlocale(LC_ALL, \"\"))\n        fprintf(stderr, \"Warning: Your C library does not support your current locale.\\n\");\n    if (fwide(stdout, 1) &lt; 1)\n        fprintf(stderr, \"Warning: Your C library does not support wide standard output.\\n\");\n\n    if (argc &lt; 2 || !strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\")) {\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"Usage: %s [ -h | --help ]\\n\", argv[0]);\n        fprintf(stderr, \"       %s FILENAME [ FILENAME ... ]\\n\", argv[0]);\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"This program will output the named files, using wide I/O.\\n\");\n        fprintf(stderr, \"\\n\");\n        return EXIT_FAILURE;\n    }\n\n    for (arg = 1; arg &lt; argc; arg++) {\n\n        in = fopen(argv[arg], \"r\");\n        if (!in) {\n            fprintf(stderr, \"%s: %s.\\n\", argv[arg], strerror(errno));\n            return EXIT_FAILURE;\n        }\n\n        if (fwide(in, 1) &lt; 1) {\n            fprintf(stderr, \"%s: Wide input is not supported from this file.\\n\", argv[arg]);\n            fclose(in);\n            return EXIT_FAILURE;\n        }\n\n        linenum = 0;\n\n        while (1) {\n\n            /* If line is an array, (sizeof line / sizeof line[0]) evaluates to\n               the number of elements in it.  This does not work if line is a pointer\n               to dynamically allocated memory.  In that case, you need to remember\n               number of wide characters you allocated for in a separate variable,\n               and use that variable here instead. */\n            p = fgetws(line, sizeof line / sizeof line[0], in);\n            if (!p)\n                break;\n\n            /* Have a new line. */\n            linenum++;\n\n            /* Remove leading whitespace. */\n            while (iswspace(*p))\n                p++;\n\n            /* Trim off the line at the first occurrence of newline or carriage return.\n               (The line will also end at the first embedded nul wide character, L'\\0',\n                if the file contains any.) */\n            p[wcscspn(p, L\"\\r\\n\")] = L'\\0';\n\n            wprintf(L\"%s: Line %lu: '%ls', %zu characters.\\n\", argv[arg], linenum, p, wcslen(p));\n        }\n\n        if (ferror(in)) {\n            fprintf(stderr, \"%s: Read error.\\n\", argv[arg]);\n            fclose(in);\n            return EXIT_FAILURE;\n        }\n        if (fclose(in)) {\n            fprintf(stderr, \"%s: Delayed read error.\\n\", argv[arg]);\n            return EXIT_FAILURE;\n        }\n\n        wprintf(L\"%s: Total %lu lines read.\\n\", argv[arg], linenum);\n        fflush(stdout);\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Aside from the function used to read each line, the difference is that instead of keeping the while loop condition as <code>while ((p = fgetws(line, ...))) { ... }</code>, I changed to the <code>while (1) { p = fgetws(line, ...); if (!p) break; ...</code> form that I believe is more readable.</p>\n\n<p>I did deliberately show the longer, more complicated-looking one first, and this simpler one last, in the hopes that you would see that the more complicated-looking one actually has the simpler <code>main()</code> -- if we don't just count lines of code or something equally silly, but look at how many opportunities for mistakes there are.</p>\n\n<p>As OP themselves wrote in a comment, the size of the buffer passed to <code>fgets()</code> or <code>fgetws()</code> is a real issue. There are rules of thumb, but they all suffer from being fragile against edits (especially the differences between arrays and pointers). With <code>getline()</code>/<code>getdelim()</code>/<code>getwline()</code>/<code>getwdelim()</code>/<code>get_wide_line()</code>/<code>get_wide_delimited()</code>, the rule of thumb is <code>wchar_t *line = NULL; size_t size = 0; ssize_t len;</code> and <code>len = get_wide_line(&amp;line, &amp;size, handle);</code>. No variations, and simple to remember and use.  Plus it gets rid of any fixed limitations.</p>\n"}], "owner": {"reputation": 29, "user_id": 9185485, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vqeF1lr6bP0/AAAAAAAAAAI/AAAAAAAAADM/sT3E_Wq1zNU/photo.jpg?sz=128", "display_name": "Amatheon", "link": "https://stackoverflow.com/users/9185485/amatheon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1547605642, "creation_date": 1547562558, "last_edit_date": 1547583515, "question_id": 54200889, "link": "https://stackoverflow.com/questions/54200889/polish-characters-in-c-using-files-and-lists", "title": "Polish characters in C using files and lists", "body": "<p>I need to get proper Polish characters \"\u0105\u0119\u017c\u017a\u0107\u015b\u00f3\u0142\". I used some solutions like <code>setlocale</code>, <code>system chcp</code>, <code>wchar_t</code>. Everything goes well as long as I don't use files/lists. <code>wscanf</code>, <code>wprintf</code> and <code>wchar_t</code> works perfectly.</p>\n\n<p>But if I'm trying to read something from a file and save that into a list (even in array), then trying to put that to the screen, I can't get proper Polish characters, and in case of the lists, I'm getting different results from time to time for example, <strong>z`</strong> , <strong>A2</strong> , like random characters from nowhere. I've been trying to get good results by using <code>fscanf</code> and <code>fgets</code> with w(wide) variations, but it doesn't work. Did I something wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;locale.h&gt;\n\nstruct dyk{\n    wchar_t line[200];                             \n    struct dyk *next;                             \n};\n\ntypedef struct dyk dyk;\n\n\nvoid printdyk(char name[100]){\n    dyk *wyp;\n    wyp = malloc(sizeof(dyk));\n    wchar_t yt[100];\n    FILE *dyktando;\n    dyktando = fopen(name, \"r+\");\n    if(dyktando == NULL){\n        wprintf(L\"B\u0142\u0105d otwarcia pliku!\\n\");                 //Can't open file\n    }else{\n        fgets(&amp;wyp-&gt;line, sizeof(dyk), dyktando);           //reading from file and send to the list\n        wprintf(L\"%s\\n\", wyp-&gt;line);                        //write text from the list on the screen\n        wchar_t yt[100];\n        wscanf(L\"%s\", &amp;yt);                                 //testing strings comparing, so I have to put some variables\n        int n=strcmp(yt, wyp-&gt;line);                        //str compare\n        printf(\"%d\", n);                                //result, it gives me -1 every time\n    }\n    fclose(dyktando);\n}\n</code></pre>\n\n<p>I tested function with txt file that contents only one character \"\u017c\". Can't read from file properly. At the start of main function I put these 2 lines: </p>\n\n<pre><code>system(\"chcp 852\");\nsetlocale(LC_ALL, \".852\");\n</code></pre>\n\n<p>I'm using codeblock, mingw32-gcc compiler, and no flags.</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 6904, "user_id": 60462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/64fd87fd2c140ee93f638a624bcc97c9?s=128&d=identicon&r=PG", "display_name": "Volker Stolz", "link": "https://stackoverflow.com/users/60462/volker-stolz"}, "edited": false, "score": 1, "creation_date": 1547562380, "post_id": 54200804, "comment_id": 95228339, "body": "Please add the stacktrace from a debugger, e.g. <code>gdb</code>."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1547562484, "post_id": 54200804, "comment_id": 95228409, "body": "Where is the code that allocates memory for <code>addressCpy</code> so you can <code>strcpy</code> into it?"}, {"owner": {"reputation": 2432, "user_id": 4700841, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ab51f7e9a70996576549b5c611a2833?s=128&d=identicon&r=PG&f=1", "display_name": "Persistence", "link": "https://stackoverflow.com/users/4700841/persistence"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547562570, "post_id": 54200804, "comment_id": 95228464, "body": "@ChrisTurner that may be the problem... I thought <code>strcpy</code> did that itself... It seems to work with the second function call commented out though"}], "answers": [{"comments": [{"owner": {"reputation": 2432, "user_id": 4700841, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ab51f7e9a70996576549b5c611a2833?s=128&d=identicon&r=PG&f=1", "display_name": "Persistence", "link": "https://stackoverflow.com/users/4700841/persistence"}, "edited": false, "score": 0, "creation_date": 1547562772, "post_id": 54200917, "comment_id": 95228607, "body": "Yep, adding <code>addressCpy = malloc(200)</code> worked... Thanks!"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 2432, "user_id": 4700841, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ab51f7e9a70996576549b5c611a2833?s=128&d=identicon&r=PG&f=1", "display_name": "Persistence", "link": "https://stackoverflow.com/users/4700841/persistence"}, "edited": false, "score": 2, "creation_date": 1547563056, "post_id": 54200917, "comment_id": 95228785, "body": "@Persistence That won&#39;t work if <code>bill-&gt;address</code> is longer than 199 characters...it would be better to use <code>strlen(bill-&gt;address)+1</code> to ensure you allocate enough space. Or use <code>strdup</code> which does the <code>malloc</code> and <code>strcpy</code> in one function call"}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1547565687, "post_id": 54200917, "comment_id": 95230496, "body": "@Chris Turner Note that <code>strdup</code> is not part of the C standard. If you need to write portable code, you should not use that function."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": true, "score": 6, "last_activity_date": 1547562638, "creation_date": 1547562638, "answer_id": 54200917, "question_id": 54200804, "link": "https://stackoverflow.com/questions/54200804/error-caused-by-function-that-hasnt-yet-been-run/54200917#54200917", "title": "Error caused by function that hasn&#39;t yet been run", "body": "<p>In function <code>PrintBillHeading()</code>, the statement <code>strcpy(addressCpy,bill-&gt;address)</code> uses the value of an uninitialized variable <code>addressCpy</code>. This is undefined behavior. Undefined behavior means that the program may crash in any random place. If the program contains undefined behavior <em>the entire program is invalid</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "is_accepted": false, "score": 1, "last_activity_date": 1547567508, "last_edit_date": 1592644375, "creation_date": 1547566819, "answer_id": 54202147, "question_id": 54200804, "link": "https://stackoverflow.com/questions/54200804/error-caused-by-function-that-hasnt-yet-been-run/54202147#54202147", "title": "Error caused by function that hasn&#39;t yet been run", "body": "<p>In addition to the <a href=\"https://stackoverflow.com/a/54200917/9658875\">correct answer</a> by AlexP, I'd like to point out another (lurking) undefined behaviour:</p>\n<pre><code>void GenerateReport(Bill* bill)\n{\n     PrintBillHeading(bill);\n     CallEntry* collatedEntries = CollapseCallStack(bill-&gt;callEntries);\n//TODO\n}\n</code></pre>\n<p>Now, <code>CollapseCallStack</code> in your current implementation <strong>does not return anything</strong>. It will still be called, and actually something will be assigned to your <code>collatedEntries</code> pointer upon your initialization of it.</p>\n<p>The problem is that when <code>CollapseCallStack</code> is called, memory for the return value is being allocated, but it never gets assigned a meaningful value, since the return statement is missing. So, essentially your <code>collatedEntries</code> pointer will be initialized with a random garbage value, and if you'd try to dereference it, it would cause UB.</p>\n"}], "owner": {"reputation": 2432, "user_id": 4700841, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ab51f7e9a70996576549b5c611a2833?s=128&d=identicon&r=PG&f=1", "display_name": "Persistence", "link": "https://stackoverflow.com/users/4700841/persistence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 54200917, "answer_count": 2, "score": 2, "last_activity_date": 1547567508, "creation_date": 1547562233, "last_edit_date": 1547562383, "question_id": 54200804, "link": "https://stackoverflow.com/questions/54200804/error-caused-by-function-that-hasnt-yet-been-run", "title": "Error caused by function that hasn&#39;t yet been run", "body": "<p>So I'm writing a bill handling system. The data currently sits in a <code>Stack</code> structure that I've written.</p>\n\n<p>I have this partially written function that writes out a report:</p>\n\n<pre><code>void GenerateReport(Bill* bill)\n{\n     PrintBillHeading(bill);\n     //CallEntry* collatedEntries = CollapseCallStack(bill-&gt;callEntries);\n//TODO\n}\n</code></pre>\n\n<p>Which works fine as long as I leave the second line commented out. If I uncomment it I get a SIGSEGV fault within the <code>PrintBillHeading()</code> function where indicated below.</p>\n\n<pre><code>void PrintBillHeading(Bill* bill)\n{\n    printf(\"Big Brother Telecom\\n\");\n    printf(\"Bill Date: %s\\n\\n\",DateTimeToISOString(bill-&gt;date));\n    printf(\"Contract Holder: %s %s\\n\", bill-&gt;title, bill-&gt;name);\n    printf(\"Address:\\n\");\n    char* addressSeg;\n    char* addressCpy;\n    strcpy(addressCpy,bill-&gt;address); //This line throws the SIGSEGV\n    while ((addressSeg = strtok_r(addressCpy,\";\",&amp;addressCpy)))\n    {\n        printf(\"%s\\n\\0\",addressSeg);\n    }\n}\n</code></pre>\n\n<p>and for completeness here is my <code>CollapseCallStack()</code> function, this is uncomplete, entirely untested and probably doesn't work.</p>\n\n<pre><code>CallEntry* CollapseCallStack(Stack* calls)\n{\n    int size = calls-&gt;topIndex;\n    CallEntry* collatedSet = malloc(sizeof(CallEntry) * size);\n    CallEntry* poppedCall;\n    int curIndex = 0;\n    while (PopStack(calls,poppedCall))\n    {\n        bool found = false;\n        for (int i = 0; i &lt; size; i++)\n        {\n            CallEntry* arrItem = collatedSet + i * sizeof(CallEntry);\n            if (StringEquals(arrItem-&gt;phoneNumber,poppedCall-&gt;phoneNumber))\n            {\n                found = true;\n                arrItem-&gt;minutes += poppedCall-&gt;minutes;\n            }\n        }\n        if (!found)\n        {\n            memcpy(collatedSet,poppedCall,sizeof(CallEntry)); //\n        }\n    }\n}\n</code></pre>\n\n<p>And the <code>CallEntry</code> struct:</p>\n\n<pre><code>typedef struct{\n    char* phoneNumber;\n    int minutes;\n    DateTime* callDateTime;\n} CallEntry;\n</code></pre>\n\n<p>My question is this: how can a function that hasn't yet been called cause a SIGSEGV fault to be expressed earlier on in a program?</p>\n\n<p>Once I've got past this, I can debug the <code>CollapseCallStack()</code> function myself, although if anyone sees any glaring problems I would appreciate a comment on that.</p>\n"}, {"tags": ["c", "qt", "gdb", "mingw"], "comments": [{"owner": {"reputation": 203, "user_id": 5452425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9a9ea9f940832c9f737cf3e364f34d?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5452425/thomas"}, "edited": false, "score": 0, "creation_date": 1547562149, "post_id": 54200757, "comment_id": 95228192, "body": "Using 0b0010 works correctly in GDB."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1547562235, "post_id": 54200757, "comment_id": 95228247, "body": "<code>BITMASK_CAN_WALK 1 &lt;&lt; 1</code> is not <code>0x0010</code> like that comment would suggest, it&#39;s <code>0x0002</code>, or <code>0b0010</code>."}, {"owner": {"reputation": 203, "user_id": 5452425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9a9ea9f940832c9f737cf3e364f34d?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5452425/thomas"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1547562445, "post_id": 54200757, "comment_id": 95228381, "body": "Yeah, I meant that. The bitmask somehow gets displayed as 0x0010 in GDB."}, {"owner": {"reputation": 203, "user_id": 5452425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9a9ea9f940832c9f737cf3e364f34d?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5452425/thomas"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1547562932, "post_id": 54200757, "comment_id": 95228717, "body": "Thats why I asked myself why the define seems to evaluate to 0x0010 and what kind of invisible conversion takes part when running the code. To me it seems like data &amp; 0x0010 (which is the value I got from the IDE for the define) behavious different in GDB than the actual program."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 5452425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9a9ea9f940832c9f737cf3e364f34d?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5452425/thomas"}, "edited": false, "score": 0, "creation_date": 1547563285, "post_id": 54201039, "comment_id": 95228965, "body": "Thanks. That&#39;s what I thought and how I understood it. Could be an display issue with preprocessed defines. Creating const unsigned ints with the same bitmask displays me the correct value in GDB."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1547563026, "creation_date": 1547563026, "answer_id": 54201039, "question_id": 54200757, "link": "https://stackoverflow.com/questions/54200757/qt-creator-gdb-mingw-bitwise-and-question/54201039#54201039", "title": "Qt Creator + GDB + MingW - Bitwise And question", "body": "<p>Those are the correct values of the defines:</p>\n\n<pre><code>#define BITMASK_CAN_JUMP 1 &lt;&lt; 0 // 0b0001\n#define BITMASK_CAN_WALK 1 &lt;&lt; 1 // 0b0010\n</code></pre>\n\n<p>You might at least want to put braces around the <code>1 &lt;&lt; 0</code> and <code>1 &lt;&lt; 1</code>, but that's another story. Anyway, <code>data</code> becomes <code>0b10 | 0b01</code>, which is <code>0b11</code>, or <code>3</code> in decimal.</p>\n\n<p><code>(data &amp; BITMASK_CAN_WALK)</code> is <code>0b11 &amp; 0b10</code>, which is <code>0b10</code>, or <code>2</code> in decimal.</p>\n\n<p>Therefore, the <code>if (data &amp; BITMASK_CAN_WALK)</code> is taken, because it is not <code>0</code> (in C++ it would be implicitly casted to <code>true</code>), and it prints the aforementioned <code>2</code>. If you change the format specifier to <code>#010x</code> you'll see that it indeed is <code>0x2</code>.</p>\n\n<p>Nothing here has the value <code>0x0010</code> (<code>16</code> in decimal), maybe there's a display bug if you're seeing that value.</p>\n"}], "owner": {"reputation": 203, "user_id": 5452425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9a9ea9f940832c9f737cf3e364f34d?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5452425/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 54201039, "answer_count": 1, "score": 0, "last_activity_date": 1547563026, "creation_date": 1547562070, "question_id": 54200757, "link": "https://stackoverflow.com/questions/54200757/qt-creator-gdb-mingw-bitwise-and-question", "title": "Qt Creator + GDB + MingW - Bitwise And question", "body": "<p>I tried to evaluate how bitwise AND operation results get evaluated. I am using Qt Creator + GDB + MingW on Windows.</p>\n\n<p>I did an simple test:</p>\n\n<pre><code>#define BITMASK_CAN_JUMP 1 &lt;&lt; 0 // 0x0001\n#define BITMASK_CAN_WALK 1 &lt;&lt; 1 // 0x0010\n\nunsigned int data = BITMASK_CAN_JUMP | BITMASK_CAN_WALK;\n...\n    if (data &amp; BITMASK_CAN_WALK) {\n        printf(\"%d\", data &amp; BITMASK_CAN_WALK);\n        printf(\"can walk\\n\");\n    }\n...\n</code></pre>\n\n<p>Setting an watch in GDB for (data &amp; 0x0010) gives me the value 0 because 0x0010 = 0b10000 which is correct. The if condition evaluates to true because the value gets evaluated as 2. To me it seems like the the debugger acts correctly by treating 0x0010 as an hexadecimal value while the program itself gets some kind of implicit conversion, like converting the value behind data to an hexadecimal value. I don't understand why data doesn't get converted to hexadecimal then, too, when using GDB.\nCould somebody clear up the situation to me?</p>\n\n<p>Best\nTom</p>\n"}, {"tags": ["c", "io"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1547561704, "post_id": 54200649, "comment_id": 95227900, "body": "Instead of <code>A = (int *)malloc(n);</code>, try <code>A = (int *)malloc(n*sizeof(int));</code>."}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 1, "creation_date": 1547561760, "post_id": 54200649, "comment_id": 95227943, "body": "first scan <code>n</code>, then use it for malloc"}, {"owner": {"reputation": 527, "user_id": 689106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/22ef5ea2bedfb2a3575ac22fe06d6c72?s=128&d=identicon&r=PG", "display_name": "Melon", "link": "https://stackoverflow.com/users/689106/melon"}, "edited": false, "score": 0, "creation_date": 1547562189, "post_id": 54200649, "comment_id": 95228219, "body": "Did you try your program on shorter arrays?"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 10917190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7937e47a2eee88f75d1dcd1f8ea71da7?s=128&d=identicon&r=PG&f=1", "display_name": "MS1902", "link": "https://stackoverflow.com/users/10917190/ms1902"}, "edited": false, "score": 0, "creation_date": 1547562614, "post_id": 54200765, "comment_id": 95228500, "body": "Thank you very much! Also, I&#39;ve been wondering why we use malloc instead of scan n and then we initiate an array a[n]. At first I thought that malloc allows that kind of &quot;psychic&quot; power that you are talking about but now it seems unlikely. Would you mind explaining this?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 111, "user_id": 10917190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7937e47a2eee88f75d1dcd1f8ea71da7?s=128&d=identicon&r=PG&f=1", "display_name": "MS1902", "link": "https://stackoverflow.com/users/10917190/ms1902"}, "edited": false, "score": 0, "creation_date": 1547562926, "post_id": 54200765, "comment_id": 95228712, "body": "Arrays are using up space in the stack which is limited, where as <code>malloc</code> allocates memory from the heap which isn&#39;t as limited and you can also <code>free</code> it when you no longer need it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 111, "user_id": 10917190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7937e47a2eee88f75d1dcd1f8ea71da7?s=128&d=identicon&r=PG&f=1", "display_name": "MS1902", "link": "https://stackoverflow.com/users/10917190/ms1902"}, "edited": false, "score": 0, "creation_date": 1547564598, "post_id": 54200765, "comment_id": 95229837, "body": "@MS1902, do note that support for arrays whose sizes are not compile-time constants (&quot;variable-length arrays&quot;) is mixed.  It was not a feature of C90 at all, it was added to C99, but then support was made optional in C11.  Some compilers support it, but others don&#39;t.  Also it is prone to fail for much smaller array dimensions than are usually required to make <code>malloc()</code> fail.  Bottom line: be careful with VLAs, and maybe don&#39;t use them at all until you know what you&#39;re doing."}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 2, "last_activity_date": 1547562091, "creation_date": 1547562091, "answer_id": 54200765, "question_id": 54200649, "link": "https://stackoverflow.com/questions/54200649/merge-sort-program-doesnt-sort-array-with-more-than-5-elements/54200765#54200765", "title": "Merge sort program doesn&#39;t sort array with more than 5 elements", "body": "<p>Your code is trying to develop psychic powers. You're using <code>n</code> before it gets assigned a value as you use <code>scanf</code> afterwards to find out what <code>n</code> should be. This will lead to undefined behaviour, such as your code only working if there are less than 5 elements.</p>\n\n<pre><code>int n, i, *A;\nA = (int *)malloc(n);\nscanf(\"%d\", &amp;n);\n</code></pre>\n\n<p>You're also not allocating enough memory as that will allocate <code>n</code> bytes where as an <code>int</code> will typically be 4 bytes (or more or less depending on your computer's architecture). The best way to ensure you allocate the right amount of memory is to multiple <code>n</code> by the <code>sizeof(*A)</code> - that is the size of whatever A is a pointer to. This ensures if you change <code>A</code> to be a different type, the allocation code will continue to be correct.</p>\n\n<pre><code>scanf(\"%d\", &amp;n);\nA = malloc(n*sizeof(*A));\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10917190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7937e47a2eee88f75d1dcd1f8ea71da7?s=128&d=identicon&r=PG&f=1", "display_name": "MS1902", "link": "https://stackoverflow.com/users/10917190/ms1902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547562091, "creation_date": 1547561657, "question_id": 54200649, "link": "https://stackoverflow.com/questions/54200649/merge-sort-program-doesnt-sort-array-with-more-than-5-elements", "title": "Merge sort program doesn&#39;t sort array with more than 5 elements", "body": "<p>I'm trying to implement the code for merge sort. I use the following code for merge sort, which you can have a look at <a href=\"https://www.hackerearth.com/practice/algorithms/sorting/merge-sort/tutorial/\" rel=\"nofollow noreferrer\">here</a>. The problem is when I run the program, for example, I asked it to sort the array [1, 2, 3, 4, 6, 5] then print out the sorted array, it return the array [-1560047667 1 2 3 4 5]. From what I observed, it will not print the value of the largest element in the array correctly. My code is below:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid merge_sort(int A[], int start, int end){\n    My code for merge sort \n    goes here\n}\n\nint main(){\n    int n, i, *A;\n    A = (int *)malloc(n);\n    scanf(\"%d\", &amp;n);\n    for(i=0; i&lt;n; i++) scanf(\"%d\", A+i);\n    merge_sort(A, 0, n);\n    for(i=0; i&lt;n; i++) printf(\"%d\", *(A+i));\n}\n</code></pre>\n\n<p>Any suggestion on what is the mistake I've made? I think the problem is at the input/output process, but not quite sure what exactly it is.</p>\n"}, {"tags": ["c", "ruby", "ffi"], "comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1547591618, "post_id": 54200630, "comment_id": 95242292, "body": "<code>INT2NUM</code> and other conversion macros return their argument encoded. If you want to use <code>printf</code> to print the original value then you need to convert it back with <code>NUM2INT</code>, etc."}, {"owner": {"reputation": 21, "user_id": 8804133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259497929ccf8b48a404a08c553a08eb?s=128&d=identicon&r=PG&f=1", "display_name": "Ninjacop", "link": "https://stackoverflow.com/users/8804133/ninjacop"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1547644821, "post_id": 54200630, "comment_id": 95261457, "body": "Thank you! I forgot about converting it back from a Ruby VALUE."}], "owner": {"reputation": 21, "user_id": 8804133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259497929ccf8b48a404a08c553a08eb?s=128&d=identicon&r=PG&f=1", "display_name": "Ninjacop", "link": "https://stackoverflow.com/users/8804133/ninjacop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547561596, "creation_date": 1547561596, "question_id": 54200630, "link": "https://stackoverflow.com/questions/54200630/ruby-c-api-macros-such-as-int2num-return-store-different-numbers-than-expected", "title": "Ruby C API macros such as INT2NUM() return/store different numbers than expected", "body": "<p>Currently I am using the Ruby C API and I am having trouble defining global Ruby variables. </p>\n\n<p>Ruby values are stored in C as VALUE, or an <code>unsigned long</code>. The Ruby version I am using is v2.6.0p0, and I've tried using macros such as INT2NUM(), DBL2NUM() and INT2FIX() and the inputted number is always stored like so:</p>\n\n<p>value * 2 + 1 -- if it's a whole number </p>\n\n<p>value * 2     -- if it's a floating point number/double</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>#include &lt;Ruby/ruby.h&gt;\n\nint main() {\n    ruby_init();\n\n    /* Test with no Ruby variables, just to see what it outputs \n       using INT2NUM() */\n    VALUE x = INT2NUM(3);\n    printf(\"%lu\", x);\n\n    /* Test storing y in a Ruby variable, then calling it using\n       INT2FIX() */\n    VALUE y = INT2FIX(4.5);\n    rb_gv_set(\"$y\", y);\n    printf(\"%lu\", rb_gv_get(\"$y\"));\n\n    /* Test storing z in a Ruby variable then calling it using \n       DBL2NUM() */\n    VALUE z = DBL2NUM(6);\n    rb_gv_set(\"$z\", z);\n    printf(\"%lu\", rb_gv_get(\"$z\"));\n\n    ruby_cleanup(0);\n    return 0;\n}\n</code></pre>\n\n<p>For the first test, the output should be <code>3</code>, but it is printed out as <code>7</code> and the second test the output should be <code>4.5</code>, but it is printed out as <code>9</code>. The last test should be printed out as <code>6</code> but it prints out as <code>54043195528445954</code>, presumably the address where it's stored.</p>\n"}, {"tags": ["c", "linux", "process", "signals", "posix"], "comments": [{"owner": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 1, "creation_date": 1547562951, "post_id": 54200603, "comment_id": 95228728, "body": "I think that EINTR is triggered only when SIGCHLD is caught and <code>waitpid</code> would not otherwise return (i.e. some child other than the one waited for exited)."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "reply_to_user": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 0, "creation_date": 1547563119, "post_id": 54200603, "comment_id": 95228838, "body": "you mean that errno == EINTR applies only to waitpid - then the question where is it stated in specs. <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/wait.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/wait.html</a> says that EINTR does apply to both."}, {"owner": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 0, "creation_date": 1547563170, "post_id": 54200603, "comment_id": 95228877, "body": "wait() is probably just a wrapper for waitpid()."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "reply_to_user": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 1, "creation_date": 1547563217, "post_id": 54200603, "comment_id": 95228914, "body": "The call wait(&amp;status) is equivalent to: waitpid(-1, &amp;status, 0); as qouted in question."}, {"owner": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 0, "creation_date": 1547563322, "post_id": 54200603, "comment_id": 95228991, "body": "Yes, and waitpid(-1, &amp;status, 0) also never returns EINTR. Also note, that system call is not restarted, it just returns. If you try to wait() for the same child in signal handler you see, it is already handled."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547563582, "post_id": 54200603, "comment_id": 95229152, "body": "Already tried SIGUSR1 and SIGCHLD (mentioned in question) - the expected result is shown."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 0, "creation_date": 1547564080, "post_id": 54200603, "comment_id": 95229492, "body": "I think that @ErkiA hit the nail on the head... Since the child process have exited normally the <code>wait</code> function returns normally, even though you catched the <code>SIGCHLD</code> signal. And you have to remember that <code>SIGCHLD</code> is also sent for <i>other</i> events, like the child process being stopped."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1547567506, "post_id": 54200603, "comment_id": 95231649, "body": "@Someprogrammerdude I have updated the question."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547568096, "post_id": 54201885, "comment_id": 95232022, "body": "FreeBSD also interrupts wait on SIGCHLD on child exit (the output is expected one)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 1, "creation_date": 1547568553, "post_id": 54201885, "comment_id": 95232295, "body": "And, that, too, is consistent with the docs, @GreenTree.  They allow but do not require a <code>SIGCHLD</code> to interrupt the <code>wait</code>.  What they do require is that <b><i>if</i></b> the <code>wait</code> is interrupted for such a reason <b><i>then</i></b> <code>wait()</code> shall set <code>errno</code> to <code>EINTR</code> and return -1.  As this answer already describes."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547569241, "post_id": 54201885, "comment_id": 95232649, "body": "If a blocked call to one of the following interfaces is interrupted        by a signal handler, then the call is automatically restarted after        the signal handler returns if the SA_RESTART flag was used; otherwise        the call fails with the error EINTR: ... * wait(2), wait3(2), wait4(2), waitid(2), and waitpid(2) <a href=\"http://man7.org/linux/man-pages/man3/siginterrupt.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/siginterrupt.3.html</a>   <a href=\"http://man7.org/linux/man-pages/man3/siginterrupt.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/siginterrupt.3.html</a>"}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547571640, "post_id": 54201885, "comment_id": 95233907, "body": "the quote above explicitly states that wait should fail with EINTR when interrupted by a signal handler. it is interrupted by signal handler in the example, so I suppose that is the case described. though maybe it&#39;s also the subtlety of interpretation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547572256, "post_id": 54201885, "comment_id": 95234193, "body": "Sure, @GreenTree, but that does not define whether an incoming <code>SIGCHLD</code> should be interpreted to <i>interrupt</i> <code>wait()</code>.  That&#39;s what typical implementations wait <i>for</i>."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547636714, "post_id": 54201885, "comment_id": 95256904, "body": "I do understand what you say - OK, even if neither posix nor linux defines this behaviour (which I doubt), we have fact of interruption under linux implementation - if you run gdb you would see that &#39;wait()&#39; is interrupted by SIGCHLD - interrupted in terms of 2.4.4 Signal Effects on Other Functions from <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547649274, "post_id": 54201885, "comment_id": 95264304, "body": "@GreenTree, some signals are special, either in general or under specific circumstances.  You will have read about <code>SIGCONT</code>, for example, there and elsewhere in chapter 2.4 of POSIX."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547649280, "post_id": 54201885, "comment_id": 95264311, "body": "Sticking with one standard domain, POSIX has this to say about <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/wait.html\" rel=\"nofollow noreferrer\"><code>wait()</code></a>: &quot;The wait() function shall cause the calling thread to become blocked until status information generated by child process termination is made available to the thread, or until delivery of a signal whose action is either to execute a signal-catching function or to terminate the process, or an error occurs.&quot;"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547649602, "post_id": 54201885, "comment_id": 95264538, "body": "Status information generated by the child process becomes available to <code>wait()</code> no later than when the process receives a <code>SIGCHLD</code>, thus the thread blocked in <code>wait()</code> could be unblocked for either of two reasons, and the requirements on its subsequent behavior differ based on which you choose."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1547650153, "post_id": 54201885, "comment_id": 95264867, "body": "But if you are unsatisfied with my answer, @GreenTree, then you are welcome to write your own.  Clearly you have been studying the documentation.  Researching and writing out a convincing argument for a position on the question would be a useful exercise."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1547565905, "creation_date": 1547565905, "answer_id": 54201885, "question_id": 54200603, "link": "https://stackoverflow.com/questions/54200603/eintr-on-wait-syscall/54201885#54201885", "title": "EINTR on &#39;wait&#39; syscall", "body": "<p>There is a subtlety of interpretation here.  You have to start with:</p>\n\n<blockquote>\n  <p>on success, [<code>wait</code>] returns the process ID of the terminated child; on error, -1 is returned.</p>\n</blockquote>\n\n<p>(<a href=\"https://linux.die.net/man/2/waitpid\" rel=\"nofollow noreferrer\">Linux wait(2) manual page</a>)</p>\n\n<p>The docs about <code>errno</code> values need to be interpreted in that light: <strong><em>in the event that <code>wait()</code> returns -1</em></strong>, thus indicating an error, and <code>errno</code> is set to <code>EINTR</code>, the interpretation is that a <code>SIGCHLD</code> or unblocked (other) signal interrupted the wait.  But that does not imply that receipt of a <code>SIGCHLD</code> must cause <code>wait()</code> to fail.  In particular, <code>wait()</code> will complete normally instead of raising an error when the <code>SIGCHLD</code> arises from termination of one of the process's children.</p>\n\n<p>Before being too critical of the docs here, do consider that</p>\n\n<ul>\n<li>a <code>SIGCHLD</code> may be delivered for reasons other than that a child has terminated</li>\n<li>the error descriptions apply to all the functions in that group, and some of them can wait for specific children only.  These could be interrupted by a <code>SIGCHLD</code> from some child that they are not waiting for.</li>\n</ul>\n\n<p>The wording of the docs also seems to suggest that a <code>SIGCHLD</code> might cause one or more of these functions to fail with <code>EINTR</code> <em>even if that signal is blocked</em>.  I would find such behavior surprising, but remember where I started: that that result is among the possible interpretations of an <code>EINTR</code> error does not necessarily imply that it can actually happen.</p>\n"}], "owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547567773, "creation_date": 1547561506, "last_edit_date": 1547567773, "question_id": 54200603, "link": "https://stackoverflow.com/questions/54200603/eintr-on-wait-syscall", "title": "EINTR on &#39;wait&#39; syscall", "body": "<p>From <code>man -e 2 wait</code>:</p>\n\n<blockquote>\n  <p>The call wait(&amp;status) is equivalent to:\n             waitpid(-1, &amp;status, 0);</p>\n</blockquote>\n\n<p>errno values:</p>\n\n<blockquote>\n  <p>EINTR  WNOHANG was not set and an unblocked signal or a SIGCHLD was\n  caught; see signal(7).</p>\n</blockquote>\n\n<p>So I from my understanding of above, if we are blocked in 'wait' and receiving a signal (SIGCHLD), the call should return with -1 and errno set to EINTR.\nThough running the following snippet will prove that wait is actually restarted (linux 4.15.0-43, glibc 2.23):</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nstatic void sigchld_handler(int signo)\n{\n    const char *const msg = \"\\nSIGCHLD\";\n\n    (void)signo;\n    write(STDERR_FILENO, msg, strlen(msg));\n}\n\nint main(void)\n{\n    pid_t wait_ret = 0, pid = 0;\n    int status = 0, ret = -1;\n\n    sigaction(SIGCHLD, &amp;(struct sigaction){\n       .sa_handler = sigchld_handler,\n    }, NULL);\n\n    if ((pid = fork()) &lt; 0)\n    {\n       perror(\"\\nfork: \");\n       goto Exit;\n    }\n\n    if (!pid)\n    {\n       sleep(3);\n       return 0;\n    }\n\n    if ((wait_ret = wait(&amp;status)) &lt; 0)\n    {\n       perror(\"\\nwait: \");\n       goto Exit;\n    }\n\n    fprintf(stderr, \"\\nwait done, pid %d\", wait_ret);\n    ret = 0;\n\nExit:\n    fprintf(stderr, \"\\n\");\n    return ret;\n}\n</code></pre>\n\n<p>SA_RESTART is not set - so why does 'wait' restart.?\nActual output:</p>\n\n<blockquote>\n<pre><code>SIGCHLD\nwait done, pid 15242\n</code></pre>\n</blockquote>\n\n<p>Expected by me output:</p>\n\n<blockquote>\n<pre><code>SIGCHLD\nwait: Interrupted system call\n</code></pre>\n</blockquote>\n\n<p>Note <code>kill -CHLD &lt;waiting process&gt;</code> manually from shell will give the expected result. </p>\n\n<p>Also note that running the code on FreeBSD 11.2 will give the expected result as well - wait is interrupted with error on child exit.</p>\n"}, {"tags": ["c++", "c", "initialization", "language-lawyer"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1547561396, "post_id": 54200465, "comment_id": 95227696, "body": "There is nothing &quot;even&quot; in <code>-Wall -Wextra</code>. That&#39;s about the bare minimum in warnings. See <a href=\"https://stackoverflow.com/questions/2408038\">this answer</a> of mine to an older question about <code>-Wall</code>..."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1547561554, "post_id": 54200465, "comment_id": 95227798, "body": "<a href=\"https://godbolt.org/z/X0qFUA\" rel=\"nofollow noreferrer\"><code>-Wall</code> is enough for me to get a warning for gcc</a>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1547561856, "post_id": 54200465, "comment_id": 95228007, "body": "@Kevin no dice with gcc 7. gcc 8 seems to detect the issue"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1547562047, "post_id": 54200465, "comment_id": 95228120, "body": "@Jean-Fran&#231;oisFabre Maybe godbolt isn&#39;t working right, but I can set it back to gcc 4.4 and it still gives me the warning."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1547562112, "post_id": 54200465, "comment_id": 95228163, "body": "okaY. Anyway it&#39;s a compiler limitation or bug if it doesn&#39;t detect that, because it can cause issues later."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1547562583, "post_id": 54200465, "comment_id": 95228474, "body": "@Kevin watch it, you&#39;re using a c++ compiler!!"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1547563066, "post_id": 54200465, "comment_id": 95228793, "body": "@SouravGhosh I hadn&#39;t noticed that, but this question has the C++ tag as well. Oddly enough with C I only get it with both <code>-Wall</code> and <code>-Winit-self</code> but the warning is from <code>-Wuninitialized</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1547563954, "post_id": 54200465, "comment_id": 95229393, "body": "Duplicate: <a href=\"https://stackoverflow.com/questions/16110546/why-does-the-compiler-allow-initializing-a-variable-with-itself\">Why does the compiler allow initializing a variable with itself?</a>. However, the answers there are not very good. So lets leave this open for now and see if something better comes up. Then we can close the linked post instead."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1547567322, "post_id": 54200465, "comment_id": 95231519, "body": "I improved the title and will mop up some old, bad duplicates, since the answers posted here so far are already better than those posted for the dupe questions."}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 1, "creation_date": 1547568463, "post_id": 54200465, "comment_id": 95232245, "body": "The C++ part is a duplicate of <a href=\"https://stackoverflow.com/q/14935722/5376789\">stackoverflow.com/q/14935722/5376789</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1547561524, "post_id": 54200564, "comment_id": 95227783, "body": "Good answer; however, I am not sure about the &quot;warnings issued, when the compiler is sure that there is going to be a problem&quot;. There are many warnings, where this isn&#39;t the case, this is highly dependent on the warning types enabled"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1547561611, "post_id": 54200564, "comment_id": 95227828, "body": "The risk with <code>int i = i + 1</code> is that UB is UB, period. Also, signed overflow. Also, much scratching of heads when another coder has to make sense of that code at some later point."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1547561666, "post_id": 54200564, "comment_id": 95227877, "body": "true! I forgot the <i>sign</i>. Edited out to make it simple"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547561718, "post_id": 54200564, "comment_id": 95227910, "body": "As @Ctx says.  For example, I often find myself building third-party code that causes tons of warnings about use of <i>possibly</i> uninitialized variables.  Control-flow analysis in those cases normally shows that the programmer included appropriate logic to ensure that the variable is assigned a value before its value is used.  But the compiler is explicitly <i>un</i>sure whether there is a problem."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1547562227, "post_id": 54200564, "comment_id": 95228243, "body": "<code>-Wparentheses</code> would be another example."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547568173, "post_id": 54200564, "comment_id": 95232074, "body": "The compiler doesn&#39;t <i>have</i> to give a diagnostic here, although any half-decent compiler will. With <code>-Wall -Wextra</code>, icc gives a warning for <code>i=i;</code>, but gcc and clang don&#39;t. Not unless we do something like <code>int i=i+1;</code>. Apparently there&#39;s something called <code>-Winit-self</code> that has to be used explicitly."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547573876, "post_id": 54200564, "comment_id": 95235017, "body": "@Lundin Depends on the compiler version &amp; platform apparently. gcc 7.3 windows remains silent even with <code>-Winit-self</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1564713322, "post_id": 54200564, "comment_id": 101129435, "body": "<code>int i = i;</code> is undefined behaviour; one possible manifestation of which is &quot;does nothing&quot;. Your answer seems to imply that it&#39;s harmless"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 11, "last_activity_date": 1547562881, "last_edit_date": 1547562881, "creation_date": 1547561380, "answer_id": 54200564, "question_id": 54200465, "link": "https://stackoverflow.com/questions/54200465/whats-the-behavior-of-an-uninitialized-variable-used-as-its-own-initializer/54200564#54200564", "title": "What&#39;s the behavior of an uninitialized variable used as its own initializer?", "body": "<p>This is a warning, it's not related to the standard.</p>\n\n<p>Warnings are heuristic with \"optimistic\" approach. The warning is issued only when the compiler is <em>sure</em> that it's going to be a problem. In cases like this you have better luck with <code>clang</code> or newest versions of <code>gcc</code> as stated in comments (see another related question of mine: <a href=\"https://stackoverflow.com/questions/46465442/why-am-i-not-getting-an-used-uninitialized-warning-from-gcc-in-this-trivial-ex\">why am I not getting an &quot;used uninitialized&quot; warning from gcc in this trivial example?</a>).</p>\n\n<p>anyway, in the first case:</p>\n\n<pre><code>int i = i;\n</code></pre>\n\n<p>does nothing, since <code>i==i</code> already. It is possible that the assignment is completely optimized out as it's useless. With compilers which don't \"see\" self-initialization as a problem you can do this without a warning:</p>\n\n<pre><code>int i = i;\nprintf(\"%d\\n\",i);\n</code></pre>\n\n<p>Whereas this triggers a warning all right:</p>\n\n<pre><code>int i;\nprintf(\"%d\\n\",i);\n</code></pre>\n\n<p>Still, it's bad enough not to be warned about this, since from now on <code>i</code> is seen as <em>initialized</em>.</p>\n\n<p>In the second case:</p>\n\n<pre><code>int i = i + 1;\n</code></pre>\n\n<p>A computation between an uninitialized value and <code>1</code> must be performed. Undefined behaviour happens there.</p>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1547561452, "post_id": 54200568, "comment_id": 95227724, "body": "no dice with <code>-Winit-self</code> either here, using <code>gcc</code> 7.3.1"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1547561885, "post_id": 54200568, "comment_id": 95228023, "body": "you have a new version of gcc. Mine is older. When you say &quot;probable source of undefined behavior (if the value of the variable is used later on)&quot; it&#39;s the same as using it uninitialized."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1547565951, "last_edit_date": 1547565951, "creation_date": 1547561387, "answer_id": 54200568, "question_id": 54200465, "link": "https://stackoverflow.com/questions/54200465/whats-the-behavior-of-an-uninitialized-variable-used-as-its-own-initializer/54200568#54200568", "title": "What&#39;s the behavior of an uninitialized variable used as its own initializer?", "body": "<p>I believe you are okay with getting the warning in case of</p>\n\n<pre><code>int i = i + 1; \n</code></pre>\n\n<p>as expected, however, you expect the warning to be displayed even in case of</p>\n\n<pre><code>int i = i;\n</code></pre>\n\n<p>also. </p>\n\n<blockquote>\n  <p><em>Why is this even allowed by compilers?</em></p>\n</blockquote>\n\n<p>There is nothing inherently wrong with the statement. See the related discussions: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/16110546/2173917\">Why does the compiler allow initializing a variable with itself?</a> </li>\n<li><a href=\"https://stackoverflow.com/q/28152298/2173917\">Why is initialization of a new variable by itself valid?</a> </li>\n</ul>\n\n<p>for more insight.</p>\n\n<blockquote>\n  <p><em>What does the C/C++ standards say about this? Specifically, what's the behavior of this? UB or implementation dependent?</em></p>\n</blockquote>\n\n<p>This is undefined behavior, as the type <code>int</code> can have trap representation and you never have taken the address of the variable in discussion. So, technically, you'll face UB as soon as you try to use the (indeterminate) value stored in variable <code>i</code>.</p>\n\n<p>You should turn on your compiler warnings. In <code>gcc</code>, </p>\n\n<ul>\n<li><a href=\"https://godbolt.org/z/DaSuJa\" rel=\"nofollow noreferrer\">compile with <code>-Winit-self</code> to get a warning.</a> in C.</li>\n<li><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Wno-all\" rel=\"nofollow noreferrer\">For C++,</a> <code>-Winit-self</code> is enabled with <code>-Wall</code> already.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547562393, "post_id": 54200644, "comment_id": 95228351, "body": "It is perhaps relevant to include that the scope of identifier <code>i</code> begins at the end of its declarator, of which the initializer is not part.  Thus <code>i</code> is in scope in its own initializer, even though it is not useful to initialize it with itself."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547562771, "post_id": 54200644, "comment_id": 95228606, "body": "Also, there&#39;s a bit of a wiggly issue around <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p2\" rel=\"nofollow noreferrer\">C11 6.3.2.1/2</a>, though I don&#39;t think that makes your analysis incorrect."}, {"owner": {"reputation": 4842, "user_id": 528929, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db7af2b655981c0db8c8d907ce347eed?s=128&d=identicon&r=PG", "display_name": "Hongxu Chen", "link": "https://stackoverflow.com/users/528929/hongxu-chen"}, "edited": false, "score": 0, "creation_date": 1547562963, "post_id": 54200644, "comment_id": 95228736, "body": "Can you elaborate this, better with reference to the standard?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547567009, "post_id": 54200644, "comment_id": 95231303, "body": "@JohnBollinger This answer is essentially correct. The complete story including the 6.3.2.1 special case can be found here: <a href=\"https://stackoverflow.com/a/40674888/584518\">(Why) is using an uninitialized variable undefined behavior?</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547567250, "post_id": 54200644, "comment_id": 95231464, "body": "Yes, @Lundin, I didn&#39;t say otherwise.  My point is that the OP&#39;s code almost, but does not quite, fall into the case covered by 6.3.2.1/2, to which the question of trap representations is irrelevant."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1547567525, "post_id": 54200644, "comment_id": 95231659, "body": "@JohnBollinger  Added further detail on whether <code>i</code> had its address taken."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547567759, "post_id": 54200644, "comment_id": 95231833, "body": "That&#39;s useful, thanks, but what I was more looking at is that 6.3.2.1/2 fails to apply here because <code>i</code> has an initializer -- the very initializer whose behavior is in question.  If instead of an initializer there were an assignment <code>i = i</code> then the behavior would be unconditionally undefined.  Already upvoted, though."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547576150, "post_id": 54200644, "comment_id": 95236065, "body": "@JohnBollinger  That brings up an interesting point.  <code>i</code> was &quot;declared with an initializer&quot; and is therefor not uninitialized as per 6.3.2.1p2, but at the same time it <i>is</i> uninitialized at the time it is used.  So which one applies?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547577379, "post_id": 54200644, "comment_id": 95236575, "body": "Yes, that&#39;s what I was getting at.  But I&#39;m prepared to accept a literal, albeit counterintuitive, reading of the standard.  That is, because <code>i</code> is declared with an initializer, it is not &quot;uninitialized&quot;, as that term is used in context, even in the initializer.  In any case, that doesn&#39;t change my advice to any and everyone about code like this: <i>don&#39;t do that!</i>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547624610, "post_id": 54200644, "comment_id": 95250641, "body": "I think you need to read the standard as: initialization follows the same rules as per simple assignment. During simple assignment, the operands are unsequenced, which probably also makes this UB. Although the evaluation of the right operand has to be done before the point where it is stored. And at that point the variable is uninitialized. I really can&#39;t come up with a scenario where this wouldn&#39;t be one form of UB or another."}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1547653934, "post_id": 54200644, "comment_id": 95267202, "body": "<i>An indeterminate value can be either an unspecified value or a trap representation.</i> Even though it is defined this way in the Standard, the C Standard Committee seem to treat indeterminate value as a distinct value different from any other value."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1564713370, "post_id": 54200644, "comment_id": 101129440, "body": "Note: the question is dual-tagged; this answer only applies to C"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 13, "last_activity_date": 1547567466, "last_edit_date": 1547567466, "creation_date": 1547561645, "answer_id": 54200644, "question_id": 54200465, "link": "https://stackoverflow.com/questions/54200465/whats-the-behavior-of-an-uninitialized-variable-used-as-its-own-initializer/54200644#54200644", "title": "What&#39;s the behavior of an uninitialized variable used as its own initializer?", "body": "<p>Because <code>i</code> is uninitialized when use to initialize itself, it has an <strong>indeterminate value</strong> at that time.  An indeterminate value can be either an <strong>unspecified value</strong> or a <strong>trap representation</strong>.</p>\n\n<p><em>If</em> your implementation supports padding bits in integer types and <em>if</em> the indeterminate value in question happens to be a trap representation, then using it results in <strong>undefined behavior</strong>.</p>\n\n<p>If your implementation does <em>not</em> have padding in integers, then the value is simply <strong>unspecified</strong> and there is <em>no</em> undefined behavior.</p>\n\n<p>EDIT:</p>\n\n<p>To elaborate further, the behavior can still be undefined if <code>i</code> never has its address taken at some point.  This is detailed in section 6.3.2.1p2 of the C11 standard:</p>\n\n<blockquote>\n  <p>If the  lvalue  designates  an  object  of  automatic  storage \n  duration  that  could  have  been declared with the register storage\n  class (never had its address taken), and that object is  uninitialized\n  (not  declared  with  an  initializer  and  no  assignment  to  it \n  has  been performed prior to use), the behavior is undefined.</p>\n</blockquote>\n\n<p>So if you never take the address of <code>i</code>, then you have undefined behavior.  Otherwise, the statements above apply.</p>\n"}], "owner": {"reputation": 4842, "user_id": 528929, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db7af2b655981c0db8c8d907ce347eed?s=128&d=identicon&r=PG", "display_name": "Hongxu Chen", "link": "https://stackoverflow.com/users/528929/hongxu-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2201, "favorite_count": 2, "accepted_answer_id": 54200644, "answer_count": 3, "score": 16, "last_activity_date": 1547567466, "creation_date": 1547561032, "last_edit_date": 1547567204, "question_id": 54200465, "link": "https://stackoverflow.com/questions/54200465/whats-the-behavior-of-an-uninitialized-variable-used-as-its-own-initializer", "title": "What&#39;s the behavior of an uninitialized variable used as its own initializer?", "body": "<p>I noticed just now that the following code can be compiled with clang/gcc/clang++/g++, using <code>c99</code>, <code>c11</code>, <code>c++11</code> standards.</p>\n\n<pre><code>int main(void) {\n    int i = i;\n}\n</code></pre>\n\n<p>and even with <code>-Wall -Wextra</code>, none of the compilers even reports warnings.</p>\n\n<p>By modifying the code to <code>int i = i + 1;</code> and with <code>-Wall</code>, they may report:</p>\n\n<pre><code>why.c:2:13: warning: variable 'i' is uninitialized when used within its own initialization [-Wuninitialized]\n    int i = i + 1;\n        ~   ^\n1 warning generated.\n</code></pre>\n\n<p>My questions:  </p>\n\n<ul>\n<li>Why is this even allowed by compilers?</li>\n<li>What does the C/C++ standards say about this? Specifically, what's the behavior    of this? UB or implementation dependent?</li>\n</ul>\n"}, {"tags": ["c++", "c", "variables", "initialization", "comma"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1547560849, "post_id": 54200314, "comment_id": 95227349, "body": "When in doubt, always use the safer approach :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1547560878, "post_id": 54200314, "comment_id": 95227376, "body": "According to <a href=\"https://en.cppreference.com/w/cpp/language/declarations#Declarators\" rel=\"nofollow noreferrer\">this declarator reference</a>, the declaration list is fully left-to-right, including initialization. In short, <code>unsigned int n = foo.size, nxn = n * n;</code> is equivalent to <code>unsigned int n = foo.siz; unsigned int nxn = n * n;</code>"}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 4, "creation_date": 1547561328, "post_id": 54200314, "comment_id": 95227647, "body": "One possible drawback of using comma is that you can get confused with statement like <code>int* a, b</code>. This can look like both variables are of type <code>int*</code> but in fact we get <code>int* a; int b;</code>"}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "reply_to_user": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 1, "creation_date": 1547561431, "post_id": 54200314, "comment_id": 95227711, "body": "@grapes - yes. I&#39;m also concerned about readability (I wouldn&#39;t take a shortcut like that because it tends to slow a reader down)."}], "answers": [{"comments": [{"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 1, "creation_date": 1547562143, "post_id": 54200433, "comment_id": 95228185, "body": "+1. Thanks. I&#39;m not sure I agree with the second line for simple cases - but style can be very much a personal thing!"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 1, "creation_date": 1547562534, "post_id": 54200433, "comment_id": 95228439, "body": "@BrettHale: I agree with you. I have the luxury of being able to hire the smartest folk possible; my philosophy behind my coding standards are to make use of every feature of the language as appropriate. If the behaviour of <code>unsigned int n = foo.size, nxn = n * n;</code> is not obvious to someone at my shop then they need to set some time aside to learn the language. Using separate lines in this case could be dangerous should someone refactor one of the types to <code>int</code> and retaining <code>unsigned</code> for the other."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1547561832, "last_edit_date": 1547561832, "creation_date": 1547560932, "answer_id": 54200433, "question_id": 54200314, "link": "https://stackoverflow.com/questions/54200314/comma-as-separator-in-variable-initialization-not-as-operator/54200433#54200433", "title": "Comma as separator in variable initialization (not as operator)", "body": "<p><code>nxn</code> will be initialized properly, since <code>n</code> has been defined and initialized at the point where <code>nxn</code> is defined.</p>\n\n<p>For clarity however, it would be better to put the variables on separate lines.  Doing so avoids ambiguity, making your intent more clear to anyone who reads your code. </p>\n"}, {"comments": [{"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1547561232, "post_id": 54200475, "comment_id": 95227586, "body": "I guess if that&#39;s the rule, I don&#39;t see any ambiguity. In fact, I would <i>prefer</i> to use the syntax I gave in the example if that&#39;s correct. Would <i>others</i> have difficulty discerning the comma as separator, and comma as operator? Any thoughts on style?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 1, "creation_date": 1547561416, "post_id": 54200475, "comment_id": 95227704, "body": "@BrettHale I can&#39;t speak for others but I like declaring one variable per line.  The is double true when dealing with pointers.  For instance <code>int * foo, bar;</code> doesn&#39;t declare two <code>int*</code>&#39;s.  Instead <code>foo</code> is a pointer and <code>bar</code> is just an <code>int</code>.  You would need <code>int * foo, * bar</code> to get two pointers.  It is for reasons like that I keep them separate.  It also makes removing a variable easier if you need to later on.  I&#39;ve added this into the answer."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1547561609, "post_id": 54200475, "comment_id": 95227827, "body": "I&#39;d certainly agree with that. It&#39;s just in a current project I&#39;ve literally provided the case from, where I want to make <code>n</code>, <code>n * n</code>, etc., of the same type. I find this style more concise. Mixing with pointers - hard to read, bad style."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 1, "creation_date": 1547561686, "post_id": 54200475, "comment_id": 95227888, "body": "@BrettHale You can always use <code>auto</code>.  <code>some_type var1 = some value; auto var2 = var1 * var1; auto var3 = var2 * var1; ...</code>"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 8, "last_activity_date": 1547561765, "last_edit_date": 1547561765, "creation_date": 1547561058, "answer_id": 54200475, "question_id": 54200314, "link": "https://stackoverflow.com/questions/54200314/comma-as-separator-in-variable-initialization-not-as-operator/54200475#54200475", "title": "Comma as separator in variable initialization (not as operator)", "body": "<p>Per <a href=\"https://timsong-cpp.github.io/cppwp/dcl.decl#3\" rel=\"noreferrer\">[dcl.decl]/3</a></p>\n\n<blockquote>\n  <p>Each <em>init-declarator</em> in a declaration is analyzed separately as if it was in a declaration by itself. [...]</p>\n</blockquote>\n\n<p>we get that</p>\n\n<pre><code>unsigned int n = foo.size, nxn = n * n;\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>unsigned int n = foo.size;\nunsigned int nxn = n * n;\n</code></pre>\n\n<p>There is a note with exceptions for other rules like <code>auto</code> or if a name shadows the type but those don't apply in this case.</p>\n\n<hr>\n\n<p>Be very wary with pointers if you put multiple variables on a single line</p>\n\n<pre><code>int * foo, bar;\n</code></pre>\n\n<p>does not give you two pointers.  Instead, <code>foo</code> is a pointer and <code>bar</code> is an <code>int</code>.  You would need</p>\n\n<pre><code>int * foo, * bar;\n</code></pre>\n\n<p>to get two pointers.  For this reason I would prefer to use</p>\n\n<pre><code>int * foo;\nint * bar;\n</code></pre>\n\n<p>and pay the extra keystorkes for safeties sake.</p>\n"}], "owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 54200475, "answer_count": 2, "score": 8, "last_activity_date": 1547561832, "creation_date": 1547560553, "question_id": 54200314, "link": "https://stackoverflow.com/questions/54200314/comma-as-separator-in-variable-initialization-not-as-operator", "title": "Comma as separator in variable initialization (not as operator)", "body": "<p>This seems such a simple question, but something I've not examined for ages in my own style... When initializing variables separated by a comma, I've assumed the following to be an unsafe practice:</p>\n\n<p><code>unsigned int n = foo.size, nxn = n * n;</code></p>\n\n<p>Since I don't really ever use the comma <em>operator</em> as such for syntactic sugar, etc; but rather to indicate that two expressions are independent - as a kind of implicit commentary on 'fine-grained parallelism' (or expression independence), that often makes code a bit more terse, e.g.,</p>\n\n<pre><code>if (&lt;some condition&gt;)\n    a = true, b = value;\n</code></pre>\n\n<p>rather than requiring <code>{}</code> scope for semi-colon separated expressions.</p>\n\n<p>But my question is really in re-examining the variable initialization case. Have I been incorrect in my assumption that <code>nxn</code> can't be relied on to be initialized as expected? Or have I been laboring under a misinterpretation all this time?</p>\n"}, {"tags": ["c", "windows", "gcc", "zeromq", "mingw-w64"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547561112, "post_id": 54200230, "comment_id": 95227515, "body": "It&#39;s not clear to me where <code>cmake</code> comes in here.  Are you saying that you used it to build and install zeroMQ?  It does not appear that you&#39;re using it with the test program you&#39;re trying to build, but I&#39;m uncertain."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1547561369, "post_id": 54200230, "comment_id": 95227678, "body": "The errors reported at the end are <i>link</i> errors, which you will only get if the C compilation was successful.  IOW, your <code>-I</code> option did what you wanted it to do.  But you also need to tell the linker where to look for the corresponding library files.  In <code>gcc</code> and many other systems, that role is filled by the <code>-L</code> option."}, {"owner": {"reputation": 67, "user_id": 8463172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce632e8f29059629bc3a4add9be58636?s=128&d=identicon&r=PG&f=1", "display_name": "gadhvi", "link": "https://stackoverflow.com/users/8463172/gadhvi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1547614317, "post_id": 54200230, "comment_id": 95247254, "body": "@JohnBollinger I have downloaded binaries of ZeroMQ and have configured, generated using CMake and then i have build the .sln using Visual Studio 2015 SDK 8.1 x64. I tried the above command <code>$ gcc hello.c -o hello -I &quot;C:\\ZeroMQ\\czmq\\include&quot; -L &quot;C:\\ZeroMQ\\czmq\\builds\\cmake\\Debug\\libczmq.lib&quot;</code> I am still getting same error-  <code>C:\\Ruby25-x64\\msys64\\tmp\\ccjNjDFn.o:hello.c:(.text+0x22): undefined reference to __imp_zsock_new_checked&#39; </code>"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1548418518, "post_id": 54200230, "comment_id": 95543960, "body": "The <code>-L directory</code> option tells the linker to search <code>directory</code> for libraries that you tell it to link. It does not tell it link any libraries. The <code>-l name</code> option does that. Tell it where to search <i>and</i> what library to link: <code>-L C:\\ZeroMQ\\czmq\\builds\\cmake\\Debug -lczmq</code>"}, {"owner": {"reputation": 67, "user_id": 8463172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce632e8f29059629bc3a4add9be58636?s=128&d=identicon&r=PG&f=1", "display_name": "gadhvi", "link": "https://stackoverflow.com/users/8463172/gadhvi"}, "reply_to_user": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1548753762, "post_id": 54200230, "comment_id": 95644997, "body": "@MikeKinghan Yes later I used msi installer and fixed missing library issue just by adding there reference in PATH variable and copying some dlls to system32. I didn&#39;t get the link issue using installer so maybe there was some issue with binaries .."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1547560894, "post_id": 54200278, "comment_id": 95227386, "body": "I don&#39;t disagree enough to downvote, but no, not really.  Specifying (relative) paths in the <code>#include</code> directive makes sense only where the path is a well-known characteristic of the header being included.  It is <i>not</i> appropriate for adapting to different header installation locations.  For the latter, one wants to use a compiler option to specify additional directories to check, exactly as the OP already describes."}], "tags": [], "owner": {"reputation": 4551, "user_id": 2908599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Df1FU.jpg?s=128&g=1", "display_name": "Romeo Ninov", "link": "https://stackoverflow.com/users/2908599/romeo-ninov"}, "is_accepted": false, "score": 0, "last_activity_date": 1547560412, "creation_date": 1547560412, "answer_id": 54200278, "question_id": 54200230, "link": "https://stackoverflow.com/questions/54200230/getting-unusual-error-while-compiling-the-c-code/54200278#54200278", "title": "Getting unusual error while compiling the C code", "body": "<p>You should change first line like this:</p>\n\n<pre><code>#include \"path/czmq.h\"\n</code></pre>\n\n<p>This is the way to tell C include file is in different directory</p>\n\n<p>If include file is in to the same directory the line become</p>\n\n<pre><code>#include \"czmq.h\"\n</code></pre>\n\n<p>The second error IMHO mean you do not have proper definitions in include file</p>\n"}], "owner": {"reputation": 67, "user_id": 8463172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce632e8f29059629bc3a4add9be58636?s=128&d=identicon&r=PG&f=1", "display_name": "gadhvi", "link": "https://stackoverflow.com/users/8463172/gadhvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "closed_date": 1548534051, "answer_count": 1, "score": 0, "last_activity_date": 1547560412, "creation_date": 1547560216, "question_id": 54200230, "link": "https://stackoverflow.com/questions/54200230/getting-unusual-error-while-compiling-the-c-code", "closed_reason": "Duplicate", "title": "Getting unusual error while compiling the C code", "body": "<ul>\n<li>I have build zeroMQ solution i.e libzmq and czmq, I have used cmake-3.13 to configure and generate while vs 2015 to build solution for my Windows 10 system. </li>\n<li>I was able to run czmq_selftest.exe successfully but when I try to run the example code I get the following error-</li>\n</ul>\n\n<p>Here is my directory structure-</p>\n\n<blockquote>\n  <p>C:\\Program Files\\czmq\\examples\\security\\hello.c\n  C:\\Program Files\\czmq\\include</p>\n</blockquote>\n\n<p>hello.c</p>\n\n<pre><code>#include &lt;czmq.h&gt;\n\nint main (void) {\n    zsock_t *publisher = zsock_new (ZMQ_PUB);\n    zsock_set_curve_server (publisher, true);\n    puts (\"Hello, Curve!\");\n    zsock_destroy(&amp;publisher);\n    return 0;\n}\n</code></pre>\n\n<p>I am using \"MinGW64\" for compiling the above code-</p>\n\n<p>Initially the above code gives me </p>\n\n<blockquote>\n  <p>$ gcc hello.c -o hello\n  hello.c:5:10: fatal error: czmq.h: No such file or directory</p>\n</blockquote>\n\n<p>While I tried manually giving the header file path I get-</p>\n\n<blockquote>\n  <p>gcc hello.c -o hello -I \"C:\\Program Files\\czmq\\include\"</p>\n</blockquote>\n\n<pre><code>C:\\Ruby25-x64\\msys64\\tmp\\ccF5oCT1.o:hello.c:(.text+0x22): undefined reference to `__imp_zsock_new_checked'\nC:\\Ruby25-x64\\msys64\\tmp\\ccF5oCT1.o:hello.c:(.text+0x3b): undefined reference to `__imp_zsock_set_curve_server'\nC:\\Ruby25-x64\\msys64\\tmp\\ccF5oCT1.o:hello.c:(.text+0x64): undefined reference to `__imp_zsock_destroy_checked'\ncollect2.exe: error: ld returned 1 exit status\n\n</code></pre>\n\n<p>I can't find any information which can help me solve this error.</p>\n"}, {"tags": ["c", "stm32"], "comments": [{"owner": {"reputation": 338, "user_id": 5558393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/n6SBb.jpg?s=128&g=1", "display_name": "shjeff", "link": "https://stackoverflow.com/users/5558393/shjeff"}, "edited": false, "score": 1, "creation_date": 1547559440, "post_id": 54199920, "comment_id": 95226522, "body": "Propably you can use something like <code>if (*((long *)&amp;(BUF-&gt;src))==279383903)</code>, but this is byte-order dependend code, and <code>BUF</code> should be <code>((struct uip_eth_hdr *)uip_buf)</code>"}, {"owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "reply_to_user": {"reputation": 338, "user_id": 5558393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/n6SBb.jpg?s=128&g=1", "display_name": "shjeff", "link": "https://stackoverflow.com/users/5558393/shjeff"}, "edited": false, "score": 0, "creation_date": 1547559653, "post_id": 54199920, "comment_id": 95226628, "body": "Thank you but I have this error:&quot; cannot convert to a pointer type  #define BUF ((struct uip_eth_hdr *)&amp;uip_buf[0])&quot;"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1547559923, "post_id": 54199920, "comment_id": 95226772, "body": "From the above, <code>BUF-&gt;src</code> has a structure type, not an arithmetic type. You could compare <code>BUF-&gt;src.addr</code> to another array of 6 <code>uint8_t</code> using the <code>memcmp</code> function."}, {"owner": {"reputation": 338, "user_id": 5558393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/n6SBb.jpg?s=128&g=1", "display_name": "shjeff", "link": "https://stackoverflow.com/users/5558393/shjeff"}, "edited": false, "score": 0, "creation_date": 1547560137, "post_id": 54199920, "comment_id": 95226921, "body": "@CKocar, I have updated my comment."}, {"owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "edited": false, "score": 1, "creation_date": 1547560497, "post_id": 54199920, "comment_id": 95227135, "body": "Thank you so much"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1547565997, "post_id": 54199920, "comment_id": 95230689, "body": "1) ethernet protocol uses big endian, while your stm32 is likely little endian, 2) <code>long</code> is probably 4 bytes on stm32, 3) many architectures allow unaligned word access. The correct way is to check individual bytes in the array."}], "owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547559210, "creation_date": 1547559210, "question_id": 54199920, "link": "https://stackoverflow.com/questions/54199920/how-to-long-value-compare", "title": "How to long value compare?", "body": "<p>BUF->src has like a 37848238928 number. \nBut I want to filter with this if(BUF->src==279383903) serialprint(\"fine\") but it cant be because BUF struct and my number is long how can I compare  with these number in if blocks?</p>\n\n<p>Buffer:</p>\n\n<pre><code>#define BUF ((struct uip_eth_hdr *)&amp;uip_buf[0])\n\n\nstruct uip_eth_hdr\n{\n  struct uip_eth_addr dest;\n  struct uip_eth_addr src;\n  uint16_t type;\n};\n\nstruct uip_eth_addr\n{\n    uint8_t addr[6];\n};\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1547590198, "post_id": 54199864, "comment_id": 95241790, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/186743/discussion-on-question-by-sagar-deshpande-calling-c-member-function-from-c\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 2, "creation_date": 1547560255, "post_id": 54200012, "comment_id": 95227000, "body": "... or just delegate object creation to C++: <code>extern &quot;C&quot; struct NB* createNB() { return new NB(); }</code>"}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1547560723, "post_id": 54200012, "comment_id": 95227284, "body": "IMHO it&#39;s worth of noting, for the sake of completness, that in pure c++ producing object files for external-linking is technically counterproductive, because there is name mangling and (I think) argument passing mode which are not standardized, so finding and using compiled functions is fragile. Keywords <i>C++ ABI</i>, <i>external and internal linkage</i>. The counter measure is of course to specify C-linkage, which c++-compliant compiler should provide and has its own implications."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1547560812, "post_id": 54200012, "comment_id": 95227331, "body": "@rustyx in which case be careful to also provide <code>freeNB</code> or similarly named function and document it in immediate vicinity of <code>createNB</code>, lest a C user of the API becomes confused about how to deal with the memory."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 4, "last_activity_date": 1547559503, "creation_date": 1547559503, "answer_id": 54200012, "question_id": 54199864, "link": "https://stackoverflow.com/questions/54199864/calling-c-member-function-from-c/54200012#54200012", "title": "Calling C++ member function from C", "body": "<p>You built <code>test.c</code>, great! Now you need to build the C++ file as well so that definitions are present.</p>\n\n<p>Currently your toolchain thinks you want to compile <em>and link</em> <code>test.c</code> into an application, but <code>test.c</code> isn't your whole source code.</p>\n\n<p>You can compile <code>test.c</code> without linking:</p>\n\n<pre><code>gcc test.c -c\n</code></pre>\n\n<p>Then do the same with your C++ file:</p>\n\n<pre><code>g++ whatever.cpp -c\n</code></pre>\n\n<p>Then link them together to get an executable:</p>\n\n<pre><code>g++ test.o whatever.o -o myProgram\n</code></pre>\n\n<p>Unfortunately your program will still not work because you are invoking a member function on a dangling/uninitialised pointer. Since you cannot instantiate an <code>NB</code> from your C code, this approach can't work.</p>\n\n<p>I recommend <code>NB</code> contain only C-compatible members. Then you can put its definition into a shared header file and instantiate it whereever you please.</p>\n"}], "owner": {"reputation": 63, "user_id": 9089004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62df9efa1edf1958cb0950a59b2826a?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar Deshpande", "link": "https://stackoverflow.com/users/9089004/sagar-deshpande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547559503, "creation_date": 1547559038, "last_edit_date": 1547559223, "question_id": 54199864, "link": "https://stackoverflow.com/questions/54199864/calling-c-member-function-from-c", "title": "Calling C++ member function from C", "body": "<p>Following is my C++ code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;iostream&gt;\n#include&lt;string.h&gt;\nextern \"C\" void wrapper(struct NB*, int );\n\nstruct AssetDbFilter {\n    std::string attribute;\n    std::string value;\n  };\n\nclass NB {\n\npublic:\n    void myTest(int a);\n};\n</code></pre>\n\n<p>Following is C++ code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;string.h&gt;\n #include \"test.h\"\nusing namespace std;\n\nvoid NB :: myTest (int a) {\n\ncout &lt;&lt; a;\n}\nvoid wrapper(NB* nb, int a) {\nnb-&gt;myTest(a);\n}\n</code></pre>\n\n<p>Following is my c code: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include \"test.h\"\nvoid wrapper(struct NB* ,int );\nint main()\n{\n    AssetDbFilter* assetdb;\n    struct NB* nb;\n    wrapper(nb, 5);\n}\n</code></pre>\n\n<p>I am not able to execute this code.\nI am calling C++ member function from a C code. When I execute this C file as <code>g++ test.c</code> I am getting following error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/tmp/ccr1IaLa.o: In function `main':\ntest1.c:(.text+0x15): undefined reference to `wrapper'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Can anyone tell me how can I resolve this?</p>\n"}, {"tags": ["c", "integer", "bit-manipulation"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1547558307, "post_id": 54199556, "comment_id": 95225903, "body": "Are you talking about printing the value without changing the variable content or about modifying the value in the variable? Hexadecimal format only makes sense in context of printing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1547559691, "post_id": 54199556, "comment_id": 95226654, "body": "It is not clear if you need this on bit level, nibble level or byte level. And what do you mean &quot;left aligned&quot;, is this a raw value or a string? Why do you need it moved? Please clarify."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547560056, "post_id": 54199556, "comment_id": 95226868, "body": "@Lundin <code>0x001407E8 --&gt; 0x1407E800</code> implies   not bit level. <code>0x099B1348 --&gt; 0x9B134880</code> implies  not byte level. So, uncleanly, this is to be nibble level."}, {"owner": {"reputation": 63, "user_id": 10841485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40df013dc9eb5be81a8f3ae0ee2e042?s=128&d=identicon&r=PG&f=1", "display_name": "surajrgupta", "link": "https://stackoverflow.com/users/10841485/surajrgupta"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1547560185, "post_id": 54199556, "comment_id": 95226952, "body": "@Gerhardh i need to process the value and while doing that i need to make sure that is left aligned. Hexadecimal i am using it for printing as well initialising the variable"}, {"owner": {"reputation": 63, "user_id": 10841485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40df013dc9eb5be81a8f3ae0ee2e042?s=128&d=identicon&r=PG&f=1", "display_name": "surajrgupta", "link": "https://stackoverflow.com/users/10841485/surajrgupta"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547560356, "post_id": 54199556, "comment_id": 95227051, "body": "@Lundin i need it atleast nibble level"}, {"owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "edited": false, "score": 0, "creation_date": 1547560427, "post_id": 54199556, "comment_id": 95227090, "body": "The shift stepwise by 1 bit could have been asked for too: 0x4444_789A to 0x8888_F134"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1547560490, "post_id": 54199556, "comment_id": 95227129, "body": "@surajrgupta &quot;i am using it for printing as well initialising the variable&quot;: --&gt; Posting code that demonstrates this use would add clarity and would allow answers to provide even greater insight."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1547560626, "post_id": 54199556, "comment_id": 95227207, "body": "What is ff your number is, say <code>0x123</code>? Do you want to transform it to <code>0x12300000</code>? You question is somewhat unclear. Please <a href=\"https://stackoverflow.com/posts/54199556/edit\">edit</a> and add more examples."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1547560917, "post_id": 54199556, "comment_id": 95227396, "body": "&quot;I have a 32 bit integer variable in hexadecimal format&quot; - there is the contradiction. A number doesn&#39;t have a format, although formats become relevant when we want to write a number down. Is this question therefore really about how to format a 32 bit <code>int</code>, and if so, then what do you really want to do?"}, {"owner": {"reputation": 63, "user_id": 10841485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40df013dc9eb5be81a8f3ae0ee2e042?s=128&d=identicon&r=PG&f=1", "display_name": "surajrgupta", "link": "https://stackoverflow.com/users/10841485/surajrgupta"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1547561393, "post_id": 54199556, "comment_id": 95227693, "body": "@Jabberwocky yes i want it as 0x12300000 if at all compile takes it as 0x00000123 while initializing i want it manipulated as 0x12300000"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1547563089, "post_id": 54199556, "comment_id": 95228816, "body": "@surajrgupta please <a href=\"https://stackoverflow.com/posts/54199556/edit\">edit</a> your question and put all clarifications <i>there</i>."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1547558358, "post_id": 54199632, "comment_id": 95225925, "body": "Might wish to add <code>if (value)</code> before and <code>return value;</code> after the loop."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1547558659, "post_id": 54199632, "comment_id": 95226086, "body": "@NominalAnimal what for?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547558722, "post_id": 54199632, "comment_id": 95226119, "body": "@P__J__ To prevent an infinite loop"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1547559145, "post_id": 54199632, "comment_id": 95226346, "body": "@Ctx how <code>if</code> before the <code>return</code> can prevent the while loop (considering the lack of the check) from being infinitive"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1547559217, "post_id": 54199632, "comment_id": 95226386, "body": "@P__J__ Read carefully, &quot;if before <i>and</i> return value after the loop&quot;"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1547560024, "post_id": 54199632, "comment_id": 95226848, "body": "I meant, <code>if (value) while (!(value &amp;0xF0000000U)) value &lt;&lt;= 4; return value;</code> might be preferable. I say <i>might</i>, because I see it as clearer expression of programmer intent, with fewer opportunities of bugs creeping in; better example for those learning to program. Actually, now that I think about it, I like <code>if (value) while (value &lt; 0x10000000) value &lt;&lt;= 4; return value;</code> even more for those same reasons."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1547560663, "post_id": 54199632, "comment_id": 95227238, "body": "@NominalAnimal Makes sense.  I moved the 0 check out of the loop to make the intent more clear."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547561002, "post_id": 54199632, "comment_id": 95227447, "body": "Although the <code>U</code> suffix in <code>0xF0000000U</code> not technically needed here, I see it adds clarity to the code.  Likely prevents some odd warning too with picky compilers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1547573939, "post_id": 54199632, "comment_id": 95235048, "body": "@P__J__ Re: &quot;0x.... are always U&quot; is not supported  by the C spec C11 &#167;6.4.4.1. The sign-ness of the type applied to the constant depends on its value.   <code>0x123</code> is an <code>int</code>, not <code>unsigned</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 8, "last_activity_date": 1547560632, "last_edit_date": 1547560632, "creation_date": 1547558239, "answer_id": 54199632, "question_id": 54199556, "link": "https://stackoverflow.com/questions/54199556/how-to-left-align-a-32-bit-integer/54199632#54199632", "title": "How to left align a 32 bit integer?", "body": "<p>What you're really asking for is if the high-order 4 bits are set.  You can do this as follows:</p>\n\n<pre><code>uint32_t left_align(uint32_t value)\n{\n    if (value) {\n        while ((value &amp; 0xF0000000U) == 0) {\n            value &lt;&lt;= 4;\n        }\n    }\n    return value;\n}\n</code></pre>\n\n<p>As long as the value is non-zero and the higher order 4 bits are 0, shift left by 4 until they are non-zero.</p>\n"}], "owner": {"reputation": 63, "user_id": 10841485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40df013dc9eb5be81a8f3ae0ee2e042?s=128&d=identicon&r=PG&f=1", "display_name": "surajrgupta", "link": "https://stackoverflow.com/users/10841485/surajrgupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1547562673, "creation_date": 1547557942, "last_edit_date": 1547562297, "question_id": 54199556, "link": "https://stackoverflow.com/questions/54199556/how-to-left-align-a-32-bit-integer", "title": "How to left align a 32 bit integer?", "body": "<p>I have a 32 bit integer variable in hexadecimal format say <code>0x9B13488</code> or <code>0x1407E8</code>. Defaultly it is right aligned to <code>0x099B1348</code> or <code>0x001407E8</code>. But I want it to be left aligned to <code>0x9B134880</code> or <code>0x1407E800</code>. Can anyone help me with it?</p>\n"}, {"tags": ["c", "csv"], "comments": [{"owner": {"reputation": 1548, "user_id": 6876710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIdxC.jpg?s=128&g=1", "display_name": "El.Hum", "link": "https://stackoverflow.com/users/6876710/el-hum"}, "edited": false, "score": 2, "creation_date": 1547558272, "post_id": 54199550, "comment_id": 95225889, "body": "what is the error?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1547558623, "post_id": 54199550, "comment_id": 95226068, "body": "<code>getfield (tmp, 1)</code> modifies <code>tmp</code> and <code>getfield (tmp, 2)</code> expects a not modified <code>tmp</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1547558883, "post_id": 54199550, "comment_id": 95226198, "body": "Check if <code>stream</code> is <code>NULL</code> right after <code>FILE *stream = fopen(&quot;input.TXT&quot;, &quot;r&quot;);</code> and abort if yes. Not doing so could result in a segfault if the file cannot be opened for some reason. Same for <code>fp</code>. On most modern Windows you cannot write to <code>C:\\temp</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1547559936, "post_id": 54199550, "comment_id": 95226781, "body": "Please edit the question so that it has consistent indention and brace placement. Your coding style is all over the place, making this hard to read."}, {"owner": {"reputation": 1, "user_id": 10916997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff304f10dda981fb005a52ae5c891bf?s=128&d=identicon&r=PG&f=1", "display_name": "humptydumpy1", "link": "https://stackoverflow.com/users/10916997/humptydumpy1"}, "reply_to_user": {"reputation": 1548, "user_id": 6876710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIdxC.jpg?s=128&g=1", "display_name": "El.Hum", "link": "https://stackoverflow.com/users/6876710/el-hum"}, "edited": false, "score": 0, "creation_date": 1547561166, "post_id": 54199550, "comment_id": 95227544, "body": "@El.Ham &quot;segmentation fault program finished with exit code 139&quot;"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1547561417, "post_id": 54199550, "comment_id": 95227706, "body": "@humptydumpy1 because of your while setting <i>tmp</i> null after. Look at my answer ..."}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1547561544, "last_edit_date": 1547561544, "creation_date": 1547559973, "answer_id": 54200145, "question_id": 54199550, "link": "https://stackoverflow.com/questions/54199550/segmentation-error-but-i-cant-find-where/54200145#54200145", "title": "Segmentation error but I can&#39;t find where", "body": "<p>after</p>\n\n<blockquote>\n<pre><code>while ((tmp = strchr (tmp, ',')) != NULL)\n{\n  count++;\n  tmp++;\n}\n</code></pre>\n</blockquote>\n\n<p><em>tmp</em> is NULL, so the next call to getfield will get a null pointer, the <em>while</em> must be done on an other pointer or you need to save tmp before</p>\n\n<p>for example do :</p>\n\n<pre><code>char * p = tmp;\n\nwhile ((p = strchr (p, ',')) != NULL)\n{\n  count++;\n  p++;\n}\n</code></pre>\n\n<hr>\n\n<p>As it was already said in remark your use of <em>strtok</em> is wrong because the string is modified after each call.</p>\n\n<p>You can modify <em>getfield</em> to work on a copy :</p>\n\n<pre><code>const char *\ngetfield (char *line, int num)\n{\n  static char l[1024];\n  strcpy(l, line);\n  const char *tok;\n  for (tok = strtok (l, \",\"); tok &amp;&amp; *tok; tok = strtok (NULL, \",\\n\"))\n  {\n    if (!--num)\n      return tok;\n  }\n  return NULL;\n}\n</code></pre>\n\n<p>But this is a poor way to do because each time to have to go throw the string bypassing more and more tokens.</p>\n\n<p>I let you optimize your code to extract each token only one time on each line.</p>\n\n<hr>\n\n<p>Note also that you use the first line of the csv, so you create a file based on 'Name' etc</p>\n"}], "owner": {"reputation": 1, "user_id": 10916997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff304f10dda981fb005a52ae5c891bf?s=128&d=identicon&r=PG&f=1", "display_name": "humptydumpy1", "link": "https://stackoverflow.com/users/10916997/humptydumpy1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547561544, "creation_date": 1547557933, "last_edit_date": 1547561362, "question_id": 54199550, "link": "https://stackoverflow.com/questions/54199550/segmentation-error-but-i-cant-find-where", "title": "Segmentation error but I can&#39;t find where", "body": "<p>I'm stuck as I don't understand why my parser code is not working one compiler just says segmentation error. While another compiler compiles it but it just returns an error code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char *\ngetfield (char *line, int num)\n{\n  const char *tok;\n  for (tok = strtok (line, \",\"); tok &amp;&amp; *tok; tok = strtok (NULL, \",\\n\"))\n  {\n    if (!--num)\n      return tok;\n  }\n  return NULL;\n}\n\nint\nmain ()\n{\n  FILE *stream = fopen (\"input\", \"r\");\n  FILE *fp;\n  char line[1024];\n  while (fgets (line, 1024, stream))\n  {\n     char *tmp = strdup (line);\n     char buf[0x100];\n     snprintf (buf, sizeof (buf), \"c:\\\\temp\\\\%s.txt\", getfield (tmp, 1));\n     fp = fopen (buf, \"w\");\n     int count = 0;\n     while ((tmp = strchr (tmp, ',')) != NULL)\n     {\n       count++;\n       tmp++;\n     }\n     if (count == 4 ){\n       fprintf (fp,\n               \"{This is my name %s\\n I'm %s years old\\n my       useragent is %s\\n My hobbies are %s\\n}\",\n               getfield (tmp, 1), getfield (tmp, 2),\n               getfield (tmp, 4), getfield (tmp, 5));\n     }\n     else {\n        fprintf (fp,\n                 \"{This is my name %s\\n I'm %s years old\\n my       useragent is %s%s\\n My hobbies are %s\\n}\",\n                 getfield (tmp, 1), getfield (tmp, 2),\n                 getfield (tmp, 4), getfield (tmp, 5),\n                 getfield (tmp, 6));\n     }\n\n     fclose (fp);\n     free (tmp);\n   }\n}\n</code></pre>\n\n<p>I have a csv file with thousands of lines. example</p>\n\n<pre><code>Name,age,gender,useragent,hobby\nmaximilian,16,Male,Mozilla/5.0 (compatible, MSIE 11, Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko,skateboard\n</code></pre>\n\n<p>Im trying to make a file for each name and add the other information in it. so it would output this for example</p>\n\n<pre><code>maximilain.txt\n\nThis is my name maximilian\n I'm 16 years old\n my useragent is Mozilla/5.0 (compatible, MSIE 11, Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko\n My hobbies are skateboard\n</code></pre>\n"}, {"tags": ["c", "eclipse", "makefile", "scheduling"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1547560208, "post_id": 54199544, "comment_id": 95226965, "body": "either <code>runas</code> or <code>sudo</code> depending on OS."}, {"owner": {"reputation": 25, "user_id": 10766241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYnDJ.jpg?s=128&g=1", "display_name": "ikram", "link": "https://stackoverflow.com/users/10766241/ikram"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1547560818, "post_id": 54199544, "comment_id": 95227334, "body": "Yes <code>sudo</code>to indicate the root, but where should I add it? in makefile or where? because when I run my project using the makefile it shows an error in the console and it asks to be root!! I use linux operating system"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1547561036, "post_id": 54199544, "comment_id": 95227470, "body": "Add on the commands in the Makefile that need to run as root.  Also update the /etc/sudoers file to add the specific commands."}, {"owner": {"reputation": 25, "user_id": 10766241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYnDJ.jpg?s=128&g=1", "display_name": "ikram", "link": "https://stackoverflow.com/users/10766241/ikram"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1547561495, "post_id": 54199544, "comment_id": 95227759, "body": "all the commands in my makefile must be running as root, should I put sudo at the beginning of makefile??"}, {"owner": {"reputation": 5566, "user_id": 530160, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xRnFS.jpg?s=128&g=1", "display_name": "Nick ODell", "link": "https://stackoverflow.com/users/530160/nick-odell"}, "edited": false, "score": 0, "creation_date": 1547580636, "post_id": 54199544, "comment_id": 95237985, "body": "<i>Every</i> command? Even building and linking it?"}, {"owner": {"reputation": 25, "user_id": 10766241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYnDJ.jpg?s=128&g=1", "display_name": "ikram", "link": "https://stackoverflow.com/users/10766241/ikram"}, "edited": false, "score": 0, "creation_date": 1547662005, "post_id": 54199544, "comment_id": 95271616, "body": "Here is my makefile <code>prod:\t\tproduct.c main.c product.h \t\tgcc -o prod -O3 product.c main.c   prod.db:\tproduct.c main.c product.h \t \t\tgcc -o prod.db -g -O3 product.c main.c </code>"}, {"owner": {"reputation": 25, "user_id": 10766241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYnDJ.jpg?s=128&g=1", "display_name": "ikram", "link": "https://stackoverflow.com/users/10766241/ikram"}, "edited": false, "score": 0, "creation_date": 1547662602, "post_id": 54199544, "comment_id": 95271906, "body": "these commands must be executed as root in terminal, but i want to use it in my  C project (using eclipse), in other words makefile must be used in eclipse as root... how can i implement my makefile in this case?? I hope that I have well expressed my problem"}], "owner": {"reputation": 25, "user_id": 10766241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYnDJ.jpg?s=128&g=1", "display_name": "ikram", "link": "https://stackoverflow.com/users/10766241/ikram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547557903, "creation_date": 1547557903, "question_id": 54199544, "link": "https://stackoverflow.com/questions/54199544/makefile-as-root", "title": "Makefile as root", "body": "<p>Good evening everyone,</p>\n\n<p>I was able to create a code to launch real-time tasks, I used sched_setscheduler to modify the type of scheduler and it requires to be root to start program execution.\nAll is fine when I used the command lines, but now I want to run my project with makefile under eclipse, I was able to create the makefile, but my problem that I could not make my code executable as an instance using the makefile</p>\n\n<p>So my question: how to run my makefile project  which is created under eclipse as administrator, is there an instruction to add in my makefile file to do that?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1547557992, "post_id": 54199498, "comment_id": 95225754, "body": "Start by putting common definitions and declarations in a <i>header file</i> that both source files could include."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1547558043, "post_id": 54199498, "comment_id": 95225779, "body": "And don&#39;t forget that all symbols you use must be declared or defined <i>before</i> you use them."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1547558204, "post_id": 54199498, "comment_id": 95225863, "body": "Lastly, listen to your compiler and what it tells you. <code>List* value=9;</code> is wrong. So is <code>my_struct_obj_global.my_struct_obj.my_list = &amp;value</code>. It seems you either learning C by guessing (which will not work much longer) or you skipped a few chapters in whatever book your reading (or possibly skipped a few classes). My recommendation is that you get a couple of books and start over. Good books will also describe how to split programs into multiple source and header files."}, {"owner": {"reputation": 194, "user_id": 7867589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c73e3bad8dfdd5265d2b04d888b0655d?s=128&d=identicon&r=PG&f=1", "display_name": "kmartin", "link": "https://stackoverflow.com/users/7867589/kmartin"}, "edited": false, "score": 0, "creation_date": 1547559501, "post_id": 54199498, "comment_id": 95226560, "body": "Do you link object files (file1.o and file2.o) together or do you have an include statement in file2.c (do you include a header file or the c file)? Because, in one case it might work, in others it will not."}, {"owner": {"reputation": 73, "user_id": 10916967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097c1c4a2247e1712a3b6f04e32b66f4?s=128&d=identicon&r=PG&f=1", "display_name": "jon", "link": "https://stackoverflow.com/users/10916967/jon"}, "reply_to_user": {"reputation": 194, "user_id": 7867589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c73e3bad8dfdd5265d2b04d888b0655d?s=128&d=identicon&r=PG&f=1", "display_name": "kmartin", "link": "https://stackoverflow.com/users/7867589/kmartin"}, "edited": false, "score": 0, "creation_date": 1547560576, "post_id": 54199498, "comment_id": 95227167, "body": "@kmartin: yes I linked them below is command gcc -c file1.c gcc -c file2.c gcc -o my_bin file1.o file2.o"}, {"owner": {"reputation": 73, "user_id": 10916967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097c1c4a2247e1712a3b6f04e32b66f4?s=128&d=identicon&r=PG&f=1", "display_name": "jon", "link": "https://stackoverflow.com/users/10916967/jon"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1547560756, "post_id": 54199498, "comment_id": 95227302, "body": "@Someprogrammerdude:  to save time I directly wrote code here, for sake I uploaded complete compiled code and output, you are deviating from my main question, my question was how can I access value in above case from another file"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1547560949, "post_id": 54199498, "comment_id": 95227416, "body": "Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a> and <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": true, "score": 1, "last_activity_date": 1547560982, "creation_date": 1547560982, "answer_id": 54200448, "question_id": 54199498, "link": "https://stackoverflow.com/questions/54199498/how-to-access-pointer-member-of-nested-structure-in-c-code-from-another-file/54200448#54200448", "title": "how to access pointer member of nested structure in c code from another file", "body": "<ul>\n<li><p><code>value</code> is a local variable in function <code>assign_value()</code>. It is created when the function is entered, and it is destroyed when the function returns.</p></li>\n<li><p>In function <code>print_value()</code>, the value of <code>struct_global.struct_two.my_list</code> is a dangling pointer: its value is the address of a variable which does not exist any more.</p></li>\n<li><p>Dereferencing the value of a dangling pointer is undefined behavior.</p></li>\n</ul>\n"}], "owner": {"reputation": 73, "user_id": 10916967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097c1c4a2247e1712a3b6f04e32b66f4?s=128&d=identicon&r=PG&f=1", "display_name": "jon", "link": "https://stackoverflow.com/users/10916967/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 54200448, "answer_count": 1, "score": 1, "last_activity_date": 1547561057, "creation_date": 1547557692, "last_edit_date": 1547561057, "question_id": 54199498, "link": "https://stackoverflow.com/questions/54199498/how-to-access-pointer-member-of-nested-structure-in-c-code-from-another-file", "title": "how to access pointer member of nested structure in c code from another file", "body": "<p>Below is complete code</p>\n\n<p>brief summary of my problem is below:\nI have one global structure as mentioned below in file1.c and its getting initialized with some value in file1.c by function\"assign_value()\"  and now I am printing  this value by function \"print_value()\" from file2.c.</p>\n\n<p>Problem is that: its not printing proper value from file2.c on the other hand if I call \"print_value()\" from file1.c inside function \"assign_value()\" as mentioned below then it shows proper value.</p>\n\n<p>Please suggest what I am missing, why I am not able to print proper value by calling print_value() function in file2.c</p>\n\n<pre><code>  file1.c\n</code></pre>\n\n<p>My_struct_one is nested structure containing another structure My_struct_two and my_struct_obj_global is global variable in file1.c</p>\n\n<pre><code>    //file1.c\n\n    #include &lt;stdio.h&gt;\n\n    #include \"file1.h\"\n\n    typedef unsigned long int List;\n\n    typedef struct\n    {\n\n     List* my_list;\n    }My_struct_two;\n\n\n     typedef struct\n    {\n\n     My_struct_two struct_two;\n    }My_struct_one;\n\n\n     My_struct_one struct_global;\n\n\n\n      void assign_value()\n     {\n     List value=9;\n\n     struct_global.struct_two.my_list = &amp;value;\n     print_value();\n     }\n\n    void print_value()\n    {\n    printf(\"inside print\");\n    printf(\"value=%u\\n\",*(struct_global.struct_two.my_list));\n    }\n</code></pre>\n\n<p>file1.h\n      //file.h</p>\n\n<pre><code>  #ifndef _file1_c\n\n  #define _file1_c\n\n  void print_value();\n  void assign_value();\n\n  #endif\n</code></pre>\n\n<p>file2.c\n      #include </p>\n\n<pre><code>  #include \"file1.h\"\n\n  int main()\n\n  {\n\n  assign_value();\n\n  print_value();\n\n  return 0;\n\n   }\n</code></pre>\n\n<p>OUTPUT:\ninside printvalue=9\ninside printvalue=4195506</p>\n\n<p>Mine doubt is why I cant access value from file2.c,</p>\n"}, {"tags": ["c++", "c", "pointers", "struct"], "answers": [{"comments": [{"owner": {"reputation": 358, "user_id": 10786209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gYLs6yxZ0O8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSnv3QCHlWD59RGwXxM_Pjq8YYPg/mo/photo.jpg?sz=128", "display_name": "Abdel Aleem", "link": "https://stackoverflow.com/users/10786209/abdel-aleem"}, "edited": false, "score": 0, "creation_date": 1547556610, "post_id": 54199207, "comment_id": 95225046, "body": "What is the advantage of using nullptr rather than 0?"}, {"owner": {"reputation": 1532, "user_id": 2226029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d9b4c52d59ba745a6e0fb739256959?s=128&d=identicon&r=PG", "display_name": "thomas_f", "link": "https://stackoverflow.com/users/2226029/thomas-f"}, "edited": false, "score": 1, "creation_date": 1547556625, "post_id": 54199207, "comment_id": 95225057, "body": "If he&#39;s using C++11 or newer, yes."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 358, "user_id": 10786209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gYLs6yxZ0O8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSnv3QCHlWD59RGwXxM_Pjq8YYPg/mo/photo.jpg?sz=128", "display_name": "Abdel Aleem", "link": "https://stackoverflow.com/users/10786209/abdel-aleem"}, "edited": false, "score": 1, "creation_date": 1547556708, "post_id": 54199207, "comment_id": 95225104, "body": "@AbdelAleem It wouldn&#39;t make a technical difference for directly initializing a pointer member like this, but it can make a difference in some cases involving overloaded functions and/or templates.  So it&#39;s a good practice to use it by default for all pointers, and it also makes the intent of the code clearer."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 2, "creation_date": 1547556756, "post_id": 54199207, "comment_id": 95225127, "body": "It means you are being explicit that you are null initialising a pointer. Also you will get an error if you accidentally try to assign <code>nullptr</code> to an integer. e.g. if you mistyped your initialiser as <code>{false, false, 0, nullptr, nullptr, 0}</code> it wont compile"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 358, "user_id": 10786209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gYLs6yxZ0O8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSnv3QCHlWD59RGwXxM_Pjq8YYPg/mo/photo.jpg?sz=128", "display_name": "Abdel Aleem", "link": "https://stackoverflow.com/users/10786209/abdel-aleem"}, "edited": false, "score": 2, "creation_date": 1547556968, "post_id": 54199207, "comment_id": 95225228, "body": "@AbdelAleem Self-documentingness only in this particular case, but it&#39;s a good habit generally."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1532, "user_id": 2226029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d9b4c52d59ba745a6e0fb739256959?s=128&d=identicon&r=PG", "display_name": "thomas_f", "link": "https://stackoverflow.com/users/2226029/thomas-f"}, "edited": false, "score": 0, "creation_date": 1547557301, "post_id": 54199207, "comment_id": 95225391, "body": "@thomas_f - Using C++11 or newer may not have been a valid assumption at 2012. At 2019 it&#39;s not unreasonable to assume it. Generally, the consensus on SO is that unless the OP says so themselves, one can assume a fairly modern standard revisions is being used."}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": true, "score": 3, "last_activity_date": 1547556522, "creation_date": 1547556522, "answer_id": 54199207, "question_id": 54199170, "link": "https://stackoverflow.com/questions/54199170/initialize-pointer-to-struct-inside-another-struct/54199207#54199207", "title": "Initialize pointer to struct inside another struct", "body": "<p>You should use <code>nullptr</code> rather than <code>0</code> but otherwise there is nothing wrong with initialising a pointer to 0.</p>\n"}], "owner": {"reputation": 358, "user_id": 10786209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gYLs6yxZ0O8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSnv3QCHlWD59RGwXxM_Pjq8YYPg/mo/photo.jpg?sz=128", "display_name": "Abdel Aleem", "link": "https://stackoverflow.com/users/10786209/abdel-aleem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 54199207, "answer_count": 1, "score": 0, "last_activity_date": 1547557078, "creation_date": 1547556402, "last_edit_date": 1547557078, "question_id": 54199170, "link": "https://stackoverflow.com/questions/54199170/initialize-pointer-to-struct-inside-another-struct", "title": "Initialize pointer to struct inside another struct", "body": "<p>I have two pointer variables (<code>prevGuiMsg</code> and <code>currGuiMsg</code>) to a struct inside another struct definition in a C++ source-file:</p>\n\n<pre><code>typedef struct\n{\n    bool re_pop_required;\n    bool concurrent_popups;\n    MlGuiMsg* prevGuiMsg;\n    MlGuiMsg* currGuiMsg;\n    uint32_t first_popup;\n    uint32_t second_popup;\n}RePopup;\n</code></pre>\n\n<p>The <code>M1GuiMsg</code>-struct is defined inside a different C header-file (I'm mixing C and C++ code). A pointer to the struct is passed as an argument to a function in the source file, where I wish to store the data that the parameter points to in the pointer variables <code>prevGuiMsg</code> and <code>currGuiMsg</code>. </p>\n\n<p>I wish to <em>explicitly</em> declare a variable of the type struct <code>RePopup</code> and initialize its members along with the declaration in the C++ source file:</p>\n\n<pre><code>RePopup rp = {false, false, 0, 0, 0, 0};\n</code></pre>\n\n<p>My question is therefore: can/should one initialize a pointer to a struct with zero inside the explicit declaration of another struct?</p>\n"}, {"tags": ["c++", "c", "c++11"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1547554422, "post_id": 54198611, "comment_id": 95223890, "body": "Please copy-paste the error messages, instead of paraphrasing them."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1547554798, "post_id": 54198611, "comment_id": 95224085, "body": "Always read the first error message"}], "answers": [{"comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 2, "creation_date": 1547554828, "post_id": 54198658, "comment_id": 95224107, "body": "You can&#39;t just use <code>num</code>, <code>power</code>, etc. in GCC syntax without declaring them as inputs. And you&#39;d probably want to specify clobbers."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1547554896, "post_id": 54198658, "comment_id": 95224151, "body": "There are certainly other issues. I&#39;ll let the OP raise a ASM question if they can&#39;t figure that bit out."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1547555826, "post_id": 54198658, "comment_id": 95224645, "body": "Alright. Just seems to be confusing to provide not working code as an example (without indication that it&#39;s not supposed to work) to already struggling OP."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1547556194, "post_id": 54198658, "comment_id": 95224839, "body": "@DanM. Perhaps but I&#39;m only keen to answer the C++ question that was asked, particularly as I don&#39;t know ASM."}, {"owner": {"reputation": 53, "user_id": 8165646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eab237ca62495715d008654791b2faa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhilash Barigidad", "link": "https://stackoverflow.com/users/8165646/abhilash-barigidad"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1547561442, "post_id": 54198658, "comment_id": 95227717, "body": "@DanM. I know we can&#39;t use directly the variable names in GCC syntax without declaring them, because they use AT&amp;T syntax. But <code>masm= intel</code> should make them compatible to run with GCC compiler as they were with Visual studio compiler"}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "reply_to_user": {"reputation": 53, "user_id": 8165646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eab237ca62495715d008654791b2faa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhilash Barigidad", "link": "https://stackoverflow.com/users/8165646/abhilash-barigidad"}, "edited": false, "score": 0, "creation_date": 1547561831, "post_id": 54198658, "comment_id": 95227989, "body": "@AbhilashBarigidad no. You are confusing intel vs at&amp;t syntax with inline assembly compiler extension (and its &quot;syntax&quot;). They have little to do with each over. You can use intel syntax for asm in GCC (i.e. implicit types, no $ before constants, different argument order and etc.), but you still need to conform to <code>__asm__</code> <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">syntax</a>."}, {"owner": {"reputation": 53, "user_id": 8165646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eab237ca62495715d008654791b2faa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhilash Barigidad", "link": "https://stackoverflow.com/users/8165646/abhilash-barigidad"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1547564726, "post_id": 54198658, "comment_id": 95229915, "body": "@DanM. I have updated the code as requested, please look into it."}, {"owner": {"reputation": 53, "user_id": 8165646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eab237ca62495715d008654791b2faa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhilash Barigidad", "link": "https://stackoverflow.com/users/8165646/abhilash-barigidad"}, "edited": false, "score": 0, "creation_date": 1547564747, "post_id": 54198658, "comment_id": 95229932, "body": "@LightnessRacesinOrbit. Have updated code, please look into it."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 53, "user_id": 8165646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eab237ca62495715d008654791b2faa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhilash Barigidad", "link": "https://stackoverflow.com/users/8165646/abhilash-barigidad"}, "edited": false, "score": 0, "creation_date": 1547565197, "post_id": 54198658, "comment_id": 95230222, "body": "@AbhilashBarigidad Like I said, you have errors unrelated to your original question - please ask them in a new question. I do not know ASM so will not be able to help with that one."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1547556208, "last_edit_date": 1547556208, "creation_date": 1547554513, "answer_id": 54198658, "question_id": 54198611, "link": "https://stackoverflow.com/questions/54198611/the-masm-intel-flag-is-not-working-for-running-assembly-language-in-gcc-compile/54198658#54198658", "title": "The -masm=intel flag is not working for running assembly language in gcc compiler with Intel syntax", "body": "<p>The most important error is the first one:</p>\n\n<pre><code>main.cpp:4:11: error: expected '(' before '{' token\n     __asm {\n           ^\n           (\n</code></pre>\n\n<p>You're using the wrong syntax for GCC. You've used Microsoft Visual Studio syntax. So, your GCC doesn't know that you're trying to give it assembly instructions.</p>\n\n<p>Instead of <code>__asm { ... }</code>, it should be <code>__asm__ ( \"...\" )</code>.</p>\n\n<p>Like this:</p>\n\n<pre><code>int AsmCode(int num,int power) {\n    __asm__ (\n        \"mov eax, num;\"\n        \"mov ecx, power;\"\n        \"shl eax, cl;\"\n    );\n}\n</code></pre>\n\n<p>Read more <a href=\"https://stackoverflow.com/q/3323445/560648\">here</a>.</p>\n\n<p>Note that there are further issues with your ASM that you should ask about separately.</p>\n"}], "owner": {"reputation": 53, "user_id": 8165646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eab237ca62495715d008654791b2faa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhilash Barigidad", "link": "https://stackoverflow.com/users/8165646/abhilash-barigidad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 54198658, "answer_count": 1, "score": 2, "last_activity_date": 1547564656, "creation_date": 1547554365, "last_edit_date": 1547564656, "question_id": 54198611, "link": "https://stackoverflow.com/questions/54198611/the-masm-intel-flag-is-not-working-for-running-assembly-language-in-gcc-compile", "title": "The -masm=intel flag is not working for running assembly language in gcc compiler with Intel syntax", "body": "<p>I am trying to use inline assembler __asm in my C program with Intel syntax as opposed to AT&amp;T syntax. I am compiling with <code>gcc -S -masm=intel test.c</code>\nbut it is giving error. Below is my test.c file.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//using namespace std;\nint AsmCode(int num,int power) {\n    __asm {\n        mov eax, num;\n        mov ecx, power;\n        shl eax, cl;\n    };\n}\nint main()\n{\n    printf(\"eax value is %d\\n\",AsmCode(2,3));\n\n    //getchar();\n    return 0;\n\n\n\n}\n</code></pre>\n\n<p>Expected result was eax value is 16, but errors are occurring like unknown type name 'mov',unknown type name 'shl' etc. </p>\n\n<p>Edit:\nI have updated the code as:</p>\n\n<pre><code>int AsmCode(int num,int power) {\n    __asm__ (\n        \"movl eax, num;\"\n        \"mov ecx, power;\"\n        \"shl eax, cl;\"\n    );\n}\nint main()\n{\n    printf(\"eax value is %d\\n\",AsmCode(2,3));\n    return 0;\n}\n</code></pre>\n\n<p>And compiled this code with <code>gcc -S -masm=intel test.c</code>. This resulted in <strong>NO OUTPUT</strong>, whereas it should produce output as <code>eax value is 16</code>. </p>\n\n<p>When compiled with <code>gcc test.c</code> it produced the errors:</p>\n\n<pre><code>Error: too many memory references for 'mov'\nError: too many memory references for 'shl'\n</code></pre>\n\n<p>Please help..</p>\n"}, {"tags": ["c", "linux", "filesystems"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1547560380, "post_id": 54198388, "comment_id": 95227063, "body": "The (st_dev, st_ino, st_gen) tuple would suffice, but unfortunately st_gen (inode generation number) is not exported by the kernel. It was considered for the <code>statx()</code> call, but it seems it didn&#39;t make into it."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1547560657, "post_id": 54198388, "comment_id": 95227230, "body": "That said, (st_dev, st_ino, st_btime) as provided by <a href=\"http://man7.org/linux/man-pages/man2/statx.2.html\" rel=\"nofollow noreferrer\"><code>statx()</code></a> might work. You&#39;ll need to use <code>syscall()</code> from <code>&lt;sys&#47;syscall.h&gt;</code>, and copy the <code>struct statx</code> from kernel <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/stat.h\" rel=\"nofollow noreferrer\">include/linux/uapi/stat.h:struct statx</a>."}], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1547554216, "post_id": 54198502, "comment_id": 95223770, "body": "Can you give some examples of metadata users can set?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1547554418, "post_id": 54198502, "comment_id": 95223887, "body": "@SomeName timestamps, file length (indirectly), ids, link count, etc"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1547554033, "creation_date": 1547554033, "answer_id": 54198502, "question_id": 54198388, "link": "https://stackoverflow.com/questions/54198388/distinguishing-file-on-the-filesystem/54198502#54198502", "title": "Distinguishing file on the filesystem", "body": "<p>Alas it is not possible because:</p>\n\n<ol>\n<li><p>for all data/metadata (including extended attributes, etc) in control of the user, it is possible to set their values/content to the exact same value as the \"original\" file.</p></li>\n<li><p>for inode number, it is dependent on the filesystem support in the kernel and many of them (FS) recycle inode numbers.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1547555315, "last_edit_date": 1547555315, "creation_date": 1547554646, "answer_id": 54198694, "question_id": 54198388, "link": "https://stackoverflow.com/questions/54198388/distinguishing-file-on-the-filesystem/54198694#54198694", "title": "Distinguishing file on the filesystem", "body": "<p>You can set extended filesystem attributes (where supported, i.e. with ext4 when mounted with option <code>user_xattr</code>):</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;attr/xattr.h&gt;\n\nint main (void) {\n    setxattr(\"test\", \"user.fileguid\", \"someuniqueguid\", 15, 0);\n}\n</code></pre>\n\n<p>and read it back with</p>\n\n<pre><code>char uuid[100];\nint len = getxattr(\"test\", \"user.fileguid\", uuid, sizeof(uuid), 0);\n</code></pre>\n\n<p>If this attribute should only be modified by a privileged process, you can use the <code>security</code> namespace instead of <code>user</code> (i.e. attribute-name <code>security.fileguid</code>). In this case, the file owner itself cannot modify the attributes himself. If you do not use the <code>user</code> namespace, the mount option <code>user_xattr</code> isn't even necessary.</p>\n\n<p>However, these attributes are not set immediately after creation of the file. But it should be sufficient to set a random guid at the first time when accessing the file with your tool (i.e. when no guid is set yet).</p>\n\n<p>These file attributes are saved with the inode, so renaming the file or (hard-)linking it will retain the attributes. However, deleting and creating it newly will not.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 54198694, "answer_count": 2, "score": 0, "last_activity_date": 1547555315, "creation_date": 1547553525, "question_id": 54198388, "link": "https://stackoverflow.com/questions/54198388/distinguishing-file-on-the-filesystem", "title": "Distinguishing file on the filesystem", "body": "<p>I'm trying to distinguish files on the filesystem with the following requirements(assuming all files are within the same filesystem):</p>\n\n<ol>\n<li>If file A was renamed to file B it should be appeared to be the same</li>\n<li>If file A was removed and then created it should appear to be different one</li>\n</ol>\n\n<p>Since I assumed that all files are within the same file system I tended to use <code>inode_number</code> for that. But it does not satisfy the point <code>2.</code>. Actually:</p>\n\n<pre><code>root@spc:~/test# touch test\nroot@spc:~/test# ls -li\ntotal 0\n2098203 -rw-r--r-- 1 root root 0 Jan 15 14:55 test\nroot@spc:~/test# rm test\nroot@spc:~/test# touch test\nroot@spc:~/test# ls -li\ntotal 0\n2098203 -rw-r--r-- 1 root root 0 Jan 15 14:55 test\n</code></pre>\n\n<p>So the two different files appeared to have the same inode number. Is there a way to do this for <code>linux/ext4</code>? Maybe we can use some file system specific api to store some meta <code>uid</code>?</p>\n"}, {"tags": ["c", "parallel-processing", "cuda", "gpu", "nvidia"], "comments": [{"owner": {"reputation": 6633, "user_id": 1662425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8109db00d44ebcdc900353b05e3a1443?s=128&d=identicon&r=PG", "display_name": "tera", "link": "https://stackoverflow.com/users/1662425/tera"}, "edited": false, "score": 0, "creation_date": 1547690252, "post_id": 54198279, "comment_id": 95281664, "body": "What platform? If Windows with the WDDM driver, the CPU time will additionally include one batch timeout. If the GPU also drives the display, there might be additional delays involved while the GPU is updating the screen."}, {"owner": {"reputation": 75, "user_id": 8164191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOsxl.jpg?s=128&g=1", "display_name": "Madhu Soodhan", "link": "https://stackoverflow.com/users/8164191/madhu-soodhan"}, "reply_to_user": {"reputation": 6633, "user_id": 1662425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8109db00d44ebcdc900353b05e3a1443?s=128&d=identicon&r=PG", "display_name": "tera", "link": "https://stackoverflow.com/users/1662425/tera"}, "edited": false, "score": 0, "creation_date": 1547718053, "post_id": 54198279, "comment_id": 95290730, "body": "Yes, I was aware of this. But I am using NVIDIA Jetson - TX2."}], "answers": [{"comments": [{"owner": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "edited": false, "score": 0, "creation_date": 1547560023, "post_id": 54198449, "comment_id": 95226846, "body": "To measure the elapsed time of a kernel execution on a specific stream, the event must be recorded on that stream by passing the stream handle as 2nd argument of <code>cudaEventRecord</code>. Like this: <code>cudaEventRecord(startGPU, stream);</code>."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 15243, "user_id": 1231073, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lSwuI.jpg?s=128&g=1", "display_name": "sgarizvi", "link": "https://stackoverflow.com/users/1231073/sgarizvi"}, "edited": false, "score": 1, "creation_date": 1547560155, "post_id": 54198449, "comment_id": 95226937, "body": "@sgarizvi true, I somehow overlooked that he was apparently using a separate stream for the kernel launch. Thanks for pointing that out! fixed."}, {"owner": {"reputation": 75, "user_id": 8164191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOsxl.jpg?s=128&g=1", "display_name": "Madhu Soodhan", "link": "https://stackoverflow.com/users/8164191/madhu-soodhan"}, "edited": false, "score": 0, "creation_date": 1547616870, "post_id": 54198449, "comment_id": 95247878, "body": "Thanks for the reply @MichaelKenzel. As I said, that was just the sample code, functionalities are very similar. I tried std::steady_clock and used streams in cudaEventRecord() as well, upon your suggestion, it gave me the same time as with +/- 0.05 ms which is negligible i guess. The kernel takes exactly 5-6ms as seen from cuda profiler. But why are my CPU timings suggesting 15ms? <i>scratching head</i>"}], "tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": true, "score": 3, "last_activity_date": 1547560116, "last_edit_date": 1547560116, "creation_date": 1547553800, "answer_id": 54198449, "question_id": 54198279, "link": "https://stackoverflow.com/questions/54198279/timings-differ-while-measuring-a-cuda-kernel/54198449#54198449", "title": "Timings differ while measuring a CUDA kernel", "body": "<p>Basically, what you're measuring as your CPU time is the time it takes to</p>\n\n<ol>\n<li>record the first event, </li>\n<li>set up the kernel launch with the respective parameters,</li>\n<li>send the necessary commands to the GPU,</li>\n<li>launch the kernel on the GPU,</li>\n<li>execute the kernel on the GPU,</li>\n<li>wait for the notification that GPU execution finished to get back to the CPU, and</li>\n<li>record the second event.</li>\n</ol>\n\n<p>Also, note that your method of measuring CPU time does not measure just the processing time spent by your process/thread, but, rather, the total system time elapsed (which potentially includes processing time spent by other processes/threads while your process/thread was not necessarily even running). I have to admit that, even in light of all that, the CPU time you report is still much larger compared to the GPU time than I would normally expect. But I'm not sure that that up there really is your entire code. In fact, I rather doubt it, given that, e.g., the <code>printf()</code>s don't really print anything. So there may be some additional factors we're not aware of that would still have to be considered to fully explain your timings.</p>\n\n<p>Anyways, most likely neither of the two measurements you take are actually measuring what you really wanted to measure. If you're interested in the time it takes for the kernel to run, then use CUDA events. However, if you synchronize first and only then record the end event, the time between the start and end events will be the time between the beginning of kernel execution, the CPU waiting for kernel execution to finish, and whatever time it may take to then record the second event and have that one get to the GPU just so you can then ask the GPU at what time it got it. Think of events like markers that mark a specific point in the command stream that is sent to the GPU. Most likely, you actually wanted to write this:</p>\n\n<pre><code>cudaEventRecord(startGPU, stream);       // mark start of kernel execution\nKernel&lt;&lt;&lt;abc, xyz, stream&gt;&gt;&gt;();\ncudaEventRecord(stopGPU, stream);        // mark end of kernel execution\ncudaEventSynchronize(stopGPU);   // wait for results to be available\n</code></pre>\n\n<p>and then use <code>cudaEventElapsedTime()</code> to get the time between the two events.</p>\n\n<p>Also, note that <code>gettimeofday()</code> is <a href=\"https://stackoverflow.com/questions/88/is-gettimeofday-guaranteed-to-be-of-microsecond-resolution\">not necessarily</a> a reliable way of obtaining high-resolution timings. In C++, you could use, e.g., <a href=\"https://en.cppreference.com/w/cpp/chrono/steady_clock\" rel=\"nofollow noreferrer\"><code>std::steady_clock</code></a>, or <a href=\"https://en.cppreference.com/w/cpp/chrono/high_resolution_clock\" rel=\"nofollow noreferrer\"><code>std::high_resolution_clock</code></a> (I would resort to the latter only if it cannot be avoided, since it is not guaranteed to be steady; and make sure that the clock period is actually sufficient for what you're trying to measure).</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 8164191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOsxl.jpg?s=128&g=1", "display_name": "Madhu Soodhan", "link": "https://stackoverflow.com/users/8164191/madhu-soodhan"}, "is_accepted": false, "score": -1, "last_activity_date": 1547718527, "creation_date": 1547718527, "answer_id": 54233111, "question_id": 54198279, "link": "https://stackoverflow.com/questions/54198279/timings-differ-while-measuring-a-cuda-kernel/54233111#54233111", "title": "Timings differ while measuring a CUDA kernel", "body": "<p>After debugging into the same issue, I found that cuda usually takes time before the first kernel launch, as referred in the forum here: <a href=\"https://devtalk.nvidia.com/default/topic/1042733/extremely-slow-cuda-api-calls-/?offset=3\" rel=\"nofollow noreferrer\">https://devtalk.nvidia.com/default/topic/1042733/extremely-slow-cuda-api-calls-/?offset=3</a>.</p>\n\n<p>The cuda runtime APIs before the kernel had 6ms of cudaMalloc and 14ms of cudaLaunch which was the reason for the extra delay. The subsequent kernels, however, was good to work normally. cudaLaunch take usually takes time in microseconds, so if anything goes beyond that, it definitely needs some repair.</p>\n\n<p><strong>NOTE:</strong> If you are running any cuda kernels in a while(1) loop (only once), the allocation must be done outside the loop. Else you will end up with delays just like this.</p>\n"}], "owner": {"reputation": 75, "user_id": 8164191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOsxl.jpg?s=128&g=1", "display_name": "Madhu Soodhan", "link": "https://stackoverflow.com/users/8164191/madhu-soodhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 54198449, "answer_count": 2, "score": 0, "last_activity_date": 1547718527, "creation_date": 1547553119, "question_id": 54198279, "link": "https://stackoverflow.com/questions/54198279/timings-differ-while-measuring-a-cuda-kernel", "title": "Timings differ while measuring a CUDA kernel", "body": "<p>I try to measure the time taken by a CUDA kernel function. I measure both CPU and GPU timings of it. But I'm getting a huge difference between both.</p>\n\n<p>When I profile it using the NVIDIA profiler the kernel takes around 6ms which is what I want. But when I used gettimeofday() around the kernel call to get the CPU timings, the measure was 15ms. I do not have any memcpy calls there too. The kernel runs in a separate stream. And similar kernels are running in concurrent streams.</p>\n\n<p>Sample code :</p>\n\n<pre><code>gettimeofday(start);\ncudaEventRecord(startGPU);\n\nKernel &lt;&lt;&lt;abc, xyz,stream&gt;&gt;&gt;();\ncudaDeviceSynchronize();\n\ncudaEventRecord(stopGPU);\nprintf(\"Elapsed GPU time  = \");\n\ngettimeofday(stop);\nprintf(\"Elapsed CPU time  = \");\n</code></pre>\n\n<p>Results I'm getting for the above code :</p>\n\n<p>Elapsed GPU time  = 6ms\nElapsed CPU time  = 15ms</p>\n\n<p>It is weird because there is only kernel execution line present. The kernel params are however pointers. Is the extra time being taken by mem copies? But I do not find mem copies anywhere in the profile too. Any leads would be appreciated.</p>\n"}, {"tags": ["c", "winapi", "keyboard", "locale", "raw-input"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4013478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Niello", "link": "https://stackoverflow.com/users/4013478/niello"}, "is_accepted": true, "score": 0, "last_activity_date": 1547578437, "creation_date": 1547578437, "answer_id": 54205183, "question_id": 54198173, "link": "https://stackoverflow.com/questions/54198173/win32-raw-input-blocks-input-locale-switching-when-ridev-nolegacy-is-specified/54205183#54205183", "title": "Win32 raw input blocks input locale switching when RIDEV_NOLEGACY is specified", "body": "<p>After another day it seems there is no easy solution. RIDEV_NOLEGACY just kills language switching by hotkey. The good news is that all necessary logic can be implemented by hand. That's my solution for now. It takes into account system hotkey setting, suppresses character generation for '`' key when it is used as hotkey, and even detects system hotkey changes without restarting an application.\nThe code is available in the same <a href=\"https://github.com/niello/misc/tree/master/RawInputLocale\" rel=\"nofollow noreferrer\">repo</a>.\nHope this will help someone else too.</p>\n"}], "owner": {"reputation": 63, "user_id": 4013478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Niello", "link": "https://stackoverflow.com/users/4013478/niello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 54205183, "answer_count": 1, "score": 1, "last_activity_date": 1547578437, "creation_date": 1547552649, "last_edit_date": 1547554304, "question_id": 54198173, "link": "https://stackoverflow.com/questions/54198173/win32-raw-input-blocks-input-locale-switching-when-ridev-nolegacy-is-specified", "title": "Win32 raw input blocks input locale switching when RIDEV_NOLEGACY is specified", "body": "<p>I'm writing a keyboard input system for Windows based on <a href=\"https://docs.microsoft.com/en-us/windows/desktop/inputdev/raw-input/\" rel=\"nofollow noreferrer\">Raw Input</a>. It is implemented with RIDEV_NOLEGACY flag set, and legacy keyboard messages are generated manually, only when input was not processed by clients.</p>\n\n<p>I've managed to get it working but language switching hotkey (Alt+Shift in my case) is now broken.</p>\n\n<p>The system must:</p>\n\n<ol>\n<li><p>distinguish between different input devices;</p></li>\n<li><p>detect device [dis]connection;</p></li>\n<li><p>allow handlers to consume input, preventing it from being processed by least priority handlers;</p></li>\n<li><p>keep <a href=\"https://en.wikipedia.org/wiki/Alt_code\" rel=\"nofollow noreferrer\">alt codes</a> functional;</p></li>\n<li><p>if possible, keep <a href=\"https://docs.microsoft.com/en-us/windows/desktop/learnwin32/accelerator-tables\" rel=\"nofollow noreferrer\">accelerators</a> with system keys functional too;</p></li>\n</ol>\n\n<p>I've tried many combinations of raw input settings, but each one violates some of requirements. The main problem now is with 3.</p>\n\n<p>With RIDEV_NOLEGACY handler can consume WM_INPUT or leave it unprocessed. In the second case system generates WM_[SYS]KEYUP / WM_[SYS]KEYDOWN messages by itself and posts them via PostMessage. Since PostMessage doesn't update thread's keyboard state, system updates it too in an appropriate place. So 3, 4 and 5 are OK. But Alt+Shift stops responding.</p>\n\n<p>Without RIDEV_NOLEGACY Alt+Shift changes locale as expected, but raw input generates legacy WM_[SYS]KEYUP / WM_[SYS]KEYDOWN regardless of whether some client processed WM_INPUT or not.</p>\n\n<p>There is a minimal working example of the problem:\n<a href=\"https://github.com/niello/misc/tree/master/RawInputLocale\" rel=\"nofollow noreferrer\">https://github.com/niello/misc/tree/master/RawInputLocale</a></p>\n\n<p>Reproduced on Win10 and Win8.1, but probably will be the same on any Windows since Vista.</p>\n\n<p>Note that if you set USE_NOLEGACY_RAW_INPUT in an example to <strong>true</strong>, WM_CHAR messages are generated only for each second keystroke, as if another one was consumed by our system client, but if you try to change input locale, nothing happens. And if you set USE_NOLEGACY_RAW_INPUT to <strong>false</strong> you will switch locale normally and receive WM_INPUTLANGCHANGE, but WM_CHAR will be generated for consumed keystrokes too.</p>\n\n<p>I've run out of ideas, so any help will be greatly appreciated.</p>\n"}]