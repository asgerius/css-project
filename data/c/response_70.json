[{"tags": ["c", "char", "int", "concat", "string-concatenation"], "comments": [{"owner": {"reputation": 4256, "user_id": 601357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/55dfaa0581d04ed45ece000fd326b052?s=128&d=identicon&r=PG", "display_name": "samsamara", "link": "https://stackoverflow.com/users/601357/samsamara"}, "edited": false, "score": 1, "creation_date": 1463010927, "post_id": 37175046, "comment_id": 61884825, "body": "why downvoted? mind explaining? just a newbie asking a basic question in C here??"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463011500, "post_id": 37175046, "comment_id": 61884963, "body": "NMDV: <code>bstr[5]; sprintf( bstr, &quot;%d&quot;, b);</code> is certainly susceptible to overruns."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463011648, "post_id": 37175046, "comment_id": 61884995, "body": "As to why a DV, &quot;but it doesn&#39;t work.&quot; is a DV magnet.  Instead explain what happened and what was expected.  As it stands, it looks like like a HW question without even an attempted compile and run."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1463014552, "post_id": 37175046, "comment_id": 61885668, "body": "<code>strcpy()</code> doesn&#39;t concatenate, it replaces. If you want to concatenate, you should be using <code>strcat()</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463015372, "post_id": 37175046, "comment_id": 61885846, "body": "<code>char *</code> is a pointer. Why (and how) do you want to concatenate two integers into a pointer??"}], "answers": [{"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 7, "last_activity_date": 1463010738, "creation_date": 1463010738, "answer_id": 37175066, "question_id": 37175046, "link": "https://stackoverflow.com/questions/37175046/concatenate-two-integers-into-a-char-in-c/37175066#37175066", "title": "concatenate two integers into a char * in C", "body": "<p>You can just do it with one <code>sprintf</code>:</p>\n\n<pre><code>char str[100];\nsprintf(str, \"%d:%d\", a, b);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1463010843, "creation_date": 1463010843, "answer_id": 37175081, "question_id": 37175046, "link": "https://stackoverflow.com/questions/37175046/concatenate-two-integers-into-a-char-in-c/37175081#37175081", "title": "concatenate two integers into a char * in C", "body": "<p>Change</p>\n\n<pre><code>strcpy(finstr,astr);\nstrcpy(finstr, \":\");\nstrcpy(finstr, bstr);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>strcpy(finstr,astr);\nstrcat(finstr, \":\");\nstrcat(finstr, bstr);\n</code></pre>\n\n<p>You are overwriting the result string with each successive call. You should instead concatenate to the end of the string, using <code>strcat</code>. Although this can just as easily be done with a single <code>sprintf</code> call.</p>\n"}], "owner": {"reputation": 4256, "user_id": 601357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/55dfaa0581d04ed45ece000fd326b052?s=128&d=identicon&r=PG", "display_name": "samsamara", "link": "https://stackoverflow.com/users/601357/samsamara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5575, "favorite_count": 0, "accepted_answer_id": 37175066, "answer_count": 2, "score": 3, "last_activity_date": 1463010988, "creation_date": 1463010584, "last_edit_date": 1463010988, "question_id": 37175046, "link": "https://stackoverflow.com/questions/37175046/concatenate-two-integers-into-a-char-in-c", "title": "concatenate two integers into a char * in C", "body": "<p>Having forgotten my C knowledge now, having a really hard time figuring out how to do the following:</p>\n\n<pre><code>int a = 5; //getting value from a function\nint b = 1; //from a function\n</code></pre>\n\n<p>what I want to have is: </p>\n\n<pre><code>char * returnstring = \"5:1\"; //want to return this\n</code></pre>\n\n<p>I have tried the following but it doesn't work.</p>\n\n<pre><code>    char astr[5], bstr[5];\n    sprintf( astr, \"%d\", a);\n    sprintf( bstr, \"%d\", b);\n\n    char finstr[100]; //final string\n    strcpy(finstr, astr);\n    strcpy(finstr, \":\");\n    strcpy(finstr, bstr);\n\n    printf (\"%s\", finstr);\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 1455, "user_id": 5339966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0897e935d50e040875b9ea61d8c0851c?s=128&d=identicon&r=PG&f=1", "display_name": "mszymborski", "link": "https://stackoverflow.com/users/5339966/mszymborski"}, "edited": false, "score": 1, "creation_date": 1463008686, "post_id": 37174751, "comment_id": 61884185, "body": "How do you check what their address is?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463008810, "post_id": 37174751, "comment_id": 61884219, "body": "Are you very sure you are not getting the address of the base pointer each time?  That would be my strong guess.  Post your code used to check the addresses."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1463008872, "post_id": 37174751, "comment_id": 61884236, "body": "Evaluating <code>arr[0][2]</code> produces an out-of-bounds access, which has undefined behaviour. (But just taking its address is fine (<code>&amp;arr[0][2]</code>) because that doesn&#39;t evaluate.)"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1463008928, "post_id": 37174751, "comment_id": 61884251, "body": "You cannot use <code>arr[0][2]</code> because it is out-of-range. (<code>&amp;arr[0][2]</code> is valid because it is just one element after the last element and it is not dereferenced)"}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1463009146, "post_id": 37174751, "comment_id": 61884312, "body": "It is normal, the multidimensionnal arrays are in fact transformed into 1 dimension arrays when you don&#39;t use pointers. Due to that, you can&#39;t use those tables with double pointers casting. [x][y] will be replaced with [x * sizeof(first_col) + y] ."}], "answers": [{"tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 1, "last_activity_date": 1463008963, "creation_date": 1463008963, "answer_id": 37174824, "question_id": 37174751, "link": "https://stackoverflow.com/questions/37174751/multidimensional-array-and-addressing/37174824#37174824", "title": "Multidimensional array and addressing", "body": "<p>The pointer <code>&amp;arr[0][2]</code> is the one-past-the-end pointer of the array <code>arr[0]</code>. This is the same address as that of the first element of the next array, <code>arr[1]</code>, which is <code>&amp;arr[1][0]</code>, because arrays are laid out contiguously in memory.</p>\n\n<p><code>arr[2][0]</code> is a bit tricker: <code>arr[2]</code> is not a valid access, but <code>&amp;arr[2]</code> is the one-past-the-end pointer of the array <code>arr</code>. But since that pointer cannot be dereferenced, it doesn't make sense to talk about <code>arr[2][0]</code>. <code>arr</code> doesn't have a third element.</p>\n"}, {"tags": [], "owner": {"reputation": 7557, "user_id": 2577852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29383b0cb31502717af693fa45df0e62?s=128&d=identicon&r=PG", "display_name": "Michael Gaskill", "link": "https://stackoverflow.com/users/2577852/michael-gaskill"}, "is_accepted": false, "score": -2, "last_activity_date": 1463009593, "last_edit_date": 1463009593, "creation_date": 1463009167, "answer_id": 37174850, "question_id": 37174751, "link": "https://stackoverflow.com/questions/37174751/multidimensional-array-and-addressing/37174850#37174850", "title": "Multidimensional array and addressing", "body": "<p>Array indexing in C is similar to adding the value of the index to the address of the first element.</p>\n\n<p>In the multidimensional array that you describe, you have 2 elements on each dimension: 0 and 1.  When you introduce a number larger than that, you're referencing an element outside that dimension.  Technically, this is an array out of bounds error.</p>\n\n<p>The addresses break down like this:</p>\n\n<ul>\n<li><code>arr[0][0]</code> - <code>&amp;arr[0] + 0</code></li>\n<li><code>arr[0][1]</code> - <code>&amp;arr[0] + 1</code></li>\n<li><code>arr[1][0]</code> - <code>&amp;arr[0] + 2</code></li>\n<li><code>arr[1][0]</code> - <code>&amp;arr[0] + 3</code></li>\n</ul>\n\n<p>When you write arr[0][2], you're referencing address &amp;arr[0] + 2, which is the same as arr[1][0].  It all just pointer math, so you can work it out pretty easily once you know how it works.</p>\n"}, {"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 0, "last_activity_date": 1463009504, "creation_date": 1463009504, "answer_id": 37174902, "question_id": 37174751, "link": "https://stackoverflow.com/questions/37174751/multidimensional-array-and-addressing/37174902#37174902", "title": "Multidimensional array and addressing", "body": "<p>C stores multi-dimensional arrays in what is called <a href=\"https://en.wikipedia.org/wiki/Row-major_order\" rel=\"nofollow\"><em>row-major order</em></a>. In that configuration, all the data for a single row is stored in consecutive memory:</p>\n\n<pre><code>arr[2][2] -&gt; r0c0, r0c1, r1c0, r1c2\n</code></pre>\n\n<p>The alternative would be <em>column-major order,</em> which places the columns consecutively.</p>\n\n<p>Since you have specified the length of the row (number of cols) as 2, it follows that accessing column 2 (the third column) will compute an address that \"wraps around\" to the next row.</p>\n\n<p>The math looks like:</p>\n\n<pre><code>&amp;(arr[row][col]) \n\n= arr # base address\n+ row * ncols * sizeof(element)\n+ col * sizeof(element)\n\n= arr + sizeof(element) * (row * ncols + col)\n</code></pre>\n\n<p>In your case, <code>arr[0][2]</code> is <code>arr + (0*2 + 2) * sizeof(int)</code>, while <code>arr[1][0]</code> is <code>arr + (1*2 + 0)*sizeof(int)</code>. </p>\n\n<p>You can do similar math for the other variations.</p>\n"}, {"tags": [], "owner": {"reputation": 1613, "user_id": 456065, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/49b8a5172d9634e038c69110bfb5e480?s=128&d=identicon&r=PG", "display_name": "Sanich", "link": "https://stackoverflow.com/users/456065/sanich"}, "is_accepted": false, "score": -2, "last_activity_date": 1463009871, "creation_date": 1463009871, "answer_id": 37174951, "question_id": 37174751, "link": "https://stackoverflow.com/questions/37174751/multidimensional-array-and-addressing/37174951#37174951", "title": "Multidimensional array and addressing", "body": "<p>You can look in your two dimensional array as a long one dimensional array:  </p>\n\n<pre><code>[00][01][10][11]\n</code></pre>\n\n<p>With the pointers arithmetic, another representation of this long one dimensional array is: </p>\n\n<pre><code>[00][01][02][03]\n</code></pre>\n\n<p>So looking in cell <code>[10]</code> is exactly the same as looking into a cell [20] in pointer arithmetic point of view. </p>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": -1, "last_activity_date": 1463013237, "last_edit_date": 1463013237, "creation_date": 1463010260, "answer_id": 37175005, "question_id": 37174751, "link": "https://stackoverflow.com/questions/37174751/multidimensional-array-and-addressing/37175005#37175005", "title": "Multidimensional array and addressing", "body": "<p>Array indexing is identical to pointer arithmetic (actually, the array name first is converted (\"decays\") to a pointer to the first element before the <code>[]</code>-operator is applied):</p>\n\n<pre><code>arr[r][c] &lt;=&gt; *(arr + r * INNER_LENGTH + c)\n</code></pre>\n\n<p>Your array has two entries per dimension. In C indexes start from <code>0</code>, so for each dimension valid indexes are <code>0</code> and <code>1</code> (i.e. <code>total_entries - 1</code>). Which makes three of your expressions suspective in the first place:</p>\n\n<pre><code>arr[0][2]    // [outer dimension/index][inner dimension/index]\narr[1][2]\narr[2][0]\n</code></pre>\n\n<p>We have these cases:</p>\n\n<ul>\n<li>Both indexes are valid: no problem.</li>\n<li>Only the address is taken, the element is not accessed and\n\n<ul>\n<li>the outer index is valid and the inner (see below) index equals the length of the inner dimension: comparison and certain address arithmetic is allowed (other constraints apply!).</li>\n<li>the outer index equals the length of the outer dimension, and the inner index is <code>0</code>: The same.</li>\n</ul></li>\n<li>Anything else: the address is invalid and any usage (take address, dereference, etc.) invokes <em>undefined behaviour</em>.</li>\n</ul>\n\n<hr>\n\n<p>What exactly goes on in memory might become a bit more clear if we use different lengths for the dimensions and have a look how the data is stored:</p>\n\n<pre><code>int arr[3][2];\n</code></pre>\n\n<p>This is an \"array of 3 arrays of 2 <code>int</code> elements\". The leftmost dimension is called the \"outer\", the rightmost the \"inner\" dimension, because of the memory layout:</p>\n\n<pre><code>arr[0][0]   // row 0, column 0\narr[0][1]   // row 0, column 1\narr[1][0]   // ...\narr[1][1]\narr[2][0]\narr[2][1]\n</code></pre>\n\n<p>Using the formula above, <code>&amp;arr[0][2]</code> (<code>arr + 0 * 2 + 2</code>) will yield the same as <code>&amp;arr[1][0]</code> (<code>arr + 1 * 2 + 0</code>), etc. Note, however, while the addresses are identical, the first version must not be dereferenced and the compiler may generate incorrect code, etc.</p>\n"}], "owner": {"reputation": 57, "user_id": 5733448, "user_type": "registered", "profile_image": "https://graph.facebook.com/1337496492927934/picture?type=large", "display_name": "Peter", "link": "https://stackoverflow.com/users/5733448/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1463013237, "creation_date": 1463008385, "question_id": 37174751, "link": "https://stackoverflow.com/questions/37174751/multidimensional-array-and-addressing", "title": "Multidimensional array and addressing", "body": "<p>I have an issue with the multidimensional arrays. Maybe the solution is much easier.</p>\n\n<pre><code>int arr[2][2]; //multidimensional array\n</code></pre>\n\n<p>My simple question is: why the </p>\n\n<p>arr[0][2] and arr[1][0] \nor\narr[1][2] and arr[2][0]</p>\n\n<p>are on the same address in my case?\nI checked this problem in Linux and Windows environment. And the issue is the same. I have checked tutorials and other sources, but no answer.</p>\n"}, {"tags": ["c", "struct", "malloc"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1463008286, "post_id": 37174723, "comment_id": 61884076, "body": "you could use strdup instead of strcpy"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1463008482, "post_id": 37174723, "comment_id": 61884138, "body": "It&#39;s not clear what you don&#39;t understand and what you need help with. You already know you can call <code>malloc</code> to allocate memory. So what precisely is it you don&#39;t understand how to do?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463008489, "post_id": 37174723, "comment_id": 61884140, "body": "<code>link x = malloc(sizeof(*x)); x-&gt;hashtag = malloc(sizeof(*x-&gt;hashtag));</code>"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1463008716, "post_id": 37174723, "comment_id": 61884193, "body": "Are you sure you initialized <code>x-&gt;hashtag-&gt;count</code> before adding 1 to it?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1463009135, "post_id": 37174723, "comment_id": 61884309, "body": "1) You don&#39;t have a &quot;<code>struct</code> in a <code>struct</code>. A pointer is not a struct! (Is it really neccessary to state?) 2) <code>link</code> is not a <code>struct</code>, but a pointer, too. 3) Don&#39;t <code>typedef</code> pointers!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1463010799, "post_id": 37174723, "comment_id": 61884782, "body": "What text or who suggested typedef&#39;ing a pointer like <code>typedef struct node{ hashtag *hashtag;  struct node*next; }*link;</code> instead of <code>typedef struct node{ hashtag *hashtag;  struct node*next; }link;</code>  (no <code>*</code> before <code>link</code>)?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463014768, "post_id": 37174723, "comment_id": 61885712, "body": "why don&#39;t you just make <code>struct node</code> contain <code>hashtag</code> instead of a pointer to one?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463010954, "post_id": 37174926, "comment_id": 61884835, "body": "<code>strcpy(x-&gt;hashtag-&gt;id, newh);</code> is susceptible to overruns.  Could use <code>x-&gt;hashtag-&gt;id[0] = &#39;\\0&#39;; strncat(x-&gt;hashtag-&gt;id, newh, sizeof(x-&gt;hashtag-&gt;id));</code>"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 1, "last_activity_date": 1463011205, "last_edit_date": 1463011205, "creation_date": 1463009674, "answer_id": 37174926, "question_id": 37174723, "link": "https://stackoverflow.com/questions/37174723/allocating-memory-for-a-structure-within-a-structure/37174926#37174926", "title": "Allocating memory for a structure within a structure", "body": "<p>You should allocate and initialize the pointer <code>x</code> in <code>check_insert</code>, it is undefined behavior to dereference it and access its members without allocation first:</p>\n\n<pre><code>void check_insert(char newh[]){\n    link x = malloc(sizeof *x);\n    x-&gt;hashtag = malloc(sizeof *x-&gt;hashtag);\n\n    // strcpy(x-&gt;hashtag-&gt;id, newh); &lt;-- UB if newh is larger than 14 in size\n    x-&gt;hashtag-&gt;id[0] = '\\0';\n    strncat(x-&gt;hashtag-&gt;id, newh, sizeof(x-&gt;hashtag-&gt;id));\n    x-&gt;hashtag-&gt;count = 1;\n    head = insert_end(head, x-&gt;hashtag);\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6322790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd4841ca85f1483946e6fbf149e8d12?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago Almeida", "link": "https://stackoverflow.com/users/6322790/tiago-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463011205, "creation_date": 1463008188, "question_id": 37174723, "link": "https://stackoverflow.com/questions/37174723/allocating-memory-for-a-structure-within-a-structure", "title": "Allocating memory for a structure within a structure", "body": "<pre><code>typedef struct{\n    char id[15];\n    int count;\n}hashtag;\n\ntypedef struct node{\n    hashtag *hashtag;\n    struct node*next;\n}*link;\n</code></pre>\n\n<p>I'm writing a program to read hashtags from a sentence, and I want to store them in a list. I've already defined this two structures, and I can read and pass the hashtags to the function below but I need help allocating memory in order to copy the string to the list.</p>\n\n<pre><code>void check_insert(char newh[]){\n    link x;\n    //malloc to allocate memory for the string I want to copy\n\n    strcpy(x-&gt;hashtag-&gt;id, newh);\n    x-&gt;hashtag-&gt;count += 1;\n    head = insert_end(head, x-&gt;hashtag); //head is a global variable that points to the 1st element of the list\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463007522, "post_id": 37174561, "comment_id": 61883857, "body": "Look up definition and declaration. See this <a href=\"http://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration\">question</a>"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1463008249, "post_id": 37174561, "comment_id": 61884062, "body": "The RHS of that assignment is an initializer. By definition an initializer can only be used to set a variable at the point it is defined. The initializer syntax is not valid for subsequent assignment operations."}, {"owner": {"reputation": 507, "user_id": 4993180, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EAtti.jpg?s=128&g=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/4993180/striker"}, "edited": false, "score": 0, "creation_date": 1463008443, "post_id": 37174561, "comment_id": 61884127, "body": "Unfortunately  that code can only be used for declarations. It is not built for assigning new values to a struct members. You will have to call individual members instead."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463009280, "post_id": 37174561, "comment_id": 61884359, "body": "1) Don&#39;t use all-uppercase-names (or ones like the ones you use); they should only be used for macros and <i>enum-constants</i> 2) The suffix <code>_t</code> is reserved by some standards like POSIX for system libraries."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 507, "user_id": 4993180, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EAtti.jpg?s=128&g=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/4993180/striker"}, "edited": false, "score": 0, "creation_date": 1463009384, "post_id": 37174561, "comment_id": 61884384, "body": "@Striker: A declaration with an initialiser is a <i>definition</i>."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1463009514, "post_id": 37174561, "comment_id": 61884414, "body": "<code>MY_STRUCTURE_t my_structure; my_structure.number = 1; my_structure.anotherNumber = 42; my_structure.character = &#39;\\0&#39;; my_structure.anotherCharacter = &#39;a&#39;;</code>"}, {"owner": {"reputation": 213, "user_id": 5765225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e03c8fc7661e63a066aa98022d6313dd?s=128&d=identicon&r=PG&f=1", "display_name": "fandor", "link": "https://stackoverflow.com/users/5765225/fandor"}, "edited": false, "score": 0, "creation_date": 1463009838, "post_id": 37174561, "comment_id": 61884504, "body": "Thank you for taking time to read my question. Can I kindly ask for the reason the question was downvoted? I would like to improve it, if there&#39;s still a chance, or not make the same mistake later. Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 5765225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e03c8fc7661e63a066aa98022d6313dd?s=128&d=identicon&r=PG&f=1", "display_name": "fandor", "link": "https://stackoverflow.com/users/5765225/fandor"}, "edited": false, "score": 0, "creation_date": 1463159589, "post_id": 37175424, "comment_id": 61962710, "body": "Thank you for your answer! Are compound literals something that you would frequently see/use in practice? Especially in the context of embedded systems?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 213, "user_id": 5765225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e03c8fc7661e63a066aa98022d6313dd?s=128&d=identicon&r=PG&f=1", "display_name": "fandor", "link": "https://stackoverflow.com/users/5765225/fandor"}, "edited": false, "score": 0, "creation_date": 1463184671, "post_id": 37175424, "comment_id": 61972860, "body": "sometimes embedded system designers don&#39;t realize that it&#39;s not the 1980s any more"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1463013523, "creation_date": 1463013523, "answer_id": 37175424, "question_id": 37174561, "link": "https://stackoverflow.com/questions/37174561/invalid-redeclaration-of-structure-identifier/37175424#37175424", "title": "Invalid redeclaration of &quot;(structure identifier)&quot;", "body": "<p>This line:</p>\n\n<pre><code>MY_STRUCTURE_t my_structure;\n</code></pre>\n\n<p>is a definition.  You say \"declare it now and define it later\" but actually what you are describing is \"define it now, and assign a new value later\". This is the same for primitive types.</p>\n\n<p>In C, assignment (not initialization) cannot be done directly from a brace-enclosed list. But you can (at block scope of course) assign from a compound literal:</p>\n\n<pre><code>my_structure = (const MY_STRUCTURE_t){\n    .number = 1,\n    .anotherNumber = 42,\n    .character = '\\0',\n    .anotherCharacter = 'a'\n};\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 5765225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e03c8fc7661e63a066aa98022d6313dd?s=128&d=identicon&r=PG&f=1", "display_name": "fandor", "link": "https://stackoverflow.com/users/5765225/fandor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4102, "favorite_count": 0, "accepted_answer_id": 37175424, "answer_count": 1, "score": -1, "last_activity_date": 1463013523, "creation_date": 1463007148, "question_id": 37174561, "link": "https://stackoverflow.com/questions/37174561/invalid-redeclaration-of-structure-identifier", "title": "Invalid redeclaration of &quot;(structure identifier)&quot;", "body": "<p>I have a structure with multiple members inside of it that I can't seem to be able to define after declaring it in a separate statement. For simplicity sake, suppose it looks like the following</p>\n\n<pre><code>typedef struct \n{\nint number;\nint anotherNumber;\nchar character;\nchar anotherCharacter;\n} MY_STRUCTURE_t;\n</code></pre>\n\n<p>It seems like I should be able to declare the structure and define it later on, as I would do with a variable of a simpler type. For example,</p>\n\n<pre><code>MY_STRUCTURE_t my_structure;\n\nmy_structure = {\n.number = 1,\n.anotherNumber = 42,\n.character = '\\0',\n.anotherCharacter = 'a'\n};\n</code></pre>\n\n<p>The code above generates an error: \"Invalid redeclaration of \"my_structure\"\". Fair enough, the compiler knows better. On the other hand, the following code works fine. </p>\n\n<pre><code>MY_STRUCTURE_t my_structure = {\n.number = 1,\n.anotherNumber = 42,\n.character = '\\0',\n.anotherCharacter = 'a'\n};\n</code></pre>\n\n<p>What is the problem with the snippet in the middle? Is there a fundamental flaw that I am missing? </p>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1463007895, "post_id": 37174499, "comment_id": 61883965, "body": "<code>matriz = (char **) calloc(...</code> Oh, you broke the input."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463023712, "post_id": 37174499, "comment_id": 61887907, "body": "<code>insertString</code> is wrong. You modify the local variable only. In <code>rellenarMatriz</code> you are a whole dimension out of sync. The variable in <code>main</code> needs to be <code>char **</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1463023787, "post_id": 37174499, "comment_id": 61887928, "body": "I suggest writing your memory allocation code separately to the code for filling the memory. This makes it easier to debug and maintain the code."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463023856, "post_id": 37174499, "comment_id": 61887943, "body": "<code>__string</code> is a reserved identifier. You should not use double underscores in your code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463156455, "post_id": 37174499, "comment_id": 61961048, "body": "in C, when calling any of the memory allocation functions: (malloc, calloc, realloc), 1) the return type is <code>void*</code> which can be assigned to any pointer.  casting the returned value just clutters the code.  Suggest removing the casting.   2) the expression: <code>sizeof(char)</code> is defined in the standard as <code>1</code>,  Using that expression just clutters the code.  3) always check (!=NULL) the returned value to assure the operation was successful.   4) when calling <code>realloc()</code>, always set the returned value into a temporary variable, check for NULL before assigning to the target variable. (cont)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463156606, "post_id": 37174499, "comment_id": 61961115, "body": "(cont) Cluttering the code makes it much more difficult to understand, debug, maintain.  IF the call to <code>realloc()</code> fails, and the target variable is immediately set, then the original memory pointer is overwritten with NULL, which results in a memory leak as that pointer cannot be recovered."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463156781, "post_id": 37174499, "comment_id": 61961215, "body": "for ease of readability and understand by us humans, 1) consistently indent the code.  Indent after EVERY opening brace &#39;{&#39;,  un-indent before every closing brace &#39;}&#39;.  2) follow the axiom:  <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463157366, "post_id": 37174499, "comment_id": 61961499, "body": "the <code>sizeof</code> returns a <code>size_t</code>, not an <code>int</code>.   <code>strlen()</code> returns a <code>size_t</code> not an <code>int</code>.   Conversions between <code>int</code> and <code>size_t</code> runs a risk.  (in <code>gcc</code>, use <code>-wConversion</code> to have all such problems output by the compiler).   Comparisons between <code>int</code> and <code>size_t</code> runs a risk.  (in <code>gcc</code>, use: <code>-Wall -Wextra</code> to have all such problems output by the compiler)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463157763, "post_id": 37174499, "comment_id": 61961730, "body": "the function: <code>strlen()</code> returns the number of characters in a NUL terminated char array, not including the terminating NUL char.  So this line: <code>datosMatriz.tamanioString = strlen( myString ) - 1;</code>  should be: <code>datosMatriz.tamanioString = strlen( myString );</code>   Similar considerations exist for: <code>while( i &lt; strlen( myString ) - 1  )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463158079, "post_id": 37174499, "comment_id": 61961907, "body": "regarding the code block beginning with: <code>while( i &lt; strlen( myString ) - 1  )</code> You should always consider the edge cases.  I.E. What happens if the user only enters is a space? What happens if the user input contains zero spaces? What happens if the the user enters some consecutive spaces?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463158364, "post_id": 37174499, "comment_id": 61962055, "body": "for clarity (and re-usability) it is best to separate the struct definition from the <code>typedef</code>.   In this case, the struct definition will need to have a <code>tag</code> name inserted, so that <code>struct tagname</code> can be used in the <code>typedef</code>.  I.E.  <code>struct tagStruct {     int rows;     int col;     int flagPosition;     int wordBiggest;     int tamanioString; };  typedef struct tagStruct matrixTest;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463158522, "post_id": 37174499, "comment_id": 61962127, "body": "&#39;magic&#39; numbers should not be used in the code.  They make the code much more difficult to understand, debug, maintain.  Suggest using an <code>enum</code> statement or <code>#define</code> statements to give those &#39;magic&#39; numbers meaningful names, then use those meaningful names throughout the code"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1463159344, "last_edit_date": 1463159344, "creation_date": 1463158737, "answer_id": 37215563, "question_id": 37174499, "link": "https://stackoverflow.com/questions/37174499/2-d-matrix-in-c-realloc-not-work/37215563#37215563", "title": "2-D Matrix In C, realloc not work", "body": "<p>this line: </p>\n\n<pre><code>matriz[i][j] = calloc( 1, 1 );\n</code></pre>\n\n<p>has the target: <code>matriz[i][j]</code> referencing a single character in the array <code>matrix[i]</code>  </p>\n\n<p>That is why the compiler is outputting a warning message</p>\n\n<p>Also, note;  this code block:</p>\n\n<pre><code>for( i = 0; i &lt; datosMatriz-&gt;col; i++ )\n    (*matriz) = realloc( matriz[i], ( datosMatriz-&gt;rows ) * sizeof( char * ) );\n</code></pre>\n\n<p>is re-allocating the same pointer over and over and over.</p>\n\n<p>Also, note: this line:</p>\n\n<pre><code>free( stringg );\n</code></pre>\n\n<p>only free's the first array, not all the other arrays created by calloc()</p>\n\n<p>Also, note: this line:</p>\n\n<pre><code>char *stringg = NULL;\n</code></pre>\n\n<p>is declaring a single pointer,  but it is being used as if it were declared via:</p>\n\n<pre><code>char **stringg = NULL;\n</code></pre>\n\n<p>and the problem line in the code is treating it as if it were declared via:</p>\n\n<pre><code>char ***stringg = NULL;\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5540253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206116275044713/picture?type=large", "display_name": "Nicolas Mozo", "link": "https://stackoverflow.com/users/5540253/nicolas-mozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463159344, "creation_date": 1463006830, "last_edit_date": 1463061491, "question_id": 37174499, "link": "https://stackoverflow.com/questions/37174499/2-d-matrix-in-c-realloc-not-work", "title": "2-D Matrix In C, realloc not work", "body": "<p>I have a little problem, first of all, sorry for my English, secondly, I'm making a matrix 2-D, but i have a problem with the work memory, I don't understand why it doesn't work. The code is written in C. I want to set one or more strings and save into an array, for this i need to increase the array's capacity dynamically.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n</code></pre>\n\n<p>Create a Struct</p>\n\n<pre><code>typedef struct {\n int rows;\n int col;\n int flagPosition;\n int wordBiggest;\n int tamanioString;\n} matrixTest;\n\nint insertString( char **matriz );\nvoid rellenarMatriz( char **matriz, char string[], matrixTest *datosMatriz );\nint getElementBiggest( char **matriz, int size );\n</code></pre>\n\n<p>Main</p>\n\n<pre><code>int main()\n{\nchar *stringg = NULL;\n\ninsertString( &amp;stringg );\n\nfree( stringg );\nreturn 0;\n}\n</code></pre>\n\n<p>In the next function, i initialize the struct and i'm loading the string, this string then i send to another function called 'rellenarMatriz'. Until here it's all fine.   </p>\n\n<pre><code>int insertString( char **matriz ){\n\nchar __string[300];\nint i = 0;\nint sizeRow = 0;\nmatrixTest datosMatriz = { 1,1,0,0,0 };\n\nmatriz = (char **) calloc( datosMatriz.rows, sizeof(char *));\n\nfor (i = 0; i &lt; datosMatriz.rows; i++)\n    matriz[i] = (char*)calloc(datosMatriz.col, sizeof(char));\n\nputs( \"User say: \" );\n\nwhile( fgets( __string, 300, stdin ) ){\n    puts( \"User say: \" );\n    i = 0;\n    sizeRow = 1;\n\n    while( i &lt; strlen( __string ) - 1  ){\n        if( __string[i] == ' ' )\n            sizeRow++;\n        i++;\n    }\n\n    datosMatriz.tamanioString = strlen( __string ) - 1;\n    datosMatriz.rows = datosMatriz.rows + sizeRow;\n    datosMatriz.flagPosition = sizeRow;\n\n    rellenarMatriz( matriz, __string, &amp;datosMatriz );\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Here is the problem.. Look at the realloc and calloc functions. I'm going crazy</p>\n\n<pre><code>void rellenarMatriz( char **matriz, char string[], matrixTest *datosMatriz){\n\nint i = 0,\n    j = 0;\n\ndatosMatriz-&gt;wordBiggest = getElementBiggest( &amp;string, datosMatriz-&gt;tamanioString );\n\nif( datosMatriz-&gt;col &lt; datosMatriz-&gt;wordBiggest ){\n\n    (*matriz) = realloc( (*matriz), (datosMatriz-&gt;wordBiggest) * sizeof( char * ) );\n\n    for( i = datosMatriz-&gt;col; i &lt; datosMatriz-&gt;wordBiggest; i++ ){\n        matriz[i] = calloc( 1, sizeof( char ));\n    }\n    datosMatriz-&gt;col = datosMatriz-&gt;wordBiggest;\n}\n\nfor( i = 0; i &lt; datosMatriz-&gt;col; i++ )\n    (*matriz) = realloc( matriz[i], ( datosMatriz-&gt;rows ) * sizeof( char * ) );\n\nfor( i = 0; i &lt; datosMatriz-&gt;col; i++ ){\n    for( j = datosMatriz-&gt;rows-datosMatriz-&gt;flagPosition; j &lt; datosMatriz-&gt;rows; j++ )\n        matriz[i][j] = calloc( 1, sizeof( char )); // Here is the biiig problem. Warning: assignment makes integer from pointer without a cast|\n}\n\nfor( i = 0; i &lt; datosMatriz-&gt;rows; i++ ){\n    for( j = 0; j &lt; datosMatriz-&gt;col; j++ ){\n        printf( \"%d and %d\\n\", i, j );\n        matriz[i][j] = 'a';\n    }\n}\n\nfor( i = 0; i &lt; datosMatriz-&gt;rows; i++ ){\n    puts( \"\\t\" );\n    for( j = 0; j &lt; datosMatriz-&gt;col; j++ )\n        printf( \"[%c]\", matriz[i][j] );\n    puts( \"\\n\" );\n}\n}\n</code></pre>\n\n<p>This doesn't matter</p>\n\n<pre><code>int getElementBiggest( char **matriz, int size ){\n\nint i = 0,\n    biggest = 0,\n    countWord = 0;\n\nfor( i = 0; i &lt; size; i++ ){\n    if( (char)(*matriz)[i] == ' ' ){\n        if( countWord &gt; biggest )\n            biggest = countWord;\n        countWord = 0;\n    }\n    else\n        countWord++;\n}\nreturn biggest;\n}\n</code></pre>\n\n<p>Also if you find a mistake in my redaction in english, please tell me, i'm studing that and would be so good that you correct my syntax.</p>\n"}, {"tags": ["c", "list", "pointers", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 3, "creation_date": 1463006177, "post_id": 37174343, "comment_id": 61883457, "body": "OP Why did you rollback the edit I made to make the code easier to read?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1463006351, "post_id": 37174343, "comment_id": 61883506, "body": "Because who really wants indentation and syntax highlighting?  :P"}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463006740, "post_id": 37174343, "comment_id": 61883625, "body": "@MichaelDorgan pffftttt undoing a rollback to revert back to indentation and syntax highlighting.. :P nice job!"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463006787, "post_id": 37174343, "comment_id": 61883643, "body": "Yeah you know.  I was honestly waiting for OP to troll us both by rolling back again..."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463006835, "post_id": 37174343, "comment_id": 61883659, "body": "Yeah, I know what you mean, thought OP trolled me by rolling back! xD"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1463007184, "post_id": 37174343, "comment_id": 61883758, "body": "<code>typedef struct ListNode ListNode;  typedef ListNode* ListNodePtr; </code> You are confusing yourself."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463008030, "post_id": 37174343, "comment_id": 61884005, "body": "<code>if(q=*sPtr){while(q-&gt;nextPtr!=NULL)      {          q=q-&gt;nextPtr;      }       q-&gt;nextPtr=newPtr; } else { *sPtr = newPtr; }</code>"}, {"owner": {"reputation": 3, "user_id": 6322733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d575934c8099bfed54f0a42dfb78659?s=128&d=identicon&r=PG&f=1", "display_name": "tommycautero", "link": "https://stackoverflow.com/users/6322733/tommycautero"}, "edited": false, "score": 0, "creation_date": 1463033695, "post_id": 37174343, "comment_id": 61891150, "body": "Sorry, it was indentated then i copy and paste it here and it lost the indentation"}], "answers": [{"tags": [], "owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "is_accepted": true, "score": 1, "last_activity_date": 1463007042, "creation_date": 1463007042, "answer_id": 37174539, "question_id": 37174343, "link": "https://stackoverflow.com/questions/37174343/error-segmentation-fault-core-dumped-list-and-struct-pointer/37174539#37174539", "title": "Error (segmentation fault core dumped) - List and struct pointer", "body": "<p>The first time through your insert:</p>\n\n<pre><code>q=*sPtr; \nw=q-&gt;nextPtr; \n</code></pre>\n\n<p><code>*sPtr</code> equals NULL.  You are dereferencing this which will cause a seg-fault on <code>q-&gt;nextPtr;</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6322733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d575934c8099bfed54f0a42dfb78659?s=128&d=identicon&r=PG&f=1", "display_name": "tommycautero", "link": "https://stackoverflow.com/users/6322733/tommycautero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1128, "favorite_count": 0, "accepted_answer_id": 37174539, "answer_count": 1, "score": -3, "last_activity_date": 1463007042, "creation_date": 1463005866, "last_edit_date": 1463006621, "question_id": 37174343, "link": "https://stackoverflow.com/questions/37174343/error-segmentation-fault-core-dumped-list-and-struct-pointer", "title": "Error (segmentation fault core dumped) - List and struct pointer", "body": "<p>Hi im a beginner in C programming; i'm trying to learn list and pointers to a struct. Here its my program to implement a list element after element  using pointers. Can somebody tell me why it gives me error segmentation fault core dumped?</p>\n\n<pre><code>#include&lt;stdio.h&gt; \n#include&lt;stdlib.h&gt; \n\nstruct ListNode{ \n    int x; \n    struct ListNode* nextPtr; \n}; \n\ntypedef struct ListNode ListNode; \ntypedef ListNode* ListNodePtr; \n\nvoid insert(ListNodePtr* sPtr, int n); \n\nint main() \n{ \n    int f; \n\n    scanf(\"%d\", &amp;f); \n    ListNodePtr startPtr=NULL; \n\n    while(f!=-1) \n    { \n        insert(&amp;startPtr, f); \n\n        scanf(\"%d\",&amp;f); \n        printf(\"/n\"); \n    } \n\n    return 0; \n} \n\nvoid insert(ListNodePtr* sPtr, int n) \n{ \n    ListNodePtr newPtr; \n\n    newPtr=malloc(sizeof(ListNode)); \n\n    if(newPtr!=NULL) \n    { \n        newPtr-&gt;x=n; \n        newPtr-&gt;nextPtr=NULL; \n    } \n\n    ListNodePtr q,w; \n\n    q=*sPtr; \n    w=q-&gt;nextPtr; \n\n    while(w!=NULL) \n    { \n        q=w; \n        w=q-&gt;nextPtr; \n    } \n\n    w=newPtr; \n}\n</code></pre>\n"}, {"tags": ["c", "malloc", "pipe", "fork"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1463005023, "post_id": 37174154, "comment_id": 61883036, "body": "Did you check what the size of <code>buffer</code> actually is, as in a <code>printf</code> statement with <code>sizeof(buffer)</code>?"}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "edited": false, "score": 0, "creation_date": 1463005146, "post_id": 37174154, "comment_id": 61883073, "body": "try reading the characters one by one with a loop instead or reading all at once it may work."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1463007014, "post_id": 37174227, "comment_id": 61883707, "body": "I assumed it would be a problem with the sizeof so that&#39;s the 1st thing that i tried. The problem with that is it gives me a weird result. it&#39;s returning this: 2ff7d93c1f79afd6a0f63c90f1ca2bbbc0645995 \\O?? instead of 2ff7d93c1f79afd6a0f63c90f1ca2bbbc0645995"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1463007365, "post_id": 37174227, "comment_id": 61883814, "body": "<code>read()</code> doesn&#39;t add a null terminator, you need to add that to the end of the data. <code>read()</code> returns the number of bytes read, add the null after that byte."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1463007408, "post_id": 37174227, "comment_id": 61883824, "body": "@ohiohai You also need to call <code>read()</code> in a loop until you get EOF. There&#39;s no guarantee that a single call will return everything."}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1463007511, "post_id": 37174227, "comment_id": 61883854, "body": "Nvm, i figured it out. It wasn&#39;t printing right because after those 40 chars sha1sum also prints the name of the file. All i had to do was force the buffer[40] to be a &#39;\\0&#39;. I&#39;m an idiot."}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1463007552, "post_id": 37174227, "comment_id": 61883870, "body": "Thanks for the help guys."}], "tags": [], "owner": {"reputation": 224, "user_id": 6317244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249837f50c1372400da954a62bed963a?s=128&d=identicon&r=PG&f=1", "display_name": "jthomas", "link": "https://stackoverflow.com/users/6317244/jthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1463005156, "creation_date": 1463005156, "answer_id": 37174227, "question_id": 37174154, "link": "https://stackoverflow.com/questions/37174154/trying-to-read-from-pipe-to-a-string-but-it-doesnt-read-the-entire-string/37174227#37174227", "title": "Trying to read from pipe to a String but it doesnt read the entire String", "body": "<p>buffer is a pointer, not a static array, so sizeof(buffer) returns the size of a pointer. (4 on 32-bit architecture, 8 on 64-bit). When you call read, you don't want the size of the pointer, you want the size of the data that it is pointing to, so you need to pass in the same value you passed as an argument to malloc (in this case, 41).</p>\n"}], "owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463005156, "creation_date": 1463004791, "question_id": 37174154, "link": "https://stackoverflow.com/questions/37174154/trying-to-read-from-pipe-to-a-string-but-it-doesnt-read-the-entire-string", "title": "Trying to read from pipe to a String but it doesnt read the entire String", "body": "<p>I'm using a child process to execute the sha1sum program. For some context, basically sha1sum will take a file and create a unique code for it. (Doesn't do exactly this but that's not really important).\nThe code is 40 chars long.</p>\n\n<p>So, my child process will execute it, and the parent process will save the code and put it in a buffer.\nI built a main function to test if it was doing what i wanted and i noticed the String wasn't complete. I'm thinking its a malloc problem. I commented on the code why i think that.</p>\n\n<pre><code>char* getN(char *name){\nint fd[2],pid;\nchar *buffer = (char*)malloc(41*sizeof(char));\n\npipe(fd);\npid=fork();\n\nif(!pid){\n    close(fd[0]);\n    dup2(fd[1],1);\n    close(fd[1]);\n    execlp(\"sha1sum\",\"sha1sum\",name,NULL);\n}\nelse{\n    close(fd[1]);\n    read(fd[0],buffer,sizeof(buffer)); /* if i change this sizeof to like sizeof(buffer)+2 it prints 2 more chars than it previously did. no clue why. */\n    close(fd[0]);\n    wait(NULL);\n}\nreturn buffer;\n}\n\n\n\nint main(){\n    char *a=getN(\"file.pdf\"); // file that's in my current directory.\n    printf(\"%s\\n\",a);\n    return 0;\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "generics", "stack", "void-pointers"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 3, "creation_date": 1463004655, "post_id": 37174060, "comment_id": 61882895, "body": "Your <code>pop</code> loop code produced the correct output. Why do you say that <code>pop</code> isn&#39;t working? Also, shouldn&#39;t <code>char d[]=&quot;&quot;;</code> be <code>char* d;</code>? You can&#39;t move or resize an array!"}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1463004807, "post_id": 37174060, "comment_id": 61882964, "body": "It&#39;s supposed to change the value of the variable <code>d</code>. That is, pop the top of stack to <code>d</code>."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1463004835, "post_id": 37174060, "comment_id": 61882970, "body": "@DavidSchwartz You are right. I changed it and updated my question. It set&#39;s <code>d</code> to null"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1463005057, "post_id": 37174060, "comment_id": 61883047, "body": "<code>&amp;element</code> is local variable address."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1463005266, "post_id": 37174060, "comment_id": 61883124, "body": "Why fragment your code into multiple blocks? It makes it hard/impossible for anyone to compile and run what you&#39;ve got!"}, {"owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "edited": false, "score": 0, "creation_date": 1463005281, "post_id": 37174060, "comment_id": 61883129, "body": "Careful with calling strlen on strings of a dubious source. It could cause undefined behavior if the string is not null termianted."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 2, "creation_date": 1463005414, "post_id": 37174060, "comment_id": 61883184, "body": "Unrelated, but <code>size_t</code> is unsigned, so it can&#39;t be <code>velInfo &lt;= 0</code>."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463005645, "post_id": 37174060, "comment_id": 61883274, "body": "@BLUEPIXY Yes! This led me to the fix. I updated my answer."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1463005668, "post_id": 37174060, "comment_id": 61883285, "body": "@Bob__ Nice catch, thanks."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "edited": false, "score": 0, "creation_date": 1463005786, "post_id": 37174060, "comment_id": 61883321, "body": "@bodangly I will have to think about how to make it safer. Thanks for the heads up. Or I can just state that the argument must be a null terminated string..."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1463005824, "post_id": 37174060, "comment_id": 61883333, "body": "@Flexo The whole code is in a couple of files. I thought it would be too much."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463006191, "post_id": 37174060, "comment_id": 61883459, "body": "Can you confirm in a debugger or via printfs if your copy function is even called - perhaps <code>isEmptyStek()</code> is returning early?  Also <code>char d[]=&quot;&quot;;</code> in your main looks dubious, but is probably safe.   I&#39;d just call it a pointer."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463006375, "post_id": 37174060, "comment_id": 61883519, "body": "@MichaelDorgan I checked, it&#39;s called. I already made the other change you are suggesting, see my edits."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463006446, "post_id": 37174060, "comment_id": 61883543, "body": "If you have a debugger, can you confirm when you &quot;lose&quot; your data pointer?  That by itself should point out any error and is much easier than the internet debugging we are doing now."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1463008495, "post_id": 37174060, "comment_id": 61884143, "body": "<code>char d[]=&quot;&quot;; ... free(d);</code> Nooooo! Do not <code>free</code> what is not allocated via <code>malloc</code> or its family! Also be careful not to cause out-of-range access!"}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1463009796, "post_id": 37174060, "comment_id": 61884495, "body": "@MikeCAT Don&#39;t worry I&#39;ve changed it to <code>char *d</code>. See my edits."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463015036, "post_id": 37174060, "comment_id": 61885773, "body": "No need to avoid tasty <a href=\"https://en.wikipedia.org/wiki/Leek\" rel=\"nofollow noreferrer\">leeks</a>.  Good to avoid <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow noreferrer\">memory leaks</a>. ;-)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463022823, "post_id": 37174060, "comment_id": 61887686, "body": "In the <code>pop</code> function, <code>stek-&gt;copyFn(&amp;element, p-&gt;info);</code> is wrong because <code>element</code> is a local variable"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1463022874, "post_id": 37174060, "comment_id": 61887697, "body": "You haven&#39;t posted enough code to answer your question. <code>push</code> in particular is important. Please post a MCVE.    It&#39;s unclear why you would use copyfunc in the pop function instead of just returning the popped item (it doesn&#39;t need to be copied since it is no longer in the stack)"}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1463035939, "post_id": 37174060, "comment_id": 61892327, "body": "You need to, by default, produce a minimal complete example for every question asked. It&#39;s not helpful or wise to rely on a &quot;slow reveal&quot; through a series of edits, that just wastes time for everyone."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463042807, "post_id": 37174060, "comment_id": 61896746, "body": "@M.M It&#39;s supposed to be a generic function, and the copy function is just for <code>char*</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463043572, "post_id": 37174060, "comment_id": 61897331, "body": "we can&#39;t tell how to <code>pop</code> correctly since we do not know how the data is stored in your stack. that&#39;s why the <code>push</code> function is important"}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463051593, "post_id": 37174060, "comment_id": 61903195, "body": "@M.M It&#39;s stored in a linked list."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463051624, "post_id": 37174060, "comment_id": 61903218, "body": "sorry but you really have to post your code, nobody can guess what you did based on words."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463055157, "post_id": 37174060, "comment_id": 61905696, "body": "@M.M I wrote what my problem was, fixed with the help of comments here, and wrote what I fixed and why it works now."}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1463023069, "last_edit_date": 1463023069, "creation_date": 1463022641, "answer_id": 37176604, "question_id": 37174060, "link": "https://stackoverflow.com/questions/37174060/a-generic-function-to-copy-char-in-c/37176604#37176604", "title": "A generic function to copy char* in C", "body": "<p>The popping code should be:</p>\n\n<pre><code>char *d;\n\nwhile (pop(&amp;s, &amp;d))\n{\n    printf(\"d = %s \", d);\n    free(d);\n}\n</code></pre>\n\n<p>The <code>pop</code> function writes the popped value to the memory pointed to by the argument. So you must supply a pointer to the area where you write the popped value. Passing <code>d</code> is no good, nor is passing pointer to a 1-byte char array.</p>\n\n<p><strong>Note:</strong> this may not be a complete answer. I think your <code>pop</code> function is also wrong but you have not posted enough code. </p>\n"}], "owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463051508, "creation_date": 1463004369, "last_edit_date": 1463051508, "question_id": 37174060, "link": "https://stackoverflow.com/questions/37174060/a-generic-function-to-copy-char-in-c", "title": "A generic function to copy char* in C", "body": "<p>I'm trying to implement a generic stack (a singly linked list), I've worked out everything except when I have to handle character arrays.</p>\n\n<p>The node:</p>\n\n<pre><code>typedef struct cvor {\n    void *info;\n    struct cvor *next;\n} Cvor;\n</code></pre>\n\n<p>the stack typedef:</p>\n\n<pre><code>typedef struct {\n    Cvor *tos;\n    size_t velicinaInfo; // \n    freeFunction freeFn;\n    copyFunction copyFn;\n} Stek;\n</code></pre>\n\n<p>function to initialize a new stack:</p>\n\n<pre><code>void noviStek(Stek *stek, size_t velInfo, freeFunction freeFn, copyFunction copyFn)\n{\n    if (velInfo &lt;= 0)\n    {\n        // element size can't be &lt;=0\n        printf(\"Velicina elementa ne moze biti 0.\\n\");\n        return;\n    }\n    stek-&gt;tos = NULL;\n    stek-&gt;velicinaInfo = velInfo;\n    stek-&gt;freeFn = freeFn;\n    stek-&gt;copyFn = copyFn;\n}\n</code></pre>\n\n<p>the <code>freeFunction</code> and <code>copyFunction</code> are defined like this:</p>\n\n<pre><code>typedef void (*freeFunction)(void *);\ntypedef void (*copyFunction)(void **, void *);\n</code></pre>\n\n<p>For the primitive types(<code>int</code>, <code>double</code>,...) I don't need a specific copy function, but I need it for char*. This is what I have so far:</p>\n\n<pre><code>void copyString(void **dest, void *src)\n{\n    char *psrc = (char*) src;\n\n    size_t size = strlen(psrc) + 1;\n\n    *dest = calloc(size, 1);\n\n    memcpy(*dest, src, size);\n}\n</code></pre>\n\n<p>main looks like this:</p>\n\n<pre><code>char a[] = \"helloooooooooo\";\nchar b[] = \"helloworld\";\nchar c[] = \"stringst\";\n\nStek s;\n\nnoviStek(&amp;s, sizeof(char*), NULL, copyString);\n\npush(&amp;s, a);\nprintf(\"tops: \");\nstekTop(&amp;s, pisi_string);\nprintf(\"\\n\");\n\npush(&amp;s, b);\nprintf(\"tops: \");\nstekTop(&amp;s, pisi_string);\nprintf(\"\\n\");\n\npush(&amp;s, c);\nprintf(\"tops: \");\nstekTop(&amp;s, pisi_string);\nprintf(\"\\n\");\n\n\n//char d[100] = \"\";\nchar d[]=\"\";\nwhile (pop(&amp;s, d))\n{\n    printf(\"d = %s \", d);\n}\n\nisprazniStek(&amp;s);\n</code></pre>\n\n<p><code>stekTop()</code> prints top of stack, <code>isprazniStek()</code> frees the stack.</p>\n\n<p>The output is:</p>\n\n<pre><code>tops: helloooooooooo \ntops: helloworld \ntops: stringstring \nd = \nd = \nd = \n</code></pre>\n\n<p>So, if the <code>copyFn</code> is defined, it's used when <code>push()</code> and <code>pop()</code> are called to copy the info content of the node (for primitive types <code>copyFn</code> is <code>NULL</code>).</p>\n\n<p>The problem is with the <code>pop</code> function, here's the function:</p>\n\n<pre><code>int pop(Stek *stek, void *element)\n{\n    if (isEmptyStek(stek))\n        return 0;\n\n    Cvor *p = stek-&gt;tos;\n\n    if (stek-&gt;copyFn)\n    {\n        stek-&gt;copyFn(&amp;element, p-&gt;info);\n    }\n    else\n    {\n        memcpy(element, p-&gt;info, stek-&gt;velicinaInfo); // element = p-&gt;info;\n    }\n\n    stek-&gt;tos = p-&gt;next;\n\n    if (stek-&gt;freeFn)\n    {\n        stek-&gt;freeFn(p-&gt;info);\n    }\n\n    free(p-&gt;info);\n    free(p);\n\n    return 1;\n}\n</code></pre>\n\n<p>It doesn't copy <code>p-&gt;info</code> to <code>element</code> (it does when I use <code>push()</code>) and it doesn't free <code>p=info</code>.</p>\n\n<p>I can't figure out why. Sorry for the long post. Any help is appreciated.</p>\n\n<p><strong>EDIT</strong>:\nI changed <code>d</code> in the main function from <code>char d[]=\"\"</code> to <code>char *d</code>, now the output is:</p>\n\n<pre><code>tops: helloooooooooo \ntops: helloworld \ntops: stringstring \nd = (null)\nd = (null)\nd = (null)\n</code></pre>\n\n<p><strong>EDIT2</strong>:\nBecause I need to change <code>d</code> I need to send it's address, here is the correct code:</p>\n\n<pre><code>char d[]=\"\";\nwhile (pop(&amp;s, &amp;d))\n{\n    printf(\"d = %s \", d);\n}\n</code></pre>\n\n<p>and the corresponding fix in <code>pop()</code>:</p>\n\n<pre><code>int pop(Stek *stek, void *element)\n{\nif (isEmptyStek(stek))\n    return 0;\n\nCvor *p = stek-&gt;tos;\n\nif (stek-&gt;copyFn)\n{\n    stek-&gt;copyFn(element, p-&gt;info); // &lt;= !\n}\n\n...\n</code></pre>\n\n<p><strong>EDIT3</strong>:\nThe variable <code>d</code> has to be freed separately to avoid leeks (thanks Valgrind):</p>\n\n<pre><code>char d[]=\"\";\nwhile (pop(&amp;s, &amp;d))\n{\n    printf(\"d = %s \", d);\n    // do something else with it\n    // ...\n    free(d);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "dynamic", "malloc", "procedure"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1463002398, "post_id": 37173561, "comment_id": 61881953, "body": "<code>scanf(&quot;%d&quot;, &amp;numbers[i]);</code> --&gt; <code>scanf(&quot;%d&quot;, &amp;(*numbers)[i]);</code> or <code>scanf(&quot;%d&quot;,  *numbers + i);</code>, <code>sizeof(*numbers)</code> --&gt; <code>sizeof(**numbers)</code>"}, {"owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463002682, "post_id": 37173561, "comment_id": 61882074, "body": "@BLUEPIXY Many thanks!! It works!!!!"}, {"owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463004937, "post_id": 37173561, "comment_id": 61883005, "body": "@BLUEPIXY What if I have an array of struct? For example struct data *p; Should the scanf be (*p)[i].field?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463005442, "post_id": 37173561, "comment_id": 61883198, "body": "<code>p[i].field</code> .... <code>struct data { int field; } x[10], *p = x;</code>.. <code>scanf(&quot;%d&quot;, &amp;p[i].field);</code>"}, {"owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463005657, "post_id": 37173561, "comment_id": 61883280, "body": "@BLUEPIXI p[i].field doesn&#39;t work, while (*p)[i].field does. Anyway, in the code I posted, they work both sizeof(*numbers) and sizeof(**numbers). Why?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463005952, "post_id": 37173561, "comment_id": 61883368, "body": "Because <code>int</code> and <code>int *</code> are same size on your system."}, {"owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463006046, "post_id": 37173561, "comment_id": 61883413, "body": "Thanks! I made confusion because I&#39;m using a struct whose fields are strings"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463006458, "post_id": 37173561, "comment_id": 61883546, "body": "<code>void func(struct data **p, int i){ scanf(&quot;%d&quot;, &amp;(*p)[i].field); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "edited": false, "score": 0, "creation_date": 1463003173, "post_id": 37173702, "comment_id": 61882293, "body": "Thank you for the reply! So you mean to use numbers in the scanf?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "edited": false, "score": 0, "creation_date": 1463003372, "post_id": 37173702, "comment_id": 61882364, "body": "@FabioNardelli, use <code>numbers</code> just like you used it  in the first block of code."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1463004803, "post_id": 37173702, "comment_id": 61882962, "body": "Even better: the array is an OUTPUT from the get_numbers function, so make it the return value instead of using an argument:  <code>int *get_numbers(unsigned *dim)</code>...  ending with <code>return numbers;</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1463004982, "post_id": 37173702, "comment_id": 61883020, "body": "@ChrisDodd, much better suggestion."}, {"owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1463005745, "post_id": 37173702, "comment_id": 61883306, "body": "@ChrisDodd Thanks, but I think I&#39;m forced to use void functions(it&#39;s for a homework at university)."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1463004968, "last_edit_date": 1463004968, "creation_date": 1463002591, "answer_id": 37173702, "question_id": 37173561, "link": "https://stackoverflow.com/questions/37173561/how-can-i-create-a-dynamic-array-in-a-procedure-in-c/37173702#37173702", "title": "How can I create a dynamic array in a procedure in C?", "body": "<p>In the first block of code, <code>numbers</code> is of type <code>int*</code>.<br>\nIn the second block of code, <code>numbers</code> is of type <code>int**</code>.  </p>\n\n<p>You have not fixed all the places that need to be fixed because of that change.</p>\n\n<p>My suggestion: </p>\n\n<ol>\n<li>Change the input argument to <code>numbersPtr</code>.</li>\n<li>Create a local variable <code>int* numbers</code>.</li>\n<li>Before you return from the function, set <code>*numbersPtr</code> to <code>number</code>.</li>\n</ol>\n\n<hr>\n\n<pre><code>void get_numbers(int **numbersPtr, unsigned int *dim)\n{\n   int* numbers;\n\n   ...\n\n   *numbersPtr = numbers;\n}\n</code></pre>\n\n<p>It will be better to change <code>get_numbers</code> to return <code>numbers</code>.</p>\n\n<pre><code>int* get_numbers(unsigned int *dim)\n{\n   int* numbers;\n\n   ...\n\n   return numbers;\n}\n</code></pre>\n\n<p>and change its usage as:</p>\n\n<pre><code>numbers = get_numbers(&amp;dim);\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6322336, "user_type": "registered", "profile_image": "https://graph.facebook.com/532760443595218/picture?type=large", "display_name": "Fabio Nardelli", "link": "https://stackoverflow.com/users/6322336/fabio-nardelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 37173702, "answer_count": 1, "score": 1, "last_activity_date": 1463004968, "creation_date": 1463001972, "question_id": 37173561, "link": "https://stackoverflow.com/questions/37173561/how-can-i-create-a-dynamic-array-in-a-procedure-in-c", "title": "How can I create a dynamic array in a procedure in C?", "body": "<p>I'm new to this fantastic site and I found it very useful in many occasions, but now I'm dealing with a problem which I can't seem to solve.\nI'm a beginner C student and I'm studying dynamic memory allocation.\nI want to create a dynamic array of, let's say, integers, allocating memory for it inside a procedure, not in the main function.</p>\n\n<p>This works: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n        int *numbers; // pointer to create a dynamic array\n        int *test; // pointer to test realloc function\n        int c;\n        size_t i = 0;\n        unsigned int dim; // array's length\n\n        // allocate memory for the 1st number \n        numbers = malloc(sizeof(*numbers));\n        if (numbers == NULL) {\n                fputs(\"Error while allocating memory!\\n\", stderr);\n        } else {\n                printf(\"Insert the 1 number: \");\n                scanf(\"%d\", &amp;numbers[0]);\n                ++i;\n\n                /* allocate memory for the other numbers,\n                 * until the user inputs EOF\n                 */\n                while (!feof(stdin)) {\n                        test = realloc(numbers, (sizeof(*numbers) * (i + 1)));\n                        if (test == NULL) {\n                                fputs(\"Error while allocating memory!\\n\", stderr);\n                        } else {\n                                numbers = test;\n                                printf(\"Insert the %u number: \", i + 1);\n                                scanf(\"%d\", &amp;numbers[i]);\n                                ++i;\n                        }\n                }\n                dim = --i;\n\n                // print the array, 5 numbers per line\n                 for (i = 0; i &lt; dim; ++i) {\n                        if (i % 5 == 0) {\n                                puts(\"\");\n                        }\n                        printf(\"%d \", numbers[i]);\n                }\n                puts(\"\");\n        }\n\n        getchar();\n        return 0;\n}\n</code></pre>\n\n<p>But I want to do this (which doesn't work):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid get_numbers(int **numbers, unsigned int *dim);\n\nint main()\n{\n        int *numbers; // pointer to create a dynamic array\n        size_t i = 0;\n        unsigned int dim; // array's length\n\n        get_numbers(&amp;numbers, &amp;dim);\n\n        // print the array, 5 numbers per line\n         for (i = 0; i &lt; dim; ++i) {\n                if (i % 5 == 0) {\n                        puts(\"\");\n                }\n                printf(\"%d \", numbers[i]);\n        }\n        puts(\"\");\n\n        getchar();\n        return 0;\n}\n\nvoid get_numbers(int **numbers, unsigned int *dim)\n{\n        int *test; // pointer to test realloc function\n        int c;\n        size_t i = 0;\n\n        // allocate memory for the 1st number \n        *numbers = malloc(sizeof(*numbers));\n        if (*numbers == NULL) {\n                fputs(\"Error while allocating memory!\\n\", stderr);\n        } else {\n                printf(\"Insert the 1 number: \");\n                scanf(\"%d\", &amp;numbers[0]); // Maybe the error is here\n                ++i;\n\n                /* allocate memory for the other numbers,\n                 * until the user inputs EOF\n                 */\n                while (!feof(stdin)) {\n                        test = realloc(*numbers, (sizeof(*numbers) * (i + 1)));\n                        if (test == NULL) {\n                                fputs(\"Error while allocating memory!\\n\", stderr);\n                        } else {\n                                *numbers = test;\n                                printf(\"Insert the %u number: \", i + 1);\n                                scanf(\"%d\", &amp;numbers[i]);\n                                ++i;\n                        }\n                }\n                *dim = --i;\n        }\n}       \n</code></pre>\n\n<p>Do I need to use a pointer to a pointer to int, right?\nI know I made some mistakes but I can't figure out how to fix them.\nThanks in advance for your replies!\nBye,\nFabio Nardelli</p>\n"}, {"tags": ["c", "string", "printf", "variadic-functions"], "comments": [{"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463002105, "post_id": 37173525, "comment_id": 61881821, "body": "See [MSDN]( <a href=\"https://msdn.microsoft.com/en-us/library/1kt27hek(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/1kt27hek(v=vs.110).aspx</a> ) and as first argument should be non-NULL, this is undefined behaviour."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463002206, "post_id": 37173525, "comment_id": 61881880, "body": "@t0mm13b are you sure about this?"}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463002335, "post_id": 37173525, "comment_id": 61881923, "body": "@SouravGhosh OP was clearly asking what happens when NULL is passed in to the <code>vsnprintf</code> function, result after the call is undefined. You seem to think I was saying otherwise?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463002391, "post_id": 37173525, "comment_id": 61881948, "body": "@t0mm13b any reference? For <code>C11</code>, please see my answer. (I think the presence of 0 and 10 also matters)"}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 1, "creation_date": 1463002415, "post_id": 37173525, "comment_id": 61881960, "body": "One is microsoft based, other is C11... cannot win eh.."}, {"owner": {"reputation": 91, "user_id": 6322488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2049e6145a765ab5fdc0b3a9eafffbd?s=128&d=identicon&r=PG&f=1", "display_name": "user6322488", "link": "https://stackoverflow.com/users/6322488/user6322488"}, "edited": false, "score": 1, "creation_date": 1463003883, "post_id": 37173525, "comment_id": 61882578, "body": "Several things. 1) This applies to C99, not just C11. 2) The C standard allows an implementation to issue <i>any</i> diagnostic for <i>any</i> reason. 3) MSDN is not the C standard. 4) There&#39;s nothing on that page that suggests undefined behavior. Specifically saying &quot;NULL invokes the invalid parameter handler&quot; sounds like defined behavior to me."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463006693, "post_id": 37173525, "comment_id": 61883608, "body": "actually OP, what compiler are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1463002242, "post_id": 37173595, "comment_id": 61881895, "body": "<code>Concerning the return value of snprintf(), SUSv2 and C99 contradict each other: when snprintf() is called with size=0 then SUSv2 stipulates an unspecified return value less than 1, while C99 allows str to be NULL in this case, and gives the return value (as always) as the number of characters that would have been written in case the output string has been large enough.</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463002562, "post_id": 37173595, "comment_id": 61882028, "body": "@EugeneSh. Still, I&#39;ll stick with the <code>C11</code>, <i>just as in the case of <code>fflush(stdin)</code>, in <code>C11</code> vs MSVC (you know)</i>. :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463002628, "post_id": 37173595, "comment_id": 61882054, "body": "Yeah, unless the <i>implementation</i> is breaking the standard."}, {"owner": {"reputation": 91, "user_id": 6322488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2049e6145a765ab5fdc0b3a9eafffbd?s=128&d=identicon&r=PG&f=1", "display_name": "user6322488", "link": "https://stackoverflow.com/users/6322488/user6322488"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463004124, "post_id": 37173595, "comment_id": 61882676, "body": "@EugeneSh. Man pages, C libraries, and the specifications they conform to differ across systems. The C standard is the only authoritative specification. Anything else is up for grabs. In fact, I highly doubt we&#39;d get the same text for <code>man 2 vsnprintf</code>. As an example, mine says <code>The snprintf() and vsnprintf() functions conform to C99.</code>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1560445654, "last_edit_date": 1560445654, "creation_date": 1463002141, "answer_id": 37173595, "question_id": 37173525, "link": "https://stackoverflow.com/questions/37173525/vsnprintf-and-null-input-string-argument/37173595#37173595", "title": "vsnprintf and NULL input string argument", "body": "<p>Quoting C11, chapter \u00a77.21.6.12, <em>The <code>vsnprintf</code> function</em></p>\n\n<blockquote>\n  <p>The <code>vsnprintf</code> function is equivalent to <code>snprintf</code>, with the variable argument list\n  replaced by <code>arg</code>, which shall have been initialized by the <code>va_start</code> macro (and possibly subsequent <code>va_arg</code> calls). [....]</p>\n</blockquote>\n\n<p>and then, for <code>snprintf()</code>, \u00a77.21.6.5</p>\n\n<blockquote>\n  <p>[...] If <code>n</code> is zero, nothing is written, and <code>s</code> may be a null pointer.</p>\n</blockquote>\n\n<p>So, your first case is defined, while the second case invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> by attempting to access an invalid (<code>NULL</code>) pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 6322488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2049e6145a765ab5fdc0b3a9eafffbd?s=128&d=identicon&r=PG&f=1", "display_name": "user6322488", "link": "https://stackoverflow.com/users/6322488/user6322488"}, "is_accepted": false, "score": 5, "last_activity_date": 1463002210, "creation_date": 1463002210, "answer_id": 37173612, "question_id": 37173525, "link": "https://stackoverflow.com/questions/37173525/vsnprintf-and-null-input-string-argument/37173612#37173612", "title": "vsnprintf and NULL input string argument", "body": "<p><code>vsnprintf(NULL, 0, \"%d\", p);</code> is actually defined behavior.</p>\n\n<blockquote>\n  <p>7.19.6.5/2 The <code>snprintf</code> function is equivalent to <code>fprintf</code>, except that the output is written into an array (specified by argument <code>s</code>)\n  rather than to a stream. If n is zero, nothing is written,and <code>s</code> may\n  be a null pointer. ...</p>\n  \n  <p>7.19.6.12/2 The <code>vsnprintf</code> function is equivalent to <code>snprintf</code> ...</p>\n</blockquote>\n\n<p><code>vsnprintf(NULL, 10, \"%d\", p);</code> is not. Since <code>n</code> is not zero, you've violated a constraint and you got undefined behavior. Either way, you're likely writing to deference a NULL pointer which is again undefined behavior. If you're lucky your program crashes. If you're not, it'll keep running and do weird things to your program.</p>\n"}], "owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1979, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1560445654, "creation_date": 1463001794, "last_edit_date": 1463002756, "question_id": 37173525, "link": "https://stackoverflow.com/questions/37173525/vsnprintf-and-null-input-string-argument", "title": "vsnprintf and NULL input string argument", "body": "<p>What is the expected behavior of <code>vsnprintf</code> when it has an input NULL string and/or size=0, e.g.</p>\n\n<pre><code>vsnprintf(NULL, 0, \"%d\", p);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>vsnprintf(NULL, 10, \"%d\", p);\n</code></pre>\n\n<p>Is it undefined behavior or valid scenario? It doesn't crash with both input string as <code>NULL</code> and its length as <code>0</code>, and returns -1 (the same for valid non-NULL string and zero length), however it does crash the other way around (<code>NULL</code> input string and positive length).</p>\n"}, {"tags": ["c", "gcc", "x86", "inline-assembly"], "comments": [{"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463001524, "post_id": 37173415, "comment_id": 61881561, "body": "your assembler is seeing it all as one string... what assembler is this you&#39;re using?"}, {"owner": {"reputation": 379, "user_id": 4691346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PrchoZ9cf-c/AAAAAAAAAAI/AAAAAAAAABI/u5WgTPOa15g/photo.jpg?sz=128", "display_name": "Konstantin W", "link": "https://stackoverflow.com/users/4691346/konstantin-w"}, "edited": false, "score": 1, "creation_date": 1463001618, "post_id": 37173415, "comment_id": 61881604, "body": "append an <code>\\n\\t</code> at every line of assembly code"}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 1, "creation_date": 1463001657, "post_id": 37173415, "comment_id": 61881625, "body": "Did you read the faq on this <a href=\"http://www.bloodshed.net/faq.html#16\" rel=\"nofollow noreferrer\">devcpp</a>"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1463002438, "post_id": 37173415, "comment_id": 61881978, "body": "as mentioned you&#39;d at least need <code>\\n</code> on the end of each string, <code>\\n\\t</code> looks prettier in generated output since it indents. But even if you compile this <code>int 21h</code> will not work properly if you generate a Windows executable. Dev-CPP is a 32-bit compiler, and doesn&#39;t target DOS. GCC will likely complain about the use of the <code>h</code> suffix for hex, and you&#39;d have to be compiling with <code>-masm=intel</code> to use intel styntax. But <code>int 21h</code> will crash your Windows app when it encounters that instruction."}], "answers": [{"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1463002667, "post_id": 37173551, "comment_id": 61882069, "body": "It is guaranteed. In GCC the use of <code>__asm</code> will force the lines to be emitted into assembly code which will be processed by GNU assembler (<code>as</code>) . Since new lines can separate instructions in GNU assembler it is completely valid to separate instruction in <code>__asm</code> with <code>\\n</code> as well. <code>\\n\\t</code> is usually what you see since it pretties the assembler code generated if you tell <code>as</code> or <code>gcc</code> to emit the intermediate assembly code."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1463002825, "post_id": 37173551, "comment_id": 61882134, "body": "Have commented to the OP above that the faq states explicitly, <code>__asm</code> for each line of assembly..."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1463047471, "post_id": 37173551, "comment_id": 61900359, "body": "If I remember correctly, using <code>;</code> to separate assembly instructions in the same <code>__asm</code> block in GCC worked just fine for me..."}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 2, "last_activity_date": 1463002766, "last_edit_date": 1463002766, "creation_date": 1463001926, "answer_id": 37173551, "question_id": 37173415, "link": "https://stackoverflow.com/questions/37173415/error-compiling-c-program-with-devcpp-when-using-inline-assembly/37173551#37173551", "title": "Error compiling C program with DevCpp when using inline assembly", "body": "<p>The FAQ demonstrates doing one statement in each <code>__asm</code>.</p>\n\n<pre><code>__asm(\"mov %ah, 1\") ;\n__asm(\"int 21h\"   ) ;\n__asm(\"ONE AND ONLY ONE INSTRUCTION\") ;\n</code></pre>\n\n<p>You <em>should</em> be able to separate lines with a <code>\\n</code>, but I don't see that documented.</p>\n\n<pre><code>__asm(\"mov %ah, 1\\n\"\n      \"int 21h   \\n\"\n      \"MULTIPLE INSTRUCTIONS WITH \\n\") ;\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5553863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9dbde9fcdf0fe758951f66446aa33c2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ilyes", "link": "https://stackoverflow.com/users/5553863/a-ilyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1463005311, "creation_date": 1463001305, "last_edit_date": 1463005311, "question_id": 37173415, "link": "https://stackoverflow.com/questions/37173415/error-compiling-c-program-with-devcpp-when-using-inline-assembly", "title": "Error compiling C program with DevCpp when using inline assembly", "body": "<p>I am using DevCpp to compile the following code but a problem occurs:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n    char s;\n\n    __asm(\n    \"mov %ah, 1\"\n    \"int 21h\"\n    \"mov %ah,2\"\n    \"mov %dl,%al\"\n    \"int 21h\"\n    );\n\n    return 0;\n}\n</code></pre>\n\n<p>The error produced by the DevCpp compiler is: </p>\n\n<blockquote>\n  <p>Error: junk <code>int 21hmov %ah' after expression Error: too many memory\n  references for</code>mov'</p>\n</blockquote>\n\n<p>How do I solve this problem?</p>\n"}, {"tags": ["c", "linux", "fopen", "relative-path"], "comments": [{"owner": {"reputation": 5721, "user_id": 3823831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10a2607a7827988b6ac570fe168e02a?s=128&d=identicon&r=PG", "display_name": "TheGreatContini", "link": "https://stackoverflow.com/users/3823831/thegreatcontini"}, "edited": false, "score": 2, "creation_date": 1463000074, "post_id": 37173034, "comment_id": 61880809, "body": "Most likely you have the new line character in your path variable (fgets includes it).  Remove trailing whitespace and it should work"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1463000134, "post_id": 37173034, "comment_id": 61880832, "body": "<a href=\"http://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\">man fgets</a>: &quot;If a newline is read, it is stored into the buffer.&quot;"}, {"owner": {"reputation": 661, "user_id": 5510623, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Yyk7K.png?s=128&g=1", "display_name": "RigidBody", "link": "https://stackoverflow.com/users/5510623/rigidbody"}, "edited": false, "score": 1, "creation_date": 1463000968, "post_id": 37173034, "comment_id": 61881265, "body": "Well, certainly is a duplicate... unless you didn&#39;t know about the fgets \\n issue... :p"}], "answers": [{"tags": [], "owner": {"reputation": 5721, "user_id": 3823831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10a2607a7827988b6ac570fe168e02a?s=128&d=identicon&r=PG", "display_name": "TheGreatContini", "link": "https://stackoverflow.com/users/3823831/thegreatcontini"}, "is_accepted": false, "score": 3, "last_activity_date": 1463000290, "creation_date": 1463000290, "answer_id": 37173169, "question_id": 37173034, "link": "https://stackoverflow.com/questions/37173034/fopen-with-pathname-and-variable-filename-not-working/37173169#37173169", "title": "fopen with pathname and variable filename not working", "body": "<p>fgets will include the newline character, so most likely this is what's killing it.  Remove the newline at the end and it should work.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 3125979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2AFKV.png?s=128&g=1", "display_name": "jbmillard", "link": "https://stackoverflow.com/users/3125979/jbmillard"}, "is_accepted": true, "score": 2, "last_activity_date": 1463000468, "creation_date": 1463000468, "answer_id": 37173214, "question_id": 37173034, "link": "https://stackoverflow.com/questions/37173034/fopen-with-pathname-and-variable-filename-not-working/37173214#37173214", "title": "fopen with pathname and variable filename not working", "body": "<p>It's the new line being read.  A good way to see this is to print the filename with a leading and trailing \":\":</p>\n\n<pre><code>printf(\"path = :%s:\\n\", path);\n</code></pre>\n\n<p>What is printed is:</p>\n\n<pre><code>Server:junk Username$ ./a.out \nEnter filename, max 20 characters: test.txt\npath = :./test.txt\n:\nError: No such file or directory\n</code></pre>\n\n<p>Note the second \":\" is on a new line.</p>\n"}], "owner": {"reputation": 661, "user_id": 5510623, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Yyk7K.png?s=128&g=1", "display_name": "RigidBody", "link": "https://stackoverflow.com/users/5510623/rigidbody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "closed_date": 1463000803, "accepted_answer_id": 37173214, "answer_count": 2, "score": 0, "last_activity_date": 1463001080, "creation_date": 1462999790, "last_edit_date": 1463001080, "question_id": 37173034, "link": "https://stackoverflow.com/questions/37173034/fopen-with-pathname-and-variable-filename-not-working", "closed_reason": "Duplicate", "title": "fopen with pathname and variable filename not working", "body": "<p>I see a few similar questions in C, but they do not answer my question.<br/> \nConsistent perror is   Error: No such file or directory.\nUser input is aFile.txt and I confirm this file exists in the same directory as the program.<br/>\nIf I manually change:<br/> </p>\n\n<pre><code>input_file = fopen(path, \"r\");&lt;br/&gt;\n</code></pre>\n\n<p>to:<br/></p>\n\n<pre><code>input_file = fopen(\".\\aFile.txt\", \"r\");&lt;br/&gt;\n</code></pre>\n\n<p>IT WORKS...<br/>\nAlso, <code>printf(\"path = %s\\n\", path);</code> prints <code>.\\aFile.txt</code><br/>\nwhich leads me to believe my concatenation is OK.\nWhat am I doing incorrectly?</p>\n\n<pre><code>   char path[25] = \"./\";\n   char filename[21];\n   printf(\"Enter filename, max 20 characters: \");\n   fgets(filename, 20, stdin);\n   strcat(path, filename);\n   strtok(path, \"\\n\"); // FIXED THE ISSUE BY REMOVING THE trailing '\\n'\n   printf(\"path = %s\\n\", path);\n\n   FILE * input_file;\n   input_file = fopen(path, \"r\"); // fopen(\".\\aFile.txt\", \"r\") works!!!\n   if (input_file == NULL)\n        perror(\"Error\");\n   else {\n        loader(list, input_file);\n        fclose(input_file);\n        printf(\"list loaded from file succesfully.\\n\");\n   }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1462999486, "post_id": 37172912, "comment_id": 61880503, "body": "Try adding <code>fflush(stdout);</code> after <code>printf(&quot;Hello&quot;);</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1462999607, "post_id": 37172912, "comment_id": 61880560, "body": "and use sleep rather than looping <a href=\"http://linux.die.net/man/3/sleep\" rel=\"nofollow noreferrer\">linux.die.net/man/3/sleep</a>"}, {"owner": {"reputation": 3, "user_id": 6322409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b7c07aa2f8efdcbf76ecadfdc4e269?s=128&d=identicon&r=PG&f=1", "display_name": "Yousef", "link": "https://stackoverflow.com/users/6322409/yousef"}, "edited": false, "score": 0, "creation_date": 1462999661, "post_id": 37172912, "comment_id": 61880597, "body": "It works :D Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6322409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b7c07aa2f8efdcbf76ecadfdc4e269?s=128&d=identicon&r=PG&f=1", "display_name": "Yousef", "link": "https://stackoverflow.com/users/6322409/yousef"}, "edited": false, "score": 0, "creation_date": 1462999801, "post_id": 37173002, "comment_id": 61880661, "body": "Thank you for the explaining."}], "tags": [], "owner": {"reputation": 71, "user_id": 6317479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c9c6606327581bcb172c2bdad7659e?s=128&d=identicon&r=PG&f=1", "display_name": "Goldlight", "link": "https://stackoverflow.com/users/6317479/goldlight"}, "is_accepted": true, "score": 1, "last_activity_date": 1462999649, "creation_date": 1462999649, "answer_id": 37173002, "question_id": 37172912, "link": "https://stackoverflow.com/questions/37172912/making-the-program-wait-for-a-specific-time-in-c/37173002#37173002", "title": "Making the program wait for a specific time in C", "body": "<p>Print a new line to flush stdout : </p>\n\n<pre><code> printf(\"Hello\\n\");\n</code></pre>\n\n<p>Currently no characters in the standard output will be displayed because it is line buffered. You can also call the <code>fflush</code> function for the same outcome.</p>\n"}], "owner": {"reputation": 3, "user_id": 6322409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b7c07aa2f8efdcbf76ecadfdc4e269?s=128&d=identicon&r=PG&f=1", "display_name": "Yousef", "link": "https://stackoverflow.com/users/6322409/yousef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "accepted_answer_id": 37173002, "answer_count": 1, "score": 0, "last_activity_date": 1462999663, "creation_date": 1462999386, "question_id": 37172912, "link": "https://stackoverflow.com/questions/37172912/making-the-program-wait-for-a-specific-time-in-c", "title": "Making the program wait for a specific time in C", "body": "<p>What I want the code to do is:\nprinting \"Hello\",\nwaiting 2 seconds, and\nprinting \"world\".</p>\n\n<p>What happens:\n    Once I run the program, it waits two seconds, then prints \"helloWorld\"</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n\ntime_t current_time = 0; //A variable to save the time\n\nprintf(\"Hello\");\n\ncurrent_time = clock();\n//wating 2 seconds\nfor ( ; (clock() - current_time) &lt; (2 * CLOCKS_PER_SEC); );\n\nprintf(\"Wolrd\");\nreturn 0;\n}\n</code></pre>\n\n<p>As if the wait command is before the two printing commands?!</p>\n"}, {"tags": ["ios", "c", "sockets", "ipv6", "ipv4"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1463018287, "post_id": 37172779, "comment_id": 61886577, "body": "Some platforms support <i>dual-stack</i> sockets (sadly, iOS is not one of them, especially with Apple pushing iOS to support only IPv6 exclusively). Where available, you can create an <code>AF_INET6</code> socket for IPv6 and then disable the <code>IPV6_V6ONLY</code> option on it to allow IPv4 via <a href=\"https://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses\" rel=\"nofollow noreferrer\">IPv4-mapped IPv6 addresses</a>."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 8333, "user_id": 813192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee82a22b9a73f459fe180128811e4c1?s=128&d=identicon&r=PG", "display_name": "Sander Steffann", "link": "https://stackoverflow.com/users/813192/sander-steffann"}, "edited": false, "score": 0, "creation_date": 1463011094, "post_id": 37172811, "comment_id": 61884878, "body": "@SanderSteffann, yeah, i am curious too."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1463021102, "post_id": 37172811, "comment_id": 61887285, "body": "It might be a good answer (I <b>didn&#39;t</b> down-vote), but I&#39;m not sure that it covers everything... what about using the <code>AF_UNSPEC</code> socket family, allowing the protocol binding to wait for the <code>bind</code>... I know this refers to listening sockets (I can listen to both IPv4 &amp; IPv6), but it might be relevant to explain how this applies (or doesn&#39;t apply) to a client socket."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1463058240, "post_id": 37172811, "comment_id": 61908188, "body": "@Myst, AF_UNSPEC is not a standard valid option for domain. As far as I know only Windows supports it, and OP is using OS X."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1463068441, "post_id": 37172811, "comment_id": 61916348, "body": "@SergeyA, <code>AF_UNSPEC</code> works on my Mac (BSD), it&#39;s specified on the <a href=\"http://linux.die.net/man/3/getaddrinfo\" rel=\"nofollow noreferrer\">Linux man page</a> and I believe (didn&#39;t check) it complies with POSIX.1-2001. I picked it up from <a href=\"http://beej.us/guide/bgnet/output/html/multipage/ipstructsdata.html#structs\" rel=\"nofollow noreferrer\">Beej&#39;s guide</a>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1463069417, "post_id": 37172811, "comment_id": 61917027, "body": "@Myst, what you are saying is not relevant to the question in any way. You are talking about getaddrinfo parameter. As <code>getaddrinfo</code> parameter AF_UNSPEC is, of course, valid and allows you to pick an interface which matches both families. But it doesn&#39;t mean you can create a socket using AF_UNSPEC as a domain! (effectively what OP would like to do)."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1463077505, "post_id": 37172811, "comment_id": 61921888, "body": "@SergeyA, as I pointed out, I don&#39;t think the answer is wrong, I just think that it would be more complete if it pointed out the information about <code>getaddrinfo</code> and <code>AF_UNSPEC</code> to answer the OP&#39;s question: &quot;is it possible I can detect what network my device is on: IPv4 or IPv6?&quot;"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1463077719, "post_id": 37172811, "comment_id": 61922012, "body": "@Myst, OP assumes the device can only have one interface (IPv4 or IPv6). This assumption is not correct, and I mentioned it in my question. OP didn&#39;t ask how to get all available interfaces for device, so I didn&#39;t answer this (unasked) question."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 5, "last_activity_date": 1462999032, "creation_date": 1462999032, "answer_id": 37172811, "question_id": 37172779, "link": "https://stackoverflow.com/questions/37172779/pre-creating-sockets-without-knowing-whether-they-are-ipv4-or-ipv6/37172811#37172811", "title": "pre-creating sockets without knowing whether they are IPv4 or IPv6", "body": "<p>What you want to do is not possible. When socket is created, it is associated with stack protocol, and IPV6 and IPV4 are just different stack protocols.</p>\n\n<p>However, the real question is <strong>why</strong> do you precreate sockets? Why not create the socket when you need to?</p>\n\n<p>And last, but not the least, your assumption is incorrect. Your device can have multiple interfaces - one for IPv4, another for IPv6 - and use them both.</p>\n"}], "owner": {"reputation": 4802, "user_id": 787684, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/863490eeddb10fb2d2c4cf2b7986aa5b?s=128&d=identicon&r=PG", "display_name": "Locksleyu", "link": "https://stackoverflow.com/users/787684/locksleyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 37172811, "answer_count": 1, "score": 0, "last_activity_date": 1462999032, "creation_date": 1462998922, "question_id": 37172779, "link": "https://stackoverflow.com/questions/37172779/pre-creating-sockets-without-knowing-whether-they-are-ipv4-or-ipv6", "title": "pre-creating sockets without knowing whether they are IPv4 or IPv6", "body": "<p>I have some code which works by pre-creating sockets (via. socket() BSD API), and then at a later time when the address is known it will do the connect() etc. This works with IPv4 but now I am refactoring to support IPv6 as well.</p>\n\n<p>The problem is that it seems that when I do the initial socket() I need to put in AF_INET or AF_INET6. However since I don't know the address yet I don't know which is correct. Is there anyway to create a generic socket which will work for either? If I use AF_INET6 and I am on a IPv4 network, am I correct in assuming it will not work?</p>\n\n<p>A related question - Even though I don't know the IP address yet, is it possible I can detect what network my device is on: IPv4 or IPv6? Assuming one network interface, I think I can only be one of those networks, so if I can find a way to detect what type of network my device is on, then I can do that at socket creation time.</p>\n\n<p>Another option is to refactor to create the socket only when I know the address, but there is a big codebase and I would like to avoid that if possible.</p>\n\n<p>I'm writing code that runs on iOS, but I am not sure if that is relevant here.</p>\n"}, {"tags": ["c", "struct", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1462998800, "post_id": 37172684, "comment_id": 61880144, "body": "I don&#39;t understand - you just traverse the tree and keep a note of the highest value.  That, or add another index so you can order it by value too."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1462999235, "post_id": 37172684, "comment_id": 61880375, "body": "If it is ordered, you just go to the rightmost leaf."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462999278, "post_id": 37172684, "comment_id": 61880401, "body": "The question says: <i>it is ordered alphabetically</i>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462999382, "post_id": 37172684, "comment_id": 61880449, "body": "@WeatherVane In this case it won&#39;t help with the <code>count</code> value..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462999542, "post_id": 37172684, "comment_id": 61880531, "body": "@EugenSh. I was replying to the two comments wondering if it is ordered by count, which OP says is not."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462999423, "post_id": 37172800, "comment_id": 61880473, "body": "I like this but your tests and <code>else</code>s are needlessly complicated, seeing as you already did <code>return</code> and already know that <code>l &gt; me</code>."}, {"owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1463000209, "post_id": 37172800, "comment_id": 61880870, "body": "@WeatherVane So you want to say that there is an unneeded comparison? If so, I can&#39;t spot it .."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1463000476, "post_id": 37172800, "comment_id": 61880999, "body": "Ah yes sorry, I spotted it now."}, {"owner": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "edited": false, "score": 0, "creation_date": 1463000922, "post_id": 37172800, "comment_id": 61881239, "body": "A minor comment. I don&#39;t like that the code is relying on the fact that <code>count</code> is always non-negative. It doesn&#39;t generalize---you can&#39;t assume that you can return <code>-1</code> if <code>head==NULL</code>."}, {"owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "reply_to_user": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "edited": false, "score": 0, "creation_date": 1463001085, "post_id": 37172800, "comment_id": 61881324, "body": "Thats true, I personally favor @blazs solution. I will add a short remark."}], "tags": [], "owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1463001419, "last_edit_date": 1463001419, "creation_date": 1462998997, "answer_id": 37172800, "question_id": 37172684, "link": "https://stackoverflow.com/questions/37172684/getting-a-max-value-from-a-binary-tree/37172800#37172800", "title": "Getting a max value from a Binary Tree", "body": "<p>Recursion is your friend in this case. Your function compares the value of itself, the max of the left side and the max of the right side and returns the biggest value.</p>\n\n<pre><code>int maxValue(link head)\n{\n    if(head == NULL){\n        return -1;\n    }\n    int me = head-&gt;count;\n    int l = maxValue(head-&gt;l);\n    int r = maxValue(head-&gt;r);\n    if(me &gt;= l &amp;&amp; me &gt;= r) {\n        return me;\n    } else if(l &gt;= me &amp;&amp; l &gt;= r){\n        return l;\n    } else {\n        return r;\n    }\n}\n</code></pre>\n\n<p><strong>Remark</strong></p>\n\n<p>This code is not as general as one could have written it. It will only work as expected if <code>count</code> is always greater equals zero in the tree and if the function is not called on a NULL object in the beginning, since then <code>-1</code> would be returned. Better use @blazs solution in practice.</p>\n"}, {"tags": [], "owner": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "is_accepted": false, "score": 1, "last_activity_date": 1463000552, "last_edit_date": 1463000552, "creation_date": 1462999325, "answer_id": 37172889, "question_id": 37172684, "link": "https://stackoverflow.com/questions/37172684/getting-a-max-value-from-a-binary-tree/37172889#37172889", "title": "Getting a max value from a Binary Tree", "body": "<p>The idea is to first compute the max values of the subtrees, <code>maxLeft</code> and <code>maxRight</code>, of a given node, and then return <code>max(currVal, maxLeft, maxRight)</code>, where <code>currVal</code> is the value in the current node.</p>\n\n<p>Here's how you express this directly in code:</p>\n\n<pre><code>int maxValue(link head)\n{\n    assert(head != NULL);\n    int currVal = head-&gt;count;\n    if (head-&gt;l != NULL) // compute max of the left subtree\n        currVal = max(currVal, maxValue(head-&gt;l));\n    if (head-&gt;r != NULL) // compute max of the right subtree\n        currVal = max(currVal, maxValue(head-&gt;r));\n    return currVal;\n}\n</code></pre>\n\n<p>The <code>max</code> could be a simple macro, for example</p>\n\n<pre><code>#define max(x, y) (x) &gt; (y) ? (x) : (y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1463002828, "creation_date": 1463002828, "answer_id": 37173750, "question_id": 37172684, "link": "https://stackoverflow.com/questions/37172684/getting-a-max-value-from-a-binary-tree/37173750#37173750", "title": "Getting a max value from a Binary Tree", "body": "<p>To find the maximum value in a tree, code can not take advantage of alphabetical ordering.  Instead the entire tree needs to be walked.  This involves checking the current node and also then the max of each of the two children, left and right.</p>\n\n<p>A classic improvement to walking a binary tree is to only recuse on one leg (e.g. left side) and loop on the other (right).  This loop unrolling can sometimes be identified by a smart compiler that recurses on both legs.  Here, below, it is done explicitly.</p>\n\n<p>This code returns <code>INT_MIN</code> should the original <code>head == NULL</code>.</p>\n\n<pre><code>int maxValue(link head) {\n  int max = INT_MIN;\n  while (head) {\n    if (head.count &gt; max) {\n      max = head.count;\n    }\n    int left_max = maxValue(head.left);\n    if (left_max &gt; max) { \n      max = left_max;\n    }\n    head = head.right;\n  }\n  return max;\n}\n</code></pre>\n\n<p>Style: I'd rather see a typedef without the <code>*</code> as in below.</p>\n\n<pre><code>typedef struct node {\n    char *name;\n    int count;\n    struct node *l, *r; \n} link;\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5629893, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93039590c11751e1f4f97ab8e9342ecd?s=128&d=identicon&r=PG&f=1", "display_name": "NightmaresCoding", "link": "https://stackoverflow.com/users/5629893/nightmarescoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1517992553, "creation_date": 1462998515, "last_edit_date": 1517992553, "question_id": 37172684, "link": "https://stackoverflow.com/questions/37172684/getting-a-max-value-from-a-binary-tree", "title": "Getting a max value from a Binary Tree", "body": "<p>Right now I binary tree and i want to get the max value out of it. Considering how it has both string and int values, it is ordered by alphabetical order. Everything is working properly all the inserts, search, delete etc. For now all we need to know is that here I have my tree.</p>\n\n<pre><code>typedef struct node \n{\n    char *name;\n    int count;\n    struct node *l, *r; \n}*link;\n</code></pre>\n\n<p>How can I make a simple function that finds what is the highest <code>count</code> in the tree. Like I can have 20 nodes in the tree and suppose the highest <code>count</code> is 10 and there are 3 nodes with the highest <code>count</code>. It doesn't matter how many there are with 10 the highest <code>count</code>, I just want the function to return 10. A function like.</p>\n\n<pre><code>int maxValue(link head)\n{\n    //the help i need with\n}\n</code></pre>\n\n<p>I've looked up online and tried some examples like the inorder and all of the different funtions but most of them just placed all values from left node to the most right one in order so it didnt really help me find the maximum number in the tree because mine is not organized from smallest to largest numbers.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1462998287, "post_id": 37172591, "comment_id": 61879850, "body": "It is static as you defined the array at file scope. The macros are evaluated, and added, at compile time. <code>malloc</code> has nothing to do with it. If you had defined the array within a function as a local array, there would still be no call to <code>malloc</code>. It would be a plain automatic variable."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1462998459, "post_id": 37172591, "comment_id": 61879932, "body": "<i>&quot;I think, arr is a dynamic defined array&quot;</i> It is not."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1462998546, "post_id": 37172591, "comment_id": 61880002, "body": "Prove to whom? Look at the disassembly. Or, alternatively learn what &quot;<i>constant expression</i>&quot; in C is."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462998766, "post_id": 37172591, "comment_id": 61880125, "body": "Or try the google."}, {"owner": {"reputation": 29, "user_id": 6322310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153850011182758/picture?type=large", "display_name": "Jia Mu", "link": "https://stackoverflow.com/users/6322310/jia-mu"}, "edited": false, "score": 0, "creation_date": 1462999007, "post_id": 37172591, "comment_id": 61880247, "body": "You mean, the Macro Operation will be always done at compiletime? If i define a macro so : #define MACRO 6+7 and i use this macro so a=MACRO-b. And this Equation will be expanded at compiletime: a=15-b?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462999793, "post_id": 37172591, "comment_id": 61880657, "body": "Yes yes yes yes yes. No. 6 + 7 = 13. And anyway you must always use brackets - <code>#define MACRO (6+7)</code>. Consider what would happen here: <code>a=MACRO * b</code>"}, {"owner": {"reputation": 29, "user_id": 6322310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153850011182758/picture?type=large", "display_name": "Jia Mu", "link": "https://stackoverflow.com/users/6322310/jia-mu"}, "edited": false, "score": 0, "creation_date": 1463000562, "post_id": 37172591, "comment_id": 61881044, "body": "Thank you. I understand now. The arr which i defined in filescope is a static varible, because this macro operation will be done at compiletime. Also the expanded Macro &quot;5U+7U&quot; is a constant expression. And constant expression will be always done at compiletime."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1463002813, "post_id": 37172902, "comment_id": 61882130, "body": "The preprocessor is actually part of the compiler (even if it&#39;s implemented separately). But the post-preprocessor part of the compiler sees <code>int arr[5U+6U]</code>. Since <code>5U+6U</code> is a constant expression, it evaluates it."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1462999360, "creation_date": 1462999360, "answer_id": 37172902, "question_id": 37172591, "link": "https://stackoverflow.com/questions/37172591/array-length-definition-with-mathematical-operation-in-c/37172902#37172902", "title": "Array length Definition with mathematical operation in c", "body": "<p>when u do</p>\n\n<pre><code>#define MACRO1 5U\n#define MACRO2 6U\nint arr[MACRO1+MACRO2];\n</code></pre>\n\n<p>the c compiler just sees</p>\n\n<pre><code>int arr[11];\n</code></pre>\n\n<p>which is probably not 'dynamic' - I quote dynamic because you dont define what 'dynamic'  means for you.</p>\n\n<p>Where it gets allocated depends on where the statement appears in the program. Its either on the stack if its in a function or its static if its at file scope</p>\n"}, {"tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": false, "score": 0, "last_activity_date": 1463001273, "creation_date": 1463001273, "answer_id": 37173409, "question_id": 37172591, "link": "https://stackoverflow.com/questions/37172591/array-length-definition-with-mathematical-operation-in-c/37173409#37173409", "title": "Array length Definition with mathematical operation in c", "body": "<p><code>arr</code> is an array whose size is determined at compile time. In C terminology, it's an array that isn't a variable length array. That's because its size is a constant. The variable can be annotated as <code>static</code> or put at file scope, and that makes it a global variable, with a size that can be reserved statically (typically included in the BSS, if the C implementation has a BSS).</p>\n\n<p>Any expression that is understood by the preprocessor is a constant. For example, you can have a preprocessor directive</p>\n\n<pre><code>#if MACRO1 + MACRO2 &gt; 4\n\u2026\n</code></pre>\n\n<p>The preprocessor (which is part of the C compiler) performs the computation (looking up the values of <code>MACRO1</code> and <code>MACRO2</code>, performing the addition and the comparison) in an early stage of the compilation.</p>\n\n<p>There are also constants that the preprocessor cannot calculate, mostly resulting from <code>sizeof</code>: the result of <code>sizeof</code> is a compile-time constant unless the calculation involves the size of a variable length array. So while you cannot write <code>#if sizeof(some_type) &gt; 4</code>, you can write things like</p>\n\n<pre><code>static unsigned char b[sizeof(x) * 2];\nstatic c = sizeof(x) | 4;\n</code></pre>\n\n<p>The size of the array <code>b</code> and the value used to initialize <code>c</code> are both compile-time constants.</p>\n\n<p>Basically, any expression that doesn't involve the value of a variable or a pointer dereference is a compile-time constant (\u201cconstant expression\u201d in the terminology used by the C standard).</p>\n\n<p>On the other hand, the value of a variable (as opposed to a macro) is not a compile-time constant, so it cannot be used where a compile-time constant is required\u00b9.</p>\n\n<pre><code>const x = 3; /* OK */\nstatic c = x; /* not ok in C */\n</code></pre>\n\n<p>\u00b9 <sub> C++ works differently here. My answer is about C. </sub>  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463004192, "post_id": 37173857, "comment_id": 61882704, "body": "Did not follow the [<code>int arr[11U];</code> &quot;since the particular type of an array length is not part of the array&#39;s type:&quot; <code>int arr[11];</code>].  Why imply the size is made into an <code>int</code>?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463004252, "post_id": 37173857, "comment_id": 61882731, "body": "@chux: I didn&#39;t mean to imply that it&#39;s an <code>int</code>, merely that it doesn&#39;t matter whether it&#39;s an <code>int</code> or an <code>unsigned int</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463004584, "post_id": 37173857, "comment_id": 61882865, "body": "OK.  As I see it, the number <code>n</code> between the <code>[]</code>, has some <i>integer</i> type up to <code>intmax_t&#47;uintmax_t</code> and would have a value in the range of [1...(SIZE_MAX-1)]`."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463006171, "post_id": 37173857, "comment_id": 61883454, "body": "@chux: There&#39;s actually no constraint that requires the value to be in the range 1..<code>SIZE_MAX</code>-1 -- but anything bigger than that (or approaching it) is likely to exceed the implementation&#39;s capacity."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463010406, "post_id": 37173857, "comment_id": 61884672, "body": "Hmm, with any array like <code>char A[some_constant]</code>, does not <code>A</code>&#39;s size must fit in <code>size_t</code> as that is the return type of <code>sizeof(A)</code> and the definition of <code>SIZE_MAX</code> is the max value of type <code>size_t</code>.  So, aside for a +1 issue, could an array&#39;s size exceed <code>SIZE_MAX</code>?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463010689, "post_id": 37173857, "comment_id": 61884757, "body": "@chux: That&#39;s a complicated question, and the standard is unclear. As I said, there&#39;s no relevant constraint on array types, so a compiler isn&#39;t required to accept <code>int arr[LUDICROUSLY_HUGE_NUMBER];</code>. In practice, any sane implementation will almost certainly make <code>size_t</code> wide enough to represent the size of any object it can support. But in theory (IMHO) <code>sizeof arr</code> is an integer expression like any other, and I see no explicit reason to assume it can&#39;t overflow the bounds of <code>size_t</code>. What happens if <code>sizeof arr</code> overflows is an interesting question. Does it wrap around, or is it UB?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463011089, "post_id": 37173857, "comment_id": 61884876, "body": "Fair enough - thanks for the response - perhaps this will make a good SO question."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463011823, "post_id": 37173857, "comment_id": 61885038, "body": "Correction to my previous comment: I meant that a compiler isn&#39;t required to <i>reject</i> (or diagnose) <code>int arr[LUDICROUSLY_HUGE_NUMBER];</code>"}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1463003335, "creation_date": 1463003335, "answer_id": 37173857, "question_id": 37172591, "link": "https://stackoverflow.com/questions/37172591/array-length-definition-with-mathematical-operation-in-c/37173857#37173857", "title": "Array length Definition with mathematical operation in c", "body": "<p>This:</p>\n\n<pre><code>#define MACRO1 5U\n#define MACRO2 6U\nint arr[MACRO1+MACRO2];\n</code></pre>\n\n<p>is equivalent to this:</p>\n\n<pre><code>int arr[5U+6U];\n</code></pre>\n\n<p>Since <code>5U+6U</code> is a <em>constant expression</em>, it's evaluated at compile time, just as if you had written:</p>\n\n<pre><code>int arr[11U];\n</code></pre>\n\n<p>or, since the particular type of an array length is not part of the array's type:</p>\n\n<pre><code>int arr[11];\n</code></pre>\n\n<p>Since the length is a constant expression, <code>arr</code> is not a <em>variable-length array</em> (VLA), and it's legal to define it at file scope. (C90 did not have VLAs. C11 made support for them optional.)</p>\n\n<p>If <code>arr</code> is defined inside a function without the <code>static</code> keyword, it has <em>automatic storage duration</em>; in most implementations, this means it's allocated on the \"stack\". Otherwise, it has <em>static storage duration</em> (it exists for the entire execution of the program, and it's allocated in whatever manner the implementation uses (perhaps a BSS segment or something similar). It will not be allocated in the same manner as by a call to <code>malloc()</code> (on the \"heap\").</p>\n\n<p>Constant expressions are defined in section 6.6 of the current C standard (see the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">N1570</a> draft).</p>\n\n<p>A <em>constant expression</em> may not contain assignment, decrement, increment, function-call, or comma operators, unless they're in a subexpression that's not evaluated. An <em>integer constant expression</em> may only have operands that are integer constants, enumeration constants, character constants, <code>sizeof</code> expressions whose results are integer constants, and a handful of other things.</p>\n"}], "owner": {"reputation": 29, "user_id": 6322310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153850011182758/picture?type=large", "display_name": "Jia Mu", "link": "https://stackoverflow.com/users/6322310/jia-mu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "accepted_answer_id": 37173857, "answer_count": 3, "score": 1, "last_activity_date": 1463003335, "creation_date": 1462998138, "question_id": 37172591, "link": "https://stackoverflow.com/questions/37172591/array-length-definition-with-mathematical-operation-in-c", "title": "Array length Definition with mathematical operation in c", "body": "<p>I want to define an Array in c in followed way:</p>\n\n<pre><code>#define MACRO1 5U\n#define MACRO2 6U\nint arr[MACRO1+MACRO2];\n</code></pre>\n\n<p>my question is: Is Array arr a dynamical defined Array in Heap or static defined Array in DATA-Segment(or BSS)?</p>\n\n<p>I think, arr is a dynamic defined array. It is similar with an array allocated with malloc function. The reason is, that the mathematical addition will be done firstly in runtime. In Compilertime all macros will be only expanded as followed:</p>\n\n<pre><code>int arr[5U+6U];\n</code></pre>\n\n<p>I used a Compiler with c90 Standard.</p>\n\n<p>Can anybody help me? Is my argumentation Right?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 2, "creation_date": 1462998291, "post_id": 37172579, "comment_id": 61879853, "body": "<code>void callback_2()</code> isn&#39;t a function taking zero arguments. <code>void callback_2(void)</code> is."}, {"owner": {"reputation": 599, "user_id": 721242, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3832bcc4b566196e67c5ca98ec1bdda1?s=128&d=identicon&r=PG", "display_name": "superlou", "link": "https://stackoverflow.com/users/721242/superlou"}, "reply_to_user": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 0, "creation_date": 1463073627, "post_id": 37172579, "comment_id": 61919562, "body": "Yep, immediately after the comments mentioned <code>()</code> vs. <code>(void)</code> it clicked.  Now that I know the root cause, it&#39;s easier to find similar stackoverflow posts.  This may be a duplicate of <a href=\"http://stackoverflow.com/questions/693788/is-it-better-to-use-c-void-arguments-void-foovoid-or-not-void-foo\">this one</a>.  Since <code>()</code> is deprecated in C99, I&#39;m going to see if there&#39;s a flag I can set to get the warning."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1462999699, "post_id": 37172644, "comment_id": 61880612, "body": "Right. <code>void callback_2()</code> <i>declares</i> that it takes an unspecified number of arguments. <code>void callback_2() { &#47;* ... *&#47; }</code> <i>defines</i> a function that has no parameters; calling it with one or more parameters has undefined behavior. That&#39;s why prototypes (<code>void callback_2(void)</code>) were added to the language, to allow such errors to be caught by the compiler."}, {"owner": {"reputation": 599, "user_id": 721242, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3832bcc4b566196e67c5ca98ec1bdda1?s=128&d=identicon&r=PG", "display_name": "superlou", "link": "https://stackoverflow.com/users/721242/superlou"}, "edited": false, "score": 0, "creation_date": 1463075011, "post_id": 37172644, "comment_id": 61920400, "body": "It seems like this specific case can be warned by using -Wstrict-prototypes on GCC C99.  Is that appropriate for this question?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 599, "user_id": 721242, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3832bcc4b566196e67c5ca98ec1bdda1?s=128&d=identicon&r=PG", "display_name": "superlou", "link": "https://stackoverflow.com/users/721242/superlou"}, "edited": false, "score": 0, "creation_date": 1463076400, "post_id": 37172644, "comment_id": 61921228, "body": "@superlou Yes, that&#39;s correct.  I&#39;ve edited my answer with this info."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1463076374, "last_edit_date": 1463076374, "creation_date": 1462998333, "answer_id": 37172644, "question_id": 37172579, "link": "https://stackoverflow.com/questions/37172579/c-function-pointers-assigned-to-functions-with-a-different-signature/37172644#37172644", "title": "C function pointers assigned to functions with a different signature", "body": "<p>This is because you have <code>callback2</code> defined as:</p>\n\n<pre><code>void callback_2()\n</code></pre>\n\n<p>The empty parenthesis means it takes an <em>unspecified</em> number of arguments.  So it qualifies to be assigned to type <code>Callback</code>.</p>\n\n<p>If you change the definition to this:</p>\n\n<pre><code>void callback_2(void)\n</code></pre>\n\n<p>This explicitly specifies that the function takes 0 arguments, and you'll get an \"assignment from incompatible pointer type\" warning.</p>\n\n<p>In order to properly catch this condition, compile with <code>-Wstrict-prototypes</code> along with <code>-Wall -Wextra</code> and you'll get the following if declare or define a function with an empty argument list:</p>\n\n<pre><code>warning: function declaration isn\u2019t a prototype\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 6322488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2049e6145a765ab5fdc0b3a9eafffbd?s=128&d=identicon&r=PG&f=1", "display_name": "user6322488", "link": "https://stackoverflow.com/users/6322488/user6322488"}, "is_accepted": false, "score": 1, "last_activity_date": 1463001228, "last_edit_date": 1463001228, "creation_date": 1463000643, "answer_id": 37173256, "question_id": 37172579, "link": "https://stackoverflow.com/questions/37172579/c-function-pointers-assigned-to-functions-with-a-different-signature/37173256#37173256", "title": "C function pointers assigned to functions with a different signature", "body": "<p>Your code not only has undefined behavior it also contains a deprecated feature.</p>\n\n<p>6.7.5.3/14</p>\n\n<blockquote>\n  <p>An identifier list declares only the identifiers of the parameters of\n  the function. An empty list in a function declarator that is part of a\n  definition of that function specifies that the function has no\n  parameters. The empty list in a function declarator that is not part\n  of a definition of that function specifies that no information about\n  the number or types of the parameters is supplied.</p>\n</blockquote>\n\n<p>Notice the difference. <code>void f();</code> is a declarator without a definition. <code>void f() {}</code> is a declarator with a definition.</p>\n\n<p>6.5.2.2/2:</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that\n  includes a prototype, the number of arguments shall agree with the\n  number of parameters. Each argument shall have a type such that its\n  value may be assigned to an object with the unqualified version of the\n  type of its corresponding parameter.</p>\n</blockquote>\n\n<p>6.11.6</p>\n\n<blockquote>\n  <p>The use of function declarators with empty parentheses (not\n  prototype-format parameter type declarators) is an obsolescent\n  feature.</p>\n</blockquote>\n\n<p>It's true that <code>void f()</code> and <code>void f(void)</code> are compatible types, but since <code>f()</code> defines a function that takes no parameters, calling it with parameters is undefined behavior.</p>\n\n<hr />\n\n<p>OK enough pedantry, so what actually happens? There is no name mangling in C, so the linker only sees the name of the function. GCC and Clang both emit code that call the functions in the exactly the same way. They push the pointer to the function onto the stack, the argument (the \"test\" string) then they call it. Nothing fishy really happens here. Here's what I get with <code>objdump</code>:</p>\n\n<pre><code>00000000004006b3 &lt;callback_2&gt;:\n  ...\n</code></pre>\n\n<p>I only included this to show the address of <code>callback_2</code>. The address in this example for <code>callback_1</code> is 400686.</p>\n\n<p>First some general stack stuff:</p>\n\n<pre><code>  4006c4:   55                      push   rbp\n  4006c5:   48 89 e5                mov    rbp,rsp\n  4006c8:   48 83 ec 10             sub    rsp,0x10\n</code></pre>\n\n<p>We store the address of <code>callback_one</code>:</p>\n\n<pre><code>  4006cc:   48 c7 45 f8 86 06 40    mov    QWORD PTR [rbp-0x8],0x400686\n  4006d3:   00\n  4006d4:   48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]\n</code></pre>\n\n<p>Then our \"test\" string. Using <code>objdump -s -j .rodata</code> shows that the address of our string is at index 7, address 4007b0. </p>\n\n<pre><code> 4007b0 73207573 65640074 65737400           s used.test. \n                                             1234567\n</code></pre>\n\n<p>4007b0 + 7 is 4007b7.</p>\n\n<pre><code>  4006d8:   bf b7 07 40 00          mov    edi,0x4007b7\n</code></pre>\n\n<p>Call <code>callback_one</code>:</p>\n\n<pre><code>  4006dd:   ff d0                   call   rax\n</code></pre>\n\n<p>Repeat for <code>callback_two</code>:</p>\n\n<pre><code>  4006df:   48 c7 45 f8 b3 06 40    mov    QWORD PTR [rbp-0x8],0x4006b3\n  4006e6:   00 \n  4006e7:   48 8b 45 f8             mov    rax,QWORD PTR [rbp-0x8]\n  4006eb:   bf b7 07 40 00          mov    edi,0x4007b7\n  4006f0:   ff d0                   call   rax\n</code></pre>\n\n<hr />\n\n<p>So why didn't you get any warning? Well, technically you're not violating any rules of the language. And undefined behavior is not required to be diagnosable. The moral of the story is: if you think code needs a warning, don't write it. But C is a tricky language. So long as you know the language, the caveats and what exactly your compiler is doing you should be fine.</p>\n"}], "owner": {"reputation": 599, "user_id": 721242, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3832bcc4b566196e67c5ca98ec1bdda1?s=128&d=identicon&r=PG", "display_name": "superlou", "link": "https://stackoverflow.com/users/721242/superlou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "accepted_answer_id": 37172644, "answer_count": 2, "score": 4, "last_activity_date": 1463076374, "creation_date": 1462998106, "question_id": 37172579, "link": "https://stackoverflow.com/questions/37172579/c-function-pointers-assigned-to-functions-with-a-different-signature", "title": "C function pointers assigned to functions with a different signature", "body": "<p>In some library code, there's a pattern of setting up callbacks for events, where the callback may receive an argument.  The callback itself may not do anything with the argument, or the argument might be <code>0</code>, but it is passed.  Decomposing it down to the basics, it looks like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid callback_1(char *data) {\n  printf(\"Length of data: %d\\n\", strlen(data));\n}\n\nvoid callback_2() {\n  printf(\"No parameters used\\n\");\n}\n\ntypedef void (*Callback)(char *);\n\nint main(void) {\n    Callback callback;\n\n    callback = callback_1;\n    callback(\"test\");\n\n    callback = callback_2;\n    callback(\"test\");\n\n    return 0;\n}\n</code></pre>\n\n<p>This compiles and runs on GCC 4.9.3 (32-bit) without anything unexpected.</p>\n\n<p>A good callback function has a signature like callback_1, but occasionally I forget the <code>data</code> parameter if it's not being used.  While I'm aware that C isn't always typesafe (especially with regards to void pointers), I expected a warning, since if I had provided a mismatched parameter, e.g. <code>int data</code>, I would receive a warning about incompatible types.  If the typedef for <code>Callback</code> didn't accept a parameter, I would receive a compilation error if a callback function had one in the signature.</p>\n\n<p>Is there a way in C to get a warning for the case where a function pointer is assigned to a function where the signature is missing an argument?  What happens on the stack if the callback is missing the parameter?  Are there possible repercussions of missing the parameter in the callback?</p>\n"}, {"tags": ["c", "arrays", "string", "pointers", "char"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1462996145, "post_id": 37172011, "comment_id": 61878690, "body": "google <i>string literals</i>"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1462996426, "post_id": 37172011, "comment_id": 61878861, "body": "Not relevant here but I have read somewhere that two variables pointing to the same string literal might share the same memory. Changing one may change the other too.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462996733, "post_id": 37172011, "comment_id": 61879043, "body": "Please post the <i>actual</i> code as a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. Obviously this was not your code - if it does not compile it cannot produce a segfault."}], "answers": [{"tags": [], "owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "is_accepted": true, "score": 0, "last_activity_date": 1462997356, "creation_date": 1462997356, "answer_id": 37172362, "question_id": 37172011, "link": "https://stackoverflow.com/questions/37172011/changing-strings-in-array-of-char-pointers/37172362#37172362", "title": "changing strings in array of char pointers", "body": "<p>The difference is:</p>\n\n<p><code>names1</code> is declared simply as an array of string pointers without other defined characteristics. Using string literals here will put the string literals into a section in your executable file which is <strong>read-only</strong>, because the compiler can this way re-use them. For example, when you use <code>char* a = \"abc\"; char* b = \"abc\";</code> then most likely <code>a</code> and <code>b</code> will have equal memory addresses as values. This means you can't modify them, so you get a \"Segmentation fault\" (another name for the same error is \"Access Violation\").</p>\n\n<p><code>names2</code> is declared as an array of arrays of chars. Assigning a string literal there will copy the data of the strings into the array, and since there is no <code>const</code> thing in play in your code, the array has to be mutable, so in turn your strings stored in the char arrays are mutable as well.</p>\n"}], "owner": {"reputation": 3, "user_id": 6322186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8835d3a61c66f2a473d67fdda63d08e?s=128&d=identicon&r=PG&f=1", "display_name": "ofjoao", "link": "https://stackoverflow.com/users/6322186/ofjoao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1463025293, "accepted_answer_id": 37172362, "answer_count": 1, "score": -4, "last_activity_date": 1462997356, "creation_date": 1462996084, "last_edit_date": 1462996602, "question_id": 37172011, "link": "https://stackoverflow.com/questions/37172011/changing-strings-in-array-of-char-pointers", "closed_reason": "Not suitable for this site", "title": "changing strings in array of char pointers", "body": "<p>I have this two arrays, codeblocks doesn't give me any build error but whenever I run it, it gives \"Segmention fault\" and it shuts the program down I've debugged it and found out I can't change values from <em>names1</em> this way but changing <em>names2</em> this way works just fine, is there a way to make this work? If yes how do I make <em>troca</em> work for <em>names1</em>?</p>\n\n<pre><code>void troca(char* frase){\n    unsigned i=0;\n    while(*(frase+i)!='\\0') {\n        if(*(frase+i)=='O') {\n            *(frase+i)='0';\n        }\n    i++;\n    }\n}\n\nint main(){\n    char *names1[]={\"JOAO\",\"MANUEL\",\"ROBERTO\",\"ZE\"};\n    char names2[][51]={\"JOAO\",\"MANUEL\",\"ROBERTO\",\"ZE\"};\n    unsigned i;\n    for(i=0;i&lt;4;i++) {\n        troca(names2[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "types", "incomplete-type"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1462996164, "post_id": 37171979, "comment_id": 61878704, "body": "If you typedef <code>struct tcpsock tcpsock_t</code>, what does it mean when you declare a variable as <code>struct tcpsock_t</code>?  <code>tcpsock_t</code> is what you need."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462996202, "post_id": 37171979, "comment_id": 61878732, "body": "You <code>typedef</code>ed <code>tcpsock_t</code> so change the faulty member to <code>tcpsock_t socket;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "reply_to_user": {"reputation": 33, "user_id": 6322250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe90fa0f8a3ab457c8829390b52386d?s=128&d=identicon&r=PG&f=1", "display_name": "Tibo", "link": "https://stackoverflow.com/users/6322250/tibo"}, "edited": false, "score": 0, "creation_date": 1462996934, "post_id": 37172028, "comment_id": 61879153, "body": "@Tibo You&#39;re welcome. I think you can mark this question as solved then ;-)"}], "tags": [], "owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "is_accepted": true, "score": 8, "last_activity_date": 1462996144, "creation_date": 1462996144, "answer_id": 37172028, "question_id": 37171979, "link": "https://stackoverflow.com/questions/37171979/field-has-incomplete-type-error/37172028#37172028", "title": "Field has incomplete type error", "body": "<p><code>typedef struct tcpsock tcpsock_t;</code> defines <code>tcpsock_t</code> as a <code>struct tcpsock</code>. Hence, your struct definition must look like this:</p>\n\n<pre><code>struct conn{\n   tcpsock_t socket;\n   long last_active;\n};\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6322250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe90fa0f8a3ab457c8829390b52386d?s=128&d=identicon&r=PG&f=1", "display_name": "Tibo", "link": "https://stackoverflow.com/users/6322250/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5342, "favorite_count": 0, "accepted_answer_id": 37172028, "answer_count": 1, "score": 0, "last_activity_date": 1462996202, "creation_date": 1462995989, "question_id": 37171979, "link": "https://stackoverflow.com/questions/37171979/field-has-incomplete-type-error", "title": "Field has incomplete type error", "body": "<p>In my C-code I've got a tcpsock.c and tcpsock.h file. The tpcsock.c file include's the tcpsock.h file. This socketcode is used in a connmgr.c (which includes tcpsock.c).\nIn the C file I've got two structs, which are defined as follows:</p>\n\n<pre><code>struct tcpsock{\n   long cookie;\n   int sd;\n   char * ip_addr;\n   int port;\n};\n\nstruct conn{\n   struct tcpsock_t socket;\n   long last_active;\n};\n</code></pre>\n\n<p>In the header file I have the following code:</p>\n\n<pre><code>typedef struct tcpsock tcpsock_t;\ntypedef struct conn conn_t;\n</code></pre>\n\n<p>When I try to compile this, I'm getting the following error:</p>\n\n<pre><code>In file included from connmgr.c:12:0:\nlib/tcpsock.c:78:22: error: field \u2018socket\u2019 has incomplete type\nstruct tcpsock_t socket;\n                 ^\n</code></pre>\n\n<p>I've been searching everywhere but wasn't able to find a solution, so I hope anyone here can help me.\nThanks in advance!</p>\n"}, {"tags": ["c", "assembly", "reverse-engineering"], "answers": [{"tags": [], "owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "is_accepted": false, "score": 0, "last_activity_date": 1462996258, "creation_date": 1462996258, "answer_id": 37172055, "question_id": 37171956, "link": "https://stackoverflow.com/questions/37171956/data-types-in-struct-when-reverse-engineering/37172055#37172055", "title": "Data types in struct when reverse engineering", "body": "<p>Since this is about 32-bit, <code>ULONG</code> is the same as <code>UINT</code>. And it has to be unsigned because it's about the size/amount of something, which can't be negative.</p>\n\n<p>Note that many other structures and functions use <code>DWORD</code> for such values (number of element, etc.), but it's also defined as unsigned integer just like <code>ULONG</code> and <code>UINT</code> - their differences in usage are historical (16-bit era, etc.).</p>\n"}], "owner": {"reputation": 33, "user_id": 6322190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/486a9dc8b7f0be25e9872d0e80e2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vladmere", "link": "https://stackoverflow.com/users/6322190/vladmere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1462996258, "creation_date": 1462995906, "last_edit_date": 1462996102, "question_id": 37171956, "link": "https://stackoverflow.com/questions/37171956/data-types-in-struct-when-reverse-engineering", "title": "Data types in struct when reverse engineering", "body": "<p>In the book Reversing: Secrets of Reverse Engineering on pg 152 he is working through reversing some Windows API and we have figured out that the struct looks like this</p>\n\n<pre><code>struct TABLE\n{\nUNKNOWN Member1;\nUNKNOWN_PTR Member2;\nUNKNOWN_PTR Member3;\nUNKNOWN_PTR Member4;\nUNKNOWN Member5;\nUNKNOWN Member6;\nUNKNOWN Member7;\nUNKNOWN Member8;\nUNKNOWN Member9;\nUNKNOWN Member10;\n};\n</code></pre>\n\n<p>I followed how he got to this point, and then he looks at another function in the API and provides this bit</p>\n\n<blockquote>\n  <p>Let\u2019s proceed to investigate what is hopefully a simple function: RtlNumberGenericTableElements. The idea is that if the root data structure has a\n  member that represents the total number of elements in the table, this function\n  would expose it. If not, this function would iterate through all the elements\n  and just count them while doing that. The following is the OllyDbg output for\n  RtlNumberGenericTableElements.</p>\n</blockquote>\n\n<pre><code>RtlNumberGenericTableElements:\n7C923FD2 PUSH EBP\n7C923FD3 MOV EBP,ESP\n7C923FD5 MOV EAX,DWORD PTR [EBP+8]\n7C923FD8 MOV EAX,DWORD PTR [EAX+14]\n7C923FDB POP EBP\n7C923FDC RET 4\n</code></pre>\n\n<blockquote>\n  <p>Well, it seems that the question has been answered. This function simply\n  takes a pointer to what one can only assume is the same structure as before,\n  and returns whatever is in offset +14. Clearly, offset +14 contains the number\n  of elements in a generic table data structure. Let\u2019s update the definition of the TABLE structure.</p>\n</blockquote>\n\n<p>with only that function returning the number of elements in the table, he updates the structure to how it is below.</p>\n\n<pre><code>struct TABLE\n{\nUNKNOWN     Member1;\nUNKNOWN_PTR Member2;\nUNKNOWN_PTR Member3;\nUNKNOWN_PTR Member4;\nUNKNOWN     Member5;\nULONG       NumberOfElements;\nUNKNOWN     Member7;\nUNKNOWN     Member8;\nUNKNOWN     Member9;\nUNKNOWN     Member10;\n};\n</code></pre>\n\n<p>Notice all he does is update Member6 to be of type ULONG and call it NumberOfElements, obviously the member contains some sort of int to contain the number of elements of the table, but how does he know from this that it is a ULONG? could it not also be a UINT or INT or is he just making some assumptions</p>\n"}, {"tags": ["c", "debugging", "segmentation-fault"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1462996151, "post_id": 37171935, "comment_id": 61878693, "body": "<code>chunks = malloc(sizeof(chunks));</code> --&gt; <code>chunks = malloc(sizeof(*chunks));</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1462996380, "post_id": 37171935, "comment_id": 61878832, "body": "Also <code>chunks[i].argv[0] = malloc( strlen(token) * sizeof(char *) + 1 );</code> : memory leak"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1462996109, "creation_date": 1462996109, "answer_id": 37172018, "question_id": 37171935, "link": "https://stackoverflow.com/questions/37171935/how-can-i-debug-this-segmentation-fault/37172018#37172018", "title": "How can I debug this segmentation fault?", "body": "<p>This line</p>\n\n<pre><code>chunks = malloc(sizeof(chunks));\n</code></pre>\n\n<p>That allocates the size of the <code>chunks</code> variable, which is a pointer and is usually only 4 or 8 bytes large (depending on if you're on a 32 or 64 bit system).</p>\n\n<p>A <code>str_list</code> structure is larger than that, which means you will write out of bounds of allocated memory, leading to <em>undefined behavior</em> and most likely a crash.</p>\n\n<p>You seem to be using two of this structure, judging by the loops, which means you need to allocate two <em>full</em> <code>str_list</code> structures, which is simplest done by e.g.</p>\n\n<pre><code>chunks = malloc(2 * sizeof *chunks);\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 4853347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02479a29ee587deff71e6962a7e55709?s=128&d=identicon&r=PG&f=1", "display_name": "Montao", "link": "https://stackoverflow.com/users/4853347/montao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37172018, "answer_count": 1, "score": 0, "last_activity_date": 1462996109, "creation_date": 1462995863, "question_id": 37171935, "link": "https://stackoverflow.com/questions/37171935/how-can-i-debug-this-segmentation-fault", "title": "How can I debug this segmentation fault?", "body": "<p>I get a segfault the second time this statement runs:</p>\n\n<p><code>chunks[i].argv[0] = malloc( strlen(token) * sizeof(char *) + 1 );</code></p>\n\n<p>The code in context is:</p>\n\n<pre><code>/* TODO: modify str_split to do the copying of its input string if it needs to (e.g. if it uses strtok on it), and return a struct that has the number of \"chunks\" it split out and the list of chunks. */\nstruct str_list *list_split(char *a_str, const char a_delim) {\n    char **result = 0;\n    char **result2 = 0;\n\n    size_t count = 0;\n    char *tmp = a_str;\n    char *last_comma = 0;\n\n    size_t count2 = 0;\n    char *tmp2 = a_str;\n    char *last_space = 0;\n\n    char delim[2];\n    delim[0] = a_delim;\n    delim[1] = 0;\n    struct str_list *chunks = NULL;\n    /* Count how many elements will be extracted. */\n    while (*tmp) {\n        if (a_delim == *tmp) {\n            count++;\n            last_comma = tmp;\n        }\n        tmp++;\n    }\n\n    /* Add space for trailing token. */\n    count += last_comma &lt; (a_str + strlen(a_str) - 1);\n\n    /* Add space for terminating null string so caller\n       knows where the list of returned strings ends. */\n    count++;\n\n    result = malloc(sizeof(char *) * count);\n    chunks = malloc(sizeof(chunks));\n\n    //chunks.size = malloc(sizeof(int));\n   // counter = (int) count + 1;\n    //chunks-&gt;size = counter;\n\n    if (result == NULL) {\n        printf(\"Error allocating memory!\\n\"); //print an error message\n        return chunks;; //return with failure\n    }\n\n    if (result) {\n        size_t idx = 0;\n        char *token = strtok(a_str, delim);\n        int i = 0;\n        while (token) {\n            assert(idx &lt; count);\n            *(result + idx++) = strdup(token); /* memory leak! how to free() */;\n            token = strtok(0, delim);;\n        }\n        assert(idx == count - 1);\n        *(result + idx) = 0;\n    }\n\n    chunks-&gt;size = (int) count;\n    chunks-&gt;argv = alloc_argv((unsigned) chunks-&gt;size);\n\n    for (int i = 0; i &lt; 2; i++) { //count is wrong\n        while (*tmp2) {\n            if (' ' == *tmp2) {\n                count2++;\n                last_space = tmp2;\n            }\n            tmp2++;\n        }\n\n        char* token = strtok(result[i], \" \");\n        while (token) {\n            printf(\"token: %s\\n\", token);\n            printf(\"size: %d\\n\", chunks-&gt;size);\n            printf(\"result: %s\\n\", result[i]);\n            printf(\"i: %d\\n\", i);\n            chunks[i].argv[0] = malloc( strlen(token) * sizeof(char *) + 1 );\n            chunks[i].argv[0] = strdup(token);;\n            token = strtok(0, \" \");\n        }\n\n    }\n\n    return chunks;\n}\n</code></pre>\n\n<p>My debugger says nothing interesting. Can you see what is wrong and what should be done? The call to the above function is:</p>\n\n<pre><code>int run_cmd(const char *cmd) {\n    struct str_list *chunks = list_split(cmd, '|');\n    struct pipeline *pipe = alloc_pipeline(2); //size is the number of pipelines\n    for (int i = 0; i &lt; 2; i++) {\n        printf(\"i %d\", i);\n        for (int j = 0; j &lt; 1; j++) {\n            pipe[i].data[j] = chunks[i].argv[j];\n        }\n    }\n    int status = execute_pipeline(pipe);\n    // free_pipeline(pipe);\n    // free_str_list(chunks);\n    return status;\n}\n</code></pre>\n\n<p>The definition of my structs is</p>\n\n<pre><code>struct str_list {\n    char *name;\n    int size;\n    char **argv;\n\n};\nstruct pipeline {\n    char *name;\n    int size;\n    char **data;\n};\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor"], "answers": [{"comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1462996652, "post_id": 37171794, "comment_id": 61878995, "body": "Nice! Maybe try to include an explanation of why your solution works, while the first one doesn&#39;t"}], "tags": [], "owner": {"reputation": 1, "user_id": 6322120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0617cacd47f23086b6d7b6ec4fa37b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Z. Denys", "link": "https://stackoverflow.com/users/6322120/z-denys"}, "is_accepted": false, "score": 0, "last_activity_date": 1462996435, "last_edit_date": 1462996435, "creation_date": 1462995227, "answer_id": 37171794, "question_id": 37171450, "link": "https://stackoverflow.com/questions/37171450/right-order-define-macro-in-c-c/37171794#37171794", "title": "Right order #define macro in C/C++", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n\n#define TEST variable\n#define makeStr(x) #x\n#define makeString(x) makeStr(x)\n\nint main(int argc, char *argv[]) {\n    char TEST[] = makeString(TEST);\n    printf(\"%s    %s\\n\", TEST, makeString(TEST));\n    return 0;\n}\n</code></pre>\n\n<p>this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 6322120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0617cacd47f23086b6d7b6ec4fa37b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Z. Denys", "link": "https://stackoverflow.com/users/6322120/z-denys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "closed_date": 1462996707, "answer_count": 1, "score": 0, "last_activity_date": 1464074431, "creation_date": 1462994018, "last_edit_date": 1464074431, "question_id": 37171450, "link": "https://stackoverflow.com/questions/37171450/right-order-define-macro-in-c-c", "closed_reason": "Duplicate", "title": "Right order #define macro in C/C++", "body": "<p>I try save variable name like this:</p>\n\n<pre><code>#define TEST someVariable\n#define makeString(x) #x\n\nint main(int argc, char *argv[])\n{\n    char TEST[] = makeString(TEST);\n    printf(\"%s    %s\\n\", TEST, makeString(TEST));\n    return 0;\n}\n</code></pre>\n\n<p>Output is :</p>\n\n<pre><code>appden4ik@appDen4ik:/opt/preprocessor/Debug$ ./preprocessor \nTEST    TEST'\n</code></pre>\n\n<p>I want next output:</p>\n\n<pre><code>someVariable      someVariable\n</code></pre>\n\n<p>Where I am wrong?</p>\n"}, {"tags": ["c", "arrays", "for-loop", "char", "scanf"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1462994162, "post_id": 37171421, "comment_id": 61877597, "body": "You&#39;re scanfing to an unallocated object <code>stdnames[count]</code>. Perhaps try allocating some memory there first with say <code>malloc</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462994689, "post_id": 37171421, "comment_id": 61877876, "body": "You might also run into trouble with <code>float marks[50];</code> when you have <code>char *stdnames[100];</code> although the loop that inputs marks is a bit obfuscated."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462994995, "post_id": 37171421, "comment_id": 61878053, "body": "There is no &quot;char array&quot;. You mean that array of pointers to <code>char</code>?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1462996122, "post_id": 37171421, "comment_id": 61878673, "body": "@arvind-dexter-thillainathan : consider including the definition for <code>getres(marks,totalNames)</code> in the code."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462995034, "post_id": 37171520, "comment_id": 61878073, "body": "That boldfaces hurts in the eyes. And <code>sizeof(char)</code> is useless, as it will never yield something other than <code>1</code>."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462995100, "post_id": 37171520, "comment_id": 61878109, "body": "@Olaf : Hurted mine too. changed :D"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462995196, "post_id": 37171520, "comment_id": 61878158, "body": "Thanks (still it is a bit too loud for me, but I can stand that - have to read Word-Docs and PPT anyway). There are other issues with the contents."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462996547, "post_id": 37171520, "comment_id": 61878937, "body": "Ehm, that would be correct (and independent of the type), but actually I wonder why not just remove that term?"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463065364, "post_id": 37171520, "comment_id": 61914136, "body": "@sjsam thanks man, it worked perfectly. I just started C. What&#39;s the exact purpose of malloc ?"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463065488, "post_id": 37171520, "comment_id": 61914213, "body": "also when i type &quot;Robert Lang&quot; with a space it skips one turn. I know scanf cant accept space, but how do you counter it ?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463065556, "post_id": 37171520, "comment_id": 61914266, "body": "@ArvindDexterThillainathan : . <code>malloc</code> is used for allocating memory. If you&#39;re a beginner, consider reading Stephen Prata&#39;s C Primer Plus. It is a great book to start C with. Latest edition is 6"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463065697, "post_id": 37171520, "comment_id": 61914369, "body": "@ArvindDexterThillainathan : scanf normally reads the input upto the first white space, that is why it accepts &quot;Robert&quot; rejects &quot;Lang&quot; :D. Use <code>fgets</code> instead.."}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463065764, "post_id": 37171520, "comment_id": 61914417, "body": "Done. Thanks man. But when you declare an array won&#39;t it allocate memory ? why use malloc ?   sure, i will read that book."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1463066148, "post_id": 37171520, "comment_id": 61914695, "body": "You declared an array of pointers actually. Had it been <code>char stdnames[100]</code>, the story would have been different.  Follow the book I have suggested, you will understand the difference between <code>char stdnames[100]</code> &amp; <code>char* stdnames[100]</code> Also when posting questions, do your homework thoroughly. Otherwise you may get an influx of downvotes which can become embarrassing. If the questions are clear and they prove your effort Stack Overflow  will be a great place to learn :D"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463067321, "post_id": 37171520, "comment_id": 61915502, "body": "sure, thanks man. one more help please. if i use i use fgets instead of scanf, what changes should i make ?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1463067577, "post_id": 37171520, "comment_id": 61915693, "body": "Instead of <code>scanf(&quot;%s&quot;,stdnames[count]);</code> use <code>fgets(stdnames[count],100,stdin)</code>. Here 100 is the I have used in <code>malloc</code>. For more information see <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow noreferrer\">fgets manual</a>"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463068704, "post_id": 37171520, "comment_id": 61916554, "body": "You are good man. It works. but when i use fputs(stdnames[i],stdout) it does not print the whole name. it prints the name after the whitespace. why is that ? thank you."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463077666, "post_id": 37171520, "comment_id": 61921986, "body": "@ArvindDexterThillainathan : That seems weird !"}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463315629, "post_id": 37171520, "comment_id": 62005488, "body": "@sjsam that book you recommended is amazing. can u recommend me a book for python ?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463315684, "post_id": 37171520, "comment_id": 62005499, "body": "@ArvindDexterThillainathan : I have never done python programming in my life, so not in a position to recommend one :("}, {"owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463315778, "post_id": 37171520, "comment_id": 62005545, "body": "@sjsam oh okay. any other programming language book you could recommend ? like C++ or ruby ?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "edited": false, "score": 0, "creation_date": 1463315916, "post_id": 37171520, "comment_id": 62005587, "body": "@ArvindDexterThillainathan : For C++ Stephen Prata has written one called C++ Primer Plus. Though I have never read it, I guess it should be good. &amp; I have never done any ruby stuff :( sorry"}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": true, "score": 1, "last_activity_date": 1463016567, "last_edit_date": 1463016567, "creation_date": 1462994283, "answer_id": 37171520, "question_id": 37171421, "link": "https://stackoverflow.com/questions/37171421/i-can-not-input-the-names-into-the-char-array-using-scanf/37171520#37171520", "title": "I can not input the names into the char array using scanf", "body": "<p>By</p>\n\n<pre><code>char *stdnames[100];\n</code></pre>\n\n<p>you got an array of (pointers to char). <br></p>\n\n<p>The NEXT BIG QUESTION  is</p>\n\n<p>Who will allocate memory for each of these pointers?</p>\n\n<p>A small answer would be - You have to do it yourself like below :<br></p>\n\n<pre><code>stdnames[count]=malloc(100*sizeof(char)); // You may replace 100 with desired size\n</code></pre>\n\n<p>or </p>\n\n<pre><code>stdnames[count]=malloc(100); // sizeof(char) is almost always 1\n</code></pre>\n\n<p>You need to put this line before the <code>scanf</code> statement. <br></p>\n\n<p><strong>Note:</strong> Don't forget to free the allocated memory once these variables become irrelevant. Do it like :</p>\n\n<pre><code>free(stdnames[count]);\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5914822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201474868031745/picture?type=large", "display_name": "Arvind Dexter Thillainathan", "link": "https://stackoverflow.com/users/5914822/arvind-dexter-thillainathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 37171520, "answer_count": 1, "score": -3, "last_activity_date": 1463016567, "creation_date": 1462993921, "question_id": 37171421, "link": "https://stackoverflow.com/questions/37171421/i-can-not-input-the-names-into-the-char-array-using-scanf", "title": "I can not input the names into the char array using scanf", "body": "<p>I can not use scanf to enter a name in stdnames array.\n     when compiled it had no error , but as soon as i enter a name and \n    then press enter to write the other name it gives an error and shuts the program.\n    How should I go about it ? </p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n  float marks[50];\n  /*char *stdnames[100]={\"Arvind Thillainathan\",\"Robert Lang\"};*/\n //I want to stores names like the above one\n  char *stdnames[100];\n  int totalNames = 0;\n  int i = 0, w=0,h=0;\n\n printf(\"How many names do you want to enter ??\\n\");\n scanf(\"%d\",&amp;totalNames);\n assert(totalNames != 0);\n\n for(int count = 0; count &lt; totalNames; count++)\n {\n     printf(\"Enter name of student\\n\");\n     scanf(\"%s\",stdnames[count]);\n //From here the problem starts\n }\n getres(marks,totalNames);\n\n for(i = 0; i &lt; totalNames; i++) \n      {\n        int v = 1;\n        printf(\"\\n\");\n        printf(\"IELTS Marks of %s\\n\\n\",stdnames[i]);\n        for(h = w; h &lt; w+5; h++)\n           {\n            if(v==1)\n            {\n                printf(\"Listening : %0.1f\\n\", marks[h]);\n            }\n            else if(v==2)\n            {\n                printf(\"Reading   : %0.1f\\n\", marks[h]);    \n            }\n            else if(v==3)\n            {\n                printf(\"Writing   : %0.1f\\n\", marks[h]);    \n            }\n            else if(v==4)\n            {\n                printf(\"Speaking  : %0.1f\\n\", marks[h]);    \n            }\n            else\n            {\n                printf(\"Overall   : %0.1f\\n\\n\", marks[h]);\n            }\n            v++;\n            //if(h==10)\n            //{\n            //  break;\n            //}\n        }\n        w+=5;\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "locking", "lock-free", "rtos"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462994917, "post_id": 37171286, "comment_id": 61878008, "body": "Why not use a recent C compiler which supports <code>stdatomics</code>? Or is there none?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462994938, "post_id": 37171286, "comment_id": 61878015, "body": "Before ARM had <code>LDREX</code>/<code>STREX</code>, it had <code>SWP[B]</code>. You can implement a C11-style <code>atomic_flag</code> with this instruction, but more complex lock-free algorithms won&#39;t be possible."}, {"owner": {"reputation": 7440, "user_id": 157344, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b403786b380b1b5a1ed25f144df103e6?s=128&d=identicon&r=PG", "display_name": "Freddie Chopin", "link": "https://stackoverflow.com/users/157344/freddie-chopin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462995325, "post_id": 37171286, "comment_id": 61878231, "body": "@Olaf - if the architecture doesn&#39;t support atomic operations, then the compiler also doesn&#39;t. In such case with GCC you get linking errors about undefined functions that implement std::atomic functionality."}, {"owner": {"reputation": 7440, "user_id": 157344, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b403786b380b1b5a1ed25f144df103e6?s=128&d=identicon&r=PG", "display_name": "Freddie Chopin", "link": "https://stackoverflow.com/users/157344/freddie-chopin"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462995444, "post_id": 37171286, "comment_id": 61878302, "body": "@EOF - ARMv6-M doesn&#39;t have SWP either..."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462995699, "post_id": 37171286, "comment_id": 61878442, "body": "@FreddieChopin: If you have a multiprocessor system without <code>LL&#47;SC</code> or atomic read-modify-write operations, the manufacturer is either incompetent or malicious. You&#39;d need a software mechanism for locking like Dekker&#39;s or Peterson&#39;s algorithm, which suck."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462996198, "post_id": 37171286, "comment_id": 61878729, "body": "@FreddieChopin:You ask if this is possible. I wrote, you should first check the standard-compliant way. Just becasue if that exists, there apparently is a way. If you negate there is a way from the start, then why do you ask at all?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462996273, "post_id": 37171286, "comment_id": 61878768, "body": "@EOF: ARMv6M is a (very much reduced) subset of ARMv7M. None of them has a <code>swp</code> instruction. It was designed as a direct competitor for AVR, PIC16, MSP430 and even 8051."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1462996405, "post_id": 37171286, "comment_id": 61878846, "body": "@FreddieChopin: The most simple (and sometimes even best) way is to <code>__disable_irq(); ... __enable_irq();</code> This is possibly even faster than the exclusive load/store approach if you have a high interrupt frequency - at the cost of slightly higher interrupt latency, of course."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462996591, "post_id": 37171286, "comment_id": 61878963, "body": "@Olaf: Disabling interrupts is not a valid way to ensure mutual exclusion or atomicity on a multiprocessor system."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462996754, "post_id": 37171286, "comment_id": 61879053, "body": "@EOF: Cortex-M0 systems are typically not UMA architectures in the Linux/etc. sense. Each core has its specific tasks, thus there is no concurrency between multiple such cores at application level, but through messages/signals, etc. Note that even the Cortex-M4 does not necessarily have global monitors for the <code>*EX</code>-instructions. Typically such systems communicate e.g. via a special mailbox peripheral (some HW-registers which ensure atomicity)."}, {"owner": {"reputation": 7440, "user_id": 157344, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b403786b380b1b5a1ed25f144df103e6?s=128&d=identicon&r=PG", "display_name": "Freddie Chopin", "link": "https://stackoverflow.com/users/157344/freddie-chopin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463003144, "post_id": 37171286, "comment_id": 61882277, "body": "@Olaf - if using std::atomics would be possible, I wouldn&#39;t be asking. atomics are <i>NOT</i> implemented in GCC for ARMv6-M, using std::atomic_flag gives stupid code (ldrb + strb), while using anything else results in linker error. Disabling interrupts in an RTOS is more complex than using these two functions - they may already be disabled and after this function they should be left in exactly the same state as before. That&#39;s why I was wondering whether there&#39;s some clever trick to do it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463009945, "post_id": 37171286, "comment_id": 61884536, "body": "@FreddieChopin: Well, as this is C, a different language than C++, apparently <code>std::</code> namespace and the related syntax is not available. Anyway, my crystal ball is currently in 100 predictions service, so I cannot see what you tried and what not. 5 years after C11 has been introduced, most people still don&#39;t know about stdatomics. As you apparently are not interested in constructive hints, but concentrate on what does not work, I&#39;ll leave it at that. Just that: I have developed such systems on CPUs, some of which don&#39;t support exclusive operations. Actually they are not available on most MCUs."}, {"owner": {"reputation": 7440, "user_id": 157344, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b403786b380b1b5a1ed25f144df103e6?s=128&d=identicon&r=PG", "display_name": "Freddie Chopin", "link": "https://stackoverflow.com/users/157344/freddie-chopin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463045652, "post_id": 37171286, "comment_id": 61898910, "body": "@Olaf - couldn&#39;t we stick to the point? What does it matter if I&#39;m checking <code>&lt;atomic&gt;</code> or <code>&lt;stdatomic.h&gt;</code>? With <code>&lt;stdatomic.h&gt;</code>, <code>atomic_flag</code> object and C-only source I get still get pointless code for ARMv6-M (<code>ldr</code> followed by <code>strb</code> and nothing more), which is exactly the same as with <code>&lt;atomic&gt;</code> and <code>std::atomic_flag</code>, so please - believe me that in C11 or in C++11 atomics are <i>NOT</i> implemented for this architecture. That&#39;s why I&#39;m not asking about use of atomic headers but for some clever programming trick (or info that there&#39;s no such thing)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463052157, "post_id": 37171286, "comment_id": 61903568, "body": "It was not me to deviate from the subject. It is you constantly using C++ features for your own <b><a href=\"https://stackoverflow.com/questions/tagged/c\">c</a></b> question. Read my last comment again and try to get my major point. You also should read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "owner": {"reputation": 7440, "user_id": 157344, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b403786b380b1b5a1ed25f144df103e6?s=128&d=identicon&r=PG", "display_name": "Freddie Chopin", "link": "https://stackoverflow.com/users/157344/freddie-chopin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 508, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1462993451, "creation_date": 1462993451, "question_id": 37171286, "link": "https://stackoverflow.com/questions/37171286/lock-free-flag-without-atomic-operations", "title": "Lock-free flag without atomic operations", "body": "<p>I'm writing an RTOS for microcontrollers ( <a href=\"http://distortos.org/\" rel=\"nofollow\">http://distortos.org/</a> ) that has to run on - amongst others - ARMv6-M architecture - which has no support for atomic operations - it has no <code>LDREX</code>/<code>STREX</code> assmebly instructions.</p>\n\n<p>I'm wondering is there any clever trick that would allow me to have a very simple lock-free shared flag? Something that could be tested-and-set by only one thread until cleared. Something along these lines:</p>\n\n<pre><code>bool lockFreeFlag;\n\nvoid serializedFunction()\n{\n    if (lockFreeFlag == true)\n        return;\n\n    lockFreeFlag = true;\n    // initialize something\n}\n\nvoid anotherThread()\n{\n    while (1)\n    {\n        if (lockFreeFlag == true)\n        {\n            // do something\n            lockFreeFlag = false;\n        }\n    }\n}\n</code></pre>\n\n<p>In this naive code when multiple threads call <code>serializedFunction()</code> then there's a race condition (thread can be preempted after the check but before setting the flag).</p>\n\n<p>Maybe it's somehow possible by using two (or more) variables or an integer(s) or something else? I don't need any synchronization or waiting, the check can fail spuriously, etc. I just need to allow only one thread to enter the function until some processing is finished in which case next call to this function will succeed. I would like to avoid some \"standard\" forms of locking (in this case masking interrupts to disable preemption) if that would be possible. It doesn't need to be a \"flag\", I would actually prefer that to be a pointer, but bool, integer or something else will also be fine.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 4, "creation_date": 1462993110, "post_id": 37171152, "comment_id": 61877045, "body": "Well, that depends on the capabilities of your terminal. You might need to select the correct locale settings."}, {"owner": {"reputation": 577, "user_id": 6067690, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-LSCKq-zNPDc/AAAAAAAAAAI/AAAAAAAAABU/oK_TUJ0GSmg/photo.jpg?sz=128", "display_name": "Istiyak", "link": "https://stackoverflow.com/users/6067690/istiyak"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1462993254, "post_id": 37171152, "comment_id": 61877115, "body": "How i will select correct locale settings for Terminal ? :)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1462993455, "post_id": 37171152, "comment_id": 61877239, "body": "There&#39;s no standard way, depends on OS mostly."}], "answers": [{"comments": [{"owner": {"reputation": 22854, "user_id": 2142994, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1bad25bebfae0b3f4bfd13b07f5d4f3b?s=128&d=identicon&r=PG", "display_name": "Ani Menon", "link": "https://stackoverflow.com/users/2142994/ani-menon"}, "reply_to_user": {"reputation": 577, "user_id": 6067690, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-LSCKq-zNPDc/AAAAAAAAAAI/AAAAAAAAABU/oK_TUJ0GSmg/photo.jpg?sz=128", "display_name": "Istiyak", "link": "https://stackoverflow.com/users/6067690/istiyak"}, "edited": false, "score": 0, "creation_date": 1463079647, "post_id": 37171664, "comment_id": 61923125, "body": "Good to know it helped :)"}], "tags": [], "owner": {"reputation": 22854, "user_id": 2142994, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1bad25bebfae0b3f4bfd13b07f5d4f3b?s=128&d=identicon&r=PG", "display_name": "Ani Menon", "link": "https://stackoverflow.com/users/2142994/ani-menon"}, "is_accepted": true, "score": 5, "last_activity_date": 1462995281, "last_edit_date": 1495535370, "creation_date": 1462994756, "answer_id": 37171664, "question_id": 37171152, "link": "https://stackoverflow.com/questions/37171152/is-it-possible-to-print-bengali-language-with-c-in-console/37171664#37171664", "title": "Is it possible to print Bengali language with C in console?", "body": "<p>To use a language &amp; display it is very much an OS dependent task and below are few generic possible ways to do it.</p>\n\n<p>On linux :</p>\n\n<ol>\n<li>Set <a href=\"https://wiki.archlinux.org/index.php/Locale\" rel=\"nofollow noreferrer\">Locale</a>,</li>\n</ol>\n\n<p>In your case it should be : <code>setlocale(LC_ALL, 'bn_IN.utf8');</code></p>\n\n<p>Refer : (<a href=\"http://www.linuxquestions.org/questions/linux-newbie-8/displaying-hindi-in-linux-command-prompt-terminal-4175448642/\" rel=\"nofollow noreferrer\">http://www.linuxquestions.org/questions/linux-newbie-8/displaying-hindi-in-linux-command-prompt-terminal-4175448642/</a>)</p>\n\n<ol start=\"2\">\n<li><p>Download appropriate font &amp; install in your system.\nCheck your : <code>cd /usr/share/fonts/</code> for the font.\nedit your .bashrc file and add your font like this:</p>\n\n<p><code>export LANG=bn_IN.UTF-8</code></p>\n\n<p>(Side effect your whole os may start using this font if it supports).</p></li>\n</ol>\n\n<p>On Windows :</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/247815\" rel=\"nofollow noreferrer\">Necessary criteria for fonts to be available in a command window</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/2638936/c-how-to-print-a-unicode-string-to-console\">How to print a unicode string to console?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/21751827/displaying-arabic-characters-in-c-sharp-console-application/21753872#21753872\">Refer</a></p>\n\n<p>Note : Your Terminal must support Unicode for any of this to work.</p>\n"}], "owner": {"reputation": 577, "user_id": 6067690, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-LSCKq-zNPDc/AAAAAAAAAAI/AAAAAAAAABU/oK_TUJ0GSmg/photo.jpg?sz=128", "display_name": "Istiyak", "link": "https://stackoverflow.com/users/6067690/istiyak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1954, "favorite_count": 1, "accepted_answer_id": 37171664, "answer_count": 1, "score": 2, "last_activity_date": 1462995281, "creation_date": 1462992959, "last_edit_date": 1462995137, "question_id": 37171152, "link": "https://stackoverflow.com/questions/37171152/is-it-possible-to-print-bengali-language-with-c-in-console", "title": "Is it possible to print Bengali language with C in console?", "body": "<p>Is it possible to print Bengali Language with C in console? If it can be done, how can I do it?</p>\n\n<p>I tried:</p>\n\n<pre><code>wprintf (L\"Character: %lc %lc \\n\", L'\u0988', 2440);\n</code></pre>\n\n<p>This does not work. It just shows an unknown symbol. What is the best formula for working with UTF-8 format data in console? If it is possible with C++, I want to know that.</p>\n"}, {"tags": ["c", "unix", "system-calls", "argv"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1462989703, "post_id": 37170126, "comment_id": 61875130, "body": "Infinite loop in the <code>while</code> loop?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1462989852, "post_id": 37170126, "comment_id": 61875222, "body": "wont&#39;t read return 0 when it&#39;ll reaches the end of file, terminating the loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1462989964, "post_id": 37170126, "comment_id": 61875304, "body": "Operator precedence: <code>while(lung = read(fd,buf,10)&gt;0)</code> -&gt; <code>while((lung = read(fd,buf,10))&gt;0)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1462990144, "post_id": 37170126, "comment_id": 61875422, "body": "Please check <code>argc</code> before using <code>argv</code> - it&#39;s so easy to forget to provide the necessary arguments. It should be <i>de rigueur</i> like many other checks."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462990321, "post_id": 37170126, "comment_id": 61875514, "body": "@GerardoZinno please don&#39;t correct errors commenters reveal, in the question. It makes the whole dialog look pointless."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "edited": false, "score": 1, "creation_date": 1462990345, "post_id": 37170126, "comment_id": 61875527, "body": "Problem Solved. Thank you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1462990512, "post_id": 37170126, "comment_id": 61875634, "body": "@WeatherVane the problem was in the while and the error is still there, I edited the post because I didn&#39;t see the edit to the answer of gsamaras and when I tried what he said the error was still there."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462991386, "post_id": 37170126, "comment_id": 61876070, "body": "Again:((  Why do devs continually write compound expressions?  They so often get them wrong:(   Please, please stop with the &#39;clever&#39; code!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462994177, "post_id": 37170126, "comment_id": 61877605, "body": "when compiling, always enable all the warnings, then fix those warnings."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462994239, "post_id": 37170126, "comment_id": 61877635, "body": "You mentioned in the question that all the headers are there, however; they are completely missing in the posted code.  Are you expecting us to guess as to which headers you included in the code?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462994339, "post_id": 37170126, "comment_id": 61877694, "body": "for ease of readability and understanding by us humans: 1) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a blank line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462994633, "post_id": 37170126, "comment_id": 61877847, "body": "when the code performs a &#39;sudden&#39; exit, do not let the OS fix things,  rather have the code cleanup after itself.  In this case, once the file is open, if suddenly exiting the program, be sure to call <code>close()</code> to cleanup before calling <code>exit()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462994716, "post_id": 37170126, "comment_id": 61877893, "body": "with a modern C compiler, there is no need to call <code>return</code> unless returning something other than 0"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "edited": false, "score": 0, "creation_date": 1462990074, "post_id": 37170255, "comment_id": 61875374, "body": "I just tried adding parenthesis but the result hasn&#39;t changed"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1462990114, "post_id": 37170255, "comment_id": 61875408, "body": "@GerardoZinno copy paste here your modified code. Did you see my edit?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "edited": false, "score": 1, "creation_date": 1462990229, "post_id": 37170255, "comment_id": 61875477, "body": "Sorry, I didn&#39;t see your edit. That was the problem. Thanks"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1462990355, "post_id": 37170255, "comment_id": 61875532, "body": "@GerardoZinno great. Also a good habit is to check for <code>argc</code>, but I know now that this wan&#39;t the problem, for sure. I remember when I had this error when I started programming, +1 by me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "edited": false, "score": 0, "creation_date": 1462990630, "post_id": 37170255, "comment_id": 61875701, "body": "I checked for argc, but I knew it was not the problem so I wrote here just the portion of code I knew had an error"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1462990729, "post_id": 37170255, "comment_id": 61875755, "body": "Bello @GerardoZinno!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1462989967, "creation_date": 1462989967, "answer_id": 37170255, "question_id": 37170126, "link": "https://stackoverflow.com/questions/37170126/program-doesnt-write-on-the-standard-output-and-gets-stuck-instead/37170255#37170255", "title": "Program doesn&#39;t write on the standard output and gets stuck instead", "body": "<p>Isn't that suspicious?</p>\n\n<pre><code>if(fd = open(argv[1], O_RDONLY)==-1) {\n</code></pre>\n\n<p>According to <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow\">operator precedence</a>, <code>==</code> will be executed before <code>=</code>.</p>\n\n<p>Then:</p>\n\n<pre><code>while(lung = read(fd,buf,10)&gt;0){\n</code></pre>\n\n<p>will similarly suffer from <code>&gt;</code> been executed before <code>=</code>.</p>\n\n<p>Tip: When in doubt, use parentheses! ;)</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "edited": false, "score": 0, "creation_date": 1462990702, "post_id": 37170360, "comment_id": 61875744, "body": "Thank you. That was the problem."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462995523, "post_id": 37170360, "comment_id": 61878352, "body": "little oops there:  this line: <code>while( (lung = (read(fd,buf,10)) &gt; 0 ) ){</code>  should really be: <code>while( (lung = read(fd,buf,10)) &gt; 0  ){</code>  so the assignment will be performed before the comparison as the comparison will then be the result of the assignment."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1462996465, "post_id": 37170360, "comment_id": 61878882, "body": "@user3629249, thanks for pointing out the error. it&#39;s fixed now."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1462996414, "last_edit_date": 1462996414, "creation_date": 1462990277, "answer_id": 37170360, "question_id": 37170126, "link": "https://stackoverflow.com/questions/37170126/program-doesnt-write-on-the-standard-output-and-gets-stuck-instead/37170360#37170360", "title": "Program doesn&#39;t write on the standard output and gets stuck instead", "body": "<pre><code>while(lung = read(fd,buf,10)&gt;0){\n    if( (write(1, buf, lung))==-1) perror(\"error\");\n}\n</code></pre>\n\n<p>is the same as (due to operator precedence ):</p>\n\n<pre><code>while(lung = (read(fd,buf,10)&gt;0) ){\n    if( (write(1, buf, lung))==-1) perror(\"error\");\n}\n</code></pre>\n\n<p>The value of <code>lung</code> will be either <code>1</code> or <code>0</code>. When it is <code>0</code>, the loop will break When it is <code>1</code>, only <code>1</code> character will be written to <code>stdout</code>.</p>\n\n<p>What you need is:</p>\n\n<pre><code>while( (lung = read(fd,buf,10)) &gt; 0 ){\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 37170255, "answer_count": 2, "score": 0, "last_activity_date": 1462996414, "creation_date": 1462989573, "last_edit_date": 1462990343, "question_id": 37170126, "link": "https://stackoverflow.com/questions/37170126/program-doesnt-write-on-the-standard-output-and-gets-stuck-instead", "title": "Program doesn&#39;t write on the standard output and gets stuck instead", "body": "<p>I'm writing this software that should open a file, that must be passed as an argument,  and write the content of the file on the standard output using the open and write system calls. (It's a bit like the <code>cat</code> command)</p>\n\n<p>The problem is that once I run the program as </p>\n\n<pre><code>./a.out /example/pattern/file\n</code></pre>\n\n<p>it writes on the standard output the pattern of the file and then it gets stuck, without writing anything or terminating, allowing me even to write on the terminal.</p>\n\n<p>I've tried using the ddd debugger, but I wasn't able to find the problem.</p>\n\n<p>All the necessary headers are included.</p>\n\n<pre><code>int main(int argc,char * argv[]){\n\n    printf(\"%s\\n\", argv[1]);\n    int fd, lung;\n    char buf[10];\n    if(fd = open(argv[1], O_RDONLY)==-1){\n        perror(\"argv[1], in apertura\");\n        exit(EXIT_FAILURE);\n    }\n    while(lung = read(fd,buf,10)&gt;0){\n        if( (write(1, buf, lung))==-1) perror(\"error\");\n    }\n    if (lung==-1) {perror(\"error\");exit(EXIT_FAILURE);}\n    fflush(NULL);\n    close(fd);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pthreads", "pipe"], "comments": [{"owner": {"reputation": 37, "user_id": 5618848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x2lbR.png?s=128&g=1", "display_name": "kevin556", "link": "https://stackoverflow.com/users/5618848/kevin556"}, "edited": false, "score": 0, "creation_date": 1462990226, "post_id": 37170117, "comment_id": 61875475, "body": "I guess it&#39;s because I use close() but I&#39;m not sure about it"}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1463022644, "last_edit_date": 1463022644, "creation_date": 1462990415, "answer_id": 37170391, "question_id": 37170117, "link": "https://stackoverflow.com/questions/37170117/pipe-not-working-through-pthread-t/37170391#37170391", "title": "pipe not working through pthread_t", "body": "<blockquote>\n  <p>I thought file descriptor were duplicated when thread are involved but it seems it's not the case here.</p>\n</blockquote>\n\n<p>No, that's not true.</p>\n\n<p>All threads within a process <em>share</em> those file descriptors (among other resources). Since, you close the write end of the pipe, your <code>write()</code> (done in the thread) fails.</p>\n\n<p>Threads of same process can <em>directly</em> communicate with each as they share the address space. For example, you could use a global variable for communication between threads (with appropriate synchronization) or you can <code>malloc()</code> some memory and <em>pass</em> it to the thread to send data.</p>\n\n<p>The kind of \"sharing\" you seem to be expecting is used between <em>processes</em> created by a common ancestor via <code>fork()</code>. When <em>forking</em> the file descriptors (among others) are duplicated  and you can one end in each process and communicate through the other end of the pipe. See here for simple examples: <a href=\"http://tldp.org/LDP/lpg/node11.html\" rel=\"nofollow\">Creating Pipes in C.</a></p>\n"}], "owner": {"reputation": 37, "user_id": 5618848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x2lbR.png?s=128&g=1", "display_name": "kevin556", "link": "https://stackoverflow.com/users/5618848/kevin556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 37170391, "answer_count": 1, "score": 0, "last_activity_date": 1463022644, "creation_date": 1462989546, "last_edit_date": 1495535295, "question_id": 37170117, "link": "https://stackoverflow.com/questions/37170117/pipe-not-working-through-pthread-t", "title": "pipe not working through pthread_t", "body": "<p>I'm now trying to send some data through a pipe between two thread (the main thread and a second one) but I get the errno 9 about the file descriptor.\nI thought file descriptor were duplicated when thread are involved but it seems it's not the case here.\nIt would normally return \"read from bf hi\" but it won't.\nCan you help me to resolve this issue ? \nThanks.\nHere is the code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n\npthread_mutex_t mutex;\nint tube[2];\n\nvoid * fonction(){\n    if(close(tube[0])==-1){\n        perror(\"close error \\n\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"son \\n\");\n    if(write(tube[1],\"hi\",2)&lt;0){\n        perror(\"write error \\n\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"errno %d \\n\",errno);\n    pthread_exit(NULL);\n}\n\nint main(){\n    pthread_t a;\n    if(pipe(tube)==-1){\n        perror(\"pipe error \\n\");\n        exit(EXIT_FAILURE);\n    }\n    char buffer[2];\n    pthread_mutex_init(&amp;mutex,NULL);\n    close(tube[1]);\n    pthread_create(&amp;a,NULL,fonction,&amp;tube[1]);\n    pthread_join(a,NULL);\n    read(tube[0],buffer,2);\n    printf(\"read from bf %s \\n\",buffer);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Ps : as timrau suggested here (<a href=\"https://stackoverflow.com/questions/37168752/pthread-t-not-starting/37168858#37168858\">Pthread_t not starting</a>) I use pthread_join but I guess it's not the right way to do it</p>\n"}, {"tags": ["c", "memory-management", "malloc", "sizeof", "undefined-behavior"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 7, "last_activity_date": 1462989992, "last_edit_date": 1462989992, "creation_date": 1462989516, "answer_id": 37170105, "question_id": 37170036, "link": "https://stackoverflow.com/questions/37170036/is-it-defined-behavior-to-allocate-memory-using-the-variable-being-declared/37170105#37170105", "title": "Is it defined behavior to allocate memory using the variable being declared?", "body": "<p>It's <strong>fine and well-defined behaviour</strong>.</p>\n\n<p><code>sizeof</code> gets evaluated at compile-time, and unless the operand is VLA, the <em>operand</em> is not evaluated. (<em>So, no invalid-pointer dererefence, as it might look like</em>)</p>\n\n<p>To put it in other words, <code>sizeof</code> only needs to know the <em>type</em> of the operand (which is already defined).</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.5.3.4</p>\n\n<blockquote>\n  <p>[....] If the type of the operand is a variable length array\n  type, the operand is evaluated; otherwise, the operand is not evaluated and the result is an\n  integer constant.</p>\n</blockquote>\n"}], "owner": {"reputation": 1581, "user_id": 2848117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7uhq.png?s=128&g=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/2848117/dom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1462989850, "answer_count": 1, "score": 6, "last_activity_date": 1462989992, "creation_date": 1462989302, "last_edit_date": 1462989806, "question_id": 37170036, "link": "https://stackoverflow.com/questions/37170036/is-it-defined-behavior-to-allocate-memory-using-the-variable-being-declared", "closed_reason": "Duplicate", "title": "Is it defined behavior to allocate memory using the variable being declared?", "body": "<p>I was looking at a port of libusb today for android and I noticed this line of code:</p>\n\n<pre><code>struct usbi_pollfd *ipollfd = malloc(sizeof(*ipollfd));\n</code></pre>\n\n<p>It seems that <code>ipollfd</code> is being allocated based on the size of itself which has not been completely allocated yet. My first thought would be that the behavior of this is undefined. Is that the case?</p>\n"}, {"tags": ["c", "arrays", "loops", "strcpy"], "comments": [{"owner": {"reputation": 917, "user_id": 3074057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kWsh7.png?s=128&g=1", "display_name": "Beezer", "link": "https://stackoverflow.com/users/3074057/beezer"}, "edited": false, "score": 0, "creation_date": 1607268296, "post_id": 37169766, "comment_id": 115213109, "body": "This is a real issue with strtok() and strtok_r() on non-BSD system where strsep is not available. Therefore i am up voting the post that has been down-voted."}], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 5695017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/933ac917978c6a73fa1b9387b6ceb5d0?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5695017/james"}, "edited": false, "score": 1, "creation_date": 1463004561, "post_id": 37169803, "comment_id": 61882857, "body": "Thanks for your explanation it was very helpful"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1462989396, "last_edit_date": 1462989396, "creation_date": 1462988481, "answer_id": 37169803, "question_id": 37169766, "link": "https://stackoverflow.com/questions/37169766/copy-a-single-character-from-a-character-array-to-another-character-array-in-c/37169803#37169803", "title": "Copy a single character from a character array to another character array in C", "body": "<p>The problem, as I see it, is in</p>\n\n<pre><code>for(i == 0 ; i &lt; 10 ; i++)\n      ^^\n</code></pre>\n\n<p>You should be using the assignment (<code>=</code>), like</p>\n\n<pre><code>for(i = 0 ; i &lt; 10 ; i++)\n</code></pre>\n\n<p>to set the initial value of <code>i</code>. Otherwise, by accessing the value of an uninitialized local variable (whose value is indeterminate without an initialization), your code will invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>Then, the usage of <code>strncpy()</code> also looks wrong, you're not passing a <code>char *</code>, as required for the first argument.</p>\n\n<p>Now, that said, two more things,</p>\n\n<ol>\n<li><p>To copy a single <code>char</code> one at a time, you can simply use the assignment                   , like </p>\n\n<pre><code>word[j] = str[i];\n</code></pre></li>\n<li><p>You should only loop over the input array till the valid entries, not the whole size (10). In case, the input is smaller, you'll again hit UB.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 223, "user_id": 5695017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/933ac917978c6a73fa1b9387b6ceb5d0?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5695017/james"}, "edited": false, "score": 0, "creation_date": 1463004672, "post_id": 37170234, "comment_id": 61882905, "body": "Thanks for your suggestion it was helpful"}], "tags": [], "owner": {"reputation": 31, "user_id": 5952351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9D0bP.jpg?s=128&g=1", "display_name": "D.Bag", "link": "https://stackoverflow.com/users/5952351/d-bag"}, "is_accepted": false, "score": 3, "last_activity_date": 1462989880, "creation_date": 1462989880, "answer_id": 37170234, "question_id": 37169766, "link": "https://stackoverflow.com/questions/37169766/copy-a-single-character-from-a-character-array-to-another-character-array-in-c/37170234#37170234", "title": "Copy a single character from a character array to another character array in C", "body": "<p>I think your problem is no pointer to the dest argument in the strncpy function.</p>\n\n<pre><code>strncpy(word[j], &amp;str[i], 1) ;\n        ^\n</code></pre>\n\n<p>Add a pointer to the destination for the strncpy function </p>\n\n<pre><code>strncpy(&amp;word[j], &amp;str[i], 1) ;\n</code></pre>\n\n<p>as well as fixing the issue mentioned by Sourav Ghosh and you should have it.</p>\n"}, {"tags": [], "owner": {"reputation": 917, "user_id": 3074057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kWsh7.png?s=128&g=1", "display_name": "Beezer", "link": "https://stackoverflow.com/users/3074057/beezer"}, "is_accepted": false, "score": 0, "last_activity_date": 1607271007, "last_edit_date": 1607271007, "creation_date": 1607269489, "answer_id": 65169913, "question_id": 37169766, "link": "https://stackoverflow.com/questions/37169766/copy-a-single-character-from-a-character-array-to-another-character-array-in-c/65169913#65169913", "title": "Copy a single character from a character array to another character array in C", "body": "<p>As i commented on the @James, this is a REAL issue on non-BSD where there is no strsep().\nstrtok() and strtok_r() are both IMO fundamentally flawed in that they unilaterally skip any sequence of &gt;1 adjacent delimiters.</p>\n<p>I used this solution:\n<a href=\"https://www.geeksforgeeks.org/c-program-replace-word-text-another-given-word/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/c-program-replace-word-text-another-given-word/</a>\nin order to fill the above with space gaps so that I can get a proper tokenization of ALL my payload.\nReader beware, the solution above has a flaw...so you might need to call it more than once...Not optimal, but if you are in a hurry as I was, I used it and it works.</p>\n<pre><code>  while(strstr(token, &quot;;;&quot;)!=NULL) {\n                 token = replaceWord(token, &quot;;;&quot;, &quot;; ;&quot;);\n                 (void) sprintf (v_sg_TempMsg, &quot;Massaged the input agsId to token:[%s]&quot;, token);\n                 printf(v_sg_TempMsg);\n                 ++tokenCounter;\n                 if(tokenCounter==15) {\n                     break;\n                 }\n   }//while(strstr(token, &quot;;;&quot;)!=NULL) {\n</code></pre>\n<p>...and the above is a hack to get call the code that is flawed to eventually remove all the occurrences of the delimiters...this is dirty dirty code, so please, no flamers...it is here to HELP people who are blocked because of a lack of an alternative to strtok() and strtok_r() skipping.</p>\n"}], "owner": {"reputation": 223, "user_id": 5695017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/933ac917978c6a73fa1b9387b6ceb5d0?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5695017/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7502, "favorite_count": 0, "accepted_answer_id": 37169803, "answer_count": 3, "score": -1, "last_activity_date": 1607271007, "creation_date": 1462988381, "last_edit_date": 1462990440, "question_id": 37169766, "link": "https://stackoverflow.com/questions/37169766/copy-a-single-character-from-a-character-array-to-another-character-array-in-c", "title": "Copy a single character from a character array to another character array in C", "body": "<p>I am fairly new to C programming and trying to improve. I have seen a few question similar to this and tried to implement their suggestions using strncpy but it still won't work. Can anyone give me a pointer in the right direction? Thanks.</p>\n\n<p>The aim of the code is to be given a string and split it on finding a blank space. I am deliberately not using <code>strtok()</code>. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nchar str[10] ;\nchar word[10] ;\nint i, j, k, l ;\n\n  int main()\n{\n  printf(\"Please enter a string of ten characters and I'll find the blanks\\n\") ;\n  fgets(str,10,stdin) ;\n\n  printf(\"Original string is %s\\n\", str) ;\n\n  j = 0 ;\n\n  for(i == 0 ; i &lt; 10 ; i++){\n    if(!isblank(str[i])){\n      strncpy(word[j], &amp;str[i], 1) ;\n      printf(\"i = %d, j = %d, str[i] = %c, word[j] = %c\\n\",i, j, str[i], word[j]) ;\n      j++ ;\n    }else{\n      printf(\"%s\\n\",word) ;\n      j = 0 ;\n    }\n  }\n  return 0 ;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "image-processing"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462988351, "post_id": 37169704, "comment_id": 61874289, "body": "Sure, there is a function in standard C for every task one can think of. Just use the <code>do_what_i_want</code>-function. Seriously: Your question is far off-topic. That could have been answered by a simple search."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1462988411, "post_id": 37169704, "comment_id": 61874333, "body": "Hmm, on second thought, that C/C++ language actually might have such a function. But the two <b>different</b> languages C and C++ don&#39;t."}, {"owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "edited": false, "score": 0, "creation_date": 1462988646, "post_id": 37169704, "comment_id": 61874470, "body": "You can use the PGM format (<a href=\"https://en.wikipedia.org/wiki/Netpbm_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Netpbm_format</a>) it is exactly what you describe. Also I doubt there is a built-in function in C about loading specific image format :) But you can write a loader routine yourself, it will be a couple of fscanf() calls (or file stream readings for C++)."}, {"owner": {"reputation": 17623, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 1, "creation_date": 1462988772, "post_id": 37169704, "comment_id": 61874549, "body": "You should show some own effort to solve your problem. This can be done without any non-standard libraries both in C and C++ The only thing you have to do is use google or read the Bitmap file specification and implement your stuff accordingly.  And why would you put integer values between 0 and 255 into a float array? (Hint 0-255 can be covered with 1 byte)"}, {"owner": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462989474, "post_id": 37169704, "comment_id": 61875005, "body": "@Olaf I posted it after reading all the searches. I put some effort and seemed useless posting the failures. Thanks for looking down on me."}, {"owner": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "reply_to_user": {"reputation": 17623, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1462989597, "post_id": 37169704, "comment_id": 61875061, "body": "@Piglet  I need a float because after the anisotropic i need a &quot;threshold confront&quot; to decide between a second step of diffusion or going through edge detection"}, {"owner": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "edited": false, "score": 0, "creation_date": 1463026848, "post_id": 37169704, "comment_id": 61888671, "body": "I reworded my question, could you please reopen it?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "edited": false, "score": 0, "creation_date": 1462989869, "post_id": 37170066, "comment_id": 61875238, "body": "Thanks for the help :) I need the 1D part because the second part of the project is transferring the 3 functions for image processing in CUDA, and CUDA don&#39;t like 2D arrays"}, {"owner": {"reputation": 36, "user_id": 6319963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e183df3efda68d6f370a44ae2f1654d?s=128&d=identicon&r=PG&f=1", "display_name": "John Wiggles", "link": "https://stackoverflow.com/users/6319963/john-wiggles"}, "reply_to_user": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "edited": false, "score": 0, "creation_date": 1462990003, "post_id": 37170066, "comment_id": 61875327, "body": "I think OpenCV has major tie-ups with CUDA in terms of development. Try and see if you can find examples relevant to what you want to do, you might just find the code for it."}, {"owner": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "edited": false, "score": 0, "creation_date": 1462990918, "post_id": 37170066, "comment_id": 61875857, "body": "<i>Sigh</i> :( if i have to use OpenCV i&#39;d rather stick to my MatLab functions, then read the txt into a float array and viceversa...  My goal was to be the smartass that used only C language  I will look into it :)"}], "tags": [], "owner": {"reputation": 36, "user_id": 6319963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e183df3efda68d6f370a44ae2f1654d?s=128&d=identicon&r=PG&f=1", "display_name": "John Wiggles", "link": "https://stackoverflow.com/users/6319963/john-wiggles"}, "is_accepted": false, "score": -1, "last_activity_date": 1462989363, "creation_date": 1462989363, "answer_id": 37170066, "question_id": 37169704, "link": "https://stackoverflow.com/questions/37169704/read-write-bmp-png-grey-scale-image-with-c-or-c/37170066#37170066", "title": "Read/Write BMP/PNG grey scale image with C or C++", "body": "<p>I memorized some rules from C++ too when I was young. Sadly, I need to memorize them again if I am to use them. To answer your question (I'm attempting to do so), </p>\n\n<p>1.) I think you're getting confused with reading an image into C++. Vanilla C++ in itself has no standard libraries to read images, use something like openCV or ITK toolbox to get relevant functions.</p>\n\n<p>2.) Yes you can convert the read image into a 1D float array but there are no in-built ways that would automatically treat that 1D float array as an image, even with external toolboxes present. For eg. you read images into Mat objects in OpenCV: from there onwards, you can do whatever you want with it, even convert it into a really long 1D array. But it wont serve your purpose.</p>\n\n<p>3.) I mean I still cant understand the 1D part, I like old school code too but that's just pushing it, man. In fact I'll say, install OpenCV, and memorize its documentation, you'll be able to do all that you mentioned and even more.</p>\n"}], "owner": {"reputation": 1, "user_id": 6321619, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208252551824329/picture?type=large", "display_name": "Gabriele Fumarco", "link": "https://stackoverflow.com/users/6321619/gabriele-fumarco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1122, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1463430878, "creation_date": 1462988201, "last_edit_date": 1463026772, "question_id": 37169704, "link": "https://stackoverflow.com/questions/37169704/read-write-bmp-png-grey-scale-image-with-c-or-c", "title": "Read/Write BMP/PNG grey scale image with C or C++", "body": "<p><em>I'm rewording it because someone thougth it was \"off topic\" and some other rude responses without thinking about my efforts and all the searches, many thanks to locking me for 4 days just because 2 of you thought I didn't write a single line of code</em></p>\n\n<p><em>I will write my puny failures and be assured, i used the search button</em></p>\n\n<p>I'm doing an imageprocessing project in C and CUDA. I knew the core of the problem but I encountered a little problem</p>\n\n<p><strong>read and write a grey scale image (PNG or BMP) as input&amp;output</strong></p>\n\n<p>My \"think about it later\" strategy was the same of my colleagues:</p>\n\n<p>1) use a Matlab script using: <code>[X,map] = imread('xray.png');</code></p>\n\n<p>map is pretty useless with a grey scale (useful for RGB files) but X returned me a Width x Height matrix with intergers as a various scale of \"brightness\"</p>\n\n<p>2) use the fprintf function in Matlab to write a xray.txt with 3 lines:</p>\n\n<ol>\n<li>Width</li>\n<li>Heigth</li>\n<li>Width*Heigth line of integers separated with a space</li>\n</ol>\n\n<p>3) import the data in C like this:</p>\n\n<pre><code>        FILE *image;\n        image = fopen(\"xray.txt\",\"r\");\n        width=fscanf(image,\"%f\\n\",&amp;width);\n        heigth=fscanf(image,\"%f\\n\",&amp;heigth);\n        pixels=(float *) calloc(width*heigth, sizeof(float));\n        for (int i = 0; i &lt; width*heigth; i++) {\n        fscanf(image,\"%f \",&amp;pixels[i]);\n        }\n        fclose(image);\n</code></pre>\n\n<p>4) <strong>OFFTOPIC</strong> core of the image processing algorithm where I <strong>NEED</strong> a 1D float array (the second version of the code is in CUDA). I need the code to be the same, for the time of processing confrontation</p>\n\n<p>5) reverse process: from width, height, pixels, i write a xrayout.txt, xrayedges.txt</p>\n\n<p>6) second MatLab script that from xrayout.txt &amp; xrayedges.txt generate xrayout.bmp &amp; xrayedges.bmp.. Not worth posting, it's the reverse process of imRead</p>\n\n<p>The project itslef is complete, it all works well but it really nags me that I couldn't find an \"only C\" solution</p>\n\n<p>Do someone know some easy way to read and write a grey scale PNG knowing: width, heigth, pixel values?\nIs there a function that can import BMP o PNG images?\nIt doesn't matter if it need a 2D array, i can work my way out</p>\n\n<p><strong>NOTE 1: by easy way i mean \"vanilla C\", without using some exotic libraries o other languages (if so, I will stick with the MatLab scripts)</strong></p>\n\n<p><strong>NOTE 2: i TRIED (with multiple failures) and searched in stackoverflow and google, posting this post is my last possibility, so please be gentle</strong></p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462988458, "post_id": 37169690, "comment_id": 61874366, "body": "Debugger.................."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1462989718, "post_id": 37169690, "comment_id": 61875140, "body": "Unrelated: At SO spaces come pretty cheap, use them"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1462990355, "post_id": 37169690, "comment_id": 61875531, "body": "@4386427 Spacesareincriiticalshortage.Usetabswheneverpossible. Togetherwecanmakeitthroughthisdifficulttime.;-)"}, {"owner": {"reputation": 11, "user_id": 6321725, "user_type": "registered", "profile_image": "https://graph.facebook.com/180672398994807/picture?type=large", "display_name": "DAnn", "link": "https://stackoverflow.com/users/6321725/dann"}, "edited": false, "score": 0, "creation_date": 1463017615, "post_id": 37169690, "comment_id": 61886384, "body": "Thanks guys I&#39;ll try it out and update"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1462990443, "post_id": 37170246, "comment_id": 61875580, "body": "Recommend <code>newnode = malloc(sizeof *newnode);</code>"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1462990817, "last_edit_date": 1462990817, "creation_date": 1462989918, "answer_id": 37170246, "question_id": 37169690, "link": "https://stackoverflow.com/questions/37169690/n-polynomial-addition-not-working/37170246#37170246", "title": "N-polynomial addition not working", "body": "<p>This part</p>\n\n<pre><code>newnode=(struct node *)malloc(sizeof(newnode));  // This will allocate space for \n                                                 // a pointer to struct node\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>newnode=(struct node *)malloc(sizeof(struct node));  // This will allocate space for \n                                                     // a struct node\n</code></pre>\n\n<p>or better as suggested by @chux</p>\n\n<pre><code>newnode = malloc(sizeof *newnode);         // This will allocate space for \n                                           // whatever newnode points to. In\n                                           // this case a struct node\n</code></pre>\n\n<p>Not sure it makes a difference but I would change:</p>\n\n<pre><code>start[5]={NULL};\n</code></pre>\n\n<p>into</p>\n\n<pre><code>start[5]={NULL, NULL, NULL, NULL, NULL};\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6321725, "user_type": "registered", "profile_image": "https://graph.facebook.com/180672398994807/picture?type=large", "display_name": "DAnn", "link": "https://stackoverflow.com/users/6321725/dann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462990817, "creation_date": 1462988152, "last_edit_date": 1462990321, "question_id": 37169690, "link": "https://stackoverflow.com/questions/37169690/n-polynomial-addition-not-working", "title": "N-polynomial addition not working", "body": "<p>I'm not sure if I'd sound dumb, but still..I want to develop a program using linked list where I could add upto 5 Polynomials. The code I could come up with is..</p>\n\n<pre><code>struct node\n{\n    int exp,coeff;\n    struct node *next;\n} *start[5]={NULL};\n\nvoid read()\n{\n    struct node *current,*newnode;\n    int n,i,max,j;\n    printf(\"How many poly?\");\n    scanf(\"%d\",&amp;n);\n    for(i=0;i&lt;n;i++)\n    {\n        printf(\"\\nDetails of poly %d\\n\",i);\n        printf(\"Max degree:\");\n        scanf(\"%d\",&amp;max);\n        for(j=max;j&gt;=0;j--)\n        {\n            newnode=(struct node *)malloc(sizeof(newnode));\n            printf(\"\\nEnter coeff of %d:\",j);\n            scanf(\"%d\",&amp;newnode-&gt;coeff);\n            newnode-&gt;exp=j;\n            if(start[i]==NULL)\n            {\n                printf(\"a%d\",start[i]);\n                start[i]=newnode;\n                newnode-&gt;next=NULL;\n                printf(\"%d,%d\",start[i],start[i]-&gt;next);\n            }\n            else if(start[i]-&gt;next==NULL)\n            {\n                printf(\"b\");\n                start[i]-&gt;next=newnode;\n                newnode-&gt;next=NULL;\n                printf(\"%d\",start[i]);\n            }\n            else\n            {\n                printf(\"c\");\n                current=start[i];\n                while(current-&gt;next!=NULL)\n                    current=current-&gt;next;\n                current-&gt;next=newnode;\n                newnode-&gt;next=NULL;\n                printf(\"%d\",start[i]);\n            }   \n        }\n    }   \n}\n\nvoid sum()\n{\n    struct node *curr1,*curr2,*tmp;\n    int i,co,ex;\n    curr1=start[0];\n    while(curr1!=NULL)\n    {   \n        for(i=1;i&lt;5;i++)\n        {\n            co=0;\n            if(curr1==start[i])\n                tmp=start[i];\n            else\n                tmp=tmp-&gt;next;\n            curr2=tmp;\n            if(curr1-&gt;exp==curr2-&gt;exp)\n            {\n                if(co==0)\n                    co=co+curr1-&gt;coeff+curr2-&gt;coeff;\n                else\n                    co=co+curr2-&gt;coeff;\n                ex=curr1-&gt;exp;\n                break;\n            }\n            else if(curr1-&gt;exp&gt;curr2-&gt;exp)\n            {   \n                ex=curr1-&gt;exp;\n                if(co==0)\n                    co=co+curr1-&gt;coeff;\n                else\n                    break;\n            }\n            else\n            {   \n                ex=curr2-&gt;exp;\n                if(co==0)\n                    co=co+curr2-&gt;coeff;\n                else\n                    break;\n            }\n        }\n        printf(\"%dX^%d\",co,ex);\n        curr1=curr1-&gt;next;\n    }\n}\n\nint main()\n{\n    read();\n    printf(\"result:\\n\");\n    sum();\n    getch();\n    return 0;\n}\n</code></pre>\n\n<p>But on executing,only the first polynomial is getting read.ie, 'i' loop work only once. I tried to check my read function and notice the second condition was not working.ie,this one:</p>\n\n<pre><code>else if(start[i]-&gt;next==NULL)    \n{\n    printf(\"b\");\n    start[i]-&gt;next=newnode;\n    newnode-&gt;next=NULL;\n    printf(\"%d\",start[i]);\n}\n</code></pre>\n\n<p>That print b was to check if program entered this block LOL.\nSomebody help me with this please...</p>\n"}, {"tags": ["c", "initialization", "allocation"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 7, "creation_date": 1462987740, "post_id": 37169442, "comment_id": 61873905, "body": "Use of <code>sizeof(x)</code> is incorrect there . Allocate memory equal to <code>strlen(x)+1</code> to <code>y</code> ."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1462987996, "post_id": 37169442, "comment_id": 61874070, "body": "Also, don&#39;t forget to add <code>\\0</code> to <code>y</code> or <code>strcpy</code> will have problems."}, {"owner": {"reputation": 11, "user_id": 6321664, "user_type": "registered", "profile_image": "https://graph.facebook.com/1005943819471647/picture?type=large", "display_name": "Vasco Morganho", "link": "https://stackoverflow.com/users/6321664/vasco-morganho"}, "edited": false, "score": 0, "creation_date": 1462988388, "post_id": 37169442, "comment_id": 61874315, "body": "sorry in advance for the &quot;noob&quot; question. How exacly should I add \\0 to y? strcpy is indeed giving trouble. @Johny Mopp"}, {"owner": {"reputation": 11, "user_id": 6321664, "user_type": "registered", "profile_image": "https://graph.facebook.com/1005943819471647/picture?type=large", "display_name": "Vasco Morganho", "link": "https://stackoverflow.com/users/6321664/vasco-morganho"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1462988457, "post_id": 37169442, "comment_id": 61874363, "body": "Ok! I changed it, but the error doesn&#39;t seem to be resolved.. thanks for the tip though. @ameyCU"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 3, "creation_date": 1462988546, "post_id": 37169442, "comment_id": 61874416, "body": "<code>char* y = strdup(x);</code> would have prevented both of these problems. Some people might argue that it would be less efficient (going over the string twice - once to copy <code>x</code>, then again to convert to lowercase), but unless we&#39;re talking about huge strings being processed many times, the overhead is probably worthwhile: making the code simpler and more obviously correct for what&#39;s probably minuscule runtime cost.."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1462988664, "post_id": 37169442, "comment_id": 61874486, "body": "Another possibility for some of the valgrind messages might be that the argument <code>x</code> isn&#39;t being passed a valid string.  If the suggestions here don&#39;t solve your problem there might also be a problem at the location(s) where <code>adicionaHashtag()</code> is called."}, {"owner": {"reputation": 11, "user_id": 6321664, "user_type": "registered", "profile_image": "https://graph.facebook.com/1005943819471647/picture?type=large", "display_name": "Vasco Morganho", "link": "https://stackoverflow.com/users/6321664/vasco-morganho"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1462988879, "post_id": 37169442, "comment_id": 61874624, "body": "@MichaelBurr Thanks a lot Michael! &quot;strdup&quot; did indeed help!! Thanks again my friend, a good one!"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1462989030, "post_id": 37169442, "comment_id": 61874746, "body": "Also, <code>strcpy(aux-&gt;nome, y);</code> looks like a potential problem.  I wouldn&#39;t be surprised if it should be <code>aux-&gt;nome = y;</code>, but that really depends on what type <code>Lista_Hashtags.nome</code> is.  If it&#39;s a <code>char*</code> then you want <code>aux-&gt;nome = y</code>, if it&#39;s a <code>char[]</code> then you want something like <code>strcpy()</code>, but you may need to protect against buffer overrun."}, {"owner": {"reputation": 11, "user_id": 6321664, "user_type": "registered", "profile_image": "https://graph.facebook.com/1005943819471647/picture?type=large", "display_name": "Vasco Morganho", "link": "https://stackoverflow.com/users/6321664/vasco-morganho"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1462989254, "post_id": 37169442, "comment_id": 61874880, "body": "@MichaelBurr Ok Michael! Thanks for the tip!"}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1463017000, "post_id": 37175794, "comment_id": 61886196, "body": "Or you can initialize the memory after allocating it. All-bits-zero may or may not be a valid initial value. For example, null pointers are usually represented as all-bits-zero, but that&#39;s not actually guaranteed."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1463017135, "post_id": 37175794, "comment_id": 61886235, "body": "size needs +1 for the null terminator"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1463017151, "post_id": 37175794, "comment_id": 61886247, "body": "@KeithThompson all bits zero is valid for <code>char</code> as it is an integer type"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463017355, "post_id": 37175794, "comment_id": 61886316, "body": "@M.M: Yes, but we don&#39;t know what&#39;s in <code>Lista_Hashtags</code> -- though now that I look at it, it&#39;s the first <code>malloc</code> that&#39;s apparently the problem. On the other hand, if an allocated array of <code>char</code> is going to hold a string, there&#39;s no need to zero all of it."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1463018048, "post_id": 37175794, "comment_id": 61886492, "body": "Yet another example of an allocation for a string that is too small for the terminating null.  Please - can people just start using <code>strdup()</code> so we can stop seeing this bug over and over?"}], "tags": [], "owner": {"reputation": 146, "user_id": 6253890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1953d8e22c4fcd4740279798f6661dda?s=128&d=identicon&r=PG&f=1", "display_name": "051026luyaok", "link": "https://stackoverflow.com/users/6253890/051026luyaok"}, "is_accepted": false, "score": 1, "last_activity_date": 1463016592, "creation_date": 1463016592, "answer_id": 37175794, "question_id": 37169442, "link": "https://stackoverflow.com/questions/37169442/uninitialized-value-was-created-by-a-heap-allocation-why/37175794#37175794", "title": "uninitialized value was created by a heap allocation. why?", "body": "<p>\"uninitialized value ...\"\nYou may use <code>char*y=calloc(strlen(x),0);</code> instead of <code>char*y=malloc(sizeof(x));</code>.Initialize the memory with \"0\".</p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1463019785, "post_id": 37175974, "comment_id": 61886954, "body": "@MichaelBurr: Note that <code>strdup</code> is non-standard."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1463019829, "last_edit_date": 1463019829, "creation_date": 1463018070, "answer_id": 37175974, "question_id": 37169442, "link": "https://stackoverflow.com/questions/37169442/uninitialized-value-was-created-by-a-heap-allocation-why/37175974#37175974", "title": "uninitialized value was created by a heap allocation. why?", "body": "<pre><code>void adicionaHashtag(char* x){\n    char*y=malloc(sizeof(x));/***ERROR IS HERE***/\n    int i;\n    for(i=0; i&lt;strlen(x); i++){\n        y[i]=tolower(x[i]);\n    }\n</code></pre>\n\n<p>You're trying to allocate and initialize a string with a copy of the string pointed to by <code>x</code>.</p>\n\n<p><code>sizeof(x)</code> is the size of a <code>char*</code> pointer.  That's typically 4 or 8 bytes. You need to allocate enough space to hold the string itself.</p>\n\n<pre><code>char *y = malloc(strlen(x) + 1);\n</code></pre>\n\n<p>The <code>+ 1</code> is to allow for the terminating null character <code>'\\0'</code>.</p>\n\n<p>Calling <code>strlen</code> on each iteration of the loop is inefficient, but not incorrect; I'll leave that for now. There's a potential problem if any of the copied characters have negative values (an unfortunate characteristic of the <code>tolower()</code> function. The assignment should be:</p>\n\n<pre><code>y[i] = tolower((unsigned char)x[i]);\n</code></pre>\n\n<p>Finally, let's say <code>x</code> points to the string <code>\"hello\"</code>. You're correctly copying 5 characters -- but not the final <code>'\\0'</code>. One possible fix is to change the <code>&lt;</code> in the loop condition to <code>&lt;=</code>, which will copy characters 0 through 5 rather than 0 through 4.</p>\n\n<p>But you can just use the existing <code>strcpy</code> function, which handles all this for you (and more efficiently):</p>\n\n<pre><code>char *y = malloc(strlen(x) + 1);\nstrcpy(y, x);\n</code></pre>\n\n<p>(You should also check the value returned by <code>malloc</code>, and treat it as an error if it's <code>NULL</code>.)</p>\n\n<p>For that matter, you probably don't need <code>y</code> at all.  <code>x</code> is already a pointer to a string. You copy it into the memory allocated for <code>y</code>, and then you copy that into <code>aux-&gt;nome</code>. Unless there's more code you haven't shown us that uses <code>y</code>, this is unnecessary (and a memory leak!).  You can drop the declaration of <code>y</code> and the code that initializes it, and just copy from <code>x</code> directly:</p>\n\n<pre><code>Lista_Hashtags *aux = malloc(sizeof *aux);\nstrcpy(aux-&gt;nome, x);\n</code></pre>\n\n<p>(This assumes that <code>aux-&gt;nome</code> is an array, not a pointer, and that it's big enough to hold a copy of the string.)</p>\n\n<p>(Note that I've changed your <code>malloc</code> call to a simpler and more robust form.)</p>\n"}], "owner": {"reputation": 11, "user_id": 6321664, "user_type": "registered", "profile_image": "https://graph.facebook.com/1005943819471647/picture?type=large", "display_name": "Vasco Morganho", "link": "https://stackoverflow.com/users/6321664/vasco-morganho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3785, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463019829, "creation_date": 1462987452, "last_edit_date": 1463017425, "question_id": 37169442, "link": "https://stackoverflow.com/questions/37169442/uninitialized-value-was-created-by-a-heap-allocation-why", "title": "uninitialized value was created by a heap allocation. why?", "body": "<p>After running Valgrind on my code I got an error: </p>\n\n<pre><code>uninitialized value was created by a heap allocation. \n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>void adicionaHashtag(char* x){\n    char*y=malloc(sizeof(x));/***ERROR IS HERE***/\n    int i;\n    for(i=0; i&lt;strlen(x); i++){\n        y[i]=tolower(x[i]);\n    }\n\n    Lista_Hashtags*aux = (Lista_Hashtags*)malloc(sizeof(Lista_Hashtags));\n    strcpy(aux-&gt;nome, y);\n    aux-&gt;contador=1;\n    if(contador_unitario == 0){\n        ultimo = aux;\n    }\n    contador_unitario++;\n    aux-&gt;proximo = primeiro;\n    primeiro = aux;\n}\n</code></pre>\n\n<p>any tips?</p>\n\n<p>also, what does \"Conditional jump or move depends on uninitialised value(s)\" mean?\n~                                                                                       </p>\n"}, {"tags": ["c", "arrays", "avr"], "comments": [{"owner": {"reputation": 59, "user_id": 4266441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66c33bfb427557b1e41addcc1a74ddfe?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4266441/ivan"}, "edited": false, "score": 0, "creation_date": 1462987754, "post_id": 37169439, "comment_id": 61873919, "body": "I guess you can ignore <code>PROGMEM</code> as it tells the AVR to place the array in program memory"}], "answers": [{"tags": [], "owner": {"reputation": 21474, "user_id": 718379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4810c6c963334e5dce573e6671d746ec?s=128&d=identicon&r=PG", "display_name": "timrau", "link": "https://stackoverflow.com/users/718379/timrau"}, "is_accepted": true, "score": 0, "last_activity_date": 1462987752, "creation_date": 1462987752, "answer_id": 37169537, "question_id": 37169439, "link": "https://stackoverflow.com/questions/37169439/reading-line-by-line-in-string-array/37169537#37169537", "title": "Reading line by line in String Array", "body": "<pre><code>int i;\nfor (i = 0; i &lt; sizeof(paragraph)/sizeof(paragraph[0]); ++i) {\n    printf(\"%s\\n\", paragraph[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4266441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66c33bfb427557b1e41addcc1a74ddfe?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4266441/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 37169537, "answer_count": 1, "score": 0, "last_activity_date": 1462987752, "creation_date": 1462987436, "question_id": 37169439, "link": "https://stackoverflow.com/questions/37169439/reading-line-by-line-in-string-array", "title": "Reading line by line in String Array", "body": "<p>I have an array which is stored in my program memory</p>\n\n<pre><code>const char* const paragraph[] PROGMEM = {\n    \"First Line\",\n    \"Second Line\"\n};\n</code></pre>\n\n<p>How do I read one string at a time so that it output</p>\n\n<pre><code>First Line\nSecond Line\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "free", "void-pointers"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1462986999, "post_id": 37169260, "comment_id": 61873470, "body": "<code>niz</code> undeclared. Post compilable code."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1462989453, "post_id": 37169260, "comment_id": 61874996, "body": "@EOF I fixed it, it&#39;s not working properly now :)"}], "answers": [{"comments": [{"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "edited": false, "score": 0, "creation_date": 1462989759, "post_id": 37169857, "comment_id": 61875167, "body": "Yes, fantastic! Can you please tell me what I was doing in the first place with my example?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "edited": false, "score": 2, "creation_date": 1462989986, "post_id": 37169857, "comment_id": 61875318, "body": "@smrdo_prdo You were writing to an unintended memory. you want <code>*(arr+i)</code>, not <code>arr+i</code>. <code>*(arr+i)</code> is <code>arr[i]</code>."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 1, "last_activity_date": 1462988685, "creation_date": 1462988685, "answer_id": 37169857, "question_id": 37169260, "link": "https://stackoverflow.com/questions/37169260/how-to-free-void-array-of-void-pointers/37169857#37169857", "title": "How to free void array of void pointers?", "body": "<p>should be</p>\n\n<pre><code>for (int i=0; i&lt;=6; i++)\n{\n    arr[i] = malloc(size);\n    memcpy(arr[i], &amp;i, size);\n}\n\nfor (int i=0; i&lt;=6; i++)\n{\n    printf(\"%d \", *(int*)(arr[i]));\n}\n</code></pre>\n"}], "owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 37169857, "answer_count": 1, "score": 0, "last_activity_date": 1462989418, "creation_date": 1462986901, "last_edit_date": 1462989418, "question_id": 37169260, "link": "https://stackoverflow.com/questions/37169260/how-to-free-void-array-of-void-pointers", "title": "How to free void array of void pointers?", "body": "<p>I managed to narrow my problem to this code snippet:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    void **arr;\n    int max = 10; //tr = 0;\n    int size = sizeof(int);\n\n    arr = malloc(max*sizeof(void*));\n\n    for (int i=0; i&lt;=6; i++)\n    {\n        arr[i] = malloc(size);\n        memcpy(arr+i, &amp;i, size);\n    }\n\n    for (int i=0; i&lt;=6; i++)\n    {\n        printf(\"%d \", *(int*)(arr + i));\n    }\n\n    free(arr[0]);\n    free(arr[1]);\n\n    free(arr);\n    return 0;\n}\n</code></pre>\n\n<p>It's ok when I free <code>arr</code>, and it's ok when I free <code>arr[0]</code>. But anything other than that I get a segfault.</p>\n\n<p>Am I doing the allocations wrong? Or is it something else?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1462986736, "post_id": 37169116, "comment_id": 61873297, "body": "9999 = 0x0000<b>270F</b>, 993024 = 0x00<b>0F27</b>00"}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1462986782, "post_id": 37169116, "comment_id": 61873320, "body": "You seem to be off by one byte, and have your byte order wrong."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1462987100, "post_id": 37169116, "comment_id": 61873523, "body": "Are you sure the file endianness is the same as the program&#39;s?"}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1462987152, "post_id": 37169116, "comment_id": 61873558, "body": "@stark I&#39;m sure it&#39;s not."}, {"owner": {"reputation": 59, "user_id": 5011996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfeac18549496a86481770a7301cde7?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Svetlikov", "link": "https://stackoverflow.com/users/5011996/sergey-svetlikov"}, "reply_to_user": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 1, "creation_date": 1462987584, "post_id": 37169116, "comment_id": 61873800, "body": "firstly @JimmyB you are right! The problem was in 1 byte, I used 3201 offset instead of 3200. Thank you!  Now I&#39;ve got a value - 254214144 (Little endian) - if convert it to Big Endian is is <b>9999</b>. P.S. I would mark you answer as correct but I don&#39;t know how to it with your comment ^("}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1463061372, "post_id": 37169116, "comment_id": 61910775, "body": "I don&#39;t understand why people keep downvoting this question :-\\"}], "answers": [{"tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": true, "score": 5, "last_activity_date": 1463063084, "last_edit_date": 1463063084, "creation_date": 1463062509, "answer_id": 37189604, "question_id": 37169116, "link": "https://stackoverflow.com/questions/37169116/incorrect-result-returned-after-reading-binary-file-int-value/37189604#37189604", "title": "Incorrect result returned after reading binary file (int value)", "body": "<p>A quick look at the values you got:</p>\n\n<p>Expected: 9999 = 0x0000<strong>270F</strong></p>\n\n<p>Received: 993024 = 0x00<strong>0F27</strong>00</p>\n\n<p>From this we can see two things:</p>\n\n<ol>\n<li><p><code>0F27</code> is <code>270F</code> with swapped bytes. Apparently, the byte order (endiannes) inside the file is not the same as that in memory;</p></li>\n<li><p>If only the byte order was swapped, you would be getting <code>0x0F270000</code> from the file, but the value seems to be shifted by one byte.</p></li>\n</ol>\n\n<p>This can mean one of two things, depending on the endianness of the file:</p>\n\n<p>If the file is little-endian (and the CPU is big-endian), you should be seeking to offset <code>3202</code> instead of <code>3201</code>.</p>\n\n<p>If the file is big-endian (and the CPU is little-endian), you should be seeking to offset <code>3200</code> instead of <code>3201</code>.</p>\n\n<p>So, check the endianness of the file and correct your offset; then, convert the data read from the endianness of the file to the endianness of your CPU (reverse the bytes in this case) to get the correct value.</p>\n\n<p>To create code that is correct on any CPU, you may be able to use <a href=\"http://man7.org/linux/man-pages/man3/endian.3.html\"><code>be32toh()</code>, or <code>le32toh()</code>,</a> to convert big-endian, or little-endian respectively, file data to the right CPU endianness.</p>\n"}], "owner": {"reputation": 59, "user_id": 5011996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfeac18549496a86481770a7301cde7?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Svetlikov", "link": "https://stackoverflow.com/users/5011996/sergey-svetlikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 37189604, "answer_count": 1, "score": 0, "last_activity_date": 1463063084, "creation_date": 1462986414, "last_edit_date": 1462986956, "question_id": 37169116, "link": "https://stackoverflow.com/questions/37169116/incorrect-result-returned-after-reading-binary-file-int-value", "title": "Incorrect result returned after reading binary file (int value)", "body": "<p>I try to read value from binary file. I know offset (3201) and use it. </p>\n\n<p>Example code: </p>\n\n<pre><code>FILE *bin_file;\nint *job_id_buffer; \n\nbin_file = fopen(\"sample.sgy\", \"rb\");\n\nif (bin_file == NULL)\n{\n// ... skipped ... \n}\n\nfseek(bin_file, 3201, SEEK_SET);\n\njob_id_buffer = (int*)malloc(sizeof(int));\n\nfread(job_id_buffer, sizeof(int), 1, bin_file);\n\nprintf(\"%d\\n\", (int)job_id_buffer[0]);\n\nfclose(bin_file);   \n</code></pre>\n\n<p>Looks like I don't know how to read value correctly. </p>\n\n<p>But problem is that when I get result, the value is <strong>993024</strong>, while I 100% know that correct value is <strong>9999</strong>. </p>\n\n<p>Could you, please, help me to understand what I do incorrectly? </p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1462986412, "post_id": 37169050, "comment_id": 61873096, "body": "Depending on environment, you can use <code>dlsym</code> or <code>GetProcAddress</code> to get the address of a symbol, then you can jump to it through a pointer."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1462987295, "post_id": 37169050, "comment_id": 61873641, "body": "C labels aren&#39;t valid symbols in the compiled code, if that&#39;s what you&#39;re asking."}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1462994019, "post_id": 37169050, "comment_id": 61877532, "body": "@Jester dlsym looks promising, thank you ... but how DO I use it? (see edit above)"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1462995366, "post_id": 37169050, "comment_id": 61878259, "body": "You forgot to link <code>-ldl</code>. Also, you don&#39;t even need assembly for this, it is plain C function pointer. You segfault because calling a function may destroy some registers as per the calling convention. If you use a function pointer the compiler will know about this. Otherwise you will have to list them in the asm as clobbers."}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1462995545, "post_id": 37169050, "comment_id": 61878360, "body": "@Jester Forgot it had to be added at the END of the compilation command. But humour me, how would I do this if I needed to do it in assembly? Obviously the snippet above is just to try this thing out."}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1462996095, "post_id": 37169050, "comment_id": 61878654, "body": "@Jester Nope, listing the registers as clobbers doesn&#39;t seem to get rid of the segfault."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1462996140, "post_id": 37169050, "comment_id": 61878686, "body": "The asm should look something like <code>&quot;call *%0&quot; :: &quot;rm&quot; (loc) : &quot;eax&quot;, &quot;ecx&quot;, &quot;edx&quot;, &quot;memory&quot;</code> and you need to add <code>-rdynamic</code> compiler flag otherwise you get a <code>NULL</code> pointer ;)"}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1462996348, "post_id": 37169050, "comment_id": 61878806, "body": "@Jester I love you. Thanks a lot. Do you want to elaborate so I can accept it as an answer?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1462997478, "post_id": 37169050, "comment_id": 61879417, "body": "Note that you don&#39;t need the <code>asm</code> statement. You can use <code>((void (*)()) loc)();</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1466202580, "last_edit_date": 1466202580, "creation_date": 1466149379, "answer_id": 37875853, "question_id": 37169050, "link": "https://stackoverflow.com/questions/37169050/assembly-get-symbolic-label-from-char-array/37875853#37875853", "title": "assembly - get symbolic label from char array?", "body": "<p>The asm should look something like <code>\"call *%0\" :: \"rm\" (loc) : \"eax\", \"ecx\", \"edx\", \"memory\"</code> and you need to add <code>-rdynamic</code> compiler flag otherwise you get a <code>NULL</code> pointer ;) \u2013 Jester</p>\n\n<p>Of course, calling functions from inline asm is <em>hard</em> to get right, especially for 64bit.  Also, calls that the compiler/optimizer can't see could lead to invalid link-time interprocedural optimizations.</p>\n\n<p><strong>It's so much easier and better to use a C function pointer</strong>.</p>\n"}], "owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555109008, "creation_date": 1462986208, "last_edit_date": 1592644375, "question_id": 37169050, "link": "https://stackoverflow.com/questions/37169050/assembly-get-symbolic-label-from-char-array", "title": "assembly - get symbolic label from char array?", "body": "<p>Yeah, I'm trying to achieve something like</p>\n<p><code>__asm__(jmp label;);</code> where <code>label</code> should be replaced by the value of a string held in memory (field of a struct).</p>\n<p>Is there a way to do this (or something similar that allows me to jump to a position determined at runtime)?</p>\n<p><strong>Update</strong>\n<code>dlsym</code> that @Jester suggested looks promising I am now trying to find out how to use it.</p>\n<p>If I try the following (gcc flags <code>-Wall -std=c99 -m32 -ldl</code>)</p>\n<pre><code>#include &lt;stdlib.h&gt; //malloc\n#include &lt;stdio.h&gt; //printf\n#include &lt;stdint.h&gt; //uint32_t\n#include &lt;string.h&gt; //strlen,strdup,...\n#include &lt;dlfcn.h&gt; //dlsym\n\nvoid test(){printf(&quot;Hello World\\n&quot;);}\nint main(int argc, char* argv[]){\n    //this works\n    __asm__(\n        &quot;call test;&quot;\n        );\n\n    //I'd like this to have the same effect\n    char *label = &quot;test&quot;;\n    void *handle = dlopen(NULL,RTLD_NOW);\n    uint32_t loc = (uint32_t)dlsym(handle,label);\n    __asm__(\n        &quot;call %0;&quot;\n        :\n        :&quot;rm&quot;(loc)\n        );\n\n}\n</code></pre>\n<p>I get</p>\n<blockquote>\n<p>Hello World</p>\n<p>Segmentation fault (core dumped)</p>\n</blockquote>\n"}, {"tags": ["python", "c", "macos", "lldb"], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 1014847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/404a4b377fbd8e35003d279b7202506f?s=128&d=identicon&r=PG", "display_name": "mrdvlpr", "link": "https://stackoverflow.com/users/1014847/mrdvlpr"}, "edited": false, "score": 0, "creation_date": 1463400979, "post_id": 37174188, "comment_id": 62034872, "body": "Thanks, and as a side note: Is anyone looking at <a href=\"http://bugreporter.apple.com\" rel=\"nofollow noreferrer\">bugreporter.apple.com</a>? Last bug I opened was not handled for over a year."}, {"owner": {"reputation": 20083, "user_id": 2465073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f7ba796598ce99fe9d17b66c119b00?s=128&d=identicon&r=PG", "display_name": "Jim Ingham", "link": "https://stackoverflow.com/users/2465073/jim-ingham"}, "reply_to_user": {"reputation": 458, "user_id": 1014847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/404a4b377fbd8e35003d279b7202506f?s=128&d=identicon&r=PG", "display_name": "mrdvlpr", "link": "https://stackoverflow.com/users/1014847/mrdvlpr"}, "edited": false, "score": 0, "creation_date": 1463422980, "post_id": 37174188, "comment_id": 62048030, "body": "The bugs from bug reporter get handed out to the teams responsible in pretty short order.  What happens after that depends more on the team receiving the bug."}], "tags": [], "owner": {"reputation": 20083, "user_id": 2465073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f7ba796598ce99fe9d17b66c119b00?s=128&d=identicon&r=PG", "display_name": "Jim Ingham", "link": "https://stackoverflow.com/users/2465073/jim-ingham"}, "is_accepted": true, "score": 1, "last_activity_date": 1463004932, "creation_date": 1463004932, "answer_id": 37174188, "question_id": 37168952, "link": "https://stackoverflow.com/questions/37168952/printing-struct-array-in-lldb-python/37174188#37174188", "title": "printing struct array in lldb python", "body": "<p>GetChildAtIndex is trying to be a little over-helpful for your purposes here.  It is in accord with the help, which says:</p>\n\n<p>Pointers differ depending on what they point to. If the pointer\npoints to a simple type, the child at index zero\nis the only child value available, unless synthetic_allowed \nis true, in which case the pointer will be used as an array\nand can create 'synthetic' child values using positive or \nnegative indexes. <strong>If the pointer points to an aggregate type \n(an array, class, union, struct), then the pointee is \ntransparently skipped and any children are going to be the indexes\nof the child values within the aggregate type.</strong> For example if\nwe have a 'Point' type and we have a SBValue that contains a\npointer to a 'Point' type, then the child at index zero will be\nthe 'x' member, and the child at index 1 will be the 'y' member\n(the child at index zero won't be a 'Point' instance).</p>\n\n<p>So really, buffers.GetChildAtIndex(2,0,1) should have returned \"No Value\".  Either that or passing 1 for the allow-synthetic argument should turn off this peek-through behavior.  In either case, this is a bug, please file it with <a href=\"http://bugreporter.apple.com\" rel=\"nofollow\">http://bugreporter.apple.com</a>.</p>\n\n<p>In the mean time you should be able to get the same effect by walking your array by hand and using \"SBTarget.CreateValueFromAddress to create the values.  Start by getting the address of the array with buffers.GetAddress(); and the size of Buffers by getting the type of buffers, getting its Pointee type &amp; calling GetByteSize on that.  Then just increment the address by the size count times to create all the values.</p>\n"}], "owner": {"reputation": 458, "user_id": 1014847, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/404a4b377fbd8e35003d279b7202506f?s=128&d=identicon&r=PG", "display_name": "mrdvlpr", "link": "https://stackoverflow.com/users/1014847/mrdvlpr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 1, "accepted_answer_id": 37174188, "answer_count": 1, "score": 1, "last_activity_date": 1463004932, "creation_date": 1462985886, "last_edit_date": 1495540361, "question_id": 37168952, "link": "https://stackoverflow.com/questions/37168952/printing-struct-array-in-lldb-python", "title": "printing struct array in lldb python", "body": "<p>Following the question here: <a href=\"https://stackoverflow.com/questions/21693730/writing-a-python-script-to-print-out-an-array-of-recs-in-lldb\">Writing a Python script to print out an array of recs in lldb</a></p>\n\n<p>I would like to be able to create a type summary for an array of a given struct in lldb. Problem is that I am not able to access array correctly through python-lldb. Some data is incorrect. </p>\n\n<p>I have the following test code in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Buffer\n{\n    struct Buffer* next;\n    struct Buffer* prev;\n};\n\nstruct Base\n{\n    struct Buffer* buffers;\n    int count;\n};\n\nvoid fill(struct Buffer* buf, int count)\n{\n    for (int i = 0; i &lt; count; ++i)\n    {\n        struct Buffer t = {(void*)0xdeadbeef,(void*)i};\n        buf[i] = t;\n    }\n}\n\nvoid foo(struct Base* base)\n{\n    printf(\"break here\\n\");\n}\n\nint main(int argc, char** argv)\n{\n    int c = 20;\n    void* buf = malloc(sizeof (struct Buffer) * c);\n    struct Base base = {.buffers = buf, .count = c};\n    fill(base.buffers, base.count);\n    foo(&amp;base);\n    return 0;\n}\n</code></pre>\n\n<p>In lldb:</p>\n\n<pre><code>(lldb) b foo  \n(lldb) r\n(lldb) script\n&gt;&gt;&gt; debugger=lldb.debugger\n&gt;&gt;&gt; target=debugger.GetSelectedTarget()\n&gt;&gt;&gt; frame=lldb.frame\n&gt;&gt;&gt; base=frame.FindVariable('base')\n&gt;&gt;&gt; buffers=base.GetChildMemberWithName('buffers')\n</code></pre>\n\n<p>Now, <code>buffers</code> should point to array of <code>struct Buffer</code> and I should be able to access each and every <code>Buffer</code> via the <code>buffers.GetChildAtIndex</code> function, but the data is corrupted in the first 2 items. </p>\n\n<pre><code>&gt;&gt;&gt; print buffers.GetChildAtIndex(0,0,1)\n(Buffer *) next = 0x00000000deadbeef\n&gt;&gt;&gt; print buffers.GetChildAtIndex(1,0,1)\n(Buffer *) prev = 0x0000000000000000\n&gt;&gt;&gt; print buffers.GetChildAtIndex(2,0,1)\n(Buffer) [2] = {\n  next = 0x00000000deadbeef\n  prev = 0x0000000000000002 \n}\n</code></pre>\n\n<p>Only the <code>buffers[2]</code> and up items are ok. </p>\n\n<p>Why does <code>print buffers.GetChildAtIndex(1,0,1)</code> points to <code>buffers[0].count</code> item instead of <code>buffers[1]</code>?</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1462985925, "post_id": 37168819, "comment_id": 61872842, "body": "put them manually in an array <i>once,</i> then index into that array whenever you need to access them."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1462987129, "post_id": 37168819, "comment_id": 61873544, "body": "Would it make sense to make an array of pointers to int, i.e. int* arr[300] = {&amp;WR_LW200, &amp;WR_LW202, ...}` and the use something like `for (int j=0; j&lt;300; j++) *(arr[j]) = value;"}, {"owner": {"reputation": 1296, "user_id": 506013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d474a0dd3522671e6bc02b1ac55776?s=128&d=identicon&r=PG", "display_name": "rts1", "link": "https://stackoverflow.com/users/506013/rts1"}, "edited": false, "score": 0, "creation_date": 1462987804, "post_id": 37168819, "comment_id": 61873951, "body": "If they really are all next to each other in memory, you might be able to &quot;force&quot; an array over them: i.e., int *a = &amp;WR_Lw200;  Then a[0] would be WR_LW200, a[1] might be WR_LW_202.  But this trick would only work if they are all defined together."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 1296, "user_id": 506013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d474a0dd3522671e6bc02b1ac55776?s=128&d=identicon&r=PG", "display_name": "rts1", "link": "https://stackoverflow.com/users/506013/rts1"}, "edited": false, "score": 0, "creation_date": 1462991608, "post_id": 37168819, "comment_id": 61876185, "body": "@rts1 - You can&#39;t trust the memory layout to be that way"}, {"owner": {"reputation": 19, "user_id": 1936647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847f52921e03d21345caeaefae0f0dd7?s=128&d=identicon&r=PG", "display_name": "BMFS", "link": "https://stackoverflow.com/users/1936647/bmfs"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1463039877, "post_id": 37168819, "comment_id": 61894800, "body": "@4386427 Thanks for the tip, this seams to work. Did not know that i could do this with pointers. I will have to read up on this to better understand it. Thanks again."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463090187, "post_id": 37168819, "comment_id": 61928578, "body": "@AustinHastings - Because the standard doesn&#39;t impose the layout of individual variables in memory. The order of variables stated in the source code has nothing to do with the actual memory layout. The compiler can do any reorder that it find good. So don&#39;t make any assumption about memory layout based on the source code."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 1936647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847f52921e03d21345caeaefae0f0dd7?s=128&d=identicon&r=PG", "display_name": "BMFS", "link": "https://stackoverflow.com/users/1936647/bmfs"}, "is_accepted": false, "score": 1, "last_activity_date": 1463067725, "creation_date": 1463067725, "answer_id": 37191656, "question_id": 37168819, "link": "https://stackoverflow.com/questions/37168819/strategy-for-cycling-trough-preexisting-set-of-variables-in-c/37191656#37191656", "title": "Strategy for cycling trough preexisting set of variables in c", "body": "<p>Just to give you a look on how it ended up looking:</p>\n\n<pre><code>    int* arr[50][5] = { {&amp;WR_LW200, &amp;WR_LW400, &amp;WR_LW600, &amp;WR_LW800, &amp;WR_LW1000},\n                        {&amp;WR_LW202, &amp;WR_LW402, &amp;WR_LW602, &amp;WR_LW802, &amp;WR_LW1002},\n                        {&amp;WR_LW204, &amp;WR_LW404, &amp;WR_LW604, &amp;WR_LW804, &amp;WR_LW1004},\n                        {&amp;WR_LW206, &amp;WR_LW406, &amp;WR_LW606, &amp;WR_LW806, &amp;WR_LW1006},\n                        {&amp;WR_LW208, &amp;WR_LW408, &amp;WR_LW608, &amp;WR_LW808, &amp;WR_LW1008},\n                        {&amp;WR_LW210, &amp;WR_LW410, &amp;WR_LW610, &amp;WR_LW810, &amp;WR_LW1010},\n                        {&amp;WR_LW212, &amp;WR_LW412, &amp;WR_LW612, &amp;WR_LW812, &amp;WR_LW1012},\n                        {&amp;WR_LW214, &amp;WR_LW414, &amp;WR_LW614, &amp;WR_LW814, &amp;WR_LW1014},\n                        {&amp;WR_LW216, &amp;WR_LW416, &amp;WR_LW616, &amp;WR_LW816, &amp;WR_LW1016},\n                        {&amp;WR_LW218, &amp;WR_LW418, &amp;WR_LW618, &amp;WR_LW818, &amp;WR_LW1018},\n                        {&amp;WR_LW220, &amp;WR_LW420, &amp;WR_LW620, &amp;WR_LW820, &amp;WR_LW1020},\n                        {&amp;WR_LW222, &amp;WR_LW422, &amp;WR_LW622, &amp;WR_LW822, &amp;WR_LW1022},\n                        {&amp;WR_LW224, &amp;WR_LW424, &amp;WR_LW624, &amp;WR_LW824, &amp;WR_LW1024},\n                        {&amp;WR_LW226, &amp;WR_LW426, &amp;WR_LW626, &amp;WR_LW826, &amp;WR_LW1026},\n                        {&amp;WR_LW228, &amp;WR_LW428, &amp;WR_LW628, &amp;WR_LW828, &amp;WR_LW1028},\n                        {&amp;WR_LW230, &amp;WR_LW430, &amp;WR_LW630, &amp;WR_LW830, &amp;WR_LW1030},\n                        {&amp;WR_LW232, &amp;WR_LW432, &amp;WR_LW632, &amp;WR_LW832, &amp;WR_LW1032},\n                        {&amp;WR_LW234, &amp;WR_LW434, &amp;WR_LW634, &amp;WR_LW834, &amp;WR_LW1034},\n                        {&amp;WR_LW236, &amp;WR_LW436, &amp;WR_LW636, &amp;WR_LW836, &amp;WR_LW1036},\n                        {&amp;WR_LW238, &amp;WR_LW438, &amp;WR_LW638, &amp;WR_LW838, &amp;WR_LW1038},\n                        {&amp;WR_LW240, &amp;WR_LW440, &amp;WR_LW640, &amp;WR_LW840, &amp;WR_LW1040},\n                        {&amp;WR_LW242, &amp;WR_LW442, &amp;WR_LW642, &amp;WR_LW842, &amp;WR_LW1042},\n                        {&amp;WR_LW244, &amp;WR_LW444, &amp;WR_LW644, &amp;WR_LW844, &amp;WR_LW1044},\n                        {&amp;WR_LW246, &amp;WR_LW446, &amp;WR_LW646, &amp;WR_LW846, &amp;WR_LW1046},\n                        {&amp;WR_LW248, &amp;WR_LW448, &amp;WR_LW648, &amp;WR_LW848, &amp;WR_LW1048},\n                        {&amp;WR_LW250, &amp;WR_LW450, &amp;WR_LW650, &amp;WR_LW850, &amp;WR_LW1050},\n                        {&amp;WR_LW252, &amp;WR_LW452, &amp;WR_LW652, &amp;WR_LW852, &amp;WR_LW1052},\n                        {&amp;WR_LW254, &amp;WR_LW454, &amp;WR_LW654, &amp;WR_LW854, &amp;WR_LW1054},\n                        {&amp;WR_LW256, &amp;WR_LW456, &amp;WR_LW656, &amp;WR_LW856, &amp;WR_LW1056},\n                        {&amp;WR_LW258, &amp;WR_LW458, &amp;WR_LW658, &amp;WR_LW858, &amp;WR_LW1058},\n                        {&amp;WR_LW260, &amp;WR_LW460, &amp;WR_LW660, &amp;WR_LW860, &amp;WR_LW1060},\n                        {&amp;WR_LW262, &amp;WR_LW462, &amp;WR_LW662, &amp;WR_LW862, &amp;WR_LW1062},\n                        {&amp;WR_LW264, &amp;WR_LW464, &amp;WR_LW664, &amp;WR_LW864, &amp;WR_LW1064},\n                        {&amp;WR_LW266, &amp;WR_LW466, &amp;WR_LW666, &amp;WR_LW866, &amp;WR_LW1066},\n                        {&amp;WR_LW268, &amp;WR_LW468, &amp;WR_LW668, &amp;WR_LW868, &amp;WR_LW1068},\n                        {&amp;WR_LW270, &amp;WR_LW470, &amp;WR_LW670, &amp;WR_LW870, &amp;WR_LW1070},\n                        {&amp;WR_LW272, &amp;WR_LW472, &amp;WR_LW672, &amp;WR_LW872, &amp;WR_LW1072},\n                        {&amp;WR_LW274, &amp;WR_LW474, &amp;WR_LW674, &amp;WR_LW874, &amp;WR_LW1074},\n                        {&amp;WR_LW276, &amp;WR_LW476, &amp;WR_LW676, &amp;WR_LW876, &amp;WR_LW1076},\n                        {&amp;WR_LW278, &amp;WR_LW478, &amp;WR_LW678, &amp;WR_LW878, &amp;WR_LW1078},\n                        {&amp;WR_LW280, &amp;WR_LW480, &amp;WR_LW680, &amp;WR_LW880, &amp;WR_LW1080},\n                        {&amp;WR_LW282, &amp;WR_LW482, &amp;WR_LW682, &amp;WR_LW882, &amp;WR_LW1082},\n                        {&amp;WR_LW284, &amp;WR_LW484, &amp;WR_LW684, &amp;WR_LW884, &amp;WR_LW1084},\n                        {&amp;WR_LW286, &amp;WR_LW486, &amp;WR_LW686, &amp;WR_LW886, &amp;WR_LW1086},\n                        {&amp;WR_LW288, &amp;WR_LW488, &amp;WR_LW688, &amp;WR_LW888, &amp;WR_LW1088},\n                        {&amp;WR_LW290, &amp;WR_LW490, &amp;WR_LW690, &amp;WR_LW890, &amp;WR_LW1090},\n                        {&amp;WR_LW292, &amp;WR_LW492, &amp;WR_LW692, &amp;WR_LW892, &amp;WR_LW1092},\n                        {&amp;WR_LW294, &amp;WR_LW494, &amp;WR_LW694, &amp;WR_LW894, &amp;WR_LW1094},\n                        {&amp;WR_LW296, &amp;WR_LW496, &amp;WR_LW696, &amp;WR_LW896, &amp;WR_LW1096},\n                        {&amp;WR_LW298, &amp;WR_LW498, &amp;WR_LW698, &amp;WR_LW898, &amp;WR_LW1098}    };\n</code></pre>\n\n<p>Big right? I had consurns that this HMI would have issues with such an approach but it did the job. The code below runs trough a string that comes from the csv file. This code runs inside another <code>while</code> cycle to cycle trough the multi dimensional array.\nit's a little crude but works.</p>\n\n<pre><code>while (i&lt;=5)\n        {\n            memset(lineTemp, 0, sizeof lineTemp); // clear lineTemp array\n            while (lineFromFile[index] != delimiter)\n            {\n                if (lineFromFile[index] != delimiter &amp;&amp; lineFromFile[index] != '\\0') { lineTemp[j] = lineFromFile[index];       index++;    j++; }\n                if (lineFromFile[index] == '\\0') { i = 5; break; }\n            }\n            index++;\n            lineTemp[j] = '\\0'; // NULL TERMINATION\n            j = 0;\n\n            if (i == -1) {  WriteLocal(\"LW\",temp,3,lineTemp,0); }\n            if (i &gt;= 0 &amp;&amp; i&lt;=5) { *(arr[x][i]) = atoi(lineTemp); }\n            i++;\n        }\n</code></pre>\n\n<p>Thanks again for the tip.\nCheers</p>\n"}], "owner": {"reputation": 19, "user_id": 1936647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847f52921e03d21345caeaefae0f0dd7?s=128&d=identicon&r=PG", "display_name": "BMFS", "link": "https://stackoverflow.com/users/1936647/bmfs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463067725, "creation_date": 1462985463, "question_id": 37168819, "link": "https://stackoverflow.com/questions/37168819/strategy-for-cycling-trough-preexisting-set-of-variables-in-c", "title": "Strategy for cycling trough preexisting set of variables in c", "body": "<p>I\u2019m trying to program a HMI console to read a file from an USB pen drive and display its data on the screen. This is a csv file and the objective is to store the interpreted data to HMI console memory, which the HMI console later interprets. The macros on these consoles run in C (not C++).</p>\n\n<p>I have no issue with both reading and interpreting the file, the issue that the existing function (not accessible to me, shown below) to write in the console memory only interprets char.</p>\n\n<pre><code>int WriteLocal( const char *type, int addr, int nRegs, void *buf , int flag );\n\nParameter:     type    is the string of \"LW\",\"LB\" etc;\n               address is the Operation address ;\n               nRegs   is the length of read or write ;\n               buf     is the buffer which store the reading or writing data\n               flag    is 0,then codetype is BIN,is 1  then codetype is BCD;\nreturn value : 1  , Operation success\n               0  , Operation fail.\n</code></pre>\n\n<p>As my luck would have it I need to write integer values. What are available to me are the variables for each memory position. These are preexisting and are named individually such as:</p>\n\n<pre><code>int WR_LW200;\nint WR_LW202;\nint WR_LW204;\n...\nint WR_LW20n;\n</code></pre>\n\n<p>Ideally we could have a vector with all the names of the variables but unfortunately this is not possible. I could manually write every single variable but I need to do 300 of these\u2026\nmust be a better way, right?</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1462985561, "post_id": 37168752, "comment_id": 61872624, "body": "Look up <code>pthread_join</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5618848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x2lbR.png?s=128&g=1", "display_name": "kevin556", "link": "https://stackoverflow.com/users/5618848/kevin556"}, "edited": false, "score": 0, "creation_date": 1462985708, "post_id": 37168858, "comment_id": 61872712, "body": "Thanks I&#39;ve added it to my program and now it&#39;s working.Do I have to put pthread_join to avoid synchronisation problem ?"}], "tags": [], "owner": {"reputation": 21474, "user_id": 718379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4810c6c963334e5dce573e6671d746ec?s=128&d=identicon&r=PG", "display_name": "timrau", "link": "https://stackoverflow.com/users/718379/timrau"}, "is_accepted": true, "score": 4, "last_activity_date": 1462985584, "creation_date": 1462985584, "answer_id": 37168858, "question_id": 37168752, "link": "https://stackoverflow.com/questions/37168752/pthread-t-not-starting/37168858#37168858", "title": "Pthread_t not starting", "body": "<p>Insert <code>pthread_join(a, NULL)</code> after <code>pthread_create()</code> and before <code>return EXIT_SUCCESS;</code> to ensure the child thread is finished before <code>main()</code> returns.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1463038910, "last_edit_date": 1463038910, "creation_date": 1462985943, "answer_id": 37168972, "question_id": 37168752, "link": "https://stackoverflow.com/questions/37168752/pthread-t-not-starting/37168972#37168972", "title": "Pthread_t not starting", "body": "<p><code>pthread_join()</code> is a way but it's not the <em>only</em> solution.</p>\n\n<p>If your main thread doesn't (need) to be alive for longer (than the thread it creates), it could simply exit with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow\"><code>pthread_exit(0)</code></a>.</p>\n\n<p>When a main thread exits using <code>pthread_exit()</code> the process stays alive until the <em>last</em> thread in the process exits.</p>\n\n<p>This is useful when main thread does initialization/setup and starts multiple threads and then it's not needed anymore.\nOtherwise, it'll have to wait for <em>all</em> threads to complete (remember that when main() exits, the whole process exits - calling <code>pthread_exit()</code> will exit only the main <em>thread</em>, not the entire process).</p>\n"}], "owner": {"reputation": 37, "user_id": 5618848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x2lbR.png?s=128&g=1", "display_name": "kevin556", "link": "https://stackoverflow.com/users/5618848/kevin556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 37168858, "answer_count": 2, "score": -1, "last_activity_date": 1463038910, "creation_date": 1462985205, "last_edit_date": 1462985673, "question_id": 37168752, "link": "https://stackoverflow.com/questions/37168752/pthread-t-not-starting", "title": "Pthread_t not starting", "body": "<p>I wrote this brief example in order to understand thread programming in C.It was supposed to write \"thread 0\". But there is no output.\nHere is the code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\nint i=0;\npthread_mutex_t mutex;\n\nvoid * fonction(){\n    pthread_mutex_lock(&amp;mutex);\n    printf(\"thread %d \\n\",i++);\n    pthread_mutex_unlock(&amp;mutex);\n    pthread_exit(NULL);\n}\n\nint main(){\n    pthread_t a;\n    pthread_mutex_init(&amp;mutex,NULL);\n    pthread_create(&amp;a,NULL,fonction,NULL);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Can someone help me ?\nPs : I used this to compile it</p>\n\n<pre><code>gcc -pthread test.c -o test\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 3, "creation_date": 1462982334, "post_id": 37167726, "comment_id": 61870669, "body": "Please also post how is the <code>raw_n</code> is defined."}, {"owner": {"reputation": 79, "user_id": 5672726, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d01a16e4b30bd2afb952c516bb75698?s=128&d=identicon&r=PG", "display_name": "Carlos Gomez", "link": "https://stackoverflow.com/users/5672726/carlos-gomez"}, "edited": false, "score": 0, "creation_date": 1462982689, "post_id": 37167726, "comment_id": 61870905, "body": "Sorry, I changed that on porpuse trying to identify the problem, but like you say in this case is a square matrix"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1462983589, "post_id": 37167726, "comment_id": 61871486, "body": "Just a wild guess, would&#39;nt you have <code>int n_raw[MAX_ROWS][MAX_COLS];</code> and then process it as <code>saveFile(image_name_extension,image_name_info,rows,columns,r&zwnj;&#8203;aw_n);</code> with <code>rows &lt; MAX_ROWS</code> and <code>cols &lt; MAX_COLS</code>?"}, {"owner": {"reputation": 79, "user_id": 5672726, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d01a16e4b30bd2afb952c516bb75698?s=128&d=identicon&r=PG", "display_name": "Carlos Gomez", "link": "https://stackoverflow.com/users/5672726/carlos-gomez"}, "edited": false, "score": 0, "creation_date": 1462984891, "post_id": 37167726, "comment_id": 61872268, "body": "MAX_ROWS and MAX_COLS are 500"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 3, "last_activity_date": 1462986853, "creation_date": 1462986853, "answer_id": 37169249, "question_id": 37167726, "link": "https://stackoverflow.com/questions/37167726/passing-matrix-as-argument-in-c-not-working/37169249#37169249", "title": "Passing matrix as argument in C not working", "body": "<p>In comments you have agreed that the array passed is defined similarly to</p>\n\n<pre><code>int n_raw[MAX_ROWS][MAX_COLS];\n</code></pre>\n\n<p>with both dimensions as 500. But you have defined the function as</p>\n\n<pre><code>void saveFile(char raw[],char inf[],int r, int c, int m[r][c])\n</code></pre>\n\n<p>with arguments <code>r = 5</code> and <code>c = 5</code>. The function believes what you have told it, and accesses the array incorrectly. The only information the function has about the array is what is in the function arguments. The array is not rearranged to suit the subset you want to access. The crucial information is the number of columns in the array, without which the compiler is unable to align each row.</p>\n\n<p>I suggest you change the function definition to</p>\n\n<pre><code>void saveFile(char raw[],char inf[],int r, int c, int m[MAX_ROWS][MAX_COLS])\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>void saveFile(char raw[],char inf[],int r, int c, int m[][MAX_COLS])\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5672726, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d01a16e4b30bd2afb952c516bb75698?s=128&d=identicon&r=PG", "display_name": "Carlos Gomez", "link": "https://stackoverflow.com/users/5672726/carlos-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "closed_date": 1463215677, "accepted_answer_id": 37169249, "answer_count": 1, "score": -5, "last_activity_date": 1462986853, "creation_date": 1462982145, "last_edit_date": 1462982627, "question_id": 37167726, "link": "https://stackoverflow.com/questions/37167726/passing-matrix-as-argument-in-c-not-working", "closed_reason": "Duplicate", "title": "Passing matrix as argument in C not working", "body": "<p>Im passing a matrix as argument in a function call saveFile</p>\n\n<pre><code>void saveFile(char raw[],char inf[],int r, int c, int m[r][c]){\n\n   FILE *save_raw,*save_inf;        \n   int i,j;\n\n   save_raw = fopen(raw,\"w\");\n   save_inf = fopen(inf,\"w\");\n\n    for(i=0;i&lt;r;i++){\n       for(j=0;j&lt;c;j++){\n           fprintf(save_raw,\"%d \",m[i][j]);     \n       }\n\n       fprintf(save_raw,\"\\n\");\n    }\n</code></pre>\n\n<p>And Im calling the fuction like this</p>\n\n<pre><code>saveFile(image_name_extension,image_name_info,rows,columns,raw_n);\n</code></pre>\n\n<p>The output of raw_n before calling the function is:</p>\n\n<pre><code>0 132 132 246 237\n0 223 132 246 237\n0 132 132 246 237\n230 132 132 246 237\n0 166 142 246 248\n</code></pre>\n\n<p>but for some reason I dont now the output of raw_n inside the saveFile function is:</p>\n\n<pre><code>0 132 132 246 237\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n</code></pre>\n\n<p>I'ts not a logical problem, anybody can help me? Thanks.</p>\n\n<p>raw_n is filled like this</p>\n\n<pre><code>for(i=0;i&lt;rows;i++){\n    for(j=0;j&lt;columns;j++){\n        raw_n[i][j] = MAX_PIXEL - raw[i][j];\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "visual-c++", "intel-mkl"], "comments": [{"owner": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "edited": false, "score": 0, "creation_date": 1462993696, "post_id": 37167719, "comment_id": 61877360, "body": "Have you tried to use cblas API rather than Fortan API in your C code?"}, {"owner": {"reputation": 347, "user_id": 3783576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8e9b2374ea146c877b1107d82febedaf?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewJohnHeath", "link": "https://stackoverflow.com/users/3783576/matthewjohnheath"}, "reply_to_user": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "edited": false, "score": 0, "creation_date": 1463040200, "post_id": 37167719, "comment_id": 61894994, "body": "@Eric I have now. If I replace the line` dcopy...` with <code>cblas_dcopy(10,threes,copy1)</code>then that line throws <code>Access violation reading location 0xFFFFFFFFFFFFFFFF</code> after managing to copy the first 3. Also the code I need to call (SuperLU) uses the Fortran declarations with &quot;extern&quot; <code>cblas_dasum</code> actually seems to work fine"}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1463051691, "post_id": 37184488, "comment_id": 61903269, "body": "ilp64 library expects long long int ."}, {"owner": {"reputation": 347, "user_id": 3783576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8e9b2374ea146c877b1107d82febedaf?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewJohnHeath", "link": "https://stackoverflow.com/users/3783576/matthewjohnheath"}, "edited": false, "score": 0, "creation_date": 1463056459, "post_id": 37184488, "comment_id": 61906741, "body": "yep, thanks. I had actually used the Link Line Advisor to work out what I needed in Fortran then copied those over without really thinking about it."}], "tags": [], "owner": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "is_accepted": true, "score": 1, "last_activity_date": 1463050010, "last_edit_date": 1463050010, "creation_date": 1463049554, "answer_id": 37184488, "question_id": 37167719, "link": "https://stackoverflow.com/questions/37167719/mkl-blas-functions-not-behaving-as-expected/37184488#37184488", "title": "MKL BLAS functions not behaving as expected", "body": "<p>Please check the libraries you link when porting from Fortran to C/C++. MKL requires different libraries and compiling flags with different compilers and settings. At least <code>mkl_blas95_ilp64.lib</code> is not required with C compiler.</p>\n\n<p>Also ILP64 is not common compared to the default model LP64.</p>\n\n<p>MKL Link Line Advisor is a tool provided by Intel to solve this issue. You could use it to check if your libraries and compiling flags are correct.</p>\n\n<p><a href=\"https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor\" rel=\"nofollow\">https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor</a></p>\n"}], "owner": {"reputation": 347, "user_id": 3783576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8e9b2374ea146c877b1107d82febedaf?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewJohnHeath", "link": "https://stackoverflow.com/users/3783576/matthewjohnheath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 37184488, "answer_count": 1, "score": 0, "last_activity_date": 1463050010, "creation_date": 1462982116, "last_edit_date": 1463049891, "question_id": 37167719, "link": "https://stackoverflow.com/questions/37167719/mkl-blas-functions-not-behaving-as-expected", "title": "MKL BLAS functions not behaving as expected", "body": "<p>I can't get Intel MKL to work as it should from C. \nI have the following test program:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include\"mkl.h\"\nint main()\n{\n    int one = 1;\n    int ten = 10;\n    double copy[10];\n    double threes[10];\n\n    for (int i = 0; i &lt; 10; ++i) threes[i] = 3;\n\n    dcopy(&amp;ten, threes, &amp;one, copy, &amp;one);\n    double l1norm;\n    l1norm = dasum(&amp;ten, threes, &amp;one);\n    return 0;\n}\n</code></pre>\n\n<p>which is building and linking fine but not doing what I intended. Specifically  at the return line the array \"copy\" continues to be full of what was there when it was declared and l1norm equal to 0. \nI am linking to the libraries : mkl_blas95_ilp64.lib, mkl_core_dll.lib, mkl_intel_ilp64_dll.lib and mkl_intel_thread_dll.lib.</p>\n\n<p>I'm also getting similar problems when running third-party code that calls MKL so I assume the problem is how I have the build configured (in Visual Studio 2015).</p>\n\n<p>The equivalent Fortran program runs fine.   </p>\n"}, {"tags": ["c", "macros", "standards", "variadic"], "answers": [{"tags": [], "owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "is_accepted": false, "score": 1, "last_activity_date": 1462982254, "creation_date": 1462982254, "answer_id": 37167763, "question_id": 37167661, "link": "https://stackoverflow.com/questions/37167661/variadic-macros-comma-before-the-ellipsis/37167763#37167763", "title": "Variadic macros - Comma before the ellipsis?", "body": "<p>GCC has its own rules. A comma before the ellipses means the parameter is required, no comma means it is optional.</p>\n"}], "owner": {"reputation": 818, "user_id": 3688293, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/044211651200793b2656b9942e7cbe89?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3688293/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462982389, "creation_date": 1462981938, "last_edit_date": 1462982389, "question_id": 37167661, "link": "https://stackoverflow.com/questions/37167661/variadic-macros-comma-before-the-ellipsis", "title": "Variadic macros - Comma before the ellipsis?", "body": "<p>I have the following code:</p>\n\n<pre><code>#define MACRO(x...) x\nMACRO(foo,bar)\n</code></pre>\n\n<p>which, using <code>gcc -E</code>, shows that <code>MACRO</code> expands to <code>foo,bar</code>. However, the C11 standard defines the following syntax for function-like macros:</p>\n\n<blockquote>\n<pre><code># define identifier lparen identifier-list opt ) replacement-list new-line\n# define identifier lparen ... ) replacement-list new-line\n# define identifier lparen identifier-list , ... ) replacement-list new-line\n</code></pre>\n</blockquote>\n\n<p>none of which seem to allow the <code>x...</code> bit. Oddly enough, the snippet above expands to <code>foo,bar</code>, while <code>#define MACRO(x, ...) x</code> correctly expands to <code>foo</code>. Is this a gcc bug, or am I missing something?</p>\n\n<p><strong>EDIT:</strong> Nevermind, this seems to be a gcc extension, documented <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": ["c", "linux", "system-calls"], "comments": [{"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1462980753, "post_id": 37167141, "comment_id": 61869557, "body": "after the asm call to syscall, check the content of errno, it should still be in it."}, {"owner": {"reputation": 9778, "user_id": 474034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zKYWU.jpg?s=128&g=1", "display_name": "lanoxx", "link": "https://stackoverflow.com/users/474034/lanoxx"}, "reply_to_user": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1462981004, "post_id": 37167141, "comment_id": 61869720, "body": "@PierreEmmanuelLallemant No <code>errno</code> is defined by glibc or what ever C standard library is being used. If I am not using such a library then I need to manually get the error number from a register. Trying to use <code>errno</code> gives me the following compile error: <b>error: \u2018errno\u2019 undeclared (first use in this function)</b>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1462982121, "post_id": 37167141, "comment_id": 61870507, "body": "I have very (20 years) old knowledge of this, so this might not be true anymore but Linux used to (and still sometimes does) treat any negative return value as an error and the absolute value of that is the errno."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1462987733, "post_id": 37167141, "comment_id": 61873896, "body": "The posted error is EFAULT"}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462992936, "post_id": 37167141, "comment_id": 61876940, "body": "@Art: you are still right."}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1462993043, "post_id": 37167141, "comment_id": 61877005, "body": "But the &quot;errno&quot; used in the kernel may be different that the errno wrapped by the C wrap function."}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462993112, "post_id": 37167141, "comment_id": 61877047, "body": "@Art: IIRC, it was any number between -1 and -4095"}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "reply_to_user": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1462993285, "post_id": 37167141, "comment_id": 61877135, "body": "@PierreEmmanuelLallemant: any example besides <code>close()</code> <code>EINPROGRESS&#47;EINTR</code> ?"}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "reply_to_user": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 0, "creation_date": 1462997212, "post_id": 37167141, "comment_id": 61879297, "body": "@ninjalj: i don&#39;t understand, can you explain what i&#39;m wrong with ? :/"}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 1, "creation_date": 1462999951, "post_id": 37167141, "comment_id": 61880739, "body": "You said the &quot;errno&quot; used in the kernel may be different that the errno wrapped by the C wrap function, but (after trivial conversion) the only case I can think of is <code>close()</code>, which in Linux returns <code>EINTR</code> for a failure case that now POSIX says should be <code>EINPROGRESS</code>:  <a href=\"http://ewontfix.com/4/\" rel=\"nofollow noreferrer\">ewontfix.com/4</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9778, "user_id": 474034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zKYWU.jpg?s=128&g=1", "display_name": "lanoxx", "link": "https://stackoverflow.com/users/474034/lanoxx"}, "edited": false, "score": 0, "creation_date": 1463040572, "post_id": 37167715, "comment_id": 61895242, "body": "Thanks, I also saw this table, but IMHO the missing clue was that the error number is returned as a negative of the actual error number."}], "tags": [], "owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "is_accepted": false, "score": 5, "last_activity_date": 1462982471, "last_edit_date": 1462982471, "creation_date": 1462982113, "answer_id": 37167715, "question_id": 37167141, "link": "https://stackoverflow.com/questions/37167141/linux-syscalls-and-errno/37167715#37167715", "title": "Linux syscalls and errno", "body": "<h2>Architecture Calling Conventions</h2>\n\n<p>As you already guessed, you can't use <code>errno</code> because it's <strong><a href=\"http://www.gnu.org/software/libc/manual/html_node/Error-Messages.html\" rel=\"noreferrer\">GLibC specific</a></strong>. The information you want will be in <code>rax</code> if it's a <code>x86_64</code>. The man page <a href=\"http://man7.org/linux/man-pages/man2/syscall.2.html\" rel=\"noreferrer\"><strong><code>man 2 syscall</code></strong></a> has the following explanation: </p>\n\n<pre><code>Architecture calling conventions\n\n       Every architecture has its own way of invoking and passing arguments\n       to the kernel.  The details for various architectures are listed in\n       the two tables below.\n\n       The first table lists the instruction used to transition to kernel\n       mode (which might not be the fastest or best way to transition to the\n       kernel, so you might have to refer to vdso(7)), the register used to\n       indicate the system call number, the register used to return the\n       system call result, and the register used to signal an error.\n\n       arch/ABI    instruction           syscall #  retval  error    Notes\n       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n       alpha       callsys               v0         a0      a3       [1]\n       arc         trap0                 r8         r0      -\n       arm/OABI    swi NR                -          a1      -        [2]\n       arm/EABI    swi 0x0               r7         r0      -\n       arm64       svc #0                x8         x0      -\n       blackfin    excpt 0x0             P0         R0      -\n       i386        int $0x80             eax        eax     -\n       ia64        break 0x100000        r15        r8      r10      [1]\n       m68k        trap #0               d0         d0      -\n       microblaze  brki r14,8            r12        r3      -\n       mips        syscall               v0         v0      a3       [1]\n       nios2       trap                  r2         r2      r7\n       parisc      ble 0x100(%sr2, %r0)  r20        r28     -\n       powerpc     sc                    r0         r3      r0       [1]\n       s390        svc 0                 r1         r2      -        [3]\n       s390x       svc 0                 r1         r2      -        [3]\n       superh      trap #0x17            r3         r0      -        [4]\n       sparc/32    t 0x10                g1         o0      psr/csr  [1]\n       sparc/64    t 0x6d                g1         o0      psr/csr  [1]\n       tile        swint1                R10        R00     R01      [1]\n       x86_64      syscall               rax        rax     -        [5]\n       x32         syscall               rax        rax     -        [5]\n       xtensa      syscall               a2         a2      -\n</code></pre>\n\n<p>And note number <code>[5]</code>:</p>\n\n<pre><code>[5] The x32 ABI uses the same instruction as the x86_64 ABI and\n               is used on the same processors.  To differentiate between\n               them, the bit mask __X32_SYSCALL_BIT is bitwise-ORed into the\n               system call number for system calls under the x32 ABI.  Both\n               system call tables are available though, so setting the bit\n               is not a hard requirement.\n</code></pre>\n\n<p><em>(In that man page, a table showing how to pass arguments to system calls follows. It's an interesting read.)</em></p>\n\n<hr>\n\n<blockquote>\n  <p><strong>How are error numbers returned from a syscall (e.g. write) in this environment?</strong>:</p>\n</blockquote>\n\n<p>You gotta check your <code>rax</code> register for the return value.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1541071504, "post_id": 37167720, "comment_id": 93096100, "body": "You can check for errors from <i>any</i> system call by checking for <code>-4095..-1</code>.  The last page of memory is reserved so you can&#39;t mmap or have the kernel use it internally so that this range is never a valid address.   <a href=\"https://stackoverflow.com/q/38751614\">What are the return values of system calls in Assembly?</a>"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 9, "last_activity_date": 1462982121, "creation_date": 1462982121, "answer_id": 37167720, "question_id": 37167141, "link": "https://stackoverflow.com/questions/37167141/linux-syscalls-and-errno/37167720#37167720", "title": "Linux syscalls and errno", "body": "<p>The linux syscall's convention is that they encode both the possible error code and the return value for successful call in the return value. It's just glibc or other C libraries's wrappers that they will set <code>errno</code> to the error code returned by the underline syscall, and the wrapper will return <code>-1</code>. Take the <code>write</code> as an example, the kernel does the error processing similar to this:</p>\n\n<pre><code>ssize_t write(int fd, ...) {\n    if (fd is not valid)\n         return -EBADF;\n    return do_write(...);\n}\n</code></pre>\n\n<p>So as you can see, the error code is just in the return value, and depending on the semantics, there is always a way to check if the syscall succeeded or not by comparing it to a value not possible for successful operation. For most syscalls, like the <code>write</code> one, that means check if it is negative.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1462988740, "creation_date": 1462988740, "answer_id": 37169875, "question_id": 37167141, "link": "https://stackoverflow.com/questions/37167141/linux-syscalls-and-errno/37169875#37169875", "title": "Linux syscalls and errno", "body": "<p>IIRC in the x86-64 ABI, an error is transmitted from the syscall with the carry bit set. Then <code>eax</code>  contains the <code>errno</code> code.</p>\n\n<p>I would suggest to study the lower layers of the source code of some libc library, like <a href=\"http://musl-libc.org/\" rel=\"nofollow\">musl-libc</a> </p>\n"}, {"comments": [{"owner": {"reputation": 5533, "user_id": 6392939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e950198a9f8742974cf43adc2ac18a?s=128&d=identicon&r=PG&f=1", "display_name": "RamenChef", "link": "https://stackoverflow.com/users/6392939/ramenchef"}, "edited": false, "score": 0, "creation_date": 1478111616, "post_id": 40386730, "comment_id": 68026353, "body": "While the link would eventually go stale, it can be fixed by community edits, and is great for backing up your answer."}], "tags": [], "owner": {"reputation": 366, "user_id": 5717309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72de09c2f3bc1be246010cf38ad4a9ea?s=128&d=identicon&r=PG", "display_name": "David Yeager", "link": "https://stackoverflow.com/users/5717309/david-yeager"}, "is_accepted": false, "score": 4, "last_activity_date": 1481781640, "last_edit_date": 1481781640, "creation_date": 1478109613, "answer_id": 40386730, "question_id": 37167141, "link": "https://stackoverflow.com/questions/37167141/linux-syscalls-and-errno/40386730#40386730", "title": "Linux syscalls and errno", "body": "<p>On Linux, a failed system call using the syscall assembly instruction will return the value -errno in the rax register. So in your case 0-0xfffffffffffffff2 == 0xE which is 14. So your errno is 14.</p>\n\n<p>How do you find what errno 14 means? You should google search \"Linux error code table\" or look in errno.h and you'll find the answer.</p>\n\n<p>Take a look here:\n<a href=\"http://www.virtsync.com/c-error-codes-include-errno\" rel=\"nofollow noreferrer\">http://www.virtsync.com/c-error-codes-include-errno</a></p>\n\n<p>According to that table, 14 is EFAULT which means \"Bad address\".  </p>\n"}], "owner": {"reputation": 9778, "user_id": 474034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zKYWU.jpg?s=128&g=1", "display_name": "lanoxx", "link": "https://stackoverflow.com/users/474034/lanoxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6216, "favorite_count": 1, "accepted_answer_id": 37167720, "answer_count": 4, "score": 7, "last_activity_date": 1481781640, "creation_date": 1462980553, "last_edit_date": 1462988110, "question_id": 37167141, "link": "https://stackoverflow.com/questions/37167141/linux-syscalls-and-errno", "title": "Linux syscalls and errno", "body": "<p><strong>Context:</strong> I am trying to write a small C program with inline asm that should run under Linux on an x86_64 system and being compiled with gcc in order to better understand how syscalls work under Linux.</p>\n\n<p>My question is: How are error numbers returned from a syscall (e.g. write) in this environment? I understand that when I use a library such as glibc, it takes care of saving the resulting error code in the global <code>errno</code> variable. But where is the error number stored when I call a syscall directly through inline assembler? Will it be stored inside a separate register, or will it be encoded in <code>%rax</code>?</p>\n\n<p>Let take the write syscall on linux as an example:</p>\n\n<p>When call <code>write</code> then after the syscall returns I find it stores <code>0xfffffffffffffff2</code> inside <code>%rax</code>, do I need to \nsomehow extract the error code from that? </p>\n\n<p>If I have the error code number, where should I look to identify the actual error that occured? Lets say I get the number 5 returned, which header file do I need to consult to find the corresponding symbolic error name.</p>\n\n<p>I am calling the write syscall like this:</p>\n\n<pre><code>asm (\"mov $1,%%rax;\"\n     \"mov $1,%%rdi;\"\n     \"mov %1,%%rsi;\"\n     \"mov %2,%%rdx;\"\n     \"syscall;\"\n     \"mov %%rax,%0;\"\n     : \"=r\" (result)\n     : \"r\" (msg), \"r\" (len)\n     : \"%rdx\", \"%rsi\", \"%rax\", \"%rdi\" /* EDIT: this is needed or else the registers will be overwritten */\n    );\n</code></pre>\n\n<p>with <code>result</code>, <code>msg</code> and <code>len</code> defined like so:</p>\n\n<pre><code>long result = 0;\nchar* msg = \"Hello World\\n\";\nlong len = 12;\n</code></pre>\n"}, {"tags": ["c", "ethernet"], "comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 3, "creation_date": 1462979820, "post_id": 37166834, "comment_id": 61868881, "body": "Print the octets as hex or decimal digits to see what the values are.  do not depend on the octet being a printable character."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462979832, "post_id": 37166834, "comment_id": 61868893, "body": "Remove the first line of code. It is potentially dangerous."}, {"owner": {"reputation": 1107, "user_id": 3930460, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/7saJD.jpg?s=128&g=1", "display_name": "Kevin Wu", "link": "https://stackoverflow.com/users/3930460/kevin-wu"}, "edited": false, "score": 0, "creation_date": 1462980100, "post_id": 37166834, "comment_id": 61869105, "body": "Hi Richard Chambers, I printed the results as decimals: I get 0, 22, 62, 95, 2 and 31 in the array that is of size 6. How can I interpret those numbers?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462982097, "post_id": 37166834, "comment_id": 61870483, "body": "As @Olaf said, why are you doing this: <code>(void)hwaddr; (void)dst_mac;</code>"}, {"owner": {"reputation": 1107, "user_id": 3930460, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/7saJD.jpg?s=128&g=1", "display_name": "Kevin Wu", "link": "https://stackoverflow.com/users/3930460/kevin-wu"}, "edited": false, "score": 0, "creation_date": 1462982308, "post_id": 37166834, "comment_id": 61870643, "body": "To avoid compiler warnings"}, {"owner": {"reputation": 2412, "user_id": 1191058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09eeee14385ba75f18adb473ccffe208?s=128&d=identicon&r=PG", "display_name": "j123b567", "link": "https://stackoverflow.com/users/1191058/j123b567"}, "edited": false, "score": 0, "creation_date": 1462984693, "post_id": 37166834, "comment_id": 61872148, "body": "What is your input to this function? &quot;00:16:3e:5f:02:1f&quot;?"}, {"owner": {"reputation": 1107, "user_id": 3930460, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/7saJD.jpg?s=128&g=1", "display_name": "Kevin Wu", "link": "https://stackoverflow.com/users/3930460/kevin-wu"}, "edited": false, "score": 0, "creation_date": 1462984813, "post_id": 37166834, "comment_id": 61872228, "body": "Yes, that is my input"}, {"owner": {"reputation": 2412, "user_id": 1191058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09eeee14385ba75f18adb473ccffe208?s=128&d=identicon&r=PG", "display_name": "j123b567", "link": "https://stackoverflow.com/users/1191058/j123b567"}, "edited": false, "score": 0, "creation_date": 1462984827, "post_id": 37166834, "comment_id": 61872234, "body": "Why are you using so weird pointer arithmetics and not just simply array access e.g.<code>dst_mac[i] = ether_address-&gt;ether_addr_octet[i]</code>?"}, {"owner": {"reputation": 2412, "user_id": 1191058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09eeee14385ba75f18adb473ccffe208?s=128&d=identicon&r=PG", "display_name": "j123b567", "link": "https://stackoverflow.com/users/1191058/j123b567"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1462985084, "post_id": 37166834, "comment_id": 61872369, "body": "So the <code>ether_aton</code> is working correctly. You just misinterpret the results. Mac address has hexadecimal values separated by &quot;:&quot;. If you print your numbers as hexadecimal as proposed by @RichardChambers, you will get exactly the same numbers as in your mac address. try <code>printf(&quot;%02x &quot;, ether_address-&gt;ether_addr_octet[i])</code> in the loop."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462988176, "post_id": 37166834, "comment_id": 61874171, "body": "There is a good reason the compiler warns about unused arguments. Only use such dummy statements if you intend not to use a paramter intentionally. And then <b>always</b> leave a comment with that statement. There will be no warning for <code>hwaddr</code>, as that is used. <b>Instantly</b> remove such dummy-expressions if you use/intend to use a parameter."}], "answers": [{"tags": [], "owner": {"reputation": 1107, "user_id": 3930460, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/7saJD.jpg?s=128&g=1", "display_name": "Kevin Wu", "link": "https://stackoverflow.com/users/3930460/kevin-wu"}, "is_accepted": true, "score": 1, "last_activity_date": 1462982026, "creation_date": 1462982026, "answer_id": 37167686, "question_id": 37166834, "link": "https://stackoverflow.com/questions/37166834/c-ether-aton-does-not-work/37167686#37167686", "title": "C: ether_aton does not work", "body": "<p>Basically, ether_aton converts your MAC Address, which has hexadecimal characters separated by colons to numbers. In my code, I am trying to print %c, when I should be printing %d.</p>\n"}], "owner": {"reputation": 1107, "user_id": 3930460, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/7saJD.jpg?s=128&g=1", "display_name": "Kevin Wu", "link": "https://stackoverflow.com/users/3930460/kevin-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 37167686, "answer_count": 1, "score": 0, "last_activity_date": 1462982026, "creation_date": 1462979690, "last_edit_date": 1462980150, "question_id": 37166834, "link": "https://stackoverflow.com/questions/37166834/c-ether-aton-does-not-work", "title": "C: ether_aton does not work", "body": "<p>I have the following function:</p>\n\n<pre><code>int parse_mac(const char *hwaddr, uint8_t *dst_mac)\n{\n    (void)hwaddr; (void)dst_mac;\n\n    //TODO: Parse the MAC address (string) pointed to by hwaddr and store\n    //the result in dst. Return 0 on success and -1 on error.\n\n    struct ether_addr* ether_address = ether_aton(hwaddr);\n    if(ether_address==NULL){\n        return -1;\n    }\n    int i;\n    for(i=0;i&lt;6;i++){\n        //*(dst_mac+i) = (*ether_address).ether_addr_octet[i];\n    }\n    printf(\"%c\\n\",(*ether_address).ether_addr_octet[0]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Given a MAC address (pointed to by hwaddr), I want to convert that into my <code>dst_mac</code> variable through <code>ether_aton</code>. However, The array inside the <code>ether_address</code> result struct is empty or so it seems. For example, the printf at the bottom gives me an empty char. What's wrong? </p>\n"}, {"tags": ["c", "if-statement", "boolean", "assignment-operator"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1462980049, "post_id": 37166250, "comment_id": 61869072, "body": "Any halfway modern compiler will warn about that for good reasons"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462980355, "post_id": 37166250, "comment_id": 61869279, "body": "@Olaf Even after using <code>((..))</code>?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462980953, "post_id": 37166250, "comment_id": 61869690, "body": "@SouravGhosh: Hmm, I really did not notice them. Ok, I change to &quot;should&quot;. Verified with gcc: It even suggest the parentheses to avoid the warning (and they work). Heck, that should require an explicit comparison to suppress the warning, nothing less visible. Thanks for informing me."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462988781, "post_id": 37166250, "comment_id": 61874554, "body": "The marked duplicate is not an duplicate, because the linked question answers about the usage and this question asks about the behavior. I&#39;m reopening this. :)"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462979983, "post_id": 37166283, "comment_id": 61869030, "body": "C very well has a boolean type. And in a condition, any expression is converted to a boolean result (of type <code>int</code>, though)."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462981048, "post_id": 37166283, "comment_id": 61869756, "body": "The <code>bool</code> type is just an <code>unsigned int</code>. Fundamentally, the language deals with &quot;zero&quot; and &quot;non-zero&quot; as booleans, rather than <code>true</code>/<code>false</code> atoms."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462981683, "post_id": 37166283, "comment_id": 61870182, "body": "No, <code>_Bool</code> is a distinct unsigned integer type with the values <code>0</code> and <code>1</code> <code>bool</code> is a macro in <code>stdbool.h</code> which maps to <code>_Bool</code>. It is <b>not</b> <code>unsigned int</code>. Note: This is standard C, not some homebrew <code>typedef</code>! About the &quot;true&quot;/&quot;false&quot; interpretation: Try <code>_Bool b = 4;</code> or <code>printf(&quot;%d&quot;, (bool)5);</code>. Note that boolean logic does not define how &quot;true&quot;/&quot;false&quot; have to be represented. Often they are by <code>0</code>/<code>1</code>, because that simplifies mathematical operations. See Wikipedia."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462987738, "post_id": 37166283, "comment_id": 61873903, "body": "It would be better to read the C standard directly (specifically 6.2.5p2 and p6 e.g.) instead of a second/third source. Maybne you will find some other new features since the last 17 years. You might also find that <code>NULL</code> is a macro with a <i>null pointer constant</i>, not a specific value. A pointer variable can only be a <i>null pointer</i>. And that is not required to have a binary representation of all-zeros. Still, such a null pointer has to evaluate &quot;false&quot;."}], "tags": [], "owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1462982190, "last_edit_date": 1462982190, "creation_date": 1462978384, "answer_id": 37166283, "question_id": 37166250, "link": "https://stackoverflow.com/questions/37166250/how-the-assignment-statement-in-an-if-statement-serves-as-a-condition/37166283#37166283", "title": "How the assignment statement in an if statement serves as a condition?", "body": "<p>C considers anything non-zero to be <code>true</code>, and anything 0 to be false.</p>\n\n<p>This assignment's value is equal to the value it assigns to <code>vnd</code>, in this case, a <code>struct diam_vnd_t *</code>. The if statement checks whether or not <code>vnd</code> is <code>NULL</code> after the assignment.</p>\n\n<p>This would be equivalent to:</p>\n\n<pre><code>vnd = (struct diam_vnd_t *)g_hash_table_lookup(vendors,vend);\nif (vnd) {...}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2845, "user_id": 856275, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a179c7fab5fb465e4534dc744122483a?s=128&d=identicon&r=PG", "display_name": "CaldwellYSR", "link": "https://stackoverflow.com/users/856275/caldwellysr"}, "is_accepted": false, "score": 0, "last_activity_date": 1462978470, "creation_date": 1462978470, "answer_id": 37166330, "question_id": 37166250, "link": "https://stackoverflow.com/questions/37166250/how-the-assignment-statement-in-an-if-statement-serves-as-a-condition/37166330#37166330", "title": "How the assignment statement in an if statement serves as a condition?", "body": "<p>The logical operator for \"is equal to\" is <code>==</code></p>\n\n<p>When you're saying <code>vnd = (struct...</code> you are assigning everything after <code>=</code> to the variable <code>vnd</code>. If you want a true or false you need to use <code>==</code></p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462979918, "post_id": 37166336, "comment_id": 61868970, "body": "<code>int i = 0;</code> is <b>not</b> an assignment."}, {"owner": {"reputation": 2933, "user_id": 1034876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/538dfb9283fb8c5b044db793f7bc9975?s=128&d=identicon&r=PG", "display_name": "element11", "link": "https://stackoverflow.com/users/1034876/element11"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462987080, "post_id": 37166336, "comment_id": 61873516, "body": "@Olaf  <code>int i; &#47;&#47;declaration</code>, <code>i = 0; &#47;&#47;assignment</code> &lt;-- Like that?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462987645, "post_id": 37166336, "comment_id": 61873849, "body": "These are different things!"}, {"owner": {"reputation": 2933, "user_id": 1034876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/538dfb9283fb8c5b044db793f7bc9975?s=128&d=identicon&r=PG", "display_name": "element11", "link": "https://stackoverflow.com/users/1034876/element11"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1462990825, "post_id": 37166336, "comment_id": 61875812, "body": "@Olaf Right, I am aware of that, I just wanted to confirm thats what you were referring to. I suppose I should have seperated the two."}], "tags": [], "owner": {"reputation": 2933, "user_id": 1034876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/538dfb9283fb8c5b044db793f7bc9975?s=128&d=identicon&r=PG", "display_name": "element11", "link": "https://stackoverflow.com/users/1034876/element11"}, "is_accepted": false, "score": 0, "last_activity_date": 1462990855, "last_edit_date": 1462990855, "creation_date": 1462978485, "answer_id": 37166336, "question_id": 37166250, "link": "https://stackoverflow.com/questions/37166250/how-the-assignment-statement-in-an-if-statement-serves-as-a-condition/37166336#37166336", "title": "How the assignment statement in an if statement serves as a condition?", "body": "<p>Assignment is always done with one equal sign. <code>=</code></p>\n\n<pre><code>int i;\ni = 0; //assignment\n</code></pre>\n\n<p>This assigns 0 to an integer called <code>i</code>. </p>\n\n<p>The same thing happens with your if statement. Whether or not it is in an if statement is irrelevant.</p>\n\n<pre><code>(vnd = (struct diam_vnd_t *)g_hash_table_lookup(vendors,vend))\n</code></pre>\n\n<p>To do a boolean expression, you need to use <code>==</code>.</p>\n\n<pre><code>(vnd == (struct diam_vnd_t *)g_hash_table_lookup(vendors,vend))\n</code></pre>\n\n<p>This will return true or false based on the comparison of the 2 items</p>\n"}, {"comments": [{"owner": {"reputation": 315, "user_id": 6309247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-ivdVBvfPrZg/AAAAAAAAAAI/AAAAAAAAAsQ/rmYiwvBzbh4/photo.jpg?sz=128", "display_name": "SWIIWII", "link": "https://stackoverflow.com/users/6309247/swiiwii"}, "edited": false, "score": 1, "creation_date": 1462978774, "post_id": 37166422, "comment_id": 61868096, "body": "thanks, this is exactly what i need, i will accept it."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1462978797, "last_edit_date": 1462978797, "creation_date": 1462978696, "answer_id": 37166422, "question_id": 37166250, "link": "https://stackoverflow.com/questions/37166250/how-the-assignment-statement-in-an-if-statement-serves-as-a-condition/37166422#37166422", "title": "How the assignment statement in an if statement serves as a condition?", "body": "<p>Quoting <code>C11</code>, chapter \u00a76.5.16, <em>Assignment operators</em> (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>An assignment operator stores a value in the object designated by the left operand. <strong>An\n  assignment expression has the value of the left operand after the assignment,<sup>111)</sup> but is not\n  an lvalue.</strong></p>\n</blockquote>\n\n<p>So, first the assignment will happen, and then, the value that has been assigned will be used as the conditional statement in <code>if</code>.</p>\n\n<p>So, in case of </p>\n\n<pre><code>if (p = 0 )\n</code></pre>\n\n<p>will evaluate to FALSE and</p>\n\n<pre><code>if (p = 5)\n</code></pre>\n\n<p>will be TRUE.</p>\n"}], "owner": {"reputation": 315, "user_id": 6309247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-ivdVBvfPrZg/AAAAAAAAAAI/AAAAAAAAAsQ/rmYiwvBzbh4/photo.jpg?sz=128", "display_name": "SWIIWII", "link": "https://stackoverflow.com/users/6309247/swiiwii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1317, "favorite_count": 0, "accepted_answer_id": 37166422, "answer_count": 4, "score": 1, "last_activity_date": 1462990855, "creation_date": 1462978297, "last_edit_date": 1462988893, "question_id": 37166250, "link": "https://stackoverflow.com/questions/37166250/how-the-assignment-statement-in-an-if-statement-serves-as-a-condition", "title": "How the assignment statement in an if statement serves as a condition?", "body": "<pre><code>if ((vnd = (struct diam_vnd_t *)g_hash_table_lookup(vendors,vend))) {...}\n</code></pre>\n\n<p>Can you tell me why it is an assignment but not a boolean expression in the brackets ? And in what situation this assignment can be considered \"true\" or \"false\" ?</p>\n"}, {"tags": ["c", "pointers", "malloc", "pass-by-value"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1462976865, "post_id": 37165553, "comment_id": 61866663, "body": "The first one changes the pointer in the <code>main()</code> function; the second changes the copy of the pointer in the <code>Convert()</code> function, but doesn&#39;t change the pointer in the <code>main()</code> function, so the pointer in <code>main()</code> is uninitialized and you are lucky that you got a crash to tell you are doing it wrong (that wasn&#39;t guaranteed)."}], "answers": [{"tags": [], "owner": {"reputation": 10281, "user_id": 51760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SI89u.jpg?s=128&g=1", "display_name": "Aif", "link": "https://stackoverflow.com/users/51760/aif"}, "is_accepted": false, "score": 0, "last_activity_date": 1462976951, "creation_date": 1462976951, "answer_id": 37165708, "question_id": 37165553, "link": "https://stackoverflow.com/questions/37165553/c-function-parameters-and-pointers/37165708#37165708", "title": "C - function parameters and pointers", "body": "<p>There are two things you're changing:</p>\n\n<ul>\n<li>Function type</li>\n<li>Function invocation</li>\n</ul>\n\n<p>Since you want to modify the pointers value, you have to provide a pointer to the pointer to int.</p>\n\n<p>See <a href=\"https://www.eskimo.com/~scs/cclass/int/sx8.html\" rel=\"nofollow\">resources</a> on pointers to pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1462977369, "last_edit_date": 1462977369, "creation_date": 1462976952, "answer_id": 37165711, "question_id": 37165553, "link": "https://stackoverflow.com/questions/37165553/c-function-parameters-and-pointers/37165711#37165711", "title": "C - function parameters and pointers", "body": "<p>C uses pass by value for function parameter passing.</p>\n\n<ul>\n<li><p>In the first case, by passing the <em>address of the pointer</em> <code>p</code>, you were able to change the pointer itself. So, im <code>main()</code>, your <em>changes</em> are <em>reflected</em>.</p></li>\n<li><p>In he second case, the pointer <em>itself</em> cannot be changed, as it itself is passed-by-value. Once you return from the <code>Convert()</code> function, any changes made to <code>p</code> will be lost. So, in <code>main()</code>, you'll be accessing invalid memory (<code>*p</code>) which nvokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>. Hence the crash.</p></li>\n</ul>\n"}], "owner": {"reputation": 75, "user_id": 6061825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3104faa081dac3781c57a5719d72cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Pavoo", "link": "https://stackoverflow.com/users/6061825/pavoo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1462977056, "answer_count": 2, "score": -3, "last_activity_date": 1462977369, "creation_date": 1462976607, "last_edit_date": 1462977138, "question_id": 37165553, "link": "https://stackoverflow.com/questions/37165553/c-function-parameters-and-pointers", "closed_reason": "Duplicate", "title": "C - function parameters and pointers", "body": "<p>Consider two cases of calling a function:</p>\n\n<pre><code>void Convert(int number, int **staticPointer)\n{\n    int * dynamicPointer = malloc(sizeof(int));\n    *dynamicPointer = number;\n    *staticPointer = dynamicPointer;\n}\n\nint main()\n{\n    int *p;\n\n    Convert(5, &amp;p);\n\n    printf(\"The number is: %d\", *p);\n\n    free(p);\n}\n</code></pre>\n\n<p>The above works beautifully with no problem.</p>\n\n<p>Now the case below:</p>\n\n<pre><code>void Convert(int number, int *staticPointer)\n{\n    int * dynamicPointer = malloc(sizeof(int));\n    *dynamicPointer = number;\n    staticPointer = dynamicPointer;\n}\n\nint main()\n{\n    int *p;\n\n    Convert(5, p);\n\n    printf(\"The number is: %d\", *p);\n\n    free(p);\n}\n</code></pre>\n\n<p>This causes SEGFAULT. Notice that I do call the function in different ways with different parameters, and I do understand that the difference is in the calling of the function.</p>\n\n<p>Can somebody please explain to me why I have to call the function as in the first example, and why the other example doesn't work (it crashes in main)?</p>\n\n<p>The purpose of my program is to reference a static pointer to a specific memory address through a function.</p>\n"}, {"tags": ["c", "linux", "fork", "glibc"], "answers": [{"comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1462980871, "post_id": 37166143, "comment_id": 61869637, "body": "I believe <code>fork(2)</code> existed before <code>clone(2)</code>."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1462981674, "post_id": 37166143, "comment_id": 61870175, "body": "That is both correct and irrelevant. I&#39;ve edited the answer to explain why."}], "tags": [], "owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1462981655, "last_edit_date": 1462981655, "creation_date": 1462978050, "answer_id": 37166143, "question_id": 37165339, "link": "https://stackoverflow.com/questions/37165339/why-is-sys-fork-not-used-by-glibcs-implementation-of-fork/37166143#37166143", "title": "Why is sys_fork not used by glibc&#39;s implementation of fork?", "body": "<p>In a nutshell: why not?</p>\n\n<p>You have one syscall that is guaranteed to exist on all platforms (you do realize that Intel isn't the only platform out there, right?), and another that is deprecated because it is unnecessary. They both carry the exact same semantics. Your code is much more compact when you only call the one guaranteed to exist.</p>\n\n<p>I will elaborate on that a little.</p>\n\n<p>Fork is defined by Posix, while clone is Linux specific. However, Linux, on occasion, takes Posix defined \"system calls\" and implements them in user space. Such is the case for fork (and vfork and pthread_create). They are all implemented in user space by calling \"clone\".</p>\n\n<p>As such, fork is deemed unnecessary at the kernel level. If a thin user space wrapper can implement it, the kernel is okay with that. As such, <strong>on Linux</strong>, clone is guaranteed to exist on all platforms, while fork may or may not exist, depending on specific platform.</p>\n"}, {"comments": [{"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 1, "creation_date": 1462993554, "post_id": 37167196, "comment_id": 61877288, "body": "<code>pthread_join()</code> does the wakeup. Similar to how, if you link with threads, glibc calls <code>set_tid_address()</code> so the &quot;main&quot; thread can be joined: <a href=\"http://stackoverflow.com/questions/6975098/when-is-the-system-call-set-tid-address-used\" title=\"when is the system call set tid address used\">stackoverflow.com/questions/6975098/&hellip;</a>"}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1507713409, "post_id": 37167196, "comment_id": 80316336, "body": "@usr: that new process can spawn threads. If you want those threads to be able to <code>pthread_join()</code> on the main thread of the new process, glibc needs the futex&#39;s address."}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1507714430, "post_id": 37167196, "comment_id": 80317109, "body": "@usr: <code>execve()</code>takes care of that by calling <code>set_tid_address()</code>. BTW, if you immediately exec, there is <code>vfork()</code>, or <code>posix_spawn()</code>, if your libc provides that."}], "tags": [], "owner": {"reputation": 28006, "user_id": 960828, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dbfc386f986b9d600324cd02dae266d?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/960828/alex-d"}, "is_accepted": true, "score": 6, "last_activity_date": 1462980740, "creation_date": 1462980740, "answer_id": 37167196, "question_id": 37165339, "link": "https://stackoverflow.com/questions/37165339/why-is-sys-fork-not-used-by-glibcs-implementation-of-fork/37167196#37167196", "title": "Why is sys_fork not used by glibc&#39;s implementation of fork?", "body": "<p>I looked at the commit where Ulrich Drepper added that code to glibc, and there wasn't any explanation in the commit log (or elsewhere).</p>\n\n<p>Have a look at Linux's implementation of <code>fork</code>, though:</p>\n\n<pre><code>return _do_fork(SIGCHLD, 0, 0, NULL, NULL, 0);\n</code></pre>\n\n<p>And here is <code>clone</code>:</p>\n\n<pre><code>return _do_fork(clone_flags, newsp, 0, parent_tidptr, child_tidptr, tls);\n</code></pre>\n\n<p>Obviously, they are almost exactly the same. The only difference is that when calling <code>clone</code>, you can set various flags, can specify a stack size for the new process, etc. <code>fork</code> doesn't take any arguments.</p>\n\n<p>Looking at Drepper's code, the <code>clone</code> flags are <code>CLONE_CHILD_SETTID | CLONE_CHILD_CLEARTID | SIGCHLD</code>. If <code>fork</code> was used, the only flag would be <code>SIGCHLD</code>.</p>\n\n<p>Here is what the <code>clone</code> manpage says about those extra flags:</p>\n\n<pre><code>CLONE_CHILD_CLEARTID (since Linux 2.5.49)\n          Erase child thread ID at location ctid in child memory when  the  child\n          exits,  and  do  a  wakeup  on  the futex at that address.  The address\n          involved may be changed by the set_tid_address(2) system call.  This is\n          used by threading libraries.\n\nCLONE_CHILD_SETTID (since Linux 2.5.49)\n          Store child thread ID at location ctid in child memory.\n</code></pre>\n\n<p>...And you can see that he does pass a pointer to where the kernel should first store the child's thread ID and then later do a futex wakeup. Is glibc doing a futex wait on that address somewhere? I don't know. If so, that would explain why Drepper chose to use <code>clone</code>.</p>\n\n<p>(And if not, it would be just one more example of the extreme accumulation of cruft which is our beloved glibc! If you wanted to find some nice, clean, well-maintained code, just keep moving and go have a look at musl libc!)</p>\n"}], "owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 916, "favorite_count": 1, "accepted_answer_id": 37167196, "answer_count": 2, "score": 8, "last_activity_date": 1462981655, "creation_date": 1462976072, "last_edit_date": 1462980801, "question_id": 37165339, "link": "https://stackoverflow.com/questions/37165339/why-is-sys-fork-not-used-by-glibcs-implementation-of-fork", "title": "Why is sys_fork not used by glibc&#39;s implementation of fork?", "body": "<p>In eglibc's <code>nptl/sysdeps/unix/sysv/linux/i386/fork.c</code> there's a definition:</p>\n\n<pre><code>#define ARCH_FORK() \\\n  INLINE_SYSCALL (clone, 5,                           \\\n          CLONE_CHILD_SETTID | CLONE_CHILD_CLEARTID | SIGCHLD, 0,     \\\n          NULL, NULL, &amp;THREAD_SELF-&gt;tid)\n</code></pre>\n\n<p>which is used in actual <code>__libc_fork()</code> as the heart of the implementation. But e.g. in Linux's <code>arch/x86/entry/syscalls/syscall_32.tbl</code> exists a <code>sys_fork</code> entry, as well as in <code>syscalls_64.tbl</code>. So apparently Linux does have its special syscall for <code>fork</code>.</p>\n\n<p>So I now wonder: why does glibc implement <code>fork()</code> in terms of <code>clone</code>, if the kernel already provides the <code>fork</code> syscall?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1462975877, "post_id": 37165187, "comment_id": 61865931, "body": "What is the motivation for this ? Homework ? Interview question ? Something else ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1462975933, "post_id": 37165187, "comment_id": 61865972, "body": "Please show your research effort till time. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1462975980, "post_id": 37165187, "comment_id": 61866008, "body": "Any even number contains either of <code>0, 2, 4, 6, 8</code> as its last digit. Take an array, place this number and try to figure out what would be the next step."}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1462976209, "post_id": 37165187, "comment_id": 61866181, "body": "I think @haccks motivation is enough.Now OP should try coming up with something.This should not be answered directly."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1462976514, "post_id": 37165187, "comment_id": 61866387, "body": "@PaulR; <i>Do you consider shift operations (<code>&gt;&gt;</code> and <code>&lt;&lt;</code>) to be &quot;bitwise&quot; ?</i>: It doesn&#39;t matter whether he consider it as bitwise operator or not, standard consider them as bitwise operator."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1462977220, "post_id": 37165187, "comment_id": 61866939, "body": "If I had ever seen or read of any processor without bitwise, boolean logical instructions, I would not down/close vote.  So, down it goes.."}], "answers": [{"comments": [{"owner": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 0, "creation_date": 1462977366, "post_id": 37165421, "comment_id": 61867056, "body": "This is very machine specific. These days most CPUs have 64 bits in an int ..."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 2, "creation_date": 1462977517, "post_id": 37165421, "comment_id": 61867176, "body": "@haavee: actually <a href=\"https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models\" rel=\"nofollow noreferrer\">most 64 bit systems are LP64</a>, where <code>int</code> is still 32 bits."}, {"owner": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 0, "creation_date": 1462977609, "post_id": 37165421, "comment_id": 61867246, "body": "You&#39;re right. But it doesn&#39;t make me like the answer any better, unfortunately."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 1, "creation_date": 1462977686, "post_id": 37165421, "comment_id": 61867299, "body": "@haavee: well it&#39;s easily fixed if you want to make it portable - just define the magic factor at compile time based on the width of an int. The general principle is sound."}, {"owner": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 0, "creation_date": 1462977719, "post_id": 37165421, "comment_id": 61867324, "body": "I&#39;d say the point of a decent algorithm is that you <i>don&#39;t</i> change it for other sizes of <code>int</code>."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 1, "creation_date": 1462977836, "post_id": 37165421, "comment_id": 61867431, "body": "@haavee: it&#39;s an easy fix - just change <code>0x80000000</code> to <code>INT_MIN</code> - happy now ?"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1462978174, "post_id": 37165421, "comment_id": 61867681, "body": "Thanks for the suggestion, @PaulR."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 1, "creation_date": 1462981561, "post_id": 37165421, "comment_id": 61870095, "body": "@haavee: Concerning &quot; These days most CPUs have 64 bits in an int&quot;: Most processors these days are embedded devices using 32, 16 or even 8 bit data paths and registers - billions each year.  Suggest 100x more sub 64-bit processors built in 2015 than 64-bit ones."}], "tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": false, "score": 2, "last_activity_date": 1462978143, "last_edit_date": 1462978143, "creation_date": 1462976290, "answer_id": 37165421, "question_id": 37165187, "link": "https://stackoverflow.com/questions/37165187/how-to-find-odd-even-number-without-arithmetic-operators-in-c/37165421#37165421", "title": "How to find odd/even number without arithmetic operators in C?", "body": "<p>Assuming an int is 32 bits:</p>\n\n<pre><code>bool even(int x) {\n    return !(((unsigned int)x)*0x80000000);\n}\n</code></pre>\n\n<p>This works by shifting all bits except the least significant out of the 32 bits of the int, so after that you have <code>0x80000000</code> for odd numbers or <code>0</code> for even numbers. This is converted to a <code>bool</code> and negated.</p>\n\n<hr>\n\n<p>As Paul R points out int a comment, a portable version would use <code>INT_MIN</code> instead of <code>0x80000000</code></p>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1462977365, "post_id": 37165858, "comment_id": 61867052, "body": "Did he say <i>without arithmetic operators</i>?"}, {"owner": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 0, "creation_date": 1462977443, "post_id": 37165858, "comment_id": 61867119, "body": "No, nothing about arithmetic operators. Negative or positive was also not mentioned but should be easily fixable."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1462977458, "post_id": 37165858, "comment_id": 61867132, "body": "The title and the question are inconsistent - the title says &quot;arithmetic&quot; but the question says  &quot;%, / or bitwise operators&quot;. OP needs to sort out their question to make it clearer."}, {"owner": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "edited": false, "score": 0, "creation_date": 1462977533, "post_id": 37165858, "comment_id": 61867194, "body": "Yes. All too often the problems are ill formulated on SO :-("}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1462981818, "post_id": 37165858, "comment_id": 61870280, "body": "Should you care for a non-2&#39;s complement specific code: <code>if( number &lt; - INT_MAX) return true;</code>"}], "tags": [], "owner": {"reputation": 4091, "user_id": 26083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c3b4f3460b142d0ba37de98d1b04655?s=128&d=identicon&r=PG", "display_name": "haavee", "link": "https://stackoverflow.com/users/26083/haavee"}, "is_accepted": false, "score": 1, "last_activity_date": 1462978356, "last_edit_date": 1462978356, "creation_date": 1462977308, "answer_id": 37165858, "question_id": 37165187, "link": "https://stackoverflow.com/questions/37165187/how-to-find-odd-even-number-without-arithmetic-operators-in-c/37165858#37165858", "title": "How to find odd/even number without arithmetic operators in C?", "body": "<p>Division is nothing but repeated subtraction:</p>\n\n<pre><code>bool even(int number) {\n    // INT_MIN in 2's complement is always even\n    if( number==INT_MIN )\n        return true;\n    else if( number&lt;0 )\n       number = -number;\n    while( number&gt;1 )\n       number -= 2;\n    return number==0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6183822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b7027991aebe2926db5ee8e0e990d91?s=128&d=identicon&r=PG&f=1", "display_name": "Way to Smart", "link": "https://stackoverflow.com/users/6183822/way-to-smart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "closed_date": 1462979406, "answer_count": 2, "score": -5, "last_activity_date": 1462978356, "creation_date": 1462975741, "last_edit_date": 1462976606, "question_id": 37165187, "link": "https://stackoverflow.com/questions/37165187/how-to-find-odd-even-number-without-arithmetic-operators-in-c", "closed_reason": "Needs more focus", "title": "How to find odd/even number without arithmetic operators in C?", "body": "<p>How to find if a given number is odd/even without using <code>%</code>, <code>/</code> or bitwise operators?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "edited": false, "score": 2, "creation_date": 1462974215, "post_id": 37164358, "comment_id": 61864440, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11180378/what-is-the-cause-of-flexible-array-member-not-at-end-of-struct-error\">What is the cause of flexible array member not at end of struct error?</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "edited": false, "score": 0, "creation_date": 1462974294, "post_id": 37164358, "comment_id": 61864526, "body": "@pytheos Not really. This question asks for the <i>reason</i> behind the way it is designed. :)"}, {"owner": {"reputation": 260, "user_id": 2780716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbcb0aa74cedc3d4eaabc5281f87fe65?s=128&d=identicon&r=PG&f=1", "display_name": "Strahinja Djuri\u0107", "link": "https://stackoverflow.com/users/2780716/strahinja-djuri%c4%87"}, "edited": false, "score": 0, "creation_date": 1462974359, "post_id": 37164358, "comment_id": 61864582, "body": "In that answer i didn&#39;t find explanation, why its caused, what makes compilers to throw this error."}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "edited": false, "score": 1, "creation_date": 1462975932, "post_id": 37164358, "comment_id": 61865969, "body": "@StrahinjaDjuri\u0107, actually the last answer there held all the info you need."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1462975932, "post_id": 37164358, "comment_id": 61865971, "body": "The compilers flags an error because the language requires the member to be at the end and the compiler is following the rules of the language.   Now the question should be: &quot;why does the <i>language</i> require it?&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 11, "last_activity_date": 1462974391, "last_edit_date": 1462974391, "creation_date": 1462974159, "answer_id": 37164517, "question_id": 37164358, "link": "https://stackoverflow.com/questions/37164358/error-flexible-array-member-not-at-end-of-struct/37164517#37164517", "title": "error: flexible array member not at end of struct", "body": "<p>Unlike array declarations in function parameters, array declared as part of a <code>struct</code> or a <code>union</code> must have a size specified (with one exception described below). That is why declaring</p>\n\n<pre><code>int lost_index[];\nint lost_index_size;\n</code></pre>\n\n<p>is incorrect.</p>\n\n<p>The exception to this rule is so-called \"flexible array member\", which is an array declared with no size at the end of the <code>struct</code>. You must place it at the end of the <code>struct</code> so that the memory for it could be allocated along with the <code>struct</code> itself. This is the only way the compiler could know the offsets of all data members.</p>\n\n<p>If the compiler were to allow flexible arrays in the middle of a <code>struct</code>, the location of members starting with <code>size</code>, <code>allowed_memory_key_size</code>, and on, would be dependent on the amount of memory that you allocate to <code>lost_index[]</code> array. Moreover, the compiler would not be able to pad the <code>struct</code> where necessary to ensure proper memory access.</p>\n"}], "owner": {"reputation": 260, "user_id": 2780716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbcb0aa74cedc3d4eaabc5281f87fe65?s=128&d=identicon&r=PG&f=1", "display_name": "Strahinja Djuri\u0107", "link": "https://stackoverflow.com/users/2780716/strahinja-djuri%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7951, "favorite_count": 4, "accepted_answer_id": 37164517, "answer_count": 1, "score": 10, "last_activity_date": 1462974674, "creation_date": 1462973778, "last_edit_date": 1462974674, "question_id": 37164358, "link": "https://stackoverflow.com/questions/37164358/error-flexible-array-member-not-at-end-of-struct", "title": "error: flexible array member not at end of struct", "body": "<p>My Struct looks like this:</p>\n\n<pre><code>typedef struct storage {\n    char ***data;\n\n    int lost_index[];\n    int lost_index_size;\n\n    int size;\n    int allowed_memory_key_size;\n    int allowed_memory_value_size;\n    int memory_size;\n    int allowed_memory_size; \n\n} STORAGE;\n</code></pre>\n\n<p>The error im getting is \"error: flexible array member not at end of struct\". Im aware that this error can be solved by moving <code>int lost_index[]</code> at the end of struct. Why should flexible array member need to be at the end of struct? What is reason?</p>\n\n<p>As this is assumed duplicate of another question, actually i didn't find answers that i actually needed, answers in similar question dont describe the <strong>reason</strong> which stands behind compiler to throw error i asked about.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "c", "bitwise-operators", "crc", "code-translation"], "comments": [{"owner": {"reputation": 354, "user_id": 4718971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb7f8285fc124a74ecd210cbe5e7682?s=128&d=identicon&r=PG&f=1", "display_name": "torox", "link": "https://stackoverflow.com/users/4718971/torox"}, "edited": false, "score": 0, "creation_date": 1462974754, "post_id": 37163995, "comment_id": 61864943, "body": "Leave it so others can benefit too"}], "answers": [{"tags": [], "owner": {"reputation": 90105, "user_id": 106159, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Qfp6z.png?s=128&g=1", "display_name": "Matthew Watson", "link": "https://stackoverflow.com/users/106159/matthew-watson"}, "is_accepted": false, "score": 1, "last_activity_date": 1462973315, "creation_date": 1462973315, "answer_id": 37164177, "question_id": 37163995, "link": "https://stackoverflow.com/questions/37163995/migrating-crc-calculations-between-c-and-c/37164177#37164177", "title": "Migrating CRC calculations between C and C#", "body": "<p>Does this work?</p>\n\n<pre><code>public static ushort oblicz_crc(byte[] buffer, int length)\n{\n    unchecked\n    {\n        ushort crc = 0xffff;\n        for (int i = 0; i &lt; length; i++)\n        {\n            crc ^= buffer[i];\n            for (int j = 0; j &lt; 8; j++)\n            {\n                if ((crc &amp; 0x0001) != 0)\n                {\n                    crc &gt;&gt;= 1;\n                    crc ^= 0xA001;\n                }\n                else\n                {\n                    crc &gt;&gt;= 1;\n                }\n            }\n        }\n        return (crc);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1462973835, "post_id": 37164274, "comment_id": 61864105, "body": "Your observation is valid, however the original code isn&#39;t reading a UInt16 from <code>*(buffer+i)</code> -- <code>buffer</code> is just a <code>uint8_t*</code>.  So the correct code for this line is:  <code>crc ^= (ushort)buffer[i];</code>"}, {"owner": {"reputation": 90105, "user_id": 106159, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Qfp6z.png?s=128&g=1", "display_name": "Matthew Watson", "link": "https://stackoverflow.com/users/106159/matthew-watson"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1462974762, "post_id": 37164274, "comment_id": 61864953, "body": "@BenVoigt I don&#39;t think you need to cast to ushort if crc is ushort (the code I posted in my answer compiles without warning using just <code>crc ^= buffer[i]</code>). However, you are right - this answer is incorrect because it uses <code>ushort</code> when it should be using <code>byte</code>."}, {"owner": {"reputation": 5685, "user_id": 5240004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8eFV.jpg?s=128&g=1", "display_name": "theB", "link": "https://stackoverflow.com/users/5240004/theb"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1462975307, "post_id": 37164274, "comment_id": 61865462, "body": "@BenVoigt Thanks for spotting that. I&#39;ve corrected it in my answer."}], "tags": [], "owner": {"reputation": 5685, "user_id": 5240004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8eFV.jpg?s=128&g=1", "display_name": "theB", "link": "https://stackoverflow.com/users/5240004/theb"}, "is_accepted": true, "score": 3, "last_activity_date": 1462975295, "last_edit_date": 1462975295, "creation_date": 1462973582, "answer_id": 37164274, "question_id": 37163995, "link": "https://stackoverflow.com/questions/37163995/migrating-crc-calculations-between-c-and-c/37164274#37164274", "title": "Migrating CRC calculations between C and C#", "body": "<p>The problem is at this line:</p>\n\n<pre><code>crc ^= (ushort)(BitConverter.ToUInt16(buffer, 0) + (byte)i);\n</code></pre>\n\n<p>In the original code its:</p>\n\n<pre><code>crc ^= *(buffer+i);\n</code></pre>\n\n<p>The original code is adding i to the buffer pointer, and dereferencing that location. If you change the code to:</p>\n\n<pre><code>crc ^=  (ushort)(buffer[i]);\n</code></pre>\n\n<p>then you're actually doing the same operation.</p>\n"}], "owner": {"reputation": 67, "user_id": 4650032, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8684f0eb61deafbc18446b82e561bd0c?s=128&d=identicon&r=PG&f=1", "display_name": "Aramil", "link": "https://stackoverflow.com/users/4650032/aramil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 37164274, "answer_count": 2, "score": 1, "last_activity_date": 1462975388, "creation_date": 1462972876, "last_edit_date": 1462975388, "question_id": 37163995, "link": "https://stackoverflow.com/questions/37163995/migrating-crc-calculations-between-c-and-c", "title": "Migrating CRC calculations between C and C#", "body": "<p>I'm trying to implement crc calculation into my C# program. I've got code snippet from device C program but I'm unable to implement it into my program.</p>\n\n<p>Here is code I've got:</p>\n\n<pre><code>uint16_t oblicz_crc(uint8_t* buffer, uint8_t length)\n{\n    uint16_t crc = 0xffff;\n    uint8_t i, j;\n    for(i=0;i&lt;length;i++)\n    {\n    crc ^= *(buffer+i);\n    for(j=0;j&lt;8;j++)\n        {\n        3\n        if(crc &amp; 0x0001)\n            {\n            crc &gt;&gt;= 1;\n            crc ^= 0xA001;\n            }\n        else\n            {\n            crc &gt;&gt;= 1;\n            }\n        }\n    }\nreturn(crc);\n}\n</code></pre>\n\n<p>And there's a code I already have in my program. I assume that some of the binary operators, an \"if ((crc &amp; 0x0001) == 1)\" fragment, or some of data types are wrong. Can you help me with this?</p>\n\n<pre><code>        public void Send_Frame(byte[] buffer)\n        {\n            byte[] checksum = Crc(buffer);  //Array.Reverse(arg) ??\n            Array.Resize(ref buffer, buffer.Length + 2);\n            Array.Copy(checksum, 0, buffer, buffer.Length - 2, 2);\n#if DEBUG\n            richTextBoxPreview.AppendText( BitConverter.ToString(buffer) + \"\\n\");\n#endif\n            //Port.Write(buffer);\n        }\n        private byte[] Crc(byte[] buffer)\n        {\n            UInt16 crc = 0xFFFF;\n            int i, j;\n            for (i = 0; i &lt; buffer.Length; i++)\n            {\n                crc ^= (ushort)(BitConverter.ToUInt16(buffer, 0) + (byte)i);\n                for (j = 0; j &lt; 8; j++)\n                {\n                    if ((crc &amp; 0x0001) == 1)\n                    {\n                        crc &gt;&gt;= 1;\n                        crc ^= 0xA001;\n                    }\n                    else\n                    {\n                        crc &gt;&gt;= 1;\n                    }\n                }\n            }\n            return BitConverter.GetBytes(crc);\n        }\n</code></pre>\n\n<p>PS: This question is about my specific code snippet. When I get answer will it be best to delete it? Or should I leave it ?</p>\n"}, {"tags": ["c", "lua", "language-binding"], "comments": [{"owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "edited": false, "score": 0, "creation_date": 1462973930, "post_id": 37163939, "comment_id": 61864180, "body": "It seems that <code>-llua5.1</code> is not being found. You need to find where the Lua library is. Perhaps homebrew is installing a newer version of Lua."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "edited": false, "score": 0, "creation_date": 1462974516, "post_id": 37163939, "comment_id": 61864741, "body": "@pytheos - no space is necessary."}], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 5119903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tGZWOBYlj2o/AAAAAAAAAAI/AAAAAAAAABY/B9JW5dpWBkY/photo.jpg?sz=128", "display_name": "Kons", "link": "https://stackoverflow.com/users/5119903/kons"}, "is_accepted": false, "score": 0, "last_activity_date": 1462973176, "creation_date": 1462973176, "answer_id": 37164120, "question_id": 37163939, "link": "https://stackoverflow.com/questions/37163939/calling-c-code-from-lua/37164120#37164120", "title": "calling c code from lua", "body": "<p>I can't comment yet so I have to post it as Answer BUT</p>\n\n<p>from the error I'd guess you need to compile with the -m32 switch in order to build for 32bit library</p>\n"}, {"tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": true, "score": 3, "last_activity_date": 1462974481, "creation_date": 1462974481, "answer_id": 37164647, "question_id": 37163939, "link": "https://stackoverflow.com/questions/37163939/calling-c-code-from-lua/37164647#37164647", "title": "calling c code from lua", "body": "<p>You haven't told it where to find lua5.1</p>\n\n<p>use <code>-L</code> to tell the compiler where the library is located</p>\n\n<p>From your own example page it says to look at <a href=\"http://www.troubleshooters.com/codecorn/lua/lua_c_calls_lua.htm#_Anatomy_of_a_Lua_Call\" rel=\"nofollow\">http://www.troubleshooters.com/codecorn/lua/lua_c_calls_lua.htm#_Anatomy_of_a_Lua_Call</a></p>\n"}, {"tags": [], "owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "is_accepted": false, "score": 0, "last_activity_date": 1462974513, "creation_date": 1462974513, "answer_id": 37164661, "question_id": 37163939, "link": "https://stackoverflow.com/questions/37163939/calling-c-code-from-lua/37164661#37164661", "title": "calling c code from lua", "body": "<p>This works for me but I don't use homebrew. Lua is installed in <code>/usr/local</code>.</p>\n\n<pre><code>% gcc -Wall -bundle -undefined dynamic_lookup -fPIC -o power.so hellofunc.c \n% lua\nLua 5.2.4  Copyright (C) 1994-2015 Lua.org, PUC-Rio\n&gt; require\"power\"\n&gt; print(square(2))\nTop of square(), nbr=2.000000\n4\n&gt; print(cube(2))\nTop of cube(), number=2.000000\n8\n</code></pre>\n\n<p>Note in the compilation line the use of <code>-bundle -undefined dynamic_lookup</code> instead of <code>-shared</code> and the absence of <code>-llua5.1</code>.</p>\n\n<p>In general, you should not link the Lua core library into dynamic libraries such as this one.</p>\n"}], "owner": {"reputation": 846, "user_id": 4904534, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-SY_kYs8we_U/AAAAAAAAAAI/AAAAAAAAAZY/7Ljb0wVhmuA/photo.jpg?sz=128", "display_name": "Ace shinigami", "link": "https://stackoverflow.com/users/4904534/ace-shinigami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 37164647, "answer_count": 3, "score": 1, "last_activity_date": 1462974513, "creation_date": 1462972777, "question_id": 37163939, "link": "https://stackoverflow.com/questions/37163939/calling-c-code-from-lua", "title": "calling c code from lua", "body": "<p>I tried to follow this: <a href=\"http://www.troubleshooters.com/codecorn/lua/lua_lua_calls_c.htm\" rel=\"nofollow\">http://www.troubleshooters.com/codecorn/lua/lua_lua_calls_c.htm</a> </p>\n\n<p>I tried to compile the c code like it says in the guide:</p>\n\n<p><code>gcc -Wall -shared -fPIC -o power.so  -I/usr/include/lua5.1 -llua5.1  hellofunc.c</code></p>\n\n<p>but I got <a href=\"http://pastebin.com/KQvA0qFH\" rel=\"nofollow\">http://pastebin.com/KQvA0qFH</a> which I recognized as the error you get when you forget to include a lib or framework but I did -I/usr/include/lua5.1</p>\n\n<p>If it matters I am running os x and I installed lua with brew</p>\n"}, {"tags": ["c", "visual-studio-2012", "c99", "c89"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1462972879, "post_id": 37163877, "comment_id": 61863360, "body": "Is this such a big deal to backport it manually? Really, I wouldn&#39;t trust the automatic tool."}, {"owner": {"reputation": 1, "user_id": 6320505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hnrZE.jpg?s=128&g=1", "display_name": "Fahad", "link": "https://stackoverflow.com/users/6320505/fahad"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1462973052, "post_id": 37163877, "comment_id": 61863498, "body": "It&#39;s a huge code with many files used. The amalagamated version of the code has around 11500 lines. I have 1800 Errors due to this discrepancy in the standard. I tried to fix manually but they are too many, the count to 1800 doesnt decrease.  Manually changing means, changing all the structures initializations and value assignments which have been used heavily through out the code. And forget about random in between initializations in each code block.  Need something which can automatically do this"}, {"owner": {"reputation": 2283, "user_id": 320911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/adCJz.jpg?s=128&g=1", "display_name": "Arto Bendiken", "link": "https://stackoverflow.com/users/320911/arto-bendiken"}, "edited": false, "score": 0, "creation_date": 1535776794, "post_id": 37163877, "comment_id": 91200778, "body": "See also <a href=\"https://stackoverflow.com/q/10804162\">stackoverflow.com/q/10804162</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6320505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hnrZE.jpg?s=128&g=1", "display_name": "Fahad", "link": "https://stackoverflow.com/users/6320505/fahad"}, "edited": false, "score": 0, "creation_date": 1462978411, "post_id": 37166094, "comment_id": 61867837, "body": "Hi, Thanks for the reply. So I&#39;ll have to do it manually.   :/  So I&#39;m thinking now of compiling it as a C++ code and try to remove the rest of the errors manually. The errors are a lot reduced when I do that, still have to fix 500 errors manually.  What do you think of this approach?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1462977948, "creation_date": 1462977948, "answer_id": 37166094, "question_id": 37163877, "link": "https://stackoverflow.com/questions/37163877/coverting-a-c99-code-to-c89/37166094#37166094", "title": "Coverting a C99 code to C89", "body": "<p>Many C99 features are simply not portable to C89 to begin with. So the \"magic tool\" can only do just so much, you have to do a lot of it manually. Examples of the most commonly-used features:</p>\n\n<p>Not portable:</p>\n\n<ul>\n<li>Effective type and strict aliasing. The C89 \"equivalent\" is undefined behavior.</li>\n<li><code>restrict</code> pointers. C89 has no equivalent.</li>\n<li>VLAs. C89 has no equivalent.</li>\n<li>Flexible array members. The C89 \"equivalent\" is undefined behavior.</li>\n<li>long long int support. C89 has no equivalent, but could possibly be supported as compiler extension.</li>\n<li>Reliable integer division of signed integers. C89 has no equivalent.</li>\n</ul>\n\n<p>Portable:</p>\n\n<ul>\n<li><code>stdint.h</code>, <code>inttypes.h</code>, <code>stdbool.h</code>. Could possibly be supported as compiler extensions. Alternatively you could typedef them yourself.</li>\n<li>Compound literals. Could be replaced with temporary local variables.</li>\n<li>Variable declarations anywhere. Just move them to the top of the block/out of the loop.</li>\n<li>// comments. Most likely supported as compiler extension. Otherwise replace with /* */</li>\n<li>Designated initializers. Can be directly replaced with old-fashioned initializer lists.</li>\n<li>inline functions. Likely supported as compiler extension.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 6320505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hnrZE.jpg?s=128&g=1", "display_name": "Fahad", "link": "https://stackoverflow.com/users/6320505/fahad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1462977948, "creation_date": 1462972654, "question_id": 37163877, "link": "https://stackoverflow.com/questions/37163877/coverting-a-c99-code-to-c89", "title": "Coverting a C99 code to C89", "body": "<p>I have a code written for VS2015 following C99 standard for building static and dynamic library to be used for other part of a project.</p>\n\n<p>I want the libraries to be built for other VS versions as well but need to convert the code into C89 standard.</p>\n\n<p>I found this tool, <a href=\"https://github.com/libav/c99-to-c89\" rel=\"nofollow\">https://github.com/libav/c99-to-c89</a>\nand just went ahead and downloaded the binaries to be used for the conversion instead of building it first from its source.</p>\n\n<p>So I get these 3 files which have to be used : \"c99wrap.exe\" \"c99conv.exe\" \"makedef\"</p>\n\n<p>All the Readme says of using it is: \n\"\nUsage</p>\n\n<p>c99conv converts preprocessed C sources, the provided c99wrap uses the C preprocessor, converts its output and feeds it to the C compiler.</p>\n\n<p>c99wrap $CC $CFLAGS source</p>\n\n<p>\"</p>\n\n<p>Can anyone help me and tell me how am I supposed to use these .exe files for conversion of the C99 C-codes into respective C-89 codes ?</p>\n\n<p>I just need a converted code. Which can be used on any VS version following C89 format.</p>\n"}, {"tags": ["c", "linux", "simulator"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1463151891, "post_id": 37163681, "comment_id": 61958266, "body": "Just curious - Did you ever get this to work?"}, {"owner": {"reputation": 125, "user_id": 3174844, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/529757229/picture?type=large", "display_name": "cmperezg", "link": "https://stackoverflow.com/users/3174844/cmperezg"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1464101418, "post_id": 37163681, "comment_id": 62339900, "body": "@ryyker yes I did, with your answer. I was waaay off, and didn&#39;t even know I had to compile with ssbig-na-sstrix-gcc. It took me a while to get it working and I forgot to accept the answer. Thank you for your help."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1464120422, "post_id": 37163681, "comment_id": 62351017, "body": "Glad to hear it.  It looked to me like you had some of it, just missing the compiler instruction.  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 1, "last_activity_date": 1462992862, "last_edit_date": 1462992862, "creation_date": 1462984454, "answer_id": 37168525, "question_id": 37163681, "link": "https://stackoverflow.com/questions/37163681/error-while-running-basic-code-with-simplescalar/37168525#37168525", "title": "error while running basic code with SimpleScalar", "body": "<p>Your <em>bad magic number in executable `sstest'</em>  error message may be an indicator that your binary is not compatible for use with <em>SimpleScaler</em>.  </p>\n\n<p>The compiler script you show: <code>gcc sstest.c -o sstest</code> is for creating an ordinary binary.  There is nothing about the code that should cause a failure to compile, or run as a normal executable, but it was not built using the SimpleScaler utility.  </p>\n\n<p>From <em><a href=\"https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=8&amp;ved=0ahUKEwiwpqjcn9LMAhWFoD4KHULwBzwQFghSMAc&amp;url=http%3A%2F%2Fwww.cse.chalmers.se%2Fedu%2Fyear%2F2009%2Fcourse%2FDAT105%2Fold_project_2008%2FDAT105_Tools.pdf&amp;usg=AFQjCNGZWjLi-gxGawT37VHulYGOq9nQVA&amp;sig2=vvYbQvATAwLa_0Ca9t0Kcg&amp;cad=rja\" rel=\"nofollow\">this SimpleScaler tutorial</a></em>:</p>\n\n<p>To create a SimpleScaler binary, in particular a C program using GCC you would use:</p>\n\n<pre><code>ssbig-na-sstrix-gcc -g -O -o foo foo.c -lm\n</code></pre>\n\n<p>From the same link, to run the program once it is built, you could use:</p>\n\n<pre><code>sim-safe [-sim opts] foo [-program opts]\n</code></pre>\n\n<p>Which appears to follow the form of what you have shown in your post:</p>\n\n<pre><code>./sim-safe -redir:sim results/hello.sim.out -redir:prog results/hello.prog.out sstest.\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 3174844, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/529757229/picture?type=large", "display_name": "cmperezg", "link": "https://stackoverflow.com/users/3174844/cmperezg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 1, "accepted_answer_id": 37168525, "answer_count": 1, "score": 4, "last_activity_date": 1463055852, "creation_date": 1462972132, "question_id": 37163681, "link": "https://stackoverflow.com/questions/37163681/error-while-running-basic-code-with-simplescalar", "title": "error while running basic code with SimpleScalar", "body": "<p>I am trying to use SimpleScalar to run a very basic code just for testing. this is the code I am running:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nmain()\n{\n    int x = 0;\n    for ( x = 0; x &lt; 1000000; x++ ) {\n\n\n    }\n    printf(\"Hello World \\n\");\n\n\n}\n</code></pre>\n\n<p>and these are the lines I used to compile and run the program with simple-sim to a folder named results.</p>\n\n<blockquote>\n  <p>gcc sstest.c -o sstest</p>\n  \n  <p>./sim-safe -redir:sim results/hello.sim.out -redir:prog\n  results/hello.prog.out sstest.</p>\n</blockquote>\n\n<p>However, the program output is empty and the simulator output gives the following error:</p>\n\n<blockquote>\n  <p>fatal: bad magic number in executable `sstest' (not an executable)</p>\n</blockquote>\n\n<p>Is there something I am doing wrong in the process? I would appreciate your help very much. Also I am using Ubuntu as operating system and c as a programming language.</p>\n"}, {"tags": ["c", "xeon-phi", "cilk"], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 0, "creation_date": 1463656499, "post_id": 37284263, "comment_id": 62162470, "body": "Yeah that works. I am guessing you are right on the lazy allocation, eager allocation doesn&#39;t make much sense anyway. Can&#39;t however find any documentation on it which would be nice."}], "tags": [], "owner": {"reputation": 96, "user_id": 5091287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c734d421cbb3d953979fe9f43b674e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Hansang Bae", "link": "https://stackoverflow.com/users/5091287/hansang-bae"}, "is_accepted": true, "score": 1, "last_activity_date": 1463511633, "creation_date": 1463511633, "answer_id": 37284263, "question_id": 37163438, "link": "https://stackoverflow.com/questions/37163438/reading-files-to-shared-memory/37284263#37284263", "title": "Reading files to shared memory", "body": "<p>Can you try to insert something like this before the fread calls?</p>\n\n<pre><code>memset(buf, 0, 2073600); // after including string.h\n</code></pre>\n\n<p>This trick worked for me, but I don't know why (lazy allocation?).</p>\n\n<p>FYI, you can also post a MIC question on <a href=\"https://software.intel.com/en-us/forums/intel-many-integrated-core\" rel=\"nofollow\">this forum</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 0, "creation_date": 1463656062, "post_id": 37284598, "comment_id": 62162171, "body": "Good idea, as it could potentially be the buffering. But sadly it returns the same result as the fread code with bad address."}, {"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "reply_to_user": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 0, "creation_date": 1463666087, "post_id": 37284598, "comment_id": 62169948, "body": "Somehow the address segment is then just not mapped to your process memory space -- my guess you be that <code>_Offload_shared_malloc</code> uses some kind of lazy evaluation, so what about trying force the mapping to process space, by writing a single byte to the first address, e.g. <code>*buf = 0;</code> just before the <code>read</code>?"}, {"owner": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 0, "creation_date": 1463667042, "post_id": 37284598, "comment_id": 62170743, "body": "Yeah. Which fits with the theory in the above answer. Read doesn&#39;t read all 2073600 bytes though but 1048568 bytes. fread also works and reads the same amount. This probably relates even more to the whole lazy allocation it does."}, {"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "reply_to_user": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 0, "creation_date": 1463667613, "post_id": 37284598, "comment_id": 62171263, "body": "Just loop and read -- the read call is never guaratee to give you want you ask for, and in socket programming it is common to loop and aggregate the data -- and it is not unusual to look at the specific error code in <code>errno</code> when the read call return -1 to see if some of the operations can be retried before giving up -- I editited the code for a minimal looping strcture that should work for you."}, {"owner": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 0, "creation_date": 1463703596, "post_id": 37284598, "comment_id": 62189664, "body": "Yeah, already looping. More an interest in understanding why the actual allocation works. Thanks for the edit, the code snippet however is just an quick example for the question. The actual code is a lot more complex."}], "tags": [], "owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "is_accepted": false, "score": 2, "last_activity_date": 1463667782, "last_edit_date": 1463667782, "creation_date": 1463512802, "answer_id": 37284598, "question_id": 37163438, "link": "https://stackoverflow.com/questions/37163438/reading-files-to-shared-memory/37284598#37284598", "title": "Reading files to shared memory", "body": "<p>I don't have a PHI, so unable to see if this would make a difference -- but fread has it's own buffering, and while that may be turned of for this type of readind, then I don't see why you would go through the overhead of using fread rather than just using the lower level calls of open&amp;read, like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\n_Cilk_shared uint8_t* _Cilk_shared buf;\n\nint main(int argc, char **argv) {\n  printf(\"Argv is %s\\n\", argv[1]);\n  int infile = open(argv[1], O_RDONLY); // should test if open ok, but skip to make code similar to OP's\n  int len, pos =0, size = 2073600;\n  buf = (_Cilk_shared uint8_t*) _Offload_shared_malloc(size);\n  do { \n      buf[pos]=0; // force the address to be mapped to process memory before read\n      len = read(infile, &amp;buf[pos], size);\n      if(len &lt; 0) {\n         perror(\"error\");\n         break;\n      }\n      pos += len; // move position forward in cases where we have no read the entire data in first read.\n      size -= len;\n  } while (size &gt; 0);\n  printf(\"Len is %d (%d) and first value of buf is %d\\n\", len, pos, *buf);\n  return 0;\n}\n</code></pre>\n\n<p>read &amp; write should work with shared memory allocated without the problem you are seeing.</p>\n"}], "owner": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 854, "favorite_count": 0, "accepted_answer_id": 37284263, "answer_count": 2, "score": 3, "last_activity_date": 1463667782, "creation_date": 1462971517, "last_edit_date": 1462984019, "question_id": 37163438, "link": "https://stackoverflow.com/questions/37163438/reading-files-to-shared-memory", "title": "Reading files to shared memory", "body": "<p>I am reading a binary file that I want to offload directly to the Xeon Phi through Cilk and shared memory.</p>\n\n<p>As we are reading fairly much data at once each time and binary data the preferred option is to use fread. </p>\n\n<p>So if I make a very simple example it would go like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\n_Cilk_shared uint8_t* _Cilk_shared buf;\n\nint main(int argc, char **argv) {\n  printf(\"Argv is %s\\n\", argv[1]);\n  FILE* infile = fopen(argv[1], \"rb\");\n  buf = (_Cilk_shared uint8_t*) _Offload_shared_malloc(2073600);\n  int len = fread(buf, 1, 2073600, infile);\n  if(ferror(infile)) {\n    perror(\"ferror\");\n  }\n  printf(\"Len is %d and first value of buf is %d\\n\", len, *buf);\n  return 0;\n}\n</code></pre>\n\n<p>The example is very simplified from the real code but enough to examplify the behavior.</p>\n\n<p>This code would then return </p>\n\n<pre><code>ferror: Bad address\nLen is 0 and first value of buf is 0\n</code></pre>\n\n<p>However if we switch out the fread for a fgets (not very suitable for reading binary data, specially with the return value) things work great. </p>\n\n<p>That is we switch <code>fgets((char *) buf, 2073600, infile);</code> and then drop the len from the print out we get </p>\n\n<p><code>first value of buf is 46</code></p>\n\n<p>Which fits with what we need and I can run <code>_Offload_cilk</code> on a function with buf as an argument and do work on it.</p>\n\n<p>Is there something I am missing or is fread just not supported? I've tried to find as much info on this from both intel and other sites on the internet but I have sadly been unable to.</p>\n\n<p>----EDIT----</p>\n\n<p>After more research into this it seems that running fread on the shared memory with a value higher than 524287 (524287 is 19 bits exactly) fread gets the error from above. At 524287 or lower things work, and you can run as many fread as you want and read all the data.</p>\n\n<p>I am utterly unable to find any reason written anywhere for this.</p>\n"}, {"tags": ["c", "algorithm", "sorting", "bubble-sort"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463086630, "post_id": 37163211, "comment_id": 61926958, "body": "The third version - is kinda strange.  Does it even sort?"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463086912, "post_id": 37163211, "comment_id": 61927064, "body": "@MichaelDorgan: It&#39;s a common optimization for a bubble sort"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1463087220, "post_id": 37163211, "comment_id": 61927206, "body": "Guess I stopped using it too long ago :)  I wonder why?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463089194, "post_id": 37163211, "comment_id": 61928139, "body": "Check Wikipedia on <a href=\"https://en.wikipedia.org/wiki/Selection_sort\" rel=\"nofollow noreferrer\">Selection sort</a> and <a href=\"https://en.wikipedia.org/wiki/Insertion_sort\" rel=\"nofollow noreferrer\">Insertion sort</a> and <a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow noreferrer\">Bubble sort</a>.  After review, I think the first corresponds to an insertion sort (the decrementing loop is indicative of that if Wikipedia is to be trusted) while the second is a bubble sort.  I&#39;m sure that none of them is a selection sort; there is more swapping going on than in a selection sort."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 1, "creation_date": 1463095105, "post_id": 37163211, "comment_id": 61930300, "body": "You should not alter the question after so many people have already given answers."}, {"owner": {"reputation": 57, "user_id": 5875839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a463187c6b7a06421d2f0528453edea7?s=128&d=identicon&r=PG&f=1", "display_name": "ThanhPT", "link": "https://stackoverflow.com/users/5875839/thanhpt"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463157335, "post_id": 37163211, "comment_id": 61961482, "body": "@Jonathan Leffler the idea of bubble sort is swap 2 element &quot;nearly&quot; for put the largest or smallest to top or bot of array, the idea of the second is different so i think it is not bubble sort."}], "answers": [{"tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 1, "last_activity_date": 1462978123, "last_edit_date": 1462978123, "creation_date": 1462972027, "answer_id": 37163643, "question_id": 37163211, "link": "https://stackoverflow.com/questions/37163211/which-one-is-bubble-sort/37163643#37163643", "title": "Which one is bubble sort?", "body": "<p>I tested both your code snippets on an actual array using Java in IntelliJ.  Both versions generated an array in ascending sorted order.</p>\n\n<p>Here is the array I used:</p>\n\n<pre><code>int[] a = {1, 9, 3, 5, 4, 2, 8, 6, 7};\n</code></pre>\n\n<p>And here is the output from the two versions:</p>\n\n<p><strong>Version 1</strong></p>\n\n<pre><code>[1, 2, 3, 4, 5, 6, 7, 8, 9]\n</code></pre>\n\n<p><strong>Version 2</strong></p>\n\n<pre><code>[1, 2, 3, 4, 5, 6, 7, 8, 9]\n</code></pre>\n\n<p>The first version looks like a standard bubble sort, while the second version appears to be something else.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463088972, "post_id": 37165823, "comment_id": 61928050, "body": "Are you sure that any of those is a selection sort?  I thought that a selection sort went through the unsorted section of the array, finding the smallest element and moving it to the start of the unsorted section, then decreasing the size of the unsorted section by one."}, {"owner": {"reputation": 17681, "user_id": 298029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcPr5.png?s=128&g=1", "display_name": "fgb", "link": "https://stackoverflow.com/users/298029/fgb"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463092130, "post_id": 37165823, "comment_id": 61929367, "body": "@JonathanLeffler It&#39;s not quite the same. The state is the same as selection sort for each outer iteration but there&#39;s some extra redundant swaps. It&#39;s still finding the smallest element but it&#39;s swapping the smallest found so far multiple times instead of once at the end. I thought it could be some bubble sort variant but I think bubble sort requires swapping adjacent elements."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463092367, "post_id": 37165823, "comment_id": 61929451, "body": "There&#39;s an element of &quot;I&#39;m not quite sure why I&#39;m bothered&quot; (since they&#39;re all slow and not singularly useful), but there&#39;s also an element of &quot;I&#39;d like it to be right&quot;.  You&#39;ll see in comments to the main question, that I think the first is insertion sort, the second a bubble sort, and the third a modified bubble sort.  I still think none is a selection sort; see the Wikipedia articles cited in my comments to the question.  (I also got it wrong in the first of those comments \u2014 I&#39;m not claiming perfection here!)"}, {"owner": {"reputation": 17681, "user_id": 298029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcPr5.png?s=128&g=1", "display_name": "fgb", "link": "https://stackoverflow.com/users/298029/fgb"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463093241, "post_id": 37165823, "comment_id": 61929738, "body": "@JonathanLeffler As for the first algorithm, the idea of the insertion sort requires inserting an item within the already sorted portion which the first algorithm doesn&#39;t do."}, {"owner": {"reputation": 57, "user_id": 5875839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a463187c6b7a06421d2f0528453edea7?s=128&d=identicon&r=PG&f=1", "display_name": "ThanhPT", "link": "https://stackoverflow.com/users/5875839/thanhpt"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463158829, "post_id": 37165823, "comment_id": 61962307, "body": "@JonathanLeffler i agree with fgb, the fist can&#39;t be insertion sort. It is bubble sort  because it swapping adjacent elements. The idea of insertion sort is we keep the left part of the array sorted and take element from the right and insert it in the left part at its proper place. Like when you play game of cards each player get 13 cards, player keeps them in the sorted order in his hand for his ease. To do that player select 1 card unsorted and put it into the middle(left, right) list cards sorted."}], "tags": [], "owner": {"reputation": 17681, "user_id": 298029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcPr5.png?s=128&g=1", "display_name": "fgb", "link": "https://stackoverflow.com/users/298029/fgb"}, "is_accepted": false, "score": 7, "last_activity_date": 1462977220, "creation_date": 1462977220, "answer_id": 37165823, "question_id": 37163211, "link": "https://stackoverflow.com/questions/37163211/which-one-is-bubble-sort/37165823#37165823", "title": "Which one is bubble sort?", "body": "<p>The first version is the bubble sort, because it's comparing each pair of adjacent items.</p>\n\n<p>The second version is a selection sort because <code>a[i]</code> ends up being the smallest item in the unsorted right portion of the array after each iteration of the outer loop.</p>\n"}, {"tags": [], "owner": {"reputation": 12214, "user_id": 6785908, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4d260895797435b1e59b3c2154a469f7?s=128&d=identicon&r=PG&f=1", "display_name": "so-random-dude", "link": "https://stackoverflow.com/users/6785908/so-random-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1541803457, "creation_date": 1541803457, "answer_id": 53234211, "question_id": 37163211, "link": "https://stackoverflow.com/questions/37163211/which-one-is-bubble-sort/53234211#53234211", "title": "Which one is bubble sort?", "body": "<p>1.The first:</p>\n\n<pre><code>for(int i=0;i&lt;n-1;i++)\n  for(int j=n-1; j&gt;i;j--)\n    if(a[j] &lt; a[j-1])\n        swap(a[j], a[j-1]);\n</code></pre>\n\n<p>This is <strong>Bubble</strong> Sort</p>\n\n<p>2.the second:</p>\n\n<pre><code>for(int i=0; i&lt;n-1; i++)\n  for(int j=i+1; j&lt;n; j++)\n    if(a[j] &lt; a[i])\n        swap(a[j],a[i]);\n</code></pre>\n\n<p>It is <strong>selection</strong> sort</p>\n\n<p>Even though at first glance it will give an impression that its a reversed implementation of bubble sort, it is not. It is <strong>selection</strong> sort as other user pointed out already </p>\n\n<p>3.third version:</p>\n\n<pre><code>int temp, i, j = 0;\n    boolean swaped = true;\n\n    while (swaped) {\n        swaped = false;\n        j++;\n        for(i = 0; i &lt; arr.length - j; i++){\n            if(arr[i] &gt; arr[i+1]){\n                temp = arr[i];\n                arr[i] = arr[i+1];\n                arr[i+1] = temp;\n                swaped = true;\n            }\n        }\n    }\n</code></pre>\n\n<p>This is in fact, <strong>enhanced bubble sort</strong>\nThis will improve the best case scenario</p>\n"}], "owner": {"reputation": 57, "user_id": 5875839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a463187c6b7a06421d2f0528453edea7?s=128&d=identicon&r=PG&f=1", "display_name": "ThanhPT", "link": "https://stackoverflow.com/users/5875839/thanhpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1541803457, "creation_date": 1462970994, "last_edit_date": 1463086641, "question_id": 37163211, "link": "https://stackoverflow.com/questions/37163211/which-one-is-bubble-sort", "title": "Which one is bubble sort?", "body": "<p>The first:</p>\n\n<pre><code>for(int i=0;i&lt;n-1;i++)\n  for(int j=n-1; j&gt;i;j--)\n    if(a[j] &lt; a[j-1])\n        swap(a[j], a[j-1]);\n</code></pre>\n\n<p>or the second:</p>\n\n<pre><code>for(int i=0; i&lt;n-1; i++)\n  for(int j=i+1; j&lt;n; j++)\n    if(a[j] &lt; a[i])\n        swap(a[j],a[i]);\n</code></pre>\n\n<p>or third version:</p>\n\n<pre><code>int temp, i, j = 0;\n    boolean swaped = true;\n\n    while (swaped) {\n        swaped = false;\n        j++;\n        for(i = 0; i &lt; arr.length - j; i++){\n            if(arr[i] &gt; arr[i+1]){\n                temp = arr[i];\n                arr[i] = arr[i+1];\n                arr[i+1] = temp;\n                swaped = true;\n            }\n        }\n    }\n</code></pre>\n\n<p>Someone say the first and someone say the second. So which one is right? Someone say the second is interchange sort. Many book say bubble sort is the third version, but many people called the first version is bubble sort. Any comment?</p>\n"}, {"tags": ["java", "c", "eclipse", "java-native-interface", "pocketsphinx"], "comments": [{"owner": {"reputation": 30439, "user_id": 3215527, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/eL3Zs.jpg?s=128&g=1", "display_name": "wero", "link": "https://stackoverflow.com/users/3215527/wero"}, "edited": false, "score": 1, "creation_date": 1462977748, "post_id": 37162981, "comment_id": 61867353, "body": "Do you see any debug log from <code>E_INFO</code>? There is a chance that <code>ps_init</code> fails - but the program continues with a null ps which may be fatal in <code>ps_start_utt</code>"}, {"owner": {"reputation": 33, "user_id": 6290706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e56b3ec63b2db3763973d59f007416?s=128&d=identicon&r=PG&f=1", "display_name": "PP600", "link": "https://stackoverflow.com/users/6290706/pp600"}, "reply_to_user": {"reputation": 30439, "user_id": 3215527, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/eL3Zs.jpg?s=128&g=1", "display_name": "wero", "link": "https://stackoverflow.com/users/3215527/wero"}, "edited": false, "score": 0, "creation_date": 1463039182, "post_id": 37162981, "comment_id": 61894376, "body": "I dont get any E_INFO because of ps == NULL... I test it with an if-condition"}, {"owner": {"reputation": 33, "user_id": 6290706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e56b3ec63b2db3763973d59f007416?s=128&d=identicon&r=PG&f=1", "display_name": "PP600", "link": "https://stackoverflow.com/users/6290706/pp600"}, "reply_to_user": {"reputation": 30439, "user_id": 3215527, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/eL3Zs.jpg?s=128&g=1", "display_name": "wero", "link": "https://stackoverflow.com/users/3215527/wero"}, "edited": false, "score": 0, "creation_date": 1463043524, "post_id": 37162981, "comment_id": 61897291, "body": "okay I think you are right! I added E_INFO after the line ps = ps_init(config), and the program never reaches this. But i dont know where the mistake could be. And now i dont get any error anymore."}], "owner": {"reputation": 33, "user_id": 6290706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e56b3ec63b2db3763973d59f007416?s=128&d=identicon&r=PG&f=1", "display_name": "PP600", "link": "https://stackoverflow.com/users/6290706/pp600"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1463057050, "creation_date": 1462970321, "last_edit_date": 1463057050, "question_id": 37162981, "link": "https://stackoverflow.com/questions/37162981/pocketsphinx-initialization-fails", "title": "Pocketsphinx initialization fails", "body": "<p>I want to program a VoiceRecognition with Pocketsphinx and start it with Eclipse. At first I built pocketsphinx and sphinxbase and I was able to start pocketsphinx_continuous.exe with cmd.</p>\n\n<p>Now I have some Problems with the c-source, to start the microphone and the recognition. </p>\n\n<pre><code>    JNIEXPORT void JNICALL Java_Test_Decoder_1defaultConfig(JNIEnv *env, jobject obj)\n{\n    config = cmd_ln_init(NULL, ps_args(), TRUE,                   // Load the configuration structure - ps_args() passes the default values\n        \"-hmm\", MODELDIR \"/en-us/en-us\",  // path to the standard english language model\n        \"-lm\", MODELDIR \"/en-us/en-us.lm.bin\",                                         // custom language model (file must be present)\n        \"-dict\", MODELDIR \"/en-us/cmudict_en_us.dict\",                                    // custom dictionary (file must be present)\n        NULL);\n\n    if (config == NULL) {\n        cmd_ln_free_r(config);\n        E_INFO(\"configuration failed\");\n    }\n\n    ps_default_search_args(config);\n    ps = ps_init(config);                                                        // initialize the pocketsphinx decoder\n\n    if (ps == NULL) {\n        cmd_ln_free_r(config);\n        E_INFO(\"decoder failed\");\n    }\n\n    E_INFO(\"COMPILED ON %s, AT: %s\\n\",__DATE__,__TIME__);\n\n\n    recognize_from_microphone();                 // call the function to capture and decode speech           \n\n\n    ps_free(ps);\n    cmd_ln_free_r(config);\n    //ad_close(ad);                                                    // close the microphone\n}\n\nstatic void recognize_from_microphone() {\n\n    ad_rec_t *ad;\n    int16 adbuf[2048];\n    uint8 utt_started, in_speech;\n    int32 k;\n    char const *hyp;\n\n    //if (ad = ad_open_dev(NULL, (int)cmd_ln_float32_r(config, \"-samprate\")) == NULL) { // open default microphone at default samplerate\n    //  E_FATAL(\"Failed to open audio device\\n\");\n    //  }\n\n    if ((ad = ad_open()) == NULL) {     // open default microphone at default samplerate\n        E_FATAL(\"Failed to open audio device\\n\");\n    }\n\n    if (ad_start_rec(ad) &lt; 0) {\n        E_FATAL(\"Failed to start recording\\n\");\n    }\n    if (ps_start_utt(ps) &lt; 0)\n        E_FATAL(\"Failed to start utterance\\n\");\n\n\n    utt_started = FALSE;\n    E_INFO(\"Ready....\\n\");\n</code></pre>\n\n<p>If i start it with Eclipse I get the following Error message:</p>\n\n<pre><code>#\n# A fatal error has been detected by the Java Runtime Environment:\n#\n#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x00000000022dfbfc, pid=7780, tid=0x0000000000003320\n#\n# JRE version: OpenJDK Runtime Environment (8.0_74-b02) (build 1.8.0_74-b02)\n# Java VM: OpenJDK 64-Bit Server VM (25.74-b02 mixed mode windows-amd64 compressed oops)\n# Problematic frame:\n# C  [pocketsphinx.dll+0x1fbfc]  ps_start_utt+0x1c\n#\n# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows\n#\n# An error report file with more information is saved as:\n# D:\\sde\\workspaceAW_4.5\\pocketsphinx\\hs_err_pid7780.log\n#\n# If you would like to submit a bug report, please visit:\n#   http://bugreport.java.com/bugreport/crash.jsp\n# The crash happened outside the Java Virtual Machine in native code.\n# See problematic frame for where to report the bug.\n#\n</code></pre>\n\n<p>It says that the Problem is inside the ps_start_utt function, but I did not change the Default/demo function. Is the Mistake in the function or is there any mistake before?</p>\n"}, {"tags": ["c++", "c", "windows", "visual-studio-2015", "kernel"], "comments": [{"owner": {"reputation": 419, "user_id": 6020544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b948e0c3a4fbf0f32ef77049172b9b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Kylecrocodyle", "link": "https://stackoverflow.com/users/6020544/kylecrocodyle"}, "edited": false, "score": 0, "creation_date": 1488216101, "post_id": 37162661, "comment_id": 72123130, "body": "Hey, has a solution been found for this issue? I have a friend experiencing a similar problem."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3272603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885675a53e73f930864f22e23c6d80cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3272603", "link": "https://stackoverflow.com/users/3272603/user3272603"}, "is_accepted": false, "score": 0, "last_activity_date": 1512896385, "creation_date": 1512896385, "answer_id": 47737320, "question_id": 37162661, "link": "https://stackoverflow.com/questions/37162661/windows-kmfd-helloworld-driver-deployment-task-failed/47737320#47737320", "title": "Windows KMFD HelloWorld Driver Deployment Task Failed", "body": "<p>you can remove the step of remove the previous installation by remove checkbox at \"project setting\"-> Driver install-> Deployment </p>\n"}], "owner": {"reputation": 33, "user_id": 6251072, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xSaS88DFlUc/AAAAAAAAAAI/AAAAAAAAAFE/GNfL5xAv9lQ/photo.jpg?sz=128", "display_name": "HJ Blom", "link": "https://stackoverflow.com/users/6251072/hj-blom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 784, "favorite_count": 4, "answer_count": 1, "score": 2, "last_activity_date": 1512896385, "creation_date": 1462969558, "last_edit_date": 1462970582, "question_id": 37162661, "link": "https://stackoverflow.com/questions/37162661/windows-kmfd-helloworld-driver-deployment-task-failed", "title": "Windows KMFD HelloWorld Driver Deployment Task Failed", "body": "<p>I need to write a Kernel Driver for Windows. Since this is my first time attempting something like this, I started with Windows' HelloWorld example:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/hh439665(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/hardware/hh439665(v=vs.85).aspx</a></p>\n\n<p>I encounter my problem when installing the driver to the target machine. The console on the target machine gives the following output:</p>\n\n<blockquote>\n  <p>Test Authoring and Execution Framework v5.3 for x64</p>\n  \n  <p><b>StartGroup: DriverTestsTasks:: _DriverRemoval</b><br> Driver\n  Certificate File: KmfdHelloWorld.cer<br> Driver Inf\n  File:KmfdHelloWorld.inf<br> Driver Hardware ID:\n  Root\\KmdfHelloWorld<br> Driver package GUID: x64<br> Import Driver To\n  Store: 1<br> Uninstall Driver: 1<br> Debug Deployment: 1<br> COM\n  failure occurred. HRESULT: 0x80040154<br> <b>Class not registered</b></p>\n  \n  <p>Class not registered</p>\n  \n  <p>Failed: A failure occured while removing the previous driver\n  installation<br> EndGroup: DriverTestTasks:: _DriverRemoval [Failed]</p>\n  \n  <p>Non-passing Tests:<br> DriverTestTasks::_DriverRemoval [Failed]\n  SummaryL Total=1, Passed=0, Failed=1, Blocked=0, Not Run=0, Skipped=0</p>\n</blockquote>\n\n<p>As explained in the tutorial, I am using Visual Studio 2015. My test machine is running Windows 10 in a VM. All the other tests pass. The driver is copied to the target machine and gets installed, but fails this one procedure and hence I can't use the Debugger explained at the end of the tutorial.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 3, "creation_date": 1462969985, "post_id": 37162648, "comment_id": 61860854, "body": "The two differs just the return value, please also post the code that calls this function."}, {"owner": {"reputation": 41, "user_id": 6319738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddf3fcfa6ef6524118aff8c29730d7?s=128&d=identicon&r=PG&f=1", "display_name": "sale", "link": "https://stackoverflow.com/users/6319738/sale"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462971058, "post_id": 37162648, "comment_id": 61861772, "body": "Already got the answer. The pointer wasnt initialized corectly. Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6319738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddf3fcfa6ef6524118aff8c29730d7?s=128&d=identicon&r=PG&f=1", "display_name": "sale", "link": "https://stackoverflow.com/users/6319738/sale"}, "edited": false, "score": 0, "creation_date": 1462970127, "post_id": 37162705, "comment_id": 61860973, "body": "Oh, i didn&#39;t know that. But i am still bugged why do code above isn&#39;t working.."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 41, "user_id": 6319738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddf3fcfa6ef6524118aff8c29730d7?s=128&d=identicon&r=PG&f=1", "display_name": "sale", "link": "https://stackoverflow.com/users/6319738/sale"}, "edited": false, "score": 1, "creation_date": 1462970364, "post_id": 37162705, "comment_id": 61861150, "body": "@sale does the pointer passed to the function get initialized?"}, {"owner": {"reputation": 41, "user_id": 6319738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddf3fcfa6ef6524118aff8c29730d7?s=128&d=identicon&r=PG&f=1", "display_name": "sale", "link": "https://stackoverflow.com/users/6319738/sale"}, "edited": false, "score": 0, "creation_date": 1462970893, "post_id": 37162705, "comment_id": 61861622, "body": "This fixes the problem. Thank you very much!"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 0, "last_activity_date": 1462970330, "last_edit_date": 1462970330, "creation_date": 1462969681, "answer_id": 37162705, "question_id": 37162648, "link": "https://stackoverflow.com/questions/37162648/convert-a-number-into-string/37162705#37162705", "title": "Convert a number into string", "body": "<p>The two function only differs by the return value, one returns the pointer <code>p</code>, the other returns nothing. So make sure the pointer you passed in are initialized to valid address, that is, it points to a buffer:</p>\n\n<pre><code>char str[100];\nitos(a, str);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char *str = malloc(100);\nitos(a, str);\n</code></pre>\n\n<p>To convert integer to string, you could just print it:</p>\n\n<pre><code>char str[100];\nint n;\nsnprintf(str, sizeof str, \"%d\", n);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6319738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddf3fcfa6ef6524118aff8c29730d7?s=128&d=identicon&r=PG&f=1", "display_name": "sale", "link": "https://stackoverflow.com/users/6319738/sale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "closed_date": 1462969918, "accepted_answer_id": 37162705, "answer_count": 1, "score": -1, "last_activity_date": 1462970330, "creation_date": 1462969527, "question_id": 37162648, "link": "https://stackoverflow.com/questions/37162648/convert-a-number-into-string", "closed_reason": "Duplicate", "title": "Convert a number into string", "body": "<p>So i was writting a simple c code which coverts a number into a string, and there is one thing that is unclear to me. On this code:</p>\n\n<pre><code>    void itos(int a,char *p){\n    int pom = a;\n    do{\n       p++;\n       pom/=10;\n    }while(pom);\n    *p = '\\0';\n    do{\n       pom = a%10 + '0';\n       *--p = pom;\n       a/=10;\n      }while(a);\n     }\n</code></pre>\n\n<p>i keep getting segmentation faults and i don't understand why. The string is passed by adress, so shouldn't the string from the main have the accses to string in the function? On the other hand this code works pefectly:</p>\n\n<pre><code>     char *itos(int a,char *p){\n     int pom = a;   \n     do{\n        p++;\n        pom/=10;\n     }while(pom);\n    *p = '\\0';\n    do{\n        pom = a%10 + '0';\n        *--p = pom;\n        a/=10;\n    }while(a);\n    return p;\n\n   }\n</code></pre>\n\n<p>If somone could explain me the diffrence (especially why the first one isn't working) i'd be extremlly greatful.</p>\n"}, {"tags": ["c", "gcc", "assembly"], "comments": [{"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 1, "creation_date": 1462969848, "post_id": 37162597, "comment_id": 61860730, "body": "Does gcc have a specific intermediate representation or byte code? Your 2nd example looks like target specific assembly. I.e. not every processor will have those registers, those are x86 specific (I might be wrong, I don&#39;t usually deal with low level stuff). Also, might be an optimization not all turned off with &quot;-O0&quot;, constructor elision is one I know which is not. Possibly related: <a href=\"http://stackoverflow.com/questions/4534791/why-does-it-use-the-movl-instead-of-push\" title=\"why does it use the movl instead of push\">stackoverflow.com/questions/4534791/&hellip;</a>"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 7, "creation_date": 1462969944, "post_id": 37162597, "comment_id": 61860823, "body": "It&#39;ll just be a different calling convention - passing the first N arguments in registers rather than on the stack. However using those registers is not a convention I recognise, nor is it on <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions\" rel=\"nofollow noreferrer\">the Wikipedia page</a>. Is this a 64-bit PC? Try compiling with <code>-m32</code> maybe to get the 32-bit conventions, which I think are stack by default."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 4, "creation_date": 1462970454, "post_id": 37162597, "comment_id": 61861233, "body": "It is just using x86_64 calling convention using the lower half of registers RDI, RSI and RDX (which are the first 3 resisters in the x86_64 calling convention)"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 2, "creation_date": 1462971096, "post_id": 37162597, "comment_id": 61861810, "body": "&quot;Is this a repost of: why does it use the movl instead of push?&quot; - no, it&#39;s not. That question deals with GCC 3.x&#39;s way of pushing arguments onto the stack by reserving some space then writing into that space, rather than using push instructions. David is correct: this is because you&#39;re compiling for 64-bit code, and this is the standard 64-bit Linux calling convention. Try <code>-m32</code> to get 32-bit code that&#39;ll look like your book, or at least like the code in that linked question which is equivalent to what&#39;s in your book (this part is gcc 2.95 vs more modern GCCs)."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1462971400, "post_id": 37162597, "comment_id": 61862096, "body": "there is no reason to expect any two compilers nor the same compiler with different settings to produce the same output.  certainly not two versions a year apart and definitely not two versions 10+ years apart.  Nor is there any reason to expect a book to match a compiler, even if they call out the compiler and version."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1462971482, "post_id": 37162597, "comment_id": 61862180, "body": "you can certainly run an old linux in a virtual machine and directly or cross compile 2.9 and see how it compares."}, {"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 0, "creation_date": 1462973761, "post_id": 37162597, "comment_id": 61864045, "body": "rather than compiling (and learning) an old version, what about taking a more up-to-date book, and learn the way it&#39;s done now?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1462976120, "post_id": 37162597, "comment_id": 61866113, "body": "The <a href=\"https://gcc.gnu.org/releases.html\" rel=\"nofollow noreferrer\"><b>GCC 2.95.X Releases</b></a> occurred from July 1999 - March 2001 and are quite dated. x86_64 was in its infancy then. See <a href=\"https://en.wikipedia.org/wiki/X86-64\" rel=\"nofollow noreferrer\"><b>x86_64</b></a>, so it appears code generation was described using the x86_64 calling convention but either using the lower-half of the registers -- or simply mistakenly using the x86 register names. Nothing wrong with learning history, but if you intend to work with current code, you need a whole lot newer reference."}], "answers": [{"comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1462978045, "post_id": 37165479, "comment_id": 61867578, "body": "Minor addition: It is actually using the <b>whole</b> registers (<code>%rdi</code>, <code>%rsi</code>, ...). Moving into a 32 bits GP register zero extends to the whole 64 bits register. Those instruction are the efficient way to do <code>mov $3, %rdx</code> and so on."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 2, "creation_date": 1462978357, "post_id": 37165479, "comment_id": 61867797, "body": "@MargaretBloom: Gotcha.  I don&#39;t normally work at this level, so I&#39;m not aware of all the nuances.  Feel free to edit the answer if you feel it&#39;s necessary."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 5, "last_activity_date": 1462976449, "creation_date": 1462976449, "answer_id": 37165479, "question_id": 37162597, "link": "https://stackoverflow.com/questions/37162597/different-assembly-instructions-from-gcc2-9-to-5-3/37165479#37165479", "title": "different assembly instructions from gcc2.9 to 5.3", "body": "<p>The book is out of date with respect to 64-bit x86.  The <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#x86-64_calling_conventions\">x86-64 calling conventions</a> per Wikipedia are:</p>\n\n<blockquote>\n<strong>System V AMD64 ABI</strong>\n<br><br>\nThe calling convention of the System V AMD64 ABI is followed on Solaris, Linux, FreeBSD, OS X, and other UNIX-like or POSIX-compliant operating systems.  The first six integer or pointer arguments are passed in registers RDI, RSI, RDX, RCX (R10 in the Linux kernel interface), R8, and R9, while XMM0, XMM1, XMM2, XMM3, XMM4, XMM5, XMM6 and XMM7 are used for certain floating point arguments. As in the Microsoft x64 calling convention, additional arguments are passed on the stack and the return value is stored in RAX.\n</blockquote>\n\n<p>Since you're passing 32-bit values, gcc is using the lower half of each register, hence <code>%edi</code>, <code>%esi</code>, and <code>%edx</code>.  </p>\n"}], "owner": {"reputation": 1908, "user_id": 3622299, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/jna7k.jpg?s=128&g=1", "display_name": "hGen", "link": "https://stackoverflow.com/users/3622299/hgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 37165479, "answer_count": 1, "score": 2, "last_activity_date": 1462976449, "creation_date": 1462969388, "last_edit_date": 1462971136, "question_id": 37162597, "link": "https://stackoverflow.com/questions/37162597/different-assembly-instructions-from-gcc2-9-to-5-3", "title": "different assembly instructions from gcc2.9 to 5.3", "body": "<p>I have the following C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid function(int a, int b, int c) {\n  int buff_1[5];\n  int buff_2[10];\n\n  buff_1[0] = 6;\n  buff_2[0] = 'A';\n  buff_2[1] = 'B';\n}\n\nint main(void) {\n  int i = 1;\n  function(1,2,3);\n  return 0;\n}\n</code></pre>\n\n<p>now I want to analyze the associated assembly code:\nThe assembly instructions before the function call, according to the book I'm reading are:</p>\n\n<pre><code>pushl $3\npushl $2\npushl $1\ncall function\n</code></pre>\n\n<p>The underlying object file was created using <code>gcc-5.3 -O0 -c functions.c</code>.\nHowever, if I create the assembly code using <code>objdump</code> I get the following instructions:</p>\n\n<pre><code>movl $3, %edx\nmovl $2, %esi\nmovl $1, %edi\n</code></pre>\n\n<p>As far as I understand assembly (I'm pretty new to it) the first one makes more sense to me.</p>\n\n<p>Is the book simply wrong? Or is the books output just outdated because of using <code>gcc 2.9</code></p>\n"}, {"tags": ["c", "makefile"], "answers": [{"tags": [], "owner": {"reputation": 344, "user_id": 4618003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e8f098af732d64e92365592e685a3c?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4618003/bernhard"}, "is_accepted": true, "score": 1, "last_activity_date": 1462969705, "creation_date": 1462969705, "answer_id": 37162715, "question_id": 37162553, "link": "https://stackoverflow.com/questions/37162553/what-is-the-implicit-command-in-thing-o-thing-c-in-a-makefile/37162715#37162715", "title": "What is the implicit command in &quot;thing.o: thing.c&quot; in a Makefile?", "body": "<p>It does just compile (not link), thus you need option -c:</p>\n\n<pre><code>$(CC) $(CFLAGS) -c thing.c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "is_accepted": false, "score": 1, "last_activity_date": 1462969868, "creation_date": 1462969868, "answer_id": 37162798, "question_id": 37162553, "link": "https://stackoverflow.com/questions/37162553/what-is-the-implicit-command-in-thing-o-thing-c-in-a-makefile/37162798#37162798", "title": "What is the implicit command in &quot;thing.o: thing.c&quot; in a Makefile?", "body": "<p>You can use <code>make -pn</code> to dump the built-in rules, the one you're looking for is </p>\n\n<pre><code>%.o: %.c\n    $(COMPILE.c) $(OUTPUT_OPTION) $&lt;\n</code></pre>\n\n<p>which can be further broken down into</p>\n\n<pre><code>$(CC) $(CFLAGS) $(CPPFLAGS) $(TARGET_ARCH) -c -o $@ $&lt;\n</code></pre>\n\n<p><code>-c</code> is probably the main culprit although <code>CPPFLAGS</code> could play a role too.</p>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 37162715, "answer_count": 2, "score": 0, "last_activity_date": 1462969868, "creation_date": 1462969304, "question_id": 37162553, "link": "https://stackoverflow.com/questions/37162553/what-is-the-implicit-command-in-thing-o-thing-c-in-a-makefile", "title": "What is the implicit command in &quot;thing.o: thing.c&quot; in a Makefile?", "body": "<p>I have a Makefile with the line:</p>\n\n<pre><code>thing.o: thing.c\n</code></pre>\n\n<p>I want to give an explicit command to do the same, as I need to make a modification to what is run.</p>\n\n<p>What is the implied command?</p>\n\n<p>If I try:</p>\n\n<pre><code>$(CC) $(CFLAGS) thing.c -o thing.o\n</code></pre>\n\n<p>I get an error, so I assume that this is not what is implicit.</p>\n\n<p>When I use the implicit make rule (i.e. I specify no command) it works properly.</p>\n\n<p>(The error, only when explicitly specifying the command, is:</p>\n\n<pre><code>/opt/avr8-gnu-toolchain-linux_x86_64/bin/avr-gcc -g -Wall -mcall-prologues -mmcu=atmega328p  -Os thing.o -Wl,-gc-sections -Wl,-relax -o pmu.obj\npmu.o: In function `__vector_22':\n(.text+0x7c): multiple definition of `__bad_interrupt'\n/opt/avr8-gnu-toolchain-linux_x86_64/bin/../lib/gcc/avr/4.9.2/../../../../avr/lib/avr5/crtatmega328p.o:(.text+0x0): first defined here\n/opt/avr8-gnu-toolchain-linux_x86_64/bin/../lib/gcc/avr/4.9.2/../../../../avr/bin/ld: Disabling relaxation: it will not work with multiple definitions\nthing.o: In function `__vectors':\n(.text+0x0): multiple definition of `__vectors'\n/opt/avr8-gnu-toolchain-linux_x86_64/bin/../lib/gcc/avr/4.9.2/../../../../avr/lib/avr5/crtatmega328p.o:(.vectors+0x0): first defined here\ncollect2: error: ld returned 1 exit status\nmake: *** [thing.obj] Error 1\n</code></pre>\n\n<p>but the exact error is unimportant - I need to find what I can replace the implicit command with.)</p>\n"}, {"tags": ["c", "parallel-processing", "mpi", "openmpi"], "comments": [{"owner": {"reputation": 371, "user_id": 1833723, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66c6d9a06b51c42c5fbbb91d8ae3f586?s=128&d=identicon&r=PG", "display_name": "&#211;lavur", "link": "https://stackoverflow.com/users/1833723/%c3%93lavur"}, "edited": false, "score": 0, "creation_date": 1462974025, "post_id": 37162483, "comment_id": 61864268, "body": "I don&#39;t know why, but I fixed the issue by receiving a &quot;WTVblock_buff&quot; array and sending the corresponding &quot;WTVblock&quot; array. I&#39;ll leave the question open in case anyone can explain what is happening here, but my problem is essentially fixed."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1462975077, "post_id": 37162483, "comment_id": 61865260, "body": "You are not allocating memory for <code>WTVblock</code> in the master rank."}], "owner": {"reputation": 371, "user_id": 1833723, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66c6d9a06b51c42c5fbbb91d8ae3f586?s=128&d=identicon&r=PG", "display_name": "&#211;lavur", "link": "https://stackoverflow.com/users/1833723/%c3%93lavur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1353, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462969117, "creation_date": 1462969117, "question_id": 37162483, "link": "https://stackoverflow.com/questions/37162483/invalid-buffer-pointer-from-mpi-recv-when-sending-an-array", "title": "Invalid buffer pointer from MPI_Recv when sending an array", "body": "<p>When running my OpenMPI program, I get the error at the bottom of this post. Specifically, it is the <code>MPI_ERR_BUFFER: invalid buffer pointer</code> error caused by an <code>MPI_Recv</code> operation that is causing trouble.</p>\n\n<p>My code is rather lengthy, but I believe the error occurs when I call:</p>\n\n<pre><code>MPI_Recv(WTVblock, n_comp * bs_cols, MPI_DOUBLE, i, MPI_ANY_TAG, MPI_COMM_WORLD, &amp;status);\n</code></pre>\n\n<p><code>WTVblock</code> is a double array of size <code>n_comp * bs_cols</code>. The rest of the code can be found on <a href=\"https://github.com/olavurmortensen/distributed_nmf/blob/master/main.c\" rel=\"nofollow\">https://github.com/olavurmortensen/distributed_nmf/blob/master/main.c</a>. The receive is on line 169 and the corresponding send is on line 164.</p>\n\n<p>Error message:</p>\n\n<pre><code>[n-62-14-2:800] *** An error occurred in MPI_Recv\n[n-62-14-2:800] *** on communicator MPI_COMM_WORLD\n[n-62-14-2:800] *** MPI_ERR_BUFFER: invalid buffer pointer\n[n-62-14-2:800] *** MPI_ERRORS_ARE_FATAL: your MPI job will now abort\n[n-62-14-2][[9104,1],2][btl_tcp_frag.c:215:mca_btl_tcp_frag_recv] mca_btl_tcp_frag_recv: readv failed: Connection reset by peer (104)\n[n-62-14-2][[9104,1],4][btl_tcp_frag.c:215:mca_btl_tcp_frag_recv] mca_btl_tcp_frag_recv: readv failed: Connection reset by peer (104)\n[n-62-14-2][[9104,1],3][btl_tcp_frag.c:123:mca_btl_tcp_frag_send] mca_btl_tcp_frag_send: writev failed: Connection reset by peer (104)\n--------------------------------------------------------------------------\nmpiexec has exited due to process rank 0 with PID 800 on\nnode n-62-14-2 exiting improperly. There are two reasons this could occur:\n\n1. this process did not call \"init\" before exiting, but others in\nthe job did. This can cause a job to hang indefinitely while it waits\nfor all processes to call \"init\". By rule, if one process calls \"init\",\nthen ALL processes must call \"init\" prior to termination.\n\n2. this process called \"init\", but exited without calling \"finalize\".\nBy rule, all processes that call \"init\" MUST call \"finalize\" prior to\nexiting or it will be considered an \"abnormal termination\"\n\nThis may have caused other processes in the application to be\nterminated by signals sent by mpiexec (as reported here).\n--------------------------------------------------------------------------\n</code></pre>\n\n<p>EDIT: I am a newbie at MPI and at C, so I apologize if my question is dumb or if I am making some horrible mistakes in my code.</p>\n"}, {"tags": ["c++", "c", "visual-studio-2010", "type-conversion", "implicit-conversion"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 3, "creation_date": 1462969236, "post_id": 37162422, "comment_id": 61860291, "body": "Did you look at the generated assembler code? Maybe you should post it here."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462969785, "post_id": 37162422, "comment_id": 61860683, "body": "FYI compiled with VS2015 it  displays always <code>eq eq</code> in debug and release mode."}, {"owner": {"reputation": 30038, "user_id": 16673, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2bd7c0e93b52c224e284d18ac34752b8?s=128&d=identicon&r=PG", "display_name": "Suma", "link": "https://stackoverflow.com/users/16673/suma"}, "edited": false, "score": 0, "creation_date": 1462969878, "post_id": 37162422, "comment_id": 61860754, "body": "The VS debug might use FILD or FICOMP, which avoids the int to float conversion (works directly with 80b float registers). /fp option may also affect the behaviour."}, {"owner": {"reputation": 101, "user_id": 6319181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e33bfa8aee607a5a8ccea1191af67178?s=128&d=identicon&r=PG&f=1", "display_name": "johannes", "link": "https://stackoverflow.com/users/6319181/johannes"}, "reply_to_user": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1462971784, "post_id": 37162422, "comment_id": 61862428, "body": "@KarstenKoop: assember code attached"}, {"owner": {"reputation": 101, "user_id": 6319181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e33bfa8aee607a5a8ccea1191af67178?s=128&d=identicon&r=PG&f=1", "display_name": "johannes", "link": "https://stackoverflow.com/users/6319181/johannes"}, "reply_to_user": {"reputation": 30038, "user_id": 16673, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2bd7c0e93b52c224e284d18ac34752b8?s=128&d=identicon&r=PG", "display_name": "Suma", "link": "https://stackoverflow.com/users/16673/suma"}, "edited": false, "score": 0, "creation_date": 1462971791, "post_id": 37162422, "comment_id": 61862435, "body": "@Suma: modifying /fp: does not change results of debug or release"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1462971902, "post_id": 37162422, "comment_id": 61862522, "body": "VS2010 was the last VS version whose 32-bit C++ compiler still generated instructions for the FPU.  The wonky Intel processor component that does math with an internal 80-bit format (thus representing 16777217 accurately)  and was responsible for so many &quot;floating point math is random&quot; problems.  You&#39;ve found one more very good reason to keep your compiler updated, GCC and VS2012+ use SSE instructions."}, {"owner": {"reputation": 30038, "user_id": 16673, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2bd7c0e93b52c224e284d18ac34752b8?s=128&d=identicon&r=PG", "display_name": "Suma", "link": "https://stackoverflow.com/users/16673/suma"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1462974300, "post_id": 37162422, "comment_id": 61864528, "body": "@HansPassant If someone still wants to get x87 instructions, it should be possible to disable SSE by using /arch:ia32"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 6319181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e33bfa8aee607a5a8ccea1191af67178?s=128&d=identicon&r=PG&f=1", "display_name": "johannes", "link": "https://stackoverflow.com/users/6319181/johannes"}, "edited": false, "score": 2, "creation_date": 1462972735, "post_id": 37163406, "comment_id": 61863220, "body": "Yes, adding /arch:SSE2 to the compiling options prints <code>eq&#47;eq</code> also in debug mode. Thanks for the explanation to user6320439 and HansPassant"}], "tags": [], "owner": {"reputation": 86, "user_id": 6320439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353676250be1cf26d226904c75e1c59b?s=128&d=identicon&r=PG&f=1", "display_name": "user6320439", "link": "https://stackoverflow.com/users/6320439/user6320439"}, "is_accepted": true, "score": 6, "last_activity_date": 1462972032, "last_edit_date": 1462972032, "creation_date": 1462971440, "answer_id": 37163406, "question_id": 37162422, "link": "https://stackoverflow.com/questions/37162422/visual-studio-debug-vs-release-build-comparing-int-and-float-missmatch/37163406#37163406", "title": "Visual Studio debug vs. release build: comparing int and float missmatch", "body": "<p>If we demangle the release ASM:</p>\n\n<pre><code>; Line 14\n    push    OFFSET ??_C@_03HNJPMNDP@eq?6?$AA@\n    call    DWORD PTR __imp__printf\n    add esp, 4\n; Line 18\n    xor eax, eax\n; Line 20\n    ret 0\n</code></pre>\n\n<p>It's just printing <code>eq</code> and exiting, which suggests that the floating comparison is just completely optimized out. For the debug assembly, we see it using <code>fld</code> and <code>fild</code> instructions:</p>\n\n<pre><code>; Line 9\n    fld DWORD PTR __real@4b800000\n    fstp    DWORD PTR _f$[ebp]\n; Line 10\n    fild    DWORD PTR _i$[ebp]\n    fstp    DWORD PTR _g$[ebp]\n; Line 13\n    fild    DWORD PTR _i$[ebp]\n</code></pre>\n\n<p>These are <code>IA32</code> instructions which is the default architecture used in Visual Studio 2010. I suspect that you use <code>/arch:SSE2</code> instead  you will get different results.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/37162422/visual-studio-debug-vs-release-build-comparing-int-and-float-missmatch/37163406#comment61862522_37162422\">Hans Passant's comment</a> essentially confirms what I just said.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1462977050, "creation_date": 1462977050, "answer_id": 37165747, "question_id": 37162422, "link": "https://stackoverflow.com/questions/37162422/visual-studio-debug-vs-release-build-comparing-int-and-float-missmatch/37165747#37165747", "title": "Visual Studio debug vs. release build: comparing int and float missmatch", "body": "<p>Both sets of output are compliant C behavior.</p>\n\n<p>In performing FP math, C allows FP calculations to occur at a higher precision level than the format of the operands.  </p>\n\n<p>If the code performs <code>i == f</code> as <code>double</code> math, the result is <code>\"neq\"</code>.<br>\nIf the code performs <code>i == f</code> as <code>float</code> math, the result is <code>\"eq\"</code>.  </p>\n\n<pre><code>int i= 16777217;\nfloat f = 16777216.0;\nif( i == f )\n  printf(\"eq\\n\");\nelse\n  printf(\"neq\\n\");\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Except for assignment and cast (which remove all extra range and precision), the values yielded by operators with floating operands and values subject to the usual arithmetic conversions and of floating constants are evaluated to a format whose range and precision may be greater than required by the type C11 \u00a75.2.4.2.2 9</p>\n</blockquote>\n\n<p>Modern C compilers provide <code>FLT_EVAL_METHOD</code> which indicates what is used.</p>\n\n<hr>\n\n<blockquote>\n  <p>Is there a VS-mechanism which prevents such false positives in comparing floats and ints (conversion to int/float with more precision)?</p>\n</blockquote>\n\n<p>To force a <code>float</code> compare, code could use</p>\n\n<pre><code>if((float) i == f )\n</code></pre>\n\n<p>To force a <code>double</code> compare, code could use</p>\n\n<pre><code>if((double) i == f )\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 6319181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e33bfa8aee607a5a8ccea1191af67178?s=128&d=identicon&r=PG&f=1", "display_name": "johannes", "link": "https://stackoverflow.com/users/6319181/johannes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 37163406, "answer_count": 2, "score": 9, "last_activity_date": 1462977050, "creation_date": 1462968964, "last_edit_date": 1495535295, "question_id": 37162422, "link": "https://stackoverflow.com/questions/37162422/visual-studio-debug-vs-release-build-comparing-int-and-float-missmatch", "title": "Visual Studio debug vs. release build: comparing int and float missmatch", "body": "<p>Have a look at this example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n  int i= 16777217;\n  float f = 16777216.0;\n  float g = i;\n\n  if( i == f )\n    printf(\"eq\\n\");\n  else\n    printf(\"neq\\n\");\n\n  if( g == f )\n    printf(\"eq\\n\");\n  else\n    printf(\"neq\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>which, using Visual Studio 2010 C++ (VS) in release mode, gcc, or g++ (4.9.2), has the output</p>\n\n<pre><code>eq\neq\n</code></pre>\n\n<p>which is reasonable to me: During the first comparison, <code>i</code> is implicitly converted to a float where the significant bit in the mantissa is truncated. Thus, both <code>i</code> and <code>f</code> have the same bit pattern which compares to equality. In the second <code>if</code> the same conversion applies but was already performed when defining and initializing <code>g</code>.</p>\n\n<p>However, using VS in debug mode, the result is</p>\n\n<pre><code>neq\neq\n</code></pre>\n\n<p>It seems, the implicit conversion during comparison in the first <code>if</code> (as part of the usual arithmetic conversions in C and C++) is not applied. Is this true? Is there a VS-mechanism which prevents such false positives in comparing floats and ints (conversion to int/float with more precision)? According to <a href=\"https://msdn.microsoft.com/en-us/library/09ka8bxx%28v=vs.100%29.aspx\" rel=\"nofollow noreferrer\">MSDN</a> VS C++ follows the standard.</p>\n\n<p>I have checked the bit representation with <a href=\"https://stackoverflow.com/a/3974138\">this function</a>. For all compilers it yields to</p>\n\n<pre><code>i = 00000001000000000000000000000001\nf = 01001011100000000000000000000000\ng = 01001011100000000000000000000000\n</code></pre>\n\n<p><code>float.h</code> on VS states <code>#define FLT_MANT_DIG 24</code> so the described truncation issue should hold as well.</p>\n\n<p>I compiled all on the same machine (Intel i5-3570K) but for VS in a virtual box. Compiling with VS on another machine also prints <code>neq/eq</code>. </p>\n\n<p><strong>EDIT</strong>: assembler code attached</p>\n\n<p>differences_debug.asm</p>\n\n<pre><code>; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 \n\n    TITLE   c:\\Users\\user\\documents\\visual studio 2010\\Projects\\differences\\differences\\differences.cpp\n    .686P\n    .XMM\n    include listing.inc\n    .model  flat\n\nINCLUDELIB MSVCRTD\nINCLUDELIB OLDNAMES\n\nPUBLIC  ??_C@_04LMPLCMBC@neq?6?$AA@         ; `string'\nPUBLIC  ??_C@_03HNJPMNDP@eq?6?$AA@          ; `string'\nPUBLIC  __real@4b800000\nPUBLIC  _wmain\nEXTRN   __imp__printf:PROC\nEXTRN   __fltused:DWORD\nEXTRN   __RTC_CheckEsp:PROC\nEXTRN   __RTC_Shutdown:PROC\nEXTRN   __RTC_InitBase:PROC\n;   COMDAT ??_C@_04LMPLCMBC@neq?6?$AA@\n; File c:\\users\\user\\documents\\visual studio 2010\\projects\\differences\\differences\\differences.cpp\nCONST   SEGMENT\n??_C@_04LMPLCMBC@neq?6?$AA@ DB 'neq', 0aH, 00H      ; `string'\nCONST   ENDS\n;   COMDAT ??_C@_03HNJPMNDP@eq?6?$AA@\nCONST   SEGMENT\n??_C@_03HNJPMNDP@eq?6?$AA@ DB 'eq', 0aH, 00H        ; `string'\nCONST   ENDS\n;   COMDAT __real@4b800000\nCONST   SEGMENT\n__real@4b800000 DD 04b800000r           ; 1.67772e+007\nCONST   ENDS\n;   COMDAT rtc$TMZ\nrtc$TMZ SEGMENT\n__RTC_Shutdown.rtc$TMZ DD FLAT:__RTC_Shutdown\nrtc$TMZ ENDS\n;   COMDAT rtc$IMZ\nrtc$IMZ SEGMENT\n__RTC_InitBase.rtc$IMZ DD FLAT:__RTC_InitBase\n; Function compile flags: /Odtp /RTCsu /ZI\nrtc$IMZ ENDS\n;   COMDAT _wmain\n_TEXT   SEGMENT\n_g$ = -32                       ; size = 4\n_f$ = -20                       ; size = 4\n_i$ = -8                        ; size = 4\n_argc$ = 8                      ; size = 4\n_argv$ = 12                     ; size = 4\n_wmain  PROC                        ; COMDAT\n; Line 7\n    push    ebp\n    mov ebp, esp\n    sub esp, 228                ; 000000e4H\n    push    ebx\n    push    esi\n    push    edi\n    lea edi, DWORD PTR [ebp-228]\n    mov ecx, 57                 ; 00000039H\n    mov eax, -858993460             ; ccccccccH\n    rep stosd\n; Line 8\n    mov DWORD PTR _i$[ebp], 16777217        ; 01000001H\n; Line 9\n    fld DWORD PTR __real@4b800000\n    fstp    DWORD PTR _f$[ebp]\n; Line 10\n    fild    DWORD PTR _i$[ebp]\n    fstp    DWORD PTR _g$[ebp]\n; Line 13\n    fild    DWORD PTR _i$[ebp]\n    fld DWORD PTR _f$[ebp]\n    fucompp\n    fnstsw  ax\n    test    ah, 68                  ; 00000044H\n    jp  SHORT $LN4@wmain\n; Line 14\n    mov esi, esp\n    push    OFFSET ??_C@_03HNJPMNDP@eq?6?$AA@\n    call    DWORD PTR __imp__printf\n    add esp, 4\n    cmp esi, esp\n    call    __RTC_CheckEsp\n; Line 15\n    jmp SHORT $LN3@wmain\n$LN4@wmain:\n; Line 16\n    mov esi, esp\n    push    OFFSET ??_C@_04LMPLCMBC@neq?6?$AA@\n    call    DWORD PTR __imp__printf\n    add esp, 4\n    cmp esi, esp\n    call    __RTC_CheckEsp\n$LN3@wmain:\n; Line 19\n    fld DWORD PTR _g$[ebp]\n    fld DWORD PTR _f$[ebp]\n    fucompp\n    fnstsw  ax\n    test    ah, 68                  ; 00000044H\n    jp  SHORT $LN2@wmain\n; Line 20\n    mov esi, esp\n    push    OFFSET ??_C@_03HNJPMNDP@eq?6?$AA@\n    call    DWORD PTR __imp__printf\n    add esp, 4\n    cmp esi, esp\n    call    __RTC_CheckEsp\n; Line 21\n    jmp SHORT $LN1@wmain\n$LN2@wmain:\n; Line 22\n    mov esi, esp\n    push    OFFSET ??_C@_04LMPLCMBC@neq?6?$AA@\n    call    DWORD PTR __imp__printf\n    add esp, 4\n    cmp esi, esp\n    call    __RTC_CheckEsp\n$LN1@wmain:\n; Line 24\n    xor eax, eax\n; Line 26\n    pop edi\n    pop esi\n    pop ebx\n    add esp, 228                ; 000000e4H\n    cmp ebp, esp\n    call    __RTC_CheckEsp\n    mov esp, ebp\n    pop ebp\n    ret 0\n_wmain  ENDP\n_TEXT   ENDS\nEND\n</code></pre>\n\n<p>differences_release.asm</p>\n\n<pre><code>; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 \n\n    TITLE   c:\\Users\\user\\documents\\visual studio 2010\\Projects\\differences\\differences\\differences.cpp\n    .686P\n    .XMM\n    include listing.inc\n    .model  flat\n\nINCLUDELIB OLDNAMES\n\nPUBLIC  ??_C@_03HNJPMNDP@eq?6?$AA@          ; `string'\nPUBLIC  ??_C@_04LMPLCMBC@neq?6?$AA@         ; `string'\nEXTRN   @__security_check_cookie@4:PROC\nEXTRN   __imp__printf:PROC\n;   COMDAT ??_C@_04LMPLCMBC@neq?6?$AA@\nCONST   SEGMENT\n??_C@_04LMPLCMBC@neq?6?$AA@ DB 'neq', 0aH, 00H      ; `string'\nCONST   ENDS\n;   COMDAT ??_C@_03HNJPMNDP@eq?6?$AA@\nCONST   SEGMENT\n??_C@_03HNJPMNDP@eq?6?$AA@ DB 'eq', 0aH, 00H        ; `string'\nCONST   ENDS\nPUBLIC  _wmain\nEXTRN   __fltused:DWORD\n; Function compile flags: /Ogtp\n;   COMDAT _wmain\n_TEXT   SEGMENT\n_argc$ = 8                      ; size = 4\n_argv$ = 12                     ; size = 4\n_wmain  PROC                        ; COMDAT\n; File c:\\users\\user\\documents\\visual studio 2010\\projects\\differences\\differences\\differences.cpp\n; Line 7\n    push    esi\n; Line 14\n    mov esi, DWORD PTR __imp__printf\n    push    OFFSET ??_C@_03HNJPMNDP@eq?6?$AA@\n    call    esi\n; Line 20\n    push    OFFSET ??_C@_03HNJPMNDP@eq?6?$AA@\n    call    esi\n    add esp, 8\n; Line 24\n    xor eax, eax\n    pop esi\n; Line 26\n    ret 0\n_wmain  ENDP\n_TEXT   ENDS\nEND\n</code></pre>\n"}, {"tags": ["c++", "c", "gnu", "scientific-computing"], "comments": [{"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1462967610, "post_id": 37161795, "comment_id": 61858987, "body": "Libraries listed have nothing to do with <a href=\"https://en.wikipedia.org/wiki/C_standard_library\" rel=\"nofollow noreferrer\">C standard library</a> or <a href=\"https://en.wikipedia.org/wiki/C%2B%2B_Standard_Library\" rel=\"nofollow noreferrer\">C++ standard library</a>"}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 1, "creation_date": 1462967853, "post_id": 37161795, "comment_id": 61859192, "body": "You need to read the documentation for the exact library. Usually you just pass a flag to the build system."}, {"owner": {"reputation": 27952, "user_id": 3747990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qE6kU.png?s=128&g=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/3747990/niall"}, "edited": false, "score": 1, "creation_date": 1462968824, "post_id": 37161795, "comment_id": 61859971, "body": "Yes, it is possible to convert most (if not all) static libraries to dlls somehow. If it is supported by the build, you should read the documentation from the vendor. If it is not, you can dig in and change the make file as required - either way, for all the libraries list, this is a very broad question. Possibly start with one, and when (or if) you encounter an error, then come back and ask about that."}], "owner": {"reputation": 1129, "user_id": 6319901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fb677ce3a7ce11c93597c803c82fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Sorrow", "link": "https://stackoverflow.com/users/6319901/dark-sorrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462967399, "creation_date": 1462967399, "question_id": 37161795, "link": "https://stackoverflow.com/questions/37161795/create-dll-run-time-link-library-for-standard-c-c-library", "title": "Create DLL (run-time link library) for Standard C/C++ Library", "body": "<p>Is it possible to create DLL (run-time link library) for Standard C/C++ Library like GNU Scientific Library, LibModbus, GNU Multiple Precision Arithmetic Library, LibQrEncode using Mingw that can be linked at run-time? If yes, how?\nUsing the make method creates files that can only be statically linked.</p>\n\n<p>Why this is being done :</p>\n\n<ol>\n<li>Separating user files/code from standard library</li>\n<li>Multiple user program/process working independent/minimal synchronization from each other access similar set of functions but are developed by 3 separate developers</li>\n<li>Modifying and updating files will be simpler</li>\n</ol>\n"}, {"tags": ["c", "strcpy"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1462967034, "post_id": 37161567, "comment_id": 61858519, "body": "<code>while (*dststring++ = *srcstring++) {;}</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1462967242, "post_id": 37161567, "comment_id": 61858670, "body": "You wrote &#39;clever&#39; code with an inappropriate loop construct and comma operators.  Unsurprisingly, it does not work:("}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1462967404, "post_id": 37161567, "comment_id": 61858798, "body": "set null-terminator."}, {"owner": {"reputation": 1, "user_id": 6150413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AtJrN.jpg?s=128&g=1", "display_name": "Matt B.", "link": "https://stackoverflow.com/users/6150413/matt-b"}, "edited": false, "score": 0, "creation_date": 1462967423, "post_id": 37161567, "comment_id": 61858823, "body": "It doesn&#39;t actually copy the string correctly, I have encountered this problem before and my teacher told us that there was one simple change needed to be made, but I can&#39;t figure out what it is."}, {"owner": {"reputation": 1, "user_id": 6150413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AtJrN.jpg?s=128&g=1", "display_name": "Matt B.", "link": "https://stackoverflow.com/users/6150413/matt-b"}, "edited": false, "score": 0, "creation_date": 1462967528, "post_id": 37161567, "comment_id": 61858926, "body": "If you are referring to a null terminator in the for loop, I was told that the *marker is equivalent to it already."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1462967535, "post_id": 37161567, "comment_id": 61858928, "body": "Add <code>*t=&#39;\\0&#39;;</code> before the end of function."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462967651, "post_id": 37161567, "comment_id": 61859019, "body": "Problem is that you exit the loop and the function before the copying the null termination. For future reference, please see how to provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to make things easier for everyone when asking a question."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462967664, "post_id": 37161567, "comment_id": 61859032, "body": "Did you make any attempts to debug this ?"}, {"owner": {"reputation": 1, "user_id": 6150413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AtJrN.jpg?s=128&g=1", "display_name": "Matt B.", "link": "https://stackoverflow.com/users/6150413/matt-b"}, "edited": false, "score": 0, "creation_date": 1462967805, "post_id": 37161567, "comment_id": 61859146, "body": "Alright I see the error in the code now thank you very much everyone. Yes, I did make attempts to debug this code but it ended up in me rewriting it and getting it wrong previously, so that is why I was stuck today."}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 6229026, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/o3HjY.jpg?s=128&g=1", "display_name": "Abhishek Panjabi", "link": "https://stackoverflow.com/users/6229026/abhishek-panjabi"}, "edited": false, "score": 0, "creation_date": 1462967599, "post_id": 37161810, "comment_id": 61858975, "body": "But for that we&#39;ve to import string.h header .How compiler will know that this is inbuilt function without importing header file ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462967735, "post_id": 37161810, "comment_id": 61859091, "body": "This is a comment, not an answer. Delete it before it&#39; gets downvoted."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 1, "last_activity_date": 1462967428, "creation_date": 1462967428, "answer_id": 37161810, "question_id": 37161567, "link": "https://stackoverflow.com/questions/37161567/c-one-error-in-strcpy-function-and-cannot-find-it/37161810#37161810", "title": "C: One error In strcpy function and cannot find it", "body": "<p><em>strcpy()</em> is a predefined function and you are trying to create your own <strong>strcpy</strong> function. so, when you compile your program, you are getting <strong>conflicting types</strong> error. So, first <strong>rename</strong> your function name.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1462967769, "post_id": 37161853, "comment_id": 61859124, "body": "Do not ever use <code>NULL</code> for null termination; it&#39;s a null pointer constant. Use integer zero <code>0</code> or <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 94, "user_id": 5119903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tGZWOBYlj2o/AAAAAAAAAAI/AAAAAAAAABY/B9JW5dpWBkY/photo.jpg?sz=128", "display_name": "Kons", "link": "https://stackoverflow.com/users/5119903/kons"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462967869, "post_id": 37161853, "comment_id": 61859205, "body": "Yeah you are right, I updated the comment.. I usually don&#39;t have anything defined in my environment :)"}, {"owner": {"reputation": 1, "user_id": 6150413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AtJrN.jpg?s=128&g=1", "display_name": "Matt B.", "link": "https://stackoverflow.com/users/6150413/matt-b"}, "edited": false, "score": 0, "creation_date": 1462967990, "post_id": 37161853, "comment_id": 61859309, "body": "I understood what he meant by it and used the null operator &#39;\\0&#39;, Thank you for the help."}, {"owner": {"reputation": 94, "user_id": 5119903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tGZWOBYlj2o/AAAAAAAAAAI/AAAAAAAAABY/B9JW5dpWBkY/photo.jpg?sz=128", "display_name": "Kons", "link": "https://stackoverflow.com/users/5119903/kons"}, "edited": false, "score": 0, "creation_date": 1462967991, "post_id": 37161853, "comment_id": 61859312, "body": "yep sry, new to all this :|"}, {"owner": {"reputation": 94, "user_id": 5119903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tGZWOBYlj2o/AAAAAAAAAAI/AAAAAAAAABY/B9JW5dpWBkY/photo.jpg?sz=128", "display_name": "Kons", "link": "https://stackoverflow.com/users/5119903/kons"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462968116, "post_id": 37161853, "comment_id": 61859429, "body": "@MichaelWalz that is about input parameter... so char pointer comparison"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462968204, "post_id": 37161853, "comment_id": 61859499, "body": "@Kons sorry, you are right. BTW the check for NULL as input parameter is not requested by <code>strcpy</code>."}, {"owner": {"reputation": 94, "user_id": 5119903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tGZWOBYlj2o/AAAAAAAAAAI/AAAAAAAAABY/B9JW5dpWBkY/photo.jpg?sz=128", "display_name": "Kons", "link": "https://stackoverflow.com/users/5119903/kons"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462968358, "post_id": 37161853, "comment_id": 61859613, "body": "@MichaelWalz well not requested doesn&#39;t mean not useful... :)"}], "tags": [], "owner": {"reputation": 94, "user_id": 5119903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tGZWOBYlj2o/AAAAAAAAAAI/AAAAAAAAABY/B9JW5dpWBkY/photo.jpg?sz=128", "display_name": "Kons", "link": "https://stackoverflow.com/users/5119903/kons"}, "is_accepted": true, "score": 1, "last_activity_date": 1462968636, "last_edit_date": 1462968636, "creation_date": 1462967563, "answer_id": 37161853, "question_id": 37161567, "link": "https://stackoverflow.com/questions/37161567/c-one-error-in-strcpy-function-and-cannot-find-it/37161853#37161853", "title": "C: One error In strcpy function and cannot find it", "body": "<p>Well it depends on your environment..</p>\n\n<p>For example I see a few things I don't like:</p>\n\n<ul>\n<li><p>You do not check for input parameters to be <code>!= NULL</code>. This will cause a <code>*0</code> access</p></li>\n<li><p>I see you are not terminating your string with the <code>'\\0'</code> character (or <code>0</code>).. So, after the loop (please intent.) add <code>*t = 0;</code></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 2970918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8be61a5c00087af70b64a4ecf79382?s=128&d=identicon&r=PG&f=1", "display_name": "oclaril", "link": "https://stackoverflow.com/users/2970918/oclaril"}, "is_accepted": false, "score": 0, "last_activity_date": 1462967932, "creation_date": 1462967932, "answer_id": 37162010, "question_id": 37161567, "link": "https://stackoverflow.com/questions/37161567/c-one-error-in-strcpy-function-and-cannot-find-it/37162010#37162010", "title": "C: One error In strcpy function and cannot find it", "body": "<p>This is a very simple aproach:</p>\n\n<pre><code>void copy(char * src, char * dst){\n    while(*src != '\\0'){\n        *dst = *src;\n        src++;\n        dst++;\n    }\n    *dst = '\\0';\n}\n\nint main(int argc, char** argv){\n    char src [] = \"hello\";\n    char dst [] = \"----\";\n\n    copy(src, dst);\n    printf(\"src: %s\\n\", src);\n    printf(\"dst: %s\\n\", dst );\n\n}\n</code></pre>\n\n<p>It's more or less like wildplasser comment. First you iterate over the src pointer. In c, if you have '\\0' (in a well formed string) then you can exit because it is the final character. Ok, you iterate over the src pointer and assign the value of src (*src) to the value of dst (*dst) and then you only have to increase both pointers...</p>\n\n<p>It's all</p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 5618708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce923ee5a773ad6757c6e42bb550e67?s=128&d=identicon&r=PG&f=1", "display_name": "Myrky", "link": "https://stackoverflow.com/users/5618708/myrky"}, "is_accepted": false, "score": 0, "last_activity_date": 1462981682, "last_edit_date": 1462981682, "creation_date": 1462981234, "answer_id": 37167371, "question_id": 37161567, "link": "https://stackoverflow.com/questions/37161567/c-one-error-in-strcpy-function-and-cannot-find-it/37167371#37167371", "title": "C: One error In strcpy function and cannot find it", "body": "<p>A very easy strcpy function would be:</p>\n\n<pre><code>int strcpy(char *dest,char *source)\n{\nif (source==NULL)\n{\n printf(\"The source pointer is NULL\");\n return 0;\n}\nif (dest==NULL)\n{\n dest=(char*)malloc((strlen(source)+1)*sizeof(char));\n}\nint i;\nfor (i=0;source[i]!='\\0';i++)\n {\n  dest[i]=source[i];\n }\ndest[i]='\\0';\nreturn 1;\n}\n</code></pre>\n\n<p>You should have no problem copying strings this way. Always use indexes instead of pointer operations, it's easier imo.</p>\n\n<p>If you use an IDE, you should learn to use the debug function to discover the errors and problems, usually when you deal with strings one of the most common RUNTIME problems is the lack of a '\\0', which automatically make your string functions go to memory zones where they shouldn`t be.  </p>\n"}, {"tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": false, "score": 1, "last_activity_date": 1462987854, "creation_date": 1462987854, "answer_id": 37169581, "question_id": 37161567, "link": "https://stackoverflow.com/questions/37161567/c-one-error-in-strcpy-function-and-cannot-find-it/37169581#37169581", "title": "C: One error In strcpy function and cannot find it", "body": "<p>If you want to implement your own <code>strcpy()</code>, then i would suggest to implement <code>strncpy()</code>. It will copy at-most <code>n-1</code> bytes from <code>source null-terminated character array</code> to <code>destination character array</code> and also add <code>null character</code> at the end of the <code>destination character array</code>.</p>\n\n<pre><code>void strcpy(char *dest, const char *src, size_t n)\n{\n   if ((dest == NULL) || (src == NULL))\n       return;\n   int i;\n   for(i=0; i&lt;(n-1) &amp;&amp; src[i]; i++)\n       dest[i] = src[i];\n   dest[i]='\\0';\n}\n</code></pre>\n\n<p>It wouldn't let <code>buffer overflow</code>.</p>\n\n<p>Note -     My implementation is different from standard library <code>strncpy()</code> implementation. The standard library function strncpy() copies at most n bytes of src. If there is no null byte among the first n bytes of src, the string placed in dest will not be null-terminated.</p>\n\n<blockquote>\n  <p>I know that this strcpy function below is incorrect, but I cannot seem to figure out the one or two things I need to change to fix it. </p>\n</blockquote>\n\n<p>You only need to add null character at the end of destination array.</p>\n\n<pre><code>void strcpy(char *destString, char *sourceString)\n{\n   char *marker, *t;\n   for(marker = sourceString, t = destString; *marker; marker++, t++)\n       *t = *marker;\n   *t='\\0';\n}  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6150413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AtJrN.jpg?s=128&g=1", "display_name": "Matt B.", "link": "https://stackoverflow.com/users/6150413/matt-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 37161853, "answer_count": 5, "score": -3, "last_activity_date": 1462987854, "creation_date": 1462966862, "question_id": 37161567, "link": "https://stackoverflow.com/questions/37161567/c-one-error-in-strcpy-function-and-cannot-find-it", "title": "C: One error In strcpy function and cannot find it", "body": "<p>I know that this strcpy function below is incorrect, but I cannot seem to figure out the one or two things I need to change to fix it. Any help would be greatly appreciated as I am completely stuck on this:</p>\n\n<pre><code>void strcpy(char *destString, char *sourceString)\n{\n       char *marker, *t;\n       for(marker = sourceString, t = destString; *marker; marker++, t++)\n       *t = *marker;\n}  \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 2, "creation_date": 1462966342, "post_id": 37161280, "comment_id": 61858030, "body": "What the program does and what&#39;s the expected right output?"}, {"owner": {"reputation": 1, "user_id": 6319939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1033094073437998/picture?type=large", "display_name": "Nitesh Dwivedi", "link": "https://stackoverflow.com/users/6319939/nitesh-dwivedi"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462966952, "post_id": 37161280, "comment_id": 61858468, "body": "It asks for no. of test casesafter that,  It takes input of strings of small alphabets of max.100 Output should print the no. of max. no. of used alphabet followed by that alphabet. Sample Input: 3 abac abc zzz   Sample Output: 2 a 1 a 3 z"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462967009, "post_id": 37161280, "comment_id": 61858507, "body": "Still not clear what are you trying to do"}, {"owner": {"reputation": 1, "user_id": 6319939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1033094073437998/picture?type=large", "display_name": "Nitesh Dwivedi", "link": "https://stackoverflow.com/users/6319939/nitesh-dwivedi"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462967436, "post_id": 37161280, "comment_id": 61858829, "body": "Hope now u can @fluter ... it&#39;s edited now."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462967785, "post_id": 37161280, "comment_id": 61859133, "body": "How should we know what the correct output is ?"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 0, "last_activity_date": 1462968777, "creation_date": 1462968777, "answer_id": 37162356, "question_id": 37161280, "link": "https://stackoverflow.com/questions/37161280/a2oj-shows-wrong-answer-to-my-submission-for-193/37162356#37162356", "title": "a2oj shows wrong answer to my submission for 193.?", "body": "<p>One problem is your <code>char str[100];</code> which can't hold a string with 100 letters.</p>\n\n<p>Try:</p>\n\n<pre><code>char str[101];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6319939, "user_type": "registered", "profile_image": "https://graph.facebook.com/1033094073437998/picture?type=large", "display_name": "Nitesh Dwivedi", "link": "https://stackoverflow.com/users/6319939/nitesh-dwivedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1463001698, "accepted_answer_id": 37162356, "answer_count": 1, "score": -5, "last_activity_date": 1462968777, "creation_date": 1462966118, "last_edit_date": 1462968312, "question_id": 37161280, "link": "https://stackoverflow.com/questions/37161280/a2oj-shows-wrong-answer-to-my-submission-for-193", "closed_reason": "Needs details or clarity", "title": "a2oj shows wrong answer to my submission for 193.?", "body": "<p>Does anyone know why does this program give wrong output? I tried all the test cases I can think of but it seems that there are some test cases that I don't cover. Here is the link: <a href=\"http://a2oj.com/p.jsp?ID=193\" rel=\"nofollow\">http://a2oj.com/p.jsp?ID=193</a> </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\n    int t, i;\n    scanf(\"%d\", &amp;t);\n    for(i=0;i&lt;t;i++)\n    {\n        char str[100];\n        scanf(\"%s\", str);\n        int l=strlen(str),j, c[26]= {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};\n        for(j=0;j&lt;l;j++)\n        {\n            int k;\n            for(k=97;k&lt;=122;k++)\n            {\n                if((int)str[j]==k)\n                    c[k-97]++;\n            }\n        }\n        int max=c[0], m, maxi=0;\n        for(m=0;m&lt;26;m++)\n        {\n            if(c[m]&gt;max)\n            {\n                max=c[m];\n                maxi=m;\n            }\n        }\n        printf(\"%d %c\\n\", max, maxi+97);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1462966243, "post_id": 37160873, "comment_id": 61857949, "body": "Your <code>return</code> statement is converting <code>const char *</code> to <code>char *</code>, i.e., it&#39;s implicitly changing the type by discarding the <code>const</code> restriction.  You can fix it by changing the function return type to <code>const char *</code> (or <code>char const *</code>), or removing <code>const</code> from the argument type, or you can circumvent the type system by inserting an explicit cast, i.e. <code>return (char *)s;</code>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462966386, "post_id": 37160873, "comment_id": 61858061, "body": "Sidenote: Return value of <code>strpbrk</code> should be pointer from string <code>s1</code>, not <code>s2</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1462966558, "post_id": 37160873, "comment_id": 61858184, "body": "&quot;const char *s means that &quot;s is a pointer which is pointing towards a constant char &quot; --&gt; No.  <code>s</code> points to <code>char</code> that should not be modified.  The data <code>s</code> points to may or may not be constant, but this function shall not attempt to change it.  Look. but don&#39;t touch."}, {"owner": {"reputation": 958, "user_id": 4714914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4sNJ.jpg?s=128&g=1", "display_name": "Liju Thomas", "link": "https://stackoverflow.com/users/4714914/liju-thomas"}, "edited": false, "score": 0, "creation_date": 1463030608, "post_id": 37160873, "comment_id": 61889896, "body": "@Ummair ..If any of the answers below has solved your problem, do mark any one as accepted. Read more about this here: <a href=\"https://stackoverflow.com/help/accepted-answer\">stackoverflow.com/help/accepted-answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 6319640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bec6fb84e22970db135bf5436b4f1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ummair", "link": "https://stackoverflow.com/users/6319640/ummair"}, "edited": false, "score": 0, "creation_date": 1462966041, "post_id": 37160954, "comment_id": 61857799, "body": "In first case my return type is <code>char *</code> I think it returns an address which POINTS to a character. In second <code>s2ptr</code> and <code>s2</code> are both pointers I am just giving the address which is in <code>s2</code> to <code>s2ptr</code>, isn&#39;t that allowed? If not how to correct it."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": -1, "last_activity_date": 1462965287, "creation_date": 1462965287, "answer_id": 37160954, "question_id": 37160873, "link": "https://stackoverflow.com/questions/37160873/warning-discards-const-qualifiers-from-pointer-target-type/37160954#37160954", "title": "warning: discards &#39;const&#39; qualifiers from pointer target type", "body": "<p>For the first case, your return type is a <code>char</code> You are trying to pass a <code>const char</code> as the return.</p>\n\n<p>For the second case, the problem is in <code>s2ptr=s2</code>.  <code>s2ptr</code> is a <code>char</code> and <code>s2</code> is a <code>const char</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1462966257, "post_id": 37161271, "comment_id": 61857962, "body": "Generally, there was not much thought put into the design of the C standard library. They just took a bunch of commonly used 1970s Unix functions of diverse quality and decided &quot;these are standard&quot;. So please don&#39;t go look at the C standard lib for advise how to write functions. Some functions there are canonical (like memcpy), while some are complete nonsense and blatantly dangerous to use (gets, printf/scanf family, strncpy etc)."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1462966602, "post_id": 37161271, "comment_id": 61858219, "body": "Yeah, some of them are seriously bad (and inconsistent), like <code>gets()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1462966917, "post_id": 37161271, "comment_id": 61858446, "body": "It has only take 22 years to get rid of <code>gets()</code>  (C89-C11)."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462971942, "post_id": 37161271, "comment_id": 61862557, "body": "You&#39;re using constant in place of const, those are different concepts."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462972805, "post_id": 37161271, "comment_id": 61863291, "body": "@2501 Yes, but that is a pointless detail in this context, this is an attempt to pedagogically try to explain basics to beginners. If you already know about the various C rules for conversions between pointer to type and pointer to qualified type, which I suspect you do, there is actually no need for you to read this answer in the first place; you&#39;ll learn nothing new from it."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1462973664, "post_id": 37161271, "comment_id": 61863961, "body": "But beginners don&#39;t, so they will be confused when they later learn const != constant, which you taught them that it is the same."}, {"owner": {"reputation": 2446, "user_id": 1532454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aNEeA.jpg?s=128&g=1", "display_name": "Jeff Learman", "link": "https://stackoverflow.com/users/1532454/jeff-learman"}, "edited": false, "score": 1, "creation_date": 1541624033, "post_id": 37161271, "comment_id": 93283835, "body": "When used as a formal parameter (in a function parameter list), it means &quot;a pointer to a char that the function promises not to change&quot; regardless of whether it is actually a constant."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 20, "last_activity_date": 1462966089, "creation_date": 1462966089, "answer_id": 37161271, "question_id": 37160873, "link": "https://stackoverflow.com/questions/37160873/warning-discards-const-qualifiers-from-pointer-target-type/37161271#37161271", "title": "warning: discards &#39;const&#39; qualifiers from pointer target type", "body": "<blockquote>\n  <p>Doesn't const char *s means that \"s is a pointer which is pointing towards a constant char\"</p>\n</blockquote>\n\n<p>Indeed it does. You get the warning because you are trying to convert this into a pointer pointing to a (non-constant) char. There is a rule in C saying that it is always ok to convert from pointer-to-type into pointer-to-const-type, <em>but not the other way around</em>.</p>\n\n<p>It doesn't matter if your code tries to change the values or not. Just by using <code>char*</code> you tell the compiler that you want a pointer which is allowed to change values.</p>\n\n<p>Most of the C standard library functions do not always make sense when it comes to \"const correctness\". There is for example no way to cleanly implement <code>strchr</code>. You will have to return <code>(char*)s</code> and cast away the <code>const</code>, which is very bad programming practice. This is the fault of the person who specified the <code>strchr</code> function: it is flawed by design.</p>\n"}, {"comments": [{"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1478860629, "post_id": 37161356, "comment_id": 68330647, "body": "&quot;You are not allowed to assign a const char* value to a char * pointer.&quot; - Why?"}, {"owner": {"reputation": 2446, "user_id": 1532454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aNEeA.jpg?s=128&g=1", "display_name": "Jeff Learman", "link": "https://stackoverflow.com/users/1532454/jeff-learman"}, "reply_to_user": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1541624016, "post_id": 37161356, "comment_id": 93283823, "body": "@AkshayImmanuelD: because that would allow subsequent code to modify the pointed to string, which controverts the intention of <code>const</code>."}], "tags": [], "owner": {"reputation": 958, "user_id": 4714914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4sNJ.jpg?s=128&g=1", "display_name": "Liju Thomas", "link": "https://stackoverflow.com/users/4714914/liju-thomas"}, "is_accepted": false, "score": 3, "last_activity_date": 1462966871, "last_edit_date": 1462966871, "creation_date": 1462966315, "answer_id": 37161356, "question_id": 37160873, "link": "https://stackoverflow.com/questions/37160873/warning-discards-const-qualifiers-from-pointer-target-type/37161356#37161356", "title": "warning: discards &#39;const&#39; qualifiers from pointer target type", "body": "<blockquote>\n  <p>For first warning: <em>return discards 'const' qualifiers from pointer target type</em></p>\n</blockquote>\n\n<p>C does not have an implicit conversion from <code>const-qualified</code> pointer types to non-const-qualified ones, so to overcome the warning you need to add it explicitly.</p>\n\n<p>Replace <strong><code>return s;</code></strong> with <strong><code>return (char *)s;</code></strong></p>\n\n<blockquote>\n  <p>For second warning: <em>assignment discards 'const' qualifiers from pointer target type</em></p>\n</blockquote>\n\n<ul>\n<li><strong>'s2ptr'</strong> is of type <strong><code>char *</code></strong> and <strong>'s2'</strong> is of type <strong><code>const char *</code></strong></li>\n<li>You are not allowed to assign a <strong><code>const char*</code></strong> value to a <strong><code>char *</code></strong> pointer. </li>\n</ul>\n\n<p>And regarding how to fix this warning... It depends on what you are trying to do. Either you can make <code>char *s2ptr</code> as <code>const char * s2ptr</code> or remove the <code>const</code> from <code>s2</code>.</p>\n\n<p>So if you wish to convert <code>char *s2ptr</code> to <code>const char *s2ptr</code>, do remember to explicitly cast <code>s2ptr</code> to <code>(char *)s2ptr</code> while returning it in the <em>my_strpbrk()</em> function.</p>\n"}], "owner": {"reputation": 143, "user_id": 6319640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bec6fb84e22970db135bf5436b4f1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ummair", "link": "https://stackoverflow.com/users/6319640/ummair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32979, "favorite_count": 4, "accepted_answer_id": 37161271, "answer_count": 3, "score": 14, "last_activity_date": 1462966871, "creation_date": 1462965067, "last_edit_date": 1462966296, "question_id": 37160873, "link": "https://stackoverflow.com/questions/37160873/warning-discards-const-qualifiers-from-pointer-target-type", "title": "warning: discards &#39;const&#39; qualifiers from pointer target type", "body": "<p>Doesn't  <code>const char *s</code>  means that \"s is a pointer which is pointing towards a constant char \" then why it is giving me this warning? I am not trying to change values. </p>\n\n<p>In first function warning is <code>return discards 'const' qualifiers from pointer target type</code>.</p>\n\n<p>and in second warning is <code>assignment discards 'const' qualifiers from pointer target type</code>.</p>\n\n<p>I  was trying to make library functions which are defined in <code>string.h</code>,  and also tell me how to correct it.</p>\n\n<pre><code>char *my_strchr( const char *s, int c )\n{\n    for(;*s!='\\0';s++)\n       if(*s==c)\n          return s; // warning\n\n    return 0;\n}\n\n\n\nchar *my_strpbrk( const char *s1, const char *s2 )\n{\n    char *s2ptr;\n\n    for(;*s1!='\\0';s1++)\n        for(s2ptr=s2;*s2ptr!='\\0';s2ptr++) //warning\n           if(*s1==*s2ptr)\n               return s2ptr;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "performance", "intel"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1462964080, "post_id": 37160329, "comment_id": 61856498, "body": "Privilege level 0 is kernel mode. It&#39;s not root."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5700061, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/39611b16b31ecfab7966f65bf368d6dd?s=128&d=identicon&r=PG&f=1", "display_name": "ANTHONY", "link": "https://stackoverflow.com/users/5700061/anthony"}, "edited": false, "score": 0, "creation_date": 1462965190, "post_id": 37160470, "comment_id": 61857263, "body": "oh, thanks @Olaf But any idea how to run it from OS kernel level.?"}, {"owner": {"reputation": 178, "user_id": 2200062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96637248dab9a269e98fbf0344e26a93?s=128&d=identicon&r=PG", "display_name": "desowin", "link": "https://stackoverflow.com/users/2200062/desowin"}, "edited": false, "score": 0, "creation_date": 1462965747, "post_id": 37160470, "comment_id": 61857601, "body": "In order to run code at OS kernel level you can develop kernel module. Linux kernel modules run in ring 0."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 273, "user_id": 5700061, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/39611b16b31ecfab7966f65bf368d6dd?s=128&d=identicon&r=PG&f=1", "display_name": "ANTHONY", "link": "https://stackoverflow.com/users/5700061/anthony"}, "edited": false, "score": 0, "creation_date": 1462976837, "post_id": 37160470, "comment_id": 61866638, "body": "@ANTHONY: As desowin wrote: If only the kernel runs in Ring 0, you apparently need a kernel module. Note that is not like a simple C program and can cause damage to hardware and filesystem, up to complete loss of data - because ring 0 allows code to do basically <b>anything</b>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 273, "user_id": 5700061, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/39611b16b31ecfab7966f65bf368d6dd?s=128&d=identicon&r=PG&f=1", "display_name": "ANTHONY", "link": "https://stackoverflow.com/users/5700061/anthony"}, "edited": false, "score": 0, "creation_date": 1462976887, "post_id": 37160470, "comment_id": 61866680, "body": "@ANTHONY: If the answer was helpful, please remember to upvote and/or accept."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 2, "last_activity_date": 1462963958, "creation_date": 1462963958, "answer_id": 37160470, "question_id": 37160329, "link": "https://stackoverflow.com/questions/37160329/how-to-access-rdmsr-from-c-program/37160470#37160470", "title": "how to access rdmsr from c program?", "body": "<p>You confuse CPU/hardware privileges (restrictions on instructions to execute, memory accesses) with OS/system privileges (OS functions, files, etc.). A root application does not run at a different CPU privilege level than code of a normal user. It just has more allowance for OS functions.</p>\n\n<p>You have to run that instruction from the OS kernel which typically runs at ring 0.</p>\n"}], "owner": {"reputation": 273, "user_id": 5700061, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/39611b16b31ecfab7966f65bf368d6dd?s=128&d=identicon&r=PG&f=1", "display_name": "ANTHONY", "link": "https://stackoverflow.com/users/5700061/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1462963958, "creation_date": 1462963555, "last_edit_date": 1495541279, "question_id": 37160329, "link": "https://stackoverflow.com/questions/37160329/how-to-access-rdmsr-from-c-program", "title": "how to access rdmsr from c program?", "body": "<p>From intel software developer manual 3b, I came to know MSR (10H) equal to RDTSC. So I wanted to verify it using piece of code as follows in my program:</p>\n\n<pre><code>asm volatile(\"rdmsr\":\"=a\"(lo),\"=d\"(hi):\"c\"(0x10));\n</code></pre>\n\n<p>But when I run my program it showed segmentation fault. Then a realized the caution that it work only in privilege level 0. So I run the program again with sudo access. This time the program ran without seg fault but the statement after asm volatile(..) are not getting executed. Even it dint work out.</p>\n\n<p>What shall I do to make rdmsr work in my program?\n(I am using linux on i7 core which supports these counters. I verified it.)</p>\n\n<p>Some related posts are <a href=\"https://stackoverflow.com/questions/11183654/cannot-read-back-from-msr\">Cannot read back from MSR</a> and <a href=\"https://stackoverflow.com/questions/5875778/execute-rdmsr-and-wrmsr-instructions-from-c-c-code\">rdmsr,wrmsr from c/c++ code</a></p>\n"}, {"tags": ["c", "arrays", "string", "int", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1462962134, "post_id": 37159656, "comment_id": 61855169, "body": "First, check the return value of <code>fscanf()</code>..."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1462962332, "post_id": 37159656, "comment_id": 61855304, "body": "Show <code>hello.txt</code> , definition variable and how to call this."}, {"owner": {"reputation": 3492, "user_id": 3782727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3nzV.jpg?s=128&g=1", "display_name": "Sathish", "link": "https://stackoverflow.com/users/3782727/sathish"}, "edited": false, "score": 0, "creation_date": 1462962921, "post_id": 37159656, "comment_id": 61855724, "body": "@user9012 can you please post the full question here? without that we cant help much"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1462964231, "post_id": 37159656, "comment_id": 61856609, "body": "Presented code looks like  no problem. variables or how variables pass to function  has a problem."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6319728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03282f732ce05fd91821ef62d4d6309a?s=128&d=identicon&r=PG&f=1", "display_name": "user9012", "link": "https://stackoverflow.com/users/6319728/user9012"}, "edited": false, "score": 0, "creation_date": 1462962475, "post_id": 37159845, "comment_id": 61855404, "body": "But num, human, cool are arrays declared in the main function."}, {"owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "reply_to_user": {"reputation": 1, "user_id": 6319728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03282f732ce05fd91821ef62d4d6309a?s=128&d=identicon&r=PG&f=1", "display_name": "user9012", "link": "https://stackoverflow.com/users/6319728/user9012"}, "edited": false, "score": 0, "creation_date": 1462962703, "post_id": 37159845, "comment_id": 61855588, "body": "It does not matter. You pass them to your <code>read</code> as pointers and this is all that <code>fscanf</code> needs. It would be more complex if you read several numbers into any of those arrays."}], "tags": [], "owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1462962351, "creation_date": 1462962351, "answer_id": 37159845, "question_id": 37159656, "link": "https://stackoverflow.com/questions/37159656/scanning-strings-and-ints-from-file-into-array-in-c/37159845#37159845", "title": "Scanning strings and ints from file into array in C", "body": "<p>Try </p>\n\n<pre><code>fscanf(ifile, \"%[^,] %*c %[^,] %*c %d %*c %d %*c %f\", first[0], last[0], num, human, cool);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 0, "last_activity_date": 1462970457, "last_edit_date": 1462970457, "creation_date": 1462967269, "answer_id": 37161730, "question_id": 37159656, "link": "https://stackoverflow.com/questions/37159656/scanning-strings-and-ints-from-file-into-array-in-c/37161730#37161730", "title": "Scanning strings and ints from file into array in C", "body": "<p>First, with <code>scanf</code> family of functions, a space matches any amount of white space, including none, in the input, also don't use <code>%*c</code>, it is not necessary. Second, you need to specify the comma in format string to successfully scan the fields. Third, when you <code>scanf</code> always check its return value to make sure the expected number fields were input. Try this fix:</p>\n\n<pre><code>void read(int *lines, char first[ENTRY][FIRST], char last[ENTRY][LAST], int *num, int *human, float *cool)\n{\n    FILE *ifile;\n\n    ifile = fopen(\"hello.txt\", \"r\");\n    if (ifile == NULL) return;\n\n    int ret = fscanf(ifile, \"%[^,], %[^,], %d, %d, %f\", first[0], last[0], &amp;num[0], &amp;human[0], &amp;cool[0]);\n    if (ret != 5) { // input file does not match the format\n        return;\n    }\n\n    printf(\"%s \", first[0]);\n    printf(\"%s\\n\", last[0]);\n    printf(\"%d\\n\", num[0]);\n    printf(\"%d\\n\", human[0]);\n    printf(\"%f\\n\", cool[0]);\n\n    fclose(ifile);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6319728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03282f732ce05fd91821ef62d4d6309a?s=128&d=identicon&r=PG&f=1", "display_name": "user9012", "link": "https://stackoverflow.com/users/6319728/user9012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1462970457, "creation_date": 1462961886, "last_edit_date": 1462962796, "question_id": 37159656, "link": "https://stackoverflow.com/questions/37159656/scanning-strings-and-ints-from-file-into-array-in-c", "title": "Scanning strings and ints from file into array in C", "body": "<p>I am scanning from a file into parallel arrays.\nI successfully scan the strings, but the ints and floats do not scan correctly! \nWhat is going wrong here???\nNum, human, and cool are arrays declared in the main function. </p>\n\n<p>An example of a record in hello.txt:\n<code>Angela, Merkel, 50, 10, 9.1</code></p>\n\n<pre><code>void read(int *lines, char first[ENTRY][FIRST], char last[ENTRY][LAST], int *num, int *human, float *cool)\n{\nFILE *ifile;\nint i;\n\nifile = fopen(\"hello.txt\", \"r\");\n\nfscanf(ifile, \"%[^,] %*c %[^,] %*c %d %*c %d %*c %f\", first[0], last[0], &amp;num[0], &amp;human[0], &amp;cool[0]);\n\nprintf(\"%s\", first[0]);\nprintf(\"%s\\n\", last[0]);\nprintf(\"%d\\n\", num[0]);\nprintf(\"%d\\n\", human[0]);\nprintf(\"%f\", cool[0]);\n\n\n\nfclose(ifile);\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "stack", "inline-assembly"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1462963342, "post_id": 37159578, "comment_id": 61855993, "body": "You should create <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1462963501, "post_id": 37159578, "comment_id": 61856085, "body": "<a href=\"http://stackoverflow.com/questions/19392336/gcc-inline-assembly-wont-let-me-overwrite-esp\" title=\"gcc inline assembly wont let me overwrite esp\">stackoverflow.com/questions/19392336/&hellip;</a>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1462965908, "post_id": 37159578, "comment_id": 61857707, "body": "Most likely it&#39;s not the &quot;mov&quot; that causes a segfault, it&#39;s the return from <code>fib_resume</code>. Does the stack contain sufficient information on it for the <code>fib_resume</code> function to work? Almost every operating system does context switching in assembler because it&#39;s pretty hard to know what the compiled C code expects to be on the stack."}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462966073, "post_id": 37159578, "comment_id": 61857822, "body": "@Art there is no &quot;return from <code>fib_resume</code> sorry, I should have said so but <code>fib_resume</code> is never called but only ever jumped to."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1462966283, "post_id": 37159578, "comment_id": 61857980, "body": "@User1291 Then we get to the next problem. Are you aware of which direction your stack grows in? I suspect your machine is i386, so your stack grows down. I also suspect you&#39;re on linux, so the <code>malloc(2MB)</code> will explicitly <code>mmap</code> the large chunk of memory, so <code>f-&gt;stack</code> is page aligned and the page before is potentially not mapped. The first time you make a function call or use the stack otherwise will underflow into the not mapped memory."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462966416, "post_id": 37159578, "comment_id": 61858083, "body": "In other words, try changing <code>f-&gt;esp = (reg_t)f-&gt;stack;</code> to <code>f-&gt;esp = (reg_t)f-&gt;stack + FIB_STACK_SIZE;</code> and see what happens."}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462967063, "post_id": 37159578, "comment_id": 61858532, "body": "@Art Of course, such a stupid error ... thank you. Do you want to elaborate so I can accept it as an answer?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462967089, "post_id": 37159578, "comment_id": 61858558, "body": "@User1291 Sure, will write it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 1, "last_activity_date": 1462967285, "creation_date": 1462967285, "answer_id": 37161739, "question_id": 37159578, "link": "https://stackoverflow.com/questions/37159578/c-inline-assembly-mov-instruction-segfaults/37161739#37161739", "title": "C,inline assembly - mov instruction segfaults", "body": "<p>On i386 (which is pretty apparent from the inline assembler) the stack grows down. That means towards lower addresses, so function calls will decrement the stack address.</p>\n\n<p>This means that when we're allocating a stack for a thread/process/etc. the normal way of doing it is to point the stack pointer register at the end of the allocated memory.</p>\n\n<p>In your case this should be:</p>\n\n<pre><code>f-&gt;esp = (reg_t)f-&gt;stack + FIB_STACK_SIZE;\n</code></pre>\n\n<p>I'm still not sure if it's a good idea to do this with inline assembler in a C function rather than writing the function completely in assembler, but this should resolve the immediate problem.</p>\n"}], "owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 37161739, "answer_count": 1, "score": 0, "last_activity_date": 1462967285, "creation_date": 1462961729, "question_id": 37159578, "link": "https://stackoverflow.com/questions/37159578/c-inline-assembly-mov-instruction-segfaults", "title": "C,inline assembly - mov instruction segfaults", "body": "<p>We're trying to implement some kind of \"fibers\" and want for each a \"stack\" allocated on the heap, let's say of fixed size somewhere near 2MB, for now.</p>\n\n<pre><code>//2MB ~ 2^21 B = 2097152 B\n#define FIB_STACK_SIZE 2097152\n\n#define reg_t uint32_t\n\ntypedef struct fiber fiber;\nstruct fiber{\n    ...\n    //fiber's stack\n    reg_t esp;\n    ...\n};\n</code></pre>\n\n<p>During creation of a fiber, we allocate that \"stack\" and enqueue the created struct for later use in a ready queue.</p>\n\n<pre><code>void fib_create(...){\n    //fiber struct itself\n    f = malloc(sizeof(*f)); //f later enqueued\n    ...     \n    //fiber stack\n    f-&gt;stack = malloc(FIB_STACK_SIZE);\n    f-&gt;esp = (reg_t)f-&gt;stack;\n    ...\n}\n</code></pre>\n\n<p><code>fib</code> is the struct taken from the ready queue for which we need to restore the context.</p>\n\n<p>Obviously, we first need to restore the stack pointer s.th. we can restore everything else:</p>\n\n<pre><code>void fib_resume(){\n    //assumes `fib' holds fiber to resume execution\n\n    //restore stack pointers\n    __asm__(\n        \"movl %0, %%esp;\"\n        :\n        :\"rm\"(fib-&gt;esp)\n        );\n\n    ...\n}\n</code></pre>\n\n<p>However, that move instruction will result in a segfault. Why? And how can we circumvent that?</p>\n"}, {"tags": ["c", "segmentation-fault", "shared-memory", "strcpy"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1462961881, "post_id": 37159509, "comment_id": 61854984, "body": "Post the output from <code>ipcs -m</code>."}, {"owner": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1462962189, "post_id": 37159509, "comment_id": 61855199, "body": "pardon me? there&#39;s no output, this is all i have"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462962383, "post_id": 37159509, "comment_id": 61855348, "body": "Did you get any compilation warnings? Have you read them? They should explain exactly what&#39;s wrong."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 6, "creation_date": 1462962505, "post_id": 37159509, "comment_id": 61855430, "body": "<code>shmaddr=shmat(shmid,0,0) == (char*)-1</code> --&gt; <code>(shmaddr=shmat(shmid,0,0)) == (char*)-1</code>"}, {"owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "edited": false, "score": 0, "creation_date": 1462962556, "post_id": 37159509, "comment_id": 61855471, "body": "Please pause your program before <code>strcpy</code>, run <code>ipcs -m | grep &lt;user name&gt;</code>  in another shell and post the output of the latter"}, {"owner": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "edited": false, "score": 0, "creation_date": 1462962739, "post_id": 37159509, "comment_id": 61855610, "body": "@BLUPIXY thank you very much !!!!! solved my problem"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1462962815, "post_id": 37159509, "comment_id": 61855658, "body": "@BLUEPIXY Show a programmer his error, and he will be thankful to you for a day; but show him how to avoid errors, and he will be your competition for your entire life."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1462962980, "post_id": 37159509, "comment_id": 61855761, "body": "@n.m. <i>show him how to avoid errors</i>  <b>Don&#39;t put assignments in conditional clauses.</b>  <code>if ((shmid = shmget(key, SHM_SIZE, FLAGS)) == -1)</code> and <code>if( shmaddr=shmat(shmid,0,0) == (char*)-1)</code> are <i>both</i> bad code - doing that is bug-prone.  Two lines are much clearer, and two lines aren&#39;t bug-prone:  <code>shmid = shmget(...); if ( shmid == -1 )...</code> won&#39;t ever have this problem."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1462963222, "post_id": 37159509, "comment_id": 61855915, "body": "BTW always the same: take care of compiler warnings..."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1462966716, "post_id": 37159509, "comment_id": 61858296, "body": "@AndrewHenle <code>if ((foo = bar) == foobar)</code> is idiomatic C. Beginners should learn it for no other reason than to be able to fluently read other peoples code since it is used everywhere."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1462967395, "post_id": 37159509, "comment_id": 61858790, "body": "@Art It is not idiomatic, it is dangerous rubbish, because it can easily be turned into <code>(foo == bar) == foobar</code> or <code>foo = foo++</code> or some other buggy mess. People used to write programs like that in the 70s and 80s. People invented obscure things like &quot;Yoda conditions&quot;. And then came the compiler warnings against assignment inside conditions. Programs turned better, bugs disappeared, everyone was happy except Yoda."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462967925, "post_id": 37159509, "comment_id": 61859254, "body": "@Art <i><code>if ((foo = bar) == foobar)</code> is idiomatic C</i>  The only reason beginners should learn it is so they learn not to use it.  There is absolutely no reason to use a bug-prone construct that tries to stuff too much into one line when exactly equivalent constructs exist that are not bug-prone.  When humans write code, <b>they write bugs</b>.  Why on God&#39;s good Earth would anyone want to write code in a way that makes it <i>easier</i> to introduce bugs?  Human minds are limited in ways computers are not.  What is gained from trying to stuff 4 or 5 operations in one line other than overloading the coder?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462968004, "post_id": 37159509, "comment_id": 61859322, "body": "@Lundin It&#39;s idiomatic in my world. Kernels, libc, system programs for Unix, etc. I won&#39;t argue if it&#39;s a good idea or not. But it is used everywhere, still is in modern code. Just checked in some version of Linux I had: <code>grep &#39;if ((.* = .*) ==&#39; -r . | wc</code> gets 830 matches. OpenSSH - 548. gcc - 62, binutils - 173, perl - 74, etc.  It&#39;s useful to know if you&#39;ll be reading other peoples code which almost everyone will."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1462969734, "post_id": 37159509, "comment_id": 61860651, "body": "@Art The Unix/Linux world is a special snowflake, since there are such vast amounts of ancient junk code still present in those systems. And the awfully-written Linux kernel certainly didn&#39;t improve the situation. It might be that *nix is a lost cause, but that doesn&#39;t mean that everyone everywhere else should start writing crap code, just because such code is so common in *nix."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1462969894, "post_id": 37159509, "comment_id": 61860771, "body": "@Lundin <i>it is dangerous rubbish</i> As is C in general. Here, I can have an opinion too."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462970455, "post_id": 37159509, "comment_id": 61861235, "body": "@n.m. I don&#39;t disagree with that - I can only guess how many people there are that get killed by the C language every day. Couple of thousands every year? This would be why safe subsets like MISRA-C and CERT-C have become so successful."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1462967861, "last_edit_date": 1462967861, "creation_date": 1462967130, "answer_id": 37161673, "question_id": 37159509, "link": "https://stackoverflow.com/questions/37159509/write-to-shared-memory-segmentation-fault/37161673#37161673", "title": "write to shared memory segmentation fault", "body": "<p>The problem is operator precedence. In the line</p>\n\n<pre><code>shmaddr=shmat(shmid,0,0) == (char*)-1)\n</code></pre>\n\n<p>Then the unary <code>-</code> operator and the cast operator have the highest precedence, followed by <code>==</code>, followed by <code>=</code> which has the lowest precedence. So your code turns out to be equal to </p>\n\n<pre><code>shmaddr=(shmat(shmid,0,0) == (char*)-1))\n</code></pre>\n\n<p>which is nonsense.</p>\n\n<p><strong>Assignment inside conditions is very bad programming practice</strong>. Every half-decent compiler will give you a warning if you try it. Apart from operator precedence issues, it is easy to mix up = and ==. Also, the = operator introduces a side effect to the expression, so mixing it with other operators could cause undefined behavior. And perhaps most importantly, putting = inside conditions usually reduce code readability quite a lot.</p>\n\n<p>Your code should be written as:</p>\n\n<pre><code>shmaddr = shmat(shmid,0,0);\nif(chmaddr  == (char*)-1){\n</code></pre>\n\n<p>It is important to understand that you gain <em>nothing</em> by merging these 2 rows into 1. The generated machine code will be identical, apart from the lack of bugs in the above version.</p>\n"}], "owner": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462967861, "creation_date": 1462961566, "last_edit_date": 1462961693, "question_id": 37159509, "link": "https://stackoverflow.com/questions/37159509/write-to-shared-memory-segmentation-fault", "title": "write to shared memory segmentation fault", "body": "<p>all I want to do is just write \"hey\" to my shared memory, but it gets thrown at that line. very simple code as follows:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/shm.h&gt;\n#define SHM_SIZE 1024\n#define FLAGS IPC_CREAT | 0644\nint main(){\n    key_t key;\n    int shmid;\n    if ((key = ftok(\"ex31.c\", 'k')) == -1){ \n        exit(1);}        \n    if ((shmid = shmget(key, SHM_SIZE, FLAGS)) == -1) {\n            exit(1);}\n    char* shmaddr;\n    if( shmaddr=shmat(shmid,0,0) == (char*)-1){   //WRONG ARGUMENTS ??\n            exit(0); }\n    printf(\"opened shared memory\\n\");  //gets here\n    strcpy(shmaddr, \"hey\");     //GETS THROWN HERE\n    printf(\"after writing to memory\\n\"); //never get here\n</code></pre>\n\n<p>the error the debugger gives me is:</p>\n\n<blockquote>\n  <p>Program received signal SIGSEGV, Segmentation fault.\n  0x0000000000401966 in main (argc=1, argv=0x7fffffffe068) at\n  ../ex31.c:449 449         strcpy(shmaddr, \"hey\");     //GETS THROWN HERE</p>\n</blockquote>\n"}, {"tags": ["c++", "c", "posix"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1462962110, "post_id": 37159483, "comment_id": 61855145, "body": "Maybe <code>&lt;ext&#47;stdio_filebuf.h&gt;</code> would interest you? Its a <code>GCC</code> file-buffer that wraps either a <code>FILE*</code> or a <i>file descriptor</i> so you can turn it into a <code>std::iostream</code>."}, {"owner": {"reputation": 12895, "user_id": 1881610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d33c1dcf29d614b9366ccc3e08ac793f?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/1881610/phillip"}, "edited": false, "score": 1, "creation_date": 1462962634, "post_id": 37159483, "comment_id": 61855534, "body": "The usual way is to set up the process manually: Create two set of pipes, one for stdin, one for stdout, <code>fork</code>, <code>dup2</code> the right ends to the right fd&#39;s, and <code>execv</code> the desired process. (Remember to <code>exit</code> if <code>execv</code> fails.)"}, {"owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "edited": false, "score": 0, "creation_date": 1462963109, "post_id": 37159483, "comment_id": 61855847, "body": "Thanks for the suggestions Galik and Philip. I&#39;m wondering if there&#39;s a library (maybe part of Boost or similar) that handles this? As I&#39;m not really familiar with these low-level aspects."}, {"owner": {"reputation": 12895, "user_id": 1881610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d33c1dcf29d614b9366ccc3e08ac793f?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/1881610/phillip"}, "edited": false, "score": 0, "creation_date": 1463050465, "post_id": 37159483, "comment_id": 61902399, "body": "Sure, there&#39;s <a href=\"http://www.highscore.de/boost/process/\" rel=\"nofollow noreferrer\">Boost.Process</a>."}], "answers": [{"comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1462971720, "post_id": 37160822, "comment_id": 61862376, "body": "&quot;I do not see why CMD being or not being an interactive program has anything to do with it&quot; - I believe that OP means that the program is controlled via stdin/stdout, and did not realise that a socket can be connected to stdin/stdout."}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 1, "creation_date": 1490954073, "post_id": 37160822, "comment_id": 73352312, "body": "socketpair does not allow running a program. Therefore, it is not a replacement for popen."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 1, "last_activity_date": 1462964927, "creation_date": 1462964927, "answer_id": 37160822, "question_id": 37159483, "link": "https://stackoverflow.com/questions/37159483/best-way-to-port-c-code-that-uses-a-bidirectional-popen-to-posix/37160822#37160822", "title": "Best way to port C++ code that uses a bidirectional popen() to POSIX", "body": "<p><a href=\"http://manpages.courier-mta.org/htmlman2/socketpair.2.html\" rel=\"nofollow\">socketpair(2)</a> creates a pair of sockets that are endpoints of a bidirectional pipe. This will directly replace <code>popen()</code>. I do not see why <code>CMD</code> being or not being an interactive program has anything to do with it.</p>\n\n<p>It is possible that the program might need to have an actual terminal device (unlikely, since <code>popen</code>() doesn't really emulate one). If so, the <a href=\"http://manpages.courier-mta.org/htmlman7/pty.7.html\" rel=\"nofollow\">pty(7)</a> man page provides additional documentation for creating a bi-directional pipe that drives a pseudo-tty device.</p>\n"}], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 37160822, "answer_count": 1, "score": 1, "last_activity_date": 1462964927, "creation_date": 1462961494, "last_edit_date": 1462961864, "question_id": 37159483, "link": "https://stackoverflow.com/questions/37159483/best-way-to-port-c-code-that-uses-a-bidirectional-popen-to-posix", "title": "Best way to port C++ code that uses a bidirectional popen() to POSIX", "body": "<p>I'm trying to get some C++ code running on Linux that a colleague wrote for OS X. It's mostly portable, but there's one part I don't know how to handle. He uses <code>popen(CMD, \"r+\")</code> to open a bidirectional pipe and communicates with the process through <code>fget</code> and <code>fprint</code>.</p>\n\n<p>On Linux the type <code>r+</code> is not available as pipes can only be unidirectional. I guess usually the way would be to handle bidirectional communication through a socket but the called <code>CMD</code> is an interactive program over which we have only limited control.</p>\n\n<p>After some searching I found some snippets for a <code>popen2</code> implementation in C. It works kinda but it would be much easier if there would be a real \"C++\" way to do it using streams instead of low-level functions like <code>write</code> and <code>read</code>. Also I have some problems where a lot of communication gets missing.</p>\n\n<p>Anyway, my question is: What is the best way to port code that uses bidirectional <code>popen()</code> to POSIX (or at least OS X + Linux)?</p>\n"}, {"tags": ["c", "gcc", "c-preprocessor"], "comments": [{"owner": {"reputation": 45256, "user_id": 176922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/621b61c5445afea7639b4cf6bb7c455a?s=128&d=identicon&r=PG", "display_name": "Benjamin Bannier", "link": "https://stackoverflow.com/users/176922/benjamin-bannier"}, "edited": false, "score": 0, "creation_date": 1462959757, "post_id": 37158651, "comment_id": 61853442, "body": "Could you confirm that <code>gcc</code> does indeed point to your 5.3.0 installation, e.g., with <code>which gcc</code>?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462961475, "post_id": 37158651, "comment_id": 61854709, "body": "If you add <code>-I</code> option the compiler looks first to the added include path before to look into the standard dirs. Using <code>--nostdinc</code> you are strongly sure that you are using your freshly installed headers."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1462964252, "post_id": 37158651, "comment_id": 61856626, "body": "Also, see <a href=\"http://stackoverflow.com/questions/31285258/why-usr-include-linux-stddef-h-is-empty\" title=\"why usr include linux stddef h is empty\">stackoverflow.com/questions/31285258/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "edited": false, "score": 1, "creation_date": 1463034744, "post_id": 37158767, "comment_id": 61891646, "body": "I might add that <code>gcc --print-file-name=include</code> prints the path to <code>stddef.h</code>."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "edited": false, "score": 0, "creation_date": 1463036128, "post_id": 37158767, "comment_id": 61892440, "body": "Right, gcc can do that with the option."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 7, "last_activity_date": 1462959803, "creation_date": 1462959803, "answer_id": 37158767, "question_id": 37158651, "link": "https://stackoverflow.com/questions/37158651/why-is-stddef-h-not-in-usr-include/37158767#37158767", "title": "Why is stddef.h not in /usr/include?", "body": "<p>That's because files under <code>/usr/include</code> are common headers that provided by the C library, for example, <code>glibc</code>, while the files at <code>/usr/lib/gcc</code> are specific for that particular compiler. It is common that each compiler has their own different implementation of <code>stddef.h</code>, but they will use the same <code>stdio.h</code> when links to the installed C library.</p>\n"}, {"tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 4, "last_activity_date": 1462959821, "creation_date": 1462959821, "answer_id": 37158773, "question_id": 37158651, "link": "https://stackoverflow.com/questions/37158651/why-is-stddef-h-not-in-usr-include/37158773#37158773", "title": "Why is stddef.h not in /usr/include?", "body": "<p>When you say <code>#include &lt;stddef.h&gt;</code> it does not require that <code>/usr/include/stddef.h</code> exists as a file on disk at all.  All that is required of an implementation is that <code>#include &lt;stddef.h&gt;</code> works, and that it gives you the features that header is meant to give you.</p>\n\n<p>In your case, the implementation put some of its files in another search path.  That's pretty typical.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1462960773, "last_edit_date": 1462960773, "creation_date": 1462960034, "answer_id": 37158861, "question_id": 37158651, "link": "https://stackoverflow.com/questions/37158651/why-is-stddef-h-not-in-usr-include/37158861#37158861", "title": "Why is stddef.h not in /usr/include?", "body": "<blockquote>\n  <p>Why is that file not under <code>/usr/include</code>?</p>\n</blockquote>\n\n<p>Because there's absolutely no requirement for standard headers to be located at <code>/usr/include/</code>. </p>\n\n<p>The implementation could place them anywhere. The only guarantee is \nthat when you do <code>#include &lt;stddef.h&gt;</code>, the compiler/preprocessor correctly locates and includes it. Since you disable that with <code>-nostdinc</code> option of gcc, you are on your own (to correctly give the location of that header).</p>\n"}], "owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13627, "favorite_count": 0, "accepted_answer_id": 37158767, "answer_count": 3, "score": 7, "last_activity_date": 1462960803, "creation_date": 1462959530, "last_edit_date": 1462960803, "question_id": 37158651, "link": "https://stackoverflow.com/questions/37158651/why-is-stddef-h-not-in-usr-include", "title": "Why is stddef.h not in /usr/include?", "body": "<p>I have compiled the gnu standard library and installed it in <code>$GLIBC_INST</code>.</p>\n\n<p>Now, I try to compile a <em>very</em> simple programm (using only one #include : <code>#include &lt;stdio.h&gt;</code>):</p>\n\n<pre><code>gcc --nostdinc -I$GLIBC_INST/include foo.c\n</code></pre>\n\n<p>The compilation (preprocessor?) tells me, that it doesn't find <code>stddef.h</code>.</p>\n\n<p>And indeed, there is none in <code>$GLIBC_INST/include</code> (nor is there one in <code>/usr/include</code>). However, I found a <code>stddef.h</code> in <code>/usr/lib/gcc/x86_64-unknown-linux-gnu/5.3.0/include</code>.</p>\n\n<p>Why is that file not under <code>/usr/include</code>? I thought it belonged to the standard c library and should be installed in <code>$GLIBC_INST/include</code>.</p>\n\n<p>How can I compile my <code>foo.c</code> with the newly installed standard library when it doesn't seem to come with a <code>stddef.h</code>?</p>\n\n<p><strong>Edit: Clarification</strong></p>\n\n<p>I feel that the title of this question is not optimal. As has been pointed out by some answers, there is not a requirement for <code>stddef.h</code> to be in <code>/usr/include</code> (or <code>$GLIBC_INST/include</code>, for that matter). I do understand that.</p>\n\n<p>But I am wondering how I can proceed when I want to use <code>$GLIBC_INST</code>. It seems obvious to me (although I might be wrong here) that I need to invoke gcc with <code>--nostdinc</code> in order to not use the system installed header files.\nThis entails that I use <code>-I$GLIB_INST/include</code>. This is clear to me.</p>\n\n<p>Yet, what remains unclear to me is: when I also add <code>-I/usr/lib/gcc/x86..../include</code>, how can I be sure that I do have in fact the newest header files for the freshly compiled glibc?</p>\n"}, {"tags": ["c", "gzip"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1462959779, "post_id": 37158618, "comment_id": 61853458, "body": "The shell redirection command &quot;&gt;&quot; is not an <i>argument to <code>execlp</code></i> and is most likely your error."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1462959852, "post_id": 37158618, "comment_id": 61853518, "body": "Redirection like you attempt is a feature of some <i>shells</i>. It&#39;s not something that <code>exec</code> does. If you want to <code>exec</code> your own processes, you need to reopen stdout yourself."}, {"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1462959975, "post_id": 37158618, "comment_id": 61853594, "body": "Is there a way of compress a file into a path and keep the original file without using redirection?"}, {"owner": {"reputation": 1493, "user_id": 5404527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f63666d0ec2bcfdcbd0cb0d2a79b6c?s=128&d=identicon&r=PG&f=1", "display_name": "o9000", "link": "https://stackoverflow.com/users/5404527/o9000"}, "edited": false, "score": 0, "creation_date": 1462960633, "post_id": 37158618, "comment_id": 61854082, "body": "Did you try reading the manual page for gzip? <code>man gzip</code>"}, {"owner": {"reputation": 1493, "user_id": 5404527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f63666d0ec2bcfdcbd0cb0d2a79b6c?s=128&d=identicon&r=PG&f=1", "display_name": "o9000", "link": "https://stackoverflow.com/users/5404527/o9000"}, "edited": false, "score": 1, "creation_date": 1462960745, "post_id": 37158618, "comment_id": 61854142, "body": "Run: <code>man gzip</code>. Then press <code>&#47;</code> to search. Write <code>keep</code> and press <code>Enter</code>.  Write <code>&#47;</code> and press <code>Enter</code> to navigate to another match. Good luck."}, {"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1462961945, "post_id": 37158618, "comment_id": 61855032, "body": "gzip -k does what i want, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 1493, "user_id": 5404527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f63666d0ec2bcfdcbd0cb0d2a79b6c?s=128&d=identicon&r=PG&f=1", "display_name": "o9000", "link": "https://stackoverflow.com/users/5404527/o9000"}, "is_accepted": false, "score": 3, "last_activity_date": 1462960409, "creation_date": 1462960409, "answer_id": 37159001, "question_id": 37158618, "link": "https://stackoverflow.com/questions/37158618/execl-in-c-with-gzip/37159001#37159001", "title": "Execl in C with gzip", "body": "<p>One way to do it is to invoke the shell:</p>\n\n<pre><code>execl(\"/bin/sh\", \"/bin/sh\", \"-c\", \"gzip -9c example.txt &gt; /home/paulo/new_name\", NULL);\n</code></pre>\n\n<p>That is similar to what the <code>system</code> function does. So another option is:</p>\n\n<pre><code>exit(system(\"gzip -9c example.txt &gt; /home/paulo/new_name\"));\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462960409, "creation_date": 1462959454, "question_id": 37158618, "link": "https://stackoverflow.com/questions/37158618/execl-in-c-with-gzip", "title": "Execl in C with gzip", "body": "<p>I have to gzip a file into a path. What i want to do is this:</p>\n\n<pre><code>gzip -9c example.txt &gt; /home/paulo/new_name\n</code></pre>\n\n<p>If i do this by and it works perfectly fine, but i am using a execlp to execute this in c:</p>\n\n<pre><code>  execlp(\"gzip\",\"gzip\",\"-9c\",file,\"&gt;\",path,NULL);\n</code></pre>\n\n<p>But when i use this execlp i get random characters on stdout. I just printed file and path to check if both were right:</p>\n\n<pre><code> printf(\"%s, %s\\n\",file,path);\n</code></pre>\n\n<p>And i got this:</p>\n\n<pre><code>example.txt, /home/paulo/new_name\n</code></pre>\n\n<p>Can someone tell me what i am doing wrong?</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1462958856, "post_id": 37158333, "comment_id": 61852831, "body": "Where does <code>ptr</code> point to? (clue: missing memory allocation)"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 2, "creation_date": 1462959038, "post_id": 37158333, "comment_id": 61852943, "body": "@ForceBru <code>malloc(1)</code> is obviously wrong, should be <code>sizeof(struct point)</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462959524, "post_id": 37158333, "comment_id": 61853269, "body": "@fluter or, for that matter, <code>ptr = malloc(sizeof*ptr);</code>"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1462959576, "post_id": 37158333, "comment_id": 61853303, "body": "@SouravGhosh Yeah, I prefer <code>sizeof *ptr</code> too."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1462959654, "post_id": 37158333, "comment_id": 61853360, "body": "No need to confuse the OP with dynamic memory allocation.<code>struct point X; ptr = &amp;X;</code> is sufficient."}], "answers": [{"tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 4, "last_activity_date": 1462958878, "creation_date": 1462958878, "answer_id": 37158383, "question_id": 37158333, "link": "https://stackoverflow.com/questions/37158333/pointers-to-structs-and-printing/37158383#37158383", "title": "Pointers to structs and printing", "body": "<p>Your <code>ptr</code> is a <em>pointer to <code>struct point</code></em>.</p>\n\n<p>However, <em>there is no <code>struct point</code> it is pointing to</em>.</p>\n\n<pre><code>struct point {\n    int x;\n    int y;\n} *ptr;\n\nstruct point pt; // add this...\n\nptr = &amp;pt;       // ...and this.\n\nptr-&gt;x = 8;\nptr-&gt;y = 8;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1462958928, "creation_date": 1462958928, "answer_id": 37158412, "question_id": 37158333, "link": "https://stackoverflow.com/questions/37158333/pointers-to-structs-and-printing/37158412#37158412", "title": "Pointers to structs and printing", "body": "<p>You have created a pointer called <code>ptr</code> but not initialized it.  When you dereference it with <code>ptr-&gt;</code> (or <code>*ptr</code>), you invoke undefined behavior which in your case is crashing the program (but could do anything).</p>\n\n<p>This would be better:</p>\n\n<pre><code>struct point {\n    int x;\n    int y;\n};\nstruct point sp = {0,0};\nstruct point *ptr = &amp;sp;\n\nsp.x = 8;\nptr-&gt;y = 8;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 1, "last_activity_date": 1462959949, "last_edit_date": 1462959949, "creation_date": 1462958936, "answer_id": 37158417, "question_id": 37158333, "link": "https://stackoverflow.com/questions/37158333/pointers-to-structs-and-printing/37158417#37158417", "title": "Pointers to structs and printing", "body": "<p>The problem is that the pointer <code>ptr</code> does not point to any valid memory buffer, assign it to a allocated or automatic storage instead:</p>\n\n<pre><code>// way 1\nstruct point p;\nptr = &amp;p;\nptr-&gt;x = 8;\nptr-&gt;y = 8;\n\n// way 2\nptr = malloc(sizeof *ptr);\nptr-&gt;x = 8;\nptr-&gt;y = 8;\n// when you are done remember to release the allocated memory\nfree(ptr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 480, "user_id": 4462413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KqFVA.png?s=128&g=1", "display_name": "Anish Sharma", "link": "https://stackoverflow.com/users/4462413/anish-sharma"}, "is_accepted": true, "score": 0, "last_activity_date": 1462960937, "last_edit_date": 1462960937, "creation_date": 1462960418, "answer_id": 37159009, "question_id": 37158333, "link": "https://stackoverflow.com/questions/37158333/pointers-to-structs-and-printing/37159009#37159009", "title": "Pointers to structs and printing", "body": "<p>Let me explain you the simple way.</p>\n\n<p>1.</p>\n\n<p>Variables hold the data(values to want them to hold) and pointers hold only the memory address of the variables(which are just a section of memory). Pointers are used to just hold the address of the variables so they cannot hold any user data. We can although create a pointer to a variable and manipulate that variable using the specific pointer. We first need to create the variable, then we create a pointer which references that variable, then we do anything with the pointer and the variable will be manipulated. </p>\n\n<pre><code>struct point \n{\n    int x;\n    int y;\n};\nstruct point var1;      //declare a variable\nstruct point *ptr=&amp;var1;// declare a pointer to that variable\nptr-&gt;x = 8;             // manipulate the variable\nptr-&gt;y = 8;\n</code></pre>\n\n<p>Or</p>\n\n<p>2.</p>\n\n<p>If you insist on using pointers only, then you need to allocate memory dynamically and then assign the base address of the allocated memory to the pointer. </p>\n\n<pre><code> struct point \n{\n    int x;\n    int y;\n} *ptr;\n\nptr=(struct point*)malloc(sizeof(struct point)); // this will allocate memory required to hold your structure              \nptr-&gt;x = 8;      //manipulate the memory content pointed by your pointer.       \nptr-&gt;y = 8;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 3838232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c253e1f94898a351d49fce02207a3c43?s=128&d=identicon&r=PG&f=1", "display_name": "M. Zheng", "link": "https://stackoverflow.com/users/3838232/m-zheng"}, "is_accepted": false, "score": 0, "last_activity_date": 1462978890, "creation_date": 1462978890, "answer_id": 37166505, "question_id": 37158333, "link": "https://stackoverflow.com/questions/37158333/pointers-to-structs-and-printing/37166505#37166505", "title": "Pointers to structs and printing", "body": "<p>You need to assign a valid memory location to ptr, which is a pointer to struct point. You could either use malloc, or declare a variable with struct point and assign its address to ptr (like the above answers).</p>\n\n<p>Btw, if ptr has file scope, then it is initialized with zero, i.e., the NULL pointer; otherwise, evaluating ptr is undefined behavior (you could get any value). In both cases, trying to dereference ptr is undefined behavior and thus you could get the segfault (in some implementation you might modified some memory location unintendedly). </p>\n"}], "owner": {"reputation": 147, "user_id": 4644253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1411c9d575ee6d940f62ccb533665d15?s=128&d=identicon&r=PG&f=1", "display_name": "George Waat", "link": "https://stackoverflow.com/users/4644253/george-waat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 37159009, "answer_count": 5, "score": 1, "last_activity_date": 1462978890, "creation_date": 1462958756, "question_id": 37158333, "link": "https://stackoverflow.com/questions/37158333/pointers-to-structs-and-printing", "title": "Pointers to structs and printing", "body": "<p>I've been learning structs and I've come to the pointers to structs, where I'm currently struggling with this.</p>\n\n<p>I've got this piece of code:</p>\n\n<pre><code>struct point {\n    int x;\n    int y;\n} *ptr;\n\nptr-&gt;x = 8;\nptr-&gt;y = 8;\n</code></pre>\n\n<p>Running this gives a segmentation error. What I want to do is assign the value of 8 to x /y, to which, as far as I understand it, ptr is pointing to. </p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 1989, "user_id": 1012497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B03SM.jpg?s=128&g=1", "display_name": "nikli", "link": "https://stackoverflow.com/users/1012497/nikli"}, "edited": false, "score": 0, "creation_date": 1462958629, "post_id": 37158210, "comment_id": 61852675, "body": "<a href=\"http://stackoverflow.com/questions/4906977/how-to-access-environment-variables-from-python\" title=\"how to access environment variables from python\">stackoverflow.com/questions/4906977/&hellip;</a>"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1462958770, "post_id": 37158210, "comment_id": 61852770, "body": "What would you do with this address? Are you aware that each process has its own address space and its own copy of the environment?"}, {"owner": {"reputation": 101, "user_id": 5013062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-79FkXBDkFe8/AAAAAAAAAAI/AAAAAAAAAD4/rYOMeNwhuXE/photo.jpg?sz=128", "display_name": "Davide Cremona", "link": "https://stackoverflow.com/users/5013062/davide-cremona"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1462958956, "post_id": 37158210, "comment_id": 61852893, "body": "@interjay: once I print the address, I can launch (remaining in the child bash process spawned by Python) the vulnerable program overwriting the return address with the one of my environment variable to execute the shellcode"}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1462959669, "post_id": 37158210, "comment_id": 61853372, "body": "Though shellcode is probably going to use some implementation specified or undefined behaviour anyway it might be pointless to point out that <code>printf(&quot;%x&quot;, getenv(&quot;EGG&quot;))</code> is undefined behaviour: <code>&quot;%x&quot;</code> expects an <code>unsigned int</code> argument, but you gave it <code>char *</code>. The correct format specifier and call would be <code>printf(&quot;%p&quot;, (void *)getenv(&quot;EGG&quot;))</code>."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1462961188, "post_id": 37158210, "comment_id": 61854493, "body": "@D.C. The address of the environment variable in the child bash process won&#39;t be the same as the address in the Python process."}, {"owner": {"reputation": 101, "user_id": 5013062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-79FkXBDkFe8/AAAAAAAAAAI/AAAAAAAAAD4/rYOMeNwhuXE/photo.jpg?sz=128", "display_name": "Davide Cremona", "link": "https://stackoverflow.com/users/5013062/davide-cremona"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1462966591, "post_id": 37158210, "comment_id": 61858212, "body": "@interjay at the end I have used gdb to get the address of my environment variable, without using Python or C"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5013062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-79FkXBDkFe8/AAAAAAAAAAI/AAAAAAAAAD4/rYOMeNwhuXE/photo.jpg?sz=128", "display_name": "Davide Cremona", "link": "https://stackoverflow.com/users/5013062/davide-cremona"}, "edited": false, "score": 0, "creation_date": 1462959255, "post_id": 37158396, "comment_id": 61853069, "body": "I have tried this but the C program and the Python one gives to me different results..."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 1, "creation_date": 1462959259, "post_id": 37158396, "comment_id": 61853073, "body": "That would be the id (address in CPython) of the python string corresponding the env variable of the python process. A very different thing from the environment of the child process and a c-string."}], "tags": [], "owner": {"reputation": 8714, "user_id": 5088142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1MIVg.jpg?s=128&g=1", "display_name": "Yaron", "link": "https://stackoverflow.com/users/5088142/yaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1462959526, "last_edit_date": 1462959526, "creation_date": 1462958890, "answer_id": 37158396, "question_id": 37158210, "link": "https://stackoverflow.com/questions/37158210/get-environment-variable-address-with-python/37158396#37158396", "title": "Get environment variable address with Python", "body": "<p>You can use id() <a href=\"https://docs.python.org/2/library/functions.html#id\" rel=\"nofollow\">https://docs.python.org/2/library/functions.html#id</a></p>\n\n<pre><code>id(os.environ.get('EGG')\n</code></pre>\n\n<p>in hex:</p>\n\n<pre><code>hex(id(os.environ.get('EGG'))\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5013062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-79FkXBDkFe8/AAAAAAAAAAI/AAAAAAAAAD4/rYOMeNwhuXE/photo.jpg?sz=128", "display_name": "Davide Cremona", "link": "https://stackoverflow.com/users/5013062/davide-cremona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 0, "accepted_answer_id": 37158396, "answer_count": 1, "score": 0, "last_activity_date": 1462959526, "creation_date": 1462958420, "last_edit_date": 1462958519, "question_id": 37158210, "link": "https://stackoverflow.com/questions/37158210/get-environment-variable-address-with-python", "title": "Get environment variable address with Python", "body": "<p>for an university project I have to perform Buffer Overflow with some programs given by the professor.</p>\n\n<p>I want to setup my shellcode environment variable with python and I do that with:</p>\n\n<pre><code>import os\nos.environ(\"EGG\") = \"...\"\nos.system('bash')\n</code></pre>\n\n<p>so now python spawns a child bash process. But now how can I print the address of EGG?\nI have done this with C:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(){\n    printf(\"%x\", getenv(\"EGG\"));\n    return 0;\n}\n</code></pre>\n\n<p>but I want to do it with Python. Anyone can help?</p>\n"}, {"tags": ["c", "linux", "alsa"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6319239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f518aa0e12375c99d3360d415cb4a414?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/6319239/jasper"}, "is_accepted": false, "score": 0, "last_activity_date": 1463299713, "creation_date": 1463299713, "answer_id": 37235911, "question_id": 37157922, "link": "https://stackoverflow.com/questions/37157922/alsa-snd-pcm-writei-underrun-error/37235911#37235911", "title": "alsa snd_pcm_writei underrun error", "body": "<p>I might have found the issue. The default start threshold in configuration is 1. And when I set this to n times of my writing frames (n = 4 is what I used), the underrun issue drops its occurrences. Only once in several minutes underrun may occur. So I assume the problem is that sound card will trying to get frames while the buffer size larger than 1 (threshold).</p>\n"}], "owner": {"reputation": 1, "user_id": 6319239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f518aa0e12375c99d3360d415cb4a414?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/6319239/jasper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463299713, "creation_date": 1462957730, "last_edit_date": 1462962064, "question_id": 37157922, "link": "https://stackoverflow.com/questions/37157922/alsa-snd-pcm-writei-underrun-error", "title": "alsa snd_pcm_writei underrun error", "body": "<p>I am using <code>alsa</code> in arm linux 3.10. There are 3 wireless devices: two capture and send pcm using <code>snd_pcm_readi</code> and <code>sendmsg</code> and one as receiver, playback what was received using <code>snd_pcm_writei</code>.</p>\n\n<p>Here is procedure:\nprograms works fine while 1 sender and 1 receiver. But when I stop first sender and start the second sender, receiver side has underrun error. For each sender, receiver has a unique pcm handle to deal with data. And all sides are using the same configuration except sender handle open with name <code>default[snd_pcm_open(pcm_handle, \"default\", stream,0)]</code> and receiver handle are using <code>plug:dmix</code>.<code>[snd_pcm_open(pcm_handle, \"plug:dmix\", stream,0)]</code></p>\n\n<pre><code>while(1)\n{\n  recv_from();\n  if sender one or two's first packet\n     alsa init handle1 or handle2\n  int err = snd_pcm_writei(handle1 or 2, buffer, 224);\n  if(err == -EPIPE)\n  {\n    fprintf(stderr, \"underrun occurred\\n\");\n    snd_pcm_prepare(handle);\n    continue;\n  }\n}\n</code></pre>\n\n<p>The purpose is to make the receiver be able to play mixed sound for both senders. Can anyone help me with this, I am new to <code>alsa</code> programming. Thanks in advance!</p>\n"}, {"tags": ["c", "timer", "stm32"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1462959002, "post_id": 37157799, "comment_id": 61852922, "body": "I can see where you enable/disable the timer interrupt, but I can&#39;t actually see any timer start/stop at all?"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 6253890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1953d8e22c4fcd4740279798f6661dda?s=128&d=identicon&r=PG&f=1", "display_name": "051026luyaok", "link": "https://stackoverflow.com/users/6253890/051026luyaok"}, "is_accepted": false, "score": 10, "last_activity_date": 1462960443, "creation_date": 1462960443, "answer_id": 37159018, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32/37159018#37159018", "title": "How can I start and stop a timer on STM32?", "body": "<p>I think \u201cNVIC_DisableIRQ(TIM7_IRQn);\u201d just disable the timer's interrupt but not stop the timer.\nYou may need: \"TIM_Cmd(TIM7, DISABLE);\" instead of \u201cNVIC_DisableIRQ(TIM7_IRQn);\u201d </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5982745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3b2bf7f901d6887286c534dd966e5e?s=128&d=identicon&r=PG&f=1", "display_name": "opetany93", "link": "https://stackoverflow.com/users/5982745/opetany93"}, "is_accepted": false, "score": 3, "last_activity_date": 1463593593, "creation_date": 1463593593, "answer_id": 37306805, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32/37306805#37306805", "title": "How can I start and stop a timer on STM32?", "body": "<p>Or you can set/unset bit CEN in CR1 register to enable/disable timer</p>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 4156890, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb2a85293501c684164b543a01027def?s=128&d=identicon&r=PG&f=1", "display_name": "RishabhHardas", "link": "https://stackoverflow.com/users/4156890/rishabhhardas"}, "is_accepted": false, "score": 3, "last_activity_date": 1463642360, "creation_date": 1463642360, "answer_id": 37316438, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32/37316438#37316438", "title": "How can I start and stop a timer on STM32?", "body": "<p>The timers can be enabled/disabled by toggling the CEN bit of the timers control register 1 (TIMx_CR1). CEN is usually the 0th bit.</p>\n\n<p><code>TIM_Cmd(ENABLE)</code> function call will enable the timer.</p>\n\n<p><code>TIM_Cmd(DISABLE)</code> function call will disable the timer.</p>\n\n<p>By calling <code>NVIC_DisableIRQ(TIM7_IRQn)</code>, you are just disabling the interrupt for Timer7 not the Timer.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5472835, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201071146376137/picture?type=large", "display_name": "Michal D", "link": "https://stackoverflow.com/users/5472835/michal-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1487886635, "last_edit_date": 1487886635, "creation_date": 1478157962, "answer_id": 40395935, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32/40395935#40395935", "title": "How can I start and stop a timer on STM32?", "body": "<p>Like said before, the CR1 does the work.</p>\n\n<p>You can write <code>TIMx-&gt;CR1 |= value;</code> where the 0th bit in <code>0</code> disables the TIM, and <code>1</code> enables.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7893079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d04a743a0abddb6edeb5bf81348635e?s=128&d=identicon&r=PG&f=1", "display_name": "clover", "link": "https://stackoverflow.com/users/7893079/clover"}, "is_accepted": false, "score": 2, "last_activity_date": 1492658243, "creation_date": 1492658243, "answer_id": 43509596, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32/43509596#43509596", "title": "How can I start and stop a timer on STM32?", "body": "<p>You canchange CR1 value to enable or disable timer.As follows,</p>\n\n<pre><code>#define EnableTim(n)               (n.TIMx-&gt;CR1 |= TIM_CR1_CEN)\n#define DisableTim(n)              (n.TIMx-&gt;CR1 &amp;= (~((U16)TIM_CR1_CEN)))\n</code></pre>\n\n<p>In addtion, when disable timer, it is best to clear CNT and SR register.Because when you use the 32bit timer, timer maybe go wrong if you do not chear CNT and SR.Code follows,</p>\n\n<pre><code>#define ClearTimCount(n)           (n.TIMx-&gt;CNT = 0)\n#define ClearTimeFlag(n)           (n.TIMx-&gt;SR = (U16)~TIM_FLAG_Update)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2248, "user_id": 63730, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ebb5fa10152f25f788221ae03ca172d?s=128&d=identicon&r=PG", "display_name": "geschema", "link": "https://stackoverflow.com/users/63730/geschema"}, "edited": false, "score": 1, "creation_date": 1557914216, "post_id": 55011311, "comment_id": 98922596, "body": "first one should be HAL_TIM_Base_Start()"}], "tags": [], "owner": {"reputation": 412, "user_id": 8366223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107359af121500ce10f16b359f7043db?s=128&d=identicon&r=PG&f=1", "display_name": "PolyGlot", "link": "https://stackoverflow.com/users/8366223/polyglot"}, "is_accepted": false, "score": 3, "last_activity_date": 1558472051, "last_edit_date": 1558472051, "creation_date": 1551818843, "answer_id": 55011311, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32/55011311#55011311", "title": "How can I start and stop a timer on STM32?", "body": "<p>Using <a href=\"http://www.disca.upv.es/aperles/arm_cortex_m3/llibre/st/STM32F439xx_User_Manual/stm32f4xx__hal__tim_8c.html\" rel=\"nofollow noreferrer\">HAL</a>, start:</p>\n\n<pre><code>HAL_TIM_Base_Start(&amp;htim#);\nHAL_TIM_Base_Start_IT(&amp;htim#);\n</code></pre>\n\n<p>Stop:</p>\n\n<pre><code>HAL_TIM_Base_Stop(&amp;htim#);\nHAL_TIM_Base_Stop_IT(&amp;htim#);\n</code></pre>\n\n<p>Where <code>_IT</code> is for timer interrupt mode. And you can reconfigure timer after stopping it.</p>\n"}], "owner": {"reputation": 317, "user_id": 5684132, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10206959610406880/picture?type=large", "display_name": "Sandeerius", "link": "https://stackoverflow.com/users/5684132/sandeerius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21702, "favorite_count": 2, "answer_count": 6, "score": 5, "last_activity_date": 1558472051, "creation_date": 1462957412, "last_edit_date": 1539063539, "question_id": 37157799, "link": "https://stackoverflow.com/questions/37157799/how-can-i-start-and-stop-a-timer-on-stm32", "title": "How can I start and stop a timer on STM32?", "body": "<p>I have a big problem. I don't know how I can stop a timer with a button and restart the timer with another button.</p>\n\n<p>This is the code that I have for it so far:</p>\n\n<hr>\n\n<p>This code is the interrupt handler for the button that starts the timer. I thought that it is possible by enabling the timer, that works so far.</p>\n\n<pre><code>void EXTI0_1_IRQHandler(void)\n{\n    if ((EXTI-&gt;PR &amp; EXTI_PR_PR1) == EXTI_PR_PR1)  /* Check line 1 has triggered the IT */\n    {\n        EXTI-&gt;PR = EXTI_PR_PR1; /* Clear the pending bit */\n        NVIC_EnableIRQ(TIM7_IRQn);\n\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>This code is the interrupt handler for the button that stops the timer. This piece of code doesn't work, and the timer stays on.</p>\n\n<pre><code>void EXTI4_15_IRQHandler(void)\n{\n    if ((EXTI-&gt;PR &amp; EXTI_PR_PR4) == EXTI_PR_PR4)  /* Check line 1 has triggered the IT */\n    {\n        EXTI-&gt;PR = EXTI_PR_PR4; /* Clear the pending bit */\n        NVIC_DisableIRQ(TIM7_IRQn);\n    }\n}\n</code></pre>\n\n<p>Does anyone have some tips or know how it must be?</p>\n"}, {"tags": ["c", "gcc", "assembly", "stack", "inline-assembly"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1462961772, "post_id": 37157552, "comment_id": 61854910, "body": "Just FYI, it&#39;s almost always better to let the compiler save/restore registers if it wants to.  Use constraints to tell it which regs you want to clobber, or better: to let it pick temp regs for you.  See the inline asm links in <a href=\"http://stackoverflow.com/tags/x86/info\">the x86 tag wiki</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 5, "last_activity_date": 1462957475, "creation_date": 1462957475, "answer_id": 37157819, "question_id": 37157552, "link": "https://stackoverflow.com/questions/37157552/gcc-inline-assembly-pushad-popad-missing/37157819#37157819", "title": "gcc, inline assembly - pushad/popad missing?", "body": "<p>GCC use AT/T assembly syntax, while <code>pushad/popad</code> are Intel convention, try this:</p>\n\n<pre><code>__asm__(\"pushal;\");\n__asm__(\"popal;\");\n</code></pre>\n"}], "owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "accepted_answer_id": 37157819, "answer_count": 1, "score": 3, "last_activity_date": 1462957475, "creation_date": 1462956750, "question_id": 37157552, "link": "https://stackoverflow.com/questions/37157552/gcc-inline-assembly-pushad-popad-missing", "title": "gcc, inline assembly - pushad/popad missing?", "body": "<p>Any way to avoid having to copy-paste the <code>pushad</code>/<code>popad</code> instruction body into my code?</p>\n\n<p>Because gcc (current flags: <code>-Wall -m32</code>) complains that</p>\n\n<pre><code>__asm__(\"pushad;\");\n</code></pre>\n\n<blockquote>\n  <p>Error: no such instruction: `pushad'</p>\n</blockquote>\n\n<pre><code>__asm__(\"popad;\");\n</code></pre>\n\n<blockquote>\n  <p>Error: no such instruction: `popad'</p>\n</blockquote>\n"}, {"tags": ["c", "fortran", "cygwin", "gfortran", "fortran-iso-c-binding"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1462956506, "post_id": 37157372, "comment_id": 61851197, "body": "This doesn&#39;t have much to do with C++."}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 1, "creation_date": 1462956627, "post_id": 37157372, "comment_id": 61851283, "body": "Isn&#39;t this the same question as <a href=\"http://stackoverflow.com/questions/37147425/c-returning-fortran-results\" title=\"c returning fortran results\">stackoverflow.com/questions/37147425/&hellip;</a> tidied up a little ?"}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1462956912, "post_id": 37157372, "comment_id": 61851486, "body": "You should edit and improve your old question. Do not repost the same, you risk don-votes and even a ban. Please note, deleted questions do count towards the question ban."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1462957045, "post_id": 37157372, "comment_id": 61851598, "body": "But gmf_ definitely does not return a double. It does not return anything in Fortran and hence it does not return anything in C. You must first understand how the subroutine works and what the arguments (parameters) do and only after that you can use it in C. The documentation in the Fortran code clearly states which arguments are the output."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 1, "creation_date": 1462957443, "post_id": 37157372, "comment_id": 61851877, "body": "BTW publishing a code in 2005 and 2011 which starts with <code>implicit double precision</code> is almost an offence."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6006752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01002c16ad769b24dbf525c2b3628f7a?s=128&d=identicon&r=PG&f=1", "display_name": "noble334", "link": "https://stackoverflow.com/users/6006752/noble334"}, "edited": false, "score": 0, "creation_date": 1462964086, "post_id": 37159458, "comment_id": 61856504, "body": "Thanks roygvib...Your answer works well...Later, I change my fortran structure to function with &quot;function (dmjd, dlat, dlon, dhgt, zd)  result(gmfh, gmfw)&quot; and it worked as well with my c code"}, {"owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "reply_to_user": {"reputation": 21, "user_id": 6006752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01002c16ad769b24dbf525c2b3628f7a?s=128&d=identicon&r=PG&f=1", "display_name": "noble334", "link": "https://stackoverflow.com/users/6006752/noble334"}, "edited": false, "score": 0, "creation_date": 1462964457, "post_id": 37159458, "comment_id": 61856758, "body": "Hmm, you may need some caution to get multiple return variables from Fortran <code>function</code>; please see <a href=\"http://stackoverflow.com/questions/37120263/function-which-returns-multiple-values/\" title=\"function which returns multiple values\">stackoverflow.com/questions/37120263/&hellip;</a>  (though this QA is not about C-Fortran interface). If necessary, please consider posting a different quetion (because it is a very different topic, I guess)."}], "tags": [], "owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "is_accepted": false, "score": 0, "last_activity_date": 1462961443, "creation_date": 1462961443, "answer_id": 37159458, "question_id": 37157372, "link": "https://stackoverflow.com/questions/37157372/calling-fortran-subroutines-from-c-code/37159458#37159458", "title": "Calling Fortran Subroutines from C code", "body": "<p>As a starter, please try the following modifications. The key point is that because <code>gmf()</code> is a Fortran <code>subroutine</code> (not a <code>function</code>), it returns nothing as the return variable. So we do not need to write <code>result = gmf_(...);</code> but rather simply write <code>gmf_(...);</code>. Please note that the values of <code>gmfh</code> and <code>gmfw</code>will be modified directly by <code>gmf()</code> on the Fortran side, because they are passed by pointers.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// Use \"void\" here because gmf() is a subroutine (with no return variable).\nvoid gmf_ (double *dmjd, double *dlat, double *dlon,\n           double *dhgt, double *zd,\n           double *gmfh, double *gmfw);\n\nint main()\n{\n    double dmjd = 1.0, dlat = 2.0, dlon = 3.0,\n           dhgt = 4.0, zd   = 5.0;\n\n    double gmfh, gmfw;\n\n    // Call the Fortran routine. No need to write \"result = gmf_(...)\".\n    // Instead, the values of gmfh and gmfw will be modified directly by gmf().\n    gmf_ ( &amp;dmjd, &amp;dlat, &amp;dlon, &amp;dhgt, &amp;zd, &amp;gmfh, &amp;gmfw );\n\n    printf( \"gmfh = %15.8f\\n\", gmfh );\n    printf( \"gmfw = %15.8f\\n\", gmfw );\n\n    return 0;\n}\n</code></pre>\n\n<p>If you use a simpler version of <code>gmf()</code>, e.g.,</p>\n\n<pre><code>      subroutine gmf ( dmjd, dlat, dlon, dhgt, zd, gmfh, gmfw )\n\nC     input data  : dmjd, dlat, dlon, dhgt, zenith\nC     output data : gmfh, gmfw\n\nc     implicit double precision (a-h,o-z)    !! this is not recommended...\n      implicit none\n      double precision :: dmjd, dlat, dlon, dhgt, zd, gmfh, gmfw\n\n      gmfh = dmjd + dlat + dlon + dhgt\n      gmfw = zd * 10.0d0\n      end\n</code></pre>\n\n<p>(here <code>gmf.f</code> is assumed to be fixed-format), we get</p>\n\n<pre><code>gmfh =     10.00000000\ngmfw =     50.00000000\n</code></pre>\n\n<p>Some side notes:</p>\n\n<ul>\n<li><p>AFAIK there is no automatic mechanism for checking the correctness of argument type matching between C and Fortran. So please check the declaration of types in the prototype very carefully so that they precisely match those in Fortran routines. Not only the types of variables (e.g., <code>integer</code>, <code>real</code>, ...) but also their kinds (e.g., <code>real(xxx)</code> or <code>double precision</code> etc) are also critically important.</p></li>\n<li><p>If possible, please try using <code>implicit none</code> in Fortran routines because it makes much easier to detect any typos or type mismatch.</p></li>\n<li><p>Once the code runs, please also consider using <code>iso_c_binding</code> (particularly <code>bind(C)</code>) to make the interface more portable.</p></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 6006752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01002c16ad769b24dbf525c2b3628f7a?s=128&d=identicon&r=PG&f=1", "display_name": "noble334", "link": "https://stackoverflow.com/users/6006752/noble334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462961443, "creation_date": 1462956302, "last_edit_date": 1462957286, "question_id": 37157372, "link": "https://stackoverflow.com/questions/37157372/calling-fortran-subroutines-from-c-code", "title": "Calling Fortran Subroutines from C code", "body": "<p>I got one fortran code (gmf.f) working great and I want to call it from c (tropo.c) so I can use the outputs of fortran subroutine in my c code as new variables.</p>\n\n<pre><code>subroutine gmf (dmjd,dlat,dlon,dhgt,zd,gmfh,gmfw)\n\nC     This subroutine determines the Global Mapping Functions GMF\n\nC     input data\nC     ----------\nC     dmjd: modified julian date   (real)\nC     dlat: ellipsoidal latitude in radians  (real)\nC     dlon: longitude in radians      (real)\nC     dhgt: height in m                  (real)\nC     zd:   zenith distance in radians        (real)\nC\nC     output data\nC     -----------\nC     gmfh: hydrostatic mapping function      (real)\nC     gmfw: wet mapping function              (real)\nC\nC     Johannes Boehm, 2005 August 30\nC     Rev. Boehm 21 July 2011: latitude -&gt; ellipsoidal latitude\nC\n\n      implicit double precision (a-h,o-z)\n</code></pre>\n\n<p>...\n...\n...\n...\nAfter some maths and computation as a result, I'm getting the outputs gmfh and gmfw.</p>\n\n<p>Since I'm not good at C I wrote one sample after some research on the WEB. What I'm struggling I don't know how to call the results from fortran into the c and see them on the screen... I'd be really appreciate if anyone help me to find the solution...</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n  int main(int argc, char **argv) {\n\n\n\n\n double gmf_(double *dmjd, double *dlat, double *dlon, double *dhgt, double *zd, double *gmfh, double *gmfw);\n\n double dmjd=53120;\n  double dlat=38.25;\n  double dlon=42.25;\n  double dhgt=700.25;\n  double zd=60.0;\n\n\n ??? double result???? = gmf_(&amp;dmjd, &amp;dlat, &amp;dlon, &amp;dhgt, &amp;zd, &amp;gmfh, &amp;gmfw);\n\n  return;\n  }\n</code></pre>\n\n<p>finally \u0131 will execute in cygwin</p>\n\n<p>gfortran -c gmf.f</p>\n\n<p>gcc -c tropo.c</p>\n\n<p>gfortran -o solve gmf.o tropo.o</p>\n\n<p>./solve</p>\n\n<p>and will see the results on the screen: gmfh and gmfw.</p>\n"}, {"tags": ["c", "avr-gcc"], "comments": [{"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1463487808, "post_id": 37157311, "comment_id": 62077498, "body": "Pointers in C are to concrete type, i.e. d++ skip 1 byte, v argument is 4byte long. Compiler cannot understand what You want. Below is good answer with cast"}], "answers": [{"tags": [], "owner": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "is_accepted": true, "score": 3, "last_activity_date": 1462956393, "creation_date": 1462956393, "answer_id": 37157410, "question_id": 37157311, "link": "https://stackoverflow.com/questions/37157311/avr-gcc-warning-initialization-from-incompatible-pointer-type/37157410#37157410", "title": "avr-gcc warning: initialization from incompatible pointer type", "body": "<p>Add a cast:</p>\n\n<pre><code>const UInt8* d = (const UInt8*)&amp;v;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "is_accepted": false, "score": -1, "last_activity_date": 1462960554, "last_edit_date": 1495541763, "creation_date": 1462960554, "answer_id": 37159067, "question_id": 37157311, "link": "https://stackoverflow.com/questions/37157311/avr-gcc-warning-initialization-from-incompatible-pointer-type/37159067#37159067", "title": "avr-gcc warning: initialization from incompatible pointer type", "body": "<p>As an addition to the other answer:</p>\n\n<p>It would be <a href=\"https://stackoverflow.com/a/7715486/1790864\">better practice</a> to supply the <code>ptr</code> argument as constant pointer in the first place.</p>\n\n<pre><code>static void ujThreadPrvPut32(UInt8* const ptr, UInt32 v);\n</code></pre>\n\n<p>Since <code>ptr</code> provides the target address where the data should go, this should not be changed by the function, only the CONTENTS at that location.</p>\n\n<p>On the other hand, you could just use memcpy().</p>\n\n<pre><code>uint8_t* ptr = 0;   // has to be set to desired target address obviously\nuint32_t value = 123;\n\nmemcpy(ptr, &amp;value, sizeof(value));\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4346741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 37157410, "answer_count": 2, "score": 0, "last_activity_date": 1462960554, "creation_date": 1462956140, "last_edit_date": 1462957870, "question_id": 37157311, "link": "https://stackoverflow.com/questions/37157311/avr-gcc-warning-initialization-from-incompatible-pointer-type", "title": "avr-gcc warning: initialization from incompatible pointer type", "body": "<p>I'm unsure how to fix the warning for this piece of code (warning pertains to the second line).\nThis is not my code but it does work perfectly. However, I'd like to get rid of the warning but am confused.\nv is an unsigned long that we want to put to pointer. We are working with avr-gcc.</p>\n\n<blockquote>\n  <p>../../uJ/uj.c:1149:20: warning: initialization from incompatible pointer type\n     const UInt8* d = &v;</p>\n</blockquote>\n\n<pre><code>static void ujThreadPrvPut32(UInt8* ptr, UInt32 v){         //to pointer\n    const UInt8* d = &amp;v;\n\n    *ptr++ = *d++;\n    *ptr++ = *d++;\n    *ptr++ = *d++;\n    *ptr = *d;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc", "shared-memory", "coredump", "backslash"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1462955530, "post_id": 37157040, "comment_id": 61850584, "body": "<code>read()</code> doesn&#39;t zero terminate <code>userInput</code>. So, you can&#39;t use <code>strcat()</code> with <code>userInput</code>."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1462955767, "post_id": 37157040, "comment_id": 61850735, "body": "You should use calloc() instead of malloc() so your memory is all zero bytes to start with. No need to tack on NUL bytes, as long as you read up to one less than the allocated size. And read your C book to find out what a <i>string</i> is and which functions take/return strings, and which take/return arbitrary arrays of characters."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462956457, "post_id": 37157040, "comment_id": 61851159, "body": "change <code>char* userInput = malloc(5);</code> to <code>char* userInput = calloc(5, sizeof(char));</code> Your <code>UserInput</code> &quot;C-String&quot; is not null terminated using malloc and reading 3 bytes only."}], "answers": [{"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1462955574, "post_id": 37157107, "comment_id": 61850612, "body": "<code>userInput</code> isn&#39;t zero terminated either."}, {"owner": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "edited": false, "score": 0, "creation_date": 1462955756, "post_id": 37157107, "comment_id": 61850728, "body": "I have compiled and checked everything.. I just don&#39;t know how to simply write &quot;b34&#39; to the shared memory so that i will be able to read it later .. that is all my problem"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "edited": false, "score": 0, "creation_date": 1462955837, "post_id": 37157107, "comment_id": 61850775, "body": "@ZoharArgov: It is impossible that you have compiled <code>strcat(userInput, &#39;\\0&#39;);</code> and &quot;checked everything.&quot;  It&#39;s <b>invalid code which cannot be used</b>.  Your compiler should not even compile it."}, {"owner": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "edited": false, "score": 0, "creation_date": 1462956091, "post_id": 37157107, "comment_id": 61850948, "body": "it did give me a warning, but has compiled.. anyways, I deleted that line and edited the post. and still, i have trouble with the next line writing to the shared memory."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "edited": false, "score": 1, "creation_date": 1462956326, "post_id": 37157107, "comment_id": 61851086, "body": "@ZoharArgov: When your compiler gives you a warning, you need to stop and fix it before running the program.  Otherwise you waste a lot of time, both yours and ours."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "edited": false, "score": 1, "creation_date": 1462956543, "post_id": 37157107, "comment_id": 61851223, "body": "@ZoharArgov: I have added lots more to my answer.  Hope this helps."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 6, "last_activity_date": 1462956530, "last_edit_date": 1462956530, "creation_date": 1462955517, "answer_id": 37157107, "question_id": 37157040, "link": "https://stackoverflow.com/questions/37157040/writing-to-shared-memory-core-dump-segmentation-fault/37157107#37157107", "title": "writing to shared memory core dump segmentation fault", "body": "<p>This:</p>\n\n<pre><code>strcat(userInput, '\\0');   //THROWS EXCEPTION!!\n</code></pre>\n\n<p>Is not valid C, and it doesn't \"throw an exception\" because C doesn't have exceptions.  Maybe it crashes, but anyway that should be expected since you're not even writing valid code.  Use a compiler that rejects obvious invalid code like this.</p>\n\n<hr>\n\n<p>Edit: and this:</p>\n\n<pre><code>char* userInput = malloc(5);\nread(0, userInput, 3);\nstrcpy(shmaddr,userInput);\n</code></pre>\n\n<p>Is invalid because you read three characters, leaving the last two characters in <code>userInput</code> uninitialized, then you call <code>strcpy()</code> which reads a null terminated string from <code>userInput</code>, but you have not null-terminated the string, so it is undefined behavior and anything could happen--including a crash.  So try this:</p>\n\n<pre><code>const size_t INPUT_MAX_SIZE = 3;\nchar userInput[INPUT_MAX_SIZE + 1];\nread(STDIN_FILENO, userInput, INPUT_MAX_SIZE);\nuserInput[INPUT_MAX_SIZE] = '\\0'; // add null terminator\nstrcpy(shmaddr,userInput);\n</code></pre>\n\n<p>Or better yet:</p>\n\n<pre><code>read(STDIN_FILENO, shmaddr, INPUT_MAX_SIZE);\n</code></pre>\n\n<p>That is, just read directly to the destination, not a temporary buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 1, "last_activity_date": 1462956601, "creation_date": 1462956601, "answer_id": 37157501, "question_id": 37157040, "link": "https://stackoverflow.com/questions/37157040/writing-to-shared-memory-core-dump-segmentation-fault/37157501#37157501", "title": "writing to shared memory core dump segmentation fault", "body": "<p>Both the function <code>strcat</code> and <code>strcpy</code> expect the arguments to be null-terminated strings, in you case, neither <code>userInput</code> or <code>shmaddr</code> satisfies this condition, that's why you see the program crashes. Try this:</p>\n\n<pre><code>#define FLAGS IPC_CREAT | 0644\nint main(void) {\n    key = ftok(\"ex31.c\", 'k');\n    shmid = shmget(key, 4, FLAGS);  // the buffer needs at least size 4 to hold the 3 char string and the null terminator\n    shmaddr = shmat(shmid, 0, 0);\n\n    char* userInput = malloc(5);\n    read(0, userInput, 3);\n    userInput[3] = '\\0';\n    strcpy(shmaddr, userInput);\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5585119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/55328b73f431c485a479b1e6d382238b?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar Argov", "link": "https://stackoverflow.com/users/5585119/zohar-argov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 37157107, "answer_count": 2, "score": -2, "last_activity_date": 1462956708, "creation_date": 1462955364, "last_edit_date": 1462956708, "question_id": 37157040, "link": "https://stackoverflow.com/questions/37157040/writing-to-shared-memory-core-dump-segmentation-fault", "title": "writing to shared memory core dump segmentation fault", "body": "<p>I need to write to shared memory, thus I have </p>\n\n<pre><code>#define FLAGS IPC_CREAT | 0644\nint main() {\nkey = ftok(\"ex31.c\", 'k');\nshmid = shmget(key, 3, FLAGS);\nshmaddr = shmat(shmid,0,0);    // THOSE LINES WORK AS EXPECTED\n\nchar* userInput = malloc(5);\nread(0, userInput, 3);  // I want to read \"b34\" for example, WORKS GOOD\nstrcpy(shmaddr,userInput);   // THROWS EXCEPTION!\n}\n</code></pre>\n\n<p>it throws me exception in <code>strcat</code>, and if I delete it the exception is thrown in the next line of <code>strcpy</code>.\nI need to write to the memory \"<code>b34\\0</code>\" (4 chars) and then read it.</p>\n"}, {"tags": ["c", "assembly", "x86", "call", "inline-assembly"], "comments": [{"owner": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 1, "creation_date": 1462956919, "post_id": 37156743, "comment_id": 61851496, "body": "The <i>proper</i> way to do this is actually calling the function. If you need to change the return address, the proper way to do it is through a jump right after the call. If you&#39;re worried about efficiency, I bet the difference is not as great as you think. If, after all this, there&#39;s still some reason to really, <i>really</i> want to do this (&quot;just to learn&quot; could be one), I&#39;d use ASM to make a copy of the stack to a static array and try to make sense of what it looks like, so I&#39;d know what to push there to simulate a call. Expect the unexpected (e.g. an space for return value)."}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 0, "creation_date": 1462958026, "post_id": 37156743, "comment_id": 61852281, "body": "@Jojonete Thank you. What I&#39;m trying to do is &quot;store&quot; a(n arbitrary) function call in a struct in order to later (potentially MUCH later) use that struct to actually make the &quot;call&quot; on a different stack. Using &quot;call + jump after&quot; should do the trick IF I can figure out what I need to store and later pass as argument to the inline assembly <code>call</code> instruction. Any suggestions?"}, {"owner": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 0, "creation_date": 1462962097, "post_id": 37156743, "comment_id": 61855138, "body": "1. I&#39;m supposing the &quot;other stack&quot; is in the same process, even if MUCH later (otherwise pointers are useless, even pointers to code). 2. Are you <i>sure</i> you want the return address to be the same as the first call? That would be quite dangerous as that address expects the stack below to be consistent, which is not necessarily so in the new stack. In other words, can you elaborate a bit more on the context for this? What is the use of repeating a function call in a different stack?"}, {"owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "reply_to_user": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 0, "creation_date": 1462963975, "post_id": 37156743, "comment_id": 61856426, "body": "@Jojonete 1.)Yes, same process just different execution context. 2.) I&#39;m sure I don&#39;t. We want communicating subroutines that can yield control to each other. Each subroutine is executing on its own &quot;stack&quot; and our scheduler keeps track of what we need to switch in-between them. To START a subroutine, though, we switch stack to the new subroutine, then call it and jump (when the call returns) to some exit code that will select and resume next subroutine. Or at least that&#39;s the idea. Problem is, we don&#39;t yet know what we need to keep track of in order to actually be able to call the subroutine."}, {"owner": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 1, "creation_date": 1462966179, "post_id": 37156743, "comment_id": 61857897, "body": "Okay, I see the problem now and I&#39;m afraid I have no ideas beyond my first suggestion: write a small piece of ASM that copies (say, the top 16 KB of) the stack into a static (global) array, then write a trivial program declaring three such global arrays (call them <code>before</code>, <code>during</code> and <code>after</code>), then one function <code>f()</code> with the asm snippet using array <code>during</code>, then function <code>main()</code> with (1) the asm snippet for <code>before</code> (2) a call to <code>f()</code> (3) the asm snippet for <code>after</code> (4) code to compare/dump all three arrays in a suitable format. That should give an idea of what is needed."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1504237230, "post_id": 37156743, "comment_id": 78945773, "body": "Yes, you can just use a <code>jmp</code> after pushing a return address.  <code>ebp</code> has nothing to do with anything, though.  The code at the return address is going to have to restore your caller&#39;s registers, if you&#39;ve modified any.  But beware that having a <code>jmp</code> to another function in inline asm has non-obvious dangers.  Jumping out of an <code>asm</code> statement (and not coming back) probably needs <code>asm goto (&quot;jmp ...&quot;)</code>."}], "owner": {"reputation": 6181, "user_id": 3322533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/cbbd1b40887d19bc0c8fdd5ef42a05ed?s=128&d=identicon&r=PG", "display_name": "User1291", "link": "https://stackoverflow.com/users/3322533/user1291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "closed_date": 1504236989, "answer_count": 0, "score": 1, "last_activity_date": 1462954448, "creation_date": 1462954448, "question_id": 37156743, "link": "https://stackoverflow.com/questions/37156743/c-inline-assembly-manual-function-call", "closed_reason": "Duplicate", "title": "C, Inline Assembly - manual function call", "body": "<p>I want to jump to a function and pretend I had just called it.\nSo I push the arguments to the stack, I load the address of the label I want to jump to when I return from the function I \"call\" and push it to the stack, I set ebp to esp ... now what?</p>\n\n<p>Can I just </p>\n\n<pre><code>__asm__(\n    \"jmp %0;\"\n    :\n    :\"rm\"(&amp;my_func)\n    );\n</code></pre>\n\n<p>or what would be the proper way to do this?</p>\n"}, {"tags": ["c", "compiler-errors", "macros", "c-preprocessor", "compiler-warnings"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1462954585, "post_id": 37156658, "comment_id": 61849996, "body": "You will have to show the definitions of all macros. Please create a minimal example."}, {"owner": {"reputation": 792, "user_id": 5467686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/963001537100522/picture?type=large", "display_name": "PascalS", "link": "https://stackoverflow.com/users/5467686/pascals"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462955905, "post_id": 37156658, "comment_id": 61850834, "body": "okay, I added all uses macro definitions"}, {"owner": {"reputation": 792, "user_id": 5467686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/963001537100522/picture?type=large", "display_name": "PascalS", "link": "https://stackoverflow.com/users/5467686/pascals"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462955998, "post_id": 37156658, "comment_id": 61850894, "body": "Is it possiblem, that the error depends on the definition of GPIOA?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462956645, "post_id": 37156658, "comment_id": 61851293, "body": "Why is there leading <code>##</code> on <code>##CONTROL_STRUCT##_##REG##_##CLK##EN</code>? It should not be necessary."}], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 4789526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AARen.jpg?s=128&g=1", "display_name": "Ouss4", "link": "https://stackoverflow.com/users/4789526/ouss4"}, "is_accepted": false, "score": 0, "last_activity_date": 1462957012, "creation_date": 1462957012, "answer_id": 37157649, "question_id": 37156658, "link": "https://stackoverflow.com/questions/37156658/iar-compiler-warning-macro-does-not-create-a-valid-token/37157649#37157649", "title": "IAR Compiler warning: &quot;macro does not create a valid token&quot;", "body": "<p>In <code>##CONTROL_STRUCT##_##REG##_##CLK##EN</code> remove the first <code>##</code>.</p>\n\n<p>Note that what you are doing is error prone and not recommended by embedded coding standards.</p>\n\n<p>MISRA C:</p>\n\n<blockquote>\n  <p>Rule 19.12 (required): There shall be at most one occurrence of the # or ## operators in\n  a single macro definition.</p>\n  \n  <hr>\n  \n  <p>Rule 19.13 (advisory): The # and ## operators should not be used.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "is_accepted": true, "score": 1, "last_activity_date": 1463004680, "last_edit_date": 1463004680, "creation_date": 1462999597, "answer_id": 37172984, "question_id": 37156658, "link": "https://stackoverflow.com/questions/37156658/iar-compiler-warning-macro-does-not-create-a-valid-token/37172984#37172984", "title": "IAR Compiler warning: &quot;macro does not create a valid token&quot;", "body": "<p>\"The order of evaluation of # and ## operators is unspecified.\u201d  (ISO C99/C11 6.10.3.2, 6.10.3.3) meaning a macro may fail programmer intent with one compiler but not another. </p>\n\n<p>In your case this is not a big deal, as Ouss4 mentions, MISRA-C recommends against multiple # or ## operators, mostly to avoid obfuscation (thus its only an advisory guideline).</p>\n\n<p>However its possible multiple ## operators <em>could</em> result in undefined behavior if a ## operation results in an invalid token and this is what IAR is warning about. This and a simple example is discussed at the MISRA-C forum <a href=\"http://www.misra.org.uk/forum/viewtopic.php?f=72&amp;t=478\" rel=\"nofollow\">\"Rule 19.12 (# and ## operator) real issue?\u201d</a> :</p>\n\n<blockquote>\n  <p><code>define m(a,b) a##.##b</code></p>\n  \n  <p><code>m(1,e30)</code></p>\n  \n  <p>which is defined behavior on a left-to-right evaluation but undefined\n  behavior on right-to-left because .e30 is two preprocessing tokens.</p>\n</blockquote>\n"}], "owner": {"reputation": 792, "user_id": 5467686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/963001537100522/picture?type=large", "display_name": "PascalS", "link": "https://stackoverflow.com/users/5467686/pascals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2475, "favorite_count": 0, "accepted_answer_id": 37172984, "answer_count": 2, "score": 0, "last_activity_date": 1463004680, "creation_date": 1462954215, "last_edit_date": 1462958053, "question_id": 37156658, "link": "https://stackoverflow.com/questions/37156658/iar-compiler-warning-macro-does-not-create-a-valid-token", "title": "IAR Compiler warning: &quot;macro does not create a valid token&quot;", "body": "<p><strong>I have written the following macro in C:</strong></p>\n\n<pre><code>#define __HAL_CLK_ENABLE(CONTROL_STRUCT,REG,CLK) do { \\\nSET_BIT(CONTROL_STRUCT-&gt;REG,##CONTROL_STRUCT##_##REG##_##CLK##EN);\\\n} while(0)\n</code></pre>\n\n<p><strong>Macro call in main.c / All Parameters are defined in cpu specific header files:</strong></p>\n\n<pre><code>__HAL_CLK_ENABLE(RCC,AHB1ENR,GPIOA);\n</code></pre>\n\n<p><strong>The result should be:</strong> </p>\n\n<pre><code>SET_BIT(RCC-&gt;AHB1ENR,RCC_AHB1ENR_GPIOAEN)\n</code></pre>\n\n<p>This macro works and enables my GPIOA port correctly but I get two Compiler warnings. (IAR EW 7.6)</p>\n\n<ol>\n<li>macro Parameter \"CONTROL_STRUCT\" is used in both expanded and raw forms.\n(I will ignore this warning, because in this case it's right to use both forms!)</li>\n</ol>\n\n<p><strong><em>2. concatenation with \"RCC_AHB1ENR_GPIOAEN\" in macro \"__HAL_CLK_ENABLE\" does not create a valid token.\n(What does it mean? Because the token works correctly and my clock is enabled after calling this macro)</em></strong></p>\n\n<p>Thanks</p>\n\n<p><strong>EDIT1:</strong></p>\n\n<p>Macro definitions:</p>\n\n<pre><code>#define SET_BIT(REG, BIT)     ((REG) |= (BIT))\n\n#define RCC                 ((RCC_TypeDef *) RCC_BASE)\n\ntypedef struct\n{\n...                        \n__IO uint32_t AHB1ENR;\n...\n} RCC_TypeDef;\n\n#define GPIOA               ((GPIO_TypeDef *) GPIOA_BASE)\n</code></pre>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1462953833, "post_id": 37156475, "comment_id": 61849524, "body": "You should not use <code>void *</code> as a generic value type.  Also your <code>memcpy</code> would work: your <code>const</code> applies to the pointed-to memory, not to the elements of <code>para</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1462954151, "post_id": 37156475, "comment_id": 61849717, "body": "There is no way to have a binary representation of a floating point <i>literal</i>. Literals don&#39;t have representation, only objects (variables) do."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1462955139, "post_id": 37156475, "comment_id": 61850346, "body": "would a (array of) <a href=\"http://en.cppreference.com/w/c/language/union\" rel=\"nofollow noreferrer\"><code>union</code></a> suit your needs ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1462967506, "post_id": 37156475, "comment_id": 61858902, "body": "Try a compound literal (c11): Instead of <code>(void *)12.34f</code>, use a union of a <code>float</code> and <code>void*</code>.  Something like <code>((union { float f; void *p}){12.34f}).p</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462954901, "post_id": 37156744, "comment_id": 61850202, "body": "This is the way to go. I would strongly suggest separating the structure definition and variable definition though."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1462956528, "post_id": 37156744, "comment_id": 61851210, "body": "This won&#39;t work if the combination of types varies between calls."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 3, "creation_date": 1462956853, "post_id": 37156744, "comment_id": 61851432, "body": "@KlasLindb&#228;ck Sure thing. Use different structs. That&#39;s what types are <i>for</i>. You can cast their addresses to <code>void</code> if needed."}, {"owner": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "edited": false, "score": 0, "creation_date": 1462958878, "post_id": 37156744, "comment_id": 61852849, "body": "I think you missed the point.  It needed to be general purpose store of parameters, so any value could store any type."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1462959639, "post_id": 37156744, "comment_id": 61853351, "body": "&quot;It needed to be general purpose store of parameters&quot;. XY problem? Why do you need a general purpose store of parameters? If you want a general purpose <i>pointer</i> to a store of parameters, you can have one, it&#39;s called <code>void*</code>. You can pass <code>(void*)&amp;para</code> around and cast it to <code>s_para*</code> as needed."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1462954450, "creation_date": 1462954450, "answer_id": 37156744, "question_id": 37156475, "link": "https://stackoverflow.com/questions/37156475/c-how-to-initialise-a-32-bit-integer-value-with-a-32-bit-float-value/37156744#37156744", "title": "&#39;C&#39; - How to initialise a 32 bit integer value with a 32 bit float value?", "body": "<p>Use a structure and not an array.</p>\n\n<pre><code>struct s_para { const char* a; int b; float c; } const para \n    = { \"1234\", 1234, 12.34f };\n</code></pre>\n\n<p>No need to cast anything.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "edited": false, "score": 0, "creation_date": 1462960825, "post_id": 37158686, "comment_id": 61854198, "body": "what compiler did you test this with ? Cutting and pasting into VS2010 it does not compile.  Are there typo&#39;s ? ie &#39;=  =&#39; and &#39;data_ storage&#39;"}, {"owner": {"reputation": 56, "user_id": 6086500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22cfbffb210bb36893e7ef7894fb73c7?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/6086500/christian-t"}, "reply_to_user": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "edited": false, "score": 0, "creation_date": 1462961648, "post_id": 37158686, "comment_id": 61854821, "body": "You are right. there are typos - narf. I used gcc (Ubuntu 4.8.4-2ubuntu1~14.04.1) 4.8.4. Correcting the typos now!"}, {"owner": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "edited": false, "score": 0, "creation_date": 1462963191, "post_id": 37158686, "comment_id": 61855891, "body": "It seems VS2010 does not support named initialisers, ie its not C99 compliant like your gcc.  It should work on my Keil ARM though."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1462964730, "post_id": 37158686, "comment_id": 61856958, "body": "<i>pointers have the same length on the same system</i>.  No. Per the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C Standard</a>: &quot;A pointer to <code>void</code> shall have the same representation and alignment requirements as a pointer to a character type. Similarly, pointers to qualified or unqualified versions of compatible types shall have the same representation and alignment requirements. ...   All pointers to union types shall have the same representation and alignment requirements as each other. <b>Pointers to other types need not have the same representation or alignment requirements</b>.&quot;"}, {"owner": {"reputation": 56, "user_id": 6086500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22cfbffb210bb36893e7ef7894fb73c7?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/6086500/christian-t"}, "edited": false, "score": 0, "creation_date": 1462978156, "post_id": 37158686, "comment_id": 61867669, "body": "Thanks. I updated the text to a more vague reply concerning pointer length. Though it did practically not happen to me... Not that I really checked ;) But this would not change anything regarding the union solution, which would be even more safe across systems in comparision to the other way."}], "tags": [], "owner": {"reputation": 56, "user_id": 6086500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22cfbffb210bb36893e7ef7894fb73c7?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/6086500/christian-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1462978078, "last_edit_date": 1462978078, "creation_date": 1462959605, "answer_id": 37158686, "question_id": 37156475, "link": "https://stackoverflow.com/questions/37156475/c-how-to-initialise-a-32-bit-integer-value-with-a-32-bit-float-value/37158686#37158686", "title": "&#39;C&#39; - How to initialise a 32 bit integer value with a 32 bit float value?", "body": "<p>Your generic data array contains void pointer. A pointer to a non defined data type. On many systems pointers to most datatypes do not vary in size so it does not matter what it points to. This would only become relevant when doing pointer arithmetic or accessing the content. You may know this. As you told, your code later on \"knows\" in what context to use which pointer. So far so good. Let's assume we have a 32bit systems as it matches your data types.</p>\n\n<p>Now to your types:</p>\n\n<ul>\n<li>The string \"1234\" ist stored in the text section during compile time. And your compiler fills your data array with the pointer to that memory section.</li>\n<li>With the integer you explicitly cast 1234 to a void pointer, telling the compiler: \"Hey, this is a pointer, not an integer\". This works as long as your integer and your pointer have the same length or the pointer is bigger. So on our 32bit it's ok. So you store the value directly in the field where you would normally store a pointer to something.</li>\n<li>With the float the mechanism from above does not work. A float can never be interpreted as a memory address so the compiler fails.</li>\n</ul>\n\n<p>Two options:\nFirst, store int and float in text/constant section and just put the pointer in my array. But we have to store these values beforehand... (or maybe there's a fancy trick). This will work for any type!:</p>\n\n<pre><code>static int v1 = 1234;\nstatic float v2 = 12.34f;\n\nconst void *para[] = {  // General Purpose store for parameters\n    \"1234\",             // Store string pointer\n    &amp;v1,                // Store integer value\n    &amp;v2,                // Store float value\n};\n</code></pre>\n\n<p>Second and the way i would prefere here is using a union.</p>\n\n<pre><code>union data_storage {\n     const int t_int;\n     const float t_float;\n     const char *t_string;\n};\n\nconst union data_storage params[] = {  // General Purpose store for parameters\n    {.t_string = \"1234\"},           // Store string pointer\n    {.t_int = 1234},                // Store integer value\n    {.t_float = 12.34f},            // Store float value\n};\n</code></pre>\n\n<p>I tested it with</p>\n\n<pre><code>fprintf(stdout, \"%s\\n%i\\n%f\\n\", params[0].t_string, params[1].t_int, params[2].t_float);\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462978078, "creation_date": 1462953656, "question_id": 37156475, "link": "https://stackoverflow.com/questions/37156475/c-how-to-initialise-a-32-bit-integer-value-with-a-32-bit-float-value", "title": "&#39;C&#39; - How to initialise a 32 bit integer value with a 32 bit float value?", "body": "<p>I am trying to find a general purpose way to initialise an array or structure with parameter values.  When the parameters are consumed from the array or structure the context will be known by my function and so it will know how to use the values correctly.</p>\n\n<p>To initialise the array/structure I was wanting to do something like this:</p>\n\n<pre><code>const void *para[] = {  // General Purpose store for parameters\n    \"1234\",             // Store string pointer\n    (void *)1234,       // Store integer value\n    (void *)12.34f,     // Store float value\n};\n</code></pre>\n\n<p>The string and integer parameter types are ok.  The float does not work because the compiler has no method to cast a float to a void pointer.  </p>\n\n<p>What I need is a way to cast a float value to its binary representation so it can treated like a 32 bit unsigned integer.  Can this be done ?</p>\n\n<p>I could solve this problem with the brute force of memcpy() but this would require the 'const' to be removed.  The ultimate aim is that the code will be ported to a embedded ARM system with limited SRAM so the array/structure needs to located in ROM and so needs to be initialised by the compiler and not at run time.</p>\n"}, {"tags": ["c", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5336326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee522132c0a4412343375d88d9ddc1b?s=128&d=identicon&r=PG&f=1", "display_name": "semut", "link": "https://stackoverflow.com/users/5336326/semut"}, "edited": false, "score": 0, "creation_date": 1462971863, "post_id": 37156503, "comment_id": 61862489, "body": "Thank you very much, this is a pretty low-level mistake i make."}], "tags": [], "owner": {"reputation": 7560, "user_id": 1034749, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2022f0caae119ed6232cf370bb9d9d3a?s=128&d=identicon&r=PG", "display_name": "fghj", "link": "https://stackoverflow.com/users/1034749/fghj"}, "is_accepted": false, "score": 2, "last_activity_date": 1462958908, "last_edit_date": 1462958908, "creation_date": 1462953768, "answer_id": 37156503, "question_id": 37156435, "link": "https://stackoverflow.com/questions/37156435/leetcode24-swap-nodes-in-pairs-runtime-error-c-language/37156503#37156503", "title": "leetcode#24 Swap Nodes in Pairs runtime error (C language)", "body": "<pre><code>struct ListNode *dummy, *pi, *pj, *end;\ndummy-&gt;next = head;\n</code></pre>\n\n<p>you do not initialize <code>dummy</code> ptr, but you use it.</p>\n"}], "owner": {"reputation": 1, "user_id": 5336326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee522132c0a4412343375d88d9ddc1b?s=128&d=identicon&r=PG&f=1", "display_name": "semut", "link": "https://stackoverflow.com/users/5336326/semut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462958908, "creation_date": 1462953530, "last_edit_date": 1462956312, "question_id": 37156435, "link": "https://stackoverflow.com/questions/37156435/leetcode24-swap-nodes-in-pairs-runtime-error-c-language", "title": "leetcode#24 Swap Nodes in Pairs runtime error (C language)", "body": "<p>I try to answer the problem on <a href=\"https://leetcode.com/problems/swap-nodes-in-pairs/\" rel=\"nofollow\">this link</a>.<br>\nHowever, I find my answer works pretty good on a small number of inputs, but the leetcode website gives a runtime error on the input   </p>\n\n<blockquote>\n  <p>[4,77,57,79,24,47,21,42,38,54,26,28,30,85,32,40,62,28,89,37,24,3,51,72,59,49,7,60,44,7,27,48,37,37,27,13,36,49,55,26,55,33,55,85,19,39,25,33,68,14,70,44,70,73,68,29,22,27,89,66,35,69,67,24,58,94,37,46]</p>\n</blockquote>\n\n<p>Here is my code, could anybody tell me what happened?</p>\n\n<pre><code>    /**\n     * Definition for singly-linked list.\n     * struct ListNode {\n     *     int val;\n     *     struct ListNode *next;\n     * };\n     */\n    struct ListNode* swapPairs(struct ListNode* head)\n    {\n        struct ListNode *dummy, *pi, *pj, *end;\n        dummy-&gt;next = head;\n        end = dummy;\n        while(true){\n            pi = end-&gt;next;    \n            if(pi == NULL){\n                break;\n            }else{ \n                pj = pi-&gt;next;\n            }\n            if(pj == NULL){\n                break;\n            }\n            end-&gt;next = pi-&gt;next;\n            pi-&gt;next = pj-&gt;next;\n            pj-&gt;next = pi;\n            end = pi;\n        }\n        return dummy-&gt;next;\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1462953500, "post_id": 37156331, "comment_id": 61849321, "body": "Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and also provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1462953874, "post_id": 37156331, "comment_id": 61849550, "body": "What do you mean &quot;it&#39;s not right&quot;? Mention what is the current output, and what is it that you are expecting."}, {"owner": {"reputation": 13, "user_id": 5654497, "user_type": "registered", "profile_image": "https://graph.facebook.com/1063073130399358/picture?type=large", "display_name": "Artur Queiros", "link": "https://stackoverflow.com/users/5654497/artur-queiros"}, "edited": false, "score": 0, "creation_date": 1462954758, "post_id": 37156331, "comment_id": 61850121, "body": "@2501 i changed my code but it still do the same thing"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462955189, "post_id": 37156331, "comment_id": 61850379, "body": "You haven&#39;t explained what it &#39;does&#39; in the first place. Please address the first two comments and edit the question, so it will contain an actual question."}], "answers": [{"tags": [], "owner": {"reputation": 30275, "user_id": 4272464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fa45261dec56004145c653832504920?s=128&d=identicon&r=PG&f=1", "display_name": "bgoldst", "link": "https://stackoverflow.com/users/4272464/bgoldst"}, "is_accepted": false, "score": 0, "last_activity_date": 1462956434, "last_edit_date": 1462956434, "creation_date": 1462955787, "answer_id": 37157211, "question_id": 37156331, "link": "https://stackoverflow.com/questions/37156331/adding-two-arrays-and-check-if-there-is-overflow/37157211#37157211", "title": "Adding two arrays and check if there is overflow", "body": "<p>It's always good to write test code that facilitates rapid testing:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_DIGITS 80\n\ntypedef unsigned char byte;\ntypedef byte BigInt [MAX_DIGITS];\n\nbool addBigInt(const BigInt n1, const BigInt n2, BigInt res );\nvoid printBigInt(const BigInt n);\n\nint main(int argc, char *argv[] ) {\n\n    if (argc != 3) { fprintf(stderr, \"error: require 2 arguments.\\n\"); exit(1); }\n    int n1Len = strlen(argv[1]);\n    if (n1Len == 0) { fprintf(stderr, \"error: n1 is empty.\\n\" ); exit(1); }\n    if (n1Len &gt; MAX_DIGITS) { fprintf(stderr, \"error: n1 length %d is greater than max %d.\\n\", n1Len, MAX_DIGITS ); exit(1); }\n    int n2Len = strlen(argv[2]);\n    if (n2Len == 0) { fprintf(stderr, \"error: n2 is empty.\\n\" ); exit(1); }\n    if (n2Len &gt; MAX_DIGITS) { fprintf(stderr, \"error: n2 length %d is greater than max %d.\\n\", n2Len, MAX_DIGITS ); exit(1); }\n\n    BigInt n1;\n    BigInt n2;\n    for (int i = 0; i &lt; MAX_DIGITS; ++i) {\n        n1[i] = 0;\n        n2[i] = 0;\n    } // end for\n    for (int i = 0; i &lt; n1Len; ++i) {\n        char c = argv[1][i];\n        if (c &lt; '0' || c &gt; '9') { fprintf(stderr ,\"error: n1 has invalid char '%c'.\\n\", c ); exit(1); }\n        n1[n1Len-1-i] = c-'0';\n    } // end for\n    for (int i = 0; i &lt; n2Len; ++i) {\n        char c = argv[2][i];\n        if (c &lt; '0' || c &gt; '9') { fprintf(stderr ,\"error: n2 has invalid char '%c'.\\n\", c ); exit(1); }\n        n2[n2Len-1-i] = c-'0';\n    } // end for\n\n    BigInt res;\n    bool overflow = addBigInt(n1,n2,res);\n\n    printBigInt(n1);\n    printf(\" + \");\n    printBigInt(n2);\n    printf(\" = \");\n    printBigInt(res);\n    if (overflow) printf(\" [overflow]\");\n    printf(\"\\n\");\n\n    return 0;\n\n} // end main()\n\nbool addBigInt(const BigInt n1, const BigInt n2, BigInt res ) {\n\n    for (int i = 0; i &lt; MAX_DIGITS; ++i) res[i] = 0;\n\n    int c = 0;\n    for (int i = 0; i &lt; MAX_DIGITS; ++i) {\n\n        res[i] = n1[i]+n2[i]+c;\n\n        if (res[i] &gt;= 10) {\n            res[i] = res[i]-10;\n            c = 1;\n        } else {\n            c = 0;\n        } // end if\n\n    } // end for\n\n    return c == 1;\n\n} // end addBigInt()\n\nvoid printBigInt(const BigInt n) {\n    int lastDigitIndex;\n    for (lastDigitIndex = MAX_DIGITS-1; lastDigitIndex &gt; 0 &amp;&amp; n[lastDigitIndex] == 0; --lastDigitIndex) ; // no-op\n    for (int i = lastDigitIndex; i &gt;= 0; --i) printf(\"%d\",n[i]);\n} // end printBigInt()\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>ls;\n## addBigInt.c\ngcc addBigInt.c -o addBigInt;\nls;\n## addBigInt.c  addBigInt.exe\n./addBigInt;\n## error: require 2 arguments.\n./addBigInt a b c;\n## error: require 2 arguments.\n./addBigInt a b;\n## error: n1 has invalid char 'a'.\n./addBigInt 0 b;\n## error: n2 has invalid char 'b'.\n./addBigInt 0 0;\n## 0 + 0 = 0\n./addBigInt 0 1;\n## 0 + 1 = 1\n./addBigInt 1 0;\n## 1 + 0 = 1\n./addBigInt 5 7;\n## 5 + 7 = 12\n./addBigInt 12 34;\n## 12 + 34 = 46\n./addBigInt 999 11;\n## 999 + 11 = 1010\n./addBigInt 999999999999999999999999999999999999999999999999999999999999999999999999999999999 0;\n## error: n1 length 81 is greater than max 80.\n./addBigInt 99999999999999999999999999999999999999999999999999999999999999999999999999999999 0;\n## 99999999999999999999999999999999999999999999999999999999999999999999999999999999 + 0 = 99999999999999999999999999999999999999999999999999999999999999999999999999999999\n./addBigInt 99999999999999999999999999999999999999999999999999999999999999999999999999999999 1;\n## 99999999999999999999999999999999999999999999999999999999999999999999999999999999 + 1 = 0 [overflow]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5654497, "user_type": "registered", "profile_image": "https://graph.facebook.com/1063073130399358/picture?type=large", "display_name": "Artur Queiros", "link": "https://stackoverflow.com/users/5654497/artur-queiros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1462956434, "creation_date": 1462953201, "last_edit_date": 1462953604, "question_id": 37156331, "link": "https://stackoverflow.com/questions/37156331/adding-two-arrays-and-check-if-there-is-overflow", "title": "Adding two arrays and check if there is overflow", "body": "<p>I'm trying to make some code that when we had 2 arrays it returns true if there is overflow, and false if not. I made some code but looks like it's not right:</p>\n\n<pre><code>/ **\n * Description :\n * The function takes three integer: the first two are the operands of the sum\n * And the sum is left in the third.\n * Parameters :\n * N1 - first operand of the sum\n * N2 - second operand sum\n * Res - a result of the transaction sum\n * Return:\n * The function returns true on success or false in the event of \" overlfow \"\n * /\n\n   #include &lt;stdio.h&gt;\n   #include &lt;stdbool.h&gt;\n   #include &lt;string.h&gt;\n\n   #define MaxDigits 80\n\n   typedef unsigned char byte;\n   typedef byte BigInt [MaxDigits];\n\n\n   bool  addBigInt( const BigInt n1, const BigInt n2, BigInt res ) {\n    int c=0;\n    for(int i = 0; i&lt;MaxDigits; i++){\n        res[i]=0;\n    }\n    for(int i = 0; i&lt;MaxDigits; i++){\n\n    res[i] = n1[i]+n2[i]+c;\n    if( res[i]&gt;=10){\n        res[i]=res[i]-10;   \n        c=1;\n    }\n    if (res[i]&lt;10){\n        c=0;\n        }\n    }\n    if (c==1){\n        return true;\n             }\n\n    else{\n        return false;\n             }\n\n    }\n</code></pre>\n"}, {"tags": ["c", "mqtt", "launchpad"], "comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1462953417, "post_id": 37156203, "comment_id": 61849265, "body": "This looks more like C++ to me than C. These are two different languages. Please be sure to chose the right tag."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1462957849, "post_id": 37156203, "comment_id": 61852153, "body": "Can you update your post with the two loop and their behaviour?"}, {"owner": {"reputation": 151, "user_id": 1436037, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/g27Yn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/1436037/marta"}, "edited": false, "score": 0, "creation_date": 1462969739, "post_id": 37156203, "comment_id": 61860655, "body": "I think I start over again."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1462979243, "post_id": 37156203, "comment_id": 61868425, "body": "@Marta, so you mean that this question here isn&#39;t relevant anymore? Then please delete it. Thanks."}], "owner": {"reputation": 151, "user_id": 1436037, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/g27Yn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/1436037/marta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462955971, "creation_date": 1462952718, "last_edit_date": 1462955971, "question_id": 37156203, "link": "https://stackoverflow.com/questions/37156203/why-does-it-stop-after-10-messages", "title": "Why does it stop after 10 messages", "body": "<p>I'm new to the TI LaunchPad cc3200 programming. Therefore I'm playing around with the MQTT \"HelloWiFi\" examples from the Energia IDE, I altered the example code a just little bit. But if I run the code my publishing stops after 10 messages. If I paste my shortened loop code (just one message instead of 3) in the example code the publishing goes on and on. Why? Any ideas?</p>\n\n<pre><code>#define MQTTCLIENT_QOS2 1\n\n#include &lt;SPI.h&gt;\n#include &lt;WiFi.h&gt;\n#include &lt;WifiIPStack.h&gt;\n#include &lt;Countdown.h&gt;\n#include &lt;MQTTClient.h&gt;\n\n\n// your network name also called SSID\nchar ssid[] = \"Tele*****\";\n// your network password\nchar password[] = \"8757******\";\n\nchar printbuf[100];\n\nint arrivedcount = 0;\n\nvoid messageArrived(MQTT::MessageData&amp; md)\n{\n    MQTT::Message &amp;message = md.message;\n\n   sprintf(printbuf, \"Message %d arrived: qos %d, retained %d, dup %d, packetid %d\\n\", \n        ++arrivedcount, message.qos, message.retained, message.dup, message.id);\n  Serial.print(printbuf);\n  sprintf(printbuf, \"Payload %s\\n\", (char*)message.payload);\n  Serial.print(printbuf);\n}\n\n\nWifiIPStack ipstack;\nMQTT::Client&lt;WifiIPStack, Countdown&gt; client = MQTT::Client&lt;WifiIPStack, Countdown&gt;(ipstack);\n\nconst char* topic = \"wireless-networks\";\n\nvoid connect()\n{\n  char hostname[] = \"iot.eclipse.org\";\n  int port = 1883;\n  sprintf(printbuf, \"Connecting to %s:%d\\n\", hostname, port);\n  Serial.print(printbuf);\n  int rc = ipstack.connect(hostname, port);\n  if (rc != 1)\n{\n  sprintf(printbuf, \"rc from TCP connect is %d\\n\", rc);\n  Serial.print(printbuf);\n}\n\nSerial.println(\"MQTT connecting\");\nMQTTPacket_connectData data = MQTTPacket_connectData_initializer;       \ndata.MQTTVersion = 3;\ndata.clientID.cstring = (char*)\"DrahtloseNetzwerk\";\nrc = client.connect(data);\nif (rc != 0)\n{\n  sprintf(printbuf, \"rc from MQTT connect is %d\\n\", rc);\n  Serial.print(printbuf);\n}\nSerial.println(\"MQTT connected\");\n\nrc = client.subscribe(topic, MQTT::QOS2, messageArrived);   \nif (rc != 0)\n{\n  sprintf(printbuf, \"rc from MQTT subscribe is %d\\n\", rc);\n  Serial.print(printbuf);\n}\nSerial.println(\"MQTT subscribed\");\n\n }\n\nvoid setup()\n{\n  Serial.begin(115200);\n  // attempt to connect to Wifi network:\n  Serial.print(\"Attempting to connect to Network named: \");\n  // print the network name (SSID);\n  Serial.println(ssid); \n\n  WiFi.begin(ssid, password);\n  while ( WiFi.status() != WL_CONNECTED) {\n  // print dots while we wait to connect\n  Serial.print(\".\");\n  delay(300);\n}\n\nSerial.println(\"\\nYou're connected to the network\");\nSerial.println(\"Waiting for an ip address\");\n\nwhile (WiFi.localIP() == INADDR_NONE) {\n  // print dots while we wait for an ip addresss\n  Serial.print(\".\");\n  delay(300);\n}\n\nSerial.println(\"\\nIP Address obtained\");\n// We are connected and have an IP address.\nSerial.println(WiFi.localIP());\n\nSerial.println(\"MQTT Hello example\");\nconnect();\n</code></pre>\n\n<p>}</p>\n\n<pre><code>void loop()\n{\n  if (!client.isConnected())\n    connect();\n\n  MQTT::Message message;\n\n  arrivedcount = 0;\n\n  // Send and receive QoS 0 message\n  char buf[100];\n  sprintf(buf, \"Hello it's me s0540636!!\");\n  message.qos = MQTT::QOS2;\n  message.retained = false;\n  message.dup = false;\n  message.payload = (void*)buf;\n  message.payloadlen = strlen(buf)+1;\n  int rc = client.publish(topic, message);\n\n  while (arrivedcount == 0)\n    client.yield(1000);\n  delay(1000);\n}\n</code></pre>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 936, "user_id": 54922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ccb116115e634aa8f15071d59155a3?s=128&d=identicon&r=PG", "display_name": "Radoslav Hristov", "link": "https://stackoverflow.com/users/54922/radoslav-hristov"}, "edited": false, "score": 6, "creation_date": 1462952442, "post_id": 37156062, "comment_id": 61848699, "body": "I don&#39;t see much C++ here, more like good old C."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1462952502, "post_id": 37156062, "comment_id": 61848738, "body": "<code>fflush(stdin);</code> - this is undefined behaviour"}, {"owner": {"reputation": 11225, "user_id": 241013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0825ba5ec12464a2b8176642830e6a7?s=128&d=identicon&r=PG", "display_name": "Sorin", "link": "https://stackoverflow.com/users/241013/sorin"}, "edited": false, "score": 1, "creation_date": 1462952536, "post_id": 37156062, "comment_id": 61848755, "body": "Please share the code for <code>change_student_name</code>. Otherwise we can only guess what is wrong."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1462952627, "post_id": 37156062, "comment_id": 61848807, "body": "Don&#39;t ever use <code>gets</code>, it&#39;s dangerous. It has also been deprecated since the C99 standard, and removed completely in the C11 standard."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1462952679, "post_id": 37156062, "comment_id": 61848841, "body": "And why are you using <code>malloc</code> to allocate a fixed-size buffer? What&#39;s wrong with arrays (if you&#39;re programming C) or <code>std::string</code> (if you&#39;re really programming in C++)? Also, since you use <code>malloc</code> to allocate memory for the strings, but don&#39;t call <code>free</code> each call to the function will lead to a <i>memory leak</i>."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 5, "creation_date": 1462952685, "post_id": 37156062, "comment_id": 61848844, "body": "Ignoring the use of <code>gets</code>, the use of <code>malloc</code>ed buffers in C++, the undefined behaviour triggered by <code>fflush(stdin)</code>, there is not enough information here to help you in any way. We have no problem believing what you think <code>change_student_name</code> does, but unless you show us its code we cannot tell you what&#39;s wrong with it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1462952913, "post_id": 37156062, "comment_id": 61848968, "body": "And don&#39;t post screenshots of code, <i>copy and paste</i> it into your question body instead."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1462955882, "post_id": 37156062, "comment_id": 61850813, "body": "can you give a bit more information about the &quot;problem of NULL pointer&quot; you are getting ? What do you see (including output, error messages, crashes, etc.) ?"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 5082388, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Q3lhoLwthAc/AAAAAAAAAAI/AAAAAAAAJj4/JdDuqAEDuEo/photo.jpg?sz=128", "display_name": "dharmista ", "link": "https://stackoverflow.com/users/5082388/dharmista"}, "is_accepted": false, "score": 0, "last_activity_date": 1463036765, "creation_date": 1463036765, "answer_id": 37179641, "question_id": 37156062, "link": "https://stackoverflow.com/questions/37156062/instance-of-file-pointers-in-c/37179641#37179641", "title": "instance of File pointers in c++", "body": "<p>Problem is removing the file and renaming the temp_file to original_file in same instance. Solved this by storing it in a buffer and finally storing in the file without creating a new instance for the file.<br></p>\n\n<pre><code>char * writeWordToString(char * main, int * pos, char * word){\n    if (word == NULL)\n        return main;\n    while (*word != '\\0'){\n        main = (char *)realloc(main, sizeof(char)*(*pos + 1));\n        main[(*pos)++] = *word;\n        word++;\n    }\n    return main;\n}\n\nvoid change_student_name(char * fileName, char * studentnName, char * nameToBeReplaced){\n    char * buffer = NULL;\n    int buffer_end = 0;\n    char * tempName = tempExtension(fileName);\n    FILE * fp = fopen(fileName, \"r\");\n    //Skipping subject count and subject names...\n    buffer = writeWordToString(buffer, &amp;buffer_end, getLine(fp));\n    buffer = writeWordToString(buffer, &amp;buffer_end, \"\\n\");\n    buffer = writeWordToString(buffer, &amp;buffer_end, getLine(fp));\n    buffer = writeWordToString(buffer, &amp;buffer_end, \"\\n\");\n    bool correct = false;\n    while (1){\n        char * temp = getLine(fp);\n        if (temp == NULL){\n            break;\n        }\n        if (stringCmp(temp, studentnName)){\n            correct = true;\n            buffer = writeWordToString(buffer, &amp;buffer_end, nameToBeReplaced);\n            buffer = writeWordToString(buffer, &amp;buffer_end, \"\\n\");\n            printf(\"Successfully replaced %s to %s in &lt;%s&gt;\\n\", studentnName, nameToBeReplaced, fileName);\n        }\n        else{\n            buffer = writeWordToString(buffer, &amp;buffer_end, temp);\n            buffer = writeWordToString(buffer, &amp;buffer_end, \"\\n\");\n        }\n        buffer = writeWordToString(buffer, &amp;buffer_end, getLine(fp));\n        buffer = writeWordToString(buffer, &amp;buffer_end, \"\\n\");\n    }\n    if (!correct){\n        printf(\"ERROR :: %s is not in the given file &lt;%s&gt;\\n\", studentnName, fileName);\n        free(buffer);\n        return;\n    }\n    char * buff_temp = buffer;\n    FILE *wptr = fopen(fileName, \"w\");\n    buffer[buffer_end] = '\\0';\n    while (*buffer != '\\0'){\n        fputc((int)*buffer, wptr);\n        buffer++;\n    }\n    fclose(fp);\n    fclose(wptr);\n    free(buff_temp);\n    return;\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5082388, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Q3lhoLwthAc/AAAAAAAAAAI/AAAAAAAAJj4/JdDuqAEDuEo/photo.jpg?sz=128", "display_name": "dharmista ", "link": "https://stackoverflow.com/users/5082388/dharmista"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463036765, "creation_date": 1462952311, "last_edit_date": 1462955749, "question_id": 37156062, "link": "https://stackoverflow.com/questions/37156062/instance-of-file-pointers-in-c", "title": "instance of File pointers in c++", "body": "<p>My actual code is </p>\n\n<pre><code>void alter_info(char * fileName){\n    system(\"CLS\");\n    char * studentName = (char *)malloc(sizeof(char)* 30);\n    char * subject = (char *)malloc(sizeof(char)* 30); int choice;\n    printf(\"1. Add a student to the file\\n2. Change a student name\\n3. Change a student marks\\n4. Delete a student from %s\\n0. Goto Root\\n\", fileName);\n    while (1){\n        printf(\"&gt;&gt;Enter option :\");\n        scanf(\"%d\", &amp;choice);  fflush(stdin);\n        switch (choice){\n        case 1:{\n                   printf(\"&gt;&gt;Enter student name :\");\n                   gets(studentName); fflush(stdin);\n                   add_student_and_marks(fileName, studentName);\n                   break;\n        }\n        case 2:{\n                   printf(\"&gt;&gt;Enter student name to be changed :\");\n                   gets(studentName); fflush(stdin);\n                   printf(\"&gt;&gt;Enter new name for %s :\", studentName);\n                   gets(subject); fflush(stdin);\n                   change_student_name(fileName, studentName, subject);\n                   break;\n        }\n        case 3:{\n                   printf(\"&gt;&gt;Enter student whose marks are to be changed :\");\n                   gets(studentName); fflush(stdin);\n                   change_stduent_marks(fileName, studentName);\n                   break;\n        }\n        case 4:{\n                   printf(\"&gt;&gt;Enter student to be removed :\");\n                   gets(studentName); fflush(stdin);\n                   delete_student_data(fileName, studentName);\n                   break;\n        }\n        case 0:{\n                   system(\"cls\");\n                   printf(\"1. View student info\\n2. Change student details\\n3. Show leaderboard\\n4. Query region\\n0. exit\\n\");\n                   return;\n        }\n        }\n    }\n    return;\n}\n</code></pre>\n\n<p>while accessing the case 2 in switch case i am:</p>\n\n<ol>\n<li>creating a temp file</li>\n<li>Deleting the original file</li>\n<li>and finally, renaming the temp file to original file name...</li>\n</ol>\n\n<p>I am facing a problem of NULL pointer while accessing it second time.\n<br><b>Code of <code>change_student_name</code> is :</b><br></p>\n\n<pre><code>void change_student_name(char * fileName, char * studentnName, char * nameToBeReplaced){\n    char * tempName = tempExtension(fileName);\n    FILE * fp = fopen(fileName, \"r\"), *wptr = fopen(tempName, \"w+\");\n    //Skipping subject count and subject names...\n    fprintf(wptr, \"%s\\n\", getLine(fp));\n    fprintf(wptr, \"%s\\n\", getLine(fp));\n    bool correct = false;\n    while (1){\n        char * temp = getLine(fp);\n        if (temp == NULL){\n            break;\n        }\n        if (stringCmp(temp, studentnName)){\n            correct = true;\n            fprintf(wptr, \"%s\\n\", nameToBeReplaced);\n            printf(\"Successfully replaced %s to %s in &lt;%s&gt;\\n\", studentnName, nameToBeReplaced, fileName);\n        }\n        else\n            fprintf(wptr, \"%s\\n\", temp);\n        fprintf(wptr, \"%s\\n\", getLine(fp));\n    }\n    if (!correct){\n        printf(\"ERROR :: %s is not in the given file &lt;%s&gt;\\n\", studentnName, fileName);\n    }\n    fclose(wptr);\n    fclose(fp);\n    remove(fileName);\n    rename(tempName, fileName);\n}\n</code></pre>\n\n<p><code>getLine(FILE * fp)</code> returns an entire line from the file<br>\n<code>getName(FILE * fp)</code> returns a word till the delimiter(,) or end..</p>\n"}, {"tags": ["css", "c", "button", "colors", "gtk"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1463001137, "post_id": 37156061, "comment_id": 61881349, "body": "The current version is 3.20; are you running master? That being said, that&#39;s definitely weird; I&#39;d have ot try it myself..."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1463002105, "post_id": 37156061, "comment_id": 61881820, "body": "I use version in debian testing repositories: <a href=\"https://tracker.debian.org/pkg/gtk+3.0\" rel=\"nofollow noreferrer\">tracker.debian.org/pkg/gtk+3.0</a>"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1463007448, "post_id": 37156061, "comment_id": 61883834, "body": "And for clarification, how are you defining the button names? In code with <code>gtk_widget_set_name()</code>? In code with <code>g_object_set(&quot;name&quot;)</code>? In a .ui file? I ask because I can confirm this but others cannot..."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1463036721, "post_id": 37156061, "comment_id": 61892809, "body": "This is in .glade file. I&#39;ve set ID AND Widget name to histotoolBlue and Green"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1463064980, "post_id": 37189454, "comment_id": 61913868, "body": "Oh thanks for the tip, but you should edit your message.The right code is : #histoToolGreen label { color: green; }"}, {"owner": {"reputation": 308, "user_id": 1191059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a797e2a8ad5c984735cd789a9ee8bd?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/1191059/blake"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1463069833, "post_id": 37189454, "comment_id": 61917299, "body": "Updated. I think the format I used is deprecated in newer version of GTK."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1463081747, "post_id": 37189454, "comment_id": 61924319, "body": "Thanks a lot. I have a last question. If I try to do it in C, it doesn&#39;t work. Any idea  : gtk_css_provider_load_from_data(provider, &quot;#histoToolRed label {color: red}&quot; or even gtk_css_provider_load_from_data(provider, &quot;* {color: yellow}&quot;?"}, {"owner": {"reputation": 308, "user_id": 1191059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a797e2a8ad5c984735cd789a9ee8bd?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/1191059/blake"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1463094311, "post_id": 37189454, "comment_id": 61930069, "body": "I can&#39;t tell from what you&#39;ve provided. If you flesh it out to a full separate question I&#39;ll take another look though."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1463165387, "post_id": 37189454, "comment_id": 61965729, "body": "Do you think that is relevant to ask another question ?"}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1463390438, "post_id": 37189454, "comment_id": 62028875, "body": "OK, I&#39;ve posted my question: <a href=\"http://stackoverflow.com/questions/37250497/change-text-color-for-gtktoggletoolbutton-in-c-code-gtk3\" title=\"change text color for gtktoggletoolbutton in c code gtk3\">stackoverflow.com/questions/37250497/&hellip;</a>"}], "tags": [], "owner": {"reputation": 308, "user_id": 1191059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a797e2a8ad5c984735cd789a9ee8bd?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/1191059/blake"}, "is_accepted": true, "score": 1, "last_activity_date": 1463069795, "last_edit_date": 1463069795, "creation_date": 1463062132, "answer_id": 37189454, "question_id": 37156061, "link": "https://stackoverflow.com/questions/37156061/change-text-color-for-gtktoggletoolbutton-with-css-sheet-gtk3/37189454#37189454", "title": "Change text color for GtkToggleToolButton with CSS sheet (GTK+3)", "body": "<p>You might try changing the color of the label rather than that of the button. Buttons are really just clickable bins. Buttons with text are just a helpful constructor which automatically adds a label.</p>\n\n<pre><code>#histoToolGreen label {\n  color: green;\n}\n\n#histoToolBlue label {\n  color: blue;\n}\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "accepted_answer_id": 37189454, "answer_count": 1, "score": 0, "last_activity_date": 1463069795, "creation_date": 1462952310, "last_edit_date": 1462958563, "question_id": 37156061, "link": "https://stackoverflow.com/questions/37156061/change-text-color-for-gtktoggletoolbutton-with-css-sheet-gtk3", "title": "Change text color for GtkToggleToolButton with CSS sheet (GTK+3)", "body": "<p>I'm trying to use a CSS sheet for changing properties on my GTK/C application. In a dialog, I have a GtkToolBar with GtkToggleToolButtons. I would like that texts of these buttons are of different color.</p>\n\n<p>I used to write something like that in a CSS sheet:</p>\n\n<pre><code>#histoToolGreen {\n  color: green;\n}\n\n#histoToolBlue {\n  color: blue;\n}\n</code></pre>\n\n<p>and it was working with GTK 3.20 (but only when buttons was off). But now, with gtk update, it is not working anymore.\nThe name of the buttons are histoToolGreen and histoToolBlue.</p>\n\n<p>Could you tell me how to change color of GtkToggleToolButton using a CSS sheet ?</p>\n"}, {"tags": ["c", "linux", "mprotect"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1462951705, "post_id": 37155754, "comment_id": 61848262, "body": "Too many assumptions and not enough error checking - e.g. you don&#39;t seem to be checking whether <code>foo_size</code> is less than or equal to 1024 (or even positive) ?"}, {"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1462951924, "post_id": 37155754, "comment_id": 61848381, "body": "@LPs Assumptions are made because i&#39;ve checked them. bar &gt; foo on my platform, and i don&#39;t know why i should check the equality to page size."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1462951942, "post_id": 37155754, "comment_id": 61848390, "body": "I think you can use your code with Position Independent Code due to the function relocation that your code is performing. This due to relative jump to <code>printf</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1462952377, "post_id": 37155754, "comment_id": 61848664, "body": "It&#39;s probably because your code is not position independent. Try to step through the assembly code with your debugger and you&#39;ll see what happens. BTW what you try to do is probably undefined behaviour."}, {"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1462952552, "post_id": 37155754, "comment_id": 61848765, "body": "@MichaelWalz How come it&#39;s undefined? the only assumption i made here is the location of &#39;bar&#39;. Also, i did try to read the assembly output of this code, it seems that the call to printf is made relative to &#39;foo&#39;. But it&#39;s still an address, so i don&#39;t see why this is a problem. &#39;call foo + X&#39;, &#39;foo&#39; shall turn into a constant address, and X is a constant."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 1, "creation_date": 1462953126, "post_id": 37155754, "comment_id": 61849098, "body": "For what it&#39;s worth, neither version of the code runs on Clang on OS X.  And by the way you are missing return statements in <code>foo()</code> and <code>bar()</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1462953362, "post_id": 37155754, "comment_id": 61849232, "body": "@Medals maybe on your platform it&#39;s not UB but generally it is. If the call is relative to foo, then the code of foo is not position independant. The call address is relative to the original foo function, but as you simply copy the code of the original foo to the buffer, the relative address of printf will be wrong in the copied foo function."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462959113, "post_id": 37155754, "comment_id": 61852987, "body": "@Medals Subtraction two pointers that don&#39;t point to the same array object is not defined. This is undefined behavior:  <code>int foo_size = bar - foo;</code>"}, {"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462960543, "post_id": 37155754, "comment_id": 61854006, "body": "@2501 You&#39;re right. my bad. should&#39;ve been: <code>(char*)bar - (char*)foo</code>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462960701, "post_id": 37155754, "comment_id": 61854116, "body": "@Medals Casts don&#39;t change the fact the pointers don&#39;t point to the same object."}, {"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462961382, "post_id": 37155754, "comment_id": 61854638, "body": "@2501 I&#39;m casting these pointers to &#39;point&#39; to the same objects. Since subtracting them gives me the number of objects between them, and <code>sizeof(char) == 1</code>, this is exactly what i need. I think it&#39;s quite defined."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1462961497, "post_id": 37155754, "comment_id": 61854721, "body": "@Medals <i>I&#39;m casting these pointers to &#39;point&#39; to the same objects.</i> That makes no sense whatsoever."}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 1, "creation_date": 1462961520, "post_id": 37155754, "comment_id": 61854738, "body": "Why do you expect that once you&#39;ve moved <code>foo</code> that the resultant address that the compiler assumes to be <code>printf</code> the same? Let&#39;s use some number shall we? Assume <code>printf</code> is at 100, and <code>foo</code> is at 200 the compiled code calls a function at -100 (200-100 = 100) so it calls printf. Now you move <code>foo</code> to 800. Since you haven&#39;t recompiled the binary (haven&#39;t change the instruction to call printf at -100) then it will still call -100 which is now 700. The best case scenario is you get a segfault. The worst case scenario is if you actually have a function defined at 700 and that gets called"}, {"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "reply_to_user": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1462961734, "post_id": 37155754, "comment_id": 61854889, "body": "@slebetman That&#39;s the case when it&#39;s a relative call. learned my lesson."}, {"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462962014, "post_id": 37155754, "comment_id": 61855089, "body": "@2501 Whoops. <i>Same object type.</i> how&#39;s that? good for you?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462962493, "post_id": 37155754, "comment_id": 61855423, "body": "@Medals As I said, casts don&#39;t and cannot change the fact the pointers don&#39;t point to the same object. Do some research instead of asserting it is defined, try to prove yourself wrong, etc..."}, {"owner": {"reputation": 3297, "user_id": 1436796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a4b86c1c90bc06112c2c069b58bf995?s=128&d=identicon&r=PG", "display_name": "Marc van Leeuwen", "link": "https://stackoverflow.com/users/1436796/marc-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1462981071, "post_id": 37155754, "comment_id": 61869772, "body": "If you want to manipulate assembly code, you should write in assembly language, not in C."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "edited": false, "score": 0, "creation_date": 1462954072, "post_id": 37156392, "comment_id": 61849648, "body": "Well this code is made for fun and only fun, so checking function return values wasn&#39;t the first thing on my mind, since it worked on my system. But i got it, thanks."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 2, "creation_date": 1462954322, "post_id": 37156392, "comment_id": 61849821, "body": "It&#39;s possible that <code>mprotect()</code> doesn&#39;t work on your system because of W^X: <a href=\"https://en.wikipedia.org/wiki/W%5EX\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/W%5EX</a>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "edited": false, "score": 3, "creation_date": 1462954778, "post_id": 37156392, "comment_id": 61850130, "body": "@Medals IMO checking for errors makes things less frustrating to debug and more fun."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1462955196, "post_id": 37156392, "comment_id": 61850384, "body": "@DietrichEpp As Theo (the guy who invented the term) has said many times, even quite recently, w^x can&#39;t be made mandatory yet. A lot of prominent programs (like firefox for example) will fail if we actually start enforcing it strictly. Currently w^x is just a policy of &quot;don&#39;t write code that does this&quot;, rather than &quot;the kernel will stop you from doing it&quot;. I suspect Linux has just started enforcing maximum protections on the heap we get from <code>brk</code> (which should be safe to do)."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1462957255, "post_id": 37156392, "comment_id": 61851738, "body": "On Linux, you should be able to <code>mprotect()</code> the result of <code>brk()</code> just fine.  I&#39;m not aware of any restrictions.  What is the error code?  Note that the code in the OP shows incorrect usage of <code>mprotect()</code>."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1462958331, "post_id": 37156392, "comment_id": 61852492, "body": "@DietrichEpp Are you sure? I get <code>EACCESS</code> on a correct attempt to <code>mprotect(PROT_EXEC)</code>  memory from <code>brk</code> while it works on stuff I get from <code>mmap</code>. <code>mprotect(PROT_READ)</code> on memory from <code>brk</code> works."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1462958418, "post_id": 37156392, "comment_id": 61852539, "body": "@DietrichEpp see: <a href=\"https://gist.github.com/art4711/181dc7683c757df1874f0dbe7ad20c4f\" rel=\"nofollow noreferrer\">gist.github.com/art4711/181dc7683c757df1874f0dbe7ad20c4f</a>"}, {"owner": {"reputation": 2633, "user_id": 27898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84028aac31ee14ca90aa08c2442e3a1e?s=128&d=identicon&r=PG", "display_name": "mpez0", "link": "https://stackoverflow.com/users/27898/mpez0"}, "edited": false, "score": 0, "creation_date": 1462975188, "post_id": 37156392, "comment_id": 61865362, "body": "I think the x86 is a weird platform. Common, perhaps, but nonetheless weird in instructions and addressing."}, {"owner": {"reputation": 68, "user_id": 516539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/udwqT.jpg?s=128&g=1", "display_name": "Emil Je\u0159&#225;bek", "link": "https://stackoverflow.com/users/516539/emil-je%c5%99%c3%a1bek"}, "edited": false, "score": 0, "creation_date": 1462976640, "post_id": 37156392, "comment_id": 61866480, "body": "Any way I look at it, the computation of foo_size is totally unreliable. What prevents the compiler from e.g. putting bar before foo?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 2633, "user_id": 27898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84028aac31ee14ca90aa08c2442e3a1e?s=128&d=identicon&r=PG", "display_name": "mpez0", "link": "https://stackoverflow.com/users/27898/mpez0"}, "edited": false, "score": 0, "creation_date": 1462976649, "post_id": 37156392, "comment_id": 61866495, "body": "@mpez0 Maybe, but not in this case. Pc-relative addressing is done by almost everyone, it&#39;s much better than loading constants from tables and stalling on that. And much much better than text modification that would be necessary for PIC relocation with call instructions to constants. If you look at the instruction set and ABI changes on amd64 pc-relative addressing is used for much more now than on i386. This is a good thing."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 68, "user_id": 516539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/udwqT.jpg?s=128&g=1", "display_name": "Emil Je\u0159&#225;bek", "link": "https://stackoverflow.com/users/516539/emil-je%c5%99%c3%a1bek"}, "edited": false, "score": 0, "creation_date": 1462976994, "post_id": 37156392, "comment_id": 61866758, "body": "@EmilJe\u0159&#225;bek Nothing at all. This is not about making this reliable (to do that we&#39;d need linker scripts at least), it&#39;s about exploring what&#39;s going on. As OP explained he did this for fun to see what happens. I haven&#39;t even tried counting the standard violations and undefined behaviors we have in here, but they are numerous."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 38, "last_activity_date": 1462959997, "last_edit_date": 1462959997, "creation_date": 1462953390, "answer_id": 37156392, "question_id": 37155754, "link": "https://stackoverflow.com/questions/37155754/segmentation-fault-when-calling-a-function-located-in-the-heap/37156392#37156392", "title": "Segmentation fault when calling a function located in the heap", "body": "<p>Your code is not position independent and even if it were, you don't have the correct relocations to move it to an arbitrary position. Your call to <code>printf</code> (or any other function) will be done with pc-relative addressing (through the PLT, but that's besides the point here). This means that the instruction generated to call printf isn't a call to a static address but rather \"call the function X bytes from the current instruction pointer\". Since you moved the code the call is done to a bad address. (I'm assuming i386 or amd64 here, but generally it's a safe assumption, people who are on weird platforms usually mention that).</p>\n\n<p>More specifically, x86 has two different instructions for function calls. One is a call relative to the instruction pointer which determines the destination of the function call by adding a value to the current instruction pointer. This is the most commonly used function call. The second instruction is a call to a pointer inside a register or memory location. This is much less commonly used by compilers because it requires more memory indirections and stalls the pipeline. The way shared libraries are implemented (your call to <code>printf</code> will actually go to a shared library) is that for every function call you make outside of your own code the compiler will insert fake functions near your code (this is the PLT I mentioned above). Your code does a normal pc-relative call to this fake function and the fake function will find the real address to <code>printf</code> and call that. It doesn't really matter though. Almost any normal function call you make will be pc-relative and will fail. Your only hope in code like this are function pointers.</p>\n\n<p>You might also run into some restrictions on executable <code>mprotect</code>. Check the return value of <code>mprotect</code>, on my system your code doesn't work for one more reason: <code>mprotect</code> doesn't allow me to do this. Probably because the backend memory allocator of <code>malloc</code> has additional restrictions that prevents executable protections of its memory. Which leads me to the next point:</p>\n\n<p>You will break things by calling <code>mprotect</code> on memory that isn't managed by you. That includes memory you got from <code>malloc</code>. You should only <code>mprotect</code> things you've gotten from the kernel yourself through <code>mmap</code>.</p>\n\n<p>Here's a version that demonstrates how to make this work (on my system):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;err.h&gt;\n\nint\nfoo(int x, int (*fn)(const char *, ...))\n{\n        fn(\"%d\\n\", x);\n        return 42;\n}\n\nint\nbar(int x)\n{\n        return 0;\n}\n\nint\nmain(int argc, char **argv)\n{\n        size_t foo_size = (char *)bar - (char *)foo;\n        int ps = getpagesize();\n\n        void *buf_ptr = mmap(NULL, ps, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_ANON|MAP_PRIVATE, -1, 0);\n\n        if (buf_ptr == MAP_FAILED)\n                err(1, \"mmap\");\n\n        memcpy(buf_ptr, foo, foo_size);\n\n        int (*ptr)(int, int (*)(const char *, ...)) = buf_ptr;\n\n        printf(\"%d\\n\", ptr(3, printf));\n\n        return 0;\n}\n</code></pre>\n\n<p>Here, I abuse the knowledge of how the compiler will generate the code for the function call. By using a function pointer I force it to generate a call instruction that isn't pc-relative. Also, I manage the memory allocation myself so that we get the right permissions from start and not run into any restrictions that <code>brk</code> might have. As a bonus we do error handling that actually helped me find a bug in the first version of this experiment and I also corrected other minor bugs (like missing includes) which allowed me to enable warnings in the compiler and catch another potential problem.</p>\n\n<p>If you want to dig deeper into this you can do something like this. I added two versions of the function:</p>\n\n<pre><code>int\noldfoo(int x)\n{\n        printf(\"%d\\n\", x);\n        return 42;\n}\n\nint\nfoo(int x, int (*fn)(const char *, ...))\n{\n        fn(\"%d\\n\", x);\n        return 42;\n}\n</code></pre>\n\n<p>Compile the whole thing and disassemble it:</p>\n\n<pre><code>$ cc -Wall -o foo foo.c\n$ objdump -S foo | less\n</code></pre>\n\n<p>We can now look at the two generated functions:</p>\n\n<pre><code>0000000000400680 &lt;oldfoo&gt;:\n  400680:       55                      push   %rbp\n  400681:       48 89 e5                mov    %rsp,%rbp\n  400684:       48 83 ec 10             sub    $0x10,%rsp\n  400688:       89 7d fc                mov    %edi,-0x4(%rbp)\n  40068b:       8b 45 fc                mov    -0x4(%rbp),%eax\n  40068e:       89 c6                   mov    %eax,%esi\n  400690:       bf 30 08 40 00          mov    $0x400830,%edi\n  400695:       b8 00 00 00 00          mov    $0x0,%eax\n  40069a:       e8 91 fe ff ff          callq  400530 &lt;printf@plt&gt;\n  40069f:       b8 2a 00 00 00          mov    $0x2a,%eax\n  4006a4:       c9                      leaveq\n  4006a5:       c3                      retq\n\n00000000004006a6 &lt;foo&gt;:\n  4006a6:       55                      push   %rbp\n  4006a7:       48 89 e5                mov    %rsp,%rbp\n  4006aa:       48 83 ec 10             sub    $0x10,%rsp\n  4006ae:       89 7d fc                mov    %edi,-0x4(%rbp)\n  4006b1:       48 89 75 f0             mov    %rsi,-0x10(%rbp)\n  4006b5:       8b 45 fc                mov    -0x4(%rbp),%eax\n  4006b8:       48 8b 55 f0             mov    -0x10(%rbp),%rdx\n  4006bc:       89 c6                   mov    %eax,%esi\n  4006be:       bf 30 08 40 00          mov    $0x400830,%edi\n  4006c3:       b8 00 00 00 00          mov    $0x0,%eax\n  4006c8:       ff d2                   callq  *%rdx\n  4006ca:       b8 2a 00 00 00          mov    $0x2a,%eax\n  4006cf:       c9                      leaveq\n  4006d0:       c3                      retq\n</code></pre>\n\n<p>The instruction for the function call in the <code>printf</code> case is \"e8 91 fe ff ff\". This is a pc-relative function call. 0xfffffe91 bytes in front of our instruction pointer. It's treated as a signed 32 bit value, and the instruction pointer used in the calculation is the address of the next instruction. So 0x40069f (next instruction) - 0x16f (0xfffffe91 in front is 0x16f bytes behind with signed math) gives us the address 0x400530, and looking at the disassembled code I find this at the address:</p>\n\n<pre><code>0000000000400530 &lt;printf@plt&gt;:\n  400530:       ff 25 ea 0a 20 00       jmpq   *0x200aea(%rip)        # 601020 &lt;_GLOBAL_OFFSET_TABLE_+0x20&gt;\n  400536:       68 01 00 00 00          pushq  $0x1\n  40053b:       e9 d0 ff ff ff          jmpq   400510 &lt;_init+0x28&gt;\n</code></pre>\n\n<p>This is the magic \"fake function\" I mentioned earlier. Let's not get into how this works. It's necessary for shared libraries to work and that's all we need to know for now.</p>\n\n<p>The second function generates the function call instruction \"ff d2\". This means \"call the function at the address stored inside the rdx register\". No pc-relative addressing and that's why it works.</p>\n"}, {"tags": [], "owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "is_accepted": false, "score": 1, "last_activity_date": 1462953603, "creation_date": 1462953603, "answer_id": 37156464, "question_id": 37155754, "link": "https://stackoverflow.com/questions/37155754/segmentation-fault-when-calling-a-function-located-in-the-heap/37156464#37156464", "title": "Segmentation fault when calling a function located in the heap", "body": "<p>I think I can explain a bit. First of all, if both your functions have no return statement within, an undefined behaviour is invoked as per standard \u00a76.9.1/12. Secondly, which is most common on a lot of platforms, and yours apparently as well, is the following: relative addresses of functions are hardcoded into binary code of functions. That means, that if you have a call of \"printf\" within \"foo\" and then you move (e.g. execute) from another location, that address, from which \"printf\" should be called, turns bad.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 3, "last_activity_date": 1462954006, "creation_date": 1462954006, "answer_id": 37156580, "question_id": 37155754, "link": "https://stackoverflow.com/questions/37155754/segmentation-fault-when-calling-a-function-located-in-the-heap/37156580#37156580", "title": "Segmentation fault when calling a function located in the heap", "body": "<p>The compiler is free to generate the code the way it wants provided the observable results are correct (as if rule). So what you do is just an undefined behaviour invocation.</p>\n\n<p>Visual Studio sometimes uses <em>relays</em>. That means that the address of a function just points to a relative jump. That's perfectly allowed per standard because of the as is rule but it would definitely break that kind of construction. Another possibility is to have <em>local internal functions</em> called with relative jumps but outside of the function itself. In that case, your code would not copy them, and the relative calls will just point to random memory. That means that with different compilers (or even different compilation options on same compiler) it could give expected result, crash, or directly end the program without error which is exactly UB.</p>\n"}], "owner": {"reputation": 331, "user_id": 1677684, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/9187c424c4d5fd30d0e222c9bb14f27f?s=128&d=identicon&r=PG", "display_name": "Delights", "link": "https://stackoverflow.com/users/1677684/delights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3186, "favorite_count": 9, "answer_count": 3, "score": 15, "last_activity_date": 1462959997, "creation_date": 1462951425, "last_edit_date": 1462955062, "question_id": 37155754, "link": "https://stackoverflow.com/questions/37155754/segmentation-fault-when-calling-a-function-located-in-the-heap", "title": "Segmentation fault when calling a function located in the heap", "body": "<p>I'm trying to tweak the rules a little bit here, and <code>malloc</code> a buffer,\nthen copy a function to the buffer.</p>\n\n<p>Calling the buffered function works, but the function throws a Segmentation fault when i'm trying to call another function within.</p>\n\n<p>Any thoughts why?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint foo(int x)\n{\n    printf(\"%d\\n\", x);\n}\n\nint bar(int x)\n{\n}\n\nint main()\n{\n    int foo_size = bar - foo;\n\n    void* buf_ptr;\n\n    buf_ptr = malloc(1024);\n\n    memcpy(buf_ptr, foo, foo_size);\n\n    mprotect((void*)(((int)buf_ptr) &amp; ~(sysconf(_SC_PAGE_SIZE) - 1)),\n             sysconf(_SC_PAGE_SIZE),\n             PROT_READ|PROT_WRITE|PROT_EXEC);\n\n    int (*ptr)(int) = buf_ptr;\n\n    printf(\"%d\\n\", ptr(3));\n\n    return 0;\n}\n</code></pre>\n\n<p>This code will throw a segfault, unless i'll change the <code>foo</code> function to:</p>\n\n<pre><code>int foo(int x)\n{\n    //Anything but calling another function.\n    x = 4;\n    return x;\n}\n</code></pre>\n\n<p>NOTE:</p>\n\n<p>The code successfully copies <code>foo</code> into the buffer, i know i made some assumptions, but on my platform they're ok.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2145, "user_id": 4849573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fb4358973b1d406f85d2b0eeec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "ckruczek", "link": "https://stackoverflow.com/users/4849573/ckruczek"}, "edited": false, "score": 1, "creation_date": 1462949569, "post_id": 37155089, "comment_id": 61846895, "body": "<a href=\"http://cdecl.ridiculousfish.com?q=int+%2A(%2Atable())%5B30%5D%3B\" rel=\"nofollow noreferrer\">declare table as function returning pointer to array 30 of pointer to int</a>"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 3, "creation_date": 1462949599, "post_id": 37155089, "comment_id": 61846915, "body": "cdecl is your friend. <code>cdecl&gt; explain int *(*table())[30]</code>   <code>declare table as function returning pointer to array 30 of pointer to int</code>"}, {"owner": {"reputation": 532, "user_id": 5575101, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/add6836672110b43184a99e5fdabf4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kaushal", "link": "https://stackoverflow.com/users/5575101/arun-kaushal"}, "edited": false, "score": 1, "creation_date": 1462950249, "post_id": 37155089, "comment_id": 61847325, "body": "Please refer to spiral/clockwise rule <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow noreferrer\">c-faq.com/decl/spiral.anderson.html</a>"}, {"owner": {"reputation": 958, "user_id": 4714914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4sNJ.jpg?s=128&g=1", "display_name": "Liju Thomas", "link": "https://stackoverflow.com/users/4714914/liju-thomas"}, "edited": false, "score": 0, "creation_date": 1463030882, "post_id": 37155089, "comment_id": 61889984, "body": "@user1820451 If any of the answers below has solved your problem, do mark any one as accepted. Read more about this here: <a href=\"https://stackoverflow.com/help/accepted-answer\">stackoverflow.com/help/accepted-answer</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 3, "last_activity_date": 1462950904, "last_edit_date": 1462950904, "creation_date": 1462950416, "answer_id": 37155429, "question_id": 37155089, "link": "https://stackoverflow.com/questions/37155089/in-c-what-is-the-meaning-of-this-declaration-int-table30/37155429#37155429", "title": "in C what is the meaning of this declaration: int *(*table())[30];", "body": "<p>Reading of such constructs is much easier if you replace parts of the declaration that can be replaced, with a substitute name. Let's say <code>f</code> is <code>table()</code>, which is a function taking unspecified number of arguments, and <code>t</code> is the type <code>int*</code>. </p>\n\n<p>Then the declaration becomes:</p>\n\n<pre><code>t(*f)[30];\n</code></pre>\n\n<p>which is obviously a pointer to an array of 30 elements of <code>t</code>.</p>\n\n<p>Replace <code>f</code>, and we get a function taking unspecified number of arguments, and returning a pointer to an array of 30 elements of t:</p>\n\n<pre><code>t(*table())[30];\n</code></pre>\n\n<p>Replace <code>t</code> and we get a function taking unspecified number of arguments, and returning a pointer to an array of 30 elements of pointer to int:</p>\n\n<pre><code>int*(*table())[30];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1466709044, "post_id": 37155436, "comment_id": 63443981, "body": "Does it go to the 30th place in an array of pointers of ints or returning a pointer of array with length of 30?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1466719474, "post_id": 37155436, "comment_id": 63449345, "body": "@DeBanana Since it&#39;s a declarator, the 30 is an array length, not an index."}], "tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 5, "last_activity_date": 1462950439, "creation_date": 1462950439, "answer_id": 37155436, "question_id": 37155089, "link": "https://stackoverflow.com/questions/37155089/in-c-what-is-the-meaning-of-this-declaration-int-table30/37155436#37155436", "title": "in C what is the meaning of this declaration: int *(*table())[30];", "body": "<p>You can decode this from the inside out:</p>\n\n<pre><code>int *(*table())[30];\n</code></pre>\n\n<p>The innermost binding is<code>table()</code>, which is a function with unspecified arguments.  The next level is <code>*table()</code>, so <code>table</code> is returning a pointer to something.  The next level is <code>(*table())[30]</code>, so it's returning a pointer to a 30-length array of something.  The next level is <code>*(table())[30]</code>, so it's returning a pointer to a 30-length array of pointers to something.  The final level adds the type specifier, <code>int *(*table())[30]</code>.</p>\n\n<p>So <code>table</code> is a function (with unspecified arguments) that returns a pointer to a 30-length array of pointers to <code>int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 0, "last_activity_date": 1462951182, "last_edit_date": 1592644375, "creation_date": 1462951182, "answer_id": 37155681, "question_id": 37155089, "link": "https://stackoverflow.com/questions/37155089/in-c-what-is-the-meaning-of-this-declaration-int-table30/37155681#37155681", "title": "in C what is the meaning of this declaration: int *(*table())[30];", "body": "<p>The line:</p>\n<pre><code>int *(*table())[30];\n</code></pre>\n<p>declares that &quot;table is a function returning a pointer to an array of 30 pointers to int.&quot;</p>\n<p>There are myriad good articles on how to read C type declarations. <a href=\"http://unixwiz.net/techtips/reading-cdecl.html\" rel=\"nofollow noreferrer\">Here is one of them.</a></p>\n<p>To summarize:</p>\n<p><strong>The rules:</strong></p>\n<ol>\n<li>There is a type name on the left. Call that $typename.</li>\n<li>There is an identifier somewhere towards the right, possibly surrounded by <code>[]</code> and <code>()</code> and <code>*</code>. Call that $identifier.</li>\n</ol>\n<p>Your declaration will be templated like: <code>$identifier</code> is a ... <code>$typename</code>.</p>\n<ol start=\"3\">\n<li><p>Start with &quot;$identifier is a(n)&quot;.</p>\n</li>\n<li><p>If you can go right, by consuming a <code>[...]</code> or a <code>(...)</code>, then add that to your declaration. The <code>[...]</code> is a (possibly-empty) array declaration, written &quot;array (of ...)&quot;; while the <code>(...)</code> is a (possibly-empty) function declaration, written &quot;function returning&quot; or &quot;function taking (...) returning&quot;.</p>\n</li>\n<li><p>If you cannot go right, because you reach a semicolon, or comma, or a closing parenthesis, then you must go left. Go left, consuming either the $typename if you are at the end of the process, or consuming a pointer declaration (<code>*</code>, written &quot;pointer(s) to&quot;) or consuming an opening parenthesis. After consuming any of these, except the $typename, try to go right again.</p>\n<p>Remember: Go right if you can, go left if you must.</p>\n</li>\n</ol>\n<p><strong>Your question, revisited</strong></p>\n<p>With that in mind, let's look again:</p>\n<pre><code>int *(*table())[30];\n</code></pre>\n<p>Step by step:</p>\n<ol>\n<li><p>$typename = &quot;int&quot;</p>\n</li>\n<li><p>$identifier = &quot;table&quot;;</p>\n</li>\n<li><p>Start with &quot;$identifier is a(n)&quot;: &quot;table is a(n)&quot; <code>${typename} *(*${declaration}())[30];</code></p>\n</li>\n<li><p>Go right: &quot;... function returning&quot; <code>${typename} *(* ${declaration} )[30];</code></p>\n</li>\n<li><p>Go right: fails, because of <code>)</code></p>\n</li>\n<li><p>Go left: &quot;... pointer(s) to&quot; <code>${typename} * ${declaration} [30];</code></p>\n</li>\n<li><p>Go right: &quot;... an array of 30&quot; <code>${typename} * ${declaration};</code></p>\n</li>\n<li><p>Go right: fails, because of <code>;</code>  <code>${typename} * ${declaration}</code></p>\n</li>\n<li><p>Go left: &quot;... pointer(s) to&quot; <code>${typename} ${declaration}</code></p>\n</li>\n<li><p>Go right: fails.</p>\n</li>\n<li><p>Go left: &quot;int&quot;</p>\n</li>\n</ol>\n<p>Write that all in order, and you get:</p>\n<blockquote>\n<p>table is a(n) function returning pointer(s) to an array of 30 pointer(s) to int</p>\n</blockquote>\n<p>Clean up the sentence by removing (s) where not needed, and replacing single pointer with &quot;a pointer&quot;:</p>\n<blockquote>\n<p>table is a function returning a pointer to an array of 30 pointers to int.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 958, "user_id": 4714914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4sNJ.jpg?s=128&g=1", "display_name": "Liju Thomas", "link": "https://stackoverflow.com/users/4714914/liju-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1462954428, "last_edit_date": 1462954428, "creation_date": 1462951829, "answer_id": 37155878, "question_id": 37155089, "link": "https://stackoverflow.com/questions/37155089/in-c-what-is-the-meaning-of-this-declaration-int-table30/37155878#37155878", "title": "in C what is the meaning of this declaration: int *(*table())[30];", "body": "<p>Above declaration can be understood by the <strong>Clockwise/Spiral</strong> rule.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/gIJg1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gIJg1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Following describes how to parse the declaration using the rule:</p>\n\n<blockquote>\n  <p>1) <strong><em>table</em></strong> is a function with unspecified arguments.</p>\n  \n  <p>2) The <strong><em>table()</em></strong> function returns a <strong>pointer</strong>.</p>\n  \n  <p>3) The <strong>pointer</strong> returned by <em>table()</em> function points to an array of <strong>30</strong> elements.</p>\n  \n  <p>4) Each element is of type <strong><em>integer pointers</em></strong> i.e., each element is pointing to an integer.</p>\n</blockquote>\n\n<p>More about the rule is well explained in this link : <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow noreferrer\">The ``Clockwise/Spiral Rule''</a></p>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1462952469, "creation_date": 1462952469, "answer_id": 37156121, "question_id": 37155089, "link": "https://stackoverflow.com/questions/37155089/in-c-what-is-the-meaning-of-this-declaration-int-table30/37156121#37156121", "title": "in C what is the meaning of this declaration: int *(*table())[30];", "body": "<p>The identifier <em>table</em> is a function which returns a pointer to an array of 30 integer pointers. As a complement to learning the so called <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow\">clockwise/spiral rule</a>, you can use a site like <a href=\"http://cdecl.org/\" rel=\"nofollow\">http://cdecl.org/</a> to find out.</p>\n\n<p>If I was able to rewrite the code I would split the declaration into a type declaration and a function declaration. That way it will be easier to understand the program text. Also I would call the result type <em>Table</em> and choose a more specific name for the function, which most likely returns a special kind of table, say a <em>Foo</em> table. If possible I would also avoid the empty parameter list and use the keyword <em>void</em> to specify that the function takes no parameters:</p>\n\n<pre><code>typedef int *(*Table)[30];\n\nTable FooTable(void);\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 1820451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e0e18689194c374abe2979565fb924a?s=128&d=identicon&r=PG", "display_name": "user1820451", "link": "https://stackoverflow.com/users/1820451/user1820451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "answer_count": 5, "score": 4, "last_activity_date": 1462954428, "creation_date": 1462949423, "last_edit_date": 1462949618, "question_id": 37155089, "link": "https://stackoverflow.com/questions/37155089/in-c-what-is-the-meaning-of-this-declaration-int-table30", "title": "in C what is the meaning of this declaration: int *(*table())[30];", "body": "<pre><code>int *(*table())[30];\n</code></pre>\n\n<p>I cannot find a solution anywhere.\nWhat is the *table(), can it be a function or array?</p>\n\n<p>Can you please tell me what that means?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1462948165, "post_id": 37154631, "comment_id": 61846080, "body": "Does engine.h need to be re-built if temp.h changes? Or does engine.o need to be re-built if temp.h changes?"}, {"owner": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1462948331, "post_id": 37154631, "comment_id": 61846177, "body": "engine.h right? And ultimately engine.o I guess"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1462948599, "post_id": 37154631, "comment_id": 61846329, "body": "When you update temp.h what do you have to do to engine.h? And what do you have to do to engine.o? (Keep in mind that Make cares about the <i>outputs</i> of each command - you compile engine.c, but from Make&#39;s point of view that&#39;s &quot;doing something to engine.o&quot;)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1462948969, "post_id": 37154631, "comment_id": 61846545, "body": "The answer key is correct.  When <code>temp.h</code> changes, you need to rebuild <code>engine.o</code> \u2014 so you tell Make that <code>engine.o</code> is out of date unless it is newer than <code>temp.h</code> (as well as <code>engine.c</code> and <code>engine.h</code>).  In fact, you could omit <code>engine.c</code> from the list; Make will infer that dependency."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1462948978, "post_id": 37154631, "comment_id": 61846551, "body": "&quot;engine.h right?&quot;. No, not right because header files do not need to be rebuilt (in general). If <code>temp.h</code> changes, nothing needs to be done to <code>engine.h</code>. The output which needs to be rebuilt is <code>engine.o</code>. Hence why the second answer is correct and not the first."}, {"owner": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "edited": false, "score": 0, "creation_date": 1462949001, "post_id": 37154631, "comment_id": 61846563, "body": "So if temp.h included another header file, I&#39;d have to add that to the target as well?"}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1462949972, "post_id": 37154631, "comment_id": 61847127, "body": "Yes. But hopefully, today&#39;s compilers can do that for you, e.g. <code>gcc -M</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1463106340, "post_id": 37154631, "comment_id": 61932701, "body": "in general, a makefile needs to be written so it generates &#39;dependency&#39; files, then the rule can be: <code>%.o:%.c %.d</code> followed by the &#39;recipe&#39;.   The dependency files (one for each *.c file) contains ALL the header files,  Then if any referenced header file changes, then the *.o file will be re-created.  There are several ways to generate the dependency files.  If using <code>gcc</code>, there are parameters available to generate the dependencies.  The dependency files are included in the makefile via a statement similar to: <code>-include $(DEP)</code>  where <code>DEP</code> is a macro that contains list of dependencies files"}], "answers": [{"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": true, "score": 1, "last_activity_date": 1462949381, "creation_date": 1462949381, "answer_id": 37155069, "question_id": 37154631, "link": "https://stackoverflow.com/questions/37154631/makefile-query-c/37155069#37155069", "title": "Makefile query-C", "body": "<p>To review:</p>\n\n<blockquote>\n  <p>The file <code>engine.c</code> includes the file <code>engine.h</code> and <code>engine.h</code> includes the file <code>temp.h</code></p>\n</blockquote>\n\n<p>So that's:</p>\n\n<p><em>engine.c</em></p>\n\n<pre><code>#include \"engine.h\"\n</code></pre>\n\n<p><em>engine.h</em></p>\n\n<pre><code>#include \"temp.h\"\n</code></pre>\n\n<p><em>temp.h</em></p>\n\n<pre><code>/* nothing */\n</code></pre>\n\n<p>If you modify <code>temp.h</code>, then <strong>you need to rebuild <code>engine.o</code> from its parts,</strong> because one of its parts is (eventually) <code>temp.h</code>. </p>\n\n<p>When all the including is done, the code effectively looks like this:</p>\n\n<blockquote>\n  <p>engine.c</p>\n  \n  <p>/* #include \"engine.h\" */</p>\n  \n  <blockquote>\n    <p>engine.h</p>\n    \n    <p>/* #include \"temp.h\" */</p>\n    \n    <blockquote>\n      <p>temp.h</p>\n      \n      <p>/* end of temp.h */</p>\n    </blockquote>\n    \n    <p>...</p>\n    \n    <p>/* end of engine.h */</p>\n  </blockquote>\n  \n  <p>...</p>\n  \n  <p>/* end of engine.c */</p>\n</blockquote>\n\n<p>In fact, if you use something like <code>gcc -E engine.c &gt; engine.i</code> you can see this for yourself. The <code>-E</code> option stops after the preprocessing phase, translating C source into C source-without-preprocessor-directives.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1462949439, "creation_date": 1462949439, "answer_id": 37155090, "question_id": 37154631, "link": "https://stackoverflow.com/questions/37154631/makefile-query-c/37155090#37155090", "title": "Makefile query-C", "body": "<p>Let's say the contents of <code>temp.h</code> are:</p>\n\n<pre><code>#pragma once\n\nvoid temp_function(int x);\n</code></pre>\n\n<p>and the contents of <code>engine.h</code> are:</p>\n\n<pre><code>#pragma once\n#include \"temp.h\"\n\nvoid engine_function(int a, int b);\n</code></pre>\n\n<p>and the contents of <code>engine.c</code> are:</p>\n\n<pre><code>#include \"engine.h\"\n\nvoid engine_function(int a, int b)\n{\n   temp_function(a+b);\n}\n</code></pre>\n\n<p>Let's also say that for some reason the contents of <code>temp.h</code> are changed to:</p>\n\n<pre><code>#pragma once\n\nvoid temp_function(int x, int y);\n</code></pre>\n\n<p>Let's assume that <code>temp_function</code> is implemented in another file.</p>\n\n<p>If you don't re-compile <code>eninge.c</code>, then the object code in <code>engine.o</code> for <code>temp_function</code> does not match the object code for the function in the file in which it is implemented. As a result, you will see a link time error. If you re-compile <code>engine.c</code>, you will see a compile time error.</p>\n\n<p>It is always better to catch errors at compile time than at link time.</p>\n\n<p>The rule</p>\n\n<pre><code>engine.o: engine.c engine.h temp.h\n</code></pre>\n\n<p>makes sure that the command to build <code>engine.o</code> is executed when <code>temp.h</code> is changed, and the compile time error is caught.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1462951579, "post_id": 37155180, "comment_id": 61848191, "body": "A change in <code>temp.h</code> may also change the results of compiling <code>engine.c</code> without affecting material in <code>engine.h</code> \u2014 so it has a direct effect on <code>engine.c</code> and no effect on <code>engine.h</code>."}], "tags": [], "owner": {"reputation": 11, "user_id": 6318647, "user_type": "registered", "profile_image": "https://graph.facebook.com/782451461891849/picture?type=large", "display_name": "copj", "link": "https://stackoverflow.com/users/6318647/copj"}, "is_accepted": false, "score": 1, "last_activity_date": 1462949693, "creation_date": 1462949693, "answer_id": 37155180, "question_id": 37154631, "link": "https://stackoverflow.com/questions/37154631/makefile-query-c/37155180#37155180", "title": "Makefile query-C", "body": "<p>engine.c depends on engine.h, and any change in engine.h can have significant change in engine.c</p>\n\n<p>Similarly engine.h depends on temp.h, and any change in temp.h can have significant change in engine.h, which will indirectly have impact on engine.c</p>\n\n<p>lets see this with an example:</p>\n\n<p>in temp.h</p>\n\n<pre><code>#define ID 1\n</code></pre>\n\n<p>in engine.h</p>\n\n<pre><code>#define ENGINE_ID ID\n</code></pre>\n\n<p>in engine.c</p>\n\n<pre><code>engineId = ENGINE_ID;\n</code></pre>\n\n<p>if you modify ID, but in makefile rule is this:</p>\n\n<pre><code>engine.o: engine.c engine.h\ngcc -c engine.c \n</code></pre>\n\n<p>the file will not recompile. But with</p>\n\n<pre><code>engine.o: engine.c engine.h temp.h\ngcc -c engine.c \n</code></pre>\n\n<p>The file will get recompiled with new ID.</p>\n"}], "owner": {"reputation": 775, "user_id": 4259146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/md4P7.jpg?s=128&g=1", "display_name": "samz_manu", "link": "https://stackoverflow.com/users/4259146/samz-manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 37155069, "answer_count": 3, "score": 4, "last_activity_date": 1462949693, "creation_date": 1462948119, "last_edit_date": 1462948857, "question_id": 37154631, "link": "https://stackoverflow.com/questions/37154631/makefile-query-c", "title": "Makefile query-C", "body": "<p>This was on an exam of mine and I'm reviewing and can't figure out why I lost points on it. Too late to ask the professor now so I'm here. Have I just not understood the basics of makefile? This is the problem:</p>\n\n<blockquote>\n  <p>The file <code>engine.c</code> includes the file <code>engine.h</code> and <code>engine.h</code> includes the file <code>temp.h</code>. Write one or more makefile rules that generates the file <code>engine.o</code>.\" </p>\n</blockquote>\n\n<p>This was my answer:</p>\n\n<pre><code>engine.o: engine.c engine.h\n    gcc -c engine.c\n</code></pre>\n\n<p>The answer key says it should be:</p>\n\n<pre><code>engine.o: engine.c engine.h temp.h\n    gcc -c engine.c \n</code></pre>\n\n<p>But I don't get it. The object file for <code>engine.c</code> doesn't depend on <code>temp.h</code> does it? <code>engine.h</code> depends on it. And I would handle <code>temp.h</code> if I was writing another target for <code>engine.h</code> but I'm not. Strictly speaking about the target for <code>engine.o</code>, do I need <code>temp.h</code>?</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1462948152, "post_id": 37154590, "comment_id": 61846077, "body": "Do you know what <code>(int*)buffer</code> means? If not read about <i>casting</i>. Do you know what the unary dereference operator <code>*</code> does (for example what happens if you have <code>*some_pointer</code>)? If not read about that too. Then just combine the knowledge about each subject, like they are combined in expression you&#39;re wondering about."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 2, "creation_date": 1462948439, "post_id": 37154590, "comment_id": 61846237, "body": "This statement also possibly causes alignment exception on some architectures."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 5, "creation_date": 1462948708, "post_id": 37154590, "comment_id": 61846393, "body": "This statement also causes undefined behavior."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1462949997, "post_id": 37154590, "comment_id": 61847146, "body": "It&#39;s taking the address of <code>buffer</code>, casting it to <code>int *</code>, then dereferencing the resulting pointer, which is undefined behavior.  In particular, there is no guarantee that <code>buffer</code> is aligned on an accept <code>int</code> boundary.  The behavior is undefined.  You should not attempt to run this code."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1462948302, "post_id": 37154654, "comment_id": 61846154, "body": "It doesn&#39;t <i>directly</i> take the address of <code>buffer[0]</code>. Instead the array <i>decays</i> to a pointer to its first element."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1462949573, "post_id": 37154654, "comment_id": 61846898, "body": "I cannot give upvote, until answer answer also explains why this code is broken and should not be used."}], "tags": [], "owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "is_accepted": false, "score": 1, "last_activity_date": 1462948183, "creation_date": 1462948183, "answer_id": 37154654, "question_id": 37154590, "link": "https://stackoverflow.com/questions/37154590/what-does-intbuffer-mean/37154654#37154654", "title": "What does *(int*)(buffer) mean?", "body": "<p>It takes the address of <code>buffer[0]</code>, casts it to an <code>int*</code>, dereferences that, and uses the dereferenced value to initialize <code>size</code>. In other words, it takes the first <code>sizeof(int)</code> bytes of <code>buffer</code>, pretends those bytes are an <code>int</code>, and stores that int's value in <code>size</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462950083, "post_id": 37154677, "comment_id": 61847211, "body": "@user694733, true, it could crash on some architectures due to a bad  memory alignment for a pointer to <code>int</code>"}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462953980, "post_id": 37154677, "comment_id": 61849606, "body": "@user694733 Thanks for your feedback, I&#39;ve tried to mention one reason that i know will result in undefined operation on some CPUs. The answer by Lundin goes in more detail about the issues with this code and i feel like i would be echoing what has already being said."}], "tags": [], "owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "is_accepted": false, "score": 14, "last_activity_date": 1462954182, "last_edit_date": 1495540894, "creation_date": 1462948250, "answer_id": 37154677, "question_id": 37154590, "link": "https://stackoverflow.com/questions/37154590/what-does-intbuffer-mean/37154677#37154677", "title": "What does *(int*)(buffer) mean?", "body": "<pre><code>char buffer[4096];//this is an array of 4096 characters\n// some code\n\nint size = *(int*)(buffer);\n</code></pre>\n\n<p>Will cast the(decayed) character pointer,which is <code>buffer</code>, to an integer pointer. It then dereferences it to get an <strong>integer value</strong>. The integer value you get from this will be composed of the first 4 character values of the <code>buffer</code> array assuming the size of <code>int</code> is 4 bytes in your machine, or in general will be composed of <code>sizeof(int)</code> characters.</p>\n\n<p>In other words, the memory representation of the first <code>sizeof(int)</code> characters of the <code>buffer</code> array will be treated as though they represent a single integer value,since now it is pointed to by an integer pointer, and that will be stored in the <code>size</code> integer variable when that integer pointer is dereferenced.</p>\n\n<p>That being said, as it has been stated repeatedly in the comments section, this code is unsafe. One thing that comes to mind is, some CPUs have a strict alignment requirements(see <a href=\"https://stackoverflow.com/questions/3025125/cpu-and-data-alignment\">this answer</a>), and in this case there is no guarantee that the address of the first element of the <code>buffer</code> array complies with the alignment requirement of an integer resulting in undefined operation in those CPUs. </p>\n\n<p>See @Lundin answer for even more reason why this code is unsafe and may not give you the result you were looking for.</p>\n"}, {"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462948387, "post_id": 37154698, "comment_id": 61846218, "body": "&quot;first takes the address of array <code>buffer</code>&quot; is wrong, getting the address of <code>buffer</code> would be <code>&amp;buffer</code>. Instead <code>buffer</code> <i>decays to a pointer</i> to its first element."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1462949569, "post_id": 37154698, "comment_id": 61846896, "body": "I cannot give upvote, until answer answer also explains why this code is broken and should not be used."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1462950686, "post_id": 37154698, "comment_id": 61847613, "body": "@user694733 Indeed, if only one answer clearly explained why this is ub."}], "tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 3, "last_activity_date": 1462948410, "last_edit_date": 1462948410, "creation_date": 1462948317, "answer_id": 37154698, "question_id": 37154590, "link": "https://stackoverflow.com/questions/37154590/what-does-intbuffer-mean/37154698#37154698", "title": "What does *(int*)(buffer) mean?", "body": "<blockquote>\n  <p>Can anyone help me understand what does the following statements do?</p>\n</blockquote>\n\n<p>The first statement :</p>\n\n<pre><code>char buffer[4096];\n</code></pre>\n\n<p>declares an array of <code>chars</code> with size <code>4096</code>.</p>\n\n<p>The second statement :</p>\n\n<pre><code>int size = *(int*)(buffer);\n</code></pre>\n\n<p><strong>1.</strong> First takes the decayed character pointer to the array <code>buffer</code> (also named <code>buffer</code>), which is a pointer pointing to its first element, set at the time of its declaration</p>\n\n<p><strong>2.</strong> Then casts it to pointer to <code>int</code>, or <code>int*</code></p>\n\n<p><strong>3.</strong> Finally, assigns the content of this pointer (which will be of type <code>int</code>) to variable <code>size</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 5, "creation_date": 1462949212, "post_id": 37154872, "comment_id": 61846678, "body": "I think your example code should not use pointer dereference trick at all. Using <code>memcpy</code> would still have possible endianness issue, but at least there would not be UB."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462954728, "post_id": 37154872, "comment_id": 61850107, "body": "How is code that still has the same undefined behavior less bad?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1462964324, "post_id": 37154872, "comment_id": 61856675, "body": "@2501 Because it doesn&#39;t have the mentioned type problems. Demonstrating how to fix that was the purpose of the code snippet. To fix the undefined behavior, you would need to do something far more drastical."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1462970021, "post_id": 37154872, "comment_id": 61860889, "body": "There&#39;s a problem with the proposed alternative: it imposes a constraint that is not present in the original code, namely, that the target hardware must provide an 8-bit native type and a 32-bit native type. That might be a valid change, but code samples that impose different requirements from the original code should point out those differences. <code>unsigned char</code> will always exist; <code>uint8_t</code> might not."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 7, "last_activity_date": 1462949176, "last_edit_date": 1462949176, "creation_date": 1462948836, "answer_id": 37154872, "question_id": 37154590, "link": "https://stackoverflow.com/questions/37154590/what-does-intbuffer-mean/37154872#37154872", "title": "What does *(int*)(buffer) mean?", "body": "<p>TL;DR: this code is bad, forget about it and move on.</p>\n\n<hr>\n\n<p><code>(buffer)</code> This parenthesis means that the programmer was insecure of their own programming abilities.  </p>\n\n<p>Since <code>buffer</code> is an array of characters, using the identifier <code>buffer</code> on its own gives you a pointer to the first element: a <code>char</code> pointer.</p>\n\n<p><code>(int*)</code> This is a cast, converting the <code>char</code> pointer to an <code>int</code> pointer.</p>\n\n<p><code>*</code> takes the contents of that integer pointer and the result is stored in the integer <code>size</code>.</p>\n\n<p>Please note that this code is completely unsafe. Many pointer conversions invoke poorly-defined behavior. There might be alignment issues. There might be pointer aliasing issues (Google \"strict aliasing rule\"). This particular code is also endianess-dependent, meaning that it requires that the contents of the character array has a given byte order.</p>\n\n<p>Overall, it does not make any sense to use signed types like <code>int</code> or  <code>char</code> (maybe signed) when doing things like this. In particular, the <code>char</code> type is very problematic since it has implementation-defined signedness and should be avoided. Use <code>unsigned char</code> or <code>uint8_t</code> instead.</p>\n\n<p>Slightly less bad code would look something like this:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nuint8_t buffer[4096];\n// some code\nuint32_t size = *(uint32_t*)buffer;\n</code></pre>\n"}], "owner": {"reputation": 472, "user_id": 1764409, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/35625d1a4aa32fc7b8876ed151a24f3b?s=128&d=identicon&r=PG", "display_name": "shaikh", "link": "https://stackoverflow.com/users/1764409/shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2797, "favorite_count": 1, "accepted_answer_id": 37154872, "answer_count": 4, "score": 6, "last_activity_date": 1462954182, "creation_date": 1462947987, "last_edit_date": 1462948274, "question_id": 37154590, "link": "https://stackoverflow.com/questions/37154590/what-does-intbuffer-mean", "title": "What does *(int*)(buffer) mean?", "body": "<p>In a c++ code I am reading, found the following.\nCan anyone help me understand what does the following statements do?</p>\n\n<pre><code>char buffer[4096];\n// some code\nint size = *(int*)(buffer);\n</code></pre>\n"}, {"tags": ["c", "gcc", "audio", "wav"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1462947896, "post_id": 37154257, "comment_id": 61845964, "body": "Why do you have function definitions in a h file? Your program design is a mess."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1462948336, "post_id": 37154257, "comment_id": 61846182, "body": "I would check endianness and size of integer types. You should switch to fixed size integers and not rely on <code>short</code>/<code>int</code>/<code>long</code> having a particular size."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1462948359, "post_id": 37154257, "comment_id": 61846200, "body": "I don&#39;t know your platform, but probably all your <code>long</code> variable have to be <code>int</code>. Best thing is to <code>#include &lt;stdint.h&gt;</code> and use its types:  <code>uint32_t</code>, <code>uint16_t</code> and so on"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1462948462, "post_id": 37154257, "comment_id": 61846252, "body": "<code>I really stack here</code> -  I heap you manage to solve your problems."}, {"owner": {"reputation": 4722, "user_id": 1170207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b71f9d5ae0b1574cbd07efb7ae926f8?s=128&d=identicon&r=PG", "display_name": "Jan Christoph Terasa", "link": "https://stackoverflow.com/users/1170207/jan-christoph-terasa"}, "edited": false, "score": 2, "creation_date": 1462949479, "post_id": 37154257, "comment_id": 61846829, "body": "32 bit PCM can be floating point (<code>float</code>) or integer (<code>int32_t</code>), but certainly not <code>double</code>."}, {"owner": {"reputation": 25, "user_id": 4077189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5fc7df4b36d293960ddfc3779c151f?s=128&d=identicon&r=PG&f=1", "display_name": "ya90net", "link": "https://stackoverflow.com/users/4077189/ya90net"}, "edited": false, "score": 0, "creation_date": 1463984262, "post_id": 37154257, "comment_id": 62277968, "body": "I could solve the problem. Your answers are quite helpfull. Thank you guys :)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4077189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5fc7df4b36d293960ddfc3779c151f?s=128&d=identicon&r=PG&f=1", "display_name": "ya90net", "link": "https://stackoverflow.com/users/4077189/ya90net"}, "edited": false, "score": 1, "creation_date": 1463984066, "post_id": 37155015, "comment_id": 62277888, "body": "Your answer is perfect. My program started to work well. I really apreciate. Thanks!"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 0, "last_activity_date": 1462949248, "creation_date": 1462949248, "answer_id": 37155015, "question_id": 37154257, "link": "https://stackoverflow.com/questions/37154257/read-and-write-32bit-wav-file-in-c/37155015#37155015", "title": "Read and write 32bit wav file in C", "body": "<p>I guess your platform has long with size 8 bytes.</p>\n\n<p>You can simply check it with:</p>\n\n<pre><code>printf(\"Long= %zu bytes - int= %zu bytes\\n\", sizeof(long), sizeof(int));\n</code></pre>\n\n<p>Then when you use, e.g</p>\n\n<pre><code>fread(&amp;riff_chunk_size, 4, 1, fp);\n</code></pre>\n\n<p>You are wrongly reading the value, due to the endianness.</p>\n\n<p>Switch all long types to <code>int</code> or better add</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n</code></pre>\n\n<p>and change your variable types to:</p>\n\n<ul>\n<li><code>long</code> -> <code>int32_t</code></li>\n<li><code>int</code> -> <code>int32_t</code></li>\n<li><code>short</code> -> <code>int16_t</code></li>\n</ul>\n"}], "owner": {"reputation": 25, "user_id": 4077189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5fc7df4b36d293960ddfc3779c151f?s=128&d=identicon&r=PG&f=1", "display_name": "ya90net", "link": "https://stackoverflow.com/users/4077189/ya90net"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1181, "favorite_count": 0, "accepted_answer_id": 37155015, "answer_count": 1, "score": 0, "last_activity_date": 1462951751, "creation_date": 1462946731, "last_edit_date": 1462951751, "question_id": 37154257, "link": "https://stackoverflow.com/questions/37154257/read-and-write-32bit-wav-file-in-c", "title": "Read and write 32bit wav file in C", "body": "<p>I'm making a small program to read &amp; write 32 bit wav file in C language.</p>\n\n<p>But, I got a problem.</p>\n\n<p>After compilation, Sometimes the program works well, yet sometimes, it doesn't work...like:</p>\n\n<ul>\n<li>output wav file is empty</li>\n<li>output wav file(1 sec) is too big, larger than 5GB...</li>\n</ul>\n\n<p>I really stack here...\nAnyone knows a solution??</p>\n\n<p>Below is my program </p>\n\n<p>\u2193 wave32.h \u2193 </p>\n\n<pre><code>typedef struct\n{\n  int fs; \n  int bits;\n  int length;\n  double *s; \n} MONO_PCM;\n\nvoid wave_read_32bit_mono(MONO_PCM *pcm, char *file_name)\n{\n  FILE *fp;\n  char riff_chunk_ID[4];\n  long riff_chunk_size;\n  char file_format_type[4];\n  char fmt_chunk_ID[4];\n  long fmt_chunk_size;\n  short wave_format_type;\n  short channel;\n  long samples_per_sec;\n  long bytes_per_sec;\n  short block_size;\n  short bits_per_sample;\n  char data_chunk_ID[4];\n  long data_chunk_size;\n  int data;\n  int n;\n\n  fp = fopen(file_name, \"rb\");\n\n  fread(riff_chunk_ID, 1, 4, fp);\n  fread(&amp;riff_chunk_size, 4, 1, fp);\n  fread(file_format_type, 1, 4, fp);\n  fread(fmt_chunk_ID, 1, 4, fp);\n  fread(&amp;fmt_chunk_size, 4, 1, fp);\n  fread(&amp;wave_format_type, 2, 1, fp);\n  fread(&amp;channel, 2, 1, fp);\n  fread(&amp;samples_per_sec, 4, 1, fp);\n  fread(&amp;bytes_per_sec, 4, 1, fp);\n  fread(&amp;block_size, 2, 1, fp);\n  fread(&amp;bits_per_sample, 2, 1, fp);\n  fread(data_chunk_ID, 1, 4, fp);\n  fread(&amp;data_chunk_size, 4, 1, fp);\n\n\n  pcm-&gt;fs = samples_per_sec;\n  pcm-&gt;bits = bits_per_sample;\n  pcm-&gt;length = data_chunk_size / 4;\n  pcm-&gt;s = calloc(pcm-&gt;length, sizeof(double));\n\n  for (n = 0; n &lt; pcm-&gt;length; n++)\n  {\n    fread(&amp;data, 4, 1, fp);\n    pcm-&gt;s[n] =  ( (double)data / 2147483648.0 ) ;\n  }\n\n  fclose(fp);\n}\nvoid wave_write_32bit_mono(MONO_PCM *pcm, char *file_name)\n{\n  FILE *fp;\n  char riff_chunk_ID[4];\n  long riff_chunk_size;\n  char file_format_type[4];\n  char fmt_chunk_ID[4];\n  long fmt_chunk_size;\n  short wave_format_type;\n  short channel;\n  long samples_per_sec;\n  long bytes_per_sec;\n  short block_size;\n  short bits_per_sample;\n  char data_chunk_ID[4];\n  long data_chunk_size;\n  double s;\n  int data;\n  int n;\n\n  riff_chunk_ID[0] = 'R';\n  riff_chunk_ID[1] = 'I';\n  riff_chunk_ID[2] = 'F';\n  riff_chunk_ID[3] = 'F';\n  riff_chunk_size = 36 + pcm-&gt;length * 2;\n  file_format_type[0] = 'W';\n  file_format_type[1] = 'A';\n  file_format_type[2] = 'V';\n  file_format_type[3] = 'E';\n\n  fmt_chunk_ID[0] = 'f';\n  fmt_chunk_ID[1] = 'm';\n  fmt_chunk_ID[2] = 't';\n  fmt_chunk_ID[3] = ' ';\n  fmt_chunk_size = 16;\n  wave_format_type = 1;\n  channel = 1;\n  samples_per_sec = pcm-&gt;fs;\n  bytes_per_sec = pcm-&gt;fs * pcm-&gt;bits / 8;\n  block_size = pcm-&gt;bits / 8;\n  bits_per_sample = pcm-&gt;bits;\n\n  data_chunk_ID[0] = 'd';\n  data_chunk_ID[1] = 'a';\n  data_chunk_ID[2] = 't';\n  data_chunk_ID[3] = 'a';\n  data_chunk_size = pcm-&gt;length * 4;\n\n  fp = fopen(file_name, \"wb\");\n\n  fwrite(riff_chunk_ID, 1, 4, fp);\n  fwrite(&amp;riff_chunk_size, 4, 1, fp);\n  fwrite(file_format_type, 1, 4, fp);\n  fwrite(fmt_chunk_ID, 1, 4, fp);\n  fwrite(&amp;fmt_chunk_size, 4, 1, fp);\n  fwrite(&amp;wave_format_type, 2, 1, fp);\n  fwrite(&amp;channel, 2, 1, fp);\n  fwrite(&amp;samples_per_sec, 4, 1, fp);\n  fwrite(&amp;bytes_per_sec, 4, 1, fp);\n  fwrite(&amp;block_size, 2, 1, fp);\n  fwrite(&amp;bits_per_sample, 2, 1, fp);\n  fwrite(data_chunk_ID, 1, 4, fp);\n  fwrite(&amp;data_chunk_size, 4, 1, fp);\n\n  for (n = 0; n &lt; pcm-&gt;length; n++)\n  {\n    s = (pcm-&gt;s[n]) * 2147483648.0;\n\n\n    if (s &gt; 2147483647.0)\n    {\n      s = 2147483647.0;\n    }\n    else if (s &lt; -2147483647.0)\n    {\n      s = -2147483647.0;\n    }\n\n    data = (int)(s + 0.5);\n    fwrite(&amp;data, 4, 1, fp);\n  }\n\n  fclose(fp);\n}\n</code></pre>\n\n<p>\u2193 wave32.c \u2193 </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;math.h&gt;\n#include \"wave32.h\"\n\nint main(void)\n{\n  MONO_PCM pcm0, pcm1;\n  int n;\n\n  wave_read_32bit_mono(&amp;pcm0, \"sine32.wav\"); // 1 sec sine wave \n\n  pcm1.fs = pcm0.fs;\n  pcm1.bits = pcm0.bits;\n  pcm1.length = pcm0.length;\n  pcm1.s = calloc(pcm1.length, sizeof(double));\n\n  for (n = 0; n &lt; pcm1.length; n++)\n  {\n\n    pcm1.s[n] = pcm0.s[n];\n\n  }\n\n  wave_write_32bit_mono(&amp;pcm1, \"b.wav\");\n\n  free(pcm0.s);\n  free(pcm1.s);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "named-pipes"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1462947039, "post_id": 37154227, "comment_id": 61845561, "body": "Can you please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us? Where in the program do you print the output? Have you check what <code>fread</code> (and also <code>fwrite</code>) actually returns?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1462947078, "post_id": 37154227, "comment_id": 61845573, "body": "Oh, and you know that pipes are <i>streaming</i>, meaning it might not give you all the data you ask for in one read call, you might have to read in a loop."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1462948730, "post_id": 37154227, "comment_id": 61846408, "body": "What&#39;s on the other end of the pipes?"}, {"owner": {"reputation": 159, "user_id": 4015519, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2bdb829d9ebd19da1659b99715b95b4c?s=128&d=identicon&r=PG&f=1", "display_name": "FatFockFrank", "link": "https://stackoverflow.com/users/4015519/fatfockfrank"}, "edited": false, "score": 0, "creation_date": 1462975711, "post_id": 37154227, "comment_id": 61865786, "body": "The InPipe is a tream of IP packets that are being read in. Where OutPipe is where I n.eed to write the IP packets that passed through my filter. I&#39;ve tried to read in a loop, then write it out 60 bytes at a time. But my problem is that it doesn&#39;t seem to call the write functions and just reads in all of the packets only."}], "answers": [{"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 0, "last_activity_date": 1462959514, "creation_date": 1462959514, "answer_id": 37158644, "question_id": 37154227, "link": "https://stackoverflow.com/questions/37154227/named-pipe-is-only-reading-and-not-writing/37158644#37158644", "title": "Named Pipe is only reading and not writing", "body": "<p>The read reads up to 1500 bytes of data, but you were only writing 60 bytes. You might want to fix this:</p>\n\n<pre><code>fwrite(buffer, 1, ret, OutPipe);\n</code></pre>\n\n<p>And the write will only happen with the filter checked returns true, so to help debug, I suggest add a log when the filter returns false:</p>\n\n<pre><code>if(FilterPacket(buffer, args)) {\n    fwrite(buffer, 1, ret, OutPipe);\n    fflush(OutPipe);\n} else {\n    fprintf(stderr, \"FilterPacket returned false for packet %s\\n\", buffer);\n}\n</code></pre>\n\n<p>Also, <code>buffer</code> is not released when the function returns, this will cause memory leak, add this to the end of the function:</p>\n\n<pre><code>free(buffer);\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 4015519, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2bdb829d9ebd19da1659b99715b95b4c?s=128&d=identicon&r=PG&f=1", "display_name": "FatFockFrank", "link": "https://stackoverflow.com/users/4015519/fatfockfrank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462959514, "creation_date": 1462946601, "question_id": 37154227, "link": "https://stackoverflow.com/questions/37154227/named-pipe-is-only-reading-and-not-writing", "title": "Named Pipe is only reading and not writing", "body": "<p>I have an InPipe meant for reading in binary data and an OutPipe meant for writing back the binary data that passes through my firewall. </p>\n\n<pre><code>/// The input named pipe, \"ToFirewall\"\nstatic FILE* InPipe = NULL;\n\n\n/// The output named pipe, \"FromFirewall\"\nstatic FILE* OutPipe = NULL;\n</code></pre>\n\n<p>I open both pipes in a separate function.</p>\n\n<pre><code>static bool OpenPipes(void)\n{\n    //ToFirewall\n    InPipe = fopen(\"ToFirewall\", \"rb\");\n    if(InPipe == NULL)\n    {\n       perror(\"ERROR, failed to open pipe ToFirewall:\");\n       return false;\n    }\n\n   OutPipe = fopen(\"FromFirewall\", \"wb\");\n   if(OutPipe == NULL)\n   {\n      perror(\"ERROR, failed to open pipe FromFirewall:\");\n\n           return false;\n       }\n\n   return true;\n}\n</code></pre>\n\n<p>For some reason as I read in data, it will skip over the write and doesn't bother to check if it passed through my firewall or not. I looked online and I read solutions about flushing, but it did not help. </p>\n\n<pre><code>static void* FilterThread(void* args) {\n    OpenPipes();\n\n    unsigned char* buffer = malloc(1500);\n\n    int ret = fread(buffer, 1, 1500, InPipe);\n    if(ret){\n        fclose(InPipe);\n    }\n\n\n    //Check is FilterPacket will allow the packet through the firewall\n    if(FilterPacket(buffer, args)) {\n        fwrite(buffer, 1, 60, OutPipe);\n        fflush(OutPipe);\n    }\n\n//        fflush(OutPipe);\n    fclose(OutPipe);\n\n    return NULL;\n}\n</code></pre>\n\n<p>Here is my output</p>\n\n<pre><code>RCVR: opened file output.bin\nSNDR: Waiting 200ms between packets\nSNDR: Number of packets: 18\nSNDR: Starting packet 0\nSNDR: Starting packet 1\nSNDR: Starting packet 2\nSNDR: Starting packet 3\nSNDR: Starting packet 4\nSNDR: Starting packet 5\nSNDR: Starting packet 6\nSNDR: Starting packet 7\nSNDR: Starting packet 8\nSNDR: Starting packet 9\nSNDR: Starting packet 10\nSNDR: Starting packet 11\nSNDR: Starting packet 12\nSNDR: Starting packet 13\nSNDR: Starting packet 14\nSNDR: Starting packet 15\nSNDR: Starting packet 16\nSNDR: Starting packet 17\nSNDR: Finished, wrote 18 packets to the pipe\n</code></pre>\n\n<p>And here you can see what the expected output should actually look like</p>\n\n<pre><code>&gt; RCVR: opened file output.bin\nSNDR: Waiting 200ms between packets\nSNDR: Number of packets: 18\nSNDR: Starting packet 0\nSNDR: Starting packet 1\nRCVR: 129.21.37.11 -&gt; 74.125.21.103\nSNDR: Starting packet 2\nRCVR: 74.125.21.103 -&gt; 129.21.37.11\nSNDR: Starting packet 3\nSNDR: Starting packet 4\nRCVR: 129.21.37.11 -&gt; 74.125.21.103\nSNDR: Starting packet 5\nSNDR: Starting packet 6\nRCVR: 74.125.21.103 -&gt; 129.21.37.11\nSNDR: Starting packet 7\nRCVR: 129.21.37.28 -&gt; 74.125.21.103\nSNDR: Starting packet 8\nSNDR: Starting packet 9\nRCVR: 129.21.37.11 -&gt; 74.125.21.103\nSNDR: Starting packet 10\nRCVR: 74.125.21.103 -&gt; 129.21.37.28\nSNDR: Starting packet 11\nSNDR: Starting packet 12\nRCVR: 74.125.21.103 -&gt; 129.21.37.11\nSNDR: Starting packet 13\nRCVR: 129.21.37.28 -&gt; 74.125.21.103\nSNDR: Starting packet 14\nSNDR: Starting packet 15\nSNDR: Starting packet 16\nRCVR: 129.21.37.11 -&gt; 74.125.21.103\nSNDR: Starting packet 17\nRCVR: 74.125.21.103 -&gt; 129.21.37.28\nSNDR: Finished, wrote 18 packets to the pipe\nFwSim, Commanding firewall to Exit\nRCVR: 74.125.21.103 -&gt; 129.21.37.11\nExiting\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 9, "creation_date": 1462945089, "post_id": 37153864, "comment_id": 61844712, "body": "It&#39;s the linker that actually finds it. And yes the path to find the standard libraries is predefined."}, {"owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1462945188, "post_id": 37153864, "comment_id": 61844765, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Could you please explain a little bit more? Thanks!"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1462945371, "post_id": 37153864, "comment_id": 61844851, "body": "<a href=\"http://stackoverflow.com/questions/23181905/standard-c-library-linking\">Here&#39;s some more info</a>"}, {"owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1462945840, "post_id": 37153864, "comment_id": 61845041, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6 Thanks for the link. However, that question seems partially answers my question. I&#39;m more interested in the path finding during link stage."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1462945910, "post_id": 37153864, "comment_id": 61845068, "body": "Compiling basically turns a .c (or .cpp) file into a .o file.  The .o files are combined, along with any needed library searches, to produce an executable.  If file <code>foo.c</code> defines a function <code>foo</code>, and <code>bar.c</code> defines a function <code>bar</code>, then <code>foo.o</code> and <code>bar.o</code> contain compiled versions of those functions.  It&#39;s only when the object files are linked that external references are resolved, and that&#39;s when libraries are searched.  The final executable should contain no unresolved references."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1462945952, "post_id": 37153864, "comment_id": 61845082, "body": "&quot;path finding during link stage&quot; It is different for different compilers, or for different versions of the same compiler. Why are you interested in it?"}, {"owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462946128, "post_id": 37153864, "comment_id": 61845148, "body": "@n.m. Trying to have a more clear picture about the compilation of a c program. I want to gain more insight on the background of using standard c library instead of always treating them as a black box."}, {"owner": {"reputation": 1531, "user_id": 4253427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fbfd7d486a5687d0ea82d1a5e9e2e?s=128&d=identicon&r=PG&f=1", "display_name": "zeromus", "link": "https://stackoverflow.com/users/4253427/zeromus"}, "edited": false, "score": 0, "creation_date": 1462946234, "post_id": 37153864, "comment_id": 61845206, "body": "You&#39;re supposed to view them as a black box. That&#39;s why it&#39;s so enigmatic and mystical and varying between compilers. I&#39;m sure you know, functions which arent in the standard library are following entirely different rules."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1462946372, "post_id": 37153864, "comment_id": 61845267, "body": "C or C++? Probably worth being straight on the language you use."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1462947497, "post_id": 37153864, "comment_id": 61845761, "body": "See <a href=\"http://stackoverflow.com/a/11481258/12711\">stackoverflow.com/a/11481258/12711</a> if you want to really know what&#39;s happening behind the scenes of where the compiler/linker are looking for headers and libraries (at least for gcc)."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 6318521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d880acde998693106d3d402efee31953?s=128&d=identicon&r=PG&f=1", "display_name": "user6318521", "link": "https://stackoverflow.com/users/6318521/user6318521"}, "is_accepted": true, "score": 8, "last_activity_date": 1462946639, "creation_date": 1462946639, "answer_id": 37154235, "question_id": 37153864, "link": "https://stackoverflow.com/questions/37153864/where-the-compiler-find-printf/37154235#37154235", "title": "Where the compiler find ``printf``?", "body": "<p>Chances are if you're on a linux system, the C library used is <code>glibc</code>. GCC doesn't actually provide a C library implementation, only the header files. It's the job of the C library to actually <em>implement</em> the definition of these functions. On Linux, there's something called \"shared libraries\" which are loaded dynamically by programs that need it. For example:</p>\n\n<pre><code>ldd /usr/bin/gcc\n    linux-vdso.so.1 (0x00007ffd9e9f8000)\n    libm.so.6 =&gt; /lib64/libm.so.6 (0x00007ff9a35a6000)\n    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007ff9a31de000)\n    /lib64/ld-linux-x86-64.so.2 (0x000055953c573000)\n</code></pre>\n\n<p>You can disable the linking of <code>libc</code> by passing <code>-nostdlib</code> and link in your own C library. There are also other ways to replace definitions provided by the C library, like linking in your own <code>malloc</code> and so on. The linker is only allowed to find <em>one</em> definition for any given declaration and since there is no name mangling in C, it's easy to do so.</p>\n\n<p><sup>This is an oversimplified explanation, and doesn't mention builtins, the math library or the like.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": false, "score": 2, "last_activity_date": 1462948414, "creation_date": 1462948414, "answer_id": 37154724, "question_id": 37153864, "link": "https://stackoverflow.com/questions/37153864/where-the-compiler-find-printf/37154724#37154724", "title": "Where the compiler find ``printf``?", "body": "<p><code>printf</code> is part of standard library, which is called \"standard\" because it is linked by default by C compiler. Standard library is typically provided by operating system or compiler. On most linux systems, it is located in <code>libc.so</code>, whereas on MS Windows C Library is provided by Visual C runtime file <code>msvcrt.dll</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "is_accepted": false, "score": 1, "last_activity_date": 1463047695, "last_edit_date": 1463047695, "creation_date": 1463047346, "answer_id": 37183594, "question_id": 37153864, "link": "https://stackoverflow.com/questions/37153864/where-the-compiler-find-printf/37183594#37183594", "title": "Where the compiler find ``printf``?", "body": "<p>After some digging, the following explanation makes the most sense to me: </p>\n\n<p><strong>short version</strong></p>\n\n<p>a           header           file           contains           declarations           that           the           compiler           needs,           but           not           implementations.                   The\ncorresponding          library          file          has          those.                The          compiler          needs          the          header          files          but          not          the          libraries;           the          linker\nneeds        the        libraries,        not        the        header        files.</p>\n\n<p><strong>long version</strong></p>\n\n<p>The header file does not contain the definition of the <code>printf()</code>\n function (i.e., its implementation.)  That is contained in the C Standard I/O Library (i.e., <code>glibc</code>). The compiler is not able to    create        the        machine        instructions        that\nwill       cause       the\n<code>printf()</code>\nfunction       to       run,        because       it       does       not       know       where         the\n<code>printf()</code>\nimplementation       is;\nit        cannot        create        a        call          to        this        function.            Instead,        the        compiler        places        a        notation        in        the        executable        file        that\nsays,        more        or        less,        the        call        to\n<code>printf()</code>\nmust        be        resolved        by        the        linker.</p>\n\n<p>The       linker       is       a       separate       program       that       runs       after       the       compiler.          It       looks       at       all       of       the       unresolved       symbols       in       the\nprogram,        such        as\n<code>printf()</code>\n,        and        tries        to        resolve        them        by        looking        up        their        locations        in        the        software        libraries\nthat       the       program       needs.          In       this       case,       the       linker       needs       to       look       up       in       the       C       Standard       I/O       Library       the       location\nof         the\n<code>printf()</code>\nfunction,         so         that         it         can         patch         the         code         to         make         a         call         to         it (<code>ldd /usr/bin/gcc</code> way or <code>gcc -v foo.c -Wl --verbose</code> way).             The         C         Standard         I/O         Library\nis         special         because         it         is         used         in         almost         every         C         program,         and         therefore         many         C         implementations         include         it\nwithin        the        C        runtime        library.           This        makes        it        possible        for        the        linker        to        find        it        easily</p>\n"}], "owner": {"reputation": 1733, "user_id": 1460102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e70df89ccf5e5509e4aae9ef4ed5b865?s=128&d=identicon&r=PG", "display_name": "xxks-kkk", "link": "https://stackoverflow.com/users/1460102/xxks-kkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1996, "favorite_count": 1, "accepted_answer_id": 37154235, "answer_count": 3, "score": 3, "last_activity_date": 1463047695, "creation_date": 1462945045, "last_edit_date": 1462945246, "question_id": 37153864, "link": "https://stackoverflow.com/questions/37153864/where-the-compiler-find-printf", "title": "Where the compiler find ``printf``?", "body": "<p>I haven't touched on c++ for a while and this question might be stupid but it indeed bothers me for a while.</p>\n\n<p>Suppose I have the following c program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  int i;\n  for(i=0; i&lt;10; i++)\n  {\n    printf(\"Hello World!\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>I know the reason I include <code>stdio.h</code> is because I call <code>printf</code> in <code>main</code> but I'm wondering how compiler would know where to find the implementation of <code>printf()</code> during the compilation? <code>stdio.h</code> only provides function prototype but what exactly is happening during the compilation? </p>\n\n<p>Will there be certain prefixed path that compiler knows to search for the implementation of <code>printf</code>? If so, how to find them?</p>\n\n<p>Thanks much!</p>\n"}, {"tags": ["c", "audio", "libwebsockets"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1462950841, "post_id": 37153774, "comment_id": 61847716, "body": "Can you compare the file you try to send with the file written on disk? I assume you&#39;re running this program on linux?"}, {"owner": {"reputation": 15, "user_id": 4629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6984b24a1f35c55de33692a0838166a5?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian Georgescu", "link": "https://stackoverflow.com/users/4629458/lucian-georgescu"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1462951070, "post_id": 37153774, "comment_id": 61847876, "body": "I send live audio from microphone. The client has a function to encode chunks as raw or wav. I&#39;m on Ubuntu."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1462952119, "post_id": 37153774, "comment_id": 61848490, "body": "Can you check that your wav file starts with something like <code>RIFF</code> , To do this you can type : <code>hexdump -C your_file.wav | head</code>"}, {"owner": {"reputation": 15, "user_id": 4629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6984b24a1f35c55de33692a0838166a5?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian Georgescu", "link": "https://stackoverflow.com/users/4629458/lucian-georgescu"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1462952834, "post_id": 37153774, "comment_id": 61848929, "body": "This is what i get: 00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|"}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 0, "last_activity_date": 1462954014, "creation_date": 1462954014, "answer_id": 37156585, "question_id": 37153774, "link": "https://stackoverflow.com/questions/37153774/save-audio-stream-in-file-using-c-libwebsockets/37156585#37156585", "title": "Save audio stream in file using C libwebsockets", "body": "<p>I think that you do not write header in your wav file. To do so, </p>\n\n<ul>\n<li>you can write some function to do so see <a href=\"http://soundfile.sapp.org/doc/WaveFormat/\" rel=\"nofollow\">specification here</a> </li>\n<li><p>or you can use a dedicaded library, like <a href=\"http://www.mega-nerd.com/libsndfile/\" rel=\"nofollow\">libsndfile</a>, which is not so complicated to use:</p>\n\n<pre><code>// instead of fopen, write something like\nSF_INFO info;\nSNDFILE * sf;\n\ninfo.samplerate = sample_rate;\ninfo.channels = 1;\ninfo.sections = 1;\ninfo.seekable = 0;\ninfo.frames = 0;\ninfo.format = SF_FORMAT_WAV | SF_FORMAT_PCM_16;\n\nsf = sf_open(filename, SFM_WRITE, &amp;info);\n</code></pre>\n\n<hr>\n\n<pre><code>// instead of fwrite, something like\nsf_write_short(sf, in, len / sizeof(short));\n</code></pre>\n\n<hr>\n\n<pre><code>// and instead of fclose\nsf_close(sf);\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 4629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6984b24a1f35c55de33692a0838166a5?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian Georgescu", "link": "https://stackoverflow.com/users/4629458/lucian-georgescu"}, "is_accepted": false, "score": 0, "last_activity_date": 1462959549, "last_edit_date": 1462959549, "creation_date": 1462955875, "answer_id": 37157237, "question_id": 37153774, "link": "https://stackoverflow.com/questions/37153774/save-audio-stream-in-file-using-c-libwebsockets/37157237#37157237", "title": "Save audio stream in file using C libwebsockets", "body": "<p>I didn't use libsndfile, but I change something on the client side. This is the current hexdump output:</p>\n\n<pre><code>00000000  52 49 46 46 20 60 00 00  57 41 56 45 66 6d 74 20  |RIFF `..WAVEfmt |\n00000010  10 00 00 00 01 00 02 00  44 ac 00 00 10 b1 02 00  |........D.......|\n00000020  04 00 10 00 64 61 74 61  00 60 00 00 00 00 00 00  |....data.`......|\n00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n00006020  00 00 00 00 00 00 00 00  00 00 00 00 52 49 46 46  |............RIFF|\n00006030  20 60 00 00 57 41 56 45  66 6d 74 20 10 00 00 00  | `..WAVEfmt ....|\n00006040  01 00 02 00 44 ac 00 00  10 b1 02 00 04 00 10 00  |....D...........|\n00006050  64 61 74 61 00 60 00 00  00 00 00 00 00 00 00 00  |data.`..........|\n00006060  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n0000c050  00 00 00 00 00 00 00 00  52 49 46 46 20 60 00 00  |........RIFF `..|\n0000c060  57 41 56 45 66 6d 74 20  10 00 00 00 01 00 02 00  |WAVEfmt ........|\n0000c070  44 ac 00 00 10 b1 02 00  04 00 10 00 64 61 74 61  |D...........data|\n0000c080  00 60 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.`..............|\n0000c090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n</code></pre>\n\n<p>It seems to be wav encoded, but i don't have a content.</p>\n"}], "owner": {"reputation": 15, "user_id": 4629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6984b24a1f35c55de33692a0838166a5?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian Georgescu", "link": "https://stackoverflow.com/users/4629458/lucian-georgescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 37156585, "answer_count": 2, "score": 1, "last_activity_date": 1462959549, "creation_date": 1462944585, "last_edit_date": 1462950549, "question_id": 37153774, "link": "https://stackoverflow.com/questions/37153774/save-audio-stream-in-file-using-c-libwebsockets", "title": "Save audio stream in file using C libwebsockets", "body": "<p>I have a C server that uses libwebsockets and I want to save a received audio stream in a file on disk.</p>\n\n<p>Here is my code snippet:</p>\n\n<pre><code>#define FILENAME        \"/home/ubuntu/Desktop/file.wav\"\nFILE *received_file;\n\nstruct lws_context *Audiocontext;\nstatic int callback_audio(\n        struct lws *wsi,\n        enum lws_callback_reasons reason,\n        void *user, void *in, size_t len)\n{\n    switch (reason) {\n        case LWS_CALLBACK_ESTABLISHED: \n        {\n            printf(\"client is connected\\n\");\n            received_file = fopen(FILENAME, \"w+\");\n            if (received_file == NULL)\n            {\n                printf(\"Failed to open file\\n\");\n                exit(EXIT_FAILURE);\n            }\n        }\n        break;\n        case LWS_CALLBACK_RECEIVE: {\n            if(strcmp((char*)in,\"EOS\")==0)\n            {\n                printf(\"End of stream!\\n\");\n                fclose(received_file);\n            }\n            else\n            {\n                fwrite(in, 1, len, received_file);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I got the message \"client is connected\" and also the file, but the content isn't ok, I cannot play it. I think there is a problem regarding the way I save the stream on file using <code>fwrite()</code>.</p>\n\n<p>The client is sending audio chunks encoded as wav, 16Khz, mono. Here is a snippet from client (it's a javascript client, the full code is here:<a href=\"http://kaljurand.github.io/dictate.js/\" rel=\"nofollow\">http://kaljurand.github.io/dictate.js/</a>).</p>\n\n<pre><code>if (recorder) {\n    recorder.stop();\n    config.onEvent(MSG_STOP, 'Stopped recording');\n    // Push the remaining audio to the server\n    recorder.export16kMono(function(blob) {\n        socketSend(blob);\n        socketSend(TAG_END_OF_SENTENCE);\n        recorder.clear();\n        }, 'export16kMono');\n    config.onEndOfSpeech();\n} else {\n    config.onError(ERR_AUDIO, \"Recorder undefined\");\n}\n</code></pre>\n\n<p>The client is working well, I use it for exactly the same task, but using a Java server. I would appreciate if someone could indicate me how to save these audio chunks in a valid file.</p>\n"}, {"tags": ["c", "arrays", "pointers", "struct", "ruby-c-extension"], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1462942449, "creation_date": 1462942449, "answer_id": 37153383, "question_id": 37153255, "link": "https://stackoverflow.com/questions/37153255/c-allocate-a-struct-within-a-function-using-the-struct-pointer-as-argument/37153383#37153383", "title": "C - Allocate a struct within a function using the struct pointer as argument", "body": "<p>Given the definition <code>void createMatrix(VALUE xxx, Matrix *mat)</code> and the use of <code>mat-&gt;nrows = \u2026</code> etc inside the function, the calls to <code>createMatrix()</code> in <code>matmul_mul()</code> are wrong.</p>\n\n<p>You have:</p>\n\n<pre><code>VALUE matmat_mul(VALUE self, VALUE matrixA, VALUE matrixB)\n{\n    int i,j;\n\n    Matrix *matA;\n    createMatrix(matrixA, matA);\n\n    Matrix *matB;\n    createMatrix(matrixB, matB);\n</code></pre>\n\n<p>You need:</p>\n\n<pre><code>VALUE matmat_mul(VALUE self, VALUE matrixA, VALUE matrixB)\n{\n    int i,j;\n\n    Matrix matA;\n    createMatrix(matrixA, &amp;matA);\n\n    Matrix matB;\n    createMatrix(matrixB, &amp;matB);\n</code></pre>\n\n<p>In the current code, you pass uninitialized pointers to <code>createMatrix()</code> and then assign to the 'random' memory that the pointers point at.  This seldom leads to happiness.  In the revised code, you have a pair of <code>Matrix</code> values and you pass the pointers to those to the <code>createMatrix()</code> function, which then fills in the details for you.</p>\n"}], "owner": {"reputation": 954, "user_id": 3259651, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/xrrkE.jpg?s=128&g=1", "display_name": "Rojj", "link": "https://stackoverflow.com/users/3259651/rojj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37153383, "answer_count": 1, "score": 1, "last_activity_date": 1462942449, "creation_date": 1462941672, "question_id": 37153255, "link": "https://stackoverflow.com/questions/37153255/c-allocate-a-struct-within-a-function-using-the-struct-pointer-as-argument", "title": "C - Allocate a struct within a function using the struct pointer as argument", "body": "<p>I am working with the Ruby C API. I need to create a struct from within a function but I think I am making some allocation error. This is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ruby.h&gt;\n#include &lt;ruby/thread.h&gt;\n\ntypedef struct {\n    double *matrix;\n    int nrows;\n    int ncols;\n}Matrix;\n\n\nvoid createMatrix(VALUE matrix, Matrix *mat) {\n    printf(\"In\\n\");\n    mat-&gt;nrows = RARRAY_LEN(matrix);\n    VALUE firstElement = rb_ary_entry(matrix, 0);\n    mat-&gt;ncols = RARRAY_LEN(firstElement);\n    printf(\"Matrix shape: (%d,%d)\\n\", mat-&gt;nrows, mat-&gt;ncols);\n    int i,j;\n\n    double *tempMat = (double *)malloc(mat-&gt;nrows * mat-&gt;ncols * sizeof(double));\n\n    printf(\"Allocated\\n\");\n    VALUE row;\n    for (i=0; i&lt;mat-&gt;nrows; i++)\n    {\n        row = rb_ary_entry(matrix, i);\n        for (j=0; j&lt;mat-&gt;ncols; j++)\n        {\n            tempMat[i * mat-&gt;ncols + j] = NUM2DBL(rb_ary_entry(row, j));\n//          printf(\"Matrix A Element(%d,%d)=%f\\n\", i, j, matA[i * colsA + j]);\n        }\n    }\n    mat-&gt;matrix = tempMat;\n    for (i=0; i&lt;mat-&gt;nrows; i++)\n        {\n            for (j=0; j&lt;mat-&gt;ncols; j++)\n            {\n                printf(\"Matrix temp Element(%d,%d)=%f\\n\", i, j, mat-&gt;matrix[i * mat-&gt;ncols + j]);\n            }\n        }\n\n    printf(\"Assigned\\n\");\n    return;\n}\n\n\nVALUE matmat_mul(VALUE self, VALUE matrixA, VALUE matrixB)\n{\n    int i,j;\n\n    Matrix *matA;\n    createMatrix(matrixA, matA);\n\n    Matrix *matB;\n    createMatrix(matrixB, matB);\n\n    return Qnil;\n}\n\nvoid Init_la_ruby_ext()\n{\n    VALUE rg = rb_define_module(\"RG\");\n    VALUE linalg = rb_define_module_under(rg, \"LinearAlgebra\");\n    VALUE operation = rb_define_class_under(linalg, \"Operation\", rb_cObject);\n    rb_define_method(operation, \"matmat_mul\", matmat_mul, 2);\n}\n</code></pre>\n\n<p>The <code>extconf.rb</code> file is</p>\n\n<pre><code>require 'mkmf'\nextension_name = 'la_ruby_ext'\ncreate_makefile(extension_name)\n</code></pre>\n\n<p>and you can run the test with </p>\n\n<pre><code>require './la_ruby_ext'\nrows = 3\ncols = 3\nmat = Array.new(rows){Array.new(cols)}\nmat[0] = [0.0, 1.0, 2.0]\nmat[1] = [3.0, 4.0, 5.0]\nmat[2] = [6.0, 7.0, 8.0]\noperation = RG::LinearAlgebra::Operation.new \nmatC = operation.matmat_mul(mat, mat.transpose)\n</code></pre>\n\n<p>As you can see from running the test the code gives segmentation fault the second time I call the function <code>createMatrix</code>. This is my understanding:</p>\n\n<ol>\n<li>I first create a pointer to a <code>struct Matrix</code></li>\n<li>I then pass this pointer as argument to <code>createMatrix</code></li>\n<li>I allocate a pointer to a 2D array</li>\n<li>Create the 2D array</li>\n<li>I assign the pointer to matrix-> nmatrix</li>\n</ol>\n\n<p>Any idea? Is this the right way to do this?</p>\n"}, {"tags": ["c", "sorting", "structure"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1462942550, "post_id": 37153244, "comment_id": 61843833, "body": "<code>while(swapped)</code> is the same as <code>while(0)</code> since you initialize <code>swapped</code> to 0, and never change it."}, {"owner": {"reputation": 21, "user_id": 6318130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zimN9.jpg?s=128&g=1", "display_name": "Trevor C", "link": "https://stackoverflow.com/users/6318130/trevor-c"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1462943085, "post_id": 37153244, "comment_id": 61843992, "body": "Thanks that helped and also I just had lname instead of fname."}], "owner": {"reputation": 21, "user_id": 6318130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zimN9.jpg?s=128&g=1", "display_name": "Trevor C", "link": "https://stackoverflow.com/users/6318130/trevor-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "closed_date": 1462950120, "answer_count": 0, "score": 2, "last_activity_date": 1462941562, "creation_date": 1462941562, "question_id": 37153244, "link": "https://stackoverflow.com/questions/37153244/bubble-sort-a-linked-list-structure-of-strings-ints-and-floats-in-c", "closed_reason": "Not suitable for this site", "title": "Bubble sort a linked list Structure of Strings, Ints and Floats in C", "body": "<p>I am having trouble with the bubble sorting of my linked list, I populate the linked list by reading from a file (I can include this function and file as well if necessary) I am not receiving any compiler errors; however, when I run the program the linked list is not sorting itself at all. Using debug statements I found that the program will enter into the swap function but it is not rearranging the values of the structure parts. Does anyone have any solutions to this? I have included my code for defining the structure and the code of the bubble sort and swap function where the problem arises.</p>\n\n<pre><code> struct character {  /*define character_t structure*/\n      char fname[STRSZ];\n      char lname[STRSZ];\n      int seas;\n      char state;\n      float height;\n      struct character *next;\n    };\n    typedef struct character character_t;\n\n\n\n    void bubbleSort(character_t *start){\n      int swapped,i;\n      character_t *ptr1;\n      character_t *lptr = NULL;\n\n     do{\n       swapped=0;\n       ptr1=start;\n\n       while(ptr1-&gt;next!=lptr)\n       {\n         if(strcmp(ptr1-&gt;fname,ptr1-&gt;next-&gt;fname)&gt;0)\n         {\n           swap(ptr1,ptr1-&gt;next);\n         }\n         ptr1=ptr1-&gt;next;\n       }\n       lptr=ptr1;\n     }\n     while(swapped);\n    }\n\n    void swap(struct character *a,struct character *b){\n      char tfname[898]=\" \";\n      char tlname[898]= \" \";\n      int tseas;\n      char tstate;\n      float theight;\n\n      strcpy(tfname,a-&gt;fname);\n      strcpy(a-&gt;fname,b-&gt;name);\n      strcpy(b-&gt;fname,tfname);\n\n      strcpy(tfname,a-&gt;fname);\n      strcpy(a-&gt;fname,b-&gt;fname);\n      strcpy(b-&gt;fname,tfname);\n\n      tseas=a-&gt;seas;\n      a-&gt;seas=b-&gt;seas;\n      b-&gt;seas=tseas;\n\n      tstate=a-&gt;state;\n      a-&gt;state=b-&gt;state;\n      b-&gt;state=tstate;\n\n      theight=a-&gt;height;\n      a-&gt;height=b-&gt;height;\n      b-&gt;height=theight;\n    }\n</code></pre>\n"}, {"tags": ["c", "double", "format-specifiers", "long-double", "length-modifiers"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1462937623, "post_id": 37152565, "comment_id": 61842613, "body": "What compiler &amp; runtime/libc are you using?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1462938451, "post_id": 37152565, "comment_id": 61842803, "body": "Try <code>longDoubleNumber = (long double)2.0&#47;3.0;</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1462938638, "post_id": 37152565, "comment_id": 61842847, "body": "@sjsam, the lack of a cast in the original code may be intentional.  In any event, it does not explain the output presented."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1462938789, "post_id": 37152565, "comment_id": 61842884, "body": "The 30-digit variation should use <code>%1.30Lg</code> or <code>%1.30Lf</code>, not <code>%1.30f</code>.  But I doubt that fix will get you the output you expect, since the other <code>long double</code> outputs are also incorrect.  It looks to me as if your compiler or C library is buggy / non-conforming."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1462945726, "post_id": 37152565, "comment_id": 61844988, "body": "@JohnBollinger: Or it could be a compiler / library mismatch. Eg. on Windows, msvcrt assumes that long double == double."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1536468547, "post_id": 37152565, "comment_id": 91431395, "body": "<a href=\"https://stackoverflow.com/q/940087/995714\"><code>sizeof</code> return a size_t which must be printed using <code>%zu</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1462985306, "post_id": 37157062, "comment_id": 61872489, "body": "Although these changes are <i>reasonable</i>, it&#39;s not clear that all of them are appropriate for the the specific demonstrative purposes of the program.  More importantly, however, it is unclear why you think these would resolve the specific output problems noted by the OP.  Even the last suggested change -- which is, indeed, necessary -- seems unlikely to cause correct output to be produced given the nature of the earlier incorrect outputs."}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463037400, "post_id": 37157062, "comment_id": 61893251, "body": "@JohnBollinger, I didn&#39;t say that they will, I said that they &quot;should&quot;. I can agree however, that word &quot;might&quot; is more appropriate. The purpose of the changes is to negate possible side effects from type conversions. Once one can say that there are none, and if the problem persists in the same way, then we can go forward. That&#39;s the most reasonable approach that I see atm."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463061730, "post_id": 37157062, "comment_id": 61911080, "body": "Even &quot;might&quot; is unreasonably optimistic.  There is <b>no</b> reason to expect that the suggested changes would solve the OP&#39;s main problems."}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463062388, "post_id": 37157062, "comment_id": 61911633, "body": "@JohnBollinger, fine, have it your way."}], "tags": [], "owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "is_accepted": false, "score": 0, "last_activity_date": 1463062370, "last_edit_date": 1463062370, "creation_date": 1462955418, "answer_id": 37157062, "question_id": 37152565, "link": "https://stackoverflow.com/questions/37152565/format-specifier-lf-for-long-double-in-c-is-not-working-as-if-expected/37157062#37157062", "title": "Format specifier %Lf for long double in C is not working as if expected", "body": "<p>I suggest you make a couple of corrections and then re-run your tests.\nFirst, we need to assure that all types are correct and no promotions, or other things are involved. We need to change</p>\n\n<pre><code>floatNumber = 2.0/3.0;\nlongDoubleNumber = 2.0/3.0;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>floatNumber = 2.0f / 3.0f;\nlongDoubleNumber = 2.0L / 3.0L;\n</code></pre>\n\n<p>This is required to disallow promotions of the result to double (in the first case and type conversion from double to long double in second), because orginally both your operands were of type \"double\" in each case.</p>\n\n<p>Secondly, you should get rid of undefined behaviour in</p>\n\n<pre><code>printf(\"longDoubleNumber = %1.30g\\n\", longDoubleNumber);\n</code></pre>\n\n<p>and use a proper long double length specifier in format string. It will look like this:</p>\n\n<pre><code>printf(\"longDoubleNumber = %1.30Lg\\n\", longDoubleNumber);\n</code></pre>\n\n<p>Notify us of the results.</p>\n"}], "owner": {"reputation": 9, "user_id": 3906204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HpGJv.jpg?s=128&g=1", "display_name": "prasanth_ntu", "link": "https://stackoverflow.com/users/3906204/prasanth-ntu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2059, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507384613, "creation_date": 1462936861, "last_edit_date": 1507384613, "question_id": 37152565, "link": "https://stackoverflow.com/questions/37152565/format-specifier-lf-for-long-double-in-c-is-not-working-as-if-expected", "title": "Format specifier %Lf for long double in C is not working as if expected", "body": "<p>While studying the C essentials from online video, the author shared the code below to find the difference between float, double and long double.\nI ran this program in Eclispse running in 64 bit Windows 10 Laptop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\nputs(\"Floating point type usage in C:\");\n\n// Floating point types\nfloat           floatNumber;\ndouble          doubleNumber;\nlong double     longDoubleNumber;\n\n// Size of floating point types\n//lu - Stands for \"unsigned decimal integer\" and \"long\"\nprintf(\"Storage size for unsigned float : %lu  bytes \\n\", sizeof(float));\nprintf(\"Storage size for double :         %lu  bytes \\n\", sizeof(double));\nprintf(\"Storage size for long double :   %lu  bytes \\n\", sizeof(long double));\n\nfloatNumber = 2.0/3.0;\ndoubleNumber = 2.0/3.0;\nlongDoubleNumber = 2.0/3.0;\n\nputs(\"\\nCompare precision at 4 decimal points:\");\nprintf(\"floatNumber      = %1.4f\\n\", floatNumber);\nprintf(\"doubleNumber     = %1.4lf\\n\", doubleNumber);\nprintf(\"longDoubleNumber = %1.4Lf\\n\", longDoubleNumber);\n\nputs(\"\\nCompare precision at 10 decimal points:\");\nprintf(\"floatNumber      = %1.10f\\n\", floatNumber);\nprintf(\"doubleNumber     = %1.10lf\\n\", doubleNumber);\nprintf(\"longDoubleNumber = %1.10Lf\\n\", longDoubleNumber);\n\nputs(\"\\nCompare precision at 30 decimal points:\");\nprintf(\"floatNumber      = %1.30f\\n\", floatNumber);\nprintf(\"doubleNumber     = %1.30lf\\n\", doubleNumber);\nprintf(\"longDoubleNumber = %1.30g\\n\", longDoubleNumber);\nreturn 0;\n}\n</code></pre>\n\n<p>Somehow,I am not getting the expected output.\nI have added the output that i had got in my Eclispse console.\nCould anyone help me to figure out what went wrong</p>\n\n<pre><code>Floating point type usage in C:\nStorage size for unsigned float : 4  bytes \nStorage size for double :         8  bytes \nStorage size for long double :   16  bytes \n\nCompare precision at 4 decimal points:\nfloatNumber      = 0.6667\ndoubleNumber     = 0.6667\nlongDoubleNumber = 0.0000              //Expected value = 0.6667\n\nCompare precision at 10 decimal points:\nfloatNumber      = 0.6666666865\ndoubleNumber     = 0.6666666667\nlongDoubleNumber = 0.0000000000   //Expected value = 0.6666666667\n\nCompare precision at 30 decimal points:\nfloatNumber      = 0.666666686534881590000000000000 \ndoubleNumber     = 0.666666666666666630000000000000\nlongDoubleNumber = 3.1728895775924853e-317   //This is not the expected value\n</code></pre>\n"}]