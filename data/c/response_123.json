[{"tags": ["c", "ruby", "arduino", "microcontroller"], "comments": [{"owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "edited": false, "score": 1, "creation_date": 1495065493, "post_id": 44036405, "comment_id": 75099665, "body": "<a href=\"https://playground.arduino.cc/Interfacing/Ruby\" rel=\"nofollow noreferrer\">playground.arduino.cc/Interfacing/Ruby</a>"}, {"owner": {"reputation": 587, "user_id": 1473641, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e1f431cce8a104400fc6ef5f3da497a?s=128&d=identicon&r=PG", "display_name": "Prox", "link": "https://stackoverflow.com/users/1473641/prox"}, "reply_to_user": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "edited": false, "score": 0, "creation_date": 1495074280, "post_id": 44036405, "comment_id": 75101652, "body": "Thank you.  I got this working quickly for my Arduino Uno."}], "answers": [{"tags": [], "owner": {"reputation": 830, "user_id": 7059512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a00007e9f887b4547f8f29b921e612b2?s=128&d=identicon&r=PG&f=1", "display_name": "per1234", "link": "https://stackoverflow.com/users/7059512/per1234"}, "is_accepted": false, "score": 1, "last_activity_date": 1495073080, "creation_date": 1495073080, "answer_id": 44037415, "question_id": 44036405, "link": "https://stackoverflow.com/questions/44036405/how-to-control-arduino-board-or-stand-alone-avr-using-serial/44037415#44037415", "title": "How to control Arduino board or stand alone AVR using serial?", "body": "<p>You will need to flash the AVR with a program that interprets commands coming over serial from your Ruby program and takes the desired action.</p>\n\n<p>One option is the Firmata protocol. There is a Firmata Arduino library:</p>\n\n<p><a href=\"https://github.com/firmata/arduino\" rel=\"nofollow noreferrer\">https://github.com/firmata/arduino</a></p>\n\n<p>Some Firmata client libraries for Ruby are listed at that <a href=\"https://github.com/firmata/arduino#firmata-client-libraries\" rel=\"nofollow noreferrer\">link</a>. I haven't used it but that seems like a fast way to achieve your goal, though you may have more fun designing your own command protocol and writing the microcontroller firmware from scratch.</p>\n"}], "owner": {"reputation": 587, "user_id": 1473641, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e1f431cce8a104400fc6ef5f3da497a?s=128&d=identicon&r=PG", "display_name": "Prox", "link": "https://stackoverflow.com/users/1473641/prox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495073080, "creation_date": 1495064659, "question_id": 44036405, "link": "https://stackoverflow.com/questions/44036405/how-to-control-arduino-board-or-stand-alone-avr-using-serial", "title": "How to control Arduino board or stand alone AVR using serial?", "body": "<p>I know how to program an AVR using a programmer.  I am now wanting to learn Ruby and I thought it might be fun interacting with an Arduino or just an Attiny85 directly from the serial port.  </p>\n\n<p>I am kind of new to this stuff.  Is there a way to control LEDs, servos and other components without burning a program directly to the AVR chip? </p>\n\n<p>Would it make sense to write a Ruby program that connects to the AVR or Arduino through a serial connection and controls components?  I didn't know if this was possible.  Any ideas on how this can be done?  I see that there is a serial port gem for Ruby.  Would this be a good starting point?</p>\n\n<p>I didn't know if this would be a good idea with Ruby.</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1495416417, "post_id": 44036358, "comment_id": 75226931, "body": "Problem solved?"}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "reply_to_user": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1500872433, "post_id": 44036358, "comment_id": 77508494, "body": "@RicardoBranco really sorry for the delay"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "edited": false, "score": 0, "creation_date": 1500872635, "post_id": 44038511, "comment_id": 77508558, "body": "Great greate answer. It works without <code>#define _GNU_SOURCE 1</code> for me. go version number is 1.8, and os is macOS el capitan."}], "tags": [], "owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "is_accepted": true, "score": 1, "last_activity_date": 1495081517, "last_edit_date": 1495081517, "creation_date": 1495081124, "answer_id": 44038511, "question_id": 44036358, "link": "https://stackoverflow.com/questions/44036358/cannot-access-c-variables-in-cgo/44038511#44038511", "title": "Cannot access c variables in cgo", "body": "<p>#define's are problematic with CGo. I could get it to work with Go 1.8.1 on Linux amd64 like this:</p>\n\n<pre><code>package main\n\nimport \"os\"\n\n/*\n#define _GNU_SOURCE 1\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;utmpx.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nchar *path_utmpx = UTMPX_FILE;\n\ntypedef struct utmpx utmpx;\n*/\nimport \"C\"\n\ntype record C.utmpx\n\nfunc main() {\n    path := C.GoString(C.path_utmpx)\n    fd, err := os.Open(path)\n    if err != nil {\n        panic(\"bad\")\n    }\n    fd.Close()\n}\n</code></pre>\n\n<ol>\n<li>I had to define _GNU_SOURCE to get the UTMPX_FILE definition.</li>\n<li>I had to create the path_utmpx variable to get around the #define problems with CGo.</li>\n<li>I had to do the typedef to get <code>type record C.utmpx</code> compile.</li>\n<li>With Go, you can't use C strings directly.  You must convert them to Go strings.  Similarly, if you want to call C functions with Go strings, you must convert them to C strings (and free the space allocated in the heap).  </li>\n</ol>\n\n<p>A few pointers:</p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/c-go-cgo\" rel=\"nofollow noreferrer\">https://blog.golang.org/c-go-cgo</a></li>\n<li><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/cgo/</a></li>\n</ul>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 44038511, "answer_count": 1, "score": 0, "last_activity_date": 1495084379, "creation_date": 1495064326, "last_edit_date": 1495084379, "question_id": 44036358, "link": "https://stackoverflow.com/questions/44036358/cannot-access-c-variables-in-cgo", "title": "Cannot access c variables in cgo", "body": "<p>I'm trying to access a c struct in cgo, but go this </p>\n\n<blockquote>\n  <p>could not determine kind of name for C.utmpx</p>\n</blockquote>\n\n<p>utmpx is a c struct </p>\n\n<p>here is the go code:</p>\n\n<pre><code>/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;utmpx.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n*/\nimport \"C\"\n\ntype record C.utmpx\n\nfd, err := os.Open(C._PATH_UTMPX) // this works\nfd, err := os.Open(C.UTMPX_FILE)  // error\n</code></pre>\n\n<p>In the utmpx.h file , there is </p>\n\n<pre><code> #define    _PATH_UTMPX     \"/var/run/utmpx\"\n #define    UTMPX_FILE  _PATH_UTMPX\n</code></pre>\n\n<p>I can use _PATH_UTMPX but get the same warn when using UTMPX_FILE, why?</p>\n\n<p>It seems that I cannot access these variables declared in .h file\nHow can i do this ?</p>\n\n<p>platform: macOS sirria,go 1.8</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1495063726, "post_id": 44036260, "comment_id": 75099214, "body": "Show how the array is declared."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1495063814, "post_id": 44036260, "comment_id": 75099238, "body": "I&#39;m sure <code>&#39;n&#39;</code> is being passed for a very good reason. Is it the number of words, or the total length of all characters combined?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1495063929, "post_id": 44036260, "comment_id": 75099264, "body": "<code>strlen</code> can be used to tell you how much to advance the destination pointer in each iteration."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1495063948, "post_id": 44036260, "comment_id": 75099273, "body": "lauren, please provide a Minimum, Complete and Verifiable Example (see: <a href=\"http://stackoverflow.com/help/mcve\"><b>How to create a Minimal, Complete, and Verifiable example</b></a>). Providing the necessary details, including your code, and associated errors, if any, will allow everyone here to help you with your question."}, {"owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495064114, "post_id": 44036260, "comment_id": 75099311, "body": "i should declare the array by myself ! i can cal the function like this for example : char ss*=connect(words,7)"}, {"owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495064166, "post_id": 44036260, "comment_id": 75099327, "body": "i am trieng to say that i would declare a local words array that includes the n strings i want to connect"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1495064218, "post_id": 44036260, "comment_id": 75099341, "body": "It is necessary to prepare the area after joining. Is there room in the first word?"}, {"owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495064242, "post_id": 44036260, "comment_id": 75099349, "body": "also i can&#39;t change the giving array that i declared !! i can do it but i will have to loop on every string to find it&#39;s lengh but i can use one loop :\\"}, {"owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495064321, "post_id": 44036260, "comment_id": 75099365, "body": "n is the number of strings in the array"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1495064581, "post_id": 44036260, "comment_id": 75099416, "body": "Ok, the issue with the array is that a <i>pointer to pointer to char</i> is NOT an array. Depending on how the array is declared it may or may not be reallocated. Next, what storage are you going to use to return the concatenated words in? Unless you dynamically allocate in <code>connect</code>, you must pass a pointer to a block of memory to hold the result as a parameter. That, as a starter, is why a MCVE will help us help you."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1495099546, "last_edit_date": 1495099546, "creation_date": 1495064324, "answer_id": 44036357, "question_id": 44036260, "link": "https://stackoverflow.com/questions/44036260/how-to-connect-link-words-in-an-string-array-using-one-loop/44036357#44036357", "title": "how to connect/link words in an string array using one loop?", "body": "<p>If to use only the two mentioned standard string functions then the function can look as it is shown in the demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar * connect( char **words, size_t n )\n{\n    size_t length = 0;\n\n    for ( size_t i = 0; i &lt; n; i++ ) length += strlen( words[i] );\n\n    char *s = malloc( length + 1 );\n\n    size_t pos = 0;\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        strcpy( s + pos, words[i] );\n        pos += strlen( words[i] );\n    }        \n\n    s[pos] = '\\0';\n\n    return s;\n}\n\nint main( void )\n{\n    char * s[] = { \"Hello\", \" \", \"World\" };\n\n    char *p = connect( s, sizeof( s ) / sizeof( *s ) );\n\n    puts( p );\n\n    free( p );\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>Hello World\n</code></pre>\n\n<p>If to use only one loop then the function can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar * connect( char **words, size_t n )\n{\n    char *s = calloc( 1, sizeof( char ) );\n\n    if ( s != NULL )\n    {        \n        size_t pos = 0;\n\n        for ( size_t i = 0; s != NULL &amp;&amp; i &lt; n; i++ )\n        {\n            size_t length = strlen( words[i] );\n            char *tmp = realloc( s, pos + length + 1 );\n\n            if ( tmp != NULL )\n            {   \n                s = tmp;\n                strcpy( s + pos, words[i] );\n                pos += length;\n            }\n            else\n            {\n                free( s );\n                s = NULL;\n            }                \n        }        \n    }\n\n    return s;\n}\n\nint main( void )\n{\n    char * s[] = { \"Hello\", \" \", \"World\" };\n\n    char *p = connect( s, sizeof( s ) / sizeof( *s ) );\n\n    if ( p != NULL ) puts( p );\n\n    free( p );\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 1, "creation_date": 1495068781, "post_id": 44036845, "comment_id": 75100464, "body": "thank you so much but as i saied i am looking for a solution using only one loop !!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495071044, "post_id": 44036845, "comment_id": 75100936, "body": "OK, I&#39;ll add a <code>realloc</code> example."}, {"owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495077955, "post_id": 44036845, "comment_id": 75102493, "body": "the time line ended ! no need any more for you to help me .. thanks anyway"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "edited": false, "score": 0, "creation_date": 1495080860, "post_id": 44036845, "comment_id": 75103220, "body": "Hopefully you found the single loop addition before then. Good luck with your coding."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1495072322, "last_edit_date": 1495072322, "creation_date": 1495068133, "answer_id": 44036845, "question_id": 44036260, "link": "https://stackoverflow.com/questions/44036260/how-to-connect-link-words-in-an-string-array-using-one-loop/44036845#44036845", "title": "how to connect/link words in an string array using one loop?", "body": "<p>In addition to using <code>strcpy</code>, you can also use <code>sprintf</code>. Each of the functions in the <code>printf</code> family returns the number of characters actually output allowing you to compute an offset in your final string without an additional function call. Now, there is nothing wrong with using a <code>strcpy/strlen</code> approach, and in fact, that is probably the preferred approach, but be aware that there are always multiple ways of doing things within the parameters you have given. Also note that the <code>printf</code> family offers a wealth of formatting benefits in the event you would need to include additional information along with the concatenation of strings.</p>\n\n<p>For example, using <code>sprintf</code> to concatenate each string while saving the number of characters in each <code>nc</code> as the offset for writing the next string to the resulting buffer <code>buf</code>, while using a <em>ternary</em> operator to control the addition of a <code>space</code> between the words based on your loop counter, you could do something similar to the following:</p>\n\n<pre><code>char *compress (char **p, int n)\n{\n    char *buf = NULL;     /* buffer to hold concatendated string */\n    size_t total = 0;     /* total number of characters required */\n    int nc = 0;           /* number of chars added (counter)     */\n\n    for (int i = 0; i &lt; n; i++)     /* get total required length */\n        total += strlen (p[i]) + 1; /* including spaces between  */\n\n    if (!(buf = malloc (total + 1)))    /* allocate/validate mem */\n        return buf;                     /* return NULL on error  */\n\n    for (int i = 0; i &lt; n; i++) /* add each word to buf, save nc */\n        nc += sprintf (buf + nc, i ? \" %s\" : \"%s\", p[i]);\n\n    *(buf + nc) = 0;      /* affirmatively nul-terminate buf */\n\n    return buf;\n}\n</code></pre>\n\n<p><strong>note:</strong> each memory allocation with <code>malloc</code>, <code>calloc</code> or <code>realloc</code> should be validated to insure it succeeds, and the error handled in the event of failure. (here <code>NULL</code> is returned if allocation fails).</p>\n\n<p>Putting that together in a short example, you could do something similar to the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar *compress (char **p, int n)\n{\n    char *buf = NULL;     /* buffer to hold concatendated string */\n    size_t total = 0;     /* total number of characters required */\n    int nc = 0;           /* number of chars added (counter)     */\n\n    for (int i = 0; i &lt; n; i++)     /* get total required length */\n        total += strlen (p[i]) + 1; /* including spaces between  */\n\n    if (!(buf = malloc (total + 1)))    /* allocate/validate mem */\n        return buf;                     /* return NULL on error  */\n\n    for (int i = 0; i &lt; n; i++) /* add each word to buf, save nc */\n        nc += sprintf (buf + nc, i ? \" %s\" : \"%s\", p[i]);\n\n    *(buf + nc) = 0;      /* affirmatively nul-terminate buf */\n\n    return buf;\n}\n\nint main (void) {\n\n    char *sa[] = { \"My\", \"dog\", \"has\", \"too many\", \"fleas.\" },\n        *result = compress (sa, sizeof sa/sizeof *sa);\n\n    if (result) {                              /* check return */\n        printf (\"result: '%s'\\n\", result);     /* print string */\n        free (result);                         /* free memory  */\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/strcat_sprintf\nresult: 'My dog has too many fleas.'\n</code></pre>\n\n<p><strong>Memory/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to write beyond/outside the bounds of your allocated block of memory, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/strcat_sprintf\n==27595== Memcheck, a memory error detector\n==27595== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==27595== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==27595== Command: ./bin/strcat_sprintf\n==27595==\nresult: 'My dog has too many fleas.'\n==27595==\n==27595== HEAP SUMMARY:\n==27595==     in use at exit: 0 bytes in 0 blocks\n==27595==   total heap usage: 1 allocs, 1 frees, 28 bytes allocated\n==27595==\n==27595== All heap blocks were freed -- no leaks are possible\n==27595==\n==27595== For counts of detected and suppressed errors, rerun with: -v\n==27595== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have any additional questions.</p>\n\n<hr>\n\n<p><code>compress</code> <strong>with a Single Loop</strong></p>\n\n<p>As mentioned in the comment to MarianD's answer, you can use a single loop, reallocating your buffer with the addition of each word to the final string, but that is less efficient than getting the total number of characters required and then allocating once. However, there are many occasions where that is exactly what you will be required to do. Basically, you will simply get the length of each word and then allocate memory for that word (and the space between it and the next and for the <em>nul-byte</em>) using <code>realloc</code> instead of <code>malloc</code> (or <code>calloc</code>). <code>realloc</code> acts just like <code>malloc</code> for the first allocation, thereafter it resizes the buffer maintaining its current contents.</p>\n\n<p><strong>note:</strong> never <code>realloc</code> the buffer directly (e.g. <code>buf = realloc (buf, newsize);</code>), instead, always use a temporary pointer. Why? IF realloc fails, <code>NULL</code> is returned by <code>realloc</code> which causes you to lose the reference to your original <code>buf</code> (e.g. it will result in <code>buf = NULL;</code>), meaning that the address for your original <code>buf</code> is lost (and you have created a memory leak).</p>\n\n<p>Putting that together, you could do something like the following:</p>\n\n<pre><code>char *compress (char **p, int n)\n{\n    char *buf = NULL;     /* buffer to hold concatendated string */\n    size_t bufsz = 0;     /* current allocation size for buffer  */\n    int nc = 0;           /* number of chars added (counter)     */\n\n    for (int i = 0; i &lt; n; i++) {       /* add each word to buf  */\n        size_t len = strlen (p[i]) + 1; /* get length of word    */\n        void *tmp = realloc (buf, bufsz + len);   /* realloc buf */\n\n        if (!tmp)                       /* validate reallocation */\n            return buf;                 /* return current buffer */\n\n        buf = tmp;         /* assign reallocated block to buffer */\n        bufsz += len;       /* increment bufsz to current size   */\n\n        nc += sprintf (buf + nc, i ? \" %s\" : \"%s\", p[i]);\n    }\n\n    *(buf + nc) = 0;      /* affirmatively nul-terminate buf */\n\n    return buf;\n}\n</code></pre>\n\n<p><strong>Memory/Error Check</strong></p>\n\n<pre><code>$ valgrind ./bin/strcat_sprintf_realloc\n==28175== Memcheck, a memory error detector\n==28175== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==28175== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==28175== Command: ./bin/strcat_sprintf_realloc\n==28175==\nresult: 'My dog has too many fleas.'\n==28175==\n==28175== HEAP SUMMARY:\n==28175==     in use at exit: 0 bytes in 0 blocks\n==28175==   total heap usage: 5 allocs, 5 frees, 68 bytes allocated\n==28175==\n==28175== All heap blocks were freed -- no leaks are possible\n==28175==\n==28175== For counts of detected and suppressed errors, rerun with: -v\n==28175== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p><strong>note:</strong> now there are <code>5</code> allocations instead of <code>1</code>. </p>\n\n<p>Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 39, "user_id": 7817339, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b9e5edb925dbfb4b921361fca850013?s=128&d=identicon&r=PG&f=1", "display_name": "lauren", "link": "https://stackoverflow.com/users/7817339/lauren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1495099546, "creation_date": 1495063532, "last_edit_date": 1495066723, "question_id": 44036260, "link": "https://stackoverflow.com/questions/44036260/how-to-connect-link-words-in-an-string-array-using-one-loop", "title": "how to connect/link words in an string array using one loop?", "body": "<p>i have an array with n words .. i want to attach the strings togther ..\nfor example if the array have the following strings: \"hello\" \"world\" \"stack77\"\ni want the function to return :\"helloworldstach7 \" any help how i can do something like this without Recursion and with one loop and i can only use from the string library the two functions strcpy and strlen !!\nany ideas ! thanks\nI NEED TO USE ONE LOOP ONLY !</p>\n\n<pre><code>char *connect(char**words,int n){\nint i=0;\n    while(words){\n    strcpy(words+i,\n</code></pre>\n\n<p>i saw many many solutions but they all use other string functions , where i only want to use strcpy and strlen .</p>\n"}, {"tags": ["java", "c", "pointers", "struct", "jna"], "comments": [{"owner": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "edited": false, "score": 0, "creation_date": 1495085840, "post_id": 44036223, "comment_id": 75104746, "body": "You only need <code>Memory</code> if you need to allocate space. If you just need the native peer value, why doesn&#39;t <code>Pointer</code> work just as you&#39;ve described?"}, {"owner": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "reply_to_user": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "edited": false, "score": 0, "creation_date": 1495086022, "post_id": 44036223, "comment_id": 75104806, "body": "@DanielWiddis How do I create the pointer?"}, {"owner": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "edited": false, "score": 0, "creation_date": 1495091417, "post_id": 44036223, "comment_id": 75107726, "body": "Thanks for the additional details.  You need a <code>PointerType</code> or one of its extensions.  @cubrr gave an excellent answer below."}], "answers": [{"comments": [{"owner": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "edited": false, "score": 1, "creation_date": 1495091237, "post_id": 44040493, "comment_id": 75107602, "body": "What advantage is there to extending <code>PointerByReference</code> rather than simply <code>PointerType</code>?"}, {"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "reply_to_user": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "edited": false, "score": 1, "creation_date": 1495091635, "post_id": 44040493, "comment_id": 75107883, "body": "@DanielWiddis <code>PointerByReference</code>&#39;s <code>getValue</code> and <code>setValue</code> methods <a href=\"https://github.com/java-native-access/jna/blob/3a5787b9616862364ce92f9bb92c5661d743ac0a/src/com/sun/jna/ptr/PointerByReference.java#L44\" rel=\"nofollow noreferrer\">deal with the additional level on indirection automatically</a>. It is a <b>pointer to a pointer</b>. A <code>PointerType</code> is simply a type of <i>pointer</i>. That is, it only wraps one level of indirection, whereas <code>PointerByReference</code> wraps two. Since the <code>itemRef</code> is a pointer to a pointer in this case, I would argue that it is semantically more correct to use <code>PointerByReference</code>."}, {"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "reply_to_user": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "edited": false, "score": 1, "creation_date": 1495091778, "post_id": 44040493, "comment_id": 75107993, "body": "Also worth noting that <code>PointerByReference</code> extends <code>ByReference</code>, meaning that it <a href=\"https://github.com/java-native-access/jna/blob/3a5787b9616862364ce92f9bb92c5661d743ac0a/src/com/sun/jna/ptr/ByReference.java#L42\" rel=\"nofollow noreferrer\">automatically allocates memory for the pointer</a>."}, {"owner": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 0, "creation_date": 1495124459, "post_id": 44040493, "comment_id": 75131265, "body": "Yes, this works. The only oddity is that subclasses of <code>PointerByReference</code> apparently need to be public. Does that mean the answer I accepted on this question is wrong: <a href=\"http://stackoverflow.com/questions/43949920/macos-documentation-for-structs-in-security-h\" title=\"macos documentation for structs in security h\">stackoverflow.com/questions/43949920/&hellip;</a> ?"}, {"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "reply_to_user": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 0, "creation_date": 1495124800, "post_id": 44040493, "comment_id": 75131451, "body": "@BrianMcCutchon I&#39;m not sure what you mean by asking if it&#39;s wrong. How does a Java class having to be <code>public</code> tie into this?"}, {"owner": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 0, "creation_date": 1495125621, "post_id": 44040493, "comment_id": 75131901, "body": "Err, sorry, I meant does your answer mean that the answer I accepted to the question I linked in my previous comment is wrong?"}, {"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "reply_to_user": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 0, "creation_date": 1495142705, "post_id": 44040493, "comment_id": 75140974, "body": "@BrianMcCutchon No, the answer seems correct to my eyes. I meant to ask that what makes you question the answer&#39;s validity?"}], "tags": [], "owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "is_accepted": true, "score": 2, "last_activity_date": 1495092029, "last_edit_date": 1495092029, "creation_date": 1495090070, "answer_id": 44040493, "question_id": 44036223, "link": "https://stackoverflow.com/questions/44036223/getting-an-opaque-struct-returned-by-parameter-in-jna/44040493#44040493", "title": "Getting an opaque struct returned by parameter in JNA", "body": "<p>The <code>SecKeychainItemRef</code> type <a href=\"https://opensource.apple.com/source/libsecurity_keychain/libsecurity_keychain-55017/lib/SecBase.h.auto.html\" rel=\"nofollow noreferrer\">is defined to be a <strong>pointer to</strong> the struct</a>. This means that the <code>SecKeychainFindGenericPassword</code> function actually expects a <em>pointer to a pointer</em> as the <code>itemRef</code> argument, and as such, you can use the JNA <code>PointerByReference</code> class as the argument.</p>\n\n<p>After a successful call, you can use <a href=\"http://java-native-access.github.io/jna/4.4.0/javadoc/com/sun/jna/ptr/PointerByReference.html\" rel=\"nofollow noreferrer\"><code>PointerByReference.getValue()</code></a> to get the opaque pointer.</p>\n\n<pre><code>/* int SecKeychainFindGenericPassword(\n *     Pointer keychainOrArray,\n *     int serviceNameLength,\n *     String serviceName,\n *     int accountNameLength,\n *     String accountName,\n *     IntByReference *passwordLength,\n *     PointerByReference passwordData,\n *     PointerByReference itemRef\n * );\n */\n\nstatic void main() {\n    IntByReference passLength = new IntByReference(0);\n    PointerByReference passwordData = new PointerByReference();\n    PointerByReference itemRef = new PointerByReference();\n\n    int result = SecKeychainFindGenericPassword(\n        keychainOrArray,\n        \"service name\".length(),\n        \"service name\",\n        \"account\".length(),\n        \"account\",\n        passLength,\n        passwordData,\n        itemRef\n    );\n\n    if (result == 0) {\n        System.out.printf(\n            \"OSStatus: %d, passDataPtr: 0x%08X, itemRefPtr: 0x%08X%n\",\n            result,\n            Pointer.nativeValue(passwordData.getValue()),\n            Pointer.nativeValue(itemRef.getValue())\n        );\n    } else {\n        /* Use SecCopyErrorMessageString to get a human-readable message */\n        System.out.printf(\"An error occurred: %d%n\", result);\n    }\n}\n</code></pre>\n\n<p>If you're calling this method in an actual project, I would suggest creating a class named <code>SecKeychainItemRef</code> which extends the <code>PointerByReference</code> class. This communicates the argument's type to the reader in a clearer fashion, even if it doesn't let you access the internals of the struct.</p>\n"}], "owner": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 44040493, "answer_count": 1, "score": 1, "last_activity_date": 1495092029, "creation_date": 1495063294, "last_edit_date": 1495540983, "question_id": 44036223, "link": "https://stackoverflow.com/questions/44036223/getting-an-opaque-struct-returned-by-parameter-in-jna", "title": "Getting an opaque struct returned by parameter in JNA", "body": "<p>I'm trying to call a method in Apple's <code>Security.h</code> framework that returns a struct by reference, like so:</p>\n\n<pre><code>int findSomething(SomeStruct *s)\n</code></pre>\n\n<p>(Specifically, it's <a href=\"https://developer.apple.com/reference/security/1397301-seckeychainfindgenericpassword?language=objc\" rel=\"nofollow noreferrer\">this method</a>, and I'm trying to get <code>itemRef</code>. There's a usage example <a href=\"https://developer.apple.com/library/content/documentation/Security/Conceptual/keychainServConcepts/03tasks/tasks.html#//apple_ref/doc/uid/TP30000897-CH205-TP9\" rel=\"nofollow noreferrer\">here</a>.) The problem is that I don't know what fields <code>SomeStruct</code> has or how big it is. It only exists to be passed to other native library functions. So, I want something like this (Java):</p>\n\n<pre><code>interface SomeLib extends Library {\n    int findSomething(Pointer p);\n}\n\n...\nPointer p = ... // Not sure how to make this\nnativeLib.findSomething(p)\n// Do something with p\n</code></pre>\n\n<p>If I could do <code>sizeof(SomeStruct)</code> in Java, I could create the pointer using JNAs <code>Memory</code>, I think. I could write a native method to return <code>sizeof(SomeStruct)</code>, but I don't want to add a native component to my own code.</p>\n\n<p>This is similar to <a href=\"https://stackoverflow.com/questions/17981282/jna-how-to-deal-with-unkown-structs\">this question</a>, but it asks about a case where the fields of <code>SomeStruct</code> are known at runtime, whereas, in my case, the fields are obscured intentionally by the library authors.</p>\n"}, {"tags": ["mysql", "c", "mysql-5.7"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495062289, "post_id": 44035931, "comment_id": 75098820, "body": "Is <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-stmt-result-metadata.html\" rel=\"nofollow noreferrer\"><code>mysql_stmt_result_metadata()</code></a> what you&#39;re looking for?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5460725"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495062858, "post_id": 44035931, "comment_id": 75098982, "body": "I knew about that, but I really can&#39;t understand how I should use them in order to get the type and length of each return column... are there designated methods for that?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495063133, "post_id": 44035931, "comment_id": 75099065, "body": "How about <code>mysql_fetch_field()</code> and <code>mysql_fetch_fields()</code>? See the description of the <code>MYSQL_FIELD</code> structure <a href=\"https://dev.mysql.com/doc/refman/5.7/en/c-api-data-structures.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5460725"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495064355, "post_id": 44035931, "comment_id": 75099375, "body": "<code>mysql_fetch_field()</code> is an alternative to <code>mysql_stmt_fetch()</code>. It would fetch the field directly while I need to store it in the binds, and I also don&#39;t know if it&#39;s fine to use it with prepared statements... In case it works with them I could use it but I would have to re-design my software (not that I have problems in doing that if it&#39;s the only way or if it&#39;s a better solution), so I wondered if I could make this by using fetch and the output binds."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495064461, "post_id": 44035931, "comment_id": 75099395, "body": "<code>mysql_fetch_field()</code> fetches the field metadata, not the data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5460725"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495064967, "post_id": 44035931, "comment_id": 75099513, "body": "What bothers me is this: <code>Call this function repeatedly to retrieve information about all columns in the result set. </code> Will it conflict with <code>mysql_stmt_fetch()</code> or will they keep seperate pointers to the active row?   And most of all, how do I get the result set to use it on?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495065472, "post_id": 44035931, "comment_id": 75099658, "body": "I think they&#39;re independent. <code>mysql_fetch_field</code> is looping over the columns, fetching the rows has no effect on it. You can also use <code>mysql_fetch_fields</code>, which returns all the metadata about all the fields in an array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495065515, "post_id": 44035931, "comment_id": 75099671, "body": "And <code>mysql_fetch_field_direct()</code> lets you ask about a specific field, instead of looping."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5460725"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1495065904, "post_id": 44035931, "comment_id": 75099781, "body": "<code>mysql_fetch_field_direct()</code> seems great, now I have a clear picture of how to do everything! Thanks dude!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5460725"}, "is_accepted": false, "score": 0, "last_activity_date": 1495069777, "creation_date": 1495069777, "answer_id": 44037041, "question_id": 44035931, "link": "https://stackoverflow.com/questions/44035931/how-do-i-learn-the-type-and-length-of-a-return-parameter-before-doing-the-first/44037041#44037041", "title": "How do I learn the type and length of a return parameter before doing the first fetch in a prepared statement with MySQL&#39;s C API?", "body": "<p>Thanks to @Barmar's comments, in case someone has my same doubts here's how I did it: </p>\n\n<ul>\n<li>Just after <code>mysql_stmt_execute()</code>, use <code>mysql_stmt_attr_set()</code> with <code>STMT_ATTR_UPDATE_MAX_LENGTH</code> as second parameter. This will tell <code>mysql_stmt_store_result()</code> to set <code>max_length</code> for you.</li>\n<li>Get a <code>MYSQL_RES*</code> pointer with <code>mysql_stmt_store_result()</code> (remember to use <code>mysql_free_result()</code> when you're done with it). </li>\n<li>Allocate a number of binds as returned by <code>mysql_stmt_field_count()</code></li>\n<li>For each output bind, get it's <code>MYSQL_FIELD*</code> pointer with <code>mysql_fetch_field_direct()</code></li>\n<li>Get the column's data type from the <code>type</code> field of the <code>MYSQL_FIELD</code> struct</li>\n<li>Get the column's length (in case of strings and blobs) from the <code>max_length</code> field of the <code>MYSQL_FIELD</code> struct.</li>\n</ul>\n\n<p>Now you can bind the buffers to the statement and use <code>mysql_stmt_fetch()</code> to fetch the rows in the bind.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5460725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495069777, "creation_date": 1495061329, "question_id": 44035931, "link": "https://stackoverflow.com/questions/44035931/how-do-i-learn-the-type-and-length-of-a-return-parameter-before-doing-the-first", "title": "How do I learn the type and length of a return parameter before doing the first fetch in a prepared statement with MySQL&#39;s C API?", "body": "<p>I've browsed the MySQL APIs and the web in general for days, but sadly I couldn't find a clear solution to this problem, which is the last thing I need to deal with to complete the database part of my C application. </p>\n\n<p>I'm using prepared statements, and I need my code to dinamically create the output <code>MYSQL_BIND</code> structures after calling <code>mysql_stmt_execute()</code> and before doing the first <code>mysql_stmt_fetch()</code>. The <code>MYSQL_BIND</code> struct needs it's <code>buffer</code> to be allocated in order to store data with the fetch, so I need to know the type of data and it's length (in case it's a string or blob) before calling fetch. The APIs <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-stmt-fetch.html\" rel=\"nofollow noreferrer\">somehow offer a confusing solution for the length</a>, but there's nothing said about the type. And about the length, I don't really understand how I should access the <code>max_length</code> parameter which <code>mysql_stmt_store_result()</code> should set for each field if I follow the first strategy suggested in the aforementioned API page. </p>\n\n<p>Hope someone knows this.</p>\n"}, {"tags": ["c", "linux", "posix", "message-queue", "mq"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1495082594, "post_id": 44035792, "comment_id": 75103648, "body": "Don&#39;t you get <code>msg_len == 0</code> if the message is empty?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495086503, "post_id": 44035792, "comment_id": 75105011, "body": "Do you want to check it the queue is empty, or if the message received is empty?"}, {"owner": {"reputation": 43, "user_id": 7863079, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/789749880a575aec13c3af3dfe0e2f7e?s=128&d=identicon&r=PG&f=1", "display_name": "hypr2", "link": "https://stackoverflow.com/users/7863079/hypr2"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495112659, "post_id": 44035792, "comment_id": 75122373, "body": "i don&#39;t get 0, for some reason it is 1 but if i put 1 it will break even when I send something. @alk I think that both would work"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495114150, "post_id": 44035792, "comment_id": 75123531, "body": "So what is the value of the very one byte you receive if <code>mq_receive()</code> returns 1?"}, {"owner": {"reputation": 43, "user_id": 7863079, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/789749880a575aec13c3af3dfe0e2f7e?s=128&d=identicon&r=PG&f=1", "display_name": "hypr2", "link": "https://stackoverflow.com/users/7863079/hypr2"}, "edited": false, "score": 0, "creation_date": 1495115447, "post_id": 44035792, "comment_id": 75124548, "body": "it says 0 when i send it"}, {"owner": {"reputation": 43, "user_id": 7863079, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/789749880a575aec13c3af3dfe0e2f7e?s=128&d=identicon&r=PG&f=1", "display_name": "hypr2", "link": "https://stackoverflow.com/users/7863079/hypr2"}, "edited": false, "score": 0, "creation_date": 1495126684, "post_id": 44035792, "comment_id": 75132517, "body": "I&#39;ve done it the way that if you don&#39;t send anything it sends an empty message. It detected that after that"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495479546, "post_id": 44035792, "comment_id": 75259736, "body": "To better understand &quot;<i>empty</i>&quot; you might simply show us the code you use to send such a message?"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495086635, "post_id": 44038831, "comment_id": 75105061, "body": "&quot;<i>if(strlen(msg) == 0) ...</i>&quot; so if the 1st <code>char</code> of the messages received is a <code>&#39;\\0&#39;</code>you consider that an error. Why? Using <code>strlen()</code> on the msg` here is assuming a very specific use-case, namely that a &quot;string&quot; was received, which not necessarily needs to be the case."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495087115, "post_id": 44038831, "comment_id": 75105275, "body": "&quot;<i>the return value of mq_receive is not what you&#39;re looking for</i>&quot; why not? Because as you cite from the documentation: &quot;<i>RETURN VALUE: On success, mq_receive() and mq_timedreceive() return the  <b>number of bytes in the received message</i></b>&quot;. <code>0</code> bytes received would indicate an empty message, wouldn&#39;t they?"}, {"owner": {"reputation": 934, "user_id": 1454681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b8135cb65231f0d994c6644b486424c0?s=128&d=identicon&r=PG", "display_name": "Vardit", "link": "https://stackoverflow.com/users/1454681/vardit"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495090141, "post_id": 44038831, "comment_id": 75106885, "body": "How would you otherwise receive an empty message? (-1) return value clearly doesn&#39;t do the job"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495108621, "post_id": 44038831, "comment_id": 75119450, "body": "What about <code>mq_receive()</code>  returning a value of <code>0</code>? What else then an empty message would this indicate, independently of what (kind of data, strings, binary)  any non-empty message would contain."}], "tags": [], "owner": {"reputation": 934, "user_id": 1454681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b8135cb65231f0d994c6644b486424c0?s=128&d=identicon&r=PG", "display_name": "Vardit", "link": "https://stackoverflow.com/users/1454681/vardit"}, "is_accepted": false, "score": -1, "last_activity_date": 1495083120, "creation_date": 1495083120, "answer_id": 44038831, "question_id": 44035792, "link": "https://stackoverflow.com/questions/44035792/how-to-check-if-a-message-is-empty/44038831#44038831", "title": "How to check if a message is empty", "body": "<p>From mq_receive manual:</p>\n\n<pre><code>mq_receive() removes the oldest message with the highest priority\nfrom the message queue ... If the queue is empty, then, by default, \nmq_receive() blocks until a message becomes available, \nor the call is interrupted by a signal handler.  \nIf the O_NONBLOCK flag is enabled for the message\nqueue description, then the call instead fails immediately with the error EAGAIN.\n\nRETURN VALUE: On success, mq_receive() and mq_timedreceive() return the \nnumber of bytes in the received message; on error, -1 is returned, \nwith errno set to indicate the error.\n</code></pre>\n\n<p>the return value of mq_receive is not what you're looking for. You need to check whether your received message length is 0.</p>\n\n<p>I also highly reccomend you to read <a href=\"https://www.softprayog.in/programming/interprocess-communication-using-posix-message-queues-in-linux\" rel=\"nofollow noreferrer\">this</a> helpful tutorial about POSIX message queues.</p>\n\n<p>Here's a working example: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;mqueue.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt; /* memset */\n#include &lt;unistd.h&gt; /* close */\n#include &lt;sys/mman.h&gt;\n\n#define QUEUE_NAME \"/test\"\n#define MAX_MSG_LEN 100\n\nint main(int argc, char **argv)\n{\n    int q;\n    char* Q;\n    char c;\n    int loop = 1;\n    int msg_len;\n\n    struct mq_attr lastnosti_vrste;\n\n    lastnosti_vrste.mq_flags = 0;\n    lastnosti_vrste.mq_maxmsg = 10;\n    lastnosti_vrste.mq_msgsize = 100;\n    lastnosti_vrste.mq_curmsgs = 0; \n\n\n    while((c=getopt(argc, argv, \"q:\")) != -1)\n    {\n        switch(c)\n        {\n            case 'q':\n                mq_unlink(Q);\n                q = 1;\n                Q = QUEUE_NAME;\n            break;\n        }\n    }\n\n    int oprimek_vrsta = -1;\n    char *msg = malloc(MAX_MSG_LEN + 1);\n\n    if(q != 0)\n    {\n        oprimek_vrsta = mq_open(Q, O_RDWR|O_CREAT|O_EXCL, 0660, &amp;lastnosti_vrste);\n        if(oprimek_vrsta == -1){\n            perror(\"error creating queue\");\n            return -1;\n        }\n\n        if(mq_getattr(oprimek_vrsta, &amp;lastnosti_vrste) == -1){\n            perror(\"error reading attributes\");\n            return -1;\n        }\n        while(loop)\n        {\n\n            memset(msg, 0, 4096);\n            munmap(msg, 4096);\n            msg_len = mq_timedreceive(oprimek_vrsta, msg, MAX_MSG_LEN, 0);\n            if(strlen(msg) == 0)\n            {\n                perror(\"error reading message\");\n                loop = 0;\n                mq_close(oprimek_vrsta);\n                mq_unlink(Q);\n                return -1;\n            }\n            else\n            {\n                write(1, msg, strlen(msg));\n            }\n        }\n\n        free(msg);\n    }\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7863079, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/789749880a575aec13c3af3dfe0e2f7e?s=128&d=identicon&r=PG&f=1", "display_name": "hypr2", "link": "https://stackoverflow.com/users/7863079/hypr2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495086970, "creation_date": 1495060532, "last_edit_date": 1495086970, "question_id": 44035792, "link": "https://stackoverflow.com/questions/44035792/how-to-check-if-a-message-is-empty", "title": "How to check if a message is empty", "body": "<p>So I've been doing this for a whole day and didn't figure it out. I need to check if an empty message is passed to the receiver or server and then unlink queue.\nThis is what I have:</p>\n\n<pre><code>while((c=getopt(argc, argv, \":q:\"))!=-1){\n    switch(c){\n        case 'q':\n            q = 1;\n            Q = optarg;\n            break;\n    }\n}\nint oprimek_vrsta = -1;\nchar *msg = malloc(maxmsg_len + 1);\n\nif(q != 0){\n    oprimek_vrsta = mq_open(Q, O_RDWR|O_CREAT|O_EXCL, 0660, &amp;lastnosti_vrste);\n    if(oprimek_vrsta == -1){\n        perror(\"error creating queue\");\n        return -1;\n    }\n\n    if(mq_getattr(oprimek_vrsta, &amp;lastnosti_vrste) == -1){\n        perror(\"error reading attributes\");\n        return -1;\n    }\n    while(loop){\n        memset(msg, 0, 4096);\n        munmap(msg, 4096);\n        msg_len = mq_receive(oprimek_vrsta, msg, maxmsg_len, &amp;priority);\n        if(msg_len == -1){\n            perror(\"error reading message\");\n            loop = 0;\n            free(msg);\n            mq_close(oprimek_vrsta);\n            mq_unlink(Q);\n            return -1;\n        }else{\n            write(1, msg, strlen(msg));\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "opengl-3"], "comments": [{"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1495060717, "post_id": 44035618, "comment_id": 75098347, "body": "<code>1282</code> is <code>GL_INVALID_OPERATION</code>, it&#39;s written in your OpenGL headers. Also I don&#39;t see where you <code>glUseProgram</code>. And I suggest you specify a fixed attribute location with <code>glBindAttribLocation</code> (or even better with <code>layout(location=0)</code> if supported) rather than querying it afterwards."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 2, "creation_date": 1495060724, "post_id": 44035618, "comment_id": 75098351, "body": "Error 1282 (0x502) is <a href=\"https://www.khronos.org/opengl/wiki/OpenGL_Error#Meaning_of_errors\" rel=\"nofollow noreferrer\">Invalid Operation</a>. Try without the default <code>moving</code>value (which is already 0.0 at link time)."}, {"owner": {"reputation": 96, "user_id": 5618523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/695a51fe4eeb18ba2d9450c789d1b9c8?s=128&d=identicon&r=PG&f=1", "display_name": "anarchokawaii", "link": "https://stackoverflow.com/users/5618523/anarchokawaii"}, "edited": false, "score": 0, "creation_date": 1495066582, "post_id": 44035618, "comment_id": 75099962, "body": "ybungalobill glUseProgram is in there. i just didn&#39;t specify my entire code"}], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 5618523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/695a51fe4eeb18ba2d9450c789d1b9c8?s=128&d=identicon&r=PG&f=1", "display_name": "anarchokawaii", "link": "https://stackoverflow.com/users/5618523/anarchokawaii"}, "edited": false, "score": 0, "creation_date": 1495141667, "post_id": 44054006, "comment_id": 75140553, "body": "yes i do create a shader program, i just didn&#39;t specify it in the code. and i don&#39;t know what 4 means."}, {"owner": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "reply_to_user": {"reputation": 96, "user_id": 5618523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/695a51fe4eeb18ba2d9450c789d1b9c8?s=128&d=identicon&r=PG&f=1", "display_name": "anarchokawaii", "link": "https://stackoverflow.com/users/5618523/anarchokawaii"}, "edited": false, "score": 0, "creation_date": 1495142479, "post_id": 44054006, "comment_id": 75140884, "body": "Item 4 means that you are passing a value, that is different from -1, to uniform location that does not correspond to which the shader is expecting. But you must be sure that this error is being generated for <code>glUniform1f</code>. Others functions, like <code>glGetUniformLocation</code> could generate GL_INVALID_OPERATION too"}], "tags": [], "owner": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "is_accepted": false, "score": 0, "last_activity_date": 1495127324, "creation_date": 1495127324, "answer_id": 44054006, "question_id": 44035618, "link": "https://stackoverflow.com/questions/44035618/why-is-this-program-not-able-to-change-the-uniform/44054006#44054006", "title": "why is this program not able to change the uniform?", "body": "<p>From <code>glUniform</code> man pages, <code>GL_INVALID_OPERATION</code> occurs in the following situations:</p>\n\n<ol>\n<li><p>is generated if there is no current program object.</p></li>\n<li><p>is generated if the size of the uniform variable declared in the shader does not match the size indicated by the glUniform command.</p></li>\n<li><p>is generated if one of the integer variants of this function is used to load a uniform variable of type float, vec2, vec3, vec4, or an array of these, or if one of the floating-point variants of this function is used to load a uniform variable of type int, ivec2, ivec3, or ivec4, or an array of these.</p></li>\n<li><p>is generated if location is an invalid uniform location for the current program object and location is not equal to -1.</p></li>\n<li><p>is generated if count is greater than 1 and the indicated uniform variable is not an array variable.</p></li>\n<li><p>is generated if a sampler is loaded using a command other than glUniform1i and glUniform1iv.</p></li>\n<li><p>is generated if glUniform is executed between the execution of glBegin() and the corresponding execution of glEnd().</p></li>\n</ol>\n\n<p>From the excerpt of your code, seems to me that problem could be on item 1 or item 4</p>\n"}], "owner": {"reputation": 96, "user_id": 5618523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/695a51fe4eeb18ba2d9450c789d1b9c8?s=128&d=identicon&r=PG&f=1", "display_name": "anarchokawaii", "link": "https://stackoverflow.com/users/5618523/anarchokawaii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495127324, "creation_date": 1495059251, "question_id": 44035618, "link": "https://stackoverflow.com/questions/44035618/why-is-this-program-not-able-to-change-the-uniform", "title": "why is this program not able to change the uniform?", "body": "<p>this is my vertex shader code</p>\n\n<pre><code>const GLchar* Vshader_source =\n        \"#version 130 \\n\"\n        \"in vec3 position; \\n\"\n        \"uniform float moving = 0.0;\\n\"\n        \"void main(){ \\n\"\n        \"gl_Position = vec4(position.x,position.y - moving,position.z,1.0);\\n\"\n        \"}\";\n</code></pre>\n\n<p>and this is my program's window loop + the uniform selection functions, and the vertices formatting</p>\n\n<pre><code>GLint posAttrib = glGetAttribLocation(shaderProgram, \"position\");\nglVertexAttribPointer(posAttrib,3, GL_FLOAT,GL_FALSE,0,0);\nglEnableVertexAttribArray(posAttrib );\n\nGLint uniVex = glGetUniformLocation(shaderProgram,\"moving\");\n\ntime_t new = time(NULL) + 1;\nchar error_num = 0;\nGLfloat vexnum = 0.1f;\nwhile(!glfwWindowShouldClose(window)){\n                glClearColor(0.1f, 0.1f, 0.1f, 1.0f);\n                glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n                if (!error_num){\n                        fprintf(stderr,\"%d\\n\",glGetError());\n                        error_num++;\n                }\n                if (time(NULL) == new){\n                        new++;\n                        glUniform1f(uniVex,vexnum += 0.1f);\n                }\n                glDrawArrays(GL_TRIANGLES,0,3);\n                glfwSwapBuffers(window);\n                glfwPollEvents();\n        }\n</code></pre>\n\n<p>it worked before and i could see the triangle when \"uniform float moving =0.0;\" was removed and gl_position was just \"gl_Position = vec4(position,1.0);\". but when i adjusted it for the uniform it won't draw anything and glgeterror() returns 1282. which i looked up but no one seems to have an answer for what error 1282 is.</p>\n"}, {"tags": ["c", "split", "strtok"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495058679, "post_id": 44035380, "comment_id": 75097680, "body": "<code>i &lt; w + 1;</code> ==&gt; <code>i &lt; w;</code> ??"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495059090, "post_id": 44035380, "comment_id": 75097813, "body": "Your function <code>split</code> is returning an address within the local variable <code>char linia[256]</code> which has gone out of life. It is <i>undefined behaviour</i>."}, {"owner": {"reputation": 1, "user_id": 8027916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e0c10448c0af28662d8f0acfd16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "pisul", "link": "https://stackoverflow.com/users/8027916/pisul"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495060017, "post_id": 44035380, "comment_id": 75098139, "body": "Okay, so what is the best way to make it work? I&#39;ve checked other threads with simmilar problems and couldn&#39;t find a solution."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495060454, "post_id": 44035380, "comment_id": 75098265, "body": "You could pass a buffer as a function argument."}], "owner": {"reputation": 1, "user_id": 8027916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e0c10448c0af28662d8f0acfd16d1eb?s=128&d=identicon&r=PG&f=1", "display_name": "pisul", "link": "https://stackoverflow.com/users/8027916/pisul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1495059138, "answer_count": 0, "score": 0, "last_activity_date": 1495058098, "creation_date": 1495058098, "question_id": 44035380, "link": "https://stackoverflow.com/questions/44035380/strange-characters-after-splitting-string", "closed_reason": "Duplicate", "title": "Strange characters after splitting string", "body": "<p>I'm new into programming. While doing a project to my university I've encountered a problem. My goal is to make a program which will be summing big numbers (more than 20 chars, less then 100). They should be writen in the .txt file divided with space.\nThe problem is that after splitting those numbers I can only get the first one; the second one is changed into some strange characters (\u0010\u0111v1).\nI'd be really grateful if somebody can help me with this.  </p>\n\n<pre><code>int il_w = 4;\n\nchar * split(int w, int k)\n{\n    char const* const fileName = \"Numbers.txt\";\n    FILE* file = fopen(fileName, \"r\");\n    char linia[256];\n    char * pch = '\\0';\n    int i = 0;\n\n    for(i = 0; i &lt; w + 1; i++)\n        fgets(linia, sizeof(linia), file);\n\n    i = 0;\n    pch = strtok (linia, \" \");\n\n    while (i &lt; k)\n    {\n        pch = strtok (NULL, \" \");\n        i++;\n    }\n\n    fclose(file);\n\n    return pch;\n}\n\nint compare(char * a, char * b)\n{\n    printf(\"%s \", a);\n    printf(\"%s\", b);\n    //a &gt; b -&gt; 0, a &lt; b -&gt; 1, a = b -&gt; 2\n    if(strlen(a) &gt; strlen(b))\n        return 0;\n    else if(strlen(a) &lt; strlen(b))\n        return 1;\n    else\n    {\n        int i = 0;\n        for(i = 0; i &lt; strlen(a); i++)\n        {\n            int anum = atoi(a[i]);\n            int bnum = atoi(b[i]);\n\n            if (anum &gt; bnum)\n                return 0;\n            else if (anum &lt; bnum)\n                return 1;\n            else\n                continue;\n        }\n        return 2;\n    }\n}\n\nint main()\n{\n    int i = 0;\n\n    while(i &lt; il_w)\n    {\n        char * number1 = split(i, 0);\n        printf(\"%s \\n\", number1);\n        char * number2 = strtok(split(i, 1), \"\\n\");\n        printf(\"%s \\n\", number2);\n\n        printf(\"%d \\n\", compare(number1, number2));\n\n        i++;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1495058225, "post_id": 44035331, "comment_id": 75097524, "body": "because in <code>insertFirstElement</code> your <code>s</code> is modified locally and that&#39;s it, the assignment doesn&#39;t get passed back. You have a memory leak (you are malloc&#39;ing and then never freeing it)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495058280, "post_id": 44035331, "comment_id": 75097545, "body": "The function modifies a <i>copy</i> of the variable, which is forgotten at function exit."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 2, "creation_date": 1495059149, "post_id": 44035331, "comment_id": 75097847, "body": "Hands up all those who knew what the problem was from the title:)"}], "answers": [{"tags": [], "owner": {"reputation": 529, "user_id": 7401196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743a2271f4fff01a3667ec33f15e9023?s=128&d=identicon&r=PG&f=1", "display_name": "E.D.", "link": "https://stackoverflow.com/users/7401196/e-d"}, "is_accepted": false, "score": -1, "last_activity_date": 1495058305, "creation_date": 1495058305, "answer_id": 44035431, "question_id": 44035331, "link": "https://stackoverflow.com/questions/44035331/linked-lists-are-not-modified-through-function-c-programming/44035431#44035431", "title": "Linked lists are not modified through function (C programming)", "body": "<p>on the line </p>\n\n<pre><code>s = (Sequence*)malloc(sizeof(Sequence));\n</code></pre>\n\n<p>you replace the sequence you were given with a new sequence. You take in an address pointing at a sequence, but then replace that address with a new address pointing at a new sequence. You'd need to change the sequence s was pointing at without changing where s is pointing to modify the sequence in a way that will be reflected outside the function.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 7858712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1660095144001477/picture?type=large", "display_name": "Gianmarco Fioretti", "link": "https://stackoverflow.com/users/7858712/gianmarco-fioretti"}, "edited": false, "score": 0, "creation_date": 1495093615, "post_id": 44035739, "comment_id": 75109221, "body": "I thought that to use dynamically initialization modify directly the argument, which moreover is a pointer."}], "tags": [], "owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "is_accepted": true, "score": 1, "last_activity_date": 1495060138, "creation_date": 1495060138, "answer_id": 44035739, "question_id": 44035331, "link": "https://stackoverflow.com/questions/44035331/linked-lists-are-not-modified-through-function-c-programming/44035739#44035739", "title": "Linked lists are not modified through function (C programming)", "body": "<p>You pass pointer by value in <code>insertFirstElement</code> function. After returning from function, the address of pointer remains unchanged. You need to pass pointer to pointer such that,</p>\n\n<pre><code>void insertFirstElement(Sequence** s, int e) {\n\n    if (*s == NULL) {\n\n        *s = (Sequence*)malloc(sizeof(Sequence));\n        (*s)-&gt;value = e;\n        (*s)-&gt;next = NULL;\n        return;\n    }\n}\n</code></pre>\n\n<p>Accordingly, calling function, <code>insertFirstElement(s2, 5);</code> is modified as \n <code>insertFirstElement(&amp;s2, 5);</code></p>\n"}, {"tags": [], "owner": {"reputation": 461, "user_id": 7965340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XIYWy.jpg?s=128&g=1", "display_name": "Madhur Yadav", "link": "https://stackoverflow.com/users/7965340/madhur-yadav"}, "is_accepted": false, "score": 0, "last_activity_date": 1495062052, "creation_date": 1495062052, "answer_id": 44036060, "question_id": 44035331, "link": "https://stackoverflow.com/questions/44035331/linked-lists-are-not-modified-through-function-c-programming/44036060#44036060", "title": "Linked lists are not modified through function (C programming)", "body": "<p>In the function <strong>void insertFirstElement(Sequence* s, int e)</strong></p>\n\n<p>since the linkedlist will get modified therefore use call by reference (you are using call by value method).</p>\n\n<p>try void insertFirstElement(Sequence** s, int e)</p>\n"}], "owner": {"reputation": 79, "user_id": 7858712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1660095144001477/picture?type=large", "display_name": "Gianmarco Fioretti", "link": "https://stackoverflow.com/users/7858712/gianmarco-fioretti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 44035739, "answer_count": 3, "score": 2, "last_activity_date": 1495062052, "creation_date": 1495057883, "question_id": 44035331, "link": "https://stackoverflow.com/questions/44035331/linked-lists-are-not-modified-through-function-c-programming", "title": "Linked lists are not modified through function (C programming)", "body": "<p>I have this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nstruct node {\n    int value;\n    struct node* next;\n};\n\ntypedef struct node Sequence;\n\n\nSequence* init() {\n\n    Sequence* s = NULL;\n    return s;\n}\n\nvoid insertFirstElement(Sequence* s, int e) {\n\n    if (s == NULL) {\n\n        s = (Sequence*)malloc(sizeof(Sequence));\n        s-&gt;value = e;\n        s-&gt;next = NULL;\n        return;\n    }\n}\n\n\nint main(int argc, const char * argv[]) {\n\n    Sequence* s = NULL;\n    s = (Sequence*)malloc(sizeof(Sequence));\n    s-&gt;value = 5;\n    s-&gt;next = NULL;\n\n    if (s == NULL) {\n\n        printf(\"Doesn't work!\\n\");\n    }\n    else {\n\n        printf(\"It works!\\n\");\n    }\n\n    Sequence* s2 = init();\n    insertFirstElement(s2, 5);\n\n    if (s2 == NULL) {\n\n        printf(\"Doesn't work!\\n\");\n    }\n    else {\n\n        printf(\"It works!\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And program print this:</p>\n\n<pre><code>It works!\nDoesn't work!\n</code></pre>\n\n<p>So I doesn't understand why I can't modify my linked list through 'insertFirstElement' function. Why 'Sequence' it is not updated after function call? Why it remains 'NULL'? Can someone help me?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "is_accepted": true, "score": 8, "last_activity_date": 1495057149, "creation_date": 1495057149, "answer_id": 44035179, "question_id": 44035146, "link": "https://stackoverflow.com/questions/44035146/why-does-gnu-configure-define-macros-for-sizeof-int-etc-as-specific-integer-val/44035179#44035179", "title": "Why does GNU configure define macros for SIZEOF_INT etc. as specific integer values?", "body": "<p>I found the answer a minute after asking the question. These macros are sometimes used in the predicates of #if etc. where sizeof calls cannot be evaluated.</p>\n\n<p>For example</p>\n\n<pre><code>#if SIZEOF_LONG_LONG_INT == 8\nstuff\n#endif\n</code></pre>\n"}], "owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 44035179, "answer_count": 1, "score": 6, "last_activity_date": 1495057149, "creation_date": 1495056947, "question_id": 44035146, "link": "https://stackoverflow.com/questions/44035146/why-does-gnu-configure-define-macros-for-sizeof-int-etc-as-specific-integer-val", "title": "Why does GNU configure define macros for SIZEOF_INT etc. as specific integer values?", "body": "<p>If you're going to define these at all, why not define them as</p>\n\n<pre><code>#define SIZEOF_INT sizeof(int)\n</code></pre>\n\n<p>etc. so they are correct even if someone tries to use them to compile against a different architecture?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1495057125, "post_id": 44035113, "comment_id": 75097079, "body": "Reread the error. You already have a variable named <code>secret</code>, of type <code>int</code> - and now you&#39;re declaring a variable named <code>secret</code> of type <code>int *</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1495057181, "post_id": 44035113, "comment_id": 75097103, "body": "That&#39;s a homework question and it looks more like a problem understanding the text than a programming question. I&#39;d recommend to aask your tutor to explain what he means (although it is quite clear). Note the code invokes undefined behaviour."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1495057269, "post_id": 44035113, "comment_id": 75097138, "body": "@juanpa.arrivillaga. I read it as <code>*secret_pt += *another_secret</code>. <code>secret</code> is an <code>int</code>, not a pointer."}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1495057327, "post_id": 44035113, "comment_id": 75097163, "body": "@MadPhysicist right, I meant <code>int sum = *secret_pt + *another_secret;</code> I&#39;m pretty sure the point is to illustrate dereferencing pointers, given the verbiage &quot;Add the <i>value at the address pointed to by</i> another_secret&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "is_accepted": false, "score": 0, "last_activity_date": 1495057191, "creation_date": 1495057191, "answer_id": 44035189, "question_id": 44035113, "link": "https://stackoverflow.com/questions/44035113/changing-a-pointers-value/44035189#44035189", "title": "Changing a pointer&#39;s value", "body": "<p>You are given two addresses, <code>secret_pt</code> and <code>another_secret</code>. You are asked to add their contents together and store the result into whatever <code>secret_pt</code> points to. This happens to be <code>secret</code>, but you are not supposed to assign to it directly.</p>\n\n<p>The contents of a pointer is accessed by dereferencing it using the <code>*</code> operator. So the value at the address of <code>secret_pt</code> is <code>*secret_pt</code> and similarly the value at the address of <code>another_secret</code> is <code>*another_secret</code>. You can add them together.</p>\n\n<p>Keep in mind that <code>*secret_pt</code> is just <code>secret</code>, a fact that you can use to store into <code>secret</code> without actually using the name <code>secret</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1619, "user_id": 3342206, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92d5672ff3c806eb71d84d7298d5be43?s=128&d=identicon&r=PG&f=1", "display_name": "8bittree", "link": "https://stackoverflow.com/users/3342206/8bittree"}, "edited": false, "score": 0, "creation_date": 1495127702, "post_id": 44036485, "comment_id": 75133084, "body": "A reference to the C standard might be more appropriate here rather than the C++ standard, even if it happens to be a rule common to both."}], "tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 0, "last_activity_date": 1495065224, "last_edit_date": 1495540047, "creation_date": 1495065224, "answer_id": 44036485, "question_id": 44035113, "link": "https://stackoverflow.com/questions/44035113/changing-a-pointers-value/44036485#44036485", "title": "Changing a pointer&#39;s value", "body": "<p>Welcome to <a href=\"http://en.wikipedia.org/wiki/One_Definition_Rule\" rel=\"nofollow noreferrer\">ODR</a>, Welcome to <a href=\"https://stackoverflow.com/questions/162941/why-use-pointers\">pointers</a></p>\n\n<blockquote>\n  <p>A fundamental C++ rule that states that no translation unit shall\n  contain more than one definition of any variable, function, class\n  type, enumeration type or template, and that every program shall\n  contain exactly one definition of every non-inline function or\n  variable. Some definitions may be duplicated in multiple translation\n  units, subject to strict rules.</p>\n</blockquote>\n\n<p><em>ISO/IEC 14882-2014. Programming Languages \u2014 C++, Fourth Edition. 2014.</em></p>\n"}], "owner": {"reputation": 5, "user_id": 8027891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d7bd6d1c26bd3d733b3f37b508f7df?s=128&d=identicon&r=PG&f=1", "display_name": "Antt", "link": "https://stackoverflow.com/users/8027891/antt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1495065224, "creation_date": 1495056760, "last_edit_date": 1495056954, "question_id": 44035113, "link": "https://stackoverflow.com/questions/44035113/changing-a-pointers-value", "title": "Changing a pointer&#39;s value", "body": "<p>I just started learning C language and i have a basic question.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    // These variables have been assigned hidden values:\n    int secret;\n    int *another_secret;\n\n    // Declare a variable named secret_pt and make it point to secret:\n\n    // Add the value at the address pointed to by another_secret to the\n    // value at the address pointed to by secret_pt.\n    // Do not change the address assigned to secret_pt, and don't explicitly set secret.\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is my approach;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    // These variables have been assigned hidden values:\n    int secret;\n    int *another_secret;\n\n    // Declare a variable named secret_pt and make it point to secret:\n\n     //  int *secret_pt;\n    //secret_pt = &amp;secret;\n    int *secret_pt = &amp;secret;\n\n    // Add the value at the address pointed to by another_secret to the\n    // value at the address pointed to by secret_pt.\n    // Do not change the address assigned to secret_pt, and don't explicitly set secret.\n\n    int *secret = *another_secret;\n\n    return 0;\n}\n</code></pre>\n\n<p>But i'm getting redefining error which makes sense but i don't know how to solve it.</p>\n"}, {"tags": ["c", "debugging", "exception", "assembly", "operating-system"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1495056886, "post_id": 44035105, "comment_id": 75096971, "body": "The debugger takes care of this. It either overwrites your program with a software breakpoint instruction (<code>int3</code>) or by setting up a hardware assisted breakpoint."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495057002, "post_id": 44035105, "comment_id": 75097017, "body": "How does the CPU know <code>addl</code> is an addition? How what to do with the <code>ret</code> instruction?"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1495057194, "post_id": 44035105, "comment_id": 75097114, "body": "@Olaf he can&#39;t see in the generated code the command that causes the program to halt. This has nothing to do with his understanding of <code>addl</code> or <code>ret</code> I think."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1495057249, "post_id": 44035105, "comment_id": 75097129, "body": "@TonyTannous: If you know how breakpoints in RAM are used, you know it very well does."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495057320, "post_id": 44035105, "comment_id": 75097159, "body": "@Olaf breakpoints in RAM ? I didn&#39;t understand sorry."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1495057563, "post_id": 44035105, "comment_id": 75097257, "body": "@TonyTannous: Beakpoints in ROM work differently."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1495057932, "post_id": 44035105, "comment_id": 75097419, "body": "The answer varies amongst processors."}, {"owner": {"reputation": 103, "user_id": 8027876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d31dd278f43b07881b78413b92fea32?s=128&d=identicon&r=PG&f=1", "display_name": "James1234", "link": "https://stackoverflow.com/users/8027876/james1234"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1495058283, "post_id": 44035105, "comment_id": 75097549, "body": "@chux intel x86"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495059690, "post_id": 44035105, "comment_id": 75098020, "body": "&#39;why would it stop after fetching an instruction ?&#39; - it doesn&#39;t.  It stops when that instruction is about to be executed.  Modern processors often fetch instructions that are not executed."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1495181593, "post_id": 44035105, "comment_id": 75153827, "body": "<a href=\"http://stackoverflow.com/questions/41135561/how-does-adding-a-run-time-breakpoint-in-visual-studio-work/41179799#41179799\">See this answer for a discussion of how debuggers do this on x86 (in the context of Visual Studio, but not exclusive to that environment)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1495059531, "post_id": 44035142, "comment_id": 75097978, "body": "?? modern debuggers use internal hardware breakpoint registers.  Software breakpoints are no longer useful due to internal pipelining issues and multithreading problems."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 2, "creation_date": 1495060961, "post_id": 44035142, "comment_id": 75098420, "body": "hardware looking for an address has the same problem as replacing the memory with a breakpoint instruction with respect to the pipe.  old fashioned debugging is...old fashioned...more than in the past you are going to interfere with things that you need to not interfere with to debug, stop/change the flow of code due to a breakpoint or by single stepping, etc you are changing the behavior, sometimes that doesnt matter, sometimes that does, depends on the bug..."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 4, "creation_date": 1495061077, "post_id": 44035142, "comment_id": 75098452, "body": "replacing an instruction in memory is one solution, having something in the cpu or chip that watches for an address or instruction or some mechanism and stops the core without having the replace the instruction is another solution.  The replace the instruction solution allows for a near infinite number of breakpoints, the internal on chip debugger solution generally is limited to some relatively small number of breakpoints at any one time."}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1495142028, "post_id": 44035142, "comment_id": 75140691, "body": "Nitpick: <i>the debugger will insert in the generated code</i> -- &quot;insert&quot; is ambiguous here... it saves the first byte of the target instruction and temporarily overwrites with <code>int3</code>.  &quot;Insert&quot; implies shifting instructions to make room for the interrupt instruction."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 2, "creation_date": 1495181787, "post_id": 44035142, "comment_id": 75153937, "body": "@thingy That statement is clearly false; what would a debugger do if you had more than 4 breakpoints set? What are the &quot;internal pipelining issues&quot; that make software breakpoints &quot;no longer useful&quot;? It is guaranteed that, regardless of pipelining and out-of-order execution, instructions will always be retired in order, and thus appear as if they were executed serially. Also, what are the &quot;multithreading problems&quot;, other than those inherent to debugging multithreaded code? Hardware breakpoint registers <i>might</i> be used, but software breakpoints are still viable and commonplace."}, {"owner": {"reputation": 2085, "user_id": 3787736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083a38739359a3cb689c5be4cd7a1985?s=128&d=identicon&r=PG", "display_name": "dho", "link": "https://stackoverflow.com/users/3787736/dho"}, "edited": false, "score": 2, "creation_date": 1495218222, "post_id": 44035142, "comment_id": 75177401, "body": "@TonyTannous It might be worth noting that <code>int 3</code> could be <code>0xcd03</code> or <code>0xcc</code>, and why a debugger would use <code>0xcc</code> instead. In particular, that the size of breakpoint instruction must necessarily be &lt;= the smallest instruction supported by the processor, and why this must be true. Possibly also worth noting that <code>int 3</code> is specific to the x86/x86-64 ISA."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 2085, "user_id": 3787736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083a38739359a3cb689c5be4cd7a1985?s=128&d=identicon&r=PG", "display_name": "dho", "link": "https://stackoverflow.com/users/3787736/dho"}, "edited": false, "score": 0, "creation_date": 1495219382, "post_id": 44035142, "comment_id": 75177968, "body": "@dho edit my answer, I think your explanation will be better than my limited one. I will approve the editting."}, {"owner": {"reputation": 2085, "user_id": 3787736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083a38739359a3cb689c5be4cd7a1985?s=128&d=identicon&r=PG", "display_name": "dho", "link": "https://stackoverflow.com/users/3787736/dho"}, "edited": false, "score": 1, "creation_date": 1495229543, "post_id": 44035142, "comment_id": 75182569, "body": "I went a bit overboard, but HTH."}], "tags": [], "owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "is_accepted": true, "score": 14, "last_activity_date": 1495229597, "last_edit_date": 1495229597, "creation_date": 1495056918, "answer_id": 44035142, "question_id": 44035105, "link": "https://stackoverflow.com/questions/44035105/how-does-the-processor-know-the-breakpoints/44035142#44035142", "title": "How does the processor know the breakpoints?", "body": "<p>Most modern instruction sets include a <code>breakpoint</code> exception, used to allow debuggers to insert breakpoints in a program's code by temporarily replacing the relevant program instruction with the special software interrupt instruction. On the x86/x86-64 ISA, this instruction is \"interrupt vector 3\" (aka <code>int3</code>), which is usually emitted as the single-byte instruction <code>0xcc</code>.</p>\n\n<p>An important thing to note about breakpoint instructions is that they generally must be at least as small as the smallest possible instruction on the ISA. There are a few reasons for this. Some ISAs require minimum alignments for instructions; a shorter instruction will typically have less strict alignment requirements. Additionally, replacing some instruction with a longer one means that you are likely to overwrite a later instruction. This might not be a big deal in single-threaded applications, but in multithreaded applications, it is a show-stopper. Consider, for example, what might happen if you replace a short instruction at the end of an optional branch with a longer one, and another running thread skips the branch.</p>\n\n<p>In other cases, such a special instruction may not exist. On hardware platforms lacking a specific breakpoint instruction, special hardware registers are sometimes provided to cause the processor to trap when it attempts to access a particular location in memory. These registers are typically rather limited in number, so when debugging with numerous breakpoints, a dedicated breakpoint instruction is extremely useful.</p>\n\n<p>When you start your program in a debugger and add a software-enabled breakpoint, what typically happens is something like the following:</p>\n\n<p>The debugger loads the program into memory and provides you some input prompt. You tell the debugger to add a breakpoint. It may use some information to figure out where in memory your breakpoint actually corresponds to the in-memory representation of the program. The debugger then decodes the instruction at that address (because it generally wants to replace the whole instruction) and replaces \nit (in memory) with the breakpoint instruction. You then tell the debugger to execute / continue executing the program.</p>\n\n<p>When the processor encounters this instruction, it generates a trap. This trap is delivered as an interrupt to the operating system, which notices that the trap is intended to debug the program. The OS knows which program is being executed (therefore also who is executing it) -- so it may do some permission checks to make sure the user debugging the application is actually allowed to do so at this point. If all looks good, the OS notifies the debugger that a breakpoint was encountered, and it tells you that it stopped.</p>\n\n<p>This isn't a universal explanation. Significant OS support is required for the above to be true. On Linux and the BSDs, most of this functionality is exposed through the <code>ptrace(2)</code> syscall (which allows reading and replacing instructions, as well as single-stepping them). While POSIX-compliant, OS X does not implement <code>ptrace(2)</code> and instead provides various Mach ports for this. Windows has something else entirely.</p>\n\n<p>On embedded systems, special hardware ports (like <a href=\"https://en.wikipedia.org/wiki/JTAG\" rel=\"noreferrer\">JTAG</a>) might be supplied to allow introspection at a hardware level, allowing the development of an external debugger, which \"speaks\" directly to the hardware using JTAG.</p>\n"}], "owner": {"reputation": 103, "user_id": 8027876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d31dd278f43b07881b78413b92fea32?s=128&d=identicon&r=PG&f=1", "display_name": "James1234", "link": "https://stackoverflow.com/users/8027876/james1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 1, "accepted_answer_id": 44035142, "answer_count": 1, "score": 10, "last_activity_date": 1495229597, "creation_date": 1495056722, "last_edit_date": 1495057004, "question_id": 44035105, "link": "https://stackoverflow.com/questions/44035105/how-does-the-processor-know-the-breakpoints", "title": "How does the processor know the breakpoints?", "body": "<p>Lets consider this very simple program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main () \n{\n    int num1=4, num2=5;\n    printf(\"Welcome\\n\");\n    printf(\"num1 + num2 = %d\\n\", num1+num2);\n    return 0;\n}\n</code></pre>\n\n<p>When looking on the generated assembly code using <code>gcc -S prog.c</code>:</p>\n\n<pre><code>    .file   \"p.c\"\n    .def    ___main;    .scl    2;  .type   32; .endef\n    .section .rdata,\"dr\"\nLC0:\n    .ascii \"Welcome\\0\"\nLC1:\n    .ascii \"num1 + num2 = %d\\12\\0\"\n    .text\n    .globl  _main\n    .def    _main;  .scl    2;  .type   32; .endef\n_main:\nLFB10:\n    .cfi_startproc\n    pushl   %ebp\n    .cfi_def_cfa_offset 8\n    .cfi_offset 5, -8\n    movl    %esp, %ebp\n    .cfi_def_cfa_register 5\n    andl    $-16, %esp\n    subl    $32, %esp\n    call    ___main\n    movl    $4, 28(%esp)\n    movl    $5, 24(%esp)\n    movl    $LC0, (%esp)\n    call    _puts\n    movl    28(%esp), %edx\n    movl    24(%esp), %eax\n    addl    %edx, %eax\n    movl    %eax, 4(%esp)\n    movl    $LC1, (%esp)\n    call    _printf\n    call    _getchar\n    movl    $0, %eax\n    leave\n    .cfi_restore 5\n    .cfi_def_cfa 4, 4\n    ret\n    .cfi_endproc\nLFE10:\n    .ident  \"GCC: (GNU) 5.3.0\"\n    .def    _puts;  .scl    2;  .type   32; .endef\n    .def    _printf;    .scl    2;  .type   32; .endef\n    .def    _getchar;   .scl    2;  .type   32; .endef\n</code></pre>\n\n<p>I know that the CPU see's the assembled code that the compiler generated for it, what I don't understand is how the program stops at the <code>breakpoint</code> that the user set ? why doesn't the CPU continue running the program ? what and how does that happens ?\nI mean, why would it stop after fetching an instruction ?</p>\n\n<p>I am a bit confused about it, is it Code::Blocks caring for this or whatever program user is using ?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1495055247, "post_id": 44034712, "comment_id": 75096229, "body": "Your declaration is missing a <b>type</b>: <code>int arr[][] = ....</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1495055263, "post_id": 44034712, "comment_id": 75096232, "body": "Also, <b><code>int main(void)</code></b>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1495055338, "post_id": 44034712, "comment_id": 75096263, "body": "Also commas... also you need to specify dimensions for others but last"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8024128, "user_type": "registered", "profile_image": "https://graph.facebook.com/435380553495575/picture?type=large", "display_name": "\u05e4\u05e0\u05d7\u05e1 \u05d0\u05dc\u05d1\u05d9\u05d9\u05d1", "link": "https://stackoverflow.com/users/8024128/%d7%a4%d7%a0%d7%97%d7%a1-%d7%90%d7%9c%d7%91%d7%99%d7%99%d7%91"}, "edited": false, "score": 0, "creation_date": 1495056696, "post_id": 44034793, "comment_id": 75096865, "body": "i added the type in the program , i forgot to write them in the question."}, {"owner": {"reputation": 126, "user_id": 7061355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y0e4N.jpg?s=128&g=1", "display_name": "Piotr More\u0144", "link": "https://stackoverflow.com/users/7061355/piotr-more%c5%84"}, "reply_to_user": {"reputation": 1, "user_id": 8024128, "user_type": "registered", "profile_image": "https://graph.facebook.com/435380553495575/picture?type=large", "display_name": "\u05e4\u05e0\u05d7\u05e1 \u05d0\u05dc\u05d1\u05d9\u05d9\u05d1", "link": "https://stackoverflow.com/users/8024128/%d7%a4%d7%a0%d7%97%d7%a1-%d7%90%d7%9c%d7%91%d7%99%d7%99%d7%91"}, "edited": false, "score": 0, "creation_date": 1495057071, "post_id": 44034793, "comment_id": 75097048, "body": "I&#39;ve edited my answer following your question about predefined sizes of given dimensions"}], "tags": [], "owner": {"reputation": 126, "user_id": 7061355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y0e4N.jpg?s=128&g=1", "display_name": "Piotr More\u0144", "link": "https://stackoverflow.com/users/7061355/piotr-more%c5%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1495057365, "last_edit_date": 1495057365, "creation_date": 1495055277, "answer_id": 44034793, "question_id": 44034712, "link": "https://stackoverflow.com/questions/44034712/defining-2d-array-in-c-in-vs-express-2012/44034793#44034793", "title": "defining 2D array in c in VS Express 2012", "body": "<p>You should add type to your array declaration - for example int arr[][].\nIf you don't want to specify size of columns and rows you have to do it dynamically. For example this way:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\nint main()\n{\n    int r = 3, c = 4, i, j, count;\n\n    int **arr = (int **)malloc(r * sizeof(int *));\n    for (i=0; i&lt;r; i++)\n         arr[i] = (int *)malloc(c * sizeof(int));\n\n    // Note that arr[i][j] is same as *(*(arr+i)+j)\n    count = 0;\n    for (i = 0; i &lt;  r; i++)\n      for (j = 0; j &lt; c; j++)\n         arr[i][j] = ++count;  // OR *(*(arr+i)+j) = ++count\n\n    for (i = 0; i &lt;  r; i++)\n      for (j = 0; j &lt; c; j++)\n         printf(\"%d \", arr[i][j]);\n\n   /* Code for further processing and free the \n      dynamically allocated memory */\n\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8024128, "user_type": "registered", "profile_image": "https://graph.facebook.com/435380553495575/picture?type=large", "display_name": "\u05e4\u05e0\u05d7\u05e1 \u05d0\u05dc\u05d1\u05d9\u05d9\u05d1", "link": "https://stackoverflow.com/users/8024128/%d7%a4%d7%a0%d7%97%d7%a1-%d7%90%d7%9c%d7%91%d7%99%d7%99%d7%91"}, "edited": false, "score": 0, "creation_date": 1495056744, "post_id": 44034836, "comment_id": 75096893, "body": "I edited the question as i wrote it in the program...Cant I not initialize the rows and colums?"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 3, "last_activity_date": 1495055433, "creation_date": 1495055433, "answer_id": 44034836, "question_id": 44034712, "link": "https://stackoverflow.com/questions/44034712/defining-2d-array-in-c-in-vs-express-2012/44034836#44034836", "title": "defining 2D array in c in VS Express 2012", "body": "<p>You're missing the type; all but the first dimension must be specified; and you're missing commas between the aggregate initializers. Working example:</p>\n\n<pre><code>int main(void) {\n    int arr[][2] = {{1,2}, {1,2}, {1,3}};\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1495057536, "last_edit_date": 1495057536, "creation_date": 1495057198, "answer_id": 44035190, "question_id": 44034712, "link": "https://stackoverflow.com/questions/44034712/defining-2d-array-in-c-in-vs-express-2012/44035190#44035190", "title": "defining 2D array in c in VS Express 2012", "body": "<p>When you have such a declaration</p>\n\n<pre><code>int arr[][]={{1,2},{1,2},{1,3}};\n</code></pre>\n\n<p>then the compiler can determine the number of the elements for the left most dimension. There are three initializers so the left most dimension is equal to 3. However the compiler is unable to determine the number of elements in the right most dimension because all these declarations are valid</p>\n\n<pre><code>int arr[][2]={{1,2},{1,2},{1,3}};\nint arr[][20]={{1,2},{1,2},{1,3}};\nint arr[][200]={{1,2},{1,2},{1,3}};\n</code></pre>\n\n<p>So you need explicitly to specify the number of elements in the right most dimension of the array. As I can guess you mean the following array declaration</p>\n\n<pre><code>int arr[][2]={{1,2},{1,2},{1,3}};\n</code></pre>\n\n<p>that is equivalent to</p>\n\n<pre><code>int arr[3][2]={{1,2},{1,2},{1,3}};\n</code></pre>\n\n<p>Though the MS VS allows a declaration of main like</p>\n\n<pre><code>void main()\n</code></pre>\n\n<p>nevertheless according to the C Standard the function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>even if a rerun statement is absent. </p>\n"}], "owner": {"reputation": 1, "user_id": 8024128, "user_type": "registered", "profile_image": "https://graph.facebook.com/435380553495575/picture?type=large", "display_name": "\u05e4\u05e0\u05d7\u05e1 \u05d0\u05dc\u05d1\u05d9\u05d9\u05d1", "link": "https://stackoverflow.com/users/8024128/%d7%a4%d7%a0%d7%97%d7%a1-%d7%90%d7%9c%d7%91%d7%99%d7%99%d7%91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1495057536, "creation_date": 1495054927, "last_edit_date": 1495056461, "question_id": 44034712, "link": "https://stackoverflow.com/questions/44034712/defining-2d-array-in-c-in-vs-express-2012", "title": "defining 2D array in c in VS Express 2012", "body": "<pre><code>#include&lt;stdio.h&gt;\nvoid main()//this is the way that we pragram in c\n{\n  int arr[][]={{1,2},{1,2},{1,3}};//in class it wasnt required to initialize both\n}\n</code></pre>\n\n<p>the errors:</p>\n\n<blockquote>\n  <p>Error 1   error C2087: 'arr' : missing subscript<br>\n  Error 2   error C2078: too many initializers<br>\n  3 IntelliSense: an array may not have elements of this type   </p>\n</blockquote>\n\n<p>I am a beginner , and i saw in class that the professor did the same thing.\nalso i asked my instructor and he told me that it should raise this error.</p>\n\n<p>can someone please addres me to where and what is the problem?</p>\n"}, {"tags": ["c", "linux", "multithreading", "networking", "poll-syscall"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1495056279, "post_id": 44034104, "comment_id": 75096690, "body": "The thread can modify it, but it won&#39;t have any effect if <code>poll()</code> has already started. The array is copied into the kernel at the start of the system call."}], "owner": {"reputation": 113, "user_id": 3373837, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/ae93f3d037fad7f6a953f7f1a3848f47?s=128&d=identicon&r=PG&f=1", "display_name": "siri", "link": "https://stackoverflow.com/users/3373837/siri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1495052416, "creation_date": 1495052416, "question_id": 44034104, "link": "https://stackoverflow.com/questions/44034104/pollfd-structure-being-accessed-while-poll-system-call-in-progress", "title": "Pollfd structure being accessed while poll() system call in progress", "body": "<p>I have a dedicated polling thread that does the poll() system call. On an event a\nworker thread is posted to do actual read/write from the network. The polling thread disables the fd for an event if it is being worked upon by the worker thread. Once the worker thread is finished with the read/write it reenables the fd\nfor polling.</p>\n\n<p>Can the worker thread directly modify the pollfd array that poll() uses? Will there be any issues if the pollfd array is modified while it is passed to the poll() invocation?</p>\n"}, {"tags": ["c", "linux", "buffer", "stdio"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1495055088, "post_id": 44034025, "comment_id": 75096151, "body": "<code>stdout</code> is in a bad state as you closed the underlying descriptor <code>STDOUT_FILENO</code> things work correctly with <code>fclose(stdout)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1495055552, "post_id": 44034688, "comment_id": 75096361, "body": "What is strange is that printing 1024 characters then leads to state change... Looping over the printf can easily exhibit this."}, {"owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "edited": false, "score": 1, "creation_date": 1495060695, "post_id": 44034688, "comment_id": 75098336, "body": "Yes, this internal setting up of the buffer via <code>fstat</code> call that you described, seems consistent with what <code>man setbuf</code> says: &quot;The setvbuf() function may be used only after opening a stream and before any other operations have been performed on it.&quot; If I replace that first <code>printf</code> with <code>setlinebuf(stdout);</code> it behaves the same."}, {"owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "edited": false, "score": 0, "creation_date": 1495061630, "post_id": 44034688, "comment_id": 75098626, "body": "So an analagous caveat seems to apply to <code>printf</code> as the one appearing in the Notes within <code>man 2 write</code>:  &quot;A  successful return from write() does not make any guarantee that data has been committed to disk.&quot; replacing &#39;write()&#39; with &#39;printf()&#39; and &#39;disk&#39; with &#39;kernel file buffer&#39;. Here <code>fflush</code> and <code>fsync</code> would be analogues. I don&#39;t know of an analogue to <code>close(fd)</code> that would sever the connection from the kernel file buffer to the disk.."}, {"owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "edited": false, "score": 0, "creation_date": 1496156294, "post_id": 44034688, "comment_id": 75539424, "body": "After understanding the internals of how this is working, it seems to me that stdio library should report an error when it first discovers that the underlying fd is bad. So when the initial call to <code>fstat</code> returns <code>EBADF</code>, i think <code>printf</code> should return -1, rather than just setting the stdio buffer to block-buffered as if it was writing to a disk file."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 4, "last_activity_date": 1495056098, "last_edit_date": 1495056098, "creation_date": 1495054810, "answer_id": 44034688, "question_id": 44034025, "link": "https://stackoverflow.com/questions/44034025/stdio-to-terminal-after-closestdout-fileno-behavior/44034688#44034688", "title": "stdio to terminal after close(STDOUT_FILENO) behavior", "body": "<p>If you <code>strace</code> the both programs, it seems that <code>stdio</code> works so that upon <em>first</em> write, it checks the descriptor with <code>fstat</code> to find out what kind of file is connected to the <code>stdout</code> - if it is a terminal, then <code>stdout</code> shall be <em>line-buffered</em>, if it is something else, then <code>stdout</code> will be made block-buffered. If you call <code>close(1);</code> before the first <code>printf</code>, now the initial <code>fstat</code> will return <code>EBADF</code> and as <code>1</code> is not a file descriptor that points to a character device, <code>stdout</code> is made block-buffered. </p>\n\n<p>On my computer the buffer size is 8192 bytes - that many bytes can be buffered to be written to <code>stdout</code> <em>before</em> the first failure would occur.</p>\n\n<hr>\n\n<p>If you uncomment the first <code>printf</code>, the <code>fstat(1, ...)</code> <em>succeeds</em> and Glibc detects that <code>stdout</code> is connected to a terminal; <code>stdout</code> is set to line-buffered, and thus because <code>printf after close(STDOUT_FILENO)\\n</code> ends with newline, the buffer will be flushed right away - which will result in an immediate error.</p>\n"}], "owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 44034688, "answer_count": 1, "score": 4, "last_activity_date": 1495056098, "creation_date": 1495052058, "last_edit_date": 1495052142, "question_id": 44034025, "link": "https://stackoverflow.com/questions/44034025/stdio-to-terminal-after-closestdout-fileno-behavior", "title": "stdio to terminal after close(STDOUT_FILENO) behavior", "body": "<p>I am wondering why uncommenting that first printf statement in the following program changes its subsequent behavior:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\nint main() {\n  //printf(\"hi from C \\n\");\n\n  // Close underlying file descriptor:\n  close(STDOUT_FILENO);\n\n  if (write(STDOUT_FILENO, \"Direct write\\n\", 13) != 13) // immediate error detected.\n    fprintf(stderr, \"Error on write after close(STDOUT_FILENO): %s\\n\", strerror(errno));\n\n  // printf() calls continue fine, ferror(stdout) = 0 (but no write to terminal):\n  int rtn;\n  if ((rtn = printf(\"printf after close(STDOUT_FILENO)\\n\")) &lt; 0 || ferror(stdout)) \n    fprintf(stderr, \"Error on printf after close(STDOUT_FILENO)\\n\");\n  fprintf(stderr, \"printf returned %d\\n\", rtn);\n  // Only on fflush is error detected:\n  if (fflush(stdout) || ferror(stdout))\n    fprintf(stderr, \"Error on fflush(stdout): %s\\n\", strerror(errno));\n}\n</code></pre>\n\n<p>Without that first printf, the subsequent printf rtns 34 as if no error occured even though the connection from the stdout user buffer to the underlying fd has been closed. Only on a manual fflush(stdout) does the error get reported back.\nBut with that first printf turned on, the next printf reports errors as I would expect.\nOf course nothing is written to the terminal(by printf) after the STDOUT_FILENO fd has been closed in either case.</p>\n\n<p>I know it's silly to <code>close(STDOUT_FILENO)</code> in the first place here; this is an experiment I stumbled into and thinking someone more knowledgeable in these areas may see something instructive to us in it.. </p>\n\n<p>I am on Linux with gcc.</p>\n"}, {"tags": ["c", "bits", "bit-fields"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1495051638, "post_id": 44033878, "comment_id": 75094432, "body": "Where did Q1 go?"}, {"owner": {"reputation": 366, "user_id": 8024984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60731b46db8858e14685f07fef1eb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail Romanko", "link": "https://stackoverflow.com/users/8024984/mikhail-romanko"}, "edited": false, "score": 0, "creation_date": 1495051773, "post_id": 44033878, "comment_id": 75094523, "body": "Please fix comments. You opened comment but forget to close it. And add code that demontraits your problem"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495052026, "post_id": 44033878, "comment_id": 75094667, "body": "<code>int position ;</code> is uninitialised as are <code>mask.w</code> and <code>mask.y</code>."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1495052110, "post_id": 44033878, "comment_id": 75094708, "body": "If you use bitfields like this, you can pretty much treat <code>w,x,y,z</code> all as individual variables and just assign them values.  If you want to set or clear multiple values at once, then you probably want to ditch the bitfield syntax and start using <code>&amp;</code> and <code>|</code> to set whole ranges of bits at once."}, {"owner": {"reputation": 61, "user_id": 7474325, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-HRAn73LrBXc/AAAAAAAAAAI/AAAAAAAAABo/A31S4W4vv2k/photo.jpg?sz=128", "display_name": "Gopal Krishna", "link": "https://stackoverflow.com/users/7474325/gopal-krishna"}, "edited": false, "score": 0, "creation_date": 1495053447, "post_id": 44033878, "comment_id": 75095384, "body": "I have updated the question"}], "answers": [{"tags": [], "owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "is_accepted": true, "score": 1, "last_activity_date": 1495052100, "creation_date": 1495052100, "answer_id": 44034034, "question_id": 44033878, "link": "https://stackoverflow.com/questions/44033878/set-and-reset-of-bitfields/44034034#44034034", "title": "Set and Reset of Bitfields", "body": "<p>A2: not in a portable way; you can put it into a <code>union</code> with an integer member and shuffle the bitfields so that it works for your ABI.  But as said, this is not portable</p>\n\n<p>A3: <code>memset(&amp;a, 0, sizeof a)</code> should do it</p>\n\n<p>BUT: bitfields are ugly and probably the wrong choice for you use case.  I would use unsigned integers for it.</p>\n"}, {"comments": [{"owner": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "edited": false, "score": 0, "creation_date": 1495061614, "post_id": 44035231, "comment_id": 75098620, "body": "The use of bitfield operations and int-wide bitwise operations on the same variable is not portable. E.g., on a bigendian machine it is likely that B.c is not bit 3 but bit sizeof(int) * 8 - 3."}, {"owner": {"reputation": 61, "user_id": 7474325, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-HRAn73LrBXc/AAAAAAAAAAI/AAAAAAAAABo/A31S4W4vv2k/photo.jpg?sz=128", "display_name": "Gopal Krishna", "link": "https://stackoverflow.com/users/7474325/gopal-krishna"}, "edited": false, "score": 0, "creation_date": 1495081238, "post_id": 44035231, "comment_id": 75103328, "body": "Hi Sokre, I cant use OR operator for setting the bit because the condition is I can set  only the bits that are already set in the Mask bitfield in your case say bitfield b.So If B = 0b0100 and I want to set the first bit of bitfield a i.e 0b0001 , I should not be able to do that .As per the condition I can set and reset  only the 3rd bit of a .(B = 0b0100).Thats why I wanted to use AND operator"}, {"owner": {"reputation": 114, "user_id": 7593451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be3e2693e068372678d739f1bb74599?s=128&d=identicon&r=PG&f=1", "display_name": "Sokre", "link": "https://stackoverflow.com/users/7593451/sokre"}, "edited": false, "score": 0, "creation_date": 1495101086, "post_id": 44035231, "comment_id": 75114282, "body": "Hi, then you shoud AND the MASK with B and OR the result with A. AND-ing will leave only bits in both B and mask standing and OR-ing will will set the resulting bits in A. Of course, assuming A was reset before all of that."}, {"owner": {"reputation": 114, "user_id": 7593451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be3e2693e068372678d739f1bb74599?s=128&d=identicon&r=PG&f=1", "display_name": "Sokre", "link": "https://stackoverflow.com/users/7593451/sokre"}, "reply_to_user": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "edited": false, "score": 0, "creation_date": 1495108551, "post_id": 44035231, "comment_id": 75119397, "body": "@Doug Currie - you might be right, but I have my doubts about that. For the sake of this dicussion, I don&#39;t see why would it matter how a &quot;bitwise split&quot; integer is stored in memory, when OR-ing/AND-ing is going to be performed on registers. The defined struct has integer as underlying type. When integer is loaded from memory into a register, it is going to be &quot;sorted out right&quot;. Or?"}, {"owner": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "edited": false, "score": 0, "creation_date": 1495120214, "post_id": 44035231, "comment_id": 75128480, "body": "@Skore, no, the processor will not flip bits end to end when reading/writing to memory. It&#39;s unfortunate that C does not specify the layout of bit fields within ints; you cannot depend on it. See <a href=\"https://www.securecoding.cert.org/confluence/display/c/EXP11-C.+Do+not+make+assumptions+regarding+the+layout+of+structures+with+bit-fields\" rel=\"nofollow noreferrer\">securecoding.cert.org/confluence/display/c/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/6043483/why-bit-endianness-is-an-issue-in-bitfields\" title=\"why bit endianness is an issue in bitfields\">stackoverflow.com/questions/6043483/&hellip;</a>"}, {"owner": {"reputation": 114, "user_id": 7593451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be3e2693e068372678d739f1bb74599?s=128&d=identicon&r=PG&f=1", "display_name": "Sokre", "link": "https://stackoverflow.com/users/7593451/sokre"}, "reply_to_user": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "edited": false, "score": 0, "creation_date": 1495123175, "post_id": 44035231, "comment_id": 75130494, "body": "@Doug Currie, yes, the correct explanation is that the order of bits in a bitfield is unspecified and therefore compiler implementation dependent and not portable. There is however no relation to endianness. Whether portability is really an issue here can only be answered by Gopal. With a bit of tweaking he can do what he intends to."}], "tags": [], "owner": {"reputation": 114, "user_id": 7593451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be3e2693e068372678d739f1bb74599?s=128&d=identicon&r=PG&f=1", "display_name": "Sokre", "link": "https://stackoverflow.com/users/7593451/sokre"}, "is_accepted": false, "score": 0, "last_activity_date": 1495058646, "last_edit_date": 1495058646, "creation_date": 1495057396, "answer_id": 44035231, "question_id": 44033878, "link": "https://stackoverflow.com/questions/44033878/set-and-reset-of-bitfields/44035231#44035231", "title": "Set and Reset of Bitfields", "body": "<p>A1: If you want to set a bit you should use OR operator, not AND. The access to bits via pointer is similar to the one via variable. The only difference is in \"->\" instead of \".\". I.e. a->w and not a.w;</p>\n\n<p>A2: Yes, there is. For example, declare an integer pointer to the same memory location and use it to access the memory as integer variable. See example code below. Downside is that you get access to all the bits your struct is occupying.</p>\n\n<p>A3: Same as A2. If you can set, you can also reset.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n  int a:1;\n  int b:1;\n  int c:1;\n  int d:1;\n} bitField;\n\nint main() {\n  bitField A;\n  bitField B;\n\n  int *allA;\n  allA = (int *)&amp;A;     //Access bitField as Integer\n\n  *allA = 0x02;         //Set bit 2 of A\n  printf(\"A=0x%x\\n\", A);\n\n  *allA = 0x53;         //Set bits 1 and 2 of A, but also set a few of \"out of range\" bits\n  printf(\"A=0x%x\\n\", A);\n\n  *allA = 0x01;         //Set bit 1, reset all other bits\n  printf(\"A=0x%x\\n\", A);\n\n  B.c = 1;              //Set Bit 3 of B\n\n  A.c |= B.c;           //A=0b0001, B=0b0100 -&gt; A|B=0b0101 (dec 5)\n  printf(\"A=0x%x\\n\", A);\n\n  int *allB;\n  allB = (int *)&amp;B;\n\n  *allA = 0;\n  *allB = 3;\n  *allA |= *allB;       //Set bits 1 and 2 of A by OR-ing with B;\n  printf(\"A=0x%x\\n\", A);\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7474325, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-HRAn73LrBXc/AAAAAAAAAAI/AAAAAAAAABo/A31S4W4vv2k/photo.jpg?sz=128", "display_name": "Gopal Krishna", "link": "https://stackoverflow.com/users/7474325/gopal-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 44034034, "answer_count": 2, "score": 0, "last_activity_date": 1495058646, "creation_date": 1495051532, "last_edit_date": 1495053430, "question_id": 44033878, "link": "https://stackoverflow.com/questions/44033878/set-and-reset-of-bitfields", "title": "Set and Reset of Bitfields", "body": "<p>I am trying to write a C program wherein I will declare two variable of type <strong>status</strong> bitfield, status a and status mask.And in <strong>status a</strong> I can only set the bitfields which are already set in mask.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct\n{\n    unsigned int w : 1 ;\n    unsigned int x : 1 ;\n    unsigned int y : 1 ;\n    unsigned int z : 1 ;\n}status ;\n\nvoid bitset(status* a,status* b,int position)\n{\n    /*Check for the position and set that bit only if it is set in mask.\n     In this case, I can set only a.x and a.z.\n\n}\nint main()\n{\n    status a ;\n    status mask ;\n    int position ;\n\n    mask.w = 0\n    mask.x = 1 ;\n    mask.y = 0;\n    mask.z = 1;\n\n    position = 1 ;\n\n    bitset(&amp;a,&amp;b,position); \n}\n</code></pre>\n\n<p>For this I tried using &amp; operator.But it is showing error.</p>\n\n<p>Q1: By using pointers to the <strong>a</strong> and <strong>mask</strong> how can I complete the function bitset.</p>\n\n<p>Q2: Is there a way so that I can set all the bitfields at once,something like\n    a = 0x10 so that only y bit is set.</p>\n\n<p>Q3: Is there a way so that I can reset all the bits at once,like a={0}.Is this         the correct way to do it? Please help.</p>\n"}, {"tags": ["c", "security"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495051642, "post_id": 44033866, "comment_id": 75094434, "body": "Start by looking at which cases are leading to the <i>early termination</i> of the function."}, {"owner": {"reputation": 11, "user_id": 8027540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777805cfd8a00e62a706981880ef661?s=128&d=identicon&r=PG&f=1", "display_name": "nas", "link": "https://stackoverflow.com/users/8027540/nas"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495051782, "post_id": 44033866, "comment_id": 75094529, "body": "The function terminates early when the password length is not right.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495051955, "post_id": 44033866, "comment_id": 75094641, "body": "Which gives you a way of determining the length right away. Right? It is important piece of information."}, {"owner": {"reputation": 11, "user_id": 8027540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777805cfd8a00e62a706981880ef661?s=128&d=identicon&r=PG&f=1", "display_name": "nas", "link": "https://stackoverflow.com/users/8027540/nas"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495052085, "post_id": 44033866, "comment_id": 75094695, "body": "Yes, the password consists of six characters. I&#39;m just not sure how to go further than that."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495053005, "post_id": 44033866, "comment_id": 75095159, "body": "Not an easy one I must admit."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1495054878, "post_id": 44033866, "comment_id": 75096044, "body": "Well, you can use a semi-brute-force approach. Have 5 characters fixed. Start with one character and run this code on each possibility few hundred of times. It shouldn&#39;t take too long, and calculate the <i>average</i> running time. This should effectively eliminate the randomness. Once you get the shortest average time, you can say with some confidence that you have one correct character. Fix it and proceed to the next one."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1495057423, "post_id": 44033866, "comment_id": 75097206, "body": "and notice that the difference - and therefore the wait - will get lower when you get closer to the correct one"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495058644, "post_id": 44033866, "comment_id": 75097671, "body": "Actually you can use even more heuristic approach. You don&#39;t have to try <i>all</i> of the possibilities, as the closer the character to the correct one, the shorter the waiting time, so you can do a kind of binary search. But I believe it is unnecessary complication."}], "owner": {"reputation": 11, "user_id": 8027540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777805cfd8a00e62a706981880ef661?s=128&d=identicon&r=PG&f=1", "display_name": "nas", "link": "https://stackoverflow.com/users/8027540/nas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495051482, "creation_date": 1495051482, "question_id": 44033866, "link": "https://stackoverflow.com/questions/44033866/side-channel-attack", "title": "Side-channel attack", "body": "<p>I have this piece of code given in my homework, which is part of a crackme. Now, we are asked to implement a side-channel attack on this crackme to find the right password.\nI know that you can find it by looking at the time it takes to compute. This also depends on the difference of the characters.\nI'm just not sure how to start coding the attack, moreover that the time varies, and is random.\nBy trying out a few possibilities and looking at the time it takes to print out an answer, the length of the key equals 6.</p>\n\n<p>Can somebody please help?</p>\n\n<p>The code fragment (written in C):</p>\n\n<pre><code>int compare_key() {\n    unsigned int len = strlen(key_input);\n    unsigned int correct_len = strlen(correct_key);\n    int i, wait_time = 0, random_time, diff;\n    struct timeval t;\n    gettimeofday(&amp;t, NULL);\n    srand(t.tv_usec * t.tv_sec);\n\n    if (len != correct_len) return 1;\n    for (i = 0; i &lt; correct_len; i++) {\n        if (key_input[i] != correct_key[i]) {\n            diff = key_input[i] - correct_key[i]; \n            if (diff &lt; 0)\n                diff = -diff;\n            // delay stops brute force attack\n            wait_time += diff;\n        }\n    }\n\n    random_time = rand() % 10;\n    usleep(10000 * (wait_time + random_time));\n\n    return wait_time &gt; 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1495049985, "post_id": 44033448, "comment_id": 75093420, "body": "<a href=\"https://en.wikipedia.org/wiki/C_data_types#stdint.h\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/C_data_types#stdint.h</a>"}, {"owner": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1495050061, "post_id": 44033448, "comment_id": 75093449, "body": "Portability, serialization, marshalling..... there are a number of times when you want an <i>exact known size</i> of all of your types"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495050173, "post_id": 44033448, "comment_id": 75093516, "body": "Because the types <code>long long</code> and <code>long</code> and <code>int</code> and <code>short</code> are defined to be of a <i>minimum</i> size. If you <b>must</b> have 32 bits then on an architecture where <code>int</code> is 16 bits <code>int32_t</code> will do the job."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1495050271, "post_id": 44033448, "comment_id": 75093577, "body": "There are many portability concerns unrelated to integer representation and range."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1495050318, "post_id": 44033448, "comment_id": 75093599, "body": "Use of <code>int32_t</code> can <i>decrease</i> portability as a rare platform might be using non-2&#39;s complement integers.  Of course, if the code needs 2&#39;s complement to run right, that is good."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1495050511, "post_id": 44033448, "comment_id": 75093707, "body": "@nathan That&#39;s one of the rare cases that applies for both languages equally."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1495050161, "post_id": 44033500, "comment_id": 75093506, "body": "<code>int32_t</code> also insures 2&#39;s complement.  <code>int</code> does not."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1495050348, "post_id": 44033500, "comment_id": 75093610, "body": "@EugeneSh.: C11 draft standard n1570: <i>7.20.1.1 Exact-width integer types 1 The typedef name intN_t designates a signed integer type with width N , no padding bits, and a two\u2019s complement representation. Thus, int8_t denotes such a signed integer type with a width of exactly 8 bits.</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495050444, "post_id": 44033500, "comment_id": 75093669, "body": "@EugeneSh. Detail: <code>int32_t</code> is <i>optional</i> for those rare platforms using non-2&#39;s complement.  A compliant platform need not have <code>int32_t</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1495050448, "post_id": 44033500, "comment_id": 75093675, "body": "@EOF Good one, thanks. This is why I like SO. Every day something new..."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 2, "last_activity_date": 1495050428, "last_edit_date": 1495050428, "creation_date": 1495050108, "answer_id": 44033500, "question_id": 44033448, "link": "https://stackoverflow.com/questions/44033448/use-of-int32-t-in-c-or-c/44033500#44033500", "title": "use of int32_t in c or c++?", "body": "<blockquote>\n  <ol>\n  <li>Firstly, why do we need int32_t as we already have different variation for it like short int unsigned int and etc.</li>\n  </ol>\n</blockquote>\n\n<p>Because <code>short int</code>, <code>unsigned int</code>, etc aren't portable among architectures.</p>\n\n<p>If you mean exactly 32 bits, just say that explicitely. Otherwise you might end up using 64 bits just using the <code>unsigned int</code> with a different CPU architecture.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Secondly does the use of this type of fixed size types makes programs portable?</li>\n  </ol>\n</blockquote>\n\n<p>Yes, as mentioned above.</p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 8024984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60731b46db8858e14685f07fef1eb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail Romanko", "link": "https://stackoverflow.com/users/8024984/mikhail-romanko"}, "is_accepted": false, "score": 1, "last_activity_date": 1495050160, "creation_date": 1495050160, "answer_id": 44033513, "question_id": 44033448, "link": "https://stackoverflow.com/questions/44033448/use-of-int32-t-in-c-or-c/44033513#44033513", "title": "use of int32_t in c or c++?", "body": "<p>1) int32_t provides <strong>exact 32 bit integer</strong>. This is important because you can port your applications to different platforms without rewriting algorithm (if they will compile and yes, int is not always 16 or 32 or 64 bit wide, check C Reference). Check <a href=\"http://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\">nice self-explanatory page about stdint.h types</a></p>\n\n<p>2) Probably, yes</p>\n"}], "owner": {"reputation": 3, "user_id": 8027484, "user_type": "registered", "profile_image": "https://graph.facebook.com/213962672443030/picture?type=large", "display_name": "Saroj Kumar Mallick", "link": "https://stackoverflow.com/users/8027484/saroj-kumar-mallick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3107, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1495050475, "creation_date": 1495049918, "last_edit_date": 1495050475, "question_id": 44033448, "link": "https://stackoverflow.com/questions/44033448/use-of-int32-t-in-c-or-c", "title": "use of int32_t in c or c++?", "body": "<p>I have two questions in my mind now:</p>\n\n<ol>\n<li><p>Firstly, why do we need int32_t as we already have different variation for it like short int unsigned int and etc.</p></li>\n<li><p>Secondly does the use of this type of fixed size types makes programs portable?</p></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 2, "creation_date": 1495049538, "post_id": 44033279, "comment_id": 75093158, "body": "Okay! Two words <code>Undefined Behaviour</code>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 2, "creation_date": 1495049620, "post_id": 44033279, "comment_id": 75093208, "body": "@Sniper One word: Dyscalculia"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1495049758, "post_id": 44033279, "comment_id": 75093279, "body": "@EOF: Why? It is UB, Sniper is right."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495049795, "post_id": 44033279, "comment_id": 75093293, "body": "@Olaf You missed all of the fun."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495049840, "post_id": 44033279, "comment_id": 75093334, "body": "@EugeneSh.: You&#39;re not the first to tell me. That&#39;s what I have to live with."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495049894, "post_id": 44033279, "comment_id": 75093365, "body": "@Olaf You had to be there..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1495050069, "post_id": 44033279, "comment_id": 75093455, "body": "The proper declarations for <code>main</code> are <code>int main (void)</code> and <code>int main (int argc, char **argv)</code> (which you will see written with the equivalent <code>char *argv[]</code>). <b>note:</b> <code>main</code> is a function of <code>type int</code> and it returns a value. See <a href=\"http://stackoverflow.com/questions/204476/\"><b>See What should main() return in C and C++?</b></a>"}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1495052917, "post_id": 44033279, "comment_id": 75095117, "body": "Compile your code with <code>-Wall</code> and <code>-Wextra</code>, and run it with valgrind"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1495054618, "post_id": 44033279, "comment_id": 75095937, "body": "You&#39;re calling <code>foo</code> and <code>bar</code> with no visible declaration. For C99 and later, that&#39;s a constraint violation. For C90, it&#39;s undefined behavior, because the compiler will assume <code>foo</code> returns an <code>int</code> when in fact it returns an <code>int*</code>. Make sure your compiler at least warns you about this problem. To fix it, you can move the definitions of <code>foo</code> and <code>bar</code> above that of <code>main</code>, or you can add separate declarations. (Of course your program will still be buggy after those fixes.)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4176932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7365ec6b26f0a89a36f8b886c9e2e7?s=128&d=identicon&r=PG&f=1", "display_name": "ygyao", "link": "https://stackoverflow.com/users/4176932/ygyao"}, "edited": false, "score": 0, "creation_date": 1495053958, "post_id": 44033327, "comment_id": 75095617, "body": "Thank you for your response. Actually, I should write more precisely about my question. I don&#39;t understand why the incoming argument of bar() replace the previous value of foo()."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 25, "user_id": 4176932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7365ec6b26f0a89a36f8b886c9e2e7?s=128&d=identicon&r=PG&f=1", "display_name": "ygyao", "link": "https://stackoverflow.com/users/4176932/ygyao"}, "edited": false, "score": 0, "creation_date": 1495054118, "post_id": 44033327, "comment_id": 75095701, "body": "@ygyao Because the function bar or the function printf reuses the memory early used by the function foo.  So at the address where early there was the parameter x of the function foo now there can be anything that the function bar of the function printf can place there."}, {"owner": {"reputation": 25, "user_id": 4176932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7365ec6b26f0a89a36f8b886c9e2e7?s=128&d=identicon&r=PG&f=1", "display_name": "ygyao", "link": "https://stackoverflow.com/users/4176932/ygyao"}, "edited": false, "score": 0, "creation_date": 1495064689, "post_id": 44033327, "comment_id": 75099439, "body": "It seems not to be a coincident replacement. Why the incoming argument in bar(7) can replace exactly the memory address where the argument 31 stored?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495083328, "post_id": 44033327, "comment_id": 75103859, "body": "With undefined behaviour, anything can happen.  Things can even seem to make sense, and/or be consistent.  Or not \u2014 anything is OK."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 5, "last_activity_date": 1495054248, "last_edit_date": 1495054248, "creation_date": 1495049515, "answer_id": 44033327, "question_id": 44033279, "link": "https://stackoverflow.com/questions/44033279/what-will-happen-in-c-if-the-passing-parameter-is-a-constant-value/44033327#44033327", "title": "What will happen in C if the passing parameter is a constant value", "body": "<p>Function parameters are its local variables. So in this function definition</p>\n\n<pre><code>int *foo(int x) \n{ \n  return &amp;x;\n}\n</code></pre>\n\n<p>there is returned a pointer to a local variable.</p>\n\n<p>As result the program has undefined behavior.</p>\n\n<p>You can imagine the function definition and its call the following way</p>\n\n<pre><code>p = foo(31);\n\nint *foo( /* int x */ ) \n{ \n  int x = 31;\n  return &amp;x;\n}\n</code></pre>\n\n<p>The variable <code>x</code> will not be alive after exiting the function. Thus the pointer has an invalid value that is a value that does not point to an actual object. The memory allocated for the parameter of the function <code>foo</code> can be overwritten by a call of other function as for example by a call of the function <code>printf</code>..</p>\n\n<p>Take into account that according to the C Standard the function <code>main</code> without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>and function <code>foo</code> should be declared before its usage. Otherwise the compiler can issue a message that either there is used incompatible types or it can not find the corresponding function.</p>\n"}, {"tags": [], "owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "is_accepted": false, "score": 1, "last_activity_date": 1495049996, "creation_date": 1495049996, "answer_id": 44033471, "question_id": 44033279, "link": "https://stackoverflow.com/questions/44033279/what-will-happen-in-c-if-the-passing-parameter-is-a-constant-value/44033471#44033471", "title": "What will happen in C if the passing parameter is a constant value", "body": "<p>The function foo receives a copy of the input parameter value in its local variable x. What foo sees does not depend on whether the argument to the function is constant or not.</p>\n\n<p>The vatiable x is located on the stack and is freed when foo returns. So foo returns an address to a location in the stack. Returning a pointer to a local variable is an invitation for all kinds of problems. </p>\n\n<p>In this case  that same location most  probably gets reused when bar is called. </p>\n"}], "owner": {"reputation": 25, "user_id": 4176932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7365ec6b26f0a89a36f8b886c9e2e7?s=128&d=identicon&r=PG&f=1", "display_name": "ygyao", "link": "https://stackoverflow.com/users/4176932/ygyao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1495054248, "creation_date": 1495049340, "last_edit_date": 1495053765, "question_id": 44033279, "link": "https://stackoverflow.com/questions/44033279/what-will-happen-in-c-if-the-passing-parameter-is-a-constant-value", "title": "What will happen in C if the passing parameter is a constant value", "body": "<p>Suppose I have a main function as below:</p>\n\n<pre><code>void main()\n{ int *p;\n  p = foo(31);\n  printf(\u201c%d\u201d, (*p)+2);\n  bar(7); /* Body of function bar() not shown */ \n  printf(\u201c%d\u201d, (*p)+4);\n}\n\nint *foo(int x) \n{ \n  return &amp;x;\n}\n</code></pre>\n\n<p>Assuming the function bar() that compiles correctly, why the second result of the printf is <strong>11</strong> if the body of bar() does not write to its incoming arguments space.</p>\n\n<p>More specifically, my question is why the incoming argument value of <strong>bar()</strong> which is <strong>7</strong> replaces the value <strong>31</strong>? </p>\n\n<p>What's more, when the main function pass the value 31 into foo(), how does the value 31 passed? By register? or the compiler creates a temporary variable to pass 31? And why the incoming argument of  <strong>foo()</strong> and <strong>bar()</strong> share the same position in the memory</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1495049333, "post_id": 44033245, "comment_id": 75093047, "body": "What seems not to be perfect?"}, {"owner": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 0, "creation_date": 1495049349, "post_id": 44033245, "comment_id": 75093062, "body": "Please provide what output you are expecting and what are you getting for some <code>x</code> and <code>y</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 6, "creation_date": 1495049398, "post_id": 44033245, "comment_id": 75093085, "body": "In C, it is <code>==</code> that means equal sign."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1495049435, "post_id": 44033245, "comment_id": 75093110, "body": "Note that assignment is distinct from equality comparison in C. A good compiler would have warned you."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1495049458, "post_id": 44033245, "comment_id": 75093124, "body": "After that correction the loops will iterate one too few: to <code>width-1</code> and to <code>length-1</code>. So <code>i==length</code> and <code>j==width</code> will never be true."}, {"owner": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "edited": false, "score": 0, "creation_date": 1495054564, "post_id": 44033245, "comment_id": 75095914, "body": "The logic isn&#39;t perfect, the loop iterates endlessly. I&#39;m expecting Xs to be printed out in either a square or rectangular shape (depending on the length or width)"}], "answers": [{"tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": true, "score": 0, "last_activity_date": 1495089032, "creation_date": 1495089032, "answer_id": 44040196, "question_id": 44033245, "link": "https://stackoverflow.com/questions/44033245/build-a-simple-text-square-rectangle-using-xs-and-printf/44040196#44040196", "title": "Build a simple text square/rectangle using &quot;Xs&quot; and printf", "body": "<p>I see 3 flaws in your logic.</p>\n\n<blockquote>\n  <p>you mix <code>=</code> (assignment) with <code>==</code> comparison.</p>\n</blockquote>\n\n<p>This is why your loop never ends: you always reset <code>i</code> to <code>1</code> with your <code>if (((i = 1) || (i = length)) &amp;...</code></p>\n\n<blockquote>\n  <p>you're not going far enough with your variables: </p>\n</blockquote>\n\n<p>if <code>i &lt; length</code>,  then you'll never have it reach <code>length</code> and print the bottom line of X's</p>\n\n<blockquote>\n  <p>you can't draw a rectangle because your <code>&amp;&amp;</code> in the test <code>(((i = 1) || (i = length)) &amp;&amp; ((j = 1) || (j = width)))</code> is too restrictive. It can't work if <code>width</code> different from <code>length</code>.</p>\n</blockquote>\n\n<h1>You must learn the logic by yourself using tutorials:</h1>\n\n<p>Here such questions will be discarded by sometime-sad people. But as a welcome, here it is (you can replace <code>y</code> in the second case by <code>x</code>, but I thought it would help you understand):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid draw (float x, float y)\n {\n   int i,j;\n   int length = (int)x + 0;\n   int width = (int)y + 0;\n   for(i=1; i&lt;=length; i++) {\n       for(j=1;j&lt;=width;j++) {\n           if(((i==1)||(i==length))) {\n               printf(\"x\");\n           } else {\n             if (((j==1)||(j==width))) {\n               printf(\"y\");\n             } else {\n               printf(\" \");\n             }\n           }\n       }\n       printf(\"\\n\");\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 44040196, "answer_count": 1, "score": 0, "last_activity_date": 1495329673, "creation_date": 1495049212, "last_edit_date": 1495329673, "question_id": 44033245, "link": "https://stackoverflow.com/questions/44033245/build-a-simple-text-square-rectangle-using-xs-and-printf", "title": "Build a simple text square/rectangle using &quot;Xs&quot; and printf", "body": "<p>I am trying to build a square/rectangle using \"Xs\" on a 1:1 scale with the length and width, but the logic seems to be not perfect</p>\n\n<pre><code>void draw (float x, float y) {\n    int i, j;\n    int length = (int)x + 0;\n    int width = (int)y + 0;\n    for (i = 1; i &lt; length; i++) {\n        for (j = 1; j &lt; width; j++) {\n            if (((i = 1) || (i = length)) &amp;&amp; ((j = 1) || (j = width))) {\n                printf(\"x\");\n            } else {\n                printf(\" \");\n            }\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>The problem is that the loop iterates endlessly printing x's everywhere. I'm expecting Xs to be printed out in either a square or rectangular shape (depending on the length or width).</p>\n"}, {"tags": ["c", "algorithm", "math", "random"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1495049296, "post_id": 44033219, "comment_id": 75093028, "body": "Are you looking for a c or a c++ solution? Both languages offer different solutions. Your example looks like c, and you have both languages tagged."}, {"owner": {"reputation": 21, "user_id": 7413479, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1841815442698211/picture?type=large", "display_name": "Sebi Danila", "link": "https://stackoverflow.com/users/7413479/sebi-danila"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1495049381, "post_id": 44033219, "comment_id": 75093073, "body": "I am good with any language solution, i just want the algorithm. Yes, my code is wrote in C"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1495049544, "post_id": 44033219, "comment_id": 75093160, "body": "If you are looking to discuss algorithms, you may want to ask in a more appropriate stack exchange site. Perhaps <a href=\"https://cs.stackexchange.com/\">cs.stackexchange.com</a>?"}, {"owner": {"reputation": 6063, "user_id": 3225495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57OBG.jpg?s=128&g=1", "display_name": "BJ Myers", "link": "https://stackoverflow.com/users/3225495/bj-myers"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1495049684, "post_id": 44033219, "comment_id": 75093240, "body": "@Fran&#231;oisAndrieux Algorithms are not off-topic on SO, and programming questions are explicitly off-topic on cs.stackexchange."}], "answers": [{"tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1495073943, "creation_date": 1495073943, "answer_id": 44037531, "question_id": 44033219, "link": "https://stackoverflow.com/questions/44033219/generating-graph-with-random-edges/44037531#44037531", "title": "generating graph with random edges", "body": "<p>So you have N edges and want to mark K of them optimizing memory consumption. In this case you can use <a href=\"https://ru.wikipedia.org/wiki/Reservoir_sampling\" rel=\"nofollow noreferrer\">Reservoir sampling</a> with O(K) memory complexity.</p>\n\n<p>Make an array of integers with size K, fill it with 0..K-1 numbers, then walk a loop and randomly replace some numbers using rules that provide uniformity</p>\n\n<pre><code>ReservoirSample(S[1..n], R[1..k])\n  // fill the reservoir array\n  for i = 1 to k\n      R[i] := S[i]\n\n  // replace elements with gradually decreasing probability\n  for i = k+1 to n\n    j := random(1, i)   // important: inclusive range\n    if j &lt;= k\n        R[j] := S[i]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7413479, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1841815442698211/picture?type=large", "display_name": "Sebi Danila", "link": "https://stackoverflow.com/users/7413479/sebi-danila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1495073943, "creation_date": 1495049103, "last_edit_date": 1495049510, "question_id": 44033219, "link": "https://stackoverflow.com/questions/44033219/generating-graph-with-random-edges", "title": "generating graph with random edges", "body": "<p>I am trying to write a c/c++ program that uses Disjoint Sets using union by rank and path compression Graph Algorithm then apply Kruskal's algorithm on that graph.I already generated number_of_vertices-1 pairs (0,1),(1,2)...(n-2,n-1) as edges in the graph in order to make the graph connected.  I need to generate the rest of 3*number_Of_Vertices+1 random edges as pairs of (vertex1,vertex2) without collisions(the same edge shall not be generated twice). I have to do this without using extra memory. By extra memory i mean an extra list, vector...Do you guyz have any idea how to do this?</p>\n\n<p>This is what i did until now but it surely has collisions:</p>\n\n<pre><code>edge** createRandomEdges(nodeG **nodeArray, int n) {\n    edge **edgeArray = (edge**)malloc(sizeof(edge*)*n * 4);\n\n    for (int i = 0; i &lt; n; i++)\n        edgeArray[i] = createEdge(nodeArray[0], nodeArray[i + 1], rand() % 100+1);\n    for (int i = n; i &lt; 4 * n; i++) {\n       int nodeAindex = rand() % n;\n       int nodeBindex = rand() % n;\n\n       while (nodeAindex == nodeBindex) {\n           nodeAindex = rand() % n;\n           nodeBindex = rand() % n;\n       }\n\n       int weight = rand() % 100 + 1;\n       edgeArray[i] = createEdge(nodeArray[nodeAindex], nodeArray[nodeBindex], weight);\n   }\n\n   return edgeArray;\n}\n</code></pre>\n"}, {"tags": ["c", "null"], "comments": [{"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 0, "creation_date": 1495048929, "post_id": 44033014, "comment_id": 75092815, "body": "The answers of the duplicate mentions the &quot;difference&quot; between NULL and 0 as well, so it seems appropriate as a duplicate. At least considering that &quot;best practices&quot; is opinion-based, i.e. not appropriate for <a href=\"https://stackoverflow.com\">Stack Overflow</a>."}], "answers": [{"comments": [{"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 4, "creation_date": 1495048646, "post_id": 44033082, "comment_id": 75092653, "body": "Pointers still hold values. In the case of <code>NULL</code>, it&#39;s the value of 0 typed as a pointer."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1495060338, "post_id": 44033082, "comment_id": 75098235, "body": "Important note to what @JonathanWood said: <code>NULL</code> (or <code>(T*)0</code>) is not necessarily all-0 in memory."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6718012"}, "is_accepted": false, "score": 0, "last_activity_date": 1495048578, "creation_date": 1495048578, "answer_id": 44033082, "question_id": 44033014, "link": "https://stackoverflow.com/questions/44033014/c-code-using-null-versus-0-best-practices/44033082#44033082", "title": "C code, using NULL versus 0, Best Practices", "body": "<p>When initializing variables you should use:</p>\n\n<pre><code>int i=0;\nfloat f=0.0f;\ndouble = 0.0;\nchar c='\\0'; \n</code></pre>\n\n<p>In the case of initializing pointers, you should use NULL in any kind of pointer. This is due to the definition of pointer type variable: it doesn't hold a value, it holds the address of a value, or set of values(array/string -> int in case of int* (array), char in case of char* (string), etc.). Therefore you use NULL to indicate that it points to nothing on the memory. </p>\n"}], "owner": {"reputation": 409, "user_id": 4657413, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6u2Hm.jpg?s=128&g=1", "display_name": "newb7777", "link": "https://stackoverflow.com/users/4657413/newb7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1495050275, "answer_count": 1, "score": 0, "last_activity_date": 1495048844, "creation_date": 1495048286, "last_edit_date": 1495048844, "question_id": 44033014, "link": "https://stackoverflow.com/questions/44033014/c-code-using-null-versus-0-best-practices", "closed_reason": "Duplicate", "title": "C code, using NULL versus 0, Best Practices", "body": "<p>In C coding, when is it best to use \"NULL\" versus 0. \nI have noticed in code that wherever there is a pointer, NULL is used. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1495044092, "post_id": 44031896, "comment_id": 75090301, "body": "The floating point constants have a type of <code>double</code>. If suffixed with <code>f</code> (like <code>1.5f</code>), then <code>float</code>."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 1, "creation_date": 1495044118, "post_id": 44031896, "comment_id": 75090315, "body": "And all the other constants have type <code>int</code>."}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 2, "creation_date": 1495044330, "post_id": 44031896, "comment_id": 75090418, "body": "@Sneftel, not quite: there can be constants suffixed with, say, <code>UL</code> (unsigned long) or <code>U</code> (unsigned int)."}, {"owner": {"reputation": 4259, "user_id": 2348315, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IIlRD.jpg?s=128&g=1", "display_name": "PeterSW", "link": "https://stackoverflow.com/users/2348315/petersw"}, "edited": false, "score": 0, "creation_date": 1495044436, "post_id": 44031896, "comment_id": 75090476, "body": "All the reference material you would need to fully answer that question:  <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/operator_precedence</a> <a href=\"http://en.cppreference.com/w/c/language/integer_constant\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/integer_constant</a> <a href=\"http://en.cppreference.com/w/c/language/floating_constant\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/floating_constant</a>"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "edited": false, "score": 4, "creation_date": 1495044483, "post_id": 44031896, "comment_id": 75090505, "body": "@hidefromkgb I was referring to the constants in the OP&#39;s posted code. Clearly it&#39;s possible to have constants in C with a type other than <code>int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": true, "score": 5, "last_activity_date": 1495044392, "creation_date": 1495044392, "answer_id": 44031986, "question_id": 44031896, "link": "https://stackoverflow.com/questions/44031896/evaluation-of-an-expression-in-c-without-an-explicit-type/44031986#44031986", "title": "Evaluation of an Expression in C Without an Explicit Type", "body": "<p>In your expression <code>1.5</code> is a <code>double</code> (in order for the compiler to treat it a a <code>float</code> it should have an <code>f</code> suffix: <code>1.5f</code>). All of the other numbers are of type <code>int</code>.</p>\n\n<p>In order to show how the <code>9 / 3 / 2 * 6 + 2 * 1.5</code> expression will be evaluated, look at the <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"noreferrer\">C Operator Precedence</a> for reference (both priority and associativity). Note that <code>2 * 1.5</code> will be of type <code>double</code> (and so the type of the whole expression).</p>\n"}, {"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495045151, "post_id": 44032005, "comment_id": 75090886, "body": "Thumbs up... :)"}], "tags": [], "owner": {"reputation": 366, "user_id": 8024984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60731b46db8858e14685f07fef1eb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail Romanko", "link": "https://stackoverflow.com/users/8024984/mikhail-romanko"}, "is_accepted": false, "score": 12, "last_activity_date": 1495045245, "last_edit_date": 1495045245, "creation_date": 1495044447, "answer_id": 44032005, "question_id": 44031896, "link": "https://stackoverflow.com/questions/44031896/evaluation-of-an-expression-in-c-without-an-explicit-type/44032005#44032005", "title": "Evaluation of an Expression in C Without an Explicit Type", "body": "<p>According to the <strong>usual arithmetic conversions</strong> (6.3.1.8 Usual arithmetic conversions)</p>\n\n<blockquote>\n  <p>Otherwise, if the corresponding real type of either operand is <strong>double</strong>,\n  the other operand is converted, without change of type domain, to a\n  type whose corresponding real type is double.</p>\n</blockquote>\n\n<p>the answer: </p>\n\n<ol>\n<li>9 / 3 = 3 (int)</li>\n<li>3 / 2 = 1 (int)</li>\n<li>1 * 6 = 6 (int)</li>\n<li>2 * 1.5 = 3.0 (double)</li>\n<li>6 + 3.0 = 9.0 (double)</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1495044732, "post_id": 44032049, "comment_id": 75090644, "body": "K&amp;R are outdated. The <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.2p4\" rel=\"nofollow noreferrer\">C standard</a> would be a better reference."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1495044777, "post_id": 44032049, "comment_id": 75090674, "body": "Note that the result of <code>printf(&quot;%d %d\\n&quot;, sizeof(1.5)==sizeof(double), sizeof(1.5)==sizeof(float));</code> could be 1 1 - although that is not so common.  <code>_Generic</code> is a better discriminator."}, {"owner": {"reputation": 1472, "user_id": 6942918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzNAX.png?s=128&g=1", "display_name": "kyriakosSt", "link": "https://stackoverflow.com/users/6942918/kyriakosst"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495046490, "post_id": 44032049, "comment_id": 75091554, "body": "@EugeneSh. : Since it was a question from an exam, I supposed the original book should be a good reference."}, {"owner": {"reputation": 1472, "user_id": 6942918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzNAX.png?s=128&g=1", "display_name": "kyriakosSt", "link": "https://stackoverflow.com/users/6942918/kyriakosst"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1495046495, "post_id": 44032049, "comment_id": 75091560, "body": "@chux : Indeed, it is hardware/system dependent, however it is straight forward for proving a point. One shouldn&#39;t depend on that while writing code."}, {"owner": {"reputation": 3623, "user_id": 701302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0209e45e0162da89877cf2981ff127?s=128&d=identicon&r=PG", "display_name": "slevy1", "link": "https://stackoverflow.com/users/701302/slevy1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495053706, "post_id": 44032049, "comment_id": 75095495, "body": "@Eugene Sh: The K&amp;R text is the first authoritative work on C by those who invented the language and still merits a modicum of respect.  It allows one to acquire basic C99 concepts or refresh their knowledge of it.  What K&amp;R has to say about floats vs doubles still rings true."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3623, "user_id": 701302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0209e45e0162da89877cf2981ff127?s=128&d=identicon&r=PG", "display_name": "slevy1", "link": "https://stackoverflow.com/users/701302/slevy1"}, "edited": false, "score": 0, "creation_date": 1495053969, "post_id": 44032049, "comment_id": 75095626, "body": "@slevy1 With all of the respect to K&amp;R, some of the things described there are just incorrect about modern C. And one can&#39;t know which ones exactly without consulting the modern standard. In this specific case it appears to be correct. But how can you be sure about that?"}, {"owner": {"reputation": 3623, "user_id": 701302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0209e45e0162da89877cf2981ff127?s=128&d=identicon&r=PG", "display_name": "slevy1", "link": "https://stackoverflow.com/users/701302/slevy1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495065851, "post_id": 44032049, "comment_id": 75099756, "body": "@Eugene Sh: <a href=\"https://en.wikipedia.org/wiki/The_C_Programming_Language#/media/File:The_C_Programming_Language_cover.svg\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/The_C_Programming_Language#/media/&hellip;</a> (2nd edition reprinted in 2016)"}], "tags": [], "owner": {"reputation": 1472, "user_id": 6942918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzNAX.png?s=128&g=1", "display_name": "kyriakosSt", "link": "https://stackoverflow.com/users/6942918/kyriakosst"}, "is_accepted": false, "score": 2, "last_activity_date": 1495046660, "last_edit_date": 1495046660, "creation_date": 1495044593, "answer_id": 44032049, "question_id": 44031896, "link": "https://stackoverflow.com/questions/44031896/evaluation-of-an-expression-in-c-without-an-explicit-type/44032049#44032049", "title": "Evaluation of an Expression in C Without an Explicit Type", "body": "<p>It is a <code>double</code>.</p>\n\n<p>As mentioned in Kernighan &amp; Ritchie's \"The C programming language\":</p>\n\n<blockquote>\n  <p>Floating-point constants contain a decimal point (123.4) or an exponent (1e-2) or both; their type is double, unless suffixed.</p>\n</blockquote>\n\n<p>A quick way to find out for yourself would also be to write that code:\n<code>\nprintf(\"%d %d\\n\", sizeof(1.5)==sizeof(double), sizeof(1.5)==sizeof(float));\n</code>\nwhich will output\n<code>\n1 0\n</code>\nindicating that 1.5 is a double.</p>\n\n<p><em>Edit: Of course, type sizes in C are system dependent, so that code should not be entirely trusted.</em></p>\n"}, {"tags": [], "owner": {"reputation": 3623, "user_id": 701302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0209e45e0162da89877cf2981ff127?s=128&d=identicon&r=PG", "display_name": "slevy1", "link": "https://stackoverflow.com/users/701302/slevy1"}, "is_accepted": false, "score": 1, "last_activity_date": 1495137527, "last_edit_date": 1495540490, "creation_date": 1495048818, "answer_id": 44033146, "question_id": 44031896, "link": "https://stackoverflow.com/questions/44031896/evaluation-of-an-expression-in-c-without-an-explicit-type/44033146#44033146", "title": "Evaluation of an Expression in C Without an Explicit Type", "body": "<p>This problem may also be resolved by utilizing an approach based on <a href=\"https://en.wikipedia.org/wiki/Reflection_(computer_programming)\" rel=\"nofollow noreferrer\">reflection</a>. One may compare the type of the expression with a float and then with a double by using <code>__builtin_types_compatible_p()</code>.  This function   determines whether two types are the same. For this purpose, <code>__typeof__</code> can handily retrieve the type of the expression and pass it to the built-in function, as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    if (__builtin_types_compatible_p(__typeof__(9 / 3 / 2 * 6 + 2 * 1.5), float)) {\n        puts(\"float\");\n    } else if (__builtin_types_compatible_p(__typeof__(9 / 3 / 2 * 6 + 2 * 1.5), double)) {\n        puts(\"double\");\n    }\n    return (0);\n}\n</code></pre>\n\n<p>See <a href=\"http://codepad.org/c9bUE4P4\" rel=\"nofollow noreferrer\">demo</a>.</p>\n\n<p>When the types are the same, the function returns 1; see more <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Note: <code>__typeof__</code> does not return a string but a system type.</p>\n\n<p>Instead of providing the entire mathematical expression to <strong>typeof</strong>, one may simply pass 1.5 since the question really turns on what data type represents this floating-point value.  </p>\n\n<p>See related information: <a href=\"https://stackoverflow.com/questions/9804371/syntax-and-sample-usage-of-generic-in-c11/17290414#17290414\">Syntax and Sample Usage of _Generic in C11</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 8027011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d471ceb226c4240793b24900a33ac0a?s=128&d=identicon&r=PG&f=1", "display_name": "Faz Hassan", "link": "https://stackoverflow.com/users/8027011/faz-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 1, "accepted_answer_id": 44031986, "answer_count": 4, "score": 2, "last_activity_date": 1495137527, "creation_date": 1495043989, "last_edit_date": 1495051890, "question_id": 44031896, "link": "https://stackoverflow.com/questions/44031896/evaluation-of-an-expression-in-c-without-an-explicit-type", "title": "Evaluation of an Expression in C Without an Explicit Type", "body": "<p>Consider the following question from a previous paper on C:</p>\n\n<blockquote>\n  <p>Show step-by-step how the following C expression is evaluated, giving the\n  value of the expression and the <strong>type of that value</strong>.</p>\n\n<pre><code>9 / 3 / 2 * 6 + 2 * 1.5\n</code></pre>\n</blockquote>\n\n<p>Is the type a float or a double? Could someone please clarify? (Note the lack of an explicit type in the question.)</p>\n"}, {"tags": ["c", "linux", "unix"], "comments": [{"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1495043769, "post_id": 44031792, "comment_id": 75090123, "body": "because you have no base case"}, {"owner": {"reputation": 23, "user_id": 7282616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/441c6903353055f0b850954b86cd079b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7282616/joe"}, "reply_to_user": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1495043969, "post_id": 44031792, "comment_id": 75090233, "body": "Could you clarify a little? Because there is more to the code. I&#39;ll edit it in"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495045357, "post_id": 44031792, "comment_id": 75090977, "body": "Time to use the debugger."}, {"owner": {"reputation": 205, "user_id": 6681210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80f7df7970668181b659d2dc3826645?s=128&d=identicon&r=PG&f=1", "display_name": "0x0C4", "link": "https://stackoverflow.com/users/6681210/0x0c4"}, "edited": false, "score": 0, "creation_date": 1495049345, "post_id": 44031792, "comment_id": 75093057, "body": "very bad coding ! use strncpy and strncat ! Use a size value for all pointer to a string please !"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7282616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/441c6903353055f0b850954b86cd079b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7282616/joe"}, "edited": false, "score": 0, "creation_date": 1495044282, "post_id": 44031920, "comment_id": 75090388, "body": "Ah, so you mean, at the end when I call print helper on itself with all the same stuff it was originally called with, instead make that a while loop? I think that makes sense"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 23, "user_id": 7282616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/441c6903353055f0b850954b86cd079b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7282616/joe"}, "edited": false, "score": 0, "creation_date": 1495044415, "post_id": 44031920, "comment_id": 75090467, "body": "@Joe Not just the end.  Start the function by calling <code>opendir</code>, then use <code>while ((entry = readdir(dir)) != NULL)</code> the read the entries, then <code>closedir</code> at the end."}, {"owner": {"reputation": 23, "user_id": 7282616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/441c6903353055f0b850954b86cd079b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7282616/joe"}, "edited": false, "score": 0, "creation_date": 1495044606, "post_id": 44031920, "comment_id": 75090561, "body": "Yeah I&#39;ve got that in now. Thanks so much. I was seriously stumped."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1495044109, "creation_date": 1495044109, "answer_id": 44031920, "question_id": 44031792, "link": "https://stackoverflow.com/questions/44031792/seg-faults-when-writing-my-own-find-program/44031920#44031920", "title": "Seg faults when writing my own find program", "body": "<p>You have a recursive call for every <strong>file</strong> that you're processing.  The call stack will get deep fast and you'll overflow the stack.</p>\n\n<p>Change the code to recurse on each directory instead of each file.  Have the function accept just a directory path.  Then open the directory and use a <code>while</code> loop to go through each entry.  If the entry is a directory, <em>then</em> make a recursive call with the name of the subdirectory.</p>\n"}], "owner": {"reputation": 23, "user_id": 7282616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/441c6903353055f0b850954b86cd079b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7282616/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44031920, "answer_count": 1, "score": 2, "last_activity_date": 1495044176, "creation_date": 1495043657, "last_edit_date": 1495044176, "question_id": 44031792, "link": "https://stackoverflow.com/questions/44031792/seg-faults-when-writing-my-own-find-program", "title": "Seg faults when writing my own find program", "body": "<p>So just to clarify. This is for a school assignment. We are writing a simplified find program (sfind), and I am running into an issue.</p>\n\n<p>Basically, the -print flag works perfectly in any situation where there isn't a huge amount to look at. However, when I try to run it from my base directory, (which has a large amount of files) I eventually run into seg faults. I feel this could be for any number of reasons. </p>\n\n<ol>\n<li>My user process limit is too low</li>\n<li>My max file size is too low</li>\n<li>I am getting stack overflow for too deep of recursion</li>\n<li>Some other thing I am overlooking</li>\n</ol>\n\n<p>I am running this on ubuntu, and it will eventaully be turned in on a Unix server.</p>\n\n<p>Here is my current recursion code.</p>\n\n<pre><code>int printHelper(struct dirent *entry, DIR *dir, char* path){\n    struct stat fileStat;\n    DIR *tempDir;\n    char tempPath[1000];\n    char const* name = entry-&gt;d_name;\n    strcpy(tempPath, path);\n    strcat(tempPath, name);\n    lstat(tempPath, &amp;fileStat);\n    if(strcmp(name, \".\") != 0 &amp;&amp; strcmp(name, \"..\") != 0){\n        printf(\"%s%s\\n\", path, name);\n    }\n    if((S_ISDIR(fileStat.st_mode)) &amp;&amp; (strcmp(name, \".\") != 0) &amp;&amp; (strcmp(name, \"..\") != 0)){\n        struct dirent *tempEntr;\n        char newTempPath[1000];\n        char newPathName[1000];\n        strcpy(newPathName, name);\n        strcpy(newTempPath, path);\n        strcat(newTempPath, newPathName);\n        strcat(newTempPath, slashPath);\n        tempDir = opendir(newTempPath);\n        tempEntr = readdir(tempDir);\n        printHelper(tempEntr, tempDir, newTempPath);\n        closedir(tempDir);\n    }\n    if(!(entry = readdir(dir))){\n            return 0;\n    }\n    printHelper(entry, dir, path);\n    return 0;\n}\n</code></pre>\n\n<p>Here is the beginning of the file</p>\n\n<pre><code>#include &lt;sys/stat.h&gt;\n#include &lt;sys/resource.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include \"myPrint.h\"\n\nchar slashPath[3] = \"/\\0\";\n\nint myPrint(char const* myFile){\n    DIR *dir;\n    struct dirent *entry;\n\n    int isDir;\n    isDir = 1;\n\n    if (!(dir = opendir(myFile))){\n        isDir = 0;\n    }\n    else if (!(entry = readdir(dir))){\n        return -1;\n    }\n    if(isDir == 0){\n        dir = opendir(\".\");\n        while((entry = readdir(dir))){\n            if(strcmp(myFile, entry-&gt;d_name) == 0){\n                printf(\"%s\\n\", myFile);\n                return 0;\n            }\n        }\n        printf(\"find: \u2018%s\u2019: No such file or directory\\n\", myFile);\n        return 0;\n    }\n    else{\n        char path[2000];\n        strcpy(path, myFile);\n        strcat(path, slashPath);\n        printf(\"%s\\n\", myFile);\n        printHelper(entry, dir, path);\n        return 0;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "windows", "sockets", "winsock"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1495043228, "post_id": 44031553, "comment_id": 75089770, "body": "Yes there is a way. Have a list and add to it. Then print it. What is the actual question?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495043238, "post_id": 44031553, "comment_id": 75089774, "body": "Have a look at <code>man QUEUE</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8026959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d6c5d1f2eed8ba6de2b49439ef7154?s=128&d=identicon&r=PG&f=1", "display_name": "0verfl0w", "link": "https://stackoverflow.com/users/8026959/0verfl0w"}, "edited": false, "score": 0, "creation_date": 1495047026, "post_id": 44031933, "comment_id": 75091828, "body": "Thanks that helped a lot!"}], "tags": [], "owner": {"reputation": 366, "user_id": 8024984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60731b46db8858e14685f07fef1eb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail Romanko", "link": "https://stackoverflow.com/users/8024984/mikhail-romanko"}, "is_accepted": true, "score": 0, "last_activity_date": 1495044172, "creation_date": 1495044172, "answer_id": 44031933, "question_id": 44031553, "link": "https://stackoverflow.com/questions/44031553/adding-connected-clients-to-a-list-c/44031933#44031933", "title": "Adding Connected Clients To A List - C", "body": "<p>Here goes the answer: yes, you actualy can do this, just follow the steps:</p>\n\n<ol>\n<li>Create socket for server</li>\n<li><p>Set it to NONBLOCKING mode with following code:</p>\n\n<p>fcntl(sock, F_SETFL, O_NONBLOCK);</p></li>\n<li><p>Bind it and set listening for it</p></li>\n<li>Accept socket (check for -1 and errno (if -1 and errno set to EWOULDBLOCK then there is no clients that want to connect to your server))</li>\n<li>Set them to NONBLOCKING mode.</li>\n<li>Store sockaddr* (sockaddr_in or sockaddr_in6) and client socket</li>\n<li>Repeat steps 4 - 6</li>\n<li>Now multiple clients connected to your server.</li>\n<li>Check when write or read from clients for -1 and errno (for disconect detection)</li>\n</ol>\n\n<p>And remember! ALWAYS CHECK THE RETURN VALUES. Otherwise you may be in trouble. Also check the <a href=\"http://man7.org/linux/man-pages/man7/ip.7.html\" rel=\"nofollow noreferrer\">IP man pages</a> for linux networking.</p>\n"}], "owner": {"reputation": 3, "user_id": 8026959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d6c5d1f2eed8ba6de2b49439ef7154?s=128&d=identicon&r=PG&f=1", "display_name": "0verfl0w", "link": "https://stackoverflow.com/users/8026959/0verfl0w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 44031933, "answer_count": 1, "score": 0, "last_activity_date": 1495044172, "creation_date": 1495042756, "question_id": 44031553, "link": "https://stackoverflow.com/questions/44031553/adding-connected-clients-to-a-list-c", "title": "Adding Connected Clients To A List - C", "body": "<p>I have created a client and server, both written in C, and am now looking at editing the server to handle multiple clients. The question I have is: Is there any way I can add the incoming connections/connected clients to a list that could be printed to the terminal? For example:</p>\n\n<p>Connected Clients:</p>\n\n<p>[1] Client 1</p>\n\n<p>[2] Client 2</p>\n\n<p>I am using raw sockets for this. The server runs on Linux using raw sockets and the client runs on windows using WinSock2 and so far seems to run well.</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1495042130, "post_id": 44031333, "comment_id": 75089151, "body": "There are many ways of doing <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">Inter-Process Communications (IPC)</a>. Read about them, search for how they are implemented in a POSIX (Unix, Linux, macOS) environment, and experiment."}, {"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1495043348, "post_id": 44031333, "comment_id": 75089846, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16400820/c-how-to-use-posix-semaphores-on-forked-processes\">C, how to use POSIX semaphores on forked processes?</a>"}, {"owner": {"reputation": 1033, "user_id": 3410010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFRd3.jpg?s=128&g=1", "display_name": "yadhu", "link": "https://stackoverflow.com/users/3410010/yadhu"}, "edited": false, "score": 0, "creation_date": 1495067700, "post_id": 44031333, "comment_id": 75100205, "body": "You can pipes to communicate between the processes. Pipes are very simple and standard way to communicate between the two processes."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1495199058, "post_id": 44031333, "comment_id": 75165642, "body": "Isn&#39;t thinks asking for an atomic?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495374537, "post_id": 44031333, "comment_id": 75215930, "body": "there are a number of system functions that are NOT to be placed in a signal handler, <code>printf()</code> is one of the system functions to NOT use.  Suggest having the signal handler function set a variable.  Then have the main function be checking/polling that variable, when the variable is set, then call <code>printf()</code> and unset the variable.  (actually safer to have the signal handler increment the variable, have the main() checking for when the variable changes, then decrement the variable and call <code>printf()</code>"}], "owner": {"reputation": 2070, "user_id": 6193113, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/1692333061036108/picture?type=large", "display_name": "Phocs", "link": "https://stackoverflow.com/users/6193113/phocs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495174692, "creation_date": 1495042004, "last_edit_date": 1495056600, "question_id": 44031333, "link": "https://stackoverflow.com/questions/44031333/to-share-an-unsigned-int-between-parent-and-child-after-fork", "title": "To share an unsigned int between parent and child after fork()?", "body": "<p>I'm trying to write a small program that generates a child process with fork() that will have to increase a variable shared with the parent, how do I share an unsigned int variable?</p>\n\n<p>code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\n\nstatic unsigned int elapsed;\n\nint count(){\n    while(1){\n        sleep(1);\n        elapsed++;\n    }\n    exit(EXIT_SUCCESS);\n}\n\nvoid hadler(int sig){\n    if( sig == SIGUSR1){\n        printf(\"elapsed: %u\\n\", elapsed);\n    }\n\n}\n\nint main(){\n    pid_t pid = getpid();\n    printf(\"This is my pid: %d\\n\", pid);\n    pid = fork();\n    if(pid == 0)\n        count();\n\n    while(1){\n        signal(SIGUSR1, hadler);\n    }\n}\n</code></pre>\n\n<p>You can see there is a child than exec count() (increase a variable \"elapsed\" every second). The parent is waiting for SIGUSR1, when receive the signal he print the \"elapsed\".\nNaively I tried to use a static global variable but it doesn't work for obvious reasons.</p>\n"}, {"tags": ["c", "linux", "unix", "gdb"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1495041192, "post_id": 44031072, "comment_id": 75088589, "body": "You see that the <code>install</code> program is using the <code>--strip</code> option? That is what stips debug information. Also, <code>-g3</code> is just <code>-g</code> but with more information added, no need to change that."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1495042723, "post_id": 44031072, "comment_id": 75089499, "body": "Also, you may need to <code>make clean</code> or <code>make -B</code> to recompile if you change only the Makefile"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1495042766, "post_id": 44031072, "comment_id": 75089515, "body": "Use <code>file</code> to quickly show whether symbols are present."}], "answers": [{"tags": [], "owner": {"reputation": 413, "user_id": 3676886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJeQv.jpg?s=128&g=1", "display_name": "HenryGiraldo", "link": "https://stackoverflow.com/users/3676886/henrygiraldo"}, "is_accepted": false, "score": 1, "last_activity_date": 1495048401, "last_edit_date": 1495048401, "creation_date": 1495046102, "answer_id": 44032444, "question_id": 44031072, "link": "https://stackoverflow.com/questions/44031072/why-does-not-created-gdb-symbols-when-i-compiled-with-g-option/44032444#44032444", "title": "why does not created gdb symbols when I compiled with -g option", "body": "<p>strip option discards all symbols from object files.  It is used for production objects to be light weight.</p>\n\n<p>To ensure that it is the strip option, run the gdb before installing it.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7255735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c186ec9a5172395f3c61a20e433e5eeb?s=128&d=identicon&r=PG", "display_name": "ryfjwr", "link": "https://stackoverflow.com/users/7255735/ryfjwr"}, "edited": false, "score": 0, "creation_date": 1495197961, "post_id": 44037656, "comment_id": 75164823, "body": "Thanks! I can attach the built &quot;top&quot; process with gdb! Because of your clear example, I learned how gdb options work. I&#39;ll continue to study from the source codes."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1495074804, "creation_date": 1495074804, "answer_id": 44037656, "question_id": 44031072, "link": "https://stackoverflow.com/questions/44031072/why-does-not-created-gdb-symbols-when-i-compiled-with-g-option/44037656#44037656", "title": "why does not created gdb symbols when I compiled with -g option", "body": "<blockquote>\n  <p><code>sudo make install DESTDIR=/tmp/sample</code></p>\n</blockquote>\n\n<p>It is very common for <code>make install</code> to strip the binaries that are installed.</p>\n\n<blockquote>\n  <p><code>install -D --owner 0 --group 0 --mode a=rx --strip top</code></p>\n</blockquote>\n\n<p>And that's exactly what happened here (note the <code>--strip</code> above).</p>\n\n<p>You can either debug the original executable:</p>\n\n<pre><code>gdb ./top\n</code></pre>\n\n<p>or debug the installed <code>/tmp/sample/usr/bin/top</code> while using the original binary as symbol file:</p>\n\n<pre><code>gdb /tmp/sample/usr/bin/top\n(gdb) symbol-file ./top\n(gdb) run\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7255735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c186ec9a5172395f3c61a20e433e5eeb?s=128&d=identicon&r=PG", "display_name": "ryfjwr", "link": "https://stackoverflow.com/users/7255735/ryfjwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1495074804, "creation_date": 1495041083, "question_id": 44031072, "link": "https://stackoverflow.com/questions/44031072/why-does-not-created-gdb-symbols-when-i-compiled-with-g-option", "title": "why does not created gdb symbols when I compiled with -g option", "body": "<p>To know how unix command works, I build <a href=\"https://github.com/soarpenguin/procps-3.0.5\" rel=\"nofollow noreferrer\">procps</a>.</p>\n\n<p>Here is my procedure, </p>\n\n<pre><code>$ git clone git@github.com:soarpenguin/procps-3.0.5.git\n$ cd procps-3.0.5\n</code></pre>\n\n<ul>\n<li>then, I modified Makefile <a href=\"https://github.com/soarpenguin/procps-3.0.5/blob/master/Makefile#L68\" rel=\"nofollow noreferrer\">this line</a> </li>\n<li>just changed option <code>-g3</code> => <code>-g</code></li>\n</ul>\n\n<p><strong>before</strong></p>\n\n<pre><code>CFLAGS := -D_GNU_SOURCE -O2 -g3 -fno-common -ffast-math -I proc\n</code></pre>\n\n<p><strong>after</strong></p>\n\n<pre><code>CFLAGS := -D_GNU_SOURCE -O2 -g -fno-common -ffast-math -I proc\n</code></pre>\n\n<p>after that </p>\n\n<pre><code>   $ mkdir /tmp/sample\n   $ make \n   $ sudo make install DESTDIR=/tmp/sample\n   install -D --owner 0 --group 0 --mode a=rx --strip top \n   /tmp/sample/usr/bin/top\n   $ ls /tmp/sample/usr/bin/ |grep top\n   top\n</code></pre>\n\n<h1>Question</h1>\n\n<p>Somehow I add <code>-g</code> option, gdb can't read symbol, why?<br>\nespecialy <code>no debugging symbols found</code> </p>\n\n<pre><code>$ gdb /tmp/sample/usr/bin/top\nGNU gdb (GDB) Red Hat Enterprise Linux (7.2-92.el6)\nCopyright (C) 2010 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-redhat-linux-gnu\".\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;...\nReading symbols from /tmp/sample/usr/bin/top...(no debugging symbols found)...done.\n</code></pre>\n\n<h1>my environment</h1>\n\n<pre><code>$ cat /etc/system-release\nCentOS release 6.9 (Final)\n\n$ gdb -v\nGNU gdb (GDB) Red Hat Enterprise Linux (7.2-92.el6)\nCopyright (C) 2010 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later \n&lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\" and \"show warranty\" for details.\nThis GDB was configured as \"x86_64-redhat-linux-gnu\".\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\n</code></pre>\n"}, {"tags": ["c", "opacity", "sdl-2"], "comments": [{"owner": {"reputation": 1942, "user_id": 969365, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1EnZd.png?s=128&g=1", "display_name": "simon", "link": "https://stackoverflow.com/users/969365/simon"}, "edited": false, "score": 1, "creation_date": 1495048391, "post_id": 44030993, "comment_id": 75092534, "body": "Did you check the returned value of <code>SDL_SetTextureAlphaMod</code>? &quot;Alpha modulation is not always supported by the renderer; it will return -1 if alpha modulation is not supported.&quot; <a href=\"https://wiki.libsdl.org/SDL_SetTextureAlphaMod\" rel=\"nofollow noreferrer\">wiki.libsdl.org/SDL_SetTextureAlphaMod</a>"}, {"owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "reply_to_user": {"reputation": 1942, "user_id": 969365, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1EnZd.png?s=128&g=1", "display_name": "simon", "link": "https://stackoverflow.com/users/969365/simon"}, "edited": false, "score": 0, "creation_date": 1495048469, "post_id": 44030993, "comment_id": 75092570, "body": "As I said in the post, I checked: &quot;I have to add that I don&#39;t have any error with <code>SDL_RENDERER_ACCELERATED</code>.&quot;"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1495053222, "post_id": 44030993, "comment_id": 75095256, "body": "Edit in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  OS?  SDL_Renderer backend?  SDL2 version?"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "is_accepted": true, "score": 3, "last_activity_date": 1495110978, "creation_date": 1495110978, "answer_id": 44047958, "question_id": 44030993, "link": "https://stackoverflow.com/questions/44030993/sdl-settexturealphamod-has-no-effect-with-sdl-renderer-accelerated/44047958#44047958", "title": "SDL_SetTextureAlphaMod has no effect with SDL_RENDERER_ACCELERATED", "body": "<p>I just had to add:</p>\n\n<pre><code>SDL_SetTextureBlendMode(my_texture, SDL_BLENDMODE_BLEND);\n</code></pre>\n\n<p>To get it working with any image, before setting <code>SDL_SetTextureAlphaMod</code>.</p>\n"}], "owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 44047958, "answer_count": 1, "score": 1, "last_activity_date": 1495110978, "creation_date": 1495040812, "last_edit_date": 1495053853, "question_id": 44030993, "link": "https://stackoverflow.com/questions/44030993/sdl-settexturealphamod-has-no-effect-with-sdl-renderer-accelerated", "title": "SDL_SetTextureAlphaMod has no effect with SDL_RENDERER_ACCELERATED", "body": "<h2>Context</h2>\n\n<p>I have an image loaded with SDL2. I can display it without any problem with <code>SDL_RenderCopy</code> or <code>SDL_RenderCopyEx</code>. I want now to change the opacity of my image.</p>\n\n<h2>What I tried</h2>\n\n<p>I tried using <code>SDL_SetTextureAlphaMod</code> according to the documentation.</p>\n\n<pre><code>SDL_SetTextureAlphaMod(my_texture, 122);\n</code></pre>\n\n<p>It was not working. I tried to put it before <code>SDL_RenderClear</code>, after <code>SDL_RenderClear</code> and even after <code>SDL_RenderCopy</code>. None of these worked. </p>\n\n<p>After that, I tried to change my renderer from <code>SDL_RENDERER_ACCELERATED</code> to <code>SDL_RENDERER_SOFTWARE</code> and... it worked. However, it's obviously slower than with <code>SDL_RENDERER_ACCELERATED</code>.</p>\n\n<p>I have to add that I don't have any error with <code>SDL_RENDERER_ACCELERATED</code>. No error but no result. </p>\n\n<h2>What I want to do</h2>\n\n<p>I want a way to change the opacity of my image with <code>SDL_RENDERER_ACCELERATED</code> instead of <code>SDL_RENDERER_SOFTWARE</code>.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I tried using <code>SDL_Image</code> and now I only have issues when loading a BMP image. I think I should convert the BMP into another format. Any idea?</p>\n\n<p>I have the issue on both Windows and Linux and I'm using SDL 2.0.5.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 1, "creation_date": 1495040105, "post_id": 44030773, "comment_id": 75087923, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimum, Complete, and Verifiable Example</a>"}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 1, "creation_date": 1495040335, "post_id": 44030773, "comment_id": 75088058, "body": "Now is a good time to lean how to use a debugger. It is your most important tool. Really."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1495040451, "post_id": 44030773, "comment_id": 75088141, "body": "What @OldProgrammer says above, for sure.  That, and did you mean &#39;LInt aux=*r;&#39;?  What is type of  &#39;r&#39;?    Did you maybe mean &#39;&amp;r&#39; ??"}, {"owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "reply_to_user": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1495040501, "post_id": 44030773, "comment_id": 75088176, "body": "@c650 i would love to, but I&#39;m using codeboard and it seems like i can&#39;t see what the tests are, it just says if you done well or now (university teachers idea)"}, {"owner": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "edited": false, "score": 2, "creation_date": 1495040568, "post_id": 44030773, "comment_id": 75088219, "body": "For this to work, <code>r</code> must be a pointer to an already existing linked list with a mininum length of the sum of then lenghts of <code>l1</code>  and <code>l2</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495040614, "post_id": 44030773, "comment_id": 75088238, "body": "<code>aux-&gt;valor=l1-&gt;valor, l1=l1-&gt;prox;</code> Are you sure that should be a comma? It looks like it should be a semicolon. It shouldn&#39;t be a problem, but it looks a bit odd."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495040625, "post_id": 44030773, "comment_id": 75088255, "body": "@Bruno giving out software development assignmetns without access to a debugger is like soccer practice with no pitch.  Tell your teacher s/he&#39;s an.. no, just say it&#39;s silly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495040666, "post_id": 44030773, "comment_id": 75088292, "body": "<b>Never ever</b> <code>typedef</code> a data pointer!"}, {"owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495040874, "post_id": 44030773, "comment_id": 75088411, "body": "@ThingyWotsit r is the 1st argument and it&#39;s LInt *r, but I say LInt aux=*r because for me it&#39;s an easy way to work at the beginning."}, {"owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495041225, "post_id": 44030773, "comment_id": 75088608, "body": "@IanAbbott i guess it can be yeah, but It doesn&#39;t solve the issue that I&#39;m having!"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495041372, "post_id": 44030773, "comment_id": 75088703, "body": "I think the segmentation fault is due to something outside the code you posted."}, {"owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "reply_to_user": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "edited": false, "score": 1, "creation_date": 1495041381, "post_id": 44030773, "comment_id": 75088706, "body": "@ErichKitzmueller i did forgot about allocating memmory yeah..."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495041502, "post_id": 44030773, "comment_id": 75088794, "body": "Do you need to keep the original lists <code>l1</code> and <code>l2</code> after the merge, or are you allowed to destroy them while creating the merged list?"}, {"owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495041537, "post_id": 44030773, "comment_id": 75088818, "body": "@IanAbbott I can see now a test, and the test is Input: [ ] + [  1  3  5  7  9 11 13 15 17 19 ] Output: expected [  1  3  5  7  9 11 13 15 17 19 ]         obtained [ ]"}, {"owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495041598, "post_id": 44030773, "comment_id": 75088858, "body": "@IanAbbott I&#39;m allowed to destroy them"}], "answers": [{"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 2, "last_activity_date": 1495043322, "last_edit_date": 1495043322, "creation_date": 1495042328, "answer_id": 44031437, "question_id": 44030773, "link": "https://stackoverflow.com/questions/44030773/why-am-i-having-segmentation-fault/44031437#44031437", "title": "Why am I having segmentation fault?", "body": "<p>Here is (one phase of) a destructive merge sort.  It moves the elements of lists <code>l1</code> and <code>l2</code> (which are already sorted) onto the merged list.</p>\n\n<pre><code>typedef struct lligada {\n    int valor;\n    struct lligada *prox;\n} *LInt;\n\nvoid merge(LInt *r, LInt l1, LInt l2) {\n    while (l1 &amp;&amp; l2) {\n        if (l1-&gt;valor &lt;= l2-&gt;valor) {\n            *r = l1;\n            l1 = l1-&gt;prox;\n        } else {\n            *r = l2;\n            l2 = l2-&gt;prox;\n        }\n        r = &amp;(*r)-&gt;prox;\n    }\n    if (l1) {\n        *r = l1;\n    } else {\n        *r = l2;\n    }\n}\n</code></pre>\n\n<p>An alternative to assigning <code>r = &amp;(*)-&gt;prox;</code> after the <code>if/else</code> statement, is to assign <code>r</code> within the <code>if</code> and <code>else</code> parts, e.g.:</p>\n\n<pre><code>        if (l1-&gt;valor &lt;= l2-&gt;valor) {\n            *r = l1;\n            r = &amp;l1-&gt;prox; // &lt;-- this and ...\n            l1 = l1-&gt;prox;\n        } else {\n            *r = l2;\n            r = &amp;l2-&gt;prox; // &lt;-- ... this are alternative ... \n            l2 = l2-&gt;prox;\n        }\n        // r = &amp;(*r)-&gt;prox; // &lt;-- ... to this\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7158004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ipcGX.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7158004/bruno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 44031437, "answer_count": 1, "score": -1, "last_activity_date": 1495043322, "creation_date": 1495040057, "last_edit_date": 1495040588, "question_id": 44030773, "link": "https://stackoverflow.com/questions/44030773/why-am-i-having-segmentation-fault", "title": "Why am I having segmentation fault?", "body": "<p>I am working with this type (new at it):</p>\n\n<pre><code>typedef struct lligada {\n    int valor;\n    struct lligada *prox;\n} *LInt;\n</code></pre>\n\n<p>And I was trying to do a function that takes ordered \"LInt\" and merge them into one ordered \"LInt\".</p>\n\n<pre><code>void merge (LInt *r, LInt l1, LInt l2){\n\n    LInt aux=*r;\n    for (; l1!=NULL &amp;&amp; l2!=NULL;aux=aux-&gt;prox){\n        if (l1-&gt;valor &lt;= l2-&gt;valor){ aux-&gt;valor=l1-&gt;valor, l1=l1-&gt;prox;}\n        else {aux-&gt;valor=l2-&gt;valor, l2=l2-&gt;prox;}\n    }\n    while (l1!=NULL){\n        aux-&gt;valor=l1-&gt;valor;\n        l1=l1-&gt;prox;\n        aux=aux-&gt;prox;\n    }\n    while (l2!=NULL){\n        aux-&gt;valor=l2-&gt;valor;\n        l2=l2-&gt;prox;\n        aux=aux-&gt;prox;\n    }\n    aux=NULL;\n}\n</code></pre>\n\n<p>I'm having segmentation fault and I don't know why.</p>\n"}, {"tags": ["c", "struct", "scanf", "bit"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1495039098, "post_id": 44030426, "comment_id": 75087348, "body": "<code>%d</code> is a format specifier for <code>int</code>, which is likely to be 32 bits long. But you are using it to <code>scanf</code> an 8-bit value. So it is corrupting the adjacent bytes as well."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1495044502, "post_id": 44030426, "comment_id": 75090517, "body": "With <code>scanf()</code>, <code>&quot;%d&quot;</code> has a corresponding argument of a pointer to signed integer such as <code>int *</code>.  <code>&amp;(time-&gt;hours)</code> is type <code>uint8_t *</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 10, "last_activity_date": 1495041101, "last_edit_date": 1495540986, "creation_date": 1495039203, "answer_id": 44030498, "question_id": 44030426, "link": "https://stackoverflow.com/questions/44030426/using-scanf-to-read-uint8-t-data/44030498#44030498", "title": "Using scanf to read uint8_t data", "body": "<p>After including <code>#include &lt;inttypes.h&gt;</code>, change:</p>\n\n<pre><code>scanf(\"%d\",&amp;(time-&gt;hours));\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>scanf(\"%\" SCNu8, &amp;(time-&gt;hours));\n</code></pre>\n\n<p>in all your scanf's, so that you read for uint8_t, instead of an int.</p>\n\n<hr>\n\n<p>The observation you made relates to that, you were reading with <code>%d</code> specifier, which designated for type <code>int</code>, which is usually <a href=\"https://stackoverflow.com/questions/11438794/is-the-size-of-c-int-2-bytes-or-4-bytes\">32</a> bits. So when you assign the read value to <code>time-&gt;hours</code>, then it would \"overflow\" to the adjacent struct fields as well.</p>\n\n<hr>\n\n<p>Next time, please enable your compiler's warning, and you should get something like this:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -Wall main.c \nmain.c:32:16: warning: format specifies type 'int *' but the argument has type\n      'uint8_t *' (aka 'unsigned char *') [-Wformat]\n    scanf(\"%d\",&amp;(time-&gt;hours));\n           ~~  ^~~~~~~~~~~~~~\n           %s\nmain.c:34:16: warning: format specifies type 'int *' but the argument has type\n      'uint8_t *' (aka 'unsigned char *') [-Wformat]\n    scanf(\"%d\",&amp;(time-&gt;minutes));\n           ~~  ^~~~~~~~~~~~~~~~\n           %s\nmain.c:40:16: warning: format specifies type 'int *' but the argument has type\n      'uint8_t *' (aka 'unsigned char *') [-Wformat]\n    scanf(\"%d\",&amp;(date-&gt;month));\n           ~~  ^~~~~~~~~~~~~~\n           %s\n3 warnings generated.\n</code></pre>\n\n<p>I used <strong>Wall</strong> compiler flag, as I discuss in this <a href=\"https://stackoverflow.com/a/43963348/2411320\">answer</a>.</p>\n"}], "owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3233, "favorite_count": 0, "accepted_answer_id": 44030498, "answer_count": 1, "score": 4, "last_activity_date": 1495041101, "creation_date": 1495038917, "last_edit_date": 1495040558, "question_id": 44030426, "link": "https://stackoverflow.com/questions/44030426/using-scanf-to-read-uint8-t-data", "title": "Using scanf to read uint8_t data", "body": "<p>I have written a simple C program to read hours and minutes and then add them together. But it is not getting added and <code>currentHrMin</code> is printing only the value of minutes. However if <code>getCurrentDate(&amp;dateParams)</code> is called after printing <code>currentHrMin</code>, there is no issue. I am not able to find out what is wrong with my code. Could be a silly issue. I am using MinGW C compiler.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n#define BCD_TO_DEC(num) ((((num)&amp;0xF0)&gt;&gt;4)*10+((num)&amp;0x0F))\n#define DEC_TO_BCD(num) ((((num)/10) &lt;&lt; 4) | ((num) % 10))\n\n\nstruct RTC_TIME\n{\n    uint8_t hours;\n    uint8_t minutes;\n    uint8_t seconds;\n    uint8_t twelveHourFormat:1; //1 = 12 hour format, 0=24 hour format.\n    uint8_t AM_0_PM_1:1;\n    uint8_t hours24Format;\n    uint8_t alarm1State:1;\n    uint8_t alarm2State:1;\n};\n\nstruct RTC_DATE\n{\n    uint8_t date;\n    uint8_t month;\n    uint8_t dayOfWeek;\n    uint8_t year;\n};\n\n\nvoid getCurrentTime(struct RTC_TIME* time)\n{\n    printf(\"Enter Hour: \");\n    scanf(\"%d\",&amp;(time-&gt;hours));\n    printf(\"Enter Min: \");\n    scanf(\"%d\",&amp;(time-&gt;minutes));\n}\n\nvoid getCurrentDate(struct RTC_DATE* date)\n{\n    printf(\"Enter Month: \");\n    scanf(\"%d\",&amp;(date-&gt;month));\n}\n\nint ar1[5]= {0x1253,0x1034,0x0804,0x1112,0x0409};\n\nint main(void)\n{\n    struct RTC_DATE dateParams;\n    struct RTC_TIME timeParams;\n\n    getCurrentTime(&amp;timeParams);\n    getCurrentDate(&amp;dateParams);\n    uint16_t currentHrMin = timeParams.hours*60 + timeParams.minutes;\n    printf(\"Current hour minute = %d\\n\",currentHrMin);\n\n    return(0);\n\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "server", "ftp"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1495036093, "post_id": 44029454, "comment_id": 75085465, "body": "You know which local interface the current FTP connection is using. Bind to <i>that</i> interface (with a random port)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1495036426, "post_id": 44029454, "comment_id": 75085731, "body": "Binding to <code>INADDR_ANY</code> as you do now should work.  It would be cleaner, however, to bind only to the address the client is using.  I think you can get that by using <code>getsockname()</code> on the <i>connected</i> socket (for the command connection) instead of on the listening socket."}, {"owner": {"reputation": 99, "user_id": 3848783, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1682568654/picture?type=large", "display_name": "Theo Champion", "link": "https://stackoverflow.com/users/3848783/theo-champion"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1495037395, "post_id": 44029454, "comment_id": 75086368, "body": "@Someprogrammerdude How do I know on which interface my current FTP connection is using ?"}, {"owner": {"reputation": 99, "user_id": 3848783, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1682568654/picture?type=large", "display_name": "Theo Champion", "link": "https://stackoverflow.com/users/3848783/theo-champion"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1495037638, "post_id": 44029454, "comment_id": 75086515, "body": "@JohnBollinger So I here I just getsockname the command connection socket and save the addr and bind to that with my data connection socket ? Those address will always be the same ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1495064922, "post_id": 44029454, "comment_id": 75099505, "body": "@JohnBollinger: &quot;<i>when the client attempts to establish the data connection, it will try to connect to the same machine with which it has already established the command connection</i>&quot; - per the FTP spec, the client is <i>supposed</i> to connect to whatever IP the server says, which can be any IP the server wants, even one for another machine if it so chooses. In reality, FTP clients usually have an option to ignore the server&#39;s stated IP and just use the already-connected IP, which <i>usually</i> is fine."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1495112951, "post_id": 44029454, "comment_id": 75122596, "body": "@RemyLebeau, you are quite right.  thank you for that correction (previous comment deleted).  Theo: that does not change the fact that the IP address with which the client has established the command connection -- which should be obtainable from the connected socket -- is demonstrably an address reachable to it, modulo NAT.  If the server has to determine contextually what address to specify to the client (as opposed to being explicitly configured with that data) then I see no better address to choose."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1495065655, "creation_date": 1495065655, "answer_id": 44036530, "question_id": 44029454, "link": "https://stackoverflow.com/questions/44029454/socket-how-to-find-local-address-when-binded-with-inaddr-any/44036530#44036530", "title": "Socket, how to find local address when binded with INADDR_ANY", "body": "<blockquote>\n  <p>What I do step by step is:</p>\n  \n  <ol>\n  <li>Create a server socket with INADDR_ANY and random port (port 0)</li>\n  <li>listen() with this socket</li>\n  <li>getsockname() this socket to get it's infos</li>\n  <li>send back the infos to the client on the command connection</li>\n  <li>the accept() is done later, when the user need to use the data con</li>\n  </ol>\n  \n  <p>(Is that the right way to do it ?)</p>\n</blockquote>\n\n<p>In general, yes, however steps #1 and #3 tend to be more complicated than that.</p>\n\n<p>For one thing, <code>getsockname()</code> cannot get the true IP until the socket is actually connected to someone (which, in this case, means you would have to call <code>getsockname()</code> on the socket returned by <code>accept()</code>, not on the socket that you call <code>accept()</code> on).  So, when binding to <code>INADDR_ANY</code>, you should just report the IP of the interface that the command socket is connected to.  In which case, it is better to just bind the listening socket to only that interface directly and not to <code>INAADDR_ANY</code> at all.</p>\n\n<p>For another thing, even if the server machine only has 1 interface installed, if the server is behind a NAT router, and the client is outside the NAT, then you would have to report the router's public IP instead of your server's listening IP.  You would have to know the router's public IP ahead of time, either by storing it in your app's configuration, or by dynamically querying the router itself via uPNP, or by querying an outside service like <code>http://iplookup.flashfxp.com/</code>.  Unless the router is FTP-aware (some are) and is smart enough to replace the reported IP for you when passing through the router, in which case you do have to report your listening IP instead.</p>\n"}, {"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 1, "last_activity_date": 1495065964, "creation_date": 1495065964, "answer_id": 44036582, "question_id": 44029454, "link": "https://stackoverflow.com/questions/44029454/socket-how-to-find-local-address-when-binded-with-inaddr-any/44036582#44036582", "title": "Socket, how to find local address when binded with INADDR_ANY", "body": "<p>You should call <code>getsockname()</code> on the command socket. That gives you the IP address the client used to connect to you. It can be different for each client on a multi-homed host. If you're behind a NAT device you should use its public IP address, which you will have to obtain via configuration.</p>\n"}], "owner": {"reputation": 99, "user_id": 3848783, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1682568654/picture?type=large", "display_name": "Theo Champion", "link": "https://stackoverflow.com/users/3848783/theo-champion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1495065964, "creation_date": 1495035948, "question_id": 44029454, "link": "https://stackoverflow.com/questions/44029454/socket-how-to-find-local-address-when-binded-with-inaddr-any", "title": "Socket, how to find local address when binded with INADDR_ANY", "body": "<p>I'm recoding a simple ftp server and I'm stuck of the implemetation of the PASV command.</p>\n\n<p>In fact, when the client send a PASV command, I have to create a new server socket and send back the infos (address and port) to the client so that he can connect to it to create the data connection.</p>\n\n<p>What I do step by step is:</p>\n\n<ol>\n<li>Create a server socket with INADDR_ANY and random port (port 0)</li>\n<li>listen() with this socket</li>\n<li>getsockname() this socket to get it's infos</li>\n<li>send back the infos to the client on the command connection</li>\n<li>the accept() is done later, when the user need to use the data con</li>\n</ol>\n\n<p>(Is that the right way to do it ?)</p>\n\n<p>The thing is, the server socket that I create on the server side is binded with INADDR_ANY so getsockname() on it always return 0.0.0.0 (cause it is binded to virtually all the ips off the system).</p>\n\n<p>Is that case, what address should I send back to the client and how to find it ?</p>\n\n<p>How real ftp servers handle this ?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["c", "pointers", "linked-list", "typedef"], "comments": [{"owner": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "edited": false, "score": 0, "creation_date": 1495035234, "post_id": 44029183, "comment_id": 75084848, "body": "Why don&#39;t you check the core dump then?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495035331, "post_id": 44029183, "comment_id": 75084919, "body": "It makes a lot of difference whether it is circular or not. Please clarify what you want."}, {"owner": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1495035422, "post_id": 44029183, "comment_id": 75084985, "body": "<i>Where</i> have you tried your <code>malloc</code>? You first need to <code>malloc</code> your new_list, then your head and tail.  You can&#39;t dereference a list that&#39;s not there."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1495035848, "post_id": 44029183, "comment_id": 75085281, "body": "As a side note, <code>head</code> and <code>tail</code> nodes of your empty list are not connected. Is this intentional? I think you want want <code>create_new_list</code> to make both <code>head</code> and <code>tail</code> null, and then when you actually add 1st element to the list, then they will both point to this one element (it is, after all, tail and head). Or if you want sentinel tail and head elements (so empty list has 2 &quot;fake&quot; elements, unusual but might make sense sometimes), then their <code>next</code>/<code>prev&#47;</code> should be initialized accordingly."}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "reply_to_user": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "edited": false, "score": 0, "creation_date": 1495036391, "post_id": 44029183, "comment_id": 75085708, "body": "@RoiHatam honestly I&#39;ve never done that before, honestly. I should look at how to do that. I&#39;m not asking here because I don&#39;t want to insert a question into another question. Thank you anyhow :)"}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495036465, "post_id": 44029183, "comment_id": 75085754, "body": "@4386427 How is that different? Don&#39;t I need just to assign the value of the head pointer to <code>tail-&gt;next</code>? And <code>head-&gt;prev</code> to the tail of course..."}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1495036617, "post_id": 44029183, "comment_id": 75085853, "body": "@hyde I wanted to set the pointers correctly as soon as I insert the first node :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1495036632, "post_id": 44029183, "comment_id": 75085867, "body": "There are no nested <code>struct</code>s shown. A pointer is not the object it points to!"}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495037198, "post_id": 44029183, "comment_id": 75086247, "body": "@Olaf you&#39;re actually right. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "edited": false, "score": 0, "creation_date": 1495037093, "post_id": 44029290, "comment_id": 75086186, "body": "Thanks! It worked! The Chris Tuner&#39;s solution is also working though. I marked this because it was the first one"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "edited": false, "score": 0, "creation_date": 1495037925, "post_id": 44029290, "comment_id": 75086679, "body": "@brainplot my answer fixes the immediate problem covered by your question, but doesn&#39;t cover the other problems with your code"}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1495038537, "post_id": 44029290, "comment_id": 75087052, "body": "@ChrisTurner what do you mean? My code shows nothing special or particularly wrong I think, probabily apart from trying to initialize the nodes within the same function :/"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1495039053, "post_id": 44029290, "comment_id": 75087328, "body": "@ChrisTurner - yes, your answer is correct as well. I&#39;m sure OP gave you and upvote - just as I did."}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "edited": false, "score": 0, "creation_date": 1495058062, "post_id": 44029290, "comment_id": 75097460, "body": "@4386427 I actually did! Also, I think that passing the struct&#39;s name (node_t) as the sizeof argument looks a little bit neater (and more readable as well) rather than passing the portion pointed by new_node. You&#39;re answer is yet more complete though. That&#39;s it"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "edited": false, "score": 0, "creation_date": 1495098845, "post_id": 44029290, "comment_id": 75112667, "body": "@brainplot sorry, I did just mean the &quot;trying to initialize the nodes&quot; bit"}, {"owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1495099441, "post_id": 44029290, "comment_id": 75113120, "body": "@ChrisTurner yeah, I figured. Thank you. No worries :)"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1495035872, "last_edit_date": 1495035872, "creation_date": 1495035448, "answer_id": 44029290, "question_id": 44029183, "link": "https://stackoverflow.com/questions/44029183/how-do-i-refer-to-pointers-in-nested-structs/44029290#44029290", "title": "How do I refer to pointers in nested structs?", "body": "<p>Your problem is that you never allocate any memory for the new list. Consequently</p>\n\n<pre><code>\u00b4new_list-&gt;head = ... `\n</code></pre>\n\n<p>will crash.</p>\n\n<p>Try:</p>\n\n<pre><code>list_t * create_new_list()\n{\n    list_t * new_list = malloc(sizeof *new_list);  // Allocate a new list\n    if (!new_list) exit(1);                        // Bail out if it failed\n    new_list-&gt;head = NULL;                         // Initialize pointers\n    new_list-&gt;tail = NULL;                         // Initialize pointers\n    return new_list;                               // Return the new list\n}\n</code></pre>\n\n<p>Don't allocate any nodes in the <code>create</code>function. Do that in an <code>insert</code> function.</p>\n\n<p>Something like:</p>\n\n<pre><code>void insert(list_t *list, int key)\n{\n    node_t* new_node = malloc( sizeof *new_node );\n    if (!new_node) exit(1);                        \n    new_node-&gt;key = key;\n\n    //... add the code to insert the node into the list\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 3, "last_activity_date": 1495035463, "creation_date": 1495035463, "answer_id": 44029300, "question_id": 44029183, "link": "https://stackoverflow.com/questions/44029183/how-do-i-refer-to-pointers-in-nested-structs/44029300#44029300", "title": "How do I refer to pointers in nested structs?", "body": "<pre><code>list_t * new_list;\nnew_list-&gt;head = malloc( sizeof(node_t) );\n</code></pre>\n\n<p>This won't work as <code>new_list</code> doesn't have a value! You need to allocate memory for it as well. Try doing this</p>\n\n<pre><code>list_t * new_list = malloc(sizeof(list_t));\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6335279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c244d1561000ab8f3143cc12cff3d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "brainplot", "link": "https://stackoverflow.com/users/6335279/brainplot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 44029290, "answer_count": 2, "score": 0, "last_activity_date": 1495035872, "creation_date": 1495035184, "last_edit_date": 1495035251, "question_id": 44029183, "link": "https://stackoverflow.com/questions/44029183/how-do-i-refer-to-pointers-in-nested-structs", "title": "How do I refer to pointers in nested structs?", "body": "<p>I'm fairly new to C pointers so I'm trying to play around with them to figure out how they work, more in depth.\nI've got the following data types, defined with <code>typedef</code>:</p>\n\n<pre><code>struct node\n{\n    int key;\n    struct node * prev;\n    struct node * next;\n};\n\ntypedef struct node node_t;\n\nstruct list\n{\n    node_t * head;\n    node_t * tail;\n};\n\ntypedef struct list list_t;\n</code></pre>\n\n<p>My goal is to have a doubly linked list with a pointer to its head and its tail, maybe with <code>tail-&gt;next</code> pointing to the head; in order to have a circular list.\nThe problem is that whenever I try to refer to any of the node's pointers, I get a segmentation fault.\nI coded a function like this:</p>\n\n<pre><code>list_t * create_new_list()\n{\n    list_t * new_list;\n    new_list-&gt;head = malloc( sizeof(node_t) );\n    new_list-&gt;tail = malloc( sizeof(node_t) );\n\n    // I've also tried\n    // list * new_list = malloc( sizeof(list_t) );\n    // but it doesn't work */\n\n\n    /* init the head node */\n    new_list-&gt;head-&gt;prev = NULL;\n    new_list-&gt;head-&gt;next = NULL;\n    new_list-&gt;head-&gt;key = 0;\n\n    /* init the tail node */\n    new_list-&gt;tail-&gt;prev = NULL;\n    new_list-&gt;tail-&gt;next = NULL;\n    new_list-&gt;tail-&gt;key = 0;\n\n    return new_list;\n}\n</code></pre>\n\n<p>When I call <code>create_new_list()</code> from my <code>main()</code> function I get:\n\"Segmentation Fault. Core dump created\".</p>\n\n<pre><code>int main()\n{\n    list_t * my_list = create_new_list();\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "cuda"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1495035502, "post_id": 44029037, "comment_id": 75085032, "body": "you could statically link to the cuda libraries you need"}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1495138017, "post_id": 44029037, "comment_id": 75138785, "body": "Offtopic: the obvious alternative solution is to avoid CUDA and to use non-vendor-specific GPU acceleration, e.g. OpenCL, OpenMP or OpenGL compute shaders. These have their own drawbacks of course."}], "answers": [{"tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": false, "score": 1, "last_activity_date": 1495084018, "creation_date": 1495084018, "answer_id": 44038994, "question_id": 44029037, "link": "https://stackoverflow.com/questions/44029037/using-cuda-optionally-on-linux/44038994#44038994", "title": "Using CUDA Optionally on Linux", "body": "<p>You have two choices, both perfectly valid:</p>\n\n<ol>\n<li>As you note in your question, use <code>dlopen</code> to load dynamic libraries at runtime</li>\n<li>Statically link the CUDA toolkit libraries into your application. NVIDIA have been shipping static versions of the toolkit libraries for linux for several major release cycles, and static linking is fully supported. The downside of this approach is application size.</li>\n</ol>\n"}], "owner": {"reputation": 197, "user_id": 1003231, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dfd95502fe9bbcf5f9fca380014372bb?s=128&d=identicon&r=PG", "display_name": "Underhill", "link": "https://stackoverflow.com/users/1003231/underhill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495084018, "creation_date": 1495034793, "question_id": 44029037, "link": "https://stackoverflow.com/questions/44029037/using-cuda-optionally-on-linux", "title": "Using CUDA Optionally on Linux", "body": "<p>I have an application, written in <em>C</em>, which runs on multiple platforms: Windows and various flavors of Unix. The two most important are Linux, then Windows.</p>\n\n<p>One of the core algorithms could benefit from CUDA acceleration. However, everything must run normally if the system isn't CUDA-capable, (or the user doesn't specifically ask for GPGPU acceleration).</p>\n\n<p>So, I need to make sure the application tries to load the CUDA libraries <em>only</em> under the right circumstances.</p>\n\n<p>On Windows, the delay-load mechanism makes this fairly easy.</p>\n\n<p>Is there a similarly easy mechanism to do this on Linux? Or do I have to go through the contortions involved with dlopen()?</p>\n"}, {"tags": ["c", "freebsd", "sctp"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1498079775, "post_id": 44028555, "comment_id": 76356882, "body": "a good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>... the good output... try to solve this problem alone... why this question has no up vote ?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1498080789, "post_id": 44028555, "comment_id": 76357277, "body": "The man on linux said &quot;EINVAL Invalid port or address.&quot;. Hope this help."}, {"owner": {"reputation": 658, "user_id": 2372992, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/65e5b2cb3b356fe30143fe271d780f45?s=128&d=identicon&r=PG&f=1", "display_name": "amritanshu", "link": "https://stackoverflow.com/users/2372992/amritanshu"}, "edited": false, "score": 0, "creation_date": 1498128348, "post_id": 44028555, "comment_id": 76377256, "body": "Conectx implies it&#39;s a 1:1 interface?  I think you can&#39;t use <code>SOCK_SEQPACKET</code> type of socket here you need to use <code>SOCK_STREAM</code>?"}, {"owner": {"reputation": 1342, "user_id": 5508532, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67f7923644113e4d8897b755a75b8272?s=128&d=identicon&r=PG&f=1", "display_name": "binary01", "link": "https://stackoverflow.com/users/5508532/binary01"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1498175408, "post_id": 44028555, "comment_id": 76404826, "body": "@Stargateur  It does not help. The very same code works fine on Linux."}, {"owner": {"reputation": 1342, "user_id": 5508532, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67f7923644113e4d8897b755a75b8272?s=128&d=identicon&r=PG&f=1", "display_name": "binary01", "link": "https://stackoverflow.com/users/5508532/binary01"}, "reply_to_user": {"reputation": 658, "user_id": 2372992, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/65e5b2cb3b356fe30143fe271d780f45?s=128&d=identicon&r=PG&f=1", "display_name": "amritanshu", "link": "https://stackoverflow.com/users/2372992/amritanshu"}, "edited": false, "score": 0, "creation_date": 1498175654, "post_id": 44028555, "comment_id": 76404883, "body": "@amritanshu Same problem if using SOCK_STREAM,"}, {"owner": {"reputation": 658, "user_id": 2372992, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/65e5b2cb3b356fe30143fe271d780f45?s=128&d=identicon&r=PG&f=1", "display_name": "amritanshu", "link": "https://stackoverflow.com/users/2372992/amritanshu"}, "edited": false, "score": 0, "creation_date": 1498201614, "post_id": 44028555, "comment_id": 76412534, "body": "yeah, actually I don&#39;t have a freebsd setup mostly on linux and was trying to extrapolate things to help you, note I dont get an EINVAL on linux for your code.  Moving ahead, the call to setsocketopt will map to sctp_do_connectx in sctp_usrreq.c, one of the reason this call to connect can fail (with EINVAL) is if SCTP_REUSE_PORT is not enabled for the socket."}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1498659244, "post_id": 44028555, "comment_id": 76589986, "body": "It works perfectly fine for me. But I have slightly different version of FreeBSD :( michalo@darkstar:~/src % ./a.out Connected! Assoc ID 3 michalo@darkstar:~/src % uname -rp 10.3-RELEASE-p11 amd64"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1501711567, "post_id": 44028555, "comment_id": 77904552, "body": "try to find out is your address is valid? print address after convert it to string ba2str()    it seem you are not use true argument     <a href=\"https://www.freebsd.org/cgi/man.cgi?query=sctp_connectx&amp;manpath=FreeBSD%208.0-RELEASE\" rel=\"nofollow noreferrer\">freebsd.org/cgi/&hellip;</a>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1501712283, "post_id": 44028555, "comment_id": 77904794, "body": "<a href=\"http://petanode.com/blog/posts/sctp-specific-socket-functions-in-linux.html\" rel=\"nofollow noreferrer\">petanode.com/blog/posts/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 417, "user_id": 1369864, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/a09hK.jpg?s=128&g=1", "display_name": "Pushpendra", "link": "https://stackoverflow.com/users/1369864/pushpendra"}, "is_accepted": false, "score": 1, "last_activity_date": 1505221267, "creation_date": 1505221267, "answer_id": 46177117, "question_id": 44028555, "link": "https://stackoverflow.com/questions/44028555/sctp-connectx-gives-einval-on-freebsd/46177117#46177117", "title": "sctp_connectx() gives EINVAL on FreeBSD", "body": "<p>I think answer is there in your query. If we follow the <code>truss</code> trace then as you said it fails on <code>setsockopt()</code>.</p>\n\n<p>So the actually error <strong>EINVAL</strong> is returned by <code>setsockopt()</code>. And as per FreeBSD <code>setsockopt()</code> manual:</p>\n\n<blockquote>\n  <p>[EINVAL]: Installing an accept_filter(9) on a <strong>non-listening</strong>\n        socket was attempted.</p>\n</blockquote>\n\n<p>is the description of the error. So I think you should do below things:</p>\n\n<ol>\n<li>Explore your socket options whether they are correct with respect to you listener socket.</li>\n<li>Check for the errors for functions <code>htons()</code> and <code>inet_addr()</code></li>\n</ol>\n\n<p>And my suggestion is that you should not use inet_addr(), for more details see BUG section of the manual. I would recommend to use <code>inet_aton()</code> instead.</p>\n"}], "owner": {"reputation": 1342, "user_id": 5508532, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67f7923644113e4d8897b755a75b8272?s=128&d=identicon&r=PG&f=1", "display_name": "binary01", "link": "https://stackoverflow.com/users/5508532/binary01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 13, "last_activity_date": 1505221267, "creation_date": 1495033457, "question_id": 44028555, "link": "https://stackoverflow.com/questions/44028555/sctp-connectx-gives-einval-on-freebsd", "title": "sctp_connectx() gives EINVAL on FreeBSD", "body": "<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/sctp.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc,char **argv)\n{\n\n    struct sockaddr_in remoteAddr;\n\n    int clientSock = socket(PF_INET,SOCK_SEQPACKET,IPPROTO_SCTP);\n    if(clientSock == -1) {\n        perror(\"socket\");\n        return 1;\n    }\n    memset(&amp;remoteAddr,0,sizeof remoteAddr);\n    remoteAddr.sin_family = AF_INET;\n    remoteAddr.sin_len = sizeof remoteAddr;\n    remoteAddr.sin_port = htons(5555);\n    remoteAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    sctp_assoc_t assoc_id = 0;\n    if(sctp_connectx(clientSock,(struct sockaddr*)&amp;remoteAddr,1, &amp;assoc_id)!= 0) {\n        perror(\"sctp_connectx\");\n        return 1;\n    }\n    printf(\"Connected! Assoc ID %d\\n\",(int)assoc_id);\n\n    return 0;   \n}\n</code></pre>\n\n<p>When run, this code fails:</p>\n\n<pre><code>$ clang  -Wall sctp_connect.c \n$ ./a.out \nsctp_connectx: Invalid argument\n$ uname -rp\n11.0-RELEASE-p9 amd64\n</code></pre>\n\n<p>But I cannot figure out what's wrong. The <a href=\"https://www.freebsd.org/cgi/man.cgi?query=sctp_connectx&amp;manpath=FreeBSD%208.0-RELEASE\" rel=\"noreferrer\">sctp_connectx</a>() manpage says it will fail with EINVAL if an address with invalid family or no addresses was provided  - but that seems not to be the case from the code.</p>\n\n<p>The <a href=\"https://github.com/moe123/mirroring-freebsd-github/blob/44078c2c278acced83d13b54414f8d918a0e5174/lib/libc/net/sctp_sys_calls.c#L100\" rel=\"noreferrer\">sctp_connectx</a>() has several parts where it can fail with EINVAL, but <code>truss</code> shows it gets to the setsockopt() call, so it's the kernel that fails the call:</p>\n\n<pre><code>socket(PF_INET,SOCK_SEQPACKET,132)       = 3 (0x3)\nmmap(0x0,2097152,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANON,-1,0x0) = 34374418432 (0x800e00000)\nsetsockopt(0x3,0x84,0x8007,0x800e16000,0x14)     ERR#22 'Invalid argument'\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1495033421, "post_id": 44028460, "comment_id": 75083465, "body": "Please show the code that writes out the records, and also the code that <code>fopen</code>s the file."}, {"owner": {"reputation": 15, "user_id": 5034110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67768d82e4a9201cdc4f7bb2b098924?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz Szeremeta", "link": "https://stackoverflow.com/users/5034110/grzegorz-szeremeta"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1495033707, "post_id": 44028460, "comment_id": 75083677, "body": "@dasblinkenlight I&#39;ve edited my question following your suggestions."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1495033707, "post_id": 44028460, "comment_id": 75083678, "body": "Change <code>&quot;r&quot;</code> to <code>&quot;rb&quot;</code> and see if it helps."}, {"owner": {"reputation": 15, "user_id": 5034110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67768d82e4a9201cdc4f7bb2b098924?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz Szeremeta", "link": "https://stackoverflow.com/users/5034110/grzegorz-szeremeta"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1495033955, "post_id": 44028460, "comment_id": 75083862, "body": "@dasblinkenlight I&#39;ve changed it and still, when I&#39;m reading for example records 00440,00441 and 00442, first element of the recs array contains all of them, second contains 00441 and 00442 and third one contains only 00443."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5034110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67768d82e4a9201cdc4f7bb2b098924?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz Szeremeta", "link": "https://stackoverflow.com/users/5034110/grzegorz-szeremeta"}, "edited": false, "score": 0, "creation_date": 1495034438, "post_id": 44028724, "comment_id": 75084251, "body": "That&#39;s probably the case, thanks a lot for your help. I wouldn&#39;t find it out by myself for another few hours."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 6, "last_activity_date": 1495034556, "last_edit_date": 1495034556, "creation_date": 1495033883, "answer_id": 44028724, "question_id": 44028460, "link": "https://stackoverflow.com/questions/44028460/reading-data-from-file-to-struct-using-fread/44028724#44028724", "title": "Reading data from file to struct using fread", "body": "<p>The problem is that your records <code>rec</code> isn't a zero terminated string.</p>\n\n<p>So printing using <code>%s</code> shows all records because the printing will just continue until it sees a <code>'\\0'</code>.</p>\n\n<p>So either make sure to add a zero-termination in each <code>rec</code> or use another way of printing than <code>%s</code>.</p>\n\n<p>BTW: If there isn't any zero-termination inside <code>recs</code> you actually have undefined behavior.</p>\n\n<p>This little program mimics the problem:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct r {\n    char c[1];\n};\n\nint main(void) {\n    int i;\n    struct r recs[4] = {{'a'}, {'b'}, {'c'}, {'\\0'}};\n                                      //       ^^^^^\n                                      //       Just to stop printing here\n    for (i=0; i&lt;3; i++)\n    {\n        printf(\"%d %s\\n\", i, recs[i].c);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 abc\n1 bc\n2 c\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5034110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67768d82e4a9201cdc4f7bb2b098924?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz Szeremeta", "link": "https://stackoverflow.com/users/5034110/grzegorz-szeremeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 44028724, "answer_count": 1, "score": 0, "last_activity_date": 1495034556, "creation_date": 1495033240, "last_edit_date": 1495033663, "question_id": 44028460, "link": "https://stackoverflow.com/questions/44028460/reading-data-from-file-to-struct-using-fread", "title": "Reading data from file to struct using fread", "body": "<p>I'm writing a piece of code and a part of it is reading \"records\" from file to n-length array, n given as an argument. Records in file have constant length(in this case 1024) and contain only numerics, spaces and lower letters. Each record is terminated with \\n. I'm using following structure to keep one record:</p>\n\n<pre><code>typedef struct{\nchar rec[1024];\n} record;\n</code></pre>\n\n<p>And Code for extracting n of them and storing in n-length array of records is written this way:</p>\n\n<pre><code>record * recs=malloc(n*sizeof(record));\nsize_t read=fread(recs,sizeof(record),(size_t)n,f);\n</code></pre>\n\n<p>When I checked output of this operations it turns out that first element of array recs contains all of the records, second all but first and so on instead of keeping one at each element of array. I'm kind of lost, because i thought that it should store each record in different element of array.\nAs suggested, I'm also providing code for opening a file and printing elements of array:</p>\n\n<pre><code>if((f=fopen(argv[2],\"r\"))==NULL){\n        perror(\"error opening file\\n\");\n        exit(1);\n    }\n\nfor(int i=0;i&lt;(int)read;i++){\n        printf(\"record number %d\\n %s\\n\",i,recs[i].rec);\n    }\n</code></pre>\n"}, {"tags": ["c", "multithreading", "valgrind"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1495031616, "post_id": 44027758, "comment_id": 75082005, "body": "And if you build with debug information (add the <code>-g</code> flag to GCC when building) then on what <i>line</i> in your does Valgrind say the problem occur?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1495031871, "post_id": 44027758, "comment_id": 75082222, "body": "Pointers and arrays are different. You can&#39;t use a <code>char ***</code> to access the elements of <code>char buffer[height][width][3]</code>."}, {"owner": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "edited": false, "score": 0, "creation_date": 1495032163, "post_id": 44027758, "comment_id": 75082474, "body": "The problem occurs in the line with <code>buffer[y-1][x-1][0]=1</code>"}, {"owner": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "edited": false, "score": 0, "creation_date": 1495032215, "post_id": 44027758, "comment_id": 75082530, "body": "How can I access the array in the struct?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1495032277, "post_id": 44027758, "comment_id": 75082582, "body": "Try changing <code>char ***buffer</code> to <code>void *buffer</code> in <code>info1</code>, and changing <code>char ***buffer</code> to <code>char (*buffer)[width][3]</code> in <code>calculateThread</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495128169, "post_id": 44027758, "comment_id": 75133350, "body": "note: the <code>write()</code> function declaration is incorporated by: <code>#include &lt;unistd.h&gt;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495128426, "post_id": 44027758, "comment_id": 75133484, "body": "the function: <code>void *calculateThread(void *arg)</code> states that it will return a <code>void*</code> but the function actually just runs off the end of the function:  Since this is a &#39;thread&#39; function, it should end with something similar to: int status=0; pthread_exit( &amp;status );`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495128793, "post_id": 44027758, "comment_id": 75133672, "body": "the posted code is missing <code>#include &lt;stdlib.h&gt;</code> for th prototype for <code>free()</code>, <code>malloc()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495128896, "post_id": 44027758, "comment_id": 75133727, "body": "when writing a literal, if written without a trailing <code>f</code>, then it is seen as a <code>double</code> rather than a <code>float</code>.  While &#39;implicit conversion&#39; will save you (usually), it is much better to include the trailing <code>f</code> so no conversion is needed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495129566, "post_id": 44027758, "comment_id": 75134132, "body": "in the <code>main()</code> function, never access beyond <code>argv[0]</code> without first checking <code>argc</code> to verify the expected command line parameters were actually entered by the user.  Otherwise seg fault events will occur.  When the expected command line parameters were not entered, then output a <code>USAGE</code> message to <code>stderr</code> and exit the program.  Note: the third parameter is no longer valid.  If you need to access the environment variables, use <code>getenv()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495129914, "post_id": 44027758, "comment_id": 75134354, "body": "the function: <code>len()</code> should (probably) be replaced with calling: <code>strlen()</code>, which is prototyped in the <code>string.h</code> header file"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495130771, "post_id": 44027758, "comment_id": 75134837, "body": "when calling any of the heap allocation functions: (malloc, calloc, realloc), always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495131258, "post_id": 44027758, "comment_id": 75135112, "body": "the posted code is assuming that a <code>int</code> size is 4 bytes.  This assumption is only &#39;usually&#39; correct when the underlying computer architecture is 32bits.  I.E. this fails on 64bit architectures and any architecture that is less than 32 bits"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495131341, "post_id": 44027758, "comment_id": 75135157, "body": "when compiling, always enable the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion -std=gnu11</code> )"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495131553, "post_id": 44027758, "comment_id": 75135246, "body": "the posted code contains (many) &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with no basis.  I.E. 2, 4,18, 22, 34, and many others. &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc.  Suggest using <code>#define</code> statements or an <code>enum</code> statement to give those &#39;magic&#39; numbers meaningful names, then using those meaningful names throughout the code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495131815, "post_id": 44027758, "comment_id": 75135413, "body": "regarding: <code>write(1, buffer, height*width*3);</code>  unless the <code>width</code> has been &#39;adjusted&#39; to reflect the required &#39;multiple of 4&#39; bytes, this will fail to write the whole buffer of pixel data"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1495132246, "post_id": 44027758, "comment_id": 75135662, "body": "regarding: <code>unsigned long timediff = ((end.tv_sec*1000000)+end.tv_usec) - ((start.tv_sec*1000000)+start.tv_usec);</code>  the struct tv fields are unsigned values.  multiplying them by the signed value <code>1000000</code> results in signed values  subtracting results in a signed value which is being converted to a unsigned value.  Depending on your compiler and the actual values, the result can be incorrect"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "edited": false, "score": 0, "creation_date": 1495033050, "post_id": 44028140, "comment_id": 75083180, "body": "But how do I create buffer as global variable, if I don&#39;t know height and width? Maybe I&#39;m missing something"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "edited": false, "score": 1, "creation_date": 1495033611, "post_id": 44028140, "comment_id": 75083614, "body": "No, I guess you can&#39;t have it as a global with the way you&#39;re declaring it currently."}, {"owner": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "edited": false, "score": 0, "creation_date": 1495034640, "post_id": 44028140, "comment_id": 75084385, "body": "I did it now global and initialized it with malloc. Now it finally works. Thanks for your help."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "edited": false, "score": 1, "creation_date": 1495035515, "post_id": 44028140, "comment_id": 75085039, "body": "@NKK It&#39;s best to avoid global variables where possible."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1495042943, "post_id": 44028140, "comment_id": 75089622, "body": "The dynamic approach creating a jagged array (which in fact is many linked arrays) is an expensive and quite complicated solution, which probably only really make sense for huge  values of <code>height</code> and <code>width</code>. For smaller ones better go for the approach provided <i>Ian</i> in his answer: <a href=\"http://stackoverflow.com/a/44029056/694576\">stackoverflow.com/a/44029056/694576</a>"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1495032403, "creation_date": 1495032403, "answer_id": 44028140, "question_id": 44027758, "link": "https://stackoverflow.com/questions/44027758/c-thread-invalid-read-of-size-8-with-buffer-array/44028140#44028140", "title": "C Thread Invalid read of size 8 with buffer array", "body": "<p>This line of code is obviously wrong. The type on the left hand side is a <code>char ***</code> and you're assigning to it a <code>char</code>, with specifically the value of <code>0</code> as that is how you initialise <code>buffer</code> at the top of <code>main</code></p>\n\n<pre><code>(abc+i)-&gt;buffer = ***buffer;\n</code></pre>\n\n<p>ideally you want it to be</p>\n\n<pre><code>(abc+i)-&gt;buffer = buffer;\n</code></pre>\n\n<p>but that won't work as <code>buffer</code> is a 3 dimensional array rather than a <code>char ***</code> and they're not equivalent.</p>\n\n<p>You could either create <code>buffer</code> as a <code>char ***</code> by allocating the various levels or since each thread is only accessing a subset of <code>buffer</code> you could make it a global variable?</p>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 1, "last_activity_date": 1495035274, "last_edit_date": 1495035274, "creation_date": 1495034827, "answer_id": 44029056, "question_id": 44027758, "link": "https://stackoverflow.com/questions/44027758/c-thread-invalid-read-of-size-8-with-buffer-array/44029056#44029056", "title": "C Thread Invalid read of size 8 with buffer array", "body": "<p>You are trying to access the data via a pointer to pointer to pointer to <code>char</code> (<code>char ***</code>), but the data is actually an array [<code>height</code>] of array [<code>width</code>] of array [3] of <code>char</code> (<code>char [height][width][3]</code>). A pointer to the first element of this array is a pointer to an array [<code>width</code>] of array [3] of <code>char</code> (<code>char (*)[width][3]</code>). Since <code>width</code> and <code>height</code> are variable, the <code>info1</code> type cannot contain a member <code>buffer</code> of type <code>char (*)[width][3]</code>, so the easiest thing to do is to declare it as a <code>void *</code>:</p>\n\n<pre><code>typedef struct {\n    ...\n    void *buffer;\n    ...\n} info1;\n</code></pre>\n\n<p>In function <code>calculateThread</code>, the original <code>width</code> value is available, so you can declare local variable <code>buffer</code> with the correct type and initialize it:</p>\n\n<pre><code>    char (*buffer)[width][3] = abc-&gt;buffer;\n</code></pre>\n\n<p>In function <code>main</code>, the assignment <code>(abc+i)-&gt;buffer = ***buffer;</code> is obviously incorrect as <code>***buffer</code> is of type <code>char</code>. You want a pointer to the start of the buffer contents, which is just <code>buffer</code>, so change that to:</p>\n\n<pre><code>            (abc+i)-&gt;buffer = buffer;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8025971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2e26c459e372ed12b71c88fc1a6405?s=128&d=identicon&r=PG&f=1", "display_name": "NKK", "link": "https://stackoverflow.com/users/8025971/nkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495035274, "creation_date": 1495031459, "question_id": 44027758, "link": "https://stackoverflow.com/questions/44027758/c-thread-invalid-read-of-size-8-with-buffer-array", "title": "C Thread Invalid read of size 8 with buffer array", "body": "<p>I have the problem, that when I want to assign my buffer array values, there is a segmentation fault\nCode:</p>\n\n<pre><code>#define BMPHEADER_SIZE 54\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/time.h&gt;\n\n// there will be a low level I/O function from the operating system\nextern long write(int, const char *, unsigned long);\n\nfloat zoom      = 1.5;\nfloat quadLimit = 3.0;\nchar colorLimit = 40;\npthread_mutex_t lock;\n\n\ntypedef struct Complex_s {\n    float re;\n    float im;\n} Complex;\n\ntypedef struct {\n    int width;\n    int height;\n    int anfang;\n    int ende;\n    float imageRelation;\n    char *blueGreenRed;\n    //char *buffer;\n    char ***buffer;\n}info1;\n\n// bad, but fast !!!\nint intFloor(double x) {\n    return (int)(x+100000) - 100000;\n}\n\n// count chars until \\0 or space or \"to long\"\nint len(char * str) {\n    int ddorf=0;\n    while (str[ddorf] != '\\0' &amp;&amp; str[ddorf] != ' ' &amp;&amp; ddorf != 40225) ++ddorf;\n    return ddorf;\n}\n\n// read a positive number from a char array\nint str2num(char * str) {\n    int result = 0;\n    int b = 1;\n    int l = len(str);\n    int i;\n    for(i=1; i&lt;l; ++i) b *= 10;\n    for(i=0; i&lt;l; ++i) {\n        result += b * (int)(str[i] - '0');\n        b /= 10;\n    }\n    return result;\n}\n\nvoid toRGB(int id, char * blueGreenRed) {\n    blueGreenRed[0] = 0;\n    blueGreenRed[1] = 0;\n    blueGreenRed[2] = 0;\n    if ( id == colorLimit ) return;\n\n    float hi,q,t,coeff;\n\n    coeff = 7.0 * (id/(float)colorLimit);\n    hi = intFloor(coeff);\n    t = coeff - hi;\n    q = 1 - t;\n    if (hi == 0.0) {\n        blueGreenRed[2] = 0;\n        blueGreenRed[1] = t*255; //immer mehr green und blau -&gt; dunkelblau zu cyan\n        blueGreenRed[0] = t*127 + 128;\n    } else if (hi == 1.0) {\n        blueGreenRed[2] = t*255; //immer mehr rot -&gt; cyan zu weiss\n        blueGreenRed[1] = 255;\n        blueGreenRed[0] = 255;\n    } else if (hi == 2.0) {\n        blueGreenRed[2] = 255;\n        blueGreenRed[1] = 255;\n        blueGreenRed[0] = q*255; // immer weniger blau -&gt; weiss zu gelb\n    } else if (hi == 3.0) {\n        blueGreenRed[2] = 255;\n        blueGreenRed[1] = q*127 + 128; // immer weniger green -&gt; gelb zu orange\n        blueGreenRed[0] = 0;\n    } else if (hi == 4.0) {\n        blueGreenRed[2] = q*127 + 128; // orange wird dunkler -&gt; orange zu braun\n        blueGreenRed[1] = q*63 + 64;\n        blueGreenRed[0] = 0;\n    } else if (hi == 5.0) {\n        blueGreenRed[2] = 128;\n        blueGreenRed[1] = 64;\n        blueGreenRed[0] = t*128; // mehr blau -&gt; braun zu violett\n    } else if (hi == 6.0) {\n        blueGreenRed[2] = q*128; // weniger rot und green -&gt; violett wird dunkelblau\n        blueGreenRed[1] = q*64;\n        blueGreenRed[0] = 128;\n    }\n}\n\nchar* calculatePunkt(int x, int y, int width, int height, float imageRelation, char *blueGreenRed) {\n\n    char iterate=0;\n    Complex c    = {0,0};\n    Complex newz = {0,0};\n    Complex z = {0,0};\n    float quad=0;\n\n    c.re = zoom * (-1.0 + imageRelation * ( (x-1.0) / (width-1.0)) );\n    c.im = zoom * ( 0.5 - (y-1.0) / (height-1.0) );\n\n    // iterate\n    for ( iterate=1; iterate &lt; colorLimit &amp;&amp; quad &lt; quadLimit; ++iterate ) {\n        quad = z.re * z.re + z.im * z.im;\n\n        newz.re = (z.re * z.re) - (z.im * z.im) + c.re;\n        newz.im =  z.re * z.im * 2.0            + c.im;\n\n        z = newz;\n    }\n    toRGB(iterate, blueGreenRed);\n\n    return blueGreenRed;\n}   \n\nvoid *calculateThread(void *arg){\n\n    info1 *abc =(info1*) arg;\n    int x, y;\n    int anfang = abc-&gt;anfang;\n    int ende = abc-&gt;ende;\n    int width = abc-&gt;width;\n    int height = abc-&gt;height;\n    float imageRelation = abc-&gt;imageRelation;\n    char *blueGreenRed = abc-&gt;blueGreenRed;\n    char ***buffer = abc-&gt;buffer;\n    //char *buffer = abc-&gt;buffer;\n\n    for (y=anfang; y &lt;= ende; ++y) {    \n\n        for (x=1; x &lt;= width; ++x) {\n\n\n            char* rgb = calculatePunkt(x, y, width, height, imageRelation, blueGreenRed);\n            fprintf(stderr, \"test, %d\\n\", anfang);\n            pthread_mutex_lock(&amp;lock);\n            //buffer[(y-1)+(height*(x-1))+(height*width*0)] = rgb[0];\n            //buffer[(y-1)+(height*(x-1))+(height*width*1)] = rgb[1];\n            //buffer[(y-1)+(height*(x-1))+(height*width*2)] = rgb[2];\n            buffer[y-1][x-1][0] = 1;\n            buffer[y-1][x-1][1] = 1;\n            buffer[y-1][x-1][2] = 1;\n            pthread_mutex_unlock(&amp;lock);\n        }\n    }\n\n\n\n\n}   \n\nint main(int argc, char ** argv, char ** envp) {\n    int width  = str2num(argv[1]);\n    int height = str2num(argv[2]);\n    int anzahl_threads = str2num(argv[3]);\n\n    float imageRelation = (float)width/(float)height;\n    int i, j, anfang, ende, y;\n    char blueGreenRed[3];\n    char buffer[height][width][3];\n    for(i=0; i&lt;height; i++){\n        for(j=0; j&lt;width; j++){\n            buffer[i][j][0]=0;\n            buffer[i][j][1]=0;\n            buffer[i][j][2]=0;\n        }\n    }       \n    //char *buffer = malloc(height*width*3*sizeof(char));\n    //*buffer = (char*){ 0 };\n\n\n    unsigned char info[BMPHEADER_SIZE] = {\n                  //size\n        'B','M',  0,0,0,0, 0,0, 0,0, 54,0,0,0,\n                  //width  //height\n        40,0,0,0, 0,0,0,0, 0,0,0,0,  1,0, 24,0,\n                  // datasize\n        0,0,0,0,  0,0,0,0\n    };\n\n    // BMP lines must be of lengths divisible by 4\n    char span[4] = \"\\0\\0\\0\\0\";\n    int spanBytes = 4 - ((width * 3) % 4);\n    if (spanBytes == 4) spanBytes = 0;\n    int psize = ((width * 3) + spanBytes) * height;\n\n    *( (int*) &amp;info[2])  = BMPHEADER_SIZE + psize;\n    *( (int*) &amp;info[18]) = width;\n    *( (int*) &amp;info[22]) = height;\n    *( (int*) &amp;info[34]) = psize;\n\n    write(1, (char *) info, BMPHEADER_SIZE);\n\n    struct timeval start, end;\n    gettimeofday(&amp;start, 0);\n    int interval = height/anzahl_threads;\n\n    info1 *abc = malloc(anzahl_threads*sizeof(info1));;\n\n    pthread_t *thread = malloc(anzahl_threads*sizeof(pthread_t));\n\n    if(pthread_mutex_init(&amp;lock, NULL)){\n        fprintf(stderr, \"Error initializing mutex\\n\");\n        return 1;\n    }\n    for(i=0; i&lt;anzahl_threads; i++){\n\n        (abc+i)-&gt;width = width;\n        (abc+i)-&gt;height = height;\n        (abc+i)-&gt;imageRelation = imageRelation;\n        (abc+i)-&gt;blueGreenRed = blueGreenRed;\n        (abc+i)-&gt;buffer = ***buffer;\n        //abc-&gt;buffer = *buffer;\n        anfang = 1+(i*interval);\n        (abc+i)-&gt;anfang = anfang;\n        if(i&lt;(anzahl_threads-1)){\n            ende = (i*interval)+interval;\n        }\n        else{\n            ende = height;\n        }\n        (abc+i)-&gt;ende = ende;       \n        if (pthread_create(&amp;thread[i], NULL, calculateThread, (void*)(abc+i))) {\n            fprintf(stderr, \"Error creating thread\\n\");\n            return 1;\n        }\n\n    }   \n\n    for(i=0; i&lt;anzahl_threads; i++){\n        if (pthread_join(thread[i], NULL)) {\n            fprintf(stderr, \"Error joining thread\\n\");\n            return 2;\n        }\n    }\n    pthread_mutex_destroy(&amp;lock);\n\n    for(y=1; y&lt;=height; ++y){\n        // BMP lines must be of lengths divisible by 4\n        write(1, span, spanBytes);\n    }   \n    write(1, buffer, height*width*3);\n    //free(buffer);\n    free(thread);\n    free(abc);\n\n\n\n    gettimeofday(&amp;end, 0);\n\n    unsigned long timediff = ((end.tv_sec*1000000)+end.tv_usec) - ((start.tv_sec*1000000)+start.tv_usec);\n    fprintf(stderr, \"Gesamtzeit in Mikrosek.: %lu\\n\", timediff);\n    return 0;\n}\n</code></pre>\n\n<p>Valgrind:</p>\n\n<pre><code>==28366== Thread 2:\n==28366== Invalid read of size 8\n==28366==    at 0x401115: calculateThread (in /home/nilskk/Schreibtisch/Betriebssysteme/Abgabe2/Aufgabe1/mandel1)\n==28366==    by 0x4E3F183: start_thread (pthread_create.c:312)\n==28366==    by 0x514F37C: clone (clone.S:111)\n==28366==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==28366== \n==28366== \n==28366== Process terminating with default action of signal 11 (SIGSEGV)\n==28366==  Access not within mapped region at address 0x0\n==28366==    at 0x401115: calculateThread (in /home/nilskk/Schreibtisch/Betriebssysteme/Abgabe2/Aufgabe1/mandel1)\n==28366==    by 0x4E3F183: start_thread (pthread_create.c:312)\n==28366==    by 0x514F37C: clone (clone.S:111)\n==28366==  If you believe this happened as a result of a stack\n==28366==  overflow in your program's main thread (unlikely but\n==28366==  possible), you can try to increase the size of the\n==28366==  main thread stack using the --main-stacksize= flag.\n==28366==  The main thread stack size used in this run was 8388608.\n--28366-- REDIR: 0x50d7d00 (libc.so.6:free) redirected to 0x4c2bd80 (free)\n==28366== \n==28366== HEAP SUMMARY:\n==28366==     in use at exit: 640 bytes in 4 blocks\n==28366==   total heap usage: 4 allocs, 0 frees, 640 bytes allocated\n==28366== \n==28366== Searching for pointers to 4 not-freed blocks\n==28366== Checked 16,869,264 bytes\n==28366== \n==28366== Thread 1:\n==28366== 544 bytes in 2 blocks are possibly lost in loss record 3 of 3\n==28366==    at 0x4C2CC70: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==28366==    by 0x4012E14: allocate_dtv (dl-tls.c:296)\n==28366==    by 0x4012E14: _dl_allocate_tls (dl-tls.c:460)\n==28366==    by 0x4E3FD92: allocate_stack (allocatestack.c:589)\n==28366==    by 0x4E3FD92: pthread_create@@GLIBC_2.2.5 (pthread_create.c:500)\n==28366==    by 0x40187E: main (in /home/nilskk/Schreibtisch/Betriebssysteme/Abgabe2/Aufgabe1/mandel1)\n==28366== \n==28366== LEAK SUMMARY:\n==28366==    definitely lost: 0 bytes in 0 blocks\n==28366==    indirectly lost: 0 bytes in 0 blocks\n==28366==      possibly lost: 544 bytes in 2 blocks\n==28366==    still reachable: 96 bytes in 2 blocks\n==28366==         suppressed: 0 bytes in 0 blocks\n==28366== Reachable blocks (those to which a pointer was found) are not shown.\n==28366== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==28366== \n==28366== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)\n==28366== \n==28366== 1 errors in context 1 of 2:\n==28366== Thread 2:\n==28366== Invalid read of size 8\n==28366==    at 0x401115: calculateThread (in /home/nilskk/Schreibtisch/Betriebssysteme/Abgabe2/Aufgabe1/mandel1)\n==28366==    by 0x4E3F183: start_thread (pthread_create.c:312)\n==28366==    by 0x514F37C: clone (clone.S:111)\n==28366==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==28366== \n==28366== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>When I comment the buffer assignment in the thread function, it works. So it has to do something with the buffer, but I don't see the mistake.</p>\n"}, {"tags": ["c", "pointers", "char", "strcat-s"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1495031383, "post_id": 44027655, "comment_id": 75081828, "body": "The expression <code>*str1 = &quot;Ciao &quot;</code> doesn&#39;t do what you think it does, and should cause the compiler to issue a warning about it. Perhaps you need to learn about <a href=\"http://en.cppreference.com/w/cpp/string/byte/strcpy\" rel=\"nofollow noreferrer\"><code>strcpy</code></a>? Also note that <code>sizeof(str1)</code> doesn&#39;t do what you think it does either."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1495035356, "post_id": 44027655, "comment_id": 75084938, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">don&#39;t cast the result of <code>malloc</code> in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 6044264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2d52296c121703ff0ec78ea27c0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Fighter", "link": "https://stackoverflow.com/users/6044264/phil-fighter"}, "is_accepted": false, "score": 1, "last_activity_date": 1495033958, "creation_date": 1495033958, "answer_id": 44028747, "question_id": 44027655, "link": "https://stackoverflow.com/questions/44027655/strcat-s-and-char-pointer-newbie-issue/44028747#44028747", "title": "strcat_s and char pointer newbie issue", "body": "<p>You have to copy the strings firstly into the allocated memory. If you like to know the length of a string use <code>strlen()</code>. <code>sizeof()</code> returns the size of the datatype in byte. In your case it is a pointer (4 byte on 32bit, 8 byte on 64bit machines).\nThe following code should work properly:</p>\n\n<pre><code>char *str1 = (char *)malloc(20);\nstrcpy(str1,\"Ciao \");\nchar *str2 = (char *)malloc(20);\nstrcpy(str2,\"Marco \");\nstrcat(str1, str2);\nprintf(\"%s\", str1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1495036902, "creation_date": 1495036902, "answer_id": 44029806, "question_id": 44027655, "link": "https://stackoverflow.com/questions/44027655/strcat-s-and-char-pointer-newbie-issue/44029806#44029806", "title": "strcat_s and char pointer newbie issue", "body": "<p>There are some issues with your code, and there are some general notes on <code>strcat_s</code>.</p>\n\n<p>Your code <code>str1 = (char *)malloc(20); *str1 = \"Ciao \"</code> does not copy <code>Ciao</code>; <code>*str</code> is a single character at the first position of <code>str</code>, and your expression converts string literal <code>\"Ciao \"</code> (which is a <em>pointer</em> to a sequence of characters) to some <em>single</em> character (<code>T</code> in this case; surprising, isn't it?). One would need to use <code>strcpy</code> instead. An array, like <code>char buffer[20] = \"Ciao \"</code>, in contrast, works, because this (special) case is not an assignment but an initialiser of an array.</p>\n\n<p>Your code <code>sizeof(str1)</code> gives you the size of a pointer value, which is probably <code>4</code> or <code>8</code>, and has nothing to do with the actual size of the content or the memory block reserved. One should use <code>strlen</code> instead.</p>\n\n<p>Concerning <code>strcat_s</code>, one should consider that it is not available on all platforms and that you have to be aware of it's special behaviour. For example, if you call <code>strcat_s(somebuffer, 3, \"somestrlongerthan3\")</code>, which exceeds the maximum length of <code>3</code> as provided, <code>somebuffer</code> will be an \"empty\" string (i.e. the first character will be set to <code>\\0</code>.</p>\n\n<p>I'd suggest to use <code>strncat</code> or <code>snprintf</code> instead. See the following variants: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main () {\n\n    char c = \"Ciao \";  // Gives a compiler warning and yields 'T'\n\n#define maxlen 20\n\n    // Variant 1: start with initialized buffer, yet no \"pointer\" and dynamic allocation\n    char resultBuffer[maxlen] = \"Ciao \";\n    size_t charactersRemaining = maxlen-strlen(resultBuffer)-1;\n    strncat(resultBuffer, \"Marco\", charactersRemaining);\n\n    // Variant 2: use dynamically allocated buffer and snprintf, with constant \"Ciao\".\n    char *resultBuffer2 = malloc(maxlen);\n    const char* second2 = \"Marco\";\n    snprintf(resultBuffer2, maxlen, \"Ciao %s\", second2);\n\n    // Variant 3: use dynamically allocated buffer and snprintf, with probably variable \"Ciao\" and \"Marco\"\n    char *resultBuffer3 = malloc(maxlen);\n    const char* first3 = \"Ciao\";\n    const char* second3 = \"Marco\";\n    snprintf(resultBuffer3, maxlen, \"%s %s\", first3, second3);\n\n    return 0;\n} \n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4485984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7l9byTeH7Mg/AAAAAAAAAAI/AAAAAAAABB0/_6-l0qcPZVg/photo.jpg?sz=128", "display_name": "Techvigator", "link": "https://stackoverflow.com/users/4485984/techvigator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1495036902, "creation_date": 1495031183, "last_edit_date": 1495031310, "question_id": 44027655, "link": "https://stackoverflow.com/questions/44027655/strcat-s-and-char-pointer-newbie-issue", "title": "strcat_s and char pointer newbie issue", "body": "<p>I'm doing simple c excercise using visual studio.\nUsing strcat_s function I receive a violation exception thru this code:</p>\n\n<pre><code>char *str1;\nstr1 = (char *)malloc(20);\n*str1 = \"Ciao \";\nchar *str2 = \"Marco\";\nstrcat_s(str1, sizeof(str1), str2);\nprintf(\"%s\", str1);\n</code></pre>\n\n<p>Now, if I use a predefined array whith a fixed size, strcat_s works perfectly.\nHow can I use pointers to char instead of array to make it work?</p>\n\n<p>Any other solution or tip will be very appreciated.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "macos", "configure"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1495033624, "post_id": 44027589, "comment_id": 75083623, "body": "Can you create programs using those compilers?"}, {"owner": {"reputation": 1, "user_id": 8003601, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212802278835503/picture?type=large", "display_name": "Thien An Nguyen", "link": "https://stackoverflow.com/users/8003601/thien-an-nguyen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495046564, "post_id": 44027589, "comment_id": 75091591, "body": "actually, after some testing, it looks like my mpif77 is broken (trying &#39;mpif77 -help&#39; , &#39;mpif77 - show&#39; , nothing shows up).   I&#39;m having trouble figuring out how to reinstall mpif77, would you know how I would go about doing that?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495046712, "post_id": 44027589, "comment_id": 75091663, "body": "Sorry; can&#39;t help you any more than Google can. I&#39;d have to hunt down where those compilers come from etc.  (I&#39;d not heard of them before you asked this question.)  Try <code>mpif77 --version</code> (double dash, probably, though if that doesn&#39;t work, try a single dash, or just <code>-V</code>, or perhaps even <code>-v</code>).  That may tell you the version of the software.  It may not help you with compilation, per se."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495047000, "post_id": 44027589, "comment_id": 75091814, "body": "The config.log is likely to be too big to be useful.  What might be relevant is the part where it diagnoses the compiler problem, which is likely to be near the end of the log.  If you can find 100 lines or less at the end which contain the error messages, they might tell you what&#39;s up, or you might be able to post those here.  Copy&#39;n&#39;paste into the edit window, then select them, then indent them by pressing the <b><code>{}</code></b> button above the edit window.   If you&#39;re feeling fancy, add <code>&lt;!-- language: lang-none --&gt;</code> as an unindented line on its own (blank line above and below) before the log file."}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 4597023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1089025404457164/picture?type=large", "display_name": "riodoro1", "link": "https://stackoverflow.com/users/4597023/riodoro1"}, "is_accepted": false, "score": 1, "last_activity_date": 1495031574, "creation_date": 1495031574, "answer_id": 44027812, "question_id": 44027589, "link": "https://stackoverflow.com/questions/44027589/configure-error-c-compiler-cannot-create-executables-osx-el-capitan/44027812#44027812", "title": "Configure: error: C compiler cannot create executables (OSX El Capitan)", "body": "<p>This error usually means that the compiler failes a simple test of compiling a test code and running the resulting binary. You are trying to use <code>mpicc</code> to compile your project (is it necessary?) and it is only a wrapper for regular compiler, You have to have gcc or clang already in the system.</p>\n\n<p>The easiest way to get all \"Command line tools\" including clang for macOS is to just install XCode and follow with <code>xcode-select --install</code> in terminal.</p>\n"}], "owner": {"reputation": 1, "user_id": 8003601, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212802278835503/picture?type=large", "display_name": "Thien An Nguyen", "link": "https://stackoverflow.com/users/8003601/thien-an-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2188, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495046845, "creation_date": 1495031017, "last_edit_date": 1495046845, "question_id": 44027589, "link": "https://stackoverflow.com/questions/44027589/configure-error-c-compiler-cannot-create-executables-osx-el-capitan", "title": "Configure: error: C compiler cannot create executables (OSX El Capitan)", "body": "<p>I'm trying to install some software on my Mac (OS X El Capitan 10.11) and when running its configure script, I'm getting a message that it cannot create executables.  I'm passing:</p>\n\n<pre><code>../configure \\\n--disable-diablo \\\n--download-essential  \\\nCC=/usr/local/bin/mpicc  \\\nCXX=/usr/local/bin/mpicxx  \\\nF77=/usr/local/bin/mpif77  \\\nFC=/usr/local/bin/mpif90  \\\n</code></pre>\n\n<p>from a build directory.  I had to specify where the compilers are located as it would also return an error if I didn't.  Also, I am very new to this material so I would like to ask for a bit of patience if I take a while to understand whatever help is sent my way.</p>\n\n<p>Also, I'm having trouble posting my config.log, so help with that would be appreciated as well.</p>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1495031034, "post_id": 44027366, "comment_id": 75081503, "body": "What are your threads <i>actually</i> doing? Perhaps you can try to simplify them until they work, and then add a single little thing one step at a time until it stops working, and then locate the problematic code that way? Do you perhaps have a deadlock or data race? Have you tried using tools such as <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> (more specifically its <a href=\"http://valgrind.org/info/tools.html\" rel=\"nofollow noreferrer\">Hellgrind and DRD tools</a>)?"}, {"owner": {"reputation": 221, "user_id": 7763046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41a630c2956be53670e6558efd8277f2?s=128&d=identicon&r=PG&f=1", "display_name": "Vor Name", "link": "https://stackoverflow.com/users/7763046/vor-name"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1495031270, "post_id": 44027366, "comment_id": 75081714, "body": "hello @Someprogrammerdude ty for your answer! is everything i posted so far correct? this is my main.c <a href=\"https://pastebin.com/WCPbWnf6\" rel=\"nofollow noreferrer\">pastebin.com/WCPbWnf6</a> || the producer is reading a file with links and the consumer is downloading the urls || askServer(const char* address, const char* page, const char* filename) || if you would like to download www.youtube.com/new you would pass it like askServer(&#39;www.youtube.com&#39;, &#39;/new&#39;, file you would like to safe it to)"}, {"owner": {"reputation": 221, "user_id": 7763046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41a630c2956be53670e6558efd8277f2?s=128&d=identicon&r=PG&f=1", "display_name": "Vor Name", "link": "https://stackoverflow.com/users/7763046/vor-name"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1495033916, "post_id": 44027366, "comment_id": 75083830, "body": "btw. the programm is finishing &quot;correctly&quot; if i kill it with exit(0) after all the jobs are done, but if i try to use pthread_exit(3)  the programm never stopps, so i guess it cant be a deadlock/data race right?"}, {"owner": {"reputation": 221, "user_id": 7763046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41a630c2956be53670e6558efd8277f2?s=128&d=identicon&r=PG&f=1", "display_name": "Vor Name", "link": "https://stackoverflow.com/users/7763046/vor-name"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1495034732, "post_id": 44027366, "comment_id": 75084456, "body": "i dont know how to use valgrind but i compiled my main with gcc -Wall -Werror -g -pthread -std=c99 main.c socket.o -o test || then run valgrind || valgrind ./test | and the output was the same as before // no (valgrind) errors occured it still just idled after finishing the jobs"}, {"owner": {"reputation": 221, "user_id": 7763046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41a630c2956be53670e6558efd8277f2?s=128&d=identicon&r=PG&f=1", "display_name": "Vor Name", "link": "https://stackoverflow.com/users/7763046/vor-name"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1495035256, "post_id": 44027366, "comment_id": 75084867, "body": "even if i try to swap pthread_exit(0) with printf(&quot;test&quot;) it doesnt output anything just exit(0) works so far but i just want to kill the thread not the whole program"}, {"owner": {"reputation": 2085, "user_id": 3787736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083a38739359a3cb689c5be4cd7a1985?s=128&d=identicon&r=PG", "display_name": "dho", "link": "https://stackoverflow.com/users/3787736/dho"}, "edited": false, "score": 0, "creation_date": 1495216461, "post_id": 44027366, "comment_id": 75176516, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>. The snippets you have provided are not enough to diagnose the problem, though I suspect you have a locking issue somewhere."}], "owner": {"reputation": 221, "user_id": 7763046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41a630c2956be53670e6558efd8277f2?s=128&d=identicon&r=PG&f=1", "display_name": "Vor Name", "link": "https://stackoverflow.com/users/7763046/vor-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1495221218, "creation_date": 1495030449, "last_edit_date": 1495221218, "question_id": 44027366, "link": "https://stackoverflow.com/questions/44027366/c-pthread-join-exit-threads-exit-wont-work", "title": "C pthread join/exit Threads (Exit wont work)", "body": "<p>im trying to learn Threads, but i have a issue..\nI'am trying to create multiple Threads as defined by ThreadCount and close them all after the work is done.</p>\n\n<pre><code>#define ThreadCount 5\n</code></pre>\n\n<p>just a short snippet of my main</p>\n\n<pre><code>pthread_t pro;\npthread_t con[ThreadCount];\npthread_attr_t attr;\npthread_attr_init(&amp;attr);\n\npthread_create(&amp;pro, &amp;attr, producer, fifo);\nfor(unsigned int i = 0; i &lt;ThreadCount;++i){\n    pthread_create (&amp;con[i], NULL, consumer, createhilfsStruct(i,fifo));\n}\nfor(unsigned int i = 0; i &lt;ThreadCount;++i){\n    pthread_join (con[i], NULL);\n}\npthread_join (pro, NULL);\nprintf(\"Done\");\npthread_exit(NULL);\n</code></pre>\n\n<p>__</p>\n\n<pre><code>typedef struct{\n    int threadName;\n    queue* queue;\n}hilfsStruct;\n\ntypedef struct {\n    job* buf[QUEUESIZE];\n    long head, tail;\n    int full, empty, currentPages, done;\n    pthread_mutex_t *mut;\n    pthread_cond_t *notFull, *notEmpty;\n} queue;\n\nhilfsStruct* createhilfsStruct(int threadName, queue* q){\n    hilfsStruct* h = (hilfsStruct*)malloc (sizeof (hilfsStruct));\n    h-&gt;queue = q;\n    h-&gt;threadName = threadName;\n    return h;\n}\n\nqueue *queueInit (void) {\n    queue *q;\n\n    q = (queue *)malloc (sizeof (queue));\n    if (!q) return (NULL);\n\n    q-&gt;empty = 1;\n    q-&gt;full = 0;\n    q-&gt;head = 0;\n    q-&gt;tail = 0;\n    q-&gt;currentPages = 0;\n    q-&gt;done = 0;\n    q-&gt;mut = (pthread_mutex_t *) malloc (sizeof (pthread_mutex_t));\n    pthread_mutex_init (q-&gt;mut, NULL);\n    q-&gt;notFull = (pthread_cond_t *) malloc (sizeof (pthread_cond_t));\n    pthread_cond_init (q-&gt;notFull, NULL);\n    q-&gt;notEmpty = (pthread_cond_t *) malloc (sizeof (pthread_cond_t));\n    pthread_cond_init (q-&gt;notEmpty, NULL);\n\n    return (q);\n}\n</code></pre>\n\n<p>And in my consumer function i have a query to check if fifo->done is true and if its true i use exit(0); to kill the program ==> printf(\"Done\") in the main cant get called [obviously]</p>\n\n<p>If i swap the exit(0) for an pthread_exit(3); // i found this online but i cant figure out why 3</p>\n\n<p>It doesn't exit the thread and the program is just idling and never closes / never reaches anything below the pthread_join</p>\n\n<p>My first try was to use <code>pthread_t con, pro;</code> instead of <code>pthread_t con[..]</code> and just <code>pthread_join(con,NULL)</code> but that wasn't working either.</p>\n\n<p>What am i doing wrong?</p>\n\n<p>Ty guys, and have a nice day</p>\n"}, {"tags": ["c", "libclang", "libtooling"], "answers": [{"comments": [{"owner": {"reputation": 430, "user_id": 2339855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BMtCI.png?s=128&g=1", "display_name": "Marcus Karpoff", "link": "https://stackoverflow.com/users/2339855/marcus-karpoff"}, "edited": false, "score": 0, "creation_date": 1532365235, "post_id": 50725053, "comment_id": 89936669, "body": "I no longer need this but for the next poor soul who stumble across this I&#39;ll mark this as the correct answer."}], "tags": [], "owner": {"reputation": 516, "user_id": 6490190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c28036f5e41e1db1ea8d989c9264820?s=128&d=identicon&r=PG", "display_name": "Yuriy", "link": "https://stackoverflow.com/users/6490190/yuriy"}, "is_accepted": true, "score": 1, "last_activity_date": 1534433582, "last_edit_date": 1534433582, "creation_date": 1528301724, "answer_id": 50725053, "question_id": 44027316, "link": "https://stackoverflow.com/questions/44027316/clang-libtooling-insert-a-new-header-safely/50725053#50725053", "title": "clang libtooling insert a new header safely", "body": "<p>AFAIK it is possible (The proposed variants are for c ++ but with some changes can be used for c). </p>\n\n<p>I don't know what do you mean by \"safely insert\", \nbut I see two ways:</p>\n\n<ol>\n<li>Inserting <code>#include</code> near existing one. The problem here is to find\nexisting <code>#include</code>. The possible way to do it  described here:\n<a href=\"https://stackoverflow.com/a/44077744/6490190\">https://stackoverflow.com/a/44077744/6490190</a></li>\n<li><p>Inserting include before the topmost <code>TranslationUnitDecl</code> or\n<code>NamespaceDecl</code> in AST. The idea is to start from some <code>Stmt</code> or\n<code>Decl</code> or <code>Type</code> in code and recursively visit all its parents:\n<code>ASTContext::getParents()</code> until <code>TranslationUnitDecl</code> or\n<code>NamespaceDecl</code> is found.</p>\n\n<p>Example can be found here:</p>\n\n<ul>\n<li><a href=\"https://github.com/YulyIllarionov/Cpp-14-Regress/blob/master/cpp14regress/inc/lambda.h\" rel=\"nofollow noreferrer\">https://github.com/YulyIllarionov/Cpp-14-Regress/blob/master/cpp14regress/inc/lambda.h</a>,</li>\n<li><a href=\"https://github.com/YulyIllarionov/Cpp-14-Regress/blob/master/cpp14regress/src/lambda.cpp\" rel=\"nofollow noreferrer\">https://github.com/YulyIllarionov/Cpp-14-Regress/blob/master/cpp14regress/src/lambda.cpp</a></li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 430, "user_id": 2339855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BMtCI.png?s=128&g=1", "display_name": "Marcus Karpoff", "link": "https://stackoverflow.com/users/2339855/marcus-karpoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 3, "accepted_answer_id": 50725053, "answer_count": 1, "score": 2, "last_activity_date": 1534433582, "creation_date": 1495030290, "last_edit_date": 1495535476, "question_id": 44027316, "link": "https://stackoverflow.com/questions/44027316/clang-libtooling-insert-a-new-header-safely", "title": "clang libtooling insert a new header safely", "body": "<p>I'm using clang's libtooling to modify some code and I'm trying to find a way to safely insert a header whenever my tool is used on a C file.</p>\n\n<p>I've read <a href=\"https://stackoverflow.com/questions/27029313/whats-the-right-way-to-match-includes-or-defines-using-clangs-libtooling\">What's the right way to match #includes (or #defines) using Clang's libtooling?</a> question about match calls to the preprocessors but I'm still uncertain about using it to insert code. </p>\n\n<p>What is the proper way to insert a new #include using libtooling rewriter?</p>\n"}, {"tags": ["c", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1495030098, "post_id": 44027206, "comment_id": 75080794, "body": "Sounds perfectly reasonable.  Do you have any specific doubts?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495030200, "post_id": 44027206, "comment_id": 75080888, "body": "@ThingyWotsit not really, I just wanted to hear some other opinions."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495030341, "post_id": 44027206, "comment_id": 75080984, "body": "Well, that&#39;s what I would do straight off, without any further thought about it.  It would certainly work, and so why bother with more complex solutions?  :)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1495030390, "post_id": 44027206, "comment_id": 75081024, "body": "the best - use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684245(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MsgWaitForMultipleObjectsEx</a> - you absolute not need create additional threads"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495030572, "post_id": 44027206, "comment_id": 75081173, "body": "I mean, you could go messing about with the input to the message loop, MsgWaitForMultipleObjectsEx(), say.  That would mean modifying code that already works fine, so it&#39;s not something I would bother with just to avoid another thread.  If it&#39;s already simple, reasonably efficient and works well, why tinker:)"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495030607, "post_id": 44027206, "comment_id": 75081198, "body": "@RbMm LOL...... we may have to agree to differ:)"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495030681, "post_id": 44027206, "comment_id": 75081248, "body": "Of course, the main objection to MsgWaitForMultipleObjectsEx() is the typing required to enter it:)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495030820, "post_id": 44027206, "comment_id": 75081349, "body": "&quot;If it&#39;s already simple, reasonably efficient and works well, why tinker:) &quot; - for make the best solution. for high quality professional code. create additional, absolute non needed thread here - no professional, not effective and not the best way"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495032062, "post_id": 44027206, "comment_id": 75082391, "body": "@RbMm &#39;Best&#39; solution?  You consider modifying the input to the message handling/dispatch loop, (something that is already working), a professional approach?   Posting messages, and having them handled in the &#39;usual&#39; manner, is not something to be worried about in &#39;high quality professional code&#39;.  &#39;absolute non needed thread&#39; - yes.  Expedient and flexible, also yes.    As I said, we may have to agree to differ:)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495032131, "post_id": 44027206, "comment_id": 75082444, "body": "@ThingyWotsit - yes, we can agree to be differ :)"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495086323, "post_id": 44035728, "comment_id": 75104928, "body": "Thanks a lot. Very good answer. I was already using <code>PostMessage</code>, the wording in the question was not optimal."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495109745, "post_id": 44035728, "comment_id": 75120263, "body": "Well, &#39;so there will be no worries about thread-related problems such as race conditions and deadlocks&#39; what?  How could there be any such thing?  It&#39;s just sequential code - create process, wait for it to finish, postMessage.  &#39;The program flow for creating the process and waiting for it is simpler. It can be sequential instead of event-based like the thread solution.&#39; - this is completely and totally upside-down and incorrect."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495109921, "post_id": 44035728, "comment_id": 75120385, "body": "&#39;so I try to avoid threads as much as possible&#39; - I noticed - you are spreading unnecessary FUD about &#39;race conditions and deadlocks&#39; where there is zero chance of that happening in this application."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495110148, "post_id": 44035728, "comment_id": 75120565, "body": "You are, essentially, calling DoEvents() in an event-handler loop and using a flag to prevent reentrancy.  That is ummm.... &#39;not optimal&#39; :("}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495126869, "post_id": 44035728, "comment_id": 75132622, "body": "@ThingyWotsit I don&#39;t think that there is such a thing like a trivial thread. The correct patterns might be obvious for you and me but certainly not for the less experienced developers. Dead-lock issue is very real even in such &quot;simple&quot; cases (<code>PostMessage()</code> vs. <code>SendMessage()</code>) and code evolves and won&#39;t stay simple for all time."}], "tags": [], "owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "is_accepted": true, "score": 2, "last_activity_date": 1495060453, "last_edit_date": 1495060453, "creation_date": 1495060062, "answer_id": 44035728, "question_id": 44027206, "link": "https://stackoverflow.com/questions/44027206/launch-an-application-and-wait-until-it-has-finished-without-blocking-redraw/44035728#44035728", "title": "Launch an application and wait until it has finished without blocking redraw", "body": "<p>Your approach is fine, just make sure to use <code>PostMessage()</code> for</p>\n\n<blockquote>\n  <p>send a special WM_APP message to the main window</p>\n</blockquote>\n\n<p>to avoid deadlock if the main thread happens to wait for thread T.</p>\n\n<p>As commenter noted, an <strong>alternative for creating a thread</strong> is to use a message loop with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684245(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>MsgWaitForMultipleObjectsEx</code></a>. </p>\n\n<p>The advantages I see:</p>\n\n<ul>\n<li>There is no additional thread required, so there will be no worries about thread-related problems such as race conditions and deadlocks. These problems are often hard to find and debug (typically they only happen on customer machines), so I try to avoid threads as much as possible.</li>\n<li>The program flow for creating the process and waiting for it is simpler. It can be sequential instead of event-based like the thread solution.</li>\n</ul>\n\n<p>You have to judge for yourself if this is a <em>better</em> approach for your scenario. </p>\n\n<p>A function that can be used to <strong>wait for a process</strong> (or any other waitable handle) <strong>while processing messages</strong> could be as follows. It's implementation is pretty involved (for background info see the links at the end of my answer) but usage is quite easy (see example afterwards).</p>\n\n<pre><code>// Function to process messages until the state of any of the given objects is signaled, \n// the timeout is reached or a WM_QUIT message is received.\n// Parameter hDialog can be nullptr, if there is no dialog.\n//\n// Returns ERROR_SUCCESS if any of the given handles is signaled.\n// Returns ERROR_TIMEOUT in case of timeout.\n// Returns ERROR_CANCELLED if the WM_QUIT message has been received.\n// Returns the value of GetLastError() if MsgWaitForMultipleObjectsEx() fails.\n\nDWORD WaitForObjectsWithMsgLoop( \n    HWND hDialog, const std::vector&lt;HANDLE&gt;&amp; handles, DWORD timeOutMillis = INFINITE )\n{\n    if( handles.empty() )\n        return ERROR_INVALID_PARAMETER;\n\n    DWORD handleCount = static_cast&lt;DWORD&gt;( handles.size() );\n    DWORD startTime = GetTickCount();\n    DWORD duration = 0;\n    do\n    {\n        DWORD status = MsgWaitForMultipleObjectsEx(\n            handleCount, handles.data(), \n            timeOutMillis - duration, \n            QS_ALLINPUT, \n            MWMO_INPUTAVAILABLE );\n\n        if( status == WAIT_FAILED )\n        {\n            // MsgWaitForMultipleObjectsEx() has failed.\n            return GetLastError();\n        }\n        else if( status &gt;= WAIT_OBJECT_0 &amp;&amp; status &lt; WAIT_OBJECT_0 + handleCount )\n        {\n            // Any of the handles is signaled.\n            return ERROR_SUCCESS;\n        }\n        else if( status == WAIT_OBJECT_0 + handleCount )\n        {\n            // New input is available, process it.\n            MSG msg;\n            while( PeekMessage( &amp;msg, NULL, 0, 0, PM_REMOVE ) )\n            {\n                if( msg.message == WM_QUIT )\n                {\n                    // End the message loop because of quit message.\n                    PostQuitMessage( static_cast&lt;int&gt;( msg.wParam ) );\n                    return ERROR_CANCELLED;\n                }\n                // Enable message filter hooks (that's what the system does in it's message loops).\n                // You may use a custom code &gt;= MSGF_USER.\n                // https://blogs.msdn.microsoft.com/oldnewthing/20050428-00/?p=35753\n                if( ! CallMsgFilter( &amp;msg, MSGF_USER ) )\n                {\n                    // Optionally process dialog messages.\n                    if( ! hDialog || ! IsDialogMessage( hDialog, &amp;msg ) )\n                    {\n                        // Standard message processing.\n                        TranslateMessage( &amp;msg );\n                        DispatchMessage( &amp;msg );\n                    }\n                }\n            }\n        }\n\n        duration = GetTickCount() - startTime;\n    }\n    while( duration &lt; timeOutMillis );\n\n    // Timeout reached.\n    return ERROR_TIMEOUT;\n}\n</code></pre>\n\n<p>The function could be used in a dialog box procedure as follows. Error handling omitted for brevity.</p>\n\n<pre><code>INT_PTR CALLBACK YourDialogProc( HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam )\n{\n    static bool s_childProcessRunning = false;\n\n    switch( message )\n    {\n        case YourMessageToLaunchProcess:\n        {\n            // prevent reentrancy in case the process is already running\n            if( s_childProcessRunning )\n            {\n                MessageBoxW( hDlg, L\"Process already running\", L\"Error\", MB_ICONERROR );\n                return TRUE;\n            }\n            // Prepare CreateProcess() arguments\n            STARTUPINFO si{ sizeof(si) };\n            PROCESS_INFORMATION pi{};\n            wchar_t command[] = L\"notepad.exe\"; // string must be writable!\n\n            // Launch the process\n            if( CreateProcessW( NULL, command, NULL, NULL, FALSE, 0, NULL, NULL, &amp;si, &amp;pi ) )\n            {\n                // Set flag to prevent reentrancy. \n                s_childProcessRunning = true;  \n\n                // Wait until the child process exits while processing messages\n                // to keep the window responsive.  \n                DWORD waitRes = WaitForObjectsWithMsgLoop( hDlg, { pi.hProcess } );\n                // TODO: Check waitRes for error\n\n                s_childProcessRunning = false;\n\n                // Cleanup\n                CloseHandle( pi.hThread );\n                CloseHandle( pi.hProcess );\n            }\n            return TRUE;\n        }\n\n        // more message handlers...\n    }\n    return FALSE;\n}\n</code></pre>\n\n<p>Obligatory Old New Thing links:</p>\n\n<ul>\n<li><a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20060126-00/?p=32513\" rel=\"nofollow noreferrer\">Pumping messages while waiting for a period of time</a></li>\n<li><a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20050401-00/?p=35993/\" rel=\"nofollow noreferrer\">The dialog manager, part 4: The dialog loop</a></li>\n<li><a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20050428-00/?p=35753\" rel=\"nofollow noreferrer\">Rescuing thread messages from modal loops via message filters</a></li>\n</ul>\n"}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "accepted_answer_id": 44035728, "answer_count": 1, "score": 2, "last_activity_date": 1495086588, "creation_date": 1495030024, "last_edit_date": 1495086588, "question_id": 44027206, "link": "https://stackoverflow.com/questions/44027206/launch-an-application-and-wait-until-it-has-finished-without-blocking-redraw", "title": "Launch an application and wait until it has finished without blocking redraw", "body": "<p>I have an interactive Win32 application and at some point I need to launch another application and wait until that other application has finished. During the time the other application runs, the interactive application shouldn't be responsive expect for resizing and moving the window (this implies of course that the interactive application still should continue redrawing).</p>\n\n<p>My current approach is this:</p>\n\n<ol>\n<li>Create a Thread T</li>\n<li>Disable the main window (with <code>EnableWindow(handle, FALSE)</code>)</li>\n<li>Continue message loop</li>\n<li>Special <code>WM_APP</code> message sent from thread T will enable the main window again (<code>EnableWindow(handle, TRUE)</code>);</li>\n</ol>\n\n<p>Thread T:</p>\n\n<ol>\n<li>launch the application with <code>CreateProcess</code></li>\n<li>wait until application has terminated using <code>WaitForSingleObject</code></li>\n<li>post a special <code>WM_APP</code> message to the main window using <code>PostMessage</code>.</li>\n<li>thread terminates here</li>\n</ol>\n\n<p>This works fine, but I'm not sure if this is the correct approach.</p>\n\n<p>Is there a better approach or should I continue like this?</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 846, "user_id": 1137102, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/HOdwV.png?s=128&g=1", "display_name": "RoiHatam", "link": "https://stackoverflow.com/users/1137102/roihatam"}, "edited": false, "score": 0, "creation_date": 1495029925, "post_id": 44027116, "comment_id": 75080654, "body": "where is <code>;</code> before the <code>do</code>?"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1495029937, "post_id": 44027116, "comment_id": 75080662, "body": "you forgot some \\"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495030010, "post_id": 44027116, "comment_id": 75080720, "body": "Never use a macro where a function or a function call wrapped in a macro will do as well."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495030349, "post_id": 44027116, "comment_id": 75080990, "body": "You probably didn&#39;t include stdlib.h. Btw, using the same identifiers as those present in the standard libraries is not allowed by C."}, {"owner": {"reputation": 3493, "user_id": 1511337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KB2az.jpg?s=128&g=1", "display_name": "Chan Kim", "link": "https://stackoverflow.com/users/1511337/chan-kim"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495030537, "post_id": 44027116, "comment_id": 75081150, "body": "@Lundin, I want to leave malloc(..) intact in the original codes but overload it to do malloc plus some other task(printing here). Isn&#39;t it possible?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1495030718, "post_id": 44027116, "comment_id": 75081271, "body": "@ChanKim Strictly speaking, I believe that the C language forbids this through 7.1.3. It may or may not work on some compilers but it probably won&#39;t be portable."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1495030739, "post_id": 44027116, "comment_id": 75081287, "body": "Please write in modern C, not archaic C.  All functions need an explicit return type \u2014 including <code>main()</code>.  You should write <code>int main(void)</code> every time (unless you use the command line arguments; then you use a variant on <code>int main(int argc, char **argv)</code>), and every other function definition should have an explicit type.  This is required by C99 and beyond."}, {"owner": {"reputation": 3493, "user_id": 1511337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KB2az.jpg?s=128&g=1", "display_name": "Chan Kim", "link": "https://stackoverflow.com/users/1511337/chan-kim"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495030850, "post_id": 44027116, "comment_id": 75081375, "body": "@Lundin, but it should be noted we can modify the behavior of malloc() using #define using the answer by John Zwinck below."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1495031001, "post_id": 44027182, "comment_id": 75081482, "body": "Note that, in theory, the <code>&lt;stdlib.h&gt;</code> header could have provided a macro for <code>malloc()</code>.  You might, therefore, need to <code>#undef malloc</code> before defining this macro.  The chances of running foul of this are minimal, but funnier things have been known.  I got burned by a macro definition for <code>snprintf()</code> once, for example."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 4, "last_activity_date": 1495029973, "creation_date": 1495029973, "answer_id": 44027182, "question_id": 44027116, "link": "https://stackoverflow.com/questions/44027116/adding-a-statement-after-or-before-all-specific-function-calls-using-define-in-c/44027182#44027182", "title": "adding a statement after or before all specific function calls using define in C", "body": "<p>Try this:</p>\n\n<pre><code>#define malloc(x) ( \\\n    printf(\"malloc at %s()-%d,%s\\n\",__func__,__LINE__,__FILE__), \\\n    malloc(x))\n</code></pre>\n\n<p>The idea is to use the \"comma operator\" like this:</p>\n\n<pre><code>int *ip = (printf(...), malloc(120*sizeof(int)));\n</code></pre>\n\n<p>The result of the comma operator is always its last argument.</p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1495048001, "post_id": 44029425, "comment_id": 75092344, "body": "A wrapper <i>function</i> cannot use <code>__func__</code>, <code>__LINE__</code> or <code>__FILE__</code> like this..."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1495035852, "creation_date": 1495035852, "answer_id": 44029425, "question_id": 44027116, "link": "https://stackoverflow.com/questions/44027116/adding-a-statement-after-or-before-all-specific-function-calls-using-define-in-c/44029425#44029425", "title": "adding a statement after or before all specific function calls using define in C", "body": "<p>Given the macro, the line</p>\n\n<pre><code>int *ip = malloc(120*sizeof(int));\n</code></pre>\n\n<p>expands to</p>\n\n<pre><code>int *ip = do { malloc(120*sizeof(int)); printf(\"malloc at %s()-%d,%s\\n\",__func__,__LINE__,__FILE__);} while(0);\n</code></pre>\n\n<p>which hopefully makes it obvious where that error comes from.  </p>\n\n<p>John Zwinck's solution is a good option, although personally I'd create a wrapper function (named something other than <code>malloc</code>, naturally) rather than a macro.  </p>\n"}], "owner": {"reputation": 3493, "user_id": 1511337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KB2az.jpg?s=128&g=1", "display_name": "Chan Kim", "link": "https://stackoverflow.com/users/1511337/chan-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 44027182, "answer_count": 2, "score": 0, "last_activity_date": 1495035852, "creation_date": 1495029779, "last_edit_date": 1495029846, "question_id": 44027116, "link": "https://stackoverflow.com/questions/44027116/adding-a-statement-after-or-before-all-specific-function-calls-using-define-in-c", "title": "adding a statement after or before all specific function calls using define in C", "body": "<p>I have done this before but somehow I can't do it now so I ask here.\nI have some codes I downloaded from a git repository and I want to print the filename, and linenumber whenever malloc is called. I made a simple test.  </p>\n\n<pre><code>---- test.c ----\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"xxx.h\"\n\nmain()\n{\nprintf(\"hello\\n\");\nint *ip = malloc(120*sizeof(int));\nprintf(\"ip = %x\\n\",ip);\nfree(ip);\n}\n\n---- xxx.h\n#define malloc(x) do {malloc(x); \\\nprintf(\"malloc at %s()-%d,%s\\n\",__func__,__LINE__,__FILE__);} \\\nwhile(0)\n</code></pre>\n\n<p>When I do <code>gcc test.c</code>, I get</p>\n\n<pre><code>test.c: In function 'main':\ntest.c:8: error: expected expression before 'do'\n</code></pre>\n\n<p>How should I fix xxx.h ?  (this question applies also for C++)</p>\n"}, {"tags": ["c", "ruby", "api"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1495030396, "post_id": 44027037, "comment_id": 75081031, "body": "<code>RBASIC(my_argument)-&gt;klass</code> should do."}, {"owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1495031740, "post_id": 44027037, "comment_id": 75082118, "body": "Yes, it does. Thank you very much."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1495085019, "creation_date": 1495085019, "answer_id": 44039204, "question_id": 44027037, "link": "https://stackoverflow.com/questions/44027037/how-to-get-the-class-of-a-value-in-ruby-c-api/44039204#44039204", "title": "How to get the class of a VALUE in Ruby C API", "body": "<p>Every ruby object is internally represented by <a href=\"https://github.com/ruby/ruby/blob/0472578b26793e45434769200a806cb6190e5700/include/ruby/ruby.h#L889\" rel=\"nofollow noreferrer\"><code>RObject</code></a> struct (I will copy the source here for the sake of future readers):</p>\n\n<pre><code>struct RObject {\n  struct RBasic basic;\n  union {\n    struct {\n      uint32_t numiv;\n      VALUE *ivptr;\n      void *iv_index_tbl; /* shortcut for RCLASS_IV_INDEX_TBL(rb_obj_class(obj)) */\n    } heap;\n    VALUE ary[ROBJECT_EMBED_LEN_MAX];\n  } as;\n};\n</code></pre>\n\n<p>The very first member, <a href=\"https://github.com/ruby/ruby/blob/0472578b26793e45434769200a806cb6190e5700/include/ruby/ruby.h#L854\" rel=\"nofollow noreferrer\"><code>RBasic</code></a>, defines the class:</p>\n\n<pre><code>struct RBasic {\n    VALUE flags;\n    const VALUE klass;\n}\n</code></pre>\n\n<p>To get an access to <code>RBasic</code> metadata of anything, one might use <code>RBASIC</code> macro:</p>\n\n<pre><code>RBASIC(my_argument)\n</code></pre>\n\n<p>To get the class directly, one might use <a href=\"https://github.com/ruby/ruby/blob/0472578b26793e45434769200a806cb6190e5700/include/ruby/ruby.h#L878\" rel=\"nofollow noreferrer\"><code>RBASIC_CLASS</code></a> macro:</p>\n\n<pre><code>RBASIC_CLASS(my_argument)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 2, "last_activity_date": 1531738110, "creation_date": 1531738110, "answer_id": 51360066, "question_id": 44027037, "link": "https://stackoverflow.com/questions/44027037/how-to-get-the-class-of-a-value-in-ruby-c-api/51360066#51360066", "title": "How to get the class of a VALUE in Ruby C API", "body": "<p>I came across this recently, and used the <code>RBASIC_CLASS</code> macro, but was getting segfaults in certain scenarios for some unexplained reason.</p>\n\n<p>After scanning through <code>ruby.h</code>, I found the <code>CLASS_OF</code> macro, which returns the class as <code>VALUE</code> of a given object.</p>\n\n<pre><code>VALUE obj = INT2NUM(10);\nVALUE klass = CLASS_OF(obj); // rb_cInteger \n</code></pre>\n\n<p>Using Ruby 2.5</p>\n"}], "owner": {"reputation": 116, "user_id": 7926043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2a05eeb94cfe09ed7a81a9dbd971998?s=128&d=identicon&r=PG&f=1", "display_name": "Sisyphe", "link": "https://stackoverflow.com/users/7926043/sisyphe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 44039204, "answer_count": 2, "score": 1, "last_activity_date": 1531738110, "creation_date": 1495029554, "last_edit_date": 1495051425, "question_id": 44027037, "link": "https://stackoverflow.com/questions/44027037/how-to-get-the-class-of-a-value-in-ruby-c-api", "title": "How to get the class of a VALUE in Ruby C API", "body": "<p>I created some classes with Ruby's C API. I want to create a function whose behavior will change depending on the class of the Ruby object.</p>\n\n<p>I tried to use <code>is_a?</code> from Ruby, however, I don't think it's the good way to do this. I checked \"<a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc\" rel=\"nofollow noreferrer\">Creating Extension Libraries for Ruby</a>\" without success. The only direct way to check classes is with the default types.</p>\n\n<p>I have my class \"Klass\" already created:</p>\n\n<pre><code>VALUE rb_cKlass = rb_define_class(\"Klass\", rb_cObject);\n</code></pre>\n\n<p>And how I wanted to check if the class is the good one:</p>\n\n<pre><code>VALUE my_function(VALUE self, VALUE my_argument) {\n    if(rb_check_class(my_argument), rb_cKlass)) {\n        // do something if my_argument is an instance of Klass\n    } else {\n        return Qnil;\n    }\n}\n</code></pre>\n\n<p>Is there a way to do this?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1495028828, "post_id": 44026698, "comment_id": 75079769, "body": "What does <code>it doesn&#39;t work</code> mean"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1495028829, "post_id": 44026698, "comment_id": 75079772, "body": "Please show the input, as well as the actual and expected output. &quot;Does not work&quot; is not a problem statement."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1495028840, "post_id": 44026698, "comment_id": 75079781, "body": "Welcome to Stack Overflow! You mind creating a <a href=\"http://stackoverflow.com/help/mcve\"><b><i>MCVE</i></b></a>?"}, {"owner": {"reputation": 1156, "user_id": 4597023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1089025404457164/picture?type=large", "display_name": "riodoro1", "link": "https://stackoverflow.com/users/4597023/riodoro1"}, "edited": false, "score": 1, "creation_date": 1495028953, "post_id": 44026698, "comment_id": 75079872, "body": "Also irrelevant to the problem of it not working I think this program could use some functions to make the code more readable, maybe then You will be able to use the debugger and find the problem yourself."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1495029032, "post_id": 44026698, "comment_id": 75079929, "body": "<code>i&lt;=k</code> --&gt; <code>i&lt;k</code> and Need set <code>found</code> to <code>0</code> before  loop. Also <code>k &lt; 49</code> --&gt; <code>k &lt; 50</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495029255, "post_id": 44026698, "comment_id": 75080109, "body": "Please edit the post and indent the code."}, {"owner": {"reputation": 328, "user_id": 8010390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46c400c051659a29e3a5497877b9e5d3?s=128&d=identicon&r=PG&f=1", "display_name": "surjit", "link": "https://stackoverflow.com/users/8010390/surjit"}, "edited": false, "score": 0, "creation_date": 1495029287, "post_id": 44026698, "comment_id": 75080140, "body": "at first using option 1 i can enter data into the array. and using option 3 I can remove the date. but after using option 3 (case 3) when I try to enter a new data using option 1(case 1), it prompts for the input but doesn&#39;t add the element into the array and goes back to the beginning of loop(next iteration)"}, {"owner": {"reputation": 328, "user_id": 8010390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46c400c051659a29e3a5497877b9e5d3?s=128&d=identicon&r=PG&f=1", "display_name": "surjit", "link": "https://stackoverflow.com/users/8010390/surjit"}, "edited": false, "score": 0, "creation_date": 1495029521, "post_id": 44026698, "comment_id": 75080330, "body": "I am not supposed to use any library function. so I wrote it without functions.."}, {"owner": {"reputation": 328, "user_id": 8010390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46c400c051659a29e3a5497877b9e5d3?s=128&d=identicon&r=PG&f=1", "display_name": "surjit", "link": "https://stackoverflow.com/users/8010390/surjit"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1495029695, "post_id": 44026698, "comment_id": 75080461, "body": "@BLUEPIXY <code>found</code> is set to <code>0</code> at the declaration before the loop."}], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 6044264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2d52296c121703ff0ec78ea27c0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Fighter", "link": "https://stackoverflow.com/users/6044264/phil-fighter"}, "reply_to_user": {"reputation": 328, "user_id": 8010390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46c400c051659a29e3a5497877b9e5d3?s=128&d=identicon&r=PG&f=1", "display_name": "surjit", "link": "https://stackoverflow.com/users/8010390/surjit"}, "edited": false, "score": 0, "creation_date": 1495031354, "post_id": 44027107, "comment_id": 75081797, "body": "Set <code>found</code> to <code>0</code> in the beginning of the <code>while</code> loop. When you removed a number successfully <code>found</code> is <code>1</code> again in the the next adding iteration."}, {"owner": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "reply_to_user": {"reputation": 328, "user_id": 8010390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46c400c051659a29e3a5497877b9e5d3?s=128&d=identicon&r=PG&f=1", "display_name": "surjit", "link": "https://stackoverflow.com/users/8010390/surjit"}, "edited": false, "score": 0, "creation_date": 1495031426, "post_id": 44027107, "comment_id": 75081862, "body": "@surjitsahoo That&#39;s because you&#39;re not resetting it after deleting an element (nor when searching for an element). Do as Phil says and reset it in the beginning, inside the <code>while</code> loop."}], "tags": [], "owner": {"reputation": 86, "user_id": 6044264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2d52296c121703ff0ec78ea27c0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Fighter", "link": "https://stackoverflow.com/users/6044264/phil-fighter"}, "is_accepted": true, "score": 2, "last_activity_date": 1495029753, "creation_date": 1495029753, "answer_id": 44027107, "question_id": 44026698, "link": "https://stackoverflow.com/questions/44026698/1d-array-manipulation-iteration-using-loop-and-switch-statement/44027107#44027107", "title": "1D array manipulation iteration using loop and switch statement", "body": "<p>After adding the first element your <code>found</code> is always <code>1</code>. Reset <code>found</code> to <code>0</code> before the next iteration.</p>\n"}], "owner": {"reputation": 328, "user_id": 8010390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46c400c051659a29e3a5497877b9e5d3?s=128&d=identicon&r=PG&f=1", "display_name": "surjit", "link": "https://stackoverflow.com/users/8010390/surjit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44027107, "answer_count": 1, "score": -5, "last_activity_date": 1498190515, "creation_date": 1495028709, "last_edit_date": 1498190515, "question_id": 44026698, "link": "https://stackoverflow.com/questions/44026698/1d-array-manipulation-iteration-using-loop-and-switch-statement", "title": "1D array manipulation iteration using loop and switch statement", "body": "<p>This program has multiple options to choose from such as.<br>\n1.add element to the array<br>\n2.search an element<br>\n3.remove an element<br>\nI am showing only one case as others are irrelevant. Here 1'st loop works fine for all the options, but for second iteration I can't add a new element, it always says \"element added successfully\" </p>\n\n<pre><code>int k = 0, found = 0;\n//k counts the total elements in the list\nwhile(1){\n    switch (choice)\n    {\n      case 1 :\n\n            printf(\"Enter the number : \");\n            scanf(\"%d\", &amp;num);\n            for(i=0; i&lt;=k; i++){\n              if(num == number[i]){\n                found=1;\n                printf(\"Element already added. Please try again\\n\");\n                break;\n              }\n            }\n            if(found == 0){\n              number[k]=num;\n              k = k+1;\n              printf(\"Element added successfully\\n\");\n              found = 0;\n            }\n\n    break;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 3, "creation_date": 1495028120, "post_id": 44026427, "comment_id": 75079197, "body": "If your question is about C, don&#39;t cross-tag C++ unless there is something relevant to C++ (C != C++)."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1495028344, "post_id": 44026427, "comment_id": 75079388, "body": "better to have the base struct as the first attribute of the derived ones as you may end up with more common attributes later on"}, {"owner": {"reputation": 13, "user_id": 8025616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af58e768b5196e67287b15659e2440fa?s=128&d=identicon&r=PG&f=1", "display_name": "ikkowy", "link": "https://stackoverflow.com/users/8025616/ikkowy"}, "edited": false, "score": 0, "creation_date": 1495028514, "post_id": 44026427, "comment_id": 75079518, "body": "The base type is not used to store any data in it. Only to have access to type A or type B"}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 1, "creation_date": 1495028947, "post_id": 44026427, "comment_id": 75079868, "body": "Compile with <code>-pedantic</code> and see for yourself"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495029220, "post_id": 44026427, "comment_id": 75080085, "body": "Too bad you only show snippets. But thought further you will end up violating the effective rule, invoking undefined behaviour. As you apparently have a predefined set of specialised structures, use a <code>union</code> inside your &quot;base struct&quot; instead. If you use gcc and can live with extensions, have a look at <code>-fplan9-extensions</code> which are a perfect alternative allowing an clean OOP approach."}, {"owner": {"reputation": 13, "user_id": 8025616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af58e768b5196e67287b15659e2440fa?s=128&d=identicon&r=PG&f=1", "display_name": "ikkowy", "link": "https://stackoverflow.com/users/8025616/ikkowy"}, "edited": false, "score": 0, "creation_date": 1495029522, "post_id": 44026427, "comment_id": 75080331, "body": "Ouh thanks - using a union is a great idea :3"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1495030608, "post_id": 44026427, "comment_id": 75081199, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8702713/struct-pointer-compatibility\">Struct pointer compatibility</a>"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 1, "last_activity_date": 1495031903, "creation_date": 1495031903, "answer_id": 44027940, "question_id": 44026427, "link": "https://stackoverflow.com/questions/44026427/c-programming-base-struct-type-for-derived-types/44027940#44027940", "title": "C programming - base struct type for &quot;derived&quot; types", "body": "<p>First, to answer your question, it is not allowed to point to a <code>Struct_B</code> type with a pointer of a <code>BaseStruct</code> type, if these two types have different alignment requirements (cf. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">C standard</a>):</p>\n\n<blockquote>\n  <p>6.3.2.3 Pointers</p>\n  \n  <p>(7) A pointer to an object or incomplete type may be converted to a\n  pointer to a different object or incomplete type. If the resulting\n  pointer is not correctly aligned for the pointed-to type, the behavior\n  is undefined.</p>\n</blockquote>\n\n<p>However, you can easily overcome this situation by building a proper union:</p>\n\n<pre><code>typedef enum {\n    StructType_A,\n    StructType_B\n} StructType;\n\n// &gt;&gt;&gt; type A &lt;&lt;&lt;\ntypedef struct {\n    int xyz;\n    char blabliblub;\n} Struct_A;\n\n// &gt;&gt;&gt; type B &lt;&lt;&lt;\ntypedef struct {\n    long int abc;\n} Struct_B;\n\n// &gt;&gt;&gt; composite type &lt;&lt;&lt;\ntypedef struct {\n    StructType type;\n    union {\n        Struct_A a;\n        Struct_B b;\n    } content;\n} Union_AB;\n\n\nint main () {\n    Struct_A a;\n    a.xyz  = 7853;\n    a.blabliblub = 'z';\n\n    Union_AB anA;\n    anA.type = StructType_A;\n    anA.content.a.xyz = 7853;\n    anA.content.a.blabliblub = 'Z';\n\n    Union_AB someB;\n    someB.type = StructType_B;\n    someB.content.b.abc = 5653L;\n\n    Union_AB* ptr = (&amp;anA);\n    if (ptr-&gt;type == StructType_A) printf (\"YAY :3\\n\");\n\n    ptr = (&amp;someB);\n    if (ptr-&gt;type == StructType_A) printf (\"YAY :3\\n\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8025616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af58e768b5196e67287b15659e2440fa?s=128&d=identicon&r=PG&f=1", "display_name": "ikkowy", "link": "https://stackoverflow.com/users/8025616/ikkowy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 44027940, "answer_count": 1, "score": 0, "last_activity_date": 1495031903, "creation_date": 1495028044, "last_edit_date": 1495028223, "question_id": 44026427, "link": "https://stackoverflow.com/questions/44026427/c-programming-base-struct-type-for-derived-types", "title": "C programming - base struct type for &quot;derived&quot; types", "body": "<p>The idea is that it is possible to make a pointer to an instance of <strong>Struct_A</strong> or<br>\nan instance of <strong>Struct_B</strong> with a pointer of the <strong>BaseStruct</strong> type.</p>\n\n<p>Can I create a \"base struct-type\" in C as shown below with any compiler?<br>\nI tested it with GCC and it worked, but I am not sure if it would work everywhere ...<br></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef enum {\n StructType_A,\n StructType_B\n} StructType;\n\n// &gt;&gt;&gt; base type &lt;&lt;&lt;\ntypedef struct {\n StructType type;\n} BaseStruct;\n\n// &gt;&gt;&gt; type A &lt;&lt;&lt;\ntypedef struct {\n StructType type;\n int xyz;\n char blabliblub;\n} Struct_A;\n\n// &gt;&gt;&gt; type B &lt;&lt;&lt;\ntypedef struct {\n StructType type;\n long int abc;\n} Struct_B;\n\nint main () {\n Struct_A a;\n BaseStruct* ptr;\n\n a.type = StructType_A;\n a.xyz  = 7853;\n a.blabliblub = 'z';\n\n ptr = (BaseStruct*) &amp;a;\n\n if (ptr-&gt;type == StructType_A) printf (\"YAY :3\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "priority-queue"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495028052, "post_id": 44026397, "comment_id": 75079138, "body": "Please show your <code>text2.txt</code> file."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 2, "creation_date": 1495028175, "post_id": 44026397, "comment_id": 75079249, "body": "Please provide a <a href=\"http://stackoverflow.com/help/mcve\">Minimum example</a>. We need a question to answer to, too."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495028462, "post_id": 44026397, "comment_id": 75079471, "body": "@Badda the question is probably &quot;How can I use less memory&quot;. But we need the <code>text2.txt</code> file."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1495029430, "post_id": 44026397, "comment_id": 75080256, "body": "The traveling salesman has become a quantum pizza delivery guy?"}, {"owner": {"reputation": 115, "user_id": 8024291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec67e3cfba606f304f901704a7f8f856?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios Dr", "link": "https://stackoverflow.com/users/8024291/stelios-dr"}, "edited": false, "score": 0, "creation_date": 1495029440, "post_id": 44026397, "comment_id": 75080265, "body": "S..........XX...X.X.X..XX. .XXXXXXX.X.XX.X.X....X.... .X.....WXX..X.X.X..X...X.X ...XXXWWWWX...X...X..X.X.. XXX...XXXXXXXXXXXXXXXXXXX. .W..XE....................  , here is an example of an input"}, {"owner": {"reputation": 115, "user_id": 8024291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec67e3cfba606f304f901704a7f8f856?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios Dr", "link": "https://stackoverflow.com/users/8024291/stelios-dr"}, "edited": false, "score": 0, "creation_date": 1495029493, "post_id": 44026397, "comment_id": 75080303, "body": "the grid here is 26x6"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1495029508, "post_id": 44026397, "comment_id": 75080318, "body": "Actually, it sounds like the grader is the correct person to ask this question of."}, {"owner": {"reputation": 115, "user_id": 8024291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec67e3cfba606f304f901704a7f8f856?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios Dr", "link": "https://stackoverflow.com/users/8024291/stelios-dr"}, "edited": false, "score": 0, "creation_date": 1495029586, "post_id": 44026397, "comment_id": 75080377, "body": "no the delivery man can\u2019t traverse through the wormhole , just the pizza . Sorry , i forgot to mention it ."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495030747, "post_id": 44026397, "comment_id": 75081297, "body": "@SteliosDr for the <code>text2.txt</code> and other clarifications please edit your question, text in comments cannot be formatted, especially you cannot put line breaks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495031730, "post_id": 44026397, "comment_id": 75082110, "body": "Between <code>path</code>, <code>grid</code> and <code>previous</code>, you&#39;re allocating roughly 26 MB of memory.  That&#39;s a lot for a test program, but not in absolute terms on desktop or server machines (embedded systems can be more restricted in memory)."}, {"owner": {"reputation": 115, "user_id": 8024291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec67e3cfba606f304f901704a7f8f856?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios Dr", "link": "https://stackoverflow.com/users/8024291/stelios-dr"}, "edited": false, "score": 0, "creation_date": 1495032614, "post_id": 44026397, "comment_id": 75082824, "body": "we have 260mb of memory approximately . Grader says my program is roughly out of memory . What could it possibly be (sorry for my english , i am greek)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495037689, "post_id": 44026397, "comment_id": 75086550, "body": "@SteliosDr please edit your question and put the content of the <code>text2.txt</code> there."}, {"owner": {"reputation": 115, "user_id": 8024291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec67e3cfba606f304f901704a7f8f856?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios Dr", "link": "https://stackoverflow.com/users/8024291/stelios-dr"}, "edited": false, "score": 0, "creation_date": 1495038083, "post_id": 44026397, "comment_id": 75086771, "body": "I have more inputs , if that helps"}], "owner": {"reputation": 115, "user_id": 8024291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec67e3cfba606f304f901704a7f8f856?s=128&d=identicon&r=PG&f=1", "display_name": "Stelios Dr", "link": "https://stackoverflow.com/users/8024291/stelios-dr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495038029, "creation_date": 1495027940, "last_edit_date": 1495038029, "question_id": 44026397, "link": "https://stackoverflow.com/questions/44026397/out-of-memory-error-in-c-program-for-shortest-path-in-a-grid", "title": "Out of memory error in c program for shortest path in a grid", "body": "<p>I want to create a program that computes the path of minimum cost between 2 elements \u201cS\u201d and \u201cE\u201d,while carrying a pizza. We have a grid (2d array) that consists of <code>.</code>, <code>W</code>, <code>X</code>, <code>S</code> and <code>E</code>. \u201cX\u201d are walls-obstacles. If we move while carrying the load, every move (L,R,U,D) costs 2. However, we can leave the pizza in a wormhole \u201cW\u201d and take it again from another \u201cW\u201d in our grid, reducing the cost of our moves to 1. Leaving the pizza and taking it again costs 1.</p>\n\n<p>I have written a program, but it consumes a lot of memory and the grader doesn\u2019t accept it. I use a priority queue to store every next situation. The array prev is 3d, because we want to store, because <code>prev[i][j][0]</code> means we don\u2019t carry the pizza and <code>prev[i][j][1]</code>, means we carry it.\nHere is a simple input :</p>\n\n<pre><code>S..........XX...X.X.X..XX.\n.XXXXXXX.X.XX.X.X....X....\n.X.....WXX..X.X.X..X...X.X\n...XXXWWWWX...X...X..X.X..\nXXX...XXXXXXXXXXXXXXXXXXX.\n.W..XE....................\n</code></pre>\n\n<p>Can anyone help?</p>\n\n<pre><code>#define MAX_ROWS        1000\n#define MAX_COLUMNS     1000\n#define TRUE 1\n#define FALSE 0\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdbool.h&gt;\n\n\nchar path[1000000] ;\nchar grid[MAX_ROWS][MAX_COLUMNS];\nchar line[MAX_COLUMNS] ;\nint row_coordinate ;\nint column_coordinate ;\nbool loaded ;\n\ntypedef struct {\n     bool loaded ;\n     int row_coordinate ;\n     int column_coordinate ;\n}situation ;\n\ntypedef struct {\n     int row_c ;\n     int column_c ;\n     char move ;\n}previous ;\n\ntypedef struct coordinates{\n    int row ;\n    int column ;\n}position ;\n\ntypedef struct {\n    int priority ;\n    situation *data ;\n} node_t ;\ntypedef struct {\n    node_t *nodes ;\n    int len ;\n    int size ;\n} heap_t ;\n\nvoid push (heap_t *h , int priority , situation *data) {\n    if (h-&gt;len + 1 &gt;= h-&gt;size) {\n        h-&gt;size = h-&gt;size ? h-&gt;size * 2 : 4;\n        h-&gt;nodes = (node_t *)realloc(h-&gt;nodes, h-&gt;size * sizeof (node_t));\n    }\n    int i = h-&gt;len + 1;\n    int j = i / 2;\n    while (i &gt; 1 &amp;&amp; h-&gt;nodes[j].priority &gt; priority) {\n        h-&gt;nodes[i] = h-&gt;nodes[j];\n        i = j;\n        j = j / 2;\n    }\n    h-&gt;nodes[i].priority = priority;\n    h-&gt;nodes[i].data = data ;\n    h-&gt;len++;\n}\n\nsituation *pop (heap_t *h) {\n    int i, j, k;\n    if (!h-&gt;len) {\n        return NULL;\n    }\n    situation *data = h-&gt;nodes[1].data;\n    h-&gt;nodes[1] = h-&gt;nodes[h-&gt;len];\n    h-&gt;len--;\n    i = 1;\n    while (1) {\n        k = i;\n        j = 2 * i;\n        if (j &lt;= h-&gt;len &amp;&amp; h-&gt;nodes[j].priority &lt; h-&gt;nodes[k].priority) {\n            k = j;\n        }\n        if (j + 1 &lt;= h-&gt;len &amp;&amp; h-&gt;nodes[j + 1].priority &lt; h-&gt;nodes[k].priority) {\n            k = j + 1;\n        }\n        if (k == i) {\n            break;\n        }\n        h-&gt;nodes[i] = h-&gt;nodes[k];\n        i = k;\n    }\n    h-&gt;nodes[i] = h-&gt;nodes[h-&gt;len + 1];\n    return data;\n}\n\nint isEmpty(heap_t *ptr_heap){\n    if (ptr_heap == NULL){\n        return FALSE ;\n    }\n    if (ptr_heap-&gt;size == 0){\n        return TRUE ;\n    } else {\n        return FALSE ;\n    }\n}\n\nprevious prev[1000][1000][2] ;\n\nint main()\n{\n    FILE *FilePtr;\n    int columns=0,rows=0,priority,i,j,k,cost,min_cost,length_of_path,l,c;\n    position start ;\n    FilePtr = fopen(\"text2.txt\" , \"r\");\n    if(FilePtr == NULL)\n    {\n        printf(\"Can't open file\");\n        exit(EXIT_FAILURE);\n    }\n    while (fgets(line,sizeof line,FilePtr)!= NULL)\n    {\n        for (columns=0; columns&lt;(strlen(line)-1); ++columns){\n            grid[rows][columns]=line[columns] ;\n            //initialization of start\n            if (grid[rows][columns] == 'S'){\n                start.row=rows ;\n                start.column=columns ;\n            }\n        }\n        grid[rows][columns]='\\0' ;\n        ++rows ;\n    }\n    //until here cool !\n    //initialization of init(initial situation)\n    situation *init = &amp;(situation){ .loaded = true , .row_coordinate = start.row , .column_coordinate = start.column} ;\n\n    heap_t *h = (heap_t *)calloc(1,sizeof (heap_t)) ;\n    //push init in queue with priority = 0\n    priority = 0 ;\n    push(h,priority,init) ;\n    //initialize array of situations prev\n    //prev is a 3d array !\n\n    for (i=0; i&lt;rows; ++i){\n       for (j=0; j&lt;columns; ++j)\n          for (k=0; k &lt; 2; ++k)   {\n             prev[i][j][k].move = 'O' ;\n             prev[i][j][k].row_c = -1 ;\n             prev[i][j][k].column_c = -1 ;\n       }\n    }\n    //prev[init] = \"none\"\n    prev[0][0][1].move = 'n' ;\n    //initializations\n    min_cost = 0 ;\n    cost = 0 ;\n    i = 0 ;\n    j = 0 ;\n    k = 1 ;\n    c = 0 ;\n    l = 0 ;\n    length_of_path = 0 ;\n    //initialize the current situation\n    situation *current = &amp;(situation){ .loaded = true , .row_coordinate = 0 , .column_coordinate = 0 } ;\n    while(!isEmpty(h)){\n           current = pop(h) ;\n           i = current-&gt;row_coordinate ;\n           j = current-&gt;column_coordinate ;\n           if(current-&gt;loaded == true){k = 1 ;}\n           else {k = 0 ;}\n           //printf(\"%d\\n\",i) ;\n           //printf(\"%d\\n\",j) ;\n           //printf(\"%d\\n\",k) ;\n           //exit(1) ;\n           //until here cool\n           if ((grid[i][j] == 'E' )&amp;&amp;(k == 1)) {\n               min_cost = cost ;\n               printf(\"%d\\n\" , min_cost) ;\n               while (prev[i][j][k].move != 'n'){//as long as we are not in the initial situation\n                    printf(\"%d\\n\" , min_cost) ;\n                    //exit(1) ;\n                    path[length_of_path] = prev[i][j][k].move ;//we store the path in reverse order\n                    length_of_path++ ;\n                    if (prev[i][j][k].move == 'L'){j-- ; }\n                    else if (prev[i][j][k].move == 'R'){j++ ;}\n                    else if(prev[i][j][k].move == 'U'){i-- ;}\n                    else if(prev[i][j][k].move == 'D'){i++ ;}\n                    else continue ;//we are in warmhole no change of coordinates\n               }\n               //exit(1) ;\n               for (l=length_of_path; l&gt;=0; l--){//prints the solution/best path\n                  printf(\"%d\\n\" , min_cost) ;\n                  printf(\"%c\" , path[l]) ;\n               }\n               //exit(1) ;\n           }\n           else {\n               //m = \"L\"\n               j-- ;\n               //we find the next situation\n               if (j&gt;=0){\n                 situation *next = &amp;(situation){ .loaded = true , .row_coordinate = i , .column_coordinate = j} ;\n                 if (k == 0) {next-&gt;loaded = false ;}\n                 if (prev[i][j][k].row_c == -1){ // if next doesn't exist in prev\n                    //prev[next] = (i,j,m) ;\n                    prev[i][j][k].row_c = i ;\n                    prev[i][j][k].column_c = j ;\n                    prev[i][j][k].move = 'L' ;\n                    if (k == 0) {c = 1 ;}//lakis doesn't carry the pizza\n                    else {c = 2 ;}\n                 }\n                 cost = cost + c ;\n                 priority = cost + c ;\n                 push(h,priority,next) ;\n               }\n               j++ ; // go back to the begging\n               //m = \"R\"\n               j++ ;\n               //we find the next situation\n               if (j&lt;columns){\n                 situation *next = &amp;(situation){ .loaded = true , .row_coordinate = 0 , .column_coordinate = 0} ;\n                 if (k == 0) {next-&gt;loaded = false ;}\n                 if (prev[i][j][k].row_c == -1){\n                    //prev[next] = (i,j,m) ;\n                    prev[i][j][k].row_c = i ;\n                    prev[i][j][k].column_c = j ;\n                    prev[i][j][k].move = 'R' ;\n                    if (k == 0) {c = 1 ;}//lakis doesn't carry the pizza\n                    else {c = 2 ;}\n                 }\n                 cost = cost + c ;\n                 priority = cost + c ;\n                 push(h,priority,next) ;\n               }\n               j-- ;\n               //m = \"U\"\n               i-- ;\n               //we find the next situation\n               if (i&gt;=0){\n                 situation *next = &amp;(situation){ .loaded = true , .row_coordinate = i , .column_coordinate = j} ;\n                 if (k == 0) {next-&gt;loaded = false ;}\n                 if (prev[i][j][k].row_c == -1){\n                    //prev[next] = (i,j,m) ;\n                    prev[i][j][k].row_c = i ;\n                    prev[i][j][k].column_c = j ;\n                    prev[i][j][k].move = 'U' ;\n                    if (k == 0) {c = 1 ;}//lakis doesn't carry the pizza\n                    else {c = 2 ;}\n                 }\n                 cost = cost + c ;\n                 priority = cost + c ;\n                 push(h,priority,next) ;\n               }\n               i++ ;\n               //m = \"D\"\n               i++ ;\n               //we find the next situation\n               if (i&lt;rows){\n                 situation *next = &amp;(situation){ .loaded = true , .row_coordinate = i , .column_coordinate = j} ;\n                 if (k == 0) {next-&gt;loaded = false ;}\n                 if (prev[i][j][k].row_c == -1){\n                    //prev[next] = (i,j,m) ;\n                    prev[i][j][k].row_c = i ;\n                    prev[i][j][k].column_c = j ;\n                    prev[i][j][k].move = 'D' ;\n                    if (k == 0) {c = 1 ;}//lakis doesn't carry the pizza\n                    else {c = 2 ;}\n                 }\n                 cost = cost + c ;\n                 priority = cost ;\n                 push(h,priority,next) ;\n               }\n               i--;\n               // if m = \"W\"\n               c = 1 ; //lakis takes or leaves the pizza\n               cost = cost + c ;\n               priority = cost ;\n               situation *next = &amp;(situation){ .loaded = true , .row_coordinate = i , .column_coordinate = j} ;\n               if (k == 0) {next-&gt;loaded = false ;}\n               push(h,priority,next) ;\n           }\n    }\n    fclose(FilePtr) ;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "swift", "interop", "unsafe-pointers"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5611944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60541b4c97ab2a240fdb14ee809fd054?s=128&d=identicon&r=PG&f=1", "display_name": "n.eesemann", "link": "https://stackoverflow.com/users/5611944/n-eesemann"}, "edited": false, "score": 0, "creation_date": 1495090223, "post_id": 44027397, "comment_id": 75106952, "body": "Thanks Martin, this one solved the issue, (got no swift or c background, so I got misled by some sources which wrote to do it with &quot;withcstring&quot;.)"}], "tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1495186395, "last_edit_date": 1495542881, "creation_date": 1495030533, "answer_id": 44027397, "question_id": 44026115, "link": "https://stackoverflow.com/questions/44026115/string-withcstring-and-unsafemutablepointermutating-cstring-wrapped-into-a-fu/44027397#44027397", "title": "string.withCString and UnsafeMutablePointer(mutating: cstring) wrapped into a function", "body": "<p><code>withCString { ... }</code> creates a <em>temporary</em> representation of the Swift\nstring as null-terminated UTF-8 sequence, which is valid only inside\nthe closure. Passing the pointer to the outside of the closure is\nundefined behaviour.</p>\n\n<p>Also note that you cannot mutate the string using that pointer.\nPassing <code>UnsafeMutablePointer(mutating: $0)</code> only makes the compiler \nbelieve that the pointed-to memory is mutable, but actually doing\nso is undefined behaviour and might even crash.</p>\n\n<p>If <code>randomSign()</code> function does not modify the given\nstring then the best solution is to change its C declaration to \ntake a <em>constant</em> string:</p>\n\n<pre><code>unsigned long randomSign(const char *xml_string);\n</code></pre>\n\n<p>This would be imported to Swift as</p>\n\n<pre><code>func randomSign(_ xml_string: UnsafePointer&lt;Int8&gt;!) -&gt; UInt\n</code></pre>\n\n<p>Now you can pass  a Swift string directly to that function:</p>\n\n<pre><code>let str = \"some xml_tag\"\nlet result = randomSign(str)\n</code></pre>\n\n<p>The compiler automatically inserts the code for creating a\ntemporary UTF-8 representation and passing that to the function, compare <a href=\"https://stackoverflow.com/questions/27063569/string-value-to-unsafepointeruint8-function-parameter-behavior\">String value to UnsafePointer&lt;UInt8&gt; function parameter behavior</a>.</p>\n\n<p><strike>If you cannot change the C declaration then you still can call it\nas</p>\n\n<pre><code>let str = \"some xml_tag\"\nlet result = randomSign(UnsafeMutablePointer(mutating: str))\n</code></pre>\n\n<p>also without the need for your own helper function.</strike></p>\n\n<p><em>Update:</em> The last suggestion is not correct. The temporary string created by\nthe compiler is only during for the call of <code>UnsafeMutablePointer()</code>\nbut not necessarily still valid during the call of <code>randomSign()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5611944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60541b4c97ab2a240fdb14ee809fd054?s=128&d=identicon&r=PG&f=1", "display_name": "n.eesemann", "link": "https://stackoverflow.com/users/5611944/n-eesemann"}, "edited": false, "score": 0, "creation_date": 1495090348, "post_id": 44027401, "comment_id": 75107027, "body": "Thanks for the reference :)"}], "tags": [], "owner": {"reputation": 43976, "user_id": 6541007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2xMee.jpg?s=128&g=1", "display_name": "OOPer", "link": "https://stackoverflow.com/users/6541007/ooper"}, "is_accepted": false, "score": 0, "last_activity_date": 1495030547, "creation_date": 1495030547, "answer_id": 44027401, "question_id": 44026115, "link": "https://stackoverflow.com/questions/44026115/string-withcstring-and-unsafemutablepointermutating-cstring-wrapped-into-a-fu/44027401#44027401", "title": "string.withCString and UnsafeMutablePointer(mutating: cstring) wrapped into a function", "body": "<p>Check the <a href=\"https://developer.apple.com/reference/swift/string/1538904-withcstring\" rel=\"nofollow noreferrer\">reference of <code>withCString(_:)</code></a>.</p>\n\n<blockquote>\n  <h2>Discussion</h2>\n  \n  <p>The withCString(_:) method ensures that the sequence\u2019s lifetime\n  extends through the execution of body. The pointer argument to body is\n  only valid for the lifetime of the closure. Do not escape it from the\n  closure for later use.</p>\n</blockquote>\n\n<p>Your VERSION_2 code is trying to <em>escape it from the closure for later use</em>. It's not a valid usage of <code>withCString(_:)</code>.</p>\n\n<p>The region containing UTF-8 representation of the <code>String</code> is temporal and Swift runtime will release it at any time.</p>\n\n<p>You can write something like this:</p>\n\n<pre><code>func utf8Array(from string: String) -&gt; [Int8] {\n    return string.cString(using: .utf8)!\n}\n\nfunc randomSignWrapper_3(xml_tag_str: String) -&gt; UInt {\n    var charArray = utf8Array(from: xml_tag_str)\n    let result = randomSign(xml_string: &amp;charArray)\n    return result\n}\n</code></pre>\n\n<p>But I wonder if you need to define a function like <code>utf8Array(from:)</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 5611944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60541b4c97ab2a240fdb14ee809fd054?s=128&d=identicon&r=PG&f=1", "display_name": "n.eesemann", "link": "https://stackoverflow.com/users/5611944/n-eesemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1495186395, "creation_date": 1495027207, "last_edit_date": 1495035107, "question_id": 44026115, "link": "https://stackoverflow.com/questions/44026115/string-withcstring-and-unsafemutablepointermutating-cstring-wrapped-into-a-fu", "title": "string.withCString and UnsafeMutablePointer(mutating: cstring) wrapped into a function", "body": "<p>I have a problem with the String.withCString{} in combination with UnsafeMutablePointer(mutating: ...).</p>\n\n<p>Given: a C-Function like this </p>\n\n<pre><code>randomSign(xml_string: UnsafeMutablePointer&lt;Int8&gt;!) -&gt; Uint\n</code></pre>\n\n<p>Also given: a String like </p>\n\n<pre><code>str = \"some xml_tag\"\n</code></pre>\n\n<p>My working code is like this (VERSION_1)</p>\n\n<pre><code>func randomSignWrapper_1(xml_tag_str: String) -&gt; Uint {\n    let result = xml_str.withCString { s in return\n       randomSign(UnsafeMutablePointer(mutating: s))\n    } \n    return result\n}\n</code></pre>\n\n<p>But I want the withCString to be put into a separate function like this:</p>\n\n<pre><code>func testFunction(_ x: String) -&gt; UnsafeMutablePointer&lt;Int8&gt;{\n    return x.withCString{s in\n        return UnsafeMutablePointer(mutating: s)\n    }\n}\n</code></pre>\n\n<p>So that I can easily reuse it (VERSION_2) </p>\n\n<pre><code>func randomSignWrapper_2(xml_tag_str: String) -&gt; Uint {\n    let result = randomSign(testFunction(xml_tag_str))\n    return result\n} \n</code></pre>\n\n<p>But the problem is that VERSION_1 delivers the right return value while VERSION_2 is somehow not working properly, and telling me that the data is wrong.\nAnd I would like to know why it behaves like this?\nAnd how to solve it that I can use it the described way?</p>\n"}, {"tags": ["c", "arrays", "list-manipulation"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 2, "creation_date": 1495028480, "post_id": 44025978, "comment_id": 75079489, "body": "What stops you from looking into NumPy&#39;s source code?"}, {"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1495032216, "post_id": 44025978, "comment_id": 75082531, "body": "The fact that I did not know that it&#39;s opensource (and still don&#39;t)."}], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1495030039, "post_id": 44027097, "comment_id": 75080750, "body": "Yeah, this is simple iterative solution however there is no bound on the number of dimensions, to reshape it to 999 dimensions I&#39;d need exactly 999 for loops, doesn&#39;t sound very good."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 1, "creation_date": 1495030221, "post_id": 44027097, "comment_id": 75080901, "body": "@VahagnTumanyan the loop &quot;demonstrates&quot; that access through a <code>*int[2]</code> pointer works just as expected. There&#39;s really no &quot;reshaping&quot; happening, just aliasing through a pointer of different type."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "edited": false, "score": 0, "creation_date": 1495043846, "post_id": 44027097, "comment_id": 75090166, "body": "@VahagnTumanyan Even though 999 dimensions has two bottom elements, the overall size becomes (2^999)*sizeof(element). Are you kidding?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 3, "last_activity_date": 1495029730, "creation_date": 1495029730, "answer_id": 44027097, "question_id": 44025978, "link": "https://stackoverflow.com/questions/44025978/reshaping-an-array-from-1d-to-nd-in-c/44027097#44027097", "title": "Reshaping an array from 1D to ND in C", "body": "<p>A n-dimensional array in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> is nothing more than syntactic sugar for computing the offset inside a simple array, they look the same in memory (one contiguous block). Therefore, there's really no point in \"reshaping\" it, as this little sample demonstrates:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint data[] = {1,2,3,4};\n\nint main(void)\n{\n    int *i = data;\n\n    for (int n = 0; n &lt; 4; ++n)\n    {\n        printf(\"i[%d] = %d\\n\", n, i[n]);\n    }\n\n    int (*j)[2] = (void *)i;\n\n    for (int n1 = 0; n1 &lt; 2; ++n1)\n    {\n        for (int n2 = 0; n2 &lt; 2; ++n2)\n        {\n            printf(\"j[%d][%d] = %d\\n\", n1, n2, j[n1][n2]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<blockquote>\n  <p>i[0] = 1<br>\n  i[1] = 2<br>\n  i[2] = 3<br>\n  i[3] = 4<br>\n  j[0][0] = 1<br>\n  j[0][1] = 2<br>\n  j[1][0] = 3<br>\n  j[1][1] = 4</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 0, "last_activity_date": 1495029798, "creation_date": 1495029798, "answer_id": 44027125, "question_id": 44025978, "link": "https://stackoverflow.com/questions/44025978/reshaping-an-array-from-1d-to-nd-in-c/44027125#44027125", "title": "Reshaping an array from 1D to ND in C", "body": "<p>NumPy doesn't need an algorithm, because it stores data contiguously regardless of the shape.  The \"shape\" property is the only difference between the input and the output of <code>reshape()</code>.  The algorithms come into play when later accessing the array, such as when printing it.  Then you need to follow the shape to know how many elements go in each row or other dimension.</p>\n"}], "owner": {"reputation": 412, "user_id": 5128747, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1632020240373517/picture?type=large", "display_name": "Vahagn Tumanyan", "link": "https://stackoverflow.com/users/5128747/vahagn-tumanyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 44027097, "answer_count": 2, "score": 0, "last_activity_date": 1495029798, "creation_date": 1495026844, "last_edit_date": 1495027865, "question_id": 44025978, "link": "https://stackoverflow.com/questions/44025978/reshaping-an-array-from-1d-to-nd-in-c", "title": "Reshaping an array from 1D to ND in C", "body": "<p>I am having a lot of trouble trying to implement this on my own, so if anyone can point to, or describe an algorithm I'd be much obliged. </p>\n\n<p><strong>The problem statement</strong></p>\n\n<p>Given one dimensional flattened pointer <code>int* i</code> which would look something like this <code>{1,2,3,4}</code>, and given a list of dimensions in form of a list <code>{2,2}</code> reshape the 1D array to conform with specified dimensions. Overall after the procedure the array should look like <code>{{1,2},{3,4}}</code>. </p>\n\n<p>I am basically asking if anyone knows the algorithm that is used in numpy.reshape.</p>\n"}, {"tags": ["c", "file", "slice"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1495026603, "post_id": 44025791, "comment_id": 75077946, "body": "what did you try so far? If fields won&#39;t contain spaces, try <code>strtok()</code> (google for manpage)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495026801, "post_id": 44025791, "comment_id": 75078118, "body": "And your <b>specific</b> problem is? Where is your code? What it wrong with it? We are not a coding service."}, {"owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "edited": false, "score": 0, "creation_date": 1495026875, "post_id": 44025791, "comment_id": 75078180, "body": "I&#39;ve tried <code>lfind()</code> and <code>fseek()</code> Didn&#39;t really go well, and the file will contain space so..."}, {"owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495026913, "post_id": 44025791, "comment_id": 75078207, "body": "@Olaf I am not looking for a code, I am asking how slicing is done"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495027004, "post_id": 44025791, "comment_id": 75078272, "body": "@FelixPalmen strtok() shall not be used anymore. Explained why <a href=\"http://stackoverflow.com/questions/5999418/why-is-strtok-considered-unsafe\">here</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495027106, "post_id": 44025791, "comment_id": 75078367, "body": "@Badda: <code>strtok()</code> is perfectly fine in a single-threaded environment when called correctly."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495027288, "post_id": 44025791, "comment_id": 75078496, "body": "Yes but no. There are improved versions of the same function which will always work regardless of how you use it. Why would we keep advising the former, unperfect version ? Just an opinion though, I see what your point is."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1495027797, "post_id": 44025791, "comment_id": 75078930, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/236129/split-a-string-in-c\">Split a string in C++?</a>"}, {"owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1495027981, "post_id": 44025791, "comment_id": 75079080, "body": "@danieltakeshi you can use C coding for C++, but not the way around"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 1, "creation_date": 1495028350, "post_id": 44025791, "comment_id": 75079392, "body": "@Badda: Just beacuse a function is not thread-safe does not mean it is &quot;unperfect&quot;. A sports car is not good for cross-country, but it is the better choice for driving on streets than a Jeep (not those city-slicker SUVs)."}, {"owner": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "edited": false, "score": 0, "creation_date": 1495037150, "post_id": 44025791, "comment_id": 75086215, "body": "One question. In the file, is there always at least one space between each name and the next id? Or would there be no space between if a name uses all eight characters. (example: <code>... 123 JoeShort124 Peter   125 ...</code>). If so, <code>strtok()</code> would be useless."}, {"owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "reply_to_user": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "edited": false, "score": 0, "creation_date": 1495042750, "post_id": 44025791, "comment_id": 75089507, "body": "@SiggiSv they can be &quot;attached&quot;, so yes you make a valid point"}], "answers": [{"tags": [], "owner": {"reputation": 789, "user_id": 7868795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/471c6f01b994a5aadf85dc6cfec40fc4?s=128&d=identicon&r=PG", "display_name": "Ra&#39;Jiska", "link": "https://stackoverflow.com/users/7868795/rajiska"}, "is_accepted": false, "score": 0, "last_activity_date": 1495027611, "last_edit_date": 1495027611, "creation_date": 1495027300, "answer_id": 44026152, "question_id": 44025791, "link": "https://stackoverflow.com/questions/44025791/slicing-file-string/44026152#44026152", "title": "Slicing file string", "body": "<p>You may want to use the LibC <code>strtok</code> function. It allows you to split your string given a list of separators.</p>\n\n<p>Here is an example similar to your project:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint     main(int argc, char **argv)\n{\n  int   i;\n  char  *line;\n  char  *tok;\n\n  i = 0;\n  if (!(line = strdup(\"123 Hello 345 World 678 Foo 901 Bar\")))\n    return EXIT_FAILURE;\n  tok = strtok(line, \" \");\n  while (tok)\n    {\n      if ((i % 2) == 0)\n        printf(\"ID: \");\n      else\n        printf(\"Name: \");\n      puts(tok);\n      tok = strtok(NULL, \" \");\n      ++i;\n    }\n  free (line);\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>ID: 123\nName: Hello\nID: 345\nName: World\nID: 678\nName: Foo\nID: 901\nName: Bar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "is_accepted": true, "score": 1, "last_activity_date": 1495045636, "last_edit_date": 1495045636, "creation_date": 1495044688, "answer_id": 44032082, "question_id": 44025791, "link": "https://stackoverflow.com/questions/44025791/slicing-file-string/44032082#44032082", "title": "Slicing file string", "body": "<p>Since you're coming from Python, <code>strtok(char *str, const char *delim)</code>, which has been mentioned here, does a similar job as <code>string.split(s[, sep[, maxsplit]])</code> does in python (with some differences like: There is no default delimiter. It does not return a list of strings. It just returns the first splice and then you need to call it again with <code>str</code> set to <code>NULL</code>).</p>\n\n<p>But there is no need to use any function that search through the string for some separator since you know that you want to slice the file into strings that are each 12 char long (and then slice each of them into a string containing the first 3 char and a string containing the last 8 char, discarding the one char between them).</p>\n\n<p>For the first part, slicing the file into strings that are 12 char long, you have two options:</p>\n\n<ul>\n<li>You could use <code>fgets(tmp_str, 13, filename)</code> to read 12 char at once from the file (size is 13 because it reads in one less char than size because it then need one more to end the string with <code>'\\0'</code>).</li>\n<li>Or you could read all the file into a string. Then in a loop, use <code>strncpy(tmp_str, &amp;initial_s[i * 12], 12)</code> (assuming <code>i</code> is our counter, starting at <code>0</code> and the file was read into <code>initial_s</code>) to copy 12 chars, starting at position <code>i * 12</code> into tmp_str (and don't forget to terminate the string with <code>tmp_str[12] = '\\0'</code>.</li>\n</ul>\n\n<p>For the second part, you again have two options:</p>\n\n<ul>\n<li><p>You could again use <code>strncpy()</code>. This time to first copy 3 chars into <code>temp-&gt;id</code>, starting at the begging of <code>tmp_str</code>. And then to copy 8 chars into <code>temp-&gt;productName</code>, starting at position <code>4</code> (remember to terminate all your strings with '\\0'). If you do so, you could change your <code>struct</code> to have char arrays instead of pointers to chars:</p>\n\n<pre><code>typedef struct ProductTree {\n    char id[4];               //Product ID number. This is the key of the search tree.\n    char productName[9];      //Name of the product.\n    struct ProductTree *left, *right;\n} ProductTree;\n</code></pre></li>\n<li><p>Or you could be a bit \"clever\" for the second part. Have <code>temp-&gt;id</code> point to the beginning of <code>tmp_str</code> , have <code>temp-&gt;productName</code> point to the 5th char in <code>tmp_str</code> and change the space between them to <code>'\\0'</code> to terminate <code>temp-&gt;id</code>:</p>\n\n<pre><code>temp-&gt;id = tmp_str;\ntmp_str[3] = '\\0';\ntemp-&gt;productName = tmp_str[4];\n</code></pre></li>\n</ul>\n\n<p>Whichever options you chose, remember to  allocate memory for all your strings, check all input for errors and free both your strings and structs when done.</p>\n"}], "owner": {"reputation": 63, "user_id": 7872614, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92952ce2b05e96fea1f80166b58df9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Khateeb", "link": "https://stackoverflow.com/users/7872614/ahmad-khateeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 44032082, "answer_count": 2, "score": 0, "last_activity_date": 1495045636, "creation_date": 1495026396, "last_edit_date": 1495027344, "question_id": 44025791, "link": "https://stackoverflow.com/questions/44025791/slicing-file-string", "title": "Slicing file string", "body": "<p>I have a text file that holds ID's and names all in one line</p>\n\n<pre><code>314 name1   122 name3   884 name2\n</code></pre>\n\n<p>the ID is 3 digits (we will deal with it as <code>char</code>), then we have one space followed by the name which is 8 digits (spaces included), and then comes another person's ID/name and so on...</p>\n\n<p>so I open a the file, read it and want to \"slice\" it</p>\n\n<p>*the <code>struct</code> I am about to mention isn't important, just an example, can be found at the bottom</p>\n\n<p>Basically take the first 3 digits and put them in a struct under ID, then ignore the following space, and grab the 8 digits that come after and place them in the same struct under name and so on (can just remove the first 12 digits of the file every time), the problem is simply the slicing</p>\n\n<p>I came from Python where if I have a <code>string</code>, and only want to keep the first two digits I'd do something like <code>string = string[0-2]</code></p>\n\n<pre><code>//ProductTree is a struct \n\nchar initial_s[sizeof(initialStockFile)];\nProdudctTree* temp = NULL;\nfscanf(initialStockFile, \"%s\", initial_s);\n        temp = malloc(sizeof(ProductTree));\n        while( initial_s != '\\0' ){\n            temp-&gt;id = initial_s[0-9];\n            temp-&gt;productName = initial_s[10-20];\n            initial_s = initial_s+21;\n            temp = temp-&gt;right;\n        }\n        temp-&gt;right = NULL;\n        return temp;\n</code></pre>\n\n<p>This is what I have tried but clearly doesn't work</p>\n\n<p>The struct if anyone is curious</p>\n\n<pre><code>typedef struct ProductTree {\n    char* id;               //Product ID number. This is the key of the search tree.\n    char* productName;      //Name of the product.\n    struct ProductTree *left, *right;\n} ProductTree;\n</code></pre>\n"}, {"tags": ["c", "eclipse", "include-path", "implicit-declaration"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1495031124, "post_id": 44025479, "comment_id": 75081576, "body": "When working with Eclipse, it is perfectly normal to spend a a week or so per project chasing down all mysterious path and include errors."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495031349, "post_id": 44025479, "comment_id": 75081795, "body": "@Lundin Honestly this is so mysterious I think Eclipse does cause my problems. Is there any logical and reproductible way to fix those errors generally ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495032006, "post_id": 44025479, "comment_id": 75082340, "body": "Note <a href=\"http://stackoverflow.com/questions/597318\">What are the benefits of a relative path such as &quot;../include/header.h&quot; for a header?</a>  Generally, you&#39;re best off avoiding the <code>..</code> notation in the source files including a header."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1495032342, "post_id": 44025479, "comment_id": 75082627, "body": "Also, the header file you define should not include headers it does not need to compile.  There&#39;s nothing in the header that needs any of the types from &#39;the mighty trio&#39; \u2014 the three most commonly used standard headers, <code>&lt;stdio.h&gt;</code>, <code>&lt;stdlib.h&gt;</code>, <code>&lt;string.h&gt;</code> \u2014 so they do not need to be included in the header, and arguably should not be included in the header.  There&#39;s a phrase IWYU \u2014 Include What You Use \u2014 and a program to ensure that you obey that (produced by Google, originally).  Your header violates IWYU."}], "answers": [{"comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495025911, "post_id": 44025542, "comment_id": 75077389, "body": "Those includes are already in the header file, declaring them two times makes errors. Must I move them into main and have no includes in the header ??"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 2, "creation_date": 1495026248, "post_id": 44025542, "comment_id": 75077660, "body": "@Badda, you seem to have a serious misconception.  <i>Each translation unit</i> -- roughly one C source file and all headers directly or indirectly <code>#include</code>d by it -- should have a declaration of every function referenced therein.  For functions defined elsewhere, this is normally accomplished by including the appropriate header file.  As you have presented it, your <code>main.c</code> does not do this, but it needs to do.  Whether the same headers are included into other translation units is an altogether separate question."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1495026684, "post_id": 44025542, "comment_id": 75078007, "body": "@JohnBollinger I understand what you are saying. But including <code>#include &quot;..&#47;header&#47;fileProcessing.h&quot;</code> produces errors like <code>first defined here</code> and <code>multiple definition of</code>. Which, I think, means that the header is already included and that doing it twice is not possible. But may be I am misundersting even more than what I thought. I&#39;d be glad to understand. Do you think that adding this and the corresponding errors to my question is relevant ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 2, "creation_date": 1495028680, "post_id": 44025542, "comment_id": 75079658, "body": "@Badda, adding that <code>#include</code> directive to your <code>main.c</code> <i>should not</i> cause any error, and <i>does not</i> cause any error for me with the code you&#39;ve presented (and laid out as I&#39;ve inferred is required).  In fact, it nicely resolves all the compiler warnings.  If you observe a different result then you&#39;ve omitted something relevant from your question."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495030443, "post_id": 44025542, "comment_id": 75081069, "body": "&quot;I&#39;ll add the function&#39;s body if needed, but I have seen nowhere any clue telling that a function&#39;s body could cause an include error&quot; So you think it can ? If so, i&#39;ll delete this question and try to ask or more relevant and precise one."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495030858, "post_id": 44025542, "comment_id": 75081377, "body": "It&#39;s unclear to me what you&#39;re asking, @Badda.  Obviously, the body of your <code>main()</code> function is causing the compiler to issue warnings.  On the other hand, the body of <code>STLINKReadSytemCalls()</code> is irrelevant to those warnings.  Moreover, <code>#include</code>ing the <code>fileProcessing.h</code> header you&#39;ve presented into <code>main.c</code> has nothing to do with that (or any) function&#39;s body."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 3, "last_activity_date": 1495032032, "last_edit_date": 1495032032, "creation_date": 1495025813, "answer_id": 44025542, "question_id": 44025479, "link": "https://stackoverflow.com/questions/44025479/implicit-declaration-of-functions-regardless-of-header-include-and-ifndef/44025542#44025542", "title": "Implicit declaration of functions regardless of header include and ifndef", "body": "<p>You don't show that your <code>main.c</code> file has the two rather obvious</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"../header/fileProcessing.h\"\n</code></pre>\n\n<p>lines, is that on purpose? Otherwise this is the answer, I think.</p>\n"}, {"comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495032685, "post_id": 44027917, "comment_id": 75082883, "body": "I will post another question, thanks for helping me focusing on what seemed to be working and what did not. I think I might have misjudged the causes of my errors and by doing so, misleaded you all by giving you irrevelant information. I do apologize and may be this question needs to be flagged. Regarding the data I gave you, I consider that your answer deserved to be accepted, as it perfectly solves the problem I was describing."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1495031856, "creation_date": 1495031856, "answer_id": 44027917, "question_id": 44025479, "link": "https://stackoverflow.com/questions/44025479/implicit-declaration-of-functions-regardless-of-header-include-and-ifndef/44027917#44027917", "title": "Implicit declaration of functions regardless of header include and ifndef", "body": "<p>As you've presented it, your <code>main.c</code> contains calls to two functions that have no in-scope declaration: <code>STLINKReadSytemCalls()</code> and <code>printf()</code>.  That correlates with the warnings (not errors) emitted by the compiler, and it is the only thing about the code you've presented that could explain those warnings.</p>\n\n<p>At this point I emphasize that</p>\n\n<ol>\n<li><p>The problem is what I just described: the lack of in-scope function declarations at the point where these functions are called.  Your \"four problems [that] might cause these errors\" (only three actually presented) describe various specific avenues by which such problems sometimes arise; none of them is itself the problem.</p></li>\n<li><p>The compiler is emitting <em>warnings</em>, not errors.  That means it accepts the code, but it cannot be certain that it did the right thing with it.  In particular, it relies on the number and type of the arguments to guess the argument lists, and it guesses that the functions return <code>int</code>.  This is not safe, but if you get lucky then it might work, or at least seem to do.</p></li>\n</ol>\n\n<p>Given that the problem is lack of function declarations, the solution is, obviously, to ensure that all the needed declarations are provided, and that they are in scope where those functions are referenced.  For functions defined elsewhere than in the same C source, the usual solution is to <code>#include</code> a header file or files containing the needed declarations.  Supposing that the headers in question are written appropriately (the standard library's are, and the internal one you've presented is) that's all there is to it.</p>\n\n<p>The layout of your project is not entirely clear, but it looks like you could achieve that by putting</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"../header/fileProcessing.h\"\n</code></pre>\n\n<p>at the beginning of <code>main.c</code>, as indeed @unwind already suggested.  That change is enough to satisfy <em>my</em> compiler.</p>\n\n<p>You have suggested that doing that causes some other kind of problem with your original code.  If that's true, then it would constitute an altogether different question, and if you can't figure it out then you could consider posing it here as such.  There is no hint of such a problem in <em>this</em> question as posed, and as an altogether separate concern, it would be inappropriate to raise that here.</p>\n\n<hr>\n\n<p>As an aside, I add that I find it a bit odd (but not wrong) that your <code>fileProcessing.h</code> <code>#include</code>s the standard <code>stdio.h</code>, <code>stdlib.h</code>, and <code>string.h</code> headers even though it has no dependencies on any of them.  As a style rule, I strongly recommend that each source file, including header files, should <code>#include</code> all headers required for the features they use directly, but no others.  In support of that, all headers should furthermore have proper multiple-inclusion guards, as the header you present in fact does.</p>\n\n<p>Thus, I would rewrite <code>fileProcessing.h</code> like so:</p>\n\n<pre><code>#ifndef FILEPROCESSING_H_\n#define FILEPROCESSING_H_\n\nint STLINKReadSytemCalls(void);\n\n#endif /* FILEPROCESSING_H_ */\n</code></pre>\n\n<p>... and let other files handle <code>#include</code>ing any or all of the three aforementioned standard library headers as needed.</p>\n"}, {"comments": [{"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1553668957, "post_id": 55370649, "comment_id": 97464869, "body": "Use correct spelling, punctuation, and grammar to the best of your ability."}], "tags": [], "owner": {"reputation": 1, "user_id": 2518066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79131d64ef612eb9d2bb9fdc1dc4038?s=128&d=identicon&r=PG", "display_name": "user2518066", "link": "https://stackoverflow.com/users/2518066/user2518066"}, "is_accepted": false, "score": 0, "last_activity_date": 1553666132, "creation_date": 1553666132, "answer_id": 55370649, "question_id": 44025479, "link": "https://stackoverflow.com/questions/44025479/implicit-declaration-of-functions-regardless-of-header-include-and-ifndef/55370649#55370649", "title": "Implicit declaration of functions regardless of header include and ifndef", "body": "<p>Probably a reuse of FILEPROCESSING_H_ symboh. Can happen with .h copy-paste</p>\n"}], "owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7925, "favorite_count": 0, "accepted_answer_id": 44027917, "answer_count": 3, "score": 2, "last_activity_date": 1569359807, "creation_date": 1495025667, "last_edit_date": 1569359807, "question_id": 44025479, "link": "https://stackoverflow.com/questions/44025479/implicit-declaration-of-functions-regardless-of-header-include-and-ifndef", "title": "Implicit declaration of functions regardless of header include and ifndef", "body": "<p>I have the well-known errors :</p>\n\n<p><code>implicit declaration of function 'STLINKReadSytemCalls' [-Wimplicit-function-declaration]</code><br>\n<code>implicit declaration of function 'printf' [-Wimplicit-function-declaration]</code><br>\n<code>incompatible implicit declaration of built-in function 'printf'</code></p>\n\n<p>And Eclipse (Atollic TrueStudio more precisely) kindly added :</p>\n\n<p><code>include '&lt;stdio.h&gt;' or provide a declaration of 'printf'</code></p>\n\n<p>Reading the billions of post asking how to solve this problem on SO, it seems that three problems might cause these errors : </p>\n\n<ul>\n<li>Functions are defined after main;</li>\n<li>Required headers to use a function are included</li>\n<li><code>#ifndef</code>, <code>#define</code> and <code>#endif</code>do not correctly wrap the header files</li>\n</ul>\n\n<p>I have found a post in which someone seemed to have this error and said after fixing it that Eclipse was the problem. Can't find the topic though, but his solution didn't work for me. It was something like clicking on the function, <em>source</em> -> <em>add includes</em>.</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>int main(void) {\n\n    if (STLINKReadSytemCalls() == 1)\n        printf(\"Error in system calls.\\n\");\n    return 0;\n}\n</code></pre>\n\n<p><strong>fileProcessing.c</strong></p>\n\n<pre><code>#include \"../header/fileProcessing.h\"\n\nint STLINKReadSytemCalls(void) {\n\n    // mainly system calls\n}\n</code></pre>\n\n<p><strong>fileProcessing.h</strong></p>\n\n<pre><code>#ifndef FILEPROCESSING_H_\n#define FILEPROCESSING_H_\n\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint STLINKReadSytemCalls(void);\n\n#endif /* FILEPROCESSING_H_ */\n</code></pre>\n\n<p>The most confusing part is that the code actually works. I have the following output : </p>\n\n<pre><code>STM32 ST-LINK CLI v3.0.0.0\nSTM32 ST-LINK Command Line Interface\n\nNo ST-LINK detected\nUnable to connect to ST-LINK!\nError in system calls.\n</code></pre>\n\n<p>Everything seems to be fine, but compiler keeps yelling.\nI'll add the function's body if needed, but I have seen nowhere any clue telling that a function's body could cause an include error. I must be missing something so obvious that I'll self-facepalm like no one ever did when I'll see it; but I have already spent hours and my hope that this is obvious is getting thinner.</p>\n\n<p>Oh, and yesterday with the same include path and same directory build it worked perfectly fine. I really don't know what changed since. </p>\n"}, {"tags": ["c", "string", "runtime"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1495025615, "post_id": 44025412, "comment_id": 75077143, "body": "<code>999</code>...ehmmm.."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1495025675, "post_id": 44025412, "comment_id": 75077199, "body": "What is the error you&#39;re getting? And what line number is it happening on?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495026182, "post_id": 44025412, "comment_id": 75077610, "body": "&#39;name temp value space is 15&#39; why?   Whats&#39; wrong with [256]?  Were you an accountant in a previous life?  :)"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495026264, "post_id": 44025412, "comment_id": 75077671, "body": "I mean, wots the point of checking for 15, (14+NUL), chars AFTER you&#39;ve overflowed the temp buffer?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495026327, "post_id": 44025412, "comment_id": 75077714, "body": "...and int &#39;maxName = 15;&#39; is one too long, (NUL terminator)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6698583"}, "edited": false, "score": 0, "creation_date": 1495026473, "post_id": 44025412, "comment_id": 75077845, "body": "It checks if  it&#39;s past 15 so that you can re enter the characters, I made the 999 buffer 15 before but if there is an input over 15 characters it breaks my code"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1495032249, "post_id": 44025412, "comment_id": 75082561, "body": "According to <i><a href=\"https://msdn.microsoft.com/en-us/library/td1esda9.aspx\" rel=\"nofollow noreferrer\">this</a></i>, you have too few arguments to <code>strcpy_s</code>.  This code example does not compile for me.  Is this the code you are actually using?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6698583"}, "edited": false, "score": 0, "creation_date": 1495026670, "post_id": 44025859, "comment_id": 75077998, "body": "Yeah I tried to make the <code>scanf_s</code> buffer the same but any values entered over the buffer ruin the code."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1495027690, "post_id": 44025859, "comment_id": 75078838, "body": "@Robert - Yes, I saw your comment above also.  I think you are still missing the point about allowing room for NULL termination.  Without a NULL character appended to the end of a <code>char</code> array, all you have is an array of <code>char</code>, not a string.  See my edits in post above."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6698583"}, "edited": false, "score": 0, "creation_date": 1495028263, "post_id": 44025859, "comment_id": 75079327, "body": "Yeah, I posted that comment because there wasn&#39;t all that edit part sorry. I only realized that the string is set to NULL when I printed the length variable, so I fixed the code by checking for NULL, thanks for the help though"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1495033279, "last_edit_date": 1495542380, "creation_date": 1495026558, "answer_id": 44025859, "question_id": 44025412, "link": "https://stackoverflow.com/questions/44025412/runtime-error-2-s/44025859#44025859", "title": "Runtime error #2 - S", "body": "<p>At least two problems are apparent. The first should prevent a successful compile, the next is worse.</p>\n\n<p>1) There are too few arguments to <a href=\"https://msdn.microsoft.com/en-us/library/td1esda9.aspx\" rel=\"nofollow noreferrer\">strcpy_s</a>, where its prototype is shown to be:</p>\n\n<pre><code>errno_t strcpy_s(char *strDest, size_t numElements, const char *strSource);\n</code></pre>\n\n<p>Your statement... </p>\n\n<pre><code>strcpy_s(players[totalplayers].name, name);\n</code></pre>\n\n<p>...appears to be missing the middle argument, <code>size_t numberOfElements,</code>  Because this is not an optional argument in <code>strcpy_s</code>, the code you show should not have compiled.  </p>\n\n<p>2) Your code is invoking <em><a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a></em>.  You have configured your <a href=\"http://code.wikia.com/wiki/Scanf_s\" rel=\"nofollow noreferrer\">scanf_s</a> function to read in more than what your variable <code>name</code> can hold.    Beyond the point in your code this occurs, there is no telling how your code will behave.  It may work one time, or a hundred times, then not work the next.</p>\n\n<pre><code>char name[15];\n....\nint maxName = 15;\n\n\nscanf_s(\"%s\", name, 999);//name can contain only 14 characters and a NULL.\n                    ^^^  //you are allowing scanf_s to read more than that.\n</code></pre>\n\n<p>Set the 3rd argument of <code>scanf_s</code> to match size-1 of the char array you are writing to:</p>\n\n<pre><code>int maxName = 14;//and for same reason, change maxName \nscanf_s(\"%s\", name, 14);//room for NULL\n/// or a width specifier can be used\nscanf_s(\"%14s\", name, 15);\n/// BEST of all, use a portable version: scanf with width specifier\nscanf((\"%14s\", name); //provided similar protection.\n                      //note: scanf has not be deprecated by anyone\n                      //except Microsoft\n</code></pre>\n\n<p>Either way, if <code>scanf_s</code> is to protect against buffer overflow, you must set the arguments correctly.  </p>\n\n<p>Regarding your comment: <em>I made the 999 buffer 15 before but if there is an input over 15 characters it breaks my code</em>.</p>\n\n<p>You need to allow room for NULL terminator.  ( <em><a href=\"https://stackoverflow.com/questions/12203339/c-string-definition-in-c-c\">see this C string definition</a></em> )<br>\nIf you fill your buffer, sized to contain only 15 <code>char</code> with 15 <code>char</code> of input, the array does not have room for the NULL terminator.  The <code>char</code> is array is therefore not a C string, and will not be guaranteed to behave as a string.  (UB).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6698583"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495033279, "creation_date": 1495025485, "last_edit_date": 1495026582, "question_id": 44025412, "link": "https://stackoverflow.com/questions/44025412/runtime-error-2-s", "title": "Runtime error #2 - S", "body": "<p><a href=\"https://i.stack.imgur.com/EzpMO.png\" rel=\"nofollow noreferrer\">EDIT: This is the error I am getting.</a>\nI am getting this error after the program works perfectly, and I don't know why. I am trying to add in strings into a temp variable which then adds them to a struct array, the name temp value space is 15 and then checks if the name is over 15 characters and asks the user to re enter the string if true. It may be because of the buffer in entering to name var but I don't know.</p>\n\n<pre><code>typedef struct {\nchar name[15];\nint score;\nint riskF;\n} player_info;\n\nint main()\n{\n    player_info players[20];\n    char name[15];\n    int gameN = 0;\n    int riskF = 0;\n    int accScore = 0;\n    int totalplayers = 0;\n    int count = 1;\n    int length = 0;\n    int maxName = 15;\n\n    printf_s(\"Enter player %d: \", count);\n    scanf_s(\"%s\", name, 999);\n\n    length = strlen(name);\n    if (length &lt; maxName)\n    {\n        strcpy_s(players[totalplayers].name, name);\n        totalplayers++;\n        count++;\n    }\n    else\n    {\n        printf_s(\"\\nName too big; please enter a name within 15 characters!\\n\\n\");\n    }\n    length = 0;\n\n\n\n    printf_s(\"done!\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "shfileoperation"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1495025787, "post_id": 44025382, "comment_id": 75077292, "body": "be good if you how minimum paste stack trace with <b>symbols</b>"}, {"owner": {"reputation": 5977, "user_id": 592835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rrxAO.jpg?s=128&g=1", "display_name": "Anton Semenov", "link": "https://stackoverflow.com/users/592835/anton-semenov"}, "edited": false, "score": 0, "creation_date": 1495026980, "post_id": 44025382, "comment_id": 75078247, "body": "please provide full code of the thread"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 3, "creation_date": 1495027926, "post_id": 44025382, "comment_id": 75079037, "body": "Defect in your code. We can&#39;t see it."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1495028168, "post_id": 44025382, "comment_id": 75079243, "body": "faster of all this is heap corruption, makes by your code. but without how minimum stack trace impossible say exactly"}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1495031461, "post_id": 44025382, "comment_id": 75081882, "body": "@Olaf about the c++ tag, do you see here something that&#39;s not compliant with c++? The &quot;goto&quot; is fine here because it exits the function cleanly and cleans up any necessary resources."}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495031610, "post_id": 44025382, "comment_id": 75081999, "body": "@RbMm I will provide you with a full stack trace when it will happen to me again, but I don&#39;t think that there&#39;s a heap corruption because I tried putting a &quot;HeapValidate&quot; check before the main&#39;s exit, and saw that there were no corruptions"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1495032028, "post_id": 44025382, "comment_id": 75082367, "body": "@cydan - very hard say exactly what happens here without debug crash yourself. the stack trace with installed pdb symbols (without this trace almost useless) this is mandatory minimum. the <code>SHFileOperationW</code> is unbelievable heavy api - i look on win10 and inside this function was made - 76473 internal functions calls. yes! 76k and not instructions but functions !!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1495032236, "post_id": 44025382, "comment_id": 75082551, "body": "@cydan: Theat is not the point. As no <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is give, it could very well make a difference. Identtical syntax does not imply identical semantics! Just don&#39;t spam tags! If you compile as C++ use the C++ tag, if C, use the C tag! They are different languages."}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495038181, "post_id": 44025382, "comment_id": 75086837, "body": "@RbMm I added the stack trace.. Couldn&#39;t get symbols for one of the DLLs though"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495038802, "post_id": 44025382, "comment_id": 75087197, "body": "@cydan - from stack visible that error in <code>DragExt64.dll</code> which how i understand is not native windows dll (not exist in my system). so this error in plugin extension"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1495038947, "post_id": 44025382, "comment_id": 75087277, "body": "and really - you have no <b>pdb symbols</b> ! i view only <b>exports</b> ! but have <b>pdb symbols</b> installed is critical for any system level debugging. you can not have symbols for <code>DragExt64.dll</code> but for <code>shell32.dll</code>, <code>windows.storage.dll</code> and another windows dlls - <b>must</b> have"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1495040792, "post_id": 44025382, "comment_id": 75088362, "body": "&quot;It is done in multiple threads&quot;.  That&#39;s not good, a custom shell extension like the one used by WinSCP is not very likely to handle that correctly.  You can arbitrarily uninstall it, but this is just as likely to go wrong on the user&#39;s machine.  Do keep in mind that deleting files on more than one thread is never useful.  It is actually <i>slower</i>, disks don&#39;t like to be jerked around by more than one thread."}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "edited": false, "score": 0, "creation_date": 1495040947, "post_id": 44030638, "comment_id": 75088452, "body": "Thanks! It seems that DragExt64.dll belongs to WinSCP.. I will try to disable it via the registry key and see if I can reproduce it"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 3, "last_activity_date": 1495040298, "last_edit_date": 1495040298, "creation_date": 1495039626, "answer_id": 44030638, "question_id": 44025382, "link": "https://stackoverflow.com/questions/44025382/shfileoperation-randomly-raises-exceptions-when-deleting-files/44030638#44030638", "title": "SHFileOperation: randomly raises exceptions when deleting files", "body": "<p>from stack trace (even without <em>pdb symbols</em> - with it will be much more better ) visible that exception not inside windows shell itself but in third party product - <code>dragext64.dll</code> (this is not native windows image) wich is implement <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/cc144063(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Copy Hook Handler</a> - i advise uninstall this or disable via registry key</p>\n\n<pre><code>HKEY_CLASSES_ROOT\n   Directory\n      shellex\n         CopyHookHandlers\n            MyCopyHandler\n               (Default) = {MyCopyHandler CLSID GUID}\n</code></pre>\n\n<p>and test after this. think exceptions must go away. </p>\n\n<hr>\n\n<p>also look like some another shell extensions have bugs here - search in google <code>SHELL32_CallFileCopyHooks</code>. for example <a href=\"https://gitlab.com/tortoisegit/tortoisegit/issues/2901\" rel=\"nofollow noreferrer\">bug</a> <code>TortoiseGit.dll</code> - note here in stack trace <code>shell32.dll!SHELL32_CallFileCopyHooks()</code></p>\n\n<p>so all this bugs inside implementation of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb776048(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><em>ICopyHook::CopyCallback</em></a> method</p>\n"}], "owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 1, "accepted_answer_id": 44030638, "answer_count": 1, "score": 5, "last_activity_date": 1495040298, "creation_date": 1495025401, "last_edit_date": 1495038103, "question_id": 44025382, "link": "https://stackoverflow.com/questions/44025382/shfileoperation-randomly-raises-exceptions-when-deleting-files", "title": "SHFileOperation: randomly raises exceptions when deleting files", "body": "<p>I am using SHFileOperation() to delete directories from a specific path. It is done in multiple threads and the directory that's deleted is always different. </p>\n\n<p>From time to time, it throws exceptions:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x00007FF8AF5D9D2A (ntdll.dll) in del.exe:\n  0xC0000008: An invalid handle was specified</p>\n</blockquote>\n\n<p>and this one:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x00007FF8ACC90A36 (shell32.dll) in del.exe:\n  0xC0000005: Access violation reading location 0x0000000000000001.</p>\n</blockquote>\n\n<p>modules:</p>\n\n<pre><code>shell32.dll 00007FF8ACBD0000-00007FF8AE0D8000 \nntdll.dll   00007FF8AF530000-00007FF8AF701000\n</code></pre>\n\n<p>This is the code:</p>\n\n<pre><code>SHFILEOPSTRUCTW tFileOptions = { 0 };\n\n/* Initialize the file options structure for the deletion process */\ntFileOptions.pFrom = pwstrPath;\ntFileOptions.wFunc = FO_DELETE;\ntFileOptions.fFlags = FOF_NOCONFIRMATION | FOF_SILENT | FOF_NOERRORUI;\n\n/* Execute the deletions with the Shell operation */\niResult = SHFileOperationW(&amp;tFileOptions);\nif (0 != iResult)\n{\n    printf(\"WTF\\n\");\n    goto lbl_cleanup;\n}\n\nSHChangeNotify(SHCNE_RMDIR, SHCNF_PATHW, pwstrPath, NULL);\n</code></pre>\n\n<p>The pwstrPath has a double null terminator at the end.</p>\n\n<p>What can be the reason for these exceptions?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Stack trace:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NlEg6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NlEg6.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "turbo-c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1495022479, "post_id": 44024039, "comment_id": 75074803, "body": "Why are you using outdated software that is even older than you?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495022792, "post_id": 44024039, "comment_id": 75075019, "body": "^^^^^^^^^^ ageist :)"}, {"owner": {"reputation": 931, "user_id": 6830757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxb9.jpg?s=128&g=1", "display_name": "Shivam Sharma", "link": "https://stackoverflow.com/users/6830757/shivam-sharma"}, "edited": false, "score": 0, "creation_date": 1495074260, "post_id": 44024039, "comment_id": 75101648, "body": "@Bhumesh  you should to accept one answer, if you found that answer helpful for you..so that community knows the right solution that worked for this problem.. :)"}, {"owner": {"reputation": 23, "user_id": 7940052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1778050775769690/picture?type=large", "display_name": "Bhumesh Polaswar", "link": "https://stackoverflow.com/users/7940052/bhumesh-polaswar"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495078233, "post_id": 44024039, "comment_id": 75102569, "body": "@MichaelWalz  which is the best software for c programming?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495086199, "post_id": 44024039, "comment_id": 75104870, "body": "@BhumeshPolaswar anything but TurboC. Visual Studio community edition is quite good."}, {"owner": {"reputation": 4194, "user_id": 8164333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lCAZ3.jpg?s=128&g=1", "display_name": "iamsankalp89", "link": "https://stackoverflow.com/users/8164333/iamsankalp89"}, "edited": false, "score": 0, "creation_date": 1504333275, "post_id": 44024039, "comment_id": 78982416, "body": "put a getch() function above return statement"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1607542054, "post_id": 44024039, "comment_id": 115308557, "body": "Hit Alt-F5 to switch the the user screen."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 5178972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f236786234cb178924030ae9662380a9?s=128&d=identicon&r=PG&f=1", "display_name": "user5178972", "link": "https://stackoverflow.com/users/5178972/user5178972"}, "is_accepted": false, "score": 1, "last_activity_date": 1495022243, "creation_date": 1495022243, "answer_id": 44024204, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program/44024204#44024204", "title": "No output when running program", "body": "<p>I cannot comment, so I cannot ask for clarification and therefore I shall post an answer.</p>\n\n<p>I think the problem is that the console window closes after the program execution ends. Try this:</p>\n\n<pre><code>#inlcude &lt;stdio.h&gt;\n\nint main(int argc, char** argv)\n{\n   printf(\"Hello world\\n\");\n   getchar();\n   return 0;\n}\n</code></pre>\n\n<p>The getchar() function waits for your input and stops the execution until you hit enter key.</p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 3807678, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100000301923853/picture?type=large", "display_name": "codelyzer", "link": "https://stackoverflow.com/users/3807678/codelyzer"}, "is_accepted": false, "score": 1, "last_activity_date": 1504343841, "last_edit_date": 1504343841, "creation_date": 1495022780, "answer_id": 44024396, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program/44024396#44024396", "title": "No output when running program", "body": "<p>Turbo C by default closes the screen immediately so you have to hold the screen by calling a function which is defined inside <code>conio.h</code> header file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nint main()\n{\n  printf(\"Hello world\\n\");\n  getch();\n  return 0;\n} \n</code></pre>\n\n<p>The <code>getch()</code> method waits for your input before closing the screen. </p>\n\n<p>Though I would not recommend using Turbo C as it is outdated. You should start using something like gcc with Codeblocks or some other IDE. </p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495025494, "post_id": 44025239, "comment_id": 75077057, "body": "Your comments about <code>getch</code> and <code>getchar</code> are incorrect."}, {"owner": {"reputation": 931, "user_id": 6830757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxb9.jpg?s=128&g=1", "display_name": "Shivam Sharma", "link": "https://stackoverflow.com/users/6830757/shivam-sharma"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495025651, "post_id": 44025239, "comment_id": 75077176, "body": "@WeatherVane  why? both functions expects a character from console. then what is incorrect? can you tell me?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495025816, "post_id": 44025239, "comment_id": 75077321, "body": "The comments need to be reversed. <code>getch</code> does not behave as the comment says, <code>getchar</code> does as you say for <code>getch</code>."}, {"owner": {"reputation": 931, "user_id": 6830757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxb9.jpg?s=128&g=1", "display_name": "Shivam Sharma", "link": "https://stackoverflow.com/users/6830757/shivam-sharma"}, "reply_to_user": {"reputation": 23, "user_id": 7940052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1778050775769690/picture?type=large", "display_name": "Bhumesh Polaswar", "link": "https://stackoverflow.com/users/7940052/bhumesh-polaswar"}, "edited": false, "score": 0, "creation_date": 1495078927, "post_id": 44025239, "comment_id": 75102728, "body": "@BhumeshPolaswar mesion not buddy, you should to accept this answer by clicking tick mark button which is located in left side of this answer..  :) :)"}, {"owner": {"reputation": 23, "user_id": 7940052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1778050775769690/picture?type=large", "display_name": "Bhumesh Polaswar", "link": "https://stackoverflow.com/users/7940052/bhumesh-polaswar"}, "edited": false, "score": 0, "creation_date": 1495083150, "post_id": 44025239, "comment_id": 75103806, "body": "But which is the best software for c programming?"}, {"owner": {"reputation": 931, "user_id": 6830757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxb9.jpg?s=128&g=1", "display_name": "Shivam Sharma", "link": "https://stackoverflow.com/users/6830757/shivam-sharma"}, "reply_to_user": {"reputation": 23, "user_id": 7940052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1778050775769690/picture?type=large", "display_name": "Bhumesh Polaswar", "link": "https://stackoverflow.com/users/7940052/bhumesh-polaswar"}, "edited": false, "score": 0, "creation_date": 1495097325, "post_id": 44025239, "comment_id": 75111576, "body": "@BhumeshPolaswar   GCC compiler is the most used and recommended compiler. For a beginner, I will suggest to start with Code::Blocks or Microsoft visual studio . Code Blocks is a very light weight IDE which is quite good to start with programming.  :)"}, {"owner": {"reputation": 23, "user_id": 7940052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1778050775769690/picture?type=large", "display_name": "Bhumesh Polaswar", "link": "https://stackoverflow.com/users/7940052/bhumesh-polaswar"}, "edited": false, "score": 0, "creation_date": 1495097672, "post_id": 44025239, "comment_id": 75111831, "body": "@ShivamSharma which setup should I choose I find this on code block website codeblocks-16.01-setup.exe  codeblocks-16.01-setup-nonadmin.exe  codeblocks-16.01-nosetup.zip  codeblocks-16.01mingw-setup.exe  codeblocks-16.01mingw-nosetup.zip  codeblocks-16.01mingw_fortran-setup.ex"}], "tags": [], "owner": {"reputation": 931, "user_id": 6830757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxb9.jpg?s=128&g=1", "display_name": "Shivam Sharma", "link": "https://stackoverflow.com/users/6830757/shivam-sharma"}, "is_accepted": true, "score": 5, "last_activity_date": 1504330677, "last_edit_date": 1592644375, "creation_date": 1495025035, "answer_id": 44025239, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program/44025239#44025239", "title": "No output when running program", "body": "<p>let me solve your problem,buddy.</p>\n<p><strong>Problem:</strong>  program doesn't display the output.</p>\n<p><strong>Reason:</strong></p>\n<p>Program execution takes milleseconds to display the output &amp; turbo c++ compilor has not control over it. So, it's the responsibility of coder to control the execution to display the output.</p>\n<p><strong>Solutions:</strong></p>\n<p><strong>1</strong>.using  <code>getch();             //it is predefined function of &lt;conio.h&gt; </code></p>\n<p><strong>2</strong>.using <code>getchar();           //it is predefined function of &lt;stdio.h&gt;</code></p>\n<p>Using <code>getch();</code></p>\n<p>Code:</p>\n<pre><code> #include &lt;stdio.h&gt;\n    #include &lt;conio.h&gt;\n    \n    int main()\n    {\n      printf(&quot;Hello world\\n&quot;);\n      getch();                  //it can be used to hold program execution,it wait until the user enters a character.\n      return 0;\n    } \n</code></pre>\n<p>USING <code>getchar();</code></p>\n<p>Code:</p>\n<pre><code>    #include &lt;stdio.h&gt;\n    int main()\n    {\n      printf(&quot;Hello world\\n&quot;);\n      getchar();                  //getchar() means get a character from user,if user press any key + enter then getchar() executes.\n      return 0;\n    } \n\n\n   \n \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 478, "user_id": 7989544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RCpdI.jpg?s=128&g=1", "display_name": "Biswajit Roy", "link": "https://stackoverflow.com/users/7989544/biswajit-roy"}, "is_accepted": false, "score": 1, "last_activity_date": 1495045011, "creation_date": 1495045011, "answer_id": 44032167, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program/44032167#44032167", "title": "No output when running program", "body": "<p>In order to see your output,you must hold your console window. Here are some methods. Include the conio.h file to your program and add the function, getch() at the end of program above return statement. If u r working on windows, you may use the command system (\"PAUSE\"); at the end of program although this is a dos command and works in windows only but u can use it. However, portability will be a concern here. </p>\n"}, {"tags": [], "owner": {"reputation": 4194, "user_id": 8164333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lCAZ3.jpg?s=128&g=1", "display_name": "iamsankalp89", "link": "https://stackoverflow.com/users/8164333/iamsankalp89"}, "is_accepted": false, "score": 0, "last_activity_date": 1504331944, "creation_date": 1504331944, "answer_id": 46010930, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program/46010930#46010930", "title": "No output when running program", "body": "<p>Simply use <code>getch()</code> which is  predefined function of <code>&lt;conio.h&gt;</code>, then you will get the output screen</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\nint main()\n{\n    printf(\"Hello World\\n\");\n    getch();\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 13494067, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5a61e0d43ba69762107a0697593fb036?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/13494067/ken"}, "edited": false, "score": 1, "creation_date": 1588885502, "post_id": 61667697, "comment_id": 109081423, "body": "Correction of typo-&gt;  &quot;with errors&quot;,  -&gt; &quot;it compiled with NO Errors and ran perfectly."}], "tags": [], "owner": {"reputation": 1, "user_id": 13494067, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5a61e0d43ba69762107a0697593fb036?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/13494067/ken"}, "is_accepted": false, "score": 0, "last_activity_date": 1588885376, "creation_date": 1588885376, "answer_id": 61667697, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program/61667697#61667697", "title": "No output when running program", "body": "<p>I encountered the exact same problem using Dev-C compiler, and I think I found the problem he had. This may serve well for someone at a later . The solution that I realized, was that it wasn't the program, nor the compiler. It was a simple over-sight on my behalf. I had previously been working on a Win32 Gui program. That's what sounds like to be the problem here. I think the problem is the hash tag  \"-mwindows\" may be turned on in the compiler options settings. That tag tells the compiler not to make the unwanted console window when building the GUI program. I rewrote the code, and save to a file and compiled on the command-line.... gcc -o main main.c   ... it compile with errors and ran perfect. Unselected the tag in compiler options and re-created a new project as a console project. Then all was back to normal. So just make sure whether the default GUI settings are turned off, or do not add -mwindows at the end of the command line syntax, and the Linker will know to create the console. The console window is not the same window as the Windows Cmd Prompt window. They look the same but are not, I think the program console window is basically a double-buffered Device Context that allows you to see your program in windows.</p>\n"}], "owner": {"reputation": 23, "user_id": 7940052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1778050775769690/picture?type=large", "display_name": "Bhumesh Polaswar", "link": "https://stackoverflow.com/users/7940052/bhumesh-polaswar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15734, "favorite_count": 0, "accepted_answer_id": 44025239, "answer_count": 6, "score": 2, "last_activity_date": 1607540514, "creation_date": 1495021800, "last_edit_date": 1495026734, "question_id": 44024039, "link": "https://stackoverflow.com/questions/44024039/no-output-when-running-program", "title": "No output when running program", "body": "<p>I had a issue with running a c-program. I am using Turbo C++ compiler but when I write a code and compile there is no problem with compiling. But when I run program is doesn't display any output.</p>\n\n<p>This is the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    printf(\"Hello World\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1495022298, "post_id": 44024013, "comment_id": 75074681, "body": "<code>nb += str[i] != &#39;\\n&#39;;</code> - what, dare I ask, is <i>that</i> supposed to be doing ? Since <code>str[i] != &#39;\\n&#39;</code> is the condition of your while-loop (which you <i>inside of</i>), it must be true, so was your intent to simply be <code>nb += 1;</code> ? A <i>debugger</i> certainly seems appropriate for further investigation."}, {"owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1495022578, "post_id": 44024013, "comment_id": 75074871, "body": "eeww that&#39;s a mistake, this is not what I wrote in my code I don&#39;t know how I managed to write this here. I edit."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1495022940, "post_id": 44024013, "comment_id": 75075117, "body": "Your example is missing all of your check functions. I&#39;d start by checking the return value of fseek, and verifying that the output of get_nb is what you are expecting."}, {"owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "edited": false, "score": 0, "creation_date": 1495023405, "post_id": 44024013, "comment_id": 75075466, "body": "Since the checking functions does only that: checking, and always return 0, I thought that it was of no use to show them, and worst, it would be some floody code. I had put a few more lines in my code to check the return value of fseek, but I did it after the fail happened. Of course, when it doesn&#39;t fail, the return value is 0. Yet I can&#39;t make the bug happen again... But it happened once! I&#39;m really confused about this"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1495024860, "post_id": 44024013, "comment_id": 75076523, "body": "<code>return</code> is not a function. <a href=\"http://stackoverflow.com/q/4762662/995714\">Don&#39;t use it with parentheses like that</a>"}, {"owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "edited": false, "score": 0, "creation_date": 1495031311, "post_id": 44024013, "comment_id": 75081751, "body": "it should be the same with other statements then? like <code>if</code>, <code>while</code>?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1495035064, "post_id": 44024013, "comment_id": 75084721, "body": "<code>if</code> and <code>while</code> are control blocks which have different syntax. <code>return</code> is just a single statement"}], "owner": {"reputation": 571, "user_id": 7450836, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/69c0cbc84d95b5201e2f5999106119ca?s=128&d=identicon&r=PG&f=1", "display_name": "nounoursnoir", "link": "https://stackoverflow.com/users/7450836/nounoursnoir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495031596, "creation_date": 1495021733, "last_edit_date": 1495031596, "question_id": 44024013, "link": "https://stackoverflow.com/questions/44024013/movement-in-a-file-eventually-fails", "title": "Movement in a file eventually fails", "body": "<p>A function in my program, <code>choice_move_to_position</code>, enables to move the virtual cursor in an open file to a specific position. For example if I type 56, the cursor will be put at the position 56 of the file (which means the 57th character). I tested it and found no problem, it seemed to work perfectly. However, I used it to debug another function, but <code>choice_move_to_position</code> failed. After it failed once, I tried to use it again and it worked.</p>\n\n<p>Here is my function, and two other functions that may cause the problem, yet I can't get what's wrong.</p>\n\n<pre><code>int     get_nb(char *str) // This function converts a string into an integer\n                          // In this program, get_nb will always receive a string\n                          // corresponding to a real number: the input is formatted.\n{\n\n    int     i = 0;\n    int     nb = 0;\n\n    if (str[0] == '-')\n        i++;\n    while (str[i] != '\\n')\n    {\n        nb *= 10;\n        nb += str[i] - 48;\n        i++;\n    }\n    if (str[0] == '-')\n        return -nb\n    return nb;\n\n}\n\nvoid    get_new_buffer(char *str, int max_size) // Resets the buffer and the string\n                                                // in which the buffer will be stored,\n                                                // then get an input\n{\n    char    c;\n    int     i = 0;\n\n    // If we have a buffer overflow, the function resets the buffer\n    if (str[max_size - 2] != '\\n' &amp;&amp; str[max_size - 2] != '\\0')\n        while ((c = getchar()) != '\\n' &amp;&amp; c != EOF);\n    // The following resets the string in which will be stored the buffer\n    while (str[i])\n    {\n        str[i] = '\\0';\n        i++;\n    }\n    // The buffer and the string are clean, we can call fgets\n    fgets(str, max_size, stdin);\n}\n\nvoid    choice_move_to_position(FILE *file)\n{\n    char    choice[12] = {'\\0'};\n\n    printf(\"Select the position to get.\\n\");\n    get_new_buffer(choice, 12);\n    // The following loop checks 3 things:\n    //     the input must be an integer (positive or negative)\n    // AND the input must not be larger than 11 characters or smaller than 2 characters (including the ending newline)\n    // AND the input must correspond to a valid position\n    while (check_int_buffer(choice, 1) != 0 ||\n           check_size_buffer(choice, 12, 2, \"\", \"\") != 0 ||\n           check_position(file, ftell(file), choice) != 0)\n    {\n        printf(\"Please select a valid integer.\\n\");\n        get_new_buffer(choice, 12);\n    }\n    fseek(file, get_nb(choice), SEEK_SET); // Go to the selected position\n    printf(\"New position is: %ld.\\n\", ftell(file));\n}\n</code></pre>\n\n<p>I wanted to go to the position 10 (11th character) in a file that contains 11 characters. The output was the following:</p>\n\n<pre><code> - What do you want to do ? (help) // this is a printf\nmove to position                   // this is a user input\n - Select the position to get      // this is a printf\n10                                 // this is a user input\n - New position is: 0              // this is a printf using the function ftell\n</code></pre>\n\n<p>Please note that there is no error message, which means that the input was correctly formatted.</p>\n\n<p>I checked everything, tested it alot and I still can't get any answer. I would like to know if the bug I had have something to do with my program, or if it could be material. I once had a program that had like 95% chance of working and eventually, randomly, it didn't. It was due to a bad management of the memory I used (no protection). In this program it seems to me that I have protected every bit of code that needed to be protected. Please share your thoughts about this. Is it possible that the problem is material, or does my function have some flaws?</p>\n"}, {"tags": ["c", "linux", "io-redirection", "dup"], "comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495021289, "post_id": 44023742, "comment_id": 75073979, "body": "You must dup the initial file descriptors before your dup2, otherwise dup2 closes them and there is no way to recover them."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495021583, "post_id": 44023742, "comment_id": 75074179, "body": "Something like: <code>old_out=dup(STDOUT_FILENO); old_err=dup(STDERR_FILENO);</code> to take a copy, then when done: <code>dup2(old_out,STDOUT_FILENO); dup2(old_err,STDERR_FILENO);</code>  yes?"}], "answers": [{"comments": [{"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "edited": false, "score": 0, "creation_date": 1495021627, "post_id": 44023950, "comment_id": 75074214, "body": "Guess you answered my comment while I was typing it, thanks!"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "edited": false, "score": 0, "creation_date": 1495021701, "post_id": 44023950, "comment_id": 75074267, "body": "I was :). Of course it would be better if whatever is in the middle was able to accept a file descriptor to write onto, eliminating the need to redirect, but when working with third party code you sadly just have to make do."}, {"owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "edited": false, "score": 0, "creation_date": 1495021903, "post_id": 44023950, "comment_id": 75074393, "body": "Yeah, there&#39;s way too much code in the middle to replace all the print statements with something else."}], "tags": [], "owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "is_accepted": true, "score": 4, "last_activity_date": 1495021539, "creation_date": 1495021539, "answer_id": 44023950, "question_id": 44023742, "link": "https://stackoverflow.com/questions/44023742/redirect-stdout-stderr-using-dup2-then-resinstate-later/44023950#44023950", "title": "Redirect stdout/stderr using dup2, then resinstate later", "body": "<p>You must dup the initial file descriptors before your dup2, otherwise dup2 closes them and there is no way to recover them. </p>\n\n<pre><code>int stdout_copy = dup(STDOUT_FILENO);\ndup2(nf, STDOUT_FILENO);\n\n/* do something with stdout */\n\ndup2(stdout_copy, STDOUT_FILENO);\nclose(stdout_copy);\n</code></pre>\n\n<p>Throw in error handling, add <code>fflush</code> calls to ensure you don't leave data unwritten in stdlib buffers and you should be good.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14423840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a22ddca53b3c999728742d01f42c628a?s=128&d=identicon&r=PG", "display_name": "Nibal", "link": "https://stackoverflow.com/users/14423840/nibal"}, "is_accepted": false, "score": 0, "last_activity_date": 1602472548, "last_edit_date": 1602472548, "creation_date": 1602299062, "answer_id": 64289560, "question_id": 44023742, "link": "https://stackoverflow.com/questions/44023742/redirect-stdout-stderr-using-dup2-then-resinstate-later/64289560#64289560", "title": "Redirect stdout/stderr using dup2, then resinstate later", "body": "<p>Linux man pages are clear that dup2 doesn't close the <code>oldfd</code>. Don't forget to also close <code>nf</code>.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4665, "favorite_count": 0, "accepted_answer_id": 44023950, "answer_count": 2, "score": 3, "last_activity_date": 1602472548, "creation_date": 1495020968, "question_id": 44023742, "link": "https://stackoverflow.com/questions/44023742/redirect-stdout-stderr-using-dup2-then-resinstate-later", "title": "Redirect stdout/stderr using dup2, then resinstate later", "body": "<p><strong>Background:</strong> We have an embedded linux system running Busybox (limited resources), we have a process running which normally spits out lots of info on the console (via stdout / stderr) but we'd like to <em>temporarily</em> redirect it to syslog (using syslogd / logger) on command - WITHOUT restarting the process or rebooting.</p>\n\n<p>Using the code found <a href=\"https://stackoverflow.com/questions/14505079/redirect-stdout-stderr-to-syslog\">here</a> works nicely, until we try to stop/close the logger fd at which point writes to stdout/stderr fail and everything breaks. Example below:</p>\n\n<pre><code>int main()\n{\n\n    // Got command to direct all output to syslog:\n\n    FILE *fl;\n    fl = popen(\"logger\",\"w\");\n    if(fl == NULL)\n        return 1;\n    fprintf(fl,\"logger test new\"); // This goes to syslogd\n    int nf;\n    nf = fileno(fl);\n    dup2(nf,STDOUT_FILENO);\n    dup2(nf,STDERR_FILENO);\n    fprintf(stdout,\"Written in stdout\\n\");\n    fprintf(stderr,\"Written in stderr\\n\");\n\n    // ...some time later when we've logged enough things:\n\n    pclose(fl);\n    fprintf(stdout,\"This will fail\\n\");\n    fprintf(stderr,\"Catch fire and die\\n\");\n}\n</code></pre>\n\n<p>So the question is, (how)can we restore the original state once we're done with the logging?</p>\n\n<p>Having RTFM on <code>dup()</code> and <code>dup2()</code> I'm not clear on how exactly we can achieve this, if it's possible to \"reopen\" perhaps <code>freopen()</code> stdout/stderr, but as a last resort it would be acceptable to perhaps point <code>nf</code> to <code>/dev/null/</code> so things at least don't crash.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "edited": false, "score": 0, "creation_date": 1495020680, "post_id": 44023546, "comment_id": 75073528, "body": "Also maybe a duplicate of <a href=\"http://stackoverflow.com/questions/13284208/how-is-an-array-aligned-in-c-compared-to-a-type-contained\" title=\"how is an array aligned in c compared to a type contained\">stackoverflow.com/questions/13284208/&hellip;</a> ?"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "edited": false, "score": 0, "creation_date": 1495021084, "post_id": 44023546, "comment_id": 75073830, "body": "@AurelB&#237;l&#253; See note"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1495021093, "post_id": 44023546, "comment_id": 75073836, "body": "usably this kind stuff standard do not defined by standard to let compiler to what is right for given platform. Also there are compiler setting which can change this behavior, so code should not assume how things are aligned."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1495021408, "post_id": 44023546, "comment_id": 75074079, "body": "Array elements are always sizeof T apart. Sizeof T may be larger than the sum of the components of T."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495021497, "post_id": 44023546, "comment_id": 75074137, "body": "It is not clear what you are after. What is your actual problem?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1495021523, "post_id": 44023546, "comment_id": 75074147, "body": "If <code>alignment &gt; sizeof(T)</code> then of yes some elements will not be aligned as arrays must be contiguous.  Do note that over aligned types are implementation supported and are not portable."}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1495021597, "post_id": 44023546, "comment_id": 75074190, "body": "@stark irreverent"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495021662, "post_id": 44023546, "comment_id": 75074237, "body": "@Olaf Specifically, I need an array of elements, where each element is aligned to a cache boundary"}, {"owner": {"reputation": 20213, "user_id": 147845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e225ff5beb684088f5c9131d3979a18?s=128&d=identicon&r=PG", "display_name": "You", "link": "https://stackoverflow.com/users/147845/you"}, "edited": false, "score": 0, "creation_date": 1495021692, "post_id": 44023546, "comment_id": 75074261, "body": "@Zed: how is that &quot;irrelevant&quot;?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1495021757, "post_id": 44023546, "comment_id": 75074298, "body": "I would hate to be accused of blasphemy."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495021838, "post_id": 44023546, "comment_id": 75074357, "body": "That&#39;s not guaranteed. As I suspected you have an XY problem. If you need a specific alignment, you should enforce it. You only care about cacheline alignment for the processing block; you most likely <b>do not want</b> ever element to be aligned to a cacheline, unless it is not a fundamental type, of course. But before all this: profile your code; often the cache is not the problem."}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1495021887, "post_id": 44023546, "comment_id": 75074382, "body": "@stark This has nothing to do with the components of T (assuming, of course, that <i>x</i> is larger then any alignment requirement of any component of <code>T</code>, recursively)"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1495021979, "post_id": 44023546, "comment_id": 75074446, "body": "@Olaf This is a cache issue where I have thread-specific data on the same cache line. Thank you for your response"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495022332, "post_id": 44023546, "comment_id": 75074701, "body": "<code>...that I explicitly specify as x-aligned</code> Exactly how do you do that?"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495023108, "post_id": 44023546, "comment_id": 75075232, "body": "@4386427 <a href=\"http://en.cppreference.com/w/cpp/language/alignas\" rel=\"nofollow noreferrer\">alignas</a>, or a host of older, compiler-specific directives (ex. _declspec(align(X)) on MSVC)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495023241, "post_id": 44023546, "comment_id": 75075333, "body": "@Zed - and you end up with <code>sizeof(T)</code> being <b>less</b> than the alignment (aka <i>X</i>) ?"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495084049, "post_id": 44023546, "comment_id": 75104081, "body": "@4386427 Thats essentially what the question is about. Say you want <code>T</code> aligned on a 64 or 128 byte cache line boundary - does the alignment specifier change the size of T?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495085243, "post_id": 44023546, "comment_id": 75104522, "body": "@zed - I&#39;m sure it will. In other words, you can&#39;t get <code>sizeof(T)</code> being less than the alignment."}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "edited": false, "score": 0, "creation_date": 1495083877, "post_id": 44023969, "comment_id": 75104020, "body": "Thank you for your response. The statement &quot;If type T is x-aligned, every object of type T is x-aligned, including any array elements&quot; is what I&#39;d like documentation for, as this means, as I phrased in the question, extended alignment can change the size of a structure"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "edited": false, "score": 0, "creation_date": 1495084403, "post_id": 44023969, "comment_id": 75104232, "body": "I should rephrase the whole question, really. It was badly formed."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "edited": false, "score": 0, "creation_date": 1495085976, "post_id": 44023969, "comment_id": 75104794, "body": "&quot;is what I&#39;d like documentation for&quot;.I have a hard time imagining what alignment of types would otherwise mean. &quot;extended alignment can change the size of a structure&quot; Change in comparison to what? There is no same-but-unaligned type."}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "edited": false, "score": 0, "creation_date": 1495104788, "post_id": 44023969, "comment_id": 75116768, "body": "To your first question, I was looking for a source from the standard, ex (<a href=\"http://stackoverflow.com/a/4638295/7226419\">stackoverflow.com/a/4638295/7226419</a>)"}, {"owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "edited": false, "score": 0, "creation_date": 1495104925, "post_id": 44023969, "comment_id": 75116874, "body": "To your second question, your answer shows how a structure with the exact same members can different sizes based on the addition of <code>alignas(16)</code>. Again, badly worded, but the <i>change</i> is from <code>struct T {...}</code> to <code>struct alignas(x) T {...}</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "edited": false, "score": 0, "creation_date": 1495106660, "post_id": 44023969, "comment_id": 75118027, "body": "&quot;Exact same members&quot; doesn&#39;t mean &quot;same type&quot; or &quot;same size&quot; or  anything like that. There&#39;s not even a guarantee in the standard that given <code>struct A{}; struct B{};</code> sizes of A and B will be equal."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 9, "last_activity_date": 1495021595, "creation_date": 1495021595, "answer_id": 44023969, "question_id": 44023546, "link": "https://stackoverflow.com/questions/44023546/c-alignment-and-arrays/44023969#44023969", "title": "C++ alignment and arrays", "body": "<p>If type <code>T</code> is x-aligned, every object of type <code>T</code> is x-aligned, including any array elements. In particular, this means <code>x &gt; sizeof(T)</code> cannot possibly hold.</p>\n\n<p>A quick test with a couple of modern compilers confirms:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct alignas(16) overaligned {};\nstruct unaligned {};\n\ntemplate &lt;class T&gt; void sizes()\n{\n    T m, marr[2];\n    std::cout &lt;&lt; sizeof(m) &lt;&lt; \" \" &lt;&lt; sizeof(marr) &lt;&lt; std::endl;\n}\n\nint main ()\n{\n    sizes&lt;unaligned&gt;();\n    sizes&lt;overaligned&gt;();\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 2\n16 32\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 7226419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43785b98bf5c6ab7a1a87fe33779d74c?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/7226419/kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1106, "favorite_count": 0, "accepted_answer_id": 44023969, "answer_count": 1, "score": 0, "last_activity_date": 1495084803, "creation_date": 1495020436, "last_edit_date": 1495542880, "question_id": 44023546, "link": "https://stackoverflow.com/questions/44023546/c-alignment-and-arrays", "title": "C++ alignment and arrays", "body": "<ul>\n<li>I have some type <code>T</code> that I explicitly specify as <em>x</em>-aligned</li>\n<li><em>x</em> > <code>sizeof(T)</code></li>\n<li><em>x</em> > any implementation fundamental alignment</li>\n<li>(ex: <em>x</em> is page or cache aligned)</li>\n</ul>\n\n<p>Suppose I now have: <code>T arr[y]</code>, where <code>arr</code> is <em>x</em>-aligned (either by being allocated on the stack, or in data, or by an <em>x</em>-aligned heap allocation)</p>\n\n<p>Then at least some of <code>arr[1],...,arr[y-1]</code> are not <em>x</em>-aligned.</p>\n\n<p>Correct? (In fact, it <em>must</em> be correct if <code>sizeof(T)</code> does not change with extended alignment specification)</p>\n\n<p>Note1: This is <em>not</em> the same question as <a href=\"https://stackoverflow.com/questions/13284208/how-is-an-array-aligned-in-c-compared-to-a-type-contained\">How is an array aligned in C++ compared to a type contained?</a>. This question asks about the alignment of the array itself, not of the individual elements inside.</p>\n\n<p>Note2: This question: <a href=\"https://stackoverflow.com/questions/38844505/does-alignas-affect-the-value-of-sizeof\">Does alignas affect the value of sizeof?</a> is essentially what I'm asking - but for extended-alignment.</p>\n\n<p>Note3: <a href=\"https://stackoverflow.com/a/4638295/7226419\">https://stackoverflow.com/a/4638295/7226419</a> Is an authoritative answer to the question (that <code>sizeof(T)</code> includes any padding necessary to satisfy alignment requirements for having all <code>T</code>'s in an array of <code>T</code>'s properly aligned.</p>\n"}, {"tags": ["c", "printf", "buffer"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1495019749, "post_id": 44023228, "comment_id": 75072839, "body": "&quot;Then I add two and divide 3 to find the number of digits in octal representation&quot;  Eh... what? Why? Do you want the number to be printed with any base or with octal base specifically, or what? Please clarify."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1495019910, "post_id": 44023228, "comment_id": 75072958, "body": "There is a similar question on Math SE:  <a href=\"https://math.stackexchange.com/questions/3987/how-to-calculate-the-number-of-decimal-digits-for-a-binary-number\" title=\"how to calculate the number of decimal digits for a binary number\">math.stackexchange.com/questions/3987/&hellip;</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1495020010, "post_id": 44023228, "comment_id": 75073043, "body": "@KlasLindb&#228;ck No that&#39;s not a duplicate because we can&#39;t tell how the question here even makes sense. &quot;char buf[11];&quot; ... &quot;This works great if we know that unsigned int is at most 33 bits wide&quot; means that binary notation isn&#39;t desired here."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 750, "user_id": 6876037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acf7e5bb30e124f2597567bfd9aab1?s=128&d=identicon&r=PG&f=1", "display_name": "anonymoose", "link": "https://stackoverflow.com/users/6876037/anonymoose"}, "edited": false, "score": 0, "creation_date": 1495020027, "post_id": 44023228, "comment_id": 75073056, "body": "@anonymoose (N+2)/3+1 = (N+5)/3"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 750, "user_id": 6876037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acf7e5bb30e124f2597567bfd9aab1?s=128&d=identicon&r=PG&f=1", "display_name": "anonymoose", "link": "https://stackoverflow.com/users/6876037/anonymoose"}, "edited": false, "score": 0, "creation_date": 1495020110, "post_id": 44023228, "comment_id": 75073117, "body": "@anonymoose happens... :) try writing it down with a pen and paper...."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495020427, "post_id": 44023228, "comment_id": 75073358, "body": "@Lundin Exactly what is it you don&#39;t think makes sense with the question? My comment about 33bits means that <code>x</code> would be at most <code>8589934591</code> which means that the <code>sprintf</code> would need to print no more than <code>10</code> digits and one terminating NUL."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1495020558, "post_id": 44023228, "comment_id": 75073440, "body": "@skyking Where does the octal come from? You just drop that out of the blue. <code>%u</code> will give decimal representation, period. If you want octal, you would use <code>%o</code>. If you want any base, you would use some entirely different kind of code."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 1, "creation_date": 1495020651, "post_id": 44023228, "comment_id": 75073504, "body": "Unless I am mistaken, n binary digits require ceil(n*ln(2)/ln(10)) \u2248 ceil(n * 0.301) decimal digits (not counting the terminating NUL character)."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495021712, "post_id": 44023228, "comment_id": 75074273, "body": "@Lundin Octal representation of a number uses no fewer digits than a decimal representation. Consequently ensuring that the buffer is large enough to hold the octal representation will make it enough to hold the decimal representation of the number. In the above case I want decimal representation of <code>x</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495021883, "post_id": 44023228, "comment_id": 75074380, "body": "@skyking <b>Why do you want support for octal representation</b>? In a buffer that supposed to hold the result of <code>sprintf(buf, &quot;%u&quot;, x);</code>. This is just nonsense."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1495022149, "post_id": 44023228, "comment_id": 75074558, "body": "@Lundin I haven&#39;t said I want to support octal representation. I want <code>buf</code> to be large enough to be guaranteed that <code>sprintf</code> won&#39;t overflow. The reason for octal representation in the reasoning is that it will produce an upper bound for the number of characters required for the decimal representation.  The question is if somebody have a better solution that doesn&#39;t reserve about 10% more memory than actually required."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1495022173, "post_id": 44023228, "comment_id": 75074580, "body": "&#39;char buf[256];`. By the time this is an actual problem you&#39;ll be dead and it&#39;s somebody elses problem. Alternatively. Extrapolate how often we double the number of bits in integers, aim for the buffer running out some time just before your retirement and you have a nice retirement insurance."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495022486, "post_id": 44023228, "comment_id": 75074809, "body": "10% unnecessary memory is 1 byte. May I suggest something like <code>#if UINT_MAX &lt;= ... </code> etc? Then you can move on to something worthwhile."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1495023334, "post_id": 44023228, "comment_id": 75075411, "body": "What @Art says.  Why are you worrying about this?   If you have a bug shortage, I have plenty going spare;)   Unless you are running on some RAM-constrained embedded system, just go with 256, or 512, or whatever that is guaranteed much too big.  Move on the the next problem."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495024110, "post_id": 44023228, "comment_id": 75075983, "body": "@Lundin The question made sense to me. The question is: &quot;How many decimal digits are needed to represent a binary unsigned number with N bits?&quot; The linked question seems to address that."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1495024478, "post_id": 44023228, "comment_id": 75076250, "body": "@KlasLindb&#228;ck the question is &#39;Is there a better way to size a buffer for printing integers?&#39;.  The answer is &#39;sure, make it so large that it doesn&#39;t matter what the format is&#39;."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495025438, "post_id": 44023228, "comment_id": 75077005, "body": "@ThingyWotsit I was perhaps a bit unclear what I meant by &quot;better&quot;. In this case smaller is better so just picking a buffer size as you and Art suggested is not considered better in this case."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1495028267, "post_id": 44023228, "comment_id": 75079329, "body": "Your question here, your time thinking about it, this discussion, etc. has already used more CPU power and bytes than any shrinkage of a buffer would ever save. Especially considering that the buffer size will most likely be rounded up to 16 or even 32 to keep proper stack alignment."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1495035684, "post_id": 44023228, "comment_id": 75085159, "body": "@art I can see buffer size optimization real in 2 cases: arrays/structures that need to accommodate a string containing an <code>unsigned</code> as there  may be many instances of the object, Embedded applications where memory needs are sometimes <i>very</i> tight.  Yet for a single integer, of some type, to text, <code>char s[CHAR_BIT*sizeof(integer)+2]</code> will handle every real platform, base and sign-ness I can reasonable think off."}], "answers": [{"comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1495025446, "post_id": 44024876, "comment_id": 75077010, "body": "Not that it really matters, but 16/53 \u2248 0.30188 is an even better approximation with smaller numerator/denominator (obtained using continued fractions :)"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1495025825, "post_id": 44024876, "comment_id": 75077327, "body": "Indeed, added a note. Either way, magic numbers like this would need to be duly commented."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1495026185, "post_id": 44024876, "comment_id": 75077612, "body": "Yes, with my last update to the question there&#39;s a possibility that the expression overflows. While a smaller factor mitigates the possibility the expression is not immune to that, but I think that can be accomplished by ensuring the expression will have large enough type (by using factors of carefully chosen types)."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1495026864, "post_id": 44024876, "comment_id": 75078169, "body": "@skyking&gt; Using a compiler on a 32-bit system, the macro I made will not overflow unless you have 7million-bit integers on your target platform. I assume by the time this happens you should have upgraded to a 64-bit compiler and be good for 30-quadrillon-bit architectures."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1495027018, "post_id": 44024876, "comment_id": 75078286, "body": "I&#39;d prefer <code>#define DECIMAL_DIGITS(x) ((CHAR_BIT * sizeof (x) * 28) &#47; 93 + 2)</code>. 28/93 \u2248 0.301075, which is a slightly better approximation for (while still being greater than) log(2)/log(10); the <code>+2</code> part includes both rounding (+1) and possible sign, just because it is so easy to accidentally forget to include in the computation. The buffer would then be <code>char buffer[DECIMAL_DIGITS(x) + 1];</code>, where the +1 is for the terminating nul byte."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1495027221, "post_id": 44024876, "comment_id": 75078450, "body": "@NominalAnimal&gt; yeah, Martin R also suggested using continued fractions. You may pick any fraction you like as long as it&#39;s greater than than the actual value. I chose to left out the sign because OP used <code>%u</code>, which implies unsignedness. For a signed value I&#39;d add 1 to the result but substract 1 from bit number."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495027235, "post_id": 44024876, "comment_id": 75078458, "body": "There is nothing in the C language development that indicates that <code>int</code> will ever become larger than 4 bytes. Should 128 bit computers get invented, they would probably rather come up with a <code>long long long</code>... Or more sanely, an <code>uint128_t</code>. So all of these theories are completely useless, for now. Instead, focus on support for computers that exist in the real world."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1495027428, "post_id": 44024876, "comment_id": 75078601, "body": "@Lundin&gt; Macro does not work with only int, it works with any unsigned numeral type. Should there be a <code>long long long long int</code>, it would get the size right as well. And right now in real world, there are at least uint8_t, uint16_t, uint32_t, uint64_t and __uint128_t, and the macro gets all of those right."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495027551, "post_id": 44024876, "comment_id": 75078707, "body": "@spectras In which case you can as well do <code>sizeof(x)&#47;2 * 5</code>, to cover all known computers in the real world."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495027661, "post_id": 44024876, "comment_id": 75078798, "body": "@Lundin: The macro works with any integer type <code>x</code> and any variable <code>x</code> of any integer type, not just <code>int</code>. A careless programmer might change the type to some <code>hugeint_t</code>. I like the macro, because it is <b>safe</b>, and should get evaluated at compile time anyway (at least with GCC and optimizations enabled). Note that I also prefer as descriptive name for the macro as possible."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1495027815, "post_id": 44024876, "comment_id": 75078949, "body": "@NominalAnimal If some careless programmer changes the types to something completely bananas, they won&#39;t get much in the way of sane output from the buffer designed to hold an decimal integer in string format, now would they? This is actually the reason why the macro is <i>unsafe</i> - it isn&#39;t idiot-proof."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495028043, "post_id": 44024876, "comment_id": 75079134, "body": "@Lundin: It depends. Buffer overrun problems are the most typical ones I see in the wild. It is easy to notice that the printf conversion pattern is incorrect, and even an idiot probably notices to fix that.  In my case, I like the macro a lot, because it gives new programmers a pause: <i>&quot;Why does this code use a macro in the buffer size declaration?&quot;</i>. The macro name is an important clue there. Now, if they after that realization still often create buffer overrun bugs, it&#39;s on them: at least I tried to help them learn. This is the logic I apply for these types of cases."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1495028164, "post_id": 44024876, "comment_id": 75079238, "body": "@Lundin&gt; basically you&#39;re just suggesting the <b>exact same approach</b> except you approximated <code>8 * ln(2) &#47; ln(10)</code> to <code>5 &#47; 2 = 2.5</code> instead of <code>8 * 302&#47;1000 = 2.416</code> (or <code>8 * 28 &#47; 93 \u2248 2.4086</code> for NominalAnimal&#39;s version) , I don&#39;t really see your point or how that makes it any safer. It does break it on systems that have non-8-bit chars though, such as C54x DSPs."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495029083, "post_id": 44024876, "comment_id": 75079962, "body": "@spectras People who try to write C code portable to various obsolete Texas DSPs deserve all the bugs they can get. I doubt anyone ever wrote C code for those anyhow, since DSP programmers tend to be fixated with assembler. Why do you need a string handling program to be portable to obsolete DSPs?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1528240230, "post_id": 44024876, "comment_id": 88429292, "body": "Concern about naming. &quot;Size&quot; tends to refer to the size of the needed buffer and &quot;length&quot; to the length as returned by <code>strlen()</code>.  To that end, I recommend using <code>MAX_DECIMAL_LENGTH(x) ((size_t)(CHAR_BIT * ...</code> and <code>MAX_DECIMAL_SIZE(x) (MAX_DECIMAL_LENGTH(x) + 1)</code>"}], "tags": [], "owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "is_accepted": true, "score": 1, "last_activity_date": 1495029927, "last_edit_date": 1495535491, "creation_date": 1495024037, "answer_id": 44024876, "question_id": 44023228, "link": "https://stackoverflow.com/questions/44023228/is-there-a-better-way-to-size-a-buffer-for-printing-integers/44024876#44024876", "title": "Is there a better way to size a buffer for printing integers?", "body": "<p>Compiling different relevant comments, most notably:</p>\n\n<ul>\n<li>the <a href=\"https://math.stackexchange.com/questions/3987/how-to-calculate-the-number-of-decimal-digits-for-a-binary-number\">math question</a>.</li>\n<li><a href=\"https://stackoverflow.com/users/1187415/martin-r\">Martin R</a>'s comment that summarizes it well: <em>\u201cn binary digits require ceil(n*ln(2)/ln(10)) \u2248 ceil(n * 0.301)\u201d</em></li>\n</ul>\n\n<p>You have your answer:</p>\n\n<pre><code>#define MAX_DECIMAL_SIZE(x)  ((size_t)(CHAR_BIT * sizeof(x) * 302 / 1000) + 1)\n\nchar buffer[MAX_DECIMAL_SIZE(unsigned int) + 1];\nsprintf(buffer, \"%u\", x);\n\n/* MAX_DECIMAL_SIZE(uint8_t) =&gt; 3\n * MAX_DECIMAL_SIZE(uint16_t) =&gt; 5\n * MAX_DECIMAL_SIZE(uint32_t) =&gt; 10\n * MAX_DECIMAL_SIZE(uint64_t) =&gt; 20\n * MAX_DECIMAL_SIZE(__uint128_t) =&gt; 39 */\n</code></pre>\n\n<p>The <code>302/1000</code> comes from <code>ln(2)/ln(10)</code>, rounded up. You can take more digits, from <code>0.3010299956639812\u2026</code> for more precision, but that's overkill until you work with 32768-bits systems or so. Continued fractions work too (see Martin R's comment below). Either way, be careful that <code>CHAR_BIT * sizeof(x) * &lt;your chosen numerator&gt;</code> is not too large and remember the result must be greater than the actual value.</p>\n\n<p>And if you really insist on octal representation, just change the multiplier to <code>ln(2)/ln(8)</code> (that's \u2153) and you'll have the number of octal digits required.</p>\n"}, {"comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495026981, "post_id": 44025682, "comment_id": 75078251, "body": "It is very convenient, alas it&#39;s not part of C standard, not even of POSIX, it&#39;s a pure GNU extension. Handy when you target GNU systems though."}, {"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1495029549, "post_id": 44025682, "comment_id": 75080347, "body": "You can take the return value of <code>snprintf</code> and then allocate the appropriate amount if you want to only use the standard library"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1528240379, "post_id": 44025682, "comment_id": 88429324, "body": "@ErikW True about <code>snprintf()</code>, yet pedantic code needs to look for encoding error returns and locale issues."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1495026129, "creation_date": 1495026129, "answer_id": 44025682, "question_id": 44023228, "link": "https://stackoverflow.com/questions/44023228/is-there-a-better-way-to-size-a-buffer-for-printing-integers/44025682#44025682", "title": "Is there a better way to size a buffer for printing integers?", "body": "<p>If you're OK with dynamically allocated memory, you can use <code>asprintf</code> instead.  This function will allocate the proper amount of memory to hold the string.</p>\n\n<pre><code>char *buf;\nint result = asprintf(&amp;buf, \"%u\", x);\nif (result == -1) {\n    perror(\"asprintf failed\");\n} else {\n    ...\n    free(buf);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1495028468, "post_id": 44025989, "comment_id": 75079477, "body": "I agree with your answer, except the last paragraph. Even though I prefer a macro in the buffer size argument, it is not because I assume portability; it is because I think it makes the code easier to manage, and especially if used in code read by new programmers, might help them learn to avoid buffer overrun problems -- which are woefully common in C.  I might be posing, and it is pretty much theoretical, but I&#39;m definitely not a language lawyer! (The edited example is just trolling, though. Only an idiot would write <i>that</i>.)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1495028767, "post_id": 44025989, "comment_id": 75079730, "body": "@NominalAnimal It is no less trolling than the &quot;logarithmic&quot; answer."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495029819, "post_id": 44025989, "comment_id": 75080570, "body": "You did not explain where your magic <code>5 &#47; 2</code> factor comes from, if not from approximating <code>CHAR_BIT * ln(2) &#47; ln(10)</code>. Fact is you do the exact same thing, you just hard-coded the CHAR_BIT value to 8 and used a less accurate approximation you got through trial and error instead of understanding the underlying formula. It falls short (or long, haha) on <code>__uint128_t</code> by the way."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495030000, "post_id": 44025989, "comment_id": 75080713, "body": "@spectras &quot;Which in turn means that your array needs to hold either 5 or 10 digits.&quot; Simply count the digits needed for the numbers posted before that sentence. The initial part of this answer focuses on answering the question, which is only concerned about <code>unsigned int</code>. Therefore <code>uint128_t</code> and other such things that weren&#39;t mentioned in the question, are not addressed. The last snippet can be expanded to cover other types, by adding them to the _Generic list."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495031251, "post_id": 44025989, "comment_id": 75081699, "body": "(Second example just plain doesn&#39;t work by the way, because none of the <code>*_MAX</code> macros expand to just a literal integer on my system. My limits.h has parenthesizes around the values - but I take the example was for joke value anyway)."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1495030148, "last_edit_date": 1495030148, "creation_date": 1495026861, "answer_id": 44025989, "question_id": 44023228, "link": "https://stackoverflow.com/questions/44023228/is-there-a-better-way-to-size-a-buffer-for-printing-integers/44025989#44025989", "title": "Is there a better way to size a buffer for printing integers?", "body": "<p>If the array should work on all real-world computers, then <code>int</code> can either be 2 or 4 bytes. No other alternatives exist (*).</p>\n\n<p>Meaning the maximum value it can hold is either 65535 or 4.29*10^9. Which in turn means that your array needs to hold either 5 or 10 digits.</p>\n\n<p>Which in turn means that the array could be declared as:</p>\n\n<pre><code> char buf [sizeof(int)/2 * 5 + 1];\n</code></pre>\n\n<p>which will either expand to 5+1 or 10+1, which covers all known computers in the world.</p>\n\n<p>A better and more professional solution is to use the fixed-width types from <code>stdint.h</code>. Then always you know in advance exactly how many digits that is needed, portably, and can therefore get rid of the above \"magic numbers\".</p>\n\n<hr>\n\n<p>(*) In C language standard theory, an <code>int</code> could be anything 2 bytes or larger. But since no such systems will ever exist in the real world, there is no point in making your code portable to them. The C language has already introduced <code>long</code> and <code>long long</code> for a reason.</p>\n\n<p>People who are concerned about portability to wildly exotic, completely fictional systems are misguided, they are mostly C language lawyers who like posing. You should not let such theoretical nonsense affect how you write professional programs for real-world computers.</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>The \"C language-lawyer poser\" version would look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\n#define STRINGIFY(s) #s\n#define GET_SIZE(n) sizeof(STRINGIFY(n))\n#define DIGITS(type) _Generic((type), unsigned int: GET_SIZE(INT_MAX) )\n\nint main(void) \n{\n  unsigned int x;\n  char buf [DIGITS(x)];\n\n  printf(\"%zu\", sizeof(buf));\n\n  return 0;\n}\n</code></pre>\n\n<p>Note that this assumes that <code>INT_MAX</code> expands to an integer constant and not to an expression. I got really strange results from GCC when using <code>UINT_MAX</code>, because that macro is defined as an expression internally, inside limits.h.</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1495032037, "last_edit_date": 1495542384, "creation_date": 1495032037, "answer_id": 44027992, "question_id": 44023228, "link": "https://stackoverflow.com/questions/44023228/is-there-a-better-way-to-size-a-buffer-for-printing-integers/44027992#44027992", "title": "Is there a better way to size a buffer for printing integers?", "body": "<p>The cases where something like this is needed is rare: perhaps some microcontroller code, transferring a value over some serial protocol. In such cases, using any of the <code>printf()</code> family of functions may increase the size of the final binary.</p>\n\n<p>(In typical C development environments, the C library is dynamically loaded, and there is absolutely no benefit in trying to avoid standard C library functions. It will not decrease the program size.)</p>\n\n<p>So, if I needed such code, I might write a header file,</p>\n\n<pre><code>#if defined(INTTYPE) &amp;&amp; defined (UINTTYPE) &amp;&amp; defined (FUNCNAME)\n\n#ifndef DECIMAL_DIGITS_IN\n#define DECIMAL_DIGITS_IN(x) ((CHAR_BIT * sizeof (x) * 28) / 93 + 2)\n#endif\n\nchar *FUNCNAME(const INTTYPE value)\n{\n    static char buffer[DECIMAL_DIGITS_IN(value) + 1];\n    char       *p = buffer + sizeof buffer;\n    UINTTYPE    left = (value &lt; 0) ? -value : value;\n\n    *(--p) = '\\0';\n    do {\n        *(--p) = '0' + (left % 10);\n        left /= 10;\n    } while (left &gt; 0);\n\n    if (value &lt; 0)\n        *(--p) = '-';\n\n    return p;\n}\n\n#undef FUNCNAME\n#undef INTTYPE\n#undef UINTTYPE\n\n#endif\n</code></pre>\n\n<p>and for each type I'd need, I'd use</p>\n\n<pre><code>#define FUNCNAME int2str\n#define INTTYPE  int\n#define UINTTYPE unsigned int\n#include \"above.h\"\n</code></pre>\n\n<hr>\n\n<p>In more ordinary code, the best approach is to use <a href=\"http://man7.org/linux/man-pages/man3/snprintf.3.html\" rel=\"nofollow noreferrer\"><code>snprintf()</code></a> to avoid buffer overruns, with the buffer size \"guesstimated\". For example,</p>\n\n<pre><code>unsigned int x;\n\nchar  buffer[256];\nint   len;\n\nlen = snprintf(buffer, sizeof buffer, \"Message with a number %u\", x);\nif (len &lt; 0 || (size_t)len &gt;= sizeof buffer - 1) {\n    /* Abort! The buffer was (almost certainly) too small! */\n} else {\n    /* Success; we have the string in buffer[]. */\n}\n</code></pre>\n\n<p>Whether <code>buffer[]</code> is a few dozen or even few hundred bytes larger than necessary, is <strong>completely irrelevant</strong> in typical programs.  Just make it large enough, and output an error message in the error case that tells which buffer (file and function) was not long enough, so it'll be easy to fix in the unlikely case it ever is too short.</p>\n\n<hr>\n\n<p>As mentioned by <a href=\"https://stackoverflow.com/a/44025682/1475978\">dbush</a>, <code>asprintf()</code> GNU extension is a viable alternative. It returns a dynamically allocated string.</p>\n\n<p>Outside of GNU systems -- and this is what I suggest OP considers, too -- one can implement their own <code>asprintf()</code>, using \n<a href=\"http://man7.org/linux/man-pages/man3/vsnprintf.3p.html\" rel=\"nofollow noreferrer\"><code>vsnprintf()</code></a> (available in C99 and later C libraries, and also in POSIX.1 C libraries).</p>\n\n<p>I prefer the variant that acts like POSIX.1 getline(), i.e. takes pointers to a pointer to a dynamically allocated buffer and the size of that buffer as extra parameters, and resizes that buffer if necessary:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nsize_t dynamic_printf(char **dataptr, size_t *sizeptr, const char *format, ...)\n{\n    va_arg  args;\n    char   *data;\n    size_t  size;\n    int     len;\n\n    if (!dataptr ||\u00a0!sizeptr || !format) {\n        errno = EINVAL;\n        return 0;\n    }\n    if (!*sizeptr) {\n        *dataptr = NULL;\n        *sizeptr = 0;\n    }\n    data = *dataptr;\n    size = *sizeptr;\n\n    va_start(args, format);\n    len = vsnprintf(data, size, format, args);\n    va_end(args);\n\n    if (len &lt; 0) {\n        errno = EINVAL;\n        return 0;\n    } else\n    if ((size_t)len &lt; size) {\n        errno = 0;\n        return (size_t)len;\n    }\n\n    /* Need to reallocate the buffer. */\n    size = (size_t)len + 1;\n    data = realloc(data, size);\n    if (!data) {\n        errno = ENOMEM;\n        return 0;\n    }\n    *dataptr = data;\n    *sizeptr = size;\n\n    va_start(args, format);\n    len = vsnprintf(data, size, format, args);\n    va_end(args);\n\n    if (len != (int)(size - 1)) {\n        errno = EINVAL;\n        return 0;\n    }\n\n    errno = 0;\n    return (size_t)len;\n}\n</code></pre>\n\n<p>The idea is that you can reuse the same dynamic buffer across several <code>dynamic_printf()</code> calls:</p>\n\n<pre><code>    char   *data = NULL;\n    size_t  size = 0;\n    size_t  len;\n\n    /* Some kind of loop for example */\n\n        len = dynamic_printf(&amp;data, &amp;size, \"This is something I need in a buffer\");\n        if (errno) {\n            /* Abort! Reason is strerror(errno) */\n        } else {\n            /* data is non-NULL, and has len chars in it. */\n        }\n\n    /* Strings are no longer used, so free the buffer */\n    free(data);\n    data = NULL;\n    size = 0;\n</code></pre>\n\n<p>Note that it is perfectly safe to run <code>free(data); data = NULL; size = 0;</code> between calls. <code>free(NULL)</code> does nothing, and if the buffer pointer is <code>NULL</code> and size zero, the function will just dynamically allocate a new buffer.</p>\n\n<p>In the worst case (when the buffer is not long enough), the function does \"print\" the string twice. This is perfectly acceptable, in my opinion.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1495034913, "last_edit_date": 1495034913, "creation_date": 1495032106, "answer_id": 44028031, "question_id": 44023228, "link": "https://stackoverflow.com/questions/44023228/is-there-a-better-way-to-size-a-buffer-for-printing-integers/44028031#44028031", "title": "Is there a better way to size a buffer for printing integers?", "body": "<p>OP's solution minimally meets design goals.</p>\n\n<blockquote>\n  <p>Is there a better way to size a buffer for printing integers?</p>\n</blockquote>\n\n<p>Even a short analysis indicates the the number of bits needed with a <code>unsigned</code> grows by a factor of  <code>log10(2)</code> or about 0.30103.... for each value bit when printing decimal and by <code>1/3</code> for printing octal.  OP's code uses a factor of one-third or 0.33333...</p>\n\n<pre><code>unsigned x;\nchar buf[(CHAR_BIT*sizeof(unsigned)+5)/3];\nsprintf(buf, \"%u\", x);\n</code></pre>\n\n<p>Considerations:</p>\n\n<ol>\n<li><p>If buffer tightness concerns are real, then a buffer for decimal printing deserves a separate consideration than printing in octal.</p></li>\n<li><p>Correctness:  Unless code uses a strange <em>locale</em> with <code>sprintf()</code>, the conversion of the widest <code>unsigned</code>, which is <code>UINT_MAX</code> works for all platforms. </p></li>\n<li><p>Clarity: the <code>...5)/3</code> is unadorned and does not indicate the rational for 5 and 3.</p></li>\n<li><p>Efficiency.  The buffer size is modestly excessive.  This would not be an issues for a single buffer, but for an array of buffers a tighter value is recommended.</p></li>\n<li><p>Generality: macro is crafted to only one type.</p></li>\n<li><p>Potential hazard:  With code re-use, a code extrapolation could use the same 5 and 3 for <code>int</code> without due consideration.  OP's 5/3 works for <code>int</code> too, so this is not an issue.  </p></li>\n<li><p>Corner case: Using 5/3 for <em>signed</em> types and octal is a problem as <code>(CHAR_BIT*sizeof(unsigned)+5)/3</code> should be <code>(CHAR_BIT*sizeof(unsigned) + 5)/3 + 1</code>.  Example: problem occurs when trying to convert an <code>int -32768</code> to base 8 text: \"-100000\" via some function (not <code>sprintf(... \"%o\" ...)</code>).  That buffer needed is 8 where as <code>CHAR_BIT*sizeof(unsigned)+5)/3</code> could be 7.</p></li>\n</ol>\n\n<hr>\n\n<blockquote>\n  <p>Is there a better way to do this?</p>\n</blockquote>\n\n<p>Candidate for base 10:</p>\n\n<p>28/93 (0.301075...) is a very close, and greater, approximation of log10(2).  Of course code could use a more obvious fraction like 30103/100000.</p>\n\n<p>Generality: A good macro would also adapt to other types.  Below is one for various unsigned types.</p>\n\n<pre><code>#define LOG10_2_N 28\n#define LOG10_2_D 93\n//                              1 for the ceiling                          1 for \\0\n#define UINT_BUFFER10_SIZE(type) (1 + (CHAR_BIT*sizeof(type)*LOG10_2_N)/LOG10_2_D + 1)\n\n\nunsigned x;\nchar bufx[UINT_BUFFER10_SIZE(x)];\nsprintf(bufx, \"%u\", x);\n\nsize_t z;\nchar bufz[UINT_BUFFER10_SIZE(z)];\nsprintf(bufz, \"%zu\", z);\n</code></pre>\n\n<p>The 28/93 fraction give the same answer integer results as log10(2) for integer sizes 1 to 92 bits and so is space efficient for arrays of buffers.  It is never too small.</p>\n\n<p>A macro for signed type could use</p>\n\n<pre><code>#define INT_BUFFER_SIZE(type) (1+1+ (CHAR_BIT*sizeof(type)-1)*LOG10_2_N)/LOG10_2_D + 1)\n</code></pre>\n\n<p>Avoid an off-by-one issue: I recommend using <code>SIZE</code> in the macro name to convey the buffer <em>size</em> needed and not the maximum string length.</p>\n\n<p>Candidate for base 8:</p>\n\n<p>Once a computed size for non-base 10 is needed, applications I've made usually need a a buffer to handle any base 2 and up.  Consider <code>printf()</code> may allow <code>%b</code> someday too.  So for a <em>general</em> purpose buffer to handle integer to text, any base, any sign-ness suggest: </p>\n\n<pre><code>#define INT_STRING_SIZE(x)  (1 /* sign */ + CHAR_BIT*sizeof(x) + 1 /* \\0 */)\n\nint x = INT_MIN;\nchar buf[INT_STRING_SIZE(x)];\nmy_itoa(buf, sizeof buf, x, 2);\nputs(buf); --&gt; \"-10000000000000000000000000000000\"  (34 char were needed)\n</code></pre>\n"}], "owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 1, "accepted_answer_id": 44024876, "answer_count": 5, "score": 1, "last_activity_date": 1495034913, "creation_date": 1495019533, "last_edit_date": 1495025221, "question_id": 44023228, "link": "https://stackoverflow.com/questions/44023228/is-there-a-better-way-to-size-a-buffer-for-printing-integers", "title": "Is there a better way to size a buffer for printing integers?", "body": "<p>I want to create a buffer for <code>sprintf</code>ing a integer (in this case an <code>unsigned int</code>). A simple and misguided approach would be:</p>\n\n<pre><code>char buf[11];\n\nsprintf(buf, \"%u\", x);\n</code></pre>\n\n<p>This works great if we know that <code>unsigned int</code> is at most <code>33</code> bits wide, but what if we want to accomodate all wierd architectures? The best I can come up with is:</p>\n\n<pre><code>char buf[(CHAR_BIT*sizeof(unsigned)+5)/3];\n\nsprintf(buf, \"%u\", x);\n</code></pre>\n\n<p>I'm quite confident this will work on any implementation. <code>CHAR_BIT*sizeof(unsigned)</code> is (an upper bound for) the number of bits in an <code>unsigned</code>. Then I add two and divide 3 to find the number of digits in octal representation and finally add one for the NUL-termination. This means the buffer is enough for printing the number in octal and since decimal representation uses no more digits than octal it will be enough for decimal representation too.</p>\n\n<p>Is there a better way to do this? By better I mean a way producing smaller buffer without risking a buffer overrun no matter what value <code>x</code> has (even in face of malicious constructed yet standard conforming implementation). My approach would produce a 12-<code>char</code> buffer for 32-bit <code>unsigned</code> despite the fact that <code>11</code> would be enough.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495019512, "post_id": 44023145, "comment_id": 75072670, "body": "@xing and why&#39;s that <i>required</i> here? It&#39;s a good practice, but not an error reason here. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495019533, "post_id": 44023145, "comment_id": 75072691, "body": "<i>This question was caused by a problem that can no longer be reproduced or a simple typographical error. While similar questions may be on-topic here, this one was resolved in a manner unlikely to help future readers. This can often be avoided by identifying and closely inspecting the shortest program necessary to reproduce the problem before posting.</i>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495019536, "post_id": 44023145, "comment_id": 75072694, "body": "@xing <code>cl</code> is already initialized to 0, <code>cw</code> is initialized by <code>strlen</code> and <code>i</code> is initialized by <code>for (i = 0;...)</code>."}, {"owner": {"reputation": 199, "user_id": 4239431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffe36c54ec64b1a3465cb0648f6ea17e?s=128&d=identicon&r=PG&f=1", "display_name": "54D", "link": "https://stackoverflow.com/users/4239431/54d"}, "edited": false, "score": 0, "creation_date": 1495019608, "post_id": 44023145, "comment_id": 75072741, "body": "I pasted an outdated code that was in my clipboard, where <code>cl</code> wasn&#39;t initialized yet. My fault."}], "answers": [{"tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": true, "score": 4, "last_activity_date": 1495019431, "creation_date": 1495019431, "answer_id": 44023192, "question_id": 44023145, "link": "https://stackoverflow.com/questions/44023145/count-length-and-number-of-words-in-string/44023192#44023192", "title": "Count length and number of words in string", "body": "<pre><code>if(in[i]=' '){\n</code></pre>\n\n<p>will always be true, you need to change it to</p>\n\n<pre><code>if(in[i]==' '){\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2241, "user_id": 6284825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7dY9qEIYqY/AAAAAAAAAAI/AAAAAAAAABE/DUXNdvdCo9I/photo.jpg?sz=128", "display_name": "Abhilekh Singh", "link": "https://stackoverflow.com/users/6284825/abhilekh-singh"}, "is_accepted": false, "score": 4, "last_activity_date": 1495019507, "last_edit_date": 1592644375, "creation_date": 1495019507, "answer_id": 44023217, "question_id": 44023145, "link": "https://stackoverflow.com/questions/44023145/count-length-and-number-of-words-in-string/44023217#44023217", "title": "Count length and number of words in string", "body": "<p>2 mistakes I see in your code.</p>\n<ol>\n<li><code>if(in[i]=' ')</code> should be <code>if(in[i]==' ')</code></li>\n</ol>\n<blockquote>\n<p><code>==</code> Checks if the values of two operands are equal or not. If yes, then the condition becomes true.</p>\n<p><code>=</code> Simple assignment operator. Assigns values from right side operands to left side operand.</p>\n</blockquote>\n<ol start=\"2\">\n<li><code>i&lt;=cw</code> should be <code>i&lt;cw</code></li>\n</ol>\n<blockquote>\n<p>indexing starts with 0 in C.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 247, "user_id": 7976491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e332cb2aea0faa8ea222642e3e169504?s=128&d=identicon&r=PG&f=1", "display_name": "AppWriter", "link": "https://stackoverflow.com/users/7976491/appwriter"}, "is_accepted": false, "score": 0, "last_activity_date": 1495020099, "last_edit_date": 1495020099, "creation_date": 1495019552, "answer_id": 44023236, "question_id": 44023145, "link": "https://stackoverflow.com/questions/44023145/count-length-and-number-of-words-in-string/44023236#44023236", "title": "Count length and number of words in string", "body": "<p>You should use == instead of = in the if statement that detects the space.</p>\n\n<p>The assignment operator, = gives is always true if the number is asssigned to a nonzero value.</p>\n\n<p>The equivalence operator, == is what actually compares whether two numbers have the same value.</p>\n\n<p>It may be surprising that the assignment operator can actually test whether or not a number is zero(at least on x860. This is because jz, one of the testing instructions, checks something called a flag register (a special memory location) that contains information about the arithmetic operation most recently executed. == does a cmp, which subtracts both numbers from each other to see if it is 0. Jz stands for \"jump if zero\", so two equal numbers result to the \"jump\" to the instructions in the if statement. When = is used, the compiler uses jz instead (in order to comply with the c idea that nonzero number in if is true), which results in the behavior described above.</p>\n"}, {"tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 2, "last_activity_date": 1495019621, "creation_date": 1495019621, "answer_id": 44023259, "question_id": 44023145, "link": "https://stackoverflow.com/questions/44023145/count-length-and-number-of-words-in-string/44023259#44023259", "title": "Count length and number of words in string", "body": "<p>As Pras said, on ifs you normally use ==, because you are comparing and it returns true or false\nIf you just use = it attributes (insert) a value on the right to the left.</p>\n"}], "owner": {"reputation": 199, "user_id": 4239431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffe36c54ec64b1a3465cb0648f6ea17e?s=128&d=identicon&r=PG&f=1", "display_name": "54D", "link": "https://stackoverflow.com/users/4239431/54d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 44023192, "answer_count": 4, "score": 1, "last_activity_date": 1495020699, "creation_date": 1495019302, "last_edit_date": 1495020699, "question_id": 44023145, "link": "https://stackoverflow.com/questions/44023145/count-length-and-number-of-words-in-string", "title": "Count length and number of words in string", "body": "<p>I am a beginner in C. I am trying to print out the length and the number of words in a string inputted by user. I have trouble dealing with the counting of words. I attempt to scan the number of the space character <code></code>, then add 1 to the result. It is guaranteed that each word is only separated by one space.</p>\n\n<p>I executed the code, and inputted</p>\n\n<pre><code>I go to school by bus.\n</code></pre>\n\n<p>The second output was not as I expected</p>\n\n<pre><code>22\n24\n</code></pre>\n\n<p><code>22</code> is correct since it is indeed the length of the string, but I do not understand why it prints <code>24</code> instead of <code>6</code> (result of 5 spaces plus 1).</p>\n\n<p>The code is as follows</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main(){\n    char in[256];\n    int cl=0,cw,i;\n    scanf(\"%[^\\n]\",&amp;in);\n    cw=strlen(in);\n    for(i=0;i&lt;=cw;i++){\n        if(in[i]=' '){\n            cl=cl+1;\n        }\n    }\n    printf(\"%d\\n\",cw);\n    printf(\"%d\\n\",cl+1);\n    return 0;\n}\n</code></pre>\n\n<p>What went wrong, and how can I get a correct output?</p>\n"}, {"tags": ["c", "macos", "select", "signals"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1495018675, "post_id": 44022783, "comment_id": 75072178, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5405297/which-functions-are-interrupted-by-signals-even-with-sa-restart\">Which functions are interrupted by signals even with SA_RESTART?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1517597868, "post_id": 48553220, "comment_id": 84175457, "body": "Quote from OP: &quot;I am using select in one of my OSX programs to watch some file descriptors.&quot;"}, {"owner": {"reputation": 462, "user_id": 3191035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sqUZV.jpg?s=128&g=1", "display_name": "Frederick Ollinger", "link": "https://stackoverflow.com/users/3191035/frederick-ollinger"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1517689605, "post_id": 48553220, "comment_id": 84199937, "body": "Finish reading the OP: &quot;I encountered the issue with child processes on Linux that select may fail with errno set to EINTR. On Linux I have encountered this using...Setting the SA_RESTART flag which will eradicate the issue on Linux.&quot; This is false."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1518014721, "post_id": 48553220, "comment_id": 84330708, "body": "Thank you, please tell it Debian that they should change behaviour in their distribution :)."}], "tags": [], "owner": {"reputation": 462, "user_id": 3191035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sqUZV.jpg?s=128&g=1", "display_name": "Frederick Ollinger", "link": "https://stackoverflow.com/users/3191035/frederick-ollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1517441891, "creation_date": 1517441891, "answer_id": 48553220, "question_id": 44022783, "link": "https://stackoverflow.com/questions/44022783/sa-restart-seems-to-have-no-effect-on-select/48553220#48553220", "title": "SA_RESTART seems to have no effect on select", "body": "<p>For Linux, SA_RESTART has no effect on select(2). See the manpage for signal(7):</p>\n\n<pre><code>The following interfaces are never restarted after being interrupted\nby  a  signal  handler,  regardless  of  the  use  of SA_RESTART;\nthey always fail with the error EINTR when interrupted by a signal\nhandler:\n...\n* File descriptor multiplexing interfaces: epoll_wait(2),\n  epoll_pwait(2), poll(2), ppoll(2), select(2), and pselect(2).\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11236526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pG8sMGxznpg/AAAAAAAAAAI/AAAAAAAADGY/lTJxJqwWXMo/photo.jpg?sz=128", "display_name": "Rasty Slutsker", "link": "https://stackoverflow.com/users/11236526/rasty-slutsker"}, "is_accepted": false, "score": 1, "last_activity_date": 1563452213, "last_edit_date": 1563452213, "creation_date": 1563449636, "answer_id": 57093501, "question_id": 44022783, "link": "https://stackoverflow.com/questions/44022783/sa-restart-seems-to-have-no-effect-on-select/57093501#57093501", "title": "SA_RESTART seems to have no effect on select", "body": "<p>It appears that <code>SA_RESTART</code> does not have any effect on <code>accept()</code> if the calling (\"accepting\") thread is stopped/resumed with a signal.</p>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3239, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563452213, "creation_date": 1495018317, "question_id": 44022783, "link": "https://stackoverflow.com/questions/44022783/sa-restart-seems-to-have-no-effect-on-select", "title": "SA_RESTART seems to have no effect on select", "body": "<p>I am using select in one of my OSX programs to watch some file descriptors. I encountered the issue with child processes on Linux that select may fail with <code>errno</code> set to <code>EINTR</code>. On Linux I have encountered this using</p>\n\n<pre><code>struct sigaction sa;\n::memset(&amp;sa, 0, sizeof(sa));\nsa.sa_handler = child_death_signal_handler;\nsa.sa_flags = SA_RESTART;\nsigaction(SIGCHLD, &amp;sa, NULL);\n</code></pre>\n\n<p>Setting the <code>SA_RESTART</code> flag which will eradicate the issue on Linux. On OSX however, <code>SA_RESTART</code> is mentioned in the manpages, but it seems to have zero effect, as my read functions, etc, still fail with <code>EINTR</code> as <code>errno</code>.</p>\n\n<p>Is there some way to make this work in OSX also?</p>\n"}, {"tags": ["c", "linux", "timer", "linux-device-driver", "interrupt"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1495018133, "post_id": 44022533, "comment_id": 75071819, "body": "It sounds like you need to learn how to debug code."}, {"owner": {"reputation": 1, "user_id": 7250636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b707aa6e4319c199c2faaaa6729d08f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dizzy_Boy", "link": "https://stackoverflow.com/users/7250636/dizzy-boy"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1495018429, "post_id": 44022533, "comment_id": 75072015, "body": "The codes run correctly but I need to add timers and sysinfo() which I&#39;ve added in wrong place and improperly."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1495182986, "post_id": 44022533, "comment_id": 75154626, "body": "Too many problems in one question post. At least on problem - <code>sysinfo</code> - is not related with others. 3 scenarios for timer - &quot;once&quot;, &quot;n times&quot;, &quot;until stopped&quot; are also distinct problems. <code>And also the user process have to get back the data (snap shot) from device through command IO interface at the end of every timer interrupt completion.</code> - How this should operate from the user&#39;s point of view? Should <code>ioctl()</code> return data after 300ms, and user should call it again for get new portion of data? Currently, you question is <b>too broad</b> for Stack Overflow format."}, {"owner": {"reputation": 1, "user_id": 7250636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b707aa6e4319c199c2faaaa6729d08f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dizzy_Boy", "link": "https://stackoverflow.com/users/7250636/dizzy-boy"}, "edited": false, "score": 0, "creation_date": 1495196043, "post_id": 44022533, "comment_id": 75163490, "body": "I understand that it&#39;s sophisticated. However, if you can help with one of these problems, I would be thankful."}], "owner": {"reputation": 1, "user_id": 7250636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b707aa6e4319c199c2faaaa6729d08f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dizzy_Boy", "link": "https://stackoverflow.com/users/7250636/dizzy-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495017541, "creation_date": 1495017541, "question_id": 44022533, "link": "https://stackoverflow.com/questions/44022533/timers-and-sysinfo-at-the-character-device-driver-in-linux", "title": "Timers and sysinfo at the character device driver in Linux", "body": "<p>I'm writing a simple character device driver in Linux. But I've encountered some issues. I've added timer but it's incorrect. I need to 1) execute timer one; 2) execute timer n times each 30 seconds apart and stop; 3) execute timer continuously until user sends a STOP command to the driver. And also the user process have to get back the data (snap shot) from device through command IO interface at the end of every timer interrupt completion. I can use jiffies, tasklets, interrupts but I have no idea how to implement them in this driver.\nThen about the sysinfo(). I've added the code of sysinfo() to the user application but it has to be in the kernel application code and then send back the sysinfo() to the user application process and show in the terminal.\nHere are my kernel and user application codes respectively.</p>\n\n<p>Kernel:</p>\n\n<pre><code>/**\n * @file   diasdd.c\n * @date   16 May 2017\n * @version 0.1\n * @brief   This module maps to /dev/diasdd and\n * comes with a helper C program that can be run in Linux user space to communicate with\n * this the LKM.\n */\n\n#include &lt;linux/init.h&gt;           // Macros used to mark up functions e.g. __init __exit\n#include &lt;linux/module.h&gt;         // Core header for loading LKMs into the kernel\n#include &lt;linux/device.h&gt;         // Header to support the kernel Driver Model\n#include &lt;linux/kernel.h&gt;         // Contains types, macros, functions for the kernel\n#include &lt;linux/fs.h&gt;             // Header for the Linux file system support\n#include &lt;asm/uaccess.h&gt;          // Required for the copy to user function\n#include &lt;linux/timer.h&gt;\n\n#define  DEVICE_NAME \"diasdd\"    ///&lt; The device will appear at /dev/diasdd using this value\n#define  CLASS_NAME  \"dd\"        ///&lt; The device class -- this is a character device driver\n\nMODULE_LICENSE(\"GPL\");            ///&lt; The license type -- this affects available functionality\nMODULE_DESCRIPTION(\"A simple Linux char driver\");  ///&lt; The description -- see modinfo\nMODULE_VERSION(\"0.1\");            ///&lt; A version number to inform users\n\nstatic int    majorNumber;                  ///&lt; Stores the device number -- determined automatically\nstatic char   message[256] = {0};           ///&lt; Memory for the string that is passed from user space\nstatic short  size_of_message;              ///&lt; Used to remember the size of the string stored\nstatic int    numberOpens = 0;              ///&lt; Counts the number of times the device is opened\nstatic struct class*  diasddClass  = NULL; ///&lt; The device-driver class struct pointer\nstatic struct device* diasddDevice = NULL; ///&lt; The device-driver device struct pointer\n\n// The prototype functions for the character driver -- must come before the struct definition\nstatic int     dev_open(struct inode *, struct file *);\nstatic int     dev_release(struct inode *, struct file *);\nstatic ssize_t dev_read(struct file *, char *, size_t, loff_t *);\nstatic ssize_t dev_write(struct file *, const char *, size_t, loff_t *);\n\nstatic struct timer_list my_timer;\n\nvoid my_timer_callback( unsigned long data )\n{\n  printk( \"DiasDD: my_timer_callback called (%ld).\\n\", jiffies );\n}\n\n\n/** @brief Devices are represented as file structure in the kernel. The file_operations structure from\n *  /linux/fs.h lists the callback functions that we wish to associated with our file operations\n *  using a C99 syntax structure. char devices usually implement open, read, write and release calls\n */\nstatic struct file_operations fops =\n{\n   .open = dev_open,\n   .read = dev_read,\n   .write = dev_write,\n   .release = dev_release,\n};\n\n/** @brief The LKM initialization function\n *  The static keyword restricts the visibility of the function to within this C file. The __init\n *  macro means that for a built-in driver (not a LKM) the function is only used at initialization\n *  time and that it can be discarded and its memory freed up after that point.\n *  @return returns 0 if successful\n */\nstatic int __init diasdd_init(void){\n    // Timer starts here\n    int ret;\n\n  printk(\"DiasDD: Timer module installing\\n\");\n\n  // my_timer.function, my_timer.data\n  setup_timer( &amp;my_timer, my_timer_callback, 0 );\n\n  printk( \"DiasDD: Starting timer to fire in 300ms (%ld)\\n\", jiffies );\n  ret = mod_timer( &amp;my_timer, jiffies + msecs_to_jiffies(300) );\n  if (ret) printk(\"Error in mod_timer\\n\");  \n\n   printk(KERN_INFO \"DiasDD: Initializing the DiasDD LKM\\n\");\n\n   // Try to dynamically allocate a major number for the device -- more difficult but worth it\n   majorNumber = register_chrdev(0, DEVICE_NAME, &amp;fops);\n   if (majorNumber&lt;0){\n      printk(KERN_ALERT \"DiasDD failed to register a major number\\n\");\n      return majorNumber;\n\n   printk(KERN_INFO \"DiasDD: registered correctly with major number %d\\n\", majorNumber);\n   }\n\n   // Register the device class\n   diasddClass = class_create(THIS_MODULE, CLASS_NAME);\n   if (IS_ERR(diasddClass)){                // Check for error and clean up if there is\n      unregister_chrdev(majorNumber, DEVICE_NAME);\n      printk(KERN_ALERT \"Failed to register device class\\n\");\n      return PTR_ERR(diasddClass);          // Correct way to return an error on a pointer\n   }\n   printk(KERN_INFO \"DiasDD: device class registered correctly\\n\");\n\n   // Register the device driver\n   diasddDevice = device_create(diasddClass, NULL, MKDEV(majorNumber, 0), NULL, DEVICE_NAME);\n   if (IS_ERR(diasddDevice)){               // Clean up if there is an error\n      class_destroy(diasddClass);           // Repeated code but the alternative is goto statements\n      unregister_chrdev(majorNumber, DEVICE_NAME);\n      printk(KERN_ALERT \"Failed to create the device\\n\");\n      return PTR_ERR(diasddDevice);\n   }\n   printk(KERN_INFO \"DiasDD: device class created correctly\\n\"); // Made it! device was initialized\n   return 0;\n}\n\n/** @brief The LKM cleanup function\n *  Similar to the initialization function, it is static. The __exit macro notifies that if this\n *  code is used for a built-in driver (not a LKM) that this function is not required.\n */\nstatic void __exit diasdd_exit(void){\n    // Timer ends here\n    int ret;\n\n  ret = del_timer( &amp;my_timer );\n  if (ret) printk(\"DiasDD: The timer is still in use...\\n\");\n\n  printk(\"DiasDD: Timer module uninstalling\\n\");\n\n   device_destroy(diasddClass, MKDEV(majorNumber, 0));     // remove the device\n   class_unregister(diasddClass);                          // unregister the device class\n   class_destroy(diasddClass);                             // remove the device class\n   unregister_chrdev(majorNumber, DEVICE_NAME);             // unregister the major number\n   printk(KERN_INFO \"DiasDD: Goodbye from the LKM!\\n\");\n}\n\n/** @brief The device open function that is called each time the device is opened\n *  This will only increment the numberOpens counter in this case.\n *  @param inodep A pointer to an inode object (defined in linux/fs.h)\n *  @param filep A pointer to a file object (defined in linux/fs.h)\n */\nstatic int dev_open(struct inode *inodep, struct file *filep){\n   numberOpens++;\n   printk(KERN_INFO \"DiasDD: Device has been opened %d time(s)\\n\", numberOpens);\n   return 0;\n}\n\n/** @brief This function is called whenever device is being read from user space i.e. data is\n *  being sent from the device to the user. In this case it uses the copy_to_user() function to\n *  send the buffer string to the user and captures any errors.\n *  @param filep A pointer to a file object (defined in linux/fs.h)\n *  @param buffer The pointer to the buffer to which this function writes the data\n *  @param len The length of the b\n *  @param offset The offset if required\n */\nstatic ssize_t dev_read(struct file *filep, char *buffer, size_t len, loff_t *offset){\n   int error_count = 0;\n   // copy_to_user has the format ( * to, *from, size) and returns 0 on success\n   error_count = copy_to_user(buffer, message, size_of_message);\n\n   if (error_count==0){            // if true then have success\n      printk(KERN_INFO \"DiasDD: Sent %d characters to the user\\n\", size_of_message);\n      return (size_of_message=0);  // clear the position to the start and return 0\n   }\n   else {\n      printk(KERN_INFO \"DiasDD: Failed to send %d characters to the user\\n\", error_count);\n      return -EFAULT;              // Failed -- return a bad address message (i.e. -14)\n   }\n}\n\n/** @brief This function is called whenever the device is being written to from user space i.e.\n *  data is sent to the device from the user. The data is copied to the message[] array in this\n *  LKM using the sprintf() function along with the length of the string.\n *  @param filep A pointer to a file object\n *  @param buffer The buffer to that contains the string to write to the device\n *  @param len The length of the array of data that is being passed in the const char buffer\n *  @param offset The offset if required\n */\nstatic ssize_t dev_write(struct file *filep, const char *buffer, size_t len, loff_t *offset){\n   sprintf(message, \"%s(%zu letters)\", buffer, len);   // appending received string with its length\n   size_of_message = strlen(message);                 // store the length of the stored message\n   printk(KERN_INFO \"DiasDD: Received %zu characters from the user\\n\", len);\n   printk(KERN_INFO \"DiasDD: Received message: %s\\n\", buffer);\n   return len;\n}\n\n/** @brief The device release function that is called whenever the device is closed/released by\n *  the user space program\n *  @param inodep A pointer to an inode object (defined in linux/fs.h)\n *  @param filep A pointer to a file object (defined in linux/fs.h)\n */\nstatic int dev_release(struct inode *inodep, struct file *filep){\n   printk(KERN_INFO \"DiasDD: Device successfully closed\\n\");\n   return 0;\n}\n\n/** @brief A module must use the module_init() module_exit() macros from linux/init.h, which\n *  identify the initialization function at insertion time and the cleanup function (as\n\n *  listed above)\n */\nmodule_init(diasdd_init);\nmodule_exit(diasdd_exit);\n</code></pre>\n\n<p>User Process:</p>\n\n<pre><code>/**\n * @file   testdiasdd.c\n * @date   16 May 2017\n * @version 0.1\n * @brief  A Linux user space program that communicates with the diasdd.c LKM. It passes a\n * string to the LKM and reads the response from the LKM. For this example to work the device\n * must be called /dev/diasdd.\n*/\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;sys/sysinfo.h&gt;    // sysinfo\n#include &lt;unistd.h&gt;     // sysconf\n\n#define BUFFER_LENGTH 256               ///&lt; The buffer length (crude but fine)\nstatic char receive[BUFFER_LENGTH];     ///&lt; The receive buffer from the LKM\n\nint main(){\n   int ret, fd;\n   char stringToSend[BUFFER_LENGTH];\n   printf(\"Starting device test code example...\\n\");\n   fd = open(\"/dev/diasdd\", O_RDWR);             // Open the device with read/write access\n   if (fd &lt; 0){\n      perror(\"Failed to open the device...\");\n      return errno;\n   }\n   printf(\"Type in a short string to send to the kernel module:\\n\");\n   scanf(\"%[^\\n]%*c\", stringToSend);                // Read in a string (with spaces)\n   printf(\"Writing message to the device [%s].\\n\", stringToSend);\n   ret = write(fd, stringToSend, strlen(stringToSend)); // Send the string to the LKM\n   if (ret &lt; 0){\n      perror(\"Failed to write the message to the device.\");\n      return errno;\n   }\n\n   printf(\"Press ENTER to read back from the device...\\n\");\n   getchar();\n\n   printf(\"Reading from the device...\\n\");\n   ret = read(fd, receive, BUFFER_LENGTH);        // Read the response from the LKM\n   if (ret &lt; 0){\n      perror(\"Failed to read the message from the device.\");\n      return errno;\n   }\n   printf(\"The received message is: [%s]\\n\", receive);\n   printf(\"End of the program\\n\");\n\n   struct sysinfo info;\n\n     if (sysinfo(&amp;info) != 0)\n\n    printf(\"\\n\");\n    printf(\"Current system info:\\n\");\n    printf(\"Uptime: %ld:%ld:%ld\\n\", info.uptime/3600, info.uptime%3600/60, info.uptime%60);\n    printf(\"Total RAM: %ld MB\\n\", info.totalram/1024/1024);\n    printf(\"Free RAM: %ld MB\\n\", (info.totalram-info.freeram)/1024/1024);\n    printf(\"Shared RAM: %ld MB\\n\", info.sharedram/1024/1024);\n    printf(\"Memory used by buffers: %ld MB\\n\", info.bufferram/1024/1024);\n    printf(\"Free swap space size: %ld bytes\\n\", info.freeswap);\n    printf(\"Process count: %d\\n\", info.procs);\n\n   return 0;\n }\n</code></pre>\n\n<p>This is my Makefile:</p>\n\n<pre><code>obj-m := diasdd.o \n\nall:\n        make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules\n        $(CC) testdiasdd.c -o test\nclean:\n        make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean\n        rm test\n</code></pre>\n"}, {"tags": ["c", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 1344, "user_id": 2983132, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mbr5k.png?s=128&g=1", "display_name": "kjhf", "link": "https://stackoverflow.com/users/2983132/kjhf"}, "edited": false, "score": 1, "creation_date": 1495016026, "post_id": 44021697, "comment_id": 75070475, "body": "You should consider posting to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> instead for code review questions"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1495016041, "post_id": 44021697, "comment_id": 75070480, "body": "<code>for( int i = 1; i &lt;= 3; i ++ ) { if( i % 2 ) for( int j = 1; j &lt;= 10; j++ ) printf( &quot;%d &quot;, j ); else for( int j = 10; j &gt;= 1; j-- ) printf( &quot;%d &quot;, j ); printf(&quot;\\n&quot;); }</code>"}, {"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "edited": false, "score": 6, "creation_date": 1495016070, "post_id": 44021697, "comment_id": 75070496, "body": "I&#39;m voting to close this question as off-topic because it belongs to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "edited": false, "score": 0, "creation_date": 1495018191, "post_id": 44021697, "comment_id": 75071852, "body": "@taskinoor Just because a question is on-topic elsewhere doesn&#39;t make it off-topic here. This has been discussed several times on meta. Code review is indeed a more suitable site to post this, but that does not make this question off-topic on SO."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495018748, "post_id": 44021697, "comment_id": 75072229, "body": "Discussing performance without a specific system in mind in rather meaningless. Especially since 99% of the execution time in this case will be clogged up in the printf function calls. Unless you separate the algorithm from the printf calls, trying to optimize this loop is nothing but &quot;pre-mature optimization&quot;. Optimization would also involve attempts to pre-generate the numbers at compile-time, getting rid of the loop entirely."}, {"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495019775, "post_id": 44021697, "comment_id": 75072864, "body": "@Lundin thanks for the information. I definitely missed those meta discussions. Will keep that in my mind in future."}, {"owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1495021382, "post_id": 44021697, "comment_id": 75074047, "body": "The most efficient code for a program with no explicit or implicit input parameters is just replication of the (static) output. Using one &quot;loop&quot; we get: <code>do { printf(&quot;1 2 3 4 5 6 7 8 9 10\\n10 9 8 7 6 5 4 3 2 1\\n1 2 3 4 5 6 7 8 9 10\\n&quot;); } while(0);</code>.  If the question is to be taken literally, this must be the answer."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1495015954, "last_edit_date": 1495015954, "creation_date": 1495015612, "answer_id": 44021784, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44021784#44021784", "title": "Correct way to write a pattern in C language", "body": "<p>Use an array and iterate it normally at first iteration, vice versa in the second iteration and then normally again.</p>\n\n<p>Sample code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define SIZE 10\n\nvoid print_arr(int* array, int size);\nvoid print_rev_arr(int* array, int size);\n\nint main(void)\n{\n    int array[SIZE] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n    int iter = 3;\n\n    for(int i = 0; i &lt; iter; ++i)\n        if(i % 2)\n            print_arr(array, SIZE);\n        else\n            print_rev_arr(array, SIZE);\n    return 0;\n}\n\nvoid print_arr(int* array, int size)\n{\n    for(int i = 0; i &lt; size; ++i)\n        printf(\"%d \", array[i]);\n    printf(\"\\n\");\n}\n\nvoid print_rev_arr(int* array, int size)\n{\n    for(int i = size - 1; i &gt;= 0; --i)\n        printf(\"%d \", array[i]);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -Wall main.c \nGeorgioss-MacBook-Pro:~ gsamaras$ ./a.out \n10 9 8 7 6 5 4 3 2 1 \n1 2 3 4 5 6 7 8 9 10 \n10 9 8 7 6 5 4 3 2 1 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1495015710, "creation_date": 1495015710, "answer_id": 44021835, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44021835#44021835", "title": "Correct way to write a pattern in C language", "body": "<p>Hint: you can use <code>for</code> loops to iterate in either direction:</p>\n\n<pre><code>for (int i = 1; i &lt;= 10; ++i)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>for (int i = 10; i &gt;= 1; --i)\n</code></pre>\n\n<p>Also, a <code>for</code> loop is better than a <code>while</code> here because it really shows to the reader \"I am iterating <code>i</code> from this to that.\"</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1495019529, "post_id": 44022015, "comment_id": 75072685, "body": "The fastest and most elegant way to iterate backwards is <code>for(i=0;i&lt;N;i++)</code>. Then use <code>something[N-i-1]</code>"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1495049381, "post_id": 44022015, "comment_id": 75093074, "body": "The problem with <code>while(N--)</code> is that very often <code>N</code> will be a constant, or a parameter that was passed into the function and that other code depends on. Pus, it depends on the rather arbitrary (and, in my opinion, idiotic) convention that 0 is considered false and any non-zero value is considered &quot;not false.&quot;"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "edited": false, "score": 0, "creation_date": 1495097232, "post_id": 44022015, "comment_id": 75111509, "body": "I nodded. It should be while(i--)."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1495016184, "creation_date": 1495016184, "answer_id": 44022015, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44022015#44022015", "title": "Correct way to write a pattern in C language", "body": "<p>IO completely dominates this problem. </p>\n\n<p>But the fastest way to iterate forwards is</p>\n\n<pre><code>for(i=0;i&lt;N;i++)\n</code></pre>\n\n<p>and the fastest and most elegant way to iterate backwards is</p>\n\n<pre><code>int i = N;\nwhile(N--)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495019045, "post_id": 44022048, "comment_id": 75072391, "body": "How exactly does this optimize anything? All you did was to make the code more readable."}, {"owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495023403, "post_id": 44022048, "comment_id": 75075464, "body": "less compares per value printed"}], "tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 1, "last_activity_date": 1495016280, "creation_date": 1495016280, "answer_id": 44022048, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44022048#44022048", "title": "Correct way to write a pattern in C language", "body": "<p>Use forloops, minimize code that is repeated</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\n    int lines, flag=1, val;\n\n    for(lines=0;lines&lt;3;lines++)\n    {\n            if(flag == 1)\n                    for(val=1;val&lt;=10;val++)\n                            printf(\"%d \", val);\n            else\n                    for(val=10;val&gt;0;val--)\n                            printf(\"%d \", val);\n            printf(\"\\n\");\n            flag = -flag;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1495016332, "creation_date": 1495016332, "answer_id": 44022069, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44022069#44022069", "title": "Correct way to write a pattern in C language", "body": "<p>You can do this:</p>\n\n<ol>\n<li>Use a for loop that will start from 1 and reach 10. Print its\ncounter.</li>\n<li>Use a for loop that will start from 10 and stop at 1. Print its\ncounter.</li>\n<li>Use a for loop that will start from 1 and reach 10. Print its\ncounter.</li>\n</ol>\n\n<p>Sample code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define LEN 10\n#define ITER 3\n\nint main(void)\n{\n    for(int i = 0; i &lt; ITER; ++i)\n    {\n        if(i % 2)\n            for(int j = 1; j &lt;= LEN; ++j)\n                printf(\"%d \", j);\n        else\n            for(int j = LEN; j &gt;0; --j)\n                printf(\"%d \", j);\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -Wall main.c \nGeorgioss-MacBook-Pro:~ gsamaras$ ./a.out \n10 9 8 7 6 5 4 3 2 1 \n1 2 3 4 5 6 7 8 9 10 \n10 9 8 7 6 5 4 3 2 1 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7646732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGDm3.jpg?s=128&g=1", "display_name": "yogikrathee", "link": "https://stackoverflow.com/users/7646732/yogikrathee"}, "edited": false, "score": 0, "creation_date": 1495017511, "post_id": 44022169, "comment_id": 75071442, "body": "thank you for the deep insight I gained a lot of good points."}], "tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": false, "score": 0, "last_activity_date": 1495016603, "creation_date": 1495016603, "answer_id": 44022169, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44022169#44022169", "title": "Correct way to write a pattern in C language", "body": "<p>There are 2 things to consider.</p>\n\n<p>First is whether the program is optimal or not. Is is quite easy to prove that your program is optimal (at least asymptotically optimal). You need to display 3n numbers, so you need at least 3n iterations. You have 3n iterations, so it's fine. You might be able to further optimize the iterations themselves, but that will arise as an implicit result of the second paragraph.</p>\n\n<p>The second is readability. Your code is a bit verbose and unflexible. Consider the following:</p>\n\n<pre><code>int pattern[] = {1,2,3,4,5,6,7,8,9,10};\nint patternSize = sizeof(pattern)/sizeof(int);\nfor (int i=0; i &lt; 3; i++)\n    for (int j=0; j&lt;patternSize; j++) {\n        if (i % 2)\n            printf(\"%d\", pattern[patternSize - j - 1]);\n        else\n            printf(\"%d\", pattern[i])\n    }\n</code></pre>\n\n<p>The code is shorter and clearer. Also, it is more maintable. It is clear what you have to do to chanelge the pattern. I could hardcode the pattern size as 10, but that would requite 2 changes when you change the pattern. I could generate the pattern, from the value of j, but that would limit the number of patterns that could be shown. </p>\n\n<p>But what if the pattern is all the numbers from 1 to 200? Of course I'm not going to write them by hand. Just replace the array with a for loop that fills up the array. You don't have to change the code that displays the array. This is a small example of separation of concerns - one part of thr code does pattern generation, another part does the display, and they can be modified independently. </p>\n\n<p>While this is asymptotically optimal, there are optimizations that can be made. For examples, using that array to store the pattern is not as efficient as generating the pattern from j. But in practice, unless more efficiency is needed, the advantages of this method outweigh the small performance penalty. </p>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1495019628, "creation_date": 1495019628, "answer_id": 44023261, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language/44023261#44023261", "title": "Correct way to write a pattern in C language", "body": "<p>Okay, here's my take, I think it's more pleasant than most:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    for (int i = 0; i &lt; 3; ++i)\n    {\n        for (int j = 0; j &lt; 10; ++j)\n        {\n            const int v = (i % 2) ? 10 - j : j + 1;\n            printf(\"%d \", v);\n        }\n        putchar('\\n');\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Some points:</p>\n\n<ul>\n<li>Doesn't use an array, instead just generates the very simple pattern from the line number (<code>i</code>) and position (<code>j</code>).</li>\n<li>Not designed for \"pluggable\" patterns by using an array, since the pattern was very simplistic and repeating, that is exploited to simplify the code.</li>\n<li>Re-use the inner loop, rather than duplicating it.</li>\n<li>Prints a linefeed in the proper place, to actually get separate lines (not all posted solutions to that).</li>\n</ul>\n\n<p>The inner loop's body could be shortened to a single line by folding <code>v</code> into the <code>printf()</code> of course, but I aimed for readability and clarity, there.</p>\n"}], "owner": {"reputation": 29, "user_id": 7646732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGDm3.jpg?s=128&g=1", "display_name": "yogikrathee", "link": "https://stackoverflow.com/users/7646732/yogikrathee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "closed_date": 1495021877, "answer_count": 7, "score": 0, "last_activity_date": 1495019628, "creation_date": 1495015441, "last_edit_date": 1495016962, "question_id": 44021697, "link": "https://stackoverflow.com/questions/44021697/correct-way-to-write-a-pattern-in-c-language", "closed_reason": "Not suitable for this site", "title": "Correct way to write a pattern in C language", "body": "<p>I want to obtain the following output:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10\n10 9 8 7 6 5 4 3 2 1\n1 2 3 4 5 6 7 8 9 10\n</code></pre>\n\n<p>The code am running is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int i=1,flag=0,lines=0;  //0 for forward, 1 for reverse\n    while(i!=0 &amp;&amp; lines&lt;3){\n        if(!flag){\n            printf(\"%d \",i);\n            if(i==10){\n                flag=1;\n                printf(\"\\n\");\n                lines++;\n            }\n            else\n                i++;\n        }\n        else if(flag){\n            printf(\"%d \",i);\n            if(i==1){\n                lines++;\n                flag=0;\n                printf(\"\\n\");\n            }\n            else\n                i--;\n         }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Am getting the desired output from the above code but not sure if it's an optimal code. Any other method/suggestion? Considering unlimited space but time complexity should be kept minimum.</p>\n\n<p><strong>Condition</strong>: Use only one loop</p>\n"}, {"tags": ["c", "shell"], "comments": [{"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1495016067, "post_id": 44021472, "comment_id": 75070494, "body": "Why the assembler tag?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1495017340, "post_id": 44021472, "comment_id": 75071321, "body": "You can use probably <code>sed</code>, or other external tool (maybe base64 encoder) to preprocess input .sh files into some <code>const char file_content = &quot;....&quot;;</code>, just create some makefile rule to process the &quot;.sh&quot; files into &quot;.sh_c_str&quot; file, and then <code>#include &quot;script1.sh_c_str&quot;</code> in the source. If you are building the project with GNU make and your own custom Makefile, and you understand how it works... an art which has been sadly long lost and replaced by weird things like Autotools/etc..."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1495026055, "post_id": 44021472, "comment_id": 75077518, "body": "@Ped7g&gt; <a href=\"https://linux.die.net/man/1/xxd\" rel=\"nofollow noreferrer\"><code>xxd -i</code></a> is very convenient for that. You might want to insert a <code>const</code> keyword at the beginning of its output though."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495032969, "post_id": 44021472, "comment_id": 75083105, "body": "@spectras base64 is more dense than hex, and if the goal is obfuscation, I would even go the length to do my own encoding+trivial_encryption (base64 extended alphabet + some trivial scrambler). Then again the OP titled this &quot;hide&quot;, and then he puts plain text into binary, which is confusing. EDIT: oh, now I see what xxd -i does. Still own baseXX alphabet would be more obfuscated."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1495033124, "post_id": 44021472, "comment_id": 75083239, "body": "@Ped7g&gt; actually, it produces binary. It is written as hexadecimal to embed it in C code, but the final symbol actually embedded will be a verbatim copy of the file. Granted, if the goal was obfuscating and not embedding, that&#39;s a miss :)"}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1495018917, "last_edit_date": 1495018917, "creation_date": 1495017925, "answer_id": 44022657, "question_id": 44021472, "link": "https://stackoverflow.com/questions/44021472/c-hide-file-inside-assembler/44022657#44022657", "title": "C hide file inside assembler", "body": "<p>InternetAussie nicely answered the C string literal part already. However, it does not really look better than the macro definition, does it? Trying to have the shell code as array and concatenate the strings would only spare you having to add the newline character, so...</p>\n\n<p>If you are after being able to modify the shell scripts as easily as possible <strong>and</strong> if you are willing to invest some time for initially, then write a shell script translator.</p>\n\n<p>You would then write your shell scripts just as normally, easiest you can get probably, and let the IDE generate C code from them using your translator on every build, if the shell script changed.</p>\n\n<p>Depending on your IDE, you might install a prebuild task, include some makefiles or whatever is offered for.</p>\n\n<p>The C code generated would contain the shell script either as a define (in a header file you could include then) or global a global string constant just as in the already mentioned answer (in a source file).</p>\n\n<p>A sample parser might look like this (incomplete, you yet have to put some hands on; as this is a C question, I provide C code, but you could use anything suitable else, like perl, too):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar const* getCFileName(char const*)\n{\n    return 0; // replace .sh with .c?\n}\nchar const* getVariableName(char const*)\n{\n    return 0; // find appropriate global variable name!\n}\n\nint main(int argc, char* argv[])\n{\n    if (argc &lt; 2)\n        return -1;\n    FILE* in = fopen(argv[1], \"r\");\n    if (!in)\n        return -1;\n    FILE* out = fopen(getCFileName(argv[1]), \"w\");\n    if (!out)\n    {\n        fclose(in);\n        return -1;\n    }\n    // filename possibly given in argv or derived from either argv1/2\n    fprintf(out, \"char const* const %s = \\n\", getVariableName(argv[1]));\n    char buffer[1024];\n    while (fgets(buffer, sizeof(buffer), in))\n    {\n        // escape special characters in buffer: '\\', '\"', ...\n        // replace the terminating newline character with \"\\n\", tabs with \"\\t\", ...\n        fprintf(out, \"    \\\"%s\\\"\\n\", buffer);\n    }\n    fprintf(out, \"%s\", \"    \\\"\\\";\\n\");\n    // (included empty string for the case the file is empty - if so,\n    //  generated C code still is valid...)\n\n    fclose(in);\n    fclose(out);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 6216183, "user_type": "registered", "profile_image": "https://graph.facebook.com/218866255157897/picture?type=large", "display_name": "Roberto Rossi", "link": "https://stackoverflow.com/users/6216183/roberto-rossi"}, "edited": false, "score": 1, "creation_date": 1495036584, "post_id": 44026828, "comment_id": 75085840, "body": "thanks for you info i found a solution with your answer:"}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 0, "last_activity_date": 1495029046, "last_edit_date": 1495540045, "creation_date": 1495029046, "answer_id": 44026828, "question_id": 44021472, "link": "https://stackoverflow.com/questions/44021472/c-hide-file-inside-assembler/44026828#44026828", "title": "C hide file inside assembler", "body": "<p>As suggested by <a href=\"https://stackoverflow.com/users/4271923/ped7g\">Ped7g</a> you can use a tool like <code>base64</code> in order to convert the contents of your script into an in-<a href=\"https://en.wikipedia.org/wiki/Base64\" rel=\"nofollow noreferrer\">Base64</a>-encoded string, so that it contains no characters that need to be escaped inside a C string literal.</p>\n\n<p>Consider the following sample script <code>bash1.sh</code>:</p>\n\n<pre><code>#!/bin/bash\necho hello world\n</code></pre>\n\n<p>You encode its contents by means of <code>base64</code>:</p>\n\n<pre><code>base64 bash1.sh &gt; bash1.base64\n</code></pre>\n\n<p>The in-Base64-encoded contents are:</p>\n\n<pre><code>cat bash1.base64\nIyEvYmluL2Jhc2gKZWNobyBoZWxsbyB3b3JsZAo=\n</code></pre>\n\n<p>After that, you need somehow to \"place the contents of this file into a C string\":</p>\n\n<pre><code>const char *bash1_64 = \"IyEvYmluL2Jhc2gKZWNobyBoZWxsbyB3b3JsZAo=\";\n</code></pre>\n\n<p>You achieve that with the following Perl <i>one-liner</I>:</p>\n\n<pre><code>perl -lne 'print qq&lt;const char * bash1_64 = \"$_\";&gt;' bash1.base64 &gt; bash1.h\n</code></pre>\n\n<p>After that, the header file <code>bash1.h</code> contains the string <code>bash1_64</code>. You can already include this header file in your source files.</p>\n\n<p>The steps shown above could be collected and generalized, for instance, in a <i>Makefile</i> or in a <i>shell script</i>.</p>\n\n<p>From now on, you have to decide how are you going to <strong>decode</strong> the string containing the script to be run:</p>\n\n<ol>\n<li>You could <strong>decode</strong> the contents of this string before passing it to <code>system()</code>.</li>\n<li>You could create a common <I>common</I> shell script which is called by <code>system()</code>. This script takes a string encoded in base64 as an argument, it <strong>decodes</strong> it, and then it run its contents. Decoding a in-base64-encoded string can be easily done inside a shell script by passing the option <code>-d</code> to the <code>base64</code> program.</li>\n</ol>\n"}], "owner": {"reputation": 87, "user_id": 6216183, "user_type": "registered", "profile_image": "https://graph.facebook.com/218866255157897/picture?type=large", "display_name": "Roberto Rossi", "link": "https://stackoverflow.com/users/6216183/roberto-rossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1495029046, "creation_date": 1495014880, "last_edit_date": 1495017973, "question_id": 44021472, "link": "https://stackoverflow.com/questions/44021472/c-hide-file-inside-assembler", "title": "C hide file inside assembler", "body": "<p>I wanna hide same files (bash file (text)) inside my C code then call it at run time atm i do this thing but it is not good cause it is not easy manage all bash code easy i wanna to do something like bash1.sh, bash2.sh, bash3.sh ... inside C code then call it always inside code without use #define cause then it more easy edit .sh files on source.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SHELLSCRIPT \"\\\n#/bin/bash \\n\\\necho \\\"hello\\\" \\n\\\necho \\\"how are you\\\" \\n\\\necho \\\"today\\\" \\n\\\n\"\n/*Also you can write using char array without using MACRO*/\n/*You can do split it with many strings finally concatenate \n  and send to the system(concatenated_string); */\n\nint main()\n{\n    system(SHELLSCRIPT);    //it will run the script inside the c code. \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "enums", "lint", "pc-lint"], "answers": [{"comments": [{"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1523140148, "post_id": 49712069, "comment_id": 86438614, "body": "Hey man - that&#39;s cool, its like a generic pattern match tool - sweet, thanks +1 for that"}], "tags": [], "owner": {"reputation": 612, "user_id": 4137570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4fbdc13b0316d0d2fa1dd0b3847ff3?s=128&d=identicon&r=PG&f=1", "display_name": "Blue", "link": "https://stackoverflow.com/users/4137570/blue"}, "is_accepted": true, "score": 1, "last_activity_date": 1523141333, "last_edit_date": 1523141333, "creation_date": 1523135833, "answer_id": 49712069, "question_id": 44020861, "link": "https://stackoverflow.com/questions/44020861/can-you-get-pc-lint-to-ignore-certain-special-enums-like-myenum-min-and-myenu/49712069#49712069", "title": "Can you get PC Lint to ignore certain special enums like &#39;myenum_min&#39; and &#39;myenum_max&#39;", "body": "<p>PC-Lint does not provide a special command to suppress messages regarding enum <em>values</em>, <strong>BUT</strong> it provides the option <code>-estring(#, string)</code> to suppress a specific error message containing the specified string. This can be used for suppressing specific messages on specific enum values. </p>\n\n<p>For your example this should work:</p>\n\n<pre><code>//lint -estring(788, myenum_max)\n</code></pre>\n\n<h3>Addendum</h3>\n\n<p>The option <code>-estring(#, string)</code> has been introduced with PC-Lint version 9.00.</p>\n"}], "owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 49712069, "answer_count": 1, "score": 0, "last_activity_date": 1523141333, "creation_date": 1495013406, "question_id": 44020861, "link": "https://stackoverflow.com/questions/44020861/can-you-get-pc-lint-to-ignore-certain-special-enums-like-myenum-min-and-myenu", "title": "Can you get PC Lint to ignore certain special enums like &#39;myenum_min&#39; and &#39;myenum_max&#39;", "body": "<p>So given the following code:</p>\n\n<pre><code>typedef enum\n{\n    myenum_a   = 1,\n    myenum_b   = 2,\n    myenum_c   = 3,\n    myenum_max = 4\n}myenum_t;\n</code></pre>\n\n<p>then later</p>\n\n<pre><code>myenum_t test;\n\nswitch (test)\n{\n    case myenum_a:\n    {\n        // do stuff\n    }\n    case myenum_b:\n    {\n        // do stuff\n    }\n    case myenum_c:\n    default:\n    {\n        // do stuff\n    }\n}\n</code></pre>\n\n<p>When I run lint on this I get error 788: \"'myenum_max' not used within defaulted switch\".</p>\n\n<p>I know I can use \"// !e788\" to ignore this rule for this particular switch statement, but that means:</p>\n\n<ul>\n<li>this rule will be ignored for potential valid enums that are missing.</li>\n<li>I have to add this line everywhere I add this kind of switch statement.</li>\n</ul>\n\n<p>Or I can remove the rule entirely with \"// -e788\", but:</p>\n\n<ul>\n<li>Again this rule will be ignored for valid missing enums for ALL types of enums - so even worse.</li>\n</ul>\n\n<p>What I really want, but not sure how to do it (or if it exists) is to ignore the rule for a given enum something like:</p>\n\n<pre><code>typedef enum\n{\n    myenum_a   = 1,\n    myenum_b   = 2,\n    myenum_c   = 3,\n    myenum_max = 4   // !eXXX  - ignore this enum\n}myenum_t;\n</code></pre>\n\n<p>Is that possible?</p>\n"}, {"tags": ["c", "struct", "standards", "typedef"], "comments": [{"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1495013769, "post_id": 44020831, "comment_id": 75068910, "body": "It drops the need to use &#39;struct&#39; everywhere the type is used. The underscore is to prevent name clashes between the non-typedef&#39;ed name and the typedef&#39;ed one"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1495013992, "post_id": 44020831, "comment_id": 75069073, "body": "I don&#39;t think it&#39;s a good idea. A) it&#39;s a standard violation. All identifiers in file scope and tag namespaces starting with an underscore are reserved, B) it unnecessarily litters your global namespace. Unnecessarily, because you can use the same name for your struct tag and for your typedef (<code>typedef struct foo foo;</code>) -- a convention that C++ even built into the language."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1495014063, "post_id": 44020831, "comment_id": 75069130, "body": "&quot;All identifiers in file scope and tag namespaces starting with an underscore are reserved&quot; - U wot? Not quite."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1495014204, "post_id": 44020831, "comment_id": 75069245, "body": "@Bathsheba <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#7.1.3</a> second bulletpoint"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1495014242, "post_id": 44020831, "comment_id": 75069263, "body": "That epitomises why you should never trust anything on the internet ;-)"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1495015576, "post_id": 44020831, "comment_id": 75070148, "body": "Typedeffed names with trailing <code>_t</code> are reserved, so just dont use them in user code."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1495013525, "last_edit_date": 1495535471, "creation_date": 1495013525, "answer_id": 44020908, "question_id": 44020831, "link": "https://stackoverflow.com/questions/44020831/why-to-use-an-underscore-for-a-struct-in-c/44020908#44020908", "title": "why to use an underscore for a struct in c?", "body": "<p>A leading underscore is used for different purposes by every person or team. Read more in this <a href=\"https://stackoverflow.com/a/228797/2411320\">answer</a>, specifically the paragraph that is dedicated to <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a>.</p>\n\n<p>I usually see this:</p>\n\n<pre><code>typedef struct lwm2m_object lwm2m_object_t;\n</code></pre>\n\n<p>where one will append a <code>_t</code> to the struct's name, denoting to the reader that this is a typedef'ef name.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1495013871, "post_id": 44020912, "comment_id": 75068977, "body": "The double underscore convention is abhorrent as well, to be perfectly honest. And many C programmers ignore <i>that</i> as well. Different levels of caring for portability, I suppose."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1495013917, "post_id": 44020912, "comment_id": 75069010, "body": "@StoryTeller: I think that&#39;s naughty as it <i>could</i> clash with macros defined at leisure by the implementation of your C standard library. (I disallow it in my code base.)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1495014086, "post_id": 44020912, "comment_id": 75069155, "body": "The likelihood of clashing with the standard library is no greater than clashing with POSIX, if one looks at it honestly. I highly doubt <code>__mycompany_mymodule_mycomponent_hiddenfeature</code> will clash with anything in the standard library."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1495014459, "post_id": 44020912, "comment_id": 75069421, "body": "That&#39;s an interesting perspective. For me you should <i>never</i> write code that is undefined by standard C. But, facetiously, idealisms emanating from the likes of POSIX and MISRA can be treated as advisory, or passed over as being the musings of a pedant."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1495014596, "post_id": 44020912, "comment_id": 75069518, "body": "True. But the root cause for these prohibitions is the same. Those standards want to future-proof user code. And while I completely agree with you on the leading double underscore, I find it completely arbitrary to disregard POSIX (if one <i>is</i> building or may build for a POSIX system). Adhering to such conventions to begin with can make certain transitions smoother. So, perhaps they are not quite so pedantic. Just my 2 pennies worth opinion."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1495013853, "last_edit_date": 1495013853, "creation_date": 1495013531, "answer_id": 44020912, "question_id": 44020831, "link": "https://stackoverflow.com/questions/44020831/why-to-use-an-underscore-for-a-struct-in-c/44020912#44020912", "title": "why to use an underscore for a struct in c?", "body": "<p>Writing <code>typedef struct _lwm2m_object_t lwm2m_object_t;</code> means that you don't need to write the more verbose <code>struct _lwm2m_object_t</code> when you want to refer to the <code>struct</code> type, but you can use <code>lwm2m_object_t</code> directly instead. It saves typing and can make source code clearer.</p>\n\n<p>Prefixing the actual <code>struct</code> name with a single <code>_</code> is a convention that's grown up over the years. And many folk use <code>_t</code> as a suffix to denote a <em>type</em>.</p>\n\n<p>But a few things to note:</p>\n\n<ol>\n<li><p>Don't ever use a <em>double</em> underscore, as formally the behaviour on doing that is undefined.</p></li>\n<li><p>Don't start a type with a single underscore followed by a capital letter. Again, such type names are reserved.</p></li>\n<li><p>POSIX explicitly forbids your ending your own type with <code>_t</code>, but note that <em>standard</em> C allows it.</p></li>\n</ol>\n\n<p>Many experienced C programmers find (3) abhorrent and ignore it. (I do.)</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1495013987, "post_id": 44021095, "comment_id": 75069069, "body": "Perhaps include a link to what MISRA is?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1495014537, "post_id": 44021095, "comment_id": 75069469, "body": "I couldn&#39;t resist. Added a citation, and have an upvote."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1550848524, "post_id": 44021095, "comment_id": 96434998, "body": "It also causes the header file to fail if included from C++."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 6, "last_activity_date": 1495014522, "last_edit_date": 1495540490, "creation_date": 1495013959, "answer_id": 44021095, "question_id": 44020831, "link": "https://stackoverflow.com/questions/44020831/why-to-use-an-underscore-for-a-struct-in-c/44021095#44021095", "title": "why to use an underscore for a struct in c?", "body": "<p>Actually if you use </p>\n\n<pre><code>typedef struct lwm2m_object_t lwm2m_object_t;\n\nstruct lwm2m_object_t {\n//\n}\n</code></pre>\n\n<p>It will still be allowed by C. This is because the structure names and the typedef identifiers have different namespaces. Please see <a href=\"https://stackoverflow.com/questions/4396140/why-doesnt-ansi-c-have-namespaces\">Why doesn&#39;t ANSI C have namespaces?</a> for information about namespaces in C.</p>\n\n<p>However, many professional users avoid this and use different names for structures and typedefs. MISRA<sup>1</sup> also disallows this.  </p>\n\n<blockquote>\n  <p>Rule 5.6 (advisory): No identifier in one name space should have the same spelling as an identifier in another name space, with the exception of\n  structure member and union member names. [MISRA C 2004]</p>\n</blockquote>\n\n<p>The use of underscore is just a convention that some people follow. You can follow other conventions, e.g.</p>\n\n<pre><code>typedef struct sTag_lwm2m_object_t lwm2m_object_t;\n\nstruct sTag_lwm2m_object_t {\n//\n}\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> <a href=\"https://en.wikipedia.org/wiki/MISRA_C\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/MISRA_C</a></p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1495020430, "creation_date": 1495020430, "answer_id": 44023544, "question_id": 44020831, "link": "https://stackoverflow.com/questions/44020831/why-to-use-an-underscore-for-a-struct-in-c/44023544#44023544", "title": "why to use an underscore for a struct in c?", "body": "<p>By itself, the leading underscore has no intrinsic meaning, it just creates a distinct identifier for the tag name vs. the typedef name.  You could achieve the same result with</p>\n\n<pre><code>typedef struct foo fooType;\n</code></pre>\n\n<p>Tag names occupy a different namespace from ordinary identifiers, so you can write</p>\n\n<pre><code>typedef struct foo foo;\n</code></pre>\n\n<p>which some people consider confusing.  I don't - the tag name is disambiguated by the presence of the <code>struct</code> (or <code>union</code> or <code>enum</code>) keyword.  </p>\n\n<p>You should <em>not</em> use leading underscores in your identifiers - identifiers with two leading underscores or a leading underscore followed by a capital letter are always reserved for the implementation for any use, while identifiers with a single leading underscore are reserved in the ordinary and tag name spaces.</p>\n\n<p>You could use a trailing underscore for the same effect</p>\n\n<pre><code>typedef struct foo_ foo;\n</code></pre>\n\n<p>and satisfy everybody.</p>\n"}], "owner": {"reputation": 67, "user_id": 5065678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03599bf4c3c9a50b8f28f86c3b3e031d?s=128&d=identicon&r=PG&f=1", "display_name": "riverrock", "link": "https://stackoverflow.com/users/5065678/riverrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3427, "favorite_count": 1, "accepted_answer_id": 44021095, "answer_count": 4, "score": 0, "last_activity_date": 1550962663, "creation_date": 1495013326, "last_edit_date": 1550962663, "question_id": 44020831, "link": "https://stackoverflow.com/questions/44020831/why-to-use-an-underscore-for-a-struct-in-c", "title": "why to use an underscore for a struct in c?", "body": "<p>In the source code below, could somebody explain the rational (why is it good programming practice to <code>typedef</code> the struct <code>_lwm2m_object_t</code> with the new name <code>lwm2m_object_t</code>? All it does is drop the underscore? Why is an underscore used in the first instance?</p>\n\n<pre><code>typedef struct _lwm2m_object_t lwm2m_object_t;\n\ntypedef uint8_t (*lwm2m_read_callback_t) (lwm2m_uri_t * uriP, char ** bufferP, int * lengthP, lwm2m_object_t * objectP);\ntypedef uint8_t (*lwm2m_write_callback_t) (lwm2m_uri_t * uriP, char * buffer, int length, lwm2m_object_t * objectP);\ntypedef uint8_t (*lwm2m_execute_callback_t) (lwm2m_uri_t * uriP, char * buffer, int length, lwm2m_object_t * objectP);\ntypedef uint8_t (*lwm2m_create_callback_t) (lwm2m_uri_t * uriP, char * buffer, int length, lwm2m_object_t * objectP);\ntypedef uint8_t (*lwm2m_delete_callback_t) (uint16_t id, lwm2m_object_t * objectP);\ntypedef void (*lwm2m_close_callback_t) (lwm2m_object_t * objectP);\n\n\nstruct _lwm2m_object_t\n{\n    uint16_t                 objID;\n    lwm2m_list_t *           instanceList;\n    lwm2m_read_callback_t    readFunc;\n    lwm2m_write_callback_t   writeFunc;\n    lwm2m_execute_callback_t executeFunc;\n    lwm2m_create_callback_t  createFunc;\n    lwm2m_delete_callback_t  deleteFunc;\n    lwm2m_close_callback_t   closeFunc;\n    void *                   userData;\n};\n</code></pre>\n"}, {"tags": ["html", "c", "linux", "perl", "shell"], "comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495013344, "post_id": 44020658, "comment_id": 75068623, "body": "That depends on how you want to transfer. Given like this, a simple ZIP archive seems to do the job in a pretty portable way."}, {"owner": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495014248, "post_id": 44020658, "comment_id": 75069266, "body": "does it means that zip all the 20 files, then send it through email?"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495014876, "post_id": 44020658, "comment_id": 75069700, "body": "Or whatever other exchange means you have. With no more information on your environment it&#39;s hard to tell. You could push it to an SMB share, upload it through FTP, pipe it through the network... For all we know you could be talking about the to OS on the same system so you could just copy over the zip file to a common partition before rebooting."}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 3807678, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100000301923853/picture?type=large", "display_name": "codelyzer", "link": "https://stackoverflow.com/users/3807678/codelyzer"}, "is_accepted": false, "score": -2, "last_activity_date": 1495014870, "creation_date": 1495014870, "answer_id": 44021465, "question_id": 44020658, "link": "https://stackoverflow.com/questions/44020658/how-do-i-transfer-20-html-files-from-linux-to-windows-in-a-single-csh-perl-pyth/44021465#44021465", "title": "How do i transfer 20 .html files from Linux to Windows in a single csh/perl/python script?", "body": "<p>You can use smtp library in python and send an email with multiple attachments. All you have to do is get all your files into your python script by using directory modules and then simply send an email. </p>\n\n<p>Here is a link to the tutorial on how to send emails using python:</p>\n\n<p><a href=\"http://naelshiab.com/tutorial-send-email-python/\" rel=\"nofollow noreferrer\">http://naelshiab.com/tutorial-send-email-python/</a></p>\n"}, {"tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1495025054, "creation_date": 1495025054, "answer_id": 44025251, "question_id": 44020658, "link": "https://stackoverflow.com/questions/44020658/how-do-i-transfer-20-html-files-from-linux-to-windows-in-a-single-csh-perl-pyth/44025251#44025251", "title": "How do i transfer 20 .html files from Linux to Windows in a single csh/perl/python script?", "body": "<p>Stick 'tar' in front:</p>\n\n<pre><code>tar cvfz - ./path_to_files | uuencode stuff.tar.gz | mail -s \"attachmentname\" email@yahoo.com\n</code></pre>\n\n<p><code>-</code> 'prints' the <code>tar</code> to STDOUT and thus fed into uuencode. And gzips it, which might save some space. (You could probably use <code>zip</code> instead I'd imagine if zip files are easier to handle)</p>\n"}], "owner": {"reputation": 45, "user_id": 7892746, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/41310627d746b07402b15829c958043e?s=128&d=identicon&r=PG&f=1", "display_name": "mmaz", "link": "https://stackoverflow.com/users/7892746/mmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1495025054, "creation_date": 1495012951, "question_id": 44020658, "link": "https://stackoverflow.com/questions/44020658/how-do-i-transfer-20-html-files-from-linux-to-windows-in-a-single-csh-perl-pyth", "title": "How do i transfer 20 .html files from Linux to Windows in a single csh/perl/python script?", "body": "<p>I am working on getting multiple .html files from Linux environment to Windows. For now, the easiest way that I've been using is uuencode command. </p>\n\n<p>However, since I have 20 .html files, I used two .csh files as only 10 files can run at a time. If I combine all 20.html files, it will return error: Too many arguments. This may be due to the long directories of each .html files.</p>\n\n<p>For example, this is the uuencode commands that I used in Lintowin.csh for 10 .html files:</p>\n\n<pre><code>(uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_A/output_A/summary.html A.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_B/output_B/summary.html B.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_C/output_C/summary.html C.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_D/output_D/summary.html D.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_E/output_E/summary.html E.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_F/output_F/summary.html F.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_G/output_G/summary.html G.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_H/output_H/summary.html H.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_I/output_I/summary.html I.xls;uuencode /main/fileno/no1/user/username/mainproject/projectname/division/parts/sub/16_april/fullreport/part_report/report_J/output_J/summary.html J.xls) | \\mail -s \"attachmentname\" email@yahoo.com\n</code></pre>\n\n<p>The format is \n(uuencode file_path file_format_in_Windows) | \\mail -s \"attachment name\" receiver_email</p>\n\n<p>Is there any way on how I can fix this and make it more simpler since I need to automate this action. Is there any way I can use perl script or other command so that i can transfer all 20 .html files at a time?</p>\n"}, {"tags": ["c", "x11", "xlib"], "answers": [{"comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1495015021, "post_id": 44021348, "comment_id": 75069775, "body": "Wow. I did not read it that way but it&#39;s pretty plausible. I&#39;ll try to locate the relevant code in Xlib to check that."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 2, "creation_date": 1495015249, "post_id": 44021348, "comment_id": 75069926, "body": "You&#39;re right. The 8/16/32 values are just used in a switch and mapped to <code>sizeof(char)</code>/<code>sizeof(short)</code>/<code>sizeof(long)</code>. <a href=\"https://github.com/mirror/libX11/blob/master/src/GetProp.c#L107\" rel=\"nofollow noreferrer\">Here</a>. So they do not match their respective type&#39;s actual size."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1495037641, "post_id": 44021348, "comment_id": 75086518, "body": "Worth noting that on the wire, it&#39;s still actually 32 bits. The value gets zero-extended to an unsigned long by XGetWindowProperty."}], "tags": [], "owner": {"reputation": 34412, "user_id": 4862445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppXKM.jpg?s=128&g=1", "display_name": "Richard Smith", "link": "https://stackoverflow.com/users/4862445/richard-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1495014624, "creation_date": 1495014624, "answer_id": 44021348, "question_id": 44020616, "link": "https://stackoverflow.com/questions/44020616/correct-size-of-window-type-for-xgetwindowproperty/44021348#44021348", "title": "Correct size of Window type for XGetWindowProperty", "body": "<p>The documentation (XGetWindowProperty(3)) states that:</p>\n\n<blockquote>\n  <p>If the specified format is 32, the property data must be a long array.</p>\n</blockquote>\n\n<p>The include file shows <code>Window</code> as a typedef to <code>XID</code> which is a typedef to <code>unsigned long</code>.</p>\n\n<p>I would guess that the use of 32 is an anachronism and used to mean 32-bits, but now means whatever your compiler chooses to use for <code>unsigned long</code>.</p>\n"}], "owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 44021348, "answer_count": 1, "score": 2, "last_activity_date": 1495014624, "creation_date": 1495012842, "last_edit_date": 1495013240, "question_id": 44020616, "link": "https://stackoverflow.com/questions/44020616/correct-size-of-window-type-for-xgetwindowproperty", "title": "Correct size of Window type for XGetWindowProperty", "body": "<p>I am reading the <code>_NET_ACTIVE_WINDOW</code> atom from the root window, using this code:</p>\n\n<pre><code>Atom actualType;\nint actualFormat;\nunsigned long nItems, bytesAfter;\nunsigned char * value;\n\nif (XGetWindowProperty(display, window, atom, 0, LONG_MAX / 4,\n                       False, XA_WINDOW,\n                       &amp;actualType, &amp;actualFormat,\n                       &amp;nItems, &amp;bytesAfter, &amp;value) != Success ||\n    actualType != XA_WINDOW) {\n    return NULL;\n}\n\nWindow result = *(Window*)value;    /*  &lt;=== this line seems dubious */\nXFree(value);\nreturn result;\n</code></pre>\n\n<p>However, although it works, I am pretty sure it is bugged, because adding a few printfs shows that:</p>\n\n<ul>\n<li><code>sizeof(Window)</code> is 8</li>\n<li><code>actualFormat</code> is 32</li>\n<li><code>nItems</code> is 1</li>\n</ul>\n\n<p>Therefore, according to the documentation, the buffer allocated for the property is 4 bytes long. Reading a Window from it is a blatant overflow.</p>\n\n<p>So what's the deal with that? Is there some flags I miss to make <code>Window</code> only 4 bytes? Should I read the value as an <code>uint32_t</code> and cast it to <code>Window</code> after? Anything else?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 8, "creation_date": 1495011256, "post_id": 44020006, "comment_id": 75067123, "body": "Why don&#39;t you try them and find out?"}, {"owner": {"reputation": 79, "user_id": 7573035, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7429ade83b35dde073d05ed04d5ce48a?s=128&d=identicon&r=PG&f=1", "display_name": "sociopath", "link": "https://stackoverflow.com/users/7573035/sociopath"}, "edited": false, "score": 0, "creation_date": 1495011317, "post_id": 44020006, "comment_id": 75067163, "body": "@InternetAussie i tried x++,it is illegal.wanted the explanation"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1495011346, "post_id": 44020006, "comment_id": 75067189, "body": "Make that your question then!"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1495011387, "post_id": 44020006, "comment_id": 75067224, "body": "x is an <i>array</i> so you can&#39;t increment it, there is no * operator for <i>arrays</i>, but you can add 1 as your array decays to pointer and gives you access to pointer arithmetic."}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1495011415, "post_id": 44020006, "comment_id": 75067245, "body": "GCC gives an error :         error: lvalue required as increment operand             x++;"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1495011477, "post_id": 44020006, "comment_id": 75067288, "body": "@Jean-BaptisteYun&#232;s <i>as your array decays to pointer</i> - where?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1495012278, "post_id": 44020006, "comment_id": 75067855, "body": "Well, while the particular question is worded poorly, the query <i>may</i> have some merit. Not all the books define/describe these tricky things in detailed and understandable way. Just my two cents."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1495012301, "post_id": 44020006, "comment_id": 75067864, "body": "@KeineLust as an operand of <code>+</code>."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1495012552, "post_id": 44020006, "comment_id": 75068056, "body": "@KeineLust in <code>x+1</code>"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1495012812, "post_id": 44020006, "comment_id": 75068259, "body": "@Jean-BaptisteYun&#232;s , Quentin , I see ... decays but do nothing with the result, is a NOOP isn&#39;t it?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "edited": false, "score": 0, "creation_date": 1495013258, "post_id": 44020006, "comment_id": 75068566, "body": "Hello sir @YuHao, is there a particular reason you reverted my rollback?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1495013260, "post_id": 44020006, "comment_id": 75068567, "body": "@SouravGhosh not quite sure why the tag &quot;multiplication&quot; is necessary here."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1495013314, "post_id": 44020006, "comment_id": 75068598, "body": "@MichaelWalz Probably because, the properties of multiplication operand is in discussion here? I&#39;m open to suggestions, thought. :)"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1495018372, "post_id": 44020006, "comment_id": 75071975, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1641957/is-an-array-name-a-pointer-in-c\">Is an array name a pointer in C?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1495012080, "last_edit_date": 1495012080, "creation_date": 1495011723, "answer_id": 44020191, "question_id": 44020006, "link": "https://stackoverflow.com/questions/44020006/why-are-the-following-array-operations-illegal/44020191#44020191", "title": "Why are the following array operations illegal?", "body": "<p>Here, <code>x</code> is an <strong>array</strong> and you cannot modify the address of an array. It is illegal in C.</p>\n\n<p><strong>GCC</strong> compiler gives an error : </p>\n\n<pre><code> In function 'main':\n5:5: error: lvalue required as increment operand\n    x++;\n     ^\n7:5: error: invalid operands to binary * (have 'int *' and 'int')\n    x*2;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1495013062, "last_edit_date": 1495013062, "creation_date": 1495012056, "answer_id": 44020315, "question_id": 44020006, "link": "https://stackoverflow.com/questions/44020006/why-are-the-following-array-operations-illegal/44020315#44020315", "title": "Why are the following array operations illegal?", "body": "<p>Actually, you need to understand <strong>how and when</strong> the operators are allowed. Let's see one by one.</p>\n\n<p>Quoting from <code>C11</code>, </p>\n\n<ul>\n<li><p><strong><em><code>++</code>, Postfix increment,  chapter \u00a76.5.2.3</em></strong></p>\n\n<blockquote>\n  <p>The operand of the postfix increment or decrement operator shall have atomic, qualified,\n  or unqualified real or pointer type, and shall be a modifiable lvalue. </p>\n</blockquote></li>\n<li><p><strong><em><code>+</code>, Additive operator, chapter \u00a76.5.6</em></strong></p>\n\n<blockquote>\n  <p>For addition, either both operands shall have arithmetic type, or one operand shall be a\n  pointer to a complete object type and the other shall have integer type. (Incrementing is\n  equivalent to adding 1.)</p>\n</blockquote></li>\n<li><p><strong><em><code>*</code>, Multiplicative operator, chapter \u00a76.5.5</em></strong></p>\n\n<blockquote>\n  <p>Each of the operands shall have arithmetic type. [...]</p>\n</blockquote></li>\n</ul>\n\n<p>Now, in your usage</p>\n\n<ul>\n<li><code>x++;</code> --> <code>x</code> is not a modifiable lvalue, it is of \"array type\". This causes error.</li>\n<li><code>x+1;</code> --> Satisfies the requirement <sup>see notes for array decay</sup>, hence valid.</li>\n<li><code>x*2</code>; --> <code>x</code> is not arithmetic type (its'a <em>pointer type</em>), hence invalid.</li>\n</ul>\n\n<hr>\n\n<p><em>Additional notes:</em> (all emphasis mine)</p>\n\n<ul>\n<li><p>\"Modifiable lvalue:\"</p>\n\n<p>Quoting chapter \u00a76.3.2.1,</p>\n\n<blockquote>\n  <p>An lvalue is an expression (with an object type other than void) that potentially\n  designates an object; [...] A <strong>modifiable lvalue</strong> is an lvalue that\n  <strong>does not have array type</strong>, does not have an incomplete type, does not have a const-qualified\n  type, and if it is a structure or union, does not have any member (including,\n  recursively, any member or element of all contained aggregates or unions) with a const-qualified\n  type.</p>\n</blockquote></li>\n<li><p>\"Arithmetic Type:\"</p>\n\n<p>Quoting \u00a76.2.5,</p>\n\n<blockquote>\n  <p>Integer and floating types are collectively called arithmetic types. [...]</p>\n</blockquote></li>\n<li><p>\"Array decay:\"</p>\n\n<p>Quoting \u00a76.3.2.1, </p>\n\n<blockquote>\n  <p>Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator, or the\n  unary <code>&amp;</code> operator, or is a string literal used to initialize an array, <strong>an expression that has\n  type <em>\u2018\u2018array of type\u2019\u2019</em> is converted to an expression with type <em>\u2018\u2018pointer to type\u2019\u2019</em> that points\n  to the initial element of the array object and is not an lvalue.</strong> [...]</p>\n</blockquote></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1495012492, "creation_date": 1495012492, "answer_id": 44020484, "question_id": 44020006, "link": "https://stackoverflow.com/questions/44020006/why-are-the-following-array-operations-illegal/44020484#44020484", "title": "Why are the following array operations illegal?", "body": "<p>Among these three statements</p>\n\n<pre><code>x++;\nx+1; \nx*2;\n</code></pre>\n\n<p>there is only two statements are illegal. This statement</p>\n\n<pre><code>x+1; \n</code></pre>\n\n<p>is correct. In this case in the expression the array designator is converted to pointer to its first element.</p>\n\n<p>Multiplicative operators are not defined for pointers. So this statement</p>\n\n<pre><code>x*2;\n</code></pre>\n\n<p>is illegal.</p>\n\n<p>Arrays are non-modifiable lvalues.  You may not change an array designator. So this statement</p>\n\n<pre><code>x++;\n</code></pre>\n\n<p>is illegal.</p>\n"}], "owner": {"reputation": 79, "user_id": 7573035, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7429ade83b35dde073d05ed04d5ce48a?s=128&d=identicon&r=PG&f=1", "display_name": "sociopath", "link": "https://stackoverflow.com/users/7573035/sociopath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1925, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1495018373, "creation_date": 1495011202, "last_edit_date": 1495013193, "question_id": 44020006, "link": "https://stackoverflow.com/questions/44020006/why-are-the-following-array-operations-illegal", "title": "Why are the following array operations illegal?", "body": "<p>The expressions <code>x++;</code> and <code>x*2;</code> are reported as <em>illegal</em>. Compiler generates error. However, in case of <code>x+1;</code> there's no error reported.</p>\n\n<p>Can anyone help me understand why the particular expressions are illegal? Or, in other way, why the addition is legal?</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{ \n   int x[]={1,2,3,4,5};\n   x++;\n   x+1; \n   x*2;\n}    \n</code></pre>\n"}, {"tags": ["c", "bitwise-operators"], "comments": [{"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 2, "creation_date": 1495010763, "post_id": 44019819, "comment_id": 75066757, "body": "Um, hash*32+hash is the same as hash*(32+1) mathematically..."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1495010879, "post_id": 44019819, "comment_id": 75066834, "body": "I mean you figured that hash&lt;&lt;5 is the same as hash*32. Now you have hash*32+hash. Let hash be a common factor. It thus becomes hash*(32+1) or hash*33"}, {"owner": {"reputation": 1847, "user_id": 7472819, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb0617488be4fabf9b2a7f50b85fe7f1?s=128&d=identicon&r=PG&f=1", "display_name": "D. Mika", "link": "https://stackoverflow.com/users/7472819/d-mika"}, "edited": false, "score": 2, "creation_date": 1495010893, "post_id": 44019819, "comment_id": 75066846, "body": "Mathematically X * 32 + X = X * 33. No magic."}, {"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "reply_to_user": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1495010905, "post_id": 44019819, "comment_id": 75066861, "body": "@PaulStelian where is  <code>hash</code> changing to become  1"}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 1, "creation_date": 1495011008, "post_id": 44019819, "comment_id": 75066930, "body": "Well hash == hash*1? I think basic arithmetic may need to be studied again..."}, {"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 1, "creation_date": 1495011060, "post_id": 44019819, "comment_id": 75066978, "body": "Is it not clear that if you have 32 hashes and add another 1 has you have 33 hashes?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495011211, "post_id": 44019819, "comment_id": 75067088, "body": "@CholthiPaulTtiopic-- you are aware that <code>hash&lt;&lt;5</code> does not change the value of <code>hash</code>, but merely evaluates to the result?"}, {"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "reply_to_user": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1495011284, "post_id": 44019819, "comment_id": 75067141, "body": "@PaulStelian sorry  if the question sounds stupid, but I am thinking of <code>hash</code> as a variable with a value of 5381 in the above expression, so I am thinking this,<code>5381*32+5381</code>"}, {"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495011316, "post_id": 44019819, "comment_id": 75067160, "body": "@DavidBowling Yes, I am aware"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 3, "creation_date": 1495011403, "post_id": 44019819, "comment_id": 75067235, "body": "BTW it is crucial that you write <code>(hash &lt;&lt; 5) + hash</code> and do not &quot;shorten&quot; it to <code>hash &lt;&lt; 5 + hash</code>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1495013083, "post_id": 44019819, "comment_id": 75068439, "body": "You do know that <code>2 + 2 + 2 = 3*2</code>, right? What is <code>2 + 2 + 2 + 2</code>? What then is <code>3 * 2 + 2</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1495011923, "post_id": 44019996, "comment_id": 75067583, "body": "Is this addition and multiplication rule only, I never came across before"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "reply_to_user": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 1, "creation_date": 1495012464, "post_id": 44019996, "comment_id": 75067986, "body": "@CholthiPaulTtiopic That is the distributive law. You can learn a bit about it <a href=\"https://www.mathsisfun.com/associative-commutative-distributive.html\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1495012736, "post_id": 44019996, "comment_id": 75068196, "body": "Thanks. I now get it. I think is about to brush up my maths"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "is_accepted": true, "score": 2, "last_activity_date": 1495011184, "creation_date": 1495011184, "answer_id": 44019996, "question_id": 44019819, "link": "https://stackoverflow.com/questions/44019819/c-confused-about-bitwise-shift-operation/44019996#44019996", "title": "C confused about bitwise shift operation", "body": "<p>This is less to do with C, and more to do with mathematics.</p>\n\n<blockquote>\n  <p>The hash &lt;&lt; 5 + hash expression is the same as hash * 32 + hash or just hash * 33.</p>\n</blockquote>\n\n<p>Basic algebra states these things are true (these are written in C):</p>\n\n<pre><code>/* #1 */ (a * b + a * c) == (a * (b + c))\n/* #2 */ (a) == (a * 1)\n</code></pre>\n\n<p>Applying #2, we can say:</p>\n\n<pre><code>(hash * 32 + hash) == (hash * 32 + hash * 1)\n</code></pre>\n\n<p>Now applying #1, we can find:</p>\n\n<pre><code>(hash * 32 + hash * 1) == (hash * (32 + 1))\n</code></pre>\n\n<p>This can be reduced to:</p>\n\n<pre><code>hash * 33\n</code></pre>\n\n<p>This is basic mathematics, but maybe you are tired or overworked and just can't see how this works :)</p>\n"}], "owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44019996, "answer_count": 1, "score": -7, "last_activity_date": 1495011284, "creation_date": 1495010671, "last_edit_date": 1495010938, "question_id": 44019819, "link": "https://stackoverflow.com/questions/44019819/c-confused-about-bitwise-shift-operation", "title": "C confused about bitwise shift operation", "body": "<p>In a book I am reading, there is a hash function shown below</p>\n\n<pre><code>static inline ulong zend_inline_hash_func(const char *arKey, uint nKeyLength)\n{\n    register ulong hash = 5381;\n\n    for (uint i = 0; i &lt; nKeyLength; ++i) {\n        hash = ((hash &lt;&lt; 5) + hash) + arKey[i];\n    }\n    return hash;\n}\n</code></pre>\n\n<blockquote>\n  <p>The <code>hash &lt;&lt; 5 + hash</code> expression is the same as <code>hash * 32 + hash</code> or just <code>hash * 33</code>.</p>\n</blockquote>\n\n<p>I understand why <code>hash &lt;&lt; 5 + hash</code> is the same as <code>hash * 32 + hash</code>, but how it become <code>hash * 33</code> is the what I dont understand.\nI tried to reason that <code>hash * 32</code> overflows and wraps to become modulo 2^n operation, but clearly that's not because a) the <code>hash</code> is of type <code>ulong</code>\nwhich is big enough to hold the results of <code>hash *32</code> expression. b) even <code>unint</code> is still big to overflow by the multiplication in question\nCan someone with more C knowledge help me out with a simple explanation and maybe even point out the source of my confusion.\nThank yoou.</p>\n"}, {"tags": ["c", "sockets", "segmentation-fault"], "comments": [{"owner": {"reputation": 1, "user_id": 8024152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2297f64938374be7bd0f2468eaa140c7?s=128&d=identicon&r=PG&f=1", "display_name": "SNG", "link": "https://stackoverflow.com/users/8024152/sng"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1495010740, "post_id": 44019634, "comment_id": 75066735, "body": "int e = tcp_passive_open(&amp;server,port);"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1495014276, "post_id": 44019634, "comment_id": 75069281, "body": "<code>tcpsock_t * s = tcp_sock_create();</code>  What does that return?  The <i>exact</i> value.  Post the cope for <code>tcp_sock_create()</code> and the definition of <code>tcpsock_t</code>.  How do you declare <code>tcp_sock_create()</code>?"}, {"owner": {"reputation": 1, "user_id": 8024152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2297f64938374be7bd0f2468eaa140c7?s=128&d=identicon&r=PG&f=1", "display_name": "SNG", "link": "https://stackoverflow.com/users/8024152/sng"}, "edited": false, "score": 0, "creation_date": 1495014741, "post_id": 44019634, "comment_id": 75069606, "body": "just added them in the post"}], "owner": {"reputation": 1, "user_id": 8024152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2297f64938374be7bd0f2468eaa140c7?s=128&d=identicon&r=PG&f=1", "display_name": "SNG", "link": "https://stackoverflow.com/users/8024152/sng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495014674, "creation_date": 1495010167, "last_edit_date": 1495014674, "question_id": 44019634, "link": "https://stackoverflow.com/questions/44019634/c-segfault-when-calling-socket", "title": "c: Segfault when calling socket()", "body": "<p>I am trying to finish an assignment for school. The goal is to create a connections manager to create and manage sockets. We received a file (tcpsock.c) from the professor, but I keep getting a segfault when calling one of the functions. \nThis are all the includes/variables that are used.</p>\n\n<pre><code>#define _GNU_SOURCE \n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt; \n#include &lt;arpa/inet.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;assert.h&gt;\n\n#include \"tcpsock.h\"\n\n//#define DEBUG\n\n#ifdef DEBUG\n#define TCP_DEBUG_PRINTF(condition,...)                                 \\\n    do {                                                \\\n       if((condition))                                      \\\n       {                                                \\\n        fprintf(stderr,\"\\nIn %s - function %s at line %d: \", __FILE__,     __func__, __LINE__); \\\n        fprintf(stderr,__VA_ARGS__);                                \\\n       }                                                \\\n    } while(0)                      \n#else\n#define TCP_DEBUG_PRINTF(...) (void)0\n#endif\n\n\n#define TCP_ERR_HANDLER(condition,...)  \\\ndo {                        \\\n    if ((condition))            \\\n    {                   \\\n      TCP_DEBUG_PRINTF(1,\"error condition \\\"\" #condition \"\\\" is true\\n\");   \\\n      __VA_ARGS__;              \\\n    }                   \\\n} while(0)\n\n\n#define MAGIC_COOKIE    (long)(0xA2E1CF37D35)   // used to check if a socket is bounded\n\n#define CHAR_IP_ADDR_LENGTH 16      // 4 numbers of 3 digits, 3 dots and \\0\n#define PROTOCOLFAMILY  AF_INET     // internet protocol suite\n#define TYPE        SOCK_STREAM // streaming protool type\n#define PROTOCOL    IPPROTO_TCP     // TCP protocol \n\nstruct tcpsock {\n  long cookie;      // if the socket is bound, cookie should be equal to MAGIC_COOKIE\n        // remark: the use of magic cookies doesn't guarantee a 'bullet proof' test\n  int sd;       // socket descriptor\n  char * ip_addr;   // socket IP address\n  int port;         // socket port number\n  } ;   \n</code></pre>\n\n<p>typedef struct tcpsock tcpsock_t;</p>\n\n<p>static tcpsock_t * tcp_sock_create();  </p>\n\n<p>Whenever calling the function tcp_passive_open, I always get a segfault.</p>\n\n<pre><code>int tcp_passive_open(tcpsock_t ** sock, int port)\n{\n  int result;\n  struct sockaddr_in addr;\n  TCP_ERR_HANDLER(((port&lt;MIN_PORT)||(port&gt;MAX_PORT)), return TCP_ADDRESS_ERROR);  \n  tcpsock_t * s = tcp_sock_create();\n  TCP_ERR_HANDLER(s==NULL,return TCP_MEMORY_ERROR); \n  //printf(\"%p\\n\",s); printf(\"%d\\n\",s-&gt;sd); \n  s-&gt;sd = socket(PROTOCOLFAMILY, TYPE, PROTOCOL);\n  TCP_DEBUG_PRINTF(s-&gt;sd&lt;0,\"Socket() failed with errno = %d [%s]\", errno, strerror(errno));\n  TCP_ERR_HANDLER(s-&gt;sd&lt;0,free(s);return TCP_SOCKOP_ERROR); \n  // Construct the server address structure \n  memset(&amp;addr, 0, sizeof(struct sockaddr_in));\n  addr.sin_family = PROTOCOLFAMILY;\n  addr.sin_addr.s_addr = htonl(INADDR_ANY);\n  addr.sin_port = htons(port);\n  result = bind(s-&gt;sd,(struct sockaddr *)&amp;addr,sizeof(addr));\n  TCP_DEBUG_PRINTF(result==-1,\"Bind() failed with errno = %d [%s]\", errno, strerror(errno));\n  TCP_ERR_HANDLER(result!=0,free(s);return TCP_SOCKOP_ERROR);   \n  result = listen(s-&gt;sd,MAX_PENDING);\n  TCP_DEBUG_PRINTF(result==-1,\"Listen() failed with errno = %d [%s]\", errno, strerror(errno));\n  TCP_ERR_HANDLER(result!=0,free(s);return TCP_SOCKOP_ERROR);  \n  s-&gt;ip_addr = NULL; // address set to INADDR_ANY - not a specific IP address\n  s-&gt;port = port;\n  s-&gt;cookie = MAGIC_COOKIE; \n  *sock = s;\n  return TCP_NO_ERROR;  \n}\n</code></pre>\n\n<p>When running the debugger, it appears the segfault happens at the following line:</p>\n\n<pre><code>s-&gt;sd = socket(PROTOCOLFAMILY, TYPE, PROTOCOL);\n</code></pre>\n\n<p>It is the socket function that generates the segfault (I checked s->sd by printing it, and it does that without any problems.)\nThis code works fine with everyone, except with me. Does anyone has an idea why it gives a segmentation fault?</p>\n\n<p>The function is called by using:</p>\n\n<pre><code>tcpsock_t * server;\nint main( void )\n{\n    conmgr_listen(1234);\n    return 0;\n}\n\nvoid conmgr_listen(int port)\n{\n    int e = tcp_passive_open(&amp;server,port);\n}\n</code></pre>\n\n<p>The function 'tcp_sock_crreate()':</p>\n\n<pre><code>static tcpsock_t * tcp_sock_create()\n{\n  tcpsock_t * s = (tcpsock_t *) malloc(sizeof(tcpsock_t));\n  if (s) // init the socket to default values\n  {\n    s-&gt;cookie = 0;  // socket is not yet bound!\n    s-&gt;port = -1;\n    s-&gt;ip_addr = NULL; \n    s-&gt;sd = -1;\n  }\n  return s;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "typedef"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1495009397, "post_id": 44019322, "comment_id": 75065734, "body": "<i>Is this an array of pointers of type lwm2m_object_t?</i>.... Yes, with 9 items"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1495009467, "post_id": 44019322, "comment_id": 75065785, "body": "Surely <code>lwm2m_object_t</code> is <code>typedef</code>ed somewhere: included headers most probably"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1495009495, "post_id": 44019322, "comment_id": 75065805, "body": "<code>lwm2m_object_t</code> is not defined here. There would be a separate <code>typedef</code> for <code>lwm2m_object_t</code> somewhere else in the code."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1495009627, "post_id": 44019322, "comment_id": 75065904, "body": "It is <code>typedef</code>ed in <a href=\"https://github.com/01org/liblwm2m/blob/master/core/liblwm2m.h#L210\" rel=\"nofollow noreferrer\">liblwm2m.h</a>"}, {"owner": {"reputation": 301, "user_id": 8020705, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/41237e3aa506f0b25f5d0009e2a16572?s=128&d=identicon&r=PG&f=1", "display_name": "artic sol", "link": "https://stackoverflow.com/users/8020705/artic-sol"}, "edited": false, "score": 0, "creation_date": 1495010560, "post_id": 44019322, "comment_id": 75066602, "body": "Many thanks for your help , a basic question I know."}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 9, "last_activity_date": 1495287090, "last_edit_date": 1495287090, "creation_date": 1495009624, "answer_id": 44019435, "question_id": 44019322, "link": "https://stackoverflow.com/questions/44019322/c-creating-a-new-type-without-typedef/44019435#44019435", "title": "c creating a new type without typedef", "body": "<p>The following:</p>\n\n<pre><code>lwm2m_object_t * objArray[OBJ_COUNT];\n</code></pre>\n\n<p>declares an <i>array of pointers to</i> <code>lwm2m_object_t</code>.</p>\n\n<p>The type <code>lwm2m_object_t</code> is for sure somewhere else defined in the source code.</p>\n\n<p>Most probably in library header <a href=\"https://github.com/01org/liblwm2m/blob/master/core/liblwm2m.h#L210\" rel=\"nofollow noreferrer\">liblwm2m.h</a>.</p>\n"}], "owner": {"reputation": 301, "user_id": 8020705, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/41237e3aa506f0b25f5d0009e2a16572?s=128&d=identicon&r=PG&f=1", "display_name": "artic sol", "link": "https://stackoverflow.com/users/8020705/artic-sol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 44019435, "answer_count": 1, "score": 2, "last_activity_date": 1495287090, "creation_date": 1495009323, "question_id": 44019322, "link": "https://stackoverflow.com/questions/44019322/c-creating-a-new-type-without-typedef", "title": "c creating a new type without typedef", "body": "<p>I'm reading some c source code and the there is a new type called 'lwm2m_object_t' defined using this syntax. </p>\n\n<pre><code>#define OBJ_COUNT (9)\nlwm2m_object_t * objArray[OBJ_COUNT]; \n</code></pre>\n\n<p>Could somebody explain how you can define a type like this? Do you not have to use <code>typedef</code>? </p>\n\n<p>Is this an array of pointers of type <code>lwm2m_object_t</code>? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "tcp"], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 0, "last_activity_date": 1495012386, "creation_date": 1495012386, "answer_id": 44020447, "question_id": 44019127, "link": "https://stackoverflow.com/questions/44019127/tcp-let-server-close-connection-first-on-let-client-close-connection-first/44020447#44020447", "title": "TCP let server close connection first on let client close connection first", "body": "<blockquote>\n  <p>If server close connection after handling the request and writing back the response, there must be too many connections in CLOSE_WAIT status.</p>\n</blockquote>\n\n<p>No, but there will be a lot of TIME_WAIT states.</p>\n\n<blockquote>\n  <p>If let client close connection first, there might be too many active connections in server side if the client doesn't close them.</p>\n</blockquote>\n\n<p>So the server should use a read timeout.</p>\n\n<p>In general it's best for the server to be the one that receives the first close. That way the TIME_WAIT states pile up at the clients, not the server, and the clients won't have a lot of connections so it isn't any kind of a problem.</p>\n"}], "owner": {"reputation": 207, "user_id": 7966659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f76a65146284bf1113f7b8650a2e189?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/7966659/howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 44020447, "answer_count": 1, "score": 0, "last_activity_date": 1495012386, "creation_date": 1495008759, "last_edit_date": 1495009199, "question_id": 44019127, "link": "https://stackoverflow.com/questions/44019127/tcp-let-server-close-connection-first-on-let-client-close-connection-first", "title": "TCP let server close connection first on let client close connection first", "body": "<p>Suppose this is a simple stateless server.  </p>\n\n<ol>\n<li><p>If server close connection after handling the request and writing back the response, there must be too many connections in <code>CLOSE_WAIT</code> status.  </p></li>\n<li><p>If let client close connection first, there might be too many active connections in server side if the client doesn't close them.  </p></li>\n</ol>\n\n<p>Then how to handle this situation? Should I use 1 or 2 or other?</p>\n"}, {"tags": ["c", "file", "fork"], "comments": [{"owner": {"reputation": 1856, "user_id": 3221630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda71e95543a97a0b8c75f79bdc1df62?s=128&d=identicon&r=PG&f=1", "display_name": "arboreal84", "link": "https://stackoverflow.com/users/3221630/arboreal84"}, "edited": false, "score": 1, "creation_date": 1495008076, "post_id": 44018786, "comment_id": 75064905, "body": "I would recommend you to pick a language, be it Spanish or English. This mixture doesn&#39;t seem a good practice."}, {"owner": {"reputation": 620, "user_id": 6395331, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206324456173490/picture?type=large", "display_name": "Riccardo Bonafede", "link": "https://stackoverflow.com/users/6395331/riccardo-bonafede"}, "edited": false, "score": 0, "creation_date": 1495008644, "post_id": 44018786, "comment_id": 75065265, "body": "what is the problem?"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 1, "creation_date": 1495008805, "post_id": 44018786, "comment_id": 75065359, "body": "I would recommend reading from one file, whilst updating another, and then when finished, delete the original file and rename the new one.  What you are doing is almost guaranteed to fail in bizarre ways,"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1495008863, "post_id": 44018786, "comment_id": 75065393, "body": "How would you propose to replace say <code>9</code> in a text file with <code>10</code> by &quot;inserting&quot;? From where do you acquire another byte?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1495009199, "post_id": 44019197, "comment_id": 75065613, "body": "what is <code>getline()</code> and where is it in your snippet?"}, {"owner": {"reputation": 11, "user_id": 8024013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec12b977689db2c7d1e87979c69dca5?s=128&d=identicon&r=PG&f=1", "display_name": "llinasenc", "link": "https://stackoverflow.com/users/8024013/llinasenc"}, "edited": false, "score": 0, "creation_date": 1495009408, "post_id": 44019197, "comment_id": 75065740, "body": "The problem is that, as is an exercisei should do, I have to follow the rules that have been given. And this implies using open function."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1495009541, "post_id": 44019197, "comment_id": 75065828, "body": "@FelixPalmen Oh, yeah, sorry. Fixed"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 11, "user_id": 8024013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec12b977689db2c7d1e87979c69dca5?s=128&d=identicon&r=PG&f=1", "display_name": "llinasenc", "link": "https://stackoverflow.com/users/8024013/llinasenc"}, "edited": false, "score": 0, "creation_date": 1495009846, "post_id": 44019197, "comment_id": 75066037, "body": "@llinasenc So you are forced to use open read and write system functions even if every function manipulating files uses them indirectly ?"}], "tags": [], "owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "is_accepted": false, "score": 0, "last_activity_date": 1495009474, "last_edit_date": 1495535472, "creation_date": 1495008965, "answer_id": 44019197, "question_id": 44018786, "link": "https://stackoverflow.com/questions/44018786/how-to-read-a-file-and-compare-values-in-c/44019197#44019197", "title": "How to read a file and compare values in C?", "body": "<p>The best way to iterate through a file is to use the function <code>getline()</code>. Here is an example of its utilisation, taken from <a href=\"https://stackoverflow.com/questions/9206091/going-through-a-text-file-line-by-line-in-c\">this post</a> which I advise you read.</p>\n\n<pre><code>char const* const fileName = \"best_teams.txt\" ; // \nFILE* file = fopen(fileName, \"r\"); /* should check the result */\nif (file != NULL) {\n\n    char line[256];\n    while (getline(line, sizeof(line), file)) { // Each iteration, a line will be stored in string `line`\n           // Do what you want to do\n   } // Exits when arrives at the end of the file\nelse puts(\"Error while opening file\\n\");\n</code></pre>\n\n<p>As suggested in the comments, you can then use <code>fopen(\"best_teams.txt\", \"w\")</code>\nThe \"w\" means write mode, which is described as follow in <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fopen.htm\" rel=\"nofollow noreferrer\">fopen documentation</a> : </p>\n\n<blockquote>\n  <p>Creates an empty file for writing. If a file with the same name already exists, its content is erased and the file is considered as a new empty file.</p>\n</blockquote>\n\n<p>Another solution is to open in read and write mode, and to only change the values you desire, but it might be more complicated.</p>\n"}], "owner": {"reputation": 11, "user_id": 8024013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec12b977689db2c7d1e87979c69dca5?s=128&d=identicon&r=PG&f=1", "display_name": "llinasenc", "link": "https://stackoverflow.com/users/8024013/llinasenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495009474, "creation_date": 1495007700, "last_edit_date": 1495007743, "question_id": 44018786, "link": "https://stackoverflow.com/questions/44018786/how-to-read-a-file-and-compare-values-in-c", "title": "How to read a file and compare values in C?", "body": "<p>I need to know how could I read a file with values in different lines, and compare it with values I have in memory, to get wich line has a better score, and if values in memory are best, insert those values into the file (the file is open as read and as write at the same time, as this part of code could be run from several fork() at the same time): </p>\n\n<pre><code>if (PuntuacioEquip(jugadors)&gt;MaxPuntuacio &amp;&amp; CostEquip(jugadors)&lt;PresupostFitxatges)\n    {\n\n        //Compare with file\n        int fd, n;\n        TBestEquip info;\n\n        fd = open(\"best_teams.txt\", O_RDONLY);\n        if (fd&lt;0) panic(\"open\");\n\n        while ((n=read(fd, &amp;info, sizeof(info))) == sizeof(info)) {\n            //printf(cad,\"equip %lld, puntuacio %d\\n\", info.Equip, info.Puntuacio);\n            //write(1,cad,strlen(cad));\n            if (info.Puntuacio&gt;PuntuacioEquip(jugadors))\n                {\n                    fd = open(\"best_teams.txt\", O_WRDONLY|O_TRUNC|O_CREAT,0600);\n                    if (fd&lt;0) panic(\"open\");\n                    sprintf(cad,\"%s Cost: %d  Points: %d. %s\\n\", CostEquip(jugadors), PuntuacioEquip(jugadors));\n                    write(fd,cad,strlen(cad));\n                }\n        }\n\n\n        // We have a new partial optimal team.\n        MaxPuntuacio=PuntuacioEquip(jugadors);\n        memcpy(MillorEquip,&amp;jugadors,sizeof(TJugadorsEquip));\n        sprintf(cad,\"%s Cost: %d  Points: %d. %s\\n\", color_green, CostEquip(jugadors), PuntuacioEquip(jugadors), end_color);\n        write(1,cad,strlen(cad));\n\n\n    }\n</code></pre>\n\n<p>Appreciate any help.</p>\n\n<p>Regards,</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1495007960, "post_id": 44018554, "comment_id": 75064826, "body": "<i>... and outright dangerous to use for other purposes</i>, is not dangerous if you don&#39;t assume that <code>EXIT_FAILURE == 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8023640, "user_type": "registered", "profile_image": "https://graph.facebook.com/719319668247898/picture?type=large", "display_name": "Daniel Ericsson", "link": "https://stackoverflow.com/users/8023640/daniel-ericsson"}, "edited": false, "score": 0, "creation_date": 1495022893, "post_id": 44018747, "comment_id": 75075091, "body": "Thank you for good summary with references. I agree and believe we can make a decision based on this."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1495008332, "last_edit_date": 1495008332, "creation_date": 1495007577, "answer_id": 44018747, "question_id": 44018554, "link": "https://stackoverflow.com/questions/44018554/using-exit-success-failure-as-api-return-value/44018747#44018747", "title": "Using EXIT_SUCCESS/FAILURE as API return value", "body": "<p>From 7.22 regarding macros in stdlib.h:</p>\n\n<blockquote>\n  <p>EXIT_FAILURE<br>\n  and<br>\n  EXIT_SUCCESS  </p>\n  \n  <p>which expand to integer constant expressions that can be used as the argument to the exit function to return unsuccessful or successful termination status, respectively, to the host environment;</p>\n</blockquote>\n\n<p>This is what these macros are for. If your function is returning status to the host environment, then using these macros is fine. To use them for any other purpose would be bad practice, since that is not their intended use.</p>\n\n<p>Please note that the caller of a library is not \"the host environment\" (the OS). Using these macros as return codes from a library, that will be used by other programmers, is bad practice, since that is not how the macros were intended to be used. It is not <em>dangerous</em> to use them, but it is sloppy and very confusing.</p>\n\n<p>Similarly it is often considered sloppy to have a function just return true/false upon success/error, as that gives no additional error information.</p>\n\n<blockquote>\n  <p>To define and use own return values would be considered \"overdesign\". </p>\n</blockquote>\n\n<p>This is how you implement professional libraries. The de facto industry standard is to use a library-specific enum type corresponding to all possible errors that can occur, then let every single API function return that error type. This makes it much easier for the caller to write error handling. Each function needs to document all possible return codes.</p>\n"}], "owner": {"reputation": 11, "user_id": 8023640, "user_type": "registered", "profile_image": "https://graph.facebook.com/719319668247898/picture?type=large", "display_name": "Daniel Ericsson", "link": "https://stackoverflow.com/users/8023640/daniel-ericsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495008332, "creation_date": 1495006987, "question_id": 44018554, "link": "https://stackoverflow.com/questions/44018554/using-exit-success-failure-as-api-return-value", "title": "Using EXIT_SUCCESS/FAILURE as API return value", "body": "<p>Can it be considered reasonable, good design and good practice to use EXIT_SUCCESS and EXIT_FAILURE as return values from functions in your own library API?</p>\n\n<p>The example software is a low level platform library used in several products of the same product line for a large number of compilers and target platforms. The dev team is split on this issue. A few developers consider it good practice to reuse the defined values from EXIT_SUCCESS and EXIT_FAILURE as return values in internal functions and in the library API to signal success or failure status from the library call. To define and use own return values would be considered \"overdesign\". </p>\n\n<p>Other team members consider EXIT_SUCCESS and EXIT_FAILURE as explicitly designed for use together with the exit() function, and outright dangerous to use for other purposes. </p>\n\n<p>What is your take on this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495006948, "post_id": 44018515, "comment_id": 75064201, "body": "Question: How do you plan to break out of the <code>while(1)</code> loop?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495007040, "post_id": 44018515, "comment_id": 75064263, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 3, "user_id": 3887675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c12bc60dcf2a6f89300751303963a8?s=128&d=identicon&r=PG&f=1", "display_name": "You", "link": "https://stackoverflow.com/users/3887675/you"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495007104, "post_id": 44018515, "comment_id": 75064308, "body": "@SouravGhosh The program is not finished yet... I will add break :D :D"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1495007104, "post_id": 44018515, "comment_id": 75064309, "body": "If <code>in_length &gt; out_length</code> the code <code>snow[i] += input[i];</code> access <code>snow</code> out of bounds."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495007201, "post_id": 44018515, "comment_id": 75064371, "body": "<code>out[((tmp *= (i + 1)) % out_length + out_length) % out_length] += input[i];</code>..seriously?? and you expect <b><i>people</i></b> to read your code?"}, {"owner": {"reputation": 3, "user_id": 3887675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c12bc60dcf2a6f89300751303963a8?s=128&d=identicon&r=PG&f=1", "display_name": "You", "link": "https://stackoverflow.com/users/3887675/you"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495007338, "post_id": 44018515, "comment_id": 75064447, "body": "@SouravGhosh Oh... Sorry T.T I didn&#39;t think it..."}, {"owner": {"reputation": 3, "user_id": 3887675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c12bc60dcf2a6f89300751303963a8?s=128&d=identicon&r=PG&f=1", "display_name": "You", "link": "https://stackoverflow.com/users/3887675/you"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1495007457, "post_id": 44018515, "comment_id": 75064518, "body": "@LPs omg... I can&#39;t understand why I haven&#39;t seen it... Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1495007250, "post_id": 44018631, "comment_id": 75064401, "body": "With all due respect, this is more suitable as a comment."}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1495008207, "post_id": 44018631, "comment_id": 75064981, "body": "@SouravGhosh It&#39;s too long for a comment and it answers the question. As you mentioned yourself - was anybody expected to actually read that code?"}], "tags": [], "owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "is_accepted": true, "score": 0, "last_activity_date": 1495007216, "creation_date": 1495007216, "answer_id": 44018631, "question_id": 44018515, "link": "https://stackoverflow.com/questions/44018515/c-error-on-free/44018631#44018631", "title": "C - Error on free()?", "body": "<p>Without debugging the exact place where it happens -> at some point you're writing before/after the memory you allocated. This overwrites the allocation metadata which doesn't affect your program while it's running, but when you try to free the memory, you'll find garbage and crash.</p>\n\n<p>If you were running linux I'd recommend trying <code>valgrind</code> to debug this, but apparently there are some Windows options as well: <a href=\"https://stackoverflow.com/questions/413477/is-there-a-good-valgrind-substitute-for-windows\">Is there a good Valgrind substitute for Windows?</a></p>\n\n<p>Basically you want something which will error out the moment you write out of bounds, not when you try to read it back.</p>\n"}, {"tags": [], "owner": {"reputation": 789, "user_id": 7868795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/471c6f01b994a5aadf85dc6cfec40fc4?s=128&d=identicon&r=PG", "display_name": "Ra&#39;Jiska", "link": "https://stackoverflow.com/users/7868795/rajiska"}, "is_accepted": false, "score": 0, "last_activity_date": 1495008379, "creation_date": 1495008379, "answer_id": 44019006, "question_id": 44018515, "link": "https://stackoverflow.com/questions/44018515/c-error-on-free/44019006#44019006", "title": "C - Error on free()?", "body": "<p>The issue comes from the insufficient malloc'd <code>snow</code> buffer.\nYou malloc it the size out_length (<code>char *snow = (char *)malloc(sizeof(char) * out_length);</code>).</p>\n\n<p>Though you loop over it with in_length (wich is up to 1024 while out_length is 64):</p>\n\n<pre><code>for (i = 0; i &lt; in_length; i++)\n{\n    out[((tmp *= (i + 1)) % out_length + out_length) % out_length] += input[i];\n    snow[i] += input[i];\n    for (j = 0; j &lt; out_length; j++)\n    {\n        out[((i + j) % out_length + out_length) % out_length] += snow[j] % (i + 1);\n    }\n}\n</code></pre>\n\n<p>At the third line of this block, when i > 64, you get a memory error most likely causing a memory corruption making your program crash at <code>free()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1495009259, "creation_date": 1495009259, "answer_id": 44019306, "question_id": 44018515, "link": "https://stackoverflow.com/questions/44018515/c-error-on-free/44019306#44019306", "title": "C - Error on free()?", "body": "<p>As pointed by the comments above, there would be a greater possibility that <code>in_length > out_length</code>. Which also supports your facts that it will crash for very long strings.</p>\n\n<p>So with that, you may want to support increasing the size of <code>snow</code> via realloc prior to <code>for (i = 0; i &lt; in_length; i++)</code></p>\n\n<pre><code>if (in_length &gt; out_length) {\n    int additional_bytes =  in_length - out_length;\n    snow = realloc(snow, sizeof(char) * (out_length + additional_bytes));\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3887675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c12bc60dcf2a6f89300751303963a8?s=128&d=identicon&r=PG&f=1", "display_name": "You", "link": "https://stackoverflow.com/users/3887675/you"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 44018631, "answer_count": 3, "score": -1, "last_activity_date": 1495009259, "creation_date": 1495006869, "last_edit_date": 1495007007, "question_id": 44018515, "link": "https://stackoverflow.com/questions/44018515/c-error-on-free", "title": "C - Error on free()?", "body": "<p>I am making some hash function.</p>\n\n<p>It's source code is ...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint m_hash(char *input, size_t in_length, char *output, size_t out_length);\n\nint main()\n{\n    char buffer[1025];\n    char output[65];\n    output[64] = '\\0';\n    while(1)\n    {\n        printf(\"enter what will hash : \");\n        fgets(buffer, 1024, stdin);\n        buffer[1024] = '\\0';\n        m_hash(buffer, strlen(buffer), output, 64);\n        printf(\"your string (hashed) : %s\\n\", output);\n    }\n    return 0;\n}\n\nint m_hash(char *input, size_t in_length, char *output, size_t out_length) // 0 on Success, 1 on Fail.\n{\n    const char OUT[64] = \"zxcvbnmasdfghjklqwertyuiopZXCVBNMASDFGHJKLQWERTYUIOP1234567890_-\";\n    char *snow = (char *)malloc(sizeof(char) * out_length);\n    if (snow == NULL) return 1;\n    int *out = (int *)malloc(sizeof(int) * out_length);\n    if (out == NULL)\n    {\n        free(snow);\n        return 1;\n    }\n    memset(out, 0x00, sizeof(int) * out_length);\n    size_t tmp = 0, i, j;\n    for (i = 0; i &lt; out_length; i++)\n    {\n        tmp += i * i;\n        snow[i] = tmp / (i + 1);\n        tmp -= snow[i];\n    }\n    for (i = 0; i &lt; in_length; i++)\n    {\n        out[((tmp *= (i + 1)) % out_length + out_length) % out_length] += input[i];\n        snow[i] += input[i];\n        for (j = 0; j &lt; out_length; j++)\n        {\n            out[((i + j) % out_length + out_length) % out_length] += snow[j] % (i + 1);\n        }\n    }\nprintf(\"Will free snow.\\n\");\n    free(snow); // ERROR WTF?\nprintf(\"Freed snow.\\n\");\n    for (i = 0; i &lt; out_length; i++)\n    {\n        output[i] = OUT[(out[i] % 64 + 64) % 64];\n    }\n    free(out);\n    return 0;\n}\n</code></pre>\n\n<p>When I enter short string, there is no error. But when I enter long string like this...\n<a href=\"https://i.stack.imgur.com/QQ536.png\" rel=\"nofollow noreferrer\">It's seems to free() makes error...</a>\nThere is error on 'free(snow);'?!?!!</p>\n\n<p>Visual studio's debug message is...\n    HEAP CORRUPTION DETECTED: after Normal block (#92) at 0x01505D08.\n    CRT detected that the application wrote to memory after end of heap buffer.</p>\n\n<p>I really don't know what's wrong with this...</p>\n\n<p>What's wrong...? \u3160.\u315c</p>\n"}, {"tags": ["c", "gcc", "shared-libraries"], "answers": [{"tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": true, "score": 3, "last_activity_date": 1495006552, "creation_date": 1495006552, "answer_id": 44018417, "question_id": 44018349, "link": "https://stackoverflow.com/questions/44018349/when-i-make-a-shared-library-a-error-occur/44018417#44018417", "title": "When I make a shared library, a error occur", "body": "<p>You need to compile <code>output.c</code> as position independent code.</p>\n\n<p><code>gcc -c -fPIC output.c</code></p>\n\n<p>In the first version you have not called any library function. But in second one <code>printf</code> is being called. In general, compile all sources with <code>-fPIC</code> if you intend to build a shared library later.</p>\n"}], "owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "accepted_answer_id": 44018417, "answer_count": 1, "score": 1, "last_activity_date": 1495006552, "creation_date": 1495006344, "question_id": 44018349, "link": "https://stackoverflow.com/questions/44018349/when-i-make-a-shared-library-a-error-occur", "title": "When I make a shared library, a error occur", "body": "<p>I made a shared library as the follow:</p>\n\n<ol>\n<li><code>gcc -c output.c</code></li>\n<li><code>gcc -shared -fPIC -o liboutput.so output.o</code></li>\n</ol>\n\n<p>When output.c is the follow, it could work.</p>\n\n<pre><code>//#include \"output.h\"\n#include &lt;stdio.h&gt;\n\nint output(const char* st) {\n    return 1+2;\n}\n</code></pre>\n\n<p>But, when output.c changed as the follow, a error occur.</p>\n\n<pre><code>//#include \"output.h\"\n#include &lt;stdio.h&gt;\n\nint output(const char* st) {\n    printf(\"%s\\n\", st);\n    return 1+2;\n}\n</code></pre>\n\n<p>This is error message:</p>\n\n<blockquote>\n  <p>/usr/bin/ld: output.o: relocation R_X86_64_PC32 against undefined \u7b26\u53f7 `puts@@GLIBC_2.2.5' can not be used when making a shared object; recompile with -fPIC\n  /usr/bin/ld: \u6700\u540e\u7684\u94fe\u7ed3\u5931\u8d25: \u9519\u8bef\u7684\u503c\n  collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p>I want to know why and how to deal it. Thanks in advance.</p>\n"}, {"tags": ["c", "fifo", "mkfifo"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1495005753, "post_id": 44017907, "comment_id": 75063485, "body": "Hmmm... so you have a function that checks to see if a string contains only alphanumeric characters, then you have a function that prints only the alphanumeric characters of that string? Does the input string contain a <code>\\n</code>?"}, {"owner": {"reputation": 43, "user_id": 7991137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d102d3a7555975fea82dceedaa9b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Popa", "link": "https://stackoverflow.com/users/7991137/maria-popa"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495005861, "post_id": 44017907, "comment_id": 75063560, "body": "in the main before I check I put to the string a &#39;\\0&#39; at the end"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495005926, "post_id": 44017907, "comment_id": 75063606, "body": "Also, this sort of thing is not portable: <code>if (*str &gt;= &#39;A&#39; &amp;&amp; *str &lt;= &#39;Z&#39;)</code>. C makes few restrictions on character set encoding. Some real-world encodings, EBCDIC for example, do not encode letters in a contiguous sequence, causing this method to fail. Not that this is your problem, though."}, {"owner": {"reputation": 43, "user_id": 7991137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d102d3a7555975fea82dceedaa9b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Popa", "link": "https://stackoverflow.com/users/7991137/maria-popa"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495006212, "post_id": 44017907, "comment_id": 75063774, "body": "while (1) \t{ \t\twhile ((len = read(0, buf, BUFF_SIZE))) \t\t{ \t\t \t\t\tbuf[len] = &#39;\\0&#39;; \t\t\twrite(fd, buf, len); \t\t} \t}   This is the way I read from input characters"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495006227, "post_id": 44017907, "comment_id": 75063782, "body": "I think that @DavidBowling got the point: your buffer contains non alfanum chars, most probably a  <code>\\n</code> (<code>0x0a</code>) or space (<code>0x020</code>)"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495006322, "post_id": 44017907, "comment_id": 75063831, "body": "You read <code>BUFF_SIZE</code> characters, but is the string that you read actually of length <code>BUFF_SIZE</code>? What does the input look like?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1495006397, "post_id": 44017907, "comment_id": 75063876, "body": "BTW you should post the input data (file content)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495006464, "post_id": 44017907, "comment_id": 75063925, "body": "@DavidBowling That doesn&#39;t matter. OP is terminating the string with read returned length."}, {"owner": {"reputation": 43, "user_id": 7991137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d102d3a7555975fea82dceedaa9b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Popa", "link": "https://stackoverflow.com/users/7991137/maria-popa"}, "edited": false, "score": 2, "creation_date": 1495006574, "post_id": 44017907, "comment_id": 75063985, "body": "It works now, that was the problem with \\n . Thank you very much!"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495006685, "post_id": 44017907, "comment_id": 75064052, "body": "@DavidBowling You should post the answer then ;)"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1495007873, "post_id": 44017907, "comment_id": 75064765, "body": "@LPs-- I would, but it still feels like any answer I wrote would be a guess since the nature of the input is still unknown. If OP is reading <code>BUFF_SIZE</code> characters, and input line lengths vary, then the resulting strings may be garbled if <code>\\n</code> is simply replaced with <code>\\0</code>. I may be missing something; feel free to post an answer if you have more clarity."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 7991137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d102d3a7555975fea82dceedaa9b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Popa", "link": "https://stackoverflow.com/users/7991137/maria-popa"}, "is_accepted": true, "score": 0, "last_activity_date": 1495558442, "creation_date": 1495558442, "answer_id": 44140814, "question_id": 44017907, "link": "https://stackoverflow.com/questions/44017907/how-to-use-correctly-isalnum-function-in-c/44140814#44140814", "title": "How to use correctly isalnum function in C?", "body": "<p>The Input text contains '\\n' and that means that the string is not an alphanumeric string. When I read I push the enter button and that means one more character in the string.</p>\n"}], "owner": {"reputation": 43, "user_id": 7991137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d102d3a7555975fea82dceedaa9b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Popa", "link": "https://stackoverflow.com/users/7991137/maria-popa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 44140814, "answer_count": 1, "score": 3, "last_activity_date": 1495558442, "creation_date": 1495004965, "question_id": 44017907, "link": "https://stackoverflow.com/questions/44017907/how-to-use-correctly-isalnum-function-in-c", "title": "How to use correctly isalnum function in C?", "body": "<p>I tried to check if a character of a string is alnum and then if the string contains only alnum characters to print the string. When I run the program nothing happens. I have another program with whom I read from the input the text I want and I send it with FIFO. If i don;t include in the program the \"check\" function it works, after that it doesn't. </p>\n\n<pre><code>void    put_alphanum(char *str)\n{\nwhile (*str)\n{\n    if (*str &gt;= '0' &amp;&amp; *str &lt;= '9')\n        write(1, str, 1);\n    else if (*str &gt;= 'A' &amp;&amp; *str &lt;= 'Z')\n        write(1, str, 1);\n    else if (*str &gt;= 'a' &amp;&amp; *str &lt;= 'z')\n        write(1, str, 1);\n    str++;\n}\nwrite(1,\"\\n\",1);\n}\n</code></pre>\n\n<p>This is the function I used to print the string. If I don't put it together with the check function the program works.</p>\n\n<pre><code>int check(char *str)\n{\n\nwhile(*str)\n{\nif(isalnum(*str)==0)\nreturn 0;\n\nstr++;\n}\n\nreturn 1;\n\n}\n</code></pre>\n\n<p>This is the function I use to check if a string contains just alnum characters. But if I don;t include this function in my program, the program works. I think here is the problem. And the main function()</p>\n\n<pre><code>int     main()\n{\nint fd;\nint len;\nchar buf[BUFF_SIZE + 1];\n\nmkfifo(FIFO_LOC, 0666);\nfd = open(FIFO_LOC, O_RDONLY);\nwhile(1)\n{\n    while((len = read(fd, buf, BUFF_SIZE)))\n    {\n        buf[len] = '\\0';\n        if(check(buf)==1)\n             put_alphanum(buf);\n\n    }\n}\nreturn (0);\n}\n</code></pre>\n"}, {"tags": ["c", "delphi", "linker", "32bit-64bit", "delphi-10-seattle"], "comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1495010176, "post_id": 44017189, "comment_id": 75066296, "body": "Shameless plug of my article: <a href=\"http://rvelthuis.de/articles/articles-cobjs.html\" rel=\"nofollow noreferrer\">rvelthuis.de/articles/articles-cobjs.html</a> That should explain it. And no, you can&#39;t use 32 bit obj files in a 64 bit program. The article also shows how to handle the unsatisfied forwards."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1495010602, "post_id": 44017189, "comment_id": 75066634, "body": "FWIW, try to add the unit System.Win.Crtl (Note: C-R-T-L, not C-T-R-L) to your code. That should take care of many of the unsatisfied forwards."}, {"owner": {"reputation": 1371, "user_id": 3110262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/575e4d7de1acb0f07b60f9b79957e8aa?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/3110262/a-b"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1495011292, "post_id": 44017189, "comment_id": 75067147, "body": "This is my next question <a href=\"http://stackoverflow.com/q/44020038/3110262\">stackoverflow.com/q/44020038/3110262</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32928, "user_id": 576719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/27654f2f0143bebd759912c4b6f5a379?s=128&d=identicon&r=PG", "display_name": "LU RD", "link": "https://stackoverflow.com/users/576719/lu-rd"}, "reply_to_user": {"reputation": 141, "user_id": 6244350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf0cdb97e5413140dfa5157ccc0e798?s=128&d=identicon&r=PG&f=1", "display_name": "stackmik", "link": "https://stackoverflow.com/users/6244350/stackmik"}, "edited": false, "score": 0, "creation_date": 1563645403, "post_id": 44017450, "comment_id": 100771236, "body": "As said in both my and @David&#39;s answer, use a 64-bit compiler to create a 64-bit .obj file."}], "tags": [], "owner": {"reputation": 32928, "user_id": 576719, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/27654f2f0143bebd759912c4b6f5a379?s=128&d=identicon&r=PG", "display_name": "LU RD", "link": "https://stackoverflow.com/users/576719/lu-rd"}, "is_accepted": false, "score": 2, "last_activity_date": 1495003488, "creation_date": 1495003488, "answer_id": 44017450, "question_id": 44017189, "link": "https://stackoverflow.com/questions/44017189/e2045-bad-object-file-formatxxx-obj/44017450#44017450", "title": "E2045 Bad object file Format:&quot;XXX.obj&quot;", "body": "<p>Yes you need to convert those <code>.obj</code> files to 64 bit.</p>\n\n<p><a href=\"http://docwiki.embarcadero.com/RADStudio/en/Converting_32-bit_Delphi_Applications_to_64-bit_Windows#Other_Minor_Issues_to_Resolve\" rel=\"nofollow noreferrer\">Converting 32-bit Delphi Applications to 64-bit Windows</a> states:</p>\n\n<blockquote>\n  <ul>\n  <li><strong>64-bit External .obj Files</strong>: If you expect your 64-bit Windows application to link to an external .obj file, keep in mind that you will need a 64-bit version of the .obj file to link with a 64-bit Windows application.</li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1371, "user_id": 3110262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/575e4d7de1acb0f07b60f9b79957e8aa?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/3110262/a-b"}, "edited": false, "score": 0, "creation_date": 1495004018, "post_id": 44017486, "comment_id": 75062370, "body": "I have created a 64 bit obj file using Visual C++ Express. But no luck. I am getting the same error for the obj file."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 1371, "user_id": 3110262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/575e4d7de1acb0f07b60f9b79957e8aa?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/3110262/a-b"}, "edited": false, "score": 0, "creation_date": 1495004485, "post_id": 44017486, "comment_id": 75062688, "body": "Clearly you have some wrong objects lying around. Note that the error that is reported is for an object not in your list. Go back to basics. Prove to yourself that you can link to a simple function that adds two int values and returns the result. Work up from there. This is debugging 101. Simplify to a problem you can understand. Then apply to the real, more complex problem."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 1371, "user_id": 3110262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/575e4d7de1acb0f07b60f9b79957e8aa?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/3110262/a-b"}, "edited": false, "score": 0, "creation_date": 1495009985, "post_id": 44017486, "comment_id": 75066138, "body": "That&#39;s a different question. I do know how to deal with those issues though. But not at this question."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1495010304, "post_id": 44017486, "comment_id": 75066399, "body": "Do not compile the files as C++ object files. Try to compile them as C object files. And what format are these object files? There exist several incompatible formats."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1495010429, "post_id": 44017486, "comment_id": 75066501, "body": "@Rudy No, that&#39;s not it. Stack checking can be suppressed with a compiler switch. And the presence of <code>__imp_XXX</code> implies compilation with runtime linking. My guess is that asker is doing all this in the VS GUI rather than getting to grips with <code>cl</code>. My command line to <code>cl</code> looks like this: <code>cmd = &#39;&quot;%(cl)s&quot; &#47;I &quot;%(include)s&quot; &#47;c &#47;wd4090 &#47;wd4700 &#47;O2 &#47;GS- &#47;Gs131072 &#47;Fo%(outdir)s&#47; %(cmd)s&#39; % locals()</code> Obviously that&#39;s Python code with some subsitutions but you should be able to get the drift."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1495011052, "post_id": 44017486, "comment_id": 75066969, "body": "@David: What stack checking do you mean?"}, {"owner": {"reputation": 1371, "user_id": 3110262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/575e4d7de1acb0f07b60f9b79957e8aa?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/3110262/a-b"}, "edited": false, "score": 0, "creation_date": 1495011350, "post_id": 44017486, "comment_id": 75067193, "body": "I have created one more question for next query: <a href=\"http://stackoverflow.com/q/44020038/3110262\">stackoverflow.com/q/44020038/3110262</a>"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1495011613, "post_id": 44017486, "comment_id": 75067385, "body": "@RudyVelthuis <code>__GSHandlerCheck</code>. As you state in your article, you&#39;ve not done much with x64 objects. There&#39;s quite a bit missing from that article in that regard."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 3, "last_activity_date": 1495003589, "creation_date": 1495003589, "answer_id": 44017486, "question_id": 44017189, "link": "https://stackoverflow.com/questions/44017189/e2045-bad-object-file-formatxxx-obj/44017486#44017486", "title": "E2045 Bad object file Format:&quot;XXX.obj&quot;", "body": "<p>You cannot use a 32 bit object with the 64 bit compiler. You must recompile your code with a 64 bit compiler. </p>\n\n<p>You can use a number of different compilers to do this. Although I have heard of people succeeding with gcc I have never managed to do that. I believe that the modern Clang based Embarcadero compiler can be used, but I personally have no experience of that. I have always used the Microsoft compiler to create 64 bit objects. And certainly this is how Embarcadero themselves have done it for libraries like zlib that they link to their RTL. </p>\n"}], "owner": {"reputation": 1371, "user_id": 3110262, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/575e4d7de1acb0f07b60f9b79957e8aa?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/3110262/a-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563632930, "creation_date": 1495002628, "last_edit_date": 1495010070, "question_id": 44017189, "link": "https://stackoverflow.com/questions/44017189/e2045-bad-object-file-formatxxx-obj", "title": "E2045 Bad object file Format:&quot;XXX.obj&quot;", "body": "<p>I am working on one migration project from <code>x32</code> bit to <code>x64</code>.\nHere I am using this code: </p>\n\n<pre><code>{$L com_1.obj}\n{$L com_is1.obj}\n{$L com_2.obj}\n</code></pre>\n\n<p>But while compiling code I am getting error as </p>\n\n<pre><code>[dcc64 Error] XXX.dpr(919): E2045 Bad object file format: 'E:\\MyProj\\com_sha.obj'\n</code></pre>\n\n<p>I am not able to trace why it is happening. </p>\n\n<p>Is it due to 32 bit obj file used for compiling x64 bit delphi project?</p>\n\n<p>If it is I have also tried to create a obj file with x64 bit environment. </p>\n\n<p>Can anyone please help me on this?</p>\n\n<p>I am using <code>Delphi 10 Seattle</code>.</p>\n"}, {"tags": ["c++", "c", "logging", "syslog", "yocto"], "comments": [{"owner": {"reputation": 7633, "user_id": 4093778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j10KcVcKn4A/AAAAAAAAAAI/AAAAAAAAAdE/AgrehO6_eJo/photo.jpg?sz=128", "display_name": "Anders", "link": "https://stackoverflow.com/users/4093778/anders"}, "edited": false, "score": 0, "creation_date": 1495029253, "post_id": 44016928, "comment_id": 75080104, "body": "Double-check which syslog implementation you&#39;re using..."}], "answers": [{"comments": [{"owner": {"reputation": 2992, "user_id": 2039094, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bddf49261fab0a3b9926225dfad90856?s=128&d=identicon&r=PG", "display_name": "Gilson PJ", "link": "https://stackoverflow.com/users/2039094/gilson-pj"}, "edited": false, "score": 0, "creation_date": 1495004618, "post_id": 44017566, "comment_id": 75062779, "body": "Thanks @jku I added an invalid entry in the syslog.conf and I can see its crashing when I try to restart. So I think syslogd is reading the configuration file and trying to parse it"}, {"owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "reply_to_user": {"reputation": 2992, "user_id": 2039094, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bddf49261fab0a3b9926225dfad90856?s=128&d=identicon&r=PG", "display_name": "Gilson PJ", "link": "https://stackoverflow.com/users/2039094/gilson-pj"}, "edited": false, "score": 0, "creation_date": 1495045935, "post_id": 44017566, "comment_id": 75091250, "body": "Well, there seems to be <i>limited</i> support if a specific build configuration is enabled: <a href=\"https://git.busybox.net/busybox/tree/docs/syslog.conf.txt\" rel=\"nofollow noreferrer\">git.busybox.net/busybox/tree/docs/syslog.conf.txt</a> -- you&#39;d have read the source to be sure but I&#39;m willing to bet your syntax is not supported"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 2992, "user_id": 2039094, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bddf49261fab0a3b9926225dfad90856?s=128&d=identicon&r=PG", "display_name": "Gilson PJ", "link": "https://stackoverflow.com/users/2039094/gilson-pj"}, "edited": false, "score": 1, "creation_date": 1495444606, "post_id": 44017566, "comment_id": 75237480, "body": "@GilsonPJ You need to include rsyslog or syslog-ng in your image, they support remote logging. The syslogd in busybox does not support logging to a remote machine."}, {"owner": {"reputation": 2992, "user_id": 2039094, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bddf49261fab0a3b9926225dfad90856?s=128&d=identicon&r=PG", "display_name": "Gilson PJ", "link": "https://stackoverflow.com/users/2039094/gilson-pj"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1495445897, "post_id": 44017566, "comment_id": 75238367, "body": "@nos as per the linux manual <a href=\"https://linux.die.net/man/5/syslog.conf\" rel=\"nofollow noreferrer\">linux.die.net/man/5/syslog.conf</a> syslod must support this feature right? why busybox implementation is different? They are free to implement their own way, but how can they avoid a common feature?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1495452194, "post_id": 44017566, "comment_id": 75242448, "body": "That man page is not for the busybox syslogd implementation. It appears that busybox syslogd can do remote logging with the -R argument though if the  FEATURE_REMOTE_LOG is enabled when building busybox, as shown at <a href=\"https://busybox.net/downloads/BusyBox.html\" rel=\"nofollow noreferrer\">busybox.net/downloads/BusyBox.html</a>. Make sure you know what syslogd implementation you actually are running though - maybe you run something completely different."}, {"owner": {"reputation": 1271, "user_id": 1102681, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/3ky61.jpg?s=128&g=1", "display_name": "ransh", "link": "https://stackoverflow.com/users/1102681/ransh"}, "edited": false, "score": 0, "creation_date": 1565853964, "post_id": 44017566, "comment_id": 101480405, "body": "Is it possible to do the upgrade by simple install rsyslog or syslog-ng just above the busybox (without reinstall busybox/) ? (I know this is old post, but find it useful)"}], "tags": [], "owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "is_accepted": false, "score": 2, "last_activity_date": 1495003855, "creation_date": 1495003855, "answer_id": 44017566, "question_id": 44016928, "link": "https://stackoverflow.com/questions/44016928/syslog-not-forwarding-remote-messages/44017566#44017566", "title": "Syslog not forwarding remote messages", "body": "<p>By default Yocto-based systems use Busybox to provide minimal versions of many basic tools. syslog is one of those tools. This is a quote from Busybox documentation:</p>\n\n<blockquote>\n  <p>Note that this version of syslogd ignores /etc/syslog.conf.</p>\n</blockquote>\n\n<p>To get full syslog functionality you'd have to include a more complete implementation on your image. There are several options in meta-openembedded, <a href=\"http://layers.openembedded.org/layerindex/recipe/845/\" rel=\"nofollow noreferrer\">rsyslog in meta-oe</a>  is probably a good default choice.</p>\n"}, {"comments": [{"owner": {"reputation": 2992, "user_id": 2039094, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bddf49261fab0a3b9926225dfad90856?s=128&d=identicon&r=PG", "display_name": "Gilson PJ", "link": "https://stackoverflow.com/users/2039094/gilson-pj"}, "edited": false, "score": 0, "creation_date": 1495834907, "post_id": 44204598, "comment_id": 75433449, "body": "logger works fine. Tested using logger as well as a custom application"}], "tags": [], "owner": {"reputation": 413, "user_id": 3676886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJeQv.jpg?s=128&g=1", "display_name": "HenryGiraldo", "link": "https://stackoverflow.com/users/3676886/henrygiraldo"}, "is_accepted": false, "score": 0, "last_activity_date": 1495810482, "creation_date": 1495810482, "answer_id": 44204598, "question_id": 44016928, "link": "https://stackoverflow.com/questions/44016928/syslog-not-forwarding-remote-messages/44204598#44204598", "title": "Syslog not forwarding remote messages", "body": "<p>I would first use logger (tool incluided in busybox) to ensure that your syslog configuration is correct.\nIf the messages are sent well by this method, then we can investigate the code.</p>\n\n<pre><code>logger [OPTIONS] [MESSAGE]\n\nWrite MESSAGE to the system log. If MESSAGE is omitted, log stdin.\n\nOptions:\n\n        -s      Log to stderr as well as the system log\n        -t TAG  Log using the specified tag (defaults to user name)\n        -p PRIO Priority (numeric or facility.level pair)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 7576082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55dd92fa2efa971a901d11598532c76e?s=128&d=identicon&r=PG&f=1", "display_name": "rinn2883", "link": "https://stackoverflow.com/users/7576082/rinn2883"}, "is_accepted": false, "score": 0, "last_activity_date": 1515513698, "creation_date": 1515513698, "answer_id": 48172142, "question_id": 44016928, "link": "https://stackoverflow.com/questions/44016928/syslog-not-forwarding-remote-messages/48172142#48172142", "title": "Syslog not forwarding remote messages", "body": "<p>I'm also looking into this. busybox supports remote logging, but it seems to forward all the messages. There is no support for filtering combined with remote logging. I installed rsyslog on the image to solve this.</p>\n\n<p>I also found out that rsyslog does not rotate files out of the box. Logrotate was installed as dependency but there is no cron daemon running. I had to install cronie and configure cronie, logrotate and rsyslog.</p>\n"}], "owner": {"reputation": 2992, "user_id": 2039094, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bddf49261fab0a3b9926225dfad90856?s=128&d=identicon&r=PG", "display_name": "Gilson PJ", "link": "https://stackoverflow.com/users/2039094/gilson-pj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1515513698, "creation_date": 1495001743, "last_edit_date": 1495436791, "question_id": 44016928, "link": "https://stackoverflow.com/questions/44016928/syslog-not-forwarding-remote-messages", "title": "Syslog not forwarding remote messages", "body": "<p>I configured /etc/syslog.conf with below configuration</p>\n\n<pre><code>*.* @10.10.10.2:514\n*.* @@10.10.10.2:514\n</code></pre>\n\n<p>and logged through below code</p>\n\n<pre><code>openlog(\"Test-Msg\", LOG_PID, LOG_LOCAL0);\nfor (int i = 0; i &lt;10; i++)\n{\n    syslog(LOG_ALERT, \"My msg %d\", i);\n    std::cout&lt;&lt;\"-------------Writing Syslog \"&lt;&lt;i&lt;&lt;\"\\n\";\n}\n\ncloselog();\n</code></pre>\n\n<p>but its not forwarding to remote server. instead of that it creates a file \"@10.10.10.2:514\" &amp; \"@@10.10.10.2:514\" and logging all the message there.</p>\n\n<p>Tested with wireshark, no messages are forwarded to remote system.</p>\n\n<p>I am using yocto platform and busybox 1.22 syslog implementation.</p>\n\n<p><strong>Update</strong></p>\n\n<p>In yocto I saw one more configuration file /etc/syslog-startup.conf and there I configured </p>\n\n<pre><code>DESTINATION=remote  # log destinations (buffer file remote)\nREMOTE=10.10.10.2:514          # where to log (syslog remote)\n</code></pre>\n\n<p>Now its started forwarding all the messages, but as per the linux manuals syslog conf must support <code>*.=alert @&lt;host:port&gt;</code> filter. If I have to use the above configuration how can I apply the filters?</p>\n"}, {"tags": ["c", "shell", "process", "io", "fgets"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1495001366, "post_id": 44016803, "comment_id": 75060919, "body": "Can you please edit your question to <i>show</i> the actual (and expected) output (in full, copy-pasted as text)? Also please include an actual <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>, something that we can easily copy and test ourselves."}, {"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1495001581, "post_id": 44016803, "comment_id": 75061022, "body": "@Someprogrammerdude Hi, I added the outputs. In a word I did not expect to see duplicate lines being read."}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1495001745, "post_id": 44016803, "comment_id": 75061093, "body": "parent and child are sharing the same file descriptor, what do you expect into the fork about the stdin ?"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1495001978, "post_id": 44016803, "comment_id": 75061230, "body": "You can check here for example <a href=\"http://stackoverflow.com/questions/4277289/are-file-descriptors-shared-when-forking\" title=\"are file descriptors shared when forking\">stackoverflow.com/questions/4277289/&hellip;</a>"}, {"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "reply_to_user": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 2, "creation_date": 1495002107, "post_id": 44016803, "comment_id": 75061291, "body": "@&#212;rel Thanks for the info. But then in my code I terminate right after child is created. How is that going to change the file offset in parent?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1495002388, "post_id": 44016803, "comment_id": 75061451, "body": "This should work as expected. Are you sure you compiled the posted code?It looks like you removed the call to <code>exit</code> in your tests."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1495002891, "post_id": 44016803, "comment_id": 75061717, "body": "I cannot reproduce the behavior you describe with the posted code. I get the expected results."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1495003680, "post_id": 44016803, "comment_id": 75062162, "body": "@MichaelBurr <a href=\"http://ideone.com/MnIbsn\" rel=\"nofollow noreferrer\">ideone.com/MnIbsn</a>"}, {"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "edited": false, "score": 0, "creation_date": 1495003917, "post_id": 44016803, "comment_id": 75062306, "body": "Thanks for posting the link. That was the same problem I had. I&#39;m not that familiar with c, so maybe this is not the way I should do?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495004004, "post_id": 44016803, "comment_id": 75062361, "body": "Are you using an online compiler by any chance?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495004139, "post_id": 44016803, "comment_id": 75062456, "body": "@VittVolt: n.m.&#39;s output is somewhat different from yours. Is yours accurate? Did you actually cut&amp;paste a run? And how did you run the program: from a shell, or from an IDE?"}, {"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "edited": false, "score": 0, "creation_date": 1495004184, "post_id": 44016803, "comment_id": 75062491, "body": "Not sure if it helps, but I&#39;m running on my laptop using Ubuntu 16.04 with latest gcc, kernel version 4.8.0-46."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495005725, "post_id": 44016803, "comment_id": 75063466, "body": "I have no idea why, but removing <code>wait</code> the from parent or adding <code>fclose(stdin)</code> to the child fixes the problem on ideone. I cannot reproduce this on my physical computer."}, {"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495034057, "post_id": 44016803, "comment_id": 75083954, "body": "@n.m. Thanks for the suggestion, fclose(stdin) in the child does solve the problem as well. Removing wait() is not applicable in my case since I need to wait for the children to finish. I guess this is just a problem with standard libc. As suggested in the answer below, using read seems to get normal result."}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "edited": false, "score": 0, "creation_date": 1495030614, "post_id": 44018547, "comment_id": 75081207, "body": "Thanks for the great answer !"}, {"owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "edited": false, "score": 0, "creation_date": 1495035211, "post_id": 44018547, "comment_id": 75084834, "body": "Actually I also tried using pos = lseek(0, 0, SEEK_CUR) to get the current offset before forking, and lseek(0, pos, SEEK_SET) to reset the file position after wait(). It also turned out to be working."}], "tags": [], "owner": {"reputation": 96, "user_id": 7962224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b970c6e4960b7c0c66920d8430407c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Vadim Ponomarev", "link": "https://stackoverflow.com/users/7962224/vadim-ponomarev"}, "is_accepted": true, "score": 4, "last_activity_date": 1495006959, "creation_date": 1495006959, "answer_id": 44018547, "question_id": 44016803, "link": "https://stackoverflow.com/questions/44016803/reading-input-using-fgets-returns-duplicate-lines-in-c/44018547#44018547", "title": "Reading input using fgets returns duplicate lines in C", "body": "<ol>\n<li>it was already mentioned that parent and child are sharing current position for file descriptor 0 (stdin)</li>\n<li><p>seems that libc runtime initialization for streams (stdin, stdout, stderr) contains some stuff changing current stdin position:</p>\n\n<pre><code>&gt; strace -f ./a.out &lt; temp 2&gt;&amp;1 | less\n....\nwrite(2, \"pid: 29487 -- getcmd buf =======\"..., 45pid: 29487 -- getcmd buf ======= --&gt; line 1\nclone(child_stack=0,flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD,child_tidptr=0x7f34940f19d0) = 29488\nProcess 29488 attached\n[pid 29487] wait4(-1,  &lt;unfinished ...&gt;\n[pid 29488] lseek(0, -14, SEEK_CUR)     = 7\n[pid 29488] exit_group(0)               = ?\n[pid 29488] +++ exited with 0 +++\n&lt;... wait4 resumed&gt; [{WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 0}], 0, NULL) = 29488\n</code></pre></li>\n</ol>\n\n<p>please note lseek(0, -14, SEEK_CUR) in child (pid 29488)</p>\n\n<ol start=\"3\">\n<li><p>as a result, in my environment (openSUSE Leap 42.2, glibc-2.22-4.3.1) the program loops infinitely and there is no EOF at all</p></li>\n<li><p>changed fgets() to read() in the example </p>\n\n<pre><code>....\nif (read(0, buf, nbuf) == 0) {\n....\nwhile(getcmd(buf, 7, pid) &gt;= 0) {\n....\n</code></pre></li>\n</ol>\n\n<p>and program runs as expected (three lines and EOF)</p>\n\n<ol start=\"5\">\n<li><p>and run strace -f again - no more lseek() in child!! </p></li>\n<li><p>Conclusion - seems that stream functions (declared in stdio.h) must be used with great caution in multi-process environment because of many side effects (like in this example)</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6780140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaebf016d883100da07b8715425de21d?s=128&d=identicon&r=PG&f=1", "display_name": "tsummer2", "link": "https://stackoverflow.com/users/6780140/tsummer2"}, "is_accepted": false, "score": 0, "last_activity_date": 1556227836, "creation_date": 1556227836, "answer_id": 55857907, "question_id": 44016803, "link": "https://stackoverflow.com/questions/44016803/reading-input-using-fgets-returns-duplicate-lines-in-c/55857907#55857907", "title": "Reading input using fgets returns duplicate lines in C", "body": "<p>I found a solution for using <code>fgets()</code> from <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=858529\" rel=\"nofollow noreferrer\">this thread</a> that talks about the same problem, tldr: </p>\n\n<blockquote>\n  <p>exit flushes the stdio buffers in the child.\n  ...\n  For more details here is the link corresponding to the POSIX\n  reference, chapter 2.5.1:</p>\n  \n  <p><a href=\"http://pubs.opengroup.org/onlinepubs/007904875/functions/xsh_chap02_05.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/007904875/functions/xsh_chap02_05.html</a></p>\n  \n  <p>The behaviour is therefore undefined, and thus is allowed to change\n  between glibc 2.19 and 2.24.</p>\n</blockquote>\n\n<p>The fix:</p>\n\n<blockquote>\n  <p>As written the above link, two solutions are possible to fix the code:</p>\n  \n  <p>if(fork() == 0) { fclose(fd); exit(1); }</p>\n  \n  <p>or</p>\n  \n  <p>if(fork() == 0) { _exit(1); }</p>\n</blockquote>\n"}], "owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 1, "accepted_answer_id": 44018547, "answer_count": 2, "score": 4, "last_activity_date": 1556227836, "creation_date": 1495001152, "last_edit_date": 1495035738, "question_id": 44016803, "link": "https://stackoverflow.com/questions/44016803/reading-input-using-fgets-returns-duplicate-lines-in-c", "title": "Reading input using fgets returns duplicate lines in C", "body": "<p>I was experimenting with some C code for shell implementation and found fgets() returns duplicate lines when after I fork a process, which I could not understand, and I would greatly appreciate any help.</p>\n\n<p>My question is: does forking changes the offset in any open files in the parent process? This seems to happen in my program.</p>\n\n<p><strong>FROM THE ANSWER BELOW @Vadim Ponomarev and my understanding:</strong>\nfgets() is not thread-safe (or strictly speaking, it is, yet forking a process causes the stdin to be initialized in some way, resulting in the change of the shared file offset).</p>\n\n<p>The code goes like this:</p>\n\n<pre><code>int main() {\n\n  char buf[200];\n  int r;\n  pid_t pid = 0;\n\n  while(getcmd(buf, 200, pid) &gt;= 0) {\n    fprintf(stderr, \"current pid: %d\\n\", getpid());\n    pid = fork();\n    // Without forking the fgets() reads all lines normally\n    if(pid == 0)\n      exit(0);\n\n    wait(&amp;r);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>The getcmd() function is just a wrapper:</p>\n\n<pre><code>int\ngetcmd(char *buf, int nbuf, pid_t pid)\n{\n  memset(buf, 0, nbuf);\n  if (fgets(buf, nbuf, stdin) == NULL) {\n    fprintf(stderr, \"EOF !!!\\n\");\n    return -1;\n  }\n  fprintf(stderr, \"pid: %d -- getcmd buf ======= --&gt; %s\\n\", getpid(), buf);\n  return 0;\n}\n</code></pre>\n\n<p>I also have an input file <strong>temp</strong> with some random texts:</p>\n\n<pre><code>line 1\nline 2\nline 3\n</code></pre>\n\n<p>After compilation, and I run <strong>a.out &lt; temp</strong>, the output shows that 6 lines are printed and usually some lines are duplicated. But if I delete the line</p>\n\n<pre><code>pid = fork()\n...\n</code></pre>\n\n<p>then the output becomes normal (just show all the lines one by one, which means fgets() is called 3 times).</p>\n\n<p>Any idea what is going wrong?</p>\n\n<p>Output (this is what got):</p>\n\n<pre><code>pid: 10361 -- getcmd buf ======= --&gt; line1\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line2\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line3\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line2\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line3\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line3\n\ncurrent pid: 10361\nEOF !!!\n</code></pre>\n\n<p>And I expect to see this:</p>\n\n<pre><code>current pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line1\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line2\n\ncurrent pid: 10361\npid: 10361 -- getcmd buf ======= --&gt; line3\n\nEOF\n</code></pre>\n\n<p>A compilable version for reference:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;wait.h&gt;\n#include &lt;zconf.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;memory.h&gt;\n\nint\ngetcmd(char *buf, int nbuf, pid_t pid)\n{\n  memset(buf, 0, nbuf);\n  if (fgets(buf, nbuf, stdin) == NULL) {\n    fprintf(stderr, \"EOF !!!\\n\");\n    return -1;\n  }\n  fprintf(stderr, \"pid: %d -- getcmd buf ======= --&gt; %s\\n\", getpid(), buf);\n  return 0;\n}\n\nint main() {\n\n  char buf[200];\n  int r;\n  pid_t pid = 0;\n\n  while(getcmd(buf, 200, pid) &gt;= 0) {\n    fprintf(stderr, \"current pid: %d\\n\", getpid());\n    pid = fork();\n    // Without forking the fgets() reads all lines normally\n    if(pid == 0)\n      exit(0);\n\n    wait(&amp;r);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c", "linker", "dev-c++", "gsl"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1494998891, "post_id": 44016256, "comment_id": 75059829, "body": "You added the directories, <a href=\"http://stackoverflow.com/questions/5862757/how-do-i-link-to-a-library-with-codeblocks\">but did you specify what libraries to use?</a>"}, {"owner": {"reputation": 133, "user_id": 4856605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5e06b11ba2e898826cc69bc9f992acc?s=128&d=identicon&r=PG&f=1", "display_name": "Yinyue", "link": "https://stackoverflow.com/users/4856605/yinyue"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1494999944, "post_id": 44016256, "comment_id": 75060285, "body": "Well, there is no way (that I know of) to tell DevCpp to use a specific library (according to the link you gave). One can just add library paths. However, what I also just did was adding the files in the \\bin from my gsl-distribution to the \\bin of DevCpp (in the hope that DevCpp will then be able to use them maybe), but it also didn&#39;t work."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1495001052, "post_id": 44016256, "comment_id": 75060771, "body": "@Yinyue, please just read the link provided above, then write your comment. There are ways to tell DevCpp to use a specific library"}, {"owner": {"reputation": 133, "user_id": 4856605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5e06b11ba2e898826cc69bc9f992acc?s=128&d=identicon&r=PG&f=1", "display_name": "Yinyue", "link": "https://stackoverflow.com/users/4856605/yinyue"}, "reply_to_user": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1495033151, "post_id": 44016256, "comment_id": 75083263, "body": "@AliVolkanATLI I read the link, looked up an analogous way for DevCpp and then concluded that I know no/couldn&#39;t find any way for DevCpp to do it that way (maybe because I&#39;m too stupid), but if you know how to tell DevCpp then I&#39;d be very thankful if you told me."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 1, "creation_date": 1495189294, "post_id": 44016256, "comment_id": 75158932, "body": "@Yinyue in every project in which you want to use a library, do Project &gt; Project Options &gt; Parameters &gt; Add Library"}, {"owner": {"reputation": 133, "user_id": 4856605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5e06b11ba2e898826cc69bc9f992acc?s=128&d=identicon&r=PG&f=1", "display_name": "Yinyue", "link": "https://stackoverflow.com/users/4856605/yinyue"}, "edited": false, "score": 0, "creation_date": 1495518183, "post_id": 44016256, "comment_id": 75271978, "body": "Thanks, that did the job."}], "owner": {"reputation": 133, "user_id": 4856605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5e06b11ba2e898826cc69bc9f992acc?s=128&d=identicon&r=PG&f=1", "display_name": "Yinyue", "link": "https://stackoverflow.com/users/4856605/yinyue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494998638, "creation_date": 1494998638, "question_id": 44016256, "link": "https://stackoverflow.com/questions/44016256/linker-error-with-gsl-rng-in-devcpp", "title": "Linker error with gsl_rng in DevCpp", "body": "<p>I copied the following code from the official gnu manual for random number generator:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;gsl/gsl_rng.h&gt;\n#include &lt;gsl/gsl_randist.h&gt;\n\n\nint main (void)\n{\n  const gsl_rng_type * T;\n  gsl_rng * r;\n\n  int i, n = 10;\n  double mu = 3.0;\n\n  /* create a generator chosen by the \n     environment variable GSL_RNG_TYPE */\n\n  gsl_rng_env_setup();\n\n  T = gsl_rng_default;\n  r = gsl_rng_alloc (T);\n\n  /* print n random variates chosen from \n     the poisson distribution with mean \n     parameter mu */\n\n  for (i = 0; i &lt; n; i++) \n    {\n      unsigned int k = gsl_ran_poisson (r, mu);\n      printf (\" %u\", k);\n    }\n\n  printf (\"\\n\");\n  gsl_rng_free (r);\n  return 0;\n}\n</code></pre>\n\n<p>and I added the according lib-directory, bin-directory and include-directory to my DevCpp-project (and this appears to work fine, since before that, DevCpp couldn't even find those files). When I try to compile these files, however, I get the following errors:</p>\n\n<blockquote>\n  <p>[Linker error] undefined reference to 'gsl_rng_env_setup'<br>\n  [Linker error] undefined reference to 'gsl_rng_default'</p>\n</blockquote>\n\n<p>...and even more, all probably referring to functions defined within gsl_rng and gsl_randist. Also, declaring gsl_rng_env_setup before main(void) etc. doesn't help (then I get ambiguities). Do you know how to solve the problem? I use Windows 7, 64bit-system and DevCpp for compiling C/C++ code. I really even tried different ways of building the gsl-library (e.g. building from source, and then, when I had this error, using the unofficial Windows installer), but none of the methods solved this problem. </p>\n"}, {"tags": ["c", "unions"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1494996262, "post_id": 44015642, "comment_id": 75058964, "body": "<a href=\"http://stackoverflow.com/a/22190086/2864275\">stackoverflow.com/a/22190086/2864275</a> looks like you need c11"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495007234, "post_id": 44015642, "comment_id": 75064390, "body": "The use of the compiler option <code>-ansi</code> is questionable. Why are you using 1980s style C programming? See <a href=\"http://stackoverflow.com/questions/17206568/what-is-the-difference-between-c-c99-ansi-c-and-gnu-c-a-general-confusion-reg/17209532#17209532\" title=\"what is the difference between c c99 ansi c and gnu c a general confusion reg\">stackoverflow.com/questions/17206568/&hellip;</a>"}, {"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495007680, "post_id": 44015642, "comment_id": 75064648, "body": "@Lundin In this case, <code>-ansi</code> or <code>-std=c11</code> doesn&#39;t matter; both yield the same result. (I also moved away from <code>-ansi</code> rather soon after I posted this, for other reasons specifically related to more recent language constructs.) I discussed that briefly in the comments to InternetAussie&#39;s answer, but I have now also updated the question accordingly."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1495008136, "post_id": 44015642, "comment_id": 75064947, "body": "I believe it depends on your GCC version. <code>-ansi</code> expands to &quot;almost C90&quot; on older versions of GCC and &quot;almost C11&quot; on newer versions. It is better to use &quot;guaranteed fully compliant C11&quot;, which is <code>gcc -std=c11 -pedantic-errors</code>. Adding <code>-Wall -Wextra</code> doesn&#39;t hurt."}, {"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1495008346, "post_id": 44015642, "comment_id": 75065064, "body": "@Lundin ...and even with all of those ( <code>gcc -std=c11 -Wall -Wextra -pedantic-errors</code>), my code now compiles cleanly except for warnings that I&#39;m not doing anything with <code>argc</code> and <code>argv</code> in my <code>main()</code> (which at this point is really just a test routine, but will almost certainly grow later on). FWIW, that&#39;s with gcc 4.7.2; not the most recent version, but seemingly recent enough."}], "answers": [{"comments": [{"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "edited": false, "score": 0, "creation_date": 1494996997, "post_id": 44015853, "comment_id": 75059200, "body": "This looks like it&#39;s working nicely even with my GCC in <code>-ansi -Wall</code> mode, let alone <code>-std=c11 -Wall</code>, thank you!"}, {"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "edited": false, "score": 0, "creation_date": 1494997103, "post_id": 44015853, "comment_id": 75059224, "body": "As for your note on the relative sizes of <code>int</code> and <code>short</code>, I am aware that there is an underlying assumption hidden in plain sight there, but so far I&#39;m just poking around. I will probably migrate this to specific types of a given size, but for now I&#39;m just trying to see if I can get what I am doing to work at all."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494999178, "post_id": 44015853, "comment_id": 75059962, "body": "Another concern is <i>padding</i>. Depending on the implementation, you may need to explicitly specify that no padding be inserted by the compiler in your inner struct. I&#39;m not sure whether this will be handled automatically by your compiler as the natural alignment for <code>int</code> and <code>struct</code> may not be the same. You may want to look into what command line option your compiler provides or look into <code>#pragma pack</code> if you run into weird issues."}, {"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1494999668, "post_id": 44015853, "comment_id": 75060144, "body": "@DavidC.Rankin Thanks for the hint, I&#39;ll keep that in mind. For the time being, keep in mind that what I posted in the question isn&#39;t <i>exactly</i> the code I actually have; there are a few differences that would be relevant for the cases raised by both you and InternetAussie, but none that were relevant <i>to the question I was asking</i> which was about accessing a member of the type."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1494999776, "post_id": 44015853, "comment_id": 75060188, "body": "For gcc, unnamed unions were a compiler extension before C11. Note that there was a bug involving use of designated initializers with unnamed unions; <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=10676\" rel=\"nofollow noreferrer\">here is a bug report</a>, and <a href=\"http://stackoverflow.com/a/43103933/6879826\">here is an answer I gave to a related question</a>. In some cases, extra braces were needed to make designated initializers work, but this was finicky, and did not always work. The fix was supposed to have occurred in gcc 4.6."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "is_accepted": true, "score": 7, "last_activity_date": 1494997667, "last_edit_date": 1494997667, "creation_date": 1494996599, "answer_id": 44015853, "question_id": 44015642, "link": "https://stackoverflow.com/questions/44015642/how-to-access-a-member-of-a-union-without-naming-it/44015853#44015853", "title": "How to access a member of a union without naming it?", "body": "<p>Anonymous unions are a thing, if you can use anonymous structs (they are both C11 features or compiler extensions).</p>\n\n<p>Just as you've used a <code>struct</code> with no name to inject its members into the union's namespace, so you can also use a <code>union</code> with no name to inject its members into the enclosing namespace. Like so:</p>\n\n<pre><code>struct T {\n    union {\n        unsigned int x;\n        struct {\n            unsigned short xhigh;\n            unsigned short xlow;\n        };\n    }; /* &lt;-- no name here */\n\n    /* ...repeated a handful of times for different variables in T... */\n};\n</code></pre>\n\n<p>You just have to make sure that none of the injected names clash with other injected names or regular names that are there, otherwise it won't compile.</p>\n\n<hr>\n\n<p>One concern though: you seem to be relying on the \"fact\" that <code>unsigned short</code> is half the size of <code>unsigned int</code>, and that these types are big-endian. But if that's what happens on your system, then that's fine. If not, I suggest you rethink the structure.</p>\n"}], "owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 44015853, "answer_count": 1, "score": 3, "last_activity_date": 1495007579, "creation_date": 1494995511, "last_edit_date": 1495007579, "question_id": 44015642, "link": "https://stackoverflow.com/questions/44015642/how-to-access-a-member-of-a-union-without-naming-it", "title": "How to access a member of a union without naming it?", "body": "<p>I have some code that is very similar to the following</p>\n\n<pre><code>struct T {\n    union {\n        unsigned int x;\n        struct {\n            unsigned short xhigh;\n            unsigned short xlow;\n        };\n    } x;\n    /* ...repeated a handful of times for different variables in T... */\n};\n</code></pre>\n\n<p>This does exactly what you'd expect: It allows me to declare a variable of type <code>struct T</code> and access either <code>t.x.x</code> or <code>t.x.xhigh</code> or <code>t.x.xlow</code>. So far so good.</p>\n\n<p>However, <strong>I would really like it if I could do just <code>t.x</code></strong> in the common case of wanting to access the value of the union as an <code>unsigned int</code> quantity, but retain the ability to access the high- and low-order portions independently without resorting to bit masking and shifting, and without invoking undefined behavior.</p>\n\n<p><strong>Is that possible in C?</strong></p>\n\n<p><strong>If it is possible, then what is the C syntax for the declaration?</strong></p>\n\n<p>When I try the naiive approach of simply accessing <code>t.x</code> instead of <code>t.x.x</code>, I get warning messages like (this particular one is from a <code>printf()</code> call):</p>\n\n<pre><code>cc -ansi -o test -Wall test.c\ntest.c: In function \u2018my_function\u2019:\ntest.c:13:2: warning: format \u2018%X\u2019 expects argument of type \u2018unsigned int\u2019, but argument 2 has type \u2018const union &lt;anonymous&gt;\u2019 [-Wformat]\n</code></pre>\n\n<p>Using <code>-std=c11</code> instead of <code>-ansi</code> yields the same warning.</p>\n"}, {"tags": ["c", "pipe", "fork", "dup", "execve"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1494995658, "post_id": 44015608, "comment_id": 75058740, "body": "Aren&#39;t you execing two cats? You fork and then both of those fork again?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494995973, "post_id": 44015608, "comment_id": 75058852, "body": "What do you think will happen if <code>ls</code>s output doesn&#39;t fit a pipe-buffer?"}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1494996511, "post_id": 44015608, "comment_id": 75059035, "body": "@SamiKuhmonen Execing two cats? Maybe? The first one does exec on array a, and the next exec on array b. I thought fork() returns child and parent."}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494996545, "post_id": 44015608, "comment_id": 75059050, "body": "@EOF I&#39;m not sure what would happen. If I remove the last waitpid statement it works just fine, but cat is still running as a zombie."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494996710, "post_id": 44015608, "comment_id": 75059108, "body": "@user3499524: If <code>ls</code>s output doesn&#39;t fit a pipe buffer, <code>ls</code> will <i>block</i> when the buffer is full. Meanwhile, your parent process is blocked on <code>waitpid()</code> <i>before</i> it creates the <code>cat</code>-process, so before any <code>read()</code> from the pipe. Each of your processes is waiting for the other, so you are <i>deadlocked</i>."}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494996930, "post_id": 44015608, "comment_id": 75059180, "body": "@EOF That might be the problem... But cat does execute and prints out the ls. it prints out all the contents of the directory, I&#39;ve verified this. Plus, there&#39;s only about around 15 files.  After cat is done (or I should say, all directory contents are printed), however, it just hangs there. Cat never comes back is the issue I think."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1494997055, "post_id": 44015608, "comment_id": 75059215, "body": "A more subtle deadlock (but one that happens <i>always</i>, not just when a pipe buffer is full) is associated with the read-end of the pipe. When <code>ls</code> terminates, it closes its copies of the write-end of the pipe. However, both your parent process <i>and</i> your <code>cat</code>-process still have a copy of the write end (in fact, the <code>printf()</code> at the end of your parent process writes to it...), so a <code>read()</code> from the pipe in <code>cat</code> will block until the write end is closed, which never happens because <code>cat</code> doesn&#39;t even know about the filedescriptor of the write end, and the parent doesn&#39;t terminate."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1494997078, "post_id": 44015608, "comment_id": 75059219, "body": "@SamiKuhmonen <code>exec()</code> doesn&#39;t return if successful."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494997133, "post_id": 44015608, "comment_id": 75059236, "body": "@EOF OK, then not a problem"}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494997779, "post_id": 44015608, "comment_id": 75059430, "body": "@EOF I&#39;ll be a little honest, I might not know exactly what you mean. You say &quot;close its copy to the write-end of the pipe&quot;. Doesn&#39;t dup2() close the current one you&#39;re duping the new file descriptor onto? In otherwords, in the parent of the first exec, isn&#39;t dup2() closing the pipe when I dup back to stdout?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1494998129, "post_id": 44015608, "comment_id": 75059542, "body": "@user3499524: Ah, right, I didn&#39;t see you <code>dup2(old_std_out, 1);</code>ing back. It&#39;s not the usual way to do this kind of thing, you usually should only redirect the filedescriptors <i>after</i> <code>fork()</code>, then you wouldn&#39;t need this. Since you <code>dup2(fd[1], 1);</code> <i>before</i> the first <code>fork()</code>, you keep around two copies of the write-end of the pipe. One, you close implicitly by <code>dup2(old_std_out, 1);</code>, the other stays."}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "edited": false, "score": 0, "creation_date": 1494998513, "post_id": 44015608, "comment_id": 75059682, "body": "Would you mind elaborating on that a little more? For instance, I can dup2() after fork() inside the switch statement, or after the switch statement before the next fork(), or literally right after the fork() command.  Which after the fork() are you referring to? It may fix my issue :)"}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "edited": false, "score": 0, "creation_date": 1494998579, "post_id": 44015608, "comment_id": 75059707, "body": "One thing I know is, if I dup2() in the child after the fork, then the next child wont know the pipe address, will it?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1494998860, "post_id": 44015608, "comment_id": 75059821, "body": "A comprehensive answer should probably not be made in a comment. Unfortunately, I don&#39;t have time right now, I might in a few hours. Anyway, for a quick fix of the second deadlock, add <code>close(fd[1])</code> before the second <code>fork()</code>, see it that helps."}, {"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1494999158, "post_id": 44015608, "comment_id": 75059955, "body": "@EOF Genius sir. This seems to have fixed my issue. I suppose dup2() wasn&#39;t closing it then?  Interesting.  Well, if you post it, I will give you the solution points guaranteed because it fixed my problem.  Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "edited": false, "score": 0, "creation_date": 1495045611, "post_id": 44027989, "comment_id": 75091084, "body": "Thanks again for your help, saved me hours of frustration."}], "tags": [], "owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "is_accepted": true, "score": 2, "last_activity_date": 1495047106, "last_edit_date": 1495047106, "creation_date": 1495032033, "answer_id": 44027989, "question_id": 44015608, "link": "https://stackoverflow.com/questions/44015608/whats-wrong-with-this-c-code-the-child-is-not-returning/44027989#44027989", "title": "What&#39;s wrong with this C code? The child is not returning?", "body": "<p>There are two potential deadlocks in your program.</p>\n\n<p>First, the first child (<code>ls</code>) may block when trying to write to the pipe, in which case <code>waitpid()</code> will not return until <code>ls</code> terminates, and <code>ls</code> will not terminate until the second child (<code>cat</code>) starts executing, which can't happen until <code>waitpid()</code> returns. => Deadlock.</p>\n\n<p>Second, <code>cat</code> will read from its <code>stdin</code> until all file descriptors for the write end are closed. Both the parent process <em>and <code>cat</code></em> have a copy of the write end, <code>cat</code> has it <em>without knowing about it explicitly</em>. Some operating systems will have <code>read()</code> not block if the only copy of the write end is in the same process (to avoid this deadlock), but this is not guaranteed. Either way, since the parent process keeps around a copy of the filedescriptor, and the parent process <code>waitpid()</code>s for the child, which waits for the write-end of the pipe to close, you have deadlock again.</p>\n\n<p>Often, simplifying the program solves such problems:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\nint main()\n{\n    char *a[2] = {\"/bin/ls\", NULL};\n    char *b[2] = {\"/bin/cat\", NULL};\n    char *envp[2] = {getenv(\"PATH\"), NULL};\n    int fd[2], status;\n    pipe(fd);\n    //int old_std_out = dup(1); /*No need to copy stdout...*/\n    //int old_std_in = dup(0);  /*...or stdin...*/\n    //dup2(fd[1], 1);           /*...if you wait dup2()ing until you need to*/\n    int pid = fork();\n    switch(pid)\n    {\n        case -1:\n            perror(\"Forkscrew\");\n            exit(1);\n            //break; /*unreachable*/\n        case 0:\n            dup2(fd[1], STDOUT_FILENO); /*NOW we dup2()*/\n            close(fd[0]); /*no need to pass these file descriptors to...*/\n            close(fd[1]); /*...a program that doesn't expect to have them open*/ \n            execve(a[0], a, envp);\n            exit(0); /*might want an error message*/\n            //break; /*unreachable*/\n       default:\n            //waitpid(-1, &amp;status, 0); /*don't wait yet*/\n            //dup2(old_std_out, 1);\n            close(fd[1]); /*we don't need this in the parent anymore*/\n            break;\n    }\n    //dup2(fd[0], 0); /*not needed anymore*/\n    pid = fork();\n    switch(pid)\n    {\n        case -1:\n            perror(\"Forkscrew\");\n            /*might want to ensure the first child can terminate*/\n            exit(1);\n            //break; /*unreachable*/\n        case 0:\n            dup2(fd[0], STDIN_FILENO);\n            close(fd[0]); /*again, cat doesn't expect a fourth fd open*/\n            execve(b[0], b, envp);\n            /*again, error message would be nice*/\n            exit(0);\n            //break;\n        default:\n            //waitpid(-1, &amp;status, 0);\n            //dup2(old_std_in, 0);\n            break;\n    }\n    waitpid(-1, &amp;status, 0); /*don't wait until both children are created*/\n    waitpid(-1, &amp;status, 0);\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>As you see, I've left a number of suggestions for improvements, but this should already work fine now, provided the <code>execve()</code>s work alright.</p>\n"}], "owner": {"reputation": 173, "user_id": 3499524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00c3184f4089a9a71d14e29609190ff8?s=128&d=identicon&r=PG&f=1", "display_name": "user3499524", "link": "https://stackoverflow.com/users/3499524/user3499524"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 44027989, "answer_count": 1, "score": 0, "last_activity_date": 1495047106, "creation_date": 1494995352, "last_edit_date": 1494995993, "question_id": 44015608, "link": "https://stackoverflow.com/questions/44015608/whats-wrong-with-this-c-code-the-child-is-not-returning", "title": "What&#39;s wrong with this C code? The child is not returning?", "body": "<p>Here's my attempt to try to understand how to do correct piping between two child processes. I'm simply trying to pass the output of one Linux command to another (ls to cat) and have the program return successfully. However, I'm guessing that the second child that is forked is getting stuck and the parent is forever waiting on this child. I have been fiddling with this code for a long time trying to find out why it's getting stuck. I'm kind of a noob when it comes to C system programming, but I am trying to learn.</p>\n\n<p>Does anybody have any idea why the program does not exit, but hangs on cat?</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\nint main()\n{\n    char *a[2] = {\"/bin/ls\", NULL};\n    char *b[2] = {\"/bin/cat\", NULL};\n    char *envp[2] = {getenv(\"PATH\"), NULL};\n    int fd[2], status;\n    pipe(fd);\n    int old_std_out = dup(1);\n    int old_std_in = dup(0);\n    dup2(fd[1], 1);\n    int pid = fork();\n    switch(pid)\n    {\n        case -1:\n            perror(\"Forkscrew\");\n            exit(1);\n            break;\n        case 0:\n            execve(a[0], a, envp);\n            exit(0);\n            break;\n       default:\n            waitpid(-1, &amp;status, 0);\n            dup2(old_std_out, 1);\n            break;\n    }\n    dup2(fd[0], 0);\n    pid = fork();\n    switch(pid)\n    {\n        case -1:\n            perror(\"Forkscrew\");\n            exit(1);\n            break;\n        case 0:\n            execve(b[0], b, envp);\n            exit(0);\n            break;\n        default:\n            waitpid(-1, &amp;status, 0);\n            dup2(old_std_in, 0);\n            break;\n    }\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1495000090, "post_id": 44015602, "comment_id": 75060348, "body": "You might want to think about how to get the stack pointer to have the value you want it to have, rather than focussing on the return address."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1495004830, "post_id": 44015602, "comment_id": 75062898, "body": "Continuing from the previous comment, you may want to look at <a href=\"http://stackoverflow.com/questions/14765406/function-prologue-and-epilogue-in-c\"><b>Function Prologue and Epilogue in C</b></a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1495006485, "post_id": 44015602, "comment_id": 75063939, "body": "This is impossible in standard C. C doesn&#39;t &quot;know&quot; anything about the representation of the call stack. For standard C calls on x86, it&#39;s impossible without assembler, because you need to manipulate <code>esp</code>/<code>ebp</code> and C has no notion of registers. It might be possible on some different architecture or with some different calling conventions where the stack pointer lives in a memory location. Of course this wouldn&#39;t be portable at all."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1495010223, "post_id": 44015602, "comment_id": 75066335, "body": "WHY you need this?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1495012813, "post_id": 44015602, "comment_id": 75068260, "body": "If you need to do this, (eg. to raise notice of errors or other &#39;abnormal&#39; conditions up a stack of function calls), you are using the wrong language.  Use a language that supports exceptions, eg. C++"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1494999572, "post_id": 44016354, "comment_id": 75060103, "body": "Welcome to StackOverflow and thanks for your attempt to help. As far as I understand your proposal, it is about changing the code around the call to <code>foo2();</code>. That code, as I understand the question, is part of the non-editable skeleton, which OP describes in the question. Hence I think your proposal does not solve the stated problem. Can you elaborate?"}], "tags": [], "owner": {"reputation": 11, "user_id": 7961321, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212612871021886/picture?type=large", "display_name": "Kumar Shivang", "link": "https://stackoverflow.com/users/7961321/kumar-shivang"}, "is_accepted": false, "score": 0, "last_activity_date": 1494999105, "creation_date": 1494999105, "answer_id": 44016354, "question_id": 44015602, "link": "https://stackoverflow.com/questions/44015602/returning-directly-to-main-from-a-function-call-of-a-function-call/44016354#44016354", "title": "Returning directly to main from a function call of a function call", "body": "<p>I don't think problem is that complicated. You should be calling another function with a condition on returning value such that if it is certain value (say 0) then return otherwise continue on the function.\nSo you can just replace <code>foo2();</code> with :</p>\n\n<pre><code>if (foo2() == 0) return 0;\n</code></pre>\n\n<p>Now in <code>foo2()</code> function <code>return 0;</code> whenever you wish to return to main function call of <code>foo1()</code> otherwise continue with <code>foo1()</code> statements. You need not use setjmp here.</p>\n\n<p>You may also find this article helpful: <a href=\"https://users.cs.cf.ac.uk/Dave.Marshall/C/node32.html\" rel=\"nofollow noreferrer\">Tread programming examples</a> </p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1495010090, "last_edit_date": 1495010090, "creation_date": 1495009733, "answer_id": 44019484, "question_id": 44015602, "link": "https://stackoverflow.com/questions/44015602/returning-directly-to-main-from-a-function-call-of-a-function-call/44019484#44019484", "title": "Returning directly to main from a function call of a function call", "body": "<blockquote>\n  <p>\"So basically I am supposed to implement a way to return directly to main from a function call of a function call. \" </p>\n</blockquote>\n\n<p>This requirement is nonsense. Any attempt to sate that requirement will result in trash code. Training to write things like this is directly harmful practice. This is a very bad assignment and your teacher should be ashamed for teaching you bad practice with no disclaimer. There is also never a reason to do things like this in real-world programs.</p>\n\n<p>You can't implement the <code>setjmp</code>/<code>longjmp</code> functions in pure C, you would have to use inline assembler. They save the program counter and other such things needed by the specific system. They also meddle with the stack pointer, which is one reason they are dangerous.</p>\n\n<p>So the only way to do this in standard C is to use the standard library functions <code>setjmp</code>/<code>longjmp</code> from setjmp.h. These are widely considered very bad and dangerous since they lead to unreadable spaghetti programming and many forms of undefined behavior. One example of undefined behavior from the C standard:</p>\n\n<blockquote>\n  <p>After a longjmp, there is an attempt to access the value of an object of automatic\n  storage duration that does not have volatile-qualified type, local to the function\n  containing the invocation of the corresponding setjmp macro, that was changed\n  between the setjmp invocation and longjmp call</p>\n</blockquote>\n\n<p>Don't use these functions ever.</p>\n\n<hr>\n\n<p>That being said, this is how you write horrible, dangerous programs:</p>\n\n<pre><code>// BAD! NEVER WRITE SPAGHETTI CODE LIKE THIS!\n\n#include &lt;stdio.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;stdbool.h&gt;\n\nstatic jmp_buf jmp_main;\n\nvoid func2 (bool one_more_time)\n{\n  puts(__func__);\n  if(one_more_time)\n  {\n    longjmp(jmp_main, !one_more_time);\n  }\n  printf(\"end of \"); puts(__func__);\n}\n\nvoid func1 (bool one_more_time)\n{\n  puts(__func__);\n  func2(one_more_time);\n  printf(\"end of \"); puts(__func__);\n}\n\nint main (void)\n{\n  bool one_more_time = (bool)!setjmp(jmp_main);\n  puts(__func__);  \n  func1(one_more_time);\n  printf(\"end of \"); puts(__func__);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>main\nfunc1\nfunc2\nmain\nfunc1\nfunc2\nend of func2\nend of func1\nend of main\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6024339, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0085c9b9e066d54b754c7b3bde2973f0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6024339/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1495010090, "creation_date": 1494995333, "question_id": 44015602, "link": "https://stackoverflow.com/questions/44015602/returning-directly-to-main-from-a-function-call-of-a-function-call", "title": "Returning directly to main from a function call of a function call", "body": "<p>just as a disclaimer this question has to do with a particular assignment I have an I am not asking for anyone to do my homework for me.</p>\n\n<p>So basically I am supposed to implement a way to return directly to main from a function call of a function call. </p>\n\n<p>Part of the stipulations are that we cannot use an assembly language instructions, gcc's asm(), or gcc built ins. After doing a lot of research on this on google I couldn't really find any examples to look at or even the source code for setjmp/longjmp (the purpose of this assignment is to copy those functionalities). I've asked some more older CS students for advice and most couldn't help or told me they are pretty sure it is not possible with the stipulations given. Any advice or pointers (haha) will be appreciated. Even a nudge in the right direction or confirmation that the assignment is not as complicated as I think will be greatly appreciated!</p>\n\n<p>So far my best attempt:</p>\n\n<p>-Use a setjmp function to store the address of where we left off in main (so something like x = foo1(); and pass x into setjmp(x)) and then have foo2 call my longjmp function where in longjmp I'll have the function set a pointer (*p) to my argument and then (*p-1) = address of x in main.</p>\n\n<p>This didn't work but I thought it was the right idea trying change the return address in the call stack since if I understood it correctly, the arguments of the function are directly on top of the return address in the stack.</p>\n\n<p>Here is the code I wrote:</p>\n\n<pre><code>int setjmp(int v);\nint longjmp(int v);\nint fun1(void); \nint fun2(void); \nint *add; //using global, not sure if best idea\nint main(void)\n{\n    int x = setjmp(x);\n    foo1();\n    return 0;\n}\nint setjmp(int v)\n{\n  add = &amp;v; //used a global variable\n  return 0;\n}\nint longjmp(int v)\n{\n  int *p; //pointer\n  p = &amp;v; //save argument address\n  *(p-1) = *add; //return address = address in main\n  return 1;\n}\nint foo1(void)\n{\n    printf(\"hi1\");\n    foo2();\n    printf(\"hi2\");\n    return 0;\n}\nint foo2(void)\n{\n    int a;      \n    longjmp(a);\n    return 0;\n}//output SHOULD be \"hi1\"\n //output is currently \"hi1\" \"hi2\"\n</code></pre>\n\n<p>for what it's worth every line I have not commented was given as a skeleton and I cannot change it.</p>\n\n<p>Excuse me in advance if something is off, I am quite new to C. Thank you.</p>\n"}, {"tags": ["python", "c", "matlab", "loops", "append"], "comments": [{"owner": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 0, "creation_date": 1494995684, "post_id": 44015587, "comment_id": 75058753, "body": "Do you have any prototype of your code? Give more details of your files. What is the structure of these files? Are they tab or comma-delimited? If this is the case, I suggest that you read about the csv module (<a href=\"https://docs.python.org/3/library/csv.html\" rel=\"nofollow noreferrer\">docs.python.org/3/library/csv.html</a>)."}, {"owner": {"reputation": 117, "user_id": 6458660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20f889a9848dfa7486cd8dc0b1bbd15?s=128&d=identicon&r=PG&f=1", "display_name": "RD017", "link": "https://stackoverflow.com/users/6458660/rd017"}, "reply_to_user": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 0, "creation_date": 1494996073, "post_id": 44015587, "comment_id": 75058894, "body": "@Felipe All the data files are in <code>.txt</code> format. There are M rows and 3 columns with only numerical values and no text (not even header). The numerical values are tab-delimited."}], "answers": [{"comments": [{"owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "reply_to_user": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 1, "creation_date": 1494996301, "post_id": 44015734, "comment_id": 75058971, "body": "Files whose name match a glob wildcard string."}, {"owner": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 0, "creation_date": 1494996444, "post_id": 44015734, "comment_id": 75059013, "body": "Gosh, what a great module! Thanks for the tip!!"}, {"owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "reply_to_user": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 0, "creation_date": 1494996949, "post_id": 44015734, "comment_id": 75059187, "body": "How about this sexy &#39;/&#39; operator overload? <code>dir_path = Path(&#39;&#47;tmp&#47;some&#47;dir&#39;); file_in_dir = dir_path &#47; &#39;data1.txt&#39;</code>  And there is also <code>rglob</code> for recursive glob."}, {"owner": {"reputation": 117, "user_id": 6458660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20f889a9848dfa7486cd8dc0b1bbd15?s=128&d=identicon&r=PG&f=1", "display_name": "RD017", "link": "https://stackoverflow.com/users/6458660/rd017"}, "edited": false, "score": 0, "creation_date": 1494997179, "post_id": 44015734, "comment_id": 75059253, "body": "I am getting following error while running this code: <code>SyntaxError: Invalid syntax</code> for the line 5, that is <code>yield from path.open()</code>"}, {"owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "edited": false, "score": 0, "creation_date": 1494997286, "post_id": 44015734, "comment_id": 75059278, "body": "<code>yield from</code> is fairly new, I think Python 3.5. Replace it with <code>for line in path.open(): yield line</code>"}, {"owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "edited": false, "score": 0, "creation_date": 1494997455, "post_id": 44015734, "comment_id": 75059334, "body": "Or, since you are just concatenting all the lines anyway, change that line to <code>yield path.read_text()</code>. My original idea with <code>all_files</code> was to make it a line-by-line iterator that would chain through all the matching files like they were one big file. But since you are just appending them all anyway, just yield the whole content of the file, as returned by <code>path.read_text()</code>"}, {"owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "edited": false, "score": 0, "creation_date": 1494998022, "post_id": 44015734, "comment_id": 75059504, "body": "The problem is that &#39;data_all.txt&#39; matches the same &#39;data*.txt&#39; wildcard that matches &#39;data1.txt&#39;, &#39;data2.txt&#39;, etc. Try writing <code>data_all.txt</code> to a directory that is different from where all the others are stored."}, {"owner": {"reputation": 117, "user_id": 6458660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20f889a9848dfa7486cd8dc0b1bbd15?s=128&d=identicon&r=PG&f=1", "display_name": "RD017", "link": "https://stackoverflow.com/users/6458660/rd017"}, "edited": false, "score": 0, "creation_date": 1494998153, "post_id": 44015734, "comment_id": 75059548, "body": "Yeah, I got that. I just renamed <code>data_all.txt</code> to <code>all-data.txt</code> so that it won&#39;t match the name structure."}], "tags": [], "owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "is_accepted": true, "score": 0, "last_activity_date": 1494995987, "creation_date": 1494995987, "answer_id": 44015734, "question_id": 44015587, "link": "https://stackoverflow.com/questions/44015587/read-data-from-text-files-having-same-name-structure-and-append-all-data-into-a/44015734#44015734", "title": "Read data from text files having same name structure and append all data into a new file", "body": "<p><code>pathlib</code> module is great for globbing matching files, and for easy read/write:</p>\n\n<pre><code>from pathlib import Path\n\ndef all_files(dir, mask):\n    for path in Path(dir).glob(mask):\n        yield from path.open()\n\nPath('data_all.txt').write_text(''.join(all_files('.', 'data*.txt')))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 778, "user_id": 4654001, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/VzRFq.jpg?s=128&g=1", "display_name": "jarry jafery", "link": "https://stackoverflow.com/users/4654001/jarry-jafery"}, "is_accepted": false, "score": 0, "last_activity_date": 1494996882, "last_edit_date": 1494996882, "creation_date": 1494996060, "answer_id": 44015748, "question_id": 44015587, "link": "https://stackoverflow.com/questions/44015587/read-data-from-text-files-having-same-name-structure-and-append-all-data-into-a/44015748#44015748", "title": "Read data from text files having same name structure and append all data into a new file", "body": "<p>In python First of all you have to create the list of all file paths you can use the glob library in python.</p>\n\n<pre><code>import glob\nimport pandas as pd\npath_list = glob.glob('Path/To/Your/DataFolder/pattern(data*)')\n</code></pre>\n\n<p>then you can read that data using list comprehension.it will give you the list of data frames depending upon the data files in your folder</p>\n\n<pre><code>list_data = [pd.read_csv(x,sep='\\t') for x in path_list]\n</code></pre>\n\n<p>It will combine the data in single data frame and you can write it as a single dataframe. </p>\n\n<pre><code>data_all = pd.concat(list_data,ignore_index=True)\n</code></pre>\n\n<p>now you can write the dataframe in a single file.</p>\n\n<pre><code>data_all.to_csv('Path',sep=',')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 428, "user_id": 4232851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8f52d03e75f313b31a20e0398d4d59?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed Yasin", "link": "https://stackoverflow.com/users/4232851/mohammed-yasin"}, "is_accepted": false, "score": 0, "last_activity_date": 1494996844, "last_edit_date": 1494996844, "creation_date": 1494996099, "answer_id": 44015755, "question_id": 44015587, "link": "https://stackoverflow.com/questions/44015587/read-data-from-text-files-having-same-name-structure-and-append-all-data-into-a/44015755#44015755", "title": "Read data from text files having same name structure and append all data into a new file", "body": "<p>Use python <strong>zip</strong> and the <strong>csv</strong> module to achieve this. Within a single for loop:</p>\n\n<p>For Example:</p>\n\n<pre><code>import csv\nwith open(\"data_all.csv\", \"w\") as f:\n    csv_writer = csv.writer(f)\n    for d1, d2, d3 in zip(open(\"data1.txt\", \"r\"), open(\"data2.txt\", \"r\"), open(\"data3.txt\", \"r\")):\n        csv_writer.writerow([d1, d2, d3])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2112, "user_id": 8023022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3315b021ac1d71e530939df988841d?s=128&d=identicon&r=PG&f=1", "display_name": "orabis", "link": "https://stackoverflow.com/users/8023022/orabis"}, "is_accepted": false, "score": 0, "last_activity_date": 1494997873, "last_edit_date": 1494997873, "creation_date": 1494996121, "answer_id": 44015764, "question_id": 44015587, "link": "https://stackoverflow.com/questions/44015587/read-data-from-text-files-having-same-name-structure-and-append-all-data-into-a/44015764#44015764", "title": "Read data from text files having same name structure and append all data into a new file", "body": "<p>It can be done through reading the content of each file, and writing them into an output file handle. The files structure in your description contains numbers, so we might need to call sorted to sort them before start reading. The \"files_search_pattern\" should point out to the input directory 'PATH/*.txt' and the same for the output file handle \"data-all.txt\"</p>\n\n<pre><code>import glob\n\nfiles_search_pattern = \"*.txt\"\n\nfiles = sorted(glob.glob(files_search_pattern))\n\nwith open(\"data-all.txt\", \"wb\") as output:\n    for f in files:\n        with open(f, \"rb\") as inputFile:\n            output.write(inputFile.read())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 7993347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ece31db05117d58a9248cbd1b7752c6?s=128&d=identicon&r=PG&f=1", "display_name": "eDog", "link": "https://stackoverflow.com/users/7993347/edog"}, "is_accepted": false, "score": 0, "last_activity_date": 1494996653, "creation_date": 1494996653, "answer_id": 44015867, "question_id": 44015587, "link": "https://stackoverflow.com/questions/44015587/read-data-from-text-files-having-same-name-structure-and-append-all-data-into-a/44015867#44015867", "title": "Read data from text files having same name structure and append all data into a new file", "body": "<p>In windows,  use\ncopy data*.txt data-all.txt</p>\n\n<p>In Unix, use\ncat data*.txt >> data-all.txt</p>\n"}], "owner": {"reputation": 117, "user_id": 6458660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20f889a9848dfa7486cd8dc0b1bbd15?s=128&d=identicon&r=PG&f=1", "display_name": "RD017", "link": "https://stackoverflow.com/users/6458660/rd017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 44015734, "answer_count": 5, "score": 0, "last_activity_date": 1494997873, "creation_date": 1494995270, "question_id": 44015587, "link": "https://stackoverflow.com/questions/44015587/read-data-from-text-files-having-same-name-structure-and-append-all-data-into-a", "title": "Read data from text files having same name structure and append all data into a new file", "body": "<p>I have some data files, say <code>data1.txt</code>, <code>data 2.txt</code>,... and so on. I want to read all these data files using a single loop structure and append the data values into a single file, say data-all.txt.</p>\n\n<p>I am fine with any of the following programming languages: <code>c</code>, <code>python</code>, <code>matlab</code></p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 1, "creation_date": 1494994173, "post_id": 44015332, "comment_id": 75058288, "body": "s1 is not allocated"}], "answers": [{"comments": [{"owner": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "edited": false, "score": 0, "creation_date": 1494995624, "post_id": 44015385, "comment_id": 75058728, "body": "I just want to declare pointer to a structure and to access *ptr member through it...Here i see that s1 is just a structure and not pointer to a structure. am i right?"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "reply_to_user": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "edited": false, "score": 0, "creation_date": 1495000203, "post_id": 44015385, "comment_id": 75060390, "body": "If you want a pointer you have to use <code>malloc</code> to allocate it. I will update the code"}, {"owner": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "edited": false, "score": 0, "creation_date": 1495001620, "post_id": 44015385, "comment_id": 75061043, "body": "Thanks Orel.  For better understanding of this concept,Is it not possible to assign the value of *ptr member without using malloc() ? .... the other way is that can we initialize the structure member with some address of variable as mentioned in question ?"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "reply_to_user": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "edited": false, "score": 0, "creation_date": 1495001801, "post_id": 44015385, "comment_id": 75061124, "body": "Your pointer needs to point somewhere, if you are not using the stack you need to use the heap."}, {"owner": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "edited": false, "score": 0, "creation_date": 1495002236, "post_id": 44015385, "comment_id": 75061361, "body": "so what i understand is that  *s1 should point to either stack memory or heap memory.  But,in my code, *s1 doesn&#39;t point to stack memory and that causes the problem right? so s1-&gt;ptr   = &amp;roll; is not valid statement"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "reply_to_user": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "edited": false, "score": 0, "creation_date": 1495002312, "post_id": 44015385, "comment_id": 75061413, "body": "Yes in your case s1 is null, the global are set to 0. So s1-&gt;ptr is invalid"}, {"owner": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "reply_to_user": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1495002358, "post_id": 44015385, "comment_id": 75061437, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/144414/discussion-between-danny-and-orel\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "is_accepted": true, "score": 2, "last_activity_date": 1495000534, "last_edit_date": 1495000534, "creation_date": 1494994224, "answer_id": 44015385, "question_id": 44015332, "link": "https://stackoverflow.com/questions/44015332/understanding-pointer-to-a-structure-refers-to-pointer-member-in-c-in-accessing/44015385#44015385", "title": "understanding pointer to a structure refers to pointer member in c in accessing it", "body": "<p>Create a <code>Student</code> structure, allocate it and use it</p>\n\n<pre><code>typedef struct Student\n{\n   unsigned int  *ptr;  //Stores address of integer Variable\n} Student;\n\nint main()\n{\n    Student *s1;\n    unsigned int roll = 20;\n    s1 = malloc(sizeof(Student));\n    if (s1 == NULL) {\n        return -1;\n    }\n    s1-&gt;ptr   = &amp;roll;\n\n    printf(\"\\nRoll Number of Student : %d\",*(s1-&gt;ptr));\n    free(s1);\n\n    return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 1389, "user_id": 1509439, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2ef2e866a2e63fd648f79d4dcbecf86a?s=128&d=identicon&r=PG", "display_name": "danny", "link": "https://stackoverflow.com/users/1509439/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 44015385, "answer_count": 1, "score": 0, "last_activity_date": 1495000534, "creation_date": 1494993774, "question_id": 44015332, "link": "https://stackoverflow.com/questions/44015332/understanding-pointer-to-a-structure-refers-to-pointer-member-in-c-in-accessing", "title": "understanding pointer to a structure refers to pointer member in c in accessing it", "body": "<p>I have a below program and compilation is success but while running,program crashes in eclipse </p>\n\n<pre><code>struct Student\n{\n   unsigned int  *ptr;  //Stores address of integer Variable\n}*s1;\n\nint main()\n{\n    unsigned int roll = 20;\n    s1-&gt;ptr   = &amp;roll;\n\n    printf(\"\\nRoll Number of Student : %d\",*(s1-&gt;ptr));\n\n    return(0);\n}\n</code></pre>\n\n<p>how to print the value of roll using pointer to a structure </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993338, "post_id": 44015230, "comment_id": 75058055, "body": "did you hit enter? enter is how it knows that you finished typing the number"}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "reply_to_user": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993553, "post_id": 44015230, "comment_id": 75058115, "body": "yes, I did hit enter. I entered a simple number and hit enter and it is not running, it is not even printing hello,"}, {"owner": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993702, "post_id": 44015230, "comment_id": 75058172, "body": "it prints hello here, after I put the number in. Can you be more clear about what&#39;s happening? Is the console appearing with the &quot;enter kl&quot; message?"}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "reply_to_user": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993759, "post_id": 44015230, "comment_id": 75058184, "body": "yes the console is showing enter kl, after that I have typed a number and pressed enter."}, {"owner": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993775, "post_id": 44015230, "comment_id": 75058189, "body": "what is it printing? how far does it get? like i said, it works fine here"}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "reply_to_user": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993900, "post_id": 44015230, "comment_id": 75058215, "body": "I tried removing for loop and then it is working but with for loop it is not running"}, {"owner": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494993944, "post_id": 44015230, "comment_id": 75058223, "body": "You don&#39;t have a very sensible looking for loop, describe what numbers it&#39;s mean to iterate between."}, {"owner": {"reputation": 28365, "user_id": 2811, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b0b95da09af2d4881a50b25f091798a?s=128&d=identicon&r=PG", "display_name": "diciu", "link": "https://stackoverflow.com/users/2811/diciu"}, "edited": false, "score": 1, "creation_date": 1494994041, "post_id": 44015230, "comment_id": 75058250, "body": "<code>scanf</code> works, your code is stuck in the loop. Use <code>printf(&quot;hello\\n&quot;)</code> to flush stdout otherwise it&#39;s not printed. to read a double you should use &quot;%lg&quot;."}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "edited": false, "score": 0, "creation_date": 1494994049, "post_id": 44015230, "comment_id": 75058252, "body": "the code is for finding square root using newton raphson method."}, {"owner": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494994059, "post_id": 44015230, "comment_id": 75058254, "body": "The problem is that your loop runs forever, you should put print statements inside the loop for the values, to check that they&#39;re actually changing properly"}, {"owner": {"reputation": 999, "user_id": 3274625, "user_type": "registered", "profile_image": "https://graph.facebook.com/1062648629/picture?type=large", "display_name": "Jason Lang", "link": "https://stackoverflow.com/users/3274625/jason-lang"}, "edited": false, "score": 0, "creation_date": 1494994111, "post_id": 44015230, "comment_id": 75058277, "body": "also the for loop is less clear here than just using a while loop"}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "edited": false, "score": 0, "creation_date": 1494994257, "post_id": 44015230, "comment_id": 75058315, "body": "can&#39;t we use %lg %lf and %le for double?"}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "edited": false, "score": 0, "creation_date": 1494994434, "post_id": 44015230, "comment_id": 75058356, "body": "why is \\n requires? in printf. It runs every time I use without \\n"}, {"owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "edited": false, "score": 0, "creation_date": 1494994603, "post_id": 44015230, "comment_id": 75058410, "body": "Can we use || in the for condition ?"}], "answers": [{"tags": [], "owner": {"reputation": 28365, "user_id": 2811, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b0b95da09af2d4881a50b25f091798a?s=128&d=identicon&r=PG", "display_name": "diciu", "link": "https://stackoverflow.com/users/2811/diciu"}, "is_accepted": false, "score": 3, "last_activity_date": 1494994827, "creation_date": 1494994827, "answer_id": 44015505, "question_id": 44015230, "link": "https://stackoverflow.com/questions/44015230/scanf-is-not-taking-input-of-type-double/44015505#44015505", "title": "Scanf is not taking input of type double", "body": "<p>The problem is not <code>scanf</code>, it is an infinite loop (your <code>for</code> loop has an empty body).</p>\n\n<p>The compiler tells you that:</p>\n\n<pre><code>d:tmp diciu$ gcc -g test2.c\n[..]\ntest2.c:11:44: warning: for loop has empty body [-Wempty-body]\n for(x1=kl;((x1-x0)&gt;2) || ((x1-x0)&lt;-2);x0 );  \n                                           ^ this semicolon creates the empty body\n</code></pre>\n\n<p>Your semicolon at the end of the for loop tells the compiler to generate a for loop with an empty body.</p>\n\n<p>While reading the code tells you the problem is in the <code>scanf</code> because you don't see the \"hello\" string being printed your assumption is incorrect; <code>stdout</code> if buffered and you're not seeing the string because you have not flushed the buffer; you can force a buffer flush by adding a line terminator (<code>printf(\"hello\\n\")</code>) or by flushing stdout (look up <code>fflush</code>).</p>\n\n<p>Even if you miss the compiler warning, the problem is very easily spotted using a debugger.</p>\n"}], "owner": {"reputation": 1, "user_id": 8023065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb565df86b6bf6dd3942e09e27b5d10?s=128&d=identicon&r=PG&f=1", "display_name": "jasmine berry", "link": "https://stackoverflow.com/users/8023065/jasmine-berry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1495013679, "creation_date": 1494993082, "last_edit_date": 1495013679, "question_id": 44015230, "link": "https://stackoverflow.com/questions/44015230/scanf-is-not-taking-input-of-type-double", "title": "Scanf is not taking input of type double", "body": "<p>This is the code i am running    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid main()    \n{\n int i=0;\n double kl,x0,x1,xk;\n printf(\"enter kl\");\n scanf(\"%lf\",&amp;kl);  \n printf(\"hello\");\n for(x1=kl;((x1-x0)&gt;2) || ((x1-x0)&lt;-2);x0 );  \n  {\n   x0=x1;\n   x1=(x0/2.0)+(kl/(2.0*x0));\n\n   }\n printf(\"%lf\",x1); \n printf(\" %lf \",(sqrt(kl)-x1));\n} \n</code></pre>\n\n<p>after running <code>scanf</code> is not taking input. hello is not printed.</p>\n"}, {"tags": ["c", "compression", "binaryfiles"], "comments": [{"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 4, "creation_date": 1494992746, "post_id": 44015107, "comment_id": 75057922, "body": "If you are only replacing <code>65</code> with <code>A</code> how can the <code>\\n</code> be affected in the compressed file? Another thought, if you have price: 650 what is your plan?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 3, "creation_date": 1494994729, "post_id": 44015107, "comment_id": 75058446, "body": "You should not convert or you should escape. Does this really provide any reasonable savings compared to the trouble it will bring?"}, {"owner": {"reputation": 280, "user_id": 5302699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d484ac38c33bb7e686501839d91780?s=128&d=identicon&r=PG&f=1", "display_name": "LiuGui", "link": "https://stackoverflow.com/users/5302699/liugui"}, "reply_to_user": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1495005374, "post_id": 44015107, "comment_id": 75063208, "body": "@lU5er If the price is 650, I will convert 650 to 16bit binary number and then convert to two characters. Because the price is random, so if one price is 10, the ASCII character is LF(means a new line), so it will disturb me to separate each component by two lines."}, {"owner": {"reputation": 280, "user_id": 5302699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d484ac38c33bb7e686501839d91780?s=128&d=identicon&r=PG&f=1", "display_name": "LiuGui", "link": "https://stackoverflow.com/users/5302699/liugui"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1495005809, "post_id": 44015107, "comment_id": 75063524, "body": "@SamiKuhmonen For example, the price is 65082, if I use char to save each number, I will need 5 characters. But if I convert 65082 to 16-bit binary number, then convert it to 2 characters, I just need 2 characters. The real problem maybe much more complicated. For example, the content is not the price but <code>120BCDCDABBAC</code>, there are 10 letters but only 4 kind after 120. So I can use  each two bit to represent a letter such as <code>00</code> to represent &#39;A&#39;, then I convert every 8 bit to a character, so I can save much more space"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1495005921, "post_id": 44015107, "comment_id": 75063602, "body": "And when you add all the escaping, what percentage of the data is &quot;compressable&quot; by this, how much time is spent in implementing, compressing, decompressing... Sure you can do this, but using just an off-the-shelf general compression algorithm would get you better results with a lot less work."}, {"owner": {"reputation": 280, "user_id": 5302699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d484ac38c33bb7e686501839d91780?s=128&d=identicon&r=PG&f=1", "display_name": "LiuGui", "link": "https://stackoverflow.com/users/5302699/liugui"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1495006470, "post_id": 44015107, "comment_id": 75063930, "body": "@SamiKuhmonen So, if I save the information use characters directly, then I use a compression software to compress it, I will get a much more better result? If I convert the char to binary then to character, then I use a compression software again, how about that?"}], "owner": {"reputation": 280, "user_id": 5302699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d484ac38c33bb7e686501839d91780?s=128&d=identicon&r=PG&f=1", "display_name": "LiuGui", "link": "https://stackoverflow.com/users/5302699/liugui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494992189, "creation_date": 1494992189, "question_id": 44015107, "link": "https://stackoverflow.com/questions/44015107/parse-binary-file-in-c-how-to-count-lines", "title": "Parse binary file in C, how to count lines?", "body": "<p>I have a text file, every two lines compose a component. For example:</p>\n\n<pre><code>name1\ncontent1\nname2\ncontent2\n....\n</code></pre>\n\n<p>To compress my file size, I convert a digital number of my content to 8-bit character. For example, the original text of the first component is:</p>\n\n<pre><code>Milk\nprice: 65\n</code></pre>\n\n<p>Then I compress the text to:</p>\n\n<pre><code>Milk\nprice: A\n</code></pre>\n\n<p>'A' is a ASCII character, and it's equal to 64 when convert into decimal. So I can save one byte from 65 to A. However, when I read the compressed file, I have a problem:</p>\n\n<p>When I read the original text file, I can handle every component every two lines. That is, when I read the first two lines and find two '\\n', I know this is the first component. When I read the second two lines and find two '\\n', I know this is the second component. However, when I read the compressed file, a digital number my convert to a '\\n' ASCII character, so I can't separate each component by two '\\n'. So, what should I do? Any reply will be much appreciated!</p>\n"}, {"tags": ["c", "function", "call"], "comments": [{"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1494992524, "post_id": 44015103, "comment_id": 75057880, "body": "Is your question based on order of function placing?"}, {"owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "edited": false, "score": 1, "creation_date": 1494992865, "post_id": 44015103, "comment_id": 75057949, "body": "Well, <i>declare</i> all functions before <i>defining</i> them."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1494992868, "post_id": 44015103, "comment_id": 75057951, "body": "add a declaration for <code>void do2(int input);</code> above <code>void do1(int input)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 388, "user_id": 7892010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb22306a8bdbe2dfcfa54ec6e0edca5?s=128&d=identicon&r=PG&f=1", "display_name": "Manny_Mar", "link": "https://stackoverflow.com/users/7892010/manny-mar"}, "is_accepted": false, "score": 2, "last_activity_date": 1495006923, "last_edit_date": 1495006923, "creation_date": 1494992854, "answer_id": 44015191, "question_id": 44015103, "link": "https://stackoverflow.com/questions/44015103/calling-a-function-to-another-function-vise-versa-in-c/44015191#44015191", "title": "Calling a function to another function vise versa in C", "body": "<p>Just put a function declaration above</p>\n\n<pre><code>void do2(int input);\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>void do1(int input)\n\n{\n  do2(1);\n}\n\nvoid do2(int input)\n{\n  do1(2);\n}\n</code></pre>\n\n<p>And it will work.</p>\n"}], "owner": {"reputation": 1, "user_id": 8023063, "user_type": "registered", "profile_image": "https://graph.facebook.com/1772507812764355/picture?type=large", "display_name": "Changheon Chung", "link": "https://stackoverflow.com/users/8023063/changheon-chung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495006923, "creation_date": 1494992176, "last_edit_date": 1494992463, "question_id": 44015103, "link": "https://stackoverflow.com/questions/44015103/calling-a-function-to-another-function-vise-versa-in-c", "title": "Calling a function to another function vise versa in C", "body": "<p>If I have a function called </p>\n\n<pre><code>void do1(int input)\n\n{\ndo2(1);\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>void do2(int input)\n{\ndo1(2);\n}\n</code></pre>\n\n<p>right under eachother, is there a way for do1 function to call do2 function?</p>\n"}, {"tags": ["c", "process", "operating-system"], "comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 2, "creation_date": 1494996302, "post_id": 44015093, "comment_id": 75058972, "body": "Try adding a new line &quot;\\n&quot; to your printf... stdout is buffered."}, {"owner": {"reputation": 1093, "user_id": 3968346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ksx6B.png?s=128&g=1", "display_name": "Musen", "link": "https://stackoverflow.com/users/3968346/musen"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1494998450, "post_id": 44015093, "comment_id": 75059664, "body": "adding &quot;\\n&quot; helps to print out the message, thank you! However, the child process still does not become zombie."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1495131575, "post_id": 44024252, "comment_id": 75135267, "body": "Calling <code>_exit()</code> is a good habit? what?  what&#39;s the reason of installing exit handlers then? This is the first time I hear this in my 40+ years experience in programming. 8/"}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1495131908, "post_id": 44024252, "comment_id": 75135463, "body": "In the child, not in general. And that&#39;s to not call them multiple times."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1495132858, "post_id": 44024252, "comment_id": 75135995, "body": "a good habit is something you do always in your programs.  calling <code>_exit()</code> instead of <code>exit()</code> is <b>not</b> a good habit.  I&#39;ts a fool&#39;s habit, so you don&#39;t allow for files to be closed or state to be saved.  Libraries make use of it, so a good habit is to allow at exit handlers to be executed. As you have two processes, you have two instances of the execution environment of all libraries, so the at exit handlers probably must be executed in both.  The installer of an <code>atexit()</code> handler should consider that before installing a handler, or document correctly if calling it after <code>fork()</code> is ok."}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1495193010, "post_id": 44024252, "comment_id": 75161363, "body": "Your own example of &quot;files to be closed&quot; shows how this fails. f = fopen(...); fprintf(f, &quot;now what&quot;); fork(); exit(0);. Suddenly you got a dupllicated write if you didn&#39;t explicitly intervene by e.g. flushing first. I&#39;m yet to see a library maintaining a global state which does not require handholding w.r.t forks and exits. If there is one, and may happen to start using it, I expect the requirement to be documented. However, I expect any sane library to explicitly tell me what to call to cleanup instead (if there is any need)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1495442356, "post_id": 44024252, "comment_id": 75236002, "body": "Yes, I know that.  This probably should be documented as some kind of interaction between <code>fork()</code> and <code>exit()</code>, but doesn&#39;t make avoiding <code>exit()</code> on behalf of <code>_exit()</code> a general rule to recommend its use as <b>good use</b>."}], "tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": false, "score": -1, "last_activity_date": 1495022369, "creation_date": 1495022369, "answer_id": 44024252, "question_id": 44015093, "link": "https://stackoverflow.com/questions/44015093/a-child-process-that-calls-exit-but-does-not-become-a-zombie/44024252#44024252", "title": "A Child Process That Calls Exit() But Does Not Become A Zombie", "body": "<p>What do you mean \"the child process does not appear in ps -l as a zombie process\"? What state do you see instead? Or perhaps you mean you don't see the child in the first place? To be clear, you can inspect the process by running \"ps 1234\" (or whatever pid you get).</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\npid_t pid;\n</code></pre>\n\n<p>Why is this a global?</p>\n\n<pre><code>int main() {\n</code></pre>\n\n<p>Should be int main(void).</p>\n\n<pre><code>  pid = fork();\n  if (pid == 0) {\n    exit(0);\n</code></pre>\n\n<p>Should be _Exit to avoid calling \"at exit\" handlers. Does not matter in this toy example, but there is no reason to cultivate wrong habits.</p>\n\n<pre><code>  } else {\n   printf(\"the child process is %d\", pid);\n    sleep(20);\n</code></pre>\n\n<p>You can just pause() or getchar() instead.</p>\n\n<pre><code>  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1495025299, "creation_date": 1495025299, "answer_id": 44025350, "question_id": 44015093, "link": "https://stackoverflow.com/questions/44015093/a-child-process-that-calls-exit-but-does-not-become-a-zombie/44025350#44025350", "title": "A Child Process That Calls Exit() But Does Not Become A Zombie", "body": "<p>Two issues here.  The first is that you don't have a newline (<code>\\n</code>) at the end of your <code>printf</code> string.  Since stdout is line buffered, the output won't be flushed from the output buffer unless you either print a newline or you explicitly flush the stream.  </p>\n\n<p>So add a newline and it should print right away:</p>\n\n<pre><code>printf(\"the child process is %d\\n\", pid);\n</code></pre>\n\n<p>The main reason you aren't seeing the child pid has to do with how you're using the <code>ps</code> command.  Assuming you're calling <code>ps</code> from a different shell that the one that runs this code, <code>ps -l</code> only shows processes from session running the command.  So processes started from other sessions / shells won't appear.</p>\n\n<p>If you use the <code>-e</code> option (i.e. <code>ps -el</code> or <code>ps -ef</code>), this will show you the full list of processes in the system.  Then you should be able to see the zombie process.</p>\n"}, {"comments": [{"owner": {"reputation": 1093, "user_id": 3968346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ksx6B.png?s=128&g=1", "display_name": "Musen", "link": "https://stackoverflow.com/users/3968346/musen"}, "edited": false, "score": 0, "creation_date": 1495180101, "post_id": 44055477, "comment_id": 75153016, "body": "Thank you! Actually <code>ps child_id</code> displays the zombie process, but it does not appear when I just <code>ps</code>."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1495132510, "last_edit_date": 1592644375, "creation_date": 1495132510, "answer_id": 44055477, "question_id": 44015093, "link": "https://stackoverflow.com/questions/44015093/a-child-process-that-calls-exit-but-does-not-become-a-zombie/44055477#44055477", "title": "A Child Process That Calls Exit() But Does Not Become A Zombie", "body": "<p>I have no access until tomorrow to a MAC OS system, but your program <strong>successfully</strong> creates a zombie process in linux systems.  I have modified your sample code to add a message when the parent process exits, and the already commented <code>\\n</code> char to end properly the line and produce output at the point of <code>printf()</code> call:</p>\n<h1>zombie.c</h1>\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\npid_t pid;\n\nint main() {\n  pid = fork();\n  if (pid == 0) {\n    exit(0);\n  } else {\n    printf(&quot;the child process is %d\\n&quot;, pid);\n    sleep(20);\n    printf(&quot;exit();\\n&quot;);\n  }\n}\n</code></pre>\n<p>And the output in linux is:</p>\n<pre><code>$ zombie &amp;\n[1] 5781\nthe child process is 5786\n\n$ ps\n  PID TTY          TIME CMD\n 2569 pts/0    00:00:00 bash\n 5781 pts/0    00:00:00 zombie\n 5786 pts/0    00:00:00 zombie &lt;defunct&gt;   &lt;-- this is the zombie.\n 5795 pts/0    00:00:00 ps\n\n$ exit();  &lt;-- zombie program finishing.\n</code></pre>\n<p>On FreeBSD (and MAC OS is very similar to it) the thing goes as:</p>\n<pre><code>$ zombie &amp;\n[1] 7326\nthe child process is 7329\n$ ps\n  PID TT  STAT       TIME COMMAND\n 7281  0  Ss      0:00,18 -bash (bash)\n 7326  0  S       0:00,02 zombie\n 7329  0  Z       0:00,00 &lt;defunct&gt;  &lt;-- this is the zombie.\n 7335  0  R+      0:00,01 ps\n$ exit();  &lt;-- zombie program finishing.\n</code></pre>\n<p>Tomorrow I'll be able to do the same in a Mac OS X system, and include a third system that creates zombie processes.</p>\n"}], "owner": {"reputation": 1093, "user_id": 3968346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ksx6B.png?s=128&g=1", "display_name": "Musen", "link": "https://stackoverflow.com/users/3968346/musen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1495132510, "creation_date": 1494992131, "last_edit_date": 1495009338, "question_id": 44015093, "link": "https://stackoverflow.com/questions/44015093/a-child-process-that-calls-exit-but-does-not-become-a-zombie", "title": "A Child Process That Calls Exit() But Does Not Become A Zombie", "body": "<p>For learning purpose, I wrote a piece of code to generate zombie processes. Here is the code:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\npid_t pid;\n\nint main() {\n  pid = fork();\n  if (pid == 0) {\n    exit(0);\n  } else {\n   printf(\"the child process is %d\", pid);\n    sleep(20);\n  }\n}\n</code></pre>\n\n<p>In my assumption, the codes above should behave in such a way: the child process receive <code>pid</code> of 0 and <code>exit</code> with status code 0; the parent process receive <code>pid</code> of the child process and print it out and go to sleep for 20 seconds. Because the parent process does not call <code>wait</code> when the child process <code>exit</code>, the child process should be zombie for about 20 seconds. </p>\n\n<p>However, when I run the codes, it waits for about 20 seconds and print out the child process's pid. In the 20 seconds, the child process does not appear in <code>ps -l</code> as a zombie process.</p>\n\n<p>Can someone tell me what makes the difference between my understanding of the codes and its actual behavior?</p>\n\n<p>P.S. I am using Mac OS Sierra.</p>\n"}, {"tags": ["c", "loops", "exit"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7987230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ea241cf0de2cc21e33f7cf54c10c53?s=128&d=identicon&r=PG&f=1", "display_name": "C. Hubbard", "link": "https://stackoverflow.com/users/7987230/c-hubbard"}, "is_accepted": false, "score": 0, "last_activity_date": 1494991455, "creation_date": 1494991455, "answer_id": 44014983, "question_id": 44014860, "link": "https://stackoverflow.com/questions/44014860/determining-the-proper-loop-to-use/44014983#44014983", "title": "determining the proper loop to use", "body": "<p>There a couple different options you could choose here, both the while and the do while loop would work. Personally, I would say that a do while loop would be better fit for this case, mostly because you know for sure that you want the program to prompt the user at least once. In order to use it you would need to place the do before the printf statements and then run while some scanf input at the end is != \"Q\"</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "is_accepted": false, "score": 0, "last_activity_date": 1494991537, "creation_date": 1494991537, "answer_id": 44014996, "question_id": 44014860, "link": "https://stackoverflow.com/questions/44014860/determining-the-proper-loop-to-use/44014996#44014996", "title": "determining the proper loop to use", "body": "<p>You can use a <code>while</code> loop, along with another character case to exit out of the loop.</p>\n\n<pre><code>char grade;\n\nwhile (1)\n{\n    printf(\"Enter a single character grade (or 'X' to exit): \");\n    scanf(\" %c\", &amp;grade);\n    printf(\"You entered %c as the grade.  \", grade);\n\n    if (grade == 'X') // Or another letter, make it clear what you're using\n    {\n        break;\n    }\n\n    // Output code here...\n}\n</code></pre>\n\n<p>I would also recommend you check for both lowercase and uppercase letters. In the <code>switch</code> statement:</p>\n\n<pre><code>case 'A':\ncase 'a':\n    printf(\"The grade range for A and A- is 100%% - 90%%.\");\n    break;\n</code></pre>\n\n<p>In the <code>if</code> statement:</p>\n\n<pre><code>if (grade == 'X' || grade == 'x')\n{\n    break;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": false, "score": 0, "last_activity_date": 1494992108, "creation_date": 1494992108, "answer_id": 44015090, "question_id": 44014860, "link": "https://stackoverflow.com/questions/44014860/determining-the-proper-loop-to-use/44015090#44015090", "title": "determining the proper loop to use", "body": "<p>To repeat an action indefinitely, you could wrap it inside a <code>while</code> loop with a condition that is always true (e.g., <code>while (1) { ... }</code>) as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n    char grade;\n\n    while (1)\n    {\n        printf(\"Enter a single character grade (or Q to quit):\\n\");\n        scanf(\" %c\", &amp;grade);\n        grade = toupper(grade);\n        if (grade == 'Q') break;\n\n        printf(\"You entered %c as the grade.\\n\", grade);\n\n        switch(grade)\n        {\n            case 'A':\n                printf(\"The grade range for A and A- is 100%% - 90%%.\\n\");\n                break;\n            case 'B':\n                printf(\"The grade range for B and B- is 80%% - 89%%.\\n\");\n                break;\n            case 'C':\n                printf(\"The grade range for C and C- is 70%% - 79%%.\\n\");\n                break;\n            case 'D':\n                printf(\"The grade range for D and D- is 60%% - 69%%.\\n\");\n                break;\n            case 'F':\n                printf(\"The grade range for F is 0%% - 59%%.\\n\");\n                break;\n            default:\n                printf(\"That grade does not exist.\\n\");\n                break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>You'll notice I've made a few other modifications, which I'll run through here:</p>\n\n<ol>\n<li><p><code>include \"stdio.h\"</code> should really be <code>#include &lt;stdio.h&gt;</code>. The angle brackets tell the compiler to look in the standard directory for system header files.</p></li>\n<li><p>I also added <code>#include &lt;ctype.h&gt;</code> because I'm using the <code>toupper()</code> function to convert the input character to upper case. This makes your code easier to use, because it will now accept both upper and lower case letters.</p></li>\n<li><p>The <code>scanf()</code> format string includes a space before <code>%c</code>. This will skip over any white space characters including newline characters. Without it, the program would treat these characters as actual inputs and tell you that the <code>\\n</code> grade does not exist.</p></li>\n<li><p>The <code>break</code> statement can be used to exit the loop when the user enters Q. There were also a couple of <code>break</code>s missing from your <code>switch</code> block.</p></li>\n<li><p>The <code>main()</code> function is declared as <code>int main() { ... }</code>, so it should return an integer value. If no errors have occurred, this value should be zero.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7498488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3760da8cc9caa5c46ca487964a8431a4?s=128&d=identicon&r=PG&f=1", "display_name": "nuji", "link": "https://stackoverflow.com/users/7498488/nuji"}, "is_accepted": false, "score": 0, "last_activity_date": 1496277224, "creation_date": 1496277224, "answer_id": 44296689, "question_id": 44014860, "link": "https://stackoverflow.com/questions/44014860/determining-the-proper-loop-to-use/44296689#44296689", "title": "determining the proper loop to use", "body": "<p>Encase your switch case inside of a while loop that is true and it will run indefinitely. You can also use scanf to check for a specific key to be entered to stop it too.</p>\n"}], "owner": {"reputation": 9, "user_id": 8022988, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101488059758601/picture?type=large", "display_name": "Ted C Lim", "link": "https://stackoverflow.com/users/8022988/ted-c-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1496277224, "creation_date": 1494990525, "question_id": 44014860, "link": "https://stackoverflow.com/questions/44014860/determining-the-proper-loop-to-use", "title": "determining the proper loop to use", "body": "<p>I am trying to teach myself C.  For fun and for my own development, I have created a code that prompts the user for a letter grade, then outputs the range of that letter grade.  Here is what I have so far:</p>\n\n<pre><code>//Ted C. Lim\n\n#include \"stdio.h\"\n\n\nint main()\n{\nchar grade;\n\n    printf(\"Enter a single character grade: \");\n    scanf(\"%c\", &amp;grade);\n    printf(\"You entered %c as the grade.  \", grade);\n\n    switch(grade)\n    {\n        case 'A':\n            printf(\"The grade range for A and A- is 100%% - 90%%.\");\n            break;\n        case 'B':\n            printf(\"The grade range for B and B- is 80%% - 89%%.\");\n            break;\n        case 'C':\n            printf(\"The grade range for C and C- is 70%% - 79%%.\");\n            break;\n        case 'D':\n            printf(\"The grade range for D and D- is 60%% - 69%%.\");\n        case 'F':\n            printf(\"The grade range for F is 0%% - 59%%.\");\n        default:\n            printf(\"That grade does not exist.\");\n            break;\n    }\n\n\n}\n</code></pre>\n\n<p>If you run the program, you will see that it asks the user only once, returns the proper output, then stops.  What I would <em>like</em> to do is repeat the prompt indefinitely until the user inputs something like 'Q' to quit.  I know I should use some sort of loop here, but I'm not quite sure how to apply it.</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 2, "creation_date": 1494990832, "post_id": 44014837, "comment_id": 75057532, "body": "The integer values are a runtime property, but what you are doing is compile time. perhaps the best thing is to create a lookup table of functions. This will be far clearer as well.  macros only throw uncertainty and poor readability into the picture."}, {"owner": {"reputation": 699, "user_id": 7093297, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Pi7EY.jpg?s=128&g=1", "display_name": "wind2412", "link": "https://stackoverflow.com/users/7093297/wind2412"}, "reply_to_user": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1494990939, "post_id": 44014837, "comment_id": 75057556, "body": "@PaulRooney Got it, thanks!"}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1494991001, "post_id": 44014837, "comment_id": 75057570, "body": "It also wont force you to have esoteric function names like <code>isr_1</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1495002080, "post_id": 44014837, "comment_id": 75061273, "body": "Would you like to make an answer? You seem to have the implementation of @PaulRooney s proposal now. Seems like a worthwile Q/A pair."}, {"owner": {"reputation": 699, "user_id": 7093297, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Pi7EY.jpg?s=128&g=1", "display_name": "wind2412", "link": "https://stackoverflow.com/users/7093297/wind2412"}, "reply_to_user": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1495002337, "post_id": 44014837, "comment_id": 75061429, "body": "@PaulRooney Yep it&#39;s a useful resolution! Please post it;)"}], "answers": [{"tags": [], "owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "is_accepted": true, "score": 1, "last_activity_date": 1495023135, "last_edit_date": 1495023135, "creation_date": 1495022822, "answer_id": 44024410, "question_id": 44014837, "link": "https://stackoverflow.com/questions/44014837/how-to-use-macro-to-call-functions-which-have-only-suffix-difference/44024410#44024410", "title": "How to use macro to call functions which have only suffix difference?", "body": "<p>The macro will not work since it is only performing simple text concatenation and substitution during the execution of the preprocessor, just before compilation.  The loop happens at runtime and so the value of <code>i</code> is not available during the preprocessor stage.</p>\n\n<p>I'd suggest not using macros to try to automate work like this. It's hard to read and forces you to give your functions non-descriptive and difficult to differentiate between names.</p>\n\n<p>You could achieve the same effect by just using a simple array literal. It's far clearer because, it doesn't require you to try and mentally picture what the macro substitutions look like when reading the code. It doesn't force you to use bad function names and also it allows you to search for the function names in the source code and see where they were used. </p>\n\n<p>So instead</p>\n\n<pre><code>typedef &lt;your-function-sig-here&gt; handler_type;\n\nhandler_type handlers[] = \n{\n    isr_1,\n    isr_2,\n    isr_3\n}; \n</code></pre>\n\n<p>256 entries represents quite a large array, but I think it's still worth doing it this way. There would be nothing stopping a different tool running before the compiler to generate the array in its own header, if you didn't mind the number based function names.</p>\n"}], "owner": {"reputation": 699, "user_id": 7093297, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Pi7EY.jpg?s=128&g=1", "display_name": "wind2412", "link": "https://stackoverflow.com/users/7093297/wind2412"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44024410, "answer_count": 1, "score": 1, "last_activity_date": 1495023135, "creation_date": 1494990349, "question_id": 44014837, "link": "https://stackoverflow.com/questions/44014837/how-to-use-macro-to-call-functions-which-have-only-suffix-difference", "title": "How to use macro to call functions which have only suffix difference?", "body": "<p>In fact, I used macro to define 256 interrupt vectors, and their names are like <code>isr_1()</code>, <code>isr_2()</code> and so on. When I want to put their address to the vector array <code>uint32_t handlers[256]</code>, I faced a problem that using macro can not help my fix these problem.</p>\n\n<pre><code>#define ISR(NUM) isr_##NUM\nfor(int i = 0; i &lt; 256; i ++){\n    handlers[i] = (uint32_t)&amp;ISR(i);\n}\n</code></pre>\n\n<p>But as you know it's a wrong code. It will be expanded as:</p>\n\n<pre><code>for(int i = 0; i &lt; 256; i ++){\n    handlers[i] = (uint32_t)&amp;isr_i;\n}\n</code></pre>\n\n<p>There isn't any function named <code>isr_i()</code>. So it is wrong. Is there any way to fix this problem? </p>\n"}, {"tags": ["c", "parallel-processing", "linked-list"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1494990569, "post_id": 44014751, "comment_id": 75057461, "body": "Of the code shown, how much relative time does <code>fastMergeInformationsInG</code> take? (And probably the same question for SomeFastBooleanFunction.) Are those function(s) easy to optimise?"}, {"owner": {"reputation": 21, "user_id": 2256630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b842a1b5341ed98c13d782e7a988df5?s=128&d=identicon&r=PG", "display_name": "Ajob", "link": "https://stackoverflow.com/users/2256630/ajob"}, "edited": false, "score": 0, "creation_date": 1494992126, "post_id": 44014751, "comment_id": 75057814, "body": "SomeFasBooleanFunction is fast on this case(since n is small) but the problem is NP-Comple. To tell the truth this function verify if a graph g and a graph f are isomorphic and has complexity O(2^n), but n is at most 15, so is fast. But this function is not easy to optimize because this problem is NP-Complete. On the other hand, the function Merge has a constant time."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1495016985, "post_id": 44014751, "comment_id": 75071114, "body": "if <code>SomeFastBooleanFunction()</code> can be used to impose an order, the program can be changed from O(N*N) to O (n log N), or better. But without details, there is nothing to optimize."}, {"owner": {"reputation": 21, "user_id": 2256630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b842a1b5341ed98c13d782e7a988df5?s=128&d=identicon&r=PG", "display_name": "Ajob", "link": "https://stackoverflow.com/users/2256630/ajob"}, "edited": false, "score": 0, "creation_date": 1495031910, "post_id": 44014751, "comment_id": 75082256, "body": "Now I added the almost entired code. The checkIso is missing but, this function is really long. :)"}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1495102136, "post_id": 44014751, "comment_id": 75115008, "body": "The simplest parallelisation is to compute the six permutations separately. This will also simplify the checkColorIso() function, and enable you to remove the silly (IMO) C++ stuff, and the reallocation (sic!) in the compare function. (but permuting the colors into a <i>canonical</i> form would reduce the complexity by an equal factor)"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1495283798, "post_id": 44014751, "comment_id": 75194125, "body": "<code>a[g-&gt;edges[i]-1]++;</code>This implies that <code>g-&gt;edges[ i ]</code> can only contain values {1,2,3} That doesn&#39;t make sense to me. And: if it is actually an unordered list of (unique) edge numbers why not just keep it sorted and use memcmp() (plus maybe even hash it)"}], "owner": {"reputation": 21, "user_id": 2256630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b842a1b5341ed98c13d782e7a988df5?s=128&d=identicon&r=PG", "display_name": "Ajob", "link": "https://stackoverflow.com/users/2256630/ajob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495031859, "creation_date": 1494989850, "last_edit_date": 1495031859, "question_id": 44014751, "link": "https://stackoverflow.com/questions/44014751/best-way-to-parallelize-a-big-linked-list", "title": "Best way to parallelize a big linked list", "body": "<p>I dont have any experience with parallelism. So, if you could help me it would be really amazing.</p>\n\n<p>I developed a code in C and this part of the code takes 99% of the execution time. </p>\n\n<p>h is a linked list, a really long linked list.</p>\n\n<pre><code>    g = h;\n    while(g != NULL){\n        f = g-&gt;next;\n        t = g;\n        while(f != NULL){\n            if(SomeFastBooleanFunction(g, f)){\n                fastMergeInformationsInG(g,f);\n                t-&gt;next = f-&gt;next;\n                free(f);\n                f = t-&gt;next;\n            }\n            else{\n                t = f;\n                f = f-&gt;next;\n            }\n        }\n      g = g-&gt;next;\n     }\n</code></pre>\n\n<p>The biggest problem here is the lenght of the linked list that is really big (approximated n!2^{binomial{n}{2}} and n >= 9). Any ideas are wellcome. </p>\n\n<p>Thanks a lot.</p>\n\n<p>------------ UPDATE -----------------</p>\n\n<p>I will put here the real code used. The function above is the cleanIso bellow. I didn't put the checkIso funcion, but this function is a optimized function that check is f is isomorphic to g.</p>\n\n<pre><code>    struct Graph{                                                                                                                                                                                               \n        SomeInfo\n        int *edges;                                                                                                                                                                                               \n        struct Graph *next;                                                                                                                                                                                       \n    };\n\n    graph *cleanIso(graph *g){\n        graph *f1, *f2, *f3;\n        f1 = g;\n        while(f1 != NULL){\n            f2 = f1;\n            f3 = f1-&gt;next;\n            while(f3 != NULL){\n            if(checkColorIso(f1, f3)){\n                f1-&gt;nHom += f3-&gt;nHom;\n                f2-&gt;next = f3-&gt;next;\n                free(f3-&gt;edges);\n                free(f3);\n                f3 = f2-&gt;next;\n            }\n            else{\n                f2 = f3;\n                f3 = f3-&gt;next;\n            }\n        }\n        f1 = f1-&gt;next;\n     }\n\n     return g;\n  }\n\n    int checkColorIso(graph *g, graph *f){                                                                                                                                                             \n        graph *h;                                                                                                                                                                                                 \n        int r = 0;                                                                                                                                                                                                \n        int v[3] = {1, 2, 3};                                                                                                                                                                                     \n        int nP = g-&gt;size*(g-&gt;size - 1)/2;                                                                                                                                                                         \n        int a[3], b[3];                                                                                                                                                                                           \n        //Initializing\n        a[0] = 0;                                                                                                                                                                                                 \n        a[1] = 0;                                                                                                                                                                                                 \n        a[2] = 0;                                                                                                                                                                                                 \n        b[0] = 0;                                                                                                                                                                                                 \n        b[1] = 0;                                                                                                                                                                                                 \n        b[2] = 0;\n        //It just check if it there is some color bijection that maybe produce a isormophism                                                                                                                                                                                                 \n        for(int i = 0; i &lt; g-&gt;size*(g-&gt;size - 1)/2; i++){                                                                                                                                                         \n            a[g-&gt;edges[i]-1]++;                                                                                                                                                                                     \n            b[f-&gt;edges[i]-1]++;                                                                                                                                                                                     \n        }                                                                                                                                                                                                         \n        do{                                                                                                                                                                                                       \n            if(a[0] == b[v[0]-1] &amp;&amp; a[1] == b[v[1]-1] &amp;&amp; a[2] == b[v[2]-1]){                                                                                                                                        \n                r++;                                                                                                                                                                                                  \n            }                                                                                                                                                                                                       \n        }while(std::next_permutation(v, v+3));                                                                                                                                                                    \n        if(r == 0)                                                                                                                                                                                                \n            return 0;                                                                                                                                                                                               \n        r = 0;                                                                                                                                                                                                    \n        h = initializeGraph(g-&gt;size, NULL);                                                                                                                                                                       \n        do{                                                                                                                                                                                                       \n            copyGraph(f, h);                                                                                                                                                                                        \n            for(int i = 0; i &lt; nP; i++)                                                                                                                                                                             \n                h-&gt;edges[i] = v[h-&gt;edges[i] - 1];                                                                                                                                                                     \n            r = checkIso(g, h);\n     }while(std::next_permutation(v, v+3) &amp;&amp; r == 0);                                                                                                                                                          \n     free(h-&gt;edges);                                                                                                                                                                                           \n     free(h);                                                                                                                                                                                                  \n     return r;                                                                                                                                                                                                 \n    }\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1494990005, "post_id": 44014748, "comment_id": 75057332, "body": "its <code>#include &lt;stdio.h&gt;</code>. It means standard input output."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1495058057, "post_id": 44014748, "comment_id": 75097454, "body": "Looks a lot like you ran <code>gcc -o hello hello.c</code> somewhere where <code>hello.c</code> didn&#39;t exist - did you try <code>cd c:&#47;code&#47;c</code> first?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8022916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zwRIo.jpg?s=128&g=1", "display_name": "sarakota", "link": "https://stackoverflow.com/users/8022916/sarakota"}, "edited": false, "score": 0, "creation_date": 1495051938, "post_id": 44014839, "comment_id": 75094631, "body": "Hey, thanks for replying, but I am still having trouble. I tried using the full path, but that did not end up working. For thing first think you offered I tried typing that up in the command promt and that didn&#39;t seem to work either. I think I am doing something really wrong."}], "tags": [], "owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "is_accepted": false, "score": 3, "last_activity_date": 1494990367, "creation_date": 1494990367, "answer_id": 44014839, "question_id": 44014748, "link": "https://stackoverflow.com/questions/44014748/compiler-gccerror-no-such-file-or-directory/44014839#44014839", "title": "Compiler gcc:error; no such file or directory", "body": "<blockquote>\n  <p>gcc: error: hello.c: No such file or directory gcc: fatal error: no input files compilation terminated.</p>\n</blockquote>\n\n<p>Means that <code>gcc</code> is unable to find your <code>hello.c</code> source file. You should either cd to the source folder:</p>\n\n<pre><code>c:\ncd c:\\code\\c\\\ngcc -o hello.exe hello.c\n</code></pre>\n\n<p>Or use a full path to the source in the command line:</p>\n\n<pre><code>gcc -o c:\\code\\c\\hello.exe c:\\code\\c\\hello.c\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8022916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zwRIo.jpg?s=128&g=1", "display_name": "sarakota", "link": "https://stackoverflow.com/users/8022916/sarakota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29301, "favorite_count": 1, "closed_date": 1495009825, "answer_count": 1, "score": 5, "last_activity_date": 1495050787, "creation_date": 1494989846, "last_edit_date": 1495050787, "question_id": 44014748, "link": "https://stackoverflow.com/questions/44014748/compiler-gccerror-no-such-file-or-directory", "closed_reason": "Not suitable for this site", "title": "Compiler gcc:error; no such file or directory", "body": "<p>I am extremely new to programming and I am having problems with the basic starting program of, 'hello, world'.</p>\n\n<p>I have downloaded MinGW and I believe I set it up correctly with the command promt by entering: <code>setx PATH \"%PATH%;C:\\MinGW\\bin\"</code></p>\n\n<p>Then I created this code following a guide while using Notepad++</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  puts(\"Hello, world!\");\n  return 0;\n}\n</code></pre>\n\n<p>saving it under <code>c:/code/c/hello.c</code></p>\n\n<p>When I try to compile it or run it under: <code>gcc -o hello hello.c</code>, I get this error</p>\n\n<pre><code>gcc: error: hello.c: No such file or directory\ngcc: fatal error: no input files\ncompilation terminated.\n</code></pre>\n\n<p>And I am not sure how to fix this. I have tried looking around, but I cant find any answers or I just don't understand them.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1494989256, "post_id": 44014588, "comment_id": 75057138, "body": "Using the  complete, exact warning makes for a better post.  Suggest you edit."}, {"owner": {"reputation": 49, "user_id": 3682317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/78a9d745f4a7972159e1f5bb63fde473?s=128&d=identicon&r=PG&f=1", "display_name": "user3682317", "link": "https://stackoverflow.com/users/3682317/user3682317"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494989659, "post_id": 44014588, "comment_id": 75057253, "body": "Sadly that was the complete warning. Solved though thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 3682317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/78a9d745f4a7972159e1f5bb63fde473?s=128&d=identicon&r=PG&f=1", "display_name": "user3682317", "link": "https://stackoverflow.com/users/3682317/user3682317"}, "edited": false, "score": 0, "creation_date": 1494989309, "post_id": 44014601, "comment_id": 75057156, "body": "Wow, I can&#39;t believe I made that mistake! Thank you!"}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": true, "score": 1, "last_activity_date": 1494988804, "creation_date": 1494988804, "answer_id": 44014601, "question_id": 44014588, "link": "https://stackoverflow.com/questions/44014588/getting-strings-and-ints-from-strtok-in-c/44014601#44014601", "title": "Getting strings and ints from strtok in C", "body": "<pre><code>sscanf(input,\"%d\",moves);\n</code></pre>\n\n<p>should be changed to</p>\n\n<pre><code>sscanf(input,\"%d\",&amp;moves);\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3682317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/78a9d745f4a7972159e1f5bb63fde473?s=128&d=identicon&r=PG&f=1", "display_name": "user3682317", "link": "https://stackoverflow.com/users/3682317/user3682317"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "closed_date": 1495011755, "accepted_answer_id": 44014601, "answer_count": 1, "score": -1, "last_activity_date": 1494989140, "creation_date": 1494988687, "last_edit_date": 1494989140, "question_id": 44014588, "link": "https://stackoverflow.com/questions/44014588/getting-strings-and-ints-from-strtok-in-c", "closed_reason": "Not suitable for this site", "title": "Getting strings and ints from strtok in C", "body": "<p>I am trying to get user input which can sometimes be \"string string\" and other times be \"string int\". But I am getting an error for argument 3 of <code>sscanf(input,\"%d\",moves);</code> which states:</p>\n\n<blockquote>\n  <p>\"warning: format ' ' expects argument of type ' ', but argument 3 has type ' '. </p>\n</blockquote>\n\n<p>I am new to C and finding the debugging rather difficult. So any help here is much appreciated!</p>\n\n<pre><code>char *choice = validateStr();\nchar *tok = strtok(choice,\" \\n\");\nchar *input = strtok(NULL,\" \\n\");\nint moves = 0;\n\n else if(strcmp(choice, \"forward\") == 0){\n        sscanf(input,\"%d\",moves);\n        printf(\"%d\",moves);\n        forward(list,moves);\n</code></pre>\n"}, {"tags": ["c", "linux", "shell", "buffer"], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1494996154, "creation_date": 1494996154, "answer_id": 44015772, "question_id": 44014148, "link": "https://stackoverflow.com/questions/44014148/strange-output-buffering-behavior-in-c/44015772#44015772", "title": "Strange Output Buffering Behavior in C", "body": "<p>This code does not have well-defined behaviour:</p>\n\n<pre><code>while ((pid = waitpid(-1, &amp;r, WNOHANG)) &gt;= 0) {\n  if (errno == ECHILD) {\n      break;\n  }\n}\n</code></pre>\n\n<p>The <code>while</code> loop breaks immediately if <code>waitpid</code> returns -1, which is precisely what it returns in the case of an error. So if the body of the loop is entered, <code>waitpid</code> returned some non-negative value: either 0 -- indicating that the child is still executing -- or the pid of a child which had exited. Those are not error conditions, so the value of <code>errno</code> is not meaningful. It might be <code>ECHILD</code>, in which case the loop will incorrectly break.</p>\n\n<p>You <strong>must</strong> only check the value of <code>errno</code> in cases where the value is meaningful. Or, to be more precise, quoting the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/errno.html\" rel=\"nofollow noreferrer\">Posix standard</a>:</p>\n\n<blockquote>\n  <p>The value of <code>errno</code> shall be defined only after a call to a function for which it is explicitly stated to be set and until it is changed by the next function call or if the application assigns it a value. The value of <code>errno</code> should only be examined when it is indicated to be valid by a function's return value.</p>\n</blockquote>\n\n<p>But I'm puzzled why you feel it necessary to busy loop using <code>WNOHANG</code>. That's a massive waste of resources, since your parent process will repeatedly execute the system call until the child actually terminates. Since you really intend to wait until the child terminates, it would make much more sense to just call <code>wait</code> or to specify <code>0</code> as a flag value to <code>waitpid</code>.</p>\n\n<p>On the other hand, you might want to repeat the <code>wait</code> (or <code>waitpid</code>) if it  returns -1 with <code>errno</code> set to <code>EINTR</code>. And if it returns <code>-1</code> and <code>errno</code> is neither <code>EINTR</code> nor <code>ECHILD</code>, then some hard error has occurred which you might want to log. But that's not related to your problem, afaics.</p>\n"}], "owner": {"reputation": 297, "user_id": 4308196, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-hmPGRvJRQQc/AAAAAAAAAAI/AAAAAAAAACo/lIGQgaoNhSA/photo.jpg?sz=128", "display_name": "Vitt Volt", "link": "https://stackoverflow.com/users/4308196/vitt-volt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1494996154, "creation_date": 1494985353, "question_id": 44014148, "link": "https://stackoverflow.com/questions/44014148/strange-output-buffering-behavior-in-c", "title": "Strange Output Buffering Behavior in C", "body": "<p>I am trying out a C shell implementation from an open course, yet there is something intriguing about the behavior of the output buffering.</p>\n\n<p>The code goes like this (note the line where I use <strong>pid = waitpid(-1, &amp;r, WNOHANG)</strong>):</p>\n\n<pre><code>int\nmain(void)\n{\n  static char buf[100];\n  int fd, r;\n  pid_t pid = 0;\n\n  // Read and run input commands.\n  while(getcmd(buf, sizeof(buf)) &gt;= 0){\n    if(buf[0] == 'c' &amp;&amp; buf[1] == 'd' &amp;&amp; buf[2] == ' '){\n      buf[strlen(buf)-1] = 0;  // chop \\n\n      if(chdir(buf+3) &lt; 0)\n        fprintf(stderr, \"cannot cd %s\\n\", buf+3);\n      continue;\n    }\n    if((pid = fork1()) == 0)\n      runcmd(parsecmd(buf));\n    while ((pid = waitpid(-1, &amp;r, WNOHANG)) &gt;= 0) {\n      if (errno == ECHILD) {\n          break;\n      }\n    }\n  }\n  exit(0);\n}\n</code></pre>\n\n<p>The runcmd function is like this (note that in <strong>pipe handling</strong> I create 2 child processes and wait for them to terminate):</p>\n\n<pre><code>void\nruncmd(struct cmd *cmd)\n{\n  int p[2], r;\n  struct execcmd *ecmd;\n  struct pipecmd *pcmd;\n  struct redircmd *rcmd;\n\n  if(cmd == 0)\n    exit(0);\n\n  switch(cmd-&gt;type){\n  case ' ':\n    ecmd = (struct execcmd*)cmd;\n    if(ecmd-&gt;argv[0] == 0) {\n      exit(0);\n    }\n    // Your code here ...\n    // fprintf(stderr, \"starting to run cmd: %s\\n\", ecmd-&gt;argv[0]);\n    execvp(ecmd-&gt;argv[0], ecmd-&gt;argv);\n    fprintf(stderr, \"exec error !\\n\");\n    exit(-1);\n\n    break;\n\n  case '&gt;':\n  case '&lt;':\n    rcmd = (struct redircmd*)cmd;\n    // fprintf(stderr, \"starting to run &lt;&gt; cmd: %s\\n\", rcmd-&gt;file);\n    // Your code here ...\n    mode_t mode = S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH;\n    if (rcmd-&gt;type == '&lt;') {\n      // input\n      close(0);\n      if (open(rcmd-&gt;file, O_RDONLY, mode) != 0) {\n        fprintf(stderr, \"Opening file error !\\n\");\n        exit(-1);\n      }\n    } else {\n      // output\n      close(1);\n      if (open(rcmd-&gt;file, O_WRONLY|O_CREAT|O_TRUNC, mode) != 1) {\n        fprintf(stderr, \"Opening file error !\\n\");\n        exit(-1);\n      }\n    }\n\n    runcmd(rcmd-&gt;cmd);\n    break;\n\n  case '|':\n    pcmd = (struct pipecmd*)cmd;\n    // fprintf(stderr, \"starting to run pcmd\\n\");\n    // Your code here ...\n    pipe(p);\n\n    if (fork1() == 0) {\n      // child for read, right side command\n      close(0);\n      if (dup(p[0]) != 0) {\n        fprintf(stderr, \"error when dup !\\n\");\n        exit(-1);\n      }\n      close(p[0]);\n      close(p[1]);\n      runcmd(pcmd-&gt;right);\n      fprintf(stderr, \"exec error !\\n\");\n    } \n    if (fork1() == 0) {\n      // left side command for writing\n      close(1);\n      if (dup(p[1]) != 1) {\n        fprintf(stderr, \"dup error !\\n\");\n        exit(-1);\n      }\n      close(p[0]);\n      close(p[1]);\n      runcmd(pcmd-&gt;left);\n      fprintf(stderr, \"exec error !\\n\");\n    }\n    close(p[0]);\n    close(p[1]);\n    int stat;\n    wait(&amp;stat);\n    wait(&amp;stat);\n\n    break;\n\n  default:\n    fprintf(stderr, \"unknown runcmd\\n\");\n    exit(-1);\n  }    \n  exit(0);\n}\n</code></pre>\n\n<p>The wierd thing is, when I execute \"ls | sort\" in the terminal, I constantly get the following output </p>\n\n<pre><code>6.828$ ls | sort\n6.828$ a.out\nsh.c\nt.sh\n</code></pre>\n\n<p>This indicates that before the next command prompt \"6828$\" is printed, the output from the child process is still not flushed to terminal.</p>\n\n<p>However, if I don't use <strong>pid = waitpid(-1, &amp;r, WNOHANG))</strong> and use <strong>pid = waitpid(-1, &amp;r, 0))</strong> (or <strong>wait()</strong>), the output would be normal like:</p>\n\n<pre><code>6.828$ ls | sort\na.out\nsh.c\nt.sh\n</code></pre>\n\n<p>I have been thinking about the cause of the problem for a long time but did not come up with a possible reason. Can anyone suggest some possible reason?</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["c", "linux", "command", "sizeof", "nano"], "comments": [{"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1494985233, "post_id": 44014105, "comment_id": 75056146, "body": "Use <code>%zu</code> instead of <code>%whatever</code> in the <code>printf</code>.  Its arguments are not their respective types, rather <code>size_t</code>, because <code>sizeof</code> returns the <code>size_t</code> type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "reply_to_user": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 1, "creation_date": 1494985408, "post_id": 44014105, "comment_id": 75056196, "body": "@zbw That would make a nice answer, with some links and a fixed version of the relevant code."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1494985729, "post_id": 44014105, "comment_id": 75056273, "body": "Looking for similar questions, I found <a href=\"http://stackoverflow.com/questions/5943840/how-do-i-print-the-size-of-int-in-c\">this one</a> with a very good explanation.  I wouldn&#39;t be able to give a better answer, so I&#39;ll just provide the link."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1494985831, "post_id": 44014105, "comment_id": 75056301, "body": "Also, <code>sizeof</code> returns the number of bytes, which is generally more useful than the number of bits.  Multiply by 8 to get the number of bits"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "reply_to_user": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1494985919, "post_id": 44014105, "comment_id": 75056333, "body": "@zbw The <code>char</code> type is not 8 bits on every machine. For portability, multiply by <code>CHAR_BIT</code> from <code>&lt;limits.h&gt;</code>."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1494986644, "post_id": 44014105, "comment_id": 75056525, "body": "@InternetAussie I agree, though 8 (the <a href=\"http://stackoverflow.com/a/2098444\">POSIX-specified char size</a>) would work too, as he&#39;s on linux."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 1, "creation_date": 1494987242, "post_id": 44014105, "comment_id": 75056661, "body": "@zbw: <code>8</code> will almost certainly work, but <code>CHAR_BIT</code> is clearer. (Suppose you have some other value in the program that happens to be <code>8</code>, and you want to change it to <code>16</code>. It&#39;s a lot easier to make the change if you don&#39;t have too many irrelevant occurrences of <code>8</code>. Magic numbers are best avoided."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494988517, "post_id": 44014368, "comment_id": 75056970, "body": "&quot;However, %c expects an unsigned int,&quot; --&gt; Not quite.  <code>&quot;%c&quot;</code> expects an <code>int</code>.  The value is converted to <code>unsigned char</code> and the corresponding character is printed.  The behavior is defined."}], "tags": [], "owner": {"reputation": 461, "user_id": 7965340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XIYWy.jpg?s=128&g=1", "display_name": "Madhur Yadav", "link": "https://stackoverflow.com/users/7965340/madhur-yadav"}, "is_accepted": false, "score": 0, "last_activity_date": 1494987004, "creation_date": 1494987004, "answer_id": 44014368, "question_id": 44014105, "link": "https://stackoverflow.com/questions/44014105/errors-compiling-c-code-with-sizeof-from-command-line/44014368#44014368", "title": "Errors compiling C code with sizeof from command line", "body": "<p>This is because the unsigned char is promoted to an int (in normal C implementations), so an int is passed to printf for the specifier %c. However, %c expects an unsigned int, so the types do not match, and the C standard does not define the behavior.\nyou can perform the following methods:\n1) try using C11(standard version).\n2) try using %zu.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7783026"}, "edited": false, "score": 0, "creation_date": 1494988184, "post_id": 44014384, "comment_id": 75056888, "body": "Thank you InternetAussie.  I&#39;m not quite at a level to use macros so I&#39;ll look back at this when I get there.  However, I also found I could use %lu rather than %zu.  I got this from the web, &quot;%lu format specifier, which prints a unsigned long integer type. I chose this format because on my 64-bit machine sizeof outputs an unsigned long (storage size can only be positive). If you are using a 32-bit operating system, you might need to use \u201c%u\u201d instead of \u201c%lu\u201d. The compiler will complain if you have the wrong format.&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1494988663, "post_id": 44014384, "comment_id": 75057003, "body": "@NickAdoyot &quot;The compiler will complain if you have the wrong format&quot; --&gt; the compiler is not required to complain.  The best approach uses <code>&quot;%zu&quot;</code>.  Use <code>&quot;%lu&quot;</code> and the person who needs to maintain your code will mutter evil thoughts."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7783026"}, "edited": false, "score": 0, "creation_date": 1498009045, "post_id": 44014384, "comment_id": 76316300, "body": "@InternetAussie Thanks again for your assistance."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "is_accepted": true, "score": 2, "last_activity_date": 1494987149, "creation_date": 1494987149, "answer_id": 44014384, "question_id": 44014105, "link": "https://stackoverflow.com/questions/44014105/errors-compiling-c-code-with-sizeof-from-command-line/44014384#44014384", "title": "Errors compiling C code with sizeof from command line", "body": "<p>The <a href=\"http://en.cppreference.com/w/c/language/sizeof\" rel=\"nofollow noreferrer\"><code>sizeof</code></a> operator returns an integer of type <a href=\"http://en.cppreference.com/w/c/types/size_t\" rel=\"nofollow noreferrer\"><code>size_t</code></a>, so you should use the appropriate <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code></a> format specifier (<code>\"%zu\"</code>) (assuming C99):</p>\n\n<pre><code>printf(\n    \"%zu %zu %zu %zu %zu %zu %zu %zu %zu\\n\",\n     sizeof(char), sizeof(unsigned char),\n     sizeof(int), sizeof(unsigned int),\n     sizeof(long), sizeof(unsigned long),\n     sizeof(float), sizeof(double), sizeof(long double)\n);\n</code></pre>\n\n<p>However, this prints the number of <em>bytes</em> in each type. If you want the number of <em>bits</em> in each type, include <a href=\"http://en.cppreference.com/w/c/types/limits\" rel=\"nofollow noreferrer\"><code>&lt;limits.h&gt;</code></a> and multiply each result by <code>CHAR_BIT</code> to get that:</p>\n\n<pre><code>#include &lt;limits.h&gt;\n\n/* ... */\n\nprintf(\n    \"%zu %zu %zu %zu %zu %zu %zu %zu %zu\\n\",\n     sizeof(char) * CHAR_BIT, sizeof(unsigned char) * CHAR_BIT,\n     sizeof(int) * CHAR_BIT, sizeof(unsigned int) * CHAR_BIT,\n     sizeof(long) * CHAR_BIT, sizeof(unsigned long) * CHAR_BIT,\n     sizeof(float) * CHAR_BIT, sizeof(double) * CHAR_BIT, sizeof(long double) * CHAR_BIT\n);\n</code></pre>\n\n<hr>\n\n<p>IMO, it would look much clearer if you label what you're printing and print each value on its own line, like this:</p>\n\n<pre><code>printf(\"Number of bits in char = %zu\\n\", sizeof(char) * CHAR_BIT);\nprintf(\"Number of bits in unsigned char = %zu\\n\", sizeof(unsigned char) * CHAR_BIT);\nprintf(\"Number of bits in int = %zu\\n\", sizeof(int) * CHAR_BIT);\nprintf(\"Number of bits in unsigned int = %zu\\n\", sizeof(unsigned int) * CHAR_BIT);\nprintf(\"Number of bits in long = %zu\\n\", sizeof(long) * CHAR_BIT);\nprintf(\"Number of bits in unsigned long = %zu\\n\", sizeof(unsigned long) * CHAR_BIT);\nprintf(\"Number of bits in float = %zu\\n\", sizeof(float) * CHAR_BIT);\nprintf(\"Number of bits in double = %zu\\n\", sizeof(double) * CHAR_BIT);\nprintf(\"Number of bits in long double = %zu\\n\", sizeof(long double) * CHAR_BIT);\n</code></pre>\n\n<p>And <em>that</em> can be reduced with a macro (though macros aren't the best, they are useful for repetitive code):</p>\n\n<pre><code>#define PRINT_BITS_IN_TYPE(type) \\\n    printf(\"Number of bits in \" #type \" = %zu\\n\", sizeof(type) * CHAR_BIT)\n\nPRINT_BITS_IN_TYPE(char);\nPRINT_BITS_IN_TYPE(unsigned char);\nPRINT_BITS_IN_TYPE(int);\nPRINT_BITS_IN_TYPE(unsigned int);\nPRINT_BITS_IN_TYPE(long);\nPRINT_BITS_IN_TYPE(unsigned long);\nPRINT_BITS_IN_TYPE(float);\nPRINT_BITS_IN_TYPE(double);\nPRINT_BITS_IN_TYPE(long double);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7783026"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44014384, "answer_count": 2, "score": 0, "last_activity_date": 1494987149, "creation_date": 1494985014, "last_edit_date": 1494985754, "question_id": 44014105, "link": "https://stackoverflow.com/questions/44014105/errors-compiling-c-code-with-sizeof-from-command-line", "title": "Errors compiling C code with sizeof from command line", "body": "<p>I wrote the following code in Nano from the Linux command line to get errors when compiling:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ag7CH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ag7CH.png\" alt=\"Warnings when compiling\"></a></p>\n\n<p>I'd like to know what I need to change in my code to make it compile properly.  I am trying to get the number of bits in each data type listed to print on a single line.  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void){\n    char A;\n    unsigned char B;\n    int a;\n    unsigned int b;\n    long c;\n    unsigned long d;\n    float e;\n    double f;\n    long double g;\n\n    printf(\n        \"%c %c %i %u %li %lu %f %lf %Lf\\n\",\n         sizeof(char), sizeof(unsigned char),\n         sizeof(int), sizeof(unsigned int),\n         sizeof(long), sizeof(unsigned long),\n         sizeof(float), sizeof(double), sizeof(long double)\n    );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "unions"], "comments": [{"owner": {"reputation": 2103, "user_id": 1865694, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bP5UU.jpg?s=128&g=1", "display_name": "Alex Zywicki", "link": "https://stackoverflow.com/users/1865694/alex-zywicki"}, "edited": false, "score": 2, "creation_date": 1494985080, "post_id": 44014024, "comment_id": 75056111, "body": "C and C++ are different languages. Which one are you asking about? Your question says C but your tag says C++."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1494985822, "post_id": 44014024, "comment_id": 75056295, "body": "Related <a href=\"http://en.cppreference.com/w/c/language/union\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/union</a>"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1494985882, "post_id": 44014024, "comment_id": 75056321, "body": "Well, there&#39;s the fact that <code>banana other_banana;</code> <a href=\"http://coliru.stacked-crooked.com/a/63ce55f187196421\" rel=\"nofollow noreferrer\">isn&#39;t actually valid C</a>. It might be valid C++, but this isn&#39;t C++ code."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 1, "creation_date": 1494986108, "post_id": 44014024, "comment_id": 75056386, "body": "to do <code>banana other_banana</code> you need to <code>typedef union { ... } banana;</code>"}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 0, "creation_date": 1494986147, "post_id": 44014024, "comment_id": 75056399, "body": "also this is not a question about unions specifically as the same thing happens with structs but i&#39;ll let someone else write the answer as i can&#39;t right now"}], "answers": [{"tags": [], "owner": {"reputation": 388, "user_id": 7892010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb22306a8bdbe2dfcfa54ec6e0edca5?s=128&d=identicon&r=PG&f=1", "display_name": "Manny_Mar", "link": "https://stackoverflow.com/users/7892010/manny-mar"}, "is_accepted": false, "score": 1, "last_activity_date": 1494990223, "last_edit_date": 1494990223, "creation_date": 1494987903, "answer_id": 44014472, "question_id": 44014024, "link": "https://stackoverflow.com/questions/44014024/declaring-union-typed-variables/44014472#44014472", "title": "Declaring union typed variables", "body": "<p>Unless you use <code>typedef</code> you have to use the <code>union</code> in front of banana.</p>\n\n<pre><code>typedef union {\n    uint32_t cool[2];\n    uint64_t supercool;\n} banana;\n</code></pre>\n\n<p>Then you can just use <code>banana</code>. If you just do as in the example above, then you will have to use <code>union banana</code>, and you can even use <code>banana</code> for something else. <code>union banana</code> and <code>banana</code> are different in the example above.</p>\n\n<p>if you try <code>banana other_banana</code>as in your example, the compiler should give you <code>error: unknown type name \u2018banana\u2019</code> </p>\n"}], "owner": {"reputation": 5189, "user_id": 4049658, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cc923cb7c9b2d8add8f2f373a8ffe0f5?s=128&d=identicon&r=PG&f=1", "display_name": "user81993", "link": "https://stackoverflow.com/users/4049658/user81993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495899349, "creation_date": 1494984346, "last_edit_date": 1495899349, "question_id": 44014024, "link": "https://stackoverflow.com/questions/44014024/declaring-union-typed-variables", "title": "Declaring union typed variables", "body": "<p>I'm exploring some ancient C library and am a bit confused as to why it declares union variables in a certain way and whether or not it makes any difference, example:</p>\n\n<pre><code>union banana {\n    uint32_t cool[2];\n    uint64_t supercool;\n};\n\nvoid main() {\n    union banana new_banana; //&lt;- why like this?\n    banana other_banana; // &lt;- as opposed to this\n}\n</code></pre>\n\n<p>As far as I can tell it doesn't make any difference but you never know.. is there any?</p>\n"}, {"tags": ["c", "unix", "buffer", "buffer-overflow", "exploit"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7881131"}, "edited": false, "score": 0, "creation_date": 1494984960, "post_id": 44013401, "comment_id": 75056080, "body": "Alternate segfault: <code>int ohno = *((int*)NULL); printf(&quot;%d&quot;, ohno);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 3207770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d119f4012821fefe51d738807c7d2740?s=128&d=identicon&r=PG&f=1", "display_name": "GKoo", "link": "https://stackoverflow.com/users/3207770/gkoo"}, "edited": false, "score": 0, "creation_date": 1495007076, "post_id": 44014102, "comment_id": 75064283, "body": "The exercise is called Buffer Overrun Attack so i must assume that they want me to do it that way. Anyway if you write on the stack on the return address (EIP) , shouldn&#39;t that produce one if the return address is somewhere else ?"}, {"owner": {"reputation": 59, "user_id": 3207770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d119f4012821fefe51d738807c7d2740?s=128&d=identicon&r=PG&f=1", "display_name": "GKoo", "link": "https://stackoverflow.com/users/3207770/gkoo"}, "edited": false, "score": 0, "creation_date": 1495135856, "post_id": 44014102, "comment_id": 75137644, "body": "scratch that, i did it by making i too big."}], "tags": [], "owner": {"reputation": 8444, "user_id": 1837203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4db7eb958bf0c84072c8e9658700167?s=128&d=identicon&r=PG", "display_name": "jaket", "link": "https://stackoverflow.com/users/1837203/jaket"}, "is_accepted": false, "score": 1, "last_activity_date": 1494984985, "creation_date": 1494984985, "answer_id": 44014102, "question_id": 44013401, "link": "https://stackoverflow.com/questions/44013401/simple-buffer-overflow/44014102#44014102", "title": "Simple Buffer Overflow", "body": "<p>This bit of code is protecting you from a segfault.</p>\n\n<pre><code>for (i = 0; i &lt; BUFSIZE; i++)\n      s[i] = buf[i];\n</code></pre>\n\n<p>You may run off of the end of the buf array but that is on the stack. </p>\n\n<p>Why not just this?</p>\n\n<pre><code>*(int*)(0x00000000) = 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5693452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ea9c3e735b5ebaaf86779068a37dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Nightkids_008", "link": "https://stackoverflow.com/users/5693452/nightkids-008"}, "edited": false, "score": 0, "creation_date": 1494990967, "post_id": 44014891, "comment_id": 75057562, "body": "the i value will not changed,because the gcc use register store i value,unless u add volatile before i variable\u3002"}, {"owner": {"reputation": 1, "user_id": 5693452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ea9c3e735b5ebaaf86779068a37dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Nightkids_008", "link": "https://stackoverflow.com/users/5693452/nightkids-008"}, "edited": false, "score": 0, "creation_date": 1494991049, "post_id": 44014891, "comment_id": 75057579, "body": "if u just want crash\uff0cjust call abort"}], "tags": [], "owner": {"reputation": 1, "user_id": 5693452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ea9c3e735b5ebaaf86779068a37dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Nightkids_008", "link": "https://stackoverflow.com/users/5693452/nightkids-008"}, "is_accepted": false, "score": 0, "last_activity_date": 1494990723, "creation_date": 1494990723, "answer_id": 44014891, "question_id": 44013401, "link": "https://stackoverflow.com/questions/44013401/simple-buffer-overflow/44014891#44014891", "title": "Simple Buffer Overflow", "body": "<p>in my opinion\uff0cthe stack was word aligned\uff0cif your buf[BUFSIZE]\uff0cit will have a hole with the local i and c variable.it's disassembly code like this:</p>\n\n<pre><code>  4005d4:   55                      push   %rbp\n  4005d5:   48 89 e5                mov    %rsp,%rbp\n  4005d8:   48 83 ec 50             sub    $0x50,%rsp\n  4005dc:   48 89 7d b8             mov    %rdi,-0x48(%rbp)\n  4005e0:   c7 45 f8 00 00 00 00    movl   $0x0,-0x8(%rbp)\n</code></pre>\n\n<p>it's stack create 90 bytes,so u want to change rbp must input a lot.\n  so if u want change the other value like rbp\uff0cu must input more than 64.\nunfortunately\uff0cit may didn't work\uff0cbecause when u go through the i location\uff0cyour input value will change the i value\uff0cso the buff[i++] may not the position u want.so the best way to change rpb is just jump through the stack which subed in the first.</p>\n"}], "owner": {"reputation": 59, "user_id": 3207770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d119f4012821fefe51d738807c7d2740?s=128&d=identicon&r=PG&f=1", "display_name": "GKoo", "link": "https://stackoverflow.com/users/3207770/gkoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1495928204, "creation_date": 1494978896, "last_edit_date": 1495928204, "question_id": 44013401, "link": "https://stackoverflow.com/questions/44013401/simple-buffer-overflow", "title": "Simple Buffer Overflow", "body": "<p>I have an exercise that asks of me to produce a seg.fault. \nIn my understanding i can do that by overflowing the buffer.\nSo all i need to do is provide an input(Name) bigger than a certain size(covering the return address).\nSo if buf,i and c hold 52 Bytes and ebp 4,then the return address should be after 56 bytes. So if i give an input bigger than 56, it should produce a seg.fault. Is my thinking correct ? I tried with those numbers but it still runs and exit correctly.(UNIX-32bit)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define BUFSIZE 44\n\nchar grade = '3';\nchar Name[BUFSIZE];\n\nvoid readString(char *s) {\n   char buf[BUFSIZE];\n   int i = 0;\n   int c;\n\n   while (1) {\n      c = fgetc(stdin);\n      if ((c == EOF) || (c == '\\n'))\n         break;\n      buf[i++] = c;\n   }\n   buf[i] = 0;\n\n   for (i = 0; i &lt; BUFSIZE; i++)\n      s[i] = buf[i];\n\n   return;\n}\n\nint main(void) {\n   mprotect((void*)((unsigned int)Name &amp; 0xfffff000), 1,\n            PROT_READ | PROT_WRITE | PROT_EXEC);\n\n   printf(\"What is your name?\\n\");\n   readString(Name);\n\n   exit(0)\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1494976908, "post_id": 44013113, "comment_id": 75054433, "body": "What are you typing in as input?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 5, "creation_date": 1494976961, "post_id": 44013113, "comment_id": 75054448, "body": "That&#39;s because of newline."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494977010, "post_id": 44013113, "comment_id": 75054455, "body": "@BLUEPIXY Why exactly does a newline cause this behavior?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1494977165, "post_id": 44013113, "comment_id": 75054496, "body": "@nbro Enter Key is received in <code>getchar</code> as a newline."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494977232, "post_id": 44013113, "comment_id": 75054514, "body": "@BLUEPIXY Of course, I know that, but why is the <code>printf</code> function in the loop executed apparently twice?"}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1494977396, "post_id": 44013113, "comment_id": 75054561, "body": "@Gilles I retracted my vote to close this question since the other question is asking about what the expected behavior is and how to make it work as the OP wanted. In this case, the OP is also asking why this is happening."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1494977434, "post_id": 44013113, "comment_id": 75054571, "body": "@nbro <code>&#39;\\n&#39;</code> is not <code>&#39;q&#39;</code> so the loop is continued."}, {"owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1494977571, "post_id": 44013113, "comment_id": 75054600, "body": "@BLUEPIXY So, essentially, we&#39;re seeing twice <code>Enter a character:</code> in <code>Enter a character: Enter a character: a</code> because <code>\\n</code> is consumed automatically in the iteration after entering &quot;w&quot; as input and pressing enter. This is exactly what I wanted you to tell me and the others."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "edited": false, "score": 0, "creation_date": 1494977874, "post_id": 44013113, "comment_id": 75054664, "body": "@nbro It is not automatic, because that is how it is done."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1494978560, "post_id": 44013113, "comment_id": 75054818, "body": "Sidenote: <code>printf</code> is a function, not a statement."}], "answers": [{"tags": [], "owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "is_accepted": false, "score": 4, "last_activity_date": 1494976998, "creation_date": 1494976998, "answer_id": 44013155, "question_id": 44013113, "link": "https://stackoverflow.com/questions/44013113/why-is-my-printf-statement-being-run-twice/44013155#44013155", "title": "Why is my printf() statement being run twice?", "body": "<p>You didn't enter <code>w</code> on the command line. You entered <code>w\\n</code>. That's two characters.</p>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 6395331, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206324456173490/picture?type=large", "display_name": "Riccardo Bonafede", "link": "https://stackoverflow.com/users/6395331/riccardo-bonafede"}, "is_accepted": false, "score": 2, "last_activity_date": 1494977131, "last_edit_date": 1494977131, "creation_date": 1494977015, "answer_id": 44013157, "question_id": 44013113, "link": "https://stackoverflow.com/questions/44013113/why-is-my-printf-statement-being-run-twice/44013157#44013157", "title": "Why is my printf() statement being run twice?", "body": "<p>Because <code>getchar</code> reads a character and '\\n', not only the character that you typed.</p>\n"}, {"comments": [{"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 2, "creation_date": 1494977540, "post_id": 44013194, "comment_id": 75054594, "body": "That&#39;s not a good way to fix it. It only works if the user entered a single character on the line. A better fix would be to loop over <code>getchar</code> until a newline is found."}], "tags": [], "owner": {"reputation": 738, "user_id": 7572026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340e7b48d6bfe006ce1b6f7161911df2?s=128&d=identicon&r=PG&f=1", "display_name": "Manav Dubey", "link": "https://stackoverflow.com/users/7572026/manav-dubey"}, "is_accepted": true, "score": 0, "last_activity_date": 1494977658, "last_edit_date": 1494977658, "creation_date": 1494977340, "answer_id": 44013194, "question_id": 44013113, "link": "https://stackoverflow.com/questions/44013113/why-is-my-printf-statement-being-run-twice/44013194#44013194", "title": "Why is my printf() statement being run twice?", "body": "<p>As everyone has already stated, <code>getchar()</code> is consuming a newline ('\\n') making you have two iterations. A way to fix this is to do this:</p>\n\n<pre><code>int main(){\n  int ch;\n  for( ch = ' '; ch != 'q'; ) {\n     printf(\"Enter a character: \");\n     ch = getchar();\n     getchar();\n  }\n  printf(\"You entered a q!\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>The reason for the second <code>getchar()</code> is to consume that newline so you won't have a double output of the same thing. Using this method will only work if you are only inputting one character.</p>\n"}, {"tags": [], "owner": {"reputation": 750, "user_id": 6876037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acf7e5bb30e124f2597567bfd9aab1?s=128&d=identicon&r=PG&f=1", "display_name": "anonymoose", "link": "https://stackoverflow.com/users/6876037/anonymoose"}, "is_accepted": false, "score": 0, "last_activity_date": 1494978609, "creation_date": 1494978609, "answer_id": 44013354, "question_id": 44013113, "link": "https://stackoverflow.com/questions/44013113/why-is-my-printf-statement-being-run-twice/44013354#44013354", "title": "Why is my printf() statement being run twice?", "body": "<p>As comments and previous answers have stated, <code>getchar()</code> does not read the newline at the end. The quick fix is to add another <code>getchar();</code> at the end of your loop like this:</p>\n\n<pre><code>int main()\n{\n  int ch;\n  for( ch = ' '; ch != 'q'; ) {\n     printf(\"Enter a character: \");\n     ch = getchar();\n     getchar();\n  }\n  printf(\"You entered a q!\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>If you want a more flexible solution that will work if the user types more than one character, try this:</p>\n\n<pre><code>int main()\n{\n  int ch;\n  for( ch = ' '; ch != 'q'; ) {\n     printf(\"Enter a character: \");\n     ch = getfirstchar();\n  }\n  printf(\"You entered a q!\\n\");\n\n  return 0;\n}\nint getfirstchar() {\n  int c = getchar();\n  while(getchar() != '\\n')\n    ;\n  return c;\n}\n</code></pre>\n\n<p>I moved reading the character into a separate function so it's more adaptable to future code.</p>\n"}], "owner": {"reputation": 11, "user_id": 2788850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5bfd15bb1ded0d538fbb54b438c829?s=128&d=identicon&r=PG", "display_name": "rj1094", "link": "https://stackoverflow.com/users/2788850/rj1094"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "closed_date": 1494989051, "accepted_answer_id": 44013194, "answer_count": 4, "score": 0, "last_activity_date": 1494978609, "creation_date": 1494976711, "last_edit_date": 1494978046, "question_id": 44013113, "link": "https://stackoverflow.com/questions/44013113/why-is-my-printf-statement-being-run-twice", "closed_reason": "Duplicate", "title": "Why is my printf() statement being run twice?", "body": "<p>After the initial iteration, the <code>printf()</code> output is shown twice each iteration. Why?</p>\n\n<pre><code>int main()\n{\n  int ch;\n  for( ch = ' '; ch != 'q'; ) {\n     printf(\"Enter a character: \");\n     ch = getchar();\n  }\n  printf(\"You entered a q!\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>The terminal output is:</p>\n\n<pre><code>Enter a character: w\nEnter a character: Enter a character: a\nEnter a character: Enter a character: q\nYou entered a q!\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 334, "user_id": 2229313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5271b45f88568ba85abd28acb3d43f?s=128&d=identicon&r=PG", "display_name": "TeMPOraL", "link": "https://stackoverflow.com/users/2229313/temporal"}, "edited": false, "score": 2, "creation_date": 1494975216, "post_id": 44012865, "comment_id": 75053916, "body": "xmplrpc_client.rpc_tx_vtbl-&gt;myrpc?"}], "answers": [{"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1494976503, "post_id": 44012961, "comment_id": 75054324, "body": "The <code>-&gt;</code> wouldn&#39;t be used at all - neither <code>xmlrpc_client</code> nor <code>rpc_tx_vtbl</code> are pointers to <code>struct</code>."}, {"owner": {"reputation": 365, "user_id": 5954246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49abda1fb6b581f05bb78257f1edf142?s=128&d=identicon&r=PG&f=1", "display_name": "codeconscious", "link": "https://stackoverflow.com/users/5954246/codeconscious"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1494977189, "post_id": 44012961, "comment_id": 75054503, "body": "@JohnBode oh yeah just noticed! Thanks"}], "tags": [], "owner": {"reputation": 365, "user_id": 5954246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49abda1fb6b581f05bb78257f1edf142?s=128&d=identicon&r=PG&f=1", "display_name": "codeconscious", "link": "https://stackoverflow.com/users/5954246/codeconscious"}, "is_accepted": false, "score": 0, "last_activity_date": 1494977249, "last_edit_date": 1495535472, "creation_date": 1494975707, "answer_id": 44012961, "question_id": 44012865, "link": "https://stackoverflow.com/questions/44012865/error-invalid-type-argument-of-have-struct-xmplrpc-binding/44012961#44012961", "title": "error: invalid type argument of \u2018-&gt;\u2019 (have \u2018struct xmplrpc_binding\u2019)", "body": "<p>In order to fix the error you should write it this way</p>\n\n<pre><code> xmplrpc_client.rpc_tx_vtbl.myrpc(/* and args */);\n</code></pre>\n\n<p>this my solve the confusion <a href=\"https://stackoverflow.com/questions/2575048/arrow-operator-usage-in-c\">Arrow operator (-&gt;) usage in C</a></p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1494976464, "creation_date": 1494976464, "answer_id": 44013067, "question_id": 44012865, "link": "https://stackoverflow.com/questions/44012865/error-invalid-type-argument-of-have-struct-xmplrpc-binding/44013067#44013067", "title": "error: invalid type argument of \u2018-&gt;\u2019 (have \u2018struct xmplrpc_binding\u2019)", "body": "<p>You use the <code>-&gt;</code> operator when the operand (which appears to the <em>left</em> of the operator) is a pointer to a <code>struct</code> or <code>union</code> type, and <code>.</code> when the operand is an <em>instance</em> of a <code>struct</code> or <code>union</code> type.</p>\n\n<p>So...</p>\n\n<p><code>xmplrpc_client</code> is declared as an <em>instance</em> of <code>struct xmplrpc_binding</code>, thus you would use the <code>.</code> operator to access any of it's members:</p>\n\n<pre><code>xmlrpc_client.rpc_tx_vtbl\n</code></pre>\n\n<p>The member <code>rpc_tx_vtbl</code> is declared as an <em>instance</em> of <code>struct mplrpc_rpc_tx_vtbl</code>, so again, you'd use the <code>.</code> operator to access any of its members:</p>\n\n<pre><code>xmlrpc_client.rpc_tx_vtbl.myrpc\n</code></pre>\n\n<p>Thus, your call should be written </p>\n\n<pre><code>err = xmplrpc_client.rpc_tx_vtbl.myrpc(&amp;xmplrpc_client, in, &amp;s_out);\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 7170224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf65a8810fdb86071305ae49e5a540c7?s=128&d=identicon&r=PG&f=1", "display_name": "cstjh", "link": "https://stackoverflow.com/users/7170224/cstjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2882, "favorite_count": 0, "accepted_answer_id": 44013067, "answer_count": 2, "score": 0, "last_activity_date": 1494977249, "creation_date": 1494975121, "question_id": 44012865, "link": "https://stackoverflow.com/questions/44012865/error-invalid-type-argument-of-have-struct-xmplrpc-binding", "title": "error: invalid type argument of \u2018-&gt;\u2019 (have \u2018struct xmplrpc_binding\u2019)", "body": "<p>I got the error message:</p>\n\n<pre><code>../usr/examples/xmpl-rpc/rpc_rpc.c: In function \u2018send_myrpc\u2019:\n../usr/examples/xmpl-rpc/rpc_rpc.c:40:25: error: invalid type argument of \u2018-&gt;\u2019 (have \u2018struct xmplrpc_binding\u2019)\n err = xmplrpc_client-&gt;rpc_tx_vtbl.myrpc(&amp;xmplrpc_client, in, &amp;s_out);\n                     ^\n</code></pre>\n\n<p>and the definition of <code>xmplrpc_client</code> is:</p>\n\n<pre><code>static struct xmplrpc_binding xmplrpc_client;\n</code></pre>\n\n<p>The struct <code>xmplrpc_binding</code> has </p>\n\n<pre><code>struct xmplrpc_rpc_tx_vtbl rpc_tx_vtbl;\n</code></pre>\n\n<p>And the struct <code>xmplrpc_rpc_tx_vtbl</code> is</p>\n\n<pre><code>struct xmplrpc_rpc_tx_vtbl {\n  xmplrpc_myrpc__rpc_tx_method_fn *myrpc;\n};\n</code></pre>\n\n<p>It's obvious that <code>xmplrpc_client.rpc_tx_vtbl.myrpc</code> is the wrong way, and I think the way I wrote <code>xmplrpc_client-&gt;rpc_tx_vtbl.myrpc</code> is correct. </p>\n\n<p>What should I do to fix this error?</p>\n"}]