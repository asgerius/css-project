[{"tags": ["c"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 1, "creation_date": 1568242710, "post_id": 57897755, "comment_id": 102216367, "body": "By storing the number of items somewhere, or using a sentinel value."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1568242961, "post_id": 57897755, "comment_id": 102216411, "body": "Or <a href=\"https://stackoverflow.com/questions/10220124/how-to-know-the-end-of-int-array\" title=\"how to know the end of int array\">stackoverflow.com/questions/10220124/&hellip;</a>"}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1568243040, "post_id": 57897755, "comment_id": 102216427, "body": "Or <a href=\"https://stackoverflow.com/questions/52481172/c-count-elements-bound-check-array\" title=\"c count elements bound check array\">stackoverflow.com/questions/52481172/&hellip;</a>, etc."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1568243506, "post_id": 57897755, "comment_id": 102216532, "body": "Your <code>strings</code> declaration is not valid."}, {"owner": {"reputation": 435, "user_id": 4673887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd5054058df8d6338d04a3c0f767441?s=128&d=identicon&r=PG&f=1", "display_name": "FI-Info", "link": "https://stackoverflow.com/users/4673887/fi-info"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1568243785, "post_id": 57897755, "comment_id": 102216596, "body": "@Clifford -- thanks. Updated."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568244038, "post_id": 57897847, "comment_id": 102216651, "body": "Although &quot;while sizeof(strings[0]) gives you the size of one pointer in bytes&quot; is correct in this case, &quot;while sizeof(strings[0]) gives you the size of one array element in bytes&quot; is also correct and more general purpose."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1568244472, "post_id": 57897847, "comment_id": 102216724, "body": "@chux It&#39;s a tradeoff.  I like to take these things one small, explicit step at a time, since diving in with too many levels of abstraction too soon (like saying &quot;one element&quot;) can be confusing.  I deliberately said &quot;one pointer&quot; because here we know we&#39;re talking about an array of pointers.  But then again, it&#39;s way too easy to get confused about arrays and pointers, so there&#39;s yet another possible misreading there.  Compromise wording adopted."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 3, "last_activity_date": 1568244540, "last_edit_date": 1568244540, "creation_date": 1568243451, "answer_id": 57897847, "question_id": 57897755, "link": "https://stackoverflow.com/questions/57897755/denoting-the-end-of-a-multidimensional-array-or-multi-pointer/57897847#57897847", "title": "Denoting the end of a multidimensional array or multi-pointer", "body": "<p>You could do something like this, which is nicely analogous to null termination for strings:</p>\n\n<pre><code>char * strings[] = {\n    \"one\",\n    \"two\",\n    NULL\n};\n</code></pre>\n\n<p>You could print those strings using a loop like this:</p>\n\n<pre><code>char **pp;\nfor(pp = strings; pp != NULL; pp++)\n    printf(\"%s\\n\", *pp);\n</code></pre>\n\n<p>But when I say \"you could do\", I mean it.  There's no rule saying you <em>must</em> do it this way.  (This is in contrast to the strings themselves, where you really must use null-character termination if you construct your own strings and if you want yours to be compatible with <code>strcpy</code>, <code>printf</code>, etc.)</p>\n\n<p>The <code>NULL</code> termination I have shown works well for an array of pointers.  It can be harder to pick an appropriate sentinel value for other types, such as array of <code>int</code>.  (If you know your numbers are all positive, you can use 0 or -1 as a sentinel, but if your array has both positive and negative numbers, you may be stuck.)</p>\n\n<p>The other possibility is to maintain a separate count:</p>\n\n<pre><code>char * strings[] = {\n    \"one\",\n    \"two\"\n};\n\nint nstrings = 2;\n\n\nint i;\nfor(i = 0; i &lt; nstrings; i++)\n    printf(\"%s\\n\", strings[i]);\n</code></pre>\n\n<p>Rather than counting the strings by hand and explicitly initializing <code>nstrings</code> to 2, the better technique is to let the compiler do it for you:</p>\n\n<pre><code>int nstrings = sizeof(strings) / sizeof(strings[0];\n</code></pre>\n\n<p><code>sizeof(strings)</code> gives you the size of the whole array in bytes, while <code>sizeof(strings[0])</code> gives you the size of one element -- that is, one pointer -- in bytes, and the division therefore gives you the number of entries, which is what you want.</p>\n\n<p>Using <code>sizeof</code> and dividing like that is a pefectly common and perfectly legal idiom, but it's mildly obscure, so I prefer to encapsulate it (and make it a bit more self-documenting) with a macro, like this:</p>\n\n<pre><code>#define SIZEOFARRAY(a) (sizeof(a) / sizeof(a[0])\n\nint nstrings = SIZEOFARRAY(strings);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 3, "last_activity_date": 1568244729, "last_edit_date": 1568244729, "creation_date": 1568244279, "answer_id": 57897927, "question_id": 57897755, "link": "https://stackoverflow.com/questions/57897755/denoting-the-end-of-a-multidimensional-array-or-multi-pointer/57897927#57897927", "title": "Denoting the end of a multidimensional array or multi-pointer", "body": "<p>The array has compile-time constant size, and the number of elements can be determined by the expression <code>sizeof(strings) / sizeof(*strings)</code>.  Given then:</p>\n\n<pre><code>const size_t STRING_COUNT = sizeof(strings) / sizeof(*strings) ;\n</code></pre>\n\n<p>Then the last element in the array is:</p>\n\n<pre><code>strings[STRING_COUNT - 1] ;\n</code></pre>\n\n<p>and the array can be iterated with:</p>\n\n<pre><code>for( size_t i = 0; i &lt; STRING_COUNT; i++ ) ...\n</code></pre>\n\n<p>If <code>strings</code> is passed as an argument, it will be passed as a pointer, so the array size information will be lost.  In that case you would normally pass the size information as a separate argument:</p>\n\n<pre><code>some_function( strings, STRING_COUNT ) ;\n</code></pre>\n\n<p>Alternatively you can explicitly add a sentinel value to the array:</p>\n\n<pre><code>char* strings[] = \n{\n    \"one\",\n    \"two\",\n    NULL\n} ;\n</code></pre>\n\n<p>which can then be detected just as the NUL character is for strings. Note that for a string, string length and the length of the array the string is stored in are not related, the array need only be at least as long as the string plus NUL terminator.  The same is true of using a sentinel value.  For example given:</p>\n\n<pre><code>char* strings[20] = \n{\n    \"one\",\n    \"two\"\n    NULL\n} ;\n</code></pre>\n\n<p><code>sizeof(strings)/sizeof(*strings)</code> will be 20, but the array contains only pointers to two valid string-constants before the initialiser after initialisation.</p>\n\n<p>So whether you use the array size or a sentinel depends on the specific data structure you need.  The array size is appropriate for constant arrays or arrays with constant number of valid elements.  A sentinal might be used for variable arrays, but is not always necessary - you can simply maintain a separate count of valid elements, or may have a sparse array where valid elements are not necessarily contiguous.</p>\n"}], "owner": {"reputation": 435, "user_id": 4673887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd5054058df8d6338d04a3c0f767441?s=128&d=identicon&r=PG&f=1", "display_name": "FI-Info", "link": "https://stackoverflow.com/users/4673887/fi-info"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "closed_date": 1568283843, "accepted_answer_id": 57897847, "answer_count": 2, "score": 0, "last_activity_date": 1568244729, "creation_date": 1568242563, "last_edit_date": 1568243778, "question_id": 57897755, "link": "https://stackoverflow.com/questions/57897755/denoting-the-end-of-a-multidimensional-array-or-multi-pointer", "closed_reason": "Duplicate", "title": "Denoting the end of a multidimensional array or multi-pointer", "body": "<p>For a single (string) array, the end is denoted by <code>\\0</code>. For example, if I create the string:</p>\n\n<pre><code>char * string = \"hello\";\n</code></pre>\n\n<p>It will be represented as <code>{'h','e','l','l','o','\\0'}</code>.</p>\n\n<p>What is done for an array such as the following to denote \"its end\" ?</p>\n\n<pre><code>char * strings[] = {\"one\", \"two\"};\n</code></pre>\n\n<p>When iterating through a loop, how would I detect 'the end' of the array?</p>\n"}, {"tags": ["python", "c", "python-3.x", "mmap"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1568242360, "post_id": 57897672, "comment_id": 102216272, "body": "When you map a file, the memory and the file are automatically synchronized."}, {"owner": {"reputation": 559, "user_id": 4624106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec8065d1fddb547b919b84fef5c43f2f?s=128&d=identicon&r=PG&f=1", "display_name": "giupardeb", "link": "https://stackoverflow.com/users/4624106/giupardeb"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568242594, "post_id": 57897672, "comment_id": 102216332, "body": "is not here any solution to avoid the sync? with many changes it&#39;s like having a physical file without a map. Maybe is there an alternative to mmap?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568243182, "post_id": 57897672, "comment_id": 102216455, "body": "What are you really trying to achieve? If you don&#39;t want the file, you can use shared memory instead of <code>mmap</code>. See <a href=\"https://stackoverflow.com/questions/49103709/how-to-use-shared-memory-in-python-and-c-c\" title=\"how to use shared memory in python and c c\">stackoverflow.com/questions/49103709/&hellip;</a>"}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "edited": false, "score": 0, "creation_date": 1568247409, "post_id": 57897672, "comment_id": 102217279, "body": "The whole point of the <a href=\"https://docs.python.org/3/library/mmap.html#module-mmap\" rel=\"nofollow noreferrer\"><code>mmap</code></a> module is to support memory-mapped <i>files</i> \u2014 sounds like what you want is memory shared between processes..."}, {"owner": {"reputation": 559, "user_id": 4624106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec8065d1fddb547b919b84fef5c43f2f?s=128&d=identicon&r=PG&f=1", "display_name": "giupardeb", "link": "https://stackoverflow.com/users/4624106/giupardeb"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568270100, "post_id": 57897672, "comment_id": 102222380, "body": "@Barmar Yes my goal is memory shared between processes. I want that Python write on the memory shared and C read from the memoty shared and finally, before the C process ends it must write the memory shared to a file."}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "edited": false, "score": 0, "creation_date": 1568278010, "post_id": 57897672, "comment_id": 102226081, "body": "It looks like they&#39;re adding a <a href=\"https://docs.python.org/3.9/library/multiprocessing.shared_memory.html\" rel=\"nofollow noreferrer\"><code>multiprocessing.shared_memory.SharedMemory</code></a> class in Python 3.8."}], "owner": {"reputation": 559, "user_id": 4624106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec8065d1fddb547b919b84fef5c43f2f?s=128&d=identicon&r=PG&f=1", "display_name": "giupardeb", "link": "https://stackoverflow.com/users/4624106/giupardeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "closed_date": 1568316109, "answer_count": 0, "score": 0, "last_activity_date": 1568242353, "creation_date": 1568241804, "last_edit_date": 1568242353, "question_id": 57897672, "link": "https://stackoverflow.com/questions/57897672/write-on-the-memory-with-mmap", "closed_reason": "Duplicate", "title": "Write on the memory with mmap", "body": "<p>I'm on Linux, and I using mmap for sharing information between python code and C code. \nWhen I used this instruction:</p>\n\n<pre><code>buf = mmap.mmap(fd.fileno(), 4096, access=mmap.ACCESS_DEFAULT)\nwith buf:\n    buf.write(b'HELLO WORLD')\n</code></pre>\n\n<p>This is C instruction for mmap:</p>\n\n<pre><code>  int *shared = mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_SHARED, fd1, 0);\n</code></pre>\n\n<p>I'm expecting my changes are still in the memory, but it is in a file on the disk already. </p>\n\n<p>I would like that Python code write all information on the memory and C code write all information in the memory to file. Is it possible to do this?</p>\n"}, {"tags": ["c", "encryption", "fgets"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568241105, "post_id": 57897521, "comment_id": 102215996, "body": "<a href=\"http://man7.org/linux/man-pages/man3/fgets.3p.html\" rel=\"nofollow noreferrer\">man 3 fgets</a> &quot;The <code>fgets()</code> function shall read bytes from stream into the array pointed to by s, <b><i>until</i></b> <code>n\u22121</code> bytes are read, or a <code>&lt;newline&gt;</code> is read ... The string is then terminated with a null byte.&quot; (you could enter <code>1,000,000</code> characters, but <code>fgets</code> will only read <code>n - 1</code> of them and store only those characters along with the null byte in your array) Which is one reason new C programmers are encourage to use <code>fgets</code> and in contrast why <code>gets</code> is no longer part of the C standard."}, {"owner": {"reputation": 7, "user_id": 7143384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55299a00982321cbb10b7590ad5df2fd?s=128&d=identicon&r=PG&f=1", "display_name": "user7143384", "link": "https://stackoverflow.com/users/7143384/user7143384"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568241810, "post_id": 57897521, "comment_id": 102216163, "body": "so because fgets takes the initial input it cuts it down to the specified size rendering the else statement useless, but why does it run through the program without requiring hitting enter if the initial size is larger, but requires hitting enter if within the given parameters?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568243023, "post_id": 57897521, "comment_id": 102216423, "body": "Post the <i>exact</i> input such as <code>&quot;qazwsxedc\\n&quot;</code>.  Notice I included the &lt;Enter&gt; as <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 7, "user_id": 7143384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55299a00982321cbb10b7590ad5df2fd?s=128&d=identicon&r=PG&f=1", "display_name": "user7143384", "link": "https://stackoverflow.com/users/7143384/user7143384"}, "edited": false, "score": 0, "creation_date": 1568243763, "post_id": 57897521, "comment_id": 102216588, "body": "works with entry of 123456789 then hit enter 3 times to progress through code.       1234567890 and enter twice to progress through code.       12345678901 require only 1 enter to progress through entire code. anything below 10 characters takes 3 Enter hits to progress through entire code"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568244227, "post_id": 57897521, "comment_id": 102216680, "body": "When you enter  123456789 and then hit enter, <code>input</code> becomes <code>&quot;123456789\\n&quot;</code> - a strlen() of 10.  see <a href=\"https://stackoverflow.com/a/26831985/2410359\">this</a>"}, {"owner": {"reputation": 7, "user_id": 7143384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55299a00982321cbb10b7590ad5df2fd?s=128&d=identicon&r=PG&f=1", "display_name": "user7143384", "link": "https://stackoverflow.com/users/7143384/user7143384"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568244520, "post_id": 57897521, "comment_id": 102216738, "body": "@chux okay so adjusted length &lt;=10 to 11, yet I still get the odd enter progression, I&#39;m not normally a coding guy so im probably missing something obvious. for fgets(11) 9 characters takes 3 /n, 10 takes 2/n , anything above 11 characters takes 3/n"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568244611, "post_id": 57897521, "comment_id": 102216765, "body": "If <code>&#39;\\n&#39;</code> is not meant to be part of the PW, see <a href=\"https://stackoverflow.com/q/2693776/2410359\">stackoverflow.com/q/2693776/2410359</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568244756, "post_id": 57897521, "comment_id": 102216792, "body": "Why <code>input[]</code> so small?  Try <code>char input[100]; fgets(input, sizeof input,stdin);</code>"}, {"owner": {"reputation": 7, "user_id": 7143384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55299a00982321cbb10b7590ad5df2fd?s=128&d=identicon&r=PG&f=1", "display_name": "user7143384", "link": "https://stackoverflow.com/users/7143384/user7143384"}, "edited": false, "score": 0, "creation_date": 1568245022, "post_id": 57897521, "comment_id": 102216839, "body": "its just a test program tasked to alter to make a bit more secure, originally the program used gets with a char input [5]"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568245261, "post_id": 57897521, "comment_id": 102216881, "body": "Confucius say <i>Never Skimp on Buffer Size...</i> You may also want to look at <a href=\"https://stackoverflow.com/questions/6856635/hide-password-input-on-terminal/32421674?r=SearchResults&amp;s=1|47.6501#32421674\">Hide password input on terminal</a>"}, {"owner": {"reputation": 7, "user_id": 7143384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55299a00982321cbb10b7590ad5df2fd?s=128&d=identicon&r=PG&f=1", "display_name": "user7143384", "link": "https://stackoverflow.com/users/7143384/user7143384"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568245955, "post_id": 57897521, "comment_id": 102216999, "body": "@DavidC.Rankin had a chuckle on that one, password isnt really an issue as this wont actually be implemented, just a concept thing, plus the password gets shown anyway during the decrypt to show it works."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1568253087, "post_id": 57897521, "comment_id": 102218369, "body": "Your program gets unblocked on the read from the interactive input device when the user presses Enter. At that point, all of the input right through the newline character is available for the program to read without blocking. <code>fgets</code> returns with a portion of that input up to the buffer size, leaving the remaining input in the stream. Then when <code>getchar</code> is called, it has no reason to wait for a character; there is already one available.  Only if <code>getchar</code> finds the stream empty will the program pause for another line of input, which mean that <code>fgets</code> must read the complete line."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 3, "last_activity_date": 1568253271, "last_edit_date": 1568253271, "creation_date": 1568252500, "answer_id": 57898716, "question_id": 57897521, "link": "https://stackoverflow.com/questions/57897521/else-section-not-activating-if-string-length-is-larger-than-given-parameters-if/57898716#57898716", "title": "else section not activating if string length is larger than given parameters if statement", "body": "<p>I have tried to decipher what your objective was with the code, and I've read the tea-leaves and arrived at the conclusion (perhaps wrongly) that the crux of your question is aimed at input and branching control that on the encryption itself.</p>\n\n<p>The \"Confucius\" comment was only half a half-hearted suggestion as the <em>\"Never Skimp on Buffer Size\"</em> goes to the heart of your ability to control what branches are taken by prompting the user for directions. Why?</p>\n\n<ul>\n<li>If, as in your original code, you have a buffer size of <code>20</code>, and tell <code>fgets</code> to read at most <code>10</code> chars, then if the user enters anything more than <code>10</code> chars, the remainder are left in <code>stdin</code> <strong><em>unread</em></strong>.</li>\n<li>any characters that are left in <code>stdin</code> unread, will happily be used as input for each of your later <code>getchar()</code> statements causing you to lose complete control over how your code branches.</li>\n<li>using an adequately sized buffer and allowing <code>fgets</code> to consume a complete line at a time will ensure there are no characters left unread in <code>stdin</code> (your input buffer). You will find this to be key on taking most user input in C.</li>\n</ul>\n\n<p>So ensuring you have an adequately sized buffer and consume a line of input at each time is fundamental to being able to control where your code goes next.</p>\n\n<p>An alternative to providing a buffer capable of holding each line of input is to read the wanted number of characters and then manually emptying <code>stdin</code> before the next input. That can be as easy as reading characters until a <code>'\\n'</code> or <code>EOF</code> is reached. But... there is a catch. You have to know that characters remain before attempting to empty <code>stdin</code> with whatever function you use (e.g. <code>getchar()</code> will block -- waiting for input until input is present to be read). If you attempt to empty <code>stdin</code> in this manner when there is nothing to be emptied, your user will be left staring at a blinking cursor wondering what to do.</p>\n\n<p>Back to your code. The logic is a bit hard to follow, but from the included comments, it appears that you consider a correct passphrase for purposes of encrypting it, a phrase with <code>1-5</code> characters. An empty passphrase or a passphrase with 6 or more characters is considered invalid. (it doesn't matter what the actual numbers are from a passphase standpoint -- this is an exercise about input and branching control)</p>\n\n<p>If I understand the <code>1-5</code> char (encrypt) or <code>0</code> or <code>6</code> or more (invalid) logic, then you will want to adjust the structure of your code to follow that a bit closer.  From an overview standpoint, you either have a good passphrase to encrypt or you don't. That would control the primary branches in your code. You can provide the logic in a single <code>if {..} else {..}</code> statement, e.g.</p>\n\n<pre><code>    /* if input is longer than 0 but shorter than 6, encrypt data */\n    if (length &amp;&amp; length &lt; 6) {\n        /* all your good pass phrase code goes here */\n    }\n    else {  /* invalid pass phrase to begin with */\n        fputs (\"error: pass phrase empty or greater than 5 chars.\\n\", stderr);\n        return 1;\n    }\n</code></pre>\n\n<p>Contrast this above with the multiple independent statement groups you have in your example and it should make sense why you were having trouble with the decision tree in your code.</p>\n\n<p>Now on to your prompts to the user to press <kbd>Enter</kbd>. When you attempt to catch that input with a single <code>getchar()</code> it is horribly fragile and subject to being skipped if any characters exist in <code>stdin</code> and it has the same problem of leaving characters in <code>stdin</code> unread if more than <kbd>Enter</kbd> is pressed. Here, just declare another character array to use for temporary input the same size as your <code>input[]</code> array. Now instead of <code>getchar()</code>, just use <code>fgets()</code> again even to capture the <kbd>Enter</kbd> alone. </p>\n\n<p>(which it is quite capable of doing, since it reads and include the <code>'\\n'</code> in the buffer it fills, it will not block waiting on input like <code>getchar()</code> will)</p>\n\n<p>Concerned about size in using 512-bytes in two buffers -- don't be. Most OS's provide a minimum of 1-Meg of stack space, so that 512-bytes represents only <code>0.048%</code> of the stack storage you have available. (you still have <code>1048576 - 512 = 1048064</code> byte of stack space avaialble)</p>\n\n<p>With that change, your code can be rewritten to contain all logic related to handling a good/encrypted password within the first <code>if {...}</code> block, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXC 256    /* if you need a constant, #define one (or more) */\n\nint main (void) {\n\n    char    input[MAXC],    /* buffer to hold pass phrase */\n            tmp[MAXC];      /* temporary buffer for [enter] input */\n    size_t  i,              /* declares an UNINTIALIZED size_t */\n            length;         /*           (ditto)              */\n\n    fputs (\"Your pass phrase is: \", stdout); /* no conversion, fputs is fine */\n    if (!fgets (input, MAXC, stdin)) {\n        fputs (\"(user canceled input)\\n\", stderr);\n        return 1;\n    }\n    /* remove '\\n' by overwriting with '\\0' (if present)\n     * saving length of input in length\n     */\n    input[(length = strcspn(input, \"\\n\"))] = 0;\n\n    /* if input is longer than 0 but shorter than 6, encrypt data */\n    if (length &amp;&amp; length &lt; 6) {\n        int     encrypted = 0;  /* flag keeping state of if pw encrypted */\n\n        for (i = 0; i &lt; length; i++)    /* encrypt the pass phrase */\n            input[i] ^= 0x7f;\n        encrypted = 1;                  /* set flag true */\n\n        /* print encrypted text in an hex format (change as desired) */\n        fputs (\"\\nTo see the encrypted text press [enter]: \", stdout);\n        if (fgets (tmp, MAXC, stdin) &amp;&amp; *tmp == '\\n') {\n            for (i = 0; i &lt; length; i++)\n                printf (\" %02x\", input[i]);\n            putchar ('\\n');\n        }\n\n        /* decrypt restoring plain-text pass phrase */\n        fputs (\"\\ndecrypted pass phrase, press [enter]: \", stdout);\n        if (fgets (tmp, MAXC, stdin) &amp;&amp; *tmp == '\\n') {\n            for (i = 0; i &lt; length; i++)\n                input[i] ^= 0x7f;\n            encrypted = 0;              /* set flag false after decryption */\n        }\n        else {  /* if user pressed any other key (or generated EOF) */\n            fputs (\"error: user chose not to decrypt pass phrase.\\n\", stderr);\n            return 1;\n        }\n\n        /* output decrypted plain-text pass pharase (if decrypted) */\n        fputs (\"\\nTo see recovered text press [enter]: \", stdout);\n        if (fgets (tmp, MAXC, stdin) &amp;&amp; *tmp == '\\n' &amp;&amp; !encrypted) {\n            for (i = 0; i &lt; length; i++)\n                putchar (input[i]);\n            putchar ('\\n');\n        }\n    }\n    else {  /* invalid pass phrase to begin with */\n        fputs (\"error: pass phrase empty or greater than 5 chars.\\n\", stderr);\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> above the <code>encrypted</code> flag is simply used to hold the state of whether the contents of <code>input[]</code> is currently encrypted or not to provide an additional conditional check before you attempt to print the decrypted passphrase)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Valid passphrse case:</p>\n\n<pre><code>$ ./bin/pass0-5\nYour pass phrase is: abcde\n\nTo see the encrypted text press [enter]:\n 1e 1d 1c 1b 1a\n\ndecrypted pass phrase, press [enter]:\n\nTo see recovered text press [enter]:\nabcde\n</code></pre>\n\n<p>User chooses not to decrypt case:</p>\n\n<pre><code>$ ./bin/pass0-5\nYour pass phrase is: abcde\n\nTo see the encrypted text press [enter]:\n 1e 1d 1c 1b 1a\n\ndecrypted pass phrase, press [enter]: No, I don't want to!\nerror: user chose not to decrypt pass phrase.\n</code></pre>\n\n<p>Passphrase too long case:</p>\n\n<pre><code>$ ./bin/pass0-5\nYour pass phrase is: abcdef\nerror: pass phrase empty or greater than 5 chars.\n</code></pre>\n\n<p>Passphrase empty case:</p>\n\n<pre><code>$ ./bin/pass0-5\nYour pass phrase is:\nerror: pass phrase empty or greater than 5 chars.\n</code></pre>\n\n<p>I don't know if I read the tea-leaves properly, but from your comments and original question it looked like this area was the one that was actually your focus. Look things over and let me know if you have further questions, and if I got the main gist of your question wrong, let me know and I'm happy to help further.</p>\n"}], "owner": {"reputation": 7, "user_id": 7143384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55299a00982321cbb10b7590ad5df2fd?s=128&d=identicon&r=PG&f=1", "display_name": "user7143384", "link": "https://stackoverflow.com/users/7143384/user7143384"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568253271, "creation_date": 1568240540, "question_id": 57897521, "link": "https://stackoverflow.com/questions/57897521/else-section-not-activating-if-string-length-is-larger-than-given-parameters-if", "title": "else section not activating if string length is larger than given parameters if statement", "body": "<p>Basic encryption with input validation, program works as needed if input is within defined parameters requiring user input to advance through each stage, if input is larger than defined parameters, else should trigger saying password is invalid but instead runs through the entire program without user input to trigger advance.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\n#include &lt;stdio.h&gt; //library containing built in functions for C\n#include &lt;stdlib.h&gt; // contains general purpose library for C\n#include &lt;string.h&gt;  //library containing methods for manipulating strings\nint main()\n{\n    // creates character input array of size 5\n    char input[20];\n    //initialize variable i\n    int i;\n    //initialize variable length\n    int length;\n    //prints the phrase\n   //printf(\"Your pass phrase is: \");\n    // used to read input string, gets replaced with fgets to secure input to array length\n       //fgets(input,11,stdin);\n        //assigns input to array length\n        //length = strlen(input);\n        //prints the phrase\n    printf(\"Your pass phrase is: \");\n    fgets(input,11,stdin);\n    //assigns input to array length\n    length = strlen(input);\n    // if loop that if entered text is longer than 0 but shorter than 6 will encrypt data\n    if ((length &gt; 0 &amp;&amp; length &lt;=10)){\n        // encrypts array iteratting through elements\n        for (i=0; i&lt;length; i++)\n            // uses bitwise xor cipher to encrypt using 0x7f which shifts the characters out of the standard ascii range\n            input[i] = 0x7F ^ input[i];\n    // prints the encrypted text in an unreadable format\n    puts(\"To see the encrypted text press enter: \");\n    getchar();\n    // iterates through the area printing the encrypted characters.\n    for(i=0;i&lt;length; i++)\n        putchar(input[i]);\n    // uses xor cipher to shift data back into array by undoing the shift caused by 0x7f\n    for(i=0; i&lt;length; i++)\n        input[i] = 0x7F ^ input[i];\n    // prints the now readable array\n    puts(\"\\nTo see recovered text press enter:\");\n    getchar();\n    //iterates through the array printing the contained characters\n    for(i=0; i&lt;length; i++)\n        putchar(input[i]);\n    }\n    // prints the following phrase if the array is empty.\n    else{\n        puts(\"User input has been checked and a valid pass phrase was not entered.\");\n        }\n    return 0;\n    }\n\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1568240659, "post_id": 57897445, "comment_id": 102215892, "body": "When you use the wrong printf format operator for the variable type, you get undefined behavior."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568241028, "post_id": 57897445, "comment_id": 102215977, "body": "Try <code>%hhu</code> for better results."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1568241158, "post_id": 57897445, "comment_id": 102216008, "body": "What you&#39;re doing is undefined behavior. It could as well output <code>cats and dogs</code>."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568241201, "post_id": 57897445, "comment_id": 102216019, "body": "See <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 7.21.6.1 paragraph 9."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1568245199, "post_id": 57897445, "comment_id": 102216868, "body": "Your plain <code>char</code> type is signed; <code>d</code> is converted to <code>int</code> in the argument list to <code>printf()</code> because of the default promotion rules for types smaller than <code>int</code>; you printed <code>-1</code> (4-byte integer size) as an <code>unsigned int</code> and get the result shown.  It&#39;s UB, but your result is what you normally get in the circumstances.  If your plain <code>char</code> was an unsigned type, you&#39;d get different results."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1568287103, "last_edit_date": 1568287103, "creation_date": 1568246500, "answer_id": 57898120, "question_id": 57897445, "link": "https://stackoverflow.com/questions/57897445/question-char-d-1-printfu-d-why-outpt-is-not-255/57898120#57898120", "title": "Question : char d = -1 printf(&quot;%u&quot;,d); why outpt is not 255", "body": "<p>The likely sequence of events in your C implementation is:</p>\n\n<ul>\n<li>In <code>unsigned char c = -1;</code>, <code>-1</code> is converted to <code>unsigned char</code>, producing 255, and <code>c</code> is initialized to this value.</li>\n<li><code>char</code> is signed in the C implementation you are using, so <code>char d = -1;</code> initializes <code>d</code> to \u22121.</li>\n<li><code>int i = -1;</code> of course initializes <code>i</code> to \u22121.</li>\n<li>In <code>printf(\"c=%u,d=%u,i=%u\\n\", c, d, i);</code>, the <code>unsigned char</code> and <code>char</code> values of <code>c</code> and <code>d</code> are automatically promoted to <code>int</code>, and you pass the values 255, \u22121, and \u22121 to <code>printf</code>.</li>\n<li>The bits that represent these <code>int</code> values 255 (24 zeros and eight ones), \u22121 (32 ones), and \u22121 (32 ones) are passed to <code>printf</code>, but your <code>%u</code> conversion specifiers tell <code>printf</code> to expect <code>unsigned int</code> values. <code>printf</code> responds by interpreting these bits as if they were <code>unsigned int</code>.</li>\n<li>In <code>unsigned int</code> in your C implementation, 24 zero bits followed by eight one bits represents 255, so <code>printf</code> prints that for the first conversion.</li>\n<li>32 one bits represents 4294967295, so <code>printf</code> prints that for the second and third conversion.</li>\n<li>In <code>printf(\"c=%d,d=%d,i=%d\\n\", c, d, i);</code>, all the arguments after the format string are <code>int</code> after automatic promotion, and <code>%d</code> tells <code>printf</code> to expect <code>int</code>, so everything works as expected, and <code>printf</code> prints 255, \u22121, and \u22121.</li>\n</ul>\n\n<p>Because your argument types in the first <code>printf</code> do not match the conversion specifiers, the C standard does not define the resulting behavior. Although the above is likely what happened in your C implementation, the C standard does not guarantee this will happen in other C implementations or even in other programs doing this in this C implementation.</p>\n"}], "owner": {"reputation": 3, "user_id": 11475973, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GXcvhsgrH60/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rebbaXm26-_JGvaJixXr0gkoiLzaQ/mo/photo.jpg?sz=128", "display_name": "theprog", "link": "https://stackoverflow.com/users/11475973/theprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 57898120, "answer_count": 1, "score": 0, "last_activity_date": 1568287103, "creation_date": 1568239931, "last_edit_date": 1568240599, "question_id": 57897445, "link": "https://stackoverflow.com/questions/57897445/question-char-d-1-printfu-d-why-outpt-is-not-255", "title": "Question : char d = -1 printf(&quot;%u&quot;,d); why outpt is not 255", "body": "<p>I confused about first \"printf\" function print d is not 255, why d is 4294967295, anyone can help me explain that  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    unsigned char c = -1;\n    char d = -1;\n    int i = -1;\n    printf(\"c=%u,d=%u,i=%u\\n\", c, d, i);\n    printf(\"c=%d,d=%d,i=%d\\n\", c, d, i);\n    return 0;\n}\n</code></pre>\n\n<p>output is</p>\n\n<p><a href=\"https://i.stack.imgur.com/kF85e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kF85e.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "cmake"], "comments": [{"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1568240014, "post_id": 57897379, "comment_id": 102215740, "body": "Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal Reproducible Example</a> demonstrating this behavior?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 2, "creation_date": 1568241051, "post_id": 57897379, "comment_id": 102215986, "body": "Not sure what do you want. &quot;I would prefer to keep the #include to the libraries&quot; - <code>#include</code> includes <b>headers</b>, but libraries are <b>linked</b> (with <code>target_link_libraries</code> command in CMake)."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568241466, "post_id": 57897379, "comment_id": 102216088, "body": "<code>If I keep in all those #includes, will those libraries be compiled for each separate executable?</code> The preprocessor statements <code>#include</code> int the source code have nothing to do with if the library is enabled for compilation and/or will be linked with."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568243409, "post_id": 57897379, "comment_id": 102216513, "body": "You shouldn&#39;t omit headers from your code unless the contents are unused.  If you use functions declared in the headers, use the headers."}, {"owner": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 2, "creation_date": 1568246161, "post_id": 57897379, "comment_id": 102217039, "body": "It sounds as if you are not sure of the purpose of header files.  They not only enable the IDEs to provide autocompletion,etc, but they are essential for correct calling of the functions.  For example, suppose your code has the call <code>myfunc(123)</code>.  WITHOUT the header, myfunc will still be called, and it will pass the 4 bytes holding the integer 123.  That&#39;s fine if <code>myfunc</code> is declared as taking an integer (and this is probably why your code runs just fine) ...but what if <code>myfunc</code> actually takes a float ???  With the header, the compiler has the information to correctly cast 123 to 123.0."}, {"owner": {"reputation": 145, "user_id": 7998343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-QA0PWwz2Z70/AAAAAAAAAAI/AAAAAAAAAkg/VoDw77mTKlU/photo.jpg?sz=128", "display_name": "Connor Olsen", "link": "https://stackoverflow.com/users/7998343/connor-olsen"}, "reply_to_user": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 0, "creation_date": 1568296632, "post_id": 57897379, "comment_id": 102236525, "body": "@racraman, you&#39;re definitly right. This actually explains an failed unit test I was getting, so thank you so much for pointing that out."}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 7024671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/84Anu.jpg?s=128&g=1", "display_name": "geokon", "link": "https://stackoverflow.com/users/7024671/geokon"}, "is_accepted": false, "score": 0, "last_activity_date": 1568285462, "creation_date": 1568285462, "answer_id": 57905128, "question_id": 57897379, "link": "https://stackoverflow.com/questions/57897379/omiting-declarations-of-header-files-in-source-code-compiled-by-cmake/57905128#57905128", "title": "Omiting declarations of header files in source code compiled by CMake", "body": "<p>The library target will be compiled once and then linked to your executables. When you modify files for your executables the library will not be recompiled. If you modify the library it will be rebuilt and the executables will get relinked. </p>\n\n<p>As long as you include the headers in your library target then all executables that link the target will also link the headers. So something like this:</p>\n\n<pre><code>add_library(my_super_cool_lib my_header.h\n                              my_code.cpp)\n</code></pre>\n\n<p>Can then be linked </p>\n\n<pre><code>add_executable (do_cool_stuff cool_code.cpp)\ntarget_link_libraries(do_cool_stuff my_super_cool_lib)\n</code></pre>\n\n<p>And the headers will automatically get added to the path</p>\n\n<p>If you make a library that links to other libraries then you have a choice of what to do with the headers. In CMake speak this is called the \"link interface\"</p>\n\n<ul>\n<li>You just use them locally to build the your library - PRIVATE</li>\n<li>You can use them locally and also \"forward\" them so that whoever links your library will also get those headers - PUBLIC</li>\n<li>You can not even use them locally but make anyone who links your library get them - INTERFACE</li>\n</ul>\n\n<p>These are set with an optional argument:</p>\n\n<pre><code>target_link_libraries(do_cool_stuff &lt;PRIVATE|PUBLIC|INTERFACE&gt; my_super_cool_lib)\n</code></pre>\n\n<p>See: <a href=\"https://cmake.org/cmake/help/v3.0/command/target_link_libraries.html\" rel=\"nofollow noreferrer\">https://cmake.org/cmake/help/v3.0/command/target_link_libraries.html</a>\nand  <a href=\"https://cmake.org/cmake/help/v3.0/command/add_library.html\" rel=\"nofollow noreferrer\">https://cmake.org/cmake/help/v3.0/command/add_library.html</a>\nThe documentation is a bit dry but is very comprehensive. Just read and reread it carefully :)</p>\n"}], "owner": {"reputation": 145, "user_id": 7998343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-QA0PWwz2Z70/AAAAAAAAAAI/AAAAAAAAAkg/VoDw77mTKlU/photo.jpg?sz=128", "display_name": "Connor Olsen", "link": "https://stackoverflow.com/users/7998343/connor-olsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568285462, "creation_date": 1568239464, "question_id": 57897379, "link": "https://stackoverflow.com/questions/57897379/omiting-declarations-of-header-files-in-source-code-compiled-by-cmake", "title": "Omiting declarations of header files in source code compiled by CMake", "body": "<p>I've recently been learning and becoming familiar with CMake with the hopes of overhauling a project at work to use this instead. I understand that when I create a library target and link it to a several different executable targets, that library is only compiled once.</p>\n\n<p>I found that I can remove the #include in my source code while keeping the function calls to the library, and the code compiles and runs just fine. This seems like bad practice to me, and I would prefer to keep the #include to the libraries for the sake of readability. But, If I keep in all those #includes, will those libraries be compiled for each separate executable?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568239483, "post_id": 57897343, "comment_id": 102215614, "body": "Add the command line you are using to compile <code>hello.o</code>."}, {"owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568239585, "post_id": 57897343, "comment_id": 102215625, "body": "gcc hello.c -o hello.o"}, {"owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "edited": false, "score": 4, "creation_date": 1568240890, "post_id": 57897343, "comment_id": 102215944, "body": "Analyzing the core dump with <code>gdb</code> shows that you have an infinite recursion between <code>puts</code> and <code>malloc</code>, hence stack overflow. Standard library also uses <code>malloc()</code>, keep this in mind :)"}, {"owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "reply_to_user": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "edited": false, "score": 0, "creation_date": 1568241504, "post_id": 57897343, "comment_id": 102216097, "body": "@DanilaKiver could you tell how you debugged it using gdb? I was not able to run gdb and analyse the failure."}, {"owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "edited": false, "score": 1, "creation_date": 1568241857, "post_id": 57897343, "comment_id": 102216175, "body": "Run <code>hello</code> as you&#39;ve specified in the question. After the crash the system will produce the core dump. Then run <code>coredumpctl debug hello</code> - it will find the last core dump from <code>hello</code> and open it with <code>gdb</code>. When you are in <code>gdb</code>, run <code>bt</code> - it will print you the stack trace with the recursion."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 1, "creation_date": 1568242916, "post_id": 57897343, "comment_id": 102216399, "body": "More to the point, <code>printf()</code> and <a href=\"https://stackoverflow.com/a/57308691/10306503\">even <code>getchar()</code></a> will also use <code>malloc()</code>, and at least on Linux, they will not call it directly, but go through whatever <code>LD_PRELOAD</code> override."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1568244598, "post_id": 57897343, "comment_id": 102216762, "body": "<i>&quot;I want to understand how .so works&quot;</i> - You should read Drepper&#39;s <a href=\"https://software.intel.com/sites/default/files/m/a/1/e/dsohowto.pdf\" rel=\"nofollow noreferrer\">How To Write Shared Libraries</a>."}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1568291156, "answer_count": 0, "score": 0, "last_activity_date": 1568247660, "creation_date": 1568239225, "last_edit_date": 1568247660, "question_id": 57897343, "link": "https://stackoverflow.com/questions/57897343/understanding-how-shared-object-file-works-so", "closed_reason": "Duplicate", "title": "Understanding how shared object file works .so", "body": "<p>I want to understand how <code>.so</code> works. Eventually I would like to make my own <code>malloc()</code>. But to get the infrastructure ready I just created a sample <code>malloc()</code> function and just printing inside it.</p>\n\n<p>I compiled the following file (<code>my_malloc.c</code>):</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;dlfcn.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid* malloc(size_t sz)\n{\n    printf(\"malloc\\n\");\n    return NULL;\n}\n\nvoid free(void *p)\n{\n    printf(\"free\\n\");\n}\n</code></pre>\n\n<p>and created a <code>.so</code> using the following command:</p>\n\n<pre><code> gcc -shared -fPIC -o my_malloc.so my_malloc.c\n</code></pre>\n\n<p>Now I created a <code>hello.c</code> file and I am using the <code>malloc()</code> function in this file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    malloc(64);\n    return 0;\n}\n</code></pre>\n\n<p>Then I've compiled this file with the following command:</p>\n\n<pre><code>gcc hello.c -o hello.o\n</code></pre>\n\n<p>I used <code>LD_PRELOAD</code> to override the standard <code>malloc()</code> implementation. When I run <code>hello.o</code> I get the segmentation fault:</p>\n\n<pre><code>LD_PRELOAD=./my_malloc.so ./hello.o\nSegmentation fault\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["c", "interpolation", "numeric", "numerical-methods", "gsl"], "answers": [{"tags": [], "owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "is_accepted": true, "score": 1, "last_activity_date": 1570797793, "creation_date": 1570797793, "answer_id": 58341521, "question_id": 57897241, "link": "https://stackoverflow.com/questions/57897241/how-to-interpolate-a-complex-function-form-two-complex-variables-using-gsl-libra/58341521#58341521", "title": "How to interpolate a complex function form two complex variables using GSL library?", "body": "<p>They are linearly independent. Like x and y coordinates in plane.</p>\n\n<ol>\n<li>Interpolate real and imaginary parts or depending on your problem better yet magnitude and phase individually. </li>\n<li>Put the results back together.</li>\n</ol>\n\n<p>In pseudo:</p>\n\n<pre><code>interp(re(f(x)) + i * interp(im(f(x))) \n</code></pre>\n\n<p>Be careful if you do go mag/phase for phase jumps. You will have to unwrap the phase, which is straightforward in one dimension.</p>\n"}], "owner": {"reputation": 111, "user_id": 3914174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7n41D.jpg?s=128&g=1", "display_name": "DJNZ", "link": "https://stackoverflow.com/users/3914174/djnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 58341521, "answer_count": 1, "score": 0, "last_activity_date": 1570797793, "creation_date": 1568238618, "question_id": 57897241, "link": "https://stackoverflow.com/questions/57897241/how-to-interpolate-a-complex-function-form-two-complex-variables-using-gsl-libra", "title": "How to interpolate a complex function form two complex variables using GSL library?", "body": "<p>I am interpolating a complex <strong>analytical</strong> function from two complex variables given with arrays:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7jgy0.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7jgy0.gif\" alt=\"enter image description here\"></a></p>\n\n<p><em>A</em>, <em>mu</em> and <em>t</em> set using standard <a href=\"https://www.gnu.org/software/gsl/doc/html/complex.html\" rel=\"nofollow noreferrer\">complex numbers presentation from GSL</a>. I want to use the <a href=\"https://www.gnu.org/software/gsl/doc/html/interp.html#id1\" rel=\"nofollow noreferrer\">GSL function of two-dimensional interpolation</a>, but it only works with <code>double</code> types. I can break down all the values of all variables (<em>A</em>, <em>mu</em>, <em>t</em>) into <em>Re</em> and <em>Im</em> parts (get <code>double**</code> arrays), but I don\u2019t know how to interpolate \u201ctwo real numbers depend on four real numbers\u201d, since the interpolator does not know anything about the relationship of variables with each other. \nAlso, each variable is a function of its real and imaginary parts. As I understand it, just combining multiple splines will not work: it is wrong to do a spline between real parts, a spline between minimum parts and then a spline between splines.</p>\n\n<p>Can this be done using GSL and how, if so? And if not, is there somewhere a description of the multidimensional interpolation algorithm?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 1303, "user_id": 3365922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a61f61ab80f1814148f6e8ca470f177a?s=128&d=identicon&r=PG&f=1", "display_name": "fas", "link": "https://stackoverflow.com/users/3365922/fas"}, "edited": false, "score": 3, "creation_date": 1568238680, "post_id": 57897227, "comment_id": 102215438, "body": "<code>memcpy</code> instead of <code>two_star[i] = buf;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 4395067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RkACx1ynN00/AAAAAAAAAAI/AAAAAAAAAD8/WGgjXpJgxCM/photo.jpg?sz=128", "display_name": "Abhishek Mangal", "link": "https://stackoverflow.com/users/4395067/abhishek-mangal"}, "edited": false, "score": 0, "creation_date": 1568238934, "post_id": 57897267, "comment_id": 102215488, "body": "This works. Will accept it as the correct answer when time permits."}], "tags": [], "owner": {"reputation": 1303, "user_id": 3365922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a61f61ab80f1814148f6e8ca470f177a?s=128&d=identicon&r=PG&f=1", "display_name": "fas", "link": "https://stackoverflow.com/users/3365922/fas"}, "is_accepted": false, "score": 2, "last_activity_date": 1568239010, "last_edit_date": 1568239010, "creation_date": 1568238807, "answer_id": 57897267, "question_id": 57897227, "link": "https://stackoverflow.com/questions/57897227/pointers-in-c-allocating-memory-with-value-assignment-vs-allocating-memory-with/57897267#57897267", "title": "Pointers in C: Allocating memory with value assignment VS allocating memory without value assignment", "body": "<p>Use <a href=\"http://www.cplusplus.com/reference/cstring/strcpy\" rel=\"nofollow noreferrer\">strcpy</a>: <code>strcpy(two_star[i], buf);</code> instead of <code>two_star[i] = buf;</code>, because in your case you don't copy string, just reassign pointer <code>two_star[i]</code> to <code>buf</code> (and here is also memory leak, because you've lost pointer to allocated memory).</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1568254149, "creation_date": 1568254149, "answer_id": 57898858, "question_id": 57897227, "link": "https://stackoverflow.com/questions/57897227/pointers-in-c-allocating-memory-with-value-assignment-vs-allocating-memory-with/57898858#57898858", "title": "Pointers in C: Allocating memory with value assignment VS allocating memory without value assignment", "body": "<p>Using <code>strcpy(two_star[i], buf);</code> is insufficient.</p>\n\n<pre><code>    char buf[12];\n    two_star[i] = calloc(10, sizeof(char));\n    // snprintf(buf, 12, \"pre_%d_suff\", i);\n    strcpy(two_star[i], buf);  // bad, trying to put 12 characters into 10\n    two_star[i] = buf;\n</code></pre>\n\n<p>The destination is too small.</p>\n\n<p>Instead, code could right size.</p>\n\n<pre><code>   int size_needed = snprintf(NULL, 0, \"pre_%d_suff\", i)  + 1;\n   two_star[i] = malloc(size_needed);\n   snprintf(two_star[i], size_needed, \"pre_%d_suff\", i);\n</code></pre>\n\n<hr>\n\n<p>Note: Error checking omitted for brevity.</p>\n"}], "owner": {"reputation": 46, "user_id": 4395067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RkACx1ynN00/AAAAAAAAAAI/AAAAAAAAAD8/WGgjXpJgxCM/photo.jpg?sz=128", "display_name": "Abhishek Mangal", "link": "https://stackoverflow.com/users/4395067/abhishek-mangal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 57898858, "answer_count": 2, "score": 0, "last_activity_date": 1568254149, "creation_date": 1568238534, "last_edit_date": 1568238709, "question_id": 57897227, "link": "https://stackoverflow.com/questions/57897227/pointers-in-c-allocating-memory-with-value-assignment-vs-allocating-memory-with", "title": "Pointers in C: Allocating memory with value assignment VS allocating memory without value assignment", "body": "<p>Char pointer's memory allocation via calloc works as expected only when I do not assign some value to the pointers. </p>\n\n<p>I am trying to get some simple examples working to better my understanding of pointers / double pointers / triple pointers / ... . While writing the code for double pointers, I stumbled upon a really weird behavior.</p>\n\n<pre><code>#define PRINT(X, ...) printf(\"Address of \" X \"\\n\", ##__VA_ARGS__);\n\n...\n...\n\n    int i = 0;\n    char buf[12];\n    char **two_star;\n\n    two_star = calloc(10, sizeof(char*));\n    for (i = 0; i &lt; 10 ; ++i){\n        two_star[i] = calloc(10, sizeof(char));\n        PRINT(\"two_star[%d]   = %p\", i, two_star[i]);\n    }\n\n    for (i = 0; i &lt; 10 ; ++i){\n        two_star[i] = calloc(10, sizeof(char));\n        snprintf(buf, 12, \"pre_%d_suff\", i);\n        two_star[i] = buf;\n        PRINT(\"two_star[%d]   = %p   two_star[%d]   = %s\", i, two_star[i], i, two_star[i]);\n    }\n</code></pre>\n\n<p>I get the following results for the above two for loops: </p>\n\n<p>For Loop 1:</p>\n\n<pre><code>Address of two_star[0]   = 0xbcc090\nAddress of two_star[1]   = 0xbcc0b0\nAddress of two_star[2]   = 0xbcc0d0\nAddress of two_star[3]   = 0xbcc0f0\nAddress of two_star[4]   = 0xbcc110\nAddress of two_star[5]   = 0xbcc130\nAddress of two_star[6]   = 0xbcc150\nAddress of two_star[7]   = 0xbcc170\nAddress of two_star[8]   = 0xbcc190\nAddress of two_star[9]   = 0xbcc1b0\n</code></pre>\n\n<p>For Loop 2: </p>\n\n<pre><code>Address of two_star[0]   = 0x7ffcd2238ab0   two_star[0]   = pre_0_suff\nAddress of two_star[1]   = 0x7ffcd2238ab0   two_star[1]   = pre_1_suff\nAddress of two_star[2]   = 0x7ffcd2238ab0   two_star[2]   = pre_2_suff\nAddress of two_star[3]   = 0x7ffcd2238ab0   two_star[3]   = pre_3_suff\nAddress of two_star[4]   = 0x7ffcd2238ab0   two_star[4]   = pre_4_suff\nAddress of two_star[5]   = 0x7ffcd2238ab0   two_star[5]   = pre_5_suff\nAddress of two_star[6]   = 0x7ffcd2238ab0   two_star[6]   = pre_6_suff\nAddress of two_star[7]   = 0x7ffcd2238ab0   two_star[7]   = pre_7_suff\nAddress of two_star[8]   = 0x7ffcd2238ab0   two_star[8]   = pre_8_suff\nAddress of two_star[9]   = 0x7ffcd2238ab0   two_star[9]   = pre_9_suff\n</code></pre>\n\n<p>The issue here is evident. The pointers being allocated in the second for loop all have the same value of address. Meaning, that two_star[0] and two_star[9] end up being the same value as the same memory address ends up being updated again and again.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 2, "creation_date": 1568238609, "post_id": 57897105, "comment_id": 102215420, "body": "Because a file pointer is <b>not</b> a pointer to the content of the file in memory. It&#39;s a pointer to a complex structure (that is, <code>FILE</code>) used by libc to identify an open file."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1568238049, "creation_date": 1568238049, "answer_id": 57897152, "question_id": 57897105, "link": "https://stackoverflow.com/questions/57897105/incrementing-and-decrementing-a-file-pointer/57897152#57897152", "title": "Incrementing and decrementing a file pointer", "body": "<p>Use the <code>fseek()</code> function with the <code>SEEK_CUR</code> flag.</p>\n\n<pre><code>fseek(fptr, -1, SEEK_CUR);\n</code></pre>\n\n<p><code>SEEK_CUR</code> means that the file position should be set relative to the current position in the file. A positive offset means to add to the position, a negative offset means to subtract from the position.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1568240033, "last_edit_date": 1568240033, "creation_date": 1568239724, "answer_id": 57897419, "question_id": 57897105, "link": "https://stackoverflow.com/questions/57897105/incrementing-and-decrementing-a-file-pointer/57897419#57897419", "title": "Incrementing and decrementing a file pointer", "body": "<p>A \"file pointer\" (or <code>FILE *</code>) is <em>not</em> a \"pointer to a file\".  It's really a file <em>descriptor</em>, or a \"file handle\".  It's a data structure you use to read and write to/from files.</p>\n\n<p>You get a file handle when you open a file by calling <code>fopen</code>, and you use a file handle when you perform explicit read, write, and other operations by calling functions like <code>fread</code>, <code>fprintf</code>, and <code>fseek</code>, and you dispose of a file handle when you're done with it by calling <code>fclose</code>.  But you never do any pointer operations on it: you never put <code>*</code> in front of it to fetch its contents, and you never do pointer arithmetic on it, with <code>++</code> or any other operators.</p>\n\n<p>It is, arguably, a blemish in C's type system that we can tell that this type is a pointer at all.  If it were an opaque type, questions like this wouldn't come up.</p>\n\n<p>The only time you could conceivably write</p>\n\n<pre><code>fp++\n</code></pre>\n\n<p>would be if you had an array of <code>FILE</code> structs you were iterating over:</p>\n\n<pre><code> FILE files[10];              /* the 10 files I'm writing to */\n\n /* now write 'x' to all the files */\n FILE *fdp = files;\n for(i = 0; i &lt; 10; i++)\n    putc('x', fp++);          /* wrong, wrong, wrong */\n</code></pre>\n\n<p>But this won't work at all, for several reasons.  For one thing, you could never have an array of <code>FILE</code> structures like that.  (Well, you could try, but it would be pointless and nonportable.)  And, for another thing, you'd run up against a subtle limitation of <code>putc()</code>, which is that it's allowed to be implemented as a macro, and it's not safe to give it a file pointer argument with side effects.  (This is, admittedly, a terribly obscure point, although I guess it's why programmers these days seem to be taught to call <code>fputc</code> instead.)</p>\n\n<p>Bottom line, don't try to use <code>++</code> or <code>--</code> on file pointers.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12050586"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 1, "accepted_answer_id": 57897152, "answer_count": 2, "score": 0, "last_activity_date": 1569817148, "creation_date": 1568237726, "last_edit_date": 1569817148, "question_id": 57897105, "link": "https://stackoverflow.com/questions/57897105/incrementing-and-decrementing-a-file-pointer", "title": "Incrementing and decrementing a file pointer", "body": "<p>For a file pointer, what would be the equivalent of the <code>++</code> and <code>--</code> that can be done on normal pointers (for example, strings). As an example:</p>\n\n<pre><code>fseek(fptr, 0, SEEK_END);\nfptr--\n</code></pre>\n\n<p>Why can't something like the above be done? What would be the way to do this instead?</p>\n"}, {"tags": ["c++", "c", "visual-studio", "windows-ce", "wmdc"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568237980, "post_id": 57897093, "comment_id": 102215270, "body": "Don&#39;t forget to add an additional blank line between paragraphs or it just jams together into a huge wall of words."}, {"owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "edited": false, "score": 0, "creation_date": 1570631163, "post_id": 57897093, "comment_id": 102974619, "body": "Is the correct debugger selected in Project &gt; Properties &gt; Configuration Properties &gt; Debugging &gt; Debugger to launch?"}, {"owner": {"reputation": 29, "user_id": 6140823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72be293d57676176ddc18bd170908c9?s=128&d=identicon&r=PG&f=1", "display_name": "atomic928", "link": "https://stackoverflow.com/users/6140823/atomic928"}, "edited": false, "score": 0, "creation_date": 1570724916, "post_id": 57897093, "comment_id": 103013006, "body": "Yes, under &#39;Debugger to launch:&#39; there is a drop down with only one option &quot;Smart Device Native Debugger&quot;."}], "owner": {"reputation": 29, "user_id": 6140823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72be293d57676176ddc18bd170908c9?s=128&d=identicon&r=PG&f=1", "display_name": "atomic928", "link": "https://stackoverflow.com/users/6140823/atomic928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568237994, "creation_date": 1568237673, "last_edit_date": 1568237994, "question_id": 57897093, "link": "https://stackoverflow.com/questions/57897093/visual-studio-only-connects-to-remote-device-via-wmdc-one-time", "title": "Visual Studio only connects to remote device via WMDC one time", "body": "<p>I have both Visual Studio 2005 and 2008 installed on my main PC dev machine. I had a project that I could connect to a Wince5.0 device and debug via vs08 about 5 months ago. Now the same project will not debug the project, I am getting a \"Unable to start debugging\" window from VS after the connection is made and the exe deployed.</p>\n\n<p>I can connect to the device, via WMDC. I can see all the files and etc to the remote device. VS will download the application but will just not start debugging. I take the exact same project compile it and run it from VS 2005 and I can debug.</p>\n\n<p>Also what I have found is that if I create a new project from VS2008 it will deploy and debug as long as I do not close VS2008. Once I shut down VS08 and reopen the project the \"Unable to start debugging\" message will appear on ever deploy.</p>\n\n<p>I've tried everything I can think of and have read on, change security settings, look at registry on the device and etc. It just seems to be some VS2008 issue that just started.</p>\n"}, {"tags": ["c", "ascii"], "comments": [{"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1568237665, "post_id": 57897063, "comment_id": 102215188, "body": "A <code>char</code> is an 8-bit-value. But 353 is above the 255 limit, so the interpretation/handling depends on the compiler."}, {"owner": {"reputation": 9, "user_id": 12055333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cZqGk.jpg?s=128&g=1", "display_name": "joon", "link": "https://stackoverflow.com/users/12055333/joon"}, "reply_to_user": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1568237856, "post_id": 57897063, "comment_id": 102215236, "body": "@zx485 thank you for you answer but I want to know why does it show the character a specifically  when executed ? what does it have to do with 353 ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1568238286, "post_id": 57897063, "comment_id": 102215353, "body": "It&#39;s overflowing, so it&#39;s interpreted as <code>353 % 256 == 97</code>, which is the ASCII code for <code>a</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568238516, "post_id": 57897063, "comment_id": 102215402, "body": "Signed integer overflow yields <i>Undefined Behavior</i>, anything can happen. (on those systems where <code>char</code> is <code>unsigned</code> the value would simply be reduced <code>modulo 256</code>). What do you think it should print ? <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII Table and Description</a> ? Note: anything above 127 depends on the terminal and supported terminal character set."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568239176, "post_id": 57897063, "comment_id": 102215537, "body": "@DavidC.Rankin there&#39;s no integer overflow here, since there are no arithmetic operations. The code in the question is an out-of-range assignment"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1568239372, "post_id": 57897063, "comment_id": 102215583, "body": "@M.M - the result would still be implementation defined. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p3\" rel=\"nofollow noreferrer\">6.2.5 Types(p3)</a>"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1568239728, "post_id": 57897063, "comment_id": 102215665, "body": "Need to know <code>CHAR_BIT</code> from your system&#39;s <code>&lt;limits.h&gt;</code>. (The error is that someone wrote code that others can&#39;t understand. Also, just about any mention of ASCII is an inacurracy.)"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1568239247, "post_id": 57897221, "comment_id": 102215558, "body": "It&#39;s implementation-defined behaviour due to out-of-range assignment. There is no overflow nor UB."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1568239756, "last_edit_date": 1568239756, "creation_date": 1568238496, "answer_id": 57897221, "question_id": 57897063, "link": "https://stackoverflow.com/questions/57897063/what-is-the-relation-between-ascii-and-the-result-shown-a/57897221#57897221", "title": "what is the relation between ASCII and the result shown (a)?", "body": "<p>If <code>char</code> defaults to <code>unsigned</code> in your implementation, and <code>char</code> is 8 bits, then </p>\n\n<pre><code>char var = 353;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>char var = (353 % 256);\n</code></pre>\n\n<p>and the value of that modulus expression is <code>97</code>. That's the ASCII code for <code>a</code>.</p>\n\n<p>If <code>char</code> defaults to <code>signed char</code>, the code produces implementation-defined behavior because 353 is too large. If you're still getting <code>a</code>, it's because the implementation happens to be using the same modular arithmetic when signed integer overflow occurs, which is common. But you shouldn't depend on it, since it's implementation-specific.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 12055333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cZqGk.jpg?s=128&g=1", "display_name": "joon", "link": "https://stackoverflow.com/users/12055333/joon"}, "edited": false, "score": 0, "creation_date": 1568272818, "post_id": 57897238, "comment_id": 102223486, "body": "So I have another issue if I put 353 between &#39; &#39; only one digit is shown and also when I put %3c  this is the result --3 . What&#39;s the explanation ?"}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "reply_to_user": {"reputation": 9, "user_id": 12055333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cZqGk.jpg?s=128&g=1", "display_name": "joon", "link": "https://stackoverflow.com/users/12055333/joon"}, "edited": false, "score": 0, "creation_date": 1568297560, "post_id": 57897238, "comment_id": 102237099, "body": "@joon Putting it in a single quote turns it into a <code>char</code> constant. In other words, it changes it from the value 353 to the character <code>3</code>. It&#39;s not a valid thing to do."}], "tags": [], "owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "is_accepted": false, "score": 0, "last_activity_date": 1568241521, "last_edit_date": 1568241521, "creation_date": 1568238586, "answer_id": 57897238, "question_id": 57897063, "link": "https://stackoverflow.com/questions/57897063/what-is-the-relation-between-ascii-and-the-result-shown-a/57897238#57897238", "title": "what is the relation between ASCII and the result shown (a)?", "body": "<p>It helps to view things in hex sometimes. The decimal value 353 is hex 0x161. Since a <code>char</code> is an 8-bit value, that means it can only hold numbers up to 0xff, or decimal 255 (unsigned) or 127 (signed). Well, clearly 0x161 can't fit into a data type that can only count to 0xff, so the compiler truncated the upper bits to make it fit. The result was the value ended up being 0x61, which is decimal 97, which is the letter <code>a</code> in ASCII.</p>\n"}], "owner": {"reputation": 9, "user_id": 12055333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cZqGk.jpg?s=128&g=1", "display_name": "joon", "link": "https://stackoverflow.com/users/12055333/joon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568241521, "creation_date": 1568237522, "last_edit_date": 1568238294, "question_id": 57897063, "link": "https://stackoverflow.com/questions/57897063/what-is-the-relation-between-ascii-and-the-result-shown-a", "title": "what is the relation between ASCII and the result shown (a)?", "body": "<p>In the first session of algorithm class , the professor asked us to spot the errors and explain the reason behind the letter a shown as a result . The answer has something with ASCII code but I did not get it </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\nchar var=353;\nprintf(\"%c\",var);\nreturn 0;\n\n}\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["c", "rounding"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1568234757, "post_id": 57896155, "comment_id": 102214267, "body": "If for some reason you don&#39;t want to use <code>ceil</code>, you could try adding 1 and then truncating to <code>int</code>, but you&#39;d have to have a special case to detect the case where your original number had no fractional part."}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 11753498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3076f7d87c5000ab1b11435ccae020ef?s=128&d=identicon&r=PG&f=1", "display_name": "ut or", "link": "https://stackoverflow.com/users/11753498/ut-or"}, "edited": false, "score": 0, "creation_date": 1568237432, "post_id": 57896206, "comment_id": 102215128, "body": "Thanks. But I need the float be rounded allways up. Even 2.00007 to became 3."}], "tags": [], "owner": {"reputation": 4584, "user_id": 554436, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ze2jS.jpg?s=128&g=1", "display_name": "Saswat Padhi", "link": "https://stackoverflow.com/users/554436/saswat-padhi"}, "is_accepted": false, "score": 2, "last_activity_date": 1568232941, "creation_date": 1568232941, "answer_id": 57896206, "question_id": 57896155, "link": "https://stackoverflow.com/questions/57896155/c-rounding-up-float/57896206#57896206", "title": "C Rounding up float", "body": "<p>You can use the <a href=\"http://www.cplusplus.com/reference/cmath/ceil/\" rel=\"nofollow noreferrer\"><code>ceil</code></a> function from <code>math.h</code></p>\n"}, {"comments": [{"owner": {"reputation": 36, "user_id": 11753498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3076f7d87c5000ab1b11435ccae020ef?s=128&d=identicon&r=PG&f=1", "display_name": "ut or", "link": "https://stackoverflow.com/users/11753498/ut-or"}, "edited": false, "score": 0, "creation_date": 1568237426, "post_id": 57896216, "comment_id": 102215125, "body": "Thanks. But I need the float be rounded allways up. Even 2.00007 to became 3."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 36, "user_id": 11753498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3076f7d87c5000ab1b11435ccae020ef?s=128&d=identicon&r=PG&f=1", "display_name": "ut or", "link": "https://stackoverflow.com/users/11753498/ut-or"}, "edited": false, "score": 1, "creation_date": 1568237745, "post_id": 57896216, "comment_id": 102215217, "body": "@utor: Well that&#39;s what happens. Did you not try it?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1568232957, "creation_date": 1568232957, "answer_id": 57896216, "question_id": 57896155, "link": "https://stackoverflow.com/questions/57896155/c-rounding-up-float/57896216#57896216", "title": "C Rounding up float", "body": "<p>Use <code>ceil</code> or <code>ceilf</code> in <code>math.h</code>. The signatures are</p>\n\n<pre><code>double ceil(double arg);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>float ceilf(float arg);\n</code></pre>\n\n<p>Cast the result to an integral type if necessary, taking steps to ensure you don't overflow that type (which is one reason why the return types of <code>ceil</code> and <code>ceilf</code> are the same as the input type).</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1568233046, "post_id": 57896217, "comment_id": 102213693, "body": "Be careful with that conversion to <code>int</code> as that&#39;s vulnerable to overflow."}, {"owner": {"reputation": 7187, "user_id": 8890604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bwv2A.jpg?s=128&g=1", "display_name": "David S", "link": "https://stackoverflow.com/users/8890604/david-s"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1568233158, "post_id": 57896217, "comment_id": 102213743, "body": "@Bathsheba You are completely right, this snippet is only to show him the method; <i>guards and check are essential always</i>"}, {"owner": {"reputation": 7187, "user_id": 8890604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bwv2A.jpg?s=128&g=1", "display_name": "David S", "link": "https://stackoverflow.com/users/8890604/david-s"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568234535, "post_id": 57896217, "comment_id": 102214182, "body": "@SteveSummit indeed its also valid option, wasn&#39;t my go to answer but it will work; I think that your type of answer might confuse programmer new to C"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568234727, "post_id": 57896217, "comment_id": 102214258, "body": "@DavidS Sorry, meant to comment on the original question, not your answer."}, {"owner": {"reputation": 36, "user_id": 11753498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3076f7d87c5000ab1b11435ccae020ef?s=128&d=identicon&r=PG&f=1", "display_name": "ut or", "link": "https://stackoverflow.com/users/11753498/ut-or"}, "edited": false, "score": 0, "creation_date": 1568237403, "post_id": 57896217, "comment_id": 102215117, "body": "Thanks. But I need the float be rounded allways up. Even 2.00007 to became 3."}, {"owner": {"reputation": 7187, "user_id": 8890604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bwv2A.jpg?s=128&g=1", "display_name": "David S", "link": "https://stackoverflow.com/users/8890604/david-s"}, "reply_to_user": {"reputation": 36, "user_id": 11753498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3076f7d87c5000ab1b11435ccae020ef?s=128&d=identicon&r=PG&f=1", "display_name": "ut or", "link": "https://stackoverflow.com/users/11753498/ut-or"}, "edited": false, "score": 0, "creation_date": 1568284863, "post_id": 57896217, "comment_id": 102229814, "body": "@utor this is exactly what <i>ceil()</i> does, it rounds to the closest from the top"}], "tags": [], "owner": {"reputation": 7187, "user_id": 8890604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bwv2A.jpg?s=128&g=1", "display_name": "David S", "link": "https://stackoverflow.com/users/8890604/david-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1568232959, "creation_date": 1568232959, "answer_id": 57896217, "question_id": 57896155, "link": "https://stackoverflow.com/questions/57896155/c-rounding-up-float/57896217#57896217", "title": "C Rounding up float", "body": "<p>You can just do the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint main()\n{\n   double num = 6.87;\n   int result;\n   result = ceil(num);\n   printf(\"Ceiling integer of %.2f = %d\", num, result);\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 11753498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3076f7d87c5000ab1b11435ccae020ef?s=128&d=identicon&r=PG&f=1", "display_name": "ut or", "link": "https://stackoverflow.com/users/11753498/ut-or"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 57896217, "answer_count": 3, "score": -4, "last_activity_date": 1568232959, "creation_date": 1568232628, "question_id": 57896155, "link": "https://stackoverflow.com/questions/57896155/c-rounding-up-float", "title": "C Rounding up float", "body": "<p>I have some float, like: 7.66, 4.26,897.18...</p>\n\n<p>I want to round them up to the higher integer:</p>\n\n<pre><code>* 6.87 -&gt; 7\n\n* 5.312 -&gt; 6\n\n* 67.055 -&gt; 68\n\n* 9965.49 -&gt; 9966\n\n* etc.\n</code></pre>\n\n<p>How should I do that?</p>\n\n<p>Thank You!</p>\n"}, {"tags": ["c", "x11", "xlib", "xcb"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 3431547, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rJWMz.jpg?s=128&g=1", "display_name": "Keltek", "link": "https://stackoverflow.com/users/3431547/keltek"}, "edited": false, "score": 0, "creation_date": 1568307897, "post_id": 57910188, "comment_id": 102242393, "body": "Thanks, I&#39;ll give this a shot when I can. In the meantime, would you mind explaining a bit what&#39;s going on in your <code>intern_atom</code> function? As an X11/xcb rookie it&#39;s hard to parse what&#39;s going on there."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "reply_to_user": {"reputation": 341, "user_id": 3431547, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rJWMz.jpg?s=128&g=1", "display_name": "Keltek", "link": "https://stackoverflow.com/users/3431547/keltek"}, "edited": false, "score": 2, "creation_date": 1568447715, "post_id": 57910188, "comment_id": 102283702, "body": "Atoms are basically arbitrary strings, like here <code>_NET_ACTIVE_WINDOW</code>. However, strings do not have a fixed length. So you ask the X11 server for the <code>_NET_ACTIVE_WINDOW</code> atom and it gives you back a number. The number has a fixed length and now you can always use this number to refer to this string. Other X11 clients that ask for this atom get back the same number. Atoms are e.g. used for window properties: The kind of property is an atom (e.g. <code>_NET_ACTIVE_WINDOW</code> or <code>_WM_CLASS</code>), the type of the property is an atom (e.g. <code>WINDOW</code> or <code>UTF8_STRING)</code> etc."}], "tags": [], "owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "is_accepted": true, "score": 4, "last_activity_date": 1568302663, "creation_date": 1568302663, "answer_id": 57910188, "question_id": 57896007, "link": "https://stackoverflow.com/questions/57896007/detect-window-focus-changes-with-xcb/57910188#57910188", "title": "Detect window focus changes with XCB", "body": "<p>The focus events are only sent when the window that you selected these events on receives or loses the focus, see <a href=\"https://www.x.org/releases/X11R7.5/doc/x11proto/proto.html\" rel=\"nofollow noreferrer\">https://www.x.org/releases/X11R7.5/doc/x11proto/proto.html</a>:</p>\n\n<blockquote>\n  <p>FocusIn\n  FocusOut</p>\n  \n  <p>[...]</p>\n  \n  <p>These events are generated when the input focus changes and are reported to clients selecting FocusChange on the window.</p>\n</blockquote>\n\n<p>To use this, you would have to select this event mask on all windows and also watch for the creation of new windows.</p>\n\n<hr>\n\n<p>I would suggest a different approach: Watch for PropertyChangeNotify events on the root window to see when the <code>_NET_ACTIVE_WINDOW</code> property changes. This property should be kept up to date by the WM, according to EWMH.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;xcb/xcb.h&gt;\n\nstatic xcb_atom_t intern_atom(xcb_connection_t *conn, const char *atom)\n{\n    xcb_atom_t result = XCB_NONE;\n    xcb_intern_atom_reply_t *r = xcb_intern_atom_reply(conn,\n            xcb_intern_atom(conn, 0, strlen(atom), atom), NULL);\n    if (r)\n        result = r-&gt;atom;\n    free(r);\n    return result;\n}\n\nint main (int argc, char **argv)\n{\n    xcb_connection_t* conn = xcb_connect(NULL, NULL);\n    if (xcb_connection_has_error(conn)) {\n        printf(\"Cannot open daemon connection.\");\n        return 0;\n    }\n\n    xcb_atom_t active_window = intern_atom(conn, \"_NET_ACTIVE_WINDOW\");\n    xcb_screen_t* screen = xcb_setup_roots_iterator(xcb_get_setup(conn)).data;\n\n    uint32_t values[] = { XCB_EVENT_MASK_PROPERTY_CHANGE };\n    xcb_change_window_attributes(\n        conn,\n        screen-&gt;root,\n        XCB_CW_EVENT_MASK,\n        values);\n\n    xcb_flush(conn);\n\n    xcb_generic_event_t *ev;\n    while ((ev = xcb_wait_for_event(conn))) {\n        printf(\"IN LOOP\\n\");\n        switch (ev-&gt;response_type &amp; 0x7F) {\n        case XCB_PROPERTY_NOTIFY: {\n            xcb_property_notify_event_t *e = (void *) ev;\n            if (e-&gt;atom == active_window)\n                puts(\"active window changed\");\n            break;\n        }\n        default:\n            printf(\"IN DEFAULT\\n\");\n            break;\n        }\n        free(ev);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 3431547, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rJWMz.jpg?s=128&g=1", "display_name": "Keltek", "link": "https://stackoverflow.com/users/3431547/keltek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 1, "accepted_answer_id": 57910188, "answer_count": 1, "score": 2, "last_activity_date": 1568302663, "creation_date": 1568231914, "question_id": 57896007, "link": "https://stackoverflow.com/questions/57896007/detect-window-focus-changes-with-xcb", "title": "Detect window focus changes with XCB", "body": "<p>I'm writing a program with XCB that needs to detect whenever a window gains or loses focus. So far I have this but it just hangs on the <code>xcb_wait_for_event</code> call, never entering the loop. What am I missing here to grab root events? Or am I just going about this totally wrong and there's a better way than listening to the root?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;xcb/xcb.h&gt;\n\nint main (int argc, char **argv)\n{\n    xcb_connection_t* conn = xcb_connect(NULL, NULL);\n    if (xcb_connection_has_error(conn)) {\n        printf(\"Cannot open daemon connection.\");\n        return 0;\n    }\n\n    xcb_screen_t* screen = xcb_setup_roots_iterator(xcb_get_setup(conn)).data;\n\n    uint32_t values[] = { XCB_EVENT_MASK_FOCUS_CHANGE };\n    xcb_change_window_attributes(\n        conn,\n        screen-&gt;root,\n        XCB_CW_EVENT_MASK,\n        values);\n\n    xcb_generic_event_t *ev;\n    while ((ev = xcb_wait_for_event(conn))) {\n        printf(\"IN LOOP\\n\");\n        switch (ev-&gt;response_type &amp; 0x7F) {\n        case XCB_FOCUS_IN:\n        case XCB_FOCUS_OUT:\n            printf(\"IN CASE\\n\");\n            break;\n        default:\n            printf(\"IN DEFAULT\\n\");\n            break;\n        }\n        free(ev);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "wifi", "linux-device-driver", "netlink", "wpa"], "comments": [{"owner": {"reputation": 143, "user_id": 4934867, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1a954d9d9625b2705b4d1b21c0cfb256?s=128&d=identicon&r=PG&f=1", "display_name": "IGR94", "link": "https://stackoverflow.com/users/4934867/igr94"}, "edited": false, "score": 0, "creation_date": 1593095407, "post_id": 57895956, "comment_id": 110665203, "body": "I&#39;m currently working under similar task. First of all - do not forget that WPA2 password can&#39;t be less than 8 symbols! But this does not help with connection. I guess here we should implement WPA2 4-way handshake with NL80211 functionality. I&#39;m digging into it"}], "owner": {"reputation": 37, "user_id": 12021231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b44346825b6d94f4f5c4cd22ebbfba?s=128&d=identicon&r=PG&f=1", "display_name": "kwroot", "link": "https://stackoverflow.com/users/12021231/kwroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568231600, "creation_date": 1568231600, "question_id": 57895956, "link": "https://stackoverflow.com/questions/57895956/how-to-use-libnl-with-netlink-socket-for-connect-devices-to-ap-with-wpa2", "title": "How to use libnl with netlink socket for connect devices to AP with WPA2?", "body": "<p>I've developed in C language, some function for managing wifi programmatically, on my embedded device. The code below shows the function that I use to associate and connect my device to an open AP (with no auth encryption).</p>\n\n<pre><code> static int ap_conn() {\n\n  struct nl_msg *msg = nlmsg_alloc();\n\n  int if_index = if_nametoindex(\"wlan0\"); // Use this wireless interface for scanning.\n\n  // Open socket to kernel.\n  struct nl_sock *socket = nl_socket_alloc();  // Allocate new netlink socket in memory.\n  genl_connect(socket);  // Create file descriptor and bind socket.\n  int driver_id = genl_ctrl_resolve(socket, \"nl80211\");  // Find the \n  nl80211 driver ID.\n\n  genlmsg_put(msg, 0, 0, driver_id, 0, (NLM_F_REQUEST | NLM_F_ACK), NL80211_CMD_CONNECT, 0); \n\n  nla_put_u32(msg, NL80211_ATTR_IFINDEX, if_index);  // Add message attribute, which interface to use.\n\n  nla_put(msg, NL80211_ATTR_SSID, strlen(\"Validator_Test\"), \"Validator_Test\"); \n\n  int ret = nl_send_auto_complete(socket, msg);  // Send the message.\n  printf(\"NL80211_CMD_CONNECT sent %d bytes to the kernel.\\n\", ret);\n  ret = nl_recvmsgs_default(socket);  // Retrieve the kernel's answer. callback_dump() prints SSIDs to stdout.\n  nlmsg_free(msg);\n\n  if (ret &lt; 0) {\n      printf(\"ERROR: nl_recvmsgs_default() returned %d (%s).\\n\", ret, nl_geterror(-ret));\n      return ret;\n  }\n\n  nla_put_failure:\n  return -ENOSPC;\n</code></pre>\n\n<p>Now, I'm trying to do the same thing, but with an AP with WPA2 authentication. Unfortunately, there is little documentation for libnl. I've tried to add some command to the msg struct, that appears to be reasonable, like the following:</p>\n\n<pre><code>nla_put_32(msg, NL80211_ATTR_WPA_VERSIONS, NL80211_WPA_VERSION_2);\nnla_put(msg, NL80211_ATTR_PMK, strlen(\"pass\"), \"pass\");\n</code></pre>\n\n<p>But it doesn't work! The connection manager \"iw\" act in a similar way, but the <a href=\"https://github.com/greearb/iw-ct/blob/master/util.c\" rel=\"nofollow noreferrer\">code</a> is not so easy to understand. Some of you can help me develop this? thank you all!!</p>\n"}, {"tags": ["c", "fgets", "strlen"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1568231329, "post_id": 57895866, "comment_id": 102213094, "body": "Because you are sendign <code>BUFFSIZE</code> bytes to the output, instead of the number actually in the buffer."}, {"owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568231361, "post_id": 57895866, "comment_id": 102213101, "body": "but shouldn&#39;t write stop as soon as it finds the 0 at the end?. Also, I can&#39;t correctly send the number of bytes actually in the buffer because strlen is returning weird values"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1568231392, "post_id": 57895866, "comment_id": 102213114, "body": "You haven&#39;t used the <code>strlen</code> you wrote about."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1568231414, "post_id": 57895866, "comment_id": 102213127, "body": "No, <code>write</code> writes the number of bytes you tell it to write."}, {"owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568231423, "post_id": 57895866, "comment_id": 102213134, "body": "@WeatherVane not in the code, I said how I used it in comments"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1568231513, "post_id": 57895866, "comment_id": 102213176, "body": "Any particular reason you are using <code>read</code> and <code>write</code> with STDIN/STDOUT, as opposed to more conventional <code>printf&#47;scanf</code>? The later would handle your issue with nul-terminated strings correctly."}, {"owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568231515, "post_id": 57895866, "comment_id": 102213177, "body": "@WeatherVane then why is the trash printed at the end variable in size?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568231561, "post_id": 57895866, "comment_id": 102213195, "body": "Please read my first comment. You write the whole buffer regardless of its usage."}, {"owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "edited": false, "score": 0, "creation_date": 1568231592, "post_id": 57895866, "comment_id": 102213206, "body": "but the buffer is fixed in size, that&#39;s what I don&#39;t get"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1568231659, "post_id": 57895866, "comment_id": 102213239, "body": "You can store a 3 byte string in a 10 byte <code>buf</code>. But, if you use <code>write(1, buf, 10)</code>, you are going to get 7 bytes of garbage after the first 3 bytes."}, {"owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "edited": false, "score": 0, "creation_date": 1568231838, "post_id": 57895866, "comment_id": 102213314, "body": "ok, thanks. I edited my original question because I still don&#39;t get why strlen is returning such a large value"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1568232700, "post_id": 57895866, "comment_id": 102213590, "body": "Please read up on creating a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1568234314, "post_id": 57895866, "comment_id": 102214088, "body": "Please try stepping through the code in a debugger."}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "edited": false, "score": 0, "creation_date": 1568235542, "post_id": 57895866, "comment_id": 102214548, "body": "I think previous comments mentioned the cause, but I&#39;d like to add a note about the <code>read</code>, Since you&#39;re using <code>read</code> you have to check the number of bytes you got from it and if the bytes in the result are <code>null-terminated</code> or it may cause problems sometimes, you can check this by <code>if (!filename[bytes])</code>."}], "answers": [{"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1568234258, "post_id": 57896037, "comment_id": 102214072, "body": "This is possible, but you have not really explained the root cause."}], "tags": [], "owner": {"reputation": 431, "user_id": 9940188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab55648698bdae0015bce0761121c4d?s=128&d=identicon&r=PG&f=1", "display_name": "musbur", "link": "https://stackoverflow.com/users/9940188/musbur"}, "is_accepted": false, "score": -1, "last_activity_date": 1568232088, "creation_date": 1568232088, "answer_id": 57896037, "question_id": 57895866, "link": "https://stackoverflow.com/questions/57895866/why-is-this-code-printing-trash-at-the-end-why-is-strlen-returning-uncorrect-va/57896037#57896037", "title": "Why is this code printing trash at the end? Why is strlen returning uncorrect values?", "body": "<p>I don't know what minisat is or does, but I bet that TAGSIZE equals 64 and that minisat just doesn't output anything that fgets recognizes as newline. Therefore fgets just captures the pipe output, and the \"trash\" you see is just the remainder of whatever was in the buffer at the beginning.</p>\n\n<p>Your code is prone to all sorts of undefined behavior due to buffer overruns. </p>\n"}], "owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1568232088, "creation_date": 1568231206, "last_edit_date": 1568231802, "question_id": 57895866, "link": "https://stackoverflow.com/questions/57895866/why-is-this-code-printing-trash-at-the-end-why-is-strlen-returning-uncorrect-va", "title": "Why is this code printing trash at the end? Why is strlen returning uncorrect values?", "body": "<p>I am running the following program</p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n    char fileName[NAMESIZE];\n    char buffer[BUFFSIZE];\n    buffer[0] = 0;\n    int bytes;\n    bytes = read(0 ,fileName, NAMESIZE);\n    char command[COMMANDSIZE];\n    char outAux[TAGSIZE];\n    fileName[bytes - 1] = 0;\n    sprintf(command, \"minisat %s | grep \\\"Number of v\\\" -A2 | sed 's/|//g'| sed 's/: */: /g' | sed 's/^ *//g'\", fileName);\n    FILE * fp;\n    fp = popen(command, \"r\");\n    while(fgets(outAux, TAGSIZE, fp)){\n        strcat(buffer, outAux);\n    }\n    pclose(fp);\n    write(1, buffer, BUFFSIZE);\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>From what I understand, fgets does put a 0 at the end. However, the output is the following:</p>\n\n<pre><code>Number of variables: 3                                         \nNumber of clauses: 2                                         \nParse time: 0.00 s                                       \n(trash)\n</code></pre>\n\n<p>It correctly prints what I wanted to but then it starts prnting trash, as if there was no 0 at the end</p>\n\n<p>I tried fixing this by forcing a 0 by doing the following: saving the length of outAux in every iteration of the while loop, adding that to a counter buffLen, and then doing buffer[buffLen] = 0</p>\n\n<p>However, this fails because strlen is not returning the length of outAux. For example, the line \"Number of variables: 3\\n\" has a length of 64 according to strlen</p>\n\n<p>How can I fix my problem? (and if possible I would also like to know why strlen is returning uncorrect values)</p>\n\n<p>EDIT: The original issue came from me incorrectly using write. However, I still have my original question. If I run the following code:</p>\n\n<pre><code>fgets(outAux, TAGSIZE, fp));\nprintf(\"%s\", outAux);\nprintf(\"%d\", strlen(outAux));\n</code></pre>\n\n<p>I get the following output: </p>\n\n<pre><code>Number of variables: 3\n64\n</code></pre>\n\n<p>Why is strlen returning this large value?</p>\n"}, {"tags": ["c", "string", "input", "scanf", "text-files"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1568230276, "post_id": 57895692, "comment_id": 102212712, "body": "Please post <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and the results - the expected and the actual."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568230484, "post_id": 57895692, "comment_id": 102212793, "body": "Warning for <code>sscanf</code>: not enough arguments passed. I suppose you intend to advance a string pointer with each field, however the first read will fail trying to read a <code>double</code> from a string beginning with <code>&quot;VarDab&quot;</code>."}, {"owner": {"reputation": 2939, "user_id": 2419003, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NUQW0.png?s=128&g=1", "display_name": "m_power", "link": "https://stackoverflow.com/users/2419003/m-power"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568230817, "post_id": 57895692, "comment_id": 102212929, "body": "@WeatherVane Yes, I think I&#39;ll have to use some kind of offset to modify the <code>Line</code> that I read with <code>sscanf</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1568230896, "post_id": 57895692, "comment_id": 102212957, "body": "There is quite a lot wrong with the code. Another is that you attempt to scan <code>maxLengthOfLine</code> values without making any attempt to find where it ends. You <i>must</i> check the return value from <code>sscanf</code>. But personally, I would solve this with <code>strtok()</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568241472, "post_id": 57895692, "comment_id": 102216092, "body": "regarding; <code>file *fid;</code>   The C language is case sensitive.  The <code>FILE</code> is a typedef name for a struct that describes a file.  so: 1) must have: <code>#include &lt;stdio.h&gt;</code>  2) the correct syntax is: <code>FILE *fid;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568241667, "post_id": 57895692, "comment_id": 102216137, "body": "please read: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">why while(!feof(fid)) is always wrong</a>  Suggest using: <code>while(  fgets(Line, maxLengthOfLine, fid) ) {</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568242009, "post_id": 57895692, "comment_id": 102216204, "body": "regarding: <code>sscanf(Line, &quot;%s&quot;, varString);</code> and <code>sscanf(Line, &quot;%lf%n&quot;, &amp;varNumbers[i]);</code>  1) when using &#39;%s&#39; or &#39;%[...]&#39; always include a MAX characters modifier that is one less than the length of the input buffer because those specifiers always append a NUL byte to the input.  This also avoid buffer overflow and the attendant undefined behavior.  2) always check the returned value (not the the parameter values).  in this case, any returned value other than 1 indicates an error occurred.  3) do NOT put &#39;\\n&#39; in the format string"}, {"owner": {"reputation": 2939, "user_id": 2419003, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NUQW0.png?s=128&g=1", "display_name": "m_power", "link": "https://stackoverflow.com/users/2419003/m-power"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568296258, "post_id": 57895692, "comment_id": 102236287, "body": "@WeatherVane, I provided an update of my code which now includes the length of the input buffer."}, {"owner": {"reputation": 2939, "user_id": 2419003, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NUQW0.png?s=128&g=1", "display_name": "m_power", "link": "https://stackoverflow.com/users/2419003/m-power"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568297498, "post_id": 57895692, "comment_id": 102237055, "body": "@user3629249, I modified my code with the change you proposed (i.e. <code>while( fgets...)</code>)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568387228, "post_id": 57895692, "comment_id": 102269799, "body": "regarding:  <code>sscanf(Line, &quot;%lf %n&quot;, &amp;y[i], &amp;offset);</code>  as you stated, the number of following values is an unknown, should be checking the returned value from the call to <code>sscanf()</code> to be able to exit the loop when no more data is available"}], "answers": [{"comments": [{"owner": {"reputation": 2939, "user_id": 2419003, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NUQW0.png?s=128&g=1", "display_name": "m_power", "link": "https://stackoverflow.com/users/2419003/m-power"}, "edited": false, "score": 0, "creation_date": 1568231918, "post_id": 57895925, "comment_id": 102213343, "body": "With this approach, how do I get access to the string in order to validate that I&#39;m on the correct line in my text file?"}], "tags": [], "owner": {"reputation": 6247, "user_id": 1978471, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mIJrw.jpg?s=128&g=1", "display_name": "david72", "link": "https://stackoverflow.com/users/1978471/david72"}, "is_accepted": false, "score": 1, "last_activity_date": 1568232496, "last_edit_date": 1568232496, "creation_date": 1568231458, "answer_id": 57895925, "question_id": 57895692, "link": "https://stackoverflow.com/questions/57895692/reading-all-numbers-that-follow-a-specific-string-on-a-line-of-a-text-file/57895925#57895925", "title": "Reading all numbers that follow a specific string on a line of a text file", "body": "<p>You should use strtok to split line into tokens, example:</p>\n\n<pre><code>char *tok;\ntok = strtok(Line, \" \"); // this is your String (first token in line)\n\ntok = strtok(NULL, \" \"); // skip to next token (first number)\nwhile (tok != NULL)\n{\n    printf(\"%s\\n\", tok); // use sscanf on tok to handle the numbers\n    tok = strtok(NULL, \" \"); // skip to next token\n}\n</code></pre>\n"}], "owner": {"reputation": 2939, "user_id": 2419003, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NUQW0.png?s=128&g=1", "display_name": "m_power", "link": "https://stackoverflow.com/users/2419003/m-power"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568297387, "creation_date": 1568230157, "last_edit_date": 1568297387, "question_id": 57895692, "link": "https://stackoverflow.com/questions/57895692/reading-all-numbers-that-follow-a-specific-string-on-a-line-of-a-text-file", "title": "Reading all numbers that follow a specific string on a line of a text file", "body": "<p>I'm asking this question because the solutions I found to similar questions, here on stackoverflow, didn't allow me to solve my problem. I have a <code>.txt</code> file which is as follow:</p>\n\n<pre><code>VarA 10.0 20.0 30.0\nVarBB 10\nVarCz 1 2 3 4\nVarDab 10 20 30 40 50\n...\n</code></pre>\n\n<p>I'm trying to output (e.g. store them in a variable) the numbers associated to a specific variable using the <code>sscanf</code> function. For example, when looking for the string <code>VarDab</code> in the file, I want to store the numbers <code>10, 20, 30, 40, 50</code> in a variable. Because the number of numbers found for a specific string variable is not constant, I was trying to use the sscanf function in a loop. However, I'm not getting the result that I want. The code I have done so far:</p>\n\n<pre><code>FILE *fid;\nchar nameOfVariable[] = \"VarDab\";\nint i;\nwhile(!feof(fid))\n{\n    fgets(Line, maxLengthOfLine, fid);\n    sscanf(Line, \"%s\", varString);\n    if (strcmp(nameOfVariable, varString) == 0)\n    {\n        for (i = 0; i &lt; maxLengthOfLine; i++)\n        {\n            sscanf(Line, \"%lf%n\", &amp;varNumbers[i]);\n        }\n    }\n}\nflcose(fid);\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>From the comments, I was able to modify my current implementation by adding an offset to the <code>Line</code> at each increment in the loop. It seems to work:</p>\n\n<pre><code>FILE *fid;\nchar nameOfVariable[] = \"VarDab\";\nint i;\nint variableIsFound = 1;\nint offset = 0;\nint numberOfNumbers = 5;\n\nwhile(fgets(Line, maxLengthOfLine, fid) != NULL &amp;&amp; variableIsFound)\n{\n    sscanf(Line, \"%s %n\", varString, &amp;offset);\n    if (strcmp(nameOfVariable, varString) == 0)\n    {\n        Line += offset;\n        for (i = 0; i &lt; numberOfNumbers; i++) {\n            sscanf(Line, \"%lf %n\", &amp;y[i], &amp;offset);\n            Line += offset;\n        }\n        variableIsFound = 0;\n    }\n}\nfclose(fid);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5818, "user_id": 978558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d023acf70b927cb813b48631195e346e?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/978558/fredrik"}, "edited": false, "score": 2, "creation_date": 1568229082, "post_id": 57895423, "comment_id": 102212223, "body": "make <code>new</code> and <code>bufNew</code> 5 characters or use <code>strncmp</code>. Your 4 character strings have no space for the null termination byte."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1568229126, "post_id": 57895423, "comment_id": 102212249, "body": "<code>new[4]</code> and <code>bufNew[4]</code> is out of bounds."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1568235108, "post_id": 57895423, "comment_id": 102214384, "body": "Yup - bean counting again:("}], "answers": [{"tags": [], "owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1568229956, "creation_date": 1568229956, "answer_id": 57895648, "question_id": 57895423, "link": "https://stackoverflow.com/questions/57895423/sliced-string-and-char-buffer-are-not-equal/57895648#57895648", "title": "Sliced string and char buffer are not equal", "body": "<p>It is likely that <code>sprintf(bufNew, \"%04d\", packet_counter);</code> overwrites the terminating 0 of <code>new</code> (since as others said, it is used out of its bounds). Try moving the <code>printf(\"Sliced no is: %s\\n\",new);</code> down below <code>bufNew[4]='\\0';</code> to see it for yourself.</p>\n\n<p>To fix it, <code>new</code>and <code>bufNew</code> needs to be declared with size <code>5</code>:</p>\n\n<pre><code>   char new[5];\n   char bufNew[5];\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 10957632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLEuW.jpg?s=128&g=1", "display_name": "SUBHANSHU SAHU", "link": "https://stackoverflow.com/users/10957632/subhanshu-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57895648, "answer_count": 1, "score": 1, "last_activity_date": 1568229956, "creation_date": 1568228837, "question_id": 57895423, "link": "https://stackoverflow.com/questions/57895423/sliced-string-and-char-buffer-are-not-equal", "title": "Sliced string and char buffer are not equal", "body": "<p>I want to extract the packet number from the received message and want to compare with originally sent packet_count and trying with following code</p>\n\n<pre><code>    char string[] = \"Hello client 0000!\";    \n    char new[4];\n    char bufNew[4];\n    int i=0;\n    int count=0;\n    int num=0;\n    int packet_counter=0;\n\n    for (i=13;i&lt;17;i++)\n    {\n        new[count] = string[i];\n        count = count+1;\n    }\n    new[4]='\\0';\n    printf(\"Sliced no is: %s\\n\",new);\n    sprintf(bufNew, \"%04d\", packet_counter);\n    bufNew[4]='\\0';\n\n    printf(\"packet counter is: %s\\n\",bufNew);\n\n    printf(\"String compare result: %d\\n\",strcmp(new,bufNew));\n</code></pre>\n\n<p>Although the output look same, strings are different.</p>\n\n<p>Output:</p>\n\n<pre><code>Sliced no is: 0000                                                                                                            \npacket counter is: 0000                                                                                                       \nString compare result: 48\n</code></pre>\n\n<p>Please guide how to make both these strings equal.</p>\n"}, {"tags": ["c", "multidimensional-array", "trigram"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568228271, "post_id": 57895274, "comment_id": 102211819, "body": "How many <code>aaa</code>s in <code>aaaa</code>?"}, {"owner": {"reputation": 67, "user_id": 10930077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea1312f37ff9e288029740f6e46315b?s=128&d=identicon&r=PG&f=1", "display_name": "nhlyoung", "link": "https://stackoverflow.com/users/10930077/nhlyoung"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568228418, "post_id": 57895274, "comment_id": 102211896, "body": "That would count as 2"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1568228666, "post_id": 57895274, "comment_id": 102212033, "body": "What have you already tried to get these &quot;trigrams&quot;? Show us the code you&#39;ve tried (even if it doesn&#39;t work)."}, {"owner": {"reputation": 67, "user_id": 10930077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea1312f37ff9e288029740f6e46315b?s=128&d=identicon&r=PG&f=1", "display_name": "nhlyoung", "link": "https://stackoverflow.com/users/10930077/nhlyoung"}, "edited": false, "score": 0, "creation_date": 1568228855, "post_id": 57895274, "comment_id": 102212127, "body": "Sorry, it&#39;s up there now :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1568230020, "post_id": 57895274, "comment_id": 102212622, "body": "<code>c1 = getc(plain)</code> - you are overwriting the saved <code>c1</code>. I would think that you want to read into <code>c2</code>"}, {"owner": {"reputation": 67, "user_id": 10930077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea1312f37ff9e288029740f6e46315b?s=128&d=identicon&r=PG&f=1", "display_name": "nhlyoung", "link": "https://stackoverflow.com/users/10930077/nhlyoung"}, "edited": false, "score": 0, "creation_date": 1568230349, "post_id": 57895274, "comment_id": 102212747, "body": "YES!! I was overwriting c1. switched that to c2 and it worked perfectly. Thank you!"}, {"owner": {"reputation": 67, "user_id": 10930077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea1312f37ff9e288029740f6e46315b?s=128&d=identicon&r=PG&f=1", "display_name": "nhlyoung", "link": "https://stackoverflow.com/users/10930077/nhlyoung"}, "edited": false, "score": 0, "creation_date": 1568231280, "post_id": 57895274, "comment_id": 102213077, "body": "Well it&#39;s almost perfect. That did successfully print all trigrams, but they&#39;re not in descending order."}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 1, "creation_date": 1568231880, "post_id": 57895274, "comment_id": 102213330, "body": "I think, it would be better to use triple-for loop and <code>strstr</code> function to find number of all triagrams"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1568240478, "post_id": 57895274, "comment_id": 102215848, "body": "The order is linked directly to the index; I think one has to have a more complicated <code>struct</code> if one is going to reorder them efficiently, (or have two steps.)"}], "answers": [{"tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1568250522, "last_edit_date": 1568250522, "creation_date": 1568250112, "answer_id": 57898453, "question_id": 57895274, "link": "https://stackoverflow.com/questions/57895274/counting-trigrams-3-letter-sequence-in-c/57898453#57898453", "title": "Counting trigrams (3 letter sequence) in C?", "body": "<p>One needs more information if one is going to sort the bins; in this code, it's the <code>order</code> array-of-pointers that points to all the trigrams, one-to-one. However, with the original code, it's difficult to tell which trigram is with what index in <code>O(1)</code>. Thus I have packed and flattened the array, thus ensuring that there is a bijection from index of array to the entire space of trigrams, (17576 of them.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n\nstruct Tri { const char c0, c1, c2; };\n\nstatic size_t tri_to_idx(const struct Tri tri) {\n    return (tri.c0 - 'a') * ('z' - 'a' + 1) * ('z' - 'a' + 1)\n        + (tri.c1 - 'a') * ('z' - 'a' + 1)\n        + (tri.c2 - 'a');\n}\n\nstatic struct Tri idx_to_tri(const size_t idx) {\n    struct Tri tri = {\n        idx / (('z' - 'a' + 1) * ('z' - 'a' + 1)) + 'a',\n        (idx % (('z' - 'a' + 1) * ('z' - 'a' + 1))) / ('z' - 'a' + 1) + 'a',\n        idx % ('z' - 'a' + 1) + 'a' };\n    assert(tri.c0 &gt;= 'a' &amp;&amp; tri.c0 &lt;= 'z'\n        &amp;&amp; tri.c1 &gt;= 'a' &amp;&amp; tri.c1 &lt;= 'z'\n        &amp;&amp; tri.c2 &gt;= 'a' &amp;&amp; tri.c2 &lt;= 'z');\n    return tri;\n}\n\nstatic const char *tri_to_str(const struct Tri tri) {\n    static char str[4];\n    str[0] = tri.c0, str[1] = tri.c1, str[2] = tri.c2, str[3] = '\\0';\n    return str;\n}\n\nstatic int int_reverse_cmp(const int *const a, const int *const b) {\n    return (*a &lt; *b) - (*b &lt; *a);\n}\n\nstatic int compar(const void *a, const void *b) {\n    return int_reverse_cmp(*(int **)a, *(int **)b);\n}\n\nint main(void) {\n    const char *const fn = \"filename.txt\";\n    int count[('z' - 'a' + 1) * ('z' - 'a' + 1) * ('z' - 'a' + 1)] = { 0 };\n    int *order[('z' - 'a' + 1) * ('z' - 'a' + 1) * ('z' - 'a' + 1)];\n    int c0 = EOF, c1 = EOF, c2;\n    size_t i;\n    FILE *plain = fopen(fn, \"r\");\n\n    if(!plain) return perror(fn), EXIT_FAILURE;\n\n    while ((c2 = getc(plain)) != EOF) {\n        if (c1 &gt;= 'a' &amp;&amp; c1 &lt;= 'z'\n            &amp;&amp; c0 &gt;= 'a' &amp;&amp; c0 &lt;= 'z'\n            &amp;&amp; c2 &gt;= 'a' &amp;&amp; c2 &lt;= 'z') {\n            struct Tri tri = { c0, c1, c2 };\n            count[tri_to_idx(tri)]++;\n        }\n        c0 = c1;\n        c1 = c2;\n    }\n    fclose(plain);\n\n    for (c0 = 'a'; c0 &lt;= 'z'; c0++) {\n        for (c1 = 'a'; c1 &lt;= 'z'; c1++) {\n            for (c2 = 'a'; c2 &lt;= 'z'; c2++) {\n                struct Tri tri = { c0, c1, c2 };\n                order[tri_to_idx(tri)] = &amp;count[tri_to_idx(tri)];\n            }\n        }\n    }\n\n    qsort(order, sizeof order / sizeof *order, sizeof *order, &amp;compar);\n    for(i = 0; i &lt; ('z' - 'a' + 1) * ('z' - 'a' + 1) * ('z' - 'a' + 1)\n        &amp;&amp; *order[i]; i++) {\n        printf(\"%s: %d\\n\", tri_to_str(idx_to_tri(order[i] - count)), *order[i]);\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Now one can sort the pointers to the array and still have a bijection back into the trigrams by the index of the trigram, <code>order[i] - count</code> in the <code>printf</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 10930077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea1312f37ff9e288029740f6e46315b?s=128&d=identicon&r=PG&f=1", "display_name": "nhlyoung", "link": "https://stackoverflow.com/users/10930077/nhlyoung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568250522, "creation_date": 1568228141, "last_edit_date": 1568233122, "question_id": 57895274, "link": "https://stackoverflow.com/questions/57895274/counting-trigrams-3-letter-sequence-in-c", "title": "Counting trigrams (3 letter sequence) in C?", "body": "<p>I'm attempting to count the number of trigrams, or three letter sequences, in a block of text. I have some code already that successfully counts the number of bigrams (2 letter sequence) using a 2d array, but I'm having some trouble altering it to accept trigrams.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\nint count['z' - 'a' + 1]['z' - 'a' + 1] = {{ 0 }};\nint c0 = EOF, c1;\nFILE *plain = fopen(\"filename.txt\", \"r\");\n\nif (plain != NULL) {\n    while ((c1 = getc(plain)) != EOF) {\n        if (c1 &gt;= 'a' &amp;&amp; c1 &lt;= 'z' &amp;&amp; c0 &gt;= 'a' &amp;&amp; c0 &lt;= 'z') {\n            count[c0 - 'a'][c1 - 'a']++;\n        }\n        c0 = c1;\n    }\n    fclose(plain);\n    for (c0 = 'a'; c0 &lt;= 'z'; c0++) {\n        for (c1 = 'a'; c1 &lt;= 'z'; c1++) {\n            int n = count[c0 - 'a'][c1 - 'a'];\n            if (n) {\n                printf(\"%c%c: %d\\n\", c0, c1, n);\n            }\n        }\n    }\n}\nreturn 0;\n}\n</code></pre>\n\n<p>Edit: Here's the code I've already tried. I was hoping to just expand the 2d array to a 3d array, but this returns nothing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\nint count['z' - 'a' + 1]['z' - 'a' + 1]['z' - 'a' + 1] = {{{ 0 }}};\nint c0 = EOF, c1, c2;\nFILE *plain = fopen(\"filename.txt\", \"r\");\n\nif (plain != NULL) {\n    while ((c1 = getc(plain)) != EOF) {\n        if (c1 &gt;= 'a' &amp;&amp; c1 &lt;= 'z' &amp;&amp; c0 &gt;= 'a' &amp;&amp; c0 &lt;= 'z' &amp;&amp; c2 &gt;= 'a' &amp;&amp; c2 &lt;= 'z') {\n            count[c0 - 'a'][c1 - 'a'][c2 - 'a']++;\n\n        }\n        c0 = c1;\n        c1 = c2;\n    }\n    fclose(plain);\n    for (c0 = 'a'; c0 &lt;= 'z'; c0++) {\n        for (c1 = 'a'; c1 &lt;= 'z'; c1++) {\n            for (c2 = 'a'; c2 &lt;= 'z'; c2++) {\n                    int n = count[c0 - 'a'][c1 - 'a'][c2 - 'a'];\n                    if (n) {\n                            printf(\"%c%c%c: %d\\n\", c0, c1, c2, n);\n                    }\n            }\n        }\n    }\n}\nreturn 0;\n}\n</code></pre>\n\n<p>For example, this code prints all occurances of bigrams such as aa, ab, ac, etc. But I need it to count the occurances of aaa, aab, ... zzz. Any help would be greatly appreciated!</p>\n\n<p>Edit 2: now it successfully prints the correct output, but it needs to be in descending order (most used trigram at the top)</p>\n"}, {"tags": ["c", "arm", "integer-division", "divide-by-zero", "armv8"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 1, "creation_date": 1568223293, "post_id": 57894010, "comment_id": 102209773, "body": "Can you check if <code>FPSCR-&gt;DZE</code> is set.  It is the <code>Division by Zero exception enable bit</code>.  It may apply to integers also."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1568223348, "post_id": 57894010, "comment_id": 102209799, "body": "@FiddlingBits It seem to be running under Linux (userspace I presume?). So I guess it&#39;s about SIGTRAP handling. Well, maybe the kernel is not configured to set this bit though..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5069935"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568223519, "post_id": 57894010, "comment_id": 102209871, "body": "@EugeneSh. Yes userspace, running as non-root user with no special privileges."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1568223627, "post_id": 57894010, "comment_id": 102209923, "body": "Related question: <a href=\"https://stackoverflow.com/questions/37262572/on-which-platforms-does-integer-divide-by-zero-trigger-a-floating-point-exceptio\" title=\"on which platforms does integer divide by zero trigger a floating point exceptio\">stackoverflow.com/questions/37262572/&hellip;</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568223757, "post_id": 57894010, "comment_id": 102209969, "body": "Since it is undefined behavior, compiler is not doing anything, and generates code to perform division. Absence of signal means that either it is your kernel which masks it, or hardware doesn&#39;t generate trap. Did you check hardware spec?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5069935"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1568224565, "post_id": 57894010, "comment_id": 102210286, "body": "@FiddlingBits, looks like I need to read bit 9 of the FPSCR register.  Is there a simple way to do that in C or will it involve inline ASM?"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 2, "creation_date": 1568224687, "post_id": 57894010, "comment_id": 102210338, "body": "What ARM architecture is it? Based on this: <a href=\"https://community.arm.com/developer/ip-products/processors/b/processors-ip-blog/posts/divide-and-conquer\" rel=\"nofollow noreferrer\">community.arm.com/developer/ip-products/processors/b/&hellip;</a> there might be different behavior in case of division by zero. For example on ARMv7-A - divide by zero always returns a zero result."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5069935"}, "reply_to_user": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1568224971, "post_id": 57894010, "comment_id": 102210430, "body": "@AlexLop. I&#39;ve added the output of /etc/cpuinfo to the end of the Question.  &quot;A57&quot; is  ARMv8 silicon."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5069935"}, "edited": false, "score": 0, "creation_date": 1568226057, "post_id": 57894573, "comment_id": 102210860, "body": "I never realised before that such things were handled so differently by various architectures.  I had foolishly assumed that such a fundamental thing would always result in a hard SIGFPE, as POSIX demands.  Fascinating.  Thank you for your efforts."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1568310041, "post_id": 57894573, "comment_id": 102243266, "body": "@Wossname Can you share where POSIX <i>requires</i> that integer division by zero raises <code>SIGFPE</code>? What I found is <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">this</a> that suggests raising <code>SIGFPE</code> with a value of <code>FPE_INTDIV</code> is optional: &quot;Implementations may [...] contain extensions or limitations that prevent some values from being generated.&quot;"}], "tags": [], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "is_accepted": true, "score": 9, "last_activity_date": 1568230525, "last_edit_date": 1592644375, "creation_date": 1568225151, "answer_id": 57894573, "question_id": 57894010, "link": "https://stackoverflow.com/questions/57894010/division-by-zero-not-causing-runtime-exception-on-nvidia-jetson/57894573#57894573", "title": "Division by zero not causing runtime exception on Nvidia Jetson", "body": "<p>Nvidia Jetson Nano dev board uses ARM Cortex-A57 (<a href=\"https://buildazure.com/raspberry-pi-4-vs-nvidia-jetson-nano-developer-kit/\" rel=\"nofollow noreferrer\">Link</a>) which is based on ARMv8 architecture.\nBased on the instruction set <a href=\"https://static.docs.arm.com/100898/0100/the_a64_Instruction_set_100898_0100.pdf\" rel=\"nofollow noreferrer\">spec</a> of ARMv8, <strong>integer</strong> division by zero <strong>returns zero</strong> and not trapped.</p>\n<blockquote>\n<p><strong>2.3 Divide instructions</strong></p>\n<p>ARMv8-A supports signed and unsigned division of 32-bit and 64-bit sized values.</p>\n<p>Instruction Description</p>\n<p>SDIV Signed divide</p>\n<p>UDIV Unsigned divide</p>\n<p>...</p>\n<p><em>Overflow and divide-by-zero are not trapped</em>:</p>\n<p>\u2022 Any integer division by zero returns zero</p>\n</blockquote>\n<p>So the compiler generates <code>sdiv</code> in this case (see <a href=\"https://godbolt.org/z/6sRfrK\" rel=\"nofollow noreferrer\">example</a>) and the CPU returns 0 without any exception. When you compile the same code on different platforms, each other CPU may reacts differently to division by zero. As you mentioned in your question, in case of division by 0, the behavior is <em>undefined</em> by the C standard.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 1860275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b19d73009a2a873ceaabe514919a32?s=128&d=identicon&r=PG", "display_name": "georgn", "link": "https://stackoverflow.com/users/1860275/georgn"}, "is_accepted": false, "score": 0, "last_activity_date": 1615305975, "creation_date": 1615305975, "answer_id": 66550510, "question_id": 57894010, "link": "https://stackoverflow.com/questions/57894010/division-by-zero-not-causing-runtime-exception-on-nvidia-jetson/66550510#66550510", "title": "Division by zero not causing runtime exception on Nvidia Jetson", "body": "<p>It's worth noting that not all ARM processors are the same (as has been noted). I am working on a project with an STM32L4 (which contains a cortex-m4). It does have the SDIV and UDIV instructions. However, the generation of an exception on division by zero is <em>configurable</em> (see the <a href=\"https://www.st.com/resource/en/programming_manual/dm00046982-stm32-cortex-m4-mcus-and-mpus-programming-manual-stmicroelectronics.pdf\" rel=\"nofollow noreferrer\">STM32 Cortex\u00ae-M4 MCUs and MPUs programming manual</a>, page 231)</p>\n<p>Further complicating things is that occasionally, the compiler can recognize the division by zero case and generate illegal instructions (obviating the configuration I noted). Have a play with this <a href=\"https://godbolt.org/z/fsTsM4\" rel=\"nofollow noreferrer\">example</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5069935"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 57894573, "answer_count": 2, "score": 10, "last_activity_date": 1615305975, "creation_date": 1568222437, "last_edit_date": 1568226973, "question_id": 57894010, "link": "https://stackoverflow.com/questions/57894010/division-by-zero-not-causing-runtime-exception-on-nvidia-jetson", "title": "Division by zero not causing runtime exception on Nvidia Jetson", "body": "<p>I'm not very familiar with the internal details of ARM processors, but I do not understand the following behaviour on my Nvidia Jetson Nano dev board.</p>\n\n<p>C code sample ...</p>\n\n<pre><code>//main.c\n\n#include &lt;stdio.h&gt;\n\nint main()\n{\n  int fred = 123;\n  int i;\n\n  for(i = -10 ; i &lt;= 10 ; i++)\n    printf(\"%d / %d == %d\\n\", fred, i, fred / i);\n\n  return 0;\n}\n</code></pre>\n\n<p>Compiled with :</p>\n\n<pre><code>gcc main.c -ggdb\n</code></pre>\n\n<p>Running the resulting a.out executable yields the following output...</p>\n\n<pre><code>123 / -10 == -12\n123 / -9 == -13\n123 / -8 == -15\n123 / -7 == -17\n123 / -6 == -20\n123 / -5 == -24\n123 / -4 == -30\n123 / -3 == -41\n123 / -2 == -61\n123 / -1 == -123\n123 / 0 == 0                  //unexpected!\n123 / 1 == 123\n123 / 2 == 61\n123 / 3 == 41\n123 / 4 == 30\n123 / 5 == 24\n123 / 6 == 20\n123 / 7 == 17\n123 / 8 == 15\n123 / 9 == 13\n123 / 10 == 12\n</code></pre>\n\n<p>The exact same code compiled on an ancient Pentium 4 using gcc 3.7 causes (as expected) a runtime exception to be thrown when <code>i</code> reaches 0 and causes a division by zero.</p>\n\n<p>The Nvidia board is running Ubuntu 18.04 LTS, gcc version 7.4.0 (latest) and in every other respect runs beautifully.  I have also compiled the equivalent Ada language version of this code and a runtime exception <strong>is</strong> raised as one would expect (because Ada does safety checks ahead of time on my behalf).</p>\n\n<p>I realise that in C, \"division by zero yields undefined behaviour\" is likely the explanation for this, but for two versions of the same compiler suite to give such different results to the same operation is puzzling to me.</p>\n\n<p>What circumstances could cause an Nvidia Tegra ARM (64 bit) CPU to allow a division by zero to pass by unnoticed by the OS?</p>\n\n<p>EDIT:\nDetails about the CPU from /etc/cpuinfo...</p>\n\n<pre><code>$ cat /proc/cpuinfo\nprocessor       : 0\nmodel name      : ARMv8 Processor rev 1 (v8l)\nBogoMIPS        : 38.40\nFeatures        : fp asimd evtstrm aes pmull sha1 sha2 crc32\nCPU implementer : 0x41\nCPU architecture: 8\nCPU variant     : 0x1\nCPU part        : 0xd07\nCPU revision    : 1\n\n.... truncated ....\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "networking", "udp"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1568222385, "post_id": 57893923, "comment_id": 102209395, "body": "Usually you fetch them. I&#39;m not sure the POSIX networking API lets you check the number of &quot;packets&quot;. As far as the network stack is concerned, packets don&#39;t exist, they&#39;re the responsibility of the physical transport layer. The POSIX stack is concerned with <i>datagrams</i> which are a higher-level abstraction built on the actual packets. A single datagram could be sent as multiple packets, etc."}, {"owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568222543, "post_id": 57893923, "comment_id": 102209473, "body": "By packet I mean: each network level has its own packet type. UDP packet, specifically, is a datagram."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1568222787, "post_id": 57893923, "comment_id": 102209561, "body": "Why do you need to know how many udp datagrams are in the receive queue?  You could read the socket in non blocking mode until it generates <code>EWOULDBLOCK</code>, but then they would no longer be in the receive queue."}, {"owner": {"reputation": 436, "user_id": 9051293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88ae8d26aa1f2c5f33c305c0f4a8c48?s=128&d=identicon&r=PG&f=1", "display_name": "DevesH", "link": "https://stackoverflow.com/users/9051293/devesh"}, "edited": false, "score": 0, "creation_date": 1568222913, "post_id": 57893923, "comment_id": 102209617, "body": "Please post your question on <a href=\"https://networkengineering.stackexchange.com/\">networkengineering.stackexchange.com</a>"}, {"owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1568222924, "post_id": 57893923, "comment_id": 102209619, "body": "@pat To conform with a preexisting interface without having to reimplement it in userspace."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1568223029, "post_id": 57893923, "comment_id": 102209661, "body": "Does that interface need to know the actual number or is it sufficient to say 0 when there are 0 datagrams queued, and 1 when there are 1 or more?  I.e. what does the user of the interface do with the value?"}, {"owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "edited": false, "score": 0, "creation_date": 1568223291, "post_id": 57893923, "comment_id": 102209772, "body": "The interface should provide the actual number of packets, but I don&#39;t know if the users actually need that information."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 436, "user_id": 9051293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88ae8d26aa1f2c5f33c305c0f4a8c48?s=128&d=identicon&r=PG&f=1", "display_name": "DevesH", "link": "https://stackoverflow.com/users/9051293/devesh"}, "edited": false, "score": 3, "creation_date": 1568223299, "post_id": 57893923, "comment_id": 102209776, "body": "@Dave123 Did you consult <a href=\"https://networkengineering.stackexchange.com/help/on-topic\">networkengineering.stackexchange.com/help/on-topic</a> first? It is not particularly on topic there, this is clearly a programming question."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1568223690, "post_id": 57893923, "comment_id": 102209946, "body": "What I mean is &quot;packet&quot; and &quot;datagram&quot; are often confused but are actually two different things. Short of opening a raw socket and listening at the transport level (e.g. <code>tcpdump</code> or Wireshark) all you can see is the final, defragmented datagrams. You also need to drain the queue to count what&#39;s in it.The normal indications are receive buffer empty, receive buffer has data, and receive buffer full."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568224104, "post_id": 57893923, "comment_id": 102210103, "body": "I believe, there is no such way in Linux. The use case is rather unusual, out of curiosity, why is this of interest to you?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568231047, "post_id": 57893923, "comment_id": 102213001, "body": "@lvella There is no portable (or even nonstandard) way to get the number of pending datagrams in a socket&#39;s receive queue. If you absolutely need the actual number of pending datagrams, you will likely have to read the datagrams in the background into your own queue, and then you can return (the number of) entries from that queue as needed."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1568235327, "post_id": 57893923, "comment_id": 102214471, "body": "...by which time, another X datagrams have arrived.   This is a bad requirement that should be designed away if possible:("}], "owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568223028, "creation_date": 1568222041, "last_edit_date": 1568223028, "question_id": 57893923, "link": "https://stackoverflow.com/questions/57893923/how-can-i-find-the-number-of-pending-incoming-udp-packets-networking-related", "title": "How can I find the number of pending incoming UDP packets? (Networking Related)", "body": "<p>How to find the number of pending packets (not bytes) to receive in the input buffer of a bound UDP socket, from a C program? It can be a Linux specific interface.</p>\n\n<p>The closes I found is the <code>SIOCINQ</code> option for <code>ioctl()</code>, but it returns the number of bytes of the next packet, not the number of total packets.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568221928, "post_id": 57893889, "comment_id": 102209192, "body": "A block can be defined only within a function.:)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568221980, "post_id": 57893889, "comment_id": 102209215, "body": "..and there is no <i>syntax</i> to define a variable on heap."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1568222059, "post_id": 57893889, "comment_id": 102209248, "body": "Storage of variables is entirely implementation-dependent. In most implementations, all automatic variables are in the stack."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1568222076, "post_id": 57893889, "comment_id": 102209259, "body": "They&#39;re the same as other <i>local</i> variables (function parameters, variables declared within a function); they are stored from wherever <i>automatic</i> variables are stored.  Normally this means the stack, but they also could be in, say, registers."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568222161, "post_id": 57893889, "comment_id": 102209295, "body": "They&#39;re stored <i>in the computer</i>. That&#39;s about all you can be guaranteed. These could be registers, they could be stack, they could be heap, they could be in some other thing which we&#39;ve never heard of because it&#39;s unique to a particular CPU."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1568222190, "post_id": 57893889, "comment_id": 102209304, "body": "@tadman Nah, you can&#39;t guarantee that too. They can be optimized out."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568222220, "post_id": 57893889, "comment_id": 102209323, "body": "@EugeneSh. Arguably that&#39;s just very optimized storage."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1568224328, "post_id": 57893889, "comment_id": 102210189, "body": "Another question is whether two nonoverlapping blocks (that is, with mutually-exclusive scope) can re-use each other&#39;s storage.  It seems obvious that they could, although I&#39;ve heard that compilers tend <i>not</i> to do this.  (I&#39;m too lazy today to perform any experiments to find out.)"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 9, "last_activity_date": 1568222124, "creation_date": 1568222124, "answer_id": 57893946, "question_id": 57893889, "link": "https://stackoverflow.com/questions/57893889/in-c-where-are-block-scoped-variables-stored/57893946#57893946", "title": "In C, where are block scoped variables stored?", "body": "<p>Block-scoped variables, along with non-static local variables, have automatic storage duration. What compiler does with it is implementation-defined, though. If the compiler uses stack to manage automatic variables (most compilers do) then block variables end up on the stack. However, it is perfectly valid for the compiler to store these variables in registers, or even to optimize them out at compile time.</p>\n"}], "owner": {"reputation": 592, "user_id": 10089348, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w_VhF_J_GyI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rPAWpqXoTphYljOphP1TgjUZ4Epw/mo/photo.jpg?sz=128", "display_name": "Rander Gabriel", "link": "https://stackoverflow.com/users/10089348/rander-gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 57893946, "answer_count": 1, "score": 2, "last_activity_date": 1568222124, "creation_date": 1568221830, "question_id": 57893889, "link": "https://stackoverflow.com/questions/57893889/in-c-where-are-block-scoped-variables-stored", "title": "In C, where are block scoped variables stored?", "body": "<p>When we declare a variable inside a block (if. For...) where are those variables stored? I know that the function variables are stored on the stack, and the content dynamic allocated is stored on the heap, but what if we declare a variable inside an if block?</p>\n"}, {"tags": ["c", "json", "struct"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1568221543, "post_id": 57893800, "comment_id": 102209043, "body": "OK; that&#39;s a good start.  Now, what are you going to do next?  (We will help you resolve problems that you identify; we won&#39;t simply do your homework or write the code for you.) . Do you plan to ignore the <code>&quot;Wset&quot;</code> and <code>&quot;W_set&quot;</code> keys?  Is the order of the keys guaranteed?  Is the number of keys guaranteed?  Is the &#39;split over multiple lines&#39; property guaranteed?  What needs to be done with the field with the null key name?"}, {"owner": {"reputation": 104, "user_id": 4831400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3eafee7d44e2b6b705846691307309?s=128&d=identicon&r=PG&f=1", "display_name": "alrevuelta", "link": "https://stackoverflow.com/users/4831400/alrevuelta"}, "edited": false, "score": 2, "creation_date": 1568221721, "post_id": 57893800, "comment_id": 102209111, "body": "You can either create your own function to read the json file (which is a bit complex) or use any of the existing C libraries to read the file. I would recommend going for the second option."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568221840, "post_id": 57893800, "comment_id": 102209160, "body": "You can find a list of about 18 C libraries for parsing JSON at the bottom of the home page of <a href=\"https://json.org/\" rel=\"nofollow noreferrer\">https://json.org/</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568221941, "post_id": 57893800, "comment_id": 102209198, "body": "Does the JSON file contain only a single record (object), or can it contain many similar records?  Why are you treating <code>&quot;set&quot;</code> as an array of 50 <code>float</code>?  Is the <code>float</code> a typo for <code>char</code>, or do you expect <code>&quot;set&quot;: [ 1.2, 2.1, 3.2, 2.3 ],</code> as the entry in the JSON, or what?  Similarly with <code>low</code>."}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568222148, "post_id": 57893800, "comment_id": 102209291, "body": "@JonathanLeffler Of course. I don&#39;t want to ignore &quot;Wset&quot; and &quot;W_set&quot; keys if they exist in the Json file. The keys of the Json files are changing everything time (there are many unknown attributes that can occur in the future).   The number of keys is not guarantee. The &#39;split over multiple lines&#39; property is guaranteed?   The null key name should be given a random name (multiple keys can occurs with like the null key name)  The attribute types of the struct should be automatically detected and created. The Json file contains a single record (object)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1568222300, "post_id": 57893800, "comment_id": 102209346, "body": "If the structure of the JSON can vary, you need a more dynamic C structure, you can&#39;t just hard-code specific member names. The JSON libraries mentioned above probably have something you can use instead of defining your own struct."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568222307, "post_id": 57893800, "comment_id": 102209352, "body": "You structure has no way of storing keys like <code>&quot;Wset&quot;</code>, so it isn&#39;t adequate to represent what can be in the data file.  We can&#39;t tell that such keys are crucial to you; your data structure hints that they&#39;re not important.  This, though, is why you need to use a library rather than roll your own (unless you&#39;ve got a lot of time on your hands).  I&#39;m rolling my own library; I&#39;ve been at it, on and (mostly) off, for a year or two.  It&#39;s entertaining."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568223028, "post_id": 57893800, "comment_id": 102209660, "body": "What I mean by the &#39;split over multiple line&#39; property is that your sample data shows the JSON object with each key and value on its own line.  JSON doesn&#39;t require that; it would be happy with a single line of data for the whole file, with no spaces outside of strings.  If you have a 1 GiB file with zero or one newlines in it, JSON won&#39;t care (it&#39;s probably valid JSON), but the parsing techniques to deal with that are probably different from those you can employ if you know that the data for each element of the object will be on a separate line."}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568223592, "post_id": 57893800, "comment_id": 102209902, "body": "@JonathanLeffler The JSON object has each key and value on its own line indeed. The Json file is automatically generated."}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1568223966, "post_id": 57893800, "comment_id": 102210041, "body": "Are you looking to deal with these structures at runtime, or parse a series of JSON files to produce static C structs, generating the C at compile time? It sounds like the former, and if that is the case, I&#39;d recommend a library such as <a href=\"https://jansson.readthedocs.io/en/latest/tutorial.html\" rel=\"nofollow noreferrer\">jansson</a>"}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1568224056, "post_id": 57893800, "comment_id": 102210080, "body": "I don&#39;t understand your example - why would you want 50 elements in the <code>float set</code> field per item?"}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "reply_to_user": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1568224115, "post_id": 57893800, "comment_id": 102210108, "body": "@Attie I want to deal with these structures at runtime indeed"}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "reply_to_user": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1568224229, "post_id": 57893800, "comment_id": 102210151, "body": "@Attie Ideally i want to set 50 elements in the float set field per item to be as small as possible (but if that is not possible i can be also set as large as required)"}], "answers": [{"comments": [{"owner": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 3, "creation_date": 1568230353, "post_id": 57894864, "comment_id": 102212749, "body": "@ryyker: <a href=\"https://stackoverflow.com/questions/47202557/what-is-a-designated-initializer-in-c\" title=\"what is a designated initializer in c\">stackoverflow.com/questions/47202557/&hellip;</a>"}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1568980281, "post_id": 57894864, "comment_id": 102457877, "body": "@Schwern I receive the error: passing argument 1 of \u2018json_object_unref\u2019 from incompatible pointer type [-Wincompatible-pointer-types]      json_object_unref(root); In file included from /usr/include/json-glib-1.0/json-glib/json-glib.h:29:0,                  from test.c:4: /usr/include/json-glib-1.0/json-glib/json-types.h:314:23: note: expected \u2018JsonObject * {aka struct _JsonObject *}\u2019 but argument is of type \u2018JsonNode * {aka struct _JsonNode *}\u2019 void                  json_object_unref              (JsonObject  *object); ld:demo.json: file format not recognized; treating as linker script"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 1, "creation_date": 1569012861, "post_id": 57894864, "comment_id": 102472019, "body": "@jenniferruurs I goofed twice. The first goof is <code>root</code> is a <code>JsonNode</code> so it should have been <code>json_node_unref</code>, don&#39;t know why <code>json_object_unref</code> worked but it doesn&#39;t anymore. Might be a newer version. The second goof is deallocating the nodes is unnecessary, deallocating the parser also deallocates all the nodes its made. I&#39;ve updated the answer."}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1569046594, "post_id": 57894864, "comment_id": 102476754, "body": "@Schwern Thank you when I enter &#39;gcc -O2 $(pkg-config --cflags glib-2.0 json-glib-1.0) -o test test.c $(pkg-config --libs glib-2.0 json-glib-1.0) demo.json&#39;  /usr/bin/ld:demo.json: file format not recognized; treating as linker script /usr/bin/ld:demo.json:1: syntax error collect2: error: ld returned 1 exit status  And another question: How is it possible to hardcode the location of the file instead of telling the compiler where the file is located?"}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1569082944, "post_id": 57894864, "comment_id": 102484517, "body": "@Schwern the actual error that I receive is:  Segmentation fault (core dumped)"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 1, "creation_date": 1569086370, "post_id": 57894864, "comment_id": 102485318, "body": "@jenniferruurs It looks like you&#39;re trying to compile the JSON file. Instead, compile the program and give it the JSON file. <code>gcc -O2 $(pkg-config --cflags glib-2.0 json-glib-1.0) -o test test.c $(pkg-config --libs glib-2.0 json-glib-1.0)</code> and then <code>.&#47;test demo.json</code>. <a href=\"https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm\" rel=\"nofollow noreferrer\">Passing in arguments is basic C</a>. Unless you&#39;re doing this to learn C, I would suggest using an easier language like Ruby or Python for your JSON handling."}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1569094790, "post_id": 57894864, "comment_id": 102487292, "body": "@Schwern Indeed did tried <code>gcc -O2 $(pkg-config --cflags glib-2.0 json-glib-1.0) -o test test.c $(pkg-config --libs glib-2.0 json-glib-1.0)</code> and then <code>.&#47;test demo.json</code>, the error that I then received is &quot;Segmentation fault (core dumped)&quot; <i>(Segmentation fault is a specific kind of error caused by accessing memory that \u201cdoes not belong to you)</i>"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1569097981, "post_id": 57894864, "comment_id": 102488005, "body": "@jenniferruurs I tracked it down, you can do it too by adding <code>puts</code> statements in the code to narrow down where it&#39;s segfaulting. Or use a tool like <code>valgrind</code>. I could only get it to happen when compiling your way. The problem appears to be <code>if( error )</code> because <code>error</code> is declared but not initialized so <code>if( error )</code> is trying to read some garbage. The code has been updated. PS You&#39;ll want to compile with some warnings on. <code>-Wall -Wshadow -Wwrite-strings -Wextra -Wconversion -std=c11 -pedantic</code> for example."}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1569131838, "post_id": 57894864, "comment_id": 102492282, "body": "@Schwern The error that I receive now is <code>implicit declaration of function \u2018strdup\u2019; did you mean \u2018strcmp\u2019? [-Wimplicit-function-declaration]          .draw_set = strdup(json_object_get_string_member(stuff, &quot;draw_set&quot;)),                      strcmp initialization makes pointer from integer without a cast [-Wint-conversion] (near initialization for \u2018book.draw_set\u2019) initialization makes pointer from integer without a cast [-Wint-conversion]          .wupet = strdup(json_object_get_string_member(stuff, &quot;Wupet&quot;))                   ^~~~~~ (near initialization for \u2018book.wupet\u2019)</code>"}, {"owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 0, "creation_date": 1569132130, "post_id": 57894864, "comment_id": 102492324, "body": "@Schwern how can I prevent it to read gabage and what is going wrong, because I don&#39;t want the code to end up in the if statement at all (meaning that I can not read the json file at all) (Thank you by the way for providing me tips on how to detect errors by the way I am new in C)"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "edited": false, "score": 1, "creation_date": 1569181859, "post_id": 57894864, "comment_id": 102503691, "body": "@jenniferruurs <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/strdup.html\" rel=\"nofollow noreferrer\"><code>strdup</code> is a POSIX function</a>, not strictly in the standard, but very common. <a href=\"https://stackoverflow.com/questions/252782/strdup-what-does-it-do-in-c#252802\">It&#39;s easy enough to write your own</a>. Since we&#39;re using GLib anyway we can use their <a href=\"https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-strdup\" rel=\"nofollow noreferrer\"><code>g_strdup</code></a> instead. As for the error handling, you don&#39;t have a choice. If you&#39;re given invalid JSON which cannot be parsed that has to be handled somehow. And you&#39;re welcome."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 6, "last_activity_date": 1569181753, "last_edit_date": 1569181753, "creation_date": 1568226372, "answer_id": 57894864, "question_id": 57893800, "link": "https://stackoverflow.com/questions/57893800/convert-the-input-of-this-json-file-to-a-c-struct/57894864#57894864", "title": "convert the input of this Json file to a C struct", "body": "<blockquote>\n  <p>The attribute types of the struct should be automatically detected and created.</p>\n</blockquote>\n\n<p>You can't do it without some wacky macros. The fields of a structs in C are fixed at compile time.</p>\n\n<p>Automatically populating your struct would require being able to figure out the fields and types of your struct: <a href=\"https://en.wikipedia.org/wiki/Reflection_(computer_programming)\" rel=\"nofollow noreferrer\">reflection</a>. C does not have reflection. You could write up some clever macros, but it's probably not worth it for something this simple.</p>\n\n<p>Automatically adding fields to your struct based on the JSON is also impossible without some wacky macros.</p>\n\n<p>Instead, we'll parse the JSON into a flexible data structure and you can do whatever you like with that. If you want to put them all into a struct, that struct would have to contain all possible fields. There are <a href=\"https://stackoverflow.com/questions/7370533/can-i-extend-a-struct-in-c#14523823\">techniques to write extend structs</a> so you can have a basic <code>Book</code> and then additional extended structs for different types of books.</p>\n\n<p><a href=\"https://developer.gnome.org/json-glib/stable/\" rel=\"nofollow noreferrer\">JSON-Glib</a> provides both. It parses the JSON into JsonNodes which can be JsonArrays or JsonObjects. Then you can do whatever you want with them.</p>\n\n<hr>\n\n<p>Before we do that, the struct needs some work.</p>\n\n<pre><code>struct Books {\n    gint64      set;\n    gint64      low;\n    const char  *draw_set;\n    const char  *wupet;\n};\n</code></pre>\n\n<p><code>set</code> is not a float, but an integer.</p>\n\n<p>We're using the GLib types to match what the GLib library returns and to avoid overflow with large numbers.</p>\n\n<p>Fixed sized buffers should be avoided when reading input, they can easily overflow. Instead JSON-Glib can allocate the correct amount of memory. We'll duplicate that and store a pointer to it.</p>\n\n<hr>\n\n<p>Here's an example of parsing your JSON file using JSON-Glib and manually populating your struct.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;glib-object.h&gt;\n#include &lt;json-glib/json-glib.h&gt;\n\nstruct Books {\n    gint64      set;\n    gint64      low;\n    char        *draw_set;\n    char        *wupet;\n};\n\nint main(int argc, char** argv) {\n    GError *error = NULL;\n\n    if (argc &lt; 2) {\n        printf(\"Usage: test &lt;filename.json&gt;\\n\");\n        return EXIT_FAILURE;\n    }\n\n    // Parse the JSON from the file\n    JsonParser *parser = json_parser_new();\n    json_parser_load_from_file(parser, argv[1], &amp;error);\n    if(error) {\n        printf(\"Unable to parse `%s': %s\\n\", argv[1], error-&gt;message);\n        g_error_free(error);\n        g_object_unref(parser);\n        return EXIT_FAILURE;\n    }\n\n    // Get the root\n    JsonNode *root = json_parser_get_root(parser);\n\n    // Turn the root into a JSON object\n    JsonObject *stuff = json_node_get_object(root);\n\n    // Get each object member and assign it to the struct.\n    struct Books book = {\n        .set = json_object_get_int_member(stuff, \"set\"),\n        .low = json_object_get_int_member(stuff, \"low\"),\n        // Duplicate the strings to avoid pointing to memory inside the parser.\n        .draw_set = g_strdup(json_object_get_string_member(stuff, \"draw_set\")),\n        .wupet = g_strdup(json_object_get_string_member(stuff, \"Wupet\"))\n    };\n\n    printf(\n        \"set = %ld, low = %ld, draw_set = '%s', wupet = '%s'\\n\",\n        book.set, book.low, book.draw_set, book.wupet\n    );\n\n    // We're finished working with the parser. Deallocate the\n    // parser and all the memory it has allocated, including\n    // the nodes.\n    g_object_unref(parser);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 174, "user_id": 8593764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1378186947f4e22235b36927738e8e?s=128&d=identicon&r=PG&f=1", "display_name": "jennifer ruurs", "link": "https://stackoverflow.com/users/8593764/jennifer-ruurs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3488, "favorite_count": 0, "accepted_answer_id": 57894864, "answer_count": 1, "score": 0, "last_activity_date": 1569181753, "creation_date": 1568221408, "last_edit_date": 1568224149, "question_id": 57893800, "link": "https://stackoverflow.com/questions/57893800/convert-the-input-of-this-json-file-to-a-c-struct", "title": "convert the input of this Json file to a C struct", "body": "<p>I have a Json file named name.json\nAn example of such a Json file can be seen bellow</p>\n\n<pre><code>{\n  \"set\": 5,\n  \"low\": 0,\n  \"draw_set\": \"0.1 up to 0.3\",\n  \"Wupet\": \"Hold\",\n  \"\": null\n}\n</code></pre>\n\n<p>But it can be also the case that another time the Json file has another structure.</p>\n\n<pre><code>{\n  \"set\": 5,\n  \"low\": 0,\n  \"draw_set\": \"0.1 up to 0.3\",\n  \"W_set\": \"Ramp 1.5 \u221eC/min\",\n  \"Wset\": 0,\n  \"Wupet\": \"Hold\",\n  \"\": null\n}\n</code></pre>\n\n<p>I want to convert the input of this Json file (the attributes and their types can be different in each file) to a C struct where the structs automatically detects which attributes (and their types) there are in the Json file.\nThe attribute \"\" in   \"\": null (can be given a random attribute name)</p>\n\n<p>Then I want to automatically assign the values of Json value to the struct of object Book1.</p>\n\n<p>Plan of my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Books {\n   float  set[50];\n   int  low[50];\n   char  draw_set[100];\n   char  Wupet[100];\n};\n\nint main( ) {\n    /* Read name.Json file */\n\n\n   struct Books Book1;        /* Declare Book1 of type Book */\n   /* Convert content Json to Struct Book1 with it's actual values*/\n\n   return 0;\n}\n</code></pre>\n\n<p>Edit:\nI don't want to ignore \"Wset\" and \"W_set\" keys if they exist in the Json file. The keys of the Json files are changing everything time (there are many unknown attributes that can occur in the future). The number of keys is not guarantee. The 'split over multiple lines' property is guaranteed? The null key name should be given a random name (multiple keys can occurs with like the null key name) The attribute types of the struct should be automatically detected and created. The Json file contains a single record (object)</p>\n\n<p>I want to deal with these structures at runtime.</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568221553, "post_id": 57893761, "comment_id": 102209049, "body": "Negative value where?"}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568223333, "post_id": 57893761, "comment_id": 102209789, "body": "@EugeneSh. The <code>printf(&quot;All points: %lld\\n&quot;, all_point);</code> print a negative value"}], "answers": [{"comments": [{"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1568224889, "post_id": 57894107, "comment_id": 102210398, "body": "Oops! The type it is my mistake of carelessness. Thanks because now does not go into overflow. In your opinion, why the code is so slowly? With the same input, with <code>OpenMP</code> it takes ~10sec."}, {"owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "reply_to_user": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1568225123, "post_id": 57894107, "comment_id": 102210494, "body": "I can only guess. How many MPI processes do you launch? It should ideally be your number of processor cores. Do you use the same total number of points both with MPI and OpenMP? Is the rest of the code identical? Do you use the same optimization level in your compiler?"}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1568228576, "post_id": 57894107, "comment_id": 102211985, "body": "20 MPI processes. Nope, I use the flag <code>--oversubribe</code>. Yes, 20 processes also for MPI. The core of the code is the same. What kind of optimizations do you mean?"}, {"owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "reply_to_user": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1568266057, "post_id": 57894107, "comment_id": 102220994, "body": "OpenMP uses only one thread per core by default. If you oversubscribe your cores, the scheduler has to switch between the processes all the time, which a) can introduce a big overhead and b) still only gives you a maximum speedup of the number of cores. Basically, if you want good parallel performance, don&#39;t oversubscribe or make sure that the parallel processes on a single core don&#39;t compete for compute time. By optimization I mean the flags <code>-O3</code> or similar."}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1568292320, "post_id": 57894107, "comment_id": 102233933, "body": "If I run MPI with the <code>-np 20</code> flag, to compare it with the program written in OpenMP, on how many threads should I run the latter? Now, when I declare the parallel region, I set <code>num_threads(20)</code>"}, {"owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "reply_to_user": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1568297229, "post_id": 57894107, "comment_id": 102236893, "body": "Performance-wise, it doesn&#39;t make much sense to run a parallel program with more threads than available cores (unless they spend most of the time waiting, but that&#39;s not the case here), otherwise you&#39;re mostly benchmarking the quality of your OS&#39;s scheduler, not your code itself. What do you want to achieve? Does your system have 20 cores?"}], "tags": [], "owner": {"reputation": 4933, "user_id": 8217180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621a549160f738b81303a4a008ddd50?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Ribizel", "link": "https://stackoverflow.com/users/8217180/tobias-ribizel"}, "is_accepted": true, "score": 2, "last_activity_date": 1568223330, "last_edit_date": 1568223330, "creation_date": 1568222853, "answer_id": 57894107, "question_id": 57893761, "link": "https://stackoverflow.com/questions/57893761/optimize-mpi-code-for-any-big-integer-number/57894107#57894107", "title": "Optimize MPI code for any big integer number", "body": "<p>That's actually a much more interesting question than you might imagine. Your results are the combination of two issues: Overflow and a type confusion.</p>\n\n<p>First the overflow part:\nNumbers larger than 2147483647 can't be represented using signed 32 bit integers, which is the default size of an <code>int</code> in many C++ compilers as well as what MPI uses for the internal representation of an <code>MPI_INT</code>. So as soon as you have more than a 2-3 MPI ranks, the partial counts in the magnitude of <code>1000000000 * pi / 4</code> can still be represented as an <code>int</code>, but their sum can't - the result overflows and becomes a negative number. The same holds for the line </p>\n\n<pre><code>1000000000 * size\n</code></pre>\n\n<p>Without any suffix, both size and 1000000000 are of type <code>int</code>, so is their product. This computation will thus overflow, and only then will the result be stored in the larger <code>long long int all_points</code> variable.\nSimple fix: Replace the computation by </p>\n\n<pre><code>1000000000LL * size\n</code></pre>\n\n<p>This forces the first integer to be of type <code>long long int</code>, so the whole computation won't overflow.</p>\n\n<p>But your code has a second, more serious issue: Type confusion.</p>\n\n<p><a href=\"https://www.open-mpi.org/doc/v4.0/man3/MPI_Reduce.3.php\" rel=\"nofollow noreferrer\"><code>MPI_Reduce</code></a> expects a <code>void*</code> value for both its send and receive buffer, which means that you can use any pointer as a parameter. The type confusion now is that <code>MPI_Reduce</code> expects you to pass a pointer to an <code>int</code>, because you passed <code>MPI_INT</code> as the type argument. But the pointer you passed points to a <code>long long int</code>. What you would need to use instead is <code>MPI_LONG_LONG_INT</code>, which corresponds to the <code>long long int</code> type.</p>\n\n<p>If you want to know why your code still worked for smaller iteration counts, you can read up on the binary representation of integers, especially Little/Big Endian.</p>\n"}], "owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 57894107, "answer_count": 1, "score": 1, "last_activity_date": 1568223330, "creation_date": 1568221219, "question_id": 57893761, "link": "https://stackoverflow.com/questions/57893761/optimize-mpi-code-for-any-big-integer-number", "title": "Optimize MPI code for any big integer number", "body": "<p>I'm trying to compute an estimation of pi using Monte Carlo methods.\nThe method that I used is that of the circumference inscribed into a square.</p>\n\n<p>This is my simple code for the solution of the problem:</p>\n\n<pre><code>#define _XOPEN_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;mpi.h&gt;\n\n#define SEED time(NULL)\n\nvoid pi_mpi_version(void) {\n\n  unsigned int seed;\n  long long int all_point;\n  double x, y, start, end;\n  int rank, size;\n  long long int i, points = 0, all_intern;\n\n  MPI_Init(NULL, NULL);\n  start = MPI_Wtime();\n\n  MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n  MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n  seed = SEED + rank;\n\n  for ( i = 0; i &lt; 1000000000; i++ ) {\n    x = (double) rand_r(&amp;seed) / RAND_MAX;\n    y = (double) rand_r(&amp;seed) / RAND_MAX;\n\n    if ( x * x + y * y &lt;= 1.0 ) points++;\n  }\n\n  MPI_Reduce(&amp;points, &amp;all_intern, 1, MPI_INT, MPI_SUM, 0, MPI_COMM_WORLD);\n  all_point = 1000000000 * size;\n\n  MPI_Barrier(MPI_COMM_WORLD);\n  end = MPI_Wtime();\n\n  if ( rank == 0 ) {\n    printf(\"All intern: %lld\\n\", all_intern);\n    printf(\"All points: %lld\\n\", all_point);\n    printf(\"\\u03C0 \\u2248 %Lf\\n\", (long double) all_intern / all_point * 4.0);\n    printf(\"Time elapsed: %.4f\\n\", end - start);\n  }\n\n  MPI_Finalize();\n}\n</code></pre>\n\n<p>I try to set all varible to <code>long long int</code> but with the input <code>1000000000</code> like in the code, that return a negative number. With input up to <code>100000000</code> it seems to work.</p>\n"}, {"tags": ["c", "erlang", "elixir", "erl-interface"], "comments": [{"owner": {"reputation": 36762, "user_id": 113848, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e3d4212415bc280a21ad85d8022791fe?s=128&d=identicon&r=PG", "display_name": "legoscia", "link": "https://stackoverflow.com/users/113848/legoscia"}, "edited": false, "score": 1, "creation_date": 1568220228, "post_id": 57893503, "comment_id": 102208469, "body": "Send a message of the form <code>{&#39;$gen_call&#39;, {Sender, Tag}, {dothing, &quot;blah&quot;}}</code>, where <code>Sender</code> is the pid of the process that should receive the response (not sure how that works with the C interface) and <code>Tag</code> is a newly generated reference."}], "answers": [{"tags": [], "owner": {"reputation": 20407, "user_id": 1017941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/yocPw.jpg?s=128&g=1", "display_name": "Hauleth", "link": "https://stackoverflow.com/users/1017941/hauleth"}, "is_accepted": false, "score": 3, "last_activity_date": 1568841854, "last_edit_date": 1568841854, "creation_date": 1568225408, "answer_id": 57894640, "question_id": 57893503, "link": "https://stackoverflow.com/questions/57893503/send-message-to-genserver-from-c/57894640#57894640", "title": "Send message to GenServer from C", "body": "<p>You cannot do <code>GenServer.call/2</code> in C Node. At least not directly, due to fact that this is not public API how the messages in that case look like (not that it changes a lot, but you cannot rely on that). Instead what you can do is that you send regular message and handle that within <code>handle_info</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8295, "user_id": 390977, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b6fef298459ad9a3b1d7dc6319246331?s=128&d=identicon&r=PG", "display_name": "Ian Hunter", "link": "https://stackoverflow.com/users/390977/ian-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1568316723, "creation_date": 1568316723, "answer_id": 57913413, "question_id": 57893503, "link": "https://stackoverflow.com/questions/57893503/send-message-to-genserver-from-c/57913413#57913413", "title": "Send message to GenServer from C", "body": "<p>Calling a GenServer with a predetermined name directly from C was, as pointed out, more difficult than expected. What I ended up doing was creating a module function in Elixir that called the GenServer itself and returned the results to the caller. Then I interfaced with this in C using RPC functions.</p>\n\n<pre><code>  ei_x_buff request;                                                               \n  ei_x_new(&amp;request);                                                              \n  ei_x_format_wo_ver(&amp;request, \"[~s]\", \"My Argument\");                                      \n  ei_x_buff response;                                                              \n  ei_x_new(&amp;response);                                                             \n  ei_rpc(&amp;ec, sockfd, \"Elixir.MyModule\", \"dothing\", request.buff, request.index, &amp;response);\n</code></pre>\n\n<p>See <a href=\"http://erlang.org/doc/man/ei_connect.html#ei_rpc\" rel=\"nofollow noreferrer\">http://erlang.org/doc/man/ei_connect.html#ei_rpc</a></p>\n\n<p>Note that <code>ei_rpc</code> doesn't return a \"version magic number\" in its response buffer but <code>ei_rpc_from</code> <em>does</em>.</p>\n"}], "owner": {"reputation": 8295, "user_id": 390977, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b6fef298459ad9a3b1d7dc6319246331?s=128&d=identicon&r=PG", "display_name": "Ian Hunter", "link": "https://stackoverflow.com/users/390977/ian-hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568841854, "creation_date": 1568219975, "question_id": 57893503, "link": "https://stackoverflow.com/questions/57893503/send-message-to-genserver-from-c", "title": "Send message to GenServer from C", "body": "<p>How do I send a message to a remote Elixir GenServer and then receive the results of the call using the <a href=\"http://erlang.org/doc/apps/erl_interface/index.html\" rel=\"nofollow noreferrer\">C Erlang Interface</a>?</p>\n\n<p>I want to run something in C analogous to </p>\n\n<pre><code>{result1, result2} = GenServer.call(MyModule.NodeName, {:dothing, \"blah\"})\n</code></pre>\n\n<p>Here's what I have so far. It compiles and connects to the remote server and runs <code>ei_reg_send</code> without causing an error, but the remote server doesn't receive a response. (I have a logger turned on so I know when the call comes through.)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;erl_interface.h&gt;\n#include &lt;ei.h&gt;\n\n#define COOKIE \"cookieval\"\n#define HOST \"name@host\"\n\nint main() {\n  ei_init();\n  ei_cnode ec;\n  int n = 0;\n  int sockfd;\n  int self;\n  if((self = ei_connect_init(&amp;ec, \"nss\", COOKIE, n++)) &lt; 0) {\n    return 1;\n  }\n  if((sockfd = ei_connect(&amp;ec, HOST)) &lt; 0) {\n    return 2;\n  }\n\n  ei_x_buff request;\n  ei_x_new(&amp;request);\n  ei_x_format(&amp;request, \"{dothing, ~a}\", \"blah\");\n  if(ei_reg_send(&amp;ec, sockfd, \"MyModule.NodeName\", request.buff, request.index) &lt; 0) {\n    return 3;\n  }\n  ei_x_free(&amp;request);\n  // code makes it to here, but there's no indication that the genserver was called\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "crc", "crc16", "psoc"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1568219849, "post_id": 57893261, "comment_id": 102208289, "body": "Which options are you using on the webpage to get correct results? The sunshine webpage explain the options : <a href=\"http://www.sunshine2k.de/articles/coding/crc/understanding_crc.html\" rel=\"nofollow noreferrer\">sunshine2k.de/articles/coding/crc/understanding_crc.html</a>  Not sure why you have the table.  You can either use the table method or no table method."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1568220177, "post_id": 57893261, "comment_id": 102208446, "body": "Which options are you using on the webpage to get correct results? The sunshine webpage explain the options : <a href=\"http://www.sunshine2k.de/articles/coding/crc/understanding_crc.html\" rel=\"nofollow noreferrer\">sunshine2k.de/articles/coding/crc/understanding_crc.html</a>  Not sure why you have the table.  You can either use the table method or no table method.  when you generate the checksum you for 16crc you do the checksum for length x bytes (not include CRC).  Then when you verify you do it for x + 2 (including crc) bytes and will get either all zeroes or all ones (depending on the options)."}], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1568220841, "post_id": 57893451, "comment_id": 102208757, "body": "Are you aware that <code>crc ^= 0x0000;</code> is a no-op? As well as <code>crc &amp;= 0xFFFF;</code> on a uint16"}, {"owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1568221171, "post_id": 57893451, "comment_id": 102208887, "body": "@Ctx Oh hey you&#39;re absolutely right lol.  it didn&#39;t occur to me when the online calcualtor said XorOut = 0x0000 that means just don&#39;t XOR it.  I&#39;ve removed that line entirely as there&#39;s no point to it (and edited the answer to match).    Yeah the mask on crc isn&#39;t needed.  I was also wondering why it was there (maybe whatever it was originally written for &quot;unsigned&quot; is a 32 bit type?).  In any case, you&#39;re right, I don&#39;t need it when I&#39;m working with uint16."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1568234394, "post_id": 57893451, "comment_id": 102214116, "body": "@K_Trenholm - is there a reason that you don&#39;t use a  256 entry lookup table in the C code, which speeds up the code? You could just copy/translate the C# code to C code with only minor changes (the C code doesn&#39;t need to be part of a class)."}, {"owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "reply_to_user": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1568235908, "post_id": 57893451, "comment_id": 102214668, "body": "@rcgldr No specific reason other than the C code that I happened to find for calculating CRC16 didn&#39;t use a table.  I&#39;ll probably go back and make both ends table based before finishing this project."}], "tags": [], "owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "is_accepted": true, "score": 3, "last_activity_date": 1568222049, "last_edit_date": 1568222049, "creation_date": 1568219784, "answer_id": 57893451, "question_id": 57893261, "link": "https://stackoverflow.com/questions/57893261/how-to-calculate-crc16-ccitt-kermit-in-both-c-and-c/57893451#57893451", "title": "How to calculate CRC16-CCITT/KERMIT in both C# and C", "body": "<p>Of course I get it less than 10 minutes after posting the question (isn't that always how it goes?)</p>\n\n<p>The C code I thought was for CRC-16/KERMIT looks to actually be CRC-16/X-25.  I think I got confused because the question I took the code from the answer of was asking about KERMIT, but the answer says it's X-25.</p>\n\n<p>Removing the bitwise invert of crc at the start of the function:</p>\n\n<pre><code>crc = ~crc;\n</code></pre>\n\n<p>AS WELL AS removing</p>\n\n<pre><code>crc ^= 0xFFFF;  \n</code></pre>\n\n<p>This leaves me with:</p>\n\n<pre><code>uint16_t crc16k(uint16_t crc, uint8_t *mem, uint8_t len) {\n    uint8_t *data = mem;\n\n    if (data == NULL){\n        return 0;\n    }\n\n    while (len--) {\n        crc ^= *data++;\n        for (uint8_t k = 0; k &lt; 8; k++)\n            crc = crc &amp; 1 ? (crc &gt;&gt; 1) ^ 0x8408 : crc &gt;&gt; 1;\n    }\n\n    return crc;\n}\n</code></pre>\n\n<p>This seems to be working and the CRC matches up between my Winforms app and the PSoC5.  I suppose the \"near match\" I had earlier was just coincidence the numbers were similar?  I'd love to hear an explanation if someone has one.</p>\n"}], "owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 0, "accepted_answer_id": 57893451, "answer_count": 1, "score": 1, "last_activity_date": 1568222474, "creation_date": 1568218995, "last_edit_date": 1568222474, "question_id": 57893261, "link": "https://stackoverflow.com/questions/57893261/how-to-calculate-crc16-ccitt-kermit-in-both-c-and-c", "title": "How to calculate CRC16-CCITT/KERMIT in both C# and C", "body": "<p>I am working on calculating a CRC16-CCITT/KERMIT so that I can check data integrity on transmissions of 64-byte data packets between a C# Winforms Application and a microcontroller (PSoC5LP/Arm Cortex-M3).  I'm close, but just not quite getting the CRC calculation to line up between the two and having a tough time figuring out why.  The example data packet I am calculating the CRC for is:</p>\n\n<blockquote>\n  <p>02 03 01 02 03 04 05 07 08 09 0A 0B 00 00 06 0E 0C 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p>\n</blockquote>\n\n<p>The CRC for this packet comes out to 0x4D8C in both my Winforms application as well as for this <a href=\"https://crccalc.com/?crc=02%2003%2001%2002%2003%2004%2005%2007%2008%2009%200A%200B%2000%2000%2006%200E%200C%200D%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000%2000&amp;method=crc16&amp;datatype=hex&amp;outtype=hex\" rel=\"nofollow noreferrer\">online CRC calculator</a></p>\n\n<p>Since these line up, I'm assuming the calculation in the C# calculation is legit.  Regardless, here's the code.  Pulled from <a href=\"http://sanity-free.org/147/standard_crc16_and_crc16_kermit_implementation_in_csharp.html\" rel=\"nofollow noreferrer\">this page</a> with the only change being the I hardcoded the polynomial (0x8408):</p>\n\n<pre><code>    public static class Crc16\n{\n    const ushort polynomial = 0x8408;\n    static readonly ushort[] table = new ushort[256];\n\n    public static ushort ComputeChecksum(byte[] bytes)\n    {\n        ushort crc = 0;\n        for (int i = 0; i &lt; bytes.Length; ++i)\n        {\n            byte index = (byte)(crc ^ bytes[i]);\n            crc = (ushort)((crc &gt;&gt; 8) ^ table[index]);\n        }\n        return crc;\n    }\n\n    static Crc16()\n    {\n        ushort value;\n        ushort temp;\n        for (ushort i = 0; i &lt; table.Length; ++i)\n        {\n            value = 0;\n            temp = i;\n            for (byte j = 0; j &lt; 8; ++j)\n            {\n                if (((value ^ temp) &amp; 0x0001) != 0)\n                {\n                    value = (ushort)((value &gt;&gt; 1) ^ polynomial);\n                }\n                else\n                {\n                    value &gt;&gt;= 1;\n                }\n                temp &gt;&gt;= 1;\n            }\n            table[i] = value;\n        }\n    }\n}\n</code></pre>\n\n<p>Now the gotcha is getting a working CRC16-CCITT/KERMIT calculator function for the microcontroller that will generate the same CRC for this packet of data.</p>\n\n<p>Here's what I currently have (pulled from <a href=\"https://stackoverflow.com/questions/41560322/crc-ccitt-kermit-16-in-c-sharp\">this answer</a>):</p>\n\n<pre><code>uint16_t crc16k(uint16_t crc, uint8_t *mem, uint8_t len) {\n    uint8_t *data = mem;\n\n    if (data == NULL){\n        return 0;\n    }\n\n    crc = ~crc;\n    crc &amp;= 0xffff;\n\n    while (len--) {\n        crc ^= *data++;\n        for (uint8_t k = 0; k &lt; 8; k++)\n            crc = crc &amp; 1 ? (crc &gt;&gt; 1) ^ 0x8408 : crc &gt;&gt; 1;\n    }\n\n    crc ^= 0xFFFF;\n    return crc;\n}\n</code></pre>\n\n<p>I am calling this as such:</p>\n\n<pre><code>uint16_t crc_calc = crc16k(0x0000, message_in, 64);\n</code></pre>\n\n<p>Here's where I'm getting some funnies. that data packet is 64-bytes, but in actuality (for this packet), only the first 29 bytes are data I am using.  The rest is just padding out to meet 64 bytes.  When I calculate the CRC on the WinForms side, it looks like it is using all 64 bytes, including the padding.  When I do the same on the microcontroller side, I get a result of 0xE918.  What's weird is if I limit the length parameter to just the 29 bytes I'm interested in, I get 0x4C8B, which is perilously close to the 0x4D8C I'm looking for.  I also noticed that in the online calculator I used, it claims the XOR on the output should be 0x0000.  The C function I am using XORs 0xFFFF on the output.  Changing this to 0x0000 (and processing all 64 bytes) gives me 0x16E7.</p>\n\n<p>So I'm not sure where the problem lies.  This is the first time I've worked with a CRC so I could be missing something obvious.  Any ideas?</p>\n\n<p>Thank you in advance for the help!  Let me know if there's any additional information I should provide.</p>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 511, "user_id": 10340130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd380558f8a71a63a89ae9e37195019c?s=128&d=identicon&r=PG", "display_name": "njras", "link": "https://stackoverflow.com/users/10340130/njras"}, "edited": false, "score": 0, "creation_date": 1568216587, "post_id": 57892544, "comment_id": 102206701, "body": "From one operation, do you mean can be written in one statement? Aren&#39;t right shift, left shift and then ORing three operations in total?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1568216592, "post_id": 57892544, "comment_id": 102206703, "body": "Not sure how your &#39;working&#39; example conforms to the single operation requirement."}, {"owner": {"reputation": 5586, "user_id": 7267640, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oBhYX.jpg?s=128&g=1", "display_name": "Luuk Wuijster", "link": "https://stackoverflow.com/users/7267640/luuk-wuijster"}, "edited": false, "score": 0, "creation_date": 1568216625, "post_id": 57892544, "comment_id": 102206722, "body": "I&#39;m sorry, yes, one statement. Will change it in the question."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568216850, "post_id": 57892544, "comment_id": 102206833, "body": "<code>It would only work with an uint8_t</code> no, why?"}, {"owner": {"reputation": 5586, "user_id": 7267640, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oBhYX.jpg?s=128&g=1", "display_name": "Luuk Wuijster", "link": "https://stackoverflow.com/users/7267640/luuk-wuijster"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568217155, "post_id": 57892544, "comment_id": 102206972, "body": "@KamilCuk Well, now I think about it... I asked my teacher first and that&#39;s what he told me..."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1568216847, "creation_date": 1568216847, "answer_id": 57892706, "question_id": 57892544, "link": "https://stackoverflow.com/questions/57892544/bit-manipulation-only-change-last-4-bits/57892706#57892706", "title": "bit manipulation - only change last 4 bits", "body": "<p>You\u2019ll first want to AND the destination number with a mask that has all but 4 lowest bits set, then OR that with the lowest 4 bits of the first number.</p>\n\n<pre><code>PORTC = (PORTC &amp; ~0xfULL) | ( count &amp; 0xf );\n</code></pre>\n"}], "owner": {"reputation": 5586, "user_id": 7267640, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oBhYX.jpg?s=128&g=1", "display_name": "Luuk Wuijster", "link": "https://stackoverflow.com/users/7267640/luuk-wuijster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57892706, "answer_count": 1, "score": 2, "last_activity_date": 1568216847, "creation_date": 1568216277, "last_edit_date": 1568216652, "question_id": 57892544, "link": "https://stackoverflow.com/questions/57892544/bit-manipulation-only-change-last-4-bits", "title": "bit manipulation - only change last 4 bits", "body": "<p>I want to set the last 4 bits of an int to another int.</p>\n\n<p>So for example you have this int: <code>1100 0001</code>. And I only want to change the last four bits with another int for example: <code>0000 0110</code>. All the other bits should remain unchanged and it has to be in one statement (I'm sorry for my horrible explanation).</p>\n\n<p>The folowing statement does work, but it seems bad practice and It would only work with an <code>uint8_t</code></p>\n\n<pre><code>unint8_t count = 6; //0000 0110\nPORTC = ((PORTC &gt;&gt; 4) &lt;&lt; 4) | count; //PORTC = 1100\n</code></pre>\n\n<p>The outcome of PORTC is <code>1100 0110</code> and this is what I want, however I want it to work with any integer. What is another (better) way of doing this?</p>\n\n<p>NOTE: It <strong>must</strong> be one statement.</p>\n"}, {"tags": ["c", "gcc", "macos-mojave"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1568217956, "post_id": 57892462, "comment_id": 102207394, "body": "It has nothing to do with the C code. It must be related to the time it takes for your OS to load and start the program. I don&#39;t think this question belongs on stackoverflow. Maybe <a href=\"https://serverfault.com/\">serverfault.com</a> could be a better place but I&#39;m not sure"}], "owner": {"reputation": 848, "user_id": 1591136, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f79ff3bd1c9def9791dc073d2533c0ec?s=128&d=identicon&r=PG", "display_name": "RonPringadi", "link": "https://stackoverflow.com/users/1591136/ronpringadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1568215950, "creation_date": 1568215950, "question_id": 57892462, "link": "https://stackoverflow.com/questions/57892462/c-program-slow-start-in-macos", "title": "C Program Slow Start in MacOS", "body": "<p>I'm following a tutorial in c programming, a very simple c file <code>hello.c</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int num;\n    printf(\"Hello world! Give me an integer:\\n\");\n    scanf(\"%d\", &amp;num);\n    printf(\"Thanks! I've always been fond of %d.\\n\", num);\n    return 0;\n}\n</code></pre>\n\n<p>Source from: <a href=\"https://www.cs.princeton.edu/courses/archive/fall02/cos126/assignments/hello-osx.html\" rel=\"nofollow noreferrer\">https://www.cs.princeton.edu/courses/archive/fall02/cos126/assignments/hello-osx.html</a></p>\n\n<p>Then compile and run it in using <code>gcc hello.c</code> then <code>./a.out</code>\nThere seem to be a pause before I see <code>Hello world! Give me an integer:</code> from the time of <code>./a.out</code> and hit return.</p>\n\n<p>Why is that so? And how to improve this startup?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568215094, "post_id": 57892195, "comment_id": 102205834, "body": "I suggest you to read the <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">tutorial</a>. It contains invaluable advice on how to solve this problem."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568215513, "post_id": 57892195, "comment_id": 102206074, "body": "Why do you have <code>a[i][j]= 8;</code>? There&#39;s nothing in the problem about printing 8."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568215601, "post_id": 57892195, "comment_id": 102206136, "body": "@Mohammed Abdurrasheed To output the pattern an array is not required."}, {"owner": {"reputation": 3, "user_id": 11636151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UWE6dme-CIo/AAAAAAAAAAI/AAAAAAAAAAc/MC2nOFx-_ac/photo.jpg?sz=128", "display_name": "Mohammed Abdurrasheed", "link": "https://stackoverflow.com/users/11636151/mohammed-abdurrasheed"}, "edited": false, "score": 0, "creation_date": 1568215936, "post_id": 57892195, "comment_id": 102206329, "body": "it is to avoid garbage values however the that doesnt effect the actual code the value 8 should change later"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1568220897, "post_id": 57892195, "comment_id": 102208775, "body": "In your post I see a problem statement without an actual problem stated.  I see an approach that results in an ordered list, So, what exactly is the problem with the approach you are using.  i.e. is the output you are displaying not correct?  Where in your code do you think the problem lies?, ... etc.  It would be good to read <i><a href=\"https://stackoverflow.com/tour\">this</a></i>."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 1, "last_activity_date": 1568217078, "last_edit_date": 1568217078, "creation_date": 1568216754, "answer_id": 57892676, "question_id": 57892195, "link": "https://stackoverflow.com/questions/57892195/printing-patterns-using-arrays-in-c/57892676#57892676", "title": "Printing patterns using arrays in c", "body": "<p>Your code is overly complex. You should utilize the symmetry. Replace you while-loop with this code.</p>\n\n<pre><code>// Because of symmetry, both i and j can loop to n instead of 2*n\nfor(i=0; i&lt;n; i++) {\n    p = n;\n    for(j=0; j&lt;n; j++) {\n        // Assign four cells at once due to both horizontal and vertical symmetry\n        a[i][j] = a[i][2*n-j-1] = a[2*n-i-1][j] = a[2*n-i-1][2*n-j-1] = p;\n\n        if(j&lt;i)\n            p--;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11636151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UWE6dme-CIo/AAAAAAAAAAI/AAAAAAAAAAc/MC2nOFx-_ac/photo.jpg?sz=128", "display_name": "Mohammed Abdurrasheed", "link": "https://stackoverflow.com/users/11636151/mohammed-abdurrasheed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 57892676, "answer_count": 1, "score": -2, "last_activity_date": 1568219530, "creation_date": 1568214966, "last_edit_date": 1568219530, "question_id": 57892195, "link": "https://stackoverflow.com/questions/57892195/printing-patterns-using-arrays-in-c", "title": "Printing patterns using arrays in c", "body": "<p>The problem is to print this pattern:</p>\n\n<pre><code>5555555555\n5444444445\n5433333345\n5432222345\n5432112345\n5432112345\n5432222345\n5433333345\n5444444445\n5555555555\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int i,k,j,n,p;\n    printf(\"enter the no  :  \");\n    scanf(\"%d\",&amp;n);\n    p = n;\n    k = 0;\n    int a[2*n][2*n];\n\n    while (p&gt;=1)\n    {\n        for(i=0+k;i&lt;2*n-k;i++)\n        {\n            for(j=0+k;j&lt;2*n-k;j++)\n            {\n                if(i == 2*n-k||i == k||j == k||j == 2*n-k)\n                {\n                    a[i][j]=p;\n                }\n                else\n                {\n                    a[i][j]= 8;\n                }\n            }\n            printf(\"\\n\");\n        }\n        k++,p--;\n    }\n    for(i=0;i&lt;2*n;i++)\n    {\n        for(j=0;j&lt;2*n;j++)\n        {\n            printf(\"%d\",a[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The result I get is:</p>\n\n<pre><code>5555555555\n5444444448 \n5433333388 \n5432222888 \n5432118888 \n5432188888 \n5432888888 \n5438888888 \n5488888888 \n5888888888\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1568214762, "post_id": 57892097, "comment_id": 102205670, "body": "When an array is declared with size <code>[2]</code> the indices are 0 and 1. <code>2</code> is out of bounds."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568214788, "post_id": 57892097, "comment_id": 102205683, "body": "Change all <code>&lt;3</code> to <code>&lt;2</code>, or change the array to <code>a[3][3]</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568215536, "post_id": 57892097, "comment_id": 102206095, "body": "<i>Everyone</i>  learning C makes this bug, so I&#39;d suggest reading the chapter about arrays in your beginner level C programming book. The key is that understanding that declaring array size and performing array access are two different things, the latter using 0-indexing."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4388852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A8TmLwuzE4s/AAAAAAAAAAI/AAAAAAAAAEM/f10xlnU3ejI/photo.jpg?sz=128", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4388852/rafael"}, "is_accepted": false, "score": 0, "last_activity_date": 1568227599, "creation_date": 1568227599, "answer_id": 57895137, "question_id": 57892097, "link": "https://stackoverflow.com/questions/57892097/2d-array-interpretation/57895137#57895137", "title": "2D array interpretation", "body": "<p>I don't know if you actually intended to do this to see what happens, but you created a 2x2 array and then tried to access positions of the type a[2][*] and a[*][2]. Look at the limits in your iterations, for instance \"for(i=0;i&lt; <strong>3</strong> ;i++)\". Trying to access memory outside the bounds of arrays results in <strong>Undefined Behavior</strong>.\n<a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Undefined_behavior</a></p>\n"}], "owner": {"reputation": 9, "user_id": 12053519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ce6545dd0d830c6845afd04e1601f9?s=128&d=identicon&r=PG&f=1", "display_name": "Tezi", "link": "https://stackoverflow.com/users/12053519/tezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568227599, "creation_date": 1568214599, "last_edit_date": 1592644375, "question_id": 57892097, "link": "https://stackoverflow.com/questions/57892097/2d-array-interpretation", "title": "2D array interpretation", "body": "<p>Was trying a piece of code like this below and found that things were not happening the way it was expected to be to store values in the array indices. Please check the code snippet below and the output</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a[2][2];\n    int i,j,count_ld_x=0,count_rd_x=0;\n\n    for(i=0;i&lt;3;i++)\n    {\n        for(j=0;j&lt;3;j++)\n        {\n            printf(&quot;Inputing value for the element:a[%d][%d]&quot;,i,j);\n            scanf(&quot;%d&quot;,&amp;a[i][j]);\n        }\n    }\n\n    for(i=0;i&lt;3;i++)\n    {\n        for(j=0;j&lt;3;j++)\n        {\n            printf(&quot;a[%d][%d]=%d\\n&quot;,i,j,a[i][j]);\n        }\n    }\n}\n</code></pre>\n<p><strong>Input and Output:-</strong></p>\n<blockquote>\n<p>\ueea7 ./main</p>\n<p>Inputing value for the element:a[0][0]0</p>\n<p>Inputing value for the element:a[0][1]1</p>\n<p>Inputing value for the element:a[0][2]2</p>\n<p>Inputing value for the element:a[1][0]3</p>\n<p>Inputing value for the element:a[1][1]4</p>\n<p>Inputing value for the element:a[1][2]5</p>\n<p>Inputing value for the element:a[2][0]6</p>\n<p>Inputing value for the element:a[2][1]7</p>\n<p>Inputing value for the element:a[2][2]8</p>\n<p>a[0][0]=0</p>\n<p>a[0][1]=1</p>\n<p>a[0][2]=3</p>\n<p>a[1][0]=3</p>\n<p>a[1][1]=4</p>\n<p>a[1][2]=6</p>\n<p>a[2][0]=6</p>\n<p>a[2][1]=7</p>\n<p>a[2][2]=8</p>\n</blockquote>\n<p><strong>Confusion:-</strong> Am storing a[0][2] with 2 and the o/p am getting for the same position is 3. Can you please explain what's the issue?</p>\n"}, {"tags": ["c", "loops", "for-loop", "operators", "equality"], "comments": [{"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 2, "creation_date": 1568214215, "post_id": 57891971, "comment_id": 102205348, "body": "This doesn&#39;t look like JavaScript."}, {"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 5, "creation_date": 1568214259, "post_id": 57891971, "comment_id": 102205370, "body": "Your loop says <i>while <code>b</code> <b>equals</b> <code>10</code></i>\u2026"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1568214273, "post_id": 57891971, "comment_id": 102205380, "body": "What&#39;s the value of <code>b</code> on the first iteration through the loop, and does it meet the loop condition?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1568214491, "post_id": 57891971, "comment_id": 102205510, "body": "I suggest you to read the <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">tutorial</a>. It contains invaluable advice on how to solve this problem."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1568221878, "post_id": 57891971, "comment_id": 102209173, "body": "\ud83d\udd0e\ud83d\udc1eDid run your code in a <b>debugger</b>? This will help you step through your code and see what it&#39;s actually doing, which can often diverge wildly from what you think it&#39;s doing."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1568215072, "last_edit_date": 1568215072, "creation_date": 1568214322, "answer_id": 57892022, "question_id": 57891971, "link": "https://stackoverflow.com/questions/57891971/print-the-value-properly-1-to-10/57892022#57892022", "title": "print the value properly 1 to 10", "body": "<p>Since <code>b == 10</code> is <code>0</code> on the first iteration, the loop does not run.</p>\n\n<p>Did you mean <code>b &lt;= 10</code>?</p>\n\n<p>(For the avoidance of doubt, <code>b = ++a</code> sets <code>b</code> and <code>a</code> to <code>1</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 32611, "user_id": 9819146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioXmnWNrB_w/AAAAAAAAAAI/AAAAAAAAADs/Q47JYDWDFyo/photo.jpg?sz=128", "display_name": "Maheer Ali", "link": "https://stackoverflow.com/users/9819146/maheer-ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1568214330, "creation_date": 1568214330, "answer_id": 57892027, "question_id": 57891971, "link": "https://stackoverflow.com/questions/57891971/print-the-value-properly-1-to-10/57892027#57892027", "title": "print the value properly 1 to 10", "body": "<p>The problem is that you loop will run till <code>a</code> will be equal to <code>10</code>. In the start <code>a</code> will be 1. So the loop doesn't start at all. You need to change <code>==</code> with <code>!=</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint  main(){\n    int a=0,b;\n\n    for(b=++a;b != 10; b++/*2*/){\n        printf(\"%d\",b);//1\n    }\n    return 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568221956, "post_id": 57892194, "comment_id": 102209205, "body": "It&#39;s really unclear why <code>a</code> and <code>b</code> are present here when <code>a</code> isn&#39;t really used as anything more than a footstool."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568222049, "post_id": 57892194, "comment_id": 102209241, "body": "@tadman I agree. But it seems he needs to write a loop using increment operators and two variables.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1568223899, "last_edit_date": 1568223899, "creation_date": 1568214964, "answer_id": 57892194, "question_id": 57891971, "link": "https://stackoverflow.com/questions/57891971/print-the-value-properly-1-to-10/57892194#57892194", "title": "print the value properly 1 to 10", "body": "<blockquote>\n  <p>I want to print 1-10 in this method</p>\n</blockquote>\n\n<p>To print numbers from <code>1</code> to <code>10</code> inclusively using a for loop and the number <code>10</code> in the condition of the loop with an equality operator (<code>==</code> or <code>!=</code>) you can write the loop the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint  main( void )\n{\n    int a = 0, b;\n\n    for ( b = a; b++ != 10; )\n    {\n        printf( \"%d\", b );\n    }\n}\n</code></pre>\n\n<p>If you need that after the loop the variable <code>a</code> had the value <code>1</code> then you can write</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint  main( void )\n{\n    int a = 0, b;\n\n    for ( b = a++; b++ != 10; )\n    {\n        printf( \"%d\", b );\n    }\n}\n</code></pre>\n\n<p>Otherwise if after the loop the variables <code>a</code> and <code>b</code> had values <code>1</code> and <code>10</code> you can write</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint  main( void )\n{\n    int a = 0, b;\n\n    for ( b = a++; b != 10; )\n    {\n        printf( \"%d\", ++b );\n    }\n}\n</code></pre>\n\n<p>As for your loop then initially <code>b</code> is set to 1.</p>\n\n<pre><code>b=++a;\n</code></pre>\n\n<p>So it never can be equal to 10 after its initialization. </p>\n\n<pre><code>b == 10\n</code></pre>\n\n<p>That is the loop will not be executed.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 10554956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab97426b3c379f010d9de26b83e59508?s=128&d=identicon&r=PG&f=1", "display_name": "youpen", "link": "https://stackoverflow.com/users/10554956/youpen"}, "is_accepted": false, "score": -1, "last_activity_date": 1568215976, "last_edit_date": 1568215976, "creation_date": 1568215185, "answer_id": 57892264, "question_id": 57891971, "link": "https://stackoverflow.com/questions/57891971/print-the-value-properly-1-to-10/57892264#57892264", "title": "print the value properly 1 to 10", "body": "<p>Try this</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint  main(){\n    int a=1;\n\n    for( ; a&lt;=10 ; a++){\n        printf(\"%d\",a);\n    }\n    return 1;\n}\n</code></pre>\n\n<p>Why your output is blank is you don't execute the loop. <code>b=++a</code>  which means <code>b=1</code>, but the condition is <code>b==10 //</code> which means when <code>b=10</code>, do the loop, so your code just jump the print function, that's way you got the blank.</p>\n"}, {"tags": [], "owner": {"reputation": 436, "user_id": 9051293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88ae8d26aa1f2c5f33c305c0f4a8c48?s=128&d=identicon&r=PG&f=1", "display_name": "DevesH", "link": "https://stackoverflow.com/users/9051293/devesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1568221761, "creation_date": 1568221761, "answer_id": 57893878, "question_id": 57891971, "link": "https://stackoverflow.com/questions/57891971/print-the-value-properly-1-to-10/57893878#57893878", "title": "print the value properly 1 to 10", "body": "<p>In this line of code</p>\n\n<p><code>for(b = ++a; b == 10; b++/*2*/)</code></p>\n\n<p>In first iteration loop breaks because -</p>\n\n<p>1) Initially a becomes 1 before its assignment to b. (i.e b = 1)</p>\n\n<p>2) In first iteration -</p>\n\n<pre><code> b = 1 as (++a equal to 1) \n\n b doesn't satisfy (b == 10) condition so it ends the loop.\n</code></pre>\n\n<p>Here is working code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint  main() {\n    int a = 0, b;\n    for(b = ++a; b &lt;= 10; b++){\n        printf(\"%d\\n\",b);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6018122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AQizx.jpg?s=128&g=1", "display_name": "sunil kumar", "link": "https://stackoverflow.com/users/6018122/sunil-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 5, "score": -3, "last_activity_date": 1568223899, "creation_date": 1568214178, "last_edit_date": 1568215201, "question_id": 57891971, "link": "https://stackoverflow.com/questions/57891971/print-the-value-properly-1-to-10", "title": "print the value properly 1 to 10", "body": "<p>when i execute this problem, output is blank, why, please explain properly</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint  main(){\n    int a=0,b;\n\n    for(b=++a;b == 10; b++/*2*/){\n        printf(\"%d\",b);//1\n    }\n    return 1;\n}\n</code></pre>\n\n<p>I want to print 1-10 in this method</p>\n"}, {"tags": ["c", "list", "singly-linked-list", "c-strings"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1568213508, "post_id": 57891697, "comment_id": 102204940, "body": "Please fix code formatting by editing your post. This code isn&#39;t readable."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568214331, "post_id": 57891697, "comment_id": 102205412, "body": "the posted code fails to compile!   amongst (many) other problems, it is missing the statement: <code>#include &lt;stdlib.h&gt;</code>  for such things as the prototype for <code>malloc()</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568214449, "post_id": 57891697, "comment_id": 102205484, "body": "strongly suggest replacing this statement: <code>typedef enum { FALSE = 0, TRUE } BOOL;</code> with: <code>#include &lt;stdbool.h&gt;</code> (which exposes <code>false</code> <code>true</code> <code>bool</code>, etc)  Note: the exposed items are all lower case"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568214788, "post_id": 57891697, "comment_id": 102205682, "body": "strongly suggest removing all the <code>CrtSetDbgFlag()</code> and related calls"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568214986, "post_id": 57891697, "comment_id": 102205791, "body": "OT: for ease of readability and understanding: 1) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces.  2) separate code blocks: <code>for</code> <code>if</code> <code>else</code> <code>while</code> <code>do...while</code> <code>switch</code> <code>case</code> <code>default</code> via a single blank line.  3) separate functions via 2 or 3 blank lines (be consistent)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568215211, "post_id": 57891697, "comment_id": 102205889, "body": "OT: regarding statements like: <code>scanf(&quot;%s&quot;, fName);</code>  1) always check the returned value (not the parameter value) to assure the operation was successful.  (in this case, any value other than 1 indicates an error)  2) when using the input format conversion specifier &#39;%s&#39; and/or &#39;%[...]&#39;, always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer because those items always append a NUL byte to the input.  This also avoids any possibility of a buffer overflow and the attendant undefined behavior  I.E. <code>if( scanf(&quot;%s&quot;, fName) != 1 ) { &#47;&#47; handle error }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568215399, "post_id": 57891697, "comment_id": 102206001, "body": "OT: regarding: <code>newFrame = malloc(sizeof(struct Frame));</code>  always check (!=NULL) the returned value to assure the operation was successful.  If not successful, call <code>perror( &quot;your error message&quot; )</code> to output both your error message and the text reason the system thinks the error occurred to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568215625, "post_id": 57891697, "comment_id": 102206148, "body": "OT: regarding: <code>char fName[50];</code> This contains a &#39;magic&#39; number.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc.  &#39;magic&#39; numbers are numbers with no basis.  I.E. 50.   Suggest using an <code>enum</code> statement or <code>#define</code> statements to give &#39;magic&#39; numbers meaningful names then using those meaningful names throughout the code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568215800, "post_id": 57891697, "comment_id": 102206235, "body": "The posted code contains several memory leaks from allocating memory via <code>malloc()</code> but never calling <code>free()</code> for each of those allocated memory areas."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568216038, "post_id": 57891697, "comment_id": 102206397, "body": "when compiling, always enable the warnings, then fix any messages from the compiler.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnuu11</code> )  Note: other compilers use different options to produce the same thing"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11639861, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1skrE2KApOc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdq02zCiIyC82M04orTC0y7Es1_sQ/mo/photo.jpg?sz=128", "display_name": "Sun Zhuan", "link": "https://stackoverflow.com/users/11639861/sun-zhuan"}, "edited": false, "score": 0, "creation_date": 1568214262, "post_id": 57891869, "comment_id": 102205373, "body": "That fixed my problem, thanks. But could you please explain a bit more why I should not use malloc here for the parameter? Shouldn&#39;t I allocate the space for the whole &quot;Animation&quot; struct first?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 11, "user_id": 11639861, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1skrE2KApOc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdq02zCiIyC82M04orTC0y7Es1_sQ/mo/photo.jpg?sz=128", "display_name": "Sun Zhuan", "link": "https://stackoverflow.com/users/11639861/sun-zhuan"}, "edited": false, "score": 0, "creation_date": 1568214333, "post_id": 57891869, "comment_id": 102205414, "body": "@SunZhuan The object of the type Animation is already created in main due to the definition Animation RG;. You need only to initialize its data members."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1568214376, "last_edit_date": 1568214376, "creation_date": 1568213853, "answer_id": 57891869, "question_id": 57891697, "link": "https://stackoverflow.com/questions/57891697/exception-thrown-read-access-violation-head-was-0xcccccccc-occurred/57891869#57891869", "title": "Exception thrown: read access violation. **head** was 0xCCCCCCCC. occurred", "body": "<p>At least the function <code>InitAnimation</code> does not make sense</p>\n\n<pre><code>void InitAnimation(Animation* newAnimation) {\nnewAnimation = malloc(sizeof(Animation));\nnewAnimation-&gt;animationName = \"Animation_1\";\nnewAnimation-&gt;frames = NULL;\n }\n</code></pre>\n\n<p>and hence the program in whole is incorrect.</p>\n\n<p>The original object </p>\n\n<pre><code>Animation RG;\n//...\nInitAnimation(&amp;RG);\n</code></pre>\n\n<p>is not initialized. The parameter of the function is just overwritten.</p>\n\n<p>The object of the type <code>Animation</code> is already created in main due to the definition </p>\n\n<pre><code>Animation RG;\n</code></pre>\n\n<p>You need only to initialize its data members.</p>\n\n<p>Remove the statement with the malloc call</p>\n\n<pre><code>void InitAnimation(Animation* newAnimation) {\nnewAnimation-&gt;animationName = \"Animation_1\";\nnewAnimation-&gt;frames = NULL;\n }\n</code></pre>\n\n<p>And in general you should allocate dynamically memory for the string that will be pointed to by the data member <code>animationName</code>.</p>\n\n<p>The function cam look the following way</p>\n\n<pre><code>int InitAnimation( Animation *newAnimation, const char *name ) \n{\n    newAnimation-&gt;animationName = malloc( strlen( name ) + 1 );\n\n    int success = newAnimation-&gt;animationName !+ NULL;\n\n    if ( success )\n    {\n        strcpy( newAnimation-&gt;animationName, name );\n        newAnimation-&gt;frames = NULL;\n    }\n\n    return success;\n}\n</code></pre>\n\n<p>and called like</p>\n\n<pre><code>Animation RG;\n//...\nInitAnimation(&amp;RG, \"Animation_1\" );\n</code></pre>\n\n<p>Pay attention to that you need to include the header <code>&lt;stdlib.h&gt;</code> where the functions <code>malloc</code> and <code>free</code> are declared.</p>\n"}], "owner": {"reputation": 11, "user_id": 11639861, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1skrE2KApOc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdq02zCiIyC82M04orTC0y7Es1_sQ/mo/photo.jpg?sz=128", "display_name": "Sun Zhuan", "link": "https://stackoverflow.com/users/11639861/sun-zhuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 57891869, "answer_count": 1, "score": -2, "last_activity_date": 1568214399, "creation_date": 1568213244, "last_edit_date": 1568214399, "question_id": 57891697, "link": "https://stackoverflow.com/questions/57891697/exception-thrown-read-access-violation-head-was-0xcccccccc-occurred", "title": "Exception thrown: read access violation. **head** was 0xCCCCCCCC. occurred", "body": "<p>I am writing a Linked list in C. This is my code. I cannot really see any logic error here but when printing in while loop, after the last node is printed it does not jump out of the loop but keep looping then give me this error \"Exception thrown: read access violation. <strong>head</strong> was 0xCCCCCCCC. occurred\" on the \"head\" pointer in the loop.</p>\n\n<pre><code>// ass0.c\n#define _CRT_SECURE_NO_WARNINGS\n#define _CRTDBG_MAP_ALLOC // need this to get the line identification\n//_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF|_CRTDBG_LEAK_CHECK_DF); // in main, after local declarations\n//NB must be in debug build\n#include &lt;crtdbg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\ntypedef enum { FALSE = 0, TRUE } BOOL;\nstruct Frame {\nchar* frameName;\nstruct Frame* pNext;\n};\ntypedef struct {\nchar* animationName;\nstruct Frame* frames;\n}Animation;\n// Forward declarations\nvoid InitAnimation(Animation*);\nvoid InsertFrame(Animation*);\n//void DeleteFrame(Animation*);\n//void EditFrame(Animation*);\nvoid ReportAnimation(Animation*);\n//void CleanUp(Animation*);\nint main(void)\n{\nchar response;\nBOOL RUNNING = TRUE;\nAnimation RG;\n_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);\nInitAnimation(&amp;RG);\nwhile (RUNNING)\n{\n    printf(\"MENU\\n 1. Insert a Frame at the front\\n 2. Delete last Frame\\n 3. Edit a Frame\\n 4. Report the Animation\\n 5. Quit\\n\");\n    scanf(\"%c\", &amp;response);\n    switch (response)\n    {\n    case '1':InsertFrame(&amp;RG); break;\n    //case '2':DeleteFrame(&amp;RG); break;\n    //case '3':EditFrame(&amp;RG); break;\n    case '4':ReportAnimation(&amp;RG); break;\n    //case '5':RUNNING = FALSE; CleanUp(&amp;RG); break;\n    default:printf(\"Please enter a valid option\\n\");\n    }\n}\nreturn 0;\n  }\n\n  void InitAnimation(Animation* newAnimation) {\nnewAnimation = malloc(sizeof(Animation));\nnewAnimation-&gt;animationName = \"Animation_1\";\nnewAnimation-&gt;frames = NULL;\n }\n\n void InsertFrame(Animation* animation) {\nprintf(\"Insert a Frame in the Animation\\n\");\nchar fName[50];\nprintf(\"Please enter the Frame Name: \");\nscanf(\"%s\", fName);\n\nstruct Frame *newFrame; \nnewFrame = malloc(sizeof(struct Frame));\nint nameSize = strlen(fName);\nnewFrame-&gt;frameName = malloc(nameSize + 1);\nstrcpy(newFrame-&gt;frameName, fName);\nnewFrame-&gt;pNext = 0;\n\n//struct Frame* head;\n\nif (animation-&gt;frames == NULL) \n    animation-&gt;frames = newFrame;\n    //head = animation-&gt;frames;\n    //head-&gt;pNext = NULL;\n    //head = animation-&gt;frames;\n\n\nelse {\n    //head = animation-&gt;frames;\n    newFrame-&gt;pNext = animation-&gt;frames;\n    animation-&gt;frames = newFrame;\n\n    /*while (head != NULL) {\n        newFrame-&gt;pNext = *head;\n        animation-&gt;frames = newFrame;\n        printf(\"%s\", *head-&gt;frameName);\n        head = head-&gt;pNext;\n    }*/\n\n    //head = animation-&gt;frames;\n    printf(\"\\n\");\n}\n}\n\nvoid ReportAnimation(Animation* animation) {\nprintf(\"Animation name is Animation_1\\n\");\nprintf(\"Report the Animation\\n\");\nstruct Frame* head = animation-&gt;frames;\n//printf(\"%s\\n\", head-&gt;frameName);\n\nwhile (head) {\n    printf(\"%s\\n\", head-&gt;frameName);\n    head = head-&gt;pNext;\n}\n//printf(\"%d\", count);\n  }\n</code></pre>\n"}, {"tags": ["c", "hex", "byte", "endianness"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1568212907, "post_id": 57891163, "comment_id": 102204605, "body": "&quot;I was expecting that the first printf would have printed 0xFE FF&quot; It does, so what&#39;s the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 11896672, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2a3e41c439fcd45a9dd510cfe3da5c7?s=128&d=identicon&r=PG", "display_name": "TeaRex", "link": "https://stackoverflow.com/users/11896672/tearex"}, "is_accepted": true, "score": 3, "last_activity_date": 1568213383, "last_edit_date": 1568213383, "creation_date": 1568212220, "answer_id": 57891426, "question_id": 57891163, "link": "https://stackoverflow.com/questions/57891163/problems-with-endianness-and-bit-shift/57891426#57891426", "title": "Problems with endianness and bit shift", "body": "<p>In this answer I will assume that:</p>\n\n<ol>\n<li>The comments in your code are correct and describe what actually happens, not what you want to happen.</li>\n<li>Thus your question refers to the second pair of printf's.</li>\n<li>You are running on an Intel-based Mac (which is little-endian indeed).</li>\n</ol>\n\n<p>The result of C's bit-shifting operators is independent of endianness. If <code>x</code> is an <code>uint16_t</code>, <code>x&gt;&gt;8</code> will always return the high byte of <code>x</code>, regardless of whether that byte is stored in the first or in the second byte of <code>x</code>'s memory representation.</p>\n"}], "owner": {"reputation": 97, "user_id": 4269221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0d19865d68443f65ce35606f84d9ac?s=128&d=identicon&r=PG&f=1", "display_name": "Duccio Bertieri", "link": "https://stackoverflow.com/users/4269221/duccio-bertieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57891426, "answer_count": 1, "score": 1, "last_activity_date": 1568213383, "creation_date": 1568211380, "question_id": 57891163, "link": "https://stackoverflow.com/questions/57891163/problems-with-endianness-and-bit-shift", "title": "Problems with endianness and bit shift", "body": "<p>I'm doing some experiments with C on a Mac (that should be a little endian architecture), and i've noted a strange fact trying to print the lower and upper bytes of an uint16_t variable. </p>\n\n<p>using the value 65534 (0xFFFE in hex, big endian), with the code below, I was expecting that the first printf would have printed \n0xFE FF, while the second 0XFF FE. \nThe result is instead the opposite, why?</p>\n\n<pre><code>int main(){\n\n    uint16_t x=65534;\n    uint16_t y=htons(x);\n\n    printf(\"%02x %02x\\n\",((uint8_t*)&amp;x)[0],((uint8_t*)&amp;x)[1]); //prints fe ff\n    printf(\"%02x %02x\\n\\n\",((uint8_t*)&amp;y)[0],((uint8_t*)&amp;y)[1]); // prints ff fe\n\n\n    printf(\"%02x %02x\\n\",x&gt;&gt;8,(uint8_t)x);//prints ff fe\n    printf(\"%02x %02x\\n\",y&gt;&gt;8,(uint8_t)y);//prints fe ff\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568211581, "post_id": 57891155, "comment_id": 102203803, "body": "Use a character literalif (brick == &#39;s&#39;){ instead of the string literal."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568212595, "post_id": 57891155, "comment_id": 102204423, "body": "Make sure to compile with all warnings enabled, then pay attention to the warnings."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12053459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab214c29ad4fb811420e84b39273774?s=128&d=identicon&r=PG&f=1", "display_name": "dpalacios", "link": "https://stackoverflow.com/users/12053459/dpalacios"}, "edited": false, "score": 0, "creation_date": 1568212716, "post_id": 57891258, "comment_id": 102204495, "body": "Great. Thank you!"}], "tags": [], "owner": {"reputation": 26, "user_id": 11888965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e72a65a212ad8bad0547b4bf1c399453?s=128&d=identicon&r=PG&f=1", "display_name": "Girocired", "link": "https://stackoverflow.com/users/11888965/girocired"}, "is_accepted": true, "score": 1, "last_activity_date": 1568212314, "last_edit_date": 1568212314, "creation_date": 1568211646, "answer_id": 57891258, "question_id": 57891155, "link": "https://stackoverflow.com/questions/57891155/not-able-to-retrieve-or-store-2d-array-positions-in-if-statement/57891258#57891258", "title": "Not able to retrieve or store 2d array positions in If statement", "body": "<p>I am not sure how the compiler didn't return an error, but try putting single quotes in if statement:</p>\n\n<p>Use <code>if (brick == 's'){</code>\nInstead of\n<code>if (brick == \"s\"){</code></p>\n\n<p>Double quotes are strings, so here you are comparing pointer to \"s\" with character on that is saved in \"brick\" variable.</p>\n\n<p>The value you are printing is unintialized due to the fact that if will never execute and 0 is the most likely case.</p>\n\n<p>I would recommend using -Wall compiler option while writing/debugging code as it would, for this case for example output <code>warning: comparison between pointer and integer [enabled by default]</code></p>\n"}], "owner": {"reputation": 21, "user_id": 12053459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab214c29ad4fb811420e84b39273774?s=128&d=identicon&r=PG&f=1", "display_name": "dpalacios", "link": "https://stackoverflow.com/users/12053459/dpalacios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57891258, "answer_count": 1, "score": 0, "last_activity_date": 1568212314, "creation_date": 1568211358, "question_id": 57891155, "link": "https://stackoverflow.com/questions/57891155/not-able-to-retrieve-or-store-2d-array-positions-in-if-statement", "title": "Not able to retrieve or store 2d array positions in If statement", "body": "<p>I am attempting to solve this maze problem, however, what I have now represents a maze txt file that when ran it creates the dimensions (Rows and Columns) and prints out the matrix where \"b\" is soppose to be as well as the spaces and \"s\" for 'Starting point'  </p>\n\n<p>I am trying to get the starting coordinates where the 's' is at in this matrix. </p>\n\n<pre><code>Here is how the maze.txt file looks like:\n\nbbbb bbbbb\nbb     bbb\nb bb b bbb\nbb   b b b\nbb bbb  bb\nbb     b b\nbb b b bbb\nbb    s bb\nbbbbbbbbbb\n\n\n\nHere is my function to create the matrix:\n\n void CreateGrid(FILE* fp, int rowCount, int colNum)\n    {\n    int i, j;\n   int startPos[2];\n\n     int dimensions[rowCount][colNum];\n\n        for (i = 0; i &lt; rowCount; i++) {\n             for (j = 0; j &lt; colNum; j++) {\n                    char brick = getc(fp);\n\n                    if (brick == \"s\"){\n                       startPos[0] = i;\n                       startPos[1] = j;\n\n                    }\n                     dimensions[i][j] = brick;\n\n\n                    printf(\"%c\", dimensions[i][j]);\n        }\n\n\n\n    }\n    printf(\"\\n%d %d\", startPos[0], startPos[1]);\n\n\n\nExpected Result --&gt; x: 7, y: 7\n\n\nActual Result --&gt; 0 0\n</code></pre>\n\n<p>My logic was that since it scans through each character by row and column, it could indicate where the letter 's' will be and from that I would be able to retrieve its current position in the loop but it appears to be not the case.</p>\n\n<p>I am not sure if this is memory allocation error but I am a bit new to C so this is all a bit confusing for me because I know this would work in a higher language.</p>\n"}, {"tags": ["c", "sockets", "winsock"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1568214360, "post_id": 57890124, "comment_id": 102205424, "body": "&#39;CreatePacket()&#39; seems to return a NUL-terminated char array.  Does it?  Where is it freed, (if it does not need freeing, please explain why)?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1568214465, "post_id": 57890124, "comment_id": 102205490, "body": "Does &#39;encrypt()&#39; maintain the NUL-termination without introducing any embedded NULs?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1568214801, "post_id": 57890124, "comment_id": 102205690, "body": "The client does not send that terminating NUL, so how can the server know when a client_req has been completely received?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1568215031, "post_id": 57890124, "comment_id": 102205808, "body": "The given code has a smell of failing to correctly handle the streaming nature of TCP, where sending a 100 byte message may result in 100 recv() returns, each having loaded one byte into the buffer."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568231538, "post_id": 57890124, "comment_id": 102213186, "body": "Same with <code>send()</code>.  Both <code>send()</code> and <code>recv()</code> can return fewer bytes than requested.  You need to handle that on both sides, by running both functions in loops until all expected data is sent/consumed."}, {"owner": {"reputation": 11, "user_id": 10856333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hl07aC4hJFk/AAAAAAAAAAI/AAAAAAAARZ8/cXyHOD-6KHI/photo.jpg?sz=128", "display_name": "Vivek", "link": "https://stackoverflow.com/users/10856333/vivek"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1568271841, "post_id": 57890124, "comment_id": 102223094, "body": "@MartinJames CreatePacket() does not return anything but it stores the output in the global varibale of type char array. It is being freed at the end of the code where I am closing the socket and some garbage collection.   -&gt; So server is not able to distinguish between 2 different messages as the null-terminator (&#39;\\0&#39;) is missing at the end of the first message ? Is that so ?"}, {"owner": {"reputation": 11, "user_id": 10856333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hl07aC4hJFk/AAAAAAAAAAI/AAAAAAAARZ8/cXyHOD-6KHI/photo.jpg?sz=128", "display_name": "Vivek", "link": "https://stackoverflow.com/users/10856333/vivek"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568272217, "post_id": 57890124, "comment_id": 102223233, "body": "@RemyLebeau both send() and recv() are working fine when I debug the windows service&#39;s exe (which is a server for me). When I install service (using sc.exe) i am getting the 10054 error while receiving."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568273591, "post_id": 57890124, "comment_id": 102223896, "body": "@VivekSonawane in TCP, you MUST separate messages explicitly. For each message, you MUST either send the message&#39;s length before sending the message&#39;s body, or else terminate the message with a unique delimiter. Your code is doing neither. And your use of <code>send()</code> and <code>recv()</code> IS insufficient, despite whether you THINK they are working. TCP is a byte stream, you MUST treat it as such. That means you CAN&#39;T assume a 1:1 relationship between sends and reads"}, {"owner": {"reputation": 11, "user_id": 10856333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hl07aC4hJFk/AAAAAAAAAAI/AAAAAAAARZ8/cXyHOD-6KHI/photo.jpg?sz=128", "display_name": "Vivek", "link": "https://stackoverflow.com/users/10856333/vivek"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568274550, "post_id": 57890124, "comment_id": 102224371, "body": "@RemyLebeau Agree with you. I do send length of the message and then the actual message. Do you have any good documentation over send() and recv() usage ? Because I have read theory while implementing the same I had no luck."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568276144, "post_id": 57890124, "comment_id": 102225139, "body": "@VivekSonawane the code you have shown does not do anything to send/receive a message&#39;s length before its data. There are plenty of questions on StackOverflow whose answers show proper use of <code>send()</code> and <code>recv()</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1568291381, "post_id": 57890124, "comment_id": 102233395, "body": "A global char array?  Does not return anything?  It does, and you send what is returned!"}, {"owner": {"reputation": 11, "user_id": 10856333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hl07aC4hJFk/AAAAAAAAAAI/AAAAAAAARZ8/cXyHOD-6KHI/photo.jpg?sz=128", "display_name": "Vivek", "link": "https://stackoverflow.com/users/10856333/vivek"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1568357086, "post_id": 57890124, "comment_id": 102255115, "body": "@MartinJames As of now I am using the way as I have posted the question and that is not my real concern. I do NULL-TERMINATED message before encrypting and send the encrypted one but still it has no effect."}, {"owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "edited": false, "score": 0, "creation_date": 1568838640, "post_id": 57890124, "comment_id": 102406473, "body": "A common cause of unexpected abortive disconnect (leading to <code>WSAECONNRESET</code>) is one side of the connection closing a socket with unread data still queued."}], "owner": {"reputation": 11, "user_id": 10856333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hl07aC4hJFk/AAAAAAAAAAI/AAAAAAAARZ8/cXyHOD-6KHI/photo.jpg?sz=128", "display_name": "Vivek", "link": "https://stackoverflow.com/users/10856333/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 806, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568231436, "creation_date": 1568207852, "last_edit_date": 1568231436, "question_id": 57890124, "link": "https://stackoverflow.com/questions/57890124/recv-returns-1-failed-with-10054-error", "title": "recv() returns -1 (failed with 10054 error)", "body": "<p>When my client sends a request to the server (both are written in C), <code>recv()</code> fails on the client side with error 10054 (<code>WSAECONNRESET</code>). My server is a Windows service running on a defined port.</p>\n\n<p>The connection gets established, the sockets are created on both sides, but while sending/receiving, I am facing this issue :/</p>\n\n<p>---> Server Code  &lt;----</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>WSADATA wsa;\nSOCKET MainSock, AcceptSock;\nint c = sizeof(struct sockaddr_in);\nchar client_req[1024] = { 0 };\nint req_size;\nchar *end = NULL;\n\nif (WSAStartup(MAKEWORD(2, 0), &amp;wsa) != 0)\n{\n    fprintf(fptr, \" WSAStartup Failed. Error Code : %d\", WSAGetLastError());\n    return 1;\n}\n\n//Create a socket\nif ((MainSock = socket(AF_INET, SOCK_STREAM, 0)) == INVALID_SOCKET)\n    fprintf(fptr, \" Could not create socket : %d\\n\", WSAGetLastError());\n\n//Prepare the sockaddr_in structure\nserver.sin_family = AF_INET;\nserver.sin_addr.s_addr = INADDR_ANY;    //inet_addr(\"10.10.1.18\"); \nserver.sin_port = htons(PORT);\n\n//Bind\nif (bind(MainSock, (struct sockaddr *)&amp;server, sizeof(server)) == SOCKET_ERROR)\n    fprintf(fptr, \" Bind failed with error code : %d\\n\", WSAGetLastError());\n\n//Listen to incoming connections\nif ((listen(MainSock, SOMAXCONN)) == SOCKET_ERROR)\n    fprintf(fptr, \" listen failed with error code : %d\\n\", WSAGetLastError());\n\n//Accept and incoming connection\nfprintf(fptr, \"\\n\\n Waiting for incoming connections...\");\n\nif ((AcceptSock = accept(MainSock, (struct sockaddr *)&amp;client, &amp;c)) != INVALID_SOCKET)\n{\n    fprintf(fptr, \"\\n Connection accepted on %s\", getCurrTime());\n\n    req_size = recv(AcceptSock, client_req, 1024, 0);\n\n    if (req_size &gt; 0)\n    {\n        //stuff to do\n    }                              \n}\n</code></pre>\n\n<p>---> Client Code  &lt;----</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *ReturnedData = CreatePacket();\nencrypt(ReturnedData);\n\nif ((sent_bytes = send(ServiceSock, ReturnedData, strlen(ReturnedData), 0)) &lt; 0)\n{\n    err = GetLastError();\n    DisplayError = malloc(MINCHAR * sizeof(char));\n    sprintf(DisplayError, \"Unable to communicate. (%d)\", err);\n    MessageBox(NULL, DisplayError, \"Error!\", MB_ICONEXCLAMATION | MB_OK);\n    free(DisplayError);\n    return err;\n}\n\nif ((recv_size = recv(ServiceSock, Service_reply, 10000, 0)) == SOCKET_ERROR)   //Failed here with 10054\n{\n    err = WSAGetLastError();\n    DisplayError = malloc(MINCHAR * sizeof(char));\n    sprintf(DisplayError, \"Unable to receive information. (%d)\", err);\n    MessageBox(NULL, DisplayError, \" Error!\", MB_ICONEXCLAMATION | MB_OK);\n    free(DisplayError);\n    return err;\n}\nelse\n{\n    //stuff to do\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "compiler-errors", "static-analysis"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1568208215, "post_id": 57890062, "comment_id": 102201910, "body": "gcc manages replacable front-ends (to support compiling of multiple languages) as well as replacable back-ends (to support code generation for multiple platforms, and specifically cross-platform compiling). So, theoretically, it should be possible to use a &quot;null-backend&quot; which would result in compiling the code (with all diagnostics as usual) just without creating a binary output. May be, such back-end already exists but I don&#39;t know. &quot;quick&quot;... Yeah... <code>gcc</code> is IMHO not slower than other C++ compilers I know but is this quick enough?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568208255, "post_id": 57890062, "comment_id": 102201933, "body": "Sounds like you need something like intellisense that MSVS offers.  I believe VS code offers that if you are on linux."}, {"owner": {"reputation": 31, "user_id": 9600383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cb34750bb215c1a4d711e0d87bf244?s=128&d=identicon&r=PG", "display_name": "user9600383", "link": "https://stackoverflow.com/users/9600383/user9600383"}, "edited": false, "score": 0, "creation_date": 1568208307, "post_id": 57890062, "comment_id": 102201962, "body": "I mean raw compilation speed, in my experience it lags behind something like tcc."}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 8, "creation_date": 1568208354, "post_id": 57890062, "comment_id": 102201987, "body": "Use flag <code>-fsyntax-only</code>"}, {"owner": {"reputation": 31, "user_id": 9600383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cb34750bb215c1a4d711e0d87bf244?s=128&d=identicon&r=PG", "display_name": "user9600383", "link": "https://stackoverflow.com/users/9600383/user9600383"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568208471, "post_id": 57890062, "comment_id": 102202044, "body": "@Mansoor does it report type errors, printf etc warnings &amp; casting warnings etc..?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568208617, "post_id": 57890062, "comment_id": 102202128, "body": "@Mansoor Found the doc. side: <a href=\"https://gcc.gnu.org/onlinedocs/gcc-9.2.0/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow noreferrer\">3.8 Options to Request or Suppress Warnings</a>: <i>Check the code for syntax errors, but don\u2019t do anything beyond that.</i> If taken literally, semantic checks would be excluded... (Although, I find it sounds promising.)"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568208722, "post_id": 57890062, "comment_id": 102202193, "body": "I got at least some warnings with <a href=\"http://coliru.stacked-crooked.com/a/72b2b2bedc11649e\" rel=\"nofollow noreferrer\">Demo</a>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1568208787, "post_id": 57890062, "comment_id": 102202235, "body": "There seems to be a dupl. (which recommends <code>-fsyntax-only</code> as well): <a href=\"https://stackoverflow.com/a/26738152/7478597\">SO: Compile without generating output file in GCC</a> and a comment which recommends <code>gcc -Wall -Wextra -O -c somefile.c -o &#47;dev&#47;null</code> instead. Not the &quot;null-backend&quot; but just throwing any generated code away... ;-)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568209379, "post_id": 57890062, "comment_id": 102202583, "body": "@Jarod42 I modified your demo a bit: <a href=\"http://coliru.stacked-crooked.com/a/49bf0f5f59890070\" rel=\"nofollow noreferrer\">Demo</a>. The syntax-only run seems really to skip some of the things diagnosed in ful compile."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568209508, "post_id": 57890062, "comment_id": 102202656, "body": "The <code>-S</code> option generates assembler; is that stopping soon enough?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568210663, "post_id": 57890062, "comment_id": 102203313, "body": "Well, you can rarely check for <i>semantic</i> errors even in compiled program."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1568211597, "post_id": 57890062, "comment_id": 102203811, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26738082/compile-without-generating-output-file-in-gcc\">Compile without generating output file in GCC</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568213242, "post_id": 57890062, "comment_id": 102204797, "body": "If it takes longer than 1 second for you to compile a single source file, then the problem is not the compiler. The problem is your IDE, or your computer or your LAN. Or less likely, you have a horrifically huge source file. In either case, not a compiler problem."}], "answers": [{"tags": [], "owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "is_accepted": false, "score": 5, "last_activity_date": 1568216415, "last_edit_date": 1568216415, "creation_date": 1568209258, "answer_id": 57890527, "question_id": 57890062, "link": "https://stackoverflow.com/questions/57890062/gcc-quickly-check-for-all-errors-but-not-compile-c/57890527#57890527", "title": "gcc: quickly check for all errors but not compile C?", "body": "<p>GCC has a <code>-fsyntax-only</code> flag which checks for syntax errors, see <a href=\"https://gcc.gnu.org/onlinedocs/gcc-9.2.0/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow noreferrer\">3.8 Options to Request or Suppress Warnings</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 9600383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cb34750bb215c1a4d711e0d87bf244?s=128&d=identicon&r=PG", "display_name": "user9600383", "link": "https://stackoverflow.com/users/9600383/user9600383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568216415, "creation_date": 1568207664, "last_edit_date": 1568209275, "question_id": 57890062, "link": "https://stackoverflow.com/questions/57890062/gcc-quickly-check-for-all-errors-but-not-compile-c", "title": "gcc: quickly check for all errors but not compile C?", "body": "<p>I want to check for all syntax &amp; semantic errors in the flow while not wasting time on waiting it to compile every time.</p>\n\n<ol>\n<li><p>Is it possible with compiler architecture that gcc uses?</p></li>\n<li><p>If possible, how?</p></li>\n</ol>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 2, "creation_date": 1568207245, "post_id": 57889903, "comment_id": 102201333, "body": "Your code could <i>really</i> use some spacing... (and re-styling)."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 4, "creation_date": 1568208827, "post_id": 57889903, "comment_id": 102202255, "body": "I don&#39;t need to fully read all the code. I can&#39;t even manage to read it. I read what you are asking for and it could very well be a good question, if only it was formatted correctly and was providing a real <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Down-vote arrows are there for a reason."}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1568209483, "post_id": 57889903, "comment_id": 102202642, "body": "This code doesn&#39;t compile. I&#39;m guessing you&#39;ve missed a closing bracket somewhere in main()"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1568210850, "post_id": 57889903, "comment_id": 102203412, "body": "This latest edit makes the code even less valid and buildable. Please post the code that actually produces what you say it does. I&#39;ve answered the question despite the latest changes. You&#39;re accessing outside of the bounds of <code>tokens</code>"}, {"owner": {"reputation": 1302, "user_id": 3042790, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7cfda1f5d09fc082ee8db124240eab4e?s=128&d=identicon&r=PG&f=1", "display_name": "eager2learn", "link": "https://stackoverflow.com/users/3042790/eager2learn"}, "edited": false, "score": 1, "creation_date": 1568210956, "post_id": 57889903, "comment_id": 102203470, "body": "Edited the code and fixed the compilation error now. Sorry for the badly edited question, hope this is at least readable now."}], "answers": [{"tags": [], "owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "is_accepted": true, "score": 2, "last_activity_date": 1568210430, "creation_date": 1568210430, "answer_id": 57890865, "question_id": 57889903, "link": "https://stackoverflow.com/questions/57889903/segfault-on-strncpy-call/57890865#57890865", "title": "Segfault on strncpy call", "body": "<p>Quick run after fixing your code  so it would compile tells us the segfault is coming from <code>strlen()</code>, not <code>strncpy()</code>:</p>\n\n<pre><code>stack_pointers[j] = strncpy(next_pointer, tokens[j], strlen(tokens[i]) + 1);\n</code></pre>\n\n<p><code>tokens[i]</code> is null.</p>\n\n<p>Earlier in your code, you do:</p>\n\n<pre><code>int i = 0;\nwhile (token != NULL){\n  tokens[i++] = token;\n  printf(\"%s \\n\", token);\n  token = strtok(NULL, \" \");\n}\n</code></pre>\n\n<p>This increments <code>i</code> to 4, since the array only contains 4 strings, and you're accessing the fifth position, naturally, <code>strlen()</code> segfaults when it accesses outside the array.</p>\n\n<pre><code>#0  __strlen_sse42 () at ../sysdeps/x86_64/multiarch/strlen-sse4.S:32\n#1  0x00000000004007b8 in main () at main.c:32\n(gdb) f 1\n#1  0x00000000004007b8 in main () at main.c:32\n32      stack_pointers[j] = strncpy(next_pointer, tokens[j], strlen(tokens[i]) + 1);\n(gdb) print tokens[i]\n$1 = 0x0\n(gdb) print i\n$2 = 4\n(gdb) print tokens\n$3 = {0x7fffffffe020 \"/bin/ls\", 0x7fffffffe028 \"-l\", 0x7fffffffe02b \"foo\", 0x7fffffffe02f \"bar\", \n  0x0}\n</code></pre>\n"}], "owner": {"reputation": 1302, "user_id": 3042790, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7cfda1f5d09fc082ee8db124240eab4e?s=128&d=identicon&r=PG&f=1", "display_name": "eager2learn", "link": "https://stackoverflow.com/users/3042790/eager2learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57890865, "answer_count": 1, "score": 0, "last_activity_date": 1568211838, "creation_date": 1568207173, "last_edit_date": 1568211838, "question_id": 57889903, "link": "https://stackoverflow.com/questions/57889903/segfault-on-strncpy-call", "title": "Segfault on strncpy call", "body": "<p>I want to simulate a downward growing call stack in C and push the following onto the stack:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TLBy8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TLBy8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is test code I wrote, where I only tried to push the strings, word align and then push the addresses to the strings I that were just pushed:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n\n    /*Initialize stack */\n    size_t stack_size = (size_t) pow(2,10);\n    uint8_t *esp;                             /*Use byte-addressable stack pointer */\n    esp = (uint8_t *) malloc(stack_size);\n\n    esp += stack_size - 1;                    /*Set esp to top of allocated memory,\n                                            since stack grows downwards */\n\n    /* Parse the string into its tokens */\n    char s[]  = \"/bin/ls -l foo bar\";\n    char *tokens[4];\n    char *token = strtok(s, \" \");\n    int num_tokens = 0;                                \n    while (token != NULL)\n    {\n        tokens[num_tokens++] = token;\n        token = strtok(NULL, \" \");\n    }\n\n\n    size_t esp_iter = 0;                      /*number of bytes pushed,\n                                            needed for word alignment */    \n\n    char *stack_pointers[num_tokens];         /* Array to store addresses of\n                                               strings that were pushed */\n\n    /* Push the char arrays on the stack */\n    for (int j = 0; j &lt; num_tokens; j++)\n    {\n        esp_iter += strlen(tokens[j]) + 1;      /* +1 because of \u2018\\0\u2019, which is\n                                                  included in strncpy */\n\n        /* Address to store next string into */\n        char *next_pointer = (char *) ((uint8_t *) ( esp - esp_iter));\n\n        /* Store address in stack to which token j was pushed */\n        stack_pointers[j] = strncpy(next_pointer, tokens[j],\n                                    strlen(tokens[num_tokens]) + 1);\n    }\n\n    /* word aligning */\n    size_t pad = 4 - esp_iter % 4;\n    for (int j = 0; j &lt; (int) pad; j++)\n    {\n        esp_iter += 1;\n    }\n\n    /* Push pointers to previously pushed strings */\n    for (int j = 0; j &lt; num_tokens; j++)\n    {\n        esp_iter -= sizeof(char *);\n\n        /* Address on stack to store address of previously\n           pushed token to */\n        char *stack_pointer = (char *) (esp - esp_iter);\n        stack_pointer = (char *) stack_pointers[j];\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I want to address the stack on byte-level, so I use (uint8_t *) for the stack pointer. Then I should be able to use the length of the string + 1 (for the '\\0', which is included in strncpy) in the call to strncpy. But the strncpy yields a segmentation fault and I don't understand why.\nI malloced memory from 0x7fc4c5001000 to 0x7fc4c50013ff. Esp is set to 0x7fc4c50013ff, then I want to e.g push \"bar\" on the stack, so I decrement to the stack pointer (stack grows toward lower memory addresses) by 4 and call strncpy with destination address 0x7fc4c50013fb, which should be enough space to push those 4 characters. Why do I get a segfault here?</p>\n"}, {"tags": ["c", "function", "pointers", "definition"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 3, "creation_date": 1568206626, "post_id": 57889701, "comment_id": 102200960, "body": "<code>printf(&quot;&quot;,sum);</code> forgot to write <code>%d\\n</code> by any chance?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 2, "creation_date": 1568206750, "post_id": 57889701, "comment_id": 102201033, "body": "Also, that function is not changing the values of <code>a</code> and <code>b</code> so I don&#39;t know what you would expect from that last <code>printf</code> call except printing the exact same values as the first one. Maybe you forgot to update the values in the <code>update</code> function? Looks strange."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12053023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba545961c02639b24b329056c004fa99?s=128&d=identicon&r=PG&f=1", "display_name": "Satya_syp", "link": "https://stackoverflow.com/users/12053023/satya-syp"}, "edited": false, "score": 0, "creation_date": 1568362342, "post_id": 57889895, "comment_id": 102257305, "body": "I figured it out . The code should be as follow, in the update function ;sum=*a;sub=*b;    i have just started to code , so pardon silly mistakes"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1568207121, "creation_date": 1568207121, "answer_id": 57889895, "question_id": 57889701, "link": "https://stackoverflow.com/questions/57889701/how-to-pass-pointers-as-parameters-in-a-function/57889895#57889895", "title": "how to pass pointers as parameters in a function?", "body": "<p>If I have understood correctly (taking into account the function name) you mean something like the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid update( int *a, int *b )\n{\n    *a += *b;\n    *b = abs( *a - *b - *b );\n}\n\nint main(void) \n{\n    int a, b;\n\n    scanf( \"%d%d\", &amp;a, &amp;b );\n\n    update( &amp;a, &amp;b );\n\n    printf( \"a = %d, b = %d\\n\", a, b );\n\n    return 0;\n}\n</code></pre>\n\n<p>If for example to enter two values <code>20</code> and <code>10</code> then the output will look like</p>\n\n<pre><code>a = 30, b = 10\n</code></pre>\n\n<p>Pay attention to that these calls of <code>printf</code> in your function</p>\n\n<pre><code>printf(\"\",sum);\n\nprintf(\"\",sub);\n</code></pre>\n\n<p>do not make sense.</p>\n"}], "owner": {"reputation": 11, "user_id": 12053023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba545961c02639b24b329056c004fa99?s=128&d=identicon&r=PG&f=1", "display_name": "Satya_syp", "link": "https://stackoverflow.com/users/12053023/satya-syp"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1568210720, "answer_count": 1, "score": -4, "last_activity_date": 1568207318, "creation_date": 1568206536, "last_edit_date": 1568207318, "question_id": 57889701, "link": "https://stackoverflow.com/questions/57889701/how-to-pass-pointers-as-parameters-in-a-function", "closed_reason": "Not suitable for this site", "title": "how to pass pointers as parameters in a function?", "body": "<p>I am trying to print the sum and diffrence of numbers using pointers but i am getting only sum as output.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;math.h&gt;\n\nvoid update(int *a,int *b)\n\n {\n\n    int sum,sub;\n\n    sum = *a + *b;\n\n    printf(\"\",sum);\n\n    sub = abs(*a - *b);\n\n    printf(\"\",sub);\n\n}\n\nint main()\n\n{\n\n    int a, b;\n\n    int *pa = &amp;a, *pb = &amp;b;\n\n    scanf(\"%d %d\", &amp;a, &amp;b);\n    update(pa, pb);\n    printf(\"%d\\n%d\", a, b); \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "button", "arduino"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568204065, "post_id": 57888849, "comment_id": 102199446, "body": "Detect the <i>transition</i> of the button by remembering its previous state."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568204243, "post_id": 57888849, "comment_id": 102199527, "body": "What have you tried to achieve the desired behavior?"}, {"owner": {"reputation": 35, "user_id": 11945570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5NwgtYhD6To/AAAAAAAAAAI/AAAAAAAAAX0/z4T_TsC6y5E/photo.jpg?sz=128", "display_name": "KD Technology", "link": "https://stackoverflow.com/users/11945570/kd-technology"}, "edited": false, "score": 0, "creation_date": 1568204456, "post_id": 57888849, "comment_id": 102199655, "body": "I used an interrupt that runs a function whenever the button is released. Inside that function I putted the <code>analogWrite(LAUNCHER_PIN, strength)</code>"}, {"owner": {"reputation": 195, "user_id": 9160296, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XcnIPX-keoM/AAAAAAAAAAI/AAAAAAAAABU/O40XwOBR62s/photo.jpg?sz=128", "display_name": "Avinash Kumar Ranjan", "link": "https://stackoverflow.com/users/9160296/avinash-kumar-ranjan"}, "edited": false, "score": 0, "creation_date": 1568204512, "post_id": 57888849, "comment_id": 102199693, "body": "Attach <i>interrupt</i> on push button and detect transition changes form unpressed state to pressed down state and vice versa."}, {"owner": {"reputation": 35, "user_id": 11945570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5NwgtYhD6To/AAAAAAAAAAI/AAAAAAAAAX0/z4T_TsC6y5E/photo.jpg?sz=128", "display_name": "KD Technology", "link": "https://stackoverflow.com/users/11945570/kd-technology"}, "edited": false, "score": 0, "creation_date": 1568204564, "post_id": 57888849, "comment_id": 102199735, "body": "I want that only when I release the button the motor will get the strength value once (the final value).  On my code it sends the value every 300ms so the motor&#39;s strength changes with my press."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568218616, "post_id": 57888990, "comment_id": 102207742, "body": "very simple solution! Alongside with a external interrupt, this would be very responsive"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1568204740, "last_edit_date": 1568204740, "creation_date": 1568204297, "answer_id": 57888990, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57888990#57888990", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>This is could easily be solved with a simple <em>state machine</em>.</p>\n\n<p>You could have two states: <code>NORMAL</code>, <code>BUTTON_DOWN</code>.</p>\n\n<p>Normally you should be in the <code>NORMAL</code> state, and the <code>loop</code> function checks if the button is pressed or not. If the button is pressed and you're in state <code>NORMAL</code>, then you set the state to <code>BUTTON_DOWN</code> and do whatever other processing you need to do when the button is pressed.</p>\n\n<p>If the button is not pressed, and the current state is <code>BUTTON_DOWN</code> you know that the button have been released and you go back to the <code>NORMAL</code> state and do the button-release processing that needs to be done.</p>\n\n<p>Since you only have two states, you could represent that as a single <code>bool</code> variables, where (for example) <code>false</code> means <code>NORMAL</code> and <code>true</code> means <code>BUTTON_DOWN</code>.</p>\n\n<p>In <strong><em>pseudo</strong> code</em> it could be something like</p>\n\n<pre><code>void loop()\n{\n    if (state == NORMAL)\n    {\n        // Do normal processing\n\n        if (is_button_pressed())\n        {\n            // Do buttown-down processing\n\n            state = BUTTON_DOWN;\n        }\n    }\n    else if (state == BUTTON_DOWN)\n    {\n        if (!is_button_pressed())\n        {\n            // Do button-release processing\n\n            state = NORMAL;\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>By adding a third state, <code>BUTTON_DEBOUNCE</code>, you could easily handle debounce of the button.</p>\n\n<p>When in state <code>NORMAL</code> and you detect the button being pressed, you enter the <code>BUTTON_DEBOUNCE</code> state. If you have been in the <code>BUTTON_DEBOUNCE</code> state for a certain amount of time (say a few milliseconds) and the button is still pressed then you enter the <code>BUTTON_PRESSED</code> state and to the button-pressed processing.</p>\n\n<p>If after the short time the button is not pressed, you go back to the <code>NORMAL</code> state.</p>\n\n<p>If you add a third state like this, then you can no longer have a simple <code>bool</code> variable representing the state. An enumeration and a variable of that enumeration type might be a better choice then.</p>\n"}, {"tags": [], "owner": {"reputation": 210, "user_id": 11877755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dfb50469543aeadf2a1a28117e5c1b0?s=128&d=identicon&r=PG&f=1", "display_name": "amaldec23", "link": "https://stackoverflow.com/users/11877755/amaldec23"}, "is_accepted": false, "score": 1, "last_activity_date": 1568204351, "creation_date": 1568204351, "answer_id": 57889006, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57889006#57889006", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>You can use flag to solve this issue,create a flag variable <strong>boolean</strong> and set it <strong>true</strong> and <strong>false</strong> when event occurs and only pass the value when flag is true</p>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568218534, "post_id": 57889212, "comment_id": 102207693, "body": "Although this does work, it&#39;s not advised as it locks your system in a loop, so if you need to keep track of other stuff or to have control of other outputs, this would make it harder for you to control... Possibly making so that you duplicate your remaining code to occur inside and outside of your infinite loop"}, {"owner": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "reply_to_user": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568272449, "post_id": 57889212, "comment_id": 102223322, "body": "@BrenoTeodoro True, if you need something to be running regularly in your main loop, then a solution like the one proposed by SomeProgrammerDude is the correct one. The only benefit of this one, is that it takes a fraction of the code and in many situations is &quot;good enough&quot;."}, {"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568289242, "post_id": 57889212, "comment_id": 102232158, "body": "Agreed, your code would suffice for most applications, and would only present the issue raised in a fraction of them. It also has the advantage of occupying very little space in memory. It&#39;s an effective way of resolving the issue, just thought I&#39;d point out this minor issue, should KD Technology face it in the future."}], "tags": [], "owner": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "is_accepted": false, "score": 0, "last_activity_date": 1568204993, "creation_date": 1568204993, "answer_id": 57889212, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57889212#57889212", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>If you don't need your main process to continue doing stuff while you press buttons, then you can do something like:</p>\n\n<pre><code>while (!digitalRead(MOTOR_BTN_PIN))\n{\n    if (digitalRead(MOTOR_BTN_PIN))\n        update();\n}\n</code></pre>\n\n<p>When you press the button you get trapped in the while, and when you finally let go <code>update()</code> gets called (once).</p>\n"}, {"comments": [{"owner": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "edited": false, "score": 0, "creation_date": 1568272155, "post_id": 57893099, "comment_id": 102223207, "body": "<code>btn_prev = digitalRead(btnPin);</code> should probably be <code>btn_prev = btn</code> instead, otherwise you risk that the button state changes between the top and bottom of the loop. Which would mean that <code>btn</code> reads <code>LOW</code> at the top, button is pressed during the <code>if</code>, <code>btn_prev</code> reads <code>HIGH</code> at the bottom, and then in the next loop <code>btn</code> is also read as <code>HIGH</code> - and now you just lost a button press. If you instead limit it to a single read per loop, and just remember the last logic value, then the race condition goes away."}, {"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "reply_to_user": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "edited": false, "score": 0, "creation_date": 1568288902, "post_id": 57893099, "comment_id": 102231968, "body": "The ATmega328P, present in the most common arduino Uno and Nano boards, can perform roughly 8 million instructions a second, so your code would have to be very heavy to have this situation occur. In the same scenario, with your suggestion applied, if I read the value while pressing, release and press again before the loop has finished, you&#39;ve just lost a button press. The way I proposed is intended to lessen the odds of this happening, as the last &amp; the fist actions are to read and compare the values. To eliminate the issue altogether, we should make use of External Interrupts."}], "tags": [], "owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "is_accepted": false, "score": 0, "last_activity_date": 1568218347, "creation_date": 1568218347, "answer_id": 57893099, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57893099#57893099", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>You need to get the \"edge\" of the signal when it's going down. </p>\n\n<p>You can think of a buttons signal as a square. When the button is not pressed there is nothing, when you press it, the voltage flows, so it looks like this (this image illustrates a system where you connect your button in pulldown):</p>\n\n<p><a href=\"https://i.stack.imgur.com/fAE9W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fAE9W.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, in total, there are four states of a given digital signal:</p>\n\n<ol>\n<li>There is <em>nothing</em> (this can either be a <strong>LOW</strong> or a <strong>HIGH</strong>, depending on your connection; in the example I brought, the <em>nothing</em> relates to a <strong>HIGH</strong> signal, as I turned on the built-in PULLUP resistor of the arduino digital pin);</li>\n<li>There is a <em>signal</em> (which is always the inverse of point <strong>1</strong>;</li>\n<li>There is a ramp from <em>nothing</em> to <em>signal</em>;</li>\n<li>There is a ramp from <em>signal</em> to <em>nothing</em></li>\n</ol>\n\n<p>In your case, you'll make use of point <strong>4</strong>, as this is the state where the button is no longer pressed, and the microcontroller stops receiving signal.</p>\n\n<p>Try this:</p>\n\n<pre><code>#define btnPin 2\n\nuint8_t btn_prev;\n\nvoid setup() {\n  pinMode(btnPin, INPUT_PULLUP);\n\n  // here the previous button signal is set to HIGH, as we enabled the pullup\n  btn_prev = digitalRead(btnPin);\n}\n\nvoid loop() {\n //for each iteration we read the button singal\n uint8_t btn = digitalRead(btnPin);\n\n // we call your update function when the button was low and is now high: a.k.a. falling edge\n if (btn == LOW &amp;&amp; btn_prev == HIGH)\n  {\n    update();\n  }\n\n  // at last, we update the previous state of the button, so that we can check again for a change in the next iteration\n  btn_prev = digitalRead(btnPin);\n}\n</code></pre>\n\n<p>Hope this makes sense.</p>\n"}], "owner": {"reputation": 35, "user_id": 11945570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5NwgtYhD6To/AAAAAAAAAAI/AAAAAAAAAX0/z4T_TsC6y5E/photo.jpg?sz=128", "display_name": "KD Technology", "link": "https://stackoverflow.com/users/11945570/kd-technology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1568218347, "creation_date": 1568203862, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>So I have a push button that changes a variable value, which controls a motor's strength, when pressed. It goes through a loop back and forth and stops when I release it.</p>\n\n<p>The problem is that whenever the value changes it's being sent to the motor. I want the value to change when I press the button (without sending it to the motor) and when I'll release the button the value will be sent once to the motor (instead of the motor will change its strength very fast all the time and shake).</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>increment = 1;\n        void update() {\n            if (millis() - last_update &gt; 300) {\n                last_update = millis();\n                strength += increment;\n                analogWrite(LAUNCHER_PIN, strength);\n                Serial.print(\"Canon strength: \");\n                Serial.print(strength);\n                if (strength &lt;= CANON_MIN || strength &gt;= CANON_MAX) increment = -increment;\n            }\n        }\nif (!digitalRead(MOTOR_BTN_PIN)) update();\n</code></pre>\n"}, {"tags": ["c", "environment-variables", "jemalloc"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1568201038, "post_id": 57887914, "comment_id": 102197823, "body": "Your signal handler invokes undefined behavior.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.4p4\" rel=\"nofollow noreferrer\"><b>7.1.4 Use of library functions</b>, paragraph 4 of the C standard</a>: &quot;The functions in the standard library are not guaranteed to be reentrant and may modify objects with static or thread storage duration.&quot;  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note188\" rel=\"nofollow noreferrer\">Footnote 188 adds</a>: &quot;Thus, a signal handler cannot, in general, call standard library functions.&quot; <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow noreferrer\">POSIX allows calling async-signal-safe functions.</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1568201092, "post_id": 57887914, "comment_id": 102197856, "body": "(cont)  But neither <code>getenv()</code> nor <code>printf()</code> are async-signal-safe.  And I seriously doubt that <code>mallctl()</code> is async-signal-safe either."}, {"owner": {"reputation": 182, "user_id": 6602000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5dcac1b0f7352f6750312830062607?s=128&d=identicon&r=PG&f=1", "display_name": "Ronin Goda", "link": "https://stackoverflow.com/users/6602000/ronin-goda"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1568201708, "post_id": 57887914, "comment_id": 102198214, "body": "@AndrewHenle - i will keep that in mind.. getnev and printf was used only to show the variable.. ideally there would be only mallctl called."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 2, "creation_date": 1568201923, "post_id": 57887914, "comment_id": 102198306, "body": "<code>jemalloc</code> only checks this when it starts up."}, {"owner": {"reputation": 182, "user_id": 6602000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5dcac1b0f7352f6750312830062607?s=128&d=identicon&r=PG&f=1", "display_name": "Ronin Goda", "link": "https://stackoverflow.com/users/6602000/ronin-goda"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1568202256, "post_id": 57887914, "comment_id": 102198508, "body": "@JL2210 - U mean even before main() function ?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1568202307, "post_id": 57887914, "comment_id": 102198533, "body": "@RoninGoda Yes -- I would assume that it uses constructors and destructors even before <code>main</code>."}, {"owner": {"reputation": 182, "user_id": 6602000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5dcac1b0f7352f6750312830062607?s=128&d=identicon&r=PG&f=1", "display_name": "Ronin Goda", "link": "https://stackoverflow.com/users/6602000/ronin-goda"}, "edited": false, "score": 0, "creation_date": 1568202592, "post_id": 57887914, "comment_id": 102198682, "body": "So basically u r saying there is no way to achieve this ?"}, {"owner": {"reputation": 605, "user_id": 2270067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ca631c4674f1798344c6b18b7d388518?s=128&d=identicon&r=PG", "display_name": "ashish", "link": "https://stackoverflow.com/users/2270067/ashish"}, "edited": false, "score": 0, "creation_date": 1586243037, "post_id": 57887914, "comment_id": 108048957, "body": "@RoninGoda Curious to know how you finally achieve this?"}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 4, "last_activity_date": 1568203464, "creation_date": 1568203464, "answer_id": 57888756, "question_id": 57887914, "link": "https://stackoverflow.com/questions/57887914/setting-malloc-conf-environmental-variable-for-jemalloc-within-c-program-is-not/57888756#57888756", "title": "Setting MALLOC_CONF environmental variable for jemalloc within C program is not working", "body": "<p>If <code>jemalloc</code> only checks the value on startup, you can check if the <code>MALLOC_CONF</code> environment variable is not set, and if it's not set you can set it and re-<code>exec</code> to restart your process with the environment variable set:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main( int argc, char **argv )\n{\n    char *envval = getenv( \"MALLOC_CONF\" );\n    if ( NULL == envval )\n    {\n        setenv( \"MALLOC_CONF\", \"prof:true,prof_prefix:jeprof.out\", 1 );\n        execv( argv[ 0 ], argv );\n    }\n\n    ...\n}\n</code></pre>\n\n<p>Note that this may cause problems if the code that runs prior to <code>main()</code> does things like open files and leave them open.  That isn't likely.</p>\n"}], "owner": {"reputation": 182, "user_id": 6602000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5dcac1b0f7352f6750312830062607?s=128&d=identicon&r=PG&f=1", "display_name": "Ronin Goda", "link": "https://stackoverflow.com/users/6602000/ronin-goda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568203464, "creation_date": 1568200468, "question_id": 57887914, "link": "https://stackoverflow.com/questions/57887914/setting-malloc-conf-environmental-variable-for-jemalloc-within-c-program-is-not", "title": "Setting MALLOC_CONF environmental variable for jemalloc within C program is not working", "body": "<p>I am trying to use jemalloc for memory profiling, due to some reason i don't have control of parent process, So instead of setting MALLOC_CONF env variable outside, i am trying to set the variable within the program, but seems its not working.</p>\n\n<p>I have tried setting the MALLOC_CONF env outside and then launch the process.. it works.</p>\n\n<p>Below is the snippet of sample program</p>\n\n<pre><code>void keep_mallocing(int count, size_t size, int **ptr) {\n        int i =0;\n        for(i=0; i&lt;count; i++) {\n                ptr[i] = malloc(size);\n                memset(ptr[i], 0, size);\n        }\n}\n\nvoid keep_freeing(int count, int **ptr) {\n        int i = 0;\n        for(i=0; i&lt;count; i++) {\n                free(ptr[i]);\n        }\n}\n\nvoid handle_sigusr1(int sig)\n{\n//      malloc_stats_print(NULL, NULL, \"g,l,b,h,m,a\");\n\n        char *path = 0;\n        path = getenv( \"MALLOC_CONF\" );\n        printf(\"path : %s\\n\", path);\n\n        mallctl(\"prof.dump\", NULL, NULL, NULL, 0);\n        return;\n}\n\nint\nmain(int argc, char **argv) {\n\n        signal(SIGUSR1, handle_sigusr1);\n        setenv(\"MALLOC_CONF\", \"prof:true,prof_prefix:jeprof.out\", 1);\n        while(1)\n        {\n                int *ptr[10] = {0};\n                // count, bytes, ptr\n                keep_mallocing(10, 1000000, ptr);\n\n                sleep (1);\n                // count, ptr\n                keep_freeing(7, ptr);\n                sleep (5);\n        }\n\n    return 0;\n}\n</code></pre>\n\n<p>I m using below command to compile the code (I have tried both static and dynamic linking)</p>\n\n<p><code>gcc  -ggdb3 use_jemalloc.c -std=gnu99 -o abc /usr/local/lib/libjemalloc.a -lpthread -ldl -lm</code></p>\n\n<p>If i export the variable and then run things seems to be working</p>\n\n<pre><code>$ ls\nabc  use_jemalloc.c\n\n$ export MALLOC_CONF=\"prof:true,prof_prefix:jeprof.out\"\n\n$ ./abc &amp;\n[1] 23220\n\n$ kill -10 `pidof abc`\npath : prof:true,prof_prefix:jeprof.out\n\n$ ls\nabc  jeprof.out.23220.0.m0.heap  use_jemalloc.c\n\n</code></pre>\n\n<p>But if u nullify the variable and then it doesn't generate anything</p>\n\n<pre><code>$ rm jeprof.*\n\n$ ls\nabc  use_jemalloc.c\n\n$ export MALLOC_CONF=\n$ echo $MALLOC_CONF\n\n\n$ ./abc &amp;\n[1] 23244\n\n$ kill -10 `pidof abc`\npath : prof:true,prof_prefix:jeprof.out\n\n$ ls\nabc  use_jemalloc.c\n</code></pre>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1568198212, "post_id": 57887211, "comment_id": 102196415, "body": "did you mean <code>n &lt; b</code>?"}, {"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 0, "creation_date": 1568198218, "post_id": 57887211, "comment_id": 102196418, "body": "Quick guess: <code>n &gt; b</code> should be <code>n &lt; b</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1568199733, "post_id": 57887211, "comment_id": 102197206, "body": "If someone enters 2 and 7, in the first loop iteration <code>n</code> and <code>a</code> will have value <code>2</code>,  <code>b</code> will have the value <code>7</code>, so <code>n &gt; b</code> will be false, and the loop body never executes.   You probably intended the condition to be <code>n &lt; b</code>, not <code>n &gt; b</code>.   Accordingly, voting to close as a typo."}], "answers": [{"tags": [], "owner": {"reputation": 898, "user_id": 4439699, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jWFeg.jpg?s=128&g=1", "display_name": "Ruchir", "link": "https://stackoverflow.com/users/4439699/ruchir"}, "is_accepted": true, "score": 0, "last_activity_date": 1568278327, "last_edit_date": 1568278327, "creation_date": 1568198885, "answer_id": 57887460, "question_id": 57887211, "link": "https://stackoverflow.com/questions/57887211/program-wont-run-for-loop/57887460#57887460", "title": "Program wont run for loop?", "body": "<pre><code>for (n=a; n &lt; b; n++)\n</code></pre>\n\n<p>n should be <strong>less than</strong> b in order to run the loop</p>\n"}], "owner": {"reputation": 3, "user_id": 12052413, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396180463768908/picture?type=large", "display_name": "Michael Sheehan", "link": "https://stackoverflow.com/users/12052413/michael-sheehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1568199815, "accepted_answer_id": 57887460, "answer_count": 1, "score": -1, "last_activity_date": 1568278327, "creation_date": 1568197984, "last_edit_date": 1568198234, "question_id": 57887211, "link": "https://stackoverflow.com/questions/57887211/program-wont-run-for-loop", "closed_reason": "Not suitable for this site", "title": "Program wont run for loop?", "body": "<p>I am writing a program which gets the sum of the square of each digit of a given number and keeps doing this for the new number until that number is either 42 or 1, this program does this for a range of numbers and finds how many number end up at 42 using this method.</p>\n\n<p>when running my program in terminal it wont enter the for loop</p>\n\n<p>I am new to coding so im sure its something simple.</p>\n\n<p>I have played around using different variables and replacing the first for loop with a while but it still doesn't enter loop</p>\n\n<pre><code>  int a, b, x, n, y, z, m;\n\nscanf(\"%d %d\", &amp;a, &amp;b);\n\nfor (n=a; n &gt; b; n++){\n m = n; \n printf(\"entered for loop \\n\");\n while (m != 42) {\n    y= m%10;\n    x = x + (y*y);\n    y = (m/10)%10;\n    x = x + (y*y);\n    y = (m/100)%10;\n    x = x + (y*y);\n    y = (m/1000)%10;\n    x = x + (y*y);\n    y = (m/10000)%10;\n    x = x + (y*y);\n    y = (m/100000);\n    x = x + (y*y);\n\n     if (x == 42){\n      z = z + 1;\n\n    }\n\n    m = x;\n }\n}\n\nprintf(\"%d\\n\", z);\n</code></pre>\n\n<p>so if someone inputs 2 and 10 i should get 7, i think there is still some fine tweaking to do to the code but im just rally stuck on this for loop</p>\n"}, {"tags": ["c", "mingw", "unix-timestamp", "epoch", "localtime"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1568194012, "post_id": 57885666, "comment_id": 102194278, "body": "what if you use : <code>printf(&quot;W1=%lld W2=%lld W3=%lld\\n&quot;,((long long) w1),((long long) w2),((long long) w3));</code> ?"}, {"owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1568195235, "post_id": 57885666, "comment_id": 102194893, "body": "@SanderDeDycker Thanks, you are right. <code>%d</code> is the wrong printf format to use because it is a 64-bit value. Going to update my question with adjusted code, the problem appears a bit different after doing this."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568198313, "post_id": 57885666, "comment_id": 102196466, "body": "Perhaps <a href=\"https://linux.die.net/man/3/localtime_r\" rel=\"nofollow noreferrer\">For portable code tzset(3) should be called before localtime_r()</a> applies?"}, {"owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568198614, "post_id": 57885666, "comment_id": 102196625, "body": "@chux yes you are right about PRId64 for errno being overkill. I had a problem before I was using %d for 64-bit values, I went a bit overboard in remedying that. Changed it now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568198711, "post_id": 57885666, "comment_id": 102196683, "body": "As a matter of good investigation of why things may be failing, it would make sense to check the return value of the various <code>localtime_r()</code> calls as it &quot;returns the value described, or NULL ... in case an error was detected.&quot;"}, {"owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568199223, "post_id": 57885666, "comment_id": 102196962, "body": "@chux: Thanks for your suggestions. I tried adding <code>tzset()</code>, it made no difference. I also tried checking the return value of <code>localtime_r</code>. When it leaves errno as 0, it returns the expected pointer. When it sets errno to 22 (which I believe is EINVAL), the return value is NULL (for the second localtime_r call), or ((struct tm*)-1) (for the third one.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1568200313, "post_id": 57885666, "comment_id": 102197514, "body": "Note: 47244640256 == 0xB00000000, certainly an error value.  I suspect problem is simplified to why does <code>w2 = mktime(&amp;t1);</code> act wonky.  Might be illustrative to print the entire contents of <code>t1</code> before and after <code>mktime()</code>. Perhaps the prior <code>localtime_r(&amp;w1,&amp;t1);</code> put junk in <code>t1</code> - or is it <code>mktime(&amp;t1);</code> that is errant?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1568201905, "post_id": 57885666, "comment_id": 102198298, "body": "Might it be that <code>mktime</code> returns a 32bit value (ie. <code>0x00000000</code>), but the caller expects a 64bit value (adding the <code>0xB</code> garbage) ? Ie. might this be an abi mismatch ? Or iow : was the library that implements <code>mktime</code> also built with <code>-D__MINGW_USE_VC2005_COMPAT=1</code> or equivalent ?"}, {"owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1568235108, "post_id": 57885666, "comment_id": 102214383, "body": "@SanderDeDycker Thanks, that was it basically. When you <code>#define __MINGW_USE_VC2005_COMPAT 1</code>, then <code>localtime_s</code> is defined as an inline function which calls <code>_localtime64_s</code>. And <code>#define _POSIX_THREAD_SAFE_FUNCTIONS</code> defines <code>localtime_r</code> as an inline function which calls <code>localtime_s</code>. However, <code>mktime</code> is still 32-bit. To get 64-bit <code>mktime</code>, you need to also <code>#define __MSVCRT_VERSION__ 0x1400</code> (or higher). Once you do that, <code>mktime</code> becomes an inline function which calls <code>_mktime64</code>. Before that, <code>mktime</code> is a normal function declaration which is linked to the legacy 32-bit <code>mktime</code>"}, {"owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "edited": false, "score": 0, "creation_date": 1568235271, "post_id": 57885666, "comment_id": 102214451, "body": "So <code>#define __MINGW_USE_VC2005_COMPAT 1</code> without <code>#define __MSVCRT_VERSION__ 0x1400</code> (or <code>-D</code> equivalent) gives you a <code>localtime_r</code> with 64-bit <code>time_t</code>, but a <code>mktime</code> with 32-bit <code>time_t</code>, which obviously won&#39;t work. (Or, I think even worse than that, the actual implementation of the <code>mktime</code> symbol is returning a 32-bit <code>time_t</code>, but the function declaration is for a 64-bit <code>time_t</code>, which is what causes the junk in the upper 32-bits.)"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1568269181, "post_id": 57885666, "comment_id": 102222048, "body": "@SimonKissane : can you turn that information into an answer, so it serves others with the same issue ? Related : <a href=\"https://stackoverflow.com/help/self-answer\">Can I answer my own qustion ?</a>"}, {"owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1568275004, "post_id": 57885666, "comment_id": 102224609, "body": "@SanderDeDycker Thanks, I just did that now."}], "answers": [{"tags": [], "owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "is_accepted": true, "score": 1, "last_activity_date": 1568274978, "creation_date": 1568274978, "answer_id": 57902195, "question_id": 57885666, "link": "https://stackoverflow.com/questions/57885666/mingw-localtime-r-works-in-one-time-zone-fails-in-another/57902195#57902195", "title": "MinGW localtime_r works in one time zone, fails in another", "body": "<p>I worked out the cause of the problem. Sander De Dycker's suggestion, that <code>mktime</code> is returning a 32-bit value, is correct.</p>\n\n<p>The problem is basically this: the MSVCRT defines three <code>mktime</code> functions: <code>_mktime32</code> for 32-bit time_t, <code>_mktime64</code> for 64-bit time_t, and <code>_mktime</code> which is a legacy alias for <code>_mktime32</code>.</p>\n\n<p><a href=\"https://github.com/mirror/mingw-w64/blob/v6.0.0/mingw-w64-headers/crt/_mingw.h.in#L369\" rel=\"nofollow noreferrer\">_mingw.h</a> does a <code>#define _USE_32BIT_TIME_T</code> in 32-bit code unless you <code>#define __MINGW_USE_VC2005_COMPAT</code> to disable that. Once you have <code>#define __MINGW_USE_VC2005_COMPAT</code>, then localtime_s is defined as an inline function which calls _localtime64_s. And <code>#define _POSIX_THREAD_SAFE_FUNCTIONS</code> defines <code>localtime_r</code> as an inline function which calls <code>localtime_s</code>. However, <code>mktime</code> is still 32-bit. To get 64-bit <code>mktime</code>, you need to also <code>#define __MSVCRT_VERSION__ 0x1400</code> (or higher). Once you do that, <code>mktime</code> becomes an inline function which calls <code>_mktime64</code>. Before that, <code>mktime</code> is a normal function declaration which is linked to the legacy 32-bit <code>mktime</code>. </p>\n\n<p>So <code>#define __MINGW_USE_VC2005_COMPAT 1</code> without <code>#define __MSVCRT_VERSION__ 0x1400</code> (or <code>-D</code> equivalent) gives you a <code>localtime_r</code> with 64-bit <code>time_t</code>, but a <code>mktime</code> with 32-bit <code>time_t</code>, which obviously won't work. Even worse than that, the actual implementation of the <code>mktime</code> symbol is returning a 32-bit <code>time_t</code>, but the function declaration is for a 64-bit <code>time_t</code>, which is what causes the junk in the upper 32-bits.</p>\n\n<p>As to the difference behaviour in different time zones, I don't have a complete explanation for that, but I think the reason is likely as follows: when you have a function which actually returns a 32-bit value but is incorrectly being defined to return a 64-bit value, the upper 32-bits of the return value will hold random junk data left over from previous calculations. So, any difference in the previous calculations, or slightly different code paths, may result in different random junk. With a UTC-8 timezone, for whatever reason, the random junk is coincidentally zero, so the code (despite its incorrectness) actually works. With a UTC+10 timezone, the random junk turns out to be non-zero, which causes the rest of the code to stop working.</p>\n"}], "owner": {"reputation": 3290, "user_id": 2147204, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jhjWO.jpg?s=128&g=1", "display_name": "Simon Kissane", "link": "https://stackoverflow.com/users/2147204/simon-kissane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 57902195, "answer_count": 1, "score": 2, "last_activity_date": 1568274978, "creation_date": 1568192659, "last_edit_date": 1568199176, "question_id": 57885666, "link": "https://stackoverflow.com/questions/57885666/mingw-localtime-r-works-in-one-time-zone-fails-in-another", "title": "MinGW localtime_r works in one time zone, fails in another", "body": "<p>I have the following file test.c:</p>\n\n<pre><code> #define _POSIX_THREAD_SAFE_FUNCTIONS\n #include &lt;time.h&gt;\n #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;\n #include &lt;stdint.h&gt;\n #include &lt;inttypes.h&gt;\n\n int main(int argc,char**argv) {\n    struct tm t1, t2, t3;\n    time_t w1, w2, w3;\n    memset(&amp;t1,0,sizeof(struct tm));\n    memset(&amp;t2,0,sizeof(struct tm));\n    memset(&amp;t3,0,sizeof(struct tm));\n    w1 = 0;\n    errno = 0;\n    localtime_r(&amp;w1,&amp;t1);\n    printf(\"localtime_r: errno=%d\\n\",errno);\n    errno = 0;\n    w2 = mktime(&amp;t1);\n    printf(\"mktime: errno=%d result=%\" PRId64 \"\\n\",errno,((int64_t)w2));\n    errno = 0;\n    localtime_r(&amp;w2,&amp;t2);\n    printf(\"localtime_r: errno=%d\\n\",errno);\n    errno = 0;\n    w3 = mktime(&amp;t2);\n    printf(\"mktime: errno=%d result=%\" PRId64 \"\\n\",errno,((int64_t)w3));\n    errno = 0;\n    localtime_r(&amp;w3,&amp;t3);\n    printf(\"localtime_r: errno=%d\\n\",errno);\n    printf(\"sizeof(time_t)=%\" PRId64 \"\\n\", ((int64_t)sizeof(time_t)));\n    printf(\"W1=%\" PRId64 \" W2=%\" PRId64 \" W3=%\" PRId64 \"\\n\",((int64_t)w1),((int64_t)w2),((int64_t)w3));\n    printf(\"Y1=%d Y2=%d Y3=%d\\n\",t1.tm_year,t2.tm_year,t3.tm_year);\n    return 0;\n }\n</code></pre>\n\n<p>I compile it like this:</p>\n\n<pre><code>i686-w64-mingw32-gcc -D__MINGW_USE_VC2005_COMPAT=1 -o test.exe test.c\n</code></pre>\n\n<p>Note, <code>i686-w64-mingw32-gcc --version</code> reports <code>8.3-win32 20190406</code>\nThis is running in a Docker image of Ubuntu 19.04, using the MinGW version\nthat comes with Ubuntu 19.04 (it says version 6.0.0-3).</p>\n\n<p>I have a Windows 10 VM (Version 1809 OS Build 17763.379).\nBy default, time zone is set to US Pacific Time (UTC-8).\nI copy test.exe to this VM and run it there.</p>\n\n<p>It prints:</p>\n\n<pre><code>localtime_r: errno=0\nmktime: errno=0 result=0\nlocaltime_r: errno=0\nmktime: errno=0 result=0\nlocaltime_r: errno=0\nsizeof(time_t)=8\nW1=0 W2=0 W3=0\nY1=69 Y2=69 Y3=69\n</code></pre>\n\n<p>That's the expected result. (At UTC midnight on 1 Jan 1970, it was still 1969 in UTC-8.)</p>\n\n<p>I change the Windows time zone to UTC+10 (Canberra, Melbourne, Sydney).\nRun it again. It prints:</p>\n\n<pre><code>localtime_r: errno=0\nmktime: errno=0 result=47244640256\nlocaltime_r: errno=22\nmktime: errno=22 result=4294967295\nlocaltime_r: errno=0\nsizeof(time_t)=8\nW1=0 W2=47244640256 W3=4294967295\nY1=70 Y2=-1 Y3=206\n</code></pre>\n\n<p>It seems the mktime() call is returning an invalid value in UTC+10 time zone, but returns the correct value of 0 in UTC-8 time zone. </p>\n\n<p>Why does this code work in one timezone break in another?</p>\n\n<p>Note, this is only a problem with <code>-D__MINGW_USE_VC2005_COMPAT=1</code> to enable\n64-bit time_t. If I leave that out, which means 32-bit time_t, then the code\nworks in both timezones. (But, 32-bit time_t is not a good idea, because it breaks in the year 2038, and that's less than twenty years away now.)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568191920, "post_id": 57885436, "comment_id": 102193232, "body": "The <code>malloc</code> and <code>free</code> calls aren&#39;t handled by the compiler itself, but the &quot;standard library&quot;. How the library implements it differs, and sometime it could be using the native allocator of the operating system in which case it doesn&#39;t know anything about sizes either."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1568191952, "post_id": 57885436, "comment_id": 102193249, "body": "It&#39;s not the compiler which knows the size of the block, but the OS and the programmer who allocated it."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1568192033, "post_id": 57885436, "comment_id": 102193294, "body": "@WeatherVane When you call <code>free</code> you don&#39;t say: <code>free this size</code>; you just provide the pointer. So the compiler must know how much memory is allocated. Am I wrong?"}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 2, "creation_date": 1568192076, "post_id": 57885436, "comment_id": 102193317, "body": "No, the compiler doesn&#39;t say &quot;free this size&quot;, it says &quot;free the block starting at this address&quot;. It&#39;s the allocator who takes care of how much to free, and the allocator may reside in the OS, with the compiler not knowing about it."}, {"owner": {"reputation": 1052, "user_id": 4805355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c429ce26c5a5065a0e199f4dcede7b71?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Rusu", "link": "https://stackoverflow.com/users/4805355/vlad-rusu"}, "edited": false, "score": 2, "creation_date": 1568192107, "post_id": 57885436, "comment_id": 102193333, "body": "@nicola The compiler doesn&#39;t know anything. It&#39;s the <code>c</code> standard library which implements the <code>malloc</code> and <code>free</code> functions and that&#39;s completely independent by the compiler itself."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192113, "post_id": 57885436, "comment_id": 102193339, "body": "No, the compiler knows nothing about it. The size might not even be known during compilation. If it was, an array could be used."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192251, "post_id": 57885436, "comment_id": 102193410, "body": "@WeatherVane I see what you say, but so the problem is another. When you <code>malloc</code>, somewhere the size is stored. So you just expose a function that returns the size, that&#39;s my question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192351, "post_id": 57885436, "comment_id": 102193451, "body": "@nicola one reason it is absent, is because it isn&#39;t necessary. After <code>malloc(x)</code> you already know <code>x</code> since it was your own code that set it."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "reply_to_user": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1568192367, "post_id": 57885436, "comment_id": 102193462, "body": "@moooeeeep Thank you, I was sure that it was a dupe. Couldnt&#39; find it. This question can be closed as dupe IMO."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192433, "post_id": 57885436, "comment_id": 102193495, "body": "@WeatherVane One might argue that most of the functions of, say, <code>string.h</code> aren&#39;t necessary, but they are there."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192566, "post_id": 57885436, "comment_id": 102193567, "body": "@nicola that&#39;s rather different, for example <code>strlen</code> is used because the programmer doesn&#39;t yet know the length of a string entered by the user at run time."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192630, "post_id": 57885436, "comment_id": 102193600, "body": "@WeatherVane Sure, but it would be trivial to implement. So it&#39;s not necessary."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568192679, "post_id": 57885436, "comment_id": 102193615, "body": "You can implement your own <code>malloc</code> too if you want."}, {"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "edited": false, "score": 0, "creation_date": 1568192739, "post_id": 57885436, "comment_id": 102193656, "body": "Indeed. That&#39;s my point. The &quot;necessity&quot; point is not a reason why a function is provided or not."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1568193150, "post_id": 57885436, "comment_id": 102193891, "body": "The allocation size stored in the control block (if there is indeed such a thing) is <i>not necessarily</i> the size passed to <code>malloc</code>. Exposing it won&#39;t do you much good."}], "answers": [{"comments": [{"owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "edited": false, "score": 0, "creation_date": 1568192575, "post_id": 57885540, "comment_id": 102193570, "body": "I like a lot the first sentence and the fact that it requires some work. Of course it&#39;s not necessary, but it might be handy. Many functions provided by the standard aren&#39;t actually necessary."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1568192163, "creation_date": 1568192163, "answer_id": 57885540, "question_id": 57885436, "link": "https://stackoverflow.com/questions/57885436/why-the-c-standard-doesnt-expose-a-function-to-get-the-size-of-a-malloced-bloc/57885540#57885540", "title": "Why the C standard doesn&#39;t expose a function to get the size of a malloc&#39;ed block?", "body": "<p>Such a function does not exist since nobody has managed to convince the C standards committee of its necessity.</p>\n\n<p>Providing it might also require additional interfacing with the operating system - where such memory tasks are often delegated, so that could require changes to be made in order to implement the new functionality. That could damage the reputation of C as being supported by many platforms.</p>\n\n<p>Lastly, what would you use it for? I can't conject a use case. If you want to keep track of allocated sizes yourself, then create stub functions for <code>malloc</code>, <code>realloc</code>, &amp;c.</p>\n"}, {"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1568269501, "post_id": 57885761, "comment_id": 102222157, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/199351/discussion-on-answer-by-th33lf-why-the-c-standard-doesnt-expose-a-function-to-g\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "is_accepted": true, "score": 6, "last_activity_date": 1568201061, "last_edit_date": 1568201061, "creation_date": 1568193009, "answer_id": 57885761, "question_id": 57885436, "link": "https://stackoverflow.com/questions/57885436/why-the-c-standard-doesnt-expose-a-function-to-get-the-size-of-a-malloced-bloc/57885761#57885761", "title": "Why the C standard doesn&#39;t expose a function to get the size of a malloc&#39;ed block?", "body": "<p>Because it is completely unnecessary. The user who called <code>malloc()</code> already knows the size s/he asked for. If they want to store it, they can use a variable to do that. They could even store it inside the malloc'd memory itself!</p>\n\n<p>Secondly, when you call <code>malloc(size)</code>, you almost never get a memory block of exactly <code>size</code> bytes. The only thing the standard guarantees is that you get at least <code>size</code> bytes. This difference could be due to reasons like alignment, using larger block sizes to prevent fragmentation, etc.. </p>\n\n<p>Now, let's suppose that the standard library were to provide a function of the kind that you asked. Should it give you the allocated size or the requested size? The allocated size is heavily implementation dependent and practically meaningless since you are only allowed to access as many bytes as you initially asked for. If you go beyond that, it is undefined behaviour. If you say requested size, the implementation only needs the allocated size to handle the free, so why should it waste memory storing the requested size as well?</p>\n"}], "owner": {"reputation": 21821, "user_id": 3987294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4751b219bec937f1c58a18de85dcd06?s=128&d=identicon&r=PG&f=1", "display_name": "nicola", "link": "https://stackoverflow.com/users/3987294/nicola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "closed_date": 1568193317, "accepted_answer_id": 57885761, "answer_count": 2, "score": 1, "last_activity_date": 1568201061, "creation_date": 1568191741, "question_id": 57885436, "link": "https://stackoverflow.com/questions/57885436/why-the-c-standard-doesnt-expose-a-function-to-get-the-size-of-a-malloced-bloc", "closed_reason": "Duplicate", "title": "Why the C standard doesn&#39;t expose a function to get the size of a malloc&#39;ed block?", "body": "<p>Say that you allocate some memory on the heap through <code>malloc</code>:</p>\n\n<pre><code>someType x  = malloc(someSize);\n</code></pre>\n\n<p>When you don't need <code>x</code> anymore, you <code>free</code> it:</p>\n\n<pre><code>free(x)\n</code></pre>\n\n<p>To perform this operation, I guess, the compiler must know the size of the memory <code>x</code> points to. I think <code>free</code> performs something like:</p>\n\n<ol>\n<li>Read the value contained in <code>x</code> (say it is 16).</li>\n<li>Determine <em>in some way</em> the memory size allocated at 16 (say it's 8).</li>\n<li>Tell OS that the 16-23 memory region is not longer needed and the OS can do whatever it wants with it.</li>\n</ol>\n\n<p>If the above is true, why the standard doesn't prescribe a function that just performs the above till step 2 and returns the size to the programmer, without actually freeing the memory?</p>\n\n<p>Some (not much convincing) reasons I read online:</p>\n\n<ul>\n<li><em><code>malloc()</code> implementations usually keep track of a region's size, but they may do this indirectly, or round it up to some value, or not keep it at all</em>. It's that true? Can possibly <code>malloc</code> not keep track of the size? </li>\n<li><em>Because C is a low-level programming language, it expects you to take care of these issues yourself, but this adds greater flexibility in exactly how you implement it</em>. Ok, this is more philosophical. Nonetheless, C standard has evolved and has provided, over time, more headers, functions and tools. </li>\n<li><em>You should rewrite every compiler to implement such function</em>. Is that true? If <code>free</code> is already implemented, you just need a part of it; the implementation should be trivial.</li>\n</ul>\n\n<p><strong>So, there is a cogent, impellent, real reason why this function is not provided? Or, more likely, why the above reasons are actually important and what I am missing?</strong></p>\n\n<p>I think that this question has been already asked (and very likely a dupe), but I was able only to find similar subjects, for instance (btw the below questions are where I found some of the objections I reported above):</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1281686/determine-size-of-dynamically-allocated-memory-in-c\">Here</a> is discussed whether such function exists, but not why it doesn't. </p>\n\n<p><a href=\"https://softwareengineering.stackexchange.com/questions/237286/why-do-c-arrays-not-keep-track-of-their-length\">Here</a> is discussed about (stack-allocated)arrays.</p>\n"}, {"tags": ["c++", "c", "visual-studio-code", "vscode-settings"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1568189172, "post_id": 57884650, "comment_id": 102191829, "body": "a pity that you have to use a non-sense formattting. Note that what you have to write is bad because imagine you have to add a line <code>some_type_with_long_name x;</code> then you have to modify all lines above, this is a major annoyance in version control. Also <code>char  *s;</code> should rather be <code>char* s;</code> (however, thats slightly opinion based)"}, {"owner": {"reputation": 902, "user_id": 9172668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q4sZM.png?s=128&g=1", "display_name": "SASSY_ROG", "link": "https://stackoverflow.com/users/9172668/sassy-rog"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1568189463, "post_id": 57884650, "comment_id": 102191967, "body": "@formerlyknownas_463035818 I know but  we&#39;re are required to else we&#39;re graded with a 0."}, {"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 0, "creation_date": 1568189681, "post_id": 57884650, "comment_id": 102192087, "body": "in VSCode, there are some plugins such as <code>beautify</code> to help you align for example on the <code>=</code> sign, or space . You just need to know how to configure it"}, {"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1568189835, "post_id": 57884650, "comment_id": 102192181, "body": "@formerlyknownas_463035818, That issue of <code>char* s</code> or <code>char *s</code>, as you said, is opinion based but I have decided to keep the second notation just to specify that the type is <code>char</code> and not <code>char*</code>, just in case you would like to have multiple declarations on the same line"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568189955, "post_id": 57884650, "comment_id": 102192245, "body": "Well actually the type is <code>char *</code> LOL"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 1, "creation_date": 1568190138, "post_id": 57884650, "comment_id": 102192333, "body": "@PhoenixBlue the more common approach is to have only one variable declaration per line. And yes, the type is <code>char*</code> not <code>char</code>, thats exactly the rationale for writing <code>char* s;</code> instead of <code>char *s;</code>  the <code>*</code> is part of the type, not part of the variable name"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1568190464, "post_id": 57884650, "comment_id": 102192522, "body": "@formerlyknownas_463035818 that depends on the language."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1568190568, "post_id": 57884650, "comment_id": 102192576, "body": "@AnttiHaapala I was considering to complain about double tagging, but then remembered that often IDEs have options for &quot;C/C++&quot;. Sorry for going a bit offtopic in the comments, lets just leave it at: it depends ;)"}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 0, "creation_date": 1568201241, "post_id": 57884650, "comment_id": 102197935, "body": "I&#39;d say that in any way, it is imperative to work with the tools rather than against them. From that point of view, I&#39;d expect your teacher to provide the pupils with such tools. Therefore: Have you asked your teacher about this? Hopefully, he doesn&#39;t expect you to use a text editor or the like and do it manually. I mean, it is a very good idea to ask this here, shows initiative and such, just saying that the teacher should be active here."}], "answers": [{"comments": [{"owner": {"reputation": 902, "user_id": 9172668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q4sZM.png?s=128&g=1", "display_name": "SASSY_ROG", "link": "https://stackoverflow.com/users/9172668/sassy-rog"}, "edited": false, "score": 0, "creation_date": 1568189610, "post_id": 57884812, "comment_id": 102192051, "body": "Now how do I set it up in the C/C++ extension?"}, {"owner": {"reputation": 934, "user_id": 8474738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdPIm.jpg?s=128&g=1", "display_name": "Nathanael Demacon", "link": "https://stackoverflow.com/users/8474738/nathanael-demacon"}, "reply_to_user": {"reputation": 902, "user_id": 9172668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q4sZM.png?s=128&g=1", "display_name": "SASSY_ROG", "link": "https://stackoverflow.com/users/9172668/sassy-rog"}, "edited": false, "score": 0, "creation_date": 1568190709, "post_id": 57884812, "comment_id": 102192665, "body": "I edited my answer with an example, you just have to access the vscode configuration file"}, {"owner": {"reputation": 299, "user_id": 5735084, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fIg5JvYx_JI/AAAAAAAAAAI/AAAAAAAAABw/jX72fAzLFxQ/photo.jpg?sz=128", "display_name": "Joshua Jurgensmeier", "link": "https://stackoverflow.com/users/5735084/joshua-jurgensmeier"}, "edited": false, "score": 0, "creation_date": 1604080217, "post_id": 57884812, "comment_id": 114247786, "body": "People may also be interested in <code>AlignConsecutiveAssignments: true</code>. This aligns at the equal sign for assignments."}], "tags": [], "owner": {"reputation": 934, "user_id": 8474738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdPIm.jpg?s=128&g=1", "display_name": "Nathanael Demacon", "link": "https://stackoverflow.com/users/8474738/nathanael-demacon"}, "is_accepted": true, "score": 3, "last_activity_date": 1568190563, "last_edit_date": 1568190563, "creation_date": 1568189403, "answer_id": 57884812, "question_id": 57884650, "link": "https://stackoverflow.com/questions/57884650/auto-format-with-specific-indentation-alignment-c-c-in-vscode/57884812#57884812", "title": "Auto format with specific indentation/alignment C/C++ in vscode", "body": "<p>With the C/C++ extension you can configure the formater. Use <code>AlignConsecutiveDeclarations</code> from <a href=\"https://clang.llvm.org/docs/ClangFormatStyleOptions.html\" rel=\"nofollow noreferrer\">clang-format</a> to align variables like that.</p>\n\n<p>Example of configuration (for <code>C_Cpp.clang_format_style</code>):</p>\n\n<pre><code>{ BasedOnStyle: LLVM, AlignConsecutiveDeclarations: true }\n</code></pre>\n\n<p>So in your <code>settings.json</code> you can have something like this:</p>\n\n<pre><code>{\n  \"C_Cpp.clang_format_style\": \"{ BasedOnStyle: LLVM, AlignConsecutiveDeclarations: true }\",\n}\n</code></pre>\n"}], "owner": {"reputation": 902, "user_id": 9172668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q4sZM.png?s=128&g=1", "display_name": "SASSY_ROG", "link": "https://stackoverflow.com/users/9172668/sassy-rog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3177, "favorite_count": 0, "accepted_answer_id": 57884812, "answer_count": 1, "score": 3, "last_activity_date": 1568190563, "creation_date": 1568188821, "question_id": 57884650, "link": "https://stackoverflow.com/questions/57884650/auto-format-with-specific-indentation-alignment-c-c-in-vscode", "title": "Auto format with specific indentation/alignment C/C++ in vscode", "body": "<p>So I am working on a school project in <code>C</code> using vscode. One of the most important things that we're thoroughly graded against is neat code formatting. Say I have declared 3 variables like this</p>\n\n<pre><code>int     i;\nchar    *s;\nsize_t  t;\n</code></pre>\n\n<p>they must be aligned exactly like this. Now enabling the vscode <code>\"editor.formatOnSave\": true</code> in the settings/settings.json`\n changes this to </p>\n\n<pre><code>int i;\nchar *s;\nsize_t t;\n</code></pre>\n\n<p>now is the a way in vscode to keep these variables aligned in a specific way like the first snippet or have the alignment done automatically?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "edited": false, "score": 0, "creation_date": 1568184794, "post_id": 57883585, "comment_id": 102189752, "body": "You might want to post this code on <a href=\"https://codereview.stackexchange.com/\">Code Review</a>."}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 1, "creation_date": 1568184811, "post_id": 57883585, "comment_id": 102189763, "body": "By &quot;cycle&quot;, do you maybe mean &quot;loop&quot;?"}, {"owner": {"reputation": 49, "user_id": 12014341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcIoM.jpg?s=128&g=1", "display_name": "Nigan", "link": "https://stackoverflow.com/users/12014341/nigan"}, "edited": false, "score": 0, "creation_date": 1568184977, "post_id": 57883585, "comment_id": 102189844, "body": "Forgive me. I don&#39;t know much English."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1568184984, "post_id": 57883585, "comment_id": 102189848, "body": "Use separate loop variables.  Don\u2019t reuse <code>i</code> for multiple purposes."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568185359, "post_id": 57883585, "comment_id": 102190025, "body": "Now would be the perfect time for Captain Needa to come by."}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1568186949, "post_id": 57883585, "comment_id": 102190740, "body": "<code>I need to make the code more readable</code> the biggest problem about readability here is that it is not clear what each part of the code should do. So you should add some comments at critical parts of the code. And only reuse variables if it is really necessary. What situation does the  <code>if (i == numSocket)</code> detect?"}, {"owner": {"reputation": 49, "user_id": 12014341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcIoM.jpg?s=128&g=1", "display_name": "Nigan", "link": "https://stackoverflow.com/users/12014341/nigan"}, "reply_to_user": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1568187469, "post_id": 57883585, "comment_id": 102190984, "body": "@t.niese NumSocket stores information on how many servSock was created; in this case there are 2 first IPv4 second IPv6"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 12014341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcIoM.jpg?s=128&g=1", "display_name": "Nigan", "link": "https://stackoverflow.com/users/12014341/nigan"}, "edited": false, "score": 0, "creation_date": 1568186253, "post_id": 57883772, "comment_id": 102190408, "body": "I have PF_INET and PF_INET6 stored there, so this is most likely needed. <a href=\"https://docs.microsoft.com/en-us/windows/win32/winsock/ipv6-enabled-server-code-2\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/win32/winsock/&hellip;</a>"}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "reply_to_user": {"reputation": 49, "user_id": 12014341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcIoM.jpg?s=128&g=1", "display_name": "Nigan", "link": "https://stackoverflow.com/users/12014341/nigan"}, "edited": false, "score": 0, "creation_date": 1568190251, "post_id": 57883772, "comment_id": 102192400, "body": "@DarthVader Then if you assume that all of this is needed what do you want to simplify?"}, {"owner": {"reputation": 49, "user_id": 12014341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcIoM.jpg?s=128&g=1", "display_name": "Nigan", "link": "https://stackoverflow.com/users/12014341/nigan"}, "edited": false, "score": 0, "creation_date": 1568190583, "post_id": 57883772, "comment_id": 102192584, "body": "I want to rewrite everything so that the code becomes more understandable than now."}], "tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": false, "score": 1, "last_activity_date": 1568185431, "creation_date": 1568185431, "answer_id": 57883772, "question_id": 57883585, "link": "https://stackoverflow.com/questions/57883585/how-to-remove-an-extra-cycle/57883772#57883772", "title": "How to remove an extra cycle?", "body": "<p>As far as I understand your code, you don't need <code>FD_CLEAR()</code> your sockets one by one.<br>\nJust <code>FD_ZERO()</code> all of them at once, then use a single loop to <code>FD_SET()</code> them again.<br>\nNote that after <code>select()</code>, many sockets could be ready to use; you don't have to <code>break</code> when one has been used.<br>\nNote also that the first parameter of <code>select()</code> is unused on Windows but should be <strong>1+</strong> the <strong>max</strong> of your socket file descriptors (not the number of them) everywhere else.</p>\n\n<pre><code>for(;;)\n{\n    FD_ZERO(&amp;SockSet);\n    for (int i = 0; i &lt; numSocket; i++)\n    {\n        FD_SET(servSock[i], &amp;SockSet);\n    }\n    if (select(numSocket, &amp;SockSet, 0, 0, 0) == SOCKET_ERROR)\n        continue; // or probably break...\n    }\n    for (int i = 0; i &lt; numSocket; i++)\n    {\n        if (FD_ISSET(servSock[i], &amp;SockSet))\n        {\n            // use servSock[i]\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 3, "last_activity_date": 1568191468, "creation_date": 1568191468, "answer_id": 57885358, "question_id": 57883585, "link": "https://stackoverflow.com/questions/57883585/how-to-remove-an-extra-cycle/57885358#57885358", "title": "How to remove an extra cycle?", "body": "<p>To make the code more readable (and testable and maintainable) you can encapsulate some of the logic into separate functions with meaningful names. Consider this version of your loop</p>\n\n<pre><code>for(;;)\n{\n    int i = find_socket_to_be_served(numSocket, servSock, &amp;SockSet);\n\n    if (i == numSocket)\n    {\n        set_all_sockets(numSocket, servSock, &amp;SockSet);\n\n        if (select(numSocket, &amp;SockSet, 0, 0, 0) == SOCKET_ERROR)\n            continue;\n    }\n    // ...\n}\n</code></pre>\n\n<p>Where the two functions used are defined as</p>\n\n<pre><code>int find_socket_to_be_served(int n_sockets, int *fds, fd_set *fdset)\n{\n    int i = 0;\n    for (; i &lt; n_sockets; i++)\n    {\n        if (FD_ISSET(fds[i], fdset))\n        {\n            FD_CLR(fds[i], fdset);\n            break;\n        }\n    }\n    return i;\n}\n\nvoid set_all_sockets(int n_sockets, int *fds, fd_set *fdset)\n{\n    for (int i = 0; i &lt; n_sockets; i++)\n    {\n        FD_SET(fds[i], fdset);\n    }  \n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12014341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcIoM.jpg?s=128&g=1", "display_name": "Nigan", "link": "https://stackoverflow.com/users/12014341/nigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 57885358, "answer_count": 2, "score": 1, "last_activity_date": 1568191468, "creation_date": 1568184664, "last_edit_date": 1568187244, "question_id": 57883585, "link": "https://stackoverflow.com/questions/57883585/how-to-remove-an-extra-cycle", "title": "How to remove an extra cycle?", "body": "<p>I need to make the code more readable, but it has a lot of cycle, can I fix this somehow?</p>\n\n<p>The variable <code>i</code> constantly jumps there and there, it is very inconvenient to watch in debugging.</p>\n\n<pre><code>for(;;)\n{\n    //\n    // For connection orientated protocols, we will handle the\n    // packets received from a connection collectively.  For datagram\n    // protocols, we have to handle each datagram individually.\n    //\n\n    //\n    // Check to see if we have any sockets remaining to be served\n    // from previous time through this loop.  If not, call select()\n    // to wait for a connection request or a datagram to arrive.\n    //\n\n    for (i = 0; i &lt; numSocket; i++)\n    {\n        if (FD_ISSET(servSock[i], &amp;SockSet))\n            break;\n    }\n\n    if (i == numSocket)\n    {\n        for (i = 0; i &lt; numSocket; i++)\n        {\n            FD_SET(servSock[i], &amp;SockSet);\n        }\n\n        if (select(numSocket, &amp;SockSet, 0, 0, 0) == SOCKET_ERROR)\n            continue;\n    }\n\n    for (i = 0; i &lt; numSocket; i++)\n    {\n        if (FD_ISSET(servSock[i], &amp;SockSet))\n        {\n            FD_CLR(servSock[i], &amp;SockSet);\n            break;\n        }\n    }\n\n...\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "loops", "for-loop", "pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568183885, "post_id": 57883375, "comment_id": 102189410, "body": "Also note that the contents of the memory you allocate isn&#39;t always initialized."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568184646, "post_id": 57883375, "comment_id": 102189681, "body": "You are not supposed to return the array by overwriting <code>returnSize</code>. You are supposed to return the size of the returned array by writing it to the variable referred by <code>returnSize</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568190704, "post_id": 57883375, "comment_id": 102192660, "body": "LeetCode\u2019s problem statement is defective. It fails to state what the <code>returnSize</code> parameter is for and, if it is for the size of the returned array, whether the units are elements or bytes. And, since the size is necessarily two elements, it is not clear why there is a parameter to wastefully return this constant."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568190348, "post_id": 57883601, "comment_id": 102192458, "body": "The problem is inadequately stated. The interface is inefficient regardless because the necessary size is already known to be two elements. And the problem does not state whether the size is given in units of elements or bytes."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 1, "last_activity_date": 1568185060, "last_edit_date": 1568185060, "creation_date": 1568184717, "answer_id": 57883601, "question_id": 57883375, "link": "https://stackoverflow.com/questions/57883375/function-is-not-able-to-return-elements-in-returnsize-array-in-the-problem/57883601#57883601", "title": "Function is not able to return elements in returnSize array in the problem", "body": "<p>The interface of the function is designed to provide a two-part result, the array and its size.<br>\nYou are not supposed to return the array by overwriting <code>returnSize</code>.<br>\nYou are supposed to return the size of the returned array by writing it to the int variable referred by the pointer <code>returnSize</code> (and probably check that it is not a NULL pointer).</p>\n\n<p>The array (i.e. the newly malloced pointer) is supposed to be returned via <code>return</code>, which of course you do. But doing that by overwriting return parameter pointer is what indirectly causes a problem here. (A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mre</a> would be required to trace the observed problem to this.)</p>\n\n<p>By the way, I spotted this simply by seeing that you ignore and overwrite one of the parameters, the pointer. If that were correct, then the interface of the function would be inefficient. That can be the case, but usually not for challenges.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568190396, "post_id": 57883654, "comment_id": 102192490, "body": "The challenge gives a routine prototype which must not be altered"}, {"owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568190903, "post_id": 57883654, "comment_id": 102192739, "body": "i give suggest in real world,i dont know how about LeetCode."}], "tags": [], "owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1568184987, "creation_date": 1568184987, "answer_id": 57883654, "question_id": 57883375, "link": "https://stackoverflow.com/questions/57883375/function-is-not-able-to-return-elements-in-returnsize-array-in-the-problem/57883654#57883654", "title": "Function is not able to return elements in returnSize array in the problem", "body": "<p>You can return in for loop reduce your code's complex</p>\n\n<p>then will be more read-able</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint* twoSum(int* nums, int numsSize, int target){\n    int i,j;\n    int* returnSize= (int*)malloc(sizeof(int)*2);\n    for(i=0;i&lt;numsSize;i++){\n        for(j=i+1;j&lt;numsSize;j++){\n            if(nums[i]+nums[j]==target){\n                returnSize[0] = i;\n                returnSize[1] = j;\n                return returnSize;\n            }\n        }  \n    }\n    free(returnSize);\n    return NULL;\n}\nint main(){\n    int Test[4]={2, 7, 11, 15};\n    int Target=18;\n    int *Result=twoSum(Test,4,Target);\n    if(Result){//not NULL\n        printf(\"place:[%d,%d]\\n\",Result[0],Result[1]);\n        printf(\"Value:[%d,%d]\\n\",Test[Result[0]],Test[Result[1]]);\n        free(Result);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1568209870, "last_edit_date": 1568209870, "creation_date": 1568202818, "answer_id": 57888571, "question_id": 57883375, "link": "https://stackoverflow.com/questions/57883375/function-is-not-able-to-return-elements-in-returnsize-array-in-the-problem/57888571#57888571", "title": "Function is not able to return elements in returnSize array in the problem", "body": "<p>I can not reproduce the problem for the provided array. But in any case the function is incorrect..</p>\n\n<p>Instead of this statement (where the argument of the malloc call does not make sense) </p>\n\n<pre><code>re = (int*)malloc(sizeof(returnSize));\n                         ^^^^^^^^^^^\n</code></pre>\n\n<p>there should be</p>\n\n<pre><code>re = (int*)malloc(sizeof( sizeof( int ) * *returnSize ));\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Though the parameter <code>returnSize</code> is redundant because the array according to your description has a fixed size equal to 2.</p>\n\n<p>Moreover there is an unused variable <code>sz=1</code></p>\n\n<p>The function can invoke undefined behavior because in the case when the <code>target</code> is equal to <code>0</code> then the dynamically allocated array is not initialized and has indeterminate values because there is exit from the loop.</p>\n\n<pre><code>for(i=0;i&lt;numsSize;i++){\n\n     if(sum==target){\n            break;\n        }\n    // ... \n</code></pre>\n\n<p>There is no need to dynamically allocate an array. You could return a structure of two elements.</p>\n\n<p>The first parameter should be declared with the qualifier <code>const</code>. </p>\n\n<p>The function can be written simpler and more clear and readable.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct PairIndices\n{\n    size_t first;\n    size_t second;\n};\n\nstruct PairIndices twoSum( const int *a, size_t n, int target )\n{\n    struct PairIndices pair = { n, n };\n\n    for ( size_t i = 0; i &lt; n &amp;&amp; pair.first == n ; i++ )\n    {\n        size_t j = 1;\n\n        while ( j &lt; n &amp;&amp; a[i] + a[j] != target ) j++;\n\n        if ( j != n )\n        {\n            pair.first  = i;\n            pair.second = j;\n        }\n    }\n\n    return pair;\n}\n\nint main(void) \n{\n    int a[] = { 2, 7, 11, 15 };\n    const size_t N = sizeof( a ) / sizeof( *a );\n    int target = 9;\n\n    struct PairIndices pair = twoSum( a, N, target );\n\n    if ( pair.first != N )\n    {\n        printf( \"a[%zu] + a[%zu] == %d\\n\", pair.first, pair.second, target );\n    }\n    else\n    {\n        printf( \"There are no two elements in the array \"\n                \"sum of which is equal to %d\\n\", target );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>a[0] + a[1] == 9\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 11567961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LdZzP.jpg?s=128&g=1", "display_name": "SREERAG R NANDAN", "link": "https://stackoverflow.com/users/11567961/sreerag-r-nandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568209870, "creation_date": 1568183721, "last_edit_date": 1568205783, "question_id": 57883375, "link": "https://stackoverflow.com/questions/57883375/function-is-not-able-to-return-elements-in-returnsize-array-in-the-problem", "title": "Function is not able to return elements in returnSize array in the problem", "body": "<p>I tried to solve a C coding problem Two Sum in Online coding platform LeetCode\nI am not able to return the integer pointer size.</p>\n\n<p>Question:\nGiven an array of integers, return indices of the two numbers such that they add up to a specific target. You may assume that each input would have exactly one solution, and you may not use the same element twice.</p>\n\n<p>Example:</p>\n\n<p>Given nums = [2, 7, 11, 15], target = 9,</p>\n\n<p>Because nums[0] + nums[1] = 2 + 7 = 9,\nreturn [0, 1].</p>\n\n<pre><code>/**\n * Note: The returned array must be malloced, assume caller calls free().\n */\nint* twoSum(int* nums, int numsSize, int target, int* returnSize){\n    int i,j,sum=0,n1=0,n2=0,sz=1;\n    int *re;\n    re = (int*)malloc(sizeof(returnSize));\n    for(i=0;i&lt;numsSize;i++){\n\n         if(sum==target){\n                break;\n            }\n        n1 = i;\n        for(j=i+1;j&lt;numsSize;j++){\n            sum = nums[i]+nums[j];\n\n            if(sum==target){\n                n2 = j;\n                re[0] = n1;\n                re[1] = n2;\n                break;\n\n            }\n        }  \n    }\n\n    return re;\n}\n</code></pre>\n\n<p>\u201cI expect the output of <code>nums = [2, 7, 11, 15]</code>, <code>target = 9</code>, to be <code>[0, 1]</code>, but the actual output is <code>]</code>\u201d</p>\n"}, {"tags": ["c", "pointers", "memory-address"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1568183593, "post_id": 57883128, "comment_id": 102189296, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36967840/c-gcc-generates-wrong-instructions-when-returning-local-stack-address\">C - GCC generates wrong instructions when returning local stack address</a>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1568183769, "post_id": 57883128, "comment_id": 102189364, "body": "also : <a href=\"https://stackoverflow.com/questions/40290049/why-does-gcc-return-0-instead-of-the-address-of-a-stack-allocated-variable\">Why does gcc return 0 instead of the address of a stack allocated variable?</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1568184960, "post_id": 57883128, "comment_id": 102189839, "body": "Undefined behavior is behavior which is not defined. The compiler isn&#39;t obliged to produce any meaningful code. Speculating about why it generated a certain flavour of meaningless code isn&#39;t particularly interesting."}, {"owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1568201716, "post_id": 57883128, "comment_id": 102198219, "body": "@Lundin &quot;The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime.&quot; I didn&#39;t know that. That&#39;s why I asked the question."}], "answers": [{"comments": [{"owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "edited": false, "score": 0, "creation_date": 1568201520, "post_id": 57883307, "comment_id": 102198099, "body": "&quot;The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime.&quot; - That&#39;s what I was looking for. Thanks."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1568183426, "creation_date": 1568183426, "answer_id": 57883307, "question_id": 57883128, "link": "https://stackoverflow.com/questions/57883128/returning-address-of-a-local-variable-directly-using-address-of-operator-vs-usin/57883307#57883307", "title": "Returning address of a local variable directly using address of operator vs using pointer variable", "body": "<p>Strictly speaking, from the point of view of C language specification, that's a valid outcome.</p>\n\n<blockquote>\n  <p><strong>6.2.4 Storage durations of objects</strong> (emphasis mine)</p>\n  \n  <p><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.2.4p2\" rel=\"nofollow noreferrer\">2</a> The lifetime of an object is the portion of program execution\n  during which storage is guaranteed to be reserved for it. An object\n  exists, has a constant address, and retains its last-stored value\n  throughout its lifetime. If an object is referred to outside of its\n  lifetime, the behavior is undefined. <strong>The value of a pointer becomes\n  indeterminate when the object it points to (or just past) reaches the\n  end of its lifetime.</strong></p>\n</blockquote>\n\n<p>Therefore the value that function returns is indeterminate in either case. You cannot predict what it will be, or even use it in a meaningful way. A program that uses an indeterminate value has undefined behavior, anything can occur.</p>\n\n<p>So what your compiler does is return null when you return the address of a local directly. It's a valid value according to the C language itself, since the object is dead soon anyway. But it has the benefit of likely crashing your program early in a modern hosted implementation, and allowing you to fix a bug. </p>\n"}], "owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 57883307, "answer_count": 1, "score": 3, "last_activity_date": 1568202359, "creation_date": 1568182543, "last_edit_date": 1568202359, "question_id": 57883128, "link": "https://stackoverflow.com/questions/57883128/returning-address-of-a-local-variable-directly-using-address-of-operator-vs-usin", "title": "Returning address of a local variable directly using address of operator vs using pointer variable", "body": "<p>I'm aware of the fact that you should never return the address of a local variable from a function. But while demonstrating the fact I faced a problem. Consider the following program:</p>\n\n<pre><code>int *test()\n{\n    int x = 12;\n    int *p = &amp;x;\n    return p;\n}\n\nint main()\n{\n    int *p = test();\n    printf(\"%p\",p);\n    return 0;\n}\n</code></pre>\n\n<p>It prints an address like <code>0061fed0</code> as expected. But if I return the address of x directly using <code>&amp;</code> i.e. if the <code>test</code> function is changed as follows:</p>\n\n<pre><code>int *test()\n{\n    int x = 12;\n    return &amp;x;\n}\n</code></pre>\n\n<p>then the output becomes <code>00000000</code>. So, can you please explain what is happening here? I'm using gcc compiler that comes bundled with Code:: Blocks 17.12 IDE in windows 10.</p>\n\n<p>Regarding Duplicate Questions:\nSuggested duplicate question:\n<a href=\"https://stackoverflow.com/questions/36967840/c-gcc-generates-wrong-instructions-when-returning-local-stack-address\">C - GCC generates wrong instructions when returning local stack address</a>\nExplains the behaviour of using the address of operator directly but doesn't address the scenario where a pointer variable is used to return the address of a local variable, which is explained here in StoryTeller's answer: \"The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime\".</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19, "user_id": 11887801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a1795f7e6f92695427bb2098c43602?s=128&d=identicon&r=PG&f=1", "display_name": "ashirbad29", "link": "https://stackoverflow.com/users/11887801/ashirbad29"}, "edited": false, "score": 1, "creation_date": 1568180080, "post_id": 57882689, "comment_id": 102188115, "body": "please avoid  &quot; `` &quot;  in my code"}, {"owner": {"reputation": 947, "user_id": 1813572, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8fc07ca372a012efc1aa072b62af31f?s=128&d=identicon&r=PG", "display_name": "Jay K", "link": "https://stackoverflow.com/users/1813572/jay-k"}, "edited": false, "score": 0, "creation_date": 1568180896, "post_id": 57882689, "comment_id": 102188388, "body": "Can you paste the complete output?"}, {"owner": {"reputation": 783, "user_id": 10403061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/35yNU.jpg?s=128&g=1", "display_name": "liakoyras", "link": "https://stackoverflow.com/users/10403061/liakoyras"}, "edited": false, "score": 0, "creation_date": 1568184230, "post_id": 57882689, "comment_id": 102189536, "body": "What happened when you removed the if statement?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568195589, "post_id": 57882689, "comment_id": 102195102, "body": "<i>&quot;This code always shows \u201cnot found\u201d whatever the input is&quot;</i> -- this title is really bad. It&#39;s not helpful to identify the class of problem and not helpful to anybody who might encounter the same problem. I would suggest editing it (and also editing the body of the answer, but that&#39;s another story)."}], "answers": [{"comments": [{"owner": {"reputation": 210, "user_id": 11877755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dfb50469543aeadf2a1a28117e5c1b0?s=128&d=identicon&r=PG&f=1", "display_name": "amaldec23", "link": "https://stackoverflow.com/users/11877755/amaldec23"}, "reply_to_user": {"reputation": 19, "user_id": 11887801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a1795f7e6f92695427bb2098c43602?s=128&d=identicon&r=PG&f=1", "display_name": "ashirbad29", "link": "https://stackoverflow.com/users/11887801/ashirbad29"}, "edited": false, "score": 0, "creation_date": 1568203159, "post_id": 57882922, "comment_id": 102198963, "body": "No issues Man, My pleasure"}], "tags": [], "owner": {"reputation": 210, "user_id": 11877755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dfb50469543aeadf2a1a28117e5c1b0?s=128&d=identicon&r=PG&f=1", "display_name": "amaldec23", "link": "https://stackoverflow.com/users/11877755/amaldec23"}, "is_accepted": true, "score": 6, "last_activity_date": 1568195242, "last_edit_date": 1568195242, "creation_date": 1568181271, "answer_id": 57882922, "question_id": 57882689, "link": "https://stackoverflow.com/questions/57882689/this-code-always-shows-not-found-whatever-the-input-is/57882922#57882922", "title": "This code always shows &quot;not found&quot; whatever the input is", "body": "<p>You are passing the values wrongly in the function.</p>\n\n<p>In the function definition:  </p>\n\n<pre><code>void binary(int a[],int end,int beg,int value)\n</code></pre>\n\n<p>You call <code>binary(a,beg,end,val);</code>, but <code>end</code> is the 2nd one.</p>\n\n<p>When passing the values you are passing the <code>beg</code> value in the place of <code>end</code>. So the while loop is not executing.</p>\n"}], "owner": {"reputation": 19, "user_id": 11887801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a1795f7e6f92695427bb2098c43602?s=128&d=identicon&r=PG&f=1", "display_name": "ashirbad29", "link": "https://stackoverflow.com/users/11887801/ashirbad29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 57882922, "answer_count": 1, "score": -1, "last_activity_date": 1568195242, "creation_date": 1568180017, "last_edit_date": 1568184943, "question_id": 57882689, "link": "https://stackoverflow.com/questions/57882689/this-code-always-shows-not-found-whatever-the-input-is", "title": "This code always shows &quot;not found&quot; whatever the input is", "body": "<p>This is a binary search program. But if I give a sorted array as input, the program always shows NOT FOUND as output.</p>\n\n<p>I am a beginner so I tried to remove the if statement </p>\n\n<pre><code>void binary(int [],int,int,int);\n\nvoid main()\n{\n  int i,a[100],n,beg,end,val;\n\n  printf(\"enetr the size :\\n\");\n  scanf(\"%d\",&amp;n);\n\n  printf(\"enter the elements :\\n\");\n\n  for(i=0;i&lt;n;i++)\n    scanf(\"%d\",&amp;a[i]);\n\n  printf(\"enter the value to be search\");\n  scanf(\"%d\",&amp;val);\n\n  beg=0;\n  end=n-1;\n  binary(a,beg,end,val);\n}\n\nvoid  binary(int a[],int end,int beg,int value)\n{\n  int i,mid,count=0;\n\n  while(beg&lt;=end)\n  {\n    mid=((beg+end)/2);\n\n    if(a[mid]==value)\n    {\n      printf(\"the value is find at the %d position \",mid);\n      count=1;\n    }\n\n    if(value&lt;a[mid])\n      end=mid-1;\n    else\n      beg=mid+1;\n  }\n\n  if(count==0)\n    printf(\"NOT FOUND\");\n}\n</code></pre>\n\n<p>shows output as NOT FOUND despite of the input</p>\n"}, {"tags": ["c", "stm32", "i2c"], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 8050962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ae10e44ba1fce8ef7604c7b5a91b28c?s=128&d=identicon&r=PG&f=1", "display_name": "C Damo", "link": "https://stackoverflow.com/users/8050962/c-damo"}, "is_accepted": true, "score": 0, "last_activity_date": 1568180233, "creation_date": 1568180233, "answer_id": 57882728, "question_id": 57882537, "link": "https://stackoverflow.com/questions/57882537/how-do-i-use-stm32-hal-i2c-to-get-temperature-from-pct2075/57882728#57882728", "title": "How do I use STM32 HAL I2C to get Temperature from PCT2075", "body": "<p>Follow the figure 12 in the datasheet.</p>\n\n<p>1) First send slave address with 0 (for write operation). Slave address becomes 1001 000<strong>0</strong></p>\n\n<p>2) Send the Pointer address - For temperature it is 0000 0000.(See Page 10)</p>\n\n<p>3) The again send slave address with 1 meaning read operation. Slave address becomes 1001 000<strong>1</strong></p>\n\n<p>4) Now you can read from the temperature register of the device.</p>\n"}], "owner": {"reputation": 17, "user_id": 11308756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2012964188820484/picture?type=large", "display_name": "Jaeseo Lee", "link": "https://stackoverflow.com/users/11308756/jaeseo-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 57882728, "answer_count": 1, "score": 0, "last_activity_date": 1568180233, "creation_date": 1568179067, "question_id": 57882537, "link": "https://stackoverflow.com/questions/57882537/how-do-i-use-stm32-hal-i2c-to-get-temperature-from-pct2075", "title": "How do I use STM32 HAL I2C to get Temperature from PCT2075", "body": "<p>I would like to get a temperature from PCT2075 by using STM32 HAL I2C.\nOnly I can see that HAL ERROR status even I'm using HAL_I2C_Mem_Read() fucntion.</p>\n\n<p>Also I'm confusing what can I use for slave address. \nIn data sheet, slave address is 1001 000. Then I should write a slave address as 0x48 or (0x48&lt;&lt;1)? </p>\n\n<p>I have another question. \nWhen I configure GPIO pins in I2C as PULLUP, it is don't need to put PUll up resistor in the circuit?. I know that there are internal pullup resistor in GPIOS pins.</p>\n\n<p>Lastly, Should I send to configure data to slave before getting a Temperature.\n<a href=\"https://www.nxp.com/docs/en/data-sheet/PCT2075.pdf\" rel=\"nofollow noreferrer\">https://www.nxp.com/docs/en/data-sheet/PCT2075.pdf</a>\nTo be honest, I dont know how to read a datasheet exactly. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static void MX_I2C1_Init(void)\n{\n  /* USER CODE END I2C1_Init 1 */\n  hi2c1.Instance = I2C1;\n  hi2c1.Init.ClockSpeed = 400000;\n  hi2c1.Init.DutyCycle = I2C_DUTYCYCLE_2;\n  hi2c1.Init.OwnAddress1 = 0x48;\n  hi2c1.Init.AddressingMode = I2C_ADDRESSINGMODE_7BIT;\n  hi2c1.Init.DualAddressMode = I2C_DUALADDRESS_DISABLE;\n  hi2c1.Init.OwnAddress2 = 0;\n  hi2c1.Init.GeneralCallMode = I2C_GENERALCALL_DISABLE;\n  hi2c1.Init.NoStretchMode = I2C_NOSTRETCH_DISABLE;\n  if (HAL_I2C_Init(&amp;hi2c1) != HAL_OK)\n  {\n    Error_Handler();\n  }\n  /* USER CODE BEGIN I2C1_Init 2 */\n\n  /* USER CODE END I2C1_Init 2 */\n}\n\nmain()\n{\nretVal = HAL_I2C_Master_Transmit(&amp;hi2c1, slave_addr, &amp;send, I2C_MEMADD_SIZE_8BIT, 500);\n\nretVal = HAL_I2C_Mem_Read(&amp;hi2c1, slave_addr, 0x00u, I2C_MEMADD_SIZE_16BIT, &amp;TempReadBuffer[0], 16, 500);\nretVal = HAL_I2C_Mem_Read(&amp;hi2c1, slave_addr, 0x00u, I2C_MEMADD_SIZE_16BIT, &amp;TempReadBuffer[0], 16, 500);\n}\n</code></pre>\n\n<p>retVal = HALL_ERROR</p>\n"}, {"tags": ["c", "openmp", "longest-substring"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1568178835, "post_id": 57882484, "comment_id": 102187690, "body": "What do your function return? How do you pass the arguments? How do you build? What, if any, warnings do you get from the compiler? And please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us."}, {"owner": {"reputation": 3, "user_id": 5283687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1797644281fca1590ad73d8d42708698?s=128&d=identicon&r=PG&f=1", "display_name": "jksk", "link": "https://stackoverflow.com/users/5283687/jksk"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568180332, "post_id": 57882484, "comment_id": 102188200, "body": "I&#39;ve now edited the post with the full function"}, {"owner": {"reputation": 1876, "user_id": 2353816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5smr.jpg?s=128&g=1", "display_name": "Anders Cedronius", "link": "https://stackoverflow.com/users/2353816/anders-cedronius"}, "edited": false, "score": 0, "creation_date": 1568181335, "post_id": 57882484, "comment_id": 102188521, "body": "Have you looked at this for help? <a href=\"https://github.com/taoito/lcs-parallel\" rel=\"nofollow noreferrer\">github.com/taoito/lcs-parallel</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568182199, "post_id": 57882484, "comment_id": 102188790, "body": "First of all, try it <i>without</i> OMP. Does it work then? If not then there&#39;s something wrong with either your code or the algorithm is implemented wrong (or wrong to begin with). Either way you should probably spend some time <i>debugging</i> the non-parallel code."}, {"owner": {"reputation": 3, "user_id": 5283687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1797644281fca1590ad73d8d42708698?s=128&d=identicon&r=PG&f=1", "display_name": "jksk", "link": "https://stackoverflow.com/users/5283687/jksk"}, "edited": false, "score": 1, "creation_date": 1568209836, "post_id": 57882484, "comment_id": 102202846, "body": "As written in the post, I have got the code working without OMP"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1568218075, "post_id": 57882484, "comment_id": 102207452, "body": "Please present an actual <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 196, "user_id": 6530298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96835e1bf194d6b7cbbb92f5d4681342?s=128&d=identicon&r=PG&f=1", "display_name": "Gregor Budweiser", "link": "https://stackoverflow.com/users/6530298/gregor-budweiser"}, "edited": false, "score": 0, "creation_date": 1568641985, "post_id": 57882484, "comment_id": 102328513, "body": "As far as I can tell OpenMP is allowed to put each iteration over <code>i</code> into a separate thread. However you are accessing results from other iterations in the inner loop: <code>count[i][k] = max(count[i][k - 1], count[i - 1][k]);</code> (note the i-1). IMHO this cannot work without synchronization."}], "owner": {"reputation": 3, "user_id": 5283687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1797644281fca1590ad73d8d42708698?s=128&d=identicon&r=PG&f=1", "display_name": "jksk", "link": "https://stackoverflow.com/users/5283687/jksk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568180309, "creation_date": 1568178705, "last_edit_date": 1568180309, "question_id": 57882484, "link": "https://stackoverflow.com/questions/57882484/struggling-to-make-longest-common-subsequence-code-parallel-c", "title": "Struggling to make Longest Common Subsequence code parallel (C)", "body": "<p>Currently trying to make code finding the <a href=\"https://en.wikipedia.org/wiki/Longest_common_subsequence_problem\" rel=\"nofollow noreferrer\">longest common subsequence</a> of two given strings. I have got the code working serially, however I have been tasked for homework to implement OpenMP and OpenMPI (not worried about this yet). My main goal is to get my for loop which finds the length of the given LCS to run in parallel between threads created by omp however all my attempts so far are seemingly incorrect.</p>\n\n<p>I originally thought it was maybe the use of not making some variables such as I and K not private but I think as these variables aren't actually being modified, it should not matter. Ive also looked at using the collapse and reduction clause for my nested loop but still not sure on how they are fully meant to be utilised. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/**\n * Find the longest subsequence. Initially counts counts the length of the\n * longest subsequence. It then uses this length to count back and find each \n * char that is part of the LCS.\n */\nchar* subseq(char** strings, int size0, int size1) {\n\n    int count[size0 + 1][size1 + 1]; //The LCS \"Table\"\n    int i, k;\n\n    //Count the length of the LCS\n    #pragma omp parallel shared(count) private(i, k)\n    {\n        #pragma omp for\n        for (i = 0 ; i &lt;= size0; i++) {\n            for (k = 0; k &lt;= size1; k++) {\n                if (i == 0 || k == 0) {\n                    count[i][k] = 0;\n                } else if (strings[0][i - 1] == strings[1][k - 1]) {\n                    count[i][k] = count[i - 1][k - 1] + 1;\n                } else {\n                 count[i][k] = max(count[i][k - 1], count[i - 1][k]);\n                }\n            }\n        }\n    }\n\n\n\n\n\n    int index = count[size0][size1];\n    printf(\"count = %d\\n\", index);\n    char * lcs = malloc((index + 1) * sizeof(char));\n    lcs[index] = '\\0';\n    i = size0;\n    k = size1;\n\n    //Find each char in the LCS\n    while (i &gt; 0 &amp;&amp; k &gt; 0) {\n        if (strings[0][i - 1] == strings[1][k - 1]) {\n            lcs[index - 1] = strings[0][i - 1];\n            i--;\n            k--;\n            index--;\n        } else if (count[i - 1][k] &gt; count[i][k - 1]) {\n            i--;\n        } else {\n            k--;\n        }\n    }\n\n    return lcs;\n}\n</code></pre>\n\n<p>Right now my two example strings are \"MZJAWXU\" and \"XMJYAUZ\" but im getting an LCS length of 2 from the program instead of the expected 4. Running valgrind also throws of a lot of uninitialised value errors however without the use of omp I get no errors.</p>\n\n<p>No warnings or compiler errors.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1568177663, "post_id": 57882310, "comment_id": 102187385, "body": "See <a href=\"https://stackoverflow.com/q/5672746/3049655\">this question</a>. Also, use <code>ftell</code> if you want to get the size of the file"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 2, "creation_date": 1568177895, "post_id": 57882310, "comment_id": 102187440, "body": "@Spikatrix: As far as the C standard is concerned, <code>ftell</code> cannot reliably get the size of a file. Since you can&#39;t do it portably, you might as well use non-portable functions like <code>stat</code> and <code>fstat</code> (or whatever the Windows equivalents are)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1568178013, "post_id": 57882310, "comment_id": 102187465, "body": "That code shouldn&#39;t have produced that error message. Your <code>file</code> object is a pointer, not a structure. <code>file-&gt;size</code> rather than <code>file.size</code> could have produced that error."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1568181281, "post_id": 57882310, "comment_id": 102188502, "body": "Here&#39;s the full list of things that can be printed:"}], "answers": [{"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 0, "last_activity_date": 1568181132, "creation_date": 1568181132, "answer_id": 57882905, "question_id": 57882310, "link": "https://stackoverflow.com/questions/57882310/printing-various-file-info/57882905#57882905", "title": "Printing various FILE info", "body": "<p>Sounds like you want to use stat():</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/stat.2.html</a></p>\n\n<p>or there are always the Win32 funcs such as GetFileSize if you want to target windows. </p>\n"}, {"comments": [{"owner": {"reputation": 435, "user_id": 4673887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd5054058df8d6338d04a3c0f767441?s=128&d=identicon&r=PG&f=1", "display_name": "FI-Info", "link": "https://stackoverflow.com/users/4673887/fi-info"}, "edited": false, "score": 0, "creation_date": 1568254427, "post_id": 57882955, "comment_id": 102218615, "body": "How would I use that within a c program?"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "reply_to_user": {"reputation": 435, "user_id": 4673887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd5054058df8d6338d04a3c0f767441?s=128&d=identicon&r=PG&f=1", "display_name": "FI-Info", "link": "https://stackoverflow.com/users/4673887/fi-info"}, "edited": false, "score": 1, "creation_date": 1568265572, "post_id": 57882955, "comment_id": 102220864, "body": "@FI-Info , Please see the updated answer with the second link, it contains a detailed example."}], "tags": [], "owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "is_accepted": true, "score": 3, "last_activity_date": 1568265536, "last_edit_date": 1568265536, "creation_date": 1568181554, "answer_id": 57882955, "question_id": 57882310, "link": "https://stackoverflow.com/questions/57882310/printing-various-file-info/57882955#57882955", "title": "Printing various FILE info", "body": "<p>To get various information, You can use <code>stat</code> , <code>lstat</code> which populate the <code>struct stat</code>:</p>\n\n<pre><code>           struct stat {\n               dev_t     st_dev;     /* ID of device containing file */\n               ino_t     st_ino;     /* inode number */\n               mode_t    st_mode;    /* protection */\n               nlink_t   st_nlink;   /* number of hard links */\n               uid_t     st_uid;     /* user ID of owner */\n               gid_t     st_gid;     /* group ID of owner */\n               dev_t     st_rdev;    /* device ID (if special file) */\n               off_t     st_size;    /* total size, in bytes */\n               blksize_t st_blksize; /* blocksize for file system I/O */\n               blkcnt_t  st_blocks;  /* number of 512B blocks allocated */\n               time_t    st_atime;   /* time of last access */\n               time_t    st_mtime;   /* time of last modification */\n               time_t    st_ctime;   /* time of last status change */\n           };\n</code></pre>\n\n<p><a href=\"https://www.freebsd.org/cgi/man.cgi?query=stat&amp;apropos=0&amp;sektion=2&amp;manpath=FreeBSD+12.0-RELEASE+and+Ports&amp;arch=default&amp;format=html\" rel=\"nofollow noreferrer\">man page</a></p>\n\n<p><a href=\"https://linux.die.net/man/2/lstat\" rel=\"nofollow noreferrer\">man page + example</a></p>\n"}], "owner": {"reputation": 435, "user_id": 4673887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd5054058df8d6338d04a3c0f767441?s=128&d=identicon&r=PG&f=1", "display_name": "FI-Info", "link": "https://stackoverflow.com/users/4673887/fi-info"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 57882955, "answer_count": 2, "score": -1, "last_activity_date": 1568265536, "creation_date": 1568177369, "question_id": 57882310, "link": "https://stackoverflow.com/questions/57882310/printing-various-file-info", "title": "Printing various FILE info", "body": "<p>Are there various print formatters for the file object? For example:</p>\n\n<pre><code>// pass the filepath\nchar * filepath = argv[1];\nFILE * file = fopen(filepath, \"r\");\nprintf(\"Filepath: %s\\n\", file.size);\n\nmain4.c:416:32: error: no member named 'size' in 'struct __sFILE'\n</code></pre>\n\n<p>What are the various items that can be printed from the struct?</p>\n"}, {"tags": ["c", "performance", "optimization", "bit-manipulation", "branch"], "comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1568177108, "post_id": 57882091, "comment_id": 102187270, "body": "Perhaps <code>return -!x|x;</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1568179360, "post_id": 57882091, "comment_id": 102187872, "body": "&quot;I assume there&#39;s some nice branchless way.&quot; Well, you can&#39;t take a piece of C code and predict how it will end up being executed in a processor (unless you are extremely experienced in such stuff). You need to compile the code and investigate the generated binary. And even there it&#39;s difficult to predict the performance due to all the tricks used by the processor so you&#39;ll probably have to do profiling in the end."}, {"owner": {"reputation": 4291, "user_id": 378360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c33f6bd757f9b083ab1c1a7540f3b79?s=128&d=identicon&r=PG", "display_name": "Falk H&#252;ffner", "link": "https://stackoverflow.com/users/378360/falk-h%c3%bcffner"}, "edited": false, "score": 0, "creation_date": 1568187695, "post_id": 57882091, "comment_id": 102191087, "body": "A branch which is completely predictable is, on a modern CPU, almost free. Avoiding branches is mostly relevant for unpredictable branches."}, {"owner": {"reputation": 18645, "user_id": 50385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2faf0c72f6a7f65431e7df489878be24?s=128&d=identicon&r=PG", "display_name": "Joseph Garvin", "link": "https://stackoverflow.com/users/50385/joseph-garvin"}, "edited": false, "score": 1, "creation_date": 1568216657, "post_id": 57882091, "comment_id": 102206739, "body": "I appreciate the point you both are making, but it&#39;s unnecessary for someone to make it on every single performance question. If somebody knows to ask for branch free code it&#39;s safe to assume they have a reason."}], "answers": [{"tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 2, "last_activity_date": 1568177880, "creation_date": 1568177880, "answer_id": 57882377, "question_id": 57882091, "link": "https://stackoverflow.com/questions/57882091/branchless-way-to-map-0-to-any-nonzero-value-while-leaving-other-values-alone/57882377#57882377", "title": "Branchless way to map 0 to any nonzero value while leaving other values alone?", "body": "<p>One possible implementation is:</p>\n\n<pre><code>uint16_t forbid_zero(uint16_t x)\n{\n    return x | !x;\n}\n</code></pre>\n\n<p>Which the Compile Explorer shows <a href=\"https://godbolt.org/z/6_pww0\" rel=\"nofollow noreferrer\">x86-64 gcc 8.2 compiles to</a>:</p>\n\n<pre><code>forbid_zero(unsigned short):\n        xorl    %eax, %eax\n        testw   %di, %di\n        sete    %al\n        orl     %edi, %eax\n        ret\n</code></pre>\n\n<p>However even the implementation you give in the question <a href=\"https://godbolt.org/z/hj3B1o\" rel=\"nofollow noreferrer\">compiles to branchless code using a conditional move instruction</a> with the same compiler:</p>\n\n<pre><code>forbid_zero(unsigned short):\n        testw   %di, %di\n        movl    $1, %eax\n        cmovne  %edi, %eax\n        ret\n</code></pre>\n\n<p>...and of course there's no guarantee that <code>!x</code> won't be compiled to a branch, either.</p>\n"}], "owner": {"reputation": 18645, "user_id": 50385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2faf0c72f6a7f65431e7df489878be24?s=128&d=identicon&r=PG", "display_name": "Joseph Garvin", "link": "https://stackoverflow.com/users/50385/joseph-garvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 57882377, "answer_count": 1, "score": 2, "last_activity_date": 1568177880, "creation_date": 1568175612, "question_id": 57882091, "link": "https://stackoverflow.com/questions/57882091/branchless-way-to-map-0-to-any-nonzero-value-while-leaving-other-values-alone", "title": "Branchless way to map 0 to any nonzero value while leaving other values alone?", "body": "<p>I am trying to find the the fastest possible implementation of this function:</p>\n\n<pre><code>uint16_t forbid_zero(uint16_t x)\n{\n    if(x == 0)\n        return SOMETHING_NONZERO;\n    return x;\n}\n</code></pre>\n\n<p>It doesn't matter what SOMETHING_NONZERO is, as long as it's not zero. Any value other than zero should pass through unmodified. What's the fastest bit hackery for doing this? I assume there's some nice branchless way.</p>\n\n<p>For context I have an algorithm in my critical path where zero as an input value will trigger infinite looping and other bad behavior, and I'm curious if it's possible for me to massage the input to always be nonzero without branching to check for 0.  The consequence of passing an incorrect nonzero value to the algorithm is not nearly as bad; the mistake will be caught by checks that already have to exist at other layers, so mapping 0 to any other value is good enough.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "edited": false, "score": 0, "creation_date": 1568175829, "post_id": 57882044, "comment_id": 102186974, "body": "char* a_str=(char*)malloc(sizeof(char)*21);"}, {"owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "edited": false, "score": 0, "creation_date": 1568175872, "post_id": 57882044, "comment_id": 102186986, "body": "you need tell system how many memory you need,thats how the computer works"}], "answers": [{"comments": [{"owner": {"reputation": 276, "user_id": 11910197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pan5a.jpg?s=128&g=1", "display_name": "thisisbenmanley", "link": "https://stackoverflow.com/users/11910197/thisisbenmanley"}, "edited": false, "score": 0, "creation_date": 1568176654, "post_id": 57882197, "comment_id": 102187172, "body": "Another note because of the wording of your question title: both of the things you passed into <code>sprintf</code> (both <code>char a_str[10]</code> and <code>char* a_str</code>) are &quot;<code>char</code> pointers&quot;. All an array is in C/C++ is a pointer to the first item in that array."}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 1, "creation_date": 1568192835, "post_id": 57882197, "comment_id": 102193717, "body": "Array decays to pointer in some situations but generally speaking array and pointer aren&#39;t the same, although they share some similarities"}, {"owner": {"reputation": 276, "user_id": 11910197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pan5a.jpg?s=128&g=1", "display_name": "thisisbenmanley", "link": "https://stackoverflow.com/users/11910197/thisisbenmanley"}, "reply_to_user": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1568236734, "post_id": 57882197, "comment_id": 102214916, "body": "Thanks @qrdl, I over-generalized. <code>sprintf</code> will specifically treat a <code>char[]</code> as a <code>char*</code> because <code>sprintf</code> expects a <code>char*</code> and so the array will be implicitly converted to a pointer"}], "tags": [], "owner": {"reputation": 276, "user_id": 11910197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pan5a.jpg?s=128&g=1", "display_name": "thisisbenmanley", "link": "https://stackoverflow.com/users/11910197/thisisbenmanley"}, "is_accepted": true, "score": 1, "last_activity_date": 1568176366, "creation_date": 1568176366, "answer_id": 57882197, "question_id": 57882044, "link": "https://stackoverflow.com/questions/57882044/why-cant-the-first-argument-in-sprintf-be-a-char-pointer-in-c/57882197#57882197", "title": "Why can&#39;t the first argument in sprintf be a char pointer in C", "body": "<p>First, an important thing to understand is that a segmentation fault usually occurs when your program attempts to use memory that it is not allowed to use.</p>\n\n<p>Second, you have to understand what <code>sprintf</code> is doing. When you call <code>sprintf(a_str, \"%d\", a)</code>, you are moving the contents of variable <code>a</code> to the memory space <strong>at the address pointed to by <code>a_str</code></strong>. Therefore, in order to not cause a segmentation fault, your program must \"own\" the memory pointed to by <code>a_str</code> before using it in <code>sprintf</code>.</p>\n\n<p>When you pass <code>char a_str[10]</code> into <code>sprintf</code>, it always works because the program has allocated its own memory space for <code>a_str</code> (with the line <code>char a_str[10];</code>). Therefore, when you use <code>sprintf</code> on it, the program is accessing memory it's allowed to access.</p>\n\n<p>However, when you pass your <code>char* a_str</code> into <code>sprintf</code>, you are causing undefined behavior. When you created the <code>char* a_str</code>, all you did was create a <code>char</code> <strong>pointer</strong> that points to some random location in memory; your program most likely does not have access to the memory at the location pointed to by this random pointer. Therefore, calling <code>sprintf</code> and attempting to move the contents of <code>a</code> into that will throw a segmentation fault. This would be solved if you pointed your <code>char* a_str</code> at some usable memory location using something like <code>malloc</code>.</p>\n"}], "owner": {"reputation": 519, "user_id": 5665986, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65fd752e1c74dcd166c1c7187329657a?s=128&d=identicon&r=PG", "display_name": "Catiger3331", "link": "https://stackoverflow.com/users/5665986/catiger3331"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 57882197, "answer_count": 1, "score": -1, "last_activity_date": 1568176366, "creation_date": 1568175178, "question_id": 57882044, "link": "https://stackoverflow.com/questions/57882044/why-cant-the-first-argument-in-sprintf-be-a-char-pointer-in-c", "title": "Why can&#39;t the first argument in sprintf be a char pointer in C", "body": "<p>I want to convert an integer to a string. Here's what works:</p>\n\n<pre><code>int main() {\n    int a= 54734;\n    char a_str[10];\n    sprintf(a_str, \"%d\", a);\n\n    printf(\"%s\\n\", a_str);\n    return 0;\n}\n</code></pre>\n\n<p>But this does not work:</p>\n\n<pre><code>int main() {\nint a= 54734;\nchar* a_str;\nsprintf(a_str, \"%d\", a);\n\nprintf(\"%s\\n\", a_str);\nreturn 0;\n}\n</code></pre>\n\n<p>It returns:</p>\n\n<pre><code>Process finished with exit code 139 (interrupted by signal 11: \nSIGSEGV)\n</code></pre>\n\n<p>I thought string is null terminated, so a pointer to char should work as well. Because I'm new to C, so please correct if I'm wrong.</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1568175714, "post_id": 57882040, "comment_id": 102186950, "body": "<code>int number[15];</code> Do you mean &quot;this is a 15 digit number&quot;? Numbers don&#39;t work this way in C. Or do you mean &quot;this guy has 15 phone numbers&quot;? That could be too much."}, {"owner": {"reputation": 9, "user_id": 9204642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4bbe4d7a42317c0acdd8deb2e8ed3a?s=128&d=identicon&r=PG&f=1", "display_name": "Rosch Rocks", "link": "https://stackoverflow.com/users/9204642/rosch-rocks"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1568175918, "post_id": 57882040, "comment_id": 102186998, "body": "No. We have 9 digit numbers here in India. But, even when i enter a 9 digit number it appears to pull the memory address i think"}, {"owner": {"reputation": 626, "user_id": 4690576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a328eeb1bb069c34be414a5e7bcda10?s=128&d=identicon&r=PG", "display_name": "AmeyaVS", "link": "https://stackoverflow.com/users/4690576/ameyavs"}, "edited": false, "score": 0, "creation_date": 1568177466, "post_id": 57882040, "comment_id": 102187341, "body": "Changing the following line in the <code>display</code> function: <code>printf(&quot;%d\\n&quot;,temp-&gt;number);</code> to <code>printf(&quot;%d\\n&quot;,temp-&gt;number[0]);</code> resolves the issue(only hides the underlying problem). But there a multiple issues in your implementation."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1568179638, "post_id": 57882040, "comment_id": 102187958, "body": "What does <code>[15]</code> <i>mean</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "edited": false, "score": 0, "creation_date": 1568177768, "post_id": 57882299, "comment_id": 102187413, "body": "Actually I would use <code>unsigned long</code>, Since this type will handle up to 10 digits and since you know a phone number will never be negative and &lt;= 9 digits it is perfect"}, {"owner": {"reputation": 3918, "user_id": 2774842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR91F.jpg?s=128&g=1", "display_name": "Unn", "link": "https://stackoverflow.com/users/2774842/unn"}, "edited": false, "score": 1, "creation_date": 1568179282, "post_id": 57882299, "comment_id": 102187841, "body": "Actually, <code>unsigned long</code> is only guaranteed to contain [0, 2^32), and thus isn&#39;t enough to store all 9 digit numbers (and is 32-bits on many platforms). You&#39;ll need an <code>unsigned long long</code> or use <code>uint64_t</code> from <code>stdint.h</code> and worry less about portability. (Remember, C predates pervasive 32-bit machines)"}, {"owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "reply_to_user": {"reputation": 3918, "user_id": 2774842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR91F.jpg?s=128&g=1", "display_name": "Unn", "link": "https://stackoverflow.com/users/2774842/unn"}, "edited": false, "score": 0, "creation_date": 1568179733, "post_id": 57882299, "comment_id": 102187995, "body": "Am I missing something or is <code>4,294,967,296\u202c</code> &gt; 999,999,999"}, {"owner": {"reputation": 3918, "user_id": 2774842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR91F.jpg?s=128&g=1", "display_name": "Unn", "link": "https://stackoverflow.com/users/2774842/unn"}, "edited": false, "score": 0, "creation_date": 1568180673, "post_id": 57882299, "comment_id": 102188317, "body": "True, I was thinking 10-digit numbers sorry."}], "tags": [], "owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1568177273, "creation_date": 1568177273, "answer_id": 57882299, "question_id": 57882040, "link": "https://stackoverflow.com/questions/57882040/creating-a-phonebook-using-linked-list-and-file-operations/57882299#57882299", "title": "Creating a phonebook using linked list and file operations", "body": "<p>If you just change <code>int number[15];</code> to <code>long number;</code> it works as expected.  </p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10383628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0cfd9b13b66581e82881bd92e0b965b?s=128&d=identicon&r=PG&f=1", "display_name": "AshishP", "link": "https://stackoverflow.com/users/10383628/ashishp"}, "is_accepted": false, "score": 0, "last_activity_date": 1568182477, "creation_date": 1568182477, "answer_id": 57883115, "question_id": 57882040, "link": "https://stackoverflow.com/questions/57882040/creating-a-phonebook-using-linked-list-and-file-operations/57883115#57883115", "title": "Creating a phonebook using linked list and file operations", "body": "<p>You need to use <code>uint64_t</code> to store phone numbers refer following updated code,</p>\n\n<pre><code>#include&lt;stdint.h&gt;\n struct node\n{\n    char firstname[20];\n    char lastname[20];\n    uint64_t number;\n    struct node *next;\n};\n</code></pre>\n\n<p>Change scanf() and printf(),</p>\n\n<pre><code>scanf(\"%llu\",&amp;nn-&gt;number);\nprintf(\"%llu\",temp-&gt;number);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9204642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4bbe4d7a42317c0acdd8deb2e8ed3a?s=128&d=identicon&r=PG&f=1", "display_name": "Rosch Rocks", "link": "https://stackoverflow.com/users/9204642/rosch-rocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2068, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568182477, "creation_date": 1568175123, "question_id": 57882040, "link": "https://stackoverflow.com/questions/57882040/creating-a-phonebook-using-linked-list-and-file-operations", "title": "Creating a phonebook using linked list and file operations", "body": "<p>I was creating a phonebook in C using single linked list. The issue that I am experiencing in GCC is that at certain lines, GCC is throwing assignment to expression with array type errors. And at certain lines, it is giving me warning like format %s expects an argument of type char*.</p>\n\n<p>I have tried without the sorting function by putting it in comments and executing. The program executes and asks for the number, first name and last name. But then only the first name and last name is shown properly. The phone number displays some odd value which looks like the memory address.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node\n{\n    char firstname[20];\n    char lastname[20];\n     int number[15];\n    struct node *next;\n};\n\nstruct node *start=NULL;\n\nstruct node *getnode()\n{\n    return((struct node *)malloc(sizeof(struct node)));\n} \n\n\nvoid display(struct node *start)\n{\n    struct node *temp;\n    temp=start;\n    while(temp!=NULL)\n    {\n        printf(\"%s\\n\",temp-&gt;firstname);\n        printf(\"%s\\n\",temp-&gt;lastname);\n        printf(\"%d\\n\",temp-&gt;number);\n        temp=temp-&gt;next;\n    }\n}\n/*void sort()\n{\n    struct node *temp,*pretemp;\n    char *p;\n    temp=start;\n    pretemp=start-&gt;next;\n    while(pretemp!=NULL)\n    {\n    if(strcmp(temp-&gt;lastname,pretemp-&gt;lastname)&gt;0)\n    {\n        if(temp-&gt;lastname==pretemp-&gt;lastname)\n        {\n            if(strcmp(temp-&gt;firstname,pretemp-&gt;firstname)&gt;0)\n            {\n                p=temp-&gt;firstname;\n                temp-&gt;firstname=pretemp-&gt;firstname;\n                pretemp-&gt;firstname=p;   \n            }\n        }\n        else\n        {\n                p=temp-&gt;lastname;\n                temp-&gt;lastname=pretemp-&gt;firstname;\n                pretemp-&gt;firstname=p;\n        }\n    }\n    }\n}\n*/\nvoid insert()\n{\n    struct node *temp,*nn;\n    nn=getnode();\n    temp=start;\n    while(temp-&gt;next!=NULL)\n    {\n        temp=temp-&gt;next;\n\n    }\n    printf(\"Enter First name:\\n\");\n    scanf(\"%s\",&amp;nn-&gt;firstname);\n    printf(\"Enter Last name:\\n\");\n    scanf(\"%s\",&amp;nn-&gt;lastname);\n    printf(\"Enter number:\\n\");\n    scanf(\"%d\",&amp;nn-&gt;number);\n    temp-&gt;next=nn;\n    nn-&gt;next=NULL;\n    display(start);\n}\n\nstruct node *create()\n{\n    struct node *temp,*nn;\n    if(start!=NULL)\n        insert();\n    else\n    {\n    nn=getnode();\n    start=nn;\n    temp=start;\n    printf(\"Enter First name:\\n\");\n    scanf(\"%s\",&amp;nn-&gt;firstname);\n    printf(\"Enter Last name:\\n\");\n    scanf(\"%s\",&amp;nn-&gt;lastname);\n    printf(\"Enter number:\\n\");\n    scanf(\"%d\",&amp;nn-&gt;number);\n    nn-&gt;next=NULL;\n    display(start);\n    }\n}\nvoid search()\n{\n    struct node *temp;\n    char *f,*l;\n    temp=start;\n    printf(\"Enter name to be searched:\\n\");\n    scanf(\"%s\",&amp;f);\n    scanf(\"%s\",&amp;l);\n    while((temp-&gt;firstname==f)&amp;&amp;(temp-&gt;lastname==l))\n    {\n        temp=temp-&gt;next;\n    }\n    printf(\"%s\\n\",temp-&gt;firstname);\n    printf(\"%s\\n\",temp-&gt;lastname);\n    printf(\"%d\\n\",temp-&gt;number);\n}\n\nvoid del()\n{\n    struct node *pretemp,*temp;\n    char *f,*l;\n    temp=start;\n    pretemp=start-&gt;next;\n    printf(\"Enter name :\");\n    scanf(\"%s\",&amp;f);\n    scanf(\"%s\",&amp;l);\n    while(temp!=NULL)\n    {\n        if((pretemp-&gt;firstname==f)&amp;&amp;(pretemp-&gt;lastname==l))\n        {\n            printf(\"%s \",temp-&gt;firstname);\n            printf(\"%s \",temp-&gt;lastname);\n            printf(\"%s \",temp-&gt;number);\n            temp-&gt;next=pretemp-&gt;next;\n            free(pretemp);\n            break;\n        }\n        else \n        {\n            temp=temp-&gt;next;\n            pretemp=pretemp-&gt;next;\n        }\n\n\n    }\n}\n\nint main()\n{\n    int op,ch;\n    do{\n        printf(\"-------Welcome--------\\n \");\n        printf(\"1.Create\\n2.Insert\\n3.Display\\n4.Delete\\n5.Search\\n6.Sort\\n\");\n        printf(\"Enter your choice:\");\n        scanf(\"%d\",&amp;ch);\n        switch(ch)\n        {\n            case 1: create();\n            break;\n            case 2: insert();\n            break;\n            case 3: display(start);\n            break;\n            case 4: del();\n            break;\n            case 5:search();\n            break;\n            /*case 6:sort();\n            break;*/\n        }\n        printf(\"Do you want to quit ? 1 for no / 0 for yes:\");\n        scanf(\"%d\",&amp;op);\n    }while(op!=0);\nreturn 0;\n}\n</code></pre>\n\n<pre><code>roschlynn@Roschlynn-Asus:/mnt/c/Users/ROSCHLYNN D'SOUZA/Desktop/Test$ ./a.out\n-------Welcome--------\n 1.Create\n2.Insert\n3.Display\n4.Delete\n5.Search\n6.Sort\nEnter your choice:1\nEnter First name:\nIvan\nEnter Last name:\nDsouza\nEnter number:\n123456789\nIvan\nDsouza\n-499915096\nDo you want to quit ? 1 for no / 0 for yes:0\nroschlynn@Roschlynn-Asus:/mnt/c/Users/ROSCHLYNN D'SOUZA/Desktop/Test$\n</code></pre>\n\n<p>I expect the output to be the phone number that i entered but it appears that it is taking the memory address of the number.</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568174046, "post_id": 57881810, "comment_id": 102186598, "body": "When you don&#39;t have the 8th line, the compiler doesn&#39;t need the variable <code>b</code>, so it eliminates it.  When you have the 8th line, then it needs <code>b</code>.  Using the negative index is undefined behaviour \u2014 anything can happen when you use it."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1568185755, "post_id": 57881810, "comment_id": 102190199, "body": "b&#39;s address isn&#39;t even guaranteed to be right before a. <a href=\"https://stackoverflow.com/q/36298567/995714\">Why does gcc reorder the local variable in function?</a>, <a href=\"https://stackoverflow.com/q/1102049/995714\">Order of local variable allocation on the stack</a>, <a href=\"https://stackoverflow.com/q/12438216/995714\">Is the order of memory addresses of successively declared variables always descending?</a>, <a href=\"https://stackoverflow.com/q/51867757/995714\">What is the order of local variables on the stack?</a>, <a href=\"https://stackoverflow.com/q/28559007/995714\">Are C stack variables stored in reverse?</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1568185757, "post_id": 57881810, "comment_id": 102190200, "body": "<a href=\"https://stackoverflow.com/q/238441/995714\">Can a C compiler rearrange stack variables?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1568173511, "post_id": 57881831, "comment_id": 102186506, "body": "Thanks for your reply, I want to access b using a[-1]"}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1568173654, "post_id": 57881831, "comment_id": 102186536, "body": "@SolskGaer <code>b</code> and <code>a</code> might not be neighbors in memory, hence accessing <code>b</code> is wrong."}, {"owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "edited": false, "score": 0, "creation_date": 1568173878, "post_id": 57881831, "comment_id": 102186575, "body": "<code>#include &lt;stdio.h&gt;  int main(){     int a[1] = {1};     int *b;     b = a-1;     printf(&quot;Adress of a, aka a[0]: %d\\n&quot;, a);     printf(&quot;Address of a-1: %d\\n&quot;, a-1);     printf(&quot;Address of b: %d\\n&quot;,b);     printf(&quot;Value b is pointing to: %d\\n&quot;, *b);     printf(&quot;Does the address of a== adress of b? %d\\n&quot;, (a-1 == b));     return 0; }</code>"}, {"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "reply_to_user": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "edited": false, "score": 0, "creation_date": 1568173930, "post_id": 57881831, "comment_id": 102186583, "body": "@AgrudgeAmicus  The code worked as I expected when I uncommented line 8, can you explain that for me? Thanks"}, {"owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "edited": false, "score": 0, "creation_date": 1568174019, "post_id": 57881831, "comment_id": 102186596, "body": "Sure what were you expecting"}, {"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1568174216, "post_id": 57881831, "comment_id": 102186625, "body": "@DanielAaron printf(&quot;%d\\n&quot;, a[-1]) prints 6"}, {"owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "edited": false, "score": 0, "creation_date": 1568174570, "post_id": 57881831, "comment_id": 102186705, "body": "Little confused.  <code>printf(&quot;%d\\n&quot;, a[-1]);</code> Prints 55 for me, depends what is in address of a[-1] <code>printf(&quot;%d\\n&quot;, b);</code> Prints 6 for me since it is assigned 6 <code>printf(&quot;%d\\n&quot;, (a-1 == &amp;b));</code> Prints 0 for me since 6 != address of a - 1  If you are using codeblocks be careful, it seems to not reset the memory at that location between builds which is quite annoying."}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1568175146, "post_id": 57881831, "comment_id": 102186826, "body": "@SolskGaer Check what <a href=\"https://stackoverflow.com/users/15168/jonathan-leffler\">stackoverflow.com/users/15168/jonathan-leffler</a> has commented"}, {"owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "edited": false, "score": 0, "creation_date": 1568175746, "post_id": 57881831, "comment_id": 102186956, "body": "<a href=\"https://stackoverflow.com/questions/1677415/does-stack-grow-upward-or-downward\" title=\"does stack grow upward or downward\">stackoverflow.com/questions/1677415/&hellip;</a> a very detailed explanation"}], "tags": [], "owner": {"reputation": 101, "user_id": 6511419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230a533d7ff8c6c0a725f2ed09e465b4?s=128&d=identicon&r=PG&f=1", "display_name": "DanielAaron", "link": "https://stackoverflow.com/users/6511419/danielaaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1568173433, "creation_date": 1568173433, "answer_id": 57881831, "question_id": 57881810, "link": "https://stackoverflow.com/questions/57881810/what-is-the-problem-of-the-following-code-in-c/57881831#57881831", "title": "What is the problem of the following code in c", "body": "<p>Invalid Index for an array, I think you meant print a[1] printf(\"%d\\n\", a[-1])</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1568173722, "post_id": 57881835, "comment_id": 102186544, "body": "In my opinion, stack grows to low address, I declare b after a, so b suppose to underneath a in memory, so I can access b using a[-1], and if I uncommented line 8, everything works just as I expected"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 3, "creation_date": 1568174459, "post_id": 57881835, "comment_id": 102186675, "body": "@SolskGaer \u2014 there are no guarantees about the layout of the variables.  One compiler might do as you expect; others can do things differently.  You&#39;re attempting to exploit undefined behaviour; any result is valid."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1568185178, "post_id": 57881835, "comment_id": 102189937, "body": "@SolskGaer You can&#39;t reason about stack frame layout without a certain system in mind. In addition, if your code does questionable things beyond the scope of the C standard, the compiler might generate wrong code, regardless of memory layout."}], "tags": [], "owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "is_accepted": true, "score": 2, "last_activity_date": 1568173456, "creation_date": 1568173456, "answer_id": 57881835, "question_id": 57881810, "link": "https://stackoverflow.com/questions/57881810/what-is-the-problem-of-the-following-code-in-c/57881835#57881835", "title": "What is the problem of the following code in c", "body": "<p>The <code>a[-1]</code> is undefined memory space. </p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1568184976, "last_edit_date": 1568184976, "creation_date": 1568184488, "answer_id": 57883555, "question_id": 57881810, "link": "https://stackoverflow.com/questions/57881810/what-is-the-problem-of-the-following-code-in-c/57883555#57883555", "title": "What is the problem of the following code in c", "body": "<p><code>a[-1]</code> and <code>a-1</code> result in undefined behavior.  First, lets get a definition for array subscripting from the C11 standard section 6.5.2.1p2:</p>\n\n<blockquote>\n  <p>A  postfix  expression  followed  by  an  expression  in  square  brackets\n  <strong>[]</strong>\n  is  a  subscripted\n  designation of an element of an array object.  The definition of the subscript operator\n  <strong>[]</strong>\n  is that\n  <strong>E1[E2]</strong>\n  is identical to\n  <strong>(*((E1)+(E2)))</strong>\n  . </p>\n</blockquote>\n\n<p>So array subscripting follows the rules of pointer arithmetic when adding an integer to a pointer.</p>\n\n<p>In defining pointer arithmetic in section 6.5.6p8, it sets some rules and behavior in place <em>(emphasis mine)</em>:</p>\n\n<blockquote>\n  <p>If  both  the  pointer\n  operand  and  the  result  point  to  elements  of  the  same  array  object,  or  one  past  the  last\n  element of the array object, the evaluation shall not produce an overflow; <em>otherwise, the\n  behavior is undefined.</em>  If the result points one past the last element of the array object, it\n  shall not be used as the operand of a unary\n  *\n  operator that is evaluated.</p>\n</blockquote>\n\n<p>The result of the pointer arithmetic involved in the array subscripting in your question is outside of the array object, therefore it results in undefined behavior.</p>\n"}], "owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57881835, "answer_count": 3, "score": -2, "last_activity_date": 1568184976, "creation_date": 1568173270, "question_id": 57881810, "link": "https://stackoverflow.com/questions/57881810/what-is-the-problem-of-the-following-code-in-c", "title": "What is the problem of the following code in c", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int a[1] = {1};\n    int b = 6;\n    printf(\"%d\\n\", a[-1]);\n    printf(\"%d\\n\", b);\n    //printf(\"%d\\n\", (a-1 == &amp;b));\n    return 0;\n}\n</code></pre>\n\n<p>I wrote the above code and found out it didn't work properly when using gcc or mingw to compile it, but when I uncommented 8th line, everything is just fine. Could anyone explain the code for me?</p>\n"}, {"tags": ["c", "arrays", "string", "pointers", "structure"], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568180449, "post_id": 57882052, "comment_id": 102188247, "body": "Failure to validate the return of <code>scanf(&quot;%d &quot;,&amp;num);</code> invites <i>Undefined Behavior</i>. Always validate each input, especially user-input, e.g. <code>if (scanr(&quot;%d&quot;, &amp;num) != 1) { &#47;* handle error *&#47; }</code>."}, {"owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568183608, "post_id": 57882052, "comment_id": 102189304, "body": "@David C. Rankin  sure OP need notice if someone key in not integer after execute work."}], "tags": [], "owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1568175270, "creation_date": 1568175270, "answer_id": 57882052, "question_id": 57881796, "link": "https://stackoverflow.com/questions/57881796/add-a-string-array-to-a-character-pointer-in-c/57882052#57882052", "title": "Add a string array to a character pointer in c", "body": "<p>scanf(\"%s\",*(words.arr+i));</p>\n\n<p>%s is mean enter string one times</p>\n\n<p>and *(words.arr+i) is character not address of your array</p>\n\n<p>scanf must pass pointer of array</p>\n\n<p>%c is mean enter character 1 by 1</p>\n\n<p>for you case scanf(\"%c \",&amp;words.arr[i]); will key in 1 by 1</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;malloc.h&gt;\nstruct arr_string{\n    char *arr;\n    int size;\n};\nchar* alloc(int num){\n    char *temp = (char*)malloc(num*sizeof(char));\n    return temp;\n}\nint main(){\n    struct arr_string words;\n    int num,i;\n    printf(\"Enter no. of words: \");\n    scanf(\"%d \",&amp;num);\n    words.arr = alloc(num);\n    words.size = num;\n    for(i=0;i&lt;words.size-1;i++){\n        scanf(\"%c \",&amp;words.arr[i]);\n    }\n    for(;i&lt;words.size;i++){\n        scanf(\"%c\",&amp;words.arr[i]);\n    }\n    for(i=0;i&lt;words.size;i++){\n        printf(\"your %d is:%c \\n\",i,words.arr[i]);\n    }\n    //alloc need free back to system\n    free(words.arr);\n\n    return 0;\n}\n</code></pre>\n\n<p>If you want key in in one line must use %s like below</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;malloc.h&gt;\nstruct arr_string{\n    char *arr;\n    int size;\n};\nchar* alloc(int num){\n    char *temp = (char*)malloc(num*sizeof(char));\n    return temp;\n}\nint main(){\n    struct arr_string words;\n    int num;\n    printf(\"Enter no. of words: \");\n    scanf(\"%d \",&amp;num);\n    words.arr = alloc(num+1);//remember if you string printf by %s last one character must be '\\0' so need one more space\n    words.size = num;\n    scanf(\"%s\",words.arr);\n\n    printf(\"your string is:%s \\n\",words.arr);\n    //alloc need free back to system\n    free(words.arr);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 11706603, "user_type": "registered", "profile_image": "https://graph.facebook.com/2428489393861456/picture?type=large", "display_name": "Sabin Harnagea", "link": "https://stackoverflow.com/users/11706603/sabin-harnagea"}, "is_accepted": true, "score": 1, "last_activity_date": 1568194743, "creation_date": 1568194743, "answer_id": 57886250, "question_id": 57881796, "link": "https://stackoverflow.com/questions/57881796/add-a-string-array-to-a-character-pointer-in-c/57886250#57886250", "title": "Add a string array to a character pointer in c", "body": "<p>The reason why your program can read just one word is because you are creating the variable <code>words</code> that can store just <strong>1</strong> instance of the <code>struct arr_string</code>. Inside the struct we can see that you have pointer to <code>char</code> and an <code>int</code>. The <code>int</code> member should store the size of the word, but in your code, it store the numbers of words that you want to store witch is not correct. The member that is <code>char *</code> will store the characters from a word that you introduce.</p>\n\n<pre><code>char* alloc(int num){\n    char *temp = (char*)malloc(num*sizeof(char));\n    return temp;\n}\n</code></pre>\n\n<p>you allocate <strong>n</strong> numbers of char for your words.arr member from the structure.</p>\n\n<pre><code>words.arr = alloc(num);\n</code></pre>\n\n<p>That means what your variable words can store <strong>only 1</strong> string with <strong>n</strong> letters.\nIn order to store more words, you need to have an array of <code>arr_string</code> objects.</p>\n\n<p>Here you can find a solution to your problem:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;malloc.h&gt;\n\nstruct arr_string{\n    char *arr;\n    int size;\n};\nchar* alloc(int num){\n    char *temp = (char*)malloc(num*sizeof(char));\n    return temp;\n}\nint main(){\n    struct arr_string *words;\n    int num;\n    int i,j;\n    int letters;\n    char *buff;\n\n    printf(\"Enter no. of words: \");\n    scanf(\"%d\",&amp;num);\n\n    /*here it creates an array of arr_string objects*/\n    words = (struct arr_string*)malloc(num*sizeof(struct arr_string));\n\n    for(i=0;i&lt;num;++i)\n    {\n        letters=0;\n        /*alloc some memory for the buffer in witch you store the word entered from keyboad*/\n        buff=(char *)malloc(sizeof(char)*40);\n        scanf(\"%s\",buff);\n\n        /*seach how many letters are in the word*/\n        for(j=0;j&lt;40;++j)\n        {\n            if(buff[j] != '\\0')\n            {\n                letters++;\n            }\n            else\n            {\n                break;\n            }\n        }\n\n        /*set the value of size with the numbers of letters*/\n        words[i].size=letters;\n\n        /*alloc necessar memory for each word*/\n        words[i].arr=(char *)malloc(sizeof(char)*(words[i].size+1));\n\n        /*realloc memory so the word can be copied from the buffer*/\n        realloc(buff,sizeof(char)*(letters+1));\n\n        strcpy(words[i].arr,buff);\n        free(buff);\n    }\n\n    for(i=0;i&lt;num;++i)\n    {\n        printf(\"%s \",words[i].arr);\n    }\n\n\n    for(i=0;i&lt;num;++i)\n    {\n        free(words[i].arr);\n    }\n\n    free(words);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9236891"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 57886250, "answer_count": 2, "score": 0, "last_activity_date": 1568194743, "creation_date": 1568173162, "question_id": 57881796, "link": "https://stackoverflow.com/questions/57881796/add-a-string-array-to-a-character-pointer-in-c", "title": "Add a string array to a character pointer in c", "body": "<p>I defined a structure array_string which contains a character pointer and a integer denoting size. What I wanted to do was to store a user input string array in that pointer. By default pointer cannot take in multiple string values so I tried to dynamically allocate space to pointer inorder to store multiple strings. But it's still taking only 1 input. Can anyone please tell me how it's done?\nCode:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;malloc.h&gt;\nstruct arr_string{\n    char *arr;\n    int size;\n};\nchar* alloc(int num){\n    char *temp = (char*)malloc(num*sizeof(char));\n    return temp;\n}\nvoid main(){\n    struct arr_string words;\n    int num;\n    printf(\"Enter no. of words: \");\n    scanf(\"%d\",&amp;num);\n    words.arr = alloc(num);\n    words.size = num;\n    for(int i=0;i&lt;num;i++)\n        scanf(\"%s\",*(words.arr+i));\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1568173225, "post_id": 57881794, "comment_id": 102186456, "body": "<code>i == 20 || 30</code> is <code>(i == 20) || 30</code>. And <code>30</code> is a truthy value."}, {"owner": {"reputation": 481, "user_id": 6713871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d0cf46b08a63241386786e74ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Rollins", "link": "https://stackoverflow.com/users/6713871/chris-rollins"}, "edited": false, "score": 0, "creation_date": 1568176424, "post_id": 57881794, "comment_id": 102187112, "body": "in C every value other than binary 0 causes the conditional to evaluate as true. there&#39;s no concepts of &quot;true&quot; and &quot;false&quot; just 0 and everything else."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5323763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f5f465d4f20e15cc630b06efb015b9?s=128&d=identicon&r=PG&f=1", "display_name": "Gem", "link": "https://stackoverflow.com/users/5323763/gem"}, "edited": false, "score": 0, "creation_date": 1568173419, "post_id": 57881809, "comment_id": 102186487, "body": "What is the output of (i==20) that results to TRUE?"}, {"owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "reply_to_user": {"reputation": 93, "user_id": 5323763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f5f465d4f20e15cc630b06efb015b9?s=128&d=identicon&r=PG&f=1", "display_name": "Gem", "link": "https://stackoverflow.com/users/5323763/gem"}, "edited": false, "score": 1, "creation_date": 1568173506, "post_id": 57881809, "comment_id": 102186501, "body": "(i == 20) is <code>false</code>, but this does not matter, since <code>30</code> evaluates to <code>true</code> and you use logical <code>or</code> operator."}], "tags": [], "owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "is_accepted": false, "score": 7, "last_activity_date": 1568173264, "creation_date": 1568173264, "answer_id": 57881809, "question_id": 57881794, "link": "https://stackoverflow.com/questions/57881794/logical-operator-in-if-statement/57881809#57881809", "title": "Logical operator in if statement", "body": "<p>This: <code>if(i == 20 || 30)</code> is equivalent to <code>if((i == 20) || 30)</code> and <code>30</code> is always <code>true</code>.</p>\n\n<p>If you really want to do what I think you want to do, you should have written:</p>\n\n<pre><code>if(i == 20 || i == 30)\n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 93, "user_id": 5323763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f5f465d4f20e15cc630b06efb015b9?s=128&d=identicon&r=PG&f=1", "display_name": "Gem", "link": "https://stackoverflow.com/users/5323763/gem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568173469, "creation_date": 1568173150, "last_edit_date": 1568173469, "question_id": 57881794, "link": "https://stackoverflow.com/questions/57881794/logical-operator-in-if-statement", "title": "Logical operator in if statement", "body": "<p>Why does this statement returns TRUE? I thought C reads statement from left to right. What is the output of (i == 20) that results to 30 is TRUE?</p>\n\n<pre><code>i = 10;\nif(i == 20 || 30)\n{\nprintf(\"True\");\n}\nelse\n{\nprintf(\"False\");\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6359129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfab5dad0e1c7a204364ef773f90fcd?s=128&d=identicon&r=PG&f=1", "display_name": "W. Blengio", "link": "https://stackoverflow.com/users/6359129/w-blengio"}, "edited": false, "score": 0, "creation_date": 1568175550, "post_id": 57881979, "comment_id": 102186905, "body": "Amazing! You&#39;re right about this. However, what if I&#39;m about to remove the first/last (only) Node? would tmp=it-&gt;next cause a crash? since it-&gt;next would be NULL, even though at the end you put it = tmp which I believe would keep the program from entering into an infinite loop, it still crashes my program, or would this be an error somewhere else? Thank you in advance! Great explanation."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 15, "user_id": 6359129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfab5dad0e1c7a204364ef773f90fcd?s=128&d=identicon&r=PG&f=1", "display_name": "W. Blengio", "link": "https://stackoverflow.com/users/6359129/w-blengio"}, "edited": false, "score": 0, "creation_date": 1568175941, "post_id": 57881979, "comment_id": 102187005, "body": "<code>tmp = it-&gt;next;</code> is fine if <code>it-&gt;next == NULL</code> - it&#39;s equivalent to just <code>tmp = NULL;</code>.  It&#39;s only if <code>it == NULL</code> that it would be a problem, but we know that is <i>not</i> the case because the loop would have exited if <code>it</code> was <code>NULL</code>."}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 1, "last_activity_date": 1568174690, "creation_date": 1568174690, "answer_id": 57881979, "question_id": 57881594, "link": "https://stackoverflow.com/questions/57881594/removing-nodes-from-a-doubly-linked-list-correctly/57881979#57881979", "title": "Removing nodes from a Doubly linked list correctly", "body": "<p>When you delete a node <code>it</code>, you need to both replace the previous node's next pointer with <code>it-&gt;next</code>, and replace the next node's previous pointer with <code>it-&gt;prev</code>.</p>\n\n<p>However, when doing this you must also account for the special cases at the start and end of the list:</p>\n\n<pre><code>if (it-&gt;prev != NULL)\n    it-&gt;prev-&gt;next = it-&gt;next;\nelse\n    this-&gt;first = it-&gt;next;\n\nif (it-&gt;next != NULL)\n    it-&gt;next-&gt;prev = it-&gt;prev;\nelse\n    this-&gt;last = it-&gt;prev;\n</code></pre>\n\n<p>Your <code>tmp</code> variable should just be used to save the pointer to the next node to be examined, in case <code>it</code> is freed.  Putting it all into your loop:</p>\n\n<pre><code>Bool LinkedList_removestr(LinkedList * this, char * str)\n{\n    Node * tmp = NULL;\n    Node * it = this-&gt;first;\n    Bool Bandera = FALSE;\n\n    while (it != NULL)\n    {\n        /* Save it-&gt;next, because 'it' may be freed */\n        tmp = it-&gt;next;\n\n        if (strcmp(it-&gt;name, str) == 0)\n        {\n            Bandera = TRUE;\n\n            /* Adjust next pointer of previous node */\n            if (it-&gt;prev != NULL)\n                it-&gt;prev-&gt;next = it-&gt;next;\n            else\n                this-&gt;first = it-&gt;next;\n\n            /* Adjust previous pointer of next node */\n            if (it-&gt;next != NULL)\n                it-&gt;next-&gt;prev = it-&gt;prev;\n            else\n                this-&gt;last = it-&gt;prev;\n\n            free(it);\n        }\n\n        it = tmp;\n    }\n\n    return Bandera;\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6359129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfab5dad0e1c7a204364ef773f90fcd?s=128&d=identicon&r=PG&f=1", "display_name": "W. Blengio", "link": "https://stackoverflow.com/users/6359129/w-blengio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57881979, "answer_count": 1, "score": 0, "last_activity_date": 1568174690, "creation_date": 1568171539, "question_id": 57881594, "link": "https://stackoverflow.com/questions/57881594/removing-nodes-from-a-doubly-linked-list-correctly", "title": "Removing nodes from a Doubly linked list correctly", "body": "<p>While trying to remove nodes, I'm able to free the memory allocated, but unable to assign it to NULL so my program stops printing these addresses. I'm led to believe that I MUST use double pointers to do this. </p>\n\n<p>I've tried equaling to NULL after freeing, but that crashes the program. </p>\n\n<pre><code>typedef struct Linked_List_type\n{\n    struct Node_type *first;\n    struct Node_type *last;\n} LinkedList;\ntypedef struct Node_type\n{\n    int data;\n    char name[15];\n    char phone[15];\n    struct Node_type *next;\n    struct Node_type *prev;\n} Node;\n//This is how I insert\nvoid LinkedList_insert (LinkedList * this, int val, char * name, char * phone)\n{\n//creo un nodo para insertar\n    Node *it = this-&gt;first;\n    Node *newNode = new_Node (val, name, phone);\n    if (!this)\n    {\n        printf (\"Lista no creada\\n\");\n    }\n    for (it = this-&gt;first; it != NULL; it = it-&gt;next)\n    {\n        if (strcmp(it-&gt;name, name)==0) //Evitar repeticiC3n\n        {\n            printf (\"Valor repetido\\n\");\n            return;\n        }\n    }\n    if (!this-&gt;first)\n    {\n        newNode-&gt;next = NULL;\n        this-&gt;last = newNode;\n        this-&gt;first = newNode;\n//first y last ocupan el mismo valor, siguiente apunta a nulo\n//solo si la lista estC! vacC-a\n    }\n    else\n    {\n        newNode-&gt;prev = this-&gt;last;\n        this-&gt;last-&gt;next = newNode;\n        this-&gt;last = this-&gt;last-&gt;next;\n    }\n}\n//This is how I remove \nBool LinkedList_removestr(LinkedList * this, char * str)\n{\n    Node * tmp = NULL;\n    Node * it = this-&gt;first;\n    Bool Bandera = FALSE;\n    while(it!=NULL)\n    {\n        if(it-&gt;next!=NULL &amp;&amp; strcmp(it-&gt;name,str)==0)\n        {\n            tmp=it;\n            it=it-&gt;next;\n            free(tmp);\n            Bandera=TRUE;\n        }\n        if(it-&gt;next==NULL &amp;&amp; strcmp(it-&gt;name,str)==0)//si first es igual al que quiero remover\n        {\n            tmp=it;\n            free(tmp);//no apunto a next porque no hay\n            Bandera=TRUE;\n        }\n        it=it-&gt;next;\n    }\n    return Bandera;\n}\n</code></pre>\n\n<p>After removal, when printing the list, I expect the list to skip the removed node address, or not show it, but after using my remove function, when printing the list, the Node prints the address, I belive.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12050613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea291dc6bb1d0cc948c953ad5d1c5b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/12050613/siva"}, "edited": false, "score": 0, "creation_date": 1568260963, "post_id": 57881660, "comment_id": 102219791, "body": "Can someone help me"}, {"owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "reply_to_user": {"reputation": 1, "user_id": 12050613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea291dc6bb1d0cc948c953ad5d1c5b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/12050613/siva"}, "edited": false, "score": 0, "creation_date": 1568755355, "post_id": 57881660, "comment_id": 102373558, "body": "There are a number of questions on this site that have example code for using <code>signal()</code> and <code>alarm()</code>.  For example, see <a href=\"https://stackoverflow.com/questions/1784136/simple-signals-c-programming-and-alarm-function\">either of</a> <a href=\"https://stackoverflow.com/questions/21542077/c-sigalrm-alarm-to-display-message-every-second\">these questions</a>."}], "tags": [], "owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "is_accepted": false, "score": 1, "last_activity_date": 1568172070, "creation_date": 1568172070, "answer_id": 57881660, "question_id": 57881510, "link": "https://stackoverflow.com/questions/57881510/signals-using-alarm-in-linux-c/57881660#57881660", "title": "Signals Using Alarm() in Linux C", "body": "<p>The <code>alarm()</code> function causes <code>SIGALRM</code> to be raised, but you have to use the <a href=\"https://linux.die.net/man/2/signal\" rel=\"nofollow noreferrer\"><code>signal()</code></a> function first to register a handler for this signal.  Your program never registers a handler so there's nothing to run when the signal is raised.</p>\n"}], "owner": {"reputation": 1, "user_id": 12050613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea291dc6bb1d0cc948c953ad5d1c5b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/12050613/siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568172296, "creation_date": 1568170911, "last_edit_date": 1568172296, "question_id": 57881510, "link": "https://stackoverflow.com/questions/57881510/signals-using-alarm-in-linux-c", "title": "Signals Using Alarm() in Linux C", "body": "<ol>\n<li><p>When there is timeout the program should move to second question and if time out it should say \" your time is over \".</p></li>\n<li><p>Currently my program runs for the first question but not going to second question.</p></li>\n</ol>\n\n<p>I have tried many time but it doesn't work.</p>\n\n<pre><code>Int main(){\n    int time1\n    char q1[20]\n    printf(\"\\n\")\n    printf(\"Enter the malaysia capital name : \");\n\n    alarm(30);\n    scanf(\"%[^\\n]\",q1);\n\n    if (time != SIGALRM)\n    {\n        alarm(0);\n        printf(\"The Malaysia capital is : '%s'\\n\",q1);\n        printf(\"\\n\");\n    }\n\n    int time2\n        char q1[20]\n    printf(\"\\n\")\n    printf(\"Enter the malaysian tallest building : \");\n\n    alarm(30);\n    scanf(\"%s\",q2);\n\n    if (time2 != SIGALRM)\n\n    { \n                alarm(0);\n        printf(\"Enter the malaysian tallest building is  : '%s'\\n\",q2);\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>Expected :- After time out should move to second question\nActual :- Not moving to second question</p>\n"}, {"tags": ["c", "linux", "bit-shift"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1568170698, "post_id": 57881433, "comment_id": 102186031, "body": "It is implementation-defined behavior whether or not the sign-bit shifts for signed numbers."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12050726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mALl_1ssF_MdPu81gL7SnS-qPXv7ezkXZFQzMm5=k-s128", "display_name": "Kenneth Straw", "link": "https://stackoverflow.com/users/12050726/kenneth-straw"}, "edited": false, "score": 0, "creation_date": 1568171556, "post_id": 57881498, "comment_id": 102186176, "body": "Of course, thank you. However, one more question, why does ob come out to -1 (as per my tests) when we shift 0x80000000 31 bits to the right?"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 21, "user_id": 12050726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mALl_1ssF_MdPu81gL7SnS-qPXv7ezkXZFQzMm5=k-s128", "display_name": "Kenneth Straw", "link": "https://stackoverflow.com/users/12050726/kenneth-straw"}, "edited": false, "score": 0, "creation_date": 1568171843, "post_id": 57881498, "comment_id": 102186223, "body": "@KennethStraw: if you&#39;re getting <code>-1</code>, your implementation both preserves the sign bit <i>and</i> shifts it into the leftmost magnitude bit. Hence you see <code>0x80000000</code>, <code>0xc0000000</code>, <code>0xe0000000</code>, <code>0xf0000000</code>, <code>0xf8000000</code>, <code>0xfc000000</code>, all the way to <code>0xffffffff</code>."}, {"owner": {"reputation": 21, "user_id": 12050726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mALl_1ssF_MdPu81gL7SnS-qPXv7ezkXZFQzMm5=k-s128", "display_name": "Kenneth Straw", "link": "https://stackoverflow.com/users/12050726/kenneth-straw"}, "edited": false, "score": 0, "creation_date": 1568172068, "post_id": 57881498, "comment_id": 102186271, "body": "Thank you so much that clears a lot up, and as for the ! operator I am only allowed to use ~ &amp; ^ | + &lt;&lt; and &gt;&gt; operators. Still, thank you so much!"}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1568171730, "last_edit_date": 1568171730, "creation_date": 1568170817, "answer_id": 57881498, "question_id": 57881433, "link": "https://stackoverflow.com/questions/57881433/bitshift-causing-overflow-when-it-shouldnt/57881498#57881498", "title": "Bitshift Causing Overflow When It Shouldn&#39;t", "body": "<p>If you were shifting the max positive two's complement number, it <em>would</em> end up as zero.</p>\n\n<p>But you are <em>not</em> shifting that number:</p>\n\n<pre><code>int x = 0x7FFFFFFF;\nint nx = ~x;          // 0x80000000 (assuming 32-bit int).\n</code></pre>\n\n<p>You are bit-shifting the largest (in magnitude) <em>negative</em> number.</p>\n\n<p>And, as per the standards document <code>C11 6.5.7 Bitwise shift operators /5</code> (my emphasis):</p>\n\n<blockquote>\n  <p>The result of <code>E1 &gt;&gt; E2</code> is <code>E1</code> right-shifted <code>E2</code> bit positions. If <code>E1</code> has an unsigned type or if <code>E1</code> has a signed type and a nonnegative value, the value of the result is the integral part of the quotient of <code>E1 / 2^E2</code> . <strong><em>If <code>E1</code> has a signed type and a negative value, the resulting value is implementation-defined.</em></strong></p>\n</blockquote>\n\n<p>Your implementation seems to preserve the sign bit, which is why you end up with the non-zero negative value.</p>\n\n<hr>\n\n<p>As an aside, if you want a <code>!</code> operator, you can just use:</p>\n\n<pre><code>output = (input == 0);\n</code></pre>\n\n<p>See afore-mentioned standard, <code>6.5.3.3 Unary arithmetic operators /5</code> (again, my emphasis) where it explicitly calls out the equivalence:</p>\n\n<blockquote>\n  <p>The result of the logical negation operator <code>!</code> is <code>0</code> if the value of its operand compares unequal to <code>0</code>, <code>1</code> if the value of its operand compares equal to <code>0</code>. The result has type <code>int</code>. <strong><em>The expression <code>!E</code> is equivalent to <code>(0==E)</code>.</em></strong></p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 12050726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mALl_1ssF_MdPu81gL7SnS-qPXv7ezkXZFQzMm5=k-s128", "display_name": "Kenneth Straw", "link": "https://stackoverflow.com/users/12050726/kenneth-straw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57881498, "answer_count": 1, "score": 1, "last_activity_date": 1568171730, "creation_date": 1568170325, "last_edit_date": 1568170551, "question_id": 57881433, "link": "https://stackoverflow.com/questions/57881433/bitshift-causing-overflow-when-it-shouldnt", "title": "Bitshift Causing Overflow When It Shouldn&#39;t", "body": "<p>When I am bitshifting the max positive 2's complement, shouldn't shifting it 31 bits make an effective 0 because it starts as 0111 1111, etc. </p>\n\n<p>I have tried decreasing the shift but I am assuming it's just the computer reading it incorrectly.</p>\n\n<pre><code>int main(void) \n{\n  int x = 0x7FFFFFFF;\n  int nx = ~x;\n  int ob = nx &gt;&gt; 31;\n  int ans = ob &amp; nx;\n\n  printf(\"%d\",ans);\n}\n</code></pre>\n\n<p>I am expecting ob to be 0 but it turns out as the twos complement minimum. I am using this to create a bang without actually using !.</p>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "reply_to_user": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1568170998, "post_id": 57881402, "comment_id": 102186070, "body": "I did but it still wont work, still prints it two times"}, {"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568171345, "post_id": 57881402, "comment_id": 102186132, "body": "if I put a space int the scanf after the last %lf it stops printing the last one twice but it stops printing the first letter of each one"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1568171369, "post_id": 57881402, "comment_id": 102186137, "body": "You should always check the return value of every <code>scanf()</code> call for success before trying to use the values it sets."}, {"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1568171550, "post_id": 57881402, "comment_id": 102186172, "body": "Kind of new in C so im not sure what you mean but im actually printg them to see if its scanning everything how its supposed to but it seems its not doing that"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568173513, "post_id": 57881402, "comment_id": 102186507, "body": "Use <code>fgets()</code> or POSIX <code>getline()</code> to read lines, then use <code>sscanf()</code> to parse the data.  It often works better \u2014 and, in particular, would work better for you."}, {"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568175115, "post_id": 57881402, "comment_id": 102186820, "body": "Ok thanks ill read into those methods to understand what they do and ill see if they work for me, ill let you know"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568171489, "post_id": 57881568, "comment_id": 102186158, "body": "hmm okay so i understand its doing it one more time but then what can I do to stop it from doing this?"}, {"owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "reply_to_user": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568171728, "post_id": 57881568, "comment_id": 102186205, "body": "Always check the return value of <code>scanf</code> before trying to use any of the variables that it was supposed to write into.  After you <code>scanf</code> the line, you can use <code>getc()</code> to grab the next character and either throw it away if it&#39;s a newline, or put it back with <code>ungetc()</code> if it&#39;s not.  Your <code>while</code> condition would then check for EOF instead of trying to read anything."}, {"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568171877, "post_id": 57881568, "comment_id": 102186230, "body": "Well in the while i also tried to put instead of ==1 i put != EOF but it didnt work either. But ill try using this getc() now and let you know if it works"}, {"owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568172200, "post_id": 57881568, "comment_id": 102186290, "body": "ok i tried if getc(stdin) == &#39;\\n&#39;   throw away else ungetc(stdin); but this unget is not working"}, {"owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "reply_to_user": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "edited": false, "score": 0, "creation_date": 1568754845, "post_id": 57881568, "comment_id": 102373402, "body": "When you call <code>ungetc()</code>, you also have to pass it the character to put back.  See <a href=\"https://linux.die.net/man/3/ungetc\" rel=\"nofollow noreferrer\">the ungetc</a> documentation for usage details."}], "tags": [], "owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "is_accepted": false, "score": 1, "last_activity_date": 1568171311, "creation_date": 1568171311, "answer_id": 57881568, "question_id": 57881402, "link": "https://stackoverflow.com/questions/57881402/why-is-my-program-printing-the-last-input-line-twice/57881568#57881568", "title": "Why is my program printing the last input line twice?", "body": "<ul>\n<li><code>scanf</code> is reading values into variables that aren't cleared before each run.</li>\n<li>You aren't checking the return value of <code>scanf</code> to make sure that it succeeded.</li>\n<li><code>scanf</code> doesn't read the newline at the end of the input, but the <code>scanf('%c')</code> does.</li>\n</ul>\n\n<p>Together this means after you read your last line of input, you loop back, <code>while(scanf(\u2026))</code> successfully reads in the final newline, your other <code>scanf</code> fails because there's no more input, and the <code>printf</code> prints the stale data inside the local variables.</p>\n"}], "owner": {"reputation": 107, "user_id": 11637608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32518cc610450d346c1bb66aaf506182?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Esquivel", "link": "https://stackoverflow.com/users/11637608/diego-esquivel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568172357, "creation_date": 1568170131, "last_edit_date": 1568172357, "question_id": 57881402, "link": "https://stackoverflow.com/questions/57881402/why-is-my-program-printing-the-last-input-line-twice", "title": "Why is my program printing the last input line twice?", "body": "<p>My program is supposed to print what my input give reading it letter by \nletter with a scanf  and saving them in variables when after they print \nwhats \ninside them. This in a cycle so it can print every line. But it seems it \neither is scanning the last line two times or printing it two times </p>\n\n<p>I tried putting \\n inside the scans which solve the printing problem but \nnow it wouldn't print the first letters of each line</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    #include &lt;math.h&gt;\n    #include &lt;stdio.h&gt;\n\n    int main()\n    {\n    double tempG = 0;\n    double altG = 0;\n    double humG = 0;\n\n    char cultivo[100] = \" \";\n\n    char  nombre[100] = \" \";\n    double temp = 0;\n    double alt = 0;\n    double hum = 0;\n\n    char insertado;\n\n    int contador = 0;\n    scanf(\"%lf %lf %lf\" , &amp;tempG, &amp;altG, &amp; humG);\n    printf(\"%2.0lf %2.0lf %2.0lf \\n \\n\", tempG, altG, humG);\n    char temporal[100] = \"\";\n    while(scanf(\"%c\", &amp;insertado) != EOF){\n            scanf(\"%s %lf %lf %lf\", nombre, &amp;temp, &amp;alt, &amp;hum);\n            printf(\"%s %.0lf %.0lf %.0lf \\n\", nombre, temp, alt, hum);\n\n        }\n\n\n    return 0;\n    }\n\n</code></pre>\n\n<p>This is my input and my expected output: </p>\n\n<blockquote>\n<pre><code>25 65 1200\n\nBanano 27 50 1000\nBrocoli 16 75 2500\nFresas 18 80 2000\nZanahoria 21 75 1200\nTomate 22 75 1000\n</code></pre>\n</blockquote>\n\n<p>This is my actual output:</p>\n\n<blockquote>\n<pre><code>25 65 1200\n\nBanano 27 50 1000\nBrocoli 16 75 2500\nFresas 18 80 2000\nZanahoria 21 75 1200\nTomate 22 75 1000\nTomate 22 75 1000\n</code></pre>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1568169828, "post_id": 57881328, "comment_id": 102185909, "body": "don&#39;t you want <code>1</code> to be place at the old position of <code>5</code> after rotation?"}, {"owner": {"reputation": 11, "user_id": 10555585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2488e612fd5e6069148ccd48b8d26f6f?s=128&d=identicon&r=PG&f=1", "display_name": "user10555585", "link": "https://stackoverflow.com/users/10555585/user10555585"}, "reply_to_user": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1568170228, "post_id": 57881328, "comment_id": 102185974, "body": "No, Basically the program uses the first index for another variable, and the array needs to move to the left +1 like a queue."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1568271730, "post_id": 57881328, "comment_id": 102223036, "body": "What result do you want if you call <code>order_array(5, array)</code> for <code>int array[10] = {1,2,3,4,5,6,7,8,9,10}</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10555585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2488e612fd5e6069148ccd48b8d26f6f?s=128&d=identicon&r=PG&f=1", "display_name": "user10555585", "link": "https://stackoverflow.com/users/10555585/user10555585"}, "edited": false, "score": 0, "creation_date": 1568170186, "post_id": 57881359, "comment_id": 102185965, "body": "Thanks for the reply. I tried that code because the 5 didn&#39;t get replaced by the next 0, it would just be double 5&#39;s."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1568170502, "last_edit_date": 1568170502, "creation_date": 1568169832, "answer_id": 57881359, "question_id": 57881328, "link": "https://stackoverflow.com/questions/57881328/how-to-move-one-element-to-the-left-of-a-fixed-array/57881359#57881359", "title": "How to move one element to the left of a fixed array", "body": "<pre><code>    if (array[i] == 0)\n    {\n        array[i-1] = 0;\n    }\n</code></pre>\n\n<p>I don't understand why this block is there. It's not possible to get inside the if statement.</p>\n\n<p>With your expected output and given this is an array of <code>int</code>s, I suspect the solution is to only output four values in your print statement, but if the last element of the array should be zero, you can just do this after your <code>for</code> loop:</p>\n\n<pre><code>array[size-1] = 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10555585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2488e612fd5e6069148ccd48b8d26f6f?s=128&d=identicon&r=PG&f=1", "display_name": "user10555585", "link": "https://stackoverflow.com/users/10555585/user10555585"}, "edited": false, "score": 0, "creation_date": 1568171500, "post_id": 57881466, "comment_id": 102186160, "body": "This is what i dont want. i want 2345000000, so without the double 5"}, {"owner": {"reputation": 88, "user_id": 1097709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af33d46521c11ffa0babf7898b39284d?s=128&d=identicon&r=PG", "display_name": "chenmo", "link": "https://stackoverflow.com/users/1097709/chenmo"}, "reply_to_user": {"reputation": 11, "user_id": 10555585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2488e612fd5e6069148ccd48b8d26f6f?s=128&d=identicon&r=PG&f=1", "display_name": "user10555585", "link": "https://stackoverflow.com/users/10555585/user10555585"}, "edited": false, "score": 0, "creation_date": 1568172787, "post_id": 57881466, "comment_id": 102186384, "body": "I have modified the answer, if you want 2345000000, do nothing when you find default 0."}], "tags": [], "owner": {"reputation": 88, "user_id": 1097709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af33d46521c11ffa0babf7898b39284d?s=128&d=identicon&r=PG", "display_name": "chenmo", "link": "https://stackoverflow.com/users/1097709/chenmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1568172567, "last_edit_date": 1568172567, "creation_date": 1568170544, "answer_id": 57881466, "question_id": 57881328, "link": "https://stackoverflow.com/questions/57881328/how-to-move-one-element-to-the-left-of-a-fixed-array/57881466#57881466", "title": "How to move one element to the left of a fixed array", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n#define ARRAY_SIZE 10\n\nvoid order_array(int size, int* array) {\n    for (int i = 0; i &lt; size; i++) {\n\n        if (!array[i]) {\n            continue;\n        }\n\n        if (i + 1 &lt; size)\n            array[i] = array[i + 1];\n    }\n}\n\nint main() {\n    int array[ARRAY_SIZE] = {1, 2, 3, 4, 5};\n    printf(\"intput: \");\n    for (int i = 0; i &lt; ARRAY_SIZE; i++) {\n        printf(\"%d\", array[i]);\n    }\n    printf(\"\\n\");\n\n    order_array(ARRAY_SIZE, array);\n\n    printf(\"output: \");\n    for (int i = 0; i &lt; ARRAY_SIZE; i++) {\n        printf(\"%d\", array[i]);\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Maybe you should consider the last value that not equal to default value 0.</p>\n\n<p>Execute in shell:</p>\n\n<p>gcc -o a.out a.c &amp;&amp; ./a.out </p>\n\n<pre><code>intput: 1234500000\noutput: 2345000000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "is_accepted": false, "score": 0, "last_activity_date": 1568170590, "creation_date": 1568170590, "answer_id": 57881471, "question_id": 57881328, "link": "https://stackoverflow.com/questions/57881328/how-to-move-one-element-to-the-left-of-a-fixed-array/57881471#57881471", "title": "How to move one element to the left of a fixed array", "body": "<p>If you don't want rotation then:</p>\n\n<pre><code>int arr[];  //initialize it\nint siz=sizeof(arr)/sizeof(arr[0]);\nint index=0; \n\nwhile(index&lt;siz-1)\n{\n    arr[index]=arr[index+1];\n    index++;\n}\n\narr[index]=0;  //0 default value at the end of the array\n</code></pre>\n\n<p>This will work fine</p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1568172236, "creation_date": 1568172236, "answer_id": 57881683, "question_id": 57881328, "link": "https://stackoverflow.com/questions/57881328/how-to-move-one-element-to-the-left-of-a-fixed-array/57881683#57881683", "title": "How to move one element to the left of a fixed array", "body": "<p>You just need to manually set the last value to zero at the end.  I'd also consider using the built-in <code>memmove</code> function which is designed for moving around data where the source and destination overlap.</p>\n\n<pre><code>void order_array(int size, int array[]){\n    memmove(array, array+1, (size-1) * sizeof(array[0]));\n    array[size-1] = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10555585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2488e612fd5e6069148ccd48b8d26f6f?s=128&d=identicon&r=PG&f=1", "display_name": "user10555585", "link": "https://stackoverflow.com/users/10555585/user10555585"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1568172567, "creation_date": 1568169548, "last_edit_date": 1568169985, "question_id": 57881328, "link": "https://stackoverflow.com/questions/57881328/how-to-move-one-element-to-the-left-of-a-fixed-array", "title": "How to move one element to the left of a fixed array", "body": "<pre><code>int array[10] = {1,2,3,4,5}\n\n</code></pre>\n\n<p>from my understanding, the rest of the indexes that haven't been assign a value will be 0. If I want to move every element to the left (I am wanting to remove the first value i.e. index 0). How do I do this without causing duplicate values for the last index with a integer assigned?</p>\n\n<p>For example:</p>\n\n<p>current array</p>\n\n<pre><code>output: 1234500000\n</code></pre>\n\n<p>+1 to the left:</p>\n\n<pre><code>output: 2345500000\n</code></pre>\n\n<p>I tried the following code:</p>\n\n<pre><code>void order_array(int size, int array[])\n{\n    for (int i = 0; i &lt; size-1; i++)\n    {\n        if (array[i] == 0)\n        {\n            array[i-1] = 0;\n        }\n        array[i] = array[i+1];\n    }\n}\n</code></pre>\n\n<p>expected output after method execution:</p>\n\n<pre><code>output: 2345000000\n</code></pre>\n\n<p>Also before someone says this is a duplicate, I have looked around and no thread explains with fixed arrays, i.e. with 0's as default values.</p>\n\n<p>Appreciate your response.</p>\n"}, {"tags": ["c", "malloc", "calloc"], "comments": [{"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1568169585, "post_id": 57881307, "comment_id": 102185872, "body": "Have a look at this question: <a href=\"https://stackoverflow.com/questions/181050/can-you-allocate-a-very-large-single-chunk-of-memory-4gb-in-c-or-c\" title=\"can you allocate a very large single chunk of memory 4gb in c or c\">stackoverflow.com/questions/181050/&hellip;</a>"}, {"owner": {"reputation": 101, "user_id": 12050589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60b05a6e5fd39b461a1648e03eca98ba?s=128&d=identicon&r=PG&f=1", "display_name": "Iron Maiden", "link": "https://stackoverflow.com/users/12050589/iron-maiden"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1568169778, "post_id": 57881307, "comment_id": 102185902, "body": "@daShier indeed what I thought. From Benoit&#39;s answer I can see windows does not let me allocate more than 4GB, is that the problem then? I mean, is it not possible to overcome this problem and allocate the memory needed in my computer other than using Linux?"}, {"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 2, "creation_date": 1568170418, "post_id": 57881307, "comment_id": 102185992, "body": "As an aside: why do you need such a huge vector? Perhaps you need to think about creating an index and buffer chunks of data? Another possibility (greatly depending on your data structure) is to think about using a database since they are really good at indexing and retrieving information in massive tables."}, {"owner": {"reputation": 101, "user_id": 12050589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60b05a6e5fd39b461a1648e03eca98ba?s=128&d=identicon&r=PG&f=1", "display_name": "Iron Maiden", "link": "https://stackoverflow.com/users/12050589/iron-maiden"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1568170958, "post_id": 57881307, "comment_id": 102186064, "body": "@daShier I&#39;m actually experimenting with it, thus going as deep as I can to learn how to manage memory allocation. Linux allowed to do what I wanted though. Anyway, I don&#39;t know how to create this index and later buff chunks of data once I&#39;m a newbie in the CS field. So, can you help me with some tips or articles about it so I can study it?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568180924, "post_id": 57881307, "comment_id": 102188394, "body": "Worth reading <a href=\"https://stackoverflow.com/questions/2798330/maximum-memory-which-malloc-can-allocate\">maximum memory which malloc can allocate</a>"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 12050589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60b05a6e5fd39b461a1648e03eca98ba?s=128&d=identicon&r=PG&f=1", "display_name": "Iron Maiden", "link": "https://stackoverflow.com/users/12050589/iron-maiden"}, "edited": false, "score": 0, "creation_date": 1568171334, "post_id": 57881497, "comment_id": 102186131, "body": "I&#39;m a newbie in this field so I don&#39;t know exactly how to do that you&#39;ve said. I&#39;ve googled the VirtualAlloc API and found the function :  LPVOID VirtualAlloc(   LPVOID lpAddress,   SIZE_T dwSize,   DWORD  flAllocationType,   DWORD  flProtect ); so I should replace it like this ? :   LPVOID VirtualAlloc(   LPVOID NULL,   SIZE_T dwSize,   DWORD  MEM_COMMIT,   DWORD  PAGE_READWRITE );"}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1568174788, "last_edit_date": 1568174788, "creation_date": 1568170816, "answer_id": 57881497, "question_id": 57881307, "link": "https://stackoverflow.com/questions/57881307/how-to-correctly-allocate-a-large-chunk-of-ram-with-calloc-malloc-in-windows-10/57881497#57881497", "title": "How to correctly allocate a large chunk of RAM with calloc/malloc in Windows 10?", "body": "<p>The C run time won't let you do this but windows will, use the VirtualAlloc API instead of calloc. Specify NULL for the lpAddress parameter, MEM_COMMIT for flAllocationType  and PAGE_READWRITE for flProtect. Also note that even though dwSize uses the \"dw\" decoration that is usually DWORD in this case the parameter is actually a SIZE_T which is 64-bit for 64-bit builds.</p>\n\n<p>Code would look like:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n\n...\n\nLPVOID pResult = VirtualAlloc(NULL, dwSize, MEM_COMMIT, PAGE_READWRITE);\nif(NULL == pResult)\n{ /* Handle allocation error */ }\n</code></pre>\n\n<p>Where dwSize is the number of bytes of memory you wish to allocate, you later use VirtualFree to release the allocated memory : VirtualFree(pResult, 0, MEM_RELEASE);</p>\n\n<p>The dwSize parameter to VirtualFree is for use when you specify MEM_DECOMMIT (rather than MEM_RELEASE), allowing you to put memory back in the reserved but uncommitted state (meaning that actual pages have not yet been found to satisfy the allocation).</p>\n"}], "owner": {"reputation": 101, "user_id": 12050589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60b05a6e5fd39b461a1648e03eca98ba?s=128&d=identicon&r=PG&f=1", "display_name": "Iron Maiden", "link": "https://stackoverflow.com/users/12050589/iron-maiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568174788, "creation_date": 1568169413, "last_edit_date": 1568170121, "question_id": 57881307, "link": "https://stackoverflow.com/questions/57881307/how-to-correctly-allocate-a-large-chunk-of-ram-with-calloc-malloc-in-windows-10", "title": "How to correctly allocate a large chunk of RAM with calloc/malloc in Windows 10?", "body": "<p>I need to allocate memory for a vector with n=10^9 (1 billion) rows using calloc or malloc but when I try to allocate this amount of memory the system crashes and returns me NULL, which I presumed to be the system not allowing me to allocate this big chunk of memory. I'm using Windows 10 in a 64-bit platform with 16 GB RAM.\n However, when I ran the same code in a Linux OS (Debian) the system actually allocated the amount I demanded, so now I'm wondering:  </p>\n\n<p>How can I allocate this big chunk using Windows 10, once I'm out of time to \n venture in Linux yet?</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(void) {\n\nuint32_t * a = calloc(1000000000, 4);\nprintf(\"a = %08x\\n\", a);\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "datetime", "utc", "localtime", "timespec"], "comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1568186284, "post_id": 57881239, "comment_id": 102190433, "body": "The difference (1568155506 - 1568151907) is quite exactly 1 hour. Perhaps daylight saving is not taken into account?"}, {"owner": {"reputation": 637, "user_id": 4071435, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/598ac8af735dd5a8892220bba350cad4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Grinberg", "link": "https://stackoverflow.com/users/4071435/paul-grinberg"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1568207754, "post_id": 57881239, "comment_id": 102201632, "body": "@thebusybee - I agree that it&#39;s likely due to daylight savings. But the question is how should I be accounting for that?"}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1568296528, "post_id": 57881239, "comment_id": 102236455, "body": "<i>I also have a 3rd party network device which provides its time also as seconds from epoch, but it does so using localtime instead of UTC time.</i> This statement doesn&#39;t make sense; the Epoch is 1970-01-01 00:00:00 +0000 (UTC) - for a certain point in time, there is only one number  of  seconds  elapsed        since the Epoch, and the time zone or localtime cannot change that number. What do you actually mean? At which point in time did the device report <code>1568133906.065000</code>? Is the device actually aware of a timezone? In what timezone is it located? How was the device&#39;s time set?"}, {"owner": {"reputation": 637, "user_id": 4071435, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/598ac8af735dd5a8892220bba350cad4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Grinberg", "link": "https://stackoverflow.com/users/4071435/paul-grinberg"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 1, "creation_date": 1568296829, "post_id": 57881239, "comment_id": 102236661, "body": "@Armali - Since this is a 3rd party device, I can only infer how it treats time. From what I can tell, it keeps its RTC in localtime. It does not have a notion of a timezone. When I use a 3rd party tool to set the time on this device, the time is sent to the device as broken-down (aka year, month, day, hour, min, sec) localtime from my machine and the device simply takes it and starts ticking its clock from whatever value it received. Then, if I ask the device for time, it gives me a number which only makes sense as a seconds since epoch, but clearly it&#39;s in localtime and not UTC."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1568302567, "post_id": 57881239, "comment_id": 102240027, "body": "So, if I understand correctly, if you set the time by sending 2019, 9, 10, 16, 45, 6 and asked for the time shortly thereafter, the device would give a number just a little higher than 1568133906? If so, then I wouldn&#39;t say that the number is <i>in localtime</i> - you just view the broken-down time you provide as localtime, but on no basis. Wouldn&#39;t all be easier if you think of the device as using UTC, and setting its time with UTC values?"}, {"owner": {"reputation": 637, "user_id": 4071435, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/598ac8af735dd5a8892220bba350cad4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Grinberg", "link": "https://stackoverflow.com/users/4071435/paul-grinberg"}, "reply_to_user": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 1, "creation_date": 1568304414, "post_id": 57881239, "comment_id": 102240894, "body": "@Armali - Your understanding of how time is set into and reported from this device is correct. However, I cannot set the device time with a broken-down UTC timestamp because whatever value the device gets it displays to the user of the device (outside of my PC) as localtime. In other words, users of this device expect the time displayed by the device to match their hypothetical watch and I want that to match the localtime on my PC"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1568366052, "creation_date": 1568366052, "answer_id": 57920666, "question_id": 57881239, "link": "https://stackoverflow.com/questions/57881239/convert-localtime-in-seconds-since-epoch-to-utc/57920666#57920666", "title": "Convert localtime in seconds since epoch to UTC", "body": "<blockquote>\n  <p>I agree that it's likely due to daylight savings. But the question is how should I be accounting for that?</p>\n</blockquote>\n\n<p>The relevant information is found in <a href=\"https://linux.die.net/man/3/mktime\" rel=\"nofollow noreferrer\"><code>man mktime</code></a>:</p>\n\n<blockquote>\n  <p>The value specified in the <i>tm_isdst</i> field informs <b>mktime</b>() whether\n  or not daylight saving time (DST) is in effect for the time supplied in the <i>tm</i> structure: a positive value means DST is in effect; zero means that DST\n  is not in effect; and a negative value means that <b>mktime</b>() should (use timezone information and system databases to) attempt to determine whether DST is\n  in effect at the specified time.</p>\n</blockquote>\n\n<p>On return from <code>gmtime(&amp;device_rawtime)</code>, ts.tm_isdst is set to zero, since UTC taken by <code>gmtime()</code> is never daylight saving. So, when <code>mktime(&amp;ts)</code> is called, it converts the time structure with the information that <em>DST  is  not  in effect</em>, thus we get a converted time value which is 3600 seconds too high. To correctly account for DST, setting</p>\n\n<pre><code>ts.tm_isdst = -1\n</code></pre>\n\n<p>before calling <code>mktime(&amp;ts)</code> is sufficient.</p>\n"}], "owner": {"reputation": 637, "user_id": 4071435, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/598ac8af735dd5a8892220bba350cad4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Grinberg", "link": "https://stackoverflow.com/users/4071435/paul-grinberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 57920666, "answer_count": 1, "score": 1, "last_activity_date": 1568366052, "creation_date": 1568168873, "last_edit_date": 1568171732, "question_id": 57881239, "link": "https://stackoverflow.com/questions/57881239/convert-localtime-in-seconds-since-epoch-to-utc", "title": "Convert localtime in seconds since epoch to UTC", "body": "<p>In my system I have a PC (Linux, in case it matters) which keeps RTC time in UTC, making my localtime timezone specific. In PC code, I get UTC time as seconds since epoch using</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct timespec tv; \nclock_gettime(CLOCK_REALTIME, &amp;tv);\ndouble time = (tv.tv_nsec / 1000000000.0) + tv.tv_sec;\nreturn time;\n</code></pre>\n\n<p>I also have a 3rd party network device which provides its time also as seconds from epoch, but it does so using localtime instead of UTC time. This is a problem because, when I print the two timestamps in an interleaved log with timestamps from PC and this device, even though the two clocks show the same localtime, the timestamps are off.</p>\n\n<p>Let's assume that the timezone settings (UTC offset and daylight savings specifications) are the same between the PC and this device. How would I take the seconds since epoch provided by the device (in localtime) and convert it to seconds since epoch in UTC? In other words, what the programmatic (in C) way to apply PC timezone settings to a seconds since epoch when that number is in localtime?</p>\n\n<p>Here is my attempt at converting the 3rd party device localtime based seconds since epoch to UTC based seconds since epoch.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n  // The following epoch timestamps were converted to human time via https://www.epochconverter.com/\n  time_t device_rawtime = 1568133906.065000; // if treated as GMT:       Tuesday, September 10, 2019 4:45:06.065 PM\n  time_t pc_rawtime     = 1568151907.454432; // if treated as localtime: Tuesday, September 10, 2019 4:45:07.454 PM GMT-05:00 DST\n  struct tm  ts; \n  char       buf[80];\n\n  ts = *gmtime(&amp;device_rawtime);\n  strftime(buf, sizeof(buf), \"%a %Y-%m-%d %H:%M:%S %Z\", &amp;ts);\n  time_t converted = mktime(&amp;ts);\n  printf(\"Device rawtime=%ld which is PC localtime %s ==&gt; UTC based rawtime=%ld (pc was %ld)\\n\", device_rawtime, buf, converted, pc_rawtime);\n  return 0;\n}\n</code></pre>\n\n<p>The above does not work. It prints</p>\n\n<pre><code>Device rawtime=1568133906 which is PC localtime Tue 2019-09-10 16:45:06 GMT ==&gt; UTC based rawtime=1568155506 (pc was 1568151907)\n</code></pre>\n\n<p>As you can see, the converted device timestamp does not equal PC timestamp. How should this be done?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": true, "score": 1, "last_activity_date": 1568168784, "creation_date": 1568168784, "answer_id": 57881229, "question_id": 57881199, "link": "https://stackoverflow.com/questions/57881199/in-c-how-do-i-give-an-input-to-a-program-previously-called-with-system/57881229#57881229", "title": "In C, how do I give an input to a program previously called with system()?", "body": "<p>You don't. You use something else. Perhaps <code>popen</code></p>\n\n<pre><code>FILE *fp = popen(\"./askname\", \"w\");\nfprintf(fp, \"%s\\n\", foo);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8295752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3851699f997349034c216e170ade2140?s=128&d=identicon&r=PG&f=1", "display_name": "Lego F.", "link": "https://stackoverflow.com/users/8295752/lego-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57881229, "answer_count": 1, "score": 0, "last_activity_date": 1568168784, "creation_date": 1568168473, "question_id": 57881199, "link": "https://stackoverflow.com/questions/57881199/in-c-how-do-i-give-an-input-to-a-program-previously-called-with-system", "title": "In C, how do I give an input to a program previously called with system()?", "body": "<p>I currently want to make a program, called with system(), accept an input, in the case where the input is not an argument. As it may be a bit unclear, I am going to illustrate my question with a simple example.</p>\n\n<p>Let's assume we have 2 programs, askname.c and call.c</p>\n\n<p>askname.c  </p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n   #include &lt;stdlib.h&gt;\n   int main(int argc, char *argv[])\n{\n    char name[10];\n    printf(\"What is your name ? \");\n    fgets(name, 10, stdin);\n    printf(\"So you are %s \\n\", name);\n\n    return 0;\n}\n</code></pre>\n\n<p>After this I would call askname with call.c</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\nint main(int argc, char *argv[]){\nchar* foo =\"test\";\nsystem(\"./askname\");\n//somehow make askname receive foo to display \"So you are test\"\nreturn 0;\n}\n</code></pre>\n\n<p>Any idea of how to proceed?</p>\n"}, {"tags": ["c", "struct"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11145323, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ayt0rrwhVw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP3EeakW_hul4grwe_BfF1_DEdEw/mo/photo.jpg?sz=128", "display_name": "Trush P", "link": "https://stackoverflow.com/users/11145323/trush-p"}, "edited": false, "score": 0, "creation_date": 1568169257, "post_id": 57881246, "comment_id": 102185827, "body": "Tried that by putting the line of code all the way below p4/removing brackets inside array declaration and I am still getting variable patientsArray set but not used and expected expression before &#39;{&#39; token. any other suggestions you might have?"}, {"owner": {"reputation": 53, "user_id": 10219244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3PNev.jpg?s=128&g=1", "display_name": "MirrorCraze", "link": "https://stackoverflow.com/users/10219244/mirrorcraze"}, "reply_to_user": {"reputation": 41, "user_id": 11145323, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ayt0rrwhVw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP3EeakW_hul4grwe_BfF1_DEdEw/mo/photo.jpg?sz=128", "display_name": "Trush P", "link": "https://stackoverflow.com/users/11145323/trush-p"}, "edited": false, "score": 0, "creation_date": 1568169410, "post_id": 57881246, "comment_id": 102185847, "body": "You already deleted the patientsArray[4] on the previous file right?"}, {"owner": {"reputation": 41, "user_id": 11145323, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ayt0rrwhVw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP3EeakW_hul4grwe_BfF1_DEdEw/mo/photo.jpg?sz=128", "display_name": "Trush P", "link": "https://stackoverflow.com/users/11145323/trush-p"}, "edited": false, "score": 0, "creation_date": 1568169679, "post_id": 57881246, "comment_id": 102185888, "body": "nope still have patientsArray[4], but yes I deleted the brackets I had in the inside surrounding p1,p2,p3,p4. Will update the code"}], "tags": [], "owner": {"reputation": 53, "user_id": 10219244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3PNev.jpg?s=128&g=1", "display_name": "MirrorCraze", "link": "https://stackoverflow.com/users/10219244/mirrorcraze"}, "is_accepted": false, "score": 2, "last_activity_date": 1568168946, "creation_date": 1568168946, "answer_id": 57881246, "question_id": 57881193, "link": "https://stackoverflow.com/questions/57881193/is-there-a-way-to-store-struct-variables-in-an-array-in-c/57881246#57881246", "title": "Is there a way to store struct variables in an array in C?", "body": "<p>What you have to do is just remove brackets inside the array declaration.</p>\n\n<p>So it will be like <code>patientsArray[4]={p1,p2,p3,p4};</code></p>\n\n<p>And the other thing is \"you have to assign the value to p1,p2,p3,p4 before initializing the array\"</p>\n\n<p>or put this line of code way down below.</p>\n"}, {"tags": [], "owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "is_accepted": true, "score": 2, "last_activity_date": 1568169767, "creation_date": 1568169767, "answer_id": 57881351, "question_id": 57881193, "link": "https://stackoverflow.com/questions/57881193/is-there-a-way-to-store-struct-variables-in-an-array-in-c/57881351#57881351", "title": "Is there a way to store struct variables in an array in C?", "body": "<p>The easiest solution would be to use:</p>\n\n<pre><code>struct patients* patientsArray[4] = {&amp;p1, &amp;p2, &amp;p3, &amp;p4};\n</code></pre>\n\n<p>This will allow you to initialize the array before filling in the structures (like your code shows) and end up with the result you want.  The only difference is that you will have to access items from the array using <code>-&gt;</code> instead of <code>.</code>.</p>\n\n<p>Another option is to use:</p>\n\n<pre><code>struct patients patientsArray[4];\nstruct patients* p1 = &amp;patientsArray[0];\nstruct patients* p2 = &amp;patientsArray[1];\nstruct patients* p3 = &amp;patientsArray[2];\nstruct patients* p4 = &amp;patientsArray[3];\n</code></pre>\n\n<p>The idea is generally the same, except your array contains structures and your individual objects are pointers.</p>\n\n<p>If you have to keep everything as <code>struct</code> and can't use pointers, then you'll probably want to do something like this:</p>\n\n<pre><code>struct patients p1;\nstruct patients p2;\nstruct patients p3;\nstruct patients p4;\nstruct patients patientsArray[4];\n\n// Initialize individual objects\np1.id = 1;\n...\n\n// Initialize array\npatientsArray[0] = p1;\npatientsArray[1] = p2;\npatientsArray[2] = p3;\npatientsArray[3] = p4;\n</code></pre>\n\n<p>When everything's a <code>struct</code>, you have to fill in the individual structures before copying them to the array.</p>\n\n<p>What you definitely <em>can't</em> do is to mass-assign values to the entire array using the brace notation that you're currently using.  That syntax is for initializers, which have to be part of the variable's declaration.  The brace doesn't make sense in a normal assignment statement, which is what the compiler is complaining about.</p>\n"}], "owner": {"reputation": 41, "user_id": 11145323, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ayt0rrwhVw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP3EeakW_hul4grwe_BfF1_DEdEw/mo/photo.jpg?sz=128", "display_name": "Trush P", "link": "https://stackoverflow.com/users/11145323/trush-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 57881351, "answer_count": 2, "score": 0, "last_activity_date": 1568169767, "creation_date": 1568168437, "last_edit_date": 1568169759, "question_id": 57881193, "link": "https://stackoverflow.com/questions/57881193/is-there-a-way-to-store-struct-variables-in-an-array-in-c", "title": "Is there a way to store struct variables in an array in C?", "body": "<p>Is there way to make an array of structs with just its variables? For example, instead of using this: </p>\n\n<pre><code>struct Employee\n{\n  int age;\n  char name[50];\n  int salary;\n};\nstruct Employee  Employees[4];\n    Employees[4] = {\n           {25, \"Suresh\", 25000},\n           {24, \"Tutorial\", 28000},\n           {22, \"Gateway\", 35000},\n           {27, \"Mike\", 20000}\n};//example I found \n</code></pre>\n\n<p>I would like to use my struct variables that I have already filled in an array of structs. </p>\n\n<p>I went off the example from above and encounter an error <code>expected expression before '{' token</code></p>\n\n<p>Using the code below:</p>\n\n<pre><code>struct patients p1;\nstruct patients p2;\nstruct patients p3;\nstruct patients p4;\nstruct patients patientsArray[4];\n\n/*patient 1 specification */\np1.id=1;\np1.severity=2;\np1.firstName=\"Joe\";\np1.lastName=\"Curcio\";\np1.state=\"Patient has arrived\";\np1.time_spent = 0;\n/*patient 2 specification */\np2.id=2;\np2.severity=3;\np2.firstName=\"Sam\";\np2.lastName=\"Washington\";\np2.state=\"Patient has arrived\";\np2.time_spent = 0;\n/*patient 3 specification */\np3.id=3;\np3.severity=5;\np3.firstName=\"Mary\";\np3.lastName=\"Smith\";\np3.state=\"Patient has arrived\";\np3.time_spent = 0;\n/*patient 4 specification */\np4.id=4;\np4.severity=3;\np4.firstName=\"Joal\";\np4.lastName=\"Blackwell\";\np4.state=\"Patient has arrived\";\np4.time_spent = 0;\npatientsArray[4]={p1,p2,p3,p4};\n</code></pre>\n"}, {"tags": ["android", "c", "linker", "shared-libraries"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568189348, "post_id": 57881107, "comment_id": 102191913, "body": "You are looking for \u201cweak references.\u201d (Sorry, I cannot provide details for Android.)"}], "owner": {"reputation": 4968, "user_id": 2420519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0d30c42d5ee2da9d89a8c146000a7dc6?s=128&d=identicon&r=PG", "display_name": "Hai Zhang", "link": "https://stackoverflow.com/users/2420519/hai-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1568169281, "creation_date": 1568167741, "last_edit_date": 1568169281, "question_id": 57881107, "link": "https://stackoverflow.com/questions/57881107/are-references-to-functions-in-shared-library-required-at-start-up-or-not-until", "title": "Are references to functions in shared library required at start up, or not until actually used?", "body": "<p>Note: This question is not about linking during compile time.</p>\n\n<p>I'm asking this question because in Android we have to deal with different platform versions, and older platforms might be missing some libc functions.</p>\n\n<p>Since most people (including me) builds against the latest platform SDK, we can always link against the most recent version of bionic libc, and the compilation can pass even if we reference something that will only be in a newer platform.</p>\n\n<p>In Java it is typical to do something like:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.P) {\n    // Call new API.\n} else {\n    // Work around without the new API.\n}\n</code></pre>\n\n<p>In this way even if the compiled bytecode contains reference to new API, it will execute fine on old API because that reference won't be reached.</p>\n\n<p>So I was wondering if we can have something similar in C:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (android_get_device_api_level() &gt;= __ANDROID_API_P__) {\n    // Call new libc function.\n} else {\n    // Work around without the new function.\n}\n</code></pre>\n\n<p>Will this work on an older platform even if a new function is referenced? i.e. Will Linux load the old libc for us despite missing some symbols, or will it be rejected on start up?</p>\n"}, {"tags": ["c", "memory", "memory-leaks"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568167790, "post_id": 57881068, "comment_id": 102185569, "body": "&quot; if I&#39;m &quot;leaking&quot; memory&quot; --&gt; Yes, so far.  Code relies on the caller&#39;s of <code>ltim(), rtrim()</code> to <code>free()</code>.  Why not <code>free(string1)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12050586"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568168243, "post_id": 57881068, "comment_id": 102185670, "body": "@chux thanks for this suggestion. Could you show an example please of what I&#39;m doing wrong?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12050586"}, "edited": false, "score": 0, "creation_date": 1568169226, "post_id": 57881213, "comment_id": 102185820, "body": "This is very helpful, thanks for the suggestions here. Is returning the original data/point in memory rather than returning a copy usually the way how C functions work? Or does it really just depend?"}, {"owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "edited": false, "score": 1, "creation_date": 1568170212, "post_id": 57881213, "comment_id": 102185970, "body": "@TagC198 There&#39;s not a standard way to do it.  Functions do whatever makes the most sense in that particular context.  Whichever way you decide to go, make sure the function&#39;s documentation clearly indicates what&#39;s going on.  There&#39;s nothing worst than a nasty surprise."}], "tags": [], "owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "is_accepted": true, "score": 0, "last_activity_date": 1568168647, "creation_date": 1568168647, "answer_id": 57881213, "question_id": 57881068, "link": "https://stackoverflow.com/questions/57881068/freeing-memory-in-c-with-basic-trim-example/57881213#57881213", "title": "Freeing memory in C with basic trim example", "body": "<p>Your functions aren't technically leaking memory, but they're making it really easy for the calling code to leak memory.  Case in point: your sample <code>main</code> function leaked the buffers returned by the three calls to <code>ltrim</code>/<code>rtrim</code>, and your <code>trim</code> function leaked <code>string1</code>.</p>\n\n<p>Instead, consider how these can be simplified.  <code>ltrim</code> doesn't need to allocate memory at all.  It can simply return a pointer to the first non-space character in the input string.  <code>rtrim</code> isn't so easy, though.</p>\n\n<p>One way to avoid the memory problems entirely is to have the functions modify the input string.  Your output is never longer than the input, so you'll always have enough buffer available.  <code>rtrim</code> would simply replace the first whitespace character at the end of the string with <code>'\\0'</code>, and <code>ltrim</code> would <code>memmove()</code> using a pointer to the first non-whitespace character.  Modifying the strings in place means that the caller knows that they're responsible for making copies, allocating buffers, etc. and makes it harder to accidentally leak memory.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12050586"}, "edited": false, "score": 0, "creation_date": 1568173224, "post_id": 57881761, "comment_id": 102186455, "body": "this is great. Unfortunately my reputation is too low to upvote your answer, but once I hit that threshold I&#39;ll come back and do so. Thanks for the answer!"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1568291734, "last_edit_date": 1568291734, "creation_date": 1568172917, "answer_id": 57881761, "question_id": 57881068, "link": "https://stackoverflow.com/questions/57881068/freeing-memory-in-c-with-basic-trim-example/57881761#57881761", "title": "Freeing memory in C with basic trim example", "body": "<blockquote>\n  <p>If so, where should I be freeing the memory or altering how the malloc is called?</p>\n</blockquote>\n\n<p>Consider re-architecting  your helper functions <code>ltrim()</code>, <code>rtrim()</code> without <code>malloc()</code> and let the calling code handle allocations.</p>\n\n<pre><code>// Return beginning of trimmed string.\nconst char *ltrim(const char * string) {\n  while (isspace((unsigned char) *string) {\n    string++;\n  }\n  return string;\n}\n\n// Return end of \"trimmed\" string.\nconst char *rtrim(const char * string) {\n  // find first non-space\n  const char *non_space = string;\n  while (isspace((unsigned char) **non_space) {\n    *non_space++;\n  }\n  if (*non_space) {\n    // Quickly go to the null character.\n    string = non_space + strlen(*non_space);\n    // While the character to the \"left\" is a space, backup.\n    // Here we know there is a non-white-space somewhere to the left,\n    // so loop will end with only a `isspace()` test.\n    while (isspace((unsigned char) string[-1]) {\n      string--;\n    }\n  }\n  return string;\n}\n</code></pre>\n\n<p>Now armed with these helper functions ....</p>\n\n<pre><code>char * trim_alloc(const char * string) {\n  string = ltrim(string);\n  const char *end = rtrim(string);\n  size_t length = end - string;\n  char *copy = malloc(length + 1);\n  if (copy) {\n    memcpy(copy, string, length);\n    copy[length] = '\\0';\n  }  \n  return copy;\n}\n</code></pre>\n\n<hr>\n\n<p>Was is speedy about <code>rtrim</code> is that each of its 3 loops (<code>while, strlen, while</code>) are each only testing for one condition and not 2 like \"isspace &amp;&amp; not null_character\".  This approach works best with sizable strings with a small amount of right trimming.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12050586"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 57881213, "answer_count": 2, "score": 1, "last_activity_date": 1568291734, "creation_date": 1568167360, "last_edit_date": 1568168262, "question_id": 57881068, "link": "https://stackoverflow.com/questions/57881068/freeing-memory-in-c-with-basic-trim-example", "title": "Freeing memory in C with basic trim example", "body": "<p>I'm trying to implement a <code>trim</code> function in C, and in doing so I'm using two sub-functions, <code>ltrim</code> and <code>rtrim</code>. I was wondering if I'm \"leaking\" memory somehow by calling <code>malloc</code> so much. If so, where should I be <code>free</code>ing the memory or altering how the <code>malloc</code> is called?</p>\n\n<p>Ltrim:</p>\n\n<pre><code>char * rtrim(char * string) {\n\n    size_t slen = strlen(string);\n    char * modified_string = malloc(slen + 1);\n    strcpy(modified_string, string);\n\n    for (int i=slen-1; i&gt;0 ;i--) {\n        if (string[i] == ' ' || string[i] == '\\t')\n            modified_string[i] = '\\0';\n        else\n            break;\n    }\n\n    return modified_string;\n}\n</code></pre>\n\n<p>Rtrim:</p>\n\n<pre><code>char * ltrim(char * string) {\n\n    char c;\n    int start_index = -1;\n\n    char * modified_string = malloc(strlen(string) + 1);\n\n    for (int i=0; (c=string[i]) != '\\0'; i++) {\n        if ((c == ' ' || c == '\\t') &amp;&amp; (start_index == -1)) {   \n            ;       \n        } else {\n            if (start_index == -1) start_index = i;\n            modified_string[i - start_index] = c;\n        }\n    }\n    return modified_string;\n\n}\n</code></pre>\n\n<p>Trim:</p>\n\n<pre><code>char * trim(char * string) {\n    char * string1 = ltrim(string);\n    char * string2 = rtrim(string1);\n    return string2;\n}\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n\n    char * new_str = \"   howlin   \";\n    printf(\"Original: \\\"%s\\\" | RTrimmed: \\\"%s\\\"\\n\", new_str, rtrim(new_str));\n    printf(\"Original: \\\"%s\\\" | LTrimmed: \\\"%s\\\"\\n\", new_str, ltrim(new_str));\n    printf(\"Original: \\\"%s\\\" | Trimmed: \\\"%s\\\"\\n\", new_str, trim(new_str));\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "whitespace", "type-mismatch", "removing-whitespace"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1568167147, "post_id": 57881012, "comment_id": 102185466, "body": "<code>%1f</code> (number one) doesn&#39;t seem right to me. Perhaps you meant <code>%lf</code> (letter ell). And I guess the prof doesn&#39;t want to see the space before the newline character (<code>\\n</code>)."}, {"owner": {"reputation": 11, "user_id": 7749636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j5rWETTLLvE/AAAAAAAAAAI/AAAAAAAAAHc/FonZ_BdaVds/photo.jpg?sz=128", "display_name": "Keyur Maru", "link": "https://stackoverflow.com/users/7749636/keyur-maru"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1568167397, "post_id": 57881012, "comment_id": 102185496, "body": "Sorry but in the submission i used %.2f because we had to get output with two decimal point. Is that what caused a type mismatch?"}, {"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1568167412, "post_id": 57881012, "comment_id": 102185502, "body": "Aside from the corrections that @user3386109 indicated, why is <code>main()</code> calling itself recursively? Run through a few (ok, on most systems a few thousand) iterations and you will run out of resources. The program should simply be wrapped in a <code>while</code> loop, perhaps with an exit if <code>time=0</code>."}, {"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 1, "creation_date": 1568167625, "post_id": 57881012, "comment_id": 102185538, "body": "As for the type mismatch, the issue must be declaring your variables as <code>double</code> but only using them as <code>float</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1568167780, "post_id": 57881012, "comment_id": 102185568, "body": "The professor may expect <code>%.2lf</code>. For <code>printf</code> <code>%.2f</code> and <code>%.2lf</code> do exactly the same thing, but if the professor wants to see <code>%.2lf</code>, then that&#39;s what you need to do."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 1, "creation_date": 1568167888, "post_id": 57881012, "comment_id": 102185590, "body": "BTW, @daShier is right about the call to <code>main();</code> on the last line of the code. That needs to be removed."}, {"owner": {"reputation": 11, "user_id": 7749636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j5rWETTLLvE/AAAAAAAAAAI/AAAAAAAAAHc/FonZ_BdaVds/photo.jpg?sz=128", "display_name": "Keyur Maru", "link": "https://stackoverflow.com/users/7749636/keyur-maru"}, "edited": false, "score": 0, "creation_date": 1568167940, "post_id": 57881012, "comment_id": 102185604, "body": "So is that a type-mismatch if I use %.2f instead of %.2lf?"}, {"owner": {"reputation": 11, "user_id": 7749636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j5rWETTLLvE/AAAAAAAAAAI/AAAAAAAAAHc/FonZ_BdaVds/photo.jpg?sz=128", "display_name": "Keyur Maru", "link": "https://stackoverflow.com/users/7749636/keyur-maru"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1568168005, "post_id": 57881012, "comment_id": 102185615, "body": "Thanks @daShier I will remove the main(); at the end of the code"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1568168016, "post_id": 57881012, "comment_id": 102185620, "body": "Technically no, at least for modern compilers. When the professor was learning the language, using <code>%.2lf</code> with <code>printf</code> may have been required."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1568168032, "post_id": 57881012, "comment_id": 102185625, "body": "@daShier The compiler may make that a tail-call optimized call, so you won\u2019t run out of stack-space - but it isn\u2019t guaranteed."}, {"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 2, "creation_date": 1568168283, "post_id": 57881012, "comment_id": 102185674, "body": "@Dai, While modern compilers are amazing in their ability to realize what a programmer was (probably) thinking, I don&#39;t believe that a student should be learning to rely on the compiler to undo bad habits. ;)"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 1, "creation_date": 1568168429, "post_id": 57881012, "comment_id": 102185701, "body": "@daShier it\u2019s unfortunate that C doesn\u2019t reify the call system to enable opt-in explicit tail-calls. Doing so would make recursive functions much easier to read and write."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568189222, "post_id": 57881012, "comment_id": 102191846, "body": "Your professor should state the rules clearly and precisely. If they have not, ask them to do so. If they have, edit the rules into your question. Without this, your question is unclear and cannot be properly answered."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 1, "creation_date": 1568190654, "post_id": 57881012, "comment_id": 102192626, "body": "Clearly the error is that there are <a href=\"https://www.google.com/search?q=meters+per+mile\" rel=\"nofollow noreferrer\">1609 metres in a mile</a> (to the nearest metre)."}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 2, "last_activity_date": 1568185088, "creation_date": 1568185088, "answer_id": 57883687, "question_id": 57881012, "link": "https://stackoverflow.com/questions/57881012/how-to-fix-the-error-of-type-mismatch-and-trailing-spaces-in-c/57883687#57883687", "title": "How to fix the error of type-mismatch and trailing spaces in C", "body": "<p>Most probably your code should look like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n#define SECS_PER_HOUR 3600 // 1 hour = 60mins * 60 secs = 3600 secs\n#define METERS_PER_MILE 1600\n\nint main(void)\n{\n    for (;;)\n    {\n        double distance;\n        double time;\n        double speedmph;\n        double speedmps;\n\n        scanf(\"%lf\", &amp;distance);\n        scanf(\"%lf\", &amp;time);\n\n        speedmph = distance / time;\n        speedmps = (speedmph * METERS_PER_MILE) / SECS_PER_HOUR;\n\n        printf(\"\\nThe speed is %.2lf miles per hour.\\n\", speedmph);\n        printf(\"The speed is %.2lf meters per second.\\n\\n\", speedmps);\n    }\n}\n</code></pre>\n\n<p>Changes are:</p>\n\n<ol>\n<li>Separate unrelated lines by one empty line.</li>\n<li>Indent the source to reflect the structure.</li>\n<li>Define each variable in its own line. This improves readability and is good habit to avoid problems if you define pointers in other programs.</li>\n<li>Concerning <strong>type mismatch</strong>: Change <code>%.2f</code> into <code>%.2lf</code> to match the <code>double</code>. However, as @user3386109 wrote, for <code>printf()</code> its the same. If there were some <code>float</code> it would be casted to a <code>double</code>.</li>\n<li>Concerning <strong>trailing spaces</strong>: Remove blanks before <code>\\n</code>.</li>\n<li>Add endless loop to avoid stack overflow (no pun intended) if the compiler does not realize tail recursion.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 7749636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j5rWETTLLvE/AAAAAAAAAAI/AAAAAAAAAHc/FonZ_BdaVds/photo.jpg?sz=128", "display_name": "Keyur Maru", "link": "https://stackoverflow.com/users/7749636/keyur-maru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568185088, "creation_date": 1568166727, "last_edit_date": 1568167585, "question_id": 57881012, "link": "https://stackoverflow.com/questions/57881012/how-to-fix-the-error-of-type-mismatch-and-trailing-spaces-in-c", "title": "How to fix the error of type-mismatch and trailing spaces in C", "body": "<p>This was my school assignment and the feedback from the professor says violates the rule of type-mismatch and also avoid trailing spaces. I couldn't still pinpoint the exact problem.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define SECS_PER_HOUR 3600 //1 hour = 60mins * 60 secs = 3600 secs\n#define METERS_PER_MILE 1600 \nint main()\n{\ndouble distance, time, speedmph, speedmps;\n\n\nscanf(\"%lf\", &amp;distance);\nscanf(\"%lf\", &amp;time);\n\nspeedmph = distance / time;\nspeedmps = (speedmph * METERS_PER_MILE) / SECS_PER_HOUR;\n\nprintf(\"\\nThe speed is %.2f miles per hour. \\n\", speedmph);\nprintf(\"The speed is %.2f meters per second. \\n\\n\", speedmps);\nmain();\n}\n</code></pre>\n"}, {"tags": ["c", "binaryfiles"], "answers": [{"comments": [{"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1568165778, "post_id": 57879875, "comment_id": 102185238, "body": "<code>fwrite(num, sizeof(int), 4, fp)</code> might be even better, as it matches the documentation for which argument is the size of each element, and which is the number of elements.  It&#39;s just cosmetic, though."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568165896, "post_id": 57879875, "comment_id": 102185257, "body": "Does C actually know to read 4 numbers from the file? How does it know when one number ends and the next one starts?"}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568165963, "post_id": 57879875, "comment_id": 102185268, "body": "@smac89: <code>sizeof(int)</code> does the trick. If he were doing something even slightly more exotic I&#39;d also correct the size to the size of the array itself."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": true, "score": 2, "last_activity_date": 1568165997, "last_edit_date": 1568165997, "creation_date": 1568164634, "answer_id": 57879875, "question_id": 57879863, "link": "https://stackoverflow.com/questions/57879863/abort-trap-when-reading-integer-array-from-binary-file-in-c/57879875#57879875", "title": "Abort trap when reading integer array from binary file in C", "body": "<pre><code>fwrite(&amp;num, sizeof(int) * 4, 4, fp);\n\nfread(num, sizeof(int) * 4, 1, fp);\n</code></pre>\n\n<p>No! You want</p>\n\n<pre><code>fwrite(&amp;val, sizeof(int) * 4, 1, fp);\n\nfread(val, sizeof(int) * 4, 1, fp);\n</code></pre>\n\n<p>You have 1 array of four ints, not 4 of them. Also, taking the address of the array like that is not idiomatic. Just omit the &amp;.</p>\n"}], "owner": {"reputation": 337, "user_id": 9781768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed70d0c2ec5a7a9b51c4bc892703ecbe?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/9781768/user9123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 57879875, "answer_count": 1, "score": 1, "last_activity_date": 1568165997, "creation_date": 1568164449, "question_id": 57879863, "link": "https://stackoverflow.com/questions/57879863/abort-trap-when-reading-integer-array-from-binary-file-in-c", "title": "Abort trap when reading integer array from binary file in C", "body": "<p>I have 2 files. One for writing to a binary file, and one for reading. For now, I am just trying to write and read an integer array to and from basic binary file. It seems like my code is successful, up until I experience an abort trap 6 after my desired outcome is printed. </p>\n\n<p>I have looked into this issue and what seems to be happening is that I am trying to access memory that I do not have permission to access. I have tried increasing the size of my arrays to fix this issue, however, that does not seem to work. Here are my 2 files.</p>\n\n<p>Writing:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void){\n\nFILE *fp;\nint num[4] = {4,2,3,7};\n\n\nfp = fopen(\"tst.bin\", \"wb+\");\nfwrite(&amp;num, sizeof(int) * 4, 4, fp);\n\nfclose(fp);\n\nreturn 0;\n}\n</code></pre>\n\n<p>Reading</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n\nFILE *fp;\nint val[4] = {0};\nint i;\n\nfp = fopen(\"tst.bin\", \"rb\");\n\nfread(&amp;val, sizeof(int) * 4, 4, fp);\n\nfclose(fp);\n\nprintf(\"The value is: \\n\");\n\nfor(i = 0; i &lt; 4; ++i){\n    printf(\"%d \", val[i]);\n}\nprintf(\"\\n\");\n\nreturn 0;\n}\n</code></pre>\n\n<p>My outcome:</p>\n\n<pre><code>The value is: \n4 2 3 7 \nAbort trap: 6\n</code></pre>\n"}, {"tags": ["c", "linux", "keyboard"], "comments": [{"owner": {"reputation": 165, "user_id": 7327379, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nPTWrm6AyyE/AAAAAAAAAAI/AAAAAAAAABI/hcEHHlrDmt8/photo.jpg?sz=128", "display_name": "Demindiro", "link": "https://stackoverflow.com/users/7327379/demindiro"}, "edited": false, "score": 0, "creation_date": 1568165202, "post_id": 57879856, "comment_id": 102185173, "body": "If <code>read</code> returns -1 then an error has occurred (it should return 0 if there is no data in non-blocking mode)."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 165, "user_id": 7327379, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nPTWrm6AyyE/AAAAAAAAAAI/AAAAAAAAABI/hcEHHlrDmt8/photo.jpg?sz=128", "display_name": "Demindiro", "link": "https://stackoverflow.com/users/7327379/demindiro"}, "edited": false, "score": 1, "creation_date": 1568166515, "post_id": 57879856, "comment_id": 102185362, "body": "@Demindiro: <code>EAGAIN</code>/<code>EWOULDBLOCK</code> is the &quot;error&quot;. Nonblocking reads do <b>not</b> return 0 when there&#39;s no data. 0 is only legal for <code>read</code> to return to indicate end-of-file condition."}, {"owner": {"reputation": 165, "user_id": 7327379, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nPTWrm6AyyE/AAAAAAAAAAI/AAAAAAAAABI/hcEHHlrDmt8/photo.jpg?sz=128", "display_name": "Demindiro", "link": "https://stackoverflow.com/users/7327379/demindiro"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1568167906, "post_id": 57879856, "comment_id": 102185592, "body": "@R.. You&#39;re right, my bad."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 10941505, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E6YEgug461s/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaKn4LFTMeBoOfGjqHNTTLOwrjd9A/mo/photo.jpg?sz=128", "display_name": "Kirill Bugaev", "link": "https://stackoverflow.com/users/10941505/kirill-bugaev"}, "edited": false, "score": 0, "creation_date": 1568209924, "post_id": 57881440, "comment_id": 102202900, "body": "My program sends keycodes read from event device through network. So I have sockets timeout in this case and I want to know appropriate value for this timeout."}, {"owner": {"reputation": 30588, "user_id": 8705432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e0f95975d80525786e419222821ff4?s=128&d=identicon&r=PG&f=1", "display_name": "bk2204", "link": "https://stackoverflow.com/users/8705432/bk2204"}, "reply_to_user": {"reputation": 351, "user_id": 10941505, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E6YEgug461s/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaKn4LFTMeBoOfGjqHNTTLOwrjd9A/mo/photo.jpg?sz=128", "display_name": "Kirill Bugaev", "link": "https://stackoverflow.com/users/10941505/kirill-bugaev"}, "edited": false, "score": 1, "creation_date": 1568239648, "post_id": 57881440, "comment_id": 102215644, "body": "You can use <code>select</code> for both your network socket and your event device and be notified whenever the event device is ready for reading or the socket is ready for writing.  You don&#39;t need to know the kernel&#39;s timeout.  In any event, it can vary across versions or compile flags, so any value we gave you would be wrong in some cases."}], "tags": [], "owner": {"reputation": 30588, "user_id": 8705432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e0f95975d80525786e419222821ff4?s=128&d=identicon&r=PG&f=1", "display_name": "bk2204", "link": "https://stackoverflow.com/users/8705432/bk2204"}, "is_accepted": true, "score": 2, "last_activity_date": 1568170391, "creation_date": 1568170391, "answer_id": 57881440, "question_id": 57879856, "link": "https://stackoverflow.com/questions/57879856/keyboard-frequency-in-linux/57881440#57881440", "title": "Keyboard frequency in Linux", "body": "<p>In general, when you want to read from a non-blocking file descriptor, it's best to wait on it using a function like <code>select(2)</code> or <code>poll(2)</code> (or using the <code>epoll</code> family of functions).  These functions let you sleep a certain amount of time (or forever) and be woken up when there's new input to process.</p>\n\n<p>The driver may send data to the device file as each scancode is read or it may batch related requests at its option, so you shouldn't rely on a particular timeout.  Instead, specify an appropriate timeout to <code>select(2)</code> or <code>poll(2)</code> depending on how long you want to wait if nothing comes in.  If something comes in, you will be woken up earlier and <code>read(2)</code> should then succeed (although you should be prepared to be woken up spuriously; that is, when there is nothing to read).</p>\n\n<p>If you don't know which function to use and are not using a large number of file descriptors, <code>select</code> is probably the easiest choice.  The manual page provides an example of how to use it.</p>\n"}], "owner": {"reputation": 351, "user_id": 10941505, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E6YEgug461s/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaKn4LFTMeBoOfGjqHNTTLOwrjd9A/mo/photo.jpg?sz=128", "display_name": "Kirill Bugaev", "link": "https://stackoverflow.com/users/10941505/kirill-bugaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57881440, "answer_count": 1, "score": 1, "last_activity_date": 1568210196, "creation_date": 1568164357, "last_edit_date": 1568210196, "question_id": 57879856, "link": "https://stackoverflow.com/questions/57879856/keyboard-frequency-in-linux", "title": "Keyboard frequency in Linux", "body": "<p>I am trying to read from keyboard event device (<code>/dev/input/event5</code>) with <code>read</code> in non-blocking mode. <code>read</code> returns -1 if nothing to read. Question is how often I should check event device for new input (how long program should sleep before next read attempt)? If I push the button and don't release how often driver sends this event to event device?</p>\n\n<p><em>UPDATE:</em>\nMy program sends keycodes read from event device through network (I write low-level KVM). So I have socket timeout in this case and want to know appropriate value for this timeout. I want that keycodes sent in real-time without delays. </p>\n"}, {"tags": ["c", "unix", "segmentation-fault", "dirent.h"], "comments": [{"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 1, "creation_date": 1568162841, "post_id": 57879673, "comment_id": 102183910, "body": "Why are you calling <code>realpath</code> on the directory entry name? It&#39;s just a path component. And is it okay to use the input <code>path</code> as the destination buffer in a <code>realpath</code> call? In <code>main</code>, you pass a string literal as <code>path</code> to <code>depthFirst</code>; modifying string literals is undefined behavior."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568163131, "post_id": 57879673, "comment_id": 102183943, "body": "You need to pass either <code>NULL</code> or a big enough writeable buffer as the second argument to <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/realpath.html\" rel=\"nofollow noreferrer\"><code>realpath()</code></a>.  In your code, you pass the constant string <code>&quot;.&quot;</code> to the function when the code that runs the command gives no other name, and that is neither big enough nor writeable, so you get the core dump.  Your commented out <code>char path[PATH_MAX];</code> is on the right lines, except the name <code>path</code> hides the parameter to the function, which isn&#39;t a good idea (it leads to confusion)."}], "answers": [{"tags": [], "owner": {"reputation": 12563, "user_id": 77939, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7cd2dfec42419c9791031b2e86ea9b68?s=128&d=identicon&r=PG", "display_name": "mpontillo", "link": "https://stackoverflow.com/users/77939/mpontillo"}, "is_accepted": true, "score": 1, "last_activity_date": 1568163667, "creation_date": 1568163667, "answer_id": 57879787, "question_id": 57879673, "link": "https://stackoverflow.com/questions/57879673/how-to-fix-segmentation-fault-in-the-use-of-struct-dirent-in-c/57879787#57879787", "title": "How to fix segmentation fault in the use of struct dirent in C", "body": "<p>Jonathan beat me to it in the comments, but this change prevents the problem.</p>\n\n<pre><code>@@ -9,7 +9,7 @@\n void depthFirst(char * path){\n         struct dirent *sd;\n         DIR *dir;\n-        //char path[PATH_MAX];\n+        char rpath[PATH_MAX];\n\n         dir = opendir(path);\n\n@@ -22,8 +22,8 @@\n                 while( (sd = readdir(dir)) != NULL){\n                         if(strcmp(sd-&gt;d_name, \".\") != 0 &amp;&amp; strcmp(sd-&gt;d_name, \"..\") != 0){\n                         printf(\"%s\\n\", sd-&gt;d_name);\n-                        realpath(sd-&gt;d_name,path);\n-                        if(isdirectory(path)){\n+                        realpath(sd-&gt;d_name,rpath);\n+                        if(isdirectory(rpath)){\n                                 printf(\"\\t\");\n                                 depthFirst(sd-&gt;d_name);\n\n</code></pre>\n\n<p>As another comment pointed out, you cannot reuse the <code>char* path</code> because it is stored in a page of memory that is not writable by your program. Therefore, <code>realpath()</code> will crash upon attempting to write to it.</p>\n"}], "owner": {"reputation": 65, "user_id": 4728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee9efe75d2b24c4110af4793d689be7?s=128&d=identicon&r=PG&f=1", "display_name": "omer muhit", "link": "https://stackoverflow.com/users/4728218/omer-muhit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 57879787, "answer_count": 1, "score": 0, "last_activity_date": 1568163667, "creation_date": 1568162244, "last_edit_date": 1568163221, "question_id": 57879673, "link": "https://stackoverflow.com/questions/57879673/how-to-fix-segmentation-fault-in-the-use-of-struct-dirent-in-c", "title": "How to fix segmentation fault in the use of struct dirent in C", "body": "<p>My code prints the files/directory names in a given path(user enters it as a command-line argument). When executing with a given path in the directory, it just works fine but it is supposed to do the same for the current working directory if user does not provide any command-line argument. </p>\n\n<p>I am getting seg fault if I just run as: <code>./a.out</code><br>\nIt works when I run as: <code>./a.out /path</code></p>\n\n<p>Please fix my code by providing the necessary code fragment</p>\n\n<p>I have tried to do debugging and found out that it gives the error right after it executes the line following line in the depthFirst function</p>\n\n<pre><code>printf(\"%s\\n\", sd-&gt;d_name);\n</code></pre>\n\n<p>My faulty code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;limits.h&gt;\nvoid depthFirst(char * path){\n        struct dirent *sd;\n        DIR *dir;\n        //char path[PATH_MAX];\n\n        dir = opendir(path);\n\n\n                if(dir == NULL){\n                        printf(\"Error, unable to open\\n\");\n                        exit(1);\n                }\n\n                while( (sd = readdir(dir)) != NULL){\n                        if(strcmp(sd-&gt;d_name, \".\") != 0 &amp;&amp; strcmp(sd-&gt;d_name, \"..\") != 0){\n                        printf(\"%s\\n\", sd-&gt;d_name);\n                        realpath(sd-&gt;d_name,path);\n                        if(isdirectory(path)){\n                                printf(\"\\t\");\n                                depthFirst(sd-&gt;d_name);\n\n                        }\n                }\n\n                }\n\n\n        closedir(dir);\n}\n\nint isdirectory(char *path) {\n   struct stat statbuf;\n   if (stat(path, &amp;statbuf) == -1)\n      return 0;\n   else\n      return S_ISDIR(statbuf.st_mode);\n}\n\nint main(int argc, char *argv[]){\n        char * path;\n        char * currentDirectory;\n\n        if(argc&lt;2){\n                currentDirectory = \".\";\n                depthFirst(currentDirectory);\n        }\n        else{\n                path = argv[1];\n                depthFirst(path);\n\n        }\n        return 0;\n}\n</code></pre>\n\n<p>The output is shown below:</p>\n\n<pre><code>.git\nSegmentation fault\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1568161664, "post_id": 57879599, "comment_id": 102183728, "body": "Post the definition of <code>array</code>as used with <code>{&quot;my&quot;, &quot;favorite&quot;, &quot;things&quot;}</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1568161952, "post_id": 57879599, "comment_id": 102183765, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568162748, "post_id": 57879599, "comment_id": 102183892, "body": "Given <code>char *array[] = { &quot;my&quot;, &quot;favourite&quot;, &quot;things&quot; };</code>, using <code>sizeof(array) &#47; sizeof(array[0])</code> gives you the answer 3 (and it&#39;s the compiler&#39;s job to know the size of the array and hence where the end is).  You also get 3 if you use <code>char array[][16] = { &quot;my&quot;, &quot;favourite&quot;, &quot;movies&quot; };</code> and the same expression.  If the array is a function parameter, you don&#39;t get the size information."}, {"owner": {"reputation": 3885, "user_id": 652528, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a580420b66f89e76e1fb9a368f785b3f?s=128&d=identicon&r=PG", "display_name": "geckos", "link": "https://stackoverflow.com/users/652528/geckos"}, "edited": false, "score": 0, "creation_date": 1568164100, "post_id": 57879599, "comment_id": 102184073, "body": "in C99 is possible to use <code>int foo(int bar[static 10])</code> so that you know the with some sure the minimum size of an array parameter"}, {"owner": {"reputation": 1463, "user_id": 2299087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWtlB.jpg?s=128&g=1", "display_name": "James McPherson", "link": "https://stackoverflow.com/users/2299087/james-mcpherson"}, "edited": false, "score": 0, "creation_date": 1568168121, "post_id": 57879599, "comment_id": 102185643, "body": "I thought that the calculation was done as follows      arraylen = sizeof(array) / sizeof (type-which-makes-up-array)  eg, <code>char *</code> or <code>int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": true, "score": 1, "last_activity_date": 1568194014, "last_edit_date": 1568194014, "creation_date": 1568190407, "answer_id": 57885077, "question_id": 57879599, "link": "https://stackoverflow.com/questions/57879599/getting-the-outer-array-length-in-c/57885077#57885077", "title": "Getting the Outer-array length in C", "body": "<p>You can get the size of each dimension if you use the quotient of the appropriate, well, dimension:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n  int array[23][42][7];\n  unsigned int size_1 = sizeof array / sizeof array[0];\n  unsigned int size_2 = sizeof array[0] / sizeof array[0][0];\n  unsigned int size_3 = sizeof array[0][0] / sizeof array[0][0][0];\n  unsigned int size_e = sizeof array[0][0][0];\n\n  printf(\"Size of 1st dimension: %u\\n\", size_1);\n  printf(\"Size of 2nd dimension: %u\\n\", size_2);\n  printf(\"Size of 3rd dimension: %u\\n\", size_3);\n  printf(\"Size of element:       %u\\n\", size_e);\n\n  return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Size of 1st dimension: 23\nSize of 2nd dimension: 42\nSize of 3rd dimension: 7\nSize of element:       4\n</code></pre>\n\n<p>There is no \"end marker\" on arrays in general. You need to track the size if you use dynamically allocated arrays.</p>\n\n<p>The end-of-string marker <code>\\0</code> does <strong>not</strong> mark the end of the <code>char</code> array but the end of the string. The array can be of any size.</p>\n\n<hr>\n\n<p><em>Additional notes, not necessarily perfectly worded in the view of the standard's watchmen ;-)</em></p>\n\n<ol>\n<li><p>The <code>sizeof</code> operator is a (kind of) unary operator for the expression following it. It used to be used with types, so a cast can be given:</p>\n\n<p>sizeof (int)</p>\n\n<p>This habit led to the feeling that the parentheses are needed, and that it is a kind of function. <strong>No</strong>, it is not. The result will be calculated by the compiler, and therefore it must be calculatable at compile time.</p>\n\n<p>If you use it with an object like a variable, you could simply write:</p>\n\n<p>sizeof variable</p></li>\n<li><p>If you have a <code>char</code> array at the (second) most inner dimension you would probably liek to call <code>strlen()</code> on each of them. This might apply also to <code>char*</code> as element type.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1033, "user_id": 5778803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b5CcU.jpg?s=128&g=1", "display_name": "Eliyahu Machluf", "link": "https://stackoverflow.com/users/5778803/eliyahu-machluf"}, "is_accepted": false, "score": 0, "last_activity_date": 1568190875, "creation_date": 1568190875, "answer_id": 57885219, "question_id": 57879599, "link": "https://stackoverflow.com/questions/57879599/getting-the-outer-array-length-in-c/57885219#57885219", "title": "Getting the Outer-array length in C", "body": "<p>The array you've showed is a pointers array: </p>\n\n<pre><code> char *array = {\"my\", \"favorite\", \"things\"}\n</code></pre>\n\n<p>you can use the same syntax of </p>\n\n<pre><code>sizeof(array)/sizeof(array[0]) \n</code></pre>\n\n<p>to get the number of items at array, which are the number of pointers at array.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5335769"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57885077, "answer_count": 2, "score": 0, "last_activity_date": 1568194014, "creation_date": 1568161379, "question_id": 57879599, "link": "https://stackoverflow.com/questions/57879599/getting-the-outer-array-length-in-c", "title": "Getting the Outer-array length in C", "body": "<p>To get array length I can (usually) do:</p>\n\n<pre><code>sizeof(array) / sizeof(array[0])\n</code></pre>\n\n<p>What about if it's a multidimensional array, such as:</p>\n\n<pre><code>{\"my\", \"favorite\", \"things\"}\n</code></pre>\n\n<p>How would I get the length <code>(3)</code> of that? Basically, the length of the outer-most array.</p>\n\n<p>How is the \"end\" of the multi-array detected (similar to \\0)?</p>\n"}, {"tags": ["c", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9800735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa554b3a8300df247a5b6cf6a7e8ed1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.B.", "link": "https://stackoverflow.com/users/9800735/j-a-b"}, "edited": false, "score": 0, "creation_date": 1568725399, "post_id": 57881051, "comment_id": 102359316, "body": "Work as mad! Thanks!"}, {"owner": {"reputation": 191, "user_id": 11067418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LItU4.jpg?s=128&g=1", "display_name": "Federico Ciuffardi", "link": "https://stackoverflow.com/users/11067418/federico-ciuffardi"}, "reply_to_user": {"reputation": 29, "user_id": 9800735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa554b3a8300df247a5b6cf6a7e8ed1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.B.", "link": "https://stackoverflow.com/users/9800735/j-a-b"}, "edited": false, "score": 0, "creation_date": 1568738759, "post_id": 57881051, "comment_id": 102366840, "body": "No problem, can you up vote and choose it as the best answer?"}], "tags": [], "owner": {"reputation": 191, "user_id": 11067418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LItU4.jpg?s=128&g=1", "display_name": "Federico Ciuffardi", "link": "https://stackoverflow.com/users/11067418/federico-ciuffardi"}, "is_accepted": true, "score": 0, "last_activity_date": 1568167205, "creation_date": 1568167205, "answer_id": 57881051, "question_id": 57879555, "link": "https://stackoverflow.com/questions/57879555/why-this-semaphores-stuck/57881051#57881051", "title": "Why this semaphores stuck", "body": "<p>You should create the semaphore using this</p>\n\n<pre><code>sem_open(SEM_NAME, O_RDWR,0777, 1);\n</code></pre>\n\n<p>to set the starting value of the semaphore to 1.</p>\n"}], "owner": {"reputation": 29, "user_id": 9800735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa554b3a8300df247a5b6cf6a7e8ed1?s=128&d=identicon&r=PG&f=1", "display_name": "J.A.B.", "link": "https://stackoverflow.com/users/9800735/j-a-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 57881051, "answer_count": 1, "score": 0, "last_activity_date": 1568167205, "creation_date": 1568160863, "question_id": 57879555, "link": "https://stackoverflow.com/questions/57879555/why-this-semaphores-stuck", "title": "Why this semaphores stuck", "body": "<p>I make program which exec 2 times this code. 2 process enter to semaphore and stuck(HERE comment). Why it happen and how to fix it? </p>\n\n<pre><code>sem_t *sem = sem_open(SEM_NAME, O_RDWR);\nif (sem == SEM_FAILED) {\n    perror(\"sem_open(3) failed\");\n    exit(EXIT_FAILURE);\n}\nint j = atoi(argv[1]);\nint i;\n\nfor (i = 0; i &lt; 2; i++)  {\n  printf(\"%i\\n\",getpid() );\n   //HERE!!!!!\n   if (sem_wait(sem) &lt; 0) {\n    perror(\"sem_wait(3) failed on child\");}\n\n    printf(\"PID %ld acquired semaphore\\n\", (long) getpid());\n\n    if (sem_post(sem) &lt; 0) {\n      perror(\"sem_post(3) error on child\");}\n         printf(\"wysz\\n\");\n\n    sleep(1);\n}\n\nsemcl(sem);\n\nreturn 0;\n</code></pre>\n"}, {"tags": ["c", "networking", "segmentation-fault"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 2, "creation_date": 1568158763, "post_id": 57879361, "comment_id": 102183281, "body": "\u201cI know it&#39;s a memory problem\u201d Well then use a memory debugger like <code>valgrind</code>"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 2, "creation_date": 1568208976, "post_id": 57879361, "comment_id": 102202348, "body": "<code>buffer[RCVBUFSIZE] = &#39;\\0&#39;;</code> is not good."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568238134, "post_id": 57879361, "comment_id": 102215308, "body": "OT:  regarding: <code>char *ip = (char*) malloc(strlen(argv[1]) * sizeof(char));</code>  1) the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  Suggest removing that cast.  2) the expression: <code>sizeof( char )</code> is defined in the C standard as 1.  Multiplying by 1 has absolutely not effect and just clutters the code.  Suggest removing the multiplication.  3) always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568238870, "post_id": 57879361, "comment_id": 102215472, "body": "OT: regarding: <code>cSock = accept (sSock, (struct sockaddr *) &amp;clientData, sizeof(clientData.sin_addr));</code>   the function: <code>accept()</code> returns a <code>sock_t</code> if successful, otherwise returns a value &lt;0.   The posted code needs to be checking for that error condition"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568239375, "post_id": 57879361, "comment_id": 102215584, "body": "regarding: <code>free(receivedData);</code>   The variable: <code>receivedData</code> is of type <code>ssize_t</code>  (or at least it should be)  and the function: <code>free()</code> is expecting a pointer to some memory that was allocated with; <code>malloc()</code> or <code>calloc()</code> or <code>realloc()</code>  So this, alone will result in a seg fault event.  However, there are lots of other problems in the posted code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568239588, "post_id": 57879361, "comment_id": 102215626, "body": "OT: regarding: <code>printf(&quot;Usage : \\n\\t .&#47;server portNumber\\n&quot;);</code>  Error message should be output to <code>stderr</code>, not <code>stdout</code> so this statement would be much better written as: <code>fprintf( stderr, &quot;Usage : %s portNumber\\n&quot;, argv[0] );</code>  Remember that <code>argv[0]</code> is always a pointer to a text string containing the name of the program executed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568240280, "post_id": 57879361, "comment_id": 102215806, "body": "regarding: <code>void DieWithError (char *errorMessage) {      printf(errorMessage);      printf(&quot;\\n&quot;); }</code>  1) This fails to exit the program!  suggest the last statement be: <code>exit( EXIT_FAILURE );</code>  2) error messages should be output to <code>stderr</code>, not <code>stdout</code> and should output the text reason the system thinks the error occurred.  As a (less than perfect) suggestion: `void DieWithError (char *errorMessage) {      perror(errorMessage);      exit( EXIT_FAILURE ); }"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568241011, "post_id": 57879361, "comment_id": 102215969, "body": "regarding: receivedData = recv(cSock, buffer, RCVBUFSIZE-1, 0); buffer[RCVBUFSIZE] = &#39;\\0&#39;; is placing the char array terminator in an unexpected location.  The correct way to do this is: buffer[ receivedData ] = &#39;\\0&#39;; However, first, always check that receivedData is &gt;-=0 otherwise, an error occurred that the code needs to handle"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1568238220, "last_edit_date": 1568238220, "creation_date": 1568237744, "answer_id": 57897107, "question_id": 57879361, "link": "https://stackoverflow.com/questions/57879361/seg-fault-when-accepting-data-from-client/57897107#57897107", "title": "Seg fault when accepting data from client", "body": "<p>The posted code causes the compiler (gcc) to output several warnings:</p>\n\n<p>How I compiled the posted code: where 'untitled.c' is my local name for your posted code.</p>\n\n<pre><code>gcc    -ggdb -Wall -Wextra -Wconversion -pedantic -std=gnu11  -c \"untitled.c\"  \n</code></pre>\n\n<p>and now, the list of outputs from the compiler:</p>\n\n<pre><code>untitled.c: In function \u2018DieWithError\u2019:\nuntitled.c:18:6: warning: format not a string literal and no format arguments [-Wformat-security]\n      printf(errorMessage);\n      ^~~~~~\n\nuntitled.c: In function \u2018main\u2019:\nuntitled.c:48:14: warning: conversion to \u2018short unsigned int\u2019 from \u2018int\u2019 may alter its value [-Wconversion]\n      sAddr = atoi(argv[1]);\n              ^~~~\n\nuntitled.c:78:67: warning: passing argument 3 of \u2018accept\u2019 makes pointer from integer without a cast [-Wint-conversion]\n           cSock = accept (sSock, (struct sockaddr *) &amp;clientData, sizeof(clientData.sin_addr));\n                                                                   ^~~~~~\n\nIn file included from untitled.c:2:0:\n/usr/include/x86_64-linux-gnu/sys/socket.h:232:12: note: expected \u2018socklen_t * restrict {aka unsigned int * restrict}\u2019 but argument is of type \u2018long unsigned int\u2019\n extern int accept (int __fd, __SOCKADDR_ARG __addr,\n            ^~~~~~\n\nuntitled.c:82:26: warning: conversion to \u2018int\u2019 from \u2018ssize_t {aka long int}\u2019 may alter its value [-Wconversion]\n           receivedData = recv(cSock, buffer, RCVBUFSIZE-1, 0);\n                          ^~~~\n\nuntitled.c:95:15: warning: suggest parentheses around assignment used as truth value [-Wparentheses]\n           if (file = strstr(temp, \"/\"))\n               ^~~~\n\nuntitled.c:97:35: warning: conversion to \u2018size_t {aka long unsigned int}\u2019 from \u2018long int\u2019 may change the sign of the result [-Wsign-conversion]\n                ip = strndup(temp, file - temp);\n                                   ^~~~\n\nuntitled.c:107:24: warning: passing argument 1 of \u2018fprintf\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n                fprintf(\"Content-Length: %s \\r\\n\",CONTENTLENGTH);\n                        ^~~~~~~~~~~~~~~~~~~~~~~~~\n\nIn file included from untitled.c:1:0:\n/usr/include/stdio.h:312:12: note: expected \u2018FILE * restrict {aka struct _IO_FILE * restrict}\u2019 but argument is of type \u2018char *\u2019\n extern int fprintf (FILE *__restrict __stream,\n            ^~~~~~~\n\nuntitled.c:13:23: warning: passing argument 2 of \u2018fprintf\u2019 makes pointer from integer without a cast [-Wint-conversion]\n #define CONTENTLENGTH 20,000\n                       ^\n\nuntitled.c:107:50: note: in expansion of macro \u2018CONTENTLENGTH\u2019\n                fprintf(\"Content-Length: %s \\r\\n\",CONTENTLENGTH);\n                                                  ^~~~~~~~~~~~~\n\nIn file included from untitled.c:1:0:\n/usr/include/stdio.h:312:12: note: expected \u2018const char * restrict\u2019 but argument is of type \u2018int\u2019\n extern int fprintf (FILE *__restrict __stream,\n            ^~~~~~~\n\nuntitled.c:113:24: warning: passing argument 1 of \u2018fprintf\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n                fprintf(\"Content Length: %s \\r\\n\", CONTENTLENGTH);\n                        ^~~~~~~~~~~~~~~~~~~~~~~~~\n\nIn file included from untitled.c:1:0:\n/usr/include/stdio.h:312:12: note: expected \u2018FILE * restrict {aka struct _IO_FILE * restrict}\u2019 but argument is of type \u2018char *\u2019\n extern int fprintf (FILE *__restrict __stream,\n            ^~~~~~~\n\nuntitled.c:13:23: warning: passing argument 2 of \u2018fprintf\u2019 makes pointer from integer without a cast [-Wint-conversion]\n #define CONTENTLENGTH 20,000\n                       ^\n\nuntitled.c:113:51: note: in expansion of macro \u2018CONTENTLENGTH\u2019\n                fprintf(\"Content Length: %s \\r\\n\", CONTENTLENGTH);\n                                                   ^~~~~~~~~~~~~\n\n\nIn file included from untitled.c:1:0:\n/usr/include/stdio.h:312:12: note: expected \u2018const char * restrict\u2019 but argument is of type \u2018int\u2019\n extern int fprintf (FILE *__restrict __stream,\n            ^~~~~~~\n\nuntitled.c:117:42: warning: conversion to \u2018size_t {aka long unsigned int}\u2019 from \u2018int\u2019 may change the sign of the result [-Wsign-conversion]\n           sentData = send(cSock, buffer, receivedData, 0);\n                                          ^~~~~~~~~~~~\n\nuntitled.c:117:22: warning: conversion to \u2018int\u2019 from \u2018ssize_t {aka long int}\u2019 may alter its value [-Wconversion]\n           sentData = send(cSock, buffer, receivedData, 0);\n                      ^~~~\n\nuntitled.c:91:24: warning: unused variable \u2018port\u2019 [-Wunused-variable]\n           char *file, *port, *temp;\n                        ^~~~\n\nuntitled.c:90:17: warning: variable \u2018ip\u2019 set but not used [-Wunused-but-set-variable]\n           char *ip = (char*) malloc(strlen(argv[1]) * sizeof(char));\n                 ^~\n\nuntitled.c:127:11: warning: passing argument 1 of \u2018free\u2019 makes pointer from integer without a cast [-Wint-conversion]\n      free(receivedData);\n           ^~~~~~~~~~~~\n\nIn file included from untitled.c:4:0:\n/usr/include/stdlib.h:563:13: note: expected \u2018void *\u2019 but argument is of type \u2018int\u2019\n extern void free (void *__ptr) __THROW;\n             ^~~~\n\n\nuntitled.c:41:12: warning: unused variable \u2018root\u2019 [-Wunused-variable]\n      char *root;\n            ^~~~\n\nuntitled.c:40:11: warning: unused variable \u2018res\u2019 [-Wunused-variable]\n      char res[1024];\n           ^~~\n\nuntitled.c:38:19: warning: unused variable \u2018cAddr\u2019 [-Wunused-variable]\n      unsigned int cAddr;\n                   ^~~~~\n\nuntitled.c:37:42: warning: unused variable \u2018acceptor\u2019 [-Wunused-variable]\n      int cSock, sSock, binder, listener, acceptor, receivedData, sentData;\n                                          ^~~~~~~~\n\nuntitled.c:37:24: warning: variable \u2018binder\u2019 set but not used [-Wunused-but-set-variable]\n      int cSock, sSock, binder, listener, acceptor, receivedData, sentData;\n                        ^~~~~~\n</code></pre>\n\n<p>Among those warnings is a message about using the wrong syntax for function: <code>fprintf()</code></p>\n\n<p>and several warnings about conversion between 'int' and <code>char*</code></p>\n\n<p>Those kinds of warnings are critical.</p>\n\n<p>Then there are plenty of warnings about unused variables and variables set but never used.</p>\n\n<p>regarding: <code>#define CONTENTLENGTH 20,000</code>   The comma ',' is not valid as a separater inside a number.  The compiler will see this as 20 and some stray value 000</p>\n\n<p>Compile with warnings enabled, then fix those warnings</p>\n\n<p>Strongly suggest reading/understanding the MAN page for each C library function that you are using.</p>\n"}], "owner": {"reputation": 1, "user_id": 12049301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10d5d05e85142471aff50b0bfbfd9bc?s=128&d=identicon&r=PG&f=1", "display_name": "n3v", "link": "https://stackoverflow.com/users/12049301/n3v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568238220, "creation_date": 1568158631, "last_edit_date": 1568158716, "question_id": 57879361, "link": "https://stackoverflow.com/questions/57879361/seg-fault-when-accepting-data-from-client", "title": "Seg fault when accepting data from client", "body": "<p>I am trying to set up a server and sending back an HTTP response is proving to be difficult for me, my code is seg faulting and I don't know why. </p>\n\n<p>Here is my code for reference </p>\n\n<p>I know it's a memory problem but I don't know where, it prints up to the accept line in the while loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt; /* for printf() and fprintf() */\n#include &lt;sys/socket.h&gt; /* for socket(), bind(), and connect() */\n#include &lt;arpa/inet.h&gt; /* for sockaddr_in and inet_ntoa() */\n#include &lt;stdlib.h&gt; /* for atoi() and exit() */\n#include &lt;string.h&gt; /* for memset() */\n#include &lt;unistd.h&gt; /* for close() */\n//#include &lt;sys/types.h&gt;\n#include &lt;netdb.h&gt;\n//#include &lt;sys/stat.h&gt;\n\n#define MAXPENDING 5 /* Maximum outstanding connection requests */\n#define RCVBUFSIZE 2048\n#define CONTENTLENGTH 20,000\nvoid DieWithError(char *errorMessage); /* Error handling function */\n\nvoid DieWithError (char *errorMessage)\n{\n     printf(errorMessage);\n     printf(\"\\n\");\n}\n\n//void HandleTCPClient(int clntSocket); /* TCP client handling function */\n\nint main(int argc, char *argv[])\n{\n     //while loop over everything\n     // listen for client connect\n     // bind the socket\n     // accept the client Socket\n     // read from socket/ parse the command\n     // send an appt repsonse header and body\n     // close socket\n     // free memory\n     // ctrl c thing where u clear all memory before terminating (optional)\n     struct sockaddr_in clientData;\n     struct sockaddr_in servData;\n     int cSock, sSock, binder, listener, acceptor, receivedData, sentData;\n     unsigned int cAddr;\n     unsigned short sAddr;\n     char res[1024];\n     char *root;\n\n     if (argc != 2)\n     {\n          printf(\"Usage : \\n\\t ./server portNumber\\n\");\n          exit(1);\n     }\n     sAddr = atoi(argv[1]);\n     sSock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\n     if (sSock &lt; 0)\n     {\n          DieWithError(\"serv socket failed\");\n     }\n\n     memset(&amp;servData, 0 , sizeof(servData));\n     servData.sin_family = AF_INET;\n     servData.sin_addr.s_addr = htonl(INADDR_ANY);\n     servData.sin_port = htons(sAddr);\n\n     memset(&amp;clientData, 0, sizeof(char));\n\n     binder = bind(sSock, (struct sockaddr *) &amp;servData, sizeof (servData));\n\n     listener = listen(sSock, MAXPENDING);\n\n     if (listener &lt; 0)\n     {\n          DieWithError(\"listen did not work\");\n          exit(1);\n     }\n\n     while (1)\n     {\n          char buffer[RCVBUFSIZE];// = (char*) malloc(RCVBUFSIZE * sizeof(char));\n          printf(\"oddde\\n\");\n          //cAddr = sizeof(clientData);\n          cSock = accept (sSock, (struct sockaddr *) &amp;clientData, sizeof(clientData.sin_addr));\n          printf(\"Client %s\\n\", inet_ntoa(clientData.sin_addr));\n          //cSock = accept (sSock, (struct sockaddr *) &amp;clientData, &amp;cAddr);\n          printf(\"oke man\\n\");\n          receivedData = recv(cSock, buffer, RCVBUFSIZE-1, 0);\n          buffer[RCVBUFSIZE] = '\\0';\n\n          if (receivedData &lt; 0)\n          {\n               DieWithError(\"recv failure\");\n          }\n\n          char *ip = (char*) malloc(strlen(argv[1]) * sizeof(char));\n          char *file, *port, *temp;\n          temp = argv[1];\n          //port = argv[2];\n          file = \"/\";\n          if (file = strstr(temp, \"/\"))\n          {\n               ip = strndup(temp, file - temp);\n          }\n          else\n          {\n               ip = strdup(temp);\n          }\n\n          if (strcmp(file, \"/index.html\") == 0)\n          {\n               printf(\"HTTP/1.1 200 OK \\r\\n\");\n               fprintf(\"Content-Length: %s \\r\\n\",CONTENTLENGTH);\n               printf(\"\\r\\n\");\n          }\n          else\n          {\n               printf(\"HTTP/1.1 404 NOT FOUND \\r\\n\");\n               fprintf(\"Content Length: %s \\r\\n\", CONTENTLENGTH);\n               printf(\"\\r\\n\");\n          }\n\n          sentData = send(cSock, buffer, receivedData, 0);\n\n          if (sentData &lt; 0)\n          {\n               DieWithError(\"sending data failure\");\n          }\n\n\n     }\n     close (cSock);\n     free(receivedData);\n\n     return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Segmentation fault : 11\nrecv() failed\n</code></pre>\n\n<p>Code is supposed to send back a correct http response message,\nI have a client.c that I am using to test this code and it does not seem to exit the while loop if I remove the socket line (for testing), the main problem is the segmentation fault that I don't understand the origin of. This is my homework for an intro networks class and it is due tomorrow. </p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 1458, "user_id": 11746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fe33bc21a8570b9e9c0fce89a681fa?s=128&d=identicon&r=PG&f=1", "display_name": "IronMan", "link": "https://stackoverflow.com/users/11746212/ironman"}, "edited": false, "score": 0, "creation_date": 1568156522, "post_id": 57879137, "comment_id": 102182874, "body": "Hi, you can use <a href=\"https://en.cppreference.com/w/c/io/tmpnam\" rel=\"nofollow noreferrer\"><code>tmpnam_s</code></a> which is a safer version of this function."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1568156560, "post_id": 57879137, "comment_id": 102182881, "body": "The man-page for <code>tmpnam</code> recommends to use <code>mkstemp</code> or <code>tmpfile</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1458, "user_id": 11746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fe33bc21a8570b9e9c0fce89a681fa?s=128&d=identicon&r=PG&f=1", "display_name": "IronMan", "link": "https://stackoverflow.com/users/11746212/ironman"}, "edited": false, "score": 2, "creation_date": 1568156598, "post_id": 57879137, "comment_id": 102182891, "body": "@IronMan <code>tmpnam_s()</code> is an optional function, part of the C standard&#39;s Annex K.  Effectively only Microsoft implemented it.  It being &quot;safer&quot; is a matter of debate. It being non-portable is not."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1568156674, "post_id": 57879137, "comment_id": 102182902, "body": "@AndrewHenle aren&#39;t Microsoft&#39;s <code>*_s</code> functions actually different from the ones in Annex K that nobody uses?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1568156807, "post_id": 57879137, "comment_id": 102182925, "body": "@ChristianGibbons <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1967.htm\" rel=\"nofollow noreferrer\">Yes, they are.</a>  However, I don&#39;t have any offhand knowledge of whether or not Microsoft&#39;s <code>tmpnam_s()</code> implementation follows <a href=\"https://port70.net/~nsz/c/c11/n1570.html#K\" rel=\"nofollow noreferrer\">Annex K</a> or not, so I left that out of my initial comment."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1568157168, "post_id": 57879137, "comment_id": 102182979, "body": "@VillageIdiot What is the platform(s) this code applies to?  Windows?  POSIX?  What&#39;s the usage?  Creating a temp file using <code>open()</code>?  Or <code>fopen()</code>?  How the result is used makes a large difference identifying and implementing  any replacement."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1568158763, "post_id": 57879137, "comment_id": 102183282, "body": "VillageIdiot, you have the start of a good question here.  Make it better with answers to @AndrewHenle <a href=\"https://stackoverflow.com/questions/57879137/how-to-replace-the-use-of-tmpnam-in-the-following-code-snippet#comment102182979_57879137\">comment</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10688118"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1568219685, "post_id": 57879137, "comment_id": 102208229, "body": "@AndrewHenle I have updated the question with platform (linux) and some information around what this is used for (verifying the presence of a file)."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1568162191, "creation_date": 1568162191, "answer_id": 57879665, "question_id": 57879137, "link": "https://stackoverflow.com/questions/57879137/how-to-replace-the-use-of-tmpnam-in-the-following-code-snippet/57879665#57879665", "title": "How to replace the use of tmpnam() in the following code snippet", "body": "<p>The problem with <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.4.4\" rel=\"nofollow noreferrer\"><code>tmpnam()</code></a> is that it generates a name that is unique and does not exist when it returns, but that name is not guaranteed to be unique by the time you use it in a call to <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html\" rel=\"nofollow noreferrer\"><code>fopen()</code></a> (or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html\" rel=\"nofollow noreferrer\"><code>open()</code></a>).</p>\n\n<p>The key feature of the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mkstemp.html\" rel=\"nofollow noreferrer\"><code>mkstemp()</code></a> function is that it creates and opens a file with the new name, so that there isn't a TOCTOU (time of check, time of use) vulnerability. This cuts down the avenues for security risks.</p>\n\n<p>Code designed to use <code>tmpnam()</code> usually needs a file name, so using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/tmpfile.html\" rel=\"nofollow noreferrer\"><code>tmpfile()</code></a> is usually not an option; it doesn't provide a way to find the file name.  If you don't need the file name then using <code>tmpfile()</code> works well and is Standard C, so it is widely available.</p>\n\n<p>The specific case of <code>tmpnam()</code> and <code>tmpnam_s()</code> is interesting.  Although <code>tmpnam_s()</code> avoids some string-related problems, it does not change the behaviour of <code>tmpnam()</code> in the way that causes the security problems addressed by <code>mkstemp()</code>.  So, independent of the portability issues that arise from attempting to use <code>tmpnam_s()</code> (or any of the other <code>*_s()</code> functions from Annex K of the C11 or C18 standards), it doesn't fix the problem that causes <code>tmpnam()</code> to be deprecated.</p>\n\n<p>You can arrange to use <code>mkstemp()</code> instead of <code>tmpnam()</code> and close the file descriptor before continuing with the other code:</p>\n\n<pre><code>tmpnam(name);             // Replace this\n\nint fd = mkstemp(name);   // With this\u2026\nif (fd &gt;= 0)\n    close(fd);\n</code></pre>\n\n<p>It's not great, but it does ensure the file is created, which reduces the security vulnerabilities a bit, but not as much as using the file descriptor directly.  You could (should) wrap that into a function.</p>\n\n<p>Note that the <code>mkstemp()</code> returns a file descriptor; if you want a file stream, you can use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fdopen.html\" rel=\"nofollow noreferrer\"><code>fdopen()</code></a> to create a file stream from the file descriptor.  And if that fails, you probably want to remove the file (with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/remove.html\" rel=\"nofollow noreferrer\"><code>remove()</code></a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/unlink.html\" rel=\"nofollow noreferrer\"><code>unlink()</code></a>).  </p>\n\n<p>So, that gives you a need for <code>fmkstemp()</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;     /* mkstemp() */\n#include &lt;unistd.h&gt;     /* close() */\n\nextern FILE *fmkstemp(char *name);   /* Add to a convenient header file */\n\nFILE *fmkstemp(char *name)\n{\n    int fd = mkstemp(name);\n    FILE *fp = 0;\n    if (fd &gt;= 0)\n    {\n        fp = fdopen(fd, \"w+\");\n        if (fp == 0)\n        {\n            close(fd);\n            unlink(name);\n        }\n    }\n    return(fp);\n}\n</code></pre>\n\n<p>Note that after you've used <code>fmkstemp()</code>, you use <code>fclose()</code> to close the file stream (and, behind the scenes, that closes the file descriptor).</p>\n\n<p>Don't forget to remove the temporary file before exit.  That's where a function registered with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/atexit.html\" rel=\"nofollow noreferrer\"><code>atexit()</code></a> or one of its variants can be useful.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10688118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 57879665, "answer_count": 1, "score": 1, "last_activity_date": 1568219610, "creation_date": 1568156242, "last_edit_date": 1568219610, "question_id": 57879137, "link": "https://stackoverflow.com/questions/57879137/how-to-replace-the-use-of-tmpnam-in-the-following-code-snippet", "title": "How to replace the use of tmpnam() in the following code snippet", "body": "<p>I fully understand that <code>tmpnam</code> has been deprecated and would like to remove it from a function in an existing file that prevents me from building the project. However, since I am not familiar with it and am unable to experiment with it, I am not sure how best to replicate this functionality.</p>\n\n<pre><code>if ((myfileName = tmpnam(NULL)) == NULL) { return APP_ERROR }\n</code></pre>\n\n<p>I read the information on <a href=\"http://man7.org/linux/man-pages/man3/tmpnam.3.html\" rel=\"nofollow noreferrer\">tmpnam here</a> but the best I can come up with is to use something like:</p>\n\n<pre><code>if (tmpnam_r == NULL) { return APP_ERROR }\n</code></pre>\n\n<p>However, since I cannot compile with <code>tmpnam</code> and am unfamiliar with the code in question, I am not confident in properly capturing the original intent.</p>\n\n<p>As best as I can tell, this appears to be testing if the file exists, and if not, simply returns an error, as the next step consists of copying content into <code>myfileName</code>, which should presumably exist following the above check.</p>\n"}, {"tags": ["c", "visual-studio"], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 1, "last_activity_date": 1568155354, "last_edit_date": 1568155354, "creation_date": 1568154624, "answer_id": 57878947, "question_id": 57878825, "link": "https://stackoverflow.com/questions/57878825/similar-structs-for-compiler-looks-same/57878947#57878947", "title": "Similar structs for compiler looks same", "body": "<p>These functions have the same name but different signatures, such as <code>int length(const NodeDouble *head)</code> and <code>int length(const NodeInt *head)</code>.  You'll have to resolve these naming conflicts.  You could use a naming scheme such as prepending to which library they belong to avoid naming conflicts.</p>\n\n<p>So you might have <code>int List_Int_Length(const NodeInt *head)</code> and <code>double List_Double_Length(const NodeDouble *head)</code></p>\n\n<p>If you want to get fancy and still use the same names when calling the functions, you can use C11's <code>_Generic</code> to select the correct operation to call.  Let us first assume that you've gone ahead and fixed the naming conflicts as above.  Now let us add a third header, ListGeneric.h:</p>\n\n<pre><code>#ifndef LIST_GENERIC_H\n#define LIST_GENERIC_H\n\n#include \"ListInt.h\"\n#include \"ListDouble.h\"\n\n#define length(X) _Generic((X), \\\n    const NodeInt *: List_Int_Length((X)), \\\n    const NodeDouble *: List_Double_Length((X)) \\\n)\n\n#endif\n</code></pre>\n\n<p>With that it will automagically pick the right function based on the type of the object passed in.</p>\n"}], "owner": {"reputation": 31, "user_id": 10772834, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nDV3MCuD6WE/AAAAAAAAAAI/AAAAAAAAAL4/U6UyoUoRrSE/photo.jpg?sz=128", "display_name": "Excentricitet", "link": "https://stackoverflow.com/users/10772834/excentricitet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568155354, "creation_date": 1568153652, "last_edit_date": 1568154990, "question_id": 57878825, "link": "https://stackoverflow.com/questions/57878825/similar-structs-for-compiler-looks-same", "title": "Similar structs for compiler looks same", "body": "<p>I have 2 headers (and .c files respectively) with structures:</p>\n\n<pre><code>#pragma once\n#include &lt;stdlib.h&gt;\n\ntypedef struct NodeInt {\n    int value;\n    struct NodeInt *next;\n} NodeInt;\n\nvoid push(NodeInt **head, int data);\n\nint pop(NodeInt **head);\n\nNodeInt* getNth(NodeInt* head, int n);\n\nNodeInt* getLast(NodeInt *head);\n\nvoid pushBack(NodeInt *head, int value);\n\nNodeInt* getLastButOne(NodeInt* head);\n\nvoid popBack(NodeInt **head);\n\nvoid insert(NodeInt *head, unsigned n, int val);\n\nint deleteNth(NodeInt **head, int n);\n\nvoid deleteList(NodeInt **head);\n\nvoid fromArray(NodeInt **head, int *arr, size_t size);\n\nint* toArray(const NodeInt *head);\n\nvoid printLinkedList(const NodeInt *head);\n\nint length(const NodeInt *head);\n</code></pre>\n\n<p>and ListDouble.h:</p>\n\n<pre><code>#pragma once\n#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct NodeDouble {\n    struct NodeDouble *next;\n    double value;\n} NodeDouble;\n\nvoid push(NodeDouble **head, double data);\n\ndouble pop(NodeDouble **head);\n\nNodeDouble* getNth(NodeDouble* head, int n);\n\nNodeDouble* getLast(NodeDouble *head);\n\nvoid pushBack(NodeDouble *head, double value);\n\nNodeDouble* getLastButOne(NodeDouble* head);\n\nvoid popBack(NodeDouble **head);\n\nvoid insert(NodeDouble *head, unsigned n, double val);\n\ndouble deleteNth(NodeDouble **head, int n);\n\nvoid deleteList(NodeDouble **head);\n\nvoid fromArray(NodeDouble **head, double *arr, size_t size);\n\ndouble* toArray(const NodeDouble *head);\n\nvoid printLinkedList(const NodeDouble *head);\n\nint length(const NodeDouble *head);\n</code></pre>\n\n<p>Sources have are similar signature, but with difference in Double / Int respectively.\nWhen i try to compilation, i got error that this declarations of functions are incompatible.</p>\n\n<p>Is compiler think, that NodeInt and NodeDouble are sameDatatype and he don't see difference, and i should change names of functions? Or this problem has resolve?</p>\n"}, {"tags": ["c++", "c", "winapi", "visual-c++", "ldap"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1568157415, "post_id": 57878479, "comment_id": 102183029, "body": "No need for the <code>const_casts</code>, string literals are automatically const."}, {"owner": {"reputation": 3287, "user_id": 964478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Md8qK.png?s=128&g=1", "display_name": "Alex P.", "link": "https://stackoverflow.com/users/964478/alex-p"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1568178847, "post_id": 57878479, "comment_id": 102187697, "body": "@JonathanPotter yes, and that&#39;s why I used it. I cannot pass <code>const wchar_t**</code> to this function, only <code>wchar_t**</code>."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1568156581, "post_id": 57878480, "comment_id": 102182887, "body": "And as you can see in the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ldap/searching-a-directory\" rel=\"nofollow noreferrer\">MSDN example</a> linked to in the question, the array is terminated by <code>NULL</code>, not by <code>&quot;&quot;</code>."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1568176492, "post_id": 57878480, "comment_id": 102187127, "body": "The use of const_cast is wrong. Literals are not modifiable."}, {"owner": {"reputation": 3287, "user_id": 964478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Md8qK.png?s=128&g=1", "display_name": "Alex P.", "link": "https://stackoverflow.com/users/964478/alex-p"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1568178956, "post_id": 57878480, "comment_id": 102187723, "body": "@DavidHeffernan yes, but hopefully this function does not try to modify them. I cannot pass <code>const wchar_t**</code> to this function, only <code>wchar_t**</code>."}], "tags": [], "owner": {"reputation": 3287, "user_id": 964478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Md8qK.png?s=128&g=1", "display_name": "Alex P.", "link": "https://stackoverflow.com/users/964478/alex-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1568189818, "last_edit_date": 1568189818, "creation_date": 1568151191, "answer_id": 57878480, "question_id": 57878479, "link": "https://stackoverflow.com/questions/57878479/how-to-initialize-a-pzpwstr-wchar-t-parameter-for-winapi-ldap-search-s/57878480#57878480", "title": "How to initialize a PZPWSTR (wchar_t**) parameter for WinApi ldap_search_s?", "body": "<p>Your array is not null-terminated. NULL and an empty string are <strong>not</strong> the same.</p>\n\n<p>Use <code>NULL</code> (or <code>nullptr</code> in modern C++).</p>\n\n<pre><code>wchar_t *attrs[] = {\n    const_cast&lt;wchar_t *&gt;(L\"memberOf\"),\n    nullptr\n};\n</code></pre>\n"}], "owner": {"reputation": 3287, "user_id": 964478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Md8qK.png?s=128&g=1", "display_name": "Alex P.", "link": "https://stackoverflow.com/users/964478/alex-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 57878480, "answer_count": 1, "score": -1, "last_activity_date": 1568190468, "creation_date": 1568151191, "last_edit_date": 1568190468, "question_id": 57878479, "link": "https://stackoverflow.com/questions/57878479/how-to-initialize-a-pzpwstr-wchar-t-parameter-for-winapi-ldap-search-s", "title": "How to initialize a PZPWSTR (wchar_t**) parameter for WinApi ldap_search_s?", "body": "<p>I am using <code>ldap_search_s</code> (<code>ldap_search_sW</code>) to extract AD user groups. It works when the <code>attrs</code> parameter (<code>PZPWSTR</code>, or <code>wchar_t**</code>) is <code>NULL</code>, but when I tried to specify it I got <code>Exception at 0x7ffc1885bd95, code: 0xc0000005: read access violation at: 0xfffffffffffffffe</code>.</p>\n\n<pre><code>wchar_t *attrs[] = {\n    const_cast&lt;wchar_t *&gt;(L\"memberOf\"),\n    const_cast&lt;wchar_t *&gt;(L\"\")\n};\nret = ldap_search_s(pLdap, const_cast&lt;wchar_t *&gt;(dn.c_str()), LDAP_SCOPE_SUBTREE, const_cast&lt;wchar_t *&gt;(filter.c_str()), attrs, 0, &amp;pSearchResult);\n</code></pre>\n\n<p>According to the <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winldap/nf-winldap-ldap_search_sw\" rel=\"nofollow noreferrer\">docs</a> it needs to be \"a null-terminated array of null-terminated strings indicating the attributes to return for each matching entry. Pass NULL to retrieve all available attributes.\"</p>\n\n<p>I tried different ways using vectors, arrays, etc. and always get the same error.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ldap/searching-a-directory\" rel=\"nofollow noreferrer\">The example in MSDN</a> shows only the ANSI version, but it seems to be a very similar array of pointers.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 103, "user_id": 9956819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vyqTJUT5Akg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1h1UDYXNr5bnJmmrISnduae6qrAg/mo/photo.jpg?sz=128", "display_name": "Stephane", "link": "https://stackoverflow.com/users/9956819/stephane"}, "edited": false, "score": 0, "creation_date": 1568150872, "post_id": 57878407, "comment_id": 102181516, "body": "ok second time i have this problem, why my &quot;hello/hi&quot; disappear at the beginning of my posts ? is it normal ? do i do something wrong ?"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 1, "creation_date": 1568151204, "post_id": 57878407, "comment_id": 102181623, "body": "Regarding greetings: <a href=\"https://meta.stackexchange.com/questions/2950/should-hi-thanks-taglines-and-salutations-be-removed-from-posts\">see here (especially the second answer)</a>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1568151208, "post_id": 57878407, "comment_id": 102181626, "body": "You cannot initialize after the declaration.  At that point you will be dealing in assignment.  You cannot assign an array."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9956819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vyqTJUT5Akg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1h1UDYXNr5bnJmmrISnduae6qrAg/mo/photo.jpg?sz=128", "display_name": "Stephane", "link": "https://stackoverflow.com/users/9956819/stephane"}, "edited": false, "score": 0, "creation_date": 1568153135, "post_id": 57878580, "comment_id": 102182174, "body": "Thanks, that&#39;s crystal clear ! Since i could do it with structs i thought it was possible to do so with arrays of structs also, but no ^^. Thanks a lot."}, {"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "reply_to_user": {"reputation": 103, "user_id": 9956819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vyqTJUT5Akg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1h1UDYXNr5bnJmmrISnduae6qrAg/mo/photo.jpg?sz=128", "display_name": "Stephane", "link": "https://stackoverflow.com/users/9956819/stephane"}, "edited": false, "score": 1, "creation_date": 1568156098, "post_id": 57878580, "comment_id": 102182782, "body": "@Stephane There is an old hack where you wrap an array in a struct declaration <code>typedef struct { int arr[5] } structarray;</code> just so that you can assign one <code>structarray</code> to another. It makes everything else a bit clunky, though, so think about the trade-offs before you dive in."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 9, "last_activity_date": 1568152211, "last_edit_date": 1568152211, "creation_date": 1568151817, "answer_id": 57878580, "question_id": 57878407, "link": "https://stackoverflow.com/questions/57878407/array-of-struct-initialization-in-c/57878580#57878580", "title": "Array of struct initialization in C", "body": "<p>Arrays are special in C. You can only once initialize arrays. You can't then \"re-initialize\" arrays. Assignments on arrays don't work. Array is in most contexts a pointer that you can't assign to. You can't:</p>\n\n<pre><code>int arr[3];\n// arr = {1,2,3}; // will not work\n// arr = anything; // will not work\n</code></pre>\n\n<p>You only can <code>memcpy</code> to them with a compound literal:</p>\n\n<pre><code>memcpy(ta3, (T_A[3]){ { 0 }, { 1 }, { 2 } }, sizeof(ta3));\n</code></pre>\n\n<p>Or without compund literal initialize a temporary variable and <code>memcpy</code>:</p>\n\n<pre><code>const T_A temp[3] = { { 0 }, { 1 }, { 2 } };\nmemcpy(ta3, temp, sizeof(ta3));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 9956819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vyqTJUT5Akg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1h1UDYXNr5bnJmmrISnduae6qrAg/mo/photo.jpg?sz=128", "display_name": "Stephane", "link": "https://stackoverflow.com/users/9956819/stephane"}, "edited": false, "score": 1, "creation_date": 1568153646, "post_id": 57878674, "comment_id": 102182296, "body": "thanks for the clarification ! But no thanks for the link XD, i am not reading that, i&#39;d rather brute force my way until it compile hahaha. No more seriously, Yacc, bnf, and other grammar documents like those are just unreadable for me. if I have to do a compiler one day i&#39;ll do, but till then..."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 103, "user_id": 9956819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vyqTJUT5Akg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1h1UDYXNr5bnJmmrISnduae6qrAg/mo/photo.jpg?sz=128", "display_name": "Stephane", "link": "https://stackoverflow.com/users/9956819/stephane"}, "edited": false, "score": 0, "creation_date": 1568155905, "post_id": 57878674, "comment_id": 102182744, "body": "@Stephane There is no need to learn it completely, but I do recommend at least taking a quick look. I especially recommend learning the difference between statement and primary expression. Also, understanding the grammar can make it A LOT easier to decode the cryptic warnings and errors the compiler yields."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 5, "last_activity_date": 1598440556, "last_edit_date": 1598440556, "creation_date": 1568152445, "answer_id": 57878674, "question_id": 57878407, "link": "https://stackoverflow.com/questions/57878407/array-of-struct-initialization-in-c/57878674#57878674", "title": "Array of struct initialization in C", "body": "<p>In C, an <em>initialization</em> is something that you do simultaneously as the declaration. You cannot do it afterwards.</p>\n<p>This can be seen in the grammar that you can find here: <a href=\"https://www.lysator.liu.se/c/ANSI-C-grammar-y.html\" rel=\"nofollow noreferrer\">https://www.lysator.liu.se/c/ANSI-C-grammar-y.html</a></p>\n<p>Whenever you use the <code>=</code> after you have finished the declaration, it's an assignment and not an initialization, and assignments have different rules. One of these rules is that the common way of initializing arrays - <code>= {1,2,3}</code> - simply is not allowed. You have to use <code>memcpy</code> or something like that.</p>\n<p>When it comes to nonarrays, like <code>int</code>, <code>double</code> etc and their pointers, it is still true that you cannot formally initialize them after declaration, but for those, assignment has the same syntax so it can be confusing.</p>\n<p>However, there is a trick that can be used for arrays. Wrap the array in a struct and do like this:</p>\n<pre><code>struct wrapper{\n    int arr[3];\n} x;\n\nx = (struct wrapper){{1,2,3}};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "is_accepted": false, "score": 1, "last_activity_date": 1568313826, "creation_date": 1568313826, "answer_id": 57912839, "question_id": 57878407, "link": "https://stackoverflow.com/questions/57878407/array-of-struct-initialization-in-c/57912839#57912839", "title": "Array of struct initialization in C", "body": "<p>Unfortunately, as others already mentioned, one cannot <em>assign</em> anything to an array.</p>\n\n<pre><code>int arr[N];\n...\narr = ... ; // --&gt; This will always fail compilation\n</code></pre>\n\n<p>The only option is such case is either to assign new value to each array entry separately</p>\n\n<pre><code>arr[i] = ...;\n</code></pre>\n\n<p>Or use <code>memcpy</code> to copy values from other memory location.</p>\n\n<p>The <strong>interesting</strong> thing is that if one defines a <em>struct of array(s)</em> rather than an array of struct(s):</p>\n\n<pre><code>typedef struct S_S {\n    int x[3];\n} T_S;\n</code></pre>\n\n<p>then the assignment after the declaration is allowed:</p>\n\n<pre><code>typedef struct S_S {\n     int x[3];\n} T_S;\n\nint main(void)\n{\n   T_S y;\n\n   y = (T_S){.x = {1, 2, 3}}; //OK!\n\n  return 0;\n}\n</code></pre>\n\n<p>This <a href=\"https://godbolt.org/z/zQ78FD\" rel=\"nofollow noreferrer\">perfectly compiles</a> (assuming your compiler supports C99 standard)!</p>\n"}], "owner": {"reputation": 103, "user_id": 9956819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vyqTJUT5Akg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1h1UDYXNr5bnJmmrISnduae6qrAg/mo/photo.jpg?sz=128", "display_name": "Stephane", "link": "https://stackoverflow.com/users/9956819/stephane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 3, "answer_count": 3, "score": 1, "last_activity_date": 1598440556, "creation_date": 1568150786, "last_edit_date": 1569223567, "question_id": 57878407, "link": "https://stackoverflow.com/questions/57878407/array-of-struct-initialization-in-c", "title": "Array of struct initialization in C", "body": "<p>I cannot find the solution to this. I can initialize an array of struct like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct S_A {\n    int x;\n} T_A;\n\nT_A ta1[3];\n\nta1[0] = (T_A){0};\nta1[1] = (T_A){1};\nta1[2] = (T_A){2};\n\nT_A ta2[3] = { {0}, {1}, {2} };\n</code></pre>\n\n<p>But how can I do a one-line initialization after declaration?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>T_A ta3[3];\n\nta3 = (?){ {?}, {?}, {?} };\n\nta3 = (T_A[3]){ { 0 }, { 1 }, { 2 } }; // error\nta3 = (T_A*)  { { 0 }, { 1 }, { 2 } }; // error\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1568173380, "post_id": 57878087, "comment_id": 102186481, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/199272/discussion-on-question-by-francisco-jose-letterio-why-is-argv0-not-consistent\">moved to chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 7327379, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nPTWrm6AyyE/AAAAAAAAAAI/AAAAAAAAABI/hcEHHlrDmt8/photo.jpg?sz=128", "display_name": "Demindiro", "link": "https://stackoverflow.com/users/7327379/demindiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1568159951, "creation_date": 1568159951, "answer_id": 57879482, "question_id": 57878087, "link": "https://stackoverflow.com/questions/57878087/why-is-argv0-not-consistent/57879482#57879482", "title": "Why is argv[0] not consistent?", "body": "<p><code>argv[0]</code> isn't necessarily the program's path. It is simply the first argument.</p>\n\n<p>It just so happens that by convention, we use it for the program's name.</p>\n\n<p>For your specific case, you need:</p>\n\n<pre><code>execl(\"./printTest\", \"./printTest\", fileName, NULL);\n</code></pre>\n\n<p>Note that this means you always should check if <code>argv[0]</code> is defined before using it.</p>\n"}], "owner": {"reputation": 377, "user_id": 8617112, "user_type": "registered", "profile_image": "https://graph.facebook.com/2121562047869644/picture?type=large", "display_name": "Francisco Jos&#233; Letterio", "link": "https://stackoverflow.com/users/8617112/francisco-jos%c3%a9-letterio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1568159951, "creation_date": 1568148851, "last_edit_date": 1568149576, "question_id": 57878087, "link": "https://stackoverflow.com/questions/57878087/why-is-argv0-not-consistent", "title": "Why is argv[0] not consistent?", "body": "<p>From what I understand, argv[0] is the program's path. However, we are doing an assignment and one of my friends gets the name of the first argument when invoking argv[0]. </p>\n\n<p>Why does this happen and how can I change this behaviour?</p>\n\n<p>Edit: This is the parent process</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#define SIZE 200\n\n\n\n\nint main(int argc, char const *argv[])\n{\n    char fileName[SIZE];\n    int bytesToRead;\n    int status;\n    bytesToRead = read(0 ,fileName, SIZE);\n    int p[2];\n    pipe(p);\n\n    pid_t pid;\n    if((pid = fork()) == -1){\n        perror(\"error en el fork\");\n    }\n\n    else if(pid == 0){ \n        close(p[0]);\n        dup2(STDOUT_FILENO, p[1]);\n        execl(\"./printTest\", fileName, NULL);\n        close(p[1]);\n        exit(0);\n\n    }\n    else{\n\n\n    }\n    waitpid(pid, &amp;status, 0);\n\n    return 0;\n}\n</code></pre>\n\n<p>And next is a child process:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#define SIZE 512\n\nint main(int argc, char const *argv[])\n{\n    //char buffer[SIZE];\n    //int bytesToRead;\n    /* \n    while((bytesToRead = read(0 ,buffer, SIZE)) &gt; 0){\n            write(1, buffer, bytesToRead);\n    }*/\n    printf(\"%s\\n\",argv[0]);\n    printf(\"Exec executed\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>From what we understand, argv[0] should hold the program's name, yet it's printing the first argument (whatever was input from stdin in the parent process)</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1568146376, "post_id": 57877597, "comment_id": 102180034, "body": "The pointer passed to <code>free</code> must be the pointer returned from <code>malloc</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 7, "creation_date": 1568146425, "post_id": 57877597, "comment_id": 102180052, "body": "You can only pass <i>the exact value you <code>malloc()</code>ed</i> to <code>free()</code>. If you want to mess around with alignment, you need to either keep around the original pointer and <code>free()</code> it, or be sane and just use <code>aligned_alloc()</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1568146436, "post_id": 57877597, "comment_id": 102180053, "body": "That can&#39;t possibly work. You are returning a pointer inside allocated block, but this was not a pointer which was returned by malloc. You can&#39;t free it."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1568150582, "post_id": 57877597, "comment_id": 102181433, "body": "<code>mmap()</code> is your friend."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568155956, "post_id": 57877597, "comment_id": 102182755, "body": "the posted code fails to compile!  there are several <code>error</code> messages from the compiler. How are we to help you with a run time problem when the code you post does not compile?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568156260, "post_id": 57877597, "comment_id": 102182812, "body": "the type <code>uintptr_t</code> is defined in the header file: <code>stdint.h</code> which the posted code fails to include"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568156375, "post_id": 57877597, "comment_id": 102182838, "body": "why are you including the header files: stdio.h and stdlib.h as if they were &#39;home grown&#39; header files.  The correct syntax is: <code>#include &lt;stdio.h&gt;</code> and <code>#include &lt;stdlib.h&gt;</code>"}, {"owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568224366, "post_id": 57877597, "comment_id": 102210205, "body": "@user3629249 code I posted compiles perfectly fine on a mac. Though on linux it does get compile errors as you pointed."}], "answers": [{"tags": [], "owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "is_accepted": true, "score": 1, "last_activity_date": 1568149664, "creation_date": 1568149664, "answer_id": 57878227, "question_id": 57877597, "link": "https://stackoverflow.com/questions/57877597/abort-trap-when-freeing-a-pointer/57878227#57878227", "title": "Abort trap when freeing a pointer", "body": "<p>As explained in the comment, you can only free the exact pointer returned by malloc. If you want an aligned memory outside of the standard C datatype scope, you should probably use a function that was made for this purpose, such as <a href=\"https://linux.die.net/man/3/aligned_alloc\" rel=\"nofollow noreferrer\">aligned_alloc</a>.</p>\n\n<p>The following code should work as intended.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"stdlib.h\"\n#include &lt;stdint.h&gt;\n\n#define BYTE_ALIGNMENT 64\n\nint main(){\n\n   void *ptr;\n   int  size;\n\n   size = 66;\n   if (size % BYTE_ALIGNMENT)\n       size += BYTE_ALIGNMENT - size % BYTE_ALIGNMENT;\n   ptr = aligned_alloc(size, BYTE_ALIGNMENT);\n   printf(\"%d\\n\", size);\n   if( ((uintptr_t)ptr % BYTE_ALIGNMENT) == 0){ // make sure the pointer is byte aligned\n          printf(\"64 byte aligned %p\\n\",ptr);\n    }\n    if (ptr)\n        free(ptr);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57878227, "answer_count": 1, "score": -1, "last_activity_date": 1568149664, "creation_date": 1568146230, "question_id": 57877597, "link": "https://stackoverflow.com/questions/57877597/abort-trap-when-freeing-a-pointer", "title": "Abort trap when freeing a pointer", "body": "<p>I created a function which would return an aligned memory pointer.\nWhen I try to free it , I get an abort. I did allocate more memory to make sure I account for extra padding i did to make the pointer 64B aligned.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"stdlib.h\"\n\n#define BYTE_ALIGNMENT 64\n#define BYTE_ALIGNMENT_MASK BYTE_ALIGNMENT-1\n\nvoid *memory_aligned(size_t size){\n\n    void *ptr;\n    ptr= malloc(size+BYTE_ALIGNMENT); //malloc more memory.\n\n    if( ((uintptr_t)ptr &amp; BYTE_ALIGNMENT_MASK) == 0){\n          printf(\"already aligned %p\\n\",ptr);\n          return ptr;\n\n    }\n    if( ((uintptr_t)ptr % BYTE_ALIGNMENT) == 0){\n          printf(\"64 byte aligned %p\\n\",ptr);\n          return ptr;\n\n    } else{\n        // check how many bytes are needed to make it 64 byte aligned.\n        // ptr-&gt;8 64-8 = 56 bytes\n        printf(\"Not 64 byte aligned %p \\n\",ptr);\n        int padding = BYTE_ALIGNMENT - ((uintptr_t)ptr%BYTE_ALIGNMENT);\n        ptr = ptr+padding;\n        printf(\"should be now byte aligned %p \\n\",ptr);\n    }\n\n    return ptr;\n\n}\n\n\nint main(){\n\n   void *ptr;\n   ptr = memory_aligned(66);\n    if( ((uintptr_t)ptr % BYTE_ALIGNMENT) == 0){ // make sure the pointer is byte aligned\n          printf(\"64 byte aligned %p\\n\",ptr);\n\n\n    }\n   free(ptr);\n   return 0;\n\n}\n</code></pre>\n\n<p>The output I am getting is:</p>\n\n<pre><code>./a.out\n\n\n Not 64 byte aligned 0x7fddd7c02ae0 \nshould be now byte aligned 0x7fddd7c02b00 \n64 byte aligned 0x7fddd7c02b00\na.out(25197,0x10ae035c0) malloc: *** error for object 0x7fddd7c02b00: pointer being freed was not allocated\na.out(25197,0x10ae035c0) malloc: *** set a breakpoint in malloc_error_break to debug\nAbort trap: 6\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1568146160, "post_id": 57877538, "comment_id": 102179948, "body": "No. You can only pass a function pointer. Any parameters to the predicate function also need to be passed explicitly, because C does not have closures."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568146269, "post_id": 57877538, "comment_id": 102179991, "body": "I am not sure why you need generator function. You can simply use function pointer."}, {"owner": {"reputation": 327, "user_id": 6344234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVeZx.jpg?s=128&g=1", "display_name": "Rishabh Gupta", "link": "https://stackoverflow.com/users/6344234/rishabh-gupta"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568146492, "post_id": 57877538, "comment_id": 102180073, "body": "@SergeyA How will I send variable a to that function? Can you elaborate using given code"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568146729, "post_id": 57877538, "comment_id": 102180166, "body": "Same way as you do know. If you need context, you can use an opaque pointer to store context (see answer below)."}], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 2, "last_activity_date": 1568146551, "creation_date": 1568146551, "answer_id": 57877664, "question_id": 57877538, "link": "https://stackoverflow.com/questions/57877538/how-to-generate-a-new-function-in-c/57877664#57877664", "title": "How to generate a new function in C?", "body": "<p>A common idiom is a pair of parameters; a function and an opaque context pointer; so a simple case could be something like:</p>\n\n<pre><code>int check_range(int a, void *p) {\n    int *range = p;\n    return a &gt;= range[0] &amp;&amp; a &lt; range[1];\n}\nstruct Set { int n; int *vals; };\nint check_set(int b, void *p) {\n    struct Set *s = p;\n    int i;\n    for (i = 0; i &lt; s-&gt;n &amp;&amp; s-&gt;vals[i] != b; i++) {}\n    return i &lt; s-&gt;n;\n}\n</code></pre>\n\n<p>If you look at the blocks extension to C supported by clang &amp; gcc, it isn't far different from this, except that it is more sugary and has some really scary side effects.</p>\n"}], "owner": {"reputation": 327, "user_id": 6344234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVeZx.jpg?s=128&g=1", "display_name": "Rishabh Gupta", "link": "https://stackoverflow.com/users/6344234/rishabh-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 57877664, "answer_count": 1, "score": 1, "last_activity_date": 1568146551, "creation_date": 1568145934, "question_id": 57877538, "link": "https://stackoverflow.com/questions/57877538/how-to-generate-a-new-function-in-c", "title": "How to generate a new function in C?", "body": "<p>I want a function that could take input a single integer from the user with validation, lets call it <code>input_single_int</code>. Such a function would greatly simplify my code. If a user gives incorrect input, then the function should show error and again prompt the user to fill out the correct input. The problem is the validation part, different inputs require different validation. Even if I send a validation function, how do I send the different parameters required by the validation function through <code>input_single_int</code>? </p>\n\n<p>I want this function to be generic, so that I could use it multiple places. In the code given, if I add a parameter in <code>input_single_int</code> to accomodate input of variable b, I would have to change <code>check_a</code> function also, which I don't want to do. I also don't want to use global variables.</p>\n\n<p>The only way which I could think of achieving this is through a function that could generate another function. Something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>func generate_check_b(int a) {\n    return int check_b(int b) { return (b &gt; 0 &amp;&amp; b &lt; a); };\n}\n</code></pre>\n\n<p>Is such a thing possible in C?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define MM_SHOW 8\n#define MM_QUIT 9\n\nint input_single_int(int *var, char msg[], int exit_on_eq, int secondary_check(int val)) {\n    int inp_status, error, temp;\n    char skip;\n    do {\n        error = 0;\n        printf(\"%s\", msg);\n        inp_status = scanf(\"%d\", &amp;temp);\n        if (inp_status != 1) {\n            error = 1;\n            do {\n                scanf(\"%c\", &amp;skip);\n                if (exit_on_eq) {\n                    if (skip == 'e') {\n                        system(\"clear\");\n                        return MM_SHOW;\n                    } else if (skip == 'q') {\n                        system(\"clear\");\n                        return MM_QUIT;\n                    }\n                }\n            } while (skip != '\\n');\n        }\n        if (!secondary_check(temp)) {\n            error = 1;\n        }\n    } while (error &amp;&amp; printf(\"Please give a correct input.\\n\"));\n    *var = temp;\n    return 0;\n}\n\nint check_a(int a) { return a &gt; 0;}\nint check_b(int b, int a) { return (b &gt; 0 &amp;&amp; b &lt; a);}\n\nint main() {\n    int a, b;\n    char amsg[] = \"a should be more than 0: \";\n    char bmsg[] = \"b should be more than 0 and less than a: \";\n    input_single_int(&amp;a, amsg, 1, check_a);\n    input_single_int(&amp;b, bmsg, 1, check_b);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "fpga", "stm32f4", "ice40"], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 0, "last_activity_date": 1568191112, "creation_date": 1568191112, "answer_id": 57885274, "question_id": 57877398, "link": "https://stackoverflow.com/questions/57877398/how-to-program-lattice-ice40-ultra-with-a-microcontroller/57885274#57885274", "title": "How to program Lattice iCE40 ultra with a microcontroller", "body": "<p>If you use GCC and binutils as compiler/linker system you can use <code>objcopy</code> to generate a linkable module from any binary file. This can then be linked into your controller's readonly data space and accessed from your program.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12048586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b291d86e7ba45cf0eb3a3fc5117c7280?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith95", "link": "https://stackoverflow.com/users/12048586/jsmith95"}, "edited": false, "score": 0, "creation_date": 1571322324, "post_id": 58006017, "comment_id": 103210155, "body": "This worked, I was able to find a c program that would take a .bin file and convert it into a .h file that contains an array with the binary values of the .bin file and the length of that array. I then just include that .h file in my program and transmit the array to the FPGA. It is probably not the most memory efficient way but it works."}, {"owner": {"reputation": 745, "user_id": 2086096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qErCv.jpg?s=128&g=1", "display_name": "Baard", "link": "https://stackoverflow.com/users/2086096/baard"}, "reply_to_user": {"reputation": 3, "user_id": 12048586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b291d86e7ba45cf0eb3a3fc5117c7280?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith95", "link": "https://stackoverflow.com/users/12048586/jsmith95"}, "edited": false, "score": 0, "creation_date": 1571334094, "post_id": 58006017, "comment_id": 103216053, "body": "Congratulation."}], "tags": [], "owner": {"reputation": 745, "user_id": 2086096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qErCv.jpg?s=128&g=1", "display_name": "Baard", "link": "https://stackoverflow.com/users/2086096/baard"}, "is_accepted": true, "score": 1, "last_activity_date": 1582048707, "last_edit_date": 1582048707, "creation_date": 1568878692, "answer_id": 58006017, "question_id": 57877398, "link": "https://stackoverflow.com/questions/57877398/how-to-program-lattice-ice40-ultra-with-a-microcontroller/58006017#58006017", "title": "How to program Lattice iCE40 ultra with a microcontroller", "body": "<p>The ice40 image needs to be included in the stm32F4 image. There are at least two possibilities. </p>\n\n<ul>\n<li>As suggested in an other answer. Let the linker do the job. The GCC linker can include arbitrary binary data, several ways to do this are outlined <a href=\"https://stackoverflow.com/questions/327609/include-binary-file-with-gnu-ld-linker-script\">here</a>. This require use of <code>objcopy</code>, or modifications to the linker script.</li>\n<li><p>Make a small utility to transform the binary ice40 image to a C data object, something like this (<em>warning, code not well tested</em>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main( void ) {\n        int i=0,c;\n        printf( \"#include &lt;stdint.h&gt;\\nconst uint8_t ice40image[] = {\\n\" );\n        while ( (c = getchar()) != EOF ) \n                printf( \"%#2.2x%s\", c, (++i &amp; 15) ? \",\" : \",\\n\" );\n        printf( \"};\\n#define ICE40IMAGE_LEN %d\\n\", i );\n        return 0;\n}\n</code></pre>\n\n<p>The binary ice40 image is transformed into a header file:</p>\n\n<blockquote>\n  <p><code>./bin2uint8_t &lt; ice40image.bin &gt; ice40image.h</code></p>\n</blockquote>\n\n<p>and <code>ice40image.h</code> is included in your stm32F4 program.  I prefer this method, it lends itself to later refinements such as compressing the FPGA image (it often has long runs of 0x00). In my opinion, a very good utility for this is 'icecmpr' in project iceStorm, see <a href=\"https://github.com/cliffordwolf/icestorm/tree/master/icecompr\" rel=\"nofollow noreferrer\">https://github.com/cliffordwolf/icestorm/tree/master/icecompr</a></p></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 12048586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b291d86e7ba45cf0eb3a3fc5117c7280?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith95", "link": "https://stackoverflow.com/users/12048586/jsmith95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "accepted_answer_id": 58006017, "answer_count": 2, "score": 0, "last_activity_date": 1611927799, "creation_date": 1568145202, "question_id": 57877398, "link": "https://stackoverflow.com/questions/57877398/how-to-program-lattice-ice40-ultra-with-a-microcontroller", "title": "How to program Lattice iCE40 ultra with a microcontroller", "body": "<p>I am trying to program a iCE40 ultra FPGA with a stm32F4 microcontroller and I am trying to figure out how to load the configuration file onto the micro so that it can be sent to the FPGA by SPI to program it. The application note says that this can be done and has some pseudo code but it seems like it is for use with a computer and not a microcontroller. Both the micro and FPGA are on a PCB that I designed and have a SPI channel between them. This will get used after the programming for just communication between the two. </p>\n\n<p>The configuration file is a .bin file or .hex file and I am unsure of how to load one of these files onto the stm32 and send it to the FPGA. I am trying to do it this way because I was hoping to not have to buy a programming cable and include flash memory on my PCB to store the program since I already need SPI communication between the micro and FPGA for the application I was hoping to make things easier on my self and may have done the opposite...</p>\n\n<p>Here is the function that I have written to send the file across. I know that I need to open the file somehow and send it across. All of the other timing comes from the programming guild for the FPGA. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static void FPGA_Programming(void){\n\n    char FPGA_TimeOut = 0; // Error timeout\n    uint8_t dummyBits[7]; \n    for(char i = 0; i &lt; 7; i++){ // loads dummy bits to be transmitted\n        dummyBits[i] = 0b01010101;\n    }\n    /* Write FPGA config pin and SS to low for at least 200 ns to reset and start FPGA\n     * in SPI Slave Configuration\n     */\n    HAL_GPIO_WritePin(FPGA_Config_GPIO_Port, FPGA_Config_Pin, GPIO_PIN_RESET);\n    HAL_GPIO_WritePin(FPGA_SS_GPIO_Port,FPGA_SS_Pin, GPIO_PIN_RESET);\n    HAL_Delay(1);\n    HAL_GPIO_WritePin(FPGA_Config_GPIO_Port, FPGA_Config_Pin, GPIO_PIN_SET); // Set high to turn on FPGA THIS PIN SHOULD STAY HIGH!\n    HAL_Delay(2); // Wait for FPGA to clear sys memory\n    // SEND FPGA CONFIG FILE \n    while(!HAL_GPIO_ReadPin(FPGA_CDone_GPIO_Port, FPGA_CDone_Pin)){ // wait for CDone to go high when config is done and successfull \n        HAL_Delay(1);\n        if (FPGA_TimeOut == 5) { // if 5 milliseconds have passed and CDone has not gone low\n            // send to debug FPGA ERROR Programming\n            break;\n        }\n        FPGA_TimeOut++;\n    }\n    HAL_SPI_Transmit(&amp;hspi1, dummyBits, 7, 10 ); // wait for FPGA to start\n\n}\n</code></pre>\n\n<p>Any help with loading the file and opening it with the micro would be a great help.</p>\n"}, {"tags": ["c", "linux", "pthreads", "race-condition"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 11837920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63446cdf9e7f3ddcadccc5ea1147326?s=128&d=identicon&r=PG&f=1", "display_name": "user338717", "link": "https://stackoverflow.com/users/11837920/user338717"}, "is_accepted": true, "score": 0, "last_activity_date": 1568388303, "creation_date": 1568388303, "answer_id": 57926401, "question_id": 57877228, "link": "https://stackoverflow.com/questions/57877228/detached-pthread-data-race-from-helgrind/57926401#57926401", "title": "Detached pthread data race from helgrind", "body": "<p>In the end I just restructured everything so I could join my threads, I really don't see how detached threads could work without causing this data race.</p>\n"}], "owner": {"reputation": 87, "user_id": 11837920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63446cdf9e7f3ddcadccc5ea1147326?s=128&d=identicon&r=PG&f=1", "display_name": "user338717", "link": "https://stackoverflow.com/users/11837920/user338717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 57926401, "answer_count": 1, "score": 0, "last_activity_date": 1568388303, "creation_date": 1568144221, "last_edit_date": 1568159723, "question_id": 57877228, "link": "https://stackoverflow.com/questions/57877228/detached-pthread-data-race-from-helgrind", "title": "Detached pthread data race from helgrind", "body": "<p>I have a much larger piece of multithreaded software (proprietary and cannot share) which is reporting a data race from helgrind (see data race below). I cannot share this software but I have devised some tests to demonstrate the race.</p>\n\n<p>The race from the actual software having issues:</p>\n\n<pre><code>==7746== Possible data race during write of size 1 at 0xAC83697 by thread #4\n==7746== Locks held: 2, at addresses 0x583BCD8 0x5846F58\n==7746==    at 0x4C3A3CC: mempcpy (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==7746==    by 0x401375F: _dl_allocate_tls_init (dl-tls.c:515)\n==7746==    by 0x5053CED: get_cached_stack (allocatestack.c:254)\n==7746==    by 0x5053CED: allocate_stack (allocatestack.c:501)\n==7746==    by 0x5053CED: pthread_create@@GLIBC_2.2.5 (pthread_create.c:539)\n==7746==    by 0x4C34BB7: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==7746==    by 0x40BFA6: &lt;redacted symbol names from private project&gt;\n==7746==    by 0x4C34DB6: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==7746==    by 0x50536B9: start_thread (pthread_create.c:333)\n==7746== \n==7746== This conflicts with a previous write of size 1 by thread #10\n==7746== Locks held: none\n==7746==    at 0x5053622: start_thread (pthread_create.c:265)\n==7746==  Address 0xac83697 is in a rw- anonymous segment\n==7746== \n</code></pre>\n\n<p>This data race comes up when the software shuts down a series of threads and then re-launches some new threads in the same thread pool. Unfortunately I cannot provide any of this code, however, I believe I was able to reproduce several examples that demonstrate the problem.</p>\n\n<hr>\n\n<p>I've found 3 other questions which relate to this problem:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/32560834/why-does-this-recursive-pthread-create-call-result-in-data-race\">Why does this recursive pthread_create call result in data race?</a></li>\n</ol>\n\n<p>The answer to the above was to manually set/allocate the stack, I don't believe this is a viable answer, and if it is, can somebody explain why?</p>\n\n<ol start=\"2\">\n<li><a href=\"https://stackoverflow.com/questions/40113375/data-race-during-nested-thread-creation\">Data race during nested thread creation</a></li>\n</ol>\n\n<p>The answer didn't have any effect</p>\n\n<ol start=\"3\">\n<li><a href=\"https://stackoverflow.com/questions/42674043/data-race-with-detached-pthread-detected-by-valgrind\">Data race with detached pthread detected by valgrind</a></li>\n</ol>\n\n<p>There was no answer to this one.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> I have added another (less complex) example at the bottom of this post which can also reproduce the problem.</p>\n\n<p>I was able to rewrite the example given in the first question into a minimally reproducible example, well, mostly.</p>\n\n<p>The following piece of code will generate the following data race about 85% of the time it is run on my machine (Ubuntu 16.04.6 LTS)</p>\n\n<p>Run with:</p>\n\n<pre><code>gcc -g ./test.c -o test -lpthread &amp;&amp; valgrind --tool=helgrind ./test\n</code></pre>\n\n<pre><code>==15656== Possible data race during write of size 1 at 0x5C27697 by thread #4\n==15656== Locks held: none\n==15656==    at 0x4C3A3CC: mempcpy (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==15656==    by 0x401375F: _dl_allocate_tls_init (dl-tls.c:515)\n==15656==    by 0x4E47CED: get_cached_stack (allocatestack.c:254)\n==15656==    by 0x4E47CED: allocate_stack (allocatestack.c:501)\n==15656==    by 0x4E47CED: pthread_create@@GLIBC_2.2.5 (pthread_create.c:539)\n==15656==    by 0x4C34BB7: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==15656==    by 0x400832: launch (test3.c:22)\n==15656==    by 0x4008FC: threadfn3 (test3.c:48)\n==15656==    by 0x4C34DB6: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==15656==    by 0x4E476B9: start_thread (pthread_create.c:333)\n==15656== \n==15656== This conflicts with a previous write of size 1 by thread #2\n==15656== Locks held: none\n==15656==    at 0x4E47622: start_thread (pthread_create.c:265)\n==15656==  Address 0x5c27697 is in a rw- anonymous segment\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong> I have added another (less complex) example at the bottom of this post which can also reproduce the problem.</p>\n\n<p>Here is the program which I have constructed to reproduce the problem, the semaphores are <strong>not necessary</strong> but they seem to greatly increase the chance of the data race occurring.</p>\n\n<pre><code>#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\npthread_t t1;\npthread_t t2;\npthread_t t3;\npthread_t t4;\n\nvoid *threadfn1(void *p);\nvoid *threadfn2(void *p);\nvoid *threadfn3(void *p);\nvoid *threadfn4(void *p);\n\nsem_t sem;\nsem_t sem2;\nsem_t sem3;\n\nvoid launch(pthread_t *t, void *(*fn)(void *), void *arg)\n{\n    pthread_create(t,NULL,fn,arg);\n    pthread_detach(*t);\n}\n\nvoid *threadfn1(void *p)\n{\n    launch(&amp;t2, threadfn2, NULL);\n    printf(\"1 %p\\n\", p);\n    // notify threadfn3 we are done\n    sem_post(&amp;sem);\n    return NULL;\n}\n\nvoid *threadfn2(void *p)\n{\n    launch(&amp;t3, threadfn3, NULL);\n    printf(\"2 %p\\n\", p);\n    // notify threadfn4 we are done\n    sem_post(&amp;sem2);\n    return NULL;\n}\n\nvoid *threadfn3(void *p)\n{\n    // wait for threadfn1 to finish\n    sem_wait(&amp;sem);\n    launch(&amp;t4, threadfn4, NULL);\n    // wait for threadfn4 to finish\n    sem_wait(&amp;sem3);\n    printf(\"3 %p\\n\", p);\n    return NULL;\n}\n\nvoid *threadfn4(void *p)\n{\n    // wait for threadfn2 to finish\n    sem_wait(&amp;sem2);\n    printf(\"4 %p\\n\", p);\n    // notify threadfn3 we are done\n    sem_post(&amp;sem3);\n    return NULL;\n}\n\nint main()\n{\n    sem_init(&amp;sem, 0, 0);\n    sem_init(&amp;sem2, 0, 0);\n    sem_init(&amp;sem3, 0, 0);\n\n    launch(&amp;t1, threadfn1, NULL);\n    printf(\"main\\n\");\n    pthread_exit(NULL);\n}\n</code></pre>\n\n<p>It appears to be related to threads ending before their parents or parents-of-parents have ended... Ultimately I cannot track down exactly what is causing the data race to occur.</p>\n\n<p>Also it should be noted there is another data race which has come up a few times during my testing, ultimately I was not able to reliably reproduce it because it just appeared on occasion for no reason. The data race was the same as the one I listed, except for the conflict which appeared to list more of a stack trace than just \"start_thread\", it looked exactly like the data race reported in the first question above except for the bottom where it lists __libc_thread_freeres:</p>\n\n<pre><code>==15973== Possible data race during write of size 1 at 0x5C27697 by thread #4\n==15973== Locks held: none\n==15973==    at 0x4C3A3CC: mempcpy (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==15973==    by 0x401375F: _dl_allocate_tls_init (dl-tls.c:515)\n==15973==    by 0x4E47CED: get_cached_stack (allocatestack.c:254)\n==15973==    by 0x4E47CED: allocate_stack (allocatestack.c:501)\n==15973==    by 0x4E47CED: pthread_create@@GLIBC_2.2.5 (pthread_create.c:539)\n==15973==    by 0x4C34BB7: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==15973==    by 0x400832: launch (test3.c:22)\n==15973==    by 0x4008FC: threadfn3 (test3.c:48)\n==15973==    by 0x4C34DB6: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==15973==    by 0x4E476B9: start_thread (pthread_create.c:333)\n==15973== \n==15973== This conflicts with a previous read of size 1 by thread #2\n==15973== Locks held: none\n==15973==    at 0x51C10B1: res_thread_freeres (in /lib/x86_64-linux-gnu/libc-2.19.so)\n==15973==    by 0x51C1061: __libc_thread_freeres (in /lib/x86_64-linux-gnu/libc-2.19.so)\n==15973==    by 0x4E45199: start_thread (pthread_create.c:329)\n==15973==    by 0x515547C: clone (clone.S:111)\n</code></pre>\n\n<p><strong>No, I cannot join the threads, that would not work for our software exhibiting the problem</strong></p>\n\n<p><strong>UPDATE</strong>: I have been doing some testing and have managed to generate another example which causes the problem with much less code. If you simply launch threads and detach them in a loop it causes the data race.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\n// seems we only need 3 threads to cause the problem\n#define NUM_THREADS 3\n\npthread_t t1[NUM_THREADS] = {0};\n\nvoid launch(pthread_t *t, void *(*fn)(void *), void *arg)\n{\n    pthread_create(t,NULL,fn,arg);\n    pthread_detach(*t);\n}\n\nvoid *threadfn(void *p)\n{\n    return NULL;\n}\n\nint main()\n{\n    int i = NUM_THREADS;\n    while (i-- &gt; 0) {\n        launch(t1 + i, threadfn, NULL);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>UPDATE 2:</strong> I have found that if you launch all threads <em>BEFORE</em> detaching any of them it appears to prevent the race condition from manifesting. See the following block of code which <strong>does not</strong> generate a race condition:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n\n#define NUM_THREADS 3\n\npthread_t t1[NUM_THREADS] = {0};\n\nvoid launch(pthread_t *t, void *(*fn)(void *), void *arg)\n{\n    pthread_create(t,NULL,fn,arg);\n}\n\nvoid *threadfn(void *p)\n{\n    return NULL;\n}\n\nint main()\n{\n    int i;\n    for (i = 0; i &lt; NUM_THREADS; ++i) {\n        launch(t1 + i, threadfn, NULL);\n    }\n    for (i = 0; i &lt; NUM_THREADS; ++i) {\n        pthread_detach(t1[i]);\n    }\n    pthread_exit(NULL);\n}\n</code></pre>\n\n<p>If you add another pthread_create() call after any of the pthread_detach() calls then the race condition re-appears. This leaves me feeling like it's impossible to use pthread_detach() and subsequently use pthread_create() without causing data races.</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1568143684, "post_id": 57877063, "comment_id": 102178957, "body": "C11 draft standard n1570: <i>6.4.5 String literals 7 It is unspecified whether these arrays are distinct provided their elements have the appropriate values. If the program attempts to modify such an array, the behavior is undefined.</i> C99 draft standard n1256: <i>6.4.5 String literals 6 It is unspecified whether these arrays are distinct provided their elements have the appropriate values. If the program attempts to modify such an array, the behavior is undefined.</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1568144353, "post_id": 57877063, "comment_id": 102179224, "body": "The rules for this sort of comparison are essentially independent of the version of C.  For comparing strings with unequal content, the result is guaranteed to be unequal; if the content is equal, it is unspecified whether they reference the same locations or not, so the result could be equal or unequal \u2014 both are acceptable, and reliable code cannot rely on either result."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568143805, "post_id": 57877132, "comment_id": 102179009, "body": "It won&#39;t be implementation defined, it would be unspecified."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568143880, "post_id": 57877132, "comment_id": 102179044, "body": "@SergeyA Yes, just found the relevant passage.  Updated."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1568154530, "post_id": 57877132, "comment_id": 102182466, "body": "I&#39;d say the comparison is unspecified if the contents of the two literals is the same. If the contents differ, the comparison must return a false value. So you cannot get a false positive from the comparison, a fact which might be useful."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1568203499, "post_id": 57877132, "comment_id": 102199142, "body": "@rici <code>&quot;p&quot; == &quot;p\\0q&quot;</code> may return true I think"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1568209022, "post_id": 57877132, "comment_id": 102202377, "body": "@L.F.: <code>strcmp</code> would return equality in that case. So true would be correct, if it happened."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1568144457, "last_edit_date": 1568144457, "creation_date": 1568143713, "answer_id": 57877132, "question_id": 57877063, "link": "https://stackoverflow.com/questions/57877063/result-of-comparing-hardcoded-strings-with/57877132#57877132", "title": "Result of comparing hardcoded strings with ==", "body": "<p>It is unspecified whether or not two string constants with the same content point to the same object.  Section 6.4.5p7 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C11 standard</a> regarding string constants states:</p>\n\n<blockquote>\n  <p>It  is  unspecified  whether  these  arrays  are  distinct  provided \n  their  elements  have  the appropriate  values.   If  the  program \n  attempts  to  modify  such  an  array,  the  behavior  is undefined.</p>\n</blockquote>\n\n<p>The actual pointer comparison is valid in either case (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C11 6.5.9p6</a>):</p>\n\n<blockquote>\n  <p>Two pointers compare equal if and only if both are null pointers,\n  both are pointers to the same object (including a pointer to an object\n  and a subobject at its beginning) or function, both are pointers to\n  one past the last element of the same array object, or one is a\n  pointer to one past the end of one array object and the other is a\n  pointer to the start of a different array  object  that  happens  to \n  immediately  follow  the  first  array  object  in  the  address\n  space.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 2, "last_activity_date": 1568143876, "last_edit_date": 1568143876, "creation_date": 1568143771, "answer_id": 57877141, "question_id": 57877063, "link": "https://stackoverflow.com/questions/57877063/result-of-comparing-hardcoded-strings-with/57877141#57877141", "title": "Result of comparing hardcoded strings with ==", "body": "<p>From C standard, 6.4.5 \"String literals\", item 6:</p>\n\n<blockquote>\n  <p>It is unspecified whether these [string literals] arrays are distinct provided their\n  elements have the appropriate values.</p>\n</blockquote>\n\n<p>That means, result of this comparison is unspecified.</p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1568146164, "creation_date": 1568146164, "answer_id": 57877590, "question_id": 57877063, "link": "https://stackoverflow.com/questions/57877063/result-of-comparing-hardcoded-strings-with/57877590#57877590", "title": "Result of comparing hardcoded strings with ==", "body": "<p>Since the question specifically sought advice on C99 (not C17), relevant quotes from the 1999 C standard follow;</p>\n\n<p>Section 6.4.5 \"String Literals\", para 6 says</p>\n\n<blockquote>\n  <p>It is unspecified whether these arrays are distinct provided their elements have the\n  appropriate values. If the program attempts to modify such an array, the behavior is\n  undefined.</p>\n</blockquote>\n\n<p>Section 6.5.2.5 \"Compound literals\", para 8.</p>\n\n<blockquote>\n  <p>String literals, and compound literals with const-qualified types, need not designate\n  distinct objects.</p>\n</blockquote>\n\n<p>The above also refers to footnote 82, which (while informative, not normative) says;</p>\n\n<blockquote>\n  <p>This allows implementations to share storage for string literals and constant compound literals with the same or overlapping representations.</p>\n</blockquote>\n\n<p>Para 14 of the same section also provides an example;</p>\n\n<blockquote>\n  <p>EXAMPLE 6 Like string literals, const-qualified compound literals can be placed into read-only memory and can even be shared. For example,</p>\n\n<pre><code>     (const char []){\"abc\"} == \"abc\"\n</code></pre>\n  \n  <p>might yield 1 if the literals\u2019 storage is shared.</p>\n</blockquote>\n\n<p>Section J.1 (informative) lists a bunch of things that are unspecified in the standard, of which the 14th in the list is</p>\n\n<blockquote>\n  <p>Whether two string literals result in distinct arrays (6.4.5).</p>\n</blockquote>\n\n<p>From all of the above, it is unspecified whether two string literals with equivalent content are distinct.  Two string literals of the form <code>\"abc\"</code> are allowed but not required to be at the same address in memory.   This also means that the result of a (pointer) comparison would be unspecified.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12030490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7913cef85a87b52d56d61264bdd8543?s=128&d=identicon&r=PG&f=1", "display_name": "avolpe98", "link": "https://stackoverflow.com/users/12030490/avolpe98"}, "is_accepted": false, "score": -1, "last_activity_date": 1568189392, "creation_date": 1568189392, "answer_id": 57884809, "question_id": 57877063, "link": "https://stackoverflow.com/questions/57877063/result-of-comparing-hardcoded-strings-with/57884809#57884809", "title": "Result of comparing hardcoded strings with ==", "body": "<p>if you do so:\n<code>\nchar *a = \"1\";\nchar *b =\"1\";\n</code></p>\n\n<p>and then:</p>\n\n<p><code>if(a==b){ DO SOMETHING}</code> HERE you are comparing the address of memory, where the two pointers are stored.</p>\n\n<p>To compare the content of the memory where the variables are stored(and so to compare the value of the 2 variables) you have to do so:</p>\n\n<p><code>if(*a == *b){DO SOMETHING}</code></p>\n\n<p>I hope you mean that</p>\n"}], "owner": {"reputation": 1543, "user_id": 6947337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf5002789a65c778f9f20c5bfa8efee?s=128&d=identicon&r=PG&f=1", "display_name": "rlee827", "link": "https://stackoverflow.com/users/6947337/rlee827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 57877132, "answer_count": 4, "score": 3, "last_activity_date": 1568189392, "creation_date": 1568143415, "question_id": 57877063, "link": "https://stackoverflow.com/questions/57877063/result-of-comparing-hardcoded-strings-with", "title": "Result of comparing hardcoded strings with ==", "body": "<p>The following C code attempts to compare hardcoded strings using <code>==</code>:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n\nbool test_address_aliasing() {\n    const char * a = \"1\";\n    const char * b = \"1\";\n    return a==b;\n}\n</code></pre>\n\n<p>This will compare pointers to <code>a</code> and <code>b</code>, and an optimizing compiler will most likely combine the references to <code>a</code> and <code>b</code> to store them in the same place, thus resulting in <code>a==b</code> being true. However, a compiler is not required to combine references to equivalent strings, so is the actual result implementation defined? (I am most interested in C99 if the answer depends on the version of the C spec.)</p>\n"}, {"tags": ["c", "global"], "comments": [{"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "edited": false, "score": 1, "creation_date": 1568140424, "post_id": 57876451, "comment_id": 102177703, "body": "Note that a C program  start from the <code>main</code> function so any code that is not called from the <code>main</code> directly or indirectly will not be executed."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1568140442, "post_id": 57876451, "comment_id": 102177712, "body": "You can&#39;t have assignments outside of functions, only declarations and definitions."}, {"owner": {"reputation": 123, "user_id": 11953066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef8bb6ee9ad7b88a5c8ad6ca37470d0?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Anwar", "link": "https://stackoverflow.com/users/11953066/ahmad-anwar"}, "reply_to_user": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "edited": false, "score": 0, "creation_date": 1568140546, "post_id": 57876451, "comment_id": 102177748, "body": "@AbdelfettahBesbes I understand that, however typing printf(&quot;test&quot;); instead of the function call gives an error, while the function call does not."}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "edited": false, "score": 0, "creation_date": 1568140681, "post_id": 57876451, "comment_id": 102177805, "body": "<a href=\"https://stackoverflow.com/questions/26195619/why-are-we-not-allowed-to-have-assignment-statements-in-the-file-scope-in-c\" title=\"why are we not allowed to have assignment statements in the file scope in c\">stackoverflow.com/questions/26195619/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1568140785, "post_id": 57876451, "comment_id": 102177852, "body": "<code>test();</code> is outside of <code>main()</code> so it is not executable (or compilable) code. Move it into <code>main()</code>."}, {"owner": {"reputation": 409, "user_id": 11482040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e97145ede0f79467013cf464db3308?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Sanson", "link": "https://stackoverflow.com/users/11482040/andr%c3%a9-sanson"}, "edited": false, "score": 0, "creation_date": 1568142261, "post_id": 57876451, "comment_id": 102178407, "body": "Most programming languages won&#39;t let you write code outside of a function."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 409, "user_id": 11482040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e97145ede0f79467013cf464db3308?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Sanson", "link": "https://stackoverflow.com/users/11482040/andr%c3%a9-sanson"}, "edited": false, "score": 0, "creation_date": 1568143607, "post_id": 57876451, "comment_id": 102178914, "body": "@Andr&#233;Sanson \u2014 but there are exceptions, such as shell, Perl, Python, \u2026"}], "answers": [{"comments": [{"owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "edited": false, "score": 2, "creation_date": 1568141945, "post_id": 57876555, "comment_id": 102178289, "body": "In case 4 he is not calling test at all! He is declaring the function test (right after it definition)."}], "tags": [], "owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "is_accepted": false, "score": 3, "last_activity_date": 1568142215, "last_edit_date": 1568142215, "creation_date": 1568140751, "answer_id": 57876555, "question_id": 57876451, "link": "https://stackoverflow.com/questions/57876451/global-section-rules-in-c/57876555#57876555", "title": "Global Section Rules In C", "body": "<p><strong>case 1:</strong></p>\n\n<ul>\n<li>because you're doing assignment outside of function.</li>\n</ul>\n\n<p><strong>case 2:</strong></p>\n\n<ul>\n<li>because you're doing assignment outside of function.</li>\n</ul>\n\n<p><strong>case 3:</strong></p>\n\n<ul>\n<li>because you're doing assignment outside of function.</li>\n<li>The first assignment is considered as initialization that's why it's fine.</li>\n</ul>\n\n<p><strong>case 4:</strong></p>\n\n<ul>\n<li>because you're just declaring <code>test()</code> function again with different signature if the default is not <code>int</code>.</li>\n<li>and, You're not calling <code>test()</code> from the <code>main</code> function.</li>\n</ul>\n\n<pre><code>int test(void)\n{\n  printf(\"test\");\n  return 0; // it can cause a warning if missing\n}\n\nint main()\n{\n    printf(\"Hello World\");\n    test();\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1568141828, "creation_date": 1568141828, "answer_id": 57876772, "question_id": 57876451, "link": "https://stackoverflow.com/questions/57876451/global-section-rules-in-c/57876772#57876772", "title": "Global Section Rules In C", "body": "<p>The \"global\" section is actually compiled into a segment in the binary executable that is then loaded into memory when you program runs.</p>\n\n<p>The exact details of how it works depend on the specific OS you build for, but basically, the only thing that you can do in the global section is declare or define initialized or uninitialized variables.</p>\n\n<p>In your <strong>case 1</strong> you fist define an initialized global variable <code>a</code>, but then you try to assign a <em>new</em> value to it.</p>\n\n<p>This is actual code that needs to run after the program is loaded, so it has to be inside a function!</p>\n\n<p>Your <strong>case 2</strong> is almost same as one: you define 2 uninitialized global variables, but then you add code to manipulate them.\nThis code has to be inside a function!</p>\n\n<p><strong>case 3</strong> is more interesting:<br>\nIf you try to compile it, you should get warnings like this:</p>\n\n<pre><code>warning: data definition has no type or storage class a = 4;\nwarning: type defaults to \u2018int\u2019 in declaration of \u2018a\u2019 [-Wimplicit-int]\n</code></pre>\n\n<p>The compiler thinks you are defining a variable without a type, but with a value, so it assigns a default type of <code>int</code> to it.</p>\n\n<p>Notice this will also work:</p>\n\n<pre><code>int a;\nint a = 4;\n</code></pre>\n\n<p>And will remove the warnings.</p>\n\n<p>The compiler will treat the first line as declaration only (an intent to have a variable named <code>a</code>, but not the actual variable) and the second line will be the actual definition, creating the variable and initializing it with value 4.</p>\n\n<p>Keep in mind, that in C, initializing a variable, and assigning value to it are two slightly different things with different rules.</p>\n\n<p>Finally <strong>case 4</strong> is very simple:<br>\n\"test\" is not printed because you never call the function <code>test()</code>.</p>\n\n<pre><code>int test(void)\n{printf(\"test\");}\ntest();\n</code></pre>\n\n<p>This code is same as this code:</p>\n\n<pre><code>int test(void);\n\nint main() {\n    ...\n}\n\nint test(void)\n{\n    printf(\"test\");\n}\n</code></pre>\n\n<p>What you did with the last line in you example is simply declare a function.\nYou told the compiler that somewhere in your code exists a function named <code>test</code> that expects no parameters and returns an integer value. (if you do not specify return type for function C default to <code>int</code>!)</p>\n\n<p>Anything you write int the global scope the compiler will try to interpret as a declaration (you tell the compiler something exists) or a definition (you tell the compiler what something is).</p>\n\n<p>If it can not interpret your statement this way you will get a compilation error.</p>\n\n<p>You can not run code from global scope in C.</p>\n"}], "owner": {"reputation": 123, "user_id": 11953066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef8bb6ee9ad7b88a5c8ad6ca37470d0?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Anwar", "link": "https://stackoverflow.com/users/11953066/ahmad-anwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1568148227, "answer_count": 2, "score": 0, "last_activity_date": 1568142215, "creation_date": 1568140246, "last_edit_date": 1568140416, "question_id": 57876451, "link": "https://stackoverflow.com/questions/57876451/global-section-rules-in-c", "closed_reason": "Duplicate", "title": "Global Section Rules In C", "body": "<p>I have some questions about global section rules in C, I'll state my question in cases.</p>\n\n<p><strong>Case 1</strong>: Why is this not allowed, says redefinition.</p>\n\n<pre><code>int a = 4;\na = 5;\n\nint main()\n{\n    printf(\"Hello World\");\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Case 2</strong>: Why is this not allowed.</p>\n\n<pre><code>int a;\nint b;\na = b;\n\nint main()\n{\n    printf(\"Hello World\");\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Case 3</strong>: Why is this not allowed.</p>\n\n<pre><code>int a;\na = 4;\na = 5;//if this is removed, it works fine\n\nint main()\n{\n    printf(\"Hello World\");\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Case 4</strong>: Why is this allowed, but test is not printed.</p>\n\n<pre><code>int test(void)\n{printf(\"test\");}\ntest();\nint main()\n{\n    printf(\"Hello World\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "depth-first-search"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568138683, "post_id": 57876025, "comment_id": 102176992, "body": "<code>node-&gt;visited = 1;</code> - what if <code>node</code> is <code>NULL</code>? I get a stack overflow with your code."}, {"owner": {"reputation": 61, "user_id": 11530218, "user_type": "registered", "profile_image": "https://graph.facebook.com/2912589708766340/picture?type=large", "display_name": "Nick Steen", "link": "https://stackoverflow.com/users/11530218/nick-steen"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568138994, "post_id": 57876025, "comment_id": 102177126, "body": "okay so I should add in &amp;&amp; node!=NULL?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1568141763, "post_id": 57876025, "comment_id": 102178209, "body": "OT: regarding statements like: <code>struct AdjListNode* newNode =       (struct AdjListNode*) malloc(sizeof(struct AdjListNode));</code>  In C, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc Suggest removing that cast"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568141830, "post_id": 57876025, "comment_id": 102178237, "body": "you mention some &#39;pseudo&#39; code, but you did not post it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568142073, "post_id": 57876025, "comment_id": 102178338, "body": "when asking a question about a run time problem, as this question is doing, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it.   The posted code does not compile!  amongst other things, it is missing the necessary <code>#include</code> statements for the needed header file(s)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568143152, "post_id": 57876025, "comment_id": 102178753, "body": "the function: <code>newAdjListNode()</code> is called twice in the posted code, but never defined"}], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1568143387, "post_id": 57876947, "comment_id": 102178830, "body": "For a directed graph you want to know if both the node and the segment have been visited. This is useful for setting an augmenting path for instance. And the structure are a suggestion."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1568143929, "post_id": 57876947, "comment_id": 102179062, "body": "if you put the visit(node) inside the if (do_dfs().. == 1); then the output will be the reversed path from root to goal..."}, {"owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "edited": false, "score": 0, "creation_date": 1568144604, "post_id": 57876947, "comment_id": 102179320, "body": "Indeed. The path might (and most likely will) use the same node several time. Technically each &quot;directed&quot; path is only take once. But this is probably not the expected solution."}, {"owner": {"reputation": 61, "user_id": 11530218, "user_type": "registered", "profile_image": "https://graph.facebook.com/2912589708766340/picture?type=large", "display_name": "Nick Steen", "link": "https://stackoverflow.com/users/11530218/nick-steen"}, "edited": false, "score": 0, "creation_date": 1568146524, "post_id": 57876947, "comment_id": 102180081, "body": "thanks for the improvement! I also have another question. The first vertex is not being printed in this function. After tracing the code, it shiould be printed, but it is not. Do you have any suggestions for this?"}, {"owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "edited": false, "score": 0, "creation_date": 1568147568, "post_id": 57876947, "comment_id": 102180503, "body": "Well, your first vertex is the link between your starting point and the first printed point. So printing your starting point before starting the recursion should do the trick. But keep in mind that I did not fix the algorithm in the second part, merely the segfault."}], "tags": [], "owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "is_accepted": false, "score": 0, "last_activity_date": 1568144662, "last_edit_date": 1568144662, "creation_date": 1568142786, "answer_id": 57876947, "question_id": 57876025, "link": "https://stackoverflow.com/questions/57876025/depth-first-search-with-a-goal-state/57876947#57876947", "title": "Depth First Search with a goal state", "body": "<p>Regarding your program, you are running a recursive function without a explicit stop condition. Regarding your algorithm, I think you are not actually checking the node, but the directed segment to the node being visited. This is confusing.</p>\n\n<p>First, the algorithm:</p>\n\n<pre><code>struct AdjListNode \n{ \n    int dest;\n    int visited;\n    struct AdjListNode* next; \n}; \n</code></pre>\n\n<p>You should probably replaced dest by a pointer to a structure node. Each segment might share this pointer, and you could set this structure to visited.</p>\n\n<pre><code>struct node\n{\n   int value;\n   int visited;\n}\n\nstruct AdjListNode \n{ \n    struct node *dest;\n    int visited;\n    struct AdjListNode* next; \n}; \n</code></pre>\n\n<p>And now, your segfault:</p>\n\n<p>This reworked version of your algorithm should solve this issue. Note that I did not integrate the change I suggested in the previous section.</p>\n\n<pre><code>void visit(struct AdjListNode* node){\n    printf(\"\\n%5d:%d\", node-&gt;dest, node-&gt;visited);\n}\n\nint do_dfs(struct AdjList list, int goal, int no_vertices,struct Graph* graph){\n\n    struct AdjListNode* node = list.head;\n    while(node){\n        if (node-&gt;dest == goal)\n        {\n            visit(node);\n            printf(\"\\ndone\\n\");\n            return (1);\n        }\n        if(node-&gt;visited != 1){\n            visit(node);\n            node-&gt;visited = 1;\n            if (do_dfs(graph-&gt;array[node-&gt;dest], goal, no_vertices, graph) == 1)\n              return (1);\n        }\n        node = node-&gt;next;\n    }\n    return (0);\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11530218, "user_type": "registered", "profile_image": "https://graph.facebook.com/2912589708766340/picture?type=large", "display_name": "Nick Steen", "link": "https://stackoverflow.com/users/11530218/nick-steen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1568144662, "creation_date": 1568138101, "question_id": 57876025, "link": "https://stackoverflow.com/questions/57876025/depth-first-search-with-a-goal-state", "title": "Depth First Search with a goal state", "body": "<p>I am trying to implement depth first search on a simple graph that looks like this:</p>\n\n<pre><code>10\n4 8 10\n9 6 10 7 2\n1 6 2 3 7\n7 2 9 1 5\n3 6 1 5\n8 5 4\n5 3 8 7\n6 1 3 9\n2 7 1 9\n10 4 9\n</code></pre>\n\n<p>The first line is the number of vertices, and the other lines show the adjacency matrix.</p>\n\n<p>I have code that puts the graph into an adjacency matrix. That code looks like this:</p>\n\n<pre><code>\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// A structure to represent an adjacency list node \nstruct AdjListNode \n{ \n    int dest;\n    int visited;\n    struct AdjListNode* next; \n}; \n\n// A structure to represent an adjacency list \nstruct AdjList \n{ \n    struct AdjListNode *head;  \n}; \n\nstruct Graph \n{ \n    int V;\n    int dest;\n\n    struct AdjList* array; \n}; \n\n// A utility function to create a new adjacency list node \nstruct AdjListNode* newAdjListNode(int dest) \n{ \n    struct AdjListNode* newNode = \n     (struct AdjListNode*) malloc(sizeof(struct AdjListNode)); \n    newNode-&gt;dest = dest; \n    newNode-&gt;visited = 0;\n    newNode-&gt;next = NULL; \n    return newNode; \n} \n\nstruct Graph* createGraph(int V) \n{ \n    struct Graph* graph =  \n        (struct Graph*) malloc(sizeof(struct Graph)); \n    graph-&gt;V = V; \n\n    // Create an array of adjacency lists.  Size of  \n    // array will be V \n    graph-&gt;array =  \n      (struct AdjList*) malloc(V * sizeof(struct AdjList)); \n\n    // Initialize each adjacency list as empty by  \n    // making head as NULL \n    int i; \n    for (i = 0; i &lt; V; ++i) \n        graph-&gt;array[i].head = NULL; \n\n    return graph; \n} \n\n// Adds an edge to an undirected graph \nvoid addEdge(struct Graph* graph, int src, int dest) \n{ \n    // Add an edge from src to dest.  A new node is  \n    // added to the adjacency list of src.  The node \n    // is added at the begining \n    struct AdjListNode* newNode = newAdjListNode(dest); \n    newNode-&gt;next = graph-&gt;array[src].head; \n    graph-&gt;array[src].head = newNode; \n\n\n    /*\n\n    // Since graph is undirected, add an edge from \n    // dest to src also \n    newNode = newAdjListNode(src); \n    newNode-&gt;next = graph-&gt;array[dest].head; \n    graph-&gt;array[dest].head = newNode; \n    */\n}\n\n// A utility function to print the adjacency list  \n// representation of graph \nvoid printGraph(struct Graph* graph) \n{ \n    int v; \n    for (v = 0; v &lt; graph-&gt;V; ++v) \n    { \n        struct AdjListNode* pCrawl = graph-&gt;array[v].head; \n        printf(\"\\n Adjacency list of vertex %d\\n head \", v); \n        while (pCrawl) \n        { \n            printf(\"-&gt; %d\", pCrawl-&gt;dest); \n            pCrawl = pCrawl-&gt;next; \n        } \n        printf(\"\\n\"); \n    } \n} \n\nint main()  \n{\n\n   char c[1000];\n   FILE *fptr;\n\n\n  if ((fptr = fopen(\"/path/to/file/small_graph.txt\", \"r\")) == NULL)\n  {\n        printf(\"Error! opening file\");\n        // Program exits if file pointer returns NULL.\n        exit(1);         \n  }\n\n   fscanf(fptr, \"%[^\\n]\",c);\n   printf(\"\\n %s\",c);\n\n   int no_vertices = atoi(c);\n   no_vertices = no_vertices+1;\n\n   struct Graph* graph =createGraph(no_vertices);\n\n   const size_t line_size = 300;\n   char* line = malloc(line_size);\n\n   for(int i = 0; i&lt;=no_vertices; i++){\n        //fscanf(fptr,\"%[^\\n]\",c);\n        //printf(\"\\n %s\", c);\n\n        fgets(line, line_size, fptr);\n        printf(line);\n        char* token = strtok(line, \" \");\n        int start_vertex = atoi(token);\n        while (token){\n            printf(\"token: %s\\n\", token);\n            token = strtok(NULL,  \" \");\n            if(token != NULL){\n                int dest_vertex = atoi(token);\n                addEdge(graph, start_vertex, dest_vertex);\n            }\n\n\n        }\n   }\n   printGraph(graph);\n   //set_mark_to_zero(graph,2);\n   do_dfs(graph-&gt;array[1],5,10,graph);\n   return 0;\n}\n</code></pre>\n\n<p>The issue that I'm running into is with my searching algorithm. I followed the pseudocode pretty accurately I'd say and I've implemented the following function:</p>\n\n<pre><code>void visit(struct AdjListNode* node){\n    printf(\"\\n%5d\", node-&gt;dest);\n}\nvoid do_dfs(struct AdjList list, int goal, int no_vertices,struct Graph* graph){\n\n    struct AdjListNode* node = list.head;\n    node-&gt;visited = 1;\n    visit(node);\n    while(node-&gt;dest != goal){\n        if(node-&gt;visited != 1){\n            do_dfs(graph-&gt;array[node-&gt;dest], goal, no_vertices, graph);\n        }\n        node = node-&gt;next;\n    }\n\n\n}\n</code></pre>\n\n<p>The issue is that I get a seg fault and the graph just repeats the same answers. Is there a way to fix this so that depth first search works without seg faulting? The algorithm is only repeating the values 7,5,9 over and over again. Any help would be appreciated.</p>\n"}, {"tags": ["c", "raspberry-pi3", "pwm"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1568145278, "post_id": 57875815, "comment_id": 102179603, "body": "What the operating system is this for?"}, {"owner": {"reputation": 115, "user_id": 4341927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S0xy3.png?s=128&g=1", "display_name": "Jablondyn", "link": "https://stackoverflow.com/users/4341927/jablondyn"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1568232519, "post_id": 57875815, "comment_id": 102213533, "body": "Linux raspberrypi 4.19.66"}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 4341927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S0xy3.png?s=128&g=1", "display_name": "Jablondyn", "link": "https://stackoverflow.com/users/4341927/jablondyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1568736475, "creation_date": 1568736475, "answer_id": 57978161, "question_id": 57875815, "link": "https://stackoverflow.com/questions/57875815/raspberry-pi-3-pwm-led-pulse/57978161#57978161", "title": "Raspberry Pi 3 PWM Led Pulse", "body": "<p>This is stupid, but after checking the math, code, wiring I discovered that app needs to be run with root privileges to have on-board access to the pins. It works fine. Topic can be closed.</p>\n"}], "owner": {"reputation": 115, "user_id": 4341927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S0xy3.png?s=128&g=1", "display_name": "Jablondyn", "link": "https://stackoverflow.com/users/4341927/jablondyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568736475, "creation_date": 1568136970, "question_id": 57875815, "link": "https://stackoverflow.com/questions/57875815/raspberry-pi-3-pwm-led-pulse", "title": "Raspberry Pi 3 PWM Led Pulse", "body": "<p>I want to control LED diod with PWM using bcm2835.h and pure C langueage. My code does not work. What am I missing?</p>\n\n<p>I have tried \"gpio\" console command and it works fine, so I know that led is connected to the right ports. I can turn it on using console command:</p>\n\n<pre><code>gpio pwm 1 1024\n</code></pre>\n\n<p><br> My code:</p>\n\n<pre><code>    #include &lt;bcm2835.h&gt;\n    #include &lt;stdio.h&gt;\n\n    // PWM output on RPi Plug P1 pin 12 (which is GPIO pin 18) in alt fun 5.\n    // Note that this is the _only_ PWM pin available on the RPi IO headers\n    #define PIN RPI_GPIO_P1_12\n\n    // and it is controlled by PWM channel 0\n    #define PWM_CHANNEL 0\n\n    // This controls the max range of the PWM signal\n    #define RANGE 1024\n\n\n    int main(int argc, char **argv)\n    {\n        if (!bcm2835_init())\n        {\n            return 1;\n        }\n\n        // Set the output pin to Alt Fun 5, to allow PWM channel 0 to be output there\n        bcm2835_gpio_fsel(PIN, BCM2835_GPIO_FSEL_ALT5);\n\n        // Clock divider is set to 16.\n        // With a divider of 16 and a RANGE of 1024, in MARKSPACE mode,\n        // the pulse repetition frequency will be\n        // 1.2MHz/1024 = 1171.875Hz, suitable for driving a DC motor with PWM\n        bcm2835_pwm_set_clock(BCM2835_PWM_CLOCK_DIVIDER_16);\n\n        bcm2835_pwm_set_mode(PWM_CHANNEL, 1, 1);\n\n        bcm2835_pwm_set_range(PWM_CHANNEL, RANGE);\n\n        while(1)\n        {\n            bcm2835_pwm_set_data(PWM_CHANNEL, 1024);\n            bcm2835_delay(10);\n        }\n\n\n        bcm2835_close();\n        return 0;\n    }\n</code></pre>\n\n<p>I expect that my LED will turn on.</p>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1568137062, "post_id": 57875804, "comment_id": 102176352, "body": "See <a href=\"https://stackoverflow.com/questions/13431108/changing-address-contained-by-pointer-using-function\" title=\"changing address contained by pointer using function\">stackoverflow.com/questions/13431108/&hellip;</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568143590, "post_id": 57875804, "comment_id": 102178909, "body": "The posted code does not compile!  mainly because the needed header files: <code>stdio.h</code> and <code>stdlib.h</code> have not been included"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568143685, "post_id": 57875804, "comment_id": 102178958, "body": "We cannot reproduce the problem without a <code>main()</code> function, which is missing from the posted code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568143995, "post_id": 57875804, "comment_id": 102179097, "body": "OT: regarding this kind of statement: <code>x=(int**)malloc(m*sizeof(int*));</code>  1) in C, the returned type is <code>void *</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc  2)  always check (!=NULL) the returned value to assure the operation was successful.  3) the function is expecting a parameter of type <code>size_t</code>, but the &#39;m&#39; is an <code>int</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568144380, "post_id": 57875804, "comment_id": 102179233, "body": "OT: regarding: <code>scanf(&quot;%d&quot;,&amp;x[i][j]);</code>  Always check the returned value (not the parameter values) to assure the operation was successful.  Note: any returned value other than the number of &#39;input format conversion specifiers&#39; indicates an error.  Suggest: <code>if( scanf(&quot;%d&quot;,&amp;x[i][j]) != 1 ) { &#47;&#47; handle error }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568144649, "post_id": 57875804, "comment_id": 102179340, "body": "OT: it is good programming practice to limit the scope of variables. so in the function: <code>output()</code>  the variables: <code>i</code> and <code>j</code> should be defined in the &#39;for()` code blocks.  I.E.  <code>if( int i=0; i&lt;m; i++ )</code>"}], "answers": [{"tags": [], "owner": {"reputation": 592, "user_id": 6022626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TE4SgJMzh3g/AAAAAAAAAAI/AAAAAAAAAE4/BpGV2AGlUG0/photo.jpg?sz=128", "display_name": "Suraj", "link": "https://stackoverflow.com/users/6022626/suraj"}, "is_accepted": true, "score": 1, "last_activity_date": 1568140656, "creation_date": 1568140656, "answer_id": 57876532, "question_id": 57875804, "link": "https://stackoverflow.com/questions/57875804/why-is-my-code-unable-to-access-the-elements-of-a-matrix-through-my-functions/57876532#57876532", "title": "Why is my code unable to access the elements of a matrix through my functions?", "body": "<p>When you pass a pointer to a function, you are basically passing the address of a variable. In your case, you're allocating memory inside the function which means the variable is assigned new memory space, thereby the address of the variable also changes which you do not have access to outside the function unless you return it.</p>\n\n<p>If you're allocating memory to a pointer variable inside the function, then there's no point in passing the pointer to the function. You can just declare and initialise a pointer within your function and return it.</p>\n"}], "owner": {"reputation": 15, "user_id": 11216033, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cqyNz0FgYns/AAAAAAAAAAI/AAAAAAAAABc/qWwwINo2S-E/photo.jpg?sz=128", "display_name": "Sreya Salil", "link": "https://stackoverflow.com/users/11216033/sreya-salil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1568144101, "accepted_answer_id": 57876532, "answer_count": 1, "score": 1, "last_activity_date": 1568140656, "creation_date": 1568136946, "question_id": 57875804, "link": "https://stackoverflow.com/questions/57875804/why-is-my-code-unable-to-access-the-elements-of-a-matrix-through-my-functions", "closed_reason": "Duplicate", "title": "Why is my code unable to access the elements of a matrix through my functions?", "body": "<p>I was developing code to accept two matrices, dynamically allocate memory for them and display their sum using functions. Declaring the return types of my input,output and sum functions as 'void' resulted in a segmentation error, but, on setting the return type to 'int**' the code worked fine. I want to know what's the difference. Why was my code unable to access the elements of the matrices when the return type of the functions was 'void'? </p>\n\n<p>I thought it should be able to since I had passed the pointer to the matrix as an argument to the function.</p>\n\n<pre><code>//Before changing the return type:\n\nvoid input(int **x,int m,int n){\n    int i,j;\n    x=(int**)malloc(m*sizeof(int*));\n    for(i=0;i&lt;m;i++){\n        x[i]=(int*)malloc(n*sizeof(int));\n        for(j=0;j&lt;n;j++){\n            scanf(\"%d\",&amp;x[i][j]);\n        }\n    }\n}\nvoid sum(int **z,int **y,int **x,int m,int n){\n    int i,j;\n    z=(int**)malloc(m*sizeof(int*));\n    for(i=0;i&lt;m;i++){\n        z[i]=(int*)malloc(n*sizeof(int));\n        for(j=0;j&lt;n;j++){\n            z[i][j]=x[i][j]+y[i][j];\n        }\n    }\n}\nvoid output(int **x,int m,int n){\n    int i,j;\n    for(i=0;i&lt;m;i++){\n        for(j=0;j&lt;n;j++){\n            printf(\"%d \",x[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\n\n//After changing the return type:\n\nint** input(int **x,int m,int n){\n    int i,j;\n    x=(int**)malloc(m*sizeof(int*));\n    for(i=0;i&lt;m;i++){\n        x[i]=(int*)malloc(n*sizeof(int));\n        for(j=0;j&lt;n;j++){\n            scanf(\"%d\",&amp;x[i][j]);\n        }\n    }\n    return x;\n}\nint** sum(int **z,int **y,int **x,int m,int n){\n    int i,j;\n    z=(int**)malloc(m*sizeof(int*));\n    for(i=0;i&lt;m;i++){\n        z[i]=(int*)malloc(n*sizeof(int));\n        for(j=0;j&lt;n;j++){\n            z[i][j]=x[i][j]+y[i][j];\n        }\n    }\n    return z;\n}\nvoid output(int **x,int m,int n){\n    int i,j;\n    for(i=0;i&lt;m;i++){\n        for(j=0;j&lt;n;j++){\n            printf(\"%d \",x[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "postgresql", "libpq"], "comments": [{"owner": {"reputation": 35343, "user_id": 435800, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4f40d75bd1227e2a57c77864047cd9f7?s=128&d=identicon&r=PG", "display_name": "Kiril Kirov", "link": "https://stackoverflow.com/users/435800/kiril-kirov"}, "edited": false, "score": 0, "creation_date": 1568135809, "post_id": 57875502, "comment_id": 102175906, "body": "Nothing is lost here, <code>still reachable</code> is perfectly fine. You should only care about <code>definitely lost</code> and <code>indirectly lost</code>. <code>possibly lost</code> is also usually a false alarm."}, {"owner": {"reputation": 13, "user_id": 12048099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80eaba218134e87d327f5ec25480d10?s=128&d=identicon&r=PG&f=1", "display_name": "I_cannot_C", "link": "https://stackoverflow.com/users/12048099/i-cannot-c"}, "reply_to_user": {"reputation": 35343, "user_id": 435800, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4f40d75bd1227e2a57c77864047cd9f7?s=128&d=identicon&r=PG", "display_name": "Kiril Kirov", "link": "https://stackoverflow.com/users/435800/kiril-kirov"}, "edited": false, "score": 0, "creation_date": 1568136733, "post_id": 57875502, "comment_id": 102176235, "body": "@KirilKirov It might be fine, but I&#39;d like to know how come that number&#39;s more than zero. As far as I can tell, everything allocated should have been deallocated."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1568138578, "creation_date": 1568138578, "answer_id": 57876113, "question_id": 57875502, "link": "https://stackoverflow.com/questions/57875502/memory-is-not-freed-when-connection-to-database-is-closed-c-postgres-libpq/57876113#57876113", "title": "Memory is not freed when connection to database is closed (C, postgres - libpq)", "body": "<p>Those allocations were performed during the initialisation of <code>libcrypto</code>, which is used by the postgresql client in order to communicate with the server via SSL/TLS. That initialisation is only done once; it doesn't matter how many connections you open. (However, if the connections use different cyphers, there may be additional initialisations.)</p>\n\n<p>Libcrypto does provide interfaces which can be used to free storage allocated during initialisation. These are documented in the <a href=\"https://wiki.openssl.org/index.php/Libcrypto_API\" rel=\"nofollow noreferrer\">OpenSSL documentation</a>. So you could try adding them to your code. But, honestly, it really doesn't matter except to make the valgrind report clearer. </p>\n"}], "owner": {"reputation": 13, "user_id": 12048099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80eaba218134e87d327f5ec25480d10?s=128&d=identicon&r=PG&f=1", "display_name": "I_cannot_C", "link": "https://stackoverflow.com/users/12048099/i-cannot-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 57876113, "answer_count": 1, "score": 1, "last_activity_date": 1568138578, "creation_date": 1568135586, "question_id": 57875502, "link": "https://stackoverflow.com/questions/57875502/memory-is-not-freed-when-connection-to-database-is-closed-c-postgres-libpq", "title": "Memory is not freed when connection to database is closed (C, postgres - libpq)", "body": "<p>If you create a program with just the following two lines:</p>\n\n<pre><code>PGconn *conn = PQconnectdb(\"user=dbtest password=dbtest dbname=testdb host=localhost port=5432\");\nPQfinish(conn);\n</code></pre>\n\n<p>And run it through valgrind like so:</p>\n\n<pre><code>valgrind --leak-check=full --show-leak-kinds=all ./program\n</code></pre>\n\n<p>You see this:</p>\n\n<pre><code>==25388== Memcheck, a memory error detector\n==25388== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==25388== Using Valgrind-3.14.0 and LibVEX; rerun with -h for copyright info\n==25388== Command: ./program\n==25388== \n==25388== \n==25388== HEAP SUMMARY:\n==25388==     in use at exit: 109 bytes in 2 blocks\n==25388==   total heap usage: 6,948 allocs, 6,946 frees, 666,147 bytes allocated\n==25388== \n==25388== 13 bytes in 1 blocks are still reachable in loss record 1 of 2\n==25388==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==25388==    by 0x4CB0635: CRYPTO_strdup (in /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1)\n==25388==    by 0x4BD8AFB: BIO_meth_new (in /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1)\n==25388==    by 0x488BE8B: ??? (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x488D19C: ??? (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x487507F: PQconnectPoll (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x4875E3E: ??? (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x4878CD7: PQconnectdb (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x109158: main (in /workspace/test/src/program)\n==25388== \n==25388== 96 bytes in 1 blocks are still reachable in loss record 2 of 2\n==25388==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==25388==    by 0x4CA70E8: CRYPTO_zalloc (in /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1)\n==25388==    by 0x4BD8ADF: BIO_meth_new (in /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1)\n==25388==    by 0x488BE8B: ??? (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x488D19C: ??? (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x487507F: PQconnectPoll (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x4875E3E: ??? (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x4878CD7: PQconnectdb (in /usr/lib/x86_64-linux-gnu/libpq.so.5.11)\n==25388==    by 0x109158: main (in /workspace/test/src/program)\n==25388== \n==25388== LEAK SUMMARY:\n==25388==    definitely lost: 0 bytes in 0 blocks\n==25388==    indirectly lost: 0 bytes in 0 blocks\n==25388==      possibly lost: 0 bytes in 0 blocks\n==25388==    still reachable: 109 bytes in 2 blocks\n==25388==         suppressed: 0 bytes in 0 blocks\n==25388== \n==25388== For counts of detected and suppressed errors, rerun with: -v\n==25388== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>I noticed that opening and closing more connections doesn't seem to affect the amount of bytes lost or still reachable.</p>\n\n<p>I'm not very familiar with C, so I have to ask:</p>\n\n<p>How come there's bytes still reachable? I would expect everything to be deallocated when I close the connection to the database.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 443, "user_id": 9063850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671893f704960bd2d8c8f4834e105dd4?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d0\u05d9\u05ea\u05df \u05dc\u05d5\u05d9", "link": "https://stackoverflow.com/users/9063850/%d7%90%d7%99%d7%aa%d7%9f-%d7%9c%d7%95%d7%99"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568135971, "post_id": 57875468, "comment_id": 102175948, "body": "@chux Amazon is the name of a pointer to amazon_t"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1568136200, "post_id": 57875468, "comment_id": 102176045, "body": "OK.    Posting a description of code &quot;Note: Amazon is the name of a pointer to amazon_t&quot; is not as clear as posting code <code>typedef .... Amazon;</code>."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568137067, "post_id": 57875468, "comment_id": 102176353, "body": "Because products differ from each other and need a different copy function. If all products were the same, you would need one copy function."}, {"owner": {"reputation": 443, "user_id": 9063850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671893f704960bd2d8c8f4834e105dd4?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d0\u05d9\u05ea\u05df \u05dc\u05d5\u05d9", "link": "https://stackoverflow.com/users/9063850/%d7%90%d7%99%d7%aa%d7%9f-%d7%9c%d7%95%d7%99"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1568137895, "post_id": 57875468, "comment_id": 102176685, "body": "@KamilCuk it is stated that all the products are from the same type."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1568145210, "post_id": 57875468, "comment_id": 102179565, "body": "Why does every <code>product_info_t</code> have a copy of <code>copy</code> and <code>free</code>; shouldn&#39;t we use one virtual table for each object?"}, {"owner": {"reputation": 443, "user_id": 9063850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671893f704960bd2d8c8f4834e105dd4?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d0\u05d9\u05ea\u05df \u05dc\u05d5\u05d9", "link": "https://stackoverflow.com/users/9063850/%d7%90%d7%99%d7%aa%d7%9f-%d7%9c%d7%95%d7%99"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1568150317, "post_id": 57875468, "comment_id": 102181364, "body": "@NeilEdelman This is what I&#39;m asking. My professor insists this is the way it is supposed to be done. I am yet to understand why."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1568237604, "post_id": 57875468, "comment_id": 102215169, "body": "If the user supplies the virtual functions every time a new product is created, then they should be with the product, but what does that mean exactly? a new product type, or an individual product? I think it&#39;s unclear whether that&#39;s <code>amazon_t</code> or <code>product_info_t</code>; is <code>amazon_t</code> the product type or the whole database? What is up with the member <code>void *product</code>? If <code>amazon_t</code> and <code>product_info_t</code> have the same virtual functions, I would ask what is meant by that."}], "owner": {"reputation": 443, "user_id": 9063850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671893f704960bd2d8c8f4834e105dd4?s=128&d=identicon&r=PG&f=1", "display_name": "\u05d0\u05d9\u05ea\u05df \u05dc\u05d5\u05d9", "link": "https://stackoverflow.com/users/9063850/%d7%90%d7%99%d7%aa%d7%9f-%d7%9c%d7%95%d7%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568135940, "creation_date": 1568135434, "last_edit_date": 1568135940, "question_id": 57875468, "link": "https://stackoverflow.com/questions/57875468/at-what-cases-should-i-include-functions-for-managing-a-generic-type-in-a-struct", "title": "At what cases should I include functions for managing a generic type in a struct?", "body": "<p>I am quite confused over this. Let me give you an example where my initial guess was wrong.</p>\n\n<p>I have a generic datatype named <code>Amazon</code>, it stores listings of different products that users (identified only by their ID) would like to sell. Each listing contains the ID of the product (unique), the product itself (of generic type and identical for all products in a certain <code>Amazon</code>) and a minimal price.</p>\n\n<p>If a user wants to purchase some product, he adds a bid to an existing list of previous bids. It is important to store previous bids even if the user was outbid. </p>\n\n<p>In case it's not clear, the user supplies a free function and a copy function for the type of the product when the system is created.</p>\n\n<p>My idea for implementing the system was to include three structs:</p>\n\n<pre><code>typedef void* product_type;\ntypedef product_type(*product_type_copy)(product_type);\ntypedef void(*product_type_free)(product_type);\n\nstruct amazon_t{\n    Set listings;\n    product_type_copy copy;\n    product_type_free free;\n};\n\nstruct product_info_t{\n    List bids;\n    int id;\n    int min_price;\n    product_type product;\n};\n\nstruct bid_t{\n    int bidder_id;\n    int bid_sum;\n};\n</code></pre>\n\n<p>Now, when I got my exam back I saw that points were deducted because the struct <code>product_info_t</code> was also supposed to contain the copy function and the free function of the type of the product, like this:</p>\n\n<pre><code>struct product_info_t{\n    List bids;\n    int id;\n    int min_price;\n    product_type product;\n    product_type_copy copy;\n    product_type_free free;\n};\n</code></pre>\n\n<p>I can't understand why this is necessary. Can someone please explain why in this case I am supposed to add the functions to both structs?</p>\n\n<p>Note: <code>Amazon</code> is the name of a pointer to <code>amazon_t</code></p>\n"}, {"tags": ["c", "function", "function-pointers"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 24, "creation_date": 1568136241, "post_id": 57875417, "comment_id": 102176063, "body": "Good question - now don&#39;t ever do this again. :)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 7, "creation_date": 1568137945, "post_id": 57875417, "comment_id": 102176705, "body": "<a href=\"https://cdecl.org/?q=declare+get_pfn+as+function+%28void%29+returning+pointer+to+function+%28int%29+returning+pointer+to+function+%28int%29+returning+void\" rel=\"nofollow noreferrer\">use cdecl</a>"}], "answers": [{"comments": [{"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 2, "creation_date": 1568188315, "post_id": 57875487, "comment_id": 102191399, "body": "The other answers explain it in a better way."}], "tags": [], "owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "is_accepted": false, "score": 1, "last_activity_date": 1568136289, "last_edit_date": 1568136289, "creation_date": 1568135538, "answer_id": 57875487, "question_id": 57875417, "link": "https://stackoverflow.com/questions/57875417/defining-a-function-which-returns-a-function-pointer-which-also-returns-a-functi/57875487#57875487", "title": "Defining a function which returns a function pointer which also returns a function pointer without typedefs", "body": "<p>it's this way:</p>\n\n<pre><code>void (*(*get_pfn_pfn(void))(int))()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 808, "user_id": 5199318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e310ab88ed654014bbd8ff0e9c8e75d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/5199318/jas"}, "edited": false, "score": 0, "creation_date": 1568136142, "post_id": 57875539, "comment_id": 102176019, "body": "Thank you very much Ajay! Your explanation breaking down the steps helped me understand it more easily, but unfortunately the signature did not work sorry :("}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 808, "user_id": 5199318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e310ab88ed654014bbd8ff0e9c8e75d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/5199318/jas"}, "edited": false, "score": 1, "creation_date": 1568136225, "post_id": 57875539, "comment_id": 102176057, "body": "@Jas, sorry I messed up the order of the <code>(int)</code>. I thought your odd even functions take a param int. I will correct it."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 7, "last_activity_date": 1568225101, "last_edit_date": 1568225101, "creation_date": 1568135711, "answer_id": 57875539, "question_id": 57875417, "link": "https://stackoverflow.com/questions/57875417/defining-a-function-which-returns-a-function-pointer-which-also-returns-a-functi/57875539#57875539", "title": "Defining a function which returns a function pointer which also returns a function pointer without typedefs", "body": "<p>The return type of the function <code>get_pfn</code> is - </p>\n\n<pre><code>void (*) ();\n</code></pre>\n\n<p>So type of <code>&amp;get_pfn</code> is - </p>\n\n<pre><code>void (*(*)(int))()\n</code></pre>\n\n<p>Now, this function returns this type, hence its signature will be - </p>\n\n<pre><code>void (*(*(foo)())(int))()\n</code></pre>\n\n<p>You can verify this by typing this in <a href=\"https://cdecl.org/?q=void+%28*%28*%28foo%29%28%29%29%28int%29%29%28%29\" rel=\"nofollow noreferrer\">cdecl.org</a></p>\n"}, {"comments": [{"owner": {"reputation": 808, "user_id": 5199318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e310ab88ed654014bbd8ff0e9c8e75d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/5199318/jas"}, "edited": false, "score": 1, "creation_date": 1568136237, "post_id": 57875584, "comment_id": 102176061, "body": "Thank you so so much Kamil!! I like that broken down/visualized tree like view, it helped make it a lot more understandable :) !!"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 808, "user_id": 5199318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e310ab88ed654014bbd8ff0e9c8e75d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/5199318/jas"}, "edited": false, "score": 1, "creation_date": 1568136327, "post_id": 57875584, "comment_id": 102176092, "body": "@Jas You may like it but I don&#39;t think it is recommended to write code in this manner."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 1, "creation_date": 1568166933, "post_id": 57875584, "comment_id": 102185434, "body": "I wish there was a website that had a GUI representation of a function pointer, let you move various components around, etc. Something like <a href=\"https://nsdateformatter.com\" rel=\"nofollow noreferrer\">nsdateformatter.com</a>"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 21, "last_activity_date": 1568136777, "last_edit_date": 1568136777, "creation_date": 1568135976, "answer_id": 57875584, "question_id": 57875417, "link": "https://stackoverflow.com/questions/57875417/defining-a-function-which-returns-a-function-pointer-which-also-returns-a-functi/57875584#57875584", "title": "Defining a function which returns a function pointer which also returns a function pointer without typedefs", "body": "<p>It has to return a function pointer to a function that takes an <code>int</code> and returns a function pointer:</p>\n\n<pre><code>void (*(*get_pfn_pfn(void))(int))(void) {\n    return &amp;get_pfn;\n}\n</code></pre>\n\n<p>more lines:</p>\n\n<pre><code>void (*\n        (*\n             get_pfn_pfn(void)  // this is our function\n        )(int i) // this is get_pfn(int)\n     )(void)  // this is odd() or even()\n{\n    return &amp;get_pfn;\n}\n</code></pre>\n\n<p>The <code>void</code>s can be omitted, in which case the function pointer points to a function that takes unknown number of parameters. Which is not what you want. To declare a function pointer to a function that takes no arguments, you should add <code>void</code> inside function parameter list. The same way it's best to change <code>get_pfn</code> to <code>void (*get_pfn(int i))(void)</code>. For example try calling from <code>get_pfn(1)(\"some arg\", \"some other arg\");</code>. A C compiler will not give a warning, as empty <code>()</code> denote <em>unknown</em> arguments. To say that function takes no arguments, you have to <code>(void)</code>.</p>\n\n<p>For many the sequences of braces, especially <code>))(</code>, in function pointers are hard to parse. That's why many prefer typedefs for function pointers or types:</p>\n\n<pre><code>typedef void get_pfn_func_t(void);    \nget_pfn_func_t *get_pfn(int i) {\n    return i % 2 == 0 ? &amp;even : &amp;odd;\n}\n\ntypedef get_pfn_func_t *get_pfn_pfn_func_t(int i);\nget_pfn_pfn_func_t *get_pfn_pfn(void) {\n    return &amp;get_pfn;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 7, "last_activity_date": 1568137644, "last_edit_date": 1568137644, "creation_date": 1568136997, "answer_id": 57875822, "question_id": 57875417, "link": "https://stackoverflow.com/questions/57875417/defining-a-function-which-returns-a-function-pointer-which-also-returns-a-functi/57875822#57875822", "title": "Defining a function which returns a function pointer which also returns a function pointer without typedefs", "body": "<p>Function pointers without a <code>typedef</code> can be tricky to work with.  To figure them out, you work from the inside out.</p>\n\n<p>So let's break down exactly how we come up with the correct function signature.</p>\n\n<p><code>get_pfn_pfn</code> is a function:</p>\n\n<pre><code>get_pfn_pfn()\n</code></pre>\n\n<p>Which takes no parameters:</p>\n\n<pre><code>get_pfn_pfn(void)\n</code></pre>\n\n<p>And returns a pointer:</p>\n\n<pre><code>*get_pfn_pfn(void)\n</code></pre>\n\n<p>To a function:</p>\n\n<pre><code>(*get_pfn_pfn(void))()\n</code></pre>\n\n<p>Which takes an <code>int</code> parameter:</p>\n\n<pre><code>(*get_pfn_pfn(void))(int)\n</code></pre>\n\n<p>And returns a pointer:</p>\n\n<pre><code>*(*get_pfn_pfn(void))(int)\n</code></pre>\n\n<p>To a function:</p>\n\n<pre><code>(*(*get_pfn_pfn(void))(int))()\n</code></pre>\n\n<p>Which takes no parameters:</p>\n\n<pre><code>(*(*get_pfn_pfn(void))(int))(void)\n</code></pre>\n\n<p>And returns nothing (i.e. <code>void</code>):</p>\n\n<pre><code>void (*(*get_pfn_pfn(void))(int))(void)\n</code></pre>\n\n<hr>\n\n<p>Of course, using <code>typedef</code>'s simplifies this greatly.</p>\n\n<p>First the type for <code>even</code> and <code>odd</code>:</p>\n\n<pre><code>typedef void (*func1)(void);\n</code></pre>\n\n<p>Which we can then apply to <code>get_pfn</code>:</p>\n\n<pre><code>func1 get_pfn(int) { ... }\n</code></pre>\n\n<p>Then the type for this function:</p>\n\n<pre><code>typedef func1 (*func2)(int);\n</code></pre>\n\n<p>Which we can apply to <code>get_pfn_pfn</code>:</p>\n\n<pre><code>func2 get_pfn_pfn(void) { ... }\n</code></pre>\n"}], "owner": {"reputation": 808, "user_id": 5199318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e310ab88ed654014bbd8ff0e9c8e75d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/5199318/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 5, "accepted_answer_id": 57875584, "answer_count": 4, "score": 20, "last_activity_date": 1568225101, "creation_date": 1568135152, "last_edit_date": 1568169089, "question_id": 57875417, "link": "https://stackoverflow.com/questions/57875417/defining-a-function-which-returns-a-function-pointer-which-also-returns-a-functi", "title": "Defining a function which returns a function pointer which also returns a function pointer without typedefs", "body": "<p>I am trying to really understand function pointers without using <code>typedef</code> but cannot seem to get this. I do not understand what signature is needed to convey that I return a pointer to a pointer to a function.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nvoid odd()  { printf(\"odd!\\n\");  }\nvoid even() { printf(\"even!\\n\"); }\n\nvoid (*get_pfn(int i))()\n{\n    return i % 2 == 0 ? &amp;even : &amp;odd;\n}\n\n__SIGNATURE__\n{\n    return &amp;get_pfn;\n}\n\nint main()\n{\n    get_pfn_pfn()(1)();\n    get_pfn_pfn()(2)();\n    return 0;\n}\n</code></pre>\n\n<p>To make this work, what does <code>__SIGNATURE__</code> have to be?</p>\n"}, {"tags": ["c", "pointers", "strcpy"], "comments": [{"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 3, "creation_date": 1568134626, "post_id": 57875287, "comment_id": 102175449, "body": "We don&#39;t know. Show more context."}, {"owner": {"reputation": 21, "user_id": 12043174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa725233820d239f18abe2bee5b2c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "thesmizzle", "link": "https://stackoverflow.com/users/12043174/thesmizzle"}, "reply_to_user": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1568134828, "post_id": 57875287, "comment_id": 102175536, "body": "which one would you use? if &quot;it depends&quot;, in what depends?"}, {"owner": {"reputation": 21, "user_id": 12043174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa725233820d239f18abe2bee5b2c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "thesmizzle", "link": "https://stackoverflow.com/users/12043174/thesmizzle"}, "reply_to_user": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1568134862, "post_id": 57875287, "comment_id": 102175550, "body": "@Joshua the result is the same, but what&#39;s the difference?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568134897, "post_id": 57875287, "comment_id": 102175570, "body": "The result is not the same. It&#39;s up to you to describe your use-case, not us to list the possible ones."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1568134909, "post_id": 57875287, "comment_id": 102175572, "body": "@thesmizzle It comes down to the details of the application. How long does the string need remain accessible? It&#39;s like the difference between me saying &quot;the document you need is on my desk&quot; or &quot;here&#39;s your own copy of the document&quot;. If I&#39;m sure it will stay on my desk as long as you might possibly need to see it, you don&#39;t need your own copy. If it might not, you do."}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "edited": false, "score": 1, "creation_date": 1568134966, "post_id": 57875287, "comment_id": 102175600, "body": "Note that if you call <code>strcpy</code> without allocation enough memory to the <code>N-&gt;name</code>, a <code>segmentation fault</code> will be thrown."}, {"owner": {"reputation": 21, "user_id": 12043174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa725233820d239f18abe2bee5b2c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "thesmizzle", "link": "https://stackoverflow.com/users/12043174/thesmizzle"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1568134974, "post_id": 57875287, "comment_id": 102175602, "body": "@DavidSchwartz collected in a linked list and deleted if someone from stdin writes the command to delete it. p.s. beautiful explanation"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1568135024, "post_id": 57875287, "comment_id": 102175617, "body": "if you&#39;ve got a linked list then very likely you will use pointers. You will probably either use <code>strcpy</code> or directly read into allocated memory."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1568135025, "post_id": 57875287, "comment_id": 102175618, "body": "@thesmizzle If it is guaranteed to remain valid for as long as any other code might need to see it then a pointer to it is sufficient. If not, then you will need to allocate a separate chunk of memory and copy the string into it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568135057, "post_id": 57875287, "comment_id": 102175631, "body": "If you use <code>N-&gt;name = string;</code>, you need to make sure that there&#39;s a different <code>string</code> for each <code>N</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568135094, "post_id": 57875287, "comment_id": 102175649, "body": "@Barmar And that each <code>string</code> lives as long as <code>N</code> does."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568135124, "post_id": 57875287, "comment_id": 102175665, "body": "The choice probably isn&#39;t between pointers and strcpy, it&#39;s between pointers and arrays, e.g. <code>char name[MAXSIZE];</code>"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "edited": false, "score": 0, "creation_date": 1568135281, "post_id": 57875287, "comment_id": 102175720, "body": "By doing <code>N-&gt;name=string</code> you&#39;re assigning the pointer, so every change to <code>string</code> will also change <code>N-&gt;name</code>, so if you plan to process multiple values then it&#39;s better to use <code>strdup</code> which allocate new memory for N-&gt;name."}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1568137976, "post_id": 57875422, "comment_id": 102176723, "body": "<i>&#39;We don&#39;t like MAXSIZE much anymore&#39;</i> \u2013 unless on micro controllers..."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1568135163, "creation_date": 1568135163, "answer_id": 57875422, "question_id": 57875287, "link": "https://stackoverflow.com/questions/57875287/what-i-should-use-strcpy-or-pointers/57875422#57875422", "title": "What i should use: strcpy or pointers?", "body": "<p>Answering \"the result is the same, but what's the difference?\" (from comment)</p>\n\n<p>Starting from:</p>\n\n<pre><code>N *node = malloc(sizeof(N));\nchar input_from_stdin[80];\n</code></pre>\n\n<p>If we do</p>\n\n<pre><code>strcpy(node-&gt;name, input_from_stdin);\n</code></pre>\n\n<p>we invoke undefined behavior, but it might appear to work.</p>\n\n<p>If we do </p>\n\n<pre><code>node-&gt;name = input_from_stdin;\n</code></pre>\n\n<p>than <code>node-&gt;name</code> only contains its expected value until <code>input_from_stdin</code> is reused, which is typically when the next line is read form input.</p>\n\n<p>If we do</p>\n\n<pre><code>node-&gt;name = malloc(strlen(input_from_stdin) + 1);\nstrcpy(node-&gt;name, input_from_stdin);\n</code></pre>\n\n<p>we make a copy of the input that lives until we free it; but we must remember to free <code>node-&gt;name</code> before freeing <code>node</code>.</p>\n\n<p>We can also do</p>\n\n<pre><code>typedef struct node{\n    char name[MAXSIZE];\n    //etc...\n }N;\n</code></pre>\n\n<p>and then expect</p>\n\n<pre><code>strncpy(node-&gt;name, input_from_stdin, MAXSIZE-1)[MAXSIZE-1] = 0;\n</code></pre>\n\n<p>to work.</p>\n\n<p>Some poeple do</p>\n\n<pre><code>strncpy(node-&gt;name, input_from_stdin, MAXSIZE);\n</code></pre>\n\n<p>which is valid but getting it back out again is touchier. This is rarely seen out of fixed-width records on disk now. We don't like <code>MAXSIZE</code> much anymore and prefer everything stretchy.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 12043174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa725233820d239f18abe2bee5b2c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "thesmizzle", "link": "https://stackoverflow.com/users/12043174/thesmizzle"}, "edited": false, "score": 0, "creation_date": 1568136335, "post_id": 57875631, "comment_id": 102176094, "body": "how would you free the memory after the strdup?"}, {"owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "reply_to_user": {"reputation": 21, "user_id": 12043174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa725233820d239f18abe2bee5b2c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "thesmizzle", "link": "https://stackoverflow.com/users/12043174/thesmizzle"}, "edited": false, "score": 0, "creation_date": 1568136635, "post_id": 57875631, "comment_id": 102176206, "body": "Added an edit with how to free your memory. With a way to avoid double-free if you are going to iterate a lot."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1568145559, "post_id": 57875631, "comment_id": 102179703, "body": "It&#39;s never necessary to check for NULL before calling <code>free()</code> because <code>free()</code> is defined as doing nothing if the argument is NULL."}], "tags": [], "owner": {"reputation": 328, "user_id": 11979706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f60d5f1bab317984fe56dae07757bf?s=128&d=identicon&r=PG&f=1", "display_name": "AugustinLopez", "link": "https://stackoverflow.com/users/11979706/augustinlopez"}, "is_accepted": true, "score": 2, "last_activity_date": 1568136556, "last_edit_date": 1568136556, "creation_date": 1568136155, "answer_id": 57875631, "question_id": 57875287, "link": "https://stackoverflow.com/questions/57875287/what-i-should-use-strcpy-or-pointers/57875631#57875631", "title": "What i should use: strcpy or pointers?", "body": "<p>You want to use a buffer to read your input from stdin. But if you don't make a copy, your string will be lost at the next read iteration. If you are going to allocate memory, and if you don't know the size of the string you receive, you  should use a function like <a href=\"https://linux.die.net/man/3/strdup\" rel=\"nofollow noreferrer\">strdup</a> instead of strcpy. </p>\n\n<pre><code>node-&gt;name = strdup(string_to_copy);\nif (node-&gt;name == NULL)\n     printf(\"My allocation has failed!\\n\");\n</code></pre>\n\n<p>The allocated memory will have to be freed afterward. If the allocation fails, you will have a message (you should always check the success of your memory allocation).</p>\n\n<p>If you don't want to allocate memory and if you know that the size of your input will never be higher than say, 100, you could get away with something like this:</p>\n\n<pre><code>typedef struct node{\nchar name[100];\n//etc...\n}N\n</code></pre>\n\n<p>In that case you could use the following. Note that strcpy is a dangerous function that should be used with extra-care:</p>\n\n<pre><code>strncpy(node-&gt;name, buffer, 100);\nstrcpy(node-&gt;name, buffer);\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Here is a way to free your memory properly:</p>\n\n<pre><code>if (node-&gt;name != NULL)\n{\n   free(node-&gt;name);\n   node-&gt;name = NULL;\n}\n</code></pre>\n\n<p>This construction will free your memory and helps preventing double-free.</p>\n"}], "owner": {"reputation": 21, "user_id": 12043174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa725233820d239f18abe2bee5b2c8a8?s=128&d=identicon&r=PG&f=1", "display_name": "thesmizzle", "link": "https://stackoverflow.com/users/12043174/thesmizzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 57875631, "answer_count": 2, "score": 0, "last_activity_date": 1568136556, "creation_date": 1568134585, "last_edit_date": 1568134899, "question_id": 57875287, "link": "https://stackoverflow.com/questions/57875287/what-i-should-use-strcpy-or-pointers", "title": "What i should use: strcpy or pointers?", "body": "<pre><code>typedef struct node{\nchar *name;\n//etc...\n}N\n</code></pre>\n\n<p>If i had char *string got from stdin and i wanted to pass it to N, i could do easily N->name=string, or it would be bettere to use strcpy?\nwhich is more correct? which is more efficient? why?</p>\n"}, {"tags": ["c", "timer", "arduino", "interrupt"], "comments": [{"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1568134677, "post_id": 57875203, "comment_id": 102175471, "body": "My gut reaction would be to use the sin function and output a scaled value it on an analog pin.  What do you intend to use this for?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568134781, "post_id": 57875203, "comment_id": 102175513, "body": "I don&#39;t see any timer initialization code."}, {"owner": {"reputation": 11, "user_id": 11987989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df1f67b3da08058bf7b65d1f9d15c8d?s=128&d=identicon&r=PG&f=1", "display_name": "Hoerbii3", "link": "https://stackoverflow.com/users/11987989/hoerbii3"}, "reply_to_user": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1568374751, "post_id": 57875203, "comment_id": 102263529, "body": "@EvilTeach i trigger 6 switches and get therefore a current flow. by the size of the impulses i get a sine wave. &lt;br&gt;  <a href=\"https://imgur.com/a/ppSZmgN\" rel=\"nofollow noreferrer\">imgur.com/a/ppSZmgN</a> this image shows what i need. i want to generate the blue curves and the way the hardware is configurated is going to give me the red sine wave"}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1569279339, "post_id": 57875203, "comment_id": 102537697, "body": "@Eugene Sh: <a href=\"https://oscarliang.com/arduino-timer-and-interrupt-tutorial/\" rel=\"nofollow noreferrer\">Timer0 is used by the Arduino functions delay(), millis(), and micros()</a>, and it may already be set up."}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1569280178, "post_id": 57875203, "comment_id": 102537889, "body": "As a first pass, it seems the behaviour is dependent on how fast the main loop runs. Am I wrong? Or is it some kind of modulation? Also, digitalWrite() is very slow compared to a direct digital port output register write. And there are 3*312 = 936 calls to digitalWrite() per cycle."}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1569280525, "post_id": 57875203, "comment_id": 102537960, "body": "Try to make a small test program with loop() containing only digitalWrite(.., LOW); and digitalWrite(.., HIGH); and measure the actual timing on the oscilloscope to get an idea of the actual timing."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11987989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df1f67b3da08058bf7b65d1f9d15c8d?s=128&d=identicon&r=PG&f=1", "display_name": "Hoerbii3", "link": "https://stackoverflow.com/users/11987989/hoerbii3"}, "edited": false, "score": 0, "creation_date": 1568373389, "post_id": 57875326, "comment_id": 102262864, "body": "i dont think that this answer is solving what i m looking for. I may expressed myself wrong. i dont want to have an analog sine wave directly at the pin, i want to activate the switches (igbt_xxx) so that in the end i get a sine wave.  the switches should rapidly change from high to low while the width of the impulses vary."}], "tags": [], "owner": {"reputation": 1467, "user_id": 4171008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FsDDM.png?s=128&g=1", "display_name": "AhmaD", "link": "https://stackoverflow.com/users/4171008/ahmad"}, "is_accepted": false, "score": 2, "last_activity_date": 1578661077, "last_edit_date": 1578661077, "creation_date": 1568134703, "answer_id": 57875326, "question_id": 57875203, "link": "https://stackoverflow.com/questions/57875203/is-this-code-valid-reasonable-to-generate-a-sine-wave-using-an-arduino-uno/57875326#57875326", "title": "Is this code valid/reasonable to generate a sine wave using an Arduino Uno?", "body": "<p>Use a <code>for loop</code> to automatically index through the sine array. Write the data using analogWrite() to a PWM pin at a dedicated time interval. The time interval x array size = sine period.</p>\n\n<p>The output will look terrible ... just a rapidly varying <strong>PWM</strong> signal stretching 0-5&nbsp; V. After filtering appropriately, a Sine wave will magically appear.</p>\n"}], "owner": {"reputation": 11, "user_id": 11987989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df1f67b3da08058bf7b65d1f9d15c8d?s=128&d=identicon&r=PG&f=1", "display_name": "Hoerbii3", "link": "https://stackoverflow.com/users/11987989/hoerbii3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578661077, "creation_date": 1568134212, "last_edit_date": 1569278697, "question_id": 57875203, "link": "https://stackoverflow.com/questions/57875203/is-this-code-valid-reasonable-to-generate-a-sine-wave-using-an-arduino-uno", "title": "Is this code valid/reasonable to generate a sine wave using an Arduino Uno?", "body": "<p>NOTE: I left out the code for the other two phases (V and W), not necessary for the example.</p>\n\n<p>I'm pretty sure, the way I'm handling the \"on\" and \"off\" times like this is not an efficient way to do it.</p>\n\n<p>I want to achieve an \"on\" and \"off\" pulsation using a look up table. The timer should be compared with the current selected value of the table and switches the output if the value is passed.</p>\n\n<p>Problem: I think I handle the timer \"wrong\". I'm not getting the right amount of pulses (my understanding is, that I should get as many pulses as the values inside of the array, in this case 300+). Looking on an oscilloscope I noticed, that there are only a few pulses.</p>\n\n<p>Would I be better using the \"output compare register\"?</p>\n\n<p>What other tips/ideas do you have?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>bool posTOneg = true;               // Variable for the change from positive to negative. 'true' in the beginning.\n\n///// CONFIGURATION OF THE PINS /////\n\nint igbt_high_u = 11;\nint igbt_high_v = 10;\nint igbt_high_w = 9;\n\nint igbt_low_u = 6;\nint igbt_low_v = 5;\nint igbt_low_w = 3;\n\n///// LOOKUP TABLE /////\nint UsinPWM[]={1,2,5,7,10,12,15,17,19,22,24,27,30,32,34,37,39,42,\n44,47,49,52,54,57,59,61,64,66,69,71,73,76,78,80,83,85,88,90,92,94,97,99,                                      //42 Werte bis hier hin\n101,103,106,108,110,113,115,117,119,121,124,126,128,130,132,134,136,138,140,142,144,146,\n148,150,152,154,156,158,160,162,164,166,168,169,171,173,175,177,178,180,182,184,185,187,188,190,192,193,      // 90\n195,196,198,199,201,202,204,205,207,208,209,211,212,213,215,216,217,219,220,221,222,223,224,225,226,227,\n228,229,230,231,232,233,234,235,236,237,237,238,239,240,240,241,242,242,243,243,244,244,245,245,246,246,      // 142\n247,247,247,248,248,248,248,249,249,249,249,249,250,250,250,250,249,249,249,249,249,248,\n248,248,248,247,247,247,246,246,245,245,244,244,243,243,242,242,241,240,240,239,238,237,237,236,235,234,      // 190\n233,232,231,230,229,228,227,226,225,224,223,222,221,220,219,217,216,215,213,212,211,209,208,207,205,204,\n202,201,199,198,196,195,193,192,190,188,187,185,184,182,180,178,177,175,173,171,169,168,166,164,162,160,      // 242\n158,156,154,152,150,148,146,144,142,140,138,136,134,132,130,128,126,124,121,119,117,115,113,110,108,106,\n103,101,99,97,94,92,90,88,85,83,80,78,76,73,71,69,66,64,61,59,57,54,52,49,47,44,42,39,37,34,32,30,            // 300\n27,24,22,19,17,15,12,10,7,5,2,1};                                                                             // 312\n\n///// SIZE OF THE ARRAY /////\nint sizeU = sizeof(UsinPWM)/sizeof(int);      // Variable for PWM array (size)\n///// OFFSET 120 GRAD /////\nint indexU = 0;              // zaehlervariable\n\n///// FUNCTION FOR THE PHASE U (POS AND NEG HALF-CYCLE) /////\nvoid posHalbU (int i)\n{\n  if(TCNT0 &lt; UsinPWM[i])                              // Compare timer with the current value of the look up table\n  {\n    digitalWrite(igbt_low_v, HIGH);                   // Triggering hardware\n    digitalWrite(igbt_low_w, HIGH);\n    digitalWrite(igbt_high_u, HIGH);\n  }\n  else\n  {\n    digitalWrite(igbt_high_u, LOW);\n    digitalWrite(igbt_low_v, LOW);\n    digitalWrite(igbt_low_w, LOW);\n  }\n}\n\nvoid negHalbU(int i)\n{\n  if(TCNT0 &lt; UsinPWM[i])\n  {\n    digitalWrite(igbt_high_v, HIGH);\n    digitalWrite(igbt_high_w, HIGH);\n    digitalWrite(igbt_low_u, HIGH);\n  }\n  else\n  {\n    digitalWrite(igbt_high_v, LOW);\n    digitalWrite(igbt_high_w, LOW);\n    digitalWrite(igbt_low_u, LOW);\n  }\n}\n\n\nvoid setup()\n{\n  Serial.begin(9600);\n\n  ///// CONFIGURE PWM /////\n  pinMode(igbt_high_u, OUTPUT);\n  pinMode(igbt_high_v, OUTPUT);\n  pinMode(igbt_high_w, OUTPUT);\n  pinMode(igbt_low_u, OUTPUT);\n  pinMode(igbt_low_v, OUTPUT);\n  pinMode(igbt_low_w, OUTPUT);\n}\n\nvoid loop()\n{\n  ///// CALL PHASE U  /////\n  if(posTOneg)\n  {\n    posHalbU(indexU);\n  }\n  else\n  {\n    negHalbU(indexU);\n  }\n\n\n  indexU = indexU + 1;\n\n  if(indexU == sizeU)\n  {\n    indexU = 0;                             // Reset of the counter variable\n    posTOneg = !posTOneg;                   // Negate the boolean value. Swapping between pos and neg all the time\n  }\n}\n</code></pre>\n\n<p>Below is the result I am generating. About 20 impulses are created, and these are periodically created.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WW0OP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WW0OP.png\" alt=\"Enter image description here\"></a></p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1568145396, "post_id": 57874846, "comment_id": 102179645, "body": "<i>asm-generic</i> is a meta-folder, which replaces missed parts of architecture dependent headers. So, it&#39;s a very rare cases when you need to include something directly from <i>asm-generic</i>."}, {"owner": {"reputation": 1191, "user_id": 7559397, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f21dc34064e2838b5a87891dc4a8ca32?s=128&d=identicon&r=PG&f=1", "display_name": "Jinzu", "link": "https://stackoverflow.com/users/7559397/jinzu"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1568158606, "post_id": 57874846, "comment_id": 102183251, "body": "@0andriy: yes, but I do not have an <code>include&#47;asm</code> folder. Does that mean I do not need an <code>#include</code> statement?"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1568183448, "post_id": 57874846, "comment_id": 102189231, "body": "Again, <i>asm</i> is the architecture dependent one and of course you have it. In the case where no such folder (there is no architecture with a such in Linux kernel IIRC), build system makes it for you. Needs of the included header in the code is solely decision based on the code, developer should do a right choice."}], "owner": {"reputation": 1191, "user_id": 7559397, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f21dc34064e2838b5a87891dc4a8ca32?s=128&d=identicon&r=PG&f=1", "display_name": "Jinzu", "link": "https://stackoverflow.com/users/7559397/jinzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568132740, "creation_date": 1568132740, "question_id": 57874846, "link": "https://stackoverflow.com/questions/57874846/using-current-macro-in-linux-kernel", "title": "Using current macro in linux kernel", "body": "<p>I am changing the kernel in linux using C. I have to include information about a process and test it. This is being done on a vm. I have updated the kernel to 5.1. In my home directory I have the source code for 5.1. I have to go into the file in the 5.1 folder and type the information in /kernel/sys.c. My question is in order to use the current macro do I need to have an include statement both in the test file and in the /kernel/sys.c file as well? Also would I include it using</p>\n\n<p><code>#include &lt;include/asm/current.h&gt;</code></p>\n\n<p>because the actual header file in the linux-5.1 folder is found in</p>\n\n<p><code>include/asm-generic/current.h</code></p>\n\n<p>so would I need the <code>#include</code> statement in the kernel/sys.c file and would it be </p>\n\n<p><code>#include &lt;include/asm-generic/current.h&gt;</code> or <code>#include &lt;include/asm/current.h&gt;</code></p>\n"}, {"tags": ["c", "undefined-behavior", "c-strings", "strlen"], "comments": [{"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 1, "creation_date": 1568132218, "post_id": 57874578, "comment_id": 102174298, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11962457/why-is-using-an-uninitialized-variable-undefined-behavior\">(Why) is using an uninitialized variable undefined behavior?</a>"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1568132323, "post_id": 57874578, "comment_id": 102174355, "body": "btw. <code>temp[strlen(temp)] = &quot;\\0&quot;;</code> shouldn&#39;t compile and if you meant <code>temp[strlen(temp)] = &#39;\\0&#39;;</code> -- that wouldn&#39;t make sense either because what <code>strlen()</code> does is searching for <code>&#39;\\0&#39;</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1568132440, "post_id": 57874578, "comment_id": 102174408, "body": "It&#39;s not empty; it has exactly <code>MAX</code> elements, all with an indeterminate value."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1568132952, "post_id": 57874578, "comment_id": 102174654, "body": "That edit is invalid C. You cannot declare a global variable with a non-constant initialiser. (<code>int length = strlen(text);</code>)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1568133458, "post_id": 57874578, "comment_id": 102174891, "body": "@rici I&#39;m not yet convinced it is global.  The question still does not have an actual function defined so we can see how everything is scoped."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1568136150, "post_id": 57874578, "comment_id": 102176024, "body": "@christian: yes, perhaps you&#39;re right."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568144805, "post_id": 57874578, "comment_id": 102179400, "body": "The first edit, Jack, was fine; it was made before the first answers were posted.  The second edit is not OK; it eliminates code that was a key part of my answer, for example.  Invalidating answers is not OK.  If you need to change the code after an answer is posted, you need to add to the question, rather than replace the existing code.  (I&#39;m not sure why you think <code>yes</code> is better than <code>MAX</code> for the size of the array; I think <code>MAX</code> is better on several counts \u2014 meaningfulness of the name, and the use of upper-case rather than lower-case.) ."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 11759611, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-F25evxxXiHY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfirN36gUmcLln5m6y43KA7SJfwdA/photo.jpg?sz=128", "display_name": "Stian Diehard", "link": "https://stackoverflow.com/users/11759611/stian-diehard"}, "edited": false, "score": 0, "creation_date": 1568135113, "post_id": 57874773, "comment_id": 102175659, "body": "Great detailed answer."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1568132843, "last_edit_date": 1568132843, "creation_date": 1568132430, "answer_id": 57874773, "question_id": 57874578, "link": "https://stackoverflow.com/questions/57874578/why-does-my-empty-character-array-start-with-a-length-of-6/57874773#57874773", "title": "Why does my empty character array start with a length of 6?", "body": "<p>There are at least two problems with the line:</p>\n\n<pre><code>temp[strlen(temp)] = \"\\0\";\n</code></pre>\n\n<ol>\n<li><p>The compiler should be shrieking about converting a pointer to an integer.  You need <code>'\\0'</code> and not <code>\"\\0\"</code>.  (This might account for some of the odd characters; the least-significant byte of the address is probably stored over the null byte, making it and random other characters visible until the string printing comes across another null byte somewhere.)</p></li>\n<li><p>With that fixed, the code carefully writes a null byte over the null byte that marks the end of the string.</p></li>\n</ol>\n\n<p>You should probably not be using <code>strlen()</code> at this point (or at a number of other points where you use it in the loop).</p>\n\n<p>You should be using <code>i</code> more in the loop.  If your goal is to eliminate non-alpha characters, you probably need two indexes, one for 'next character to check' and one for 'next position to overwrite'.  After the loop, you need to write over the 'next position to overwrite' with the null byte.</p>\n\n<pre><code>int j = 0;   // Next position to overwrite\nfor (int i = 0; i &lt; length; i++)\n{\n    if (isalpha(text[i]))\n        temp[j++] = text[i];\n}\ntemp[j] = '\\0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1568133295, "last_edit_date": 1568133295, "creation_date": 1568132631, "answer_id": 57874822, "question_id": 57874578, "link": "https://stackoverflow.com/questions/57874578/why-does-my-empty-character-array-start-with-a-length-of-6/57874822#57874822", "title": "Why does my empty character array start with a length of 6?", "body": "<p>For starters the character array</p>\n\n<pre><code>char temp[MAX];\n</code></pre>\n\n<p>is not initialized. It has indeterminate values.</p>\n\n<p>So these statements</p>\n\n<pre><code>printf(\"NUM:[%i] CHAR:[%c] TEMP:[%c] TEMPSTRLEN:[%i]\\n\", i, text[i], temp[strlen(temp)], strlen(temp));\n\n  temp[strlen(temp)] = tolower(text[i]);\n</code></pre>\n\n<p>have undefined behavior because you may not apply the standard function <code>strlen</code> to uninitialized character array.</p>\n\n<p>This statement</p>\n\n<pre><code>  temp[strlen(temp)] = \"\\0\";\n</code></pre>\n\n<p>is also invalid.</p>\n\n<p>In the left side of the assignment statement there is used the string literal <code>\"\\0\"</code> which is implicitly converted to pointer to its first character.</p>\n\n<p>So these statements</p>\n\n<pre><code>  length = strlen(temp);\n\n  printf(\"[%s]\\n\", temp);\n</code></pre>\n\n<p>do not make sense.</p>\n\n<p>It seems what you mean is the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX 1000\n\nint main(void) \n{\n    char text[MAX] = \"teststring\";\n    size_t length = strlen(text);\n\n    char temp[MAX] = { '\\0' };\n    // or\n    //char temp[MAX] = \"\";\n\n\n    for ( size_t i = 0; i &lt; length; i++) \n    {\n        if (isalpha( ( unsigned char )text[i] ) ) \n        {\n            printf(\"NUM:[%zu] CHAR:[%c] TEMP:[%c] TEMPSTRLEN:[%zu]\\n\", i, text[i], temp[strlen(temp)], strlen(temp));      \n\n            temp[strlen(temp)] = tolower(text[i]);\n            temp[i+1] = '\\0';\n        }\n    }\n\n  length = strlen(temp);\n\n  printf( \"[%s]\\n\", temp );\n\n  return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>NUM:[0] CHAR:[t] TEMP:[] TEMPSTRLEN:[0]\nNUM:[1] CHAR:[e] TEMP:[] TEMPSTRLEN:[1]\nNUM:[2] CHAR:[s] TEMP:[] TEMPSTRLEN:[2]\nNUM:[3] CHAR:[t] TEMP:[] TEMPSTRLEN:[3]\nNUM:[4] CHAR:[s] TEMP:[] TEMPSTRLEN:[4]\nNUM:[5] CHAR:[t] TEMP:[] TEMPSTRLEN:[5]\nNUM:[6] CHAR:[r] TEMP:[] TEMPSTRLEN:[6]\nNUM:[7] CHAR:[i] TEMP:[] TEMPSTRLEN:[7]\nNUM:[8] CHAR:[n] TEMP:[] TEMPSTRLEN:[8]\nNUM:[9] CHAR:[g] TEMP:[] TEMPSTRLEN:[9]\n[teststring]\n</code></pre>\n\n<p><strong>Edit</strong>: next time do not change your question so cardinally because this can confuse readers of the question. </p>\n"}], "owner": {"reputation": 1242, "user_id": 11072841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32da5f13e132bf39b2fd31821ad4bbaa?s=128&d=identicon&r=PG&f=1", "display_name": "Jack A", "link": "https://stackoverflow.com/users/11072841/jack-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 57874773, "answer_count": 2, "score": -1, "last_activity_date": 1568133753, "creation_date": 1568131775, "last_edit_date": 1568133753, "question_id": 57874578, "link": "https://stackoverflow.com/questions/57874578/why-does-my-empty-character-array-start-with-a-length-of-6", "title": "Why does my empty character array start with a length of 6?", "body": "<p>When I print out the length of the temp string, it starts at a random number. The goal of this for loop is to filter out everything that's not a letter, and it works for the most part, but when I print out the filtered string it returns the filtered string but with some extra random characters before and after the string.</p>\n\n<pre><code>#define yes 1000\n...\nchar stringed[yes] = \"teststring\";\nint len = strlen(text);\n\nchar filt[yes];\n\n  for (int i = 0; i &lt; len; i++) {\n    if (isalpha(stringed[i])) {\n      filt[strlen(filt)] = tolower(stringed[i]);\n    }\n  }\n\n</code></pre>\n"}, {"tags": ["c", "indexing", "types", "c99"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568131517, "post_id": 57874301, "comment_id": 102173938, "body": "The normal, standard way to write the literal indexes and sizes as integers is as a plain decimal (usually) integer \u2014 <code>unsigned char uchar[10]; uchar[9] = &#39;\\0&#39;;</code> etc.  Anything else is unusual \u2014 there has to be a good reason to do it (and there is seldom a good reason, so it is seldom done).  With variables \u2014 using <code>size_t</code> is reasonable, but using plain <code>int</code> is also usually OK.  You can run into problems with plain <code>int</code> before you run into problems with <code>size_t</code>, but you&#39;re dealing with extremes."}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1568131494, "post_id": 57874414, "comment_id": 102173925, "body": "Is writing uchar[1U] recommended?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 1, "creation_date": 1568131547, "post_id": 57874414, "comment_id": 102173961, "body": "@OneArb No. The <code>U</code> is not needed, so it&#39;s just fluff that makes your code harder to understand."}, {"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1568132130, "post_id": 57874414, "comment_id": 102174262, "body": "@JL2210 Thanks. I got the idea from: Constants of unsigned type should have a &quot;U&quot; <a href=\"https://rules.sonarsource.com/c/RSPEC-854\" rel=\"nofollow noreferrer\">rules.sonarsource.com/c/RSPEC-854</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1568132273, "post_id": 57874414, "comment_id": 102174329, "body": "but indices used in brackets need not be unsigned or non-negative. <code>a[-1]</code> is perfectly fine provided that <code>a</code> currently points to 2..nth element in an array."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1568132446, "post_id": 57874414, "comment_id": 102174410, "body": "@OneArb That page is wrong, then. Implicit conversion rules already cover this."}, {"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1568132451, "post_id": 57874414, "comment_id": 102174414, "body": "@AnttiHaapala The question is meant for those who wish to follow the size_t advice as per the link in the question first line."}, {"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1568132641, "post_id": 57874414, "comment_id": 102174502, "body": "@JL2210 Ok <a href=\"https://rules.sonarsource.com/\" rel=\"nofollow noreferrer\">rules.sonarsource.com</a> is making a code analyzer and apply the <a href=\"https://stackoverflow.com/questions/48703624/integer-promotion-misra-c2012-rule-7-2\" title=\"integer promotion misra c2012 rule 7 2\">stackoverflow.com/questions/48703624/&hellip;</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1568132642, "post_id": 57874414, "comment_id": 102174503, "body": "@OneArb but you need to understand <i>what</i> the question there asks and what the answers are for."}, {"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1568133215, "post_id": 57874414, "comment_id": 102174769, "body": "@AnttiHaapala Thanks I just found it."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 4, "last_activity_date": 1568131032, "creation_date": 1568131032, "answer_id": 57874414, "question_id": 57874301, "link": "https://stackoverflow.com/questions/57874301/canonical-unsigned-litteral-suffix-when-used-as-array-indices/57874414#57874414", "title": "Canonical unsigned litteral suffix when used as array indices", "body": "<p>The <code>U</code> there in <code>0U</code> is just noise - because it is a simple constant its type does not really matter. What is worse there is no suffix for <code>size_t</code> specifically.</p>\n\n<p>You actually need the suffixes very seldom - and even then, more often than not, to silence a nagging compiler.</p>\n\n<p>The <code>size_t</code> advice applies to <em>objects</em> that are meant to store array indices and <em>index calculations</em> with unknowns, or things like <code>1000 * 1000 * 1000 * 10</code> for the array dimension calculation  - these should happen in <code>size_t</code> where there is a danger of integer overflow or wraparound.</p>\n"}, {"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1568131907, "creation_date": 1568131907, "answer_id": 57874621, "question_id": 57874301, "link": "https://stackoverflow.com/questions/57874301/canonical-unsigned-litteral-suffix-when-used-as-array-indices/57874621#57874621", "title": "Canonical unsigned litteral suffix when used as array indices", "body": "<p>The standard and portable way to write unsigned literals is by writing <code>&lt;number&gt;U</code>.</p>\n\n<p>However, this isn't recommended on array indices, for various reasons:</p>\n\n<ol>\n<li><p>Most of the constant array indices that you'll be using are below <code>INT_MAX</code> and <code>UINT_MAX</code>.<br>\nIf you are using constant array indices these big, you should really consider rethinking your approach.</p></li>\n<li><p>These just make your code larger (if only by a few bytes) and harder to understand.</p></li>\n</ol>\n"}], "owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1568195162, "creation_date": 1568130602, "last_edit_date": 1568195162, "question_id": 57874301, "link": "https://stackoverflow.com/questions/57874301/canonical-unsigned-litteral-suffix-when-used-as-array-indices", "title": "Canonical unsigned litteral suffix when used as array indices", "body": "<p>I read the advice for <a href=\"https://stackoverflow.com/questions/3174850/what-is-the-correct-type-for-array-indexes-in-c\">using <code>size_t</code> for array indices</a>.</p>\n\n<p>What would be the standard and portable way to write <code>unsigned</code> litterals?</p>\n\n<p>Why isn't the canonical way:</p>\n\n<pre><code>size_t i;\nunsigned char uchar[10U];\n\nuchar[0U]=10U;\n\nfor(i=2U;i&lt;uchar[0U];i++) {\n    uchar[i]=i;\n    printf(\"%u\\n\",uchar[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1568130954, "creation_date": 1568130954, "answer_id": 57874400, "question_id": 57874267, "link": "https://stackoverflow.com/questions/57874267/code-read-few-lines-from-a-text-file-in-c/57874400#57874400", "title": "code read few lines from a text file in C", "body": "<p>Any time you find yourself naming variables with numeric suffixes, you should probably be using an array. So instead of three arrays <code>name1</code>, <code>name2</code>, and <code>name3</code>, use a 2-dimensional array:</p>\n\n<pre><code>#define LINES 3\n#define LINESIZE 20\nchar name[LINES][LINESIZE];\n</code></pre>\n\n<p>Then you can read the lines in a loop, and it will be easy to change the number of lines.</p>\n\n<pre><code>for (int i = 0; i &lt; LINES; i++) {\n    if (fgets(name[i], LINESIZE, fp) == NULL) {\n        break;\n    }\n    // Remove trailing newline if it's there\n    size_z len = strlen(name[i]);\n    if (name[i][len-1] == '\\n') {\n        name[i][len-1] = '\\0';\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12037529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5856980f489d8f3ee819870afa11a85b?s=128&d=identicon&r=PG&f=1", "display_name": "ilovecoding123", "link": "https://stackoverflow.com/users/12037529/ilovecoding123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1568130954, "creation_date": 1568130483, "question_id": 57874267, "link": "https://stackoverflow.com/questions/57874267/code-read-few-lines-from-a-text-file-in-c", "title": "code read few lines from a text file in C", "body": "<p>I want to create a program to read the first 3 lines from a text file that has 9 lines. Please help me with the below code and point out what I am doing wrong.</p>\n\n<p>Further is it possible to read 3-6 lines in the text file?</p>\n\n<p>Thanks for any help.</p>\n\n<pre><code>char name1[20], name2[20], name3[20];\nFILE *fp = fopen(\"names.txt\", \"r\");\nwhile(3 == fscanf(fp, \"%20[^\\n]%*c%20[^\\n]%*c%20[^\\n]%*c\", name1, name2, name3)){\n    printf(\"%s, %s, %s\\n\", name1, name2, name3);\n}\nfclose(fp);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 2, "creation_date": 1568130205, "post_id": 57874155, "comment_id": 102173260, "body": "Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a>? You should also explain what is wrong in detail."}, {"owner": {"reputation": 352, "user_id": 1956671, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1d2nZ.jpg?s=128&g=1", "display_name": "baseman101", "link": "https://stackoverflow.com/users/1956671/baseman101"}, "edited": false, "score": 2, "creation_date": 1568130453, "post_id": 57874155, "comment_id": 102173391, "body": "Sounds like a homework question. Please post whatever code you have. I&#39;ll give you a hint, though. Use a looping construct with integer division and modulus to go through each digit. The solution should become apparent."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1568130456, "post_id": 57874155, "comment_id": 102173394, "body": "Your removing the code has made this question worse. Did you take the site tour? You also haven&#39;t specified any constraints on the integer, e.g. what is the minimum and maximum possible value? Is it always a matter of changing 9 to 7?"}, {"owner": {"reputation": 277, "user_id": 10977963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hPvYe0Frnx8/AAAAAAAAAAI/AAAAAAAAAPs/RyyolmfpBUA/photo.jpg?sz=128", "display_name": "Hunali", "link": "https://stackoverflow.com/users/10977963/hunali"}, "reply_to_user": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 0, "creation_date": 1568130492, "post_id": 57874155, "comment_id": 102173411, "body": "@pzaenger it&#39;s okay if I don&#39;t put any code?"}, {"owner": {"reputation": 277, "user_id": 10977963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hPvYe0Frnx8/AAAAAAAAAAI/AAAAAAAAAPs/RyyolmfpBUA/photo.jpg?sz=128", "display_name": "Hunali", "link": "https://stackoverflow.com/users/10977963/hunali"}, "edited": false, "score": 0, "creation_date": 1568130610, "post_id": 57874155, "comment_id": 102173467, "body": "I will put better code thanks for the suggestion"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1568131621, "post_id": 57874155, "comment_id": 102174000, "body": "Still not an MCVE. Where&#39;s your <code>main</code> function?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1568131694, "post_id": 57874155, "comment_id": 102174036, "body": "You never put <code>devided</code> into the result."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1568132345, "post_id": 57874155, "comment_id": 102174363, "body": "Despite regular edits (thank you - close vote retracted) you haven&#39;t told us what the constraints on the number are."}, {"owner": {"reputation": 277, "user_id": 10977963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hPvYe0Frnx8/AAAAAAAAAAI/AAAAAAAAAPs/RyyolmfpBUA/photo.jpg?sz=128", "display_name": "Hunali", "link": "https://stackoverflow.com/users/10977963/hunali"}, "edited": false, "score": 0, "creation_date": 1568132957, "post_id": 57874155, "comment_id": 102174657, "body": "I tried my best to explain what the program should do. I don&#39;t know what to add anymore!"}, {"owner": {"reputation": 951, "user_id": 9161094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5b3673d6dd85cb6b7c4b870c601233?s=128&d=identicon&r=PG&f=1", "display_name": "Pam", "link": "https://stackoverflow.com/users/9161094/pam"}, "edited": false, "score": 0, "creation_date": 1568143501, "post_id": 57874155, "comment_id": 102178871, "body": "The constraints on the number may not matter (although always positive and smaller than the biggest int would help). Even if the number arrives as an integer, you can convert it using itoa() and then process it as a string then use atoi to convert back. Or, you could process it as an integer in a while loop using a divider that is multiplied by 10 on every iteration (thus extracting the decimal place values)."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568136832, "post_id": 57874917, "comment_id": 102176276, "body": "Note: <code>mult*=10</code> will overflow when <code>n[i]</code> is large.  I doubt this undefined behavior will cause too much trouble here though."}, {"owner": {"reputation": 592, "user_id": 6022626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TE4SgJMzh3g/AAAAAAAAAAI/AAAAAAAAAE4/BpGV2AGlUG0/photo.jpg?sz=128", "display_name": "Suraj", "link": "https://stackoverflow.com/users/6022626/suraj"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568137570, "post_id": 57874917, "comment_id": 102176563, "body": "@chux <code>n[i]</code> is an integer and the while loop runs accordingly. So, how can <code>mult</code> overflow?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568143096, "post_id": 57874917, "comment_id": 102178733, "body": "Try <code>n[I]==INT_MAX</code>.  What is the final value of <code>mult</code>?"}], "tags": [], "owner": {"reputation": 592, "user_id": 6022626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TE4SgJMzh3g/AAAAAAAAAAI/AAAAAAAAAE4/BpGV2AGlUG0/photo.jpg?sz=128", "display_name": "Suraj", "link": "https://stackoverflow.com/users/6022626/suraj"}, "is_accepted": true, "score": 1, "last_activity_date": 1568133016, "creation_date": 1568133016, "answer_id": 57874917, "question_id": 57874155, "link": "https://stackoverflow.com/questions/57874155/how-to-transform-the-digits-of-a-number/57874917#57874917", "title": "How to transform the digits of a number?", "body": "<p>Your logic of <code>result*=devided;</code> is wrong. You need to add the digit(multiplied by it's 10's place) to the result. Here is the solution to your problem.</p>\n\n<pre><code>int function (int *n, int i){\n    int temp=n[i]; //tepmorary veraible of the passed number\n    int result=0;\n    int mult=1;\n    int devided;\n    while (temp!=0){\n        devided=temp%10;//get the last number example 123 = 3;\n        if (devided==9){ //if its 9 change the last didigt to 7\n            devided=7;\n        }\n        result+=(devided * mult);//multiply the last didgit with 10\n        temp/=10;\n        mult*=10;\n    }\n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 10977963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hPvYe0Frnx8/AAAAAAAAAAI/AAAAAAAAAPs/RyyolmfpBUA/photo.jpg?sz=128", "display_name": "Hunali", "link": "https://stackoverflow.com/users/10977963/hunali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 57874917, "answer_count": 1, "score": -6, "last_activity_date": 1568133016, "creation_date": 1568130074, "last_edit_date": 1568132806, "question_id": 57874155, "link": "https://stackoverflow.com/questions/57874155/how-to-transform-the-digits-of-a-number", "title": "How to transform the digits of a number?", "body": "<p>If the input is an integer [<strong>not array</strong>]: <strong>6977</strong>. I need to change every 9 to 7 so the result will be: <strong>6777</strong>.</p>\n\n<p>This is the code that I write this is an idea that I was thinking how could I solve the problem but it's so wrong. The whole point of my homework is to change the specific number[element] of the number and I don't know how to do that. The function should do that. more examples: input: 12345555 [change every 5 into 3] result should be 12343333.</p>\n\n<pre><code>int function (int *n,int i){\n    int temp=n[i]; //tepmorary veraible of the passed number\n    int result=10;\n    int devided;\n    while (temp!=0){\n        devided=temp%10;//get the last number example 123 = 3;\n        if (devided==9){ //if its 9 change the last didigt to 7\n            devided=7;\n        }\n        result*=devided;//multiply the last didgit with 10\n        temp/=10;\n    }\n\n    return result;\n}\n\nvoid main (void){\n    int a[100],i=0;\n    while (scanf_s (\"%d\",&amp;a[i])){\n        printf (\"%d\",function(a,i));\n        i++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "ffmpeg"], "owner": {"reputation": 11, "user_id": 10791641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4885031d410444fa5172ff1eb125f807?s=128&d=identicon&r=PG&f=1", "display_name": "StefanoM", "link": "https://stackoverflow.com/users/10791641/stefanom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1568128979, "creation_date": 1568128979, "question_id": 57873882, "link": "https://stackoverflow.com/questions/57873882/add-actual-timestamp-to-mp4-using-ffmpeg", "title": "Add actual timestamp to mp4 using ffmpeg", "body": "<p>I'm using ffmpeg to write an h264 stream to a mp4 file.\nEverything is working, but now I need to embed to this file the actual timestamp in milliseconds of each frame.</p>\n\n<p>Is it possible?</p>\n\n<p>This is my code:</p>\n\n<pre><code>void mp4_file_create(mp4_par * par, t_image * img_in)\n{\n    AVCodec * codec = NULL;\n    AVCodecContext *    cc_in;\n    AVFormatContext *   av_fmt_ctx_out;\n    AVStream *          av_stream;\n    AVPacket            av_pkt;\n    AVFormatContext *   ifmt_ctx;\n\n\n    unsigned long long last_frame_ts_utc;\n    unsigned long long last_frame_ts_absolute;\n    unsigned long long last_pts;\n\n    t_mp4_dict_metadata metadata;\n    char file_name[1024];\n    char TSstrdate[128];\n\n    av_register_all();\n\n    cc_in = NULL;\n    av_stream = NULL;\n\n    if (avformat_alloc_output_context2(&amp;mp4h-&gt;av_fmt_ctx_out, NULL, NULL, file_name) &lt; 0) {\n        trace_error(\"avformat_alloc_output_context2 failed\");\n        goto FnExit;\n    }\n\n    /* find the H264 RAW encoder */\n    codec = avcodec_find_encoder(AV_CODEC_ID_H264);\n    if (!codec) {\n        int ret;\n        AVStream *in_stream = NULL;\n\n        if (av_fmt_ctx_in == NULL)\n        {\n            trace_error(\"av_fmt_ctx_in is NULL\");\n            goto FnExit;\n        }\n        in_stream = av_fmt_ctx_in-&gt;streams[0];\n\n        in_stream-&gt;codec-&gt;width = par.width;\n        in_stream-&gt;codec-&gt;height = par.height;\n        in_stream-&gt;codec-&gt;coded_width = par.width;\n        in_stream-&gt;codec-&gt;coded_height = par.height;\n        in_stream-&gt;codec-&gt;bit_rate = 1024;\n        in_stream-&gt;codec-&gt;flags = CODEC_FLAG_GLOBAL_HEADER;\n        in_stream-&gt;codec-&gt;time_base.num = 1;\n        in_stream-&gt;codec-&gt;time_base.den = par.frame_rate;\n        in_stream-&gt;codec-&gt;gop_size = par.gop;\n        in_stream-&gt;codec-&gt;pix_fmt = AV_PIX_FMT_YUV420P;\n\n        av_stream = avformat_new_stream(mp4h-&gt;av_fmt_ctx_out, in_stream-&gt;codec-&gt;codec);\n        if (!av_stream) {\n            trace_error(\"Failed allocating output stream\");\n            goto FnExit;\n        }\n\n        ret = avcodec_copy_context(av_stream-&gt;codec, in_stream-&gt;codec);\n        if (ret != 0) {\n            goto FnExit;\n        }\n    }\n    else {\n        int ret;\n        av_stream = avformat_new_stream(mp4h-&gt;av_fmt_ctx_out, NULL);\n        if (!av_stream) {\n            goto FnExit;\n        }\n\n        cc_in = avcodec_alloc_context3(codec);\n        if (cc_in == NULL) {\n            goto FnExit;\n        }\n\n        cc_in-&gt;width = par.width;\n        cc_in-&gt;height = par.height;\n        cc_in-&gt;bit_rate = 1024;\n        cc_in-&gt;flags = CODEC_FLAG_GLOBAL_HEADER;\n        cc_in-&gt;time_base.num = 1;\n        cc_in-&gt;time_base.den = par.frame_rate;\n        cc_in-&gt;gop_size = par.gop;\n        cc_in-&gt;pix_fmt = AV_PIX_FMT_YUVJ420P;\n\n        cc_in-&gt;extradata = (unsigned char*)av_mallocz(sizeof(sample_spspps));\n        cc_in-&gt;extradata_size = sizeof(sample_spspps);\n        memcpy(cc_in-&gt;extradata, sample_spspps, cc_in-&gt;extradata_size);\n\n        ret = avcodec_copy_context(av_stream-&gt;codec, cc_in);\n        if (ret != 0) {\n            goto FnExit;\n        }\n    }\n\n    av_stream-&gt;codec-&gt;codec_tag = 0;\n    if (av_fmt_ctx_out-&gt;oformat-&gt;flags &amp; AVFMT_GLOBALHEADER)\n        av_stream-&gt;codec-&gt;flags |= CODEC_FLAG_GLOBAL_HEADER;\n\n    if (!(av_fmt_ctx_out-&gt;flags &amp; AVFMT_NOFILE)) {\n        int ret = avio_open(&amp;av_fmt_ctx_out-&gt;pb, file_name, AVIO_FLAG_READ_WRITE);\n        if (ret &lt; 0) {\n            trace_error(\"Could not open output file '%s'\", file_name);\n            goto FnExit;\n        }\n    }\n\n    av_fmt_ctx_out-&gt;streams[0]-&gt;time_base.num = 1;\n    av_fmt_ctx_out-&gt;streams[0]-&gt;time_base.den = par.frame_rate;\n    av_fmt_ctx_out-&gt;streams[0]-&gt;codec-&gt;time_base.num = 1;\n    av_fmt_ctx_out-&gt;streams[0]-&gt;codec-&gt;time_base.den = par.frame_rate;\n    AVRational fps;\n    fps.num = 1;\n    fps.den = par.frame_rate;\n    av_stream_set_r_frame_rate(av_fmt_ctx_out-&gt;streams[0], fps);\n\n    mp4h-&gt;av_fmt_ctx_out-&gt;streams[0]-&gt;first_dts = AV_TIME_BASE;\n    av_dict_set(&amp;pMetaData, \"title\", par.guid_video_function, 0);\n    av_dict_set(&amp;pMetaData, \"artist\", \"Test Artist\", 0);\n    av_dict_set(&amp;pMetaData, \"date\", TSstrdate, 0);\n    av_fmt_ctx_out-&gt;metadata = pMetaData;\n\n    if (avformat_write_header(av_fmt_ctx_out, NULL) &lt; 0) {\n        goto FnExit;\n    }\n\n    //............. Now for each frame_rate........\n\n    av_init_packet(&amp;av_pkt);\n\n    if (first_frame)\n    {\n        av_pkt.pts = 0;\n        av_pkt.dts = 0;\n    }\n    else\n    {\n        av_pkt.pts = last_pts + (long long int)((img-&gt;timestamp_absolute - last_frame_ts_absolute) *  (unsigned long long)av_stream-&gt;time_base.den / 1000000ULL);\n        av_pkt.dts = last_pts + (long long int)((img-&gt;timestamp_absolute - last_frame_ts_absolute) *  (unsigned long long)av_stream-&gt;time_base.den / 1000000ULL);\n    }\n\n\n    mp4h-&gt;av_pkt.duration = 0;\n    mp4h-&gt;av_pkt.pos = -1;\n\n\n\n    last_frame_ts_utc = img-&gt;timestamp_utc.t;\n    last_frame_ts_absolute = img-&gt;timestamp_absolute.t;\n    last_pts = av_pkt.pts;\n\n    if (img-&gt;type == keyframe)\n    {\n        av_pkt.flags |= AV_PKT_FLAG_KEY;\n    }\n\n    av_pkt.data = img-&gt;ptr;\n    av_pkt.size = img-&gt;size;\n    av_pkt.stream_index = av_stream-&gt;index;\n\n    ret = av_interleaved_write_frame(av_fmt_ctx_out, &amp;av_pkt);\n    if (ret != 0) {\n        char strE[256];\n        av_strerror(ret, strE, sizeof(strE));\n        trace_error(\"av_write_frame returns %d - %s\", ret, strE);\n        return;\n    }\n\n\n\n    //........then I will close the file\nFnExit:\n\n    if (av_fmt_ctx_out &amp;&amp; av_fmt_ctx_out-&gt;pb != NULL) {\n        if (av_write_trailer(mp4h-&gt;av_fmt_ctx_out) != 0) {\n            trace_error(\"av_write_trailer Error!\");\n        }\n    }\n\n    if (ifmt_ctx)\n        avformat_close_input(&amp;ifmt_ctx);\n\n    avio_closep(&amp;av_fmt_ctx_out-&gt;pb);\n    avcodec_close(av_stream-&gt;codec);\n    avformat_free_context(av_fmt_ctx_out);\n}\n</code></pre>\n\n<p>How can I modify it in order to embed the actual timestamp of each frame?</p>\n\n<p>I tried to add the actual timestamp to the first frame pts instead of setting it to zero, but it didn't work.</p>\n"}, {"tags": ["c", "gdb"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568128055, "post_id": 57873573, "comment_id": 102172134, "body": "Before starting the function its address where it will be loaded by the system is not known."}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 4754812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-strdovvZkRY/AAAAAAAAAAI/AAAAAAAAJIk/AFJ3fLXQpG4/photo.jpg?sz=128", "display_name": "Yosef Arbiv", "link": "https://stackoverflow.com/users/4754812/yosef-arbiv"}, "is_accepted": false, "score": 2, "last_activity_date": 1568132994, "creation_date": 1568132994, "answer_id": 57874910, "question_id": 57873573, "link": "https://stackoverflow.com/questions/57873573/movement-of-main-function-after-running-in-gdb/57874910#57874910", "title": "Movement of `main` function after running in gdb?", "body": "<p>The first output was printed before the process was started. In this case gdb prints the offset in the binary file.</p>\n\n<p>The second output is after the process was terminated, and you see the actual address in the memory space of the process.</p>\n"}, {"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568146865, "creation_date": 1568146865, "answer_id": 57877733, "question_id": 57873573, "link": "https://stackoverflow.com/questions/57873573/movement-of-main-function-after-running-in-gdb/57877733#57877733", "title": "Movement of `main` function after running in gdb?", "body": "<blockquote>\n  <p>What's going on here?</p>\n</blockquote>\n\n<p>You have a <a href=\"https://en.wikipedia.org/wiki/Position-independent_code#PIE\" rel=\"nofollow noreferrer\">position-independent executable</a> (which is really a special form of a shared library), which is relocated to random address at runtime.</p>\n\n<p>You can verify this by running <code>file ret0</code>, which will say something like <code>ELF 64-bit LSB pie executable, x86-64, version 1 ...</code></p>\n\n<p>To build a non-PIE executable, use <code>gcc -no-pie ...</code>. Non-position-independent executables must be loaded at the address at which they were linked, <code>main</code> will stay in place.</p>\n"}], "owner": {"reputation": 467, "user_id": 4019495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KYh5a.png?s=128&g=1", "display_name": "extremeaxe5", "link": "https://stackoverflow.com/users/4019495/extremeaxe5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568146865, "creation_date": 1568127824, "question_id": 57873573, "link": "https://stackoverflow.com/questions/57873573/movement-of-main-function-after-running-in-gdb", "title": "Movement of `main` function after running in gdb?", "body": "<p>I have the following C code in <code>ret0.c</code>. </p>\n\n<pre><code>int main(){\n  return 0;\n}\n</code></pre>\n\n<p>Compiling and running through gdb, I have the following output:</p>\n\n<pre><code>(gdb) disas main\nDump of assembler code for function main:\n   0x0000000000001119 &lt;+0&gt;: push   %rbp\n   0x000000000000111a &lt;+1&gt;: mov    %rsp,%rbp\n   0x000000000000111d &lt;+4&gt;: mov    $0x0,%eax\n   0x0000000000001122 &lt;+9&gt;: pop    %rbp\n   0x0000000000001123 &lt;+10&gt;:    retq   \nEnd of assembler dump.\n(gdb) run\nStarting program: /home/michael/core/mind/ob/thm/cs/lang/other/c/ret0 \n[Inferior 1 (process 14766) exited normally]\n(gdb) disas main\nDump of assembler code for function main:\n   0x0000555555555119 &lt;+0&gt;: push   %rbp\n   0x000055555555511a &lt;+1&gt;: mov    %rsp,%rbp\n   0x000055555555511d &lt;+4&gt;: mov    $0x0,%eax\n   0x0000555555555122 &lt;+9&gt;: pop    %rbp\n   0x0000555555555123 &lt;+10&gt;:    retq   \nEnd of assembler dump.\n</code></pre>\n\n<p>So after executing once, the location of <code>main</code> in memory has changed?\nWhat's going on here?</p>\n"}]