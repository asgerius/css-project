[{"tags": ["c", "linux", "serial-port", "file-descriptor", "read-write"], "comments": [{"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1515630579, "post_id": 48197937, "comment_id": 83377571, "body": "What&#39;s <code>InitPort</code>?"}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1515640624, "post_id": 48197937, "comment_id": 83379766, "body": "<code>errno</code> set by <code>read</code> is likely clobbered by <code>printf</code>. Try to <code>perror</code> first."}], "answers": [{"comments": [{"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 2, "creation_date": 1515635968, "post_id": 48198593, "comment_id": 83378782, "body": "The size of the UART FIFO is irrelevant to the possible number of bytes a <b>read()</b> syscall can return."}, {"owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 1, "creation_date": 1515707289, "post_id": 48198593, "comment_id": 83414596, "body": "Code that uses <code>O_NONBLOCK</code> should not expect that read() fills a buffer, because the system call will not wait for data to arrive. But you are correct, there could be many more bytes than UART internal fifo - the kernel itself buffers data. But that also means the last <code>read()</code> call happend a some time ago."}], "tags": [], "owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "is_accepted": false, "score": -1, "last_activity_date": 1515634061, "creation_date": 1515634061, "answer_id": 48198593, "question_id": 48197937, "link": "https://stackoverflow.com/questions/48197937/problems-reading-and-writing-to-the-same-file-descriptor-in-linux/48198593#48198593", "title": "Problems reading and writing to the same file descriptor in Linux", "body": "<blockquote>\n  <p>I should be reading 19 bytes in every read. [...]</p>\n  \n  <p>\"/dev/ttyS1\"</p>\n</blockquote>\n\n<p>On a serial port with only 16 byte fifo or less? I don't think that will work.</p>\n\n<p>Serial ports are character devices for a good reason - you want to code in a way that reads work anywhere from zero bytes (if a timeout is enabled), one byte and up to the size of the internal fifo. Don't expect them to stay in neat packets even if you (try to) send them that way.</p>\n"}, {"tags": [], "owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "is_accepted": true, "score": 4, "last_activity_date": 1515719557, "last_edit_date": 1515719557, "creation_date": 1515635264, "answer_id": 48198713, "question_id": 48197937, "link": "https://stackoverflow.com/questions/48197937/problems-reading-and-writing-to-the-same-file-descriptor-in-linux/48198713#48198713", "title": "Problems reading and writing to the same file descriptor in Linux", "body": "<blockquote>\n  <p>...but with 0 bytes read which means EOF has been reached.</p>\n</blockquote>\n\n<p>Incorrect.<br>\nYou're reading a serial <strong>terminal</strong> in <strong>non-blocking</strong> mode.<br>\nA return code of zero simply means that no data was available from the terminal at that time.<br>\nThat's what your program (which you should have posted) has to deal with when you use non-blocking mode.  </p>\n\n<blockquote>\n  <p>How do I get read() to read the incoming packets? </p>\n</blockquote>\n\n<p>Use blocking mode (i.e. remove the O_NONBLOCK option from the <strong>open()</strong>) if you do not want to see a return code of zero (or <code>errno</code> set to EAGAIN).<br>\nBut don't expect the <strong>read()</strong> syscall to message-align the packets for you unless you have text in canonical mode.</p>\n\n<p>Study <a href=\"https://stackoverflow.com/questions/25996171/linux-blocking-vs-non-blocking-serial-read/26006680#26006680\">this answer</a>.  </p>\n\n<blockquote>\n  <p>The 8-digit hex number in the least significant part of the packet is always similar to that shown, and is not what is expected in the packet.</p>\n</blockquote>\n\n<p>You've posted so little of your code (which is grounds for closing the question), but you try to read the data into <code>readPacket</code>, which seems to be a (byte?) array.<br>\nBut then you treat <code>readPacket</code> as if it was an integer in the <strong>printf()</strong>.   </p>\n\n<p>Printing the address of the array address (or the address of an integer variable) accomplishes nothing (i.e. <em>\"8-digit hex number ... is always similar to that shown\"</em>).  You have not displayed anything that might have been received. </p>\n\n<p>If you're using a little-endian, 32-bit processor, accessing a byte array as a long interger will reverse the order of the bytes of each word (i.e. <em>\"not what is expected\"</em>), and only access the first four bytes, which could be represented by eight hexadecimal digits .  </p>\n\n<blockquote>\n  <p>I am still fairly new to Linux ad may be missing something obvious. </p>\n</blockquote>\n\n<p>Although Linux is one of those OSes where (almost) \"everything is a file\", those \"files\" may not be equal.  In particular the device file that your program accesses, i.e. <code>/dev/ttyS1</code>, is a serial terminal device.  Serial terminals require additional device configuration, which is performed with the <strong>termios</strong> structure.<br>\nSince you have posted only a few lines of your program, and make no mention of any <strong>termios</strong> concepts other than baudrate, your program cannot be evaluated.</p>\n\n<hr>\n\n<p><strong>Addendum</strong>  </p>\n\n<p>Now that you've posted some initialization code, a few more mistakes are evident.  </p>\n\n<p>Regardless of your programming experience, the following inconsistency between what the code does and the comment is a flaw that can prolong debugging.</p>\n\n<pre><code>options.c_iflag &amp;= ~ICANON;         // Enable canonical input\n</code></pre>\n\n<p>Clearing the ICANON flag enables non-canonical input, the opposite of what the comment states.<br>\nYou have not described the 19 bytes of data, so whether canonical mode is appropriate cannot be determined.</p>\n\n<p>Your termios initialization is well written (i.e. you use the proper Boolean operators instead of direct assignments), but is incomplete (based on the existing code as executed for non-canonical mode).<br>\nAll of the necessary flags for non-canonical mode can be configured by simply using the <strong>cfmakeraw()</strong> routine.<br>\nYour code does not initialize the VMIN and VTIME parameters, but since the combination of non-canonical and non-blocking modes disables that feature, it doesn't matter. </p>\n\n<p>Since you have done a poor job of describing what you are trying to do, the appropriate corrections cannot be suggested.</p>\n"}], "owner": {"reputation": 187, "user_id": 7380925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/hx8CK.jpg?s=128&g=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/7380925/gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 48198713, "answer_count": 2, "score": 0, "last_activity_date": 1515719557, "creation_date": 1515628482, "last_edit_date": 1515689114, "question_id": 48197937, "link": "https://stackoverflow.com/questions/48197937/problems-reading-and-writing-to-the-same-file-descriptor-in-linux", "title": "Problems reading and writing to the same file descriptor in Linux", "body": "<p>I am getting successful reads of a fd in Linux, but with 0 bytes read which means EOF has been reached. I should be reading 19 bytes in every read.</p>\n\n<p>The project is a motor driver that sends out packets of 19 bytes to drive 2 DC motors, and it also needs to read the same size packet coming from the motor with updated position, command, and status info.</p>\n\n<p>I open the fd like this:</p>\n\n<pre><code>mc_fd = InitPort(\"/dev/ttyS1\", \"COM2\", O_NONBLOCK | O_RDWR | O_SYNC, B115200); \n</code></pre>\n\n<p>Here is the function to initialize the port:</p>\n\n<pre><code>int InitPort( char *port, char *name, int oflags, speed_t baudRate ) {\n\nint fd;                             // File descriptor\nfd = open(port, oflags);            // Open the port like a file\nassert(fd &gt; 0);                     // Open returns -1 on error\n\nstruct termios options;             // Initialize a termios struct\ntcgetattr(fd, &amp;options);            // Populate with current attributes\ncfsetospeed (&amp;options, baudRate);   // Set baud rate out\ncfsetispeed (&amp;options, baudRate);   // Set baud rate in (same as baud rate out)\noptions.c_cflag &amp;= ~CSIZE;          // Clear bit-length flag so it can be set\n    //8N1 Serial Mode\n    options.c_cflag |=  CS8;        // Set bit-length:  8\n    options.c_cflag &amp;= ~PARENB;     // Set parity:      none\n    options.c_cflag &amp;= ~CSTOPB;     // Set stop bit:        1\n    options.c_cflag &amp;= ~CRTSCTS;    // Set flow control:    none\n\noptions.c_iflag &amp;= ~ICANON;         // Enable canonical input\noptions.c_oflag &amp;= ~OPOST;          // Disables all output processing (prevents CR in output)\noptions.c_cflag |= (CLOCAL | CREAD);// Enable receiver, and set local mode\ntcsetattr(fd, TCSANOW, &amp;options);   // Set new attributes to hardware\nreturn fd;\n}\n</code></pre>\n\n<p>Originally, I only used the O_RDWR flag and reads of the fd would fail with EAGAIN (or EWOULDBLOCK). I have been trying synchronization and non-blocking settings to see if I could receive packets. At least now I am reading successfully (I think).</p>\n\n<p>I am able to write packets out at 120Hz, and reads of the fd return \"success\" at the same rate, although with 0 bytes read. </p>\n\n<p><strong>How do I get read() to read the incoming packets?</strong> \nHere is the read code along with the output from the terminal:</p>\n\n<pre><code>bytesRead = read( mc_fd, readPacket, MC_PACKET_SIZE );\nprintf(\"\\npacket: %019X\\n\", &amp;readPacket);\nperror(\"error type \");\nprintf(\"bytes read = %d\\n\", bytesRead);\n\npacket: 00000000000B63B4140\nerror type : Success\nbytes read = 0\n</code></pre>\n\n<p>The 8-digit hex number in the least significant part of the packet is always similar to that shown, and is not what is expected in the packet.</p>\n\n<p>This is Debian running on an embedded linux SBC (single board computer). I am able to read other file descriptors in the program with no problems. I am still fairly new to Linux and may be missing something obvious. Thanks!</p>\n"}, {"tags": ["c", "fgets", "strtok"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1515626298, "post_id": 48197630, "comment_id": 83376389, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1515626657, "post_id": 48197630, "comment_id": 83376489, "body": "Thanks for the comment William, but I have no idea how to read files in C (I have never seen C until a few days ago), instructions were to use &quot;EOF&quot; to determine when file ends. Is there a different way to do this but still use EOF? Im not even sure what to google for to find an answer, thats why I came here to hopefully get pointed in the right direction."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1515626795, "post_id": 48197630, "comment_id": 83376527, "body": "@Duxa the best way is <code>while(fgets(line, sizeof line, stdin)) { &#47;&#47; code }</code>"}, {"owner": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 1, "creation_date": 1515627426, "post_id": 48197630, "comment_id": 83376703, "body": "tip: just check the start of the line for &#39;one &#39; with strncmp - then you onyl need to tokenize it if it is a match"}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 0, "creation_date": 1515627631, "post_id": 48197630, "comment_id": 83376753, "body": "@MartinBeckett , yes I thought that too, but I am not sure how to go to next line if I do not need to tokenize it."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515627710, "post_id": 48197630, "comment_id": 83376781, "body": "@Pablo I tried this; however sizeof line leads to random chunks of the strings being read(each string is different length)"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515627860, "post_id": 48197630, "comment_id": 83376815, "body": "@Duxa in that case you can make the buffer longer or you write a function <code>getline</code> that calls <code>fgets</code> until a newline is read or the end of file is reached."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515628100, "post_id": 48197630, "comment_id": 83376873, "body": "@Duxa Who or what text suggest using <code>!feof(file)</code>?"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1515628111, "post_id": 48197630, "comment_id": 83376877, "body": "<code>sizeof line</code> will have different values for pointer to characters and character array."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515628330, "post_id": 48197630, "comment_id": 83376935, "body": "@chux Professor at my University. He said to use &quot;\\n&quot; to find end of line and EOF for end of file. When I googled those the above code is what I could come up with. Its much harder to find info for C than it is for C++ :("}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515628434, "post_id": 48197630, "comment_id": 83376968, "body": "yes, I should add to my comment, that <code>sizeof line</code> only works when <code>line</code> is a <code>char[]</code>, not when line is pointer (like alvits says in his/her comment)"}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515628856, "post_id": 48197630, "comment_id": 83377065, "body": "@Pablo If I have allocated 100 bytes to the char to store the line that I read, is there any harm to just using 100    fgets(line, 100, file); and not use size of? Does sizeof give anything extra (other than obvious code modularity where modifying allocated size will automatically change the value in the fgets call? To clarify my quesstion. Does sizeof do anything other than plug in that number?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1515629188, "post_id": 48197630, "comment_id": 83377177, "body": "@Duxa no, it doesn&#39;t do any harm using 100 in <code>fgets</code> However, let&#39;s say you later change your <code>malloc</code> to allocate 50 instead of 100 and you&#39;ve forgotten to change the <code>fgets</code> line, then you <i>might</i> end up with a stack overflow. That&#39;s why I usually do <code>char line[1024]; fgets(line, sizeof line, stdin)</code>, so I change the dimension of <code>line</code>, I don&#39;t have to worry about <code>fgets</code>."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515629286, "post_id": 48197630, "comment_id": 83377205, "body": "Ok thanks for clarifying @Pablo :) Thats a very good reason to use it, I just wanted to make sure its not doing something else Im not aware of. I was able to make it work... so im reading the file with fgets... now to figure out the rest of it."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515629597, "post_id": 48197630, "comment_id": 83377301, "body": "@Duxa no problem. These are the kind of things you realize once you&#39;ve got enough experience and you&#39;ve spent hour hunting stupid bugs (like forgetting to change the size argument in <code>fgets</code>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515630468, "post_id": 48197630, "comment_id": 83377547, "body": "@duxa, It might be interesting to offer  <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> to your  Professor.  But to be fair, while  <code>while(!feof(file)){</code> is weak, it is the lack of checking the return of <code>fgets()</code>in this code  that is the great folly."}], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1515629202, "post_id": 48197959, "comment_id": 83377179, "body": "Once tokenized &quot;line&quot; char array can be repurposed? Or do tokens still rely on that variable staying intact?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 1, "creation_date": 1515629400, "post_id": 48197959, "comment_id": 83377237, "body": "@Duxa you shouldn&#39;t touch the array, because <code>strtok</code> uses it for the next tokens. Unless of course you don&#39;t want to use <code>strtok</code> any more. But beware that <code>strtok</code> modifies the array. So if you later still need to access the whole line, it&#39;s best to do a copy first and then tokenize."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1515629638, "post_id": 48197959, "comment_id": 83377312, "body": "Are you sure that the code should be considered <a href=\"https://en.wiktionary.org/wiki/ill-formed\" rel=\"nofollow noreferrer\">ill formed</a>? I believe that term has a rather more specific meaning, which does not apply here."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1515630280, "post_id": 48197959, "comment_id": 83377498, "body": "@eof OK - post amended."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1515633091, "post_id": 48197959, "comment_id": 83378193, "body": "@chux Well damn.... I just found out that I cant utilize nested strtok. The &quot;temp&quot; file I am comparing with comes from another file and I used strtok to read from that one.  that one is easier because its just one line separated by whitespace.  so Im reading one string from that file, then comparing that with this second file. I guess I cant use strstok in this case? Whats an alternative?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1515638966, "post_id": 48197959, "comment_id": 83379431, "body": "@Duxa &quot;I just found out that I cant utilize nested strtok&quot; is a new requirement not in the question.  If not using <code>strtok()</code> was important, 1) your sample code should not have used it 2) original question should have stated that restriction. <a href=\"https://stackoverflow.com\">Stack Overflow</a> is a &quot;you ask a question&quot;, folks answer it.  Else we could be going round and round - with no end in sight.  If you have a new question, learn from this one, review your code,  search SO for fixes and employ a fix the best you can. If code still has a new issue,   post another question."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1515639283, "post_id": 48197959, "comment_id": 83379486, "body": "@chux Thanks. I would have liked to use strtok, and I tried to make the question simple hence I didnt use nested strtok since i thought id be able to do that once you guys helped me with the simple problem.  Thanks for your help. Ill keep your advice in mind next time."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515639472, "post_id": 48197959, "comment_id": 83379525, "body": "@Duza Consider a simple <code>p = line; while(*p &amp;&amp; !issapce(*p)) p++;</code> to find the next space.  Also research <code>strcspn()</code>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1515630729, "last_edit_date": 1515630729, "creation_date": 1515628602, "answer_id": 48197959, "question_id": 48197630, "link": "https://stackoverflow.com/questions/48197630/reading-file-line-by-line-read-first-string-if-match-then-use-rest-of-the-line/48197959#48197959", "title": "Reading file line by line, read first string, if match then use rest of the line, otherwise move to next line", "body": "<blockquote>\n  <p>Reading file line by line, read first string, if match then use rest of the line, otherwise move to next line</p>\n</blockquote>\n\n<p>In all cases, code needs to reads the entire line - it is just a question of how input is used.</p>\n\n<p>Do not use this <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">problematic code</a></p>\n\n<pre><code>// while(!feof(file)){\n//  fgets(line, 100, file);\n</code></pre>\n\n<p>Instead </p>\n\n<pre><code>while(fgets(line, sizeof line, file)) {\n</code></pre>\n\n<p>Now parse the string, add \\n to the delimit list.</p>\n\n<pre><code>  int count = 0;\n  string_token = strtok(line, \" \\n\");\n  // compare the the i'th `compare_to[i]` or \n  // what ever fulfills \"then I do a comparison with a variable\"\n  if (string_token != NULL &amp;&amp; strcmp(compare_to[i], string_token) == 0){\n    printf(\"&lt;%s&gt;\\n\", string_token );   \n    string_token = strtok(NULL, \" \\n\");\n    count++; \n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5979025"}, "is_accepted": false, "score": 0, "last_activity_date": 1515648980, "creation_date": 1515648980, "answer_id": 48200390, "question_id": 48197630, "link": "https://stackoverflow.com/questions/48197630/reading-file-line-by-line-read-first-string-if-match-then-use-rest-of-the-line/48200390#48200390", "title": "Reading file line by line, read first string, if match then use rest of the line, otherwise move to next line", "body": "<p>You can do this:</p>\n\n<pre><code>char first_str[128];\nwhile(fgets(line, 100, file) != NULL)\n{\n    sscanf(line, \"%s\", first_str);\n    if(strcmp(first_str, \"your_str\") == 0)\n    {\n        // match\n        // so use result of the line\n    }\n}\n</code></pre>\n\n<p>Basically, you are reading the whole line, then using <code>sscanf</code> to check the 1st string and then proceed depending on what your condition is.</p>\n\n<p><strong>EDIT</strong>: Make sure your array length is long enough to hold the string.</p>\n"}], "owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1515648980, "creation_date": 1515626135, "last_edit_date": 1515626762, "question_id": 48197630, "link": "https://stackoverflow.com/questions/48197630/reading-file-line-by-line-read-first-string-if-match-then-use-rest-of-the-line", "title": "Reading file line by line, read first string, if match then use rest of the line, otherwise move to next line", "body": "<p>I am unfortunately a complete novice when it comes to C. I am trying to read a text file which is formatted something like this</p>\n\n<pre><code>one two three\ntwo one three\nthree one \n</code></pre>\n\n<p>I need to read the first string on a line (so in case of first line that would be \"one\", then I do a comparison with a variable. If its a match then I need to use rest of the string, so if a match on string one I need to use \"two\" and \"three\" (separately as their own strings).\nIf there is no match I move on to the next line and so on.</p>\n\n<p>Here is the code I have so far, but it doesnt seem to work. In comments what I think the code is doing.</p>\n\n<pre><code>char temp[] = \"three\";\nwhile(!feof(file)){ //Go until end of file is reached\n    fgets(line, 100, file); //Grab the line\n    string_token = strtok(line, \" \"); //Tokenize the line \n    strcpy (compare_to, string_token); //Copy first token into a string variable\n    if (strcmp(compare_to, temp) == 0){ //Compare string with a predefined temp variable\n        while (string_token != NULL) { //If it was a match then we go until tokens end (which would be end of the line from a file)\n            printf(\"%s has the following: %s\\n\", temp,compare_to );   \n            string_token = strtok(NULL, \" \");\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop", "struct", "iteration"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515623572, "post_id": 48196832, "comment_id": 83375402, "body": "Please read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>. You tell us, there is a problem but not what is your problem. Also, run it with valgrind or use a debugger."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515624658, "post_id": 48196832, "comment_id": 83375811, "body": "What&#39;s the point of <code>Lista_utenti()</code>? It reads all the lines from <code>Archivio.txt</code> into a linked list, but never saves the list anywhere. It just prints it, but never frees any of the memory. Then <code>Info_video</code> re-reads the file. Why not return the list and pass it to <code>Info_video</code>?"}, {"owner": {"reputation": 87, "user_id": 9170190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mnZTh.jpg?s=128&g=1", "display_name": "Gwynbleidd", "link": "https://stackoverflow.com/users/9170190/gwynbleidd"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515663593, "post_id": 48196832, "comment_id": 83388625, "body": "@Pablo i will keep in mind your advice!"}, {"owner": {"reputation": 87, "user_id": 9170190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mnZTh.jpg?s=128&g=1", "display_name": "Gwynbleidd", "link": "https://stackoverflow.com/users/9170190/gwynbleidd"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515663715, "post_id": 48196832, "comment_id": 83388704, "body": "@Barmar, yes the function Lista_utenti must only print the linked list."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515688328, "post_id": 48196832, "comment_id": 83404802, "body": "It should free the memory of the linked list when it&#39;s done, otherwise you have a memory leak."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1515625660, "creation_date": 1515625660, "answer_id": 48197558, "question_id": 48196832, "link": "https://stackoverflow.com/questions/48196832/c-iteration-with-two-structs/48197558#48197558", "title": "C iteration with two structs", "body": "<p>This is wrong:</p>\n\n<pre><code>for(i=0; i&lt;N; i++){\n    for (j=0; j&lt;N; j++){\n</code></pre>\n\n<p>You don't have <code>N</code> valid elements in <code>dati</code> and <code>profilo</code>, that's just the maximum. You should save the value of the counter after you read the user and video information. I've added variables <code>dati_count</code> and <code>profilo_count</code>.</p>\n\n<p>You also need to set <code>i</code> back to <code>0</code> before the loop that reads from <code>ptr_video</code>, so that you fill in the <code>profilo</code> array from the beginning.</p>\n\n<p>And you should check whether <code>sscanf()</code> succeeds.</p>\n\n<pre><code>#Include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define N 100\n\nstruct DATI{ // STRUTTURA NON DINAMICA\n    char nome [N];\n    char cognome [N];\n    char username[N];\n    char email [N];\n};\n\nstruct DATI dati [N];\nint dati_count;\n\nstruct PROFILO{ // STRUTTURA NON DINAMICA\n    char username [N];\n    char email [N];\n    char titolo_video [N];\n    int durata_video;\n    int dimensione_video;\n};\n\nstruct PROFILO profilo [N];\nint profilo_count;\n\nstruct UTENTI{  // LINKED LIST\n    char* account;\n    struct UTENTI *next;\n};\n\ntypedef struct UTENTI utenti;\n\n// PROTOTIPO FUNZIONI\n\nvoid Lista_utenti(FILE *ptr_archivio);\nvoid Info_video(FILE *ptr_dati, FILE *ptr_video);\n\n// MAIN\n\nint main (){\n\n    FILE *ptr_archivio; //LINKED LIST\n\n    FILE *ptr_video;\n    FILE *ptr_dati;\n\n    // PER LA LINKED LIST\n    ptr_archivio = fopen(\"Archivio.txt\" , \"r\");\n\n    // CONFRONTO ARCHIVIO E VIDEO\n    ptr_video = fopen(\"Video.txt\" , \"r\");\n    ptr_dati = fopen(\"Archivio.txt\" , \"r\");\n\n    Lista_utenti(ptr_archivio);\n    Info_video(ptr_dati, ptr_video);\n\n    return 0;\n\n}\n\n// DEFINIZIONE FUNZIONI\n\nvoid Lista_utenti(FILE *ptr_archivio){ // FUNZIONE PER LA LINKED LIST\n\n    char lista [N];\n\n    utenti *current, *head;\n    head = current = NULL;\n\n    if (ptr_archivio == NULL){\n        printf(\"Errore, file non trovato!\");\n    }\n\n    else{\n\n        while(fgets(lista,sizeof(lista), ptr_archivio)){\n            utenti *node = malloc(sizeof(utenti));\n            node-&gt;account = strdup(lista);\n            node-&gt;next = NULL;\n\n            if(head == NULL){\n                current = head = node;\n            }\n            else {\n                current = current-&gt;next = node;\n            }\n        }\n        fclose(ptr_archivio);\n    }\n\n    printf(\"LINKED LIST UTENTI\\n\");\n\n    for(current = head; current ; current=current-&gt;next){\n        printf(\"%s-&gt;\", current-&gt;account);\n    }\n    printf(\"NULL\\n\");\n}\n\nvoid Info_video(FILE *ptr_dati, FILE *ptr_video){ // FUNZIONE PER CONFRONTO FILE ARCHIVIO E VIDEO\n\n    int counter = 0;\n    int j = 0;\n    int i = 0;\n    int totale = 0;\n    char video [N];\n    char archivio[N];\n\n    if (ptr_dati == NULL){\n        printf(\"Errore, file non trovato!\");\n    }\n    else {\n        while(fgets(archivio, N, ptr_dati)!= NULL){\n            if (sscanf(archivio, \"%s %s %s %s\", dati[i].nome, dati[i].cognome, dati[i].username, dati[i].email) != 4) {\n                continue;\n            }\n            printf(\"\\n\\n\");\n            printf(\"Nome: %s\\n\" , dati[i].nome);\n            printf(\"Cognome: %s\\n\" , dati[i].cognome);\n            printf(\"Username: %s\\n\" , dati[i].username);\n            printf(\"Email: %s\\n\" , dati[i].email);\n            printf(\"\\n\\n\");\n            i++;\n        }\n    }\n\n    fclose(ptr_dati);\n    dati_count = i;\n\n    if (ptr_video == NULL){\n        printf(\"Errore, file non trovato!\");\n    }\n    else {\n        i = 0;\n        while(fgets(video, N, ptr_video)!= NULL){\n            if (sscanf(video, \"%s %s %s %d %d\", profilo[i].username, profilo[i].email, profilo[i].titolo_video, &amp;profilo[i].durata_video, &amp;profilo[i].dimensione_video) != 5) {\n                continue;\n            }\n            printf(\"\\n\\n\");\n            printf(\"Username: %s\\n\" , profilo[i].username);\n            printf(\"Email: %s\\n\" , profilo[i].email);\n            printf(\"Titolo video: %s\\n\" , profilo[i].titolo_video);\n            printf(\"Durata video: %d secondi\\n\" , profilo[i].durata_video);\n            printf(\"Dimensione video: %d mb\\n\" , profilo[i].dimensione_video);\n            totale = totale + profilo[i].durata_video;\n            i++;\n            printf(\"\\n\\n\");\n        }\n\n        fclose(ptr_video);\n        profilo_count = i;\n    }\n    printf(\"La durata totale di tutti i video caricati e' di %d secondi\\n\" , totale);\n\n    for(i=0; i&lt;dati_count; i++){\n        for (j=0; j&lt;profilo_count; j++){\n            if (strcmp(dati[i].username,profilo[j].username)== 0){\n                counter = counter+1;\n                if (counter == 3){\n                    printf(\"\\nIl seguente utente %s ha caricato almeno 3 video\" , dati[i].username);\n                    counter = 0;\n\n                }\n            }\n        }\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9170190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mnZTh.jpg?s=128&g=1", "display_name": "Gwynbleidd", "link": "https://stackoverflow.com/users/9170190/gwynbleidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 48197558, "answer_count": 1, "score": -2, "last_activity_date": 1533876290, "creation_date": 1515621730, "last_edit_date": 1533876290, "question_id": 48196832, "link": "https://stackoverflow.com/questions/48196832/c-iteration-with-two-structs", "title": "C iteration with two structs", "body": "<p>The program should print the username of the user who has uploaded at least three videos.<br>\nI think that the problem is with the last nested <code>for</code>, the first row that is printed is correct, but the others aren't. \nThese are the files:</p>\n\n<p><strong>Archivio.txt</strong></p>\n\n<pre><code>Ciro Esposito cir0esp ciro.esposito@gmail.com\nGennaro Sorrentino gennSor gennaro.sorrentino@gmail.com\nPasquale Zemma pasZem pasquale.zemma@gmail.com \n</code></pre>\n\n<p><strong>Video.txt</strong></p>\n\n<pre><code>cir0esp ciro.esposito@gmail.com  Io_al_mare 15 34\npasZem pasquale.zemma@gmail.com  Festa_di_laurea 358 623\ngennSor gennaro.sorrentino@gmail.com  Io_allo_stadio 45 97\ncir0esp ciro.esposito@gmail.com  Io_in_montagna 446 814\ngennSor gennaro.sorrentino@gmail.com  Io_al_parco 66 124\ncir0esp ciro.esposito@gmail.com  Io_in_auto 10 23\n</code></pre>\n\n<p><strong>The code</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define N 100\n\nstruct DATI{ // STRUTTURA NON DINAMICA\n    char nome [N];\n    char cognome [N];\n    char username[N];\n    char email [N];\n};\n\nstruct DATI dati [N];\n\nstruct PROFILO{ // STRUTTURA NON DINAMICA\n    char username [N];\n    char email [N];\n    char titolo_video [N];\n    int durata_video;\n    int dimensione_video;\n};\n\nstruct PROFILO profilo [N];\n\nstruct UTENTI{  // LINKED LIST\n    char* account;\n    struct UTENTI *next;\n};\n\ntypedef struct UTENTI utenti;\n\n// PROTOTIPO FUNZIONI\n\nvoid Lista_utenti(FILE *ptr_archivio);\nvoid Info_video(FILE *ptr_dati, FILE *ptr_video);\n\n// MAIN\n\nint main (){\n\n    FILE *ptr_archivio; //LINKED LIST\n\n    FILE *ptr_video;\n    FILE *ptr_dati;\n\n    // PER LA LINKED LIST\n    ptr_archivio = fopen(\"Archivio.txt\" , \"r\");\n\n    // CONFRONTO ARCHIVIO E VIDEO\n    ptr_video = fopen(\"Video.txt\" , \"r\");\n    ptr_dati = fopen(\"Archivio.txt\" , \"r\");\n\n    Lista_utenti(ptr_archivio);\n    Info_video(ptr_dati, ptr_video);\n\n    return 0;\n\n}\n\n// DEFINIZIONE FUNZIONI\n\nvoid Lista_utenti(FILE *ptr_archivio){ // FUNZIONE PER LA LINKED LIST\n\n    char lista [N];\n\n    utenti *current, *head;\n    head = current = NULL;\n\n    if (ptr_archivio == NULL){\n        printf(\"Errore, file non trovato!\");\n    }\n\n    else{\n\n        while(fgets(lista,sizeof(lista), ptr_archivio)){\n            utenti *node = malloc(sizeof(utenti));\n            node-&gt;account = strdup(lista);\n            node-&gt;next = NULL;\n\n            if(head == NULL){\n                current = head = node;\n            }\n            else {\n                current = current-&gt;next = node;\n            }\n        }\n        fclose(ptr_archivio);\n    }\n\n    printf(\"LINKED LIST UTENTI\\n\");\n\n    for(current = head; current ; current=current-&gt;next){\n        printf(\"%s-&gt;\", current-&gt;account);\n    }\n    printf(\"NULL\\n\");\n}\n\nvoid Info_video(FILE *ptr_dati, FILE *ptr_video){ // FUNZIONE PER CONFRONTO FILE ARCHIVIO E VIDEO\n\n    int counter = 0;\n    int j = 0;\n    int i = 0;\n    int totale = 0;\n    char video [N];\n    char archivio[N];\n\n    if (ptr_dati == NULL){\n        printf(\"Errore, file non trovato!\");\n    }\n    else {\n        while(fgets(archivio, N, ptr_dati)!= NULL){\n            sscanf(archivio, \"%s %s %s %s\", dati[i].nome, dati[i].cognome, dati[i].username, dati[i].email);\n            printf(\"\\n\\n\");\n            printf(\"Nome: %s\\n\" , dati[i].nome);\n            printf(\"Cognome: %s\\n\" , dati[i].cognome);\n            printf(\"Username: %s\\n\" , dati[i].username);\n            printf(\"Email: %s\\n\" , dati[i].email);\n            printf(\"\\n\\n\");\n            i++;\n        }\n    }\n\n    fclose(ptr_dati);\n\n    if (ptr_video == NULL){\n        printf(\"Errore, file non trovato!\");\n    }\n    else {\n\n        while(fgets(video, N, ptr_video)!= NULL){\n            sscanf(video, \"%s %s %s %d %d\", profilo[i].username, profilo[i].email, profilo[i].titolo_video, &amp;profilo[i].durata_video, &amp;profilo[i].dimensione_video);\n            printf(\"\\n\\n\");\n            printf(\"Username: %s\\n\" , profilo[i].username);\n            printf(\"Email: %s\\n\" , profilo[i].email);\n            printf(\"Titolo video: %s\\n\" , profilo[i].titolo_video);\n            printf(\"Durata video: %d secondi\\n\" , profilo[i].durata_video);\n            printf(\"Dimensione video: %d mb\\n\" , profilo[i].dimensione_video);\n            totale = totale + profilo[i].durata_video;\n            i++;\n            printf(\"\\n\\n\");\n        }\n\n        fclose(ptr_video);\n    }\n    printf(\"La durata totale di tutti i video caricati e' di %d secondi\\n\" , totale);\n\n    for(i=0; i&lt;N; i++){\n        for (j=0; j&lt;N; j++){\n            if (strcmp(dati[i].username,profilo[j].username)== 0){\n                counter = counter+1;\n                if (counter == 3){\n                    printf(\"\\nIl seguente utente %s ha caricato almeno 3 video\" , dati[i].username);\n                    counter = 0;\n\n                }\n            }\n        }\n    } \n}\n</code></pre>\n"}, {"tags": ["c", "ip", "scanf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515621029, "post_id": 48196658, "comment_id": 83374359, "body": "<code>fgets</code> and then parse."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1515621326, "post_id": 48196658, "comment_id": 83374485, "body": "<code>scanf(&quot;%d.%d.%d.%d&quot;, &amp;a, &amp;b, &amp;c, &amp;d);</code> would work, but that would also accept entries like <code>999.99.999.99999</code> which is <b>not</b> an IP address. If you are using a unix like system, you could also use <a href=\"http://man7.org/linux/man-pages/man3/inet_pton.3.html\" rel=\"nofollow noreferrer\"><code>inet_pton</code></a> instead."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515621814, "post_id": 48196658, "comment_id": 83374715, "body": "Show us the content of your file, at least one line to see the input."}, {"owner": {"reputation": 326, "user_id": 9195303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQ2uZ.jpg?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/9195303/stefan"}, "edited": false, "score": 1, "creation_date": 1515622002, "post_id": 48196658, "comment_id": 83374774, "body": "RACUNAR1 52.123.213.11 100. This is input the name of a pc , its ip adress and his internet speed"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515624906, "post_id": 48196658, "comment_id": 83375903, "body": "Rather than compare the output with <code>fscanf(in, &quot;%s %d %d&quot;, ....) != EOF</code> as it is 1 value code does not want, compare to the number of desired successful conversions with <code>fscanf(in, &quot;%s %d %d&quot;, name, &amp;ip_adress, &amp;speed) == 3</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515625105, "post_id": 48196955, "comment_id": 83375966, "body": "<code>ipAsArray+3</code> incurs an endian dependent solution. Recommend <code>uint8_t ipAddress[4];</code> instead."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515625392, "post_id": 48196955, "comment_id": 83376079, "body": "@chux: agree in general; yet it seemed to me that OP wants to use an <code>int</code> type, probably due to a given interface <code>create_new_item(name, ip_adress, speed)</code>; But maybe my assumption is wrong; then <code>ipAddress[4]</code> is more independent, of course."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515626459, "post_id": 48196955, "comment_id": 83376443, "body": "I suspect this will work for OP, yet that pesky anti-aliasing rule comes into play.  Code does not need to assume <code>ipAddress</code> changed due to <code>sscanf(testLine, &quot;%s %hhu....&quot;, name, ipAsArray+3, ...</code> and could attempt to print uninitialized data."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515650134, "post_id": 48196955, "comment_id": 83382167, "body": "Formally, the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/scanf.html\" rel=\"nofollow noreferrer\"><code>scanf()</code></a> spacification says that using <code>%hhu</code> to convert a value too big to fit in an <code>unsigned char</code> leads to undefined behaviour.  (<i>If this object does not have an appropriate type, or if the result of the conversion cannot be represented in the space provided, the behavior is undefined.</i>)  Also, for whatever it is worth, <code>%hhu.%hhu.%hhu.%hhu</code> will convert <code>&quot; -234.  +379.  456.  9&quot;</code> because the <code>%hhu</code> will skip blanks and handle signs, etc."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515790835, "post_id": 48196955, "comment_id": 83450383, "body": "@chux: good point concerning uninitialized data, thanks. Addressed the issue by making <code>ipAddress</code> volatile."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515791337, "post_id": 48196955, "comment_id": 83450579, "body": "@Jonathan Leffler: is <code>%hhu</code>-specifier together with an input like <code>1025</code> really UB? I thought that the input sequence <i>&quot;shall be converted to a type appropriate to the conversion character.&quot;</i>, and the properly converted value is written to the respective object. Corresponding  to <code>%hhu</code>,  <code>1025</code> would be converted to an  8 bit  unsigned value first, so no overflow. Otherwise any use of <code>scanf</code>with <code>%d, %u, %hhu, ...</code> could possibly lead to UB purely depending on the input provided, and the programmer would have to check input first before using <code>scanf</code> in order  to be safe. Are you sure?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515792369, "post_id": 48196955, "comment_id": 83450956, "body": "Concerning &quot;Corresponding to %hhu, 1025 would be converted to an 8 bit unsigned value first, so no overflow.&quot;  I do not think so. <code>&quot;%hhu&quot;</code> corresponds to a pointer <code>unsigned char *</code>.  Why would 1025 attempt to convert to an<code>unsigned</code> first and not directly to <code>unsigned char</code>?  (which fails due to outside <code>unsigned char</code> range - might take on the value 255)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515792519, "post_id": 48196955, "comment_id": 83451023, "body": "<code>volatile</code> --- interesting way to solve anti-aliasing (AA)."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515794433, "post_id": 48196955, "comment_id": 83451734, "body": "@chux: maybe I expressed it wrong; I don&#39;t think that <code>1025</code> will ever be converted to an <code>unsigned</code> value, but always to an <code>unsigned char</code>-value (i.e. <code>1025</code>  for <code>%hhu</code> never yields <code>0x401</code>, but always <code>0x01</code>); Right?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515795347, "post_id": 48196955, "comment_id": 83452077, "body": "@StephanLechner  &quot;1025 for %hhu ... yields ...always 0x01); Right?&quot;  &quot;Always&quot; is a long time.  I would not agree with &quot;always 0x01&quot;.   %u --&gt; says &quot;Matches ...  decimal integer, whose format is the same as expected for the subject sequence of the <code>strtoul</code> function ...&quot;  That <code>strtoul</code> looks like a mistake in the C spec. as <code>%llu</code> certainly means to use <code>strtoull()</code>.  So it is reasonable to extend that to mean could %hhu use a theoretical <code>strtouchar()</code> when <code>&quot;1025&quot;</code> --&gt; 255.  Perhaps post as a question?  By extension, I doubt  <code>&quot;0x1234567890...12345678900000042&quot;</code> and <code>&quot;%hhu&quot;</code> must go to 0x42."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515799483, "post_id": 48196955, "comment_id": 83453317, "body": "A common implementation would be to define that over-large values presented to <code>%hhu</code> are treated modulo 256, ignoring any high-order bits.  That&#39;s a perfectly valid response to undefined behaviour.  I&#39;d be hard-pressed to think of an implementation that wouldn&#39;t behave like that, but the standard doesn&#39;t say that an implementation must do that.  It simply says that it (the standard) doesn&#39;t define what happens.  It&#39;s one of the many messy areas in standard C.  The standard avoids over-prescribing what implementations must do, which means the programmers must be careful with what they assume."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 4, "last_activity_date": 1515790763, "last_edit_date": 1515790763, "creation_date": 1515622344, "answer_id": 48196955, "question_id": 48196658, "link": "https://stackoverflow.com/questions/48196658/how-to-scan-ip-address-with-fscanf/48196955#48196955", "title": "How to scan IP Address with fscanf", "body": "<p>You could use format specifier <code>%hhu.%hhu.%hhu.%hhu</code>, which reads in unsigned 8 bit values, and you could directly read into the 4 bytes of your int-representation of an ip-address, respectively:</p>\n\n<pre><code>int main () {\n\n    const char* testLine = \"aName 192.168.112.54 100\";\n\n    char name[100];\n    int speed;\n\n    volatile uint32_t ipAddress=0;\n    unsigned char* ipAddressBytes = (unsigned char*)&amp;ipAddress;\n\n\n    if (sscanf(testLine, \"%s %hhu.%hhu.%hhu.%hhu %d\", name, ipAddressBytes+3, ipAddressBytes+2,ipAddressBytes+1,ipAddressBytes+0, &amp;speed) == 6) {\n        printf(\"%s %08X %d\\n\",name, ipAddress, speed);\n    }\n\n    return 0;   \n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>aName C0A87036 100\n</code></pre>\n\n<p>Format <code>%hhu</code> reads in an integral value and maps it to 8 bits; hence, it does not check if the input concerning the IP-address is valid in the sense that <code>1025.168.112.54</code> would not be valid. However, it avoids technical overflows in that any part exceeding 8 bits is simply ignored. So before mentioned input would yield <code>01A87036</code>.</p>\n\n<p>Note the <code>volatile</code>-specifier, which tells the compiler that it shall not optimize access to this variable; otherwise, the compiler might assume that - since the value is not obviously changed - the variable is unchanged / not initialized.</p>\n\n<p>Note further that you have to take care whether your environment is of big endian or little endian architecture. </p>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1515627711, "last_edit_date": 1515627711, "creation_date": 1515627369, "answer_id": 48197798, "question_id": 48196658, "link": "https://stackoverflow.com/questions/48196658/how-to-scan-ip-address-with-fscanf/48197798#48197798", "title": "How to scan IP Address with fscanf", "body": "<blockquote>\n  <p>How to scan IP Adress with fscanf</p>\n</blockquote>\n\n<p>With <em>line</em> data, <code>fgets()</code> has many advantages, including better error recovery than <code>fscanf()</code>, so a <code>fgets/sscanf()</code> solution</p>\n\n<pre><code>void read_tree_from(FILE *in, PC **root){\n  char buffer [MAX_NAME + 50];\n  // Read a line of input\n  if (fgets(buffer, sizeof buffer, in)) {\n    int ip_address;\n    int speed;\n    unsigned char octet[4];\n    int n = 0;\n    int namelen; \n\n    // This approach uses %n to record the scan offset - if it got that far \n    // %*s%n to scan over the name, all tht is needed is how long it is\n    // %hhu to scan an `unsigned char`\n    // \" .\" to scan spaces and then a '.'\n    sscanf(buffer, \"%*s%n %hhu .%hhu .%hhu .%hhu %d %n\",\n      &amp;namelen, &amp;octet[0], &amp;octet[1], &amp;octet[2], &amp;octet[3], &amp;speed, &amp;n);\n\n    // When `n &gt; 0`, the complete scan occurred\n    // buffer[n] != '\\0' detects extra junk after the speed\n    if (n == 0 || buffer[n] != '\\0') {\n      // failed scan\n      return;\n    }\n\n    // Check data for validity \n    if (namelen &gt;= MAX_NAME) {\n      // name too long\n      return;\n    }\n\n    buffer[namelen] = '\\0';  // \\0 terminate the name\n\n    // form IP address.  I'd recommend `uint32_t` rather than `int`\n    // The `1u*` insures code deals with unsigned promotions and shifts.  No sign extend\n    ip_address = 1u*octet[0] &lt;&lt; 24 | 1u*octet[1] &lt;&lt; 16 | 1u*octet[2] &lt;&lt; 8 | octet[3];\n\n    PC *new = create_new_item(buffer, ip_adress, speed);\n    add_to_tree(new, root);\n    }\n  }\n}\n</code></pre>\n\n<blockquote>\n  <p>or there is a easier way (?)</p>\n</blockquote>\n\n<p>Yes, if code does not care about detecting ill-form data, many short-cuts are available.  Production code checks for bad data.  Robust checking would take the <code>buffer</code> and look for numeric values out of range, (maybe with strtoul), etc.</p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 9195303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQ2uZ.jpg?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/9195303/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1515797636, "creation_date": 1515797636, "answer_id": 48235123, "question_id": 48196658, "link": "https://stackoverflow.com/questions/48196658/how-to-scan-ip-address-with-fscanf/48235123#48235123", "title": "How to scan IP Address with fscanf", "body": "<p>I tried this the first time but it didnt work probably bcs i had some error somewhere else in the code and i tought this was the part that making the eror.But it worked when i fixed some mistakes in my code.</p>\n\n<p><code>while(fscanf(in, \"%d %s %s %d\", tmp_number, tmp_name, tmp_ip, &amp;tmp_speed) != EOF){\n        RACUNAR *new = create_new_item(tmp_number, tmp_name, tmp_ip, tmp_speed);\n        add_to_tree(new, root);</code></p>\n"}], "owner": {"reputation": 326, "user_id": 9195303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQ2uZ.jpg?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/9195303/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1637, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1543594124, "creation_date": 1515620951, "last_edit_date": 1543594124, "question_id": 48196658, "link": "https://stackoverflow.com/questions/48196658/how-to-scan-ip-address-with-fscanf", "title": "How to scan IP Address with fscanf", "body": "<p>how to scan IP Adress with scanf in c?</p>\n\n<p>I already user:</p>\n\n<p><code>scanf(\" %d \", &amp;ip_adress)</code></p>\n\n<p>Should i use </p>\n\n<p><code>%d.%d.%d</code> </p>\n\n<p>or there is a easier way.</p>\n\n<p>This is my function for reading information from a file:</p>\n\n<pre><code>void read_tree_from(FILE *in, PC **root){\n    char name[MAX_NAME];\n    int ip_adress;\n    int speed;\n    while(fscanf(in, \"%s %d %d\", name, &amp;ip_adress, &amp;speed) != EOF){\n        PC *new = create_new_item(name, ip_adress, speed);\n        add_to_tree(new, root);\n    }\n}\n</code></pre>\n\n<p>But when i run the program it works fine but in output file its mess...</p>\n"}, {"tags": ["ios", "c", "xcode", "static-libraries"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515620650, "post_id": 48196467, "comment_id": 83374178, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515620792, "post_id": 48196467, "comment_id": 83374248, "body": "@WeatherVane: How do you propose doing that? This is a question about Xcode project structure and settings, not about the C language. The project structure and settings are usually displayed in the GUI. They are recorded in a technically human-readable form in the .xcodeproj file, but that is not by any means the preferred form for working with a project."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515620948, "post_id": 48196467, "comment_id": 83374320, "body": "@EricPostpischil I don&#39;t know - it wasn&#39;t my question. I put that because all I can see is a narrative with ProjectA, B, C etc. which reads as if the question could be &quot;who ate the apple?&quot; And I put it before I noticed the asker&#39;s rep."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1515620982, "post_id": 48196467, "comment_id": 83374335, "body": "@EricPostpischil agree, but the c tag should be removed if it doesn&#39;t have to do with C at all. It seems, it&#39;s a questions of &quot;how do I use this software correctly&quot;."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515621443, "post_id": 48196467, "comment_id": 83374537, "body": "re-architecture? In ProjectB, can you move all the ProjectA <code>#include</code>s to a separate dedicated header file? Then in ProjectC when you <code>#include</code> ProjectB stuff, don&#39;t include the new file and you won&#39;t see any of the ProjectA stuff. If you can&#39;t do that then it seems that ProjectC is dependent on ProjectA, and perhaps ProjectA should be visible to ProjectC."}, {"owner": {"reputation": 14780, "user_id": 312627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2a57aa997ab70d2d1288697fc497722d?s=128&d=identicon&r=PG&f=1", "display_name": "karim", "link": "https://stackoverflow.com/users/312627/karim"}, "edited": false, "score": 0, "creation_date": 1515622162, "post_id": 48196467, "comment_id": 83374833, "body": "I try to explain more in the description."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1515625627, "post_id": 48196467, "comment_id": 83376163, "body": "Can you copy the needed files from A to the B build output where C can pick it up?"}, {"owner": {"reputation": 14780, "user_id": 312627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2a57aa997ab70d2d1288697fc497722d?s=128&d=identicon&r=PG&f=1", "display_name": "karim", "link": "https://stackoverflow.com/users/312627/karim"}, "edited": false, "score": 0, "creation_date": 1515626304, "post_id": 48196467, "comment_id": 83376390, "body": "Since it is not directly used in C, I am not eager to do it. But that&#39;s the only possible solution right now."}], "owner": {"reputation": 14780, "user_id": 312627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2a57aa997ab70d2d1288697fc497722d?s=128&d=identicon&r=PG&f=1", "display_name": "karim", "link": "https://stackoverflow.com/users/312627/karim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558515630, "creation_date": 1515620166, "last_edit_date": 1533876633, "question_id": 48196467, "link": "https://stackoverflow.com/questions/48196467/static-library-and-header-chaining-issues", "title": "Static library and header chaining issues", "body": "<p>I have three projects in XCode.  </p>\n\n<ul>\n<li>ProjectA, a pure C project</li>\n<li>ProjectB, a objective C project</li>\n<li>ProjectC, a mix of objective C and Swift </li>\n</ul>\n\n<p>ProjectA is a static library project used in ProjectB.<br>\nHeader files from projectA are in copy file target, it is in ProjectB\\lib\\ProjectA.a and \\lib\\include folder. </p>\n\n<p>ProjectB is linked as a sub project in ProjectC. </p>\n\n<p>ProjectC imports some header file from ProjectB.<br>\nThose header files in ProjetB have imported header files in ProjectA. </p>\n\n<p>My problem is, ProjectA is not visible in ProjectC. ProjectC compilation fails since ProjectC imports headers from ProjectB and B has header files imported from projectA. </p>\n\n<p>What is the way to solve this C->A dependency on .h files?</p>\n\n<h2>In ProjectA.</h2>\n\n<p>file DesTypes.h:\n// some types are defined here. </p>\n\n<h2>In ProjectB.</h2>\n\n<p>ProjectA.a is linked as static lib. </p>\n\n<p>File CryptoUtil.h :</p>\n\n<pre><code>#import DesTypes.h\n</code></pre>\n\n<p>// some function prototypes used types from Destypes. The .h is in search header path. So no problem.<br>\nI need the import here since some function prototype uses the types from DesTypes.h.<br>\nOtherwise importing DesTypes.h in CryptoUtil.m file would solve the problem. </p>\n\n<h2>In ProjectC</h2>\n\n<p>File MyViewController.h:</p>\n\n<pre><code>#import CryptoUtli.h\n// Here I get compile error for chaining. I do not use anything from DesType.h. \n</code></pre>\n"}, {"tags": ["c", "fopen", "fortify", "path-manipulation"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515620347, "post_id": 48196251, "comment_id": 83374019, "body": "There is an <code>else if</code> clause on line 22 of the first code, which does not follow a matching <code>if</code>. It also has a memory leak because at <code>return variable;</code> there is no <code>free(line)</code>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515621164, "post_id": 48196251, "comment_id": 83374410, "body": "<b>[cargo-cult alert]</b> The use of <code>strncpy()</code> here is dangerous ( it allmost always is) , since <code>white_list_file_buf</code> is not initialized with a final NUL byte."}, {"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515621288, "post_id": 48196251, "comment_id": 83374465, "body": "sorry is a typed mistake , it will be:              if ( strncmp(line,variable,read - 1) == 0 ){                 fclose(fp);                 return variable;             }"}, {"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515622667, "post_id": 48196251, "comment_id": 83375042, "body": "I&#39;ve done , thanks"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515621993, "post_id": 48196636, "comment_id": 83374769, "body": "I&#39;ll change strncmp by strstr and in the fortify report appear again path manipulation"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515622148, "post_id": 48196636, "comment_id": 83374828, "body": "@Miguel&#193;ngelRetamozoSanchez can you post a few lines of your <code>White.list</code> file<code>. What is the real value of </code>WHITE_LIST_FILE`?"}, {"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515622229, "post_id": 48196636, "comment_id": 83374864, "body": "cat White.list test1 test2 something     run : ./white_list something  it sould be found it , becuase &quot;something&quot; word is inside White.list"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515622557, "post_id": 48196636, "comment_id": 83374988, "body": "@Miguel&#193;ngelRetamozoSanchez comments don&#39;t show lines, can you please post that in your question?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515623349, "post_id": 48196636, "comment_id": 83375312, "body": "@Miguel&#193;ngelRetamozoSanchez I compiled your code (using <code>secure_getenv</code> and <code>strstr) and the program worked fine. I think either </code>WHITE_LIST_FILE` is wrong or the content of <code>White.lst</code> is wrong."}, {"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515623574, "post_id": 48196636, "comment_id": 83375404, "body": "Yup me too , in the report it still apeear  the path manipulation :S"}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1515620851, "creation_date": 1515620851, "answer_id": 48196636, "question_id": 48196251, "link": "https://stackoverflow.com/questions/48196251/fortify-path-manipulation-in-c-white-list-implementation-doesnt-work-fope/48196636#48196636", "title": "Fortify : Path Manipulation in C - White List Implementation doesn&#39;t work - fopen issue", "body": "<p>A quick search of <code>__secure_getenv</code> lead to this page:</p>\n\n<p><a href=\"https://refspecs.linuxfoundation.org/LSB_1.1.0/gLSB/baselib---secure-getenv-1.html\" rel=\"nofollow noreferrer\">https://refspecs.linuxfoundation.org/LSB_1.1.0/gLSB/baselib---secure-getenv-1.html</a></p>\n\n<p>Quote:</p>\n\n<blockquote>\n  <p><code>__secure_getenv(name)</code> has the same specification as <code>getenv(name)</code> with the exception that if the program\n  is running SUID or SGID enabled, the result is always <code>NULL</code>.</p>\n</blockquote>\n\n<p>So, the question is: is your program running with set SUID or SGID bits? As\nfar as I can see, <code>__secure_getenv</code> has been renamed to <code>secure_getenv</code> (my man page says it appeared in glibc 2.17).\nYou should use that instead.</p>\n\n<p>Another cause could be: if the length of the source string is longer than the <code>size</code> argument of <code>strncpy</code>,\nit won't add the <code>'\\0'</code> terminating byte. When using <code>strncpy</code> you should\nalways make sure to write the <code>'\\0'</code> terminating byte.</p>\n\n<blockquote>\n  <p><em>man strcpy</em></p>\n\n<pre><code>#include &lt;string.h&gt;\nchar *strncpy(char *dest, const char *src, size_t n);\n</code></pre>\n  \n  <p>The  <code>strncpy()</code> function is similar, except that at most <code>n</code> bytes of <code>src</code> are copied.\n  <strong>Warning</strong>: If there is no null byte among the first <code>n</code> bytes of <code>src</code>,\n  the string placed in dest will not be null-terminated.</p>\n</blockquote>\n\n<p><code>white_list_file_buff</code> might not be <code>'\\0'</code>-terminated, thus <code>fopen</code> fails.\nBut you say you did <code>export WHITE_LIST_FILE=/path/White.list</code>. Is\n<code>/path/White.list</code> the real value you used or some path that is longer than\n200 characters?</p>\n\n<p>Also your code here</p>\n\n<pre><code>while( (read = getline(&amp;line, &amp;len, fp)) != -1 )\n{\n    else if ( strncmp(line,variable,read - 1) == 0 ){\n        fclose(fp);\n        return variable;\n    }\n\n}\n</code></pre>\n\n<p>is either wrong or did you forget to paste the whole code? There is no\nprevious <code>if</code> for that <code>else</code>.</p>\n\n<p>Assuming that you've made a copy&amp;paste error, how is the format if\n<code>White.list</code>? Every line contains nothing but the name of variables? Your\n<code>strncmp</code> compare the whole line you know, and if you want to match only a\nsubstring, you should use <code>strstr</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515622558, "post_id": 48196735, "comment_id": 83374990, "body": "I&#39;ll  put __secure_getenv insted getenv because fortify don&#39;t take like a vulnerability , but I put the complite path insted __secure_getenv and fortify doesn&#39;t take the a vulnerability"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1515621309, "creation_date": 1515621309, "answer_id": 48196735, "question_id": 48196251, "link": "https://stackoverflow.com/questions/48196251/fortify-path-manipulation-in-c-white-list-implementation-doesnt-work-fope/48196735#48196735", "title": "Fortify : Path Manipulation in C - White List Implementation doesn&#39;t work - fopen issue", "body": "<p>Your whitelist approach approach obtains the name of the whitelist from an environment variable.  This is so easily manipulable as to not even justify the added complexity of implementing a whitelist in the first place, and it certainly should be cause for its own path-manipulation vulnerability.  Using <code>__secure_getenv()</code> to obtain the value doesn't really help; it just means that your program won't work if run in a secure context.</p>\n\n<p>Even if the whitelist's own path were fixed at compile time, you're still obtaining the whitelisted paths from an external source.  That's harder to manipulate than totally unverified user input, but it doesn't really resolve the vulnerability.</p>\n\n<p>If you cannot compile your whitelist into the program, then consider instead hardcoding a whitelist of path prefixes and a whitelist of characters that may appear in the remaining path components.  It's unclear whether Fortify would actually recognize this as resolving the issue, but that would be sufficient for me to be satisfied to set the issue's analysis to \"Not an issue\".</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515702229, "post_id": 48214062, "comment_id": 83412320, "body": "VALIDATED_PATH_MANIPULATION is a fortify variable? , it means that I can  use like a flag inside my white_list_validator function ?"}, {"owner": {"reputation": 497, "user_id": 7184001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f508367fc79946b31042bcf39080b1?s=128&d=identicon&r=PG&f=1", "display_name": "Egret", "link": "https://stackoverflow.com/users/7184001/egret"}, "reply_to_user": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "edited": false, "score": 0, "creation_date": 1515863521, "post_id": 48214062, "comment_id": 83466852, "body": "It&#39;s a taint - you can taint a flow with any value via a rule, but some values (such as the validated taints) are recognized by the Fortify native rules and they will not report issues that are marked as validated."}], "tags": [], "owner": {"reputation": 497, "user_id": 7184001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f508367fc79946b31042bcf39080b1?s=128&d=identicon&r=PG&f=1", "display_name": "Egret", "link": "https://stackoverflow.com/users/7184001/egret"}, "is_accepted": false, "score": 1, "last_activity_date": 1515696953, "creation_date": 1515696953, "answer_id": 48214062, "question_id": 48196251, "link": "https://stackoverflow.com/questions/48196251/fortify-path-manipulation-in-c-white-list-implementation-doesnt-work-fope/48214062#48214062", "title": "Fortify : Path Manipulation in C - White List Implementation doesn&#39;t work - fopen issue", "body": "<p>Fortify generally will not recognize whitelist validation as fixing the issue - once you've verified the routine, you need to teach it that this is a validation routine.   This will ensure any trace that correctly validates with this routine is not reported.</p>\n\n<p>You should ensure you've addressed the other comments, and validated the underlying routine itself is secure.  Then you should register the whitelist routine as a validation routine by adding a custom rule via the rules editor.  Best way to do this is a validation / cleansing rule that adds a taint flag of taintFlag=\"VALIDATED_PATH_MANIPULATION\" - the sink rules for path manipulation should not report issues with this taint.</p>\n\n<p>For more information on using the taint flags see\n<a href=\"https://community.softwaregrp.com/dcvta86296/attachments/dcvta86296/fortify-discussions/2950/1/HP_Fortify_SCA_Custom_Rules_Guide_4.21.pdf\" rel=\"nofollow noreferrer\">https://community.softwaregrp.com/dcvta86296/attachments/dcvta86296/fortify-discussions/2950/1/HP_Fortify_SCA_Custom_Rules_Guide_4.21.pdf</a></p>\n"}], "owner": {"reputation": 197, "user_id": 7044994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E0au0.png?s=128&g=1", "display_name": "Miguel &#193;ngel Retamozo Sanchez", "link": "https://stackoverflow.com/users/7044994/miguel-%c3%81ngel-retamozo-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1120, "favorite_count": 0, "accepted_answer_id": 48196636, "answer_count": 3, "score": -1, "last_activity_date": 1515696953, "creation_date": 1515619208, "last_edit_date": 1515623379, "question_id": 48196251, "link": "https://stackoverflow.com/questions/48196251/fortify-path-manipulation-in-c-white-list-implementation-doesnt-work-fope", "title": "Fortify : Path Manipulation in C - White List Implementation doesn&#39;t work - fopen issue", "body": "<p>Hello everyone I have a fortify issue \"Path manipulation\" it produced by fopen use. According with fortify I could implement a white list in order to fix it, so there have my white list validator:</p>\n\n<p>white_list.c</p>\n\n<pre><code>#define BUFF_WHITE_LIST_FILE 200\nconst char *white_list_validator( char *variable )\n{\n  FILE *fp = NULL;\n  ssize_t read;\n  char * line = NULL;\n  size_t len = 0;\n  char white_list_file_buff[BUFF_WHITE_LIST_FILE];\n  if ( __secure_getenv(\"WHITE_LIST_FILE\") == NULL )\n    return NULL;\n  else\n  {\n    strncpy(white_list_file_buff,\n         __secure_getenv(\"WHITE_LIST_FILE\"),sizeof(white_list_file_buff)-1);\n    fp = fopen(white_list_file_buff,\"r\");\n    if ( fp == NULL )\n        return NULL;\n    else\n    {\n        while( (read = getline(&amp;line, &amp;len, fp)) != -1 )\n        {\n            if ( strncmp(line,variable,read - 1) == 0 ){\n                fclose(fp);\n                return variable;\n            }\n\n        }\n        fclose(fp);\n\n    }\n    if(line)\n        free(line);\n }\n return NULL;\n}\n</code></pre>\n\n<p>it return NULL if it doesn't find the <strong>variable</strong> inside White.list (*) or return a pointer to char if it find it </p>\n\n<pre><code>int main( int argc, char **argv ) {\n\n    FILE *fp = NULL;\n    char mrd[50]={0};\n    const char *ptr = white_list_validator(argv[1]);\n\n    if ( argv[1] == NULL )\n        return -1;\n\n    if(ptr==NULL)\n        return -1;\n    else\n    {\n        strncpy(mrd,ptr,sizeof(mrd)-1);\n        printf(\"variables found : %s\\n\",mrd);\n\n        fp = fopen(mrd,\"w\");  &lt;------   SINK\n        if ( fp == NULL ){\n                printf(\"line 22\\n\");\n                exit(1);\n        }\n        fprintf(fp, \"%s %s %s %d\", \"We\", \"are\", \"in\", 2077);\n        fclose(fp);\n\n    }\n\n  return 0;\n }\n</code></pre>\n\n<p>but when I run the fortify report appear a manipulation path vulnerability in fopen, I do not know why .You can see in the code, before that manage to file with fopen it validated for a white_list_validator.\nso anybody has an idea why it does not work correctly?</p>\n\n<p>NOTE(*) : export WHITE_LIST_FILE=/path/White.list</p>\n\n<p>cat White.list</p>\n\n<p>test1</p>\n\n<p>test2</p>\n\n<p>something</p>\n\n<p>When I run the binary:</p>\n\n<p>./white_list something</p>\n\n<p>variables found : something</p>\n"}, {"tags": ["c", "linux", "shell", "ssh", "solaris-10"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1515623854, "post_id": 48196245, "comment_id": 83375498, "body": "<i>logging for entered command</i> So you put in a keylogger?  Great, you&#39;ve now given every miscreant on your systems a get-out-of-jail-free card by likely removing <a href=\"https://en.wikipedia.org/wiki/Non-repudiation#In_security\" rel=\"nofollow noreferrer\">non-repudiation</a> from your systems.  &quot;You can&#39;t prove that was me - you run a keylogger, so someone else could have snooped my password.&quot;  And it&#39;s trivial to defeat since it runs as the user. Garbage data can be inserted into it.  Attach to <code>script</code> process with debugger, <code>ftruncate( fileno( script ), 0 );</code> and goodbye all data. OSes provide auditing for a reason.  Use it."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1515667262, "post_id": 48196245, "comment_id": 83391153, "body": "Another way around your keylogger:  <code>scp</code> in a <code>.bashrc</code> file or similar that opens a <a href=\"http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\" rel=\"nofollow noreferrer\">reverse shell</a>.  You&#39;re also confusing knowing what a user types with knowing what a user does - that <code>.bashrc</code> file can change <code>PATH</code> so typing <code>ls</code> doesn&#39;t run <code>&#47;bin&#47;ls</code> but <code>&#47;home&#47;user&#47;my&#47;nefarious&#47;ls</code>. And did you catch the possibility that your keylogger may very well log to a file that&#39;s readable by <i>everyone</i> on the system? If you can&#39;t figure that out from the code link you posted, you have no business using it."}], "owner": {"reputation": 119, "user_id": 1272036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4263446ce535f1762fc567c84323e6b8?s=128&d=identicon&r=PG", "display_name": "MTS", "link": "https://stackoverflow.com/users/1272036/mts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515619165, "creation_date": 1515619165, "question_id": 48196245, "link": "https://stackoverflow.com/questions/48196245/setting-control-terminal-for-slave-pseudo-tty-at-solaris", "title": "setting control terminal for slave pseudo-tty at Solaris", "body": "<p>I have the implementation of hooking and logging for entered command at shell for Solaris. It is released by libhook (library for hooking) and script with \"Unix 98 pty\" (which was made from this script implementation <a href=\"http://honeypots.sourceforge.net/script.c.solaris.txt\" rel=\"nofollow noreferrer\">http://honeypots.sourceforge.net/script.c.solaris.txt</a>)</p>\n\n<p>If I start \"script\" from shell at logged-in ssh session everything works well and have some output of command ps. But if the script was started by libhook (during login of ssh libhooks detects that there is SHELL's call and starts script instead of SHELL) command ps has next output:</p>\n\n<pre><code>ps: no controlling terminal\n</code></pre>\n\n<p>If hooked logged-in session (under \"script\") has pid=19215 and in this case under clean (unhooked) ssh session \"ps -el\" shows next:</p>\n\n<pre><code># ps -el\nF S    UID   PID  PPID   C PRI NI     ADDR     SZ    WCHAN TTY         TIME CMD\n1 T      0     0     0   0   0 SY        ?      0          ?           0:20 sched\n0 S      0     1     0   0  40 20        ?    385        ? ?           0:04 init\n1 S      0     2     0   0   0 SY        ?      0        ? ?           0:00 pageout\n1 S      0     3     0   0   0 SY        ?      0        ? ?         142:52 fsflush\n1 S      0     4     0   0   0 SD        ?      0        ? ?           0:57 vmtasks\n ......\n0 S      0 19215 19211   0  40 20        ?    506        ? pts/6       0:00 sh\n0 S      0 19211 19205   0  40 20        ?    881        ? pts/5       0:00 script\n0 S      0 19205 19204   0  40 20        ?   1244        ? ?           0:01 sshd\n0 S      0 19204 19203   0  40 20        ?    746        ? ?           0:00 sshd\n0 S      0 19203     1   0  40 20        ?    603        ? ?           0:00 sshd\n......\n</code></pre>\n\n<p>The structure of \"script\" calls next:</p>\n\n<pre><code>struct termios origtty, newtty;\ntcgetattr(STDIN_FILENO, &amp;origtty); // get tty modes\nint master = open(\"/dev/ptmx\", O_RDWR)); // opens master side of pseudo-tty\ngrantpt(master); // set the permissions on the slave\nunlockpt(master); // unlock the slave.\npid = fork(); // create child for slave\n</code></pre>\n\n<p>and then at the child process there are next calls:</p>\n\n<pre><code>setsid();   // creates new process session\nchar * slavename = ptsname(master); // get slave name\nint slave = open(slaveName, O_RDWR) // open the slave pseudo-tty\nioctl(slave, I_PUSH, \"ptem\"); // push the hardware emulation module\nioctl(slave, I_PUSH, \"ldterm\"); // push the line discipline module\ntcsetattr(slave, TCSANOW, &amp; ttymodes); // copy the user's terminal modes to the slave pseudo-tty\nclose(master); // close the the master; this are not needed in the slave.\n\ndup2(slave, 0);\ndup2(slave, 1);\ndup2(slave, 2);\nclose(slave); // set the slave to be our standard input, output, and error output.\nexecl(\"/sbin/sh\", \"sh\", NULL); // run shell there\n</code></pre>\n\n<p>for parent process have next calls:</p>\n\n<pre><code>newtty = origtty;\nnewtty.c_cc[VMIN] = 1;\nnewtty.c_cc[VTIME] = 0;\nnewtty.c_iflag &amp;= ~(IGNBRK | BRKINT | PARMRK | ISTRIP | INLCR | IGNCR | ICRNL | IXON);\nnewtty.c_oflag &amp;= ~OPOST;\nnewtty.c_lflag &amp;= ~(ECHO | ECHONL | ICANON | ISIG | IEXTEN);\nnewtty.c_cflag &amp;= ~(CSIZE | PARENB);\nnewtty.c_cflag |= CS8;\n</code></pre>\n\n<p>I have tried to get \"controlTerm = open (\"/dev/tty \", O_RDWR)\" before command \"setsid\" and then set \"ioctl (controlTerm, TIOCSCTTY, 1)\" after \"setsid\" (get controlling terminal for previous session and set them at new) but in this case I had same behaviour and second command returns \"-1\" with errno=9 (Bad file number).</p>\n\n<p>Same code tested under AIX and everything works well there.\nHow can I implement controlling terminal for a shell at slave pseudo-tty?</p>\n"}, {"tags": ["c", "pipe", "fork", "posix", "child-process"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1515619333, "post_id": 48196232, "comment_id": 83373570, "body": "There is a lot of such examples. One obviously wrong thing: the child is both read and writer in the pipe, this is probably not what you want."}, {"owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1515620781, "post_id": 48196232, "comment_id": 83374244, "body": "But what if I do want the child to be both a reader and a writer? That is, if I wanted to pipe data to a child for processing and then read its output."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1515622075, "post_id": 48196232, "comment_id": 83374797, "body": "A single process reading and writing into the SAME pipe is a strange thing, don&#39;t you think. A pipe is a communication channel, then at least between two processes. One process writes to it, another one reads in it, that the usual way to manage piping. Seems that in your case you need two pipes..."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1515622385, "post_id": 48196232, "comment_id": 83374923, "body": "And more important, only one single process should read from a pipe. If not, first one get the data and the other(s) have nothing."}], "answers": [{"comments": [{"owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "edited": false, "score": 0, "creation_date": 1515621996, "post_id": 48196732, "comment_id": 83374770, "body": "Oh, so I read from the pipe way too soon, huh. Without going into socketpair yet (it was one solution that was suggested to me before, alongside plain sockets), you mean I&#39;d need two <code>pipefd</code>s?"}, {"owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "reply_to_user": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "edited": false, "score": 0, "creation_date": 1515622084, "post_id": 48196732, "comment_id": 83374800, "body": "@MonatheMonad, yes.  In the present design child and parent compete to read from the pipe.  You want parent&#39;s output (to child) to travel along a channel that is not the parent&#39;s input (from child).  So, two pipes or bi-directional socket fd semantics."}], "tags": [], "owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1515621284, "creation_date": 1515621284, "answer_id": 48196732, "question_id": 48196232, "link": "https://stackoverflow.com/questions/48196232/child-process-hangs-even-after-closing-its-input/48196732#48196732", "title": "Child process hangs, even after closing its input", "body": "<p>When I run this code I see:</p>\n\n<pre><code>[notroot]$ ./c_way \nI have 5 apples.\n</code></pre>\n\n<p>and then a hang.</p>\n\n<p>It's a race:  your parent process reads its own just-written data from the pipe (and writes it to stdout) before the child process exec's <em>cat</em>.</p>\n\n<p>The child reads nothing \u2014 the pipe has been drained by the parent \u2014 and thus blocks patiently on stdin awaiting input.  The parent, meanwhile, blocks patiently on the read end of the pipe, awaiting input which will never arrive.</p>\n\n<p>You want two pipes:  one to connect parent to child stdin, and another to connect child stdout to parent.  (See also <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/socketpair.html\" rel=\"nofollow noreferrer\"><em>socketpair</em></a>.)</p>\n"}], "owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 48196732, "answer_count": 1, "score": 0, "last_activity_date": 1515621284, "creation_date": 1515619102, "question_id": 48196232, "link": "https://stackoverflow.com/questions/48196232/child-process-hangs-even-after-closing-its-input", "title": "Child process hangs, even after closing its input", "body": "<p>Suppose I have this example code (error checking largely omitted for clarity)</p>\n\n<pre><code>static void c_way() {\n    int pipefd[2], ch;\n    FILE *rf, *wf;\n    pipe(pipefd);\n    switch (fork()) {\n    case -1:\n        /* something went wrong */\n        break;\n    case 0:\n        dup2(pipefd[0], STDIN_FILENO);\n        dup2(pipefd[1], STDOUT_FILENO);\n        close(pipefd[0]);\n        close(pipefd[1]);\n        execvp(cat_args[0], cat_args);\n        _exit(0);\n    }\n    rf = fdopen(pipefd[0], \"r\");\n    wf = fdopen(pipefd[1], \"w\");\n    fprintf(wf, \"I have %d apples.\\n\", 5);\n    fclose(wf);\n    while ((ch = fgetc(rf)) != EOF)\n        putchar(ch);\n    puts(\"Done reading.\");\n    fflush(stdout);\n    fclose(rf);\n}\n</code></pre>\n\n<p>where <code>cat_args</code> is simply <code>{\"cat\", \"-\", NULL}</code>. For some reason, despite having closed the parent process's write end of the pipe, EOF never seems to be reached in the <code>fgetc</code> loop, as if the child process was waiting for more input. Did I forget to close some file descriptors? Even without using file pointers (i.e. raw POSIX reads and writes), it still hangs.</p>\n\n<p>I see some similar answered questions, so this is probably a duplicate.</p>\n"}, {"tags": ["javascript", "c", "algorithm", "sorting", "selection-sort"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515614753, "post_id": 48195160, "comment_id": 83371307, "body": "I don&#39;t see the problem in the stack snippet here, or if I clone your jsbin."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515614936, "post_id": 48195160, "comment_id": 83371378, "body": "Weird, I got the correct answer when I first cloned it, but then when I re-run it the answer is wrong."}, {"owner": {"reputation": 59, "user_id": 3139096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jxqTW.png?s=128&g=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3139096/dani"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515615045, "post_id": 48195160, "comment_id": 83371439, "body": "Sorry, the snippet and the JSBin were set to loop 9800 times which wont show the problem. The loop needs to loop 10000 times for the problem to show. I changed it now in the code snipped above and in the JSBin."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1515615125, "post_id": 48195160, "comment_id": 83371477, "body": "I still don&#39;t see the problem here, but I was seeing it in jsbin with 9800."}, {"owner": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1515615559, "post_id": 48195160, "comment_id": 83371702, "body": "What browser are you using?"}, {"owner": {"reputation": 59, "user_id": 3139096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jxqTW.png?s=128&g=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3139096/dani"}, "edited": false, "score": 0, "creation_date": 1515615662, "post_id": 48195160, "comment_id": 83371753, "body": "Chrome Version 63.0.3239.132 (Official Build) (64-bit)"}, {"owner": {"reputation": 11284, "user_id": 1431042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac347d1664f3b4c3c2d6d1326e8558f8?s=128&d=identicon&r=PG", "display_name": "Me.Name", "link": "https://stackoverflow.com/users/1431042/me-name"}, "edited": false, "score": 0, "creation_date": 1515615820, "post_id": 48195160, "comment_id": 83371852, "body": "Perhaps the problem is not the code, but rather the console output, as in  <a href=\"https://stackoverflow.com/questions/24175017/google-chrome-console-log-inconsistency-with-objects-and-arrays\" title=\"google chrome console log inconsistency with objects and arrays\">stackoverflow.com/questions/24175017/&hellip;</a>"}, {"owner": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 11284, "user_id": 1431042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac347d1664f3b4c3c2d6d1326e8558f8?s=128&d=identicon&r=PG", "display_name": "Me.Name", "link": "https://stackoverflow.com/users/1431042/me-name"}, "edited": false, "score": 0, "creation_date": 1515615875, "post_id": 48195160, "comment_id": 83371888, "body": "@Me.Name No, the array is logged after all modifications"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1515615902, "post_id": 48195160, "comment_id": 83371905, "body": "Try with <code>console.log(unsorted.slice(-20).join(&#39;,&#39;))</code> and see if you still get the same strange result. (NB: I cannot reproduce this in Chrome 63.0 , nor in FF 57.0.4)"}, {"owner": {"reputation": 11284, "user_id": 1431042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac347d1664f3b4c3c2d6d1326e8558f8?s=128&d=identicon&r=PG", "display_name": "Me.Name", "link": "https://stackoverflow.com/users/1431042/me-name"}, "reply_to_user": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1515615988, "post_id": 48195160, "comment_id": 83371949, "body": "@Bergi Ah you&#39;re right, the provided link isn&#39;t accurate for this problem, but the logging still seems to be the culprit. Did some testing and Firefox didn&#39;t have the problem. In Chrome it did occur, but only with the current combination of <code>var</code>s and <code>let</code>s, as if Chrome optimizes in such a way that the console output occurs for the loop is completely finishes. Also adding an extra console.log eleminated the problem (e.g. tried logging the actual value of the last index)."}, {"owner": {"reputation": 11284, "user_id": 1431042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac347d1664f3b4c3c2d6d1326e8558f8?s=128&d=identicon&r=PG", "display_name": "Me.Name", "link": "https://stackoverflow.com/users/1431042/me-name"}, "edited": false, "score": 0, "creation_date": 1515616255, "post_id": 48195160, "comment_id": 83372092, "body": "Also accessing the array after the loop seems to negate the problem. e.g. <code>let last = unsorted[9999];</code>. Perhaps Chrome thinks it can safely start logging of the <code>var</code> because all loops are local. Huge speculation here, but also making the initial declaration <code>let unsorted=[]</code> (and leaving the rest of the code unaltered) produced the correct results"}, {"owner": {"reputation": 11284, "user_id": 1431042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac347d1664f3b4c3c2d6d1326e8558f8?s=128&d=identicon&r=PG", "display_name": "Me.Name", "link": "https://stackoverflow.com/users/1431042/me-name"}, "edited": false, "score": 0, "creation_date": 1515616529, "post_id": 48195160, "comment_id": 83372207, "body": "Ok, adding <i>any</i> code after the loops produces the correct results. Logging indeed seems to follow its own timetable"}, {"owner": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1515616679, "post_id": 48195160, "comment_id": 83372284, "body": "My guess would be that the optimiser has a bug related to the destrucuring with property targets, and it only kicks in with enough iterations."}, {"owner": {"reputation": 59, "user_id": 3139096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jxqTW.png?s=128&g=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3139096/dani"}, "edited": false, "score": 0, "creation_date": 1515617365, "post_id": 48195160, "comment_id": 83372614, "body": "Thank you both for looking into this. So its a problem with Chrome&#39;s console. Meanwhile i translated the code into C to see :) if the problem occurs in a different language and it doesn&#39;t. Thank you all once more."}], "owner": {"reputation": 59, "user_id": 3139096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jxqTW.png?s=128&g=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3139096/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1515618956, "creation_date": 1515614340, "last_edit_date": 1515618956, "question_id": 48195160, "link": "https://stackoverflow.com/questions/48195160/why-this-selection-sort-algorithm-behaves-in-this-weird-way", "title": "Why this Selection Sort algorithm behaves in this weird way", "body": "<p>I am half asleep so I may be overlooking something over here but what is happening is very odd. I implemented the Selection Sort algorithm from <a href=\"https://en.wikipedia.org/wiki/Selection_sort\" rel=\"nofollow noreferrer\">Wikipedia</a> in JavaScript. You can view the code here under or at <a href=\"https://jsbin.com/tefujub/edit?js,console\" rel=\"nofollow noreferrer\">jsbin</a></p>\n\n<h3>The Problem</h3>\n\n<p>I am populating an array with a for loop with 10000 randomly generated numbers because it takes that many to show the issue. The algorithm works as expected with anything under 9800. However, with 10000 numbers and an empty unsorted array <code>var unsorted = [];</code> the last numbers are alternating like this <code>9, 10, 9, 10, 9, 10, 9, 10 ...</code>. If I initialize the <code>unsorted</code> array with at least one element i.e <code>var unsorted = [1];</code>, the alternating problem is fixed.</p>\n\n<p>So, why is this happening and why is it happening when the unsorted array contains at least 9800 numbers and why is it fixed when i initialize the unsorted array with at least one number before populating it through the for loop?</p>\n\nEdit\n\n<p>The problem doesn't seem to always happen so if everything looks sorted the first time you try, then try a few more times. Also, i've tested it on Edge, Firefox and Opera with the problem occurring across browsers. (latest versions as of now)</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var unsorted = [];\r\n\r\nfor (let i = 0; i &lt; 10000; i++) {\r\n  unsorted[i] = Math.floor(Math.random() * 11);\r\n}\r\n\r\nfor (let j = 0; j &lt; unsorted.length; j++) {\r\n  let min = j;\r\n\r\n  for (let i = j + 1; i &lt; unsorted.length; i++) {\r\n    if (unsorted[i] &lt; unsorted[min]) {\r\n      min = i;\r\n    }\r\n  }\r\n\r\n  if (min != j) {\r\n    [unsorted[j], unsorted[min]] = [unsorted[min], unsorted[j]]\r\n  }\r\n}\r\n\r\nconsole.log(unsorted);</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<h3>Edit: A Test With C</h3>\n\n<p>I've been learning C this month and i translated the code to see how it behaves in a different language. The answer - there is no problem. Everything is sorted just fine. Here is the code for those who like to compare. This does not mean that i am not interested in understanding why the problem happens in JavaScript\nand not in C.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    int arrLen = 10000;\n    int unsorted[arrLen];\n    time_t t;\n    srand((unsigned) time(&amp;t));\n\n    for (int i = 0; i &lt; arrLen; i++)\n    {\n        unsorted[i] = rand() % 11;\n    }\n\n    for (int j = 0; j &lt; arrLen; j++)\n    {\n        int min = j;\n\n        for (int i = j + 1; i &lt; arrLen; i++)\n        {\n            if (unsorted[i] &lt; unsorted[min]) {\n                min = i;\n            }\n        }\n\n        if (min != j)\n        {\n            int tmp = unsorted[j];\n            unsorted[j] = unsorted[min];\n            unsorted[min] = tmp;\n        }\n    }\n\n    for (int a = 0; a &lt; arrLen; a++)\n    {\n        printf(\"%d-\", unsorted[a]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1515613683, "post_id": 48194983, "comment_id": 83370735, "body": "Can you prove your statement? Like by printing the <code>argc</code>?"}, {"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 1, "creation_date": 1515613783, "post_id": 48194983, "comment_id": 83370785, "body": "By the way, shouldn&#39;t string argv [] be char* argv []? Where is string defined as char *?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1515613801, "post_id": 48194983, "comment_id": 83370792, "body": "You are aware that a call like <code>cs50.exe p1 p2</code> yields an <code>argc==3</code>, are you?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1515613832, "post_id": 48194983, "comment_id": 83370810, "body": "@Makketronix See <a href=\"https://mirror.cs50.net/library50/c/cs50-library-c-3.0/cs50.h\" rel=\"nofollow noreferrer\">mirror.cs50.net/library50/c/cs50-library-c-3.0/cs50.h</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1515613848, "post_id": 48194983, "comment_id": 83370823, "body": "You are making something up."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1515613890, "post_id": 48194983, "comment_id": 83370842, "body": "@AnT Who&#39;s making up what?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1515613938, "post_id": 48194983, "comment_id": 83370870, "body": "How are you passing the arguments?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1515613942, "post_id": 48194983, "comment_id": 83370877, "body": "Please show the sample input (i.e. the commandline including parameters which is used to execute the program). Also please insert the print proposed by Eugene and show the output."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1515613982, "post_id": 48194983, "comment_id": 83370903, "body": "Upvoted due to the quality of the question. It would be a good time to run this through your debugger. Debugging is more important than typing out code."}, {"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1515614102, "post_id": 48194983, "comment_id": 83370973, "body": "Yeah, I don&#39;t like that. Perhaps it should be cstring instead."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1515614128, "post_id": 48194983, "comment_id": 83370981, "body": "@Makketronix <code>string</code> is a typedef of <code>char*</code> in the cs50 header."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1515614179, "post_id": 48194983, "comment_id": 83371006, "body": "@George: Indeed it is and it&#39;s very naughty since string literals decay to a <code>const char*</code> type."}, {"owner": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "edited": false, "score": 0, "creation_date": 1515614298, "post_id": 48194983, "comment_id": 83371072, "body": "Turns out I forgot that the command itself counted as 1. Silly mistake."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515614349, "post_id": 48194983, "comment_id": 83371099, "body": "@Adam Grey Even if <code>&lt;cs50.h&gt;</code> has a <code>typedef char *string;</code>, In C, the standard library defines &quot;A <i>string</i> is a contiguous sequence of characters terminated by and including the first null character.&quot;. An <i>array</i> can be a <i>string</i>. A <i>string</i> is <b>not</b> a pointer.  A pointer is not a string.  <code>char *</code> is a pointer and not a <i>string</i>, although a <code>char *</code> can point to a <i>string</i>."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1515614740, "post_id": 48194983, "comment_id": 83371300, "body": "@Bathsheba Yup it&#39;s pretty bad, i&#39;d hope that a modern C compiler would warn about the conversion and make it obvious to a tutor that <code>string</code> shouldn&#39;t be used."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1515614976, "post_id": 48194983, "comment_id": 83371402, "body": "@Makketronix Imo it just shouldn&#39;t exist at all :p I really don&#39;t see the rationale behind it, and its use is often abused i.e. I was taught once upon a time that <code>string some_string; scanf(&quot;%s&quot;, some_string);</code> is clean and correct (though admittadley, we were using a different library. <code>string</code> was still just a <code>typedef</code> of <code>char*</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "is_accepted": true, "score": 4, "last_activity_date": 1515613832, "creation_date": 1515613832, "answer_id": 48195039, "question_id": 48194983, "link": "https://stackoverflow.com/questions/48194983/program-ignores-if-argc-2-statement/48195039#48195039", "title": "Program ignores `if ( argc != 2)` statement", "body": "<p>Pretty sure that you're forgetting that the command itself counts as one of the args from the shell.  In other words:</p>\n\n<pre><code>&gt; myprog myparam myotherparam\n</code></pre>\n\n<p>has argc == 3 because myprog is arg[0]</p>\n"}], "owner": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 48195039, "answer_count": 1, "score": 1, "last_activity_date": 1515615332, "creation_date": 1515613607, "last_edit_date": 1515615332, "question_id": 48194983, "link": "https://stackoverflow.com/questions/48194983/program-ignores-if-argc-2-statement", "title": "Program ignores `if ( argc != 2)` statement", "body": "<p>I am doing a problem set from the CS50 course, and in this problem <code>argc</code> needs to be 2. I made this:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\nint main (int argc, string argv [])\n{\n    if ( argc != 2){\n        printf (\"Retry\\n\");\n        return 1;\n    } else {\n        int x = atoi(argv [1]);\n        string a = get_string (\"Enter plaintext: \");\n        printf (\"%s\", a);\n        printf (\"%d\", x);\n        }\n}\n</code></pre>\n\n<p>But even when <code>argc</code> is different than 2 it ignores the if statement and goes to the else statement. </p>\n\n<p>Why is that? And how do I fix it?</p>\n"}, {"tags": ["c", "openssl", "raspberry-pi", "amazon-kinesis"], "comments": [{"owner": {"reputation": 494, "user_id": 886279, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/qWbtH.jpg?s=128&g=1", "display_name": "Albert Rannetsperger", "link": "https://stackoverflow.com/users/886279/albert-rannetsperger"}, "edited": false, "score": 0, "creation_date": 1516869806, "post_id": 48194894, "comment_id": 83868508, "body": "Hey, did u ever manage to find a solution to this? I&#39;m on a Raspberry PI Zero W and have the same problem. Been stuck on this for over a day now. If you figured out what the problem is and could share your solution I&#39;d be super grateful :)"}, {"owner": {"reputation": 1, "user_id": 4205560, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bPuwn4zksO4/AAAAAAAAAAI/AAAAAAAAACA/Agtu4D7Ph9w/photo.jpg?sz=128", "display_name": "Adam Francisco", "link": "https://stackoverflow.com/users/4205560/adam-francisco"}, "reply_to_user": {"reputation": 494, "user_id": 886279, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/qWbtH.jpg?s=128&g=1", "display_name": "Albert Rannetsperger", "link": "https://stackoverflow.com/users/886279/albert-rannetsperger"}, "edited": false, "score": 0, "creation_date": 1516995651, "post_id": 48194894, "comment_id": 83930468, "body": "I wasn&#39;t able to get it working on the Raspberry Pi W, however I did the same exact setup for a Raspberry Pi 3 model B and it worked instantly."}, {"owner": {"reputation": 494, "user_id": 886279, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/qWbtH.jpg?s=128&g=1", "display_name": "Albert Rannetsperger", "link": "https://stackoverflow.com/users/886279/albert-rannetsperger"}, "edited": false, "score": 0, "creation_date": 1517864320, "post_id": 48194894, "comment_id": 84259796, "body": "Thanks for getting back to me. Same here, couldn&#39;t get it to work on RPI W (even after fudging the C code to use less memory) but have since bought a RPI3 and it&#39;s working nicely :)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9217750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b90e59d4c6bd92b2328cfe47bbca5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Waranona", "link": "https://stackoverflow.com/users/9217750/waranona"}, "is_accepted": false, "score": 0, "last_activity_date": 1516768370, "creation_date": 1516768370, "answer_id": 48414856, "question_id": 48194894, "link": "https://stackoverflow.com/questions/48194894/error-connecting-raspberry-pi-w-to-kinesis-video-streams/48414856#48414856", "title": "Error connecting Raspberry Pi W to Kinesis Video Streams", "body": "<p>I had got this same issue. However, after changing to Raspberry Pi 3 model B, it is working good.</p>\n"}], "owner": {"reputation": 1, "user_id": 4205560, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bPuwn4zksO4/AAAAAAAAAAI/AAAAAAAAACA/Agtu4D7Ph9w/photo.jpg?sz=128", "display_name": "Adam Francisco", "link": "https://stackoverflow.com/users/4205560/adam-francisco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1516768370, "creation_date": 1515613211, "question_id": 48194894, "link": "https://stackoverflow.com/questions/48194894/error-connecting-raspberry-pi-w-to-kinesis-video-streams", "title": "Error connecting Raspberry Pi W to Kinesis Video Streams", "body": "<p>I'm following Amazon's guide to connect a Raspberry Pi W to their Kinesis Video Streams service from the link below:</p>\n\n<p><a href=\"https://s3-us-west-2.amazonaws.com/kinesis-video-streaming/kinesis-video-raspberry-pi-getting-started.pdf\" rel=\"nofollow noreferrer\">https://s3-us-west-2.amazonaws.com/kinesis-video-streaming/kinesis-video-raspberry-pi-getting-started.pdf</a></p>\n\n<p>However, when I run the sample application using this command:\n./kinesis-video-demo</p>\n\n<p>The console outputs the following and ends the process:</p>\n\n<p>Begin streaming video...</p>\n\n<p>INFO - Initializing curl.</p>\n\n<p>Illegal instruction</p>\n\n<p>I believe the application ends due to an openssl error which is a dependency for the \"kinesis-video-demo\" app. The openssl github page says that an \"illegal instruction\" may occur from the no-sse2 parameter when installing openssl as seen in the 'INSTALL' file from their github page.\n<a href=\"https://github.com/openssl/openssl\" rel=\"nofollow noreferrer\">https://github.com/openssl/openssl</a></p>\n\n<p>Is there a certain way I need to install openssl on a Raspberry Pi W for this application to work?</p>\n"}, {"tags": ["c", "struct", "lua", "swig"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1515654434, "post_id": 48194626, "comment_id": 83383897, "body": "Use SWIG or a template library like <a href=\"https://sol2.readthedocs.io/en/latest/\" rel=\"nofollow noreferrer\">Sol2</a> (needs C++ though)."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1515657669, "post_id": 48194626, "comment_id": 83385379, "body": "I don&#39;t understand what you&#39;re asking here if SWIG has already done this for you."}, {"owner": {"reputation": 133, "user_id": 1999969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03446672d3841c514d1937b7964b609?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Kiss-V&#225;mosi", "link": "https://stackoverflow.com/users/1999969/g%c3%a1bor-kiss-v%c3%a1mosi"}, "edited": false, "score": 0, "creation_date": 1515669562, "post_id": 48194626, "comment_id": 83392633, "body": "The SWIG generated code too heavy for me. I have just a few simple structures."}], "owner": {"reputation": 133, "user_id": 1999969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03446672d3841c514d1937b7964b609?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Kiss-V&#225;mosi", "link": "https://stackoverflow.com/users/1999969/g%c3%a1bor-kiss-v%c3%a1mosi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515670503, "creation_date": 1515612029, "last_edit_date": 1515670503, "question_id": 48194626, "link": "https://stackoverflow.com/questions/48194626/map-nested-c-structures-to-lua-like-swig-does", "title": "Map nested C structures to Lua like SWIG does", "body": "<p>Let's say I have C structure like this:</p>\n\n<pre><code>typedef struct {\n   int id;\n   struct {\n      int num1;\n      int num2;      \n   }numbers;\n}test_t;\n</code></pre>\n\n<p>Due to the SWIG wrapper I can use it in Lua as:</p>\n\n<pre><code>test1.number.num1 = 5\n</code></pre>\n\n<p>It works well but the generated code is too heavy (3000 lines for this example). I will run it an embedded environment. So I want to make it myself in a more simple way.</p>\n\n<p>I know SWIG uses classes and metatables to do this.\nCan someone explain and/or show an example how to simply do this?  </p>\n"}, {"tags": ["c", "stm32", "i2c", "mpu6050"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515612119, "post_id": 48194617, "comment_id": 83369941, "body": "Then profile your code and find a bottleneck."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515612442, "post_id": 48194617, "comment_id": 83370113, "body": "It looks to me like you&#39;re just using GPIO to run the I2C when you STM controller has two I2C Fast Mode controllers built in.  I think you&#39;ll find the GPIO are too slow for your application.  Use the I2C Fast Mode controllers in the STM."}, {"owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515613472, "post_id": 48194617, "comment_id": 83370633, "body": "@EugeneSh. I have tried to figure it out, the key functions are ByteWrite and Read functions, this is where all the communication is happening and according to data sheet, it seems quite right,"}, {"owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515613584, "post_id": 48194617, "comment_id": 83370691, "body": "@cleblanc i think you are right. Can you please guide me a little about it, because the reference manual of STM32F3 is not that much detailed about it further there are very less resources available in particular for STM32F3 online."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515615426, "post_id": 48194617, "comment_id": 83371640, "body": "@MoizHusnain I think you&#39;ll need to write your own I2C driver for the STM. You first need some understanding of I2C protocol.  Second you should find what PINS are available for SDA and SCLK using the I2C controller and program them as such.  Finally you probably want to setup one of the DMA controllers to server the I2C.  Doesn&#39;t seem like too much work."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515617570, "post_id": 48194617, "comment_id": 83372731, "body": "@MoizHusnain  You might find this library useful; <a href=\"http://www.st.com/content/ccc/resource/technical/document/user_manual/0e/49/a3/22/24/7d/48/6c/DM00063145.pdf/files/DM00063145.pdf/jcr:content/translations/en.DM00063145.pdf\" rel=\"nofollow noreferrer\">st.com/content/ccc/resource/technical/document/user_manual/0&zwnj;&#8203;e/&hellip;</a>"}, {"owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515619994, "post_id": 48194617, "comment_id": 83373843, "body": "Yeah i&#39;m doing the same @cleblanc except the DMA step. I have read a blog about it and even without the DMA the transfer rate should be on average 2ms. With DMA it will be reduced to 1ms. But here i&#39;m only getting 400ms time response."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515620236, "post_id": 48194617, "comment_id": 83373963, "body": "You might try increasing MPU6050_LONG_TIMEOUT * 10 or so to see if you&#39;re getting the I2C timeout somewhere that&#39;s causing your latency."}, {"owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515630284, "post_id": 48194617, "comment_id": 83377502, "body": "@cleblanc I have tried the CPAL library, i must say that it is really very powerful library, but in my case initialization is failed as i have debugged step by step. Plus i&#39;ll be back after testing your specified issue regarding timeout."}, {"owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515632066, "post_id": 48194617, "comment_id": 83377947, "body": "@cleblanc I have verified, it is not going into timeout. I have also calculated the time for one time execution of read function and it is about <b>0.0354 s</b> approx."}], "answers": [{"tags": [], "owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "is_accepted": true, "score": 0, "last_activity_date": 1516987899, "creation_date": 1516987899, "answer_id": 48466571, "question_id": 48194617, "link": "https://stackoverflow.com/questions/48194617/mpu6050-response-time-with-stm32f303/48466571#48466571", "title": "MPU6050 response time with STM32F303", "body": "<p>I have found the answer of my problem. When i tried to debug it, it was found that the clock frequency of I2C protocol is very less and was about <strong>1 Khz</strong> where as it should be in range of <strong>4 Khz</strong> for proper operation and performance efficiency. I tried to consult the datasheet and i found that the issue was with Timing Register of I2C module. In the I2C timing register the last 4bits are dedicated to clock frequency prescaler and my case it was set to full and hence the frequency was divided to maximum extent possible. so in the initialization segment of the I2C module</p>\n\n<pre><code>    void  initializeI2C(){\n\n    RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C1, ENABLE);\n\n    I2C_InitTypeDef I2C_InitStructure;\n    I2C_InitStructure.I2C_Ack = I2C_Ack_Enable;\n    I2C_InitStructure.I2C_AcknowledgedAddress = I2C_AcknowledgedAddress_7bit;\n    I2C_InitStructure.I2C_OwnAddress1 = 0;\n    I2C_InitStructure.I2C_AnalogFilter = I2C_AnalogFilter_Enable;\n    I2C_InitStructure.I2C_DigitalFilter = 0x00;\n    I2C_InitStructure.I2C_Mode = I2C_Mode_I2C;\n    I2C_InitStructure.I2C_Timing = 0xF062121F;\n    I2C_Init(I2C1, &amp;I2C_InitStructure);\n\n    I2C_Cmd(I2C1, ENABLE);\n\n}\n</code></pre>\n\n<p>I changed the value of I2C_Timing register to 0x0062121F and the clock frequency of the I2C was restored and hence I was able to get maximum sampling time of almost <strong>4 ms</strong></p>\n\n<pre><code>I2C_InitStructure.I2C_Timing = 0x0062121F;\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 6697622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MWfw.jpg?s=128&g=1", "display_name": "Moiz Husnain", "link": "https://stackoverflow.com/users/6697622/moiz-husnain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "accepted_answer_id": 48466571, "answer_count": 1, "score": 0, "last_activity_date": 1550055145, "creation_date": 1515612008, "question_id": 48194617, "link": "https://stackoverflow.com/questions/48194617/mpu6050-response-time-with-stm32f303", "title": "MPU6050 response time with STM32F303", "body": "<p>I'm trying to built Self Balancing Robot with STM32F303 Micro controller and for position measurement i'm using MPU6050. While data is being transmitted and received with I2C transmission protocol. I have previous experience with using STM32F303 and also familiar with <strong>I2C protocol</strong> and by consulting the data sheet of <strong>MPU6050</strong>, <strong>STM32F303</strong> and some online resources I have built a code using <strong>Standard Peripheral Libraries</strong> provided by ST Electronics. The problem is that i'm getting the readings but the response time is too slow. On average it should consume maximum <strong>2-3ms</strong> but here it is consuming more than <strong>400ms</strong> and i'm totally unable to figure it out. Since timing is key of this project therefore I need guideline regarding this issue. I'm using <strong>Atollic</strong> as my IDE and the code files are as follows\nMain.c</p>\n\n<pre><code>    #include \"stm32f30x.h\"\n    #include \"stm32f30x_gpio.h\"\n    #include \"stm32f30x_i2c.h\"\n    #include \"stm32f30x_rcc.h\"\n    #include \"stm32f30x_spi.h\"\n    #include \"stm32f30x_misc.h\"\n    #include \"math.h\"\n\n    #include \"mpu6050.h\"\n\n    #define I2C_SDA_PIN     GPIO_Pin_9  // PORTB\n    #define I2C_SCL_PIN     GPIO_Pin_8  // PORTB\n    #define degconvert 57.2957786 // There are like 57 degrees in a radian.\n\n    MPU6050_errorstatus err;\n    static int i = 0;\n    float gyro_xdata;\n    float gyro_ydata;\n    float gyro_zdata;\n    float accel_xdata;\n    float accel_ydata;\n    float accel_zdata;\n    float roll;\n    float pitch;\n\n    void initializeGPIO();\n    void initializeI2C();\n\n    int main(void)\n    {\n        initializeGPIO();\n        initializeI2C();\n\n        err = MPU6050_Initialization();\n\n        // Getting Raw Values\n        err = MPU6050_Get_Gyro_Data(&amp;gyro_xdata, &amp;gyro_ydata, &amp;gyro_zdata);\n        err = MPU6050_Get_Accel_Data(&amp;accel_xdata, &amp;accel_ydata, &amp;accel_zdata);\n\n        // Calculate Pitch and Roll\n        roll = atan2f(accel_ydata, accel_zdata) * degconvert;\n        pitch = atan2f(-accel_xdata, accel_zdata) * degconvert;\n\n        while(1)\n        {\n            // Collect Raw Data from Sensor\n            err = MPU6050_Get_Gyro_Data(&amp;gyro_xdata, &amp;gyro_ydata, &amp;gyro_zdata);\n            err = MPU6050_Get_Accel_Data(&amp;accel_xdata, &amp;accel_ydata, &amp;accel_zdata);\n\n            // The next two lines calculate the orientation of the Accelerometer relative\n            // to the earth and convert the output of atan2 from Radians to Degrees\n            // We will use this data to correct any Cumulative errors in the Orientation\n            // that the gyroscope develops.\n            roll = atan2f(accel_ydata, accel_zdata) * degconvert;\n            pitch = atan2f(-accel_xdata, accel_zdata) * degconvert;\n        }\n    }\n</code></pre>\n\n<p>MPU6050.c</p>\n\n<pre><code>    #include \"mpu6050.h\"\n\n    uint32_t MPU6050_Timeout = MPU6050_FLAG_TIMEOUT;\n    MPU6050_dataStruct dataStruct;\n\n    /* @brief Sets up MPU6050 internal clock and sensors sensitivity rate\n    *  This function must be called before using the sensor!\n    *\n    * @retval @MPU6050_errorstatus\n    */\n    MPU6050_errorstatus MPU6050_Initialization(void){\n\n        MPU6050_errorstatus errorstatus;\n\n        /* Set Clock source for the chip\n         * possible values @pwr_mngt_1\n         */\n        errorstatus = MPU6050_Set_Clock(MPU6050_PLL_X_GYRO);\n        if(errorstatus != 0) return errorstatus;\n\n        /* Set Gyroscope's full scope range\n         * possible values @gyro_scale_range\n         */\n        errorstatus = MPU6050_Gyro_Set_Range(MPU6050_GYRO_250);\n        if(errorstatus != 0) return errorstatus;\n\n        /* Set Accelerometer's full scope range\n         * possible values @accel_scale_range\n         */\n        errorstatus = MPU6050_Accel_Set_Range(MPU6050_ACCEL_2g);\n        if(errorstatus != 0) return errorstatus;\n\n        return MPU6050_NO_ERROR;\n    }\n\n\n    /* @brief Test if chip is visible on I2C line\n     * Reads the WHO_AM_I register\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Test(void){\n\n        MPU6050_errorstatus errorstatus;\n        uint8_t tmp;\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, WHO_AM_I, &amp;tmp, 1);\n        if(tmp != (uint8_t)0x68){\n            return errorstatus;\n        }\n        return MPU6050_NO_ERROR;\n    }\n\n    /* @brief Get Gyroscope's full scale range\n     * Reads the GYRO_CONFIG register and returns the value of gyro's range\n     *\n     * @retval tmp - value of gyro's range\n     */\n    uint8_t MPU6050_Gyro_Get_Range(void){\n\n        MPU6050_errorstatus errorstatus;\n        uint8_t tmp;\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_CONFIG, &amp;tmp, 1);\n        if(errorstatus != 0){\n            return 1;\n        }\n        else return tmp;\n\n    }\n\n    /* @brief Set Gyroscope's full scale range\n     * @param range - check @MPU6050_Gyro_Range\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Gyro_Set_Range(MPU6050_Gyro_Range range){\n\n        MPU6050_errorstatus errorstatus;\n        dataStruct.gyroMul = range;\n\n        errorstatus = MPU6050_Write((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_CONFIG, &amp;range);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n        else return MPU6050_NO_ERROR;\n\n    }\n\n    /* @brief Get Accelerometer full scale range\n     * Reads the Accel_CONFIG register and returns the value of accelerometer's range\n     *\n     * @retval tmp - value of accelerometer's range\n     */\n    uint8_t MPU6050_Accel_Get_Range(void){\n\n        MPU6050_errorstatus errorstatus;\n        uint8_t tmp;\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_CONFIG, &amp;tmp, 1);\n        if(errorstatus != 0){\n            return 1;\n        }\n        else return tmp;\n\n    }\n\n    /* @brief Set Accelerometer full scale range\n     * @param range - check @MPU6050_Accel_Range\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Accel_Set_Range(MPU6050_Accel_Range range){\n\n        MPU6050_errorstatus errorstatus;\n        dataStruct.accelMul = range;\n\n        errorstatus = MPU6050_Write((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_CONFIG, &amp;range);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n        else return MPU6050_NO_ERROR;\n\n    }\n\n    /* @brief Set MPU6050 clock source\n     * @param clock - check @MPU6050_Clock_Select\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus  MPU6050_Set_Clock(MPU6050_Clock_Select clock){\n\n        MPU6050_errorstatus errorstatus;\n\n        errorstatus = MPU6050_Write((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, PWR_MGMT_1, &amp;clock);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n        else return MPU6050_NO_ERROR;\n\n    }\n\n    /* @brief Read MPU6050 temperature\n     * @retval temp_celsius - temperature in degrees celsius\n     */\n    int16_t MPU6050_Get_Temperature(void){\n\n        MPU6050_errorstatus errorstatus;\n        uint8_t temp_low;\n        uint8_t temp_high;\n        int16_t temp;\n        int16_t temp_celsius;\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, TEMP_OUT_L, &amp;temp_low, 1);\n        if(errorstatus != 0){\n            return 1;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, TEMP_OUT_H, &amp;temp_high, 1);\n        if(errorstatus != 0){\n            return 1;\n        }\n\n        temp = (uint16_t)(temp_high &lt;&lt; 8 | temp_low);\n\n        temp_celsius = temp/340 + 36;\n        return temp_celsius;\n\n    }\n\n    /* @brief Get Gyroscope X,Y,Z raw data\n     *\n     * @param X - sensor roll on X axis\n     * @param Y - sensor pitch on Y axis\n     * @param Z - sensor jaw on Z axis\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Get_Gyro_Data_Raw(int16_t* X, int16_t* Y, int16_t* Z){\n\n        MPU6050_errorstatus errorstatus;\n\n        uint8_t xlow, xhigh, ylow, yhigh, zlow, zhigh;\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_XOUT_L, &amp;xlow, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_XOUT_H, &amp;xhigh, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_YOUT_L, &amp;ylow, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_YOUT_H, &amp;yhigh, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_ZOUT_L, &amp;zlow, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, GYRO_ZOUT_H, &amp;zhigh, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        *X = (int16_t)(xhigh &lt;&lt; 8 | xlow);\n        *Y = (int16_t)(yhigh &lt;&lt; 8 | ylow);\n        *Z = (int16_t)(zhigh &lt;&lt; 8 | zlow);\n\n        return MPU6050_NO_ERROR;\n    }\n\n    /* @brief Get Accelerometer X,Y,Z raw data\n     *\n     * @param X - sensor accel on X axis\n     * @param Y - sensor accel on Y axis\n     * @param Z - sensor accel on Z axis\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Get_Accel_Data_Raw(int16_t* X, int16_t* Y, int16_t* Z){\n\n        MPU6050_errorstatus errorstatus;\n\n        uint8_t xlow, xhigh, ylow, yhigh, zlow, zhigh;\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_XOUT_L, &amp;xlow, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_XOUT_H, &amp;xhigh, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_YOUT_L, &amp;ylow, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_YOUT_H, &amp;yhigh, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_ZOUT_L, &amp;zlow, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        errorstatus = MPU6050_Read((MPU6050_ADDRESS &amp; 0x7f) &lt;&lt; 1, ACCEL_ZOUT_H, &amp;zhigh, 1);\n        if(errorstatus != 0){\n            return errorstatus;\n        }\n\n        *X = (int16_t)(xhigh &lt;&lt; 8 | xlow);\n        *Y = (int16_t)(yhigh &lt;&lt; 8 | ylow);\n        *Z = (int16_t)(zhigh &lt;&lt; 8 | zlow);\n\n        return MPU6050_NO_ERROR;\n    }\n\n    /* @brief Get Gyroscope X,Y,Z calculated data\n     *\n     * @param X - sensor roll on X axis\n     * @param Y - sensor pitch on Y axis\n     * @param Z - sensor jaw on Z axis\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Get_Gyro_Data(float* X, float* Y, float* Z){\n\n        MPU6050_errorstatus errorstatus;\n\n        float mult;\n        int16_t gyro_x, gyro_y, gyro_z;\n\n        errorstatus = MPU6050_Get_Gyro_Data_Raw(&amp;gyro_x, &amp;gyro_y, &amp;gyro_z);\n\n        if(dataStruct.gyroMul == MPU6050_GYRO_250){\n            mult = (float)(1/MPU6050_GYRO_RANGE_250);\n        }\n        else if(dataStruct.gyroMul == MPU6050_GYRO_500){\n            mult = (float)(1/MPU6050_GYRO_RANGE_500);\n        }\n        else if(dataStruct.gyroMul == MPU6050_GYRO_1000){\n            mult = (float)(1/MPU6050_GYRO_RANGE_1000);\n        }\n        else mult = (float)(1/MPU6050_GYRO_RANGE_2000);\n\n        *X = (float)(gyro_x*mult);\n        *Y = (float)(gyro_y*mult);\n        *Z = (float)(gyro_z*mult);\n\n        return MPU6050_NO_ERROR;\n    }\n\n    /* @brief Get Accelerometer X,Y,Z calculated data\n     *\n     * @param X - sensor accel on X axis\n     * @param Y - sensor accel on Y axis\n     * @param Z - sensor accel on Z axis\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Get_Accel_Data(float* X, float* Y, float* Z){\n\n        MPU6050_errorstatus errorstatus;\n\n        float mult;\n        int16_t accel_x, accel_y, accel_z;\n\n        errorstatus = MPU6050_Get_Accel_Data_Raw(&amp;accel_x, &amp;accel_y, &amp;accel_z);\n\n        if(dataStruct.accelMul == MPU6050_ACCEL_2g){\n            mult = (float)(1/MPU6050_ACCEL_RANGE_2g);\n        }\n        else if(dataStruct.accelMul == MPU6050_ACCEL_2g){\n            mult = (float)(1/MPU6050_ACCEL_RANGE_4g);\n        }\n        else if(dataStruct.accelMul == MPU6050_ACCEL_2g){\n            mult = (float)(1/MPU6050_ACCEL_RANGE_8g);\n        }\n        else mult = (float)(1/MPU6050_ACCEL_RANGE_16g);\n\n        *X = (float)(accel_x*mult);\n        *Y = (float)(accel_y*mult);\n        *Z = (float)(accel_z*mult);\n\n        return MPU6050_NO_ERROR;\n    }\n\n    /* @brief Reads bytes from MPU6050\n     *\n     * @param SlaveAddr - Slave I2C address\n     * @param RegAddr - register address\n     * @param pBuffer - buffer to write to\n     * @ param NumByteToRead - number of bytes to read\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Read(uint8_t SlaveAddr, uint8_t RegAddr, uint8_t* pBuffer, uint16_t NumByteToRead)\n    {\n\n        /* Test if SDA line busy */\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY) != RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_TransferHandling(I2C1, SlaveAddr, 1, I2C_SoftEnd_Mode, I2C_Generate_Start_Write);\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_TXIS) == RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        if(NumByteToRead&gt;1)\n        RegAddr |= 0x80;\n\n        I2C_SendData(I2C1, (uint8_t)RegAddr);\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_TC) == RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_TX_ERROR;\n        }\n\n        I2C_TransferHandling(I2C1, SlaveAddr, NumByteToRead, I2C_AutoEnd_Mode, I2C_Generate_Start_Read);\n\n        while (NumByteToRead)\n        {\n            MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n            while(I2C_GetFlagStatus(I2C1, I2C_FLAG_RXNE) == RESET)\n            {\n                if((MPU6050_Timeout--) == 0) return MPU6050_I2C_RX_ERROR;\n            }\n\n            *pBuffer = I2C_ReceiveData(I2C1);\n            pBuffer++;\n\n            NumByteToRead--;\n        }\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_STOPF) == RESET)\n        {\n          if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_ClearFlag(I2C1, I2C_FLAG_STOPF);\n\n        return MPU6050_NO_ERROR;\n    }\n\n    /* @brief Writes bytes to MPU6050\n     *\n     * @param SlaveAddr - Slave I2C address\n     * @param RegAddr - register address\n     * @param pBuffer - buffer to write from\n     *\n     * @retval @MPU6050_errorstatus\n     */\n    MPU6050_errorstatus MPU6050_Write(uint8_t SlaveAddr, uint8_t RegAddr, uint8_t* pBuffer)\n    {\n\n        /* Test if SDA line busy */\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY) != RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_TransferHandling(I2C1, SlaveAddr, 1, I2C_Reload_Mode, I2C_Generate_Start_Write);\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_TXIS) == RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_SendData(I2C1, (uint8_t) RegAddr);\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_TCR) == RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_TransferHandling(I2C1, SlaveAddr, 1, I2C_AutoEnd_Mode, I2C_No_StartStop);\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_TXIS) == RESET)\n        {\n            if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_SendData(I2C1, *pBuffer);\n\n        MPU6050_Timeout = MPU6050_LONG_TIMEOUT;\n        while(I2C_GetFlagStatus(I2C1, I2C_FLAG_STOPF) == RESET)\n        {\n          if((MPU6050_Timeout--) == 0) return MPU6050_I2C_ERROR;\n        }\n\n        I2C_ClearFlag(I2C1, I2C_FLAG_STOPF);\n\n        return MPU6050_NO_ERROR;\n    }\n</code></pre>\n"}, {"tags": ["c", "memory", "struct", "unions"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515608797, "post_id": 48193883, "comment_id": 83368274, "body": "Is the <code>v</code> a typo and should by <code>g</code>?"}, {"owner": {"reputation": 1001, "user_id": 8040287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MYbGp.png?s=128&g=1", "display_name": "JackRed", "link": "https://stackoverflow.com/users/8040287/jackred"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515608905, "post_id": 48193883, "comment_id": 83368347, "body": "Yeah, it&#39;s a typo (I copied the formula which is in French)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515609184, "post_id": 48193883, "comment_id": 83368522, "body": "Member of a union share memory, they occupy the exact same memory. Considering that both <code>sImagePPM</code> and <code>sImagePGM</code> are the exact same size and layout, the, both the pointers will be equal. What you seem to want to be doing would overwrite the data you read from."}, {"owner": {"reputation": 1001, "user_id": 8040287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MYbGp.png?s=128&g=1", "display_name": "JackRed", "link": "https://stackoverflow.com/users/8040287/jackred"}, "edited": false, "score": 0, "creation_date": 1515609364, "post_id": 48193883, "comment_id": 83368614, "body": "Yeah, it&#39;s what I would like to do, but since it&#39;s not from the same struct, isn&#39;t there a problem by editing the data one by one, and having a half <code>sImagePPM</code>, and half <code>sImagePGM</code> value inside the union ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1515609583, "post_id": 48193883, "comment_id": 83368734, "body": "While the types of the structures in the union may be different, the memory isn&#39;t. If you make <code>imgPM.sImg.imgG.grey</code> point somewhere, then automatically <code>imgPM.sImg.imgP.array</code> will as well, to the very same location. You can&#39;t switch between members of a union like that (unless you do <i>type punning</i>, which you aren&#39;t)."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1515613990, "post_id": 48193883, "comment_id": 83370908, "body": "Just FYI, image formats pixels are typically laid out from top left to top right, then down to the next row, so you should probably switch your loops around, so that width is in the innermost loop.  (Actually you <i>can</i> treat it as a 1d array of width*height)"}, {"owner": {"reputation": 1001, "user_id": 8040287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MYbGp.png?s=128&g=1", "display_name": "JackRed", "link": "https://stackoverflow.com/users/8040287/jackred"}, "edited": false, "score": 0, "creation_date": 1515614561, "post_id": 48193883, "comment_id": 83371211, "body": "I&#39;m used to read it like this because of my mental representation of 2d array. I treated it at 1d array in the past, but here it&#39;s not interesting because of some operation we have to do). But thanks for the information."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1515614718, "post_id": 48193883, "comment_id": 83371286, "body": "If you don&#39;t at least switch the loops though, you will get a cache miss on every single pixel."}, {"owner": {"reputation": 1001, "user_id": 8040287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MYbGp.png?s=128&g=1", "display_name": "JackRed", "link": "https://stackoverflow.com/users/8040287/jackred"}, "edited": false, "score": 0, "creation_date": 1515615618, "post_id": 48193883, "comment_id": 83371728, "body": "Oh yes, I didn&#39;t see I failed this, my bad you&#39;re right"}], "answers": [{"comments": [{"owner": {"reputation": 1001, "user_id": 8040287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MYbGp.png?s=128&g=1", "display_name": "JackRed", "link": "https://stackoverflow.com/users/8040287/jackred"}, "edited": false, "score": 0, "creation_date": 1515615074, "post_id": 48194940, "comment_id": 83371456, "body": "I wanted to do something like this, with a new array, but our teacher (I&#39;m doing this for school) doesn&#39;t want us to copy an array. If we have to copy an array we have to do it value by value, or affecting it by reference in an init function for exemple. It was why I search for this, since I&#39;m wasn&#39;t sure how union work on the memory side"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1515613417, "creation_date": 1515613417, "answer_id": 48194940, "question_id": 48193883, "link": "https://stackoverflow.com/questions/48193883/modify-struct-in-union-to-other-value-in-union-without-copy/48194940#48194940", "title": "Modify struct in union to other value in union without copy", "body": "<p>The <code>imax</code> member of the struct should be accessible. If the union contains a <code>sImagePPM</code>, when you try to access the <code>imG</code> member, the representation of the <code>sImagePPM</code> is reinterpreted as a representation for a <code>sImagePGM</code> struct. The first member of the struct has the address of the struct, so the first bytes of the representation of the <code>imP</code> member will be the representation of what was <code>imP.imax</code>.</p>\n\n<p>As two numbers with same representation shall have same value <code>imgPM.sImg.imgG.imax</code> shall have the value that <code>imgPM.sImg.imgP.imax had</code>.</p>\n\n<p>Things will probably be worse for the pointers because a <code>sPixel</code> and an <code>int</code> are different types and so are pointers and pointers to pointers to them.</p>\n\n<p>Only in the case where all the arrays of <code>sPixels</code> and the array of pointers to them are dynamically allocated, you can reuse the memory because as dynamic memory has no declared type, it receives the type of the data which is written there. But in that case, it would be simpler to allocate a new block of memory for a <code>int **</code> and <code>int *</code> arrays, compute value of all pixels from the <code>sPixel array</code>, then affect  the newly computed array to the <code>imgPM.sImg.imgG.grey</code> member and free memory used by the <code>sPixel</code> arrays.</p>\n"}], "owner": {"reputation": 1001, "user_id": 8040287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MYbGp.png?s=128&g=1", "display_name": "JackRed", "link": "https://stackoverflow.com/users/8040287/jackred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 48194940, "answer_count": 1, "score": 0, "last_activity_date": 1515613417, "creation_date": 1515608658, "last_edit_date": 1515608930, "question_id": 48193883, "link": "https://stackoverflow.com/questions/48193883/modify-struct-in-union-to-other-value-in-union-without-copy", "title": "Modify struct in union to other value in union without copy", "body": "<p>I have this struct : </p>\n\n<pre><code>typedef struct sPixelRGB {\n    int r;\n    int g;\n    int b;\n} sPixel;\n\ntypedef struct tsImagePPM {\n    long imax;\n    sPixel ** array;\n} sImagePPM;\n\ntypedef struct tsImagePGM {\n    long imax;\n    int ** grey;   \n} sImagePGM;\n\nunion imgType{\n   sImagePPM imgP;\n   sImagePGM imgG;\n };\n\ntypedef struct sImage{\n   union imgType sImg;\n   long height;\n   long width;\n   int type;\n}img;\n</code></pre>\n\n<p>It represent a PPM (rgb) or PGM (only grey) Image (<a href=\"https://en.wikipedia.org/wiki/Netpbm_format\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Netpbm_format</a>).</p>\n\n<p>I have to transform my picture, originally a PPM, to a PGM, by the simple following formula : </p>\n\n<pre><code>grey = 0.299 \u00d7 r + 0.587 \u00d7 g + 0.114 \u00d7 b\n</code></pre>\n\n<p>I want to use this struct with an union because of the others functions I had to do. And I'm wondering if it is possible to modify the sImg.imgP to sImg.imG without making a new sImagePPM, filling it with the new grey value, and then affecting it to the union.</p>\n\n<p>More generally, I'm wondering if it is possible to do something like this :</p>\n\n<pre><code>//img imgPM is initialize\nimgPM.sImg.imgG.imax = imgPM.sImg.imgP.imax \nfor (i = 0 ; i &lt; width ;  i++){\n    for (j = 0 ; j &lt; height ;  j++){\n        imgPM.sImg.imgG[i][j] = imgPM.sImg.imgP[i][j]\n</code></pre>\n\n<p>Because, when I was reading my Image from a file, I didn't see that I forgot to change the imgP to an imgG when I read PGM image, and displaying the imax of the PGM struct was possible, even if I had initialize a PGM struct in the union.</p>\n\n<p>I'm not sure how it works regarding the memory, even though I read a lot of things about it.</p>\n"}, {"tags": ["c", "file", "text", "directory", "lines"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515609446, "post_id": 48193876, "comment_id": 83368658, "body": "(Probably unrelated) After opening a file and testing the pointer with <code>if(f == NULL)</code>, you print an appropriate message <i>but</i> you still merrily let the function continue on that file pointer. Put in a <code>return 0</code> after the message."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515609586, "post_id": 48193876, "comment_id": 83368736, "body": "What do your files look like? Add a few examples so we can check what your code does."}, {"owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515610175, "post_id": 48193876, "comment_id": 83369021, "body": "My files are basically just text files- a single column of two or three decimals, one decimal in each line. For example, my first text file has three numbers in a column: 17.01, 10.31, 74.656. So the code should print out: 17.01   3    when it comes to that particular file."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1515613249, "post_id": 48193876, "comment_id": 83370527, "body": "When you copy the file names to <code>filesList</code>, you don&#39;t null-terminate the strings. You allocate correctly, but after that you should either just <code>strcpy</code> or call <code>strncpy</code> with <code>strlen(...) + 1</code>. Better yet, use the POSIX function <code>strdup</code>, which will do all this -- allocation and copying -- for you."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1515613616, "post_id": 48193876, "comment_id": 83370708, "body": "Your <code>for</code> loop over <code>ch</code> consumes the file -- after it ends, the read position is beyond its end. The subsequent <code>fscanf</code>, whose return value you should check, will not find anything. You can <code>rewind</code> the file to start reading at the beginning again. (But you&#39;ll still have to check the return value of <code>fscanf</code>, so that you&#39;re sure that the first &quot;word&quot; in the file is a floating-point number.)"}, {"owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "edited": false, "score": 0, "creation_date": 1515614981, "post_id": 48193876, "comment_id": 83371406, "body": "Thanks! I implemented rewind(f) after the line count function. The variables show up now, but the line count is still wrong."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1515615499, "post_id": 48193876, "comment_id": 83371671, "body": "When you create <code>filt_len</code>, the contents are uninitialised, that is they most likely contain garbage. You cannot initialise a variable-length array, but you should set <code>filt_len</code> to zero explicitly before your counting loop."}, {"owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "edited": false, "score": 0, "creation_date": 1515616688, "post_id": 48193876, "comment_id": 83372289, "body": "That works! Thank you."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515690152, "post_id": 48193876, "comment_id": 83405998, "body": "the posted code does not compile!  amongst other things, it is missing the statement: <code>#include &lt;string.h&gt;</code>  When compiling, enable the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515690321, "post_id": 48193876, "comment_id": 83406090, "body": "the function: <code>getc()</code> (often implemented as a macro invoking <code>fgetc()</code>) returns a <code>int</code>, not a <code>char</code>, so this statement: <code>char ch1;</code>  should be: <code>int ch1;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515690714, "post_id": 48193876, "comment_id": 83406318, "body": "a directory entry can be several different kinds of things.  Strongly suggest (besides checking for <code>.</code> and <code>..</code> to also take into consideration the <code>struct dirent</code> field: <code>d_type</code> (although note that not all file systems actually implement that field.)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515690903, "post_id": 48193876, "comment_id": 83406424, "body": "when calling any of the heap allocation functions: (malloc, calloc, realloc) 1) always check (!=NULL) the returned value to assure the operation was successful.  2) the returned type is <code>void*</code>, so can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515690978, "post_id": 48193876, "comment_id": 83406470, "body": "rather than calling <code>malloc()</code>, followed by <code>strcpy()</code>,  suggest calling: <code>strdup()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515691194, "post_id": 48193876, "comment_id": 83406571, "body": "regarding: <code>if(f == NULL){       printf(&quot;Trouble opening file.&quot;);</code>  This actually tells the user little to nothing about the underlying cause of the problem.  Suggest: <code>if(f == NULL){       perror(&quot;Trouble opening file.&quot;);</code>  as this will properly output the error message to <code>stderr</code> rather than <code>stdout</code> AND will output the reason the system thinks the error occurred."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515691436, "post_id": 48193876, "comment_id": 83406717, "body": "regarding: <code>or (ch1 = getc(f); ch1 != EOF; ch1 = getc(f))</code>  the <code>EOF</code> is actually <code>-1</code>, which may (or may not) be properly compared, depending on if <code>char</code> has the default attribute of <code>signed</code> or <code>unsigned</code>.  To be safe (and make a proper check), declare <code>ch1</code> and <code>int</code> rather than <code>char</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515691530, "post_id": 48193876, "comment_id": 83406780, "body": "regarding: <code>if (ch1 == &#39;\\n&#39;)</code>  note that a &#39;\\n&#39; is actually a <code>int</code> value, so needs to be compared to an <code>int</code>.  Therefore declare <code>ch1</code> as an <code>int</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515691707, "post_id": 48193876, "comment_id": 83406880, "body": "regarding: <code>if(f == NULL){       printf(&quot;Trouble opening file.&quot;);     }</code>  The code must not continue if the the file pointer <code>f</code> is NULL,  otherwise, any activity involving that file pointer will result in a seg fault event.  Suggest inserting the statement: <code>exit( EXIT_FAILURE );</code> before the closing brace &#39;}&#39;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515691823, "post_id": 48193876, "comment_id": 83406957, "body": "the posted code fails to pass the allocated heap memory pointers (gotten from calls to <code>malloc()</code>) to <code>free()</code>.  It is poor programming practice to let the system cleanup when the program exits."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515691881, "post_id": 48193876, "comment_id": 83406988, "body": "it is poor programming practice to include header files those contents are not being used.  Suggest removing the statement: <code>#include &lt;math.h&gt;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515692048, "post_id": 48193876, "comment_id": 83407067, "body": "many times, a text file will not have a &#39;\\n&#39; (newline) on the very end of the file, so this code block: <code>for (ch1 = getc(f); ch1 != EOF; ch1 = getc(f)){       if (ch1 == &#39;\\n&#39;)         filt_len[i] = filt_len[i] + 1;     }</code> will not result in the correct line count.  This will also not work if the file is not a &#39;regular&#39; file  (cont)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515692224, "post_id": 48193876, "comment_id": 83407167, "body": "(cont):  suggest replacing with: <code>for( int i=0; fgets( ...); i++ );</code> or something similar."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515692314, "post_id": 48193876, "comment_id": 83407212, "body": "regarding: <code>fscanf(f, &quot;%lf&quot;, &amp;variable);</code>   This statement will produce garbage for most files."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515692655, "post_id": 48193876, "comment_id": 83407419, "body": "The posted code is failing to check if the directory entry is actually the name of a &#39;regular&#39; file.   If not a &#39;regular&#39; file, do not open that file for reading."}], "owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515614500, "creation_date": 1515608630, "last_edit_date": 1515614500, "question_id": 48193876, "link": "https://stackoverflow.com/questions/48193876/c-program-counting-lines-in-text-file-incompatible-with-directory-scan", "title": "C Program- counting lines in text file incompatible with directory scan?", "body": "<p>I'm trying to read a variable from multiple text files in a directory. When I run the code, it glitches after I try to read the number of lines in each text file. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;dirent.h&gt;\n\nint main()\n{\n\n  DIR *ptr;\n  double variable;\n  int n, i;\n  FILE *f;\n  char ch1;\n\n  n=0;\n  i=0;\n\n  struct dirent *directory;\n  ptr = opendir(\"faketext\");\n  while((directory = readdir(ptr)) != NULL)\n  {\n    if ( !strcmp(directory-&gt;d_name, \".\") || !strcmp(directory-&gt;d_name, \"..\") )\n    {\n\n    } else {\n      n++;\n    }\n  }\n\n  rewinddir(ptr);\n\n  char *filesList[n];\n\n  //Put file names into the array\n  while((directory = readdir(ptr)) != NULL) {\n    if ( !strcmp(directory-&gt;d_name, \".\") || !strcmp(directory-&gt;d_name, \"..\") )\n    {}\n    else {\n      filesList[i] = (char*) malloc (strlen(directory-&gt;d_name)+1);\n      strncpy (filesList[i],directory-&gt;d_name, strlen(directory-&gt;d_name) );\n      i++;\n    }\n  }\n  closedir(ptr);\n\n  int filt_len[n];\n\n  for(i=0; i&lt;n; i++){\n    char buf[0x100];\n    snprintf(buf, sizeof(buf), \"faketext/%s\", filesList[i]);\n    f = fopen(buf, \"r\");\n    if(f == NULL){\n      printf(\"Trouble opening file.\");\n    }\n\n    for (ch1 = getc(f); ch1 != EOF; ch1 = getc(f)){\n      if (ch1 == '\\n')\n        filt_len[i] = filt_len[i] + 1;\n    }\n\n    fscanf(f, \"%lf\", &amp;variable);\n    printf(\"%f\\t%d\\n\",variable, filt_len[i]);\n    fclose(f);\n  }\n\n  return 0;\n\n}\n</code></pre>\n\n<p>This program works perfectly... if I don't include the line-counting function. And the line-counting function works well outside of this program- I've used it multiple times before to great success. </p>\n\n<p>I'm currently running the program with four test text files, each with two or three variables inside. The output should be the first variable in each text file (a nonzero decimal), followed by the number 2 or 3. </p>\n\n<p>When I run the program, this is the output:</p>\n\n<p>0.000000        14</p>\n\n<p>0.000000        35</p>\n\n<p>0.000000        17</p>\n\n<p>0.000000        4199674</p>\n\n<p>Does anyone have any thoughts on why this isn't working? I don't understand why the two functions would work well separately but not together.</p>\n\n<p>(New to C and self-taught.) </p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1515608502, "post_id": 48193815, "comment_id": 83368107, "body": "<code>&#39;z&#39;-&#39;a&#39;</code> equals to <code>25</code>. So you have several UBs here. And a string has to be null-terminated to print it with <code>printf</code>..."}, {"owner": {"reputation": 716, "user_id": 2031180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jkKlR.jpg?s=128&g=1", "display_name": "campescassiano", "link": "https://stackoverflow.com/users/2031180/campescassiano"}, "edited": false, "score": 1, "creation_date": 1515608546, "post_id": 48193815, "comment_id": 83368140, "body": "<code>@</code> corresponds to 64 in decimal number, so make sure if this is not the reason, because coincidentally, <code>@</code> is one position before capital letter <code>A</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1515609037, "last_edit_date": 1515609037, "creation_date": 1515608675, "answer_id": 48193890, "question_id": 48193815, "link": "https://stackoverflow.com/questions/48193815/alphabet-array-in-c-has-an-extra-at-the-end/48193890#48193890", "title": "Alphabet array in C has an extra &#39;@&#39; at the end", "body": "<p>Your suspicion is correct: You need to end the strings off with a '\\0' since <code>printf</code>(and pretty much every other string handling function in C) expects them like this. Also you would need one more element in the array for the whole alphabet. You code should be:</p>\n\n<pre><code>char lc['z' - 'a' + 2];\nfor(int i = 'a'; i &lt;= 'z'; i++ ) {\n    lc[i - 'a'] = i ;\n}\n\nlc['z' - 'a' + 1] = '\\0';\n\nprintf(\"%s\", lc);\n\nchar uc['Z' - 'A' + 2];\nfor(int i = 'A'; i &lt;= 'Z'; i++ ) {\n    uc[i - 'A'] = i ;\n}\n\nuc['Z' - 'A' + 1] = '\\0';\n\nprintf(\"\\n%s\", uc);\n</code></pre>\n\n<p>If you are wondering the '@' is probably just a random value in memory after the array and since it hasn't reached '\\0' <code>printf</code> continues printing.</p>\n"}], "owner": {"reputation": 15, "user_id": 9200088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s4KOnGkmAoo/AAAAAAAAAAI/AAAAAAAAAFU/qALpqMgO1dc/photo.jpg?sz=128", "display_name": "Teya", "link": "https://stackoverflow.com/users/9200088/teya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 48193890, "answer_count": 1, "score": -1, "last_activity_date": 1515609037, "creation_date": 1515608394, "question_id": 48193815, "link": "https://stackoverflow.com/questions/48193815/alphabet-array-in-c-has-an-extra-at-the-end", "title": "Alphabet array in C has an extra &#39;@&#39; at the end", "body": "<p>I'm trying to build two string arrays by using the letters' corresponding ASCII codes - one with lowercase alphabet letters and one with uppercase.</p>\n\n<pre><code>char lc['z' - 'a'];\nfor(int i = 'a'; i &lt;= 'z'; i++ ) {\n    lc[i - 'a'] = i ;\n}\n\nprintf(\"%s\", lc);\n\nchar uc['Z' - 'A'];\nfor(int i = 'A'; i &lt;= 'Z'; i++ ) {\n    uc[i - 'A'] = i ;\n}\n\nprintf(\"\\n%s\", uc);\n</code></pre>\n\n<p>The output I get is correct, except that for both tables, there's an extra @ symbol at the end and I have no idea why. If I change the loop condition to i &lt; 'Z' instead, it cuts off the z/Z, not the @, so I suspect it might have something to do with the '\\0' symbol ending string arrays?</p>\n"}, {"tags": ["c", "pointers", "struct"], "answers": [{"tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 0, "last_activity_date": 1515608875, "last_edit_date": 1515608875, "creation_date": 1515608360, "answer_id": 48193803, "question_id": 48193730, "link": "https://stackoverflow.com/questions/48193730/accessing-an-integer-within-a-structure-which-has-pointer-to-structure/48193803#48193803", "title": "Accessing an integer within a structure which has Pointer to structure", "body": "<p>Do this instead:</p>\n\n<pre><code>time v = (n_access[3].ptrtoarray + 1)-&gt;record;\nint c = v.c;\n</code></pre>\n\n<p>To avoid copying the <code>time</code> structure, use a pointer,</p>\n\n<pre><code>time *v = &amp;(n_access[3].ptrtoarray + 1)-&gt;record;\nint c = v-&gt;c;\n</code></pre>\n\n<p>Simpler way? Don't do it all in one line</p>\n\n<pre><code>access* my_access = &amp;n_access[3];\nmyarray* array = &amp;my_access-&gt;ptrtoarray[1];\ntime *v = &amp;array-&gt;record;\nint c = v-&gt;c;\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48193803, "answer_count": 1, "score": 1, "last_activity_date": 1515608875, "creation_date": 1515608074, "question_id": 48193730, "link": "https://stackoverflow.com/questions/48193730/accessing-an-integer-within-a-structure-which-has-pointer-to-structure", "title": "Accessing an integer within a structure which has Pointer to structure", "body": "<p>I am new to pointers and trying to use a pointer to the structure.I need to access the structure parameter using pointer. Kindly assist me.</p>\n\n<p>Here is the program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct{\nint a;\nint b;\nint c;\n}time;\n\ntypedef struct{\nint a;\nint b;\ntime record;\n}myarray;\n\ntypedef struct{\n  myarray *ptrtoarray\n}access;\n\nmyarray n_my_array_first[2] =\n{\n\n    {1 ,2 , {1 , 2 ,2}},\n    {100 ,121 , {123,322,65535}}\n\n};\n\nmyarray n_my_array_third[2] =\n{\n  {23,44,{1,43,22}},\n  {23,48,{455,666,999}}\n};\n\naccess n_access[5] =\n{\n       {&amp;n_myarray_first},\n       {((void *)0)},\n       {((void *)0)},\n       {&amp;n_myarray_third},\n       {((void *)0)}\n};\n\nint main()\n{\n\n   /* access the record.c parameter of second element of n_my_array_third array.\n       whose value is 999 \n\n  I have tried it as : \n   time v = n_access[3].(n_myarray_third + 1) -&gt; record.c ; \n   But I am getting an error */\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Q 1 )Explain what could possibly be done to access the fields .</p>\n\n<p>Q 2 )Present any simpler ways to achieve the same thing (by using structure within structure)\nif possible.Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1515607465, "post_id": 48193547, "comment_id": 83367550, "body": "Not once do you check the return value from <code>scanf()</code>.  It returns a value for a reason."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1515607633, "post_id": 48193547, "comment_id": 83367644, "body": "<code>scanf(&quot;%s&quot;,&amp;b[i].name);</code> -&gt; <code>scanf(&quot;%s&quot;,b[i].name);</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1515607798, "post_id": 48193547, "comment_id": 83367727, "body": "<code>obj</code> and <code>price</code> are arrays. You evidently meant to use <code>j</code> as the index into those arrays."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1515608039, "post_id": 48193547, "comment_id": 83367842, "body": "Read carefully the documentation of <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">scanf</a> and of every other function you are using. Compile your code with all warnings &amp; debug info (<code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>) and <b>use the debugger</b>. <i>Fix-my-code</i> questions and <i>do-my-homework</i> questions are off-topic on SO."}, {"owner": {"reputation": 3, "user_id": 9199981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1612497852163846/picture?type=large", "display_name": "Shashank Das", "link": "https://stackoverflow.com/users/9199981/shashank-das"}, "edited": false, "score": 0, "creation_date": 1515956485, "post_id": 48193547, "comment_id": 83488645, "body": "I dont know why I was putting num=0. Actually there was a line num=b[i].numb. The variable num was being used somewhere else, this is just a snippet of the part of the code not used."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9199981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1612497852163846/picture?type=large", "display_name": "Shashank Das", "link": "https://stackoverflow.com/users/9199981/shashank-das"}, "edited": false, "score": 0, "creation_date": 1515956374, "post_id": 48193737, "comment_id": 83488618, "body": "Hey, thanks for the answer, I dont know why I was putting num=0.  Actually there was a line num=b[i].numb. The variable num was being used somewhere else, this is just a snippet of the part of the code not used. Thanks btw, it was really helpful"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1515608117, "creation_date": 1515608117, "answer_id": 48193737, "question_id": 48193547, "link": "https://stackoverflow.com/questions/48193547/the-scanf-is-not-reading-the-values/48193737#48193737", "title": "The scanf is not reading the values", "body": "<p>Your code has many small mistakes:</p>\n\n<ul>\n<li><code>scanf(\"%s\", &amp;b[i].name);</code> does not need <code>&amp;</code></li>\n<li><code>num=0;</code> is not necessary; remove it</li>\n<li>Nested loop condition should use <code>j &lt; b[i].numb</code> as its condition</li>\n<li>Nested loop is not using <code>j</code>. It needs to add <code>[j]</code> to both <code>obj</code> and <code>price</code>.</li>\n</ul>\n\n<p>Once you fix these problems, your code runs as expected as long as the input is correct (<a href=\"https://ideone.com/fW6QrJ\" rel=\"nofollow noreferrer\">demo</a>).</p>\n\n<p>However, this is not enough to make your code robust: you need to add error checking to ensure that invalid input does not cause undefined behavior:</p>\n\n<ul>\n<li>Add limits to string format specifiers in <code>scanf</code> to avoid buffer overflows (e.g. <code>%49s</code> to read <code>name[50]</code>),</li>\n<li>Add a limit to the outer loop in case <code>m</code> is above 50,</li>\n<li>Add a limit to the nested loop in case <code>b[i].numb</code> is above 10,</li>\n<li>Add checks of return values for <code>scanf</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1515665857, "last_edit_date": 1515665857, "creation_date": 1515665245, "answer_id": 48204402, "question_id": 48193547, "link": "https://stackoverflow.com/questions/48193547/the-scanf-is-not-reading-the-values/48204402#48204402", "title": "The scanf is not reading the values", "body": "<ul>\n<li><code>num</code> is undeclared.  The program does not compile to executable.  See below.</li>\n<li>Don't pass <code>&amp;b[i].name</code> to <code>scanf(3)</code>, as the <code>%s</code> format requires a <code>char *</code> and the <code>&amp;b[i].name</code> is not that type (it is, indeed, <code>char *[50]</code>, while compatible, it is not the same type, while <code>b[i].name</code> is)</li>\n<li>change <code>num</code> by <code>b[i].numb</code> in the inner <code>for</code> loop.  This is the proper number of items.  You have to check for array sizes also, as you have hardwired them in the code.  If you don't you can overrun </li>\n<li>Use inside the inner loop <code>b[i].obj[j]</code> for the object name as the reference to <code>scanf(3)</code></li>\n<li>Use inside the inner loop <code>&amp;b[i].price[j]</code> for the <code>j</code>-esim <code>price</code>.  You have forgotten it here and in the point above.</li>\n<li>you have to add code to print the individual objects (the inner loop has no <code>printf(3)</code> at all.</li>\n</ul>\n\n<p>A valid (but not completely correct, as array sizes are not checked) could be:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct mall {\n    char name[50];\n    char obj[10][30];\n    float price[10];\n    int numb;\n}b[50];\n\nint main()\n{\n    int m; // number of persons who shopped at the mall\n    scanf(\"%d\",&amp;m);\n    for(int i=0; i&lt;m; i++) {\n        scanf(\"%s\",b[i].name);\n        scanf(\"%d\",&amp;b[i].numb);\n        printf(\"* name = %s\\n\"\n                       \"  numb = %d\\n\",b[i].name,b[i].numb);\n        for(int j=0; j &lt; b[i].numb; j++) {\n            scanf(\"%s\",b[i].obj[j]);\n            scanf(\"%f\",&amp;b[i].price[j]);\n                    printf(\"  * obj = %s\\n\", b[i].obj[j]);\n                    printf(\"    price = %.2f\\n\", b[i].price[j]);\n        }\n    }    \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9199981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1612497852163846/picture?type=large", "display_name": "Shashank Das", "link": "https://stackoverflow.com/users/9199981/shashank-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1515665857, "creation_date": 1515607388, "last_edit_date": 1515607525, "question_id": 48193547, "link": "https://stackoverflow.com/questions/48193547/the-scanf-is-not-reading-the-values", "title": "The scanf is not reading the values", "body": "<p>Hey this is the entire code.\nI m a beginner in C, I was trying to make a code which has a structure mall and takes into input the name, number of items shopped , the name of each item and the cost of each item.\n* For small programs like this i fix the max size of the structure object\nBut the program cant take the input in the manner desired.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct mall\n\n{\n\n    char name[50];\n    char obj[10][30];\n    float price[10];\n    int numb;\n}b[50];\n\nvoid main()\n\n{\n\n    int m; // number of persons who shopped at the mall\n\n    scanf(\"%d\",&amp;m);\n\n    for(int i=0;i&lt;m;i++)\n    {\n        num=0;\n        scanf(\"%s\",&amp;b[i].name);\n        scanf(\"%d\",&amp;b[i].numb);\n        printf(\"%s\\n%d\",b[i].name,b[i].numb);\n        for(int j=0;j&lt;num;j++)\n        {\n            scanf(\"%s\",&amp;b[i].obj);\n            scanf(\"%f\",&amp;b[i].price);\n        }\n    }    \n}\n</code></pre>\n\n<p>For the input :</p>\n\n<pre><code>1\nRam 2 bread 50.00 jam 25.00\n</code></pre>\n\n<p>I m getting the output as</p>\n\n<p>2500</p>\n"}, {"tags": ["c", "inline"], "comments": [{"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1515603292, "post_id": 48192187, "comment_id": 83365200, "body": "That link as a case where it is not compiled because we are not declaring the function in same translation unit. But in my case I have declared and it is compiling properly"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515607385, "post_id": 48192187, "comment_id": 83367511, "body": "I&#39;m using these questions (as well as the one you quoted) as guides.  <a href=\"https://stackoverflow.com/questions/216510-inline\">extern inline</a> \u2014 <a href=\"https://stackoverflow.com/questions/6312597\">Is &quot;inline&quot; without &quot;static&quot; or &quot;extern&quot; ever useful in C99?</a> \u2014 . <a href=\"https://stackoverflow.com/questions/5229343\">How to declare an inline function in a C99 multi-file project?</a>.  My experimentation towards writing this up is available on GitHub in my SOQ repository: <a href=\"https://github.com/jleffler/soq/blob/osiris/extern-inline/src/extern-inline/\" rel=\"nofollow noreferrer\">github.com/jleffler/soq/blob/osiris/extern-inline/src/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1515619107, "post_id": 48192187, "comment_id": 83373479, "body": "Both your examples are UB as you have a function declared <code>inline</code> in one unit but not <code>inline</code> in another unit"}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515648506, "post_id": 48193896, "comment_id": 83381604, "body": "Have some difficulty in understanding correctly. In case 1: &quot;The declaration in temp1.c says that there is an external definition somewhere, but temp2.c is not that place. There needs to be an external definition provided by some other translation unit.&quot; ..But when I compile it, the temp1.c has taken  fun1 from  temp2.c . Is there any wrong in my understanding ? &quot;There is no need for a forward declaration of fun1() in the first example, either.&quot; When I remove the declaration it is showing &quot;In function <code>main&#39;,  undefined reference to </code>fun1&#39;. Can you please explain this ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515684857, "post_id": 48193896, "comment_id": 83402415, "body": "@Salim, your comment prompted me to re-examine the question and my answer, and to make substantial revisions to the analysis of your specific examples.  You should find the changes clearly marked."}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515696077, "post_id": 48193896, "comment_id": 83409307, "body": "So the inline function in the 1st case(having inline definition) behaves like a static inline function. Can we conclude like this if we have a inline declaration in the same TU?"}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515696670, "post_id": 48193896, "comment_id": 83409626, "body": "Where or what way can we use effectively inline function in 1st case ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515697901, "post_id": 48193896, "comment_id": 83410187, "body": "@Salim, Yes, a genuine inline definition of a function has properties similar to those of the definition of a static function.  In particular, neither of those kinds of function definition is an external definition."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515698379, "post_id": 48193896, "comment_id": 83410422, "body": "@Salim, in any given program, there can be only one external definition of any given identifier.  At the same time, if an inline function is declared in a given translation unit, then a definition of that function must appear in the same TU.  Therefore, if you have a function with external linkage, and it is declared as an inline function in two or more different TUs, then you need a way to ensure that at most one of the required definitions of that function is an external definition.  Making the others be inline definitions serves that purpose."}, {"owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "edited": false, "score": 0, "creation_date": 1515735804, "post_id": 48193896, "comment_id": 83422023, "body": "Thank you very much john!!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1515684732, "last_edit_date": 1515684732, "creation_date": 1515608701, "answer_id": 48193896, "question_id": 48192187, "link": "https://stackoverflow.com/questions/48192187/differentiate-extern-inline-and-inline-in-c/48193896#48193896", "title": "Differentiate extern inline and inline in C", "body": "<p>With respect to the first, \"inline function\" example, you say (highlighting added to function names),</p>\n\n<blockquote>\n  <p>Since <code>fun1</code> is a inline definition in temp2.c, it will be seen as\n  undefined from temp1.c. So external declaration in temp1.c made\n  temp1.c to access <code>fun1</code> from temp2.c.</p>\n</blockquote>\n\n<p>Your explanation is incorrect<s>, or at least misworded</s>.  <s>In this example, your temp2.c does not provide an external definition of function <code>fun1()</code>.  The declaration in temp1.c says that there is an external definition <em>somewhere</em>, but temp2.c is not that place.  There needs to be an external definition provided by some other translation unit</s>. <em>Function <code>fun1</code> in temp2.c</em> is <em>an inline function because it is declared with the <code>inline</code> keyword (that's all it means to be an \"inline function\"), but the definition of <code>fun1</code> in that file</em> is not <em>an inline</em> definition, <em>because temp2.c contains another declaration of its identifier that does not include the <code>inline</code> keyword.  Since <code>fun1</code> is declared with (implicitly) external linkage, that is an</em> external <em>definition of <code>fun1</code>.  Anyone can call it. To get an inline definition of a function,</em> every <em>declaration of its identifier in the TU must include the <code>inline</code> keyword and must omit the <code>extern</code> keyword.</em></p>\n\n<p><em>Standard C does require the function to be declared in temp1.c if it is to be called from that TU, but nothing you put in that file could enable code within to access an inline definition of <code>fun1</code> from a different TU.  Only external definitions are accessible across TUs -- that's what being an external definition means.</em></p>\n\n<p><strong><em>Note</strong>: The original (now stricken-out) text of this part of this answer supposed that temp2.c indeed did provide an inline definition of function <code>fun1</code>, because I overlooked the flaw(?) in the declarations.</em></p>\n\n<blockquote>\n  <p>I am confused as in the quotes it\n  is saying \"separate external definition\" instead of external\n  declaration.</p>\n</blockquote>\n\n<p>A function definition comprises a declaration of that function, but not every function declaration is part of a definition.  We must be careful with our wording here.  There is no meaningful sense of an \"external function <em>declaration</em>\" in C, in that no declaration has a scope wider than its translation unit.</p>\n\n<p>But one can, and often does, have (local) declarations of functions with <em>external linkage</em>.  This is the default, applicable to all function declarations that do not include the keyword <code>static</code>.  That default can be made explicit by use of the <code>extern</code> keyword, and that happens to have additional significance for declarations of inline functions.</p>\n\n<p>An external function <em>definition</em>, on the other hand, is one that can be accessed by name from another translation unit.  An inline definition explicitly is not an external definition.  Thus, your first example declares that there is a function <code>fun1</code> with external linkage, but <s>does not</s> if all the declarations of that identifier carried the <code>inline</code> keyword and not <code>extern</code> then it would not provide a corresponding external definition of that function.  If that function <s>is</s> were called, even from a source file that provides an inline definition, then the absence of an external definition <s>is</s> would be an error.</p>\n\n<hr>\n\n<p>With respect to the second, \"extern inline function\" example, you say (highlighting added to function names),</p>\n\n<blockquote>\n  <p>Since <code>fun1</code> is extern inline function, it can be called from temp1.c.</p>\n</blockquote>\n\n<p>Let's separate out the properties here.</p>\n\n<ul>\n<li><code>fun1</code> is (still) declared as a function with external linkage.</li>\n<li>The presence of the <code>inline</code> specifier in the declaration that is part of its definition makes it an inline function.</li>\n<li>The presence of the explicit <code>extern</code> specifier on a declaration of that function in the same translation unit as a definition makes the definition in that TU an external one.</li>\n</ul>\n\n<p>It is the fact that the definition in temp2.c is an external one that makes it callable from temp1.c.</p>\n\n<blockquote>\n  <p>The only difference what I observed is, no need of explicit\n  declaration of the extern inline function where it is defined.</p>\n</blockquote>\n\n<p><s>There is no need for a forward declaration of <code>fun1()</code> in the first example, either.  There would be a need for a forward declaration in <em>both</em> cases if temp2.c contained a call to <code>fun1</code> prior to that function's definition.  There is no difference here.</s></p>\n\n<hr>\n\n<p><em>Update:</em></p>\n\n<p><em>You are more or less right.  Your two alternatives are different ways to declare an an inline function with external linkage and to provide an external definition for it.  Instead, the thing you should be comparing to, and to which the original text of this answer was erroneously addressed, would be this:</em></p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ninline int32_t fun1(void);\n\ninline int32_t fun1(void)\n{\n   return 0;\n}\n</code></pre>\n\n<p><em>or, equivalently, this:</em> </p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ninline int32_t fun1(void)\n{\n   return 0;\n}\n</code></pre>\n\n<p><em>In those cases, the provided definition of <code>fun1</code> is an inline definition, accessible only from the translation unit of temp2.c.  Of course, that's not useful unless there is code in that TU that actually calls the function.</em></p>\n\n<hr>\n\n<blockquote>\n  <p>Is it the only difference ? else what are the other major difference\n  and the scope of inline and extern inline functions ?</p>\n</blockquote>\n\n<p>You are doing yourself a disservice by attempting to set up \"inline\" and \"extern inline\" as classes of functions.  There are inline functions and non-inline functions.  There are function <em>identifiers</em> with internal linkage and those with external linkage.  There are inline function <em>definitions</em>, internal ones, and external ones, and appearance of a function declaration in a TU does not necessarily require a definition in the same TU.  These combinations (and only these) of those properties are possible:</p>\n\n<ul>\n<li>function identifier is declared with <strong>external linkage</strong>, function <strong>is not</strong> an inline function, and an <strong>external definition</strong> of the function  appears in the TU</li>\n<li>function identifier is declared with <strong>external linkage</strong>, function <strong>is not</strong> an inline function, and <strong>no definition</strong> of the function appears in the TU with the declaration.  <em>If the function identifier is referenced in the TU then an external definition appears in a different TU.</em></li>\n<li>function identifier is declared with <strong>external linkage</strong>, function <strong>is</strong> an inline function, and an <strong>inline definition</strong> of the function appears in the TU.  <em>If the function identifier is referenced in the TU then an external definition appears in a different TU.</em></li>\n<li>function identifier is declared with <strong>external linkage</strong>, <em>explicitly</em>, function <strong>is</strong> an inline function, and an <strong>external definition</strong> of the function appears in the TU</li>\n<li>function identifier is declared with <strong>internal linkage</strong>, the function <strong>is not</strong> an inline function, an <strong>internal definition</strong> of the function appears in the TU</li>\n<li>function identifier is declared with <strong>internal linkage</strong>, the function <strong>is not</strong> an inline function, an <strong>no definition</strong> of the function appears in the TU. <em>The function identifier is never referenced in that TU.</em></li>\n<li>function identifier is declared with <strong>internal linkage</strong>, the function <strong>is</strong> an inline function, an <strong>inline definition</strong> of the function appears in the TU</li>\n</ul>\n\n<p>A function identifier declared with external linkage in a given TU refers refers to an external function definition, which may appear in a different TU.</p>\n\n<p>A function identifier declared with internal linkage in a given TU refers refers to an internal or inline function definition in the same TU.</p>\n\n<p>An inline function declaration may have either external or internal linkage, in either case, an inline definition of that function must appear in the same TU.  If the function identifier has external linkage (in that TU) and an inline function definition then it is left to the discretion of the implementation whether and where the inline definition or the (required) external definition elsewhere is used within that TU.</p>\n\n<hr>\n\n<p><em>Update:</em></p>\n\n<p><em>Upon reflection, your characterization of functions themselves as \"inline functions\" and \"extern inline functions\" seems to reflect the idea that inline character of a function is</em> globally <em>associated with the function's identifier (e.g. <code>fun1</code>), at least for identifiers with external linkage.  This is not the case, as I hope my rather lengthy discourse has conveyed.</em></p>\n\n<p><em>Inline character of a function identifier is a per-TU property, and inline character of a function definition is a separate, per-definition property.  If in any TU you declare a given function to be an inline function, then you must provide a definition of that function in that TU.  An external definition of a function from a different TU does not satisfy that requirement, even if the function is declared to be an inline function in the TU in which the definition appears.</em></p>\n"}], "owner": {"reputation": 265, "user_id": 8953281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69d09d598912cb37d56adce43bfaa804?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/8953281/salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "closed_date": 1515642797, "accepted_answer_id": 48193896, "answer_count": 1, "score": 2, "last_activity_date": 1515684732, "creation_date": 1515602531, "question_id": 48192187, "link": "https://stackoverflow.com/questions/48192187/differentiate-extern-inline-and-inline-in-c", "closed_reason": "Duplicate", "title": "Differentiate extern inline and inline in C", "body": "<p>I am trying to understand extern inline and inline functions.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25000497/whats-the-difference-between-static-inline-extern-inline-and-a-normal-inline-f\">What&#39;s the difference between static inline, extern inline and a normal inline function?</a></p>\n\n<p>Quoting lines from the above link:\n\"A function definition with just inline defines an inline function with external linkage. However, such definition is referred to as inline definition and it does not work as external definition for that function. That means that even though this function has external linkage, it will be seen as undefined from other translation units, unless you provide a separate external definition for it somewhere.</p>\n\n<p>A function definition with extern inline defines an inline function with external linkage and at the same time this definition serves as external definition for this function. It is possible to call such function from other translation units.\"</p>\n\n<p>But I am not able to understand this correctly.</p>\n\n<p>I have a sample code which explains what I understood:</p>\n\n<ol>\n<li>inline function: </li>\n</ol>\n\n<p>In temp1.c</p>\n\n<pre><code>#include &lt;stdint.h&gt;\nextern int32_t fun1(void);\n\nint32_t main(void)\n{\n  int32_t result = fun1(); \n  return result;  \n}\n</code></pre>\n\n<p>In temp2.c</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nint32_t fun1(void);\ninline int32_t fun1(void)\n{\n   return 0;\n}\n</code></pre>\n\n<p>Since fun1 is a inline definition in temp2.c, it will be seen as undefined from temp1.c. So external declaration in temp1.c made temp1.c to access fun1 from temp2.c. I am confused as in the quotes it is saying \"separate external definition\" instead of external declaration. </p>\n\n<ol start=\"2\">\n<li>extern inline function</li>\n</ol>\n\n<p>temp1.c</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nint32_t fun1(void);\nint32_t main(void)\n{\n  int32_t result = fun1(); \n  return result;  \n}\n</code></pre>\n\n<p>temp2.c</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nextern inline int32_t fun1(void)\n{\n  return 0;\n}\n</code></pre>\n\n<p>Since fun1 is extern inline function, it can be called from temp1.c. \nThe only difference what I observed is, no need of explicit declaration  of the extern inline function where it is defined.</p>\n\n<p>Is it the only difference ? else what are the other major difference and the scope of inline and extern inline functions ?</p>\n\n<p>Please correct if any of the above observation is wrong</p>\n"}, {"tags": ["c", "matrix", "boolean"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515601164, "post_id": 48191723, "comment_id": 83363824, "body": "Mathematical description is fine but a bit obscure. Can you give an example?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515601510, "post_id": 48191723, "comment_id": 83364079, "body": "As an aside, note that your file-scope array <code>P</code> cannot be initialized by a function call as your example seems to show.  In C, function calls may appear only inside function bodies."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515601792, "post_id": 48191723, "comment_id": 83364273, "body": "In any case, are you saying that function <code>FsiPermutationHack()</code> correctly implements the computation you want, but you&#39;re looking for improvements?  In that case, unless you have a specific problem with the code, the question is probably better suited for <a href=\"https://codereview.stackexchange.com/\">Code Review</a>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515601795, "post_id": 48191723, "comment_id": 83364274, "body": "maybe better suited for the code review exchange?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515601990, "post_id": 48191723, "comment_id": 83364398, "body": "Oh, and as another aside, you need to initialize variable <code>r</code> before you start processing the array."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515614700, "post_id": 48191723, "comment_id": 83371275, "body": "The snippet was mostly intended to illustrate the idea but you are of course right about the technicalities."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515614796, "post_id": 48191723, "comment_id": 83371327, "body": "And I don&#39;t know about Code Review, I&#39;m more looking for Concept Review - maybe the CS stackexchange is better suited but I think that this problem has more to do with the craft of coding rather than the theory. Which makes me think this is the right place for it, after all."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515622291, "post_id": 48191723, "comment_id": 83374887, "body": "Coming back to examine the question itself more carefully, I observe that your prose description of the problem does not seem to match your example code.  You are not mapping bits of <code>s</code> into bits of <code>r</code>.  You are mapping <i>rows of P</i> to <code>r</code> based on an acceptance predicate encoded in <code>s</code>."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515624512, "post_id": 48191723, "comment_id": 83375752, "body": "I don&#39;t understand what you are trying to say here. I don&#39;t think the problem is very unclear at all. You have 16 bits, each of these bits either maps to a number between 0..31, or NULL. The details of the exact mapping is arbitrary. This can be equivalently stated as a binary matrix equation mapping s to r by way of P. What confuses you?"}], "answers": [{"comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1515604702, "post_id": 48192427, "comment_id": 83366009, "body": "I was about to propose to split the matrix in tow submatrices to compute separately the high order u16 word and the low order one from <code>r</code> when I realized that it was exactly your solution!"}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515615013, "post_id": 48192427, "comment_id": 83371421, "body": "This was what I was implying with the comment about the compiler splitting it for me as well. Can&#39;t accept it as an answer though, because I still suspect there exists some neat bit twiddling hack that fundamentally improves on my solution. An alternative ideal answer would give some rationale as to why my proposed method is unlikely to be improved upon."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515619755, "post_id": 48192427, "comment_id": 83373741, "body": "@BenjaminLindqvist, I have added somewhat in the way of an argument for optimality, but if you&#39;re not persuaded then I don&#39;t know what more I can do.  No one can compare the code presented to an unspecified approach you imagine may exist.  You of course have the alternative of waiting for more answers.  If you wish to do so, then may I suggest that you set some reasonable time limit, after which you accept whichever of the answers you then have that you like best?"}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515620514, "post_id": 48192427, "comment_id": 83374101, "body": "There&#39;s nothing wrong with letting a question go unanswered."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515621228, "post_id": 48192427, "comment_id": 83374439, "body": "To clarify. I think we&#39;ve investigated all slight variations on my original solution. But I am not convinced there is no other way of approaching the problem."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515621786, "post_id": 48192427, "comment_id": 83374698, "body": "@BenjaminLindqvist, I could believe that there is another, better, approach to the overall task(s) that <code>FsiPermutationHack()</code> serves, but inasmuch as you have not disclosed that task, no answer can address it.  As you have couched the problem -- a specific computation to perform based on a specific input format -- I think you are being disingenuous by judging answers based on a completely unsubstantiated assumption that there must be some fundamentally different approach than you have already conceived."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515621968, "post_id": 48192427, "comment_id": 83374763, "body": "@BenjaminLindqvist you are right, of course, that you are not obligated to accept any answer, and certainly not mine in particular.  But if indeed you have asked a question to which you are uncertain there exists an answer that will satisfy you, then that question is inappropriate for SO."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515622144, "post_id": 48192427, "comment_id": 83374826, "body": "You are pretty off-base and I&#39;d suggest a moderator removes most of this rubbish. Your answer, while lengthy, is simply not all that good, which is why I didn&#39;t accept it."}, {"owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "edited": false, "score": 0, "creation_date": 1515622910, "post_id": 48192427, "comment_id": 83375138, "body": "I didn&#39;t notice you had edited, please disregard that last comment. I think your point in that we have to concede traversal of all 32 indices is good and with that in mind, it is hard to shave more off. However, I can see one big possible optimization. Brb"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1515619412, "last_edit_date": 1515619412, "creation_date": 1515603362, "answer_id": 48192427, "question_id": 48191723, "link": "https://stackoverflow.com/questions/48191723/efficient-tiny-boolean-matrix-multiplication/48192427#48192427", "title": "Efficient tiny boolean matrix multiplication", "body": "<p>Inasmuch as you say,</p>\n\n<blockquote>\n  <p>I am guessing this would be like ~100 instructions IF we didn't have\n  to do that stupid u32 cast. But then again, perhaps the compiler\n  auto-splits the loop in two for us in which case it's looking pretty\n  good for us.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>I have a gut feeling there exists some super simple hack that I'm missing</p>\n</blockquote>\n\n<p>, I will interpret you to be asking how to minimize the use of 32-bit arithmetic in this code intended for a 16-bit processor.</p>\n\n<p>You really ought to learn how to disassemble and check the compiled result to see whether the compiler does automatically split the loop as you hypothesize, but supposing that it does not, I don't see why you couldn't do the same manually:</p>\n\n<pre><code>static u16 P[32];  /* value assigned elsewhere */\n\nu32 FsiPermutationHack(u16 s) {\n    u16 *P_hi = P + 16;\n    u16 r_lo = 0;\n    u16 r_hi = 0;\n\n    for (u16 i = 0; i &lt; 16; i++) {\n        r_lo |= (P[i] &amp; s) != 0) &lt;&lt; i;\n        r_hi |= (P_hi[i] &amp; s) != 0) &lt;&lt; i;\n    }\n\n    return ((u32) r_hi &lt;&lt; 16) + r_lo;\n}\n</code></pre>\n\n<p>That supposes <code>u16</code> and <code>u32</code> to be unsigned 16-bit and 32-bit (respectively) integers with no padding bits.</p>\n\n<p>Note also that the idea that performing arithmetic with type <code>u16</code> instead of <code>u32</code> should be an improvement assumes that type <code>u32</code> has a higher integer promotion rank than <code>unsigned int</code>.  Roughly speaking, that comes down to the implementation's <code>unsigned int</code> being a 16-bit type.  That's entirely plausible for an implementation for a 16-bit processor.  On a system whose <code>int</code> and <code>unsigned int</code> are instead 32-bit types, however, all narrower integer arithmetic arguments would be promoted to 32 bits anyway.</p>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<p>As far as the possibility of a better alternative algorithm, I observe that each bit of the result is computed from a different element of array <code>P</code>, that the whole value of each element is used, and that the element size is the same as the target machine's native word size.  There seems then no scope for performing fewer 16-bit bitwise AND operations than there are array elements (but see below).</p>\n\n<p>If we accept that each array element must be processed separately, then the provided implementation does a pretty good job of approaching it efficiently:</p>\n\n<ul>\n<li>It performs only 16-bit computations until the time comes to assemble the final result;</li>\n<li>It computes both the upper and lower halves of the result in the same loop, thus incurring only 16 iterations' worth of loop overhead instead of 32</li>\n<li>It largely removes the extra indexing arithmetic that that would otherwise have required by creating <code>P_hi</code> for accessing the upper half of the array</li>\n</ul>\n\n<p>It would be possible to manually unroll the loop to possibly save a few more cycles, but that's the kind of optimization that you absolutely should rely on your compiler to perform for you.</p>\n\n<p>As far as \"bit twiddling hacks\", the only scope I see for anything of that nature would be processing adjacent pairs of 16-bit array elements as 32-bit unsigned integers.  That would allow performing one 32-bit bitwise AND in place of each two 16-bit ANDs.  That would be coupled with two 32-bit comparisons (<em>vs.</em> two 16-bit comparisons in the above code).  The 16-bit shift and bitwise OR operations of the above approach could be retained.  Aside from that having formally undefined behavior as a result of violating the strict aliasing rule, that would involve 32-bit arithmetic, which presumably is about half as fast as 16-bit arithmetic on your 16-bit machine. Performance is better measured than predicted, but I don't see any reason to expect a significant win from that approach.</p>\n"}], "owner": {"reputation": 3302, "user_id": 2391384, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb328ff5f63bf442bc5145f5a589d645?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindqvist", "link": "https://stackoverflow.com/users/2391384/benjamin-lindqvist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 48192427, "answer_count": 1, "score": 0, "last_activity_date": 1515619412, "creation_date": 1515600955, "question_id": 48191723, "link": "https://stackoverflow.com/questions/48191723/efficient-tiny-boolean-matrix-multiplication", "title": "Efficient tiny boolean matrix multiplication", "body": "<p>I have some unsigned 16 bit integer <code>s</code> which I'd like to map to an unsigned 32 bit integer <code>r</code> in such a way that each flipped bit in <code>s</code> flips at most one (given) bit in <code>r</code> -- simply a mapping between <code>0..16</code> and <code>0..32</code> that is. So we can see this as a matrix equation</p>\n\n<pre><code>Ps = r\n</code></pre>\n\n<p>where P is a <code>32 x 16</code> boolean matrix, <code>s</code> is a <code>16 x 1</code> boolean vector and <code>r</code> is <code>32 x 1</code> boolean vector. I have a gut feeling there exists some super simple hack that I'm missing. Important note: the target machine is a 16 bit mcu!</p>\n\n<p>Here's the best I can do:</p>\n\n<pre><code>static u16 P[32] = someArrayOrWhatever();\n\nu32 FsiPermutationHack(u16 s) {\n    u32 r;\n    for (u16 i = 0; i &lt; 32; i++)\n    {\n            r |= ((u32)((P[i] &amp; s) &gt; 0) &lt;&lt; i);\n    }\n    return r;\n}\n</code></pre>\n\n<p>The rationale is this: the i:th bit of <code>r</code> is 1 if and only if <code>(P[i] &amp; s) != 0x0000</code>. I am too stupid to disassemble stuff, but I am guessing this would be like ~100 instructions IF we didn't have to do that stupid <code>u32</code> cast. But then again, perhaps the compiler auto-splits the loop in two for us in which case it's looking pretty good for us. </p>\n\n<p>Apologies for the tangent, just thought I'd share my attempted solution -- do you have a better one?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1515599601, "post_id": 48191273, "comment_id": 83362727, "body": "<i>&quot;codeblock cannt execute the programm&quot;</i> is not a problem description... Why not? What error did it give you? <a href=\"https://stackoverflow.com/posts/48191273/edit\">Edit</a> your post to quote it in full."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1515599915, "post_id": 48191273, "comment_id": 83362958, "body": "<code>arr[0] = max;</code> Where is <code>max</code> initialized?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1515599952, "post_id": 48191273, "comment_id": 83362987, "body": "You would save yourself considerable trouble if you avoided recording the numbers in an array.  You don&#39;t need to do that for your purposes -- you can instead track the minimum and maximum as you go, as you do their count, without preserving the individual numbers across subsequent reads."}], "answers": [{"comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 1, "creation_date": 1515599779, "post_id": 48191291, "comment_id": 83362868, "body": "I was just about to mention the #3 in your problems part. Good note.. :-)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1515599817, "post_id": 48191291, "comment_id": 83362894, "body": "Not closing the file is perhaps a style problem, but one can rely on any open files being closed automatically if the program terminates normally."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515599957, "post_id": 48191291, "comment_id": 83362991, "body": "@JohnBollinger.: It is a good practice."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1515600289, "post_id": 48191291, "comment_id": 83363232, "body": "@coderredoc : There are other issues too with <code>fscanf</code> because the input file the user supplies can&#39;t be trusted entirely to contain numbers. Worth mentioning that too.."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1515600629, "post_id": 48191291, "comment_id": 83363459, "body": "@sjsam.: Hm..yes. Edited."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 3, "last_activity_date": 1515602599, "last_edit_date": 1515602599, "creation_date": 1515599607, "answer_id": 48191291, "question_id": 48191273, "link": "https://stackoverflow.com/questions/48191273/what-do-i-do-wrong-c-language-with-file-txt/48191291#48191291", "title": "What do i do wrong (c language with file.txt)", "body": "<pre><code>fscanf(in,\"%d\",&amp;arr[i] != EOF)\n</code></pre>\n\n<p>will be</p>\n\n<pre><code>fscanf(in,\"%d\",&amp;arr[i]) != EOF\n</code></pre>\n\n<p>But there are other problems also </p>\n\n<ul>\n<li><p>Not checking the return value of <code>fopen</code>.</p>\n\n<pre><code>if(in != NULL ){\n   /* File opened correctly */\n}\n</code></pre></li>\n<li><p>No guard while accessing the array. if <code>i&gt;=100</code> there will be array index out of bound error leading to undefined behavior.</p></li>\n<li><p>You forgot to <strike>declare</strike> initialize <code>max</code>. </p></li>\n<li><p>You meant to initialize <code>max</code> to <code>arr[0]</code>. So correct will be <code>max = arr[0]</code>. There is no use assigning value of <code>arr[0]</code> in case you want to find the maximum. </p></li>\n<li><p>Also you have to keep in mind that if <code>fscanf</code> doesn't return <code>EOF</code> then you can't be relieved that it worked unless you check that 2 value is being parsed correctly. The output of <code>fscanf</code> should be equal to 1 since one value is being read.</p>\n\n<pre><code>int r = fscanf(\"%d\",&amp;arr[i]);\nif( r == 1 ){\n   /* SUCCESS */\n}\nelse if( errno ) {\n   /* Error occured */\n}\nelse if( r == EOF ){\n   /* Either EOF reached or some I/O error. */\n}\n</code></pre></li>\n</ul>\n\n<p>Also among other things (not an error but a good practice)</p>\n\n<ul>\n<li><p>Not closing the file.</p>\n\n<pre><code>fclose(in);\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 119, "user_id": 7420920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/faQWJ.png?s=128&g=1", "display_name": "\u041c\u0443\u0437\u0430\u0444\u0444\u0430\u0440 \u0428\u0430\u043a\u0430\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/7420920/%d0%9c%d1%83%d0%b7%d0%b0%d1%84%d1%84%d0%b0%d1%80-%d0%a8%d0%b0%d0%ba%d0%b0%d1%80%d0%be%d0%b2"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1515600217, "answer_count": 1, "score": -6, "last_activity_date": 1515602599, "creation_date": 1515599529, "last_edit_date": 1515600174, "question_id": 48191273, "link": "https://stackoverflow.com/questions/48191273/what-do-i-do-wrong-c-language-with-file-txt", "closed_reason": "Not suitable for this site", "title": "What do i do wrong (c language with file.txt)", "body": "<p>There is a following exercise:</p>\n\n<p>I have a <code>file.txt</code> containing a lot of unknown numbers, separated by one or more spaces or by a new line.(<code>file.txt</code> in one folder with my program).</p>\n\n<p>I must find total amount of numbers and maximum value. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n    FILE *in;\n    in=fopen(\"file.txt\",\"r\");\n    int arr[100],i=0,j,max;\n    while(fscanf(in,\"%d\",&amp;arr[i] != EOF)) {\n        i++;\n    }\n    arr[0]=max;\n    for(j=1;j&lt;i;j++) {\n        if(max &lt; arr[j]) {\n            max = arr[j];\n        }\n    }\n    printf(\"Tot.number: %d\\nMax: %d\",i,max);\n}\n</code></pre>\n\n<p>But, codeblock cannot execute the program.</p>\n"}, {"tags": ["c", "gprof"], "comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1515600795, "post_id": 48191189, "comment_id": 83363560, "body": "Could you be using OSX? Gprof was known to be broken on OSX for a time"}, {"owner": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1515674716, "post_id": 48191189, "comment_id": 83395676, "body": "No I&#39;m not using OSX..."}], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 2022949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9440d07066518e43b758cc6af4d532c?s=128&d=identicon&r=PG", "display_name": "Joseph Glover", "link": "https://stackoverflow.com/users/2022949/joseph-glover"}, "is_accepted": false, "score": 1, "last_activity_date": 1563164984, "creation_date": 1563164984, "answer_id": 57033267, "question_id": 48191189, "link": "https://stackoverflow.com/questions/48191189/gprof-function-etext-is-taking-100-05-of-time-running/57033267#57033267", "title": "gprof : function &#39;etext&#39; is taking 100.05% of time running", "body": "<p>I was having a similar issue and it was caused by me calling <code>gprof</code> with a different executable.</p>\n\n<p>The accident occurred because I was recompiling with different options and naively called <code>gprof</code> with the same executable name on two different <code>gmon.out</code> files that were generated with different executables.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>gprof exec1 exec1.gmon.out # Good, expected output\ngprof exec1 exec2.gmon.out # Weird etext function with 0 calls, but lots of time consumed\n</code></pre>\n\n<p>Make sure you're not doing something similar.</p>\n"}], "owner": {"reputation": 75, "user_id": 7240603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vUonh.jpg?s=128&g=1", "display_name": "ludmi", "link": "https://stackoverflow.com/users/7240603/ludmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1563164984, "creation_date": 1515599296, "last_edit_date": 1515599834, "question_id": 48191189, "link": "https://stackoverflow.com/questions/48191189/gprof-function-etext-is-taking-100-05-of-time-running", "title": "gprof : function &#39;etext&#39; is taking 100.05% of time running", "body": "<p>I used gprof to get a profile of a c code which is running too slowly. Here is what I get:</p>\n\n<pre><code>Flat profile:\nEach sample counts as 0.01 seconds.\n  %   cumulative   self              self     total           \n time   seconds   seconds    calls  Ts/call  Ts/call  name    \n100.05      0.16     0.16                             etext\n  0.00      0.16     0.00    90993     0.00     0.00  Nel_wind\n  0.00      0.16     0.00    27344     0.00     0.00  calc_crab_dens\n  0.00      0.16     0.00    17472     0.00     0.00  Nel_radio\n  0.00      0.16     0.00     1786     0.00     0.00  sync\n  0.00      0.16     0.00        1     0.00     0.00  _fini\n  0.00      0.16     0.00        1     0.00     0.00  calc_ele\n  0.00      0.16     0.00        1     0.00     0.00  ic\n  0.00      0.16     0.00        1     0.00     0.00  initialize\n  0.00      0.16     0.00        1     0.00     0.00  make_table\n</code></pre>\n\n<p>I don't know what does \"etext\" mean and why is it taking 100.05% of time running. Thanks for your help!</p>\n"}, {"tags": ["c", "linux", "fork", "exec", "mmap"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515598045, "post_id": 48190685, "comment_id": 83361585, "body": "<i>after exec is done</i> - <code>exec</code> is not returning."}, {"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515598196, "post_id": 48190685, "comment_id": 83361698, "body": "I know, but I wonder if parent and resulting process after exec can share memory somehow using mmap"}], "answers": [{"tags": [], "owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1515598302, "creation_date": 1515598302, "answer_id": 48190868, "question_id": 48190685, "link": "https://stackoverflow.com/questions/48190685/shared-memory-after-exec/48190868#48190868", "title": "shared memory after exec()", "body": "<p>You can use <code>shm_open</code> to open a \"named\" shared memory block which is identified by a file on the filesystem. Example:\nIn the parent:</p>\n\n<pre><code>int memFd = shm_open(\"example_memory\", O_CREAT | O_RDWR, S_IRWXU);\nif (memFd == -1)\n{\n    perror(\"Can't open file\");\n    return 1;\n}\n\nint res = ftruncate(memFd, /*size of the memory block you want*/);\nif (res == -1)\n{\n    perror(\"Can't truncate file\");\n    return res;\n}\nvoid *buffer = mmap(NULL, /*size of the memory block you want*/, PROT_READ | PROT_WRITE, MAP_SHARED, memFd, 0);\nif (buffer == NULL)\n{\n    perror(\"Can't mmap\");\n    return -1;\n}\n</code></pre>\n\n<p>In the other file:</p>\n\n<pre><code>int memFd = shm_open(\"example_memory\", O_RDONLY, 0);\nif (memFd == -1)\n{\n    perror(\"Can't open file\");\n    return 1;\n}\n\nvoid *buffer = mmap(NULL, /*size of the memory block you want*/, PROT_READ, MAP_SHARED, memFd, 0);\nif (buffer == NULL)\n{\n    perror(\"Can't mmap\");\n    return -1;\n}\n</code></pre>\n\n<p>After these segments of code you can use <code>buffer</code> to access the shared memory. (Note: it doesn't need to be <code>void*</code>, you can make it a pointer to whatever you intend to store in the shared mem)</p>\n"}, {"comments": [{"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "edited": false, "score": 1, "creation_date": 1515658586, "post_id": 48191050, "comment_id": 83385770, "body": "@Jogn Bollinger : You wrote: Only if the child re-maps the memory after the exec()..And how can be remmaped using mmap from the child?"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1515598837, "creation_date": 1515598837, "answer_id": 48191050, "question_id": 48190685, "link": "https://stackoverflow.com/questions/48190685/shared-memory-after-exec/48191050#48191050", "title": "shared memory after exec()", "body": "<blockquote>\n  <p>How can I share memory between the parent and the child if the child\n  has run exec() to load another program?</p>\n</blockquote>\n\n<p>Neither memory mappings created via <code>mmap()</code> nor POSIX shared-memory segments obtained via <code>shm_open()</code> nor System V shared-memory segments obtained via <code>shmat()</code> are preserved across an exec.  That covers all the forms of shared memory I am aware of Linux providing.</p>\n\n<p>It follows that if you want the child to share memory with the parent after an <code>exec()</code> then the child must (re)connect to the appropriate shared memory <em>after</em> the <code>exec()</code>.  Obviously, that means that whatever program is started by the <code>exec()</code> must be written to do that.  (Note in particular that on success, the exec-family functions do not return.)</p>\n\n<blockquote>\n  <p>Is it possible using mmap?</p>\n</blockquote>\n\n<p>Only if the child re-maps the memory after the <code>exec()</code>.</p>\n\n<blockquote>\n  <p>By now parent and child share memory properly using mmap, but not\n  after exec is done</p>\n</blockquote>\n\n<p>That is by design.</p>\n"}], "owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2665, "favorite_count": 1, "accepted_answer_id": 48190868, "answer_count": 2, "score": 3, "last_activity_date": 1515598837, "creation_date": 1515597874, "question_id": 48190685, "link": "https://stackoverflow.com/questions/48190685/shared-memory-after-exec", "title": "shared memory after exec()", "body": "<p>How can I share memory between the parent and the child if the child has run <strong>exec()</strong> to load another program?</p>\n\n<p>Is it possible using <strong>mmap</strong>?</p>\n\n<p>By now parent and child share memory properly using mmap, but not after <strong>exec</strong> is done</p>\n"}, {"tags": ["c", "arrays", "structure", "definition"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1515597848, "post_id": 48190662, "comment_id": 83361433, "body": "No. It is not. Obviously <code>Size</code> doesn&#39;t have any value when defined."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1515597866, "post_id": 48190662, "comment_id": 83361448, "body": "A compiler can tell you if it&#39;s correct. Faster than it would have taken you to post this question."}, {"owner": {"reputation": 395, "user_id": 4391643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3d135c95c4c9a676c3149ebc800d908?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Over", "link": "https://stackoverflow.com/users/4391643/stack-over"}, "edited": false, "score": 0, "creation_date": 1515597896, "post_id": 48190662, "comment_id": 83361466, "body": "So is there any solution?"}, {"owner": {"reputation": 1362, "user_id": 7131301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95feecfe61cbcdf86514a34cdc248623?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas By", "link": "https://stackoverflow.com/users/7131301/tomas-by"}, "edited": false, "score": 0, "creation_date": 1515597921, "post_id": 48190662, "comment_id": 83361489, "body": "You declare <code>Pattern</code> as a pointer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1515597924, "post_id": 48190662, "comment_id": 83361492, "body": "Dynamic allocation is the solution."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1515597946, "post_id": 48190662, "comment_id": 83361506, "body": "<a href=\"https://stackoverflow.com/questions/36577094/array-of-size-0-at-the-end-of-struct\" title=\"array of size 0 at the end of struct\">stackoverflow.com/questions/36577094/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 2, "last_activity_date": 1515597908, "creation_date": 1515597908, "answer_id": 48190696, "question_id": 48190662, "link": "https://stackoverflow.com/questions/48190662/structure-definition-in-c/48190696#48190696", "title": "Structure definition in C", "body": "<p>You can't do that. That is violating the rule. Compile the code and you will know it clearly.</p>\n\n<p>Rather keep a <code>uint8*</code> and then allocate to it memory (using <code>malloc</code>,<code>realloc</code> etc) based on the value of <code>Size</code>.</p>\n\n<p>And now if you increase or decraese the value <code>Size</code> as per that reallocate your memory.</p>\n\n<p>Yes with this, you have to free the dynamically allocated memory when you are done working with it.</p>\n"}, {"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 1, "last_activity_date": 1515597985, "creation_date": 1515597985, "answer_id": 48190729, "question_id": 48190662, "link": "https://stackoverflow.com/questions/48190662/structure-definition-in-c/48190729#48190729", "title": "Structure definition in C", "body": "<p>Go with</p>\n\n<pre><code>uint8*   Pattern;\n</code></pre>\n\n<p>and use <code>malloc</code> to allocate its size once <code>Size</code> is known.</p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 5, "last_activity_date": 1515689588, "last_edit_date": 1515689588, "creation_date": 1515598094, "answer_id": 48190782, "question_id": 48190662, "link": "https://stackoverflow.com/questions/48190662/structure-definition-in-c/48190782#48190782", "title": "Structure definition in C", "body": "<p>An array declared as a struct field must either have an <em>integer constant expression</em> as its size or be a <em>flexible array member</em> with no size (<code>uint8 Pattern[];</code>). Your variant is neither.</p>\n\n<p>If the array size in your case is a run-time value, you have two choices</p>\n\n<ol>\n<li><p>Flexible array member <code>uint8 Pattern[];</code>, which will result in a \"flat\" struct. The proper amount of memory to accommodate the entire struct with the array of desired length will have to be allocated with <code>malloc</code> manually.</p></li>\n<li><p>Pointer member <code>uint8 *Pattern;</code>, in which case your struct will become two-leveled. Memory for the struct itself and memory for the array will generally become two separate memory blocks allocated independently.</p></li>\n</ol>\n\n<p>A flexible array member is typically a better idea (and matches your apparent original intent), unless you have some other requirements that would preclude that aproach.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1515598202, "creation_date": 1515598202, "answer_id": 48190825, "question_id": 48190662, "link": "https://stackoverflow.com/questions/48190662/structure-definition-in-c/48190825#48190825", "title": "Structure definition in C", "body": "<p>Just remove the array size <code>Size</code> in the declaration of <code>Pattern</code> and you will get a valid declaration of a structure with a flexible array member.:)</p>\n\n<pre><code>typedef struct Info_s\n{\n uint8   Size;\n uint8   Address;\n uint8   Pattern[];    \n}Info_t;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8793706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a1fe710a98c9e31e5bbd88e5512e17?s=128&d=identicon&r=PG", "display_name": "Abhishek Koranne", "link": "https://stackoverflow.com/users/8793706/abhishek-koranne"}, "is_accepted": false, "score": 1, "last_activity_date": 1515598935, "creation_date": 1515598935, "answer_id": 48191080, "question_id": 48190662, "link": "https://stackoverflow.com/questions/48190662/structure-definition-in-c/48191080#48191080", "title": "Structure definition in C", "body": "<p>If you want to dynamically allocate memory to the structure, you can do it in following way :</p>\n\n<pre><code>struct Info_s\n{\n uint8   Address;\n uint8   Pattern[Size];    \n};\n\nint main()\n{\n       struct Info_s *no;\n       int i, noOfRecords;\n       printf(\"Enter no: \");\n       scanf(\"%d\", &amp;noOfRecords);\n\n       no=(struct Info_s*) malloc (noOfRecords * sizeof(struct course));\n\n       for(i=0;i&lt;noOfRecords;++i)\n       {\n          scanf(...);\n       }\n     .\n     .\n     .\n     return 0;\n}\n</code></pre>\n\n<p>You can also refer <a href=\"https://www.programiz.com/c-programming/examples/structure-dynamic-memory-allocation\" rel=\"nofollow noreferrer\">https://www.programiz.com/c-programming/examples/structure-dynamic-memory-allocation</a> for more information.</p>\n"}], "owner": {"reputation": 395, "user_id": 4391643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3d135c95c4c9a676c3149ebc800d908?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Over", "link": "https://stackoverflow.com/users/4391643/stack-over"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 48190782, "answer_count": 5, "score": 0, "last_activity_date": 1515689588, "creation_date": 1515597791, "last_edit_date": 1515600696, "question_id": 48190662, "link": "https://stackoverflow.com/questions/48190662/structure-definition-in-c", "title": "Structure definition in C", "body": "<p>I want to define a structure on the following way:</p>\n\n<pre><code>typedef struct Info_s\n{\n uint8   Size;\n uint8   Address;\n uint8   Pattern[Size];    \n}Info_t;\n</code></pre>\n\n<p>As you can notice the size of the array Pattern is \"Size\" which is declared first in the same structure.</p>\n\n<p>Is that correct?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1515597114, "post_id": 48190416, "comment_id": 83360886, "body": "So what happens if you run your program?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1515597135, "post_id": 48190416, "comment_id": 83360910, "body": "For an array of e.g. five elements (like the <code>article</code> array), what are the valid indexes? What range do you create with <code>rand() % 6</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515597154, "post_id": 48190416, "comment_id": 83360931, "body": "Also, please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your program</a>."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 4, "last_activity_date": 1515597113, "creation_date": 1515597113, "answer_id": 48190445, "question_id": 48190416, "link": "https://stackoverflow.com/questions/48190416/how-to-generate-random-sentences-in-c-using-arrays/48190445#48190445", "title": "How to generate random sentences in C using arrays?", "body": "<pre><code>r1 = rand() % 6;\n</code></pre>\n\n<p>have values <code>0,1,2,3,4,5</code></p>\n\n<p>But the first array has <code>5</code> elements. So you were accessing array index out of bound and were having undefined behavior.</p>\n\n<p>Instead </p>\n\n<pre><code>r1 = rand() % arraysize;\n</code></pre>\n\n<p>This works.(Same you have to do for other arrays also).</p>\n\n<p>So for example in the first case <code>arraysize = 5</code> so <code>r1= rand()%5</code> and for <code>r2=rand()%5</code> etc. (Here you have array size = 5 for all the arrays).</p>\n\n<p>Getting the array size will be like this in this case</p>\n\n<pre><code>r2 = rand()%( sizeof noun/ sizeof noun[0] );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515597650, "post_id": 48190532, "comment_id": 83361289, "body": "@Yunnosch you&#39;re right. But the answer is the same :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515598091, "post_id": 48190532, "comment_id": 83361621, "body": "<i>was</i> misleading. Now fixed"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515603981, "post_id": 48190532, "comment_id": 83365635, "body": "@chux better safe than sorry"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1515603991, "last_edit_date": 1515603991, "creation_date": 1515597396, "answer_id": 48190532, "question_id": 48190416, "link": "https://stackoverflow.com/questions/48190416/how-to-generate-random-sentences-in-c-using-arrays/48190532#48190532", "title": "How to generate random sentences in C using arrays?", "body": "<p>All your lists have less than 6 elements, so from time to time, the random routine returns a value outside the list bounds: read a garbage pointer => undefined behaviour. So now the \"random\" bug is explained.</p>\n\n<p>Now what happens when you (or another developper) add or remove elements to one list? you have to adjust sizes again.</p>\n\n<p>I'd create a small macro to avoid doing that:</p>\n\n<pre><code>#define RANDSTRING(s) s[rand() % (sizeof(s)/sizeof(*(s)))]\n</code></pre>\n\n<p>now:</p>\n\n<pre><code>const char *r = RANDSTRING(noun);\n</code></pre>\n\n<p>picks a value in the <code>noun</code> list, guaranteed to be in bounds.</p>\n\n<p>it works on lists of strings and computes the size correctly. It won't work on pointers on pointers like <code>char **</code>, though.</p>\n\n<p>It also doesn't work on empty lists (<code>% 0</code> is illegal, and it makes no sense anyway)</p>\n"}], "owner": {"reputation": 73, "user_id": 8470819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I81LxVLJKhc/AAAAAAAAAAI/AAAAAAAAAIY/5UOnHNjCu7E/photo.jpg?sz=128", "display_name": "Co_Co", "link": "https://stackoverflow.com/users/8470819/co-co"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1515603991, "creation_date": 1515597024, "question_id": 48190416, "link": "https://stackoverflow.com/questions/48190416/how-to-generate-random-sentences-in-c-using-arrays", "title": "How to generate random sentences in C using arrays?", "body": "<p>I`m trying to generate random sentences but sometimes i got an error or it prints random characters.\nBelow is what i done. (the sentences should have the folowing format: article , noun , verb, preposition, article and noun).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n\n\nint main() {\nsrand(time(NULL));\n    int r1, r2, r3, r4, r5, r6;\n    char *article[] = {\"the\" , \"a\" , \"one\" , \"some\", \"any\"};\n    char *noun[] = {\"boy\" , \"girl\" , \"dog\" , \"town\", \"car\"};\n    char *verb[] = {\"drove\" , \"jumped\" , \"ran\" , \"walked\", \"skipped\"};\n    char *preposition[] = {\"to\" , \"from\" , \"over\" , \"under\", \"on\"};\n\n    r1 = rand() % 6; r2 = rand() % 6; r3 = rand() % 6;  r4 = rand() % 6; r5 = rand() % 6; r6 = rand() % 6;\n    printf(\"%s %s %s %s  %s %s\\n\", article[r1], noun[r2], verb[r3], preposition[r4], article[r5], noun[r6]);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "memory-leaks"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1515595407, "post_id": 48189791, "comment_id": 83359731, "body": "Whatever your hardware platform gives SW access to is accessible in C. C can access whatever memory addresses you wish, and it can access I/O ports as well, depending upon what your platform&#39;s C compiler tools enable."}, {"owner": {"reputation": 1275, "user_id": 1835601, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/j6OWh.jpg?s=128&g=1", "display_name": "Simo Erkinheimo", "link": "https://stackoverflow.com/users/1835601/simo-erkinheimo"}, "edited": false, "score": 0, "creation_date": 1515596809, "post_id": 48189791, "comment_id": 83360699, "body": "Assuming you&#39;re not writing your own OS or kernel driver, then no. See <a href=\"https://stackoverflow.com/questions/11467292/how-can-i-access-all-bytes-of-ram-and-rom-of-my-computer\" title=\"how can i access all bytes of ram and rom of my computer\">stackoverflow.com/questions/11467292/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 8808557, "user_type": "registered", "profile_image": "https://graph.facebook.com/1460375444016481/picture?type=large", "display_name": "Jason McCullough", "link": "https://stackoverflow.com/users/8808557/jason-mccullough"}, "edited": false, "score": 0, "creation_date": 1515599610, "post_id": 48189791, "comment_id": 83362735, "body": "My reputation isn&#39;t high enough to upvote your comments but just want to acknowledge your contribution with thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1275, "user_id": 1835601, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/j6OWh.jpg?s=128&g=1", "display_name": "Simo Erkinheimo", "link": "https://stackoverflow.com/users/1835601/simo-erkinheimo"}, "edited": false, "score": 0, "creation_date": 1515599165, "post_id": 48189856, "comment_id": 83362415, "body": "The Q&amp;A is now extremely misleading. For the most usual environments like Windows, Linux, macOS and even for your TV set-top box this answer is <b>wrong</b>."}, {"owner": {"reputation": 300, "user_id": 8800091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230f0c9c6f2224071a4c4dc45bd1087f?s=128&d=identicon&r=PG&f=1", "display_name": "andi8086", "link": "https://stackoverflow.com/users/8800091/andi8086"}, "reply_to_user": {"reputation": 1275, "user_id": 1835601, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/j6OWh.jpg?s=128&g=1", "display_name": "Simo Erkinheimo", "link": "https://stackoverflow.com/users/1835601/simo-erkinheimo"}, "edited": false, "score": 0, "creation_date": 1515751296, "post_id": 48189856, "comment_id": 83428974, "body": "My answer is as precise as the question was. Is it possible to access DRAM bits? This question is equivalent to &quot;Is it possible to access RAM that is implemented with DRAM&quot; Since the physical implementation of RAM has nothing to do with the program running on the system, my answer is quite valid."}], "tags": [], "owner": {"reputation": 300, "user_id": 8800091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230f0c9c6f2224071a4c4dc45bd1087f?s=128&d=identicon&r=PG&f=1", "display_name": "andi8086", "link": "https://stackoverflow.com/users/8800091/andi8086"}, "is_accepted": false, "score": 0, "last_activity_date": 1515595348, "creation_date": 1515595348, "answer_id": 48189856, "question_id": 48189791, "link": "https://stackoverflow.com/questions/48189791/is-it-possible-to-access-dram-bit-cells-using-c/48189856#48189856", "title": "Is it possible to access DRAM bit cells using C?", "body": "<p>The C programming language can address memory, thus it can access DRAM bit cells. You have to know the address, the according DRAM bit is mapped to and use logic operators to manipulate the corresponding bit on that address.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8808557, "user_type": "registered", "profile_image": "https://graph.facebook.com/1460375444016481/picture?type=large", "display_name": "Jason McCullough", "link": "https://stackoverflow.com/users/8808557/jason-mccullough"}, "edited": false, "score": 1, "creation_date": 1515599808, "post_id": 48190937, "comment_id": 83362887, "body": "Much better answer, and you even provided a paper to help with my research. Thanks VladP"}], "tags": [], "owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "is_accepted": true, "score": 1, "last_activity_date": 1515598521, "creation_date": 1515598521, "answer_id": 48190937, "question_id": 48189791, "link": "https://stackoverflow.com/questions/48189791/is-it-possible-to-access-dram-bit-cells-using-c/48190937#48190937", "title": "Is it possible to access DRAM bit cells using C?", "body": "<p>C does not give any specific means to directly read DRAM for standard hardware platforms: Windows, Linux, etc.\nHowever, this is possible for certain embedded platforms, and heavily depends on the operating system, or kernel, or whatever is at the core of the system.</p>\n\n<p>Embedded systems that are not under OSs with virtual memory, and that have direct memory access, obviously can and do access the memory. </p>\n\n<p>Some of the systems have DMA, which allows Direct Memory Access, as the name said. For DMA, you got to have a code that programs DMA, and instructs it to read or write certain data from certain parts of the remote memory, in this case DRAM. </p>\n\n<p>DRAM may be accessed directly if the hardware architecture supports it, and these days, this is not often the case, since it is considered that the DRAM access may slow the processor. That is why DMAs are used, to offload the main processor of the boring and tedious task of accessing external memory.</p>\n\n<p>For example, see the following description of the code that tests the memory, and the primary thing is that the code can 'see' the DRAM memory directly:\n<a href=\"https://www.akkadia.org/drepper/cpumemory.pdf\" rel=\"nofollow noreferrer\">https://www.akkadia.org/drepper/cpumemory.pdf</a></p>\n\n<p>To learn more about the memory, types of memory, and how to access the memory, please read the excellent article here:\n<a href=\"https://barrgroup.com/Embedded-Systems/How-To/Memory-Test-Suite-C\" rel=\"nofollow noreferrer\">https://barrgroup.com/Embedded-Systems/How-To/Memory-Test-Suite-C</a></p>\n\n<p>I hope that this answers your question, or at least helps you to understand what is involved in accessing DRAM. In a nutshell, OS accesses DRAM on usual systems, unless the system is designed in such a way, that DRAM may be accessed directly through the address.</p>\n"}], "owner": {"reputation": 45, "user_id": 8808557, "user_type": "registered", "profile_image": "https://graph.facebook.com/1460375444016481/picture?type=large", "display_name": "Jason McCullough", "link": "https://stackoverflow.com/users/8808557/jason-mccullough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 48190937, "answer_count": 2, "score": 0, "last_activity_date": 1515598521, "creation_date": 1515595125, "last_edit_date": 1515598407, "question_id": 48189791, "link": "https://stackoverflow.com/questions/48189791/is-it-possible-to-access-dram-bit-cells-using-c", "title": "Is it possible to access DRAM bit cells using C?", "body": "<p>Apologies if this is not the place to be asking this. I would like to know if the C programming language gives the user access to DRAM bit cells, I can't seem to find any resource online that specifically answer my question so I feel more inclined to assume this is not possible. Thanks</p>\n"}, {"tags": ["c", "list", "nodes", "singly-linked-list"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 7, "creation_date": 1515594773, "post_id": 48189625, "comment_id": 83359286, "body": "Did you try searching at all? We have thousands of questions about the basics of linked lists. Plus, if you get a segfault, you should (A) specify exactly when and (B) learn to use a debugger to step through the code, checking variable values, to the point of failure, then get a backtrace from that point and figure out what might be going wrong."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1515594802, "post_id": 48189625, "comment_id": 83359307, "body": "<code>list-&gt;next-&gt;next;</code> can fail if <code>list-&gt;next</code> is the last element of the list."}], "answers": [{"comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1515595138, "post_id": 48189709, "comment_id": 83359565, "body": "1. If a <code>for</code> loop will get the job done, why mention recursion 2. The question is about removing one element from a list, not to free memory from all elements in the list."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1515596258, "post_id": 48189709, "comment_id": 83360337, "body": "@crashmstr.: I got the question wrong. Please check."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1515596567, "last_edit_date": 1515596567, "creation_date": 1515594822, "answer_id": 48189709, "question_id": 48189625, "link": "https://stackoverflow.com/questions/48189625/delete-an-element-from-a-node-list-in-c/48189709#48189709", "title": "Delete an element from a node list in c", "body": "<pre><code>list-&gt;next = list-&gt;next-&gt;next;\n</code></pre>\n\n<p>In your case as you didn't do <code>NULL</code> check - you have dereferrenced NULL leading you to Undefined behavior (In your case segmentation fault). (In case <code>list-&gt;next = NULL</code>).</p>\n\n<p>Also why using the recursion here? Simply a <code>for</code> loop will get the job done.</p>\n\n<p>For example,</p>\n\n<pre><code>Node* remove_list(Node* list, int index) {\n    if(index &lt; 0 ){\n       fprintf(stderr,\"Error in index\\n\");\n       exit(1);\n    }\n    if(!list){\n       fprintf(stderr,\"Empty list\\n\"); \n       return list;\n    }\n    Node *p=list,*st =list;\n    for(int i = 0; i &lt;= index-1 ; i++){\n      if(list) {\n          p = list; \n          list = list-&gt;next;\n      }\n      else{\n          fprintf(stderr,\"Error in index - out of bound access\\n\");\n          exit(1);\n      }\n    }\n    if(index)\n       p-&gt;next = list-&gt;next;\n    else\n       p = list-&gt;next;\n    free(list);\n    return index == 0? p: st; \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9093743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187ef5a0c2d529c005eab0b690c87633?s=128&d=identicon&r=PG&f=1", "display_name": "Nicooost", "link": "https://stackoverflow.com/users/9093743/nicooost"}, "edited": false, "score": 0, "creation_date": 1515599440, "post_id": 48190275, "comment_id": 83362619, "body": "THANK YOU VERY MUCH!!  But why I can&#39;t remove the first element?  If I choose the index as 0, there is an error.."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 17, "user_id": 9093743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187ef5a0c2d529c005eab0b690c87633?s=128&d=identicon&r=PG&f=1", "display_name": "Nicooost", "link": "https://stackoverflow.com/users/9093743/nicooost"}, "edited": false, "score": 0, "creation_date": 1515599974, "post_id": 48190275, "comment_id": 83363010, "body": "@Nicooost This has nothing common with the function implementation I showed. See the error in your own code."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1515600246, "last_edit_date": 1515600246, "creation_date": 1515596608, "answer_id": 48190275, "question_id": 48189625, "link": "https://stackoverflow.com/questions/48189625/delete-an-element-from-a-node-list-in-c/48190275#48190275", "title": "Delete an element from a node list in c", "body": "<p>The function can be defined as it is shown in the demonstrative program.\nPay attention to that the allocated string also should be deleted.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef char * String;\n\nstruct Node \n{\n    String value; // dynamically allocated string, release memory!\n    struct Node *next; // self-reference\n};\n\ntypedef struct Node Node;\n\nNode * remove_list( Node *list, size_t index )\n{\n    Node **current = &amp;list;\n\n    while ( *current &amp;&amp; index ) \n    {\n        current = &amp;( *current )-&gt;next;\n        --index;\n    }\n\n    if ( *current )\n    {\n        Node *tmp = *current;\n        *current = ( *current )-&gt;next;\n\n        free( tmp-&gt;value );\n        free( tmp );\n    }\n\n    return list;\n}\n\nNode * push( Node *list, const char *value )\n{\n    Node *tmp = malloc( sizeof( Node ) );\n\n    tmp-&gt;value = malloc( strlen( value ) + 1 );\n    strcpy( tmp-&gt;value, value );\n\n    tmp-&gt;next = list;\n\n    return tmp;\n}\n\nvoid display( Node *list )\n{\n    for ( ; list; list = list-&gt;next )\n    {\n        printf( \"%s \", list-&gt;value );\n    }\n}\n\nint main(void) \n{\n    Node *list = NULL;\n    char value[] = \"A\";\n\n    for ( size_t i = 0; i &lt; 'Z' - 'A' + 1; i++ )\n    {\n        list = push( list, value );\n        ++value[0];\n    }\n\n\n    display( list );\n    putchar( '\\n' );\n\n    list = remove_list( list, 25 );\n    display( list );\n    putchar( '\\n' );\n\n    list = remove_list( list, 0 );\n    display( list );\n    putchar( '\\n' );\n\n    list = remove_list( list, 10 );\n    display( list );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>Z Y X W V U T S R Q P O N M L K J I H G F E D C B A \nZ Y X W V U T S R Q P O N M L K J I H G F E D C B \nY X W V U T S R Q P O N M L K J I H G F E D C B \nY X W V U T S R Q P N M L K J I H G F E D C B \n</code></pre>\n\n<p>Or here is another demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef char * String;\n\nstruct Node \n{\n    String value; // dynamically allocated string, release memory!\n    struct Node *next; // self-reference\n};\n\ntypedef struct Node Node;\n\nNode * remove_list( Node *list, size_t index )\n{\n    Node **current = &amp;list;\n\n    while ( *current &amp;&amp; index ) \n    {\n        current = &amp;( *current )-&gt;next;\n        --index;\n    }\n\n    if ( *current )\n    {\n        Node *tmp = *current;\n        *current = ( *current )-&gt;next;\n\n        free( tmp-&gt;value );\n        free( tmp );\n    }\n\n    return list;\n}\n\nNode * push( Node *list, const char *value )\n{\n    Node *tmp = malloc( sizeof( Node ) );\n\n    tmp-&gt;value = malloc( strlen( value ) + 1 );\n    strcpy( tmp-&gt;value, value );\n\n    tmp-&gt;next = list;\n\n    return tmp;\n}\n\nvoid display( Node *list )\n{\n    for ( ; list; list = list-&gt;next )\n    {\n        printf( \"%s \", list-&gt;value );\n    }\n}\n\nint main(void) \n{\n    Node *list = NULL;\n    char value[] = \"A\";\n\n    for ( size_t i = 0; i &lt; 'Z' - 'A' + 1; i++ )\n    {\n        list = push( list, value );\n        ++value[0];\n    }\n\n    while ( list )\n    {\n        display( list );\n        putchar( '\\n' );\n        list = remove_list( list, 0 );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>At this time the program output might look like</p>\n\n<pre><code>Z Y X W V U T S R Q P O N M L K J I H G F E D C B A \nY X W V U T S R Q P O N M L K J I H G F E D C B A \nX W V U T S R Q P O N M L K J I H G F E D C B A \nW V U T S R Q P O N M L K J I H G F E D C B A \nV U T S R Q P O N M L K J I H G F E D C B A \nU T S R Q P O N M L K J I H G F E D C B A \nT S R Q P O N M L K J I H G F E D C B A \nS R Q P O N M L K J I H G F E D C B A \nR Q P O N M L K J I H G F E D C B A \nQ P O N M L K J I H G F E D C B A \nP O N M L K J I H G F E D C B A \nO N M L K J I H G F E D C B A \nN M L K J I H G F E D C B A \nM L K J I H G F E D C B A \nL K J I H G F E D C B A \nK J I H G F E D C B A \nJ I H G F E D C B A \nI H G F E D C B A \nH G F E D C B A \nG F E D C B A \nF E D C B A \nE D C B A \nD C B A \nC B A \nB A \nA \n</code></pre>\n\n<p>On the other hand the function interface is not good. It is better when the function reports whether it deleted the given node or did not.</p>\n\n<p>So I myself would declare the function like</p>\n\n<pre><code>int remove_list( Node **list, size_t index );\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9093743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187ef5a0c2d529c005eab0b690c87633?s=128&d=identicon&r=PG&f=1", "display_name": "Nicooost", "link": "https://stackoverflow.com/users/9093743/nicooost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1517060606, "creation_date": 1515594530, "last_edit_date": 1517060606, "question_id": 48189625, "link": "https://stackoverflow.com/questions/48189625/delete-an-element-from-a-node-list-in-c", "title": "Delete an element from a node list in c", "body": "<p>This is my struct:</p>\n\n<pre><code>struct Node {\n    String value; // dynamically allocated string, release memory!\n    struct Node* next; // self-reference\n};\ntypedef struct Node Node;\n</code></pre>\n\n<p>Now I need a function which can remove elements of the list.</p>\n\n<pre><code>Node* remove_list(Node* list, int index) {}\n</code></pre>\n\n<p>I know how it should work. But I have no idea how to put it in a code...</p>\n\n<p>This is an idea of me:</p>\n\n<pre><code>        Node *tmp = list-&gt;next;\n        list-&gt;next = list-&gt;next-&gt;next;\n        free_list (tmp);\n        return list;\n</code></pre>\n\n<p>This code removes the 2nd element of an list, but only when the list is not longer than 2 elements... \nIf there are more than 2 elements the following error is in the terminal:</p>\n\n<pre><code>Segmentation fault: 11\n</code></pre>\n\n<p>The function should remove the element at index <code>i</code>.. </p>\n\n<p>I don't have any idea how to make it.</p>\n"}, {"tags": ["c", "data-structures", "singly-linked-list"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 4, "creation_date": 1515594702, "post_id": 48189612, "comment_id": 83359226, "body": "<i>&quot;the node is not working as I wish&quot;</i> is not a problem description. Why not? Nor is <i>&quot;I am not able to figure it out where am I going wrong&quot;</i> What went wrong? What is right instead? You also should include all code needed to compile and reproduce the problem, not just what fragments you think are relevant. Please check the Help Centre to learn what is needed in a good question and why you should provide an MCVE."}, {"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "edited": false, "score": 0, "creation_date": 1515594840, "post_id": 48189612, "comment_id": 83359345, "body": "yes I am using C and node is not working means when ever I append it to list only last 2 elements are shown"}, {"owner": {"reputation": 2576, "user_id": 501011, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/5876A.png?s=128&g=1", "display_name": "MechMK1", "link": "https://stackoverflow.com/users/501011/mechmk1"}, "edited": false, "score": 1, "creation_date": 1515594962, "post_id": 48189612, "comment_id": 83359432, "body": "I would recommend you to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, with emphasis on <b>complete</b>. That means making a simple example (e.g. adding 1, 2, 3, 4 to the list) and then displaying it."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1515595053, "post_id": 48189612, "comment_id": 83359501, "body": "<code>(*hptr) = (*hptr)-&gt;next;</code> --&gt;&gt; <code>hptr = &amp;(*hptr)-&gt;next;</code> (and you dont need the <code>if ... else...</code>"}, {"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515595227, "post_id": 48189612, "comment_id": 83359628, "body": "@wildplasser would you please explain the logic and why there is  no need of if-else?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515595355, "post_id": 48189612, "comment_id": 83359691, "body": "In both cases (empty list, non-empty list) you change the value of one pointer, a pointer that originally had a NULL value. So the problem reduces to: find the (first) NULL pointer in the chain, and change it to newnode."}, {"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515595436, "post_id": 48189612, "comment_id": 83359752, "body": "@wildplasser hptr = &amp;(*hptr)-&gt;next and what about this? what is difference between what I have written and what you have written?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515595530, "post_id": 48189612, "comment_id": 83359830, "body": "Your version assigns to <code>*hptr</code>, mine to <code>hptr</code>."}, {"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515596636, "post_id": 48189612, "comment_id": 83360605, "body": "@wildplasser what is order of execution of:  hptr = &amp;(*hptr)-&gt;next"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515596817, "post_id": 48189612, "comment_id": 83360702, "body": "The same as for any other assignment : <code>x = y;</code>  <b>,</b> <code>ch= *str;</code>  <b>,</b> <code>p = q-&gt;next;</code> <b>,</b> <code>cp = &amp;buff[3];</code>"}, {"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "edited": false, "score": 0, "creation_date": 1515600531, "post_id": 48189612, "comment_id": 83363397, "body": "I mean what is meaning of &amp;(*hptr)"}, {"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515765229, "post_id": 48189612, "comment_id": 83437040, "body": "@wildplasser my instructor says hptr = &amp;(*hptr)-&gt;next is not according to standards and it might lead to security issues if used at production since it gives you direct access to address of next? what do you think about it?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515849021, "post_id": 48189612, "comment_id": 83462604, "body": "I think it is complete nonsense. &quot;direct access to the adress of next&quot; : you need to change- <code>&gt;next</code>&#39;s value somehow , and this can be done via a pointer. And it <b>should</b> be done via a pointer if that leads to simpler code. See my answer: there are zero conditions in it, except for the loop condition."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515946617, "post_id": 48189612, "comment_id": 83485520, "body": "Well, see  my answer. If  <code>(*hptr == NULL)</code> at the start of the function, the loop will  be executed <b>zero</b> times. That is your <code>if (...) {}</code> part. Otherwise, hptr will be made to point to a -&gt;next pointer. Until that happens to be NULL. That is the end of your list."}], "answers": [{"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 0, "last_activity_date": 1515595962, "creation_date": 1515595962, "answer_id": 48190065, "question_id": 48189612, "link": "https://stackoverflow.com/questions/48189612/what-is-wrong-with-following-linkedlist-code/48190065#48190065", "title": "What is wrong with following LinkedList code?", "body": "<pre><code>void attachEnd(node **hptr, node *newnode)\n{\n        /* There MUST be a NULL pointer somewhere in the chain\n        ** Either at the beginning (an empty list)\n        ** , or at the end\n        */\n    for (       ;*hptr; hptr = &amp;(*hptr)-&gt;next) {;}\n\n        // Once you get here *hptr willbe NULL\n    *hptr = newnode;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "edited": false, "score": 0, "creation_date": 1515640088, "post_id": 48194673, "comment_id": 83379645, "body": "The problem comes in the next call. There are two items in the list now, so you enter the while loop. And the first thing you do is:  (*hptr)-&gt;next = newnode; I did not understand this statement. In while loop I am executing (*hptr) = (*hptr)-&gt;next;"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "reply_to_user": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "edited": false, "score": 1, "creation_date": 1515641308, "post_id": 48194673, "comment_id": 83379911, "body": "@PrathameshSaraf You&#39;re right. I got mixed up when I was writing things. I&#39;ve corrected it. What&#39;s happening is that you&#39;re overwriting <code>head</code>, not <code>head-&gt;next</code>. See my correction."}], "tags": [], "owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "is_accepted": false, "score": 1, "last_activity_date": 1515939096, "last_edit_date": 1515939096, "creation_date": 1515612233, "answer_id": 48194673, "question_id": 48189612, "link": "https://stackoverflow.com/questions/48189612/what-is-wrong-with-following-linkedlist-code/48194673#48194673", "title": "What is wrong with following LinkedList code?", "body": "<p>You're getting mixed up with your indirection. Let's take a look at what happens here. You have this function:</p>\n\n<pre><code>void attachEnd(node **hptr, node *newnode)\n{\n    if (*hptr == NULL)\n    {\n        *hptr = newnode;\n    }\n    else\n    {\n        while ((*hptr)-&gt;next != NULL)\n        {\n            (*hptr) = (*hptr)-&gt;next;\n        }\n\n        (*hptr)-&gt;next = newnode;\n\n    }\n}\n</code></pre>\n\n<p>Now, let's assume that you initialize <code>head</code> to <code>NULL</code>, and try to add a few nodes:</p>\n\n<pre><code>node *head = NULL;\n\nattachEnd(&amp;head, newnode1);\n</code></pre>\n\n<p>Because <code>**hptr == NULL</code> when you enter the function, you assign the value of the new node, and exit. So when you return, the value of <code>head</code> is <code>newnode1</code>.</p>\n\n<p>Next, you add another node:</p>\n\n<pre><code>attachEnd(&amp;head, newnode2);\n</code></pre>\n\n<p>In your <code>attachEnd</code> function, <code>*hptr</code> is not <code>NULL</code>, so you execute the <code>else</code> clause. <code>(*hptr)-&gt;next == NULL</code>, though, so you just assign <code>newnode2</code> to <code>(*hptr)-&gt;next</code>. All good.</p>\n\n<p>The problem comes in the next call. There are two items in the list now, so you enter the <code>while</code> loop. And the first thing you do is:</p>\n\n<pre><code>(*hptr) = (*hptr)-&gt;next;\n</code></pre>\n\n<p>Remember, since you called <code>attachEnd</code> with a pointer to <code>head</code> (which is itself a pointer), what you've done is equivalent to</p>\n\n<pre><code>head = head-&gt;next;\n</code></pre>\n\n<p>And you've lost the previous value of <code>head</code>.</p>\n\n<p>You need an intermediate variable to keep track of things so that you don't overwrite <code>head</code>:</p>\n\n<pre><code>void attachEnd(node **hptr, node *newnode)\n{\n    if (*hptr == NULL)\n    {\n        *hptr = newnode;\n        return;\n    }\n    node *ptr = *hptr;\n    while (ptr-&gt;next != NULL)\n    {\n        ptr = ptr-&gt;next;\n    }\n    ptr-&gt;next = newnode;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7420713, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A43kNhuDyRM/AAAAAAAAAAI/AAAAAAAAAGE/g4fZ5o0hyBw/photo.jpg?sz=128", "display_name": "Prathamesh Saraf", "link": "https://stackoverflow.com/users/7420713/prathamesh-saraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1515939096, "creation_date": 1515594487, "last_edit_date": 1515594747, "question_id": 48189612, "link": "https://stackoverflow.com/questions/48189612/what-is-wrong-with-following-linkedlist-code", "title": "What is wrong with following LinkedList code?", "body": "<p>I am trying to attach a node at the end of linked list but the node is not working as I wish there are no errors but I am not able to figure it out where am I going wrong please help.</p>\n\n<pre><code>void attachEnd(node **hptr, node *newnode)\n{\n    if (*hptr == NULL)\n    {\n        *hptr = newnode;\n    }\n    else\n    {\n        while ((*hptr)-&gt;next != NULL)\n        {\n            (*hptr) = (*hptr)-&gt;next;\n        }\n\n        (*hptr)-&gt;next = newnode;\n\n    }\n}\n</code></pre>\n\n<p>In main:</p>\n\n<pre><code>attachEnd(&amp;head, newnode);\n</code></pre>\n\n<p>Assume that newnode is already created and initialized</p>\n"}, {"tags": ["c", "pointers", "virtual-address-space"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1515593582, "post_id": 48189240, "comment_id": 83358421, "body": "Intentions are clear but this question is a bit terse as you would&#39;ve guessed."}, {"owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515593846, "post_id": 48189240, "comment_id": 83358620, "body": "I&#39;m  referring to this pdf: <a href=\"https://spectreattack.com/spectre.pdf\" rel=\"nofollow noreferrer\">spectreattack.com/spectre.pdf</a>"}, {"owner": {"reputation": 3631, "user_id": 1094101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afb6bd332cc5182d7c6c75c88123cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Non-maskable Interrupt", "link": "https://stackoverflow.com/users/1094101/non-maskable-interrupt"}, "edited": false, "score": 0, "creation_date": 1515597456, "post_id": 48189240, "comment_id": 83361151, "body": "FYI spectre does not access via physical address. That&#39;s why the patch do KPTI."}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515596381, "post_id": 48190050, "comment_id": 83360421, "body": "But then what does the example code expect from this line? <code>code</code> sscanf(argv[1], &quot;%p&quot;, (void**)(&amp;malicious_x)); malicious_x -= (size_t)array1; Is it simply designed to read its own allocated memory?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515596434, "post_id": 48190050, "comment_id": 83360464, "body": "And what is that supposed to demonstrate, @user3866319?"}, {"owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515596615, "post_id": 48190050, "comment_id": 83360591, "body": "What do you mean by demonstrate?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515596792, "post_id": 48190050, "comment_id": 83360690, "body": "@user3866319, when I first responded to your comment, it was just a line of code.  Now that you have put a question around the code, the answer is that I don&#39;t expect anything in particular from it, because it appears likely to have undefined behavior.  I&#39;d need more context to be sure."}, {"owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515596974, "post_id": 48190050, "comment_id": 83360804, "body": "The default behavior of the example is to read a predefined string. But if you add argv&#39;s (address) (length) it will read from there. Which is where my understanding of memory address space broke down in the first place."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515597380, "post_id": 48190050, "comment_id": 83361093, "body": "@user3866319, your code reads text input from the string designated by <code>argv[1]</code> and attempts to convert it to a pointer value, to be stored in variable <code>malicious_x</code>.  It then performs a pointer difference operation and updates <code>malicious_x</code> with the result.  Upon reflection, this code&#39;s behavior is undefined for one clear reason (the stored value of <code>malicious_x</code> is accessed via a pointer to a different object type).  Its behavior is likely undefined (as far as C is concerned) for at least two other, independent reasons, as well."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515597620, "post_id": 48190050, "comment_id": 83361269, "body": "@user3866319, more generally, pointer arithmetic produces defined results only when it does not cross object boundaries (roughly speaking).  Moreover, on a typical C implementation on a virtual memory system, pointer values correspond to <i>virtual</i> addresses anyway, not physical ones, so I&#39;m failing to see the relevance."}, {"owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515597708, "post_id": 48190050, "comment_id": 83361330, "body": "The code works fine if you enter a pointer value within the process memory. what i didn&#39;t understand at first was how a pointer to another process would be formatted. But if I understand correctly you&#39;re saying that that&#39;s impossible?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515597919, "post_id": 48190050, "comment_id": 83361486, "body": "@user3866319, &quot;works fine&quot; is not at all the same thing as &quot;has defined behavior&quot;.  And using a <code>%p</code> with <code>scanf</code> to convert a pointer value that was not produced by the same process <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p12\" rel=\"nofollow noreferrer\">explicitly has undefined behavior</a>.  But in any case, on a virtual memory system, all addresses in a process refer to that process&#39;s <i>own</i> virtual memory space."}, {"owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "edited": false, "score": 0, "creation_date": 1515598549, "post_id": 48190050, "comment_id": 83361937, "body": "That&#39;s basically what I was trying to say. A value in the process&#39;s memory will produce the correct result in regards to the example. But as you say, a value from another process is undefined."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1515595936, "creation_date": 1515595936, "answer_id": 48190050, "question_id": 48189240, "link": "https://stackoverflow.com/questions/48189240/how-does-virtual-physical-addresses-work-in-regards-to-the-spectre-example/48190050#48190050", "title": "How does virtual/physical addresses work in regards to the Spectre example?", "body": "<blockquote>\n  <p>How would you in C code calculate the physical address of a pointer?</p>\n</blockquote>\n\n<p>I take you to be asking about calculating the physical address <em>represented</em> by a pointer value, as opposed to the physical address at which the pointer value is <em>stored</em>.  The latter just boils down to the former anyway.</p>\n\n<p>But as far as the C language itself is concerned, you <strong>don't</strong> do this.  C does not recognize the distinction between physical and virtual memory in the first place, nor does it have any need to do so.  That distinction is an OS-level concern with hardware support. Thus, any technique that accomplishes what you describe relies on details of the C implementation and execution environment.</p>\n\n<p>That Spectre manages to break the process isolation provided (in part) by virtual memory is probably the most frightening thing about it.</p>\n"}], "owner": {"reputation": 387, "user_id": 3866319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/afc29a055ef15d403d1c5a5255cab3d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dacobi", "link": "https://stackoverflow.com/users/3866319/dacobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 48190050, "answer_count": 1, "score": 1, "last_activity_date": 1515595936, "creation_date": 1515593306, "last_edit_date": 1515593926, "question_id": 48189240, "link": "https://stackoverflow.com/questions/48189240/how-does-virtual-physical-addresses-work-in-regards-to-the-spectre-example", "title": "How does virtual/physical addresses work in regards to the Spectre example?", "body": "<p>I haven't been programming in a couple of years but with all the fuss about Meltdown and Spectre I've install VS2017 and compiled the Spectre example from this pdf: <a href=\"https://spectreattack.com/spectre.pdf\" rel=\"nofollow noreferrer\">https://spectreattack.com/spectre.pdf</a></p>\n\n<p>However I have no idea how the addresses that the Spectre example takes on the command line works?</p>\n\n<p>I modified the code to output the pointer address of the secret string and compiled with cl in the Native Tools Shell and it outputs something like:</p>\n\n<pre><code>00007FF6CF2210F0\n</code></pre>\n\n<p>Entering this address on the command line to the example it outputs the secret string correctly.</p>\n\n<p>But if I make a simple program with a similar string and output that address \nand then feed it to the Spectre example, in another shell, I don't get the correct string.</p>\n\n<p>I've been reading about virtual vs physical addresses and pages and offsets, but I'm quite lost.</p>\n\n<p>So the question is:</p>\n\n<p>How would you in C code calculate the physical address of a pointer?</p>\n"}, {"tags": ["c", "linux", "assembly", "nasm", "libc"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1515595330, "post_id": 48189051, "comment_id": 83359683, "body": "Also see <a href=\"https://stackoverflow.com/q/36223182/608639\">Access .data section in Position Independent Code (PIC)</a> and <a href=\"https://www.csee.umbc.edu/~chang/cs313.f04/nasmdoc/html/nasmdoc8.html#section-8.2\" rel=\"nofollow noreferrer\">Writing NetBSD/FreeBSD/OpenBSD and Linux/ELF Shared Libraries</a> in the NASM manual."}], "answers": [{"comments": [{"owner": {"reputation": 1661, "user_id": 3053430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2b15dabd1d682746b6a41846cc5c3723?s=128&d=identicon&r=PG", "display_name": "Ethan McTague", "link": "https://stackoverflow.com/users/3053430/ethan-mctague"}, "edited": false, "score": 0, "creation_date": 1515602720, "post_id": 48191927, "comment_id": 83364863, "body": "Excellent, it works! Might I ask where you learned this? I&#39;ve been struggling to find a good guide for 64-bit NASM with libc."}], "tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 4, "last_activity_date": 1515601640, "creation_date": 1515601640, "answer_id": 48191927, "question_id": 48189051, "link": "https://stackoverflow.com/questions/48189051/relocation-r-x86-64-32s-against-data-cannot-be-used-when-making-a-shared-object/48191927#48191927", "title": "Relocation R_X86_64_32S against .data cannot be used when making a shared object (64 bit NASM + gcc)", "body": "<p><code>rbp</code> is a callee-saved register hence you need to preserve it. You are not changing it so you don't have to <code>push</code>/<code>pop</code> it here. However you need to preserve 16 byte stack alignment, and a <code>push</code> is a simple way to do that. You could have used any other register, or even <code>sub rsp, 8</code>.</p>\n\n<p><code>mov rdi, hi</code> should be <code>lea rdi, [rel hi]</code>.</p>\n\n<p>Functions are called through the PLT not the GOT, and not through a pointer. Just do <code>call puts ..wrt plt</code>.</p>\n\n<p>As such, the following should work:</p>\n\n<pre><code>global main\nextern puts\n\nsection .data\n  hi db 'hello', 0\n\nsection .text\nmain:\n  push rbp\n  lea rdi, [rel hi]\n  call puts wrt ..plt\n  pop rbp\n  ret\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 3053430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2b15dabd1d682746b6a41846cc5c3723?s=128&d=identicon&r=PG", "display_name": "Ethan McTague", "link": "https://stackoverflow.com/users/3053430/ethan-mctague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1901, "favorite_count": 0, "accepted_answer_id": 48191927, "answer_count": 1, "score": 1, "last_activity_date": 1515601640, "creation_date": 1515592632, "last_edit_date": 1515594847, "question_id": 48189051, "link": "https://stackoverflow.com/questions/48189051/relocation-r-x86-64-32s-against-data-cannot-be-used-when-making-a-shared-object", "title": "Relocation R_X86_64_32S against .data cannot be used when making a shared object (64 bit NASM + gcc)", "body": "<p>I'm trying to make a program with NASM and GCC:</p>\n\n<pre><code>global main\nextern puts\n\nsection .data\n  hi db 'hello', 0\n\nsection .text\nmain:\n  push hi\n  call puts\n  ret\n</code></pre>\n\n<p>I am building with:</p>\n\n<pre><code>nasm -f elf64 main.asm\ngcc main.o -o main\nrm main.o\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>/usr/bin/ld: main.o: relocation R_X86_64_32S against `.data' can not be used when making a shared object; recompile with -fPIC\n/usr/bin/ld: final link failed: Nonrepresentable section on output\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I have a feeling I'm doing a few things wrong, judging by the presence of weird stack operations in examples like <a href=\"https://stackoverflow.com/questions/33476098/gcc-assemby-error-relocation-r-x86-64-32s-against-data\">this</a> and <a href=\"https://www.csee.umbc.edu/portal/help/nasm/sample_64.shtml#fib_64m.asm\" rel=\"nofollow noreferrer\">this</a>. I can't find any documentation that actually <em>explains</em> this, for some reason, though (In fact, I can hardly find any useful documentation for 64-bit development with NASM in general, which has made everything I've made so far a real pain in the ass to make), and adding in things like that don't have any effect on my error output.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I've been looking at <a href=\"http://www.nasm.us/doc/nasmdo11.html\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://stackoverflow.com/questions/48071280/nasm-symbol-printf-causes-overflow-in-r-x86-64-pc32-relocation\">this</a>.</p>\n\n<p>If I change my main to:</p>\n\n<pre><code>  push rbp\n  mov rax,0\n  mov rdi, hi\n  call [puts wrt ..got]\n  pop rbp\n  mov rax,0\n\n  ret\n</code></pre>\n\n<p>It compiles fine, but then gives me a segfault when running instead of actually printing. I also don't understand why I'm pushing and pulling the value of <code>rbp</code> from the stack, and why <code>rax</code>'s value matters in this case.</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1515592118, "post_id": 48188861, "comment_id": 83357485, "body": "Probably interesting read: <a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">wiki.c2.com/?ThreeStarProgrammer</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1515592220, "post_id": 48188861, "comment_id": 83357555, "body": "If you get a crash, then use a <i>debugger</i> to catch it and locate where it happens. Also use tools such as Valgrind to help you find problems with out-of-bounds writing and other memory-/pointer-related errors."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515592301, "post_id": 48188861, "comment_id": 83357608, "body": "As a side-note, don&#39;t do <code>int*** a = ...</code> and pass <code>a</code> straight of. Use e.g. <code>int** a</code> and use <code>&amp;a</code> to pass a pointer to <code>a</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9198794"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515592840, "post_id": 48188861, "comment_id": 83358013, "body": "@Someprogrammerdude Thank you for your tip, but it&#39;s still not fixed."}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 1, "creation_date": 1515593176, "post_id": 48188861, "comment_id": 83358212, "body": "It sounds like you believe you get a segmentation fault from not freeing all memory. But this is usually not the case, what you get are memory leaks, but the code should still run. Only when your process has no more available memory, and you don&#39;t check the return value of <code>malloc</code>, could a segmentation fault be caused from a memory leak. Nevertheless, you should still tell us which line causes the segmentation fault."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515593634, "post_id": 48188861, "comment_id": 83358468, "body": "Adding a column to <code>a</code> does not add a row to <code>b</code>. After adding the column the value of <code>size2</code> is incremented and used to free the rows of <code>b</code>. This tries to free one more row than what is available"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1515594882, "post_id": 48188861, "comment_id": 83359371, "body": "<i>&#39;i get error of &quot;segmentation fault&quot;&#39;</i> When? And have you tried using a debugger to trace back from that mysterious point?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515595504, "post_id": 48188861, "comment_id": 83359807, "body": "the root of the problem is the first call to malloc in BuildMatrix(), that allocates room for the pointers to the rows of data. Each of those pointers will contain trash until initialized. So either 1) use calloc() for the first call or 2) use memset() to initialize everything to &#39;\\0&#39; after the first call. When an error occurs in the call to malloc() and the code is trying to cleanup, the free() function is currently being passed trash for any/all uninitialized entries. By using calloc() or memset(), any uninitialized entries will contain NULL. Passing NULL to free() is not a problem"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515596746, "post_id": 48188861, "comment_id": 83360656, "body": "@user3629249 All pointers to the rows are initialized using <code>malloc</code>. If it fails, the previous rows are freed and with <code>*matrix=NULL</code> the matrix is cleared as well. I can&#39;t see how you get uninitialized pointers during building the matrix."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515597944, "post_id": 48188861, "comment_id": 83361505, "body": "@Gerhardh,  NOT true.  When some call to <code>malloc()</code> fails, the code returns from the current function, It does not cleanup, it does not exit."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515598325, "post_id": 48188861, "comment_id": 83361788, "body": "@user3629249 The loop after <code>if ((*matrix)[i] == NULL) {</code> does exactly that cleanup."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515598726, "post_id": 48188861, "comment_id": 83362075, "body": "In addition to the problem with changing <code>size2</code>, in <code>AddColumn()</code> the call to <code>realloc</code> could return <code>NULL</code>, invalidating your pointer in the array."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1515601664, "post_id": 48188861, "comment_id": 83364178, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/48188861/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1515601750, "post_id": 48188861, "comment_id": 83364234, "body": "Three-star programming is usually a danger sign..."}], "answers": [{"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1515595445, "last_edit_date": 1515595445, "creation_date": 1515594330, "answer_id": 48189563, "question_id": 48188861, "link": "https://stackoverflow.com/questions/48188861/how-can-i-free-all-what-i-allocated-in-this-code-why-its-case-of-segmentation/48189563#48189563", "title": "How can i free all what i allocated in this code? why it&#39;s case of segmentation fault?", "body": "<p>The problem is occurring because you are changing the value of variable <code>size2</code> after creating matrix <code>b</code> with the initial value of <code>size2</code> as number of rows.</p>\n\n<pre><code>int size1 = 2, size2 = 3, size3 = 2;\n</code></pre>\n\n<p>then you are doing:</p>\n\n<pre><code>BuildMatrix(b, size2, size3);\n</code></pre>\n\n<p>This will create matrix <code>b</code> of dimension - <code>3</code>x<code>2</code>.\nAfter this you are doing:</p>\n\n<pre><code>AddColumn(a, size1, &amp;size2, newCol, size1);\n</code></pre>\n\n<p>In <code>AddColumn()</code> you are changing the value of <code>size2</code> variable:</p>\n\n<pre><code>void AddColumn(int*** matrix, int row, int* column, int* newCol, int rows) {\n</code></pre>\n\n<p>Pointer <code>column</code> hold the address of <code>size2</code> and in <code>AddColumn()</code> the value of <code>size2</code> is incremented by <code>1</code>:</p>\n\n<pre><code>(*column)++;\n</code></pre>\n\n<p>Now the value of <code>size2</code> is <code>4</code>.</p>\n\n<p>And when freeing matrix <code>b</code>, you are passing the new value of <code>size2</code> (which is <code>4</code>) to <code>FreeMatrix()</code>:</p>\n\n<pre><code>FreeMatrix(b, size2);\n</code></pre>\n\n<p>In the <code>FreeMatrix()</code>, the <code>for</code> loop iterate for <code>4</code> times but the matrix <code>b</code> is having <code>3</code> rows:</p>\n\n<pre><code>for (int i = 0; i &lt; row; i++) {\n    free((*matrix)[i]);\n}\n</code></pre>\n\n<p>In the fourth iteration, some invalid value passed as pointer to <code>free()</code>. This is undefined behavior, in your case you are getting segmentation fault.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1515595667, "creation_date": 1515595667, "answer_id": 48189951, "question_id": 48188861, "link": "https://stackoverflow.com/questions/48188861/how-can-i-free-all-what-i-allocated-in-this-code-why-its-case-of-segmentation/48189951#48189951", "title": "How can i free all what i allocated in this code? why it&#39;s case of segmentation fault?", "body": "<p>regarding: <em>i get error of \"segmentation fault\" and I don't understand what i don't freed here?</em></p>\n\n<p>Not freeing some allocated memory will NOT cause a seg fault event.</p>\n\n<p>Trying to free some area that was not allocated WILL cause a seg fault event.</p>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 8182823, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-6Wl_m8HSpjY/AAAAAAAAAAI/AAAAAAAAAEM/RQdHIO7x2ew/photo.jpg?sz=128", "display_name": "QuesterDesura", "link": "https://stackoverflow.com/users/8182823/questerdesura"}, "is_accepted": false, "score": 0, "last_activity_date": 1515600875, "creation_date": 1515600875, "answer_id": 48191701, "question_id": 48188861, "link": "https://stackoverflow.com/questions/48188861/how-can-i-free-all-what-i-allocated-in-this-code-why-its-case-of-segmentation/48191701#48191701", "title": "How can i free all what i allocated in this code? why it&#39;s case of segmentation fault?", "body": "<p>Segmentation Fault means that your program did something that caused it to crash, like trying to access protected memory. When you don't free everything your program won't crash and you will only see, that you didn't freed everything by running a analyzer like valgrind over it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9198794"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 48189563, "answer_count": 3, "score": 0, "last_activity_date": 1515600875, "creation_date": 1515592038, "last_edit_date": 1515600454, "question_id": 48188861, "link": "https://stackoverflow.com/questions/48188861/how-can-i-free-all-what-i-allocated-in-this-code-why-its-case-of-segmentation", "title": "How can i free all what i allocated in this code? why it&#39;s case of segmentation fault?", "body": "<p>someone can explain me how can i free all what i allocated in this code?<br>\ni get error of \"segmentation fault\" and I don't understand what i don't freed here?  </p>\n\n<pre><code>void FreeMatrix(int*** matrix, int row) {\n    for (int i = 0; i &lt; row; i++) {\n        free((*matrix)[i]);\n    }\n    free(*matrix);\n}\n\n\nint main() {\n    AddColumn(a, size1, &amp;size2, newCol, size1);\n    PrintMatrix(*a, size1, size2);\n}  \n</code></pre>\n\n<p>Thank you for your help.<br>\nI jus ask for how to free all of what i allocated, the code is working. I tried a lot of things for fix this problem and i don't know how to do it, so i will be very happy for help from one of you.</p>\n"}, {"tags": ["c", "embedded", "stm32", "stm32f4discovery", "mpu6050"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515593006, "post_id": 48188777, "comment_id": 83358115, "body": "Are you aware of <code>atan2()</code>?"}, {"owner": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515593685, "post_id": 48188777, "comment_id": 83358497, "body": "Accelerometer is measuring the angle correctly (90 to -90) but Gyroscope isn&#39;t. Gyroscope measure in rad/sec so only one integration should be enough I think. But I think my implementation is somewhere missing something.  ~Thanks."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515607439, "post_id": 48188777, "comment_id": 83367536, "body": "@Yunnosch - Is this: <i><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_atan2.htm\" rel=\"nofollow noreferrer\">atan2()</a></i> link good enough, or is there a POSIX version you would prefer to reference."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "edited": false, "score": 0, "creation_date": 1515605576, "post_id": 48191750, "comment_id": 83366518, "body": "I will do the following then: 1)Take frequency 50Hz. 2)Calculate Gx_Correction every time the code is refreshed.  But is my integration implementation correct?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "edited": false, "score": 0, "creation_date": 1515606106, "post_id": 48191750, "comment_id": 83366803, "body": "Yes the integration is a simple cumulative sum."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 4, "last_activity_date": 1515606563, "last_edit_date": 1515606563, "creation_date": 1515601039, "answer_id": 48191750, "question_id": 48188777, "link": "https://stackoverflow.com/questions/48188777/mpu6050-gyroscope-tilt-angle-measurement-for-self-balancing-robot/48191750#48191750", "title": "MPU6050 - Gyroscope tilt angle measurement for self balancing robot?", "body": "<p>10Hz sampling seems far too low, and you are in any case doing unnecessary work on each sample.  Apply the raw bias offset and integrate the raw value - the conversion to degrees/sec if needed can be done at presentation, and teh intermediat conversion to radians/sec serves no purpose.</p>\n\n<p>The robot does not care about or even understand units you don't need any conversion; just sign and magnitude - the sensitivity can be dealt with by your closed-loop controller coefficients.  </p>\n\n<p>How is <code>Gx_Correction</code> determined - it will vary over time with thermal drift; if it is incorrect or not tracked in some way, your integrator will magnify the error.</p>\n\n<p>Note that higher sample rates over the SPI may not be possible - that is what the on-chip DPM is for.</p>\n\n<p>Another possible source of error is the use of <code>float</code>.  The STM32F4 has a single precision FPU, so the operation will be done in hardware - however if you are using floating point in interrupt or thread contexts be-aware that the floating point registers are unlikely to be preserved between contexts unless you have explicitly implemented it, so for example a floating point operation will be corrupted if interrupted by an interrupt that performs floating point operations.</p>\n\n<p>If the integrator only has to work the raw data values, the floating point is unnecessary:</p>\n\n<pre><code>Gx_Theta += GYRO_PLAY.Gyroscope_X - Gx_Zero_Bias;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "is_accepted": false, "score": 0, "last_activity_date": 1515675317, "creation_date": 1515675317, "answer_id": 48207616, "question_id": 48188777, "link": "https://stackoverflow.com/questions/48188777/mpu6050-gyroscope-tilt-angle-measurement-for-self-balancing-robot/48207616#48207616", "title": "MPU6050 - Gyroscope tilt angle measurement for self balancing robot?", "body": "<p>Have to integrate Gy instead of Gx.\nAlso, the angle measured by gyroscope is in deg/s so no need to multiply with <code>degrees</code>.\nFrequency of integration also needs to be 50Hz.</p>\n"}], "owner": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1515675317, "creation_date": 1515591755, "question_id": 48188777, "link": "https://stackoverflow.com/questions/48188777/mpu6050-gyroscope-tilt-angle-measurement-for-self-balancing-robot", "title": "MPU6050 - Gyroscope tilt angle measurement for self balancing robot?", "body": "<p>I have calculated the tilt angle of accelerometer by following formula:</p>\n\n<pre><code>Angle_Accel = atan(Ax/sqrt(Ay*Ay+Az*Az))*(180/PI)\n</code></pre>\n\n<p>I want to calculate the tilt angle from gyroscope now and I am using Gx co-ordinate to integrate as follows but my result is not correct.</p>\n\n<p><strong><em>Psuedo Code</em></strong></p>\n\n<ul>\n<li>Measure Gx every 0.1 seconds.</li>\n<li>After sensitivity factor and bias correction, I multiply with 180/PI to convert into degress.</li>\n<li>Then I divide by frequency i.e 10 and add it to final angle.</li>\n</ul>\n\n<p><strong>C Code</strong></p>\n\n<pre><code>Gx = (((float)GYRO_PLAY.Gyroscope_X  )* GYRO_PLAY.Gyro_Mult)-Gx_Correction;\n\nGy = (((float)GYRO_PLAY.Gyroscope_Y  )*  GYRO_PLAY.Gyro_Mult)-Gy_Correction;\n\nGz = (((float)GYRO_PLAY.Gyroscope_Z  )* GYRO_PLAY.Gyro_Mult)-Gz_Correction;\n\nGx_temp = (Gx*degrees)/10.0; //degrees = 180/PI\n\nGx_Theta = Gx_Theta + Gx_temp;\n</code></pre>\n\n<p>My angle is not correct. How should I integrate?\nAny help is much appreciated.</p>\n\n<p>PS: I know that there is a question like that <a href=\"https://stackoverflow.com/questions/31278784/integrate-readings-from-a-3-axis-gyroscope\" title=\"here\">here</a> but it does not answer my problem so kindly help me.</p>\n"}, {"tags": ["c", "linux", "enums", "linux-kernel"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1515595981, "post_id": 48188776, "comment_id": 83360136, "body": "Self documenting code.    I&#39;ve been writing C, since the K&amp;R first edition was a new book.  Even then, the first entry in an <code>enum</code>, if not specifically set to some other value, was always 0"}], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 1392340, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/2a3U9.jpg?s=128&g=1", "display_name": "Lazureus", "link": "https://stackoverflow.com/users/1392340/lazureus"}, "edited": false, "score": 0, "creation_date": 1515610690, "post_id": 48190995, "comment_id": 83369283, "body": "thanks for the answer, it really make sense for the enum at chromeos_laptop.c:56, although I&#39;m used to mark enums vulnerable to moving, adding and removing with explicit comment. However I&#39;m wondering what you will say about enum at chromeos_laptop.c:64, which as far as I&#39;ve checked is not index of any array."}, {"owner": {"reputation": 422, "user_id": 1392340, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/2a3U9.jpg?s=128&g=1", "display_name": "Lazureus", "link": "https://stackoverflow.com/users/1392340/lazureus"}, "edited": false, "score": 0, "creation_date": 1515616677, "post_id": 48190995, "comment_id": 83372283, "body": "thank you very much for addition, I&#39;d never think that this could be a reason. If you have more knowledge about this black magic, please post it."}, {"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "reply_to_user": {"reputation": 422, "user_id": 1392340, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/2a3U9.jpg?s=128&g=1", "display_name": "Lazureus", "link": "https://stackoverflow.com/users/1392340/lazureus"}, "edited": false, "score": 0, "creation_date": 1515625829, "post_id": 48190995, "comment_id": 83376238, "body": "Black magic? Absolutely not. I&#39;d call it best practices, shaped by experience over literally millions of man hours. That means <b>hard work</b>, no magic involved. Want to learn more? You could start <a href=\"http://www.catb.org/esr/faqs/hacker-howto.html\" rel=\"nofollow noreferrer\">here</a>, as well as at <a href=\"https://duckduckgo.com/?q=programming+blog\" rel=\"nofollow noreferrer\">dozens of other places</a>, then continue reading, coding and gaining experience. And have a good time!"}, {"owner": {"reputation": 422, "user_id": 1392340, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/2a3U9.jpg?s=128&g=1", "display_name": "Lazureus", "link": "https://stackoverflow.com/users/1392340/lazureus"}, "edited": false, "score": 0, "creation_date": 1515957683, "post_id": 48190995, "comment_id": 83489075, "body": "Thank Murphy one more time for the advice and take care"}], "tags": [], "owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "is_accepted": true, "score": 7, "last_activity_date": 1515612380, "last_edit_date": 1515612380, "creation_date": 1515598699, "answer_id": 48190995, "question_id": 48188776, "link": "https://stackoverflow.com/questions/48188776/why-sometimes-first-members-of-enums-in-linux-kernel-are-initialized-with-0/48190995#48190995", "title": "Why sometimes first members of enums in linux kernel are initialized with 0", "body": "<p>While this is not a syntactic necessity, usually the zero is inserted by the programmer to make the semantics of the enum members clear to the reader. A reason could be that the enums are used as index to an array, or as ID for some external resource. It is a hint that changing the enum (removing, adding, reordering) may have repercussions, though an additional comment is a good idea. Which is there in this case, in line 55 where it belongs:</p>\n\n<pre><code>/* Keep this enum consistent with i2c_adapter_names */\n</code></pre>\n\n<p>This pattern could be extended to explicitely providing the values for each member, e. g. if it may happen that entries are removed when they become obsolete and you want to keep the gap or the absolute values for some reason:</p>\n\n<pre><code>static const char *i2c_adapter_names[] = {\n    \"SMBus I801 adapter\",\n    \"i915 gmbus vga\",\n    \"&lt;unsupported&gt;\",\n    \"Synopsys DesignWare I2C adapter\",\n    \"Synopsys DesignWare I2C adapter\",\n};\n\nenum i2c_adapter_type {\n    I2C_ADAPTER_SMBUS = 0,\n    I2C_ADAPTER_VGADDC = 1,\n    /*I2C_ADAPTER_PANEL = 2,*/\n    I2C_ADAPTER_DESIGNWARE_0 = 3,\n    I2C_ADAPTER_DESIGNWARE_1 = 4,\n};\n</code></pre>\n\n<h2>Addition</h2>\n\n<p>As for <code>UNPROBED</code> and its siblings in <code>i2c_peripheral_state</code>, this has also a special meaning: That enum is used in the struct <code>i2c_peripheral</code>, and 0 is the default value when you use <code>memset(\u2026, 0, sizeof(\u2026))</code> (I'm not a fan of it due to possible side effects) or an initializer list (should be preferred) to initialize the struct. So the state <code>UNPROBED</code> is the default when no other value is explicitely assigned, as can be seen in a couple of places where instances of this struct are assigned, e. g. <a href=\"https://github.com/torvalds/linux/blob/master/drivers/platform/chrome/chromeos_laptop.c#L429\" rel=\"nofollow noreferrer\">line 429</a>.</p>\n\n<p>And a protip as bonus: It's much easier to follow the usage of identifiers with the <a href=\"http://elixir.free-electrons.com/linux/latest/ident/i2c_peripheral_state\" rel=\"nofollow noreferrer\">Linux cross reference</a>.</p>\n"}], "owner": {"reputation": 422, "user_id": 1392340, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/2a3U9.jpg?s=128&g=1", "display_name": "Lazureus", "link": "https://stackoverflow.com/users/1392340/lazureus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 48190995, "answer_count": 1, "score": 2, "last_activity_date": 1515612380, "creation_date": 1515591748, "question_id": 48188776, "link": "https://stackoverflow.com/questions/48188776/why-sometimes-first-members-of-enums-in-linux-kernel-are-initialized-with-0", "title": "Why sometimes first members of enums in linux kernel are initialized with 0", "body": "<p>I've noticed in linux kernel source code, that some enums definition have first member of enum explicitly initialized with 0 as follows: </p>\n\n<pre><code>enum i2c_adapter_type {\n    I2C_ADAPTER_SMBUS = 0,\n    I2C_ADAPTER_VGADDC,\n    I2C_ADAPTER_PANEL,\n    I2C_ADAPTER_DESIGNWARE_0,\n    I2C_ADAPTER_DESIGNWARE_1,\n};\n</code></pre>\n\n<p>Code snippet available here at chromeos_laptop.c:56</p>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/drivers/platform/chrome/chromeos_laptop.c\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/drivers/platform/chrome/chromeos_laptop.c</a> </p>\n\n<p>Can someone explain me, what is the purpose of doing such a construct ? I know that first enum member is guaranteed to be 0 by later C standards (ANSI, C99 and so on), so why people are doing this ? </p>\n"}, {"tags": ["c", "struct", "conways-game-of-life"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1515591748, "post_id": 48188732, "comment_id": 83357244, "body": "Please provide more information. Describe your thoughts. Show the different results. Show the &quot;few extra lines&quot;. Try for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. As it is, your question is unclear."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1515591869, "post_id": 48188732, "comment_id": 83357322, "body": "Perhaps you need to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>?"}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515592187, "post_id": 48188732, "comment_id": 83357535, "body": "I understand that my question is unspecific. I&#39;ve tried and tried to debug it and there is virtually nothing I can find. I wouldn&#39;t be here otherwise. I have read one of these btw. But ANY feedback would be helpful. @Yunnosch"}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515592266, "post_id": 48188732, "comment_id": 83357579, "body": "@Yunnosch Furthermore, I don&#39;t know how to reduce the program into a minimal setting since I don&#39;t know what causing the problem in the first place."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1515592365, "post_id": 48188732, "comment_id": 83357660, "body": "In addition to my alltime favorite, linked by Some programmer dude,   this might help to get you started. <a href=\"https://stackoverflow.com/questions/2069367/how-to-debug-using-gdb\" title=\"how to debug using gdb\">stackoverflow.com/questions/2069367/how-to-debug-using-gdb</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515592867, "post_id": 48188732, "comment_id": 83358036, "body": "Does <code>if(field[rowCell - rl][colCell - cl].state == ALIVE) {</code> only access <code>field[][]</code> in bounds?  I&#39;d expect border issues requiring more code.  On review, I am sure this accessing outside array bounds."}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515593081, "post_id": 48188732, "comment_id": 83358158, "body": "No it doesn&#39;t, and I&#39;m aware of it. But the program works in this case (With the first defined struct above). @chux By works I mean perfectly behaves as it should be."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515598561, "post_id": 48188732, "comment_id": 83361952, "body": "since both sets of posted code seem to work (although the end result is different) the question I ask, is what exactly are you considering to be &#39;not working&#39;?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1515598606, "post_id": 48188732, "comment_id": 83361985, "body": "The &#39;game of life&#39; doesn&#39;t normally scroll the screen nor require the user to keep hitting some key"}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515598908, "post_id": 48188732, "comment_id": 83362203, "body": "I know how the end result of world will be in advance. The second program is widely different, even though the &quot;rules are the same&quot;. I am aware that this is not how usually GoL is implemented, the accurate portrayal of the game is not important here. @user3629249"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515599760, "post_id": 48188732, "comment_id": 83362853, "body": "the posted code (both versions) fails to handle the case when the current cell has exactly 2 live neighbors"}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "edited": false, "score": 0, "creation_date": 1515600261, "post_id": 48188732, "comment_id": 83363212, "body": "It does, yet it the end result for the first program is correct. Why should it matter for the second program when I only change how I pass on status of the cells?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1515600275, "post_id": 48188732, "comment_id": 83363221, "body": "it is poor programming practice to include header files those contents are not being used.  Suggest removing the statement: <code>#include &lt;stdlib.h&gt;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1515601177, "post_id": 48188732, "comment_id": 83363833, "body": "regarding: <code>for( int rl = -1; rl &lt;= 1; rl++ )             {                 for( int cl = -1; cl &lt;= 1; cl++ )                 {                     if(field[rowCell - rl][colCell - cl].state == ALIVE)</code>  this is accessing beyond the bounds of the &#39;cell&#39;  For example: when <code>rowCell</code> = 0 and <code>colCell</code> = 0, then the check for the state is checking row -1 and col -1 And if the <code>.state</code> of that out-of-bounds cell happens to be <code>ALIVE</code> then the &#39;if&#39; code block is entered.  Suggest placing that &#39;if&#39; statement inside the &#39;if&#39; code block that checks for the boundaries"}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515601600, "post_id": 48188732, "comment_id": 83364140, "body": "Thank you for the input! I actually need help how to avoid entering beyond the bounds in any case. It is still puzzling why the program works. It might be that it&#39;s highly unlikely that a cell can be alive where it has now been initiated. I&#39;m wondering if this out of bounds problem is somehow connected to why the second program won&#39;t work. @user3629249"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515602217, "post_id": 48188732, "comment_id": 83364534, "body": "in function: <code>initField()</code>, in the second program, both <code>current</code> and <code>next</code> need to be properly initialized, probably to <code>DEAD</code>  And when initializing the 5 <code>ALIVE</code> fields, the <code>next</code> also needs to be initialized to <code>ALIVE</code>.   This additional initialization is needed because the <code>updateField()</code> is not handling the case where exactly two of the neighbors are <code>ALIVE</code>"}, {"owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515603324, "post_id": 48188732, "comment_id": 83365223, "body": "Wow. You are totally right. I totally missed I had to initialize that too. I can&#39;t thank you enough! @user3629249"}], "owner": {"reputation": 65, "user_id": 4115006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yRf5l.png?s=128&g=1", "display_name": "Senethys", "link": "https://stackoverflow.com/users/4115006/senethys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515591591, "creation_date": 1515591591, "question_id": 48188732, "link": "https://stackoverflow.com/questions/48188732/difference-between-nearly-identical-implementations-with-different-results", "title": "Difference between nearly identical implementations with different results", "body": "<p>I have two game of life implementations with a small difference in struct used:</p>\n\n<pre><code>typedef struct{\n  char state;\n  int neighbours;\n} cell;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>typedef struct{\n  char current;\n  char next;\n  int neighbours;\n} cell;\n</code></pre>\n\n<p>The bigger struct only needs few extra lines to work:</p>\n\n<pre><code> for (int r = 0; r &lt; rows; r++) {\n      for(int c = 0; c &lt; cols; c++) {\n          if (field[r][c].next == ALIVE) {\n              field[r][c].current = ALIVE;\n          }\n          else {\n              field[r][c].current = DEAD;\n          }\n      }\n   }\n}\n</code></pre>\n\n<p>Yet if you run then, it's a totally different result. Why?</p>\n\n<p>Code that works:</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ALIVE 'X'\n#define DEAD '.'\n\n\ntypedef struct{\n  char state;\n  int neighbours;\n} cell;\n\n\nvoid initField(const int rows, const int cols, cell field[rows][cols]);\nvoid printField(const int rows, const int cols, cell field[rows][cols]);\nvoid getNeighbours(const int rows, const int cols, cell field[rows][cols]);\nvoid updateField(const int rows, const int cols, cell field[rows][cols]);\n\n\nint main(void) {\n\n  //Keeps track for of user choice.\n  char key;\n\n  //World size.\n  const int R = 20;\n  const int C = 20;\n\n  //Creates the RxC cell field.\n  cell cells[R][C];\n\n  initField(R, C, cells);\n\n  do {\n    printField(R, C, cells);\n    scanf(\"%c\", &amp;key);\n    updateField(R, C, cells);\n  } while(key == '\\n');\n\n  return 0;\n}\n\n\nvoid initField(const int rows, const int cols, cell field[rows][cols]) {\n  for (int r = 0 ; r &lt; rows ; r++) {\n    for (int c = 0 ; c &lt; cols ; c++) {\n      field[r][c].state = DEAD;\n    }\n  }\n  field[0][1].state = ALIVE;\n  field[1][2].state = ALIVE;\n  field[2][0].state = ALIVE;\n  field[2][1].state = ALIVE;\n  field[2][2].state = ALIVE;\n}\n\nvoid printField(const int rows, const int cols, cell field[rows][cols]) {\n  for (int r = 0; r &lt; rows ; r++) {\n    for (int c = 0; c &lt; cols ; c++) {\n      printf(\"%c \", field[r][c].state);\n    }\n    printf(\"\\n\");\n  }\n}\n\nvoid getNeighbours(const int rows, const int cols, cell field[rows][cols]) {\n\n  for(int rowCell = 0; rowCell &lt; rows; rowCell++){\n    for(int colCell = 0; colCell &lt; cols; colCell++) {\n      //Resets the neighbour count for all cells.\n      field[rowCell][colCell].neighbours = 0;\n      //Checks for alove neighbours \"around\" cell\".\n      for(int rl = -1; rl &lt;= 1; rl++){\n        for(int cl = -1; cl &lt;= 1; cl++) {\n          if(field[rowCell - rl][colCell - cl].state == ALIVE) {\n            //Ignore the center cell to count as its own neighbour and ignore\n            //the memory cells beyond the given size of the world for right and left.\n            if(!(rl == 0 &amp;&amp; cl == 0) &amp;&amp; (rowCell-rl &lt; rows) &amp;&amp; (colCell-cl &lt; cols) &amp;&amp; (colCell-cl &gt;= 0) &amp;&amp; (rowCell-rl &gt;= 0)) {\n              field[rowCell][colCell].neighbours += 1;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n\nvoid updateField(const int rows, const int cols, cell field[rows][cols]) {\n\n  getNeighbours(rows, cols, field);\n\n  for (int r = 0; r &lt; rows; r++) {\n    for (int c = 0; c &lt; cols; c++) {\n      if(field[r][c].neighbours == 3) {\n        field[r][c].state = ALIVE;\n      }\n      else if(field[r][c].neighbours &lt;= 1) {\n        field[r][c].state = DEAD;\n      }\n      else if(field[r][c].neighbours &gt;= 4) {\n        field[r][c].state = DEAD;\n      }\n    }\n }\n}\n</code></pre>\n\n<p>Code that DOES NOT:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n/* Constants, representation of states */\n#define ALIVE 'X'\n#define DEAD '.'\n\n/* Declaration of data structure */\ntypedef struct{\n  char current;\n  char next;\n  int neighbours;\n} cell;\n\n\n/* Declaration of functions */\nvoid initField(const int rows, const int cols, cell field[rows][cols]);\nvoid printField(const int rows, const int cols, cell field[rows][cols]);\nvoid getNeighbours(const int rows, const int cols, cell field[rows][cols]);\nvoid updateField(const int rows, const int cols, cell field[rows][cols]);\n\n\nint main(void) {\n\n  char key;\n\n  //Rows and colum sizes.\n  const int R = 20;\n  const int C = 20;\n\n  //Create an array of size 20x20 containin cells.\n  cell cells[R][C];\n\n  //Initates the game.\n  initField(R, C, cells);\n\n  //Prints field, menu and updates the game while the user presses enter.\n  do {\n    printField(R, C, cells);\n    scanf(\"%c\", &amp;key);\n    if(key == '\\n') {\n      updateField(R, C, cells);\n    }\n  } while(key == '\\n');\n\n  return 0;\n}\n\n\nvoid initField(const int rows, const int cols, cell field[rows][cols]) {\n  for (int r = 0 ; r &lt; rows ; r++) {\n    for (int c = 0 ; c &lt; cols ; c++) {\n      field[r][c].current = DEAD;\n    }\n  }\n  field[0][1].current = ALIVE;\n  field[1][2].current = ALIVE;\n  field[2][0].current = ALIVE;\n  field[2][1].current = ALIVE;\n  field[2][2].current = ALIVE;\n}\n\nvoid printField(const int rows, const int cols, cell field[rows][cols]) {\n\n  for (int r = 0; r &lt; rows ; r++) {\n    for (int c = 0; c &lt; cols ; c++) {\n      printf(\"%c \", field[r][c].current);\n    }\n    printf(\"\\n\");\n  }\n}\n\nvoid getNeighbours(const int rows, const int cols, cell field[rows][cols]) {\n\n  for(int rowCell = 0; rowCell &lt; rows; rowCell++){\n    for(int colCell = 0; colCell &lt; cols; colCell++) {\n      //Resets the neighbour count for all cells.\n      field[rowCell][colCell].neighbours = 0;\n      //Checks for alove neighbours \"around\" cell\".\n      for(int rl = -1; rl &lt;= 1; rl++){\n        for(int cl = -1; cl &lt;= 1; cl++) {\n          if(field[rowCell - rl][colCell - cl].current == ALIVE) {\n            //Ignore the center cell to count as its own neighbour and ignore\n            //the data beyond the given size of the world for right and left.\n            if(!(rl == 0 &amp;&amp; cl == 0) &amp;&amp; (rowCell-rl &lt; rows) &amp;&amp; (colCell-cl &lt; cols) &amp;&amp; (colCell-cl &gt;= 0) &amp;&amp; (rowCell-rl &gt;= 0)) {\n              field[rowCell][colCell].neighbours += 1;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n\nvoid updateField(const int rows, const int cols, cell field[rows][cols]) {\n\n  getNeighbours(rows, cols, field);\n  for (int r = 0; r &lt; rows; r++) {\n    for (int c = 0; c &lt; cols; c++) {\n      if(field[r][c].neighbours == 3) {\n        field[r][c].next = ALIVE;\n      }\n      else if(field[r][c].neighbours &lt;= 1) {\n        field[r][c].next = DEAD;\n      }\n      else if(field[r][c].neighbours &gt;= 4) {\n        field[r][c].next = DEAD;\n      }\n    }\n  }\n\n  for (int r = 0; r &lt; rows; r++) {\n      for(int c = 0; c &lt; cols; c++) {\n          if (field[r][c].next == ALIVE) {\n              field[r][c].current = ALIVE;\n          }\n          else {\n              field[r][c].current = DEAD;\n          }\n      }\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "ssl", "openssl"], "comments": [{"owner": {"reputation": 2634, "user_id": 7748072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf66595c2c53ae2454c8f398d2797156?s=128&d=identicon&r=PG", "display_name": "Eug&#232;ne Adell", "link": "https://stackoverflow.com/users/7748072/eug%c3%a8ne-adell"}, "edited": false, "score": 0, "creation_date": 1515596292, "post_id": 48188703, "comment_id": 83360363, "body": "Do you have a pcap capture then we are sure of these times you are logging within your code ?"}, {"owner": {"reputation": 79, "user_id": 4433814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b09afb5ea3fbf3832abd0a1e096a304?s=128&d=identicon&r=PG&f=1", "display_name": "ATL", "link": "https://stackoverflow.com/users/4433814/atl"}, "reply_to_user": {"reputation": 2634, "user_id": 7748072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf66595c2c53ae2454c8f398d2797156?s=128&d=identicon&r=PG", "display_name": "Eug&#232;ne Adell", "link": "https://stackoverflow.com/users/7748072/eug%c3%a8ne-adell"}, "edited": false, "score": 0, "creation_date": 1515600386, "post_id": 48188703, "comment_id": 83363294, "body": "Hi @Eug&#232;neAdell, yes, these times come from the server"}], "owner": {"reputation": 79, "user_id": 4433814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b09afb5ea3fbf3832abd0a1e096a304?s=128&d=identicon&r=PG&f=1", "display_name": "ATL", "link": "https://stackoverflow.com/users/4433814/atl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515591503, "creation_date": 1515591503, "question_id": 48188703, "link": "https://stackoverflow.com/questions/48188703/ssl-session-reuse-performance", "title": "SSL Session reuse performance", "body": "<p>I have a server using SSL and capable of doing session resumption, but when reusing the session, SSL_read() function takes more time.\nThe following sequence, shows what is happening:</p>\n\n<ol>\n<li>Establish the connection (First handshake \u2248 4 seconds). Here I save the context and the session on the client to be reused.</li>\n<li>Read the data \u2248 0.01 seconds</li>\n<li>Close the connection</li>\n<li>Re-establish the connection with the context and the session previously saved (\u2248 0.01 seconds)</li>\n<li>Read the data \u2248 0.2 seconds</li>\n<li>Close the connection</li>\n</ol>\n\n<p>So, what would be the reason that step 2) is so much faster than step 5)</p>\n\n<p>Thank you in advanced.</p>\n"}, {"tags": ["c", "pointers", "data-structures", "singly-linked-list"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1515590921, "post_id": 48188418, "comment_id": 83356736, "body": "You basically ask for a tutorial on pointers. StackOverflow is not the place for that. Look for tutorials via your favorite search engine. Select the one which, too you personally, is written in the most easily understandable way. Work through it. Very important: Take a piece of paper and a pen. Represent values of variables as number/strings inside rectangle. Represent values of pointers as rectangles from which arrows point to other rectangles. Especially with pointers pointing to pointers. Act like being the computer and execute the programs."}, {"owner": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "edited": false, "score": 0, "creation_date": 1515616652, "post_id": 48188418, "comment_id": 83372267, "body": "In &quot;C&quot; language, there&#39;s at least two common reasons to use pointers : when you allocate memory and when a function modify the value of a parameter. In the <code>push</code> function you have these both reasons : <code>head</code> points to some allocated memory and the function modify the <code>head</code> value. That is why it uses a double pointer."}], "answers": [{"tags": [], "owner": {"reputation": 525, "user_id": 5011673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df09600e4d6b3319209b1d29e0ae3b95?s=128&d=identicon&r=PG&f=1", "display_name": "Kram", "link": "https://stackoverflow.com/users/5011673/kram"}, "is_accepted": false, "score": 0, "last_activity_date": 1515590916, "creation_date": 1515590916, "answer_id": 48188546, "question_id": 48188418, "link": "https://stackoverflow.com/questions/48188418/how-to-insert-a-new-node-in-a-singly-linked-list-without-using-a-temporary-node/48188546#48188546", "title": "How to insert a new node in a singly linked list without using a temporary node?", "body": "<p>Well, if I understood your question, so:</p>\n\n<p>In the push function you actually replace the original node pointer in the memory.\nE.g if you have the following list:\n1->2->3->5, and you have pointer to 1, after the push function with val 6, the list will contains: 6->1->2->3->5. but your head node will point to 6 (actual address of the pointer will be changed. The head pointer will point to another place in the memory).</p>\n\n<p>In the second option, you don't change the pointer of the head. You just change the values of the struct (next actually). With the previous example, after the insert the head pointer will still point to the same location in the memory.</p>\n"}, {"tags": [], "owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "is_accepted": true, "score": 2, "last_activity_date": 1515592283, "last_edit_date": 1515592283, "creation_date": 1515591721, "answer_id": 48188768, "question_id": 48188418, "link": "https://stackoverflow.com/questions/48188418/how-to-insert-a-new-node-in-a-singly-linked-list-without-using-a-temporary-node/48188768#48188768", "title": "How to insert a new node in a singly linked list without using a temporary node?", "body": "<p>Well, the simplest way of not doing something is not to do it.</p>\n\n<p>Tracing what the values of things are through your implementation:</p>\n\n<pre><code>// Insert a node to the beginning of the linked list\nvoid addNodeBegin (node_t *head, int val) { // assume head = [val1, ...]\n    node_t *newNode = NULL;\n    newNode = malloc(sizeof(node_t));\n    newNode-&gt;val = val;                     // newNode=[val, null]\n\n    newNode-&gt;next = head-&gt;next;             // newNode=[val, ...]\n    head-&gt;next = newNode;                   // head = [val1, [val, ...]]\n\n    node_t *tmp = NULL;\n    tmp = malloc(sizeof(node_t));\n\n    tmp-&gt;val = head-&gt;val;                   // tmp = [val1, undefined]\n    head-&gt;val = newNode-&gt;val;               // head = [val, [val, ...]]\n    head-&gt;next-&gt;val = tmp-&gt;val;             // head = [val, [val1, ...]]\n\n    free(tmp);\n\n}\n</code></pre>\n\n<p>Firstly, the only thing temp is doing is storing a copy of head->val, so you could store the value directly instead by setting newNode->val before overwriting head->val:</p>\n\n<pre><code>// Insert a node to the beginning of the linked list\nvoid addNodeBegin (node_t *head, int val) { // assume head = [val1, ...]\n    node_t *newNode = malloc(sizeof(node_t)); // no need to set to NULL first\n    newNode-&gt;val = head-&gt;val;               // newNode=[val1, undefined]\n    newNode-&gt;next = head-&gt;next;             // newNode=[val1, ...]\n    head-&gt;next = newNode;                   // head = [val1, [val1, ...]]\n    head-&gt;val = val;                        // head = [val, [val1, ...]]\n}\n</code></pre>\n\n<p>Secondly, this is doing something different to adding a node at the beginning of a list. It is inserting a node after the beginning, then swapping the values between the first and second nodes. This will matter as very commonly singly linked lists have multiple heads, either for performance reasons or to implement specific algorithms, so operations shouldn't change the tail of the list when they prepend to it.\nIt also means you have to have two different operations - appending to an empty list (NULL) and appending to a non-empty list. </p>\n\n<p>The example implementation of push() takes a pointer to the pointer to the head of the list, creates a new node and mutates that pointer to point to the new node. This seems harder to use than necessary, as it requires taking the address of the pointer to the head.</p>\n\n<pre><code>node_t* head = NULL;\n\npush ( &amp;head, 1 );\npush ( &amp;head, 2 );\npush ( &amp;head, 3 );\npush ( &amp;head, 4 );\n\nnode_t* head2 = head;\n\npush ( &amp;head2, 5 );\n</code></pre>\n\n<p>Personally I'd just return the pointer to the new node:</p>\n\n<pre><code>node_t* cons (int val, node_t* next) {\n    node_t * new_node = malloc(sizeof(node_t));\n\n    new_node-&gt;val = val;\n    new_node-&gt;next = next;\n\n    return new_node;\n}\n\nnode_t* head = cons(4, cons(3, cons(2, cons(1, NULL))));\nnode_t* head2 = cons(5, head); \n</code></pre>\n\n<p>'Cons' is short for construct, a traditional name for the construction of singly linked lists in this manner.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1515736713, "creation_date": 1515736713, "answer_id": 48220390, "question_id": 48188418, "link": "https://stackoverflow.com/questions/48188418/how-to-insert-a-new-node-in-a-singly-linked-list-without-using-a-temporary-node/48220390#48220390", "title": "How to insert a new node in a singly linked list without using a temporary node?", "body": "<p>Think on the double asterisk as a double pointer or a reference to a pointer.... the problem basically is that, in C, you cannot pass a function a variable parameter (or a parameter by reference), and so, the only way to do it is by explicitly passing the address of the pointer you want to modify.  That's the reason of the second asterisk, to make the modification made to the referenced pointer available to the application.  Both levels of reference have different meanings... you cannot pass a variable to be updated to a function as parameter, but you can pass its address.  Passing a double pointer makes this possible and you can update the pointer with something like:</p>\n\n<pre><code>*ptr_reference = &amp;node_to_be_referenced;\n</code></pre>\n\n<p>When you call the function, you pass it a reference to the pointer to be modified, something like:</p>\n\n<pre><code>function_to_be_called(&amp;pointer_to_first_node, node_to_be_inserted);\n</code></pre>\n\n<p>or, if you want to pass a middle pointer:</p>\n\n<pre><code>function_to_be_called(&amp;previous_node_of_inserted-&gt;next, node_to_be_inserted);\n</code></pre>\n\n<p>(see how is the address of the pointer what is used to reference the pointer to be modified)</p>\n"}], "owner": {"reputation": 47, "user_id": 9151261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed04c69cdcb225d7497b998c64d3804b?s=128&d=identicon&r=PG&f=1", "display_name": "omnimiratus", "link": "https://stackoverflow.com/users/9151261/omnimiratus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1106, "favorite_count": 0, "accepted_answer_id": 48188768, "answer_count": 3, "score": 3, "last_activity_date": 1515736713, "creation_date": 1515590439, "question_id": 48188418, "link": "https://stackoverflow.com/questions/48188418/how-to-insert-a-new-node-in-a-singly-linked-list-without-using-a-temporary-node", "title": "How to insert a new node in a singly linked list without using a temporary node?", "body": "<p>I just started to learn Data Structures and have been trying to implement a simple <strong>singly linked list</strong> in C going step by step. I have been following an online tutorial and while showing how to insert a node to the beginning of the list, it used double asterisks in the function parameters which I couldn't understand and the tutorial didn't explain in detail.</p>\n\n<p>I then worked around this and implemented the function without double pointers (by using a temp node), but I would love to understand and learn how the implementation I saw worked and how I implement it myself.</p>\n\n<p>I taught myself about pointers fairly recently so I cannot say that I'm comfortable with them. Actually that's one of the reasons for why I have started learning Data Structures, to practice them more. I normally understand how <em>dereferencing</em> a pointer works, but in this context I am not sure how and with what purpose it's been used in the function header.</p>\n\n<p>I would be so grateful if you could explain the way the function below works.</p>\n\n<p>Here is the function that I couldn't quite get. <a href=\"http://www.learn-c.org/en/Linked_lists\" rel=\"nofollow noreferrer\">(source)</a></p>\n\n<pre><code>void push(node_t ** head, int val) {\n    node_t * new_node;\n    new_node = malloc(sizeof(node_t));\n\n    new_node-&gt;val = val;\n    new_node-&gt;next = *head;\n    *head = new_node;\n}\n</code></pre>\n\n<p>And here is my implementation:</p>\n\n<pre><code>/*\n// Singly Linked List Implementation\n// 2018/01/10\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node {\n        int val;\n        struct node *next;\n    } node_t;\n\nvoid addNodeBegin (node_t *head, int val);\nvoid addNodeEnd (node_t *head, int val);\nvoid printLinkedList();\nvoid freeList(struct node* head);\n\nint main(void) {\n\n    node_t *head = NULL;\n    head = malloc(sizeof(node_t));\n\n    if (head == NULL) { return 1; }\n\n    head-&gt;val = 1;\n    head-&gt;next = NULL;\n\n    head-&gt;next = malloc(sizeof(node_t));\n    head-&gt;next-&gt;val = 2;\n    head-&gt;next-&gt;next = NULL;\n\n    addNodeEnd(head, 5);\n    addNodeBegin(head, 10);\n    printLinkedList(head);\n\n    freeList(head);\n\n}\n\n// Insert a node to the beginning of the linked list\nvoid addNodeBegin (node_t *head, int val) {\n    node_t *newNode = NULL;\n    newNode = malloc(sizeof(node_t));\n    newNode-&gt;val = val;\n\n    newNode-&gt;next = head-&gt;next;\n    head-&gt;next = newNode;\n\n    node_t *tmp = NULL;\n    tmp = malloc(sizeof(node_t));\n\n    tmp-&gt;val = head-&gt;val;\n    head-&gt;val = newNode-&gt;val;\n    head-&gt;next-&gt;val = tmp-&gt;val;\n\n    free(tmp);\n\n}\n\n// Insert a node to the end of the linked list\nvoid addNodeEnd (node_t *head, int val) {\n    node_t *current = head;\n\n    while (current-&gt;next != NULL) {\n        current = current-&gt;next;\n    }\n\n    current-&gt;next = malloc(sizeof(node_t));\n    current-&gt;next-&gt;val = val;\n    current-&gt;next-&gt;next = NULL;\n\n}\n\n// Print the linked list\nvoid printLinkedList(node_t *head) {\n    node_t *current = head;\n\n    while (current != NULL) {\n        printf(\"%d\\n\", current-&gt;val);\n        current = current-&gt;next;\n    }\n}\n\n// Remove the list (and free the occupied memory)\nvoid freeList(struct node* head) {\n   struct node* tmp;\n\n   while (head != NULL) {\n       tmp = head;\n       head = head-&gt;next;\n       free(tmp);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1515590655, "post_id": 48188415, "comment_id": 83356573, "body": "What&#39;s better: <code>log2(x)</code> or <code>ln(x)</code>? Doesn&#39;t make much sense as both are similar, but do different things, yet with some trickery one can be used instead of the other."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1515591664, "post_id": 48188415, "comment_id": 83357197, "body": "@underscore_d - The link provided is not a duplicate.  The discussion there, is very specifically delineating the difference between <code>#include &lt;...&gt;</code> and <code>#include &quot;...&quot;</code> notation.  This question is asking for advice on best practices of when to use them.  Agreed the topics overlap, but disagree that one completely eclipses the other."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515592314, "post_id": 48188415, "comment_id": 83357618, "body": "@ryyker To me, the other thread explains what the typical implementation-defined differences between the two are, and &quot;best practices&quot; flow naturally from knowing those."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515592720, "post_id": 48188415, "comment_id": 83357915, "body": "Using header blocks, together with using headers located in the calling files directory, or header files located in the <i>default search</i> location are all tools you can choose to use in order to accomplish your design.  For ideas on best practices in embedded programming, there are some good discussions <i><a href=\"https://embeddedgurus.com/barr-code/2010/11/what-belongs-in-a-c-h-header-file/\" rel=\"nofollow noreferrer\">HERE</a></i> and <i><a href=\"https://www.embedded.com/electronics-blogs/barr-code/4215934/What-belongs-in-a-header-file\" rel=\"nofollow noreferrer\">HERE</a></i>."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515598240, "post_id": 48188415, "comment_id": 83361726, "body": "Sorry for hammering this &quot;closed&quot; as I see this question being somewhat different in approach; but the two answers already posted were of so poor quality compared to what is presented in the duplicate that I saw not much benefit in waiting (for better answers or the existing ones being improved). The wording of the standard is elaborated in the duplicate, and &quot;best practice&quot; might change with project, environment, coworkers... not enough to let it stand on its own."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515598545, "post_id": 48188415, "comment_id": 83361932, "body": "Note the answers by piCookie and aib in the duplicate (#2 and #3 at the time of this comment) in addition to the top one by quest49 (which focuses on how current implementations do it)."}, {"owner": {"reputation": 61, "user_id": 4497871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4X4kD.jpg?s=128&g=1", "display_name": "Pieter Conradie", "link": "https://stackoverflow.com/users/4497871/pieter-conradie"}, "edited": false, "score": 0, "creation_date": 1515656465, "post_id": 48188415, "comment_id": 83384849, "body": "I have expanded my example by adding an unused module called &#39;foo&#39; as well as a universal #include &lt;fl_api.h&gt;. I accept that the question should be closed, but just needed confirmation that this was the way that other good (embedded) C libraries do it."}, {"owner": {"reputation": 61, "user_id": 4497871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4X4kD.jpg?s=128&g=1", "display_name": "Pieter Conradie", "link": "https://stackoverflow.com/users/4497871/pieter-conradie"}, "edited": false, "score": 0, "creation_date": 1515664795, "post_id": 48188415, "comment_id": 83389464, "body": "I&#39;ve added the Boost library as a reference example."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515682348, "post_id": 48188415, "comment_id": 83400691, "body": "@PieterConradie: I have come across many customs over the years. 1) Use <code>&lt;&gt;</code> only for the standard library, and <code>&quot;&quot;</code> for everything else. 2) Use <code>&lt;&gt;</code> for anything external (i.e. stuff that you take from the system) and <code>&quot;&quot;</code> for anything from your own project. 3) Use <code>&lt;&gt;</code> for &quot;public&quot; headers (i.e., system, and headers your project provides to clients) and <code>&quot;&quot;</code> for &quot;private&quot; headers (i.e. those only used by your project internally). As virtually no compiler actually exploits the &quot;permission&quot; to have <code>&lt;&gt;</code> <i>not</i> being actual files, the practical differences are minimal."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515682473, "post_id": 48188415, "comment_id": 83400774, "body": "Personally I use 1). And reopened your question, as it is much more clearly a non-dupe now."}, {"owner": {"reputation": 61, "user_id": 4497871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4X4kD.jpg?s=128&g=1", "display_name": "Pieter Conradie", "link": "https://stackoverflow.com/users/4497871/pieter-conradie"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515758195, "post_id": 48188415, "comment_id": 83433145, "body": "@DevSolar. Thanks for reopening my question. I have changed the title and revised the content to better reflect what I am actually asking. I hope that it&#39;s acceptable."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1515592192, "post_id": 48188625, "comment_id": 83357539, "body": "It requires that file to be locatable by the compiler in the given search directories <i>in practice</i>. By word of the language, all that happens in either case is that files are <i>&quot;searched for in an implementation-defined manner&quot;</i>."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1515591239, "creation_date": 1515591239, "answer_id": 48188625, "question_id": 48188415, "link": "https://stackoverflow.com/questions/48188415/user-library-collection-of-c-modules-best-method-to-provide-overridable-confi/48188625#48188625", "title": "User library (collection of C modules): best method to provide overridable configuration per C module?", "body": "<p>Using angle brackets, <code>#include &lt;mylib.h&gt;</code> requires the path to find mylib.h to be known to the IDE (compiler).</p>\n\n<p>Using quotes does not require this.</p>\n\n<p>What to use may depend on how you organize your files. If they are pretty local and relative to your main program, it is better to use quotes, which makes your development directory tree easier transportable.</p>\n"}, {"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515598378, "post_id": 48190646, "comment_id": 83361827, "body": "That&#39;s the behaviour of GCC. Other compilers might differ, as behaviour is <i>implementation-defined</i>."}, {"owner": {"reputation": 194, "user_id": 4955118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FSFY-mD9PLU/AAAAAAAAAAI/AAAAAAAAALs/ZyLLxe1hayM/photo.jpg?sz=128", "display_name": "Shahe Ansar", "link": "https://stackoverflow.com/users/4955118/shahe-ansar"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1515600504, "post_id": 48190646, "comment_id": 83363380, "body": "@DevSolar True, but in general, this is the convention I&#39;ve seen being followed by most compilers, and since the guy seems to be using GCC,  i don&#39;t see any problems"}], "tags": [], "owner": {"reputation": 194, "user_id": 4955118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FSFY-mD9PLU/AAAAAAAAAAI/AAAAAAAAALs/ZyLLxe1hayM/photo.jpg?sz=128", "display_name": "Shahe Ansar", "link": "https://stackoverflow.com/users/4955118/shahe-ansar"}, "is_accepted": false, "score": -1, "last_activity_date": 1515597753, "creation_date": 1515597753, "answer_id": 48190646, "question_id": 48188415, "link": "https://stackoverflow.com/questions/48188415/user-library-collection-of-c-modules-best-method-to-provide-overridable-confi/48190646#48190646", "title": "User library (collection of C modules): best method to provide overridable configuration per C module?", "body": "<p>It's nothing too complicated.<br>\nWhen you use <code>#include &lt;someFile.h&gt;</code> GCC will search through it's include paths (default one like the system headers paths (for ex - <code>/usr/include/</code>), or specified explicitly using the <code>-I&lt;path&gt;</code> option on the command line.<br>\nOn the other hand, when you use <code>#include \"someFile.h\"</code>, GCC will search for said file relative to the current file. So, if the current file is <code>include/test.h</code> and it has the line <code>#include \"test2.h\"</code> in it, then GCC will check for the existence of the file <code>include/test2.h</code> and include it.</p>\n\n<p>So, in your case, since you want to distribute a library, use the <code>\"\"</code> style for referencing header files that belong to your library. If you use some other library, then it's best to have <code>&lt;&gt;</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 4497871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4X4kD.jpg?s=128&g=1", "display_name": "Pieter Conradie", "link": "https://stackoverflow.com/users/4497871/pieter-conradie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515757984, "creation_date": 1515590425, "last_edit_date": 1515757984, "question_id": 48188415, "link": "https://stackoverflow.com/questions/48188415/user-library-collection-of-c-modules-best-method-to-provide-overridable-confi", "title": "User library (collection of C modules): best method to provide overridable configuration per C module?", "body": "<p>I want to create and share a new C user library (using best practices). It is a collection of C modules that a user program can compile and link with. Each module has a default configuration, but the user program must be able to override the default configuration (only if it wants to). Also, the user program must not be forced to provide configurations for C modules that it does not use.</p>\n\n<p>I want to group the C module files together in the same library directory (e.g. module.h, module_cfg.h &amp; module.c) to minimize the learning curve for a user of my library.</p>\n\n<p>Here is my solution to the problem, but I was wondering if this is bad form and if there is a better solution.</p>\n\n<p>Let's call the new C library <em>FancyLib</em> and use the prefix \"<strong>fl</strong>\" to prevent namespace clashes with other libraries or user code. Inside the library is a <code>timer</code> module. It has a default configuration file, but is overridden by a user supplied configuration file. Also inside the library is a module called <code>foo</code> that is not used by the user program.</p>\n\n<p>The whole user project, including the library, consists of the following files:</p>\n\n<ul>\n<li>libs/fl/fl_lib.h</li>\n<li>libs/fl/utils/fl_tmr.h</li>\n<li>libs/fl/utils/fl_tmr_cfg.h <strong>&lt;-- DEFAULT</strong></li>\n<li>libs/fl/utils/fl_tmr.c</li>\n<li>libs/fl/utils/fl_foo.h</li>\n<li>libs/fl/utils/fl_foo_cfg.h <strong>&lt;-- DEFAULT</strong></li>\n<li>libs/fl/utils/fl_foo.c</li>\n<li>cfg/fl_tmr_cfg.h <strong>&lt;-- OVERRIDE</strong></li>\n<li>src/main.c</li>\n</ul>\n\n<p>The content of src/main.c is:</p>\n\n<pre><code>#include &lt;fl_lib.h&gt;\n\nint main(int argc, char *argv[])\n{\n    fl_tmr_init();\n}\n</code></pre>\n\n<p>The content of libs/fl/fl_lib.h is:</p>\n\n<pre><code>#ifndef __FL_LIB_H__\n#define __FL_LIB_H__\n\n#include &lt;utils/fl_tmr.h&gt;\n#include &lt;utils/fl_foo.h&gt;\n\n#endif\n</code></pre>\n\n<p>The content of libs/fl/utils/fl_tmr.h is:</p>\n\n<pre><code>#ifndef __FL_TMR_H__\n#define __FL_TMR_H__\n\n// Include configuration (default or user supplied)\n#include &lt;fl_tmr_cfg.h&gt;\n\nvoid fl_tmr_init(void);\n\n#endif\n</code></pre>\n\n<p>The content of libs/fl/utils/fl_tmr.c is:</p>\n\n<pre><code>#include \"fl_tmr.h\" // &lt;-- Need to be quotes\n\nvoid fl_tmr_init(void)\n{\n    // Initialise timer\n}\n</code></pre>\n\n<p>The content of libs/fl/utils/fl_foo.h is:</p>\n\n<pre><code>#ifndef __FL_FOO_H__\n#define __FL_FOO_H__\n\n// Include configuration (default or user supplied)\n#include &lt;fl_foo_cfg.h&gt;\n\n#endif\n</code></pre>\n\n<p>The search path for the compiler is specified as <strong>\"-Icfg -Isrc -Ilibs/fl\"</strong>. This ensures that the user supplied configuration file is found first (cfg/fl_tmr_cfg.h) and overrides the default file in the library (libs/fl/utils/fl_tmr_cfg.h).</p>\n\n<p>Is this the best way to go about it?</p>\n\n<p>This solution only works if <code>#include &lt;&gt;</code> (with angle brackets) are used, because it \"forces\" the compiler to follow the specified include directory precedence and not use the file it found first in the same directory as the *.c file (e.g. when libs/fl/utils/fl_tmr.c is compiled).</p>\n\n<p>The use of <code>#include \"\"</code> (quotes) versus <code>#include &lt;&gt;</code> (angle brackets) have been discussed in depth <a href=\"https://stackoverflow.com/questions/21593\">here</a>, but I was still confused by <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.8.1/cpp/Search-Path.html\" rel=\"nofollow noreferrer\">this GCC documentation page</a> that made me think that <code>#include &lt;&gt;</code> (angle brackets) should be used for <strong>system</strong> files only, e.g. <code>#include &lt;stdio.h&gt;</code></p>\n\n<p>One reference example is the <a href=\"http://www.boost.org/\" rel=\"nofollow noreferrer\">boost library</a> that uses <code>#include &lt;filename&gt;</code> extensively, but makes an exception. Here is an example:</p>\n\n<p>boost\\libs\\math\\src\\tr1\\acosh.cpp:</p>\n\n<pre><code>#include &lt;boost/math/tr1.hpp&gt;\n#include &lt;boost/math/special_functions/acosh.hpp&gt; // &lt;-- Angle brackets\n#include \"c_policy.hpp\" // &lt;-- Quotes\n</code></pre>\n\n<p>Note: <code>c_policy.hpp</code> is in the same directory as <code>acosh.cpp</code></p>\n\n<p>One pitfall mentioned in that discussion is that dependencies are generated for <code>#include \"\"</code> files only and not for <code>#include &lt;&gt;</code> files. This means that if a file is changed in the library then the whole project needs to be rebuilt from scratch.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Pieter</p>\n\n<p>P.S. Any other pointers/hints/links/examples to create a good (embedded) C library would be greatly appreciated.</p>\n"}, {"tags": ["c", "linux", "arm", "interrupt", "device-tree"], "comments": [{"owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1515594108, "post_id": 48188392, "comment_id": 83358806, "body": "Have you seen this page? <a href=\"http://billauer.co.il/blog/2012/08/irq-zynq-dts-cortex-a9/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1575, "user_id": 6783666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bB4KQ.jpg?s=128&g=1", "display_name": "Moritz", "link": "https://stackoverflow.com/users/6783666/moritz"}, "reply_to_user": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1515595408, "post_id": 48188392, "comment_id": 83359734, "body": "No I had not, but it does not give a clear answer. One of the comments though led me to a <a href=\"http://xillybus.com/tutorials/device-tree-zynq-4\" rel=\"nofollow noreferrer\">page</a> that describes it properly, even clearing up confusion about 0x0 being used for shared peripheral interrupts (SPI) even though in documentation it is defined as the opposite, non-SPI. Would you be interested in writing up an answer?"}, {"owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1515608473, "post_id": 48188392, "comment_id": 83368087, "body": "Sure.  That website looks like a better writeup.  Good find"}], "answers": [{"tags": [], "owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "is_accepted": true, "score": 1, "last_activity_date": 1515608506, "creation_date": 1515608506, "answer_id": 48193847, "question_id": 48188392, "link": "https://stackoverflow.com/questions/48188392/in-an-arm-device-tree-file-what-do-the-three-interrupt-values-mean/48193847#48193847", "title": "In an ARM device tree file, what do the three interrupt values mean", "body": "<p>Parsing from the linked websites:</p>\n\n<blockquote>\n  <p>The first number is a flag indicating if the interrupt is an SPI\n  (shared peripheral interrupt). A nonzero value means it is an SPI.\n  This impacts offsets added to translate the interrupt number (16 for SPI, 32 for non-SPI).</p>\n  \n  <p>The second number is the interrupt number. </p>\n  \n  <p>The third number is the type of interrupt: \n  0 = Leave it as it was (power-up default or what the bootloader set it to, if it did). 1 = Rising edge.  4 = Level sensitive, active high.</p>\n</blockquote>\n"}], "owner": {"reputation": 1575, "user_id": 6783666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bB4KQ.jpg?s=128&g=1", "display_name": "Moritz", "link": "https://stackoverflow.com/users/6783666/moritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 48193847, "answer_count": 1, "score": 1, "last_activity_date": 1515608506, "creation_date": 1515590336, "question_id": 48188392, "link": "https://stackoverflow.com/questions/48188392/in-an-arm-device-tree-file-what-do-the-three-interrupt-values-mean", "title": "In an ARM device tree file, what do the three interrupt values mean", "body": "<p>A device tree source for a typical ARM device would have the interrupt-controller section:</p>\n\n<pre><code>interrupt-controller@f8f01000 {\n    compatible = \"arm,cortex-a9-gic\";\n    #interrupt-cells = &lt;0x3&gt;;\n    interrupt-controller;\n    reg = &lt;0xf8f01000 0x1000 0xf8f00100 0x100&gt;;\n    num_cpus = &lt;0x2&gt;;\n    num_interrupts = &lt;0x60&gt;;\n    linux,phandle = &lt;0x3&gt;;\n    phandle = &lt;0x3&gt;;\n};\n</code></pre>\n\n<p>The property <code>#interrupt-cells</code> defines the size of the tuple for registering an interrupt. Therefore, when defining a device, three integers have to be defined to specify an interrupt and its properties.</p>\n\n<pre><code>ocmc@f800c000 {\n    compatible = \"xlnx,zynq-ocmc-1.0\";\n    interrupt-parent = &lt;0x3&gt;;\n    interrupts = &lt;0x0 0x3 0x4&gt;;\n    reg = &lt;0xf800c000 0x1000&gt;;\n};\n</code></pre>\n\n<p>The question is, what do each of the three values stand for? So, what does the line <code>interrupts = &lt;0x0 0x3 0x4&gt;;</code> mean? And what offset has to be added when registering an interrupt handler for it (via <code>signal.h</code>/<code>csignal</code> with <code>signal(&lt;signal id&gt;, &lt;function name&gt;);</code>)</p>\n"}, {"tags": ["c", "struct", "casting", "function-pointers", "undefined-behavior"], "comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515595423, "post_id": 48188371, "comment_id": 83359745, "body": "@chux: you are right, but surprisingly Clang accepts it..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515595638, "post_id": 48188371, "comment_id": 83359901, "body": "I see no place in the code in your question where you use the result of converting a function pointer. A converted pointer is stored in the <code>op</code> member of a <code>struct vtable</code>, but nothing reads that value, let alone uses it to call a function. Your <code>foo</code> function calls <code>child_op</code> directly, not through a pointer. Should we presume that <code>child_op</code> will be called through the pointer-to-an-incompatible-type stored in <code>op</code>?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1515595751, "post_id": 48188371, "comment_id": 83359977, "body": "@SergeBallesta &quot;warning: declaration does not declare anything [-Wmissing-declarations]&quot;, with <code>pedantic-errors</code> that doesn&#39;t compile."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515597070, "post_id": 48188371, "comment_id": 83360861, "body": "An appropriate response to whether there are cases where this would cause problems is \u201cIf you lie to the compiler, it will get its revenge,\u201d attributed to Henry Spencer. A supported way to accomplish the desired behavior in C is to declare the functions using the same type, a function taking a pointer to <code>void</code>."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515600071, "post_id": 48188371, "comment_id": 83363065, "body": "@EricPostpischil: but using a function taking a pointer to void will not save you from a downcast: the <code>void *</code> cannot be used without it."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1515700886, "post_id": 48191324, "comment_id": 83411670, "body": "The Standard does not require that compilers behave in useful fashion if a non-prototyped function or function pointer is invoked with an argument type that does not match its first parameter.  Given <code>void void f(struct child*p) {...} void (*fp)() = f; struct child *sp;</code>, calling <code>fp(&amp;sp)</code> would have defined behavior, but calling <code>fp(&amp;(sp.parent))</code> would not."}, {"owner": {"reputation": 1085, "user_id": 2350268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SYcb.jpg?s=128&g=1", "display_name": "Sebastian Schrader", "link": "https://stackoverflow.com/users/2350268/sebastian-schrader"}, "edited": false, "score": 0, "creation_date": 1515855473, "post_id": 48191324, "comment_id": 83464350, "body": "I&#39;ll opt to be on the safe then, rather than playing UB games with the compiler and resort to wrapper functions, which will perform the casts."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1515599788, "creation_date": 1515599788, "answer_id": 48191324, "question_id": 48188371, "link": "https://stackoverflow.com/questions/48188371/is-it-undefined-behavior-in-c-to-cast-function-pointers-operating-on-derived-str/48191324#48191324", "title": "Is it undefined behavior in C to cast function pointers operating on derived structs up to functions operating on the base type?", "body": "<p>Unfortunately, there is no valid way to reference a function with a <code>struct child *</code> parameter with a pointer to function with a <code>struct parent *</code> parameter. Of course we all know that it will work with any common implementation, because at assembly language level a pointer to function is the address of the function, and the casting of a pointer to struct, to a pointer to its first member is a no-op.</p>\n\n<p>But precisely because it is a no-op, there is no reason to write UB code just to avoid it. So the correct way is to write the functions for the vtable with the exact declared signature and downcast the pointer to the correct pointed type as first instruction in the function. If the function has to exist with a child argument, just use a tiny wrapper in the vtable.</p>\n\n<hr>\n\n<p>An alternative conformant method would be to use K&amp;R style declarations for the vtable pointers also called <em>empty parameter lists</em> in n1570 draft for C11. 6.7.6.3 \u00a715 says:</p>\n\n<blockquote>\n  <p>...If one type has a parameter type list and the other type is specified by a\n  <strong>function declarator that is not part of a function definition and that contains an empty\n  identifier list</strong>, the parameter list shall not have an ellipsis terminator and the type of each\n  parameter shall be compatible with the type that results from the application of the\n  default argument promotions.</p>\n</blockquote>\n\n<p>That means that if you declare:</p>\n\n<pre><code>struct vtable {\n    void(*op)();              // empty parameter list in declaration\n};\n</code></pre>\n\n<p><code>op</code> can point to </p>\n\n<pre><code>void child_op(struct child *obj) {\n    // No need to cast here anymore\n    /* Do stuff */\n}\n</code></pre>\n\n<p>and if you have declared <code>child</code> as:</p>\n\n<pre><code>struct child {\n    struct parent parent;\n    int bar;\n};\n</code></pre>\n\n<p>Following code is legal C:</p>\n\n<pre><code>struct vtable child_vtable = { &amp;child_op };\nstruct child foo = { { &amp;child_vtable }, 25 };\nfoo.parent.vtable-&gt;op(&amp;foo);\n</code></pre>\n\n<p>because as <code>op</code> is actually called with a <code>struc child *</code> parameter it is indeed compatible with <code>child_op</code>.</p>\n\n<p>Unfortunately, this has 2 major drawbacks:</p>\n\n<ul>\n<li>you definitely lose any compile time control on the number and types of the parameters (that's why prototypes were invented...)</li>\n<li>it is explicetely an obsolescent feature:</li>\n</ul>\n\n<blockquote>\n  <p><strong>6.11.6 Function declarators</strong><br/>\n  1 The use of function declarators with empty parentheses (not prototype-format parameter\n  type declarators) is an obsolescent feature.</p>\n</blockquote>\n\n<p>TL/DR a downcast at the beginning of a function is not such a terrible thing, and it can save you from a future compiler revenge...</p>\n"}], "owner": {"reputation": 1085, "user_id": 2350268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SYcb.jpg?s=128&g=1", "display_name": "Sebastian Schrader", "link": "https://stackoverflow.com/users/2350268/sebastian-schrader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 48191324, "answer_count": 1, "score": 3, "last_activity_date": 1553264146, "creation_date": 1515590266, "last_edit_date": 1553264146, "question_id": 48188371, "link": "https://stackoverflow.com/questions/48188371/is-it-undefined-behavior-in-c-to-cast-function-pointers-operating-on-derived-str", "title": "Is it undefined behavior in C to cast function pointers operating on derived structs up to functions operating on the base type?", "body": "<p>Suppose we have the following well-known inheritance pattern in C with a parent, a derived child <code>struct</code> and a vtable:</p>\n\n<pre><code>struct parent;\n\nstruct vtable {\n    void(*op)(struct parent *obj);\n};\n\nstruct parent {\n    struct vtable *vtable;\n};\n\nstruct child {\n    struct parent parent;\n    int bar;\n};\n</code></pre>\n\n<p>The vtable for <code>struct child</code> is then usually defined in the following way:</p>\n\n<pre><code>void child_op(struct parent *obj) {\n    // Downcast\n    struct child *child = (struct child *)obj;\n    /* Do stuff */\n}\n\nstatic struct vtable child_vtable = {\n    .op = child_op,\n};\n</code></pre>\n\n<p>We can then use the vtable and have dynamic dispatch:</p>\n\n<pre><code>void foo(struct parent *obj) {\n    obj-&gt;vtable-&gt;op(obj);\n}\n</code></pre>\n\n<p>There are cases however, where we know the concrete type of a <code>struct child</code>, e.g. directly after the struct was allocated. In this case, it makes sense to skip the indirect function call through the vtable and call the specific implementation of <code>op</code> for <code>struct child</code> directly. To dos this however, we have to convert the pointer first. The \u201cupcast\u201d can be performed without actual casting.</p>\n\n<pre><code>void bar(void) {\n    struct child *obj = malloc(sizeof(*obj));\n    obj-&gt;parent.vtable = &amp;child_vtable;\n    // Need convert pointer to child into pointer to parent first\n    child_op(&amp;obj-&gt;parent);\n}\n</code></pre>\n\n<p>Would it be legal however,\nto declare the <code>child_op</code> function taking a parameter of <code>struct child *</code> instead of the base type <code>struct parent *</code>,\nbecause we know, that it will be called only with pointers to <code>struct child</code> objects and cast the function pointer assigned to the vtable instead:</p>\n\n<pre><code>void child_op(struct child *obj) {\n    // No need to cast here anymore\n    /* Do stuff */\n}\n\n// Cast only when creating the vtable\n// Is this undefined behaviour?\nstatic struct vtable child_vtable = {\n    .op = (void (*)(struct parent *))child_op,\n};\n\nvoid foo(struct child *obj) {\n    // No need to do any conversion here anymore\n    child_op(obj);\n}\n</code></pre>\n\n<p>As one can see, this would save us from having to cast in <code>child_op</code> and converting <code>struct child *</code> into <code>struct parent *</code> in cases, where we are sure, we have a valid pointer to a <code>struct child</code> (and no pointer to a e.g. <code>struct grandchild</code>).</p>\n\n<p>A similar issue is discussed <a href=\"https://stackoverflow.com/questions/559581/casting-a-function-pointer-to-another-type\">here</a> and I conclude from it, that it would be legal if the types <code>void (*)(struct parent *)</code> and <code>void (*)(struct child *)</code> are <em>compatible</em>.</p>\n\n<p>It certainly works in <em>practice</em> with the compilers and platforms I tested. If it is indeed undefined behaviour, are there any cases, where this would actually cause problems and the missing cast would actually have done something? Are any well-known projects using this scheme?</p>\n\n<p>EDIT: You can find the examples on godbolt:</p>\n\n<ul>\n<li><a href=\"https://godbolt.org/g/FYvDtn\" rel=\"nofollow noreferrer\">Regular</a></li>\n<li><a href=\"https://godbolt.org/g/zeDc3r\" rel=\"nofollow noreferrer\">Casted Function Pointer in vtable</a></li>\n</ul>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 2496, "user_id": 3512524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d86f158f96941fef8bb311262cf3ad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Skowronek", "link": "https://stackoverflow.com/users/3512524/krzysztof-skowronek"}, "edited": false, "score": 0, "creation_date": 1515589893, "post_id": 48188203, "comment_id": 83356105, "body": "see (this answer)[<a href=\"https://stackoverflow.com/a/201116/3512524]\">stackoverflow.com/a/201116/3512524]</a> about array initialization. It&#39;s a bit different that in python and JavaScript . First of all you need to put number of elements inside [ ]"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1515589943, "post_id": 48188203, "comment_id": 83356125, "body": "Read the documentation for <code>scanf</code>. Are you using it correctly?"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1515590013, "post_id": 48188203, "comment_id": 83356162, "body": "What compiler are you using? You need to <b>pay attention to the warnings</b>. If you&#39;re using GCC, always compile with <code>gcc -Wall -Werror</code>."}], "answers": [{"comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1515590293, "post_id": 48188304, "comment_id": 83356315, "body": "Agreed. If you&#39;re not going to use something for math, it should be an array of chars/ints, not a (single) integer. Thus, storing the ISBN as an array makes sense."}, {"owner": {"reputation": 29, "user_id": 9198598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f304bf0baaa33b16e00b883b8be24578?s=128&d=identicon&r=PG&f=1", "display_name": "Tallulah", "link": "https://stackoverflow.com/users/9198598/tallulah"}, "edited": false, "score": 0, "creation_date": 1515590471, "post_id": 48188304, "comment_id": 83356451, "body": "So I had tried that originally. It shows me this error &quot; isbn.c:7:10: error: array initializer must be an initializer list or string literal     char isbn[10] = 0;&quot;"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1515590669, "post_id": 48188304, "comment_id": 83356582, "body": "There are a few liitle bugs in your program, though I think I spotted most of them. But you should learn to use a debugger so you can step through your program and see in detail what it does and where you made the small (or sometimes large) mistakes."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1515590747, "post_id": 48188304, "comment_id": 83356636, "body": "OK: &quot;error: array initializer must be an initializer list or string literal char isbn[10] = 0;&quot; Then use curly braces, <code>isbn[10]={0};</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515591805, "post_id": 48188304, "comment_id": 83357287, "body": "@chux, updated. Better to be correct than sloppy (which I already was...)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 3, "last_activity_date": 1515591777, "last_edit_date": 1515591777, "creation_date": 1515590029, "answer_id": 48188304, "question_id": 48188203, "link": "https://stackoverflow.com/questions/48188203/how-to-calculate-isbn-using-c/48188304#48188304", "title": "How to calculate ISBN using C?", "body": "<p>The problem starts with <code>int isbn[]=0;</code> This declares an arry of no size, which can't be.</p>\n\n<p>Then you read <code>isbn</code> as a single <code>int</code> and then you seem to want to calculate using each digit of the ISBN.</p>\n\n<p>To do that, I suggest to declare <code>char isbn[14]={0};</code> (ISBN can be 13 characters, see <a href=\"https://en.wikipedia.org/wiki/International_Standard_Book_Number\" rel=\"nofollow noreferrer\">isbn</a>).</p>\n\n<p>Then read it as <code>scanf(\"%13s\", isbn);</code></p>\n\n<p>and process it like:</p>\n\n<pre><code>    sum = (isbn[num]-'0') * times_by; // convert digit to number\n</code></pre>\n\n<p>Note: <code>sum1 = sum + sum;</code> should be <code>sum1 = sum1 + sum;</code></p>\n\n<p>Note: <code>result = sum / 11;</code> should be <code>result = sum1 / 11;</code></p>\n\n<p>Note: you must initialize <code>sum1</code>: <code>long long sum1=0;</code></p>\n\n<p>Note: <code>result = sum1 / 11;</code> won't give you the remainder. Use <code>result = sum1 % 11;</code></p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 8841866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f3699db33971c1e0e8441f82a7c2ca?s=128&d=identicon&r=PG&f=1", "display_name": "nollak", "link": "https://stackoverflow.com/users/8841866/nollak"}, "is_accepted": false, "score": 0, "last_activity_date": 1515590129, "creation_date": 1515590129, "answer_id": 48188338, "question_id": 48188203, "link": "https://stackoverflow.com/questions/48188203/how-to-calculate-isbn-using-c/48188338#48188338", "title": "How to calculate ISBN using C?", "body": "<p>The line <code>int isbn[] = 0;</code> is your problem you are pointing the array's address to 0x0 which is not a valid address space for your application.</p>\n\n<p>You should initialize your isbn array in another way. For example <code>int isbn[20]</code>. You should give a length which is sufficient for ISBN numbers. I just used 20 as an example.</p>\n"}], "owner": {"reputation": 29, "user_id": 9198598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f304bf0baaa33b16e00b883b8be24578?s=128&d=identicon&r=PG&f=1", "display_name": "Tallulah", "link": "https://stackoverflow.com/users/9198598/tallulah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 0, "accepted_answer_id": 48188304, "answer_count": 2, "score": -4, "last_activity_date": 1515839211, "creation_date": 1515589683, "last_edit_date": 1515839211, "question_id": 48188203, "link": "https://stackoverflow.com/questions/48188203/how-to-calculate-isbn-using-c", "title": "How to calculate ISBN using C?", "body": "<p>Below is my code that should calculate the ISBN number of a book:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main(void)\n{\n    int isbn[] = 0;\n    printf(\"Please enter ISBN number: \\n\");\n\n    scanf(\"%d\", &amp;isbn);\n    int num = 0;\n    int times_by = 1;\n    long long sum;\n    long long sum1;\n    long long result = 0;\n    for (num = 0; num &lt;= 9; num++){\n        sum = isbn[num] * times_by;\n        sum1 = sum + sum;\n        times_by++;\n    }\n    result = sum / 11;\n    if (result == 0){\n        printf(\"Yes\\n\");\n    } \n    else {\n        printf(\"No\\n\");\n    }\n}\n</code></pre>\n\n<p>It is telling me that there is a problem with the initiator of isbn. I tried to create an array, which the inputted ISBN number would be saved to after, though Im not sure if this is possible..</p>\n"}, {"tags": ["c++", "c", "64-bit", "numerical-methods", "intel-ipp"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1515589497, "post_id": 48187923, "comment_id": 83355886, "body": "If you&#39;re performing multiple operations on your data then you probably want to strip-mine it anyway, with a chunk size <i>much</i> smaller than 2^30 elements."}, {"owner": {"reputation": 5909, "user_id": 500207, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DsvTT.jpg?s=128&g=1", "display_name": "Ahmed Fasih", "link": "https://stackoverflow.com/users/500207/ahmed-fasih"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1515589922, "post_id": 48187923, "comment_id": 83356117, "body": "@PaulR got it. Does the advice for small chunks hold even if I won&#39;t be doing multiple-operations, i.e., just add or abs or conj on an array?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1515590095, "post_id": 48187923, "comment_id": 83356203, "body": "No, no need to strip-mine if it&#39;s just a single operation and there is no possibility of combining it with other operations. If this is the case with simple operations like add/abs though then you will most likely be memory bandwidth-limited and will not see a significant improvement from using optimised routines."}], "owner": {"reputation": 5909, "user_id": 500207, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DsvTT.jpg?s=128&g=1", "display_name": "Ahmed Fasih", "link": "https://stackoverflow.com/users/500207/ahmed-fasih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515588678, "creation_date": 1515588678, "question_id": 48187923, "link": "https://stackoverflow.com/questions/48187923/intel-ipp-functions-for-arrays-beyond-32-bit-size-limits", "title": "Intel IPP functions for arrays beyond 32-bit size limits?", "body": "<p>I\u2019m evaluating <a href=\"https://software.intel.com/en-us/ipp-dev-reference\" rel=\"nofollow noreferrer\">Intel IPP</a> to speed up certain parts of our code, e.g.,</p>\n\n<ul>\n<li><a href=\"https://software.intel.com/en-us/ipp-dev-reference-add\" rel=\"nofollow noreferrer\">adding</a></li>\n<li><a href=\"https://software.intel.com/en-us/node/502108\" rel=\"nofollow noreferrer\">absolute value</a></li>\n<li><a href=\"https://software.intel.com/en-us/ipp-dev-reference-sortradixascend-sortradixdescend\" rel=\"nofollow noreferrer\">sorting</a></li>\n</ul>\n\n<p>among others. I note this <a href=\"https://software.intel.com/en-us/ipp-dev-guide-using-intel-integrated-performance-primitives-platform-aware-functions\" rel=\"nofollow noreferrer\">page in the manual</a>:</p>\n\n<blockquote>\n  <p>While the rest of Intel IPP functions support only signals or images of 32-bit integer size, Intel IPP platform-aware functions work with 64-bit object sizes if it is supported by the target platform. \u2026 You can distinguish Intel IPP platform-aware functions by the <code>L</code> suffix in the function name, for example, <code>ippiAdd_8u_C1RSfs_L</code>. With Intel IPP platform-aware functions you can overcome 32-bit size limitations.</p>\n</blockquote>\n\n<p>Of the three I mentioned above, it appears only <em>sorting</em> has 64-bit-aware functionality.</p>\n\n<p>So, questions: can this be right? Can IPP <em>not</em> accelerate addition/abs on arrays beyond 32-bit indexing? Is there a master list of functions that have \u201cplatform-aware\u201d (64-bit) alternatives in IPP? Do people hand-roll workarounds to the 32-bit limit, like calling the add/abs functions in a loop over 2^30-sized chunks?</p>\n"}, {"tags": ["c", "constants", "declaration", "definition"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1515587328, "post_id": 48187398, "comment_id": 83354600, "body": "<code>const int N_POINTS=10;</code> in the header (and twice included) will probably give a link error (something like multiple definitions). Instead, you can do this: <code>extern const in N_POINTS;</code> in the header and <code>const int N_POINTS=10;</code> in <i>one</i> C source. The linker will ensure that all other C sources will be linked against the same <code>N_POINTS</code>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1515587540, "post_id": 48187398, "comment_id": 83354746, "body": "Please, consider that <code>const</code> does not mean &quot;constant&quot; as you might think. Instead, it should be understood as &quot;read-only&quot;. There are no constants in C except the literals (e.g. <code>123</code>) and values defined by an <code>enum</code>. (My personal memory hook: everything what you <i>may</i> use e.g. as size of a global array declaration...)"}, {"owner": {"reputation": 220, "user_id": 3295322, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1a114d13f7cb21d6f699f5ac0b2de8a3?s=128&d=identicon&r=PG&f=1", "display_name": "YouHaveaBigEgo", "link": "https://stackoverflow.com/users/3295322/youhaveabigego"}, "edited": false, "score": 0, "creation_date": 1515587633, "post_id": 48187398, "comment_id": 83354807, "body": "Is <code>extern</code> mostly useful in this context only?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1515587764, "post_id": 48187398, "comment_id": 83354880, "body": "@Scheff Detail: In C, <code>123</code> is an integer <i>constant</i>.  C has 2 <i>literals</i>: <i>string literal</i> and <i>compound literal</i> - both of which may have their address taken, unlike <i>constants</i>. (Different from C++)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 220, "user_id": 3295322, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1a114d13f7cb21d6f699f5ac0b2de8a3?s=128&d=identicon&r=PG&f=1", "display_name": "YouHaveaBigEgo", "link": "https://stackoverflow.com/users/3295322/youhaveabigego"}, "edited": false, "score": 0, "creation_date": 1515587884, "post_id": 48187398, "comment_id": 83354929, "body": "@YouHaveaBigEgo Depends on how you consider it - you declare functions as extern, too, so they are accessible from outside the file - just that extern is the default..."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515588067, "post_id": 48187398, "comment_id": 83355023, "body": "@chux I must admit that this term &quot;literal&quot; confuses me a bit. I tried to say it correct but I fully agree with your argument. I once tried to clarify this in google and Wikipedia but with less luck. This term is used in too many contexts with slightly different meanings... (But I don&#39;t give up. Once I will get it...)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 220, "user_id": 3295322, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1a114d13f7cb21d6f699f5ac0b2de8a3?s=128&d=identicon&r=PG&f=1", "display_name": "YouHaveaBigEgo", "link": "https://stackoverflow.com/users/3295322/youhaveabigego"}, "edited": false, "score": 0, "creation_date": 1515588226, "post_id": 48187398, "comment_id": 83355117, "body": "@YouHaveaBigEgo My rule of thumb: If its globally declared and its not explicitly something else (e.g. <code>static</code>) or restricted by a previous declaration it&#39;s <code>extern</code>. The answers to <a href=\"https://stackoverflow.com/q/496448/7478597\">SO: How to correctly use the extern keyword in C</a> probably explain it better."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1515588505, "post_id": 48187398, "comment_id": 83355268, "body": "@Scheff Agree about &quot;literal&quot; confusion.  I try to use as the C spec as this is a C post - C spec uses it in a consistent manner/context - literally ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1515589024, "last_edit_date": 1592644375, "creation_date": 1515588762, "answer_id": 48187951, "question_id": 48187398, "link": "https://stackoverflow.com/questions/48187398/division-between-declaration-and-definition-in-other-c-files/48187951#48187951", "title": "Division between declaration and definition in other C files", "body": "<blockquote>\n<p>The problem is when I try to declare constant global variable in header file  ...</p>\n<p>how to correct this code to run it without error status(?)</p>\n</blockquote>\n<p>Instead, <em>declare</em> <code>extern</code> in main_lib.h  <a href=\"https://stackoverflow.com/questions/48187398/division-between-declaration-and-definition-in-other-c-files/48187951#comment83354600_48187398\">@Scheff</a>.  This would be the same if the global variable was non-<code>const</code> or <code>volatile</code>.</p>\n<pre><code>// const int N_POINTS=10;\nextern const int N_POINTS;\n</code></pre>\n<p><em>Define</em> it once and only in main_lib.c</p>\n<pre><code>// add\nconst int N_POINTS=10;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1515589671, "creation_date": 1515589671, "answer_id": 48188200, "question_id": 48187398, "link": "https://stackoverflow.com/questions/48187398/division-between-declaration-and-definition-in-other-c-files/48188200#48188200", "title": "Division between declaration and definition in other C files", "body": "<p>A method I often use is:</p>\n\n<pre><code>// lib.h\n#ifndef EXTERN\n#define EXTERN extern\n#endif\nEXTERN int myInt;\n\n// lib.c\n#include \"lib.h\"\n\n// main.c\n#define EXTERN\n#include \"lib.h\"\n</code></pre>\n\n<p><code>myInt</code> will now be known in all modules in which <code>lib.h</code> is included but will only be declared once in <code>main.c</code>. Usefull when you have lots of includes.</p>\n"}], "owner": {"reputation": 11, "user_id": 9198233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bda4ec1bd6f694cfa92a6b8b1f1f54?s=128&d=identicon&r=PG&f=1", "display_name": "J. Deniro", "link": "https://stackoverflow.com/users/9198233/j-deniro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1515589671, "creation_date": 1515586881, "question_id": 48187398, "link": "https://stackoverflow.com/questions/48187398/division-between-declaration-and-definition-in-other-c-files", "title": "Division between declaration and definition in other C files", "body": "<p>I would like to know how make the division between declaration and definition. I read few related with this topic question but for now I can do this only in basic funtion. The problem is when I try to declare constant global variable in header file and I want use this constant in the function which have declaration in the same place but definition in other files. I have 2 files with .c extension and one with .h extension.</p>\n\n<p>File main_lib.h consist:</p>\n\n<pre><code>#ifndef _MAIN_LIB_H_\n#define _MAIN_LIB_H_\nconst int N_POINTS=10;\n\nstruct Point{\n    int x;\n    int y;\n};\nvoid fill_random(struct Point points[], int n);\nvoid closest(struct Point points[], int n, struct Point* p);\n\n#endif /* _MAIN_LIB_H_ */\n</code></pre>\n\n<p>File main_lib.c consist:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;math.h&gt;\n    #include \"main_lib.h\"\n\n    void fill_random(struct Point points[], int n){\n...\n    }\n    void closest(struct Point points[], int n, struct Point* p){\n...\n    }\n</code></pre>\n\n<p>And the last file named main.c consist:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include \"main_lib.h\"\n\nint main()\n{\n    srand(time(0));\n    struct Point random_points[N_POINTS];\n\n    struct Point *p;\n    p=&amp;random_points[0];\n\n    fill_random(p,N_POINTS);\n    closest(p,N_POINTS,p);\n\n    return 0;\n}\n</code></pre>\n\n<p>The question is how to correct this code to run it without error status. Thanks a lot for any help.</p>\n"}, {"tags": ["c", "file", "graph"], "comments": [{"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 3, "creation_date": 1515586684, "post_id": 48187296, "comment_id": 83354174, "body": "Why do you prepare the buffer in memory? I/O functions are already buffered, just stream out one line after the other and you won&#39;t even need to allocate a huge buffer (of an unknown size). However without your actual code is hard to say where it may be improved."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515586691, "post_id": 48187296, "comment_id": 83354178, "body": "Please <a href=\"https://stackoverflow.com/posts/48187296/edit\">edit</a> your qquestion explain what this is: <i>...txt file in such format: &quot; \\n&quot;</i>. Also show the definition of the structure and the code you&#39;ve written, otherwise it&#39;s hard to say anything about your code."}, {"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 0, "creation_date": 1515586737, "post_id": 48187296, "comment_id": 83354214, "body": "Please provide a Minimal, Complete, and Verifiable example (<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 2, "creation_date": 1515586853, "post_id": 48187296, "comment_id": 83354279, "body": "@Nebril you can write <code>[mcve]</code> in the comment, this will expand automatically to this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515587404, "post_id": 48187296, "comment_id": 83354658, "body": "@MichaelWalz  Where is that useful tidbit about <code>[mcve]</code> documented?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1515587597, "post_id": 48187296, "comment_id": 83354786, "body": "@chux: funny that you ask, I had the same experience. It&#39;s actually <a href=\"https://stackoverflow.com/editing-help#comment-formatting\">in the Help</a>!"}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515587702, "post_id": 48187296, "comment_id": 83354842, "body": "@MichaelWalz corrected the question"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515588296, "post_id": 48187296, "comment_id": 83355161, "body": "@AntonKretov Curious, 1) why <code>long</code> in <code>long bufferLength = ...</code>.  Why not <code>int</code>, <code>unsigned</code>, others? 2) Suggest <code>size_t</code>  3) <code>numberOfNodes * (9 * 3 + 3)</code> is done using <code>int</code> math.  Assigning that to a <code>long</code> does not prevent overflow.  4) Code should use <code>size_t num_nodes; ...  size_t numberOfNodes</code> and <code>size_t bufferLength = numberOfNodes * (9 * 3 + 3);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515588505, "post_id": 48187296, "comment_id": 83355267, "body": "As you do your own buffering, you can use <code>setbuf(f, NULL);</code>  right after <code>fopen</code>, which switches off the usage of the internal buffer used by <code>fwrite</code> and thus avoiding copying your buffer into the internal buffer used by <code>fwrite</code>. This might speed  up your program a bit."}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515588871, "post_id": 48187296, "comment_id": 83355506, "body": "@MichaelWalz I&#39;ve recently tried your suggestion and it actually gave a bit of speed to all this stuff. But not as much as I would like to. But the idea is fine"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1515589171, "post_id": 48187296, "comment_id": 83355707, "body": "I would try the suggestion of the very first comment as alternative. A buffer of limited size may even have positive effects over a huge buffer containing the complete file at once before writing. And, please, don&#39;t forget to make your benchmarking with optimized release compiles. (Otherwise the results are not valuable.) My last idea: memory mapped files are mentioned usually when such questions appear..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515589637, "post_id": 48187296, "comment_id": 83355960, "body": "Try using naively <code>fprintf</code> (no <code>setbuf(f, NULL)</code> in that case). This will also greatly simplify your code."}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515589899, "post_id": 48187296, "comment_id": 83356109, "body": "@MichaelWalz with fprinf() the whole thing works 1.5x-2x slower."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1515590452, "post_id": 48187296, "comment_id": 83356440, "body": "Not directly related, but in the <code>for</code> loop you should double check that <code>bufferLength</code> us never greater than <code>bufferCounter</code>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515593593, "post_id": 48188888, "comment_id": 83358429, "body": "Thanks for your suggestion, but your solution had 1.5x longer save time than mine..."}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515594017, "post_id": 48188888, "comment_id": 83358749, "body": "printf gets a string as an agrument, then makes a lot of formatting operations and returns string. It is far slower than my approach (3x-4x times slower)."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1515592109, "creation_date": 1515592109, "answer_id": 48188888, "question_id": 48187296, "link": "https://stackoverflow.com/questions/48187296/the-fastest-way-to-save-graph-to-file-in-c/48188888#48188888", "title": "The fastest way to save graph to file in C", "body": "<p>I assume that what you need is an optimized version of printf that only processes positive integers. I did not benchmark it, but I would try to do as little comparisons and operations as possible, so I ended with that function:</p>\n\n<pre><code>int printint(FILE *fd, int n) {\n    char buffer[32];     // an uint64_t uses max 20 chars in base 10 \n    int i = sizeof(buffer);\n    do {\n        buffer[--i] = '0' + n%10;   // write digits from the right of buffer\n        n /= 10;\n    } while(n &gt; 0);\n    return fwrite(buffer + i, 1, sizeof(buffer) - i, fd);\n}\n</code></pre>\n\n<p>Then I would not use a huge buffer, but just rely on the default buffering of a FILE *</p>\n\n<p>Saving code could then become (more or less just started with the example form the question):</p>\n\n<pre><code>    const dijkstra_t *const dij = (dijkstra_t*)dijkstra;\n\n    if (dij) {\n    FILE *f = fopen(filename, \"w\");\n    if (f) {\n\n    int numberOfNodes = dij-&gt;num_nodes;\n\n    fputs(\"0 0 -1\\n\", f);\n\n    for(int i = 1; i &lt; numberOfNodes; i++) {\n        const node_t *const node = &amp;(dij-&gt;nodes[i]);\n\n        fputc(' ', f);\n\n        number = node-&gt;parent;\n        //printf(\"parent = %d\\n\", number);\n        if(number != -1) {\n            printint(number, f);\n        } else {\n              fwrite(\"-1\", 1, 2, f);\n\n        }\n\n        fputc('\\n', f);\n\n    }\n\n  ret = fclose(f) == 0;\n  free(buffer);\n  }\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515612130, "post_id": 48193360, "comment_id": 83369949, "body": "Your suggestion has made a kind of improvement, I would say, it became 5-10% faster on small graphs (&lt; 1000000 edges) and 20-30% faster on bigger graphs (&gt; 1000000 edges). I wonder if there is any additional kind of improvements that can be done in order to improve the code. Btw, maybe you could suggest me some kind of reading this file with edges? I have it fast enough, but it could be faster. I can show my code"}, {"owner": {"reputation": 56, "user_id": 9098796, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-21PQQpAB8RU/AAAAAAAAAAI/AAAAAAAAAG8/A0FQNKCnmc0/photo.jpg?sz=128", "display_name": "gwerners", "link": "https://stackoverflow.com/users/9098796/gwerners"}, "reply_to_user": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515612839, "post_id": 48193360, "comment_id": 83370306, "body": "The only thing I can think is pre-process your array to avoid memory cache-miss if the node and graph are too far away in memory, but this could be difficult as the improvement is not guaranteed in all cases."}, {"owner": {"reputation": 56, "user_id": 9098796, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-21PQQpAB8RU/AAAAAAAAAAI/AAAAAAAAAG8/A0FQNKCnmc0/photo.jpg?sz=128", "display_name": "gwerners", "link": "https://stackoverflow.com/users/9098796/gwerners"}, "reply_to_user": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515612967, "post_id": 48193360, "comment_id": 83370375, "body": "also, I think is a good idea to build a more complete example of what you need (a working example) with a random data generator for us to test."}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515613955, "post_id": 48193360, "comment_id": 83370888, "body": "This is generator&#39;s code - <a href=\"https://paste.ofcode.org/sBFeT3EU657WT8EsPWSU26\" rel=\"nofollow noreferrer\">paste.ofcode.org/sBFeT3EU657WT8EsPWSU26</a> I consider retyping all integers that do not accept negative values to uint32_t. I has to help too"}], "tags": [], "owner": {"reputation": 56, "user_id": 9098796, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-21PQQpAB8RU/AAAAAAAAAAI/AAAAAAAAAG8/A0FQNKCnmc0/photo.jpg?sz=128", "display_name": "gwerners", "link": "https://stackoverflow.com/users/9098796/gwerners"}, "is_accepted": false, "score": 0, "last_activity_date": 1515606741, "creation_date": 1515606741, "answer_id": 48193360, "question_id": 48187296, "link": "https://stackoverflow.com/questions/48187296/the-fastest-way-to-save-graph-to-file-in-c/48193360#48193360", "title": "The fastest way to save graph to file in C", "body": "<p>You can improve a little by using this \"itoa\":</p>\n\n<pre><code>void gwf_i2a(char *d, int i, int l) {\n  char *e = d + l;\n  while (l &gt; 0) {\n    e--;\n    l--;\n    e[0] = '0' + (i % 10);\n    i /= 10;\n  }\n}\n</code></pre>\n\n<hr>\n\n<p>ORIGINAL TIME: 76 clicks (7.6e-05 seconds).</p>\n\n<p>NEW      TIME: 39 clicks (3.9e-05 seconds).</p>\n\n<hr>\n\n<p>source:</p>\n\n<pre><code>#include &lt;ctime&gt;\n#include &lt;iostream&gt;\n#include &lt;random&gt;\n#include &lt;vector&gt;\n\n#define ZERO '0'\n\nvoid gwf_i2a(char *d, int i, int l) {\n  char *e = d + l;\n  while (l &gt; 0) {\n    e--;\n    l--;\n    e[0] = '0' + (i % 10);\n    i /= 10;\n  }\n}\n\ntypedef struct {\n  int x, y, z;\n} graph_t;\n\ntypedef struct {\n  int edge_start;\n  int edge_count;\n  int parent;\n  int cost;\n} node_t;\n\ntypedef struct {\n  graph_t *graph;\n  node_t *nodes;\n  int num_nodes;\n  int start_node;\n} dijkstra_t;\n\ngraph_t graph = {111, 222, 3456789};\nnode_t nodes[] = {{1, 1, 1, 9999}, {2, 2, 2, 8999}, {2, 2, 2, 1234567890}};\ndijkstra_t data[] = {&amp;graph, (node_t *)&amp;nodes, 4, 0};\n\nint getNumberOfDigits(int x) {\n  if (x &gt;= 100) {\n    if (x &gt;= 1000) return 3;\n    return 2;\n  }\n  if (x &gt;= 10) return 1;\n  return 0;\n}\n\nint getNumberOfDigitsBig(int x) {\n  if (x &gt;= 10000) {\n    if (x &gt;= 10000000) {\n      if (x &gt;= 100000000) {\n        if (x &gt;= 1000000000) return 9;\n        return 8;\n      }\n      return 7;\n    }\n    if (x &gt;= 100000) {\n      if (x &gt;= 1000000) return 6;\n      return 5;\n    }\n    return 4;\n  }\n  if (x &gt;= 100) {\n    if (x &gt;= 1000) return 3;\n    return 2;\n  }\n  if (x &gt;= 10) return 1;\n  return 0;\n}\n\nvoid save(const char *filename, const dijkstra_t *dijkstra) {\n  int ret;\n  const dijkstra_t *const dij = (dijkstra_t *)dijkstra;\n  char *buffer;\n  if (dij) {\n    FILE *f = fopen(filename, \"w\");\n    if (f) {\n      int numberOfNodes = dij-&gt;num_nodes;\n      long bufferLength = numberOfNodes * (9 * 3 + 3);\n      buffer = (char *)malloc(bufferLength + 1);\n      long bufferCounter = 0;\n\n      int number;\n      // printf(\"i = %d\\n\", number);\n      int counter;\n      int digits;\n\n      buffer[bufferCounter++] = '0';\n      buffer[bufferCounter++] = ' ';\n      buffer[bufferCounter++] = '0';\n      buffer[bufferCounter++] = ' ';\n      buffer[bufferCounter++] = '-';\n      buffer[bufferCounter++] = '1';\n      buffer[bufferCounter++] = '\\n';\n\n      for (int i = 1; i &lt; numberOfNodes; i++) {\n        const node_t *const node = &amp;(dij-&gt;nodes[i]);\n\n        number = i;\n\n        digits = getNumberOfDigits(number);\n        counter = bufferCounter;\n\n        do {\n          buffer[counter + digits] = ZERO + number % 10;\n          --digits;\n          ++bufferCounter;\n        } while (number /= 10);\n\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;cost;\n\n        if (number != -1) {\n          digits = getNumberOfDigitsBig(number);\n\n          counter = bufferCounter;\n          do {\n            buffer[counter + digits] = ZERO + number % 10;\n            digits = digits - 1;\n            bufferCounter = bufferCounter + 1;\n          } while (number /= 10);\n        } else {\n          buffer[bufferCounter++] = '-';\n          buffer[bufferCounter++] = '1';\n        }\n\n        buffer[bufferCounter++] = ' ';\n\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;parent;\n\n        if (number != -1) {\n          digits = getNumberOfDigitsBig(number);\n\n          counter = bufferCounter;\n          do {\n            buffer[counter + digits] = ZERO + number % 10;\n            --digits;\n            ++bufferCounter;\n          } while (number /= 10);\n        } else {\n          buffer[bufferCounter++] = '-';\n          buffer[bufferCounter++] = '1';\n        }\n\n        buffer[bufferCounter++] = '\\n';\n      }\n\n      fwrite(buffer, 1, bufferCounter, f);\n\n      ret = fclose(f) == 0;\n      free(buffer);\n    }\n  }\n}\n\nvoid new_save(const char *filename, const dijkstra_t *dijkstra) {\n  int ret;\n  const dijkstra_t *const dij = (dijkstra_t *)dijkstra;\n  char *buffer;\n  if (dij) {\n    FILE *f = fopen(filename, \"w\");\n    if (f) {\n      int numberOfNodes = dij-&gt;num_nodes;\n      long bufferLength = numberOfNodes * (9 * 3 + 3);\n      buffer = (char *)malloc(bufferLength + 1);\n      long bufferCounter = 0;\n\n      int number;\n      int counter;\n      int digits;\n\n      buffer[bufferCounter++] = '0';\n      buffer[bufferCounter++] = ' ';\n      buffer[bufferCounter++] = '0';\n      buffer[bufferCounter++] = ' ';\n      buffer[bufferCounter++] = '-';\n      buffer[bufferCounter++] = '1';\n      buffer[bufferCounter++] = '\\n';\n\n      for (int i = 1; i &lt; numberOfNodes; i++) {\n        const node_t *const node = &amp;(dij-&gt;nodes[i]);\n        int len = getNumberOfDigits(i) + 1;\n\n        gwf_i2a((char *)&amp;buffer[bufferCounter], i, len);\n        bufferCounter += len;\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;cost;\n\n        if (number != -1) {\n          len = getNumberOfDigitsBig(number) + 1;\n          gwf_i2a((char *)&amp;buffer[bufferCounter], number, len);\n          bufferCounter += len;\n\n        } else {\n          buffer[bufferCounter++] = '-';\n          buffer[bufferCounter++] = '1';\n        }\n\n        buffer[bufferCounter++] = ' ';\n\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;parent;\n\n        if (number != -1) {\n          digits = getNumberOfDigitsBig(number);\n\n          counter = bufferCounter;\n          do {\n            buffer[counter + digits] = ZERO + number % 10;\n            --digits;\n            ++bufferCounter;\n          } while (number /= 10);\n        } else {\n          buffer[bufferCounter++] = '-';\n          buffer[bufferCounter++] = '1';\n        }\n\n        buffer[bufferCounter++] = '\\n';\n      }\n\n      fwrite(buffer, 1, bufferCounter, f);\n\n      ret = fclose(f) == 0;\n      free(buffer);\n    }\n  }\n}\nvoid original() {\n  clock_t t;\n  t = clock();\n  save(\"bogus.txt\", data);\n  t = clock() - t;\n  std::cout &lt;&lt; \"original: \" &lt;&lt; t &lt;&lt; \" clicks (\" &lt;&lt; ((float)t) / CLOCKS_PER_SEC\n            &lt;&lt; \" seconds).\" &lt;&lt; std::endl;\n}\nvoid new_test() {\n  clock_t t;\n  t = clock();\n  new_save(\"new_bogus.txt\", data);\n  t = clock() - t;\n  std::cout &lt;&lt; \"NEW: \" &lt;&lt; t &lt;&lt; \" clicks (\" &lt;&lt; ((float)t) / CLOCKS_PER_SEC\n            &lt;&lt; \" seconds).\" &lt;&lt; std::endl;\n}\nint main(int argc, char **argv) {\n  original();\n  new_test();\n\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515750104, "post_id": 48219470, "comment_id": 83428198, "body": "Actually I don&#39;t generate any graph. The only thing I get is txt file with all the edges. My task is to find all the shortest paths from the first node to others. Then I have to save my shortest paths to txt file. Hence, bunkry files are not the option."}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515774026, "post_id": 48219470, "comment_id": 83442400, "body": "I have just commented your comment. I couldn&#39;t understand your reply, because you were definitely writing about smth else. Why did you comment rand()? I don&#39;t use it at all. As I&#39;ve said: the only thing I have to implement is fast saving. I just get the structure with millions of edges and I have to save them to .txt file. You then wrote about binary files (I don&#39;t understand as well, why) that I&#39;m not allowed to use. I&#39;ve run your save code (output_edge() function) and it produced much slower performace. I presume you commented the code of graph creator, but I don&#39;t generate graph at all"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515841178, "post_id": 48219470, "comment_id": 83460708, "body": "@AntonKretov: Now I understand. I saw your original post, then your comment referring to your generator at paste.ofcode.org, and not the edits to your question in between. (I don&#39;t know why, probably connection issues.) Yes, there are many ways to speed up both saving and loading of such graphs in ASCII text form. I&#39;ll rewrite my answer to do only the save, using the structures shown now in your question."}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515858802, "post_id": 48219470, "comment_id": 83465375, "body": "I get segmentation fault while executing your function. After the last prepend_value() it throws such an error"}, {"owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515859177, "post_id": 48219470, "comment_id": 83465489, "body": "I managed to edit your code in order to make it work (the error was in assigning a pointer to the first element in buf to end, you had to point to the last one. But my approach is still faster than yours."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515868640, "post_id": 48219470, "comment_id": 83468566, "body": "@AntonKretov: I don&#39;t believe you. Care to post your benchmark? Note that the way you only issue one <code>fwrite()</code> call, and do not check its return value, you are likely to not be able to write very large arrays at all, because for example Linux limits each single write (and thus <code>fwrite()</code>) to 2&lt;sup&gt;32&lt;/sup&gt;-1 bytes or so. I suspect that your test does not even write all the data to disk, and therefore shows results too good to be true."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "edited": false, "score": 0, "creation_date": 1515870993, "post_id": 48219470, "comment_id": 83469266, "body": "@AntonKretov: Indeed, my own microbenchmark (included above) shows that mine is at least 20% faster (2.8 seconds versus 3.5 seconds to save a graph of 100,000,000 nodes/edges). (For a million nodes/edges, the times are 0.03 seconds versus 0.02 seconds.)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1515870794, "last_edit_date": 1515870794, "creation_date": 1515730564, "answer_id": 48219470, "question_id": 48187296, "link": "https://stackoverflow.com/questions/48187296/the-fastest-way-to-save-graph-to-file-in-c/48219470#48219470", "title": "The fastest way to save graph to file in C", "body": "<p>[Rewritten on 2018-01-13.]\nStandard I/O (<code>printf()</code> etc.) is indeed comparatively slow in converting numerical data to text form. Here, the problem is to output lines of form</p>\n\n<blockquote>\n  <p>&nbsp; &nbsp; <em>&lt;node&gt;</em> <em>&lt;cost&gt;</em> <em>&lt;parent&gt;</em></p>\n</blockquote>\n\n<p>where all three are either unsigned (32-bit) integers in decimal notation, or -1. For simplicity, let's reserve the value <code>UINT32_MAX</code> (4294967295) for <code>-1</code>.</p>\n\n<p>I suggest a two-fold approach:</p>\n\n<ol>\n<li><p>Construct each record from right to left. This avoids the need of checking how many digits there are in a number.</p></li>\n<li><p>Buffer a number of records at once. This reduces the number of <code>fwrite()</code> calls, at the cost of a modest dynamically allocated buffer.</p>\n\n<p>Note that this means that the records in each chunk must be processed last-to-first, in order to retain the correct order.</p></li>\n</ol>\n\n<p>Consider the following code.  Note that I've reduced the definitions of <code>node_t</code> and <code>dijkstra_t</code> to the fields that area actually used, so that the following example can be compiled as-is. Also note that instead of <code>-1</code> for <code>parent</code> or <code>cost</code>, one must use <code>UINT32_MAX</code>, as their types are now <code>uint32_t</code>.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n    uint32_t    parent;     /* Use UINT32_MAX for -1 */\n    uint32_t    cost;       /* Use UINT32_MAX for -1 */\n} node_t;\n\ntypedef struct {\n    node_t     *nodes;\n    uint32_t    num_nodes;\n} dijkstra_t;\n\n/* This function will store an unsigned 32-bit value\n   in decimal form, ending at 'end'.\n   UINT32_MAX will be written as \"-1\", however.\n   Returns a pointer to the start of the value.\n*/\nstatic inline char *prepend_value(char *end, uint32_t value)\n{\n    if (value == UINT32_MAX) {\n        *(--end) = '1';\n        *(--end) = '-';\n    } else {\n        do {\n            *(--end) = '0' + (value % 10u);\n            value /= 10u;\n        } while (value);\n    }\n    return end;\n}\n\n/* Each record consists of three unsigned 32-bit integers,\n   each at most 10 characters, with spaces in between\n   and a newline at end. Thus, at most 33 characters. */\n#define  RECORD_MAXLEN  33\n/* We process records in chunks of 16384.\n   Maximum number of records (nodes) is 2**32 - 2 - RECORD_CHUNK,\n   or 4,294,950,910 in this case. */\n#define  RECORD_CHUNK   16384\n/* Each chunk of record is up to CHUNK_CHARS long.\n   (Roughly half a megabyte in this case.) */\n#define  CHUNK_CHARS   (RECORD_MAXLEN * RECORD_CHUNK)\n\n/* Save the edges in a graph to a stream.\n   Returns 0 if success, -1 if an error occurs.\n*/\nint save_edges(dijkstra_t *dij, FILE *out)\n{\n    if (dij &amp;&amp; out &amp;&amp; !ferror(out)) {\n        const int       nodes = dij-&gt;num_nodes;\n        const node_t   *node  = dij-&gt;nodes;\n\n        const uint32_t  root_parent = dij-&gt;nodes-&gt;parent;\n        const uint32_t  root_cost   = dij-&gt;nodes-&gt;cost;\n\n        char           *buf, *end, *ptr;\n        uint32_t        o;\n\n        /* Allocate memory for the chunk buffer. */\n        buf = malloc(CHUNK_CHARS);\n        if (!buf)\n            return -1;\n\n        end = buf + CHUNK_CHARS;\n\n        /* Temporarily, we reset the root node parent\n           to UINT32_MAX and cost to 0, so that the\n           very first record in the output is \"0 0 -1\". */\n        dij-&gt;nodes-&gt;cost   = 0;\n        dij-&gt;nodes-&gt;parent = UINT32_MAX;\n\n        for (o = 0; o &lt; nodes; o += RECORD_CHUNK) {\n            uint32_t  i = (o + RECORD_CHUNK &lt; nodes) ? o + RECORD_CHUNK : nodes;\n\n            /* Fill buffer back-to-front. */\n            ptr = end;\n            while (i--&gt;o) {\n                const node_t  *curr = node + i;\n\n                /* Format: &lt;i&gt; ' ' &lt;cost&gt; ' ' &lt;parent&gt; '\\n' */\n                /* We construct the record from right to left. */\n\n                *(--ptr) = '\\n';\n                ptr = prepend_value(ptr, curr-&gt;parent);\n                *(--ptr) = ' ';\n                ptr = prepend_value(ptr, curr-&gt;cost);\n                *(--ptr) = ' ';\n                ptr = prepend_value(ptr, i);\n            }\n\n            /* Write the chunk buffer out. */\n            if (fwrite(ptr, 1, (size_t)(end - ptr), out) != (size_t)(end - ptr)) {\n                dij-&gt;nodes-&gt;cost = root_cost;\n                dij-&gt;nodes-&gt;parent = root_parent;\n                free(buf);\n                return -1;\n            }\n        }\n\n        /* Reset root node, and free the buffer. */\n        dij-&gt;nodes-&gt;cost = root_cost;\n        dij-&gt;nodes-&gt;parent = root_parent;\n        free(buf);\n\n        /* Check for write errors. */\n        if (fflush(out))\n            return -1;\n        if (ferror(out))\n            return -1;\n\n        /* Success. */\n        return 0;\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>Additional speedup is possible, if we can use POSIX low-level I/O (<a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\"><code>open()</code></a>, <a href=\"http://man7.org/linux/man-pages/man2/close.2.html\" rel=\"nofollow noreferrer\"><code>close()</code></a>, <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\"><code>write()</code></a>, and <a href=\"http://man7.org/linux/man-pages/man2/fstat.2.html\" rel=\"nofollow noreferrer\"><code>fstat()</code></a> from <code>&lt;unistd.h&gt;</code>). When the destination is a pipe or device, we can just directly write the data; when the destination is a file, we should write in chunks of multiples of <code>st_blksize</code>, to avoid read-modify-write cycles. Unlike standard I/O, with low-level I/O we can do that with just one \"overflow\" buffer of <code>st_blksize</code>, without having to copy the entire chunk buffer around in memory.  However, since the question is not tagged <a href=\"/questions/tagged/posix\" class=\"post-tag\" title=\"show questions tagged &#39;posix&#39;\" rel=\"tag\">posix</a>, I shall refrain from further discussion along those edges.</p>\n\n<hr>\n\n<p>OP stated their own version is still faster. I found that difficult to believe, because it does much more work than my version above. When I checked, on my machine a large dataset (of say 100,000,000) cannot be written in a single <code>fwrite()</code> call, as it only does a partial write; a loop is required to actually write the entire dataset. Therefore, in my opinion, the benchmark OP uses to compare the different version is very suspect.</p>\n\n<p>Consider the following microbenchmark instead. It generates a singly linked list, and uses an externally compiled <code>save_graph()</code> function to output it (to standard output). There are three versions implemented: <em>null</em>, which does not save anything at all; <em>antonkretov</em>, for OP's implementation (adapted to work here); and <em>nominalanimal</em>, for mine.</p>\n\n<p><strong>Makefile</strong>:</p>\n\n<pre><code>CC      := gcc\nCFLAGS  := -std=c99 -O2 -Wall\nLDFLAGS :=\nBINS    := test-null test-antonkretov test-nominalanimal\nNODES   := 100000000\n\n.PHONY: all clean run\n\nall: clean $(BINS)\n\nclean:\n        rm -f $(BINS) *.o\n\n%.o: %.c\n        $(CC) $(CFLAGS) -c $^\n\n\ntest-null: main.o data-null.o\n        $(CC) $(CFLAGS) $^ -o $@\n\ntest-antonkretov: main.o data-antonkretov.o\n        $(CC) $(CFLAGS) $^ -o $@\n\ntest-nominalanimal: main.o data-nominalanimal.o\n        $(CC) $(CFLAGS) $^ -o $@\n\nrun: $(BINS)\n        @echo \"Testing $(NODES) nodes.\"\n        @./test-null $(NODES) &gt; /dev/null\n\n        @echo \"Overhead (nothing saved):\"\n        @bash -c 'time ./test-null $(NODES) &gt; /dev/null'\n        @echo \"\"\n\n        @echo \"Anton Kretov:\"\n        @bash -c 'time ./test-antonkretov $(NODES) &gt; /dev/null'\n        @echo \"\"\n\n        @echo \"Nominal Animal:\"\n        @bash -c 'time ./test-nominalanimal $(NODES) &gt; /dev/null'\n        @echo \"\"\n</code></pre>\n\n<p>Note that this forum converts <kbd>Tab</kbd>s to spaces, and Makefile format requires the indentation to use spaces, so if you copy and paste the above to file, you need to run e.g. <code>sed -e 's|^  *|\\t|' -i Makefile</code> to fix it.</p>\n\n<p><strong>data.h</strong>:</p>\n\n<pre><code>#ifndef   DATA_H\n#define   DATA_H\n#include &lt;stdint.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\n#define  INVALID_COST    UINT32_MAX\n#define  INVALID_PARENT  UINT32_MAX\n\ntypedef struct {\n    uint32_t    parent;     /* Use INVALID_PARENT for -1 */\n    uint32_t    cost;       /* Use INVALID_COST for -1 */\n} node_t;\n\ntypedef struct {\n    node_t     *nodes;\n    uint32_t    num_nodes;\n} dijkstra_t;\n\nint save_graph(dijkstra_t *, FILE *);\n\n#endif /* DATA_H */\n</code></pre>\n\n<p><strong>data-null.c</strong>, for measuring runtime overhead:</p>\n\n<pre><code>#include \"data.h\"\n\nint save_graph(dijkstra_t *dij, FILE *out)\n{\n    /* Does not do anything */\n    return 0;\n}\n</code></pre>\n\n<p><strong>data-antonkretov.c</strong>, version of OP's save routine, for comparison:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include \"data.h\"\n\nint getNumberOfDigits(uint32_t x)\n{\n    if (x &gt;= 10000) {\n        if (x &gt;= 10000000) {\n            if (x &gt;= 100000000) {\n                if (x &gt;= 1000000000)\n                    return 9;\n                return 8;\n            }\n            return 7;\n        }\n        if (x &gt;= 100000) {\n            if (x &gt;= 1000000)\n                return 6;\n            return 5;\n        }\n        return 4;\n    }\n    if (x &gt;= 100) {\n        if (x &gt;= 1000)\n            return 3;\n        return 2;\n    }\n    if (x &gt;= 10)\n        return 1;\n    return 0;\n}\n\nint save_graph(dijkstra_t *dij, FILE *out)\n{\n    uint32_t    numberOfNodes = dij-&gt;num_nodes;\n    size_t      bufferLength = numberOfNodes * (size_t)33;\n    size_t      bufferCounter = 0, counter;\n    size_t      bytes;\n    uint32_t    number, digits, i;\n    char       *buffer;\n\n    if ((size_t)(bufferLength / 33) != numberOfNodes)\n        return -1;\n\n    buffer = malloc(bufferLength);\n    if (!buffer)\n        return -1;\n\n    buffer[bufferCounter++] = '0';\n    buffer[bufferCounter++] = ' ';\n    buffer[bufferCounter++] = '0';\n    buffer[bufferCounter++] = ' ';\n    buffer[bufferCounter++] = '-';\n    buffer[bufferCounter++] = '1';\n    buffer[bufferCounter++] = '\\n';\n\n    for (i = 1; i &lt; numberOfNodes; i++) {\n        const node_t *const node = dij-&gt;nodes + i;\n\n        number = i;\n        digits = getNumberOfDigits(number);\n        counter = bufferCounter;\n        do {\n            buffer[counter + digits] = '0' + (number % 10u);\n            --digits;\n            ++bufferCounter;\n        } while (number /= 10u);\n\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;cost;\n        if (number != UINT32_MAX) {\n            digits = getNumberOfDigits(number);\n            counter = bufferCounter;\n            do {\n                buffer[counter + digits] = '0' + (number % 10u);\n                --digits;\n                ++bufferCounter;\n            } while (number /= 10u);\n        } else {\n            buffer[bufferCounter++] = '-';\n            buffer[bufferCounter++] = '1';\n        }\n\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;parent;\n        if (number != UINT32_MAX) {\n            digits = getNumberOfDigits(number);\n            counter = bufferCounter;\n            do {\n                buffer[counter + digits] = '0' + (number % 10u);\n                --digits;\n                ++bufferCounter;\n            } while (number /= 10u);\n        } else {\n            buffer[bufferCounter++] = '-';\n            buffer[bufferCounter++] = '1';\n        }\n\n        buffer[bufferCounter++] = '\\n';\n    }\n\n    counter = 0;\n    while (counter &lt; bufferCounter) {\n        bytes = fwrite(buffer + counter, 1, bufferCounter - counter, out);\n        if (!bytes) {\n            free(buffer);\n            return -1;\n        }\n        counter += bytes;\n    }\n\n    free(buffer);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>data-nominalanimal.c</strong>, my chunked back-to-front version of the save routine:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include \"data.h\"\n\n/* This function will store an unsigned 32-bit value\n   in decimal form, ending at 'end'.\n   UINT32_MAX will be written as \"-1\", however.\n   Returns a pointer to the start of the value.\n*/\nstatic inline char *prepend_value(char *end, uint32_t value)\n{\n    if (value == UINT32_MAX) {\n        *(--end) = '1';\n        *(--end) = '-';\n    } else {\n        do {\n            *(--end) = '0' + (value % 10u);\n            value /= 10u;\n        } while (value);\n    }\n    return end;\n}\n\n/* Each record consists of three unsigned 32-bit integers,\n   each at most 10 characters, with spaces in between\n   and a newline at end. Thus, at most 33 characters. */\n#define  RECORD_MAXLEN  33\n/* We process records in chunks of 16384.\n   Maximum number of records (nodes) is 2**32 - 2 - RECORD_CHUNK,\n   or 4,294,950,910 in this case. */\n#define  RECORD_CHUNK   16384\n/* Each chunk of record is up to CHUNK_CHARS long.\n   (Roughly half a megabyte in this case.) */\n#define  CHUNK_CHARS   (RECORD_MAXLEN * RECORD_CHUNK)\n\n/* Save the edges in a graph to a stream.\n   Returns 0 if success, -1 if an error occurs.\n*/\nint save_graph(dijkstra_t *dij, FILE *out)\n{\n    if (dij &amp;&amp; out &amp;&amp; !ferror(out)) {\n        const int       nodes = dij-&gt;num_nodes;\n        const node_t   *node  = dij-&gt;nodes;\n\n        const uint32_t  root_parent = dij-&gt;nodes-&gt;parent;\n        const uint32_t  root_cost   = dij-&gt;nodes-&gt;cost;\n\n        char           *buf, *end, *ptr;\n        uint32_t        o;\n\n        /* Allocate memory for the chunk buffer. */\n        buf = malloc(CHUNK_CHARS);\n        if (!buf)\n            return -1;\n\n        end = buf + CHUNK_CHARS;\n\n        /* Temporarily, we reset the root node parent\n           to UINT32_MAX and cost to 0, so that the\n           very first record in the output is \"0 0 -1\". */\n        dij-&gt;nodes-&gt;cost   = 0;\n        dij-&gt;nodes-&gt;parent = UINT32_MAX;\n\n        for (o = 0; o &lt; nodes; o += RECORD_CHUNK) {\n            uint32_t  i = (o + RECORD_CHUNK &lt; nodes) ? o + RECORD_CHUNK : nodes;\n\n            /* Fill buffer back-to-front. */\n            ptr = end;\n            while (i--&gt;o) {\n                const node_t  *curr = node + i;\n\n                /* Format: &lt;i&gt; ' ' &lt;cost&gt; ' ' &lt;parent&gt; '\\n' */\n                /* We construct the record from right to left. */\n                *(--ptr) = '\\n';\n                ptr = prepend_value(ptr, curr-&gt;parent);\n                *(--ptr) = ' ';\n                ptr = prepend_value(ptr, curr-&gt;cost);\n                *(--ptr) = ' ';\n                ptr = prepend_value(ptr, i);\n            }\n\n            /* Write buffer. */\n            if (fwrite(ptr, 1, (size_t)(end - ptr), out) != (size_t)(end - ptr)) {\n                dij-&gt;nodes-&gt;cost = root_cost;\n                dij-&gt;nodes-&gt;parent = root_parent;\n                free(buf);\n                return -1;\n            }\n        }\n\n        /* Reset root node, and free the buffer. */\n        dij-&gt;nodes-&gt;cost = root_cost;\n        dij-&gt;nodes-&gt;parent = root_parent;\n        free(buf);\n\n        if (fflush(out))\n            return -1;\n        if (ferror(out))\n            return -1;\n\n        return 0;\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>and finally the main program itself, <strong>main.c</strong>, that generates the data and calls the <code>save_graph()</code> functions:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;string.h&gt;\n#include \"data.h\"\n\n#define  EDGES_MAX  4294901759\n\nint main(int argc, char *argv[])\n{\n    dijkstra_t graph;\n    size_t     bytes;\n    uint32_t   edges, i;\n    char       dummy;\n\n    if (argc != 2 || !strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\")) {\n        fprintf(stderr, \"\\nUsage: %s EDGES\\n\\n\", argv[0]);\n        return EXIT_SUCCESS;\n    }\n    if (sscanf(argv[1], \" %\" SCNu32 \" %c\", &amp;edges, &amp;dummy) != 1 || edges &lt; 1 || edges &gt; EDGES_MAX) {\n        fprintf(stderr, \"%s: Invalid number of edges.\\n\", argv[1]);\n        return EXIT_FAILURE;\n    }\n\n    bytes = (1 + (size_t)edges) * sizeof graph.nodes[0];\n    if ((size_t)(bytes / (1 + (size_t)edges)) != sizeof graph.nodes[0]) {\n        fprintf(stderr, \"%s: Too many edges.\\n\", argv[1]);\n        return EXIT_FAILURE;\n    }\n    graph.num_nodes = edges + 1;\n    graph.nodes = malloc(bytes);\n    if (!graph.nodes) {\n        fprintf(stderr, \"%s: Too many edges: out of memory.\\n\", argv[1]);\n        return EXIT_FAILURE;\n    }\n\n    /* Generate a graph; no randomness, to keep timing steady. */\n    graph.nodes[0].parent = INVALID_COST;\n    graph.nodes[0].cost = 0;\n    for (i = 1; i &lt;= edges; i++) {\n        graph.nodes[i].parent = i - 1;\n        graph.nodes[i].cost = 1 + (i % 10);\n    }\n\n    /* Print graph. */\n    if (save_graph(&amp;graph, stdout)) {\n        fprintf(stderr, \"Write error!\\n\");\n        return EXIT_FAILURE;\n    }\n\n    /* Done. */\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Running <code>make clean run</code> (or <code>make NODES=100000000 clean run</code>) recompiles the benchmarks, and measures their run time, for a graph with 100,000,000 nodes. On my machine, the output is</p>\n\n<pre><code>Testing 100000000 nodes.\nOverhead (nothing saved):\n\nreal0m0.514s\nuser0m0.297s\nsys0m0.217s\n\nAnton Kretov:\n\nreal0m4.059s\nuser0m3.379s\nsys0m0.680s\n\nNominal Animal:\n\nreal0m3.336s\nuser0m3.151s\nsys0m0.184s\n</code></pre>\n\n<p>which shows that mine is significantly faster. If we ignore the overhead (of generating the graph), mine took about 2.8 seconds of real time to save the data to <code>/dev/null</code>, whereas OP's took about 3.5 seconds. In other words, mine shows a 20% speed improvement.</p>\n\n<p>It is important to note that both tests do produce the exact same output. For example, both <code>./test-nominalanimal 100000000 | sha256sum -</code> and <code>./test-antonkretov 100000000 | sha256sum -</code> show the exact same SHA256 checksums, <code>7504a1c97167701297c03c4aab8b0f20c5cac82a50128074d6e09c474353d0f8</code>.\n(You can also save the output to a file, and compare them; both are exactly  1,987,777,795 bytes long, and contain the exact same data. I did check.)</p>\n\n<p>If you want to run a benchmark that stores the data to storage, for the comparisons to be fair, you need to start with cold caches. Otherwise the order in which you run the benchmarks will heavily impact their timings.</p>\n"}], "owner": {"reputation": 41, "user_id": 4430163, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007191840241/picture?type=large", "display_name": "Anton Kretov", "link": "https://stackoverflow.com/users/4430163/anton-kretov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1515870794, "creation_date": 1515586510, "last_edit_date": 1515590760, "question_id": 48187296, "link": "https://stackoverflow.com/questions/48187296/the-fastest-way-to-save-graph-to-file-in-c", "title": "The fastest way to save graph to file in C", "body": "<p>I have such a problem: I need to save a large graph with > million edges to txt file. Each edge is represented with a structure containing 3 integers: from, to, cost. My task is to write a program that will fastly save the whole graph to txt file in such format: \"from to cost\\n\".</p>\n\n<p>I am interested in the method, how to do that.\nMy idea is in creating a huge buffer of chars, where I add each digit to the buffer without the need to reverse then (first of all I get the number of digits of each integer, then add each digit to the buffer, then I add whitespace/new line symbol and do it until the last number is added.</p>\n\n<p>Then I save the whole buffer to file by using fwrite() function.</p>\n\n<p>Despite the fact that this method is relatively fast, I saw programs that do it faster. My question is: do you know more efficient way to implement this program in order to get faster results?</p>\n\n<p>The program must be in C language.</p>\n\n<pre><code>typedef struct {\n   int edge_start; \n   int edge_count; \n   int parent; \n   int cost; \n} node_t;\n\ntypedef struct {\n   graph_t *graph;\n   node_t *nodes;\n   int num_nodes; \n   int start_node; \n} dijkstra_t;\n</code></pre>\n\n<p>The function to get the number of digits:</p>\n\n<pre><code>int getNumberOfDigitsBig(int x) {\n  if (x &gt;= 10000) {\n        if (x &gt;= 10000000) {\n            if (x &gt;= 100000000) {\n                if (x &gt;= 1000000000)\n                    return 9;\n                return 8;\n            }\n            return 7;\n        }\n        if (x &gt;= 100000) {\n            if (x &gt;= 1000000)\n                return 6;\n            return 5;\n        }\n        return 4;\n    }\n    if (x &gt;= 100) {\n        if (x &gt;= 1000)\n            return 3;\n        return 2;\n    }\n    if (x &gt;= 10)\n        return 1;\n    return 0;\n}\n</code></pre>\n\n<p>Save function:</p>\n\n<pre><code>    const dijkstra_t *const dij = (dijkstra_t*)dijkstra;\n\n    if (dij) {\n    FILE *f = fopen(filename, \"w\");\n    if (f) {\n\n    int numberOfNodes = dij-&gt;num_nodes;\n    long bufferLength = numberOfNodes * (9 * 3 + 3);\n    buffer = (char *)malloc(bufferLength + 1);\n    long bufferCounter = 0;\n\n    int number;\n    // printf(\"i = %d\\n\", number);\n    int counter;\n    int digits;\n\n    buffer[bufferCounter++] = '0';\n    buffer[bufferCounter++] = ' ';\n    buffer[bufferCounter++] = '0';\n    buffer[bufferCounter++] = ' ';\n    buffer[bufferCounter++] = '-';\n    buffer[bufferCounter++] = '1';\n    buffer[bufferCounter++] = '\\n';\n\n    for(int i = 1; i &lt; numberOfNodes; i++) {\n        const node_t *const node = &amp;(dij-&gt;nodes[i]);\n\n        number = i;\n\n         digits = getNumberOfDigits(number);\n         counter = bufferCounter;\n\n         do {\n           buffer[counter + digits] = ZERO + number % 10;\n           --digits;\n           ++bufferCounter;\n         } while(number /= 10);\n\n       buffer[bufferCounter++] = ' ';\n\n       number = node-&gt;cost;\n\n       if(number != -1) {\n\n         digits = getNumberOfDigitsBig(number);\n\n         counter = bufferCounter;\n         do {\n           buffer[counter + digits] = ZERO + number % 10;\n           digits = digits - 1;\n           bufferCounter = bufferCounter + 1;\n         } while(number /= 10);\n       } else {\n         buffer[bufferCounter++] = '-';\n         buffer[bufferCounter++] = '1';\n\n       } \n\n      buffer[bufferCounter++] = ' ';\n\n        buffer[bufferCounter++] = ' ';\n\n        number = node-&gt;parent;\n\n        if(number != -1) {\n\n            digits = getNumberOfDigitsBig(number);\n\n            counter = bufferCounter;\n            do {\n                buffer[counter + digits] = ZERO + number % 10;\n                --digits;\n                ++bufferCounter;\n            } while(number /= 10);\n        } else {\n              buffer[bufferCounter++] = '-';\n              buffer[bufferCounter++] = '1';\n\n        }\n\n        buffer[bufferCounter++] = '\\n';\n\n    }\n\n  fwrite(buffer, 1, bufferCounter, f);\n\n  ret = fclose(f) == 0;\n  free(buffer);\n  }\n }\n</code></pre>\n\n<p>Thanks for attention. </p>\n"}, {"tags": ["c", "pipe", "fork", "ipc"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1515583113, "post_id": 48186152, "comment_id": 83352115, "body": "Why global ? why open a file ? why ignore return value ? The manual of <a href=\"https://linux.die.net/man/2/pipe\" rel=\"nofollow noreferrer\"><code>pipe()</code></a> give an exemple code that almost do what you need... did you read the manual before use a function ?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1515585886, "post_id": 48186152, "comment_id": 83353648, "body": "@Nicholas Goncharov  It is much better when the entire profile is written in English.:)"}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1515585380, "post_id": 48186572, "comment_id": 83353348, "body": "Thank you for this code snippet, which might provide some limited short-term help.  A proper explanation <a href=\"//meta.stackexchange.com/q/114762\">would greatly improve</a> its long-term value by showing <i>why</i> this is a good solution to the problem, and would make it more useful to future readers with other, similar questions.  Please <a href=\"https://stackoverflow.com/posts/48186572/edit\">edit</a> your answer to add some explanation, including the assumptions you&#39;ve made."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1515587330, "post_id": 48186572, "comment_id": 83354604, "body": "@TobySpeight First a meta about stackoverflow will be more useful... I don&#39;t understand why you link a question of meta.stackexchange.com. Secondly, I decide to not explain a self explain code. There are a lot of other question about how work <code>pipe()</code> or <code>fork()</code>, this is not what OP ask, &quot;Write numbers from 1 to 100 using fork() and pipe()&quot;, I literally answer the question, the OP as show me some work, I think that deserve some help. Downvote me or not I don&#39;t think code only answer are bad, If I really need to explain this code I will end by explain C, that will take too many time."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1515587451, "post_id": 48186572, "comment_id": 83354688, "body": "By the way, I don&#39;t think my solution is &quot;perfect&quot;, it&#39;s just a possible solution. By the way, I didn&#39;t make the code produce the exact solution on purpose ;)."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1515587886, "post_id": 48186572, "comment_id": 83354930, "body": "@Stargateur: as you don&#39;t provide any explaination on the code, it is not evident at first sight that it does not meet one OP&#39;s requirement: <i>2 processes, where one writes even numbers and <b>another</b> writes uneven numbers</i>. And no, code without a single comment is not <i>self explain</i> code."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1515588262, "post_id": 48186572, "comment_id": 83355142, "body": "@SergeBallesta I didn&#39;t say self documented, but self explained... Whatever, I already tired of this, you make me realize that OP describe a totally different behavior in the question and in the title, This question require IPC and I don&#39;t want to answer a question about this mess."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 1, "last_activity_date": 1515590127, "last_edit_date": 1515590127, "creation_date": 1515584098, "answer_id": 48186572, "question_id": 48186152, "link": "https://stackoverflow.com/questions/48186152/write-numbers-from-1-to-100-using-fork-and-pipe/48186572#48186572", "title": "Write numbers from 1 to 100 using fork() and pipe()", "body": "<p>You need 2 pipes, when a process had write the number, it will write some data to one pipe so the other process will know that it can write his own number, etc.</p>\n\n<p>Exemple of implementation:</p>\n\n<pre><code>#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(void) {\n  int parent_to_child[2];\n  int child_to_parent[2];\n  if (pipe(parent_to_child) == -1 || pipe(child_to_parent) == -1) {\n    perror(\"pipe\");\n    return EXIT_FAILURE;\n  }\n  pid_t cpid = fork();\n  if (cpid == -1) {\n    perror(\"fork\");\n    return EXIT_FAILURE;\n  }\n  if (cpid == 0) {\n    close(parent_to_child[1]);\n    close(child_to_parent[0]);\n\n    int i = 1;\n    bool buf;\n    ssize_t ret;\n    while ((ret = read(parent_to_child[0], &amp;buf, sizeof buf)) &gt; 0) {\n      fprintf(stdout, \"%d \", i);\n      fflush(stdout);\n      if (write(child_to_parent[1], &amp;buf, sizeof buf) != sizeof buf) {\n        break;\n      }\n      i += 2;\n    }\n\n    close(parent_to_child[0]);\n    close(child_to_parent[1]);\n  } else {\n    close(parent_to_child[0]);\n    close(child_to_parent[1]);\n\n    int i = 2;\n    bool buf = true;\n    ssize_t ret;\n    while (i &lt;= 100 &amp;&amp;\n           write(parent_to_child[1], &amp;buf, sizeof buf) == sizeof buf &amp;&amp;\n           (ret = read(child_to_parent[0], &amp;buf, sizeof buf)) &gt; 0) {\n      fprintf(stdout, i != 100 ? \"%d \" : \"%d\\n\", i);\n      fflush(stdout);\n      i += 2;\n    }\n\n    close(parent_to_child[1]);\n    close(child_to_parent[0]);\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1515590108, "creation_date": 1515590108, "answer_id": 48188332, "question_id": 48186152, "link": "https://stackoverflow.com/questions/48186152/write-numbers-from-1-to-100-using-fork-and-pipe/48188332#48188332", "title": "Write numbers from 1 to 100 using fork() and pipe()", "body": "<p>If you want to use pipes to synchronize 2 processes, you really should use a pair of pipes, the former read by proc1 and written by proc2, the latter read by proc2 and written by proc1. From there you pass the read and write handles to <code>printProc</code> and that is all.</p>\n\n<p>But there is another problem in your code: you open an output file in both processes in buffered mode (with <code>fopen</code>). So each process will have its own buffer. Both buffers will be fed separetely and only written to file at close time, which is not what you want: you must open the output file before the fork, and use it in non buffered mode.</p>\n\n<p>So your code could become:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\n\nint printProc(int startNumber, FILE *f, int fdin, int fdout);\n\nint main()\n{\n    pid_t childpid;\n    int fd[4];\n    FILE *f;\n\n    pipe(fd);\n    pipe(fd + 2);\n    int start = 0;\n    write(fd[0], &amp;start, sizeof(start));\n    f = fopen(\"output.txt\", \"w\");\n    if (f == NULL) {\n        perror(\"Error opening file\");\n        return 1;\n    }\n    setbuf(f, NULL);             // use unbuffered mode for output.txt\n\n    if ((childpid = fork()) == -1)\n    {\n        perror(\"fork\");\n    }\n\n    if (childpid == 0)\n    {\n        printf(\"run child\\n\");\n\n        printProc(1, f, fd[1], fd[2]);\n    }\n    else\n    {\n        printf(\"run parent\\n\");\n\n        printProc(2, f, fd[3], fd[0]);\n    }\n    fclose(f);\n    return 0;\n}\n\nint printProc(int num, FILE *f, int fdin, int fdout)\n{\n    int proc;\n\n    while (num &lt;= 100)\n    {\n        read(fdin, &amp;proc, sizeof(proc));\n\n        fprintf(f, \"%d\\n\", num);\n        num = num + 2;\n        write(fdout, &amp;proc, sizeof(proc));\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515596275, "post_id": 48188979, "comment_id": 83360349, "body": "look like these feature are not enable everywhere, <a href=\"http://rextester.com/MBCTYE81393\" rel=\"nofollow noreferrer\">rextester.com/MBCTYE81393</a> don&#39;t work but your code work on my machine. maybe your code will improve by adding error checking."}, {"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515597507, "post_id": 48188979, "comment_id": 83361190, "body": "Thanks for pointing it out @Stargateur, sure this code could be improved in a lot of ways, but I wanted to share minimal example which worked for me."}], "tags": [], "owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "is_accepted": false, "score": 2, "last_activity_date": 1515592394, "creation_date": 1515592394, "answer_id": 48188979, "question_id": 48186152, "link": "https://stackoverflow.com/questions/48186152/write-numbers-from-1-to-100-using-fork-and-pipe/48188979#48188979", "title": "Write numbers from 1 to 100 using fork() and pipe()", "body": "<p>I would suggest to use a mutex here. Your critical section would consist of three operations:</p>\n\n<ul>\n<li>checking if it's your turn to write</li>\n<li>if above is true, write to output</li>\n<li>if you wrote to output, signal the other process that it's his turn</li>\n</ul>\n\n<p>Here is the code that achieves that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;sys/mman.h&gt;\n\nint main() {\n    pthread_mutex_t *pmutex;\n    short * even;\n    pthread_mutexattr_t attrmutex;\n\n    pthread_mutexattr_init(&amp;attrmutex);\n    pthread_mutexattr_setpshared(&amp;attrmutex, PTHREAD_PROCESS_SHARED);\n\n    pmutex = mmap(NULL, sizeof(pthread_mutex_t), PROT_READ | PROT_WRITE, MAP_SHARED | MAP_ANONYMOUS, -1, 0);\n    even = mmap(NULL, sizeof(short), PROT_READ | PROT_WRITE, MAP_SHARED | MAP_ANONYMOUS, -1, 0);\n\n    pthread_mutex_init(pmutex, &amp;attrmutex);\n\n\n    pthread_mutex_lock(pmutex);\n\n    *even = 0;\n\n    if(fork() == 0){\n        int a = 2;\n\n        while(a &lt;= 100) {\n            pthread_mutex_lock(pmutex);\n            if(*even) {\n                printf(\"%d\\n\", a);\n                *even = 0;\n                a = a + 2;\n            }\n            pthread_mutex_unlock(pmutex);\n        }\n\n        return 0;\n    }else {\n        int a = 1;\n\n        printf(\"%d\\n\", a);\n        *even = 1;\n        pthread_mutex_unlock(pmutex);\n        a = a + 2;\n        while(a &lt;= 99) {\n            pthread_mutex_lock(pmutex);\n            if(!*even) {\n                printf(\"%d\\n\", a);\n                *even = 1;\n                a = a + 2;\n            }\n            pthread_mutex_unlock(pmutex);\n        }\n\n    }\n\n    pthread_mutex_destroy(pmutex);\n    pthread_mutexattr_destroy(&amp;attrmutex);\n}\n</code></pre>\n\n<p>Both processes share two variables: <code>pmutex</code> (for synchronisation) and <code>even</code> (for checking which process is allowed to print).</p>\n"}], "owner": {"reputation": 287, "user_id": 5653482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYtkW.jpg?s=128&g=1", "display_name": "Claus Stolz", "link": "https://stackoverflow.com/users/5653482/claus-stolz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 48186572, "answer_count": 3, "score": 1, "last_activity_date": 1515592394, "creation_date": 1515582761, "last_edit_date": 1515588475, "question_id": 48186152, "link": "https://stackoverflow.com/questions/48186152/write-numbers-from-1-to-100-using-fork-and-pipe", "title": "Write numbers from 1 to 100 using fork() and pipe()", "body": "<p>I need to write a program with 2 processes, where one writes even numbers and another writes uneven numbers. In the result, I must have numbers in order from 1 to 100.</p>\n\n<p>I type this code, but when it came to processes part, it got stuck in the <code>printProc()</code> function. I guess the problem is in reading and writing in the pipe.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\nint fd[2];\n\nint printProc(int startNumber, int procNumber);\n\nint main()\n{\n    pid_t childpid;\n\n    pipe(fd);\n    int start = 0;\n    write(fd[0], &amp;start, sizeof(start));\n\n    if ((childpid = fork()) == -1)\n    {\n        perror(\"fork\");\n    }\n\n    if (childpid == 0)\n    {\n        printf(\"run child\\n\");\n\n        printProc(1, 0);\n    }\n    else\n    {\n        printf(\"run parent\\n\");\n\n        printProc(2, 1);\n    }\n\n    return 0;\n}\n\nint printProc(int startNumber, int procNumber)\n{\n    FILE *f;\n    f = fopen(\"output.txt\", \"a+\");\n\n    int num = startNumber;\n    int proc;\n\n    while (num &lt;= 100)\n    {\n        read(fd[1], &amp;proc, sizeof(proc));\n\n        if (proc == procNumber)\n        {\n            fprintf(f, \"%d\", num);\n            num = num + 2;\n            proc = (proc + 1) % 2;\n            write(fd[0], &amp;proc, sizeof(proc));\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1515580907, "post_id": 48185491, "comment_id": 83350856, "body": "ANSI C is the <i>current</i> C. I assume you mean the colloquial for C89. Your code is valid C99 and C11. It&#39;s invalid C89."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1515581331, "post_id": 48185491, "comment_id": 83351104, "body": "What is C98, please?"}, {"owner": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "edited": false, "score": 0, "creation_date": 1515581944, "post_id": 48185491, "comment_id": 83351489, "body": "C89 means the C Standard published(?) in that year (it might be the proposal year).  Basically its the version of the C Standard."}, {"owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "edited": false, "score": 1, "creation_date": 1515582055, "post_id": 48185491, "comment_id": 83351556, "body": "Typo: C89 (fixed)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1515585439, "post_id": 48185491, "comment_id": 83353373, "body": "@StoryTeller No, &quot;ANSI C&quot; is C89. ANSI have had <i>nothing</i> to do with the C language since the year 1989. ANSI does not even publish national software standards any longer, that is handled by another American institute called INCITS. The C language is specified by an international ISO/IEC standard, ISO 9899. In USA <i>only</i>, this standard is called INCITS/ISO/IEC 9899-2012."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515585722, "post_id": 48185491, "comment_id": 83353553, "body": "@Lundin - ANSI ratified C11, so technically, ANSI C <i>is</i> C11."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1515585759, "post_id": 48185491, "comment_id": 83353573, "body": "@StoryTeller They did not. INCITS did. As did any other national standard institute in the world, through their working groups. Should I go around and call it &quot;SS C&quot; because I live in Sweden?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515585979, "post_id": 48185491, "comment_id": 83353706, "body": "@Lundin - Are we arguing the meaning of &quot;ratified&quot; now? They officially adopted it. That&#39;s what they consider &quot;C&quot;. So yes, call it &quot;SS C&quot; if you want. The phrasing does not imply ownership, only association."}, {"owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515586179, "post_id": 48185491, "comment_id": 83353826, "body": "@Lundin @StoryTeller - Sorry to have caused a disagreement between you two about the correct use of <code>ANSI</code>. Perhaps a citation from either one of you can settle the dispute, but please note that doing so was not the point of my question. I am happy with the notion that <code>ANSI</code> is a vague term in this context."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515586634, "post_id": 48185491, "comment_id": 83354137, "body": "It can easily be settled by acknowledging that ANSI and INCITS are <i>American national standard institutes</i> and Stack Overflow is an <i>international</i> site. We don&#39;t care about anything but international standards here, period."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1515586817, "post_id": 48185491, "comment_id": 83354263, "body": "@Lundin - Rubbish. You may have that opinion, and I don&#39;t discount it&#39;s validity. But &quot;you&quot; is not &quot;we&quot;. And that is not something SO will ever take a stance on formally."}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "edited": false, "score": 0, "creation_date": 1515581451, "post_id": 48185637, "comment_id": 83351178, "body": "Thanks, I made a typo in my original question. It was meant to read &quot;C89&quot;, but I think you guessed as much."}, {"owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "edited": false, "score": 0, "creation_date": 1515581610, "post_id": 48185637, "comment_id": 83351280, "body": "Also, asking if the same applies for the other loop / conditional cases was a bit a stupid (side-)question on my part."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "edited": false, "score": 0, "creation_date": 1515581678, "post_id": 48185637, "comment_id": 83351323, "body": "&quot;ANSI C&quot; is slightly ambigous. I am never sure whether it&#39;s referring the <i>current</i> standard (C11) or the C89 (usually people refer it as &quot;ANSI C&quot;). So it&#39;s better to avoid it IMHO. Yes, I understood your question and hopeuflly I have answered it!"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 4, "last_activity_date": 1515581158, "creation_date": 1515581158, "answer_id": 48185637, "question_id": 48185491, "link": "https://stackoverflow.com/questions/48185491/ansi-c-scope-of-variables/48185637#48185637", "title": "ANSI C - scope of variables", "body": "<blockquote>\n  <p>Does variable j need to be declared at the start of the function? </p>\n</blockquote>\n\n<p>Yes, if you are using C89. Or, at least you'd need to introduce a scope with <code>{ ..}</code> and declare it.</p>\n\n<blockquote>\n  <p>Does the same apply for while() and if()? And what about do.. while() ?</p>\n</blockquote>\n\n<p>The syntax doesn't permit declaring variables in (i.e., <code>while (int i = 0)</code> isn't valid) them. But you can declare <em>insde</em> them which is allowed in all C standards.</p>\n\n<blockquote>\n  <p>Do the rules of scope differ between C98 and C99 or later?</p>\n</blockquote>\n\n<p>There's no C98 but yes the rules changed in C99 and later and allows you declare variables in the <code>for</code> loop (as you have in your code).</p>\n\n<blockquote>\n  <p>Is the following code ANSI C compliant?</p>\n</blockquote>\n\n<p>That depends on what \"ANSI C\" refers to. It's valid in C99 and later.</p>\n"}, {"comments": [{"owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "edited": false, "score": 0, "creation_date": 1515581929, "post_id": 48185822, "comment_id": 83351478, "body": "Re: Yeah. I feel stupid suggesting the same might apply for <code>while()</code> and <code>do... while()</code>. Or even <code>if()</code> for that matter."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "edited": false, "score": 0, "creation_date": 1515584669, "post_id": 48185822, "comment_id": 83352920, "body": "@iwarv You shouldn&#39;t. Being able to do e.g. <code>if((Handle h = OpenSomething(..)) != HANDLE_INVALID) { ...</code> would be awesome, in my opinion."}, {"owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1515584914, "post_id": 48185822, "comment_id": 83353070, "body": "@unwind Pretty much all companies I have ever worked for strictly prohibit such compounded statements in their coding standards, perhaps for the right reasons. But a good point. I feel a little less stupid. Thanks."}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1515581679, "creation_date": 1515581679, "answer_id": 48185822, "question_id": 48185491, "link": "https://stackoverflow.com/questions/48185491/ansi-c-scope-of-variables/48185822#48185822", "title": "ANSI C - scope of variables", "body": "<p><code>&gt;&gt; My understanding is that for() implicitly starts a new scope. That is; even before the opening brace.</code></p>\n\n<p>Correct.\nFrom <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.8.5p5\" rel=\"nofollow noreferrer\">C11 standards#6.8.5p5 Iteration statements</a></p>\n\n<blockquote>\n  <p>An iteration statement is a block whose scope is a strict subset of the scope of its enclosing block. The loop body is also a block whose scope is a strict subset of the scope of the iteration statement.</p>\n</blockquote>\n\n<p>This holds true for <a href=\"http://port70.net/~nsz/c/c99/n1256.pdf\" rel=\"nofollow noreferrer\">C99</a> as well.</p>\n\n<p><code>&gt;&gt; Does the same apply for while() and if()? And what about do.. while() ?</code></p>\n\n<p>In <code>if()</code>, <code>while()</code> and <code>do..while()</code> loops you can not declare the variable like <code>if (int j = 0)</code> or <code>while(int j = 0)</code>.</p>\n"}], "owner": {"reputation": 235, "user_id": 6224553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/076Q9.png?s=128&g=1", "display_name": "iwarv", "link": "https://stackoverflow.com/users/6224553/iwarv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 48185637, "answer_count": 2, "score": 2, "last_activity_date": 1515581968, "creation_date": 1515580767, "last_edit_date": 1515581968, "question_id": 48185491, "link": "https://stackoverflow.com/questions/48185491/ansi-c-scope-of-variables", "title": "ANSI C - scope of variables", "body": "<p>C++ programmer here, recently been roped in to do some C programming.\nLooking for a refresher on the rules of variable scope in ANSI C compliant code.</p>\n\n<p>Is the following code ANSI C compliant?</p>\n\n<pre><code>void foo_func(void)\n{\n    int i = 0;\n\n    printf(\"i = %d\\n\", i);\n\n    for (int j = 0; j &lt; 10; ++j) {\n       printf(\"j = %d\\n\", j);\n    }\n}\n</code></pre>\n\n<p>Does variable <code>j</code> need to be declared at the start of the function?\nMy understanding is that <code>for()</code> implicitly starts a new scope. That is; even before the opening brace.</p>\n\n<p>Does the same apply for <code>while()</code> and <code>if()</code>?\nAnd what about <code>do.. while()</code> ?</p>\n\n<p>Do the rules of scope differ between C89 and C99 or later?</p>\n"}, {"tags": ["c", "ssl", "debian", "libcurl"], "owner": {"reputation": 105, "user_id": 7186181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/86f319915cf11a0539484fd0ddb94f50?s=128&d=identicon&r=PG&f=1", "display_name": "cuihaikuo", "link": "https://stackoverflow.com/users/7186181/cuihaikuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1544807561, "creation_date": 1515578642, "last_edit_date": 1544807561, "question_id": 48184807, "link": "https://stackoverflow.com/questions/48184807/problem-with-the-ssl-ca-cert-path-access-rights-on-debian", "title": "Problem with the SSL CA cert (path? access rights?) on Debian", "body": "<p>I wrote a program to test libcurl in C, here is the code:</p>\n\n<pre><code>#include &lt;curl/curl.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n    int ret;\n    static char buf[10000];\n    CURL *curl = curl_easy_init();\n    if(curl) {\n            curl_easy_setopt(curl, CURLOPT_URL, \"https://www.baidu.com\");\n            curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, buf);\n            curl_easy_setopt(curl, CURLOPT_CAINFO, \"/etc/ssl/certs/ca-certificates.crt\");\n\n            ret = curl_easy_perform(curl);\n            if (ret == CURLE_OK)\n                    printf(\"OK\\n\");\n            else {\n                    size_t len = strlen(buf);\n                    fprintf(stderr, \"\\nlibcurl: (%d) \", ret);\n                    if(len)\n                            fprintf(stderr, \"%s%s\", buf,\n                                    ((buf[len - 1] != '\\n') ? \"\\n\" : \"\"));\n                    else\n                            fprintf(stderr, \"%s\\n\", curl_easy_strerror(ret));\n                    }\n            curl_easy_cleanup(curl);\n    }\n}\n</code></pre>\n\n<p>This code works fine with CentOS, but throw \"Problem with the SSL CA cert (path? access rights?)\" on debian, the CA file I specified is right and can be read, and when I run <code>curl -v https://www.baidu.com</code> in terminal, it shows </p>\n\n<pre><code>* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n    CApath: /etc/ssl/certs\n</code></pre>\n\n<p>should I do some other steps when using Debian?</p>\n"}, {"tags": ["c", "optimization", "encode", "compiler-optimization", "endianness"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515576452, "post_id": 48184070, "comment_id": 83347885, "body": "Can you rely on the x being little endian?"}, {"owner": {"reputation": 3416, "user_id": 2484972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea1c4b2c5aa3c7da2f2740bc1a643ee0?s=128&d=identicon&r=PG", "display_name": "Tatsuyuki Ishi", "link": "https://stackoverflow.com/users/2484972/tatsuyuki-ishi"}, "edited": false, "score": 0, "creation_date": 1515576678, "post_id": 48184070, "comment_id": 83348061, "body": "<a href=\"https://godbolt.org/g/hWiiQb\" rel=\"nofollow noreferrer\">godbolt.org/g/hWiiQb</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515576777, "post_id": 48184070, "comment_id": 83348130, "body": "I disagree with the duplicate. OP does not seem to intend bit-reversal, only byte-reversal."}, {"owner": {"reputation": 3416, "user_id": 2484972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea1c4b2c5aa3c7da2f2740bc1a643ee0?s=128&d=identicon&r=PG", "display_name": "Tatsuyuki Ishi", "link": "https://stackoverflow.com/users/2484972/tatsuyuki-ishi"}, "edited": false, "score": 0, "creation_date": 1515576889, "post_id": 48184070, "comment_id": 83348195, "body": "<a href=\"https://stackoverflow.com/questions/2602823/in-c-c-whats-the-simplest-way-to-reverse-the-order-of-bits-in-a-byte\" title=\"in c c whats the simplest way to reverse the order of bits in a byte\">stackoverflow.com/questions/2602823/&hellip;</a>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 4, "creation_date": 1515577780, "post_id": 48184070, "comment_id": 83348822, "body": "I would rely on the <code>hton</code> function. It is a utility function for TCP/IP networking that convert a 32 bit integer from host endianess to network (big endian) one. You could try to benchmark it on your system against your own implementation"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1515578441, "post_id": 48184070, "comment_id": 83349255, "body": "If you need speed you might want search for <i>intrinsic functions</i>. These are usually provided by compiler and map to single CPU instruction. I don&#39;t know for sure, but I suspect that x86 also has 32-bit byte reversal instruction."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1515581277, "post_id": 48184070, "comment_id": 83351068, "body": "x86 has both an explicit byte-swap and (recently) a store-big-endian"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515583881, "post_id": 48184070, "comment_id": 83352536, "body": "<code>this topic is not so popular</code> because you didn&#39;t use the correct keyword. Look for &quot;reverse bytes&quot; or &quot;convert endianness&quot;... and you&#39;ll see that it&#39;s extremely common"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515739128, "post_id": 48184070, "comment_id": 83423171, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7279393/quickest-way-to-change-endianness\">Quickest way to change endianness</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515739160, "post_id": 48184070, "comment_id": 83423179, "body": "<a href=\"https://stackoverflow.com/q/105252/995714\">How do I convert between big-endian and little-endian values in C++?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515739112, "post_id": 48185131, "comment_id": 83423162, "body": "instead of <code>_bswap</code>, use <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html\" rel=\"nofollow noreferrer\"><code>__builtin_bswap32</code></a> for better portability"}], "tags": [], "owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "is_accepted": false, "score": 3, "last_activity_date": 1515579627, "creation_date": 1515579627, "answer_id": 48185131, "question_id": 48184070, "link": "https://stackoverflow.com/questions/48184070/is-there-any-way-to-speedup-be32-encoding-in-c/48185131#48185131", "title": "Is there any way to speedup be32 encoding in C?", "body": "<p>There are two modifications that are likely to improve the performance of your <code>be32inc</code> function. First get rid of the pointer magic and make it a function from <code>uint32_t</code> to <code>uint32_t</code>. Second, if you don't need to be portable to other architectures than x86, implement it using the <code>_bswap</code>-intrinsic.</p>\n"}, {"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515599027, "post_id": 48185451, "comment_id": 83362309, "body": "newer x86 CPUs have <a href=\"https://stackoverflow.com/q/5246146/995714\"><code>movbe</code></a> which may be better in many cases"}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1515599229, "post_id": 48185451, "comment_id": 83362462, "body": "@L\u01b0uV\u0129nhPh&#250;c  The compiler (at least clang and gcc) will do that automatically for atom and haswell  or later using the builtin bswap when compiled with the appropriate &quot;-march=&quot; parameter, but it is not available on all x86_64 architectures."}], "tags": [], "owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1515581827, "last_edit_date": 1515581827, "creation_date": 1515580642, "answer_id": 48185451, "question_id": 48184070, "link": "https://stackoverflow.com/questions/48184070/is-there-any-way-to-speedup-be32-encoding-in-c/48185451#48185451", "title": "Is there any way to speedup be32 encoding in C?", "body": "<p>If you have a decent compiler, you should be able to use builtins (btw there is a BSD standard function that does what you want, <code>htobe32()</code>):</p>\n\n<pre><code>#ifndef I_HAVE_A_CRAP_COMPILER\n#define bswap32(x) __builtin_bswap32(x)\n\n#if __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__\n#define htobe32(x) bswap32(x)\n#elif __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__\n#define htobe32(x) (x)\n#else\n#error Must be little or big endian\n#endif\n\n#else\n/*your implementation here*/\n#endif\n</code></pre>\n\n<p>Edit: if you want to try your C library's builtin <code>htobe32()</code> function you can:</p>\n\n<pre><code>#define _BSD_SOURCE\n#include &lt;endian.h&gt;\n</code></pre>\n\n<p>Though the compiler builtin will likely be faster, since it will avoid a function call altogether and inline efficient assembly (a single <code>bswap</code> instruction on x86 and x86_64)</p>\n"}], "owner": {"reputation": 9, "user_id": 4185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc43c2104b079446a08f941d1f274f9?s=128&d=identicon&r=PG&f=1", "display_name": "YAR", "link": "https://stackoverflow.com/users/4185783/yar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515581827, "creation_date": 1515576304, "question_id": 48184070, "link": "https://stackoverflow.com/questions/48184070/is-there-any-way-to-speedup-be32-encoding-in-c", "title": "Is there any way to speedup be32 encoding in C?", "body": "<p>Is there any way to speedup be32enc in C? Here's an example of what I do for uint32_t:</p>\n\n<pre><code>for (int i=0; i &lt; 19; i++) {\n    be32enc(&amp;endiandata[i], pdata[i]);\n}\n</code></pre>\n\n<p>And the function itself:</p>\n\n<pre><code>static inline void be32enc(void *pp, uint32_t x)\n{\n uint8_t *p = (uint8_t *)pp;\n p[3] = x &amp; 0xff;\n p[2] = (x &gt;&gt; 8) &amp; 0xff;\n p[1] = (x &gt;&gt; 16) &amp; 0xff;\n p[0] = (x &gt;&gt; 24) &amp; 0xff;\n}\n</code></pre>\n\n<p>I've googled hard, but haven't found anything - this topic is not so popular. Target CPU for this would be i3-7350k and I use msvc2017. May use MIT/GPL libs as well.</p>\n"}, {"tags": ["c", "postgresql", "ssl", "locale", "postgresql-9.5"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1515599163, "post_id": 48184051, "comment_id": 83362413, "body": "It sounds like Configure is off a bit. How did you configure Postgres before building?"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 10600723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05492ef9faddb666f1ebe40a865e2ab3?s=128&d=identicon&r=PG&f=1", "display_name": "opena", "link": "https://stackoverflow.com/users/10600723/opena"}, "is_accepted": false, "score": 0, "last_activity_date": 1541258788, "creation_date": 1541258788, "answer_id": 53132733, "question_id": 48184051, "link": "https://stackoverflow.com/questions/48184051/windows-installation-error-for-postgresql-error-in-make-command/53132733#53132733", "title": "Windows installation error for postgresql. Error in make command", "body": "<p>The 'locale_t' type is defined in xlocale.h. The pg_locale.h has a condition before including xlocale.h One of the conditions might not be satisfied, so your xlocale.h is not included yet. Something like this.</p>\n\n<pre><code>#ifndef _PG_LOCALE_\n#define _PG_LOCALE_\n\n#if defined(LOCALE_T_IN_XLOCALE) || defined(WCSTOMBS_L_IN_XLOCALE)\n#include &lt;xlocale.h&gt;\n#endif\n#ifdef USE_ICU\n#include &lt;unicode/ucol.h&gt;\n#endif\n</code></pre>\n"}], "owner": {"reputation": 681, "user_id": 6390216, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/1654339add74bb26c5be059a351cb784?s=128&d=identicon&r=PG&f=1", "display_name": "roopteja", "link": "https://stackoverflow.com/users/6390216/roopteja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541258788, "creation_date": 1515576233, "last_edit_date": 1515599223, "question_id": 48184051, "link": "https://stackoverflow.com/questions/48184051/windows-installation-error-for-postgresql-error-in-make-command", "title": "Windows installation error for postgresql. Error in make command", "body": "<p>I am new to postgresql. I want to install postgresql through source code in windows. I am using MinGW and msys for installation. Configure command is working fine with me. When i execute make command I am getting errors. Would any one please help me to rectify these errors.</p>\n\n<pre><code>[gcc -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wendif-labels -Wmissing-format-attribute -Wformat-security -fno-strict-aliasing -fwrapv -fexcess-precision=standard -O2 -I../../../../src/include -I./src/include/port/win32 -DEXEC_BACKEND  -I/home/roopteja.itha/openssl/include -I/home/roopteja.itha/uuid \"-I../../../../src/include/port/win32\" -DBUILDING_DLL  -c -o spgtextproc.o spgtextproc.c\nIn file included from ../../../../src/include/c.h:101:0,\n                 from ../../../../src/include/postgres.h:47,\n                 from spgtextproc.c:40:\n../../../../src/include/pg_config_os.h:333:18: error: unknown type name '_locale_t'\n #define locale_t _locale_t\n                  ^\n../../../../src/include/utils/pg_locale.h:69:9: note: in expansion of macro 'locale_t'\n typedef locale_t pg_locale_t;\n         ^~~~~~~~\nmake[4]: *** [spgtextproc.o] Error 1\nmake[4]: Leaving directory `/home/roopteja.itha/postgresql-9.5.10/src/backend/access/spgist'\nmake[3]: *** [spgist-recursive] Error 2\nmake[3]: Leaving directory `/home/roopteja.itha/postgresql-9.5.10/src/backend/access'\nmake[2]: *** [access-recursive] Error 2\nmake[2]: Leaving directory `/home/roopteja.itha/postgresql-9.5.10/src/backend'\nmake[1]: *** [all-backend-recurse] Error 2\nmake[1]: Leaving directory `/home/roopteja.itha/postgresql-9.5.10/src'\nmake: *** [all-src-recurse] Error 2]\n</code></pre>\n\n<p>I am not able resolve this issue. Would anyone suggest necessary implementations.</p>\n"}, {"tags": ["c", "linker", "embedded"], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 4960856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805862e7b973bcafed2b679209d54cfd?s=128&d=identicon&r=PG&f=1", "display_name": "hafeez", "link": "https://stackoverflow.com/users/4960856/hafeez"}, "is_accepted": false, "score": 0, "last_activity_date": 1517946237, "last_edit_date": 1517946237, "creation_date": 1517945881, "answer_id": 48650670, "question_id": 48183971, "link": "https://stackoverflow.com/questions/48183971/linker-copytable-meaning/48650670#48650670", "title": "Linker copytable meaning", "body": "<p>In the tasking compiler copytable is used to copy sections(.data etc) from  ROM  to  RAM at startup.\nYour program may be using custom initialization code to  achieve this.\nRemoving the \"copytable\" refernce from the linker script should produce no error.</p>\n\n<p>Alternatively you can remove the linker option</p>\n\n<pre><code>LINK_OPT += --user-provided-initialization-code\n</code></pre>\n\n<p>If you are not intending to use custom initialization code and use the linker provided copytable to copy constants from ROM to RAM at startup.</p>\n"}], "owner": {"reputation": 798, "user_id": 4838002, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/13678927e03a38773999fe049196977b?s=128&d=identicon&r=PG&f=1", "display_name": "mikmik", "link": "https://stackoverflow.com/users/4838002/mikmik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 763, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517946237, "creation_date": 1515575979, "question_id": 48183971, "link": "https://stackoverflow.com/questions/48183971/linker-copytable-meaning", "title": "Linker copytable meaning", "body": "<p>I'm trying to compile an embedded C project using tasking compiler on TRICORE TC275 board. when using linker option <code>LINK_OPT += --user-provided-initialization-code</code> I got the following error :</p>\n\n<pre><code>ltc E122: copy table construction error for \"task1\": The linker detected references to the copytable, while options indicate that custom initialization code is used.\n</code></pre>\n\n<ol>\n<li>what does copytable mean ?</li>\n<li>how can I fix this ?</li>\n</ol>\n\n<p><strong>linker snippet:</strong></p>\n\n<pre><code>/* Linker script for the TRICORE system. */\n\narchitecture TC\n{\n    endianness\n    {\n        little;\n    }\n\n    space linear\n    {\n        id = 1;\n        mau = 8;\n\n        map (src_offset=0x00000000, dest_offset=0x00000000, size=4G, dest=bus:fpi_bus);\n\n        copytable (align = 1 &lt;&lt; 2, copy_unit = 1, dest = linear);\n    }\n\n    bus fpi_bus\n    {\n        mau = 8;\n        width = 32;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "sockets", "tcp"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1515575429, "post_id": 48183746, "comment_id": 83347244, "body": "&quot;Client is written in C. Server is written in C#.&quot;, funny generally is the opposite ^^&#39;"}, {"owner": {"reputation": 525, "user_id": 5011673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df09600e4d6b3319209b1d29e0ae3b95?s=128&d=identicon&r=PG&f=1", "display_name": "Kram", "link": "https://stackoverflow.com/users/5011673/kram"}, "edited": false, "score": 0, "creation_date": 1515578573, "post_id": 48183746, "comment_id": 83349339, "body": "You can&#39;t just send data from client to server over TCP without opening a socket"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1515579047, "post_id": 48183746, "comment_id": 83349624, "body": "What is the problem? Creating the TCP connection? Messing up data format? Wrong padding? Please be much more specific about where you struggle. And please also provide a sample that compiles..."}, {"owner": {"reputation": 5457, "user_id": 430661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed07a399649ac98c8c5fe40ae4249e02?s=128&d=identicon&r=PG", "display_name": "Alex Paven", "link": "https://stackoverflow.com/users/430661/alex-paven"}, "edited": false, "score": 0, "creation_date": 1515579232, "post_id": 48183746, "comment_id": 83349753, "body": "I&#39;d start at <a href=\"https://msdn.microsoft.com/en-us/library/4ca6d5z7.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/4ca6d5z7.aspx</a> - I don&#39;t have a lot of experience with this but I think the way to go is to allocate some unmanaged memory and store the bytes there, then marshall to an equivalent structure in C#. (updated link)"}, {"owner": {"reputation": 23, "user_id": 4745192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f3ca0f9a56ee955840c59eb9c55dd46?s=128&d=identicon&r=PG&f=1", "display_name": "Chen Hubert", "link": "https://stackoverflow.com/users/4745192/chen-hubert"}, "edited": false, "score": 0, "creation_date": 1515598128, "post_id": 48183746, "comment_id": 83361641, "body": "I did have socket created. The code above does not show entire codes. The output on the server side is 32 weird symbols... I sent 32 byte of data from client to server. This tells me my C# server received the msg I sent but I am not decoding it correctly at the server side. Anyone knows how to decode it right?"}], "owner": {"reputation": 23, "user_id": 4745192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f3ca0f9a56ee955840c59eb9c55dd46?s=128&d=identicon&r=PG&f=1", "display_name": "Chen Hubert", "link": "https://stackoverflow.com/users/4745192/chen-hubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515575230, "creation_date": 1515575230, "question_id": 48183746, "link": "https://stackoverflow.com/questions/48183746/c-client-to-c-server-over-tcp", "title": "C client to C# server over TCP", "body": "<p>I have a simple TCP application. Client is written in C. Server is written in C#. I am sending a simple struct over TCP to server. Note that both C# server and C client are of socket type stream. </p>\n\n<p><strong>Client in C:</strong></p>\n\n<pre><code>typedef struct \n{\nunsigned short x;\nfloat y;\nchar z[32];\n}msgStruct;\n</code></pre>\n\n<p>Below is the send function in client.</p>\n\n<pre><code>msgStruct msg;\nif (send(s, &amp;msg, sizeof(msg), 0) &lt; 0)\n{\n    puts(\"Send failed\");\n}\n</code></pre>\n\n<p><strong>Server in C#:</strong></p>\n\n<pre><code>private static byte[] _buffer = new byte[1024];\nsocket.BeginReceive(_buffer, 0, _buffer.Length, SocketFlags.None, new AsyncCallback(ReceiveCallback), socket);\n......blah blah bla......and finally\nbyte[] dataBuf = new byte[received];\nArray.Copy(_buffer, dataBuf, received); \nstring text = Encoding.ASCII.GetString(dataBuf);\nConsole.WriteLine(text);\n</code></pre>\n\n<p>I did create same looking class in C# server but I have no idea how to use it in C#. Are there C# method like below from C?</p>\n\n<pre><code>recv_size = recv(new_socket, &amp;msg, sizeof(msg)\n</code></pre>\n\n<p>If not, how do I do decode received buffers so that I can call msg.x in C#?</p>\n\n<p>I know it is not a good idea to send a struct directly over socket. I still want to this without serialization. Both computer have the same endian. </p>\n"}, {"tags": ["c", "linux", "padding", "bmp"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1515575109, "post_id": 48183712, "comment_id": 83347069, "body": "Try opening a binary file in binary mode."}, {"owner": {"reputation": 19681, "user_id": 4751173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Haz6W.jpg?s=128&g=1", "display_name": "Glorfindel", "link": "https://stackoverflow.com/users/4751173/glorfindel"}, "edited": false, "score": 8, "creation_date": 1515577528, "post_id": 48183712, "comment_id": 83348636, "body": "Please don&#39;t vandalize your posts."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1515585029, "post_id": 48183712, "comment_id": 83353131, "body": "Maybe you could see the difference in files created on Linux and Windows when you open them in a hex editor. This would also give great hints where to look into your code."}], "answers": [{"tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 4, "last_activity_date": 1515575341, "creation_date": 1515575341, "answer_id": 48183776, "question_id": 48183712, "link": "https://stackoverflow.com/questions/48183712/my-code-works-on-windows-but-fails-on-linux-eror-premature-end-of-file-bmp/48183776#48183776", "title": "My code works on windows but fails on linux. Eror: premature end of file bmp", "body": "<p>Note POSIX do not have <code>t</code> in file opening modes. It's specific to Windows. If you want it to work, use <code>b</code>:</p>\n\n<pre><code>f=fopen(\"input100.txt\",\"rb\");\n                         ^\n</code></pre>\n\n<p>Actually, ISO C do not have <code>t</code>. The only flags defined by ISO C are <code>b</code> and <code>+</code>. Pay special attention to those when attempting to write portable code.</p>\n"}], "owner": {"reputation": 7, "user_id": 9115329, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_zPZX_1wf2U/AAAAAAAAAAI/AAAAAAAAAB8/LjOTSmICK4Q/photo.jpg?sz=128", "display_name": "Alexandru Corbescu", "link": "https://stackoverflow.com/users/9115329/alexandru-corbescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "closed_date": 1515710485, "answer_count": 1, "score": -2, "last_activity_date": 1515577509, "creation_date": 1515575074, "last_edit_date": 1515577509, "question_id": 48183712, "link": "https://stackoverflow.com/questions/48183712/my-code-works-on-windows-but-fails-on-linux-eror-premature-end-of-file-bmp", "closed_reason": "Not suitable for this site", "title": "My code works on windows but fails on linux. Eror: premature end of file bmp", "body": "<p>I have to work with some bmp files in order to change the colour of some pixels in a new colour; the withe pixels are ignored. My code seems to work on windows but once I try it on linux the new bmp file wont open because 'premature end of file bmp'.\nThe input file contains the name of the bmp file and the new colour of the pixels.\nI have to create a new file with '_task1.bmp' at the end.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct bmp_fileheader\n{\n    unsigned char  fileMarker1; /* 'B' */\n    unsigned char  fileMarker2; /* 'M' */\n    unsigned int   bfSize; /* File's size */\n    unsigned short unused1;\n    unsigned short unused2;\n    unsigned int   imageDataOffset; /* Offset to the start of image data */\n}FH;\ntypedef struct bmp_infoheader\n{\n    unsigned int   biSize; /* Size of the info header - 40 bytes */\n    signed int     width; /* Width of the image */\n    signed int     height; /* Height of the image */\n    unsigned short planes;\n    unsigned short bitPix;\n    unsigned int   biCompression;\n    unsigned int   biSizeImage; /* Size of the image data */\n    int            biXPelsPerMeter;\n    int            biYPelsPerMeter;\n    unsigned int   biClrUsed;\n    unsigned int   biClrImportant;\n}IH;\nint main()\n{\n    FH fh;    IH ih;\n    FILE *f,*g;\n    int B,G,R,i,j,padding;\n    char fileName[22],fileNameTask[22],*p;\n    unsigned char clr[3],clrNew[3];\n\n    f=fopen(\"input100.txt\",\"rt\");\n    if(f==NULL)\n        return -1;\n\n    fscanf(f,\"%s %d %d %d\",&amp;fileName,&amp;B,&amp;G,&amp;R);\n    clrNew[0]=B; clrNew[1]=G; clrNew[2]=R;\n    fclose(f);\n\n    f=fopen(fileName,\"rb\");\n    if(f==NULL)\n        return -1;\n\n    p=strchr(fileName,'.');   *p='\\0';\n    strcpy(fileNameTask,fileName); strcat(fileNameTask,\"_task1.bmp\");\n\n    g=fopen(fileNameTask,\"wb\");\n    fread(&amp;fh.fileMarker1,1,1,f); fread(&amp;fh.fileMarker2,1,1,f); // B M\n    fread(&amp;fh.bfSize,4,1,f);\n    fread(&amp;fh.unused1,2,1,f); fread(&amp;fh.unused1,2,1,f);\n    fread(&amp;fh.imageDataOffset,4,1,f);\n\n    fwrite(&amp;fh.fileMarker1,1,1,g); fwrite(&amp;fh.fileMarker2,1,1,g);\n    fwrite(&amp;fh.bfSize,4,1,g);\n    fwrite(&amp;fh.unused1,2,1,g); fread(&amp;fh.unused1,2,1,g);\n    fwrite(&amp;fh.imageDataOffset,4,1,g);\n\n    fread(&amp;ih.biSize,4,1,f); // 40\n    fread(&amp;ih.width,4,1,f); fread(&amp;ih.height,4,1,f);\n    fread(&amp;ih.planes,2,1,f);\n    fread(&amp;ih.bitPix,2,1,f); // 24\n    fread(&amp;ih.biCompression,4,1,f);\n    fread(&amp;ih.biSizeImage,4,1,f);\n    fread(&amp;ih.biXPelsPerMeter,4,1,f); fread(&amp;ih.biYPelsPerMeter,4,1,f); // 0\n    fread(&amp;ih.biClrUsed,4,1,f);   fread(&amp;ih.biClrImportant,4,1,f); // ambele 0\n\n    fwrite(&amp;ih.biSize,4,1,g); // 40\n    fwrite(&amp;ih.width,4,1,g); fwrite(&amp;ih.height,4,1,g);\n    fwrite(&amp;ih.planes,2,1,g);\n    fwrite(&amp;ih.bitPix,2,1,g); // 24\n    fwrite(&amp;ih.biCompression,4,1,g);\n    fwrite(&amp;ih.biSizeImage,4,1,g);\n    fwrite(&amp;ih.biXPelsPerMeter,4,1,g); fwrite(&amp;ih.biYPelsPerMeter,4,1,g); // 0\n    fwrite(&amp;ih.biClrUsed,4,1,g);   fwrite(&amp;ih.biClrImportant,4,1,g); // ambele 0\n    padding=(ih.width*3) % 4;\n    for(i=0;i&lt;ih.height;i++)\n    {\n        for(j=0;j&lt;ih.width;j++)\n        {\n            fread(&amp;clr,3,1,f);\n            if(clr[0]==255 &amp;&amp; clr[1]==255 &amp;&amp; clr[2]==255)\n                fwrite(clr,3,1,g);\n            else\n                fwrite(clrNew,3,1,g);\n        }\n        switch(padding)\n        {\n            case 3: fread(&amp;clr,1,1,f); clr[0]=0; fwrite(&amp;clr,1,1,g); break;\n            case 2: fread(&amp;clr,2,1,f); clr[0]=clr[1]=0; fwrite(&amp;clr,2,1,g); break;\n            case 1: fread(&amp;clr,3,1,f); clr[0]=clr[1]=clr[2]=0; fwrite(&amp;clr,3,1,g);\n        }\n    }\n    fclose(f); fclose(g);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 5, "creation_date": 1515574475, "post_id": 48183545, "comment_id": 83346750, "body": "RTFM of <code>free()</code>, ;)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1515574491, "post_id": 48183545, "comment_id": 83346756, "body": "You only <code>free</code> what you have allocated using <code>malloc</code> (directly or indirectly)."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1515574565, "post_id": 48183545, "comment_id": 83346789, "body": "<code>Although arrays are basically pointers</code>..stoppppp, and go back to reading your C book."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1515574719, "post_id": 48183545, "comment_id": 83346879, "body": "Don&#39;t use the C++ tag for a C question."}, {"owner": {"reputation": 453, "user_id": 7157159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/189af1d9b178f250365d282b0f9b1921?s=128&d=identicon&r=PG&f=1", "display_name": "Cosmos Man", "link": "https://stackoverflow.com/users/7157159/cosmos-man"}, "edited": false, "score": 0, "creation_date": 1515574775, "post_id": 48183545, "comment_id": 83346913, "body": "@manni66 There is C++ code in the post. Read carefully plz"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1515574985, "post_id": 48183545, "comment_id": 83347011, "body": "<i>in C gives error</i> C++?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1515575048, "post_id": 48183545, "comment_id": 83347042, "body": "The C++ code doesn&#39;t call a function. If your re-route it via function you&#39;ll get the exact same nasal demons."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1515575387, "post_id": 48183545, "comment_id": 83347224, "body": "Bad dupe since this is also about C++. Since I have wiki&#39;d my answer I can reopen with clear conscience ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 1, "last_activity_date": 1515574460, "creation_date": 1515574460, "answer_id": 48183555, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char/48183555#48183555", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>You only need to free what was malloced.<br>\nYour <code>ptr</code> is not a pointer, it is an array; an automatic local (inside main()) variable. It does not need freeing and attempting to free it is a mistake.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1515575212, "post_id": 48183566, "comment_id": 83347123, "body": "Not <i>quite</i> an act of kindness. It expects a pointer, and it doesn&#39;t get one. One other place where an array to pointer conversion won&#39;t occur, thankfully."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1515575305, "post_id": 48183566, "comment_id": 83347170, "body": "@StoryTeller: I&#39;ve nicked that, and wiki&#39;d the answer, since it&#39;s basically yours now."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1515575296, "last_edit_date": 1515575296, "creation_date": 1515574497, "answer_id": 48183566, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char/48183566#48183566", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>You <em>only</em> call <code>free</code> on <em>dynamic memory</em> that you've allocated using <code>malloc</code>, <code>calloc</code> &amp;c.. Similarly, you only call <code>delete</code> on memory allocated with <code>new</code>. In your case, the C++ compiler is required to issue a diagnostic since <em>pointer decay</em> is not permitted to occur in this particular instance, and <code>delete</code> requires a pointer type.</p>\n\n<p>The behaviour on attempting to call <code>free</code> on automatic memory is <em>undefined</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1515574541, "creation_date": 1515574541, "answer_id": 48183580, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char/48183580#48183580", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>You only <code>free</code> what you have allocated using <code>malloc</code> (directly or indirectly) or related function (like <code>realloc</code>).</p>\n\n<p>Attempting to pass a pointer not returned by <code>malloc</code> will lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<p>That you get a compiler error for <code>delete</code> in C++ is first and foremost because C and C++ are <em>different languages</em> with different rules.</p>\n\n<p>And remember, an array is an array, not a pointer. Though an array can <em>decay</em> to a pointer to its first element in many situation (like when passing it to a function).</p>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515574922, "post_id": 48183596, "comment_id": 83346983, "body": "&quot;All the static Strings will be allocated in the data section.&quot;, please quote the standard that say this non sense."}, {"owner": {"reputation": 525, "user_id": 5011673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df09600e4d6b3319209b1d29e0ae3b95?s=128&d=identicon&r=PG&f=1", "display_name": "Kram", "link": "https://stackoverflow.com/users/5011673/kram"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515576988, "post_id": 48183596, "comment_id": 83348262, "body": "Read about data segment and what it contains"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515577246, "post_id": 48183596, "comment_id": 83348412, "body": "Sorry, can&#39;t find any reference to &quot;data segment&quot; in C standard ;)"}, {"owner": {"reputation": 525, "user_id": 5011673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df09600e4d6b3319209b1d29e0ae3b95?s=128&d=identicon&r=PG&f=1", "display_name": "Kram", "link": "https://stackoverflow.com/users/5011673/kram"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515578101, "post_id": 48183596, "comment_id": 83349016, "body": "Well actually you are right.. It is not referenced in C standard. But, I tried to explain to this guy why the free is not working...."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515579632, "post_id": 48183596, "comment_id": 83350020, "body": "The C standard does not specify where variables are allocated. Local variables will however end up in <code>.stack</code> and string literals in <code>.text</code>. Nothing in this code will end up in <code>.data</code>. Regardless, this answer is still strange, because the OP is trying to free a local variable allocated on the stack, not the string literal itself."}], "tags": [], "owner": {"reputation": 525, "user_id": 5011673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df09600e4d6b3319209b1d29e0ae3b95?s=128&d=identicon&r=PG&f=1", "display_name": "Kram", "link": "https://stackoverflow.com/users/5011673/kram"}, "is_accepted": false, "score": 0, "last_activity_date": 1515574603, "creation_date": 1515574603, "answer_id": 48183596, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char/48183596#48183596", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>All the static Strings will be allocated in the data section. You can't free data from this section. Threrefore, you can free only data the you have allocated with malloc (calloc / ralloc)</p>\n"}, {"comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1515577474, "post_id": 48183853, "comment_id": 83348588, "body": "You still try to delete <code>&quot;Hello World&quot;</code>, which is not proper."}, {"owner": {"reputation": 148, "user_id": 8951714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eea11a2843254a4cace1723f4ed163?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruva-404", "link": "https://stackoverflow.com/users/8951714/dhruva-404"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1515577734, "post_id": 48183853, "comment_id": 83348792, "body": "he wants to do it ! i gave him the way!"}], "tags": [], "owner": {"reputation": 148, "user_id": 8951714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eea11a2843254a4cace1723f4ed163?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruva-404", "link": "https://stackoverflow.com/users/8951714/dhruva-404"}, "is_accepted": false, "score": -2, "last_activity_date": 1515575592, "creation_date": 1515575592, "answer_id": 48183853, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char/48183853#48183853", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>This is the proper way of using delete ! you first have to let the compiler know that the variable ptr is dynamic by using new! </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;new&gt;\nusing namespace std;\n\nint main(void) {\n\n    char *ptr;\n    try{\n    ptr = new char [20];\n    } catch(bad_alloc xa){\n        cout&lt;&lt;\"error\";\n    }\n\n    ptr= \"Hello World\";\n    cout&lt;&lt;ptr;\n\n    delete [] ptr; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 8102039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9e02299a1a362cc48e8e1e63596347?s=128&d=identicon&r=PG&f=1", "display_name": "sambia39", "link": "https://stackoverflow.com/users/8102039/sambia39"}, "is_accepted": false, "score": 0, "last_activity_date": 1515581130, "creation_date": 1515581130, "answer_id": 48185629, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char/48185629#48185629", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>in C programming language, you cannot write the instruction you made for obvious reasons. First of all, it must be understood that a pointer variable is a variable like so many others with a type except that it contains only addresses, so it is called a pointer variable because it contains the address of what is in memory. A pointer is therefore an <strong>address associated with a type of data</strong> and these <strong>two elements are inseparable.</strong> </p>\n\n<p>If the pointer variable contains the address of an object of the whole type, the pointed object is used to know how to interpret the bits that make up this object, as well as its size. The instruction you wrote is therefore a constant pointer to a character type stored somewhere in memory. The string is therefore probably placed in a read-only data segment and therefore you cannot modify the string or release its memory, because the pointer <strong>variable does not point to a string in a space allocated dynamically</strong> beforehand by the \"malloc\" or \"calloc\" allocation function, and that is why you have the error message.</p>\n\n<p>The second error is due to a confusion of your part here too, you must understand that there is a difference between an array of characters and a pointer. In simpler terms, a pointer variable is not an array and an array is not a pointer, but access to the element is done in the same way. For an array, the characters that make up the string and end with  \"\\0\" can be changed, but the array of characters will always point to the same address in memory and the pointer can contain another address, but beware, if you allocate the memory with a pointer and then point to other pars without releasing the memory you allocated creates a memory leak. </p>\n"}], "owner": {"reputation": 453, "user_id": 7157159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/189af1d9b178f250365d282b0f9b1921?s=128&d=identicon&r=PG&f=1", "display_name": "Cosmos Man", "link": "https://stackoverflow.com/users/7157159/cosmos-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 48183580, "answer_count": 6, "score": -4, "last_activity_date": 1515586844, "creation_date": 1515574423, "last_edit_date": 1515586844, "question_id": 48183545, "link": "https://stackoverflow.com/questions/48183545/freeing-char-in-c-gives-error-and-how-do-c-compiler-handle-that-char", "title": "Freeing char[] in C gives error and how do C compiler handle that char[]", "body": "<p>Although arrays are basically pointers, freeing <code>char[]</code> in <em>C</em> gives an error.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char ptr[] = \"Hello World\";\n\n    free(ptr); // this gives error at run time\n}\n</code></pre>\n\n<p><strong>ERROR</strong>: nexc(4212,0x10038e3c0) malloc: <strong>* error for object 0x7fff5fbff54c: pointer being freed was not allocated\n*</strong> set a breakpoint in malloc_error_break to debug</p>\n\n<p>The interesting part is that, it is saying I am freeing a pointer which is not allocated.<br>\nHow could this happen?</p>\n\n<p>But in <strong>C++</strong>, compiler gives me a compile time error instead.</p>\n\n<pre><code>int main(void) {\n    char ptr[] = \"Hello World\";\n\n    delete ptr; // this gives error at compile time\n}\n</code></pre>\n\n<p>like,\n    <strong><code>Cannot delete expression of type char[12]</code></strong></p>\n\n<p>I thought this is because of compiler handles the <code>char[12]</code> by allocating  when the function is called and deallocating the memory when the function ends. So, I write some codes after <code>free(ptr);</code> before the function ends.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char ptr[] = \"Hello World\";\n\n    free(ptr); // this still gives error at run time\n\n    printf(\"\\n\");\n    printf(\"\\n\");\n    printf(\"\\n\");\n    printf(\"\\n\");\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>This still gives error. How is this happening?</p>\n"}, {"tags": ["c", "malloc", "free", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1515573779, "post_id": 48183333, "comment_id": 83346282, "body": "The standard library provides no standard way for that. What is your real problem? Depending on the system, there are tools (like valgrind) to control the dynamic memory usage."}, {"owner": {"reputation": 525, "user_id": 5011673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df09600e4d6b3319209b1d29e0ae3b95?s=128&d=identicon&r=PG&f=1", "display_name": "Kram", "link": "https://stackoverflow.com/users/5011673/kram"}, "edited": false, "score": 0, "creation_date": 1515573807, "post_id": 48183333, "comment_id": 83346303, "body": "You want to know the stack size or the heap size?"}, {"owner": {"reputation": 268, "user_id": 4724052, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/taW2b.jpg?s=128&g=1", "display_name": "Sid Sahay", "link": "https://stackoverflow.com/users/4724052/sid-sahay"}, "edited": false, "score": 0, "creation_date": 1515574209, "post_id": 48183333, "comment_id": 83346545, "body": "You can use valgrind to get a better idea about memory."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1515574198, "post_id": 48183417, "comment_id": 83346541, "body": "I think OP here is concerned about the allocations made by the program and not the actual space utilized by the process. I think he wants a tally of mallocs/frees. Just my interpretation."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1515574304, "post_id": 48183417, "comment_id": 83346625, "body": "Hence my mention of <code>valgrind</code> &amp; <code>mallinfo</code> etc"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1515575268, "last_edit_date": 1515575268, "creation_date": 1515573906, "answer_id": 48183417, "question_id": 48183333, "link": "https://stackoverflow.com/questions/48183333/how-to-know-the-full-size-of-memory-allocated-for-a-single-program-in-c/48183417#48183417", "title": "How to know the full size of memory allocated for a single program in C?", "body": "<p>There is no standard way to know that, and the notion of \"full size of memory\" is not well defined (and its \"allocation\" could happen outside and independently of <code>malloc</code>, e.g. on Linux by direct calls to <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">mmap(2)</a> etc...)</p>\n\n<p>In practice (assuming your code is running in a <a href=\"https://en.wikipedia.org/wiki/Process_(computing)\" rel=\"nofollow noreferrer\">process</a> on some common <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating system</a> on a desktop or laptop), think instead in terms of <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual address space</a>.</p>\n\n<p>Read <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\"><em>Operating Systems: Three Easy Pieces</em></a> (freely downloadable).</p>\n\n<p>On Linux (but this is Linux specific) you could use <code>/proc/</code> (see <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow noreferrer\">proc(5)</a> for details) to query the kernel about the virtual address space and the status of some process. For a process of pid 1234, see <code>/proc/1234/maps</code> and <code>/proc/1234/status</code> etc.</p>\n\n<p>You could (and probably should) use <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a> to hunt <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow noreferrer\">memory leaks</a>.</p>\n\n<p>With GNU <a href=\"https://www.gnu.org/software/libc/\" rel=\"nofollow noreferrer\">glibc</a>, you also have <a href=\"http://man7.org/linux/man-pages/man3/mallinfo.3.html\" rel=\"nofollow noreferrer\">mallinfo(3)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man3/malloc_stats.3.html\" rel=\"nofollow noreferrer\">malloc_stats(3)</a> (but they are non-standard) etc...</p>\n\n<p>Be aware that <code>malloc</code> and <code>free</code> uses lower-level system calls such as <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">mmap(2)</a> &amp; <code>munmap</code> (or the older <a href=\"http://man7.org/linux/man-pages/man2/sbrk.2.html\" rel=\"nofollow noreferrer\">sbrk(2)</a>, etc...) to change the virtual address space, but that  <code>free</code> usually don't release memory to the kernel with <code>munmap</code> but prefers to keep and mark the freed memory zone for future usage by <code>malloc</code>.</p>\n\n<p>You could use other <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow noreferrer\">implementations of <code>malloc</code></a> if you really wanted to (or even provide your own one). But you generally should not.</p>\n"}], "owner": {"reputation": 69, "user_id": 5561093, "user_type": "registered", "profile_image": "https://graph.facebook.com/769716766487709/picture?type=large", "display_name": "Melvin George", "link": "https://stackoverflow.com/users/5561093/melvin-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 48183417, "answer_count": 1, "score": 0, "last_activity_date": 1515575268, "creation_date": 1515573660, "question_id": 48183333, "link": "https://stackoverflow.com/questions/48183333/how-to-know-the-full-size-of-memory-allocated-for-a-single-program-in-c", "title": "How to know the full size of memory allocated for a single program in C?", "body": "<p>To check the program total memory allocated at end of a program, Since i used <strong>free()</strong> function for deallocating an array .</p>\n"}, {"tags": ["c++", "c", "macros", "decltype"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515571225, "post_id": 48182676, "comment_id": 83344981, "body": "&quot;I have no right to change this struct but the struct changes a lot.&quot; How does that make sense? Simply enforce the use of a typedef, if people are changing the code anyway."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1515571227, "post_id": 48182676, "comment_id": 83344984, "body": "remember, in C, <code>tools</code> is a datatype, not a variable that you can use member access operator onto it."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515571379, "post_id": 48182676, "comment_id": 83345048, "body": "Please be specific... are you required to <i>define</i> a matching function (including the function body) or to <i>declare</i> a matching function signature? To be honest, if your job is to define the function, then I don&#39;t see the value in automatic signature changes, because you would need to re-check the implementation details anyway."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515571384, "post_id": 48182676, "comment_id": 83345053, "body": "If the type of variable should be opaque, use a typedef."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1515571443, "post_id": 48182676, "comment_id": 83345086, "body": "There&#39;s a non-standard gcc extension <code>typeof</code>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1515571460, "post_id": 48182676, "comment_id": 83345093, "body": "I don&#39;t see how <code>decltype</code> can help you much here tbh because if the function signature changes you have to recode the function anyway."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1515571518, "post_id": 48182676, "comment_id": 83345117, "body": "By the way, despite the fact you are looking for a C++ equivalent facility, I don&#39;t think it really warrants the C++ tag."}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515571901, "post_id": 48182676, "comment_id": 83345299, "body": "@Lundin   See my reedit part."}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515572013, "post_id": 48182676, "comment_id": 83345351, "body": "@grek40  reedited."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1515572461, "post_id": 48182676, "comment_id": 83345582, "body": "<i>&quot;For historical reasons, some of them used int, others used size_t or ssize_t and so on.&quot;</i> You need to get those groups together and set common rules on how to do things. It sounds like you are trying to solve people problem with tech."}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1515572685, "post_id": 48182676, "comment_id": 83345695, "body": "@user694733   lol, yup, maybe you are right..."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 2, "creation_date": 1515572730, "post_id": 48182676, "comment_id": 83345717, "body": "So basically, you have <code>1..N</code> groups that provide you with code and you want to run the same test on those <code>N</code> codes. The signature is the same each time you get code from group <code>x</code> but can be different when you get code from group <code>y</code>. Maybe you can just define a unique symbol for each of the groups and change your compilation process to include this symbol like <code>make GROUP=x</code>. Then all thats left is a preprocessor conditional that enables different function signatures depending on the <code>GROUP</code> value."}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515572953, "post_id": 48182676, "comment_id": 83345839, "body": "@grek40  Great, I&#39;ll try  :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1515574124, "post_id": 48182676, "comment_id": 83346502, "body": "@Yves I see. Then I think I came up with a work-around, see my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 0, "creation_date": 1515572179, "post_id": 48182775, "comment_id": 83345439, "body": "I&#39;ve reedited my question. Hmm. I&#39;ll try right now.  :D"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 0, "creation_date": 1515572336, "post_id": 48182775, "comment_id": 83345521, "body": "@Yves - I hope it helps. I&#39;m not sure it answers the question anymore, however. You want type checking or for the need to comment/uncomment to go away?"}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 0, "creation_date": 1515572638, "post_id": 48182775, "comment_id": 83345669, "body": "Exactly. I just want to stop comment/uncomment anymore. You see I developed my tool yesterday and today many colleagues use it. But they are testing the different versions... So I have to use <code>int</code> for group 1, to use <code>size_t</code> for group 2... This is really boring..."}, {"owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "edited": false, "score": 1, "creation_date": 1515572751, "post_id": 48182775, "comment_id": 83345726, "body": "Your answer helps a lot anyway. :D   At least I can write a report to my leader..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1515572911, "post_id": 48182775, "comment_id": 83345812, "body": "One thing to add here is that write the body of the function in such a way that it is compatible with both <code>size_t</code> and <code>int</code>. Which would mean you might have to introduce some unnecessary casts."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1515573138, "post_id": 48182775, "comment_id": 83345931, "body": "@AjayBrahmakshatriya - Personally I think both <code>size_t</code> and <code>int</code> should be abstracted by a type alias. Then the body of the function will at least contain only casts to the alias. Either way, this is nasty business the OP is in."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1515571381, "creation_date": 1515571381, "answer_id": 48182775, "question_id": 48182676, "link": "https://stackoverflow.com/questions/48182676/c-equivalent-to-c-decltype/48182775#48182775", "title": "C equivalent to C++ decltype", "body": "<p>Well, this isn't <code>decltype</code> but if you can just <em>convince</em> your colleague to use a type alias, you can have your static type checking.</p>\n\n<p>If your colleague can be persuaded to do this:</p>\n\n<pre><code>typedef int tool_a_prototype(int, int, int);\n\nstruct tools {  \n    tool_a_prototype *tool_a;\n};\n</code></pre>\n\n<p>Then you can declare your functions like this:</p>\n\n<pre><code>tool_a_prototype my_tool_a;\n\nint my_tool_a(int a, int b, int c) {\n  //Whatever\n}\n</code></pre>\n\n<p>And your friendly compiler will tell you if there's a prototype mismatch.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1515574304, "post_id": 48183460, "comment_id": 83346624, "body": "Yeah, I always forget about generic selections. This should be the accepted answer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1515574395, "post_id": 48183460, "comment_id": 83346695, "body": "@StoryTeller Still, the typedef version is the sound and most correct one. Code like this is the last resort."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515574625, "post_id": 48183460, "comment_id": 83346831, "body": "Nice solution. I am a bit puzzled why you need <code>##</code> in your function names in the macro..."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515574891, "post_id": 48183460, "comment_id": 83346974, "body": "What benefit would we get by a <code>typedef</code>? The definition of the function would still have to be changed if that <code>typedef</code> is defined differently."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515579268, "post_id": 48183460, "comment_id": 83349781, "body": "@Gerhardh Actually the <code>##</code> isn&#39;t needed indeed at all, it was a remain of my first attempt to solve this. Fixed. Regarding typedef, it is possible to do <code>typedef int func_t (int, int);</code> then <code>func_t func;</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515579429, "post_id": 48183460, "comment_id": 83349883, "body": "Sure you can do <code>fun_t func;</code> but this only helps declaring a function with no benefit for defining that function."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 9, "last_activity_date": 1515579285, "last_edit_date": 1515579285, "creation_date": 1515574068, "answer_id": 48183460, "question_id": 48182676, "link": "https://stackoverflow.com/questions/48182676/c-equivalent-to-c-decltype/48183460#48183460", "title": "C equivalent to C++ decltype", "body": "<p>The sane solution is to enforce a <code>typedef</code>. If that isn't possible, and the number of alternative types the function could have are limited, as seems to be the case, you could cook up something with C11 <code>_Generic</code>.</p>\n\n<p>Instead of having a single function called <code>my_func</code>, create multiple functions with different names. Prefix their names depending on the return type. Then have a macro which in turn re-directs to the appropriate function, based on the type passed. </p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/*** the struct that cannot be changed ***/\nstruct tools {  \n    int (*tool_a) (int, int, int);\n};\n\n/*** any number of functions with different types ***/\nint int_my_func(int a, int b, int c) \n{ \n  puts(__func__); \n}\n\nsize_t size_t_my_func(int a, int b, int c) \n{ \n  puts(__func__); \n}\n\n/*** macro to select the appropriate function based on type ***/\n#define my_func_typeof(type)                           \\\n  _Generic( (type),                                    \\\n            int(*)(int,int,int)    : int_my_func,      \\\n            size_t(*)(int,int,int) : size_t_my_func)\n\n/*** caller code ***/\nint main (void)\n{\n  struct tools my_tool = {\n    .tool_a = my_func_typeof( (struct tools){0}.tool_a )\n  };\n\n  my_tool.tool_a(1,2,3);\n\n}\n</code></pre>\n\n<p>Here I used a compound literal <code>(struct tools){0}.tool_a</code> to create a dummy object of the same type as <code>tool_a</code>, then passed that on to the macro which picks the appropriate function. If the type is not supported, there will be a compiler error since no matching _Generic association could be found.</p>\n"}, {"tags": [], "owner": {"reputation": 2901, "user_id": 619493, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e90d55a00ea556834a09949b6db2a547?s=128&d=identicon&r=PG", "display_name": "Amir Gonnen", "link": "https://stackoverflow.com/users/619493/amir-gonnen"}, "is_accepted": false, "score": 0, "last_activity_date": 1545809194, "creation_date": 1545809194, "answer_id": 53928817, "question_id": 48182676, "link": "https://stackoverflow.com/questions/48182676/c-equivalent-to-c-decltype/53928817#53928817", "title": "C equivalent to C++ decltype", "body": "<blockquote>\n  <p>The problem is that the struct changes a lot, especially the return\n  types, for example int is replaced by size_t today, so I have to\n  change my code a lot.</p>\n  \n  <p>I know that decltype in C++ can help me so I just want to know if C\n  has something equivalent?</p>\n</blockquote>\n\n<p>If you are willing to use a <strong>non standard</strong> gcc extension, you can use <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Typeof.html\" rel=\"nofollow noreferrer\"><code>typeof</code></a>:</p>\n\n<pre><code>struct tools {  \n    int (*tool_a) (int, int, int);\n};\n\ntypedef typeof( ((struct tools*)NULL)-&gt;tool_a ) tool_a_type;\ntypedef typeof( ((tool_a_type)NULL)(0,0,0) ) tool_a_return_type;\n\ntool_a_return_type my_func(int x, int y, int z)\n{\n\n}\n\nstruct tools my_tool = {\n    .tool_a = my_func\n};\n</code></pre>\n"}], "owner": {"reputation": 8220, "user_id": 3305546, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/G2mbe.png?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/3305546/yves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2412, "favorite_count": 1, "accepted_answer_id": 48183460, "answer_count": 3, "score": 13, "last_activity_date": 1545809194, "creation_date": 1515570969, "last_edit_date": 1515571880, "question_id": 48182676, "link": "https://stackoverflow.com/questions/48182676/c-equivalent-to-c-decltype", "title": "C equivalent to C++ decltype", "body": "<p>In my C project, there is a struct, created by another colleague, containing some function pointers:<br></p>\n\n<pre><code>struct tools {  \n    int (*tool_a) (int, int, int);\n    ...\n};\n</code></pre>\n\n<p>I have no right to change this struct and relative files.<br></p>\n\n<p>Now I'm coding with the struct.<br>\nI have to define a function, whose return type and list of arguments must be the same with the <code>tools.tool_a</code>.<br>\nMeaning that my function must be as below:<br></p>\n\n<pre><code>int my_func(int, int, int);\n</code></pre>\n\n<p>The problem is that the struct changes a lot, especially the return types, for example <code>int</code> is replaced by <code>size_t</code> today, so I have to change my code a lot.<br></p>\n\n<p>I know that <code>decltype</code> in C++ can help me so I just want to know if C has something equivalent?<br></p>\n\n<p>I'm thinking I may use macro but I don't know how, I even don't know if it's possible or not.<br>\n<br></p>\n\n<h1>REAL CASE</h1>\n\n<p>I'm developing some testing tools for linux-kernel with C.<br>\nThere have been many versions of custom kernels coming from other groups in my company. For historical reasons, some of them used <code>int</code>, others used <code>size_t</code> or <code>ssize_t</code> and so on.<br></p>\n\n<p>Now when I code, I have to do like this:<br></p>\n\n<pre><code>// int my_func(int a, int b, int c)\nsize_t my_func(int a, int b, int c)\n// ssize_t my_func(int a, int b, int c)\n{}\nstruct tools my_tool = {\n    .tool_a = my_func;\n}\n</code></pre>\n\n<p>I have to keep commenting and uncommenting...</p>\n"}, {"tags": ["c", "linux", "pointers", "struct", "syntax"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 7, "creation_date": 1515570726, "post_id": 48182596, "comment_id": 83344749, "body": "Please do not enter pure text as images to your questions. Just copy&amp;paste text as text."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1515570784, "post_id": 48182596, "comment_id": 83344782, "body": "<code>val_a-&gt;_a</code> is equivalent to <code>val_a[0]._a</code> due to implicit array to pointer conversion. That holds for any kind of array, not just arrays of <code>struct</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1515574345, "post_id": 48182596, "comment_id": 83346660, "body": "<code>-&gt;</code> can be used with any pointer, even addresses of global/static or local variables. So your assumption that &quot;like allocated memory in heap or mmap&quot; is wrong."}, {"owner": {"reputation": 63, "user_id": 5241864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8eb1022fe178fd7b6089864832944a?s=128&d=identicon&r=PG&f=1", "display_name": "JuHyung Son", "link": "https://stackoverflow.com/users/5241864/juhyung-son"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1515574871, "post_id": 48182596, "comment_id": 83346966, "body": "@Gerhardh sorry. I removed images"}, {"owner": {"reputation": 63, "user_id": 5241864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8eb1022fe178fd7b6089864832944a?s=128&d=identicon&r=PG&f=1", "display_name": "JuHyung Son", "link": "https://stackoverflow.com/users/5241864/juhyung-son"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515574892, "post_id": 48182596, "comment_id": 83346975, "body": "@Stargateur I removed it. sorry.."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1515575027, "post_id": 48182596, "comment_id": 83347029, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2575048/arrow-operator-usage-in-c\">Arrow operator (-&gt;) usage in C</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515575128, "post_id": 48182596, "comment_id": 83347076, "body": "@Stargateur I think it is rather a problem of correct type definition than arrow usage."}, {"owner": {"reputation": 63, "user_id": 5241864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8eb1022fe178fd7b6089864832944a?s=128&d=identicon&r=PG&f=1", "display_name": "JuHyung Son", "link": "https://stackoverflow.com/users/5241864/juhyung-son"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515575710, "post_id": 48182596, "comment_id": 83347417, "body": "@Stargateur Thank you for the comment. But I was curious about defining struct like that is whether array of struct or not."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1515576161, "post_id": 48182596, "comment_id": 83347686, "body": "@JuHyungSon: Stack Overflow&#39;s voting system gives unexpected verdict sometimes. Before you have put code into the question post, you have collected 3 &quot;off-topic&quot; close votes. I agree with Stargateur in that core of your problem is understanding of operator <code>-&gt;</code>, so we both voted for duplicate. But since 3 close votes is more than 2, &quot;off-topic&quot; verdict wins, while it currently inapplicable to your question. Next time try to put basic things into the question post at the <i>creation time</i>, so you won&#39;t collect unneeded close votes (and downvotes)."}, {"owner": {"reputation": 63, "user_id": 5241864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8eb1022fe178fd7b6089864832944a?s=128&d=identicon&r=PG&f=1", "display_name": "JuHyung Son", "link": "https://stackoverflow.com/users/5241864/juhyung-son"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1515576668, "post_id": 48182596, "comment_id": 83348053, "body": "@Tsyvarev I understand it. Thank you for your comment and advise. I agree with you. It was enough for me to someone answered my question to help me and teach me. Thank you so much."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5241864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8eb1022fe178fd7b6089864832944a?s=128&d=identicon&r=PG&f=1", "display_name": "JuHyung Son", "link": "https://stackoverflow.com/users/5241864/juhyung-son"}, "edited": false, "score": 0, "creation_date": 1515576035, "post_id": 48183805, "comment_id": 83347609, "body": "Thank you so much. I understood it. It really helped a lot."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 1, "last_activity_date": 1515575428, "creation_date": 1515575428, "answer_id": 48183805, "question_id": 48182596, "link": "https://stackoverflow.com/questions/48182596/struct-in-c-language/48183805#48183805", "title": "struct in C language", "body": "<blockquote>\n  <p>I thought it could be defining struct array,</p>\n</blockquote>\n\n<p>No, it is not an array made of structs, but an array holding pointers to structs. The code defines an array holding <code>CHRDEV_MAJOR_HASH_SIZE</code> pointers without any memory for the structs itself.</p>\n\n<p>In your code this would be </p>\n\n<pre><code>struct a{\n    int _a;\n} *val_a[10];\n</code></pre>\n\n<p>Then you can use it like this:</p>\n\n<pre><code>val_a[0] = malloc(sizeof(struct a));\nval_a[0]-&gt;_a = 123;\n(*val_a[0])._a = 123; // identical to previous line.\n</code></pre>\n\n<p>Or if you want to use the decayed pointer from that array:</p>\n\n<pre><code>*val_a = malloc(sizeof(struct a));\n(*val_a)-&gt;_a = 123;\n</code></pre>\n\n<p>But this will only access the first element of the array.</p>\n"}], "owner": {"reputation": 63, "user_id": 5241864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8eb1022fe178fd7b6089864832944a?s=128&d=identicon&r=PG&f=1", "display_name": "JuHyung Son", "link": "https://stackoverflow.com/users/5241864/juhyung-son"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1515575421, "accepted_answer_id": 48183805, "answer_count": 1, "score": -4, "last_activity_date": 1515575524, "creation_date": 1515570620, "last_edit_date": 1515575524, "question_id": 48182596, "link": "https://stackoverflow.com/questions/48182596/struct-in-c-language", "closed_reason": "Not suitable for this site", "title": "struct in C language", "body": "<p>While I am studying device driver I bump into this code below.</p>\n\n<pre><code>static struct char_device_struct{\n    struct char_device_struct *next;\n    ...\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n</code></pre>\n\n<p>I thought it could be defining struct array, so I wrote a simple code like this below and found strange things.</p>\n\n<pre><code>struct a{\n    int _a;\n} val_a[10];\n\nstruct b{\n    int _b;\n};\n\nstruct b val_b;\n\nint main(){\n    val_a-&gt;_a=10;\n    val_b._b=10;\n\n    return 0;\n}\n</code></pre>\n\n<p>val_a is accessible by \"->\" like allocated memory in heap or mmap(accessing by pointer) but not accessed like \".\".</p>\n\n<ul>\n<li>what does it mean to use struct like array(e.g. CHRDEV_MAJOR_HASH_SIZE) </li>\n<li>and if it is just defining struct array what is difference between just using like val_b.</li>\n</ul>\n\n<p>Sorry for the bad English.\nThank you very much.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1515568876, "post_id": 48182135, "comment_id": 83343910, "body": "In <code>createData</code> the variable <code>tab</code> is a <i>local variable</i>, it will cease to exist once the function returns. Returning a pointer to its first element (which is what you do) will make that pointer immediately invalid."}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515569259, "post_id": 48182135, "comment_id": 83344074, "body": "I have tried to return a different variable instead of tab that point to its first element , but it didn&#39;t work"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515569370, "post_id": 48182135, "comment_id": 83344121, "body": "The solution is dynamic allocation."}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515569449, "post_id": 48182135, "comment_id": 83344162, "body": "Actually my assignement says that the return type must be Client[] , is that even possible !!"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515569509, "post_id": 48182135, "comment_id": 83344185, "body": "@Someprogrammerdude well in case of a predefined array size, there are alternatives... <a href=\"https://stackoverflow.com/a/4581061/5265292\">stackoverflow.com/a/4581061/5265292</a>"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515569709, "post_id": 48182135, "comment_id": 83344276, "body": "@YaSsou A return type of <code>Client[]</code> sounds like trouble if you ask me..."}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515569846, "post_id": 48182135, "comment_id": 83344335, "body": "Well, yes it is a predifined size, @grek40 yes it did cause me troubles in the other hands when I used Client* some problems where solved but still not working"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515569950, "post_id": 48182135, "comment_id": 83344381, "body": "Since you have a specific assignment, the exact wording is important... are you asked to return <code>Client[]</code>, an array of clients, an array of client pointers or something different?"}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515569986, "post_id": 48182135, "comment_id": 83344402, "body": "An array of 20000 Clients to be exact"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515570089, "post_id": 48182135, "comment_id": 83344454, "body": "Is <code>initClient</code> with this function signature your invention or is it part of your assignment requirements? Some related question on array of X: <a href=\"https://stackoverflow.com/questions/9995564/function-with-return-type-array-in-c\" title=\"function with return type array in c\">stackoverflow.com/questions/9995564/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515570172, "post_id": 48182135, "comment_id": 83344490, "body": "The assignment requires this signature: struct Client[] createData() ;"}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515570311, "post_id": 48182135, "comment_id": 83344554, "body": "For initClient yes it is in part of my assignment requirements"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1515570875, "post_id": 48182135, "comment_id": 83344813, "body": "The only way to return a local array (which is not <code>malloc()</code>ed) safe from a function, I see, is to make it <code>static</code>. <code>static</code> extends the life-time of the local variable over the whole program life-time. Hence access after return of function is OK. On the other hand, every call of the function returns the one-and-only same instance of variable (with the same storage)."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515570994, "post_id": 48182135, "comment_id": 83344864, "body": "@YaSsou I mean, is this specific function signature for <code>initClient</code> required (with return type <code>Client*</code> and parameter types as 3 integers) or is it only generally required to implement some function with name <code>initClient</code>? If you are not specific down to the last detail, then you can&#39;t get good answers. If it wasn&#39;t a homework question you could get an answer that completely changes the function signatures, but since you need them, you have to explain them in detail."}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515571148, "post_id": 48182135, "comment_id": 83344944, "body": "No it is the specific signature"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1515571177, "post_id": 48182135, "comment_id": 83344961, "body": "Arrays may not be passed as arguments nor returned - they decay to a pointer. Returning a local (non-<code>static</code>) array is <a href=\"https://stackoverflow.com/a/4105123/1505939\">UB</a> as it allows access to something for which life-time has ended. This changes if the array is wrapped in a <code>struct</code> (like demonstrated on <a href=\"https://ideone.com/y1wSgB\" rel=\"nofollow noreferrer\"><b>ideone</b></a>). <b>BUT</b>, this means copying the array (bad performance). There was a reason why K&amp;R decided not to support arrays for arguments/return. (May be, they even considered the trick with the <code>struct</code> as &quot;back-door&quot;.)"}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515571905, "post_id": 48182135, "comment_id": 83345302, "body": "I see **, I just couldn&#39;t get it right :/"}], "answers": [{"comments": [{"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1515573186, "post_id": 48183133, "comment_id": 83345947, "body": "If that&#39;s the solution (instead of some error in the required signatures) then the responsible teacher is a terrible person :)"}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515573464, "post_id": 48183133, "comment_id": 83346076, "body": "@Scheff, Thank you very much it works fine, at first it gave me an error :for loop initial declaration used outside c99 But it was fixed when I moved the declaration of i outside of the loop"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 1, "creation_date": 1515573471, "post_id": 48183133, "comment_id": 83346080, "body": "@grek40 Yepp. That&#39;s why I felt the necessity of an extension."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515573677, "post_id": 48183133, "comment_id": 83346194, "body": "@YaSsou Did you recognize that the 2nd sample did provide the exact same output like the first? This is no accident - I didn&#39;t seed the <code>rand()</code> and hence it is reproducible. This might be welcome or not. In the latter case, you have to use <code>srand()</code> with a a random value (e.g. current seconds of time)."}, {"owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "edited": false, "score": 0, "creation_date": 1515574312, "post_id": 48183133, "comment_id": 83346633, "body": "Okay, I see, for now rand() is okay (the teacher required it). Thanks for the information and for everything you were most helpful :)"}], "tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": true, "score": 1, "last_activity_date": 1515573436, "last_edit_date": 1515573436, "creation_date": 1515572855, "answer_id": 48183133, "question_id": 48182135, "link": "https://stackoverflow.com/questions/48182135/a-function-that-returns-a-table-of-struct-in-c/48183133#48183133", "title": "A function that returns a table of struct in C", "body": "<p>According to what has been discussed in the comments (and considering that I gave some probably confusing hints) I want to show the (only) solution I see to match all requirements:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct { int num_tel, nbr_appel, cout; } Client;\n\nClient* initClient(int num_tel, int nbr_appel, int cout);\nClient* createData();\n\n#define NBCLIENT 20\n\nClient* initClient(int num_tel, int nbr_appel, int cout)\n{\n  Client *pClient = malloc(sizeof (Client));\n  /** @bug check for NULL pointer missing! */\n  pClient-&gt;num_tel = num_tel;\n  pClient-&gt;nbr_appel = nbr_appel;\n  pClient-&gt;cout = cout;\n  return pClient;\n}\n\nClient* createData()\n{\n  Client *clients = malloc(NBCLIENT * sizeof (Client));\n  /** @bug check for NULL pointer missing! */\n  for (int i = 0; i &lt; NBCLIENT; ++i) {\n    int numeroTel = 600000000 + (rand() % NBCLIENT);\n    int prixAppel = (rand() % 400) + 1;\n    Client *pClient = initClient(numeroTel,1,prixAppel);\n    /* copy returned CONTENTS to malloc-ed array element */\n    clients[i] = *pClient; /* assignment for struct-s is granted */\n    /* release pClient to prevent memory leaks - it's not anymore needed */\n    free(pClient);\n  }\n  return clients;\n}\n\nint main()\n{\n  Client *clients = createData();\n  for (int i = 0; i &lt; NBCLIENT; ++i) {\n    Client *pClient = clients + i; /* or: &amp;clients[i] would work as well */\n    printf(\"%2d.: %d, %d, %d\\n\",\n      i, pClient-&gt;num_tel, pClient-&gt;nbr_appel, pClient-&gt;cout);\n  }\n  free(clients);\n  return 0;\n}\n</code></pre>\n\n<p>Thereby, to match the required signatures the returned <code>struct</code> value of <code>initClient()</code> is copied into the array <code>malloc()</code>-ed in <code>createData()</code>. As doing it this way, the <code>free()</code> is important to prevent memory leaks as the memory of <code>malloc()</code> done in <code>initClient()</code> is neither used nor referenced afterwards.</p>\n\n<p>Compiled and tested on <a href=\"https://ideone.com/7zJESh\" rel=\"nofollow noreferrer\"><strong>ideone</strong></a>. Output was:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> 0.: 600000003, 1, 87\n 1.: 600000017, 1, 116\n 2.: 600000013, 1, 336\n 3.: 600000006, 1, 93\n 4.: 600000009, 1, 222\n 5.: 600000002, 1, 28\n 6.: 600000010, 1, 60\n 7.: 600000003, 1, 327\n 8.: 600000000, 1, 227\n 9.: 600000012, 1, 137\n10.: 600000011, 1, 169\n11.: 600000007, 1, 30\n12.: 600000002, 1, 331\n13.: 600000002, 1, 324\n14.: 600000007, 1, 336\n15.: 600000009, 1, 203\n16.: 600000002, 1, 259\n17.: 600000009, 1, 168\n18.: 600000013, 1, 57\n19.: 600000011, 1, 43\n</code></pre>\n\n<hr>\n\n<p>The temporary memory allocated in <code>initClient()</code> and free-d in <code>createData()</code> would be something which would bother me. This could be prevented with a slight change of the signature of <code>initClient()</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct { int num_tel, nbr_appel, cout; } Client;\n\nvoid initClient(Client *pClient, int num_tel, int nbr_appel, int cout);\nClient* createData();\n\n#define NBCLIENT 20\n\nvoid initClient(Client *pClient, int num_tel, int nbr_appel, int cout)\n{\n  pClient-&gt;num_tel = num_tel;\n  pClient-&gt;nbr_appel = nbr_appel;\n  pClient-&gt;cout = cout;\n}\n\nClient* createData()\n{\n  Client *clients = malloc(NBCLIENT * sizeof (Client));\n  /** @bug check for NULL pointer missing! */\n  for (int i = 0; i &lt; NBCLIENT; ++i) {\n    int numeroTel = 600000000 + (rand() % NBCLIENT);\n    int prixAppel = (rand() % 400) + 1;\n    initClient(clients + i, numeroTel, 1, prixAppel); \n    /* &amp;clients[i] would've worked as well as clients + i */\n  }\n  return clients;\n}\n\nint main()\n{\n  Client *clients = createData();\n  for (int i = 0; i &lt; NBCLIENT; ++i) {\n    Client *pClient = clients + i; /* or: &amp;clients[i] would work as well */\n    printf(\"%2d.: %d, %d, %d\\n\",\n      i, pClient-&gt;num_tel, pClient-&gt;nbr_appel, pClient-&gt;cout);\n  }\n  free(clients);\n  return 0;\n}\n</code></pre>\n\n<p>Compiled and tested again on <a href=\"https://ideone.com/PkjYxv\" rel=\"nofollow noreferrer\"><strong>ideone</strong></a>. Output was:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> 0.: 600000003, 1, 87\n 1.: 600000017, 1, 116\n 2.: 600000013, 1, 336\n 3.: 600000006, 1, 93\n 4.: 600000009, 1, 222\n 5.: 600000002, 1, 28\n 6.: 600000010, 1, 60\n 7.: 600000003, 1, 327\n 8.: 600000000, 1, 227\n 9.: 600000012, 1, 137\n10.: 600000011, 1, 169\n11.: 600000007, 1, 30\n12.: 600000002, 1, 331\n13.: 600000002, 1, 324\n14.: 600000007, 1, 336\n15.: 600000009, 1, 203\n16.: 600000002, 1, 259\n17.: 600000009, 1, 168\n18.: 600000013, 1, 57\n19.: 600000011, 1, 43\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9156294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/145774436082903/picture?type=large", "display_name": "Ya Ssou", "link": "https://stackoverflow.com/users/9156294/ya-ssou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 48183133, "answer_count": 1, "score": -3, "last_activity_date": 1515573436, "creation_date": 1515568603, "last_edit_date": 1515570761, "question_id": 48182135, "link": "https://stackoverflow.com/questions/48182135/a-function-that-returns-a-table-of-struct-in-c", "title": "A function that returns a table of struct in C", "body": "<p>I have a struct call Client , and a function <code>initClient</code> that create such struct.</p>\n\n<p>Now I want to implement a function that creates a <code>table[20000]</code> of this struct, but I couldn't figure out the right syntax of the returned data. Is it <code>Client**</code> or <code>Client[]</code> ?...\nThis is my code: <code>client.h</code>:</p>\n\n<pre><code> struct sClient\n {\n     int num_tel;\n     int nbr_appel;\n     int cout;\n  };\n\n  typedef struct sClient Client;\n  Client * initClient(int num_tel, int nbr_appel,int cout);\n  Client *createData();\n</code></pre>\n\n<p>and main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"client.h\"\n\nClient* initClient(int num_tel, int nbr_appel,int cout){\n    Client *c = (Client *) malloc(sizeof(Client)); \n    c-&gt; num_tel =num_tel;\n    c-&gt; nbr_appel= nbr_appel; \n    c-&gt; cout= cout;\n\n    return c; \n}\n\nClient* createData(){\n    // Number of clients\n    #define NBCLIENT 20 \n    Client* tab[NBCLIENT];\n    Client *c; \n    int i,numeroTel,prixAppel;\n\n    for(i=0;i&lt;NBCLIENT;i++)\n    {\n        // Generation of a random num_tel\n        numeroTel = 600000000+(rand() % NBCLIENT);   \n        prixAppel = (rand() % 400)+1; \n        c=initClient(numeroTel,1,prixAppel);\n        tab[i]=c;      \n    }   \n    return tab;    \n}\n\nint main(int argc, char *argv[])\n{\n    createData();\n    system(\"PAUSE\");    \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "enums", "language-lawyer", "declaration"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 13, "creation_date": 1515568147, "post_id": 48182007, "comment_id": 83343589, "body": "C and C++ are very different languages, even though they share a lot of the syntax. One such thing is how enumerations work. Just because something looks the same in C and C++, doesn&#39;t mean they actually are the same."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1515568300, "post_id": 48182007, "comment_id": 83343646, "body": "@KeineLust I believe that is only true with <code>enum class</code>. Ordinary C-style enums are still defined in the enclosing scope."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1515568338, "post_id": 48182007, "comment_id": 83343657, "body": "Your C++ compiler doesn&#39;t give an error because it follows C++ language rules, rather than C language rules. If it followed C rules it would be a C compiler, wouldn&#39;t it?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1515568414, "post_id": 48182007, "comment_id": 83343680, "body": "@SilvioMayolo, you are right, I misread the question"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515568549, "post_id": 48182007, "comment_id": 83343746, "body": "For enumerations, you might want to see e.g. <a href=\"http://en.cppreference.com/w/c/language/enum\" rel=\"nofollow noreferrer\">this C reference</a> and <a href=\"http://en.cppreference.com/w/cpp/language/enum\" rel=\"nofollow noreferrer\">this C++ reference</a>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1515568723, "post_id": 48182007, "comment_id": 83343844, "body": "That one exemple of why C is not C++ is not C. By the way, finally a question correctly tagged as C and C++ \\o/."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 10, "last_activity_date": 1515569052, "creation_date": 1515569052, "answer_id": 48182239, "question_id": 48182007, "link": "https://stackoverflow.com/questions/48182007/redeclare-variable-inside-enum/48182239#48182239", "title": "Redeclare variable inside enum", "body": "<p>It doesn't give a re-declaration error because the enumerator is introduced into class scope. Recall that a struct and class are mostly interchangeable in C++. The scope of <code>S</code> contains the enumerator <code>i</code>.</p>\n\n<p>In C however, <code>struct S</code> doesn't define a scope. There are only 4 types of scope in C: function, file, block, and function prototype. As such, <code>i</code> is introduced into file scope where the variable <code>i</code> is already defined.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 48182239, "answer_count": 1, "score": 6, "last_activity_date": 1515585472, "creation_date": 1515568049, "last_edit_date": 1515585472, "question_id": 48182007, "link": "https://stackoverflow.com/questions/48182007/redeclare-variable-inside-enum", "title": "Redeclare variable inside enum", "body": "<p>In C, If we re-declare variable inside <code>enum</code>, then compiler gives an error that \"'i' redeclared as different kind of symbol\".It Ok.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint i = 10;\n\nstruct S \n{ \n    enum \n    {\n        i = 20\n    }e; \n};\n\nint main()\n{\n    printf(\"%d\\n\", i);\n}\n</code></pre>\n\n<p>But, In C++, If we redeclare variable inside enum, then it's working fine.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint i = 10;\n\nstruct S \n{ \n    enum \n    {\n        i = 20\n    }e; \n};\n\nint main()\n{\n    cout&lt;&lt;i&lt;&lt;endl;\n}\n</code></pre>\n\n<p>I don't understand, Why doesn't C++ compiler gives an error for redeclaration variable?</p>\n"}, {"tags": ["c", "opengl", "mouse", "glut", "mouseclick-event"], "answers": [{"tags": [], "owner": {"reputation": 675, "user_id": 2094911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab143598424cc6e4ec05b797c12a531?s=128&d=identicon&r=PG", "display_name": "Matso", "link": "https://stackoverflow.com/users/2094911/matso"}, "is_accepted": false, "score": 0, "last_activity_date": 1515570724, "last_edit_date": 1515570724, "creation_date": 1515569386, "answer_id": 48182319, "question_id": 48181748, "link": "https://stackoverflow.com/questions/48181748/not-getting-an-output-for-opengl-to-print-line-using-mouse-click/48182319#48182319", "title": "Not getting an output for OpenGL to print line using mouse click", "body": "<p>First of all You do not actually draw anything - function <code>drawl</code> is called only when You click every second time. To draw a line (or anything) one need to call a drawing routine every frame, like the <code>Display</code> function is called.</p>\n\n<p>Second thing is that position given in <code>mouse</code> callback function is not suitable for defining a point in 3D. One have to translate them onto proper coordinates (that is ranging from -1 to 1 usually) to be able to use them as drawing data. Otherwise GL will try to draw some lines out of view, which means nothing will be drawn.</p>\n\n<p>I would reorganize the application structure a bit - when You get <code>mouse</code> call instead of calling <code>drawl</code> every other call to it, store the properly translated positions the <code>mouse</code> function gives You in some global variable and do the drawing in <code>Display</code> routine. Also <code>gluOrtho2D</code> should usually be called every frame as well. In Your call to it You have the parameters wrong - see the <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/gluOrtho2D.xml\" rel=\"nofollow noreferrer\">reference page</a> for details.</p>\n"}, {"tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 1, "last_activity_date": 1516486860, "last_edit_date": 1516486860, "creation_date": 1516486103, "answer_id": 48361590, "question_id": 48181748, "link": "https://stackoverflow.com/questions/48181748/not-getting-an-output-for-opengl-to-print-line-using-mouse-click/48361590#48361590", "title": "Not getting an output for OpenGL to print line using mouse click", "body": "<p>For this answer I ported the answer which I had given to the question <a href=\"https://stackoverflow.com/questions/47123256/draw-a-polygon-in-opengl-glut-with-mouse/47124170#47124170\">Draw a polygon in OpenGL GLUT with mouse</a> from C++ to C.</p>\n\n<p><br/>\nYou have to separate the mouse events and the drawing function.</p>\n\n<p>In the mouse (<code>void mouse(int button, int state, int x, int y)</code>) event you should just collect the inputs. </p>\n\n<ul>\n<li><p>If the left mouse button is pressed, the following function adds a the X coordinate of the mouse position to the array <code>ptListX</code> and the Y-coordinate to the array <code>ptListY</code>.  </p></li>\n<li><p>If the right button is pressed the polygon is marked closed. If the left button is pressed again, the polygon is cleared and the process restarts.</p></li>\n</ul>\n\n<p></p>\n\n<pre><code>int wndSizwX = 800, wndSizeY = 500; // size of the window\nint mouseX = 0, mouseY = 0;         // current mouse position\n\n#define MAX_PTS 100\nint ptListX[MAX_PTS]; // X coordinate ot the input points \nint ptListY[MAX_PTS]; // Y coordinate of the input points\nint noOfPts = 0;      // number of input points\nint closed = 0;       // marke polygon \"closed\"\n\nvoid mouse(int button, int state, int x, int y)\n{\n    mouseX = x;\n    mouseY = y;\n\n    if (button == GLUT_LEFT_BUTTON &amp;&amp; state == GLUT_DOWN)\n    {\n        if (closed || noOfPts &gt;= MAX_PTS - 1)\n            noOfPts = 0; // restart the polygon\n        closed = 0;\n        ptListX[noOfPts] = mouseX; \n        ptListY[noOfPts] = mouseY;\n        noOfPts ++;\n    }\n    if ( button == GLUT_RIGHT_BUTTON &amp;&amp; state == GLUT_DOWN )\n        closed = 1;\n}\n</code></pre>\n\n<p>In a mouse move event function the current mouse position can be tracked:</p>\n\n<pre><code>void mouse_move(int x, int y)\n{\n    mouseX = x;\n    mouseY = y;\n    glutPostRedisplay();\n}\n</code></pre>\n\n<p>In the main loop (<code>Display</code> function), the current list of points is connected to lines and continuously drawn. If the <code>cloesd</code> flag is set, then the polygon is closed. Else a line from the last point in the list to the current mouse position is drawn.</p>\n\n<pre><code>void Display()\n{\n    glClearColor(0.5f, 0.5f, 0.5f, 1.0f);  \n    glClear(GL_COLOR_BUFFER_BIT);  \n\n    if (noOfPts)\n    {\n        glLineWidth(5.0);\n        glColor3f(0.0f,1.0f,0.0f);\n        glBegin(GL_LINE_STRIP);\n        for (int i=0; i&lt;noOfPts; ++i )\n            glVertex2f( (float)ptListX[i], (float)ptListY[i] );\n        if ( closed )\n            glVertex2f( (float)ptListX[0], (float)ptListY[0] );\n        else\n            glVertex2f( (float)mouseX, (float)mouseY );\n        glEnd();\n    }\n\n    glFlush();  \n}\n</code></pre>\n\n<p>The registration of the mouse move event has to be add to the main program by <code>glutPassiveMotionFunc</code>.<br/>\nFurther the Y-Axis of the orthographic projection has to be flipped, to match the view space to the mouse coordinates: </p>\n\n<pre><code>void main(int argc, char **argv)\n{\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);\n    glutInitWindowSize(wndSizwX,wndSizeY);\n    glutInitWindowPosition(0,0);\n    glutCreateWindow(\"Mouse\");\n\n    gluOrtho2D(0, wndSizwX, wndSizeY, 0); // flip Y \n\n    glutDisplayFunc(Display);\n    glutMouseFunc(mouse);\n    glutPassiveMotionFunc(mouse_move);\n    glutMainLoop();\n}\n</code></pre>\n\n<p>See the preview:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uFT4K.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uFT4K.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 172, "user_id": 7241680, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-28PymPFwyeg/AAAAAAAAAAI/AAAAAAAAFSc/NVN-7ADDPKs/photo.jpg?sz=128", "display_name": "GauthamGAjith", "link": "https://stackoverflow.com/users/7241680/gauthamgajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 1, "accepted_answer_id": 48361590, "answer_count": 2, "score": 1, "last_activity_date": 1516554646, "creation_date": 1515566950, "last_edit_date": 1516554646, "question_id": 48181748, "link": "https://stackoverflow.com/questions/48181748/not-getting-an-output-for-opengl-to-print-line-using-mouse-click", "title": "Not getting an output for OpenGL to print line using mouse click", "body": "<p>My aim is to draw a line using mouse click. When you click the first click it reads the coordinates then when for the nest click it will draw the line using GL_LINES with first and second points. </p>\n\n<pre><code>int first, x1, yi, x2, yj, ww = 600, wh = 400;\nvoid drawl()\n{\n    glClear(GL_COLOR_BUFFER_BIT);  \n    glLineWidth(5.00);\n    glColor3f(0,1,0);\n    glBegin(GL_LINES);\n        glVertex2i(x1,yi);\n        glVertex2i(x2,yj);\n    glEnd();\n    glFlush();\n}\n\nvoid Display()\n{\n    glClearColor(0.5, 0.5, 0.5, 1.0);  \n    glColor3f(0.7, 0.4, 0.0);  \n    glClear(GL_COLOR_BUFFER_BIT);  \n    glFlush();  \n}\n\nvoid mouse(int button, int state, int x, int y)\n{\n    if(button == GLUT_LEFT_BUTTON &amp;&amp; state == GLUT_DOWN)\n    {\n        if(first == 0)\n        {       \n            first++;\n            x1 = x;\n            yi = wh - y;\n        }\n        else\n        {\n            x2 = x;\n            yj = wh - y;\n            drawl();\n            printf(\"%d,%d,%d,%d\\n\",x1,yi,x2,yj);\n            first--;\n        }   \n\n    }\n}\n\nvoid main(int argc, char **argv)\n{\n    first = 0;\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);\n    glutInitWindowSize(800,500);\n    glutInitWindowPosition(0,0);\n    glutCreateWindow(\"Mouse\");\n    gluOrtho2D(0,800,0,500);\n    glutDisplayFunc(Display);\n    glutMouseFunc(mouse);\n    glutMainLoop();\n} \n</code></pre>\n\n<p>Output I got is given below.  It is not drawing the line. Should I include myinit() function and why?</p>\n\n<p><a href=\"https://i.stack.imgur.com/3GcGB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3GcGB.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "macros", "c-preprocessor", "preprocessor", "alphanumeric"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1515563799, "post_id": 48181111, "comment_id": 83342085, "body": "Google <code>man isalnum</code> - hey presto"}, {"owner": {"reputation": 600, "user_id": 6777125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wgsOB.jpg?s=128&g=1", "display_name": "Krunal Shah", "link": "https://stackoverflow.com/users/6777125/krunal-shah"}, "edited": false, "score": 0, "creation_date": 1515563811, "post_id": 48181111, "comment_id": 83342093, "body": "using isalnum() function right ?"}, {"owner": {"reputation": 45, "user_id": 8423084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8UuP.jpg?s=128&g=1", "display_name": "Sillyon", "link": "https://stackoverflow.com/users/8423084/sillyon"}, "edited": false, "score": 0, "creation_date": 1515564014, "post_id": 48181111, "comment_id": 83342163, "body": "no. we need to define isalnum ourselves.(with using #define macro or macros, i don&#39;t know.)"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1515564389, "post_id": 48181111, "comment_id": 83342275, "body": "Description and title doesn&#39;t match. I&#39;m bit confused, can you edit the question @Sillyon ?"}, {"owner": {"reputation": 45, "user_id": 8423084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8UuP.jpg?s=128&g=1", "display_name": "Sillyon", "link": "https://stackoverflow.com/users/8423084/sillyon"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1515564771, "post_id": 48181111, "comment_id": 83342391, "body": "sorry for that @ThiruShetty. i will try"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1515566637, "post_id": 48181111, "comment_id": 83342977, "body": "Sure, take the time to learn all you can about macros. It&#39;s a great educational endeavor. Then, a year from now, if you have continued to develop as a C programmer, revisit the wisdom of using macros for such purposes and see how much your desire to use them has changed."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515574172, "post_id": 48181111, "comment_id": 83346529, "body": "This question is described as an exam question and was answered so fast that it could have actually been used in an exam. But you have not done so, have you? It is just your preparation for trying a second time to pass that exam, isn&#39;t it? Or maybe you passed that exam and just want to brush up on those questions you could not answer. This is probably an interesting read (for you and for those people who answered fast): <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\" title=\"how do i ask and answer homework questions\">meta.stackoverflow.com/questions/334822/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8423084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8UuP.jpg?s=128&g=1", "display_name": "Sillyon", "link": "https://stackoverflow.com/users/8423084/sillyon"}, "edited": false, "score": 0, "creation_date": 1515567652, "post_id": 48181245, "comment_id": 83343388, "body": "sure, i used this as an example"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1515570568, "post_id": 48181245, "comment_id": 83344664, "body": "Thanks for the fish. Make sure to have another fish ready for me tomorrow."}], "tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": true, "score": 1, "last_activity_date": 1515564399, "creation_date": 1515564399, "answer_id": 48181245, "question_id": 48181111, "link": "https://stackoverflow.com/questions/48181111/find-the-input-is-alphanumeric-or-not-with-using-define-macro-preprocessor-in-c/48181245#48181245", "title": "find the input is alphanumeric or not with using #define macro preprocessor in c", "body": "<p>Here is the macro:</p>\n\n<pre><code>#define IS_ALNUM(x) (((x)&gt;='a' &amp;&amp; (x) &lt;= 'z')) ||((x)&gt;='A' &amp;&amp; (x) &lt;= 'Z')) || (((x)&gt;='0' &amp;&amp; (x) &lt;= '9')))\n</code></pre>\n\n<p>It tests if it is </p>\n\n<ul>\n<li>Between a and z</li>\n<li>Between A and Z</li>\n<li>Between 0 and 9</li>\n</ul>\n\n<p>Quite simple</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 8423084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8UuP.jpg?s=128&g=1", "display_name": "Sillyon", "link": "https://stackoverflow.com/users/8423084/sillyon"}, "is_accepted": false, "score": 0, "last_activity_date": 1515694635, "last_edit_date": 1515694635, "creation_date": 1515567269, "answer_id": 48181844, "question_id": 48181111, "link": "https://stackoverflow.com/questions/48181111/find-the-input-is-alphanumeric-or-not-with-using-define-macro-preprocessor-in-c/48181844#48181844", "title": "find the input is alphanumeric or not with using #define macro preprocessor in c", "body": "<p>i solved this i think, thanks to all of you. that one is working:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define IS_LOWER(x)     ((x) &lt;='z' &amp;&amp; (x) &gt;= 'a')  //then returns 1, else returns 0.\n#define IS_UPPER(x)     ((x) &lt;='Z' &amp;&amp; (x) &gt;= 'A')  //then returns 1, else returns 0.\n#define IS_NUMERIC(x)   ((x) &lt;= 9  &amp;&amp; (x) &gt;=  0 )  //then returns 1, else returns 0.\n\n#define IS_ALPHANUM(x)  (IS_LOWER(x) || IS_UPPER(x) || IS_NUMERIC(x) ? (x) : (-1))\n//then returns x, else returns -1.\n\nint main()\n{\n    int a;\n    a=IS_ALPHANUM('h'); //try h character one for example.\n    printf(\"%d\",a);\n    return 0;\n}\n</code></pre>\n\n<p>have a great coding days</p>\n"}], "owner": {"reputation": 45, "user_id": 8423084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8UuP.jpg?s=128&g=1", "display_name": "Sillyon", "link": "https://stackoverflow.com/users/8423084/sillyon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 1, "accepted_answer_id": 48181245, "answer_count": 2, "score": -5, "last_activity_date": 1515694635, "creation_date": 1515563659, "last_edit_date": 1515564861, "question_id": 48181111, "link": "https://stackoverflow.com/questions/48181111/find-the-input-is-alphanumeric-or-not-with-using-define-macro-preprocessor-in-c", "title": "find the input is alphanumeric or not with using #define macro preprocessor in c", "body": "<p>this is the question what asked in my exam is: \"write cource code of a character taken from user is alphanumeric or not.\"</p>\n\n<p>alphanumeric means--> <strong>A-Z</strong> | <strong>a-z</strong> | <strong>0-9</strong> (alphabetic or numeric)\nif it is return true or someting. help me to solve this question please..</p>\n\n<p>in summary we will build <strong>isalnum()</strong> function ourselves.(with #define macros)</p>\n"}, {"tags": ["c", "math"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9085691"}, "edited": false, "score": 0, "creation_date": 1515560826, "post_id": 48180599, "comment_id": 83341173, "body": "I&#39;ve already done the &quot;easy&quot; parts. I&#39;ve made a recursive descent parser to evaluate the expression, a function to evaluate the result and to convert it to whatever base I wish(up to 16 for now), but now I&#39;ll need to change everything to handle infinitely large inputs that won&#39;t fit in a long long as well as extremely large results. I&#39;m thinking of making functions for each, and I&#39;m thinking of a linked list or array to do addition/subtraction/multiplication, but while I&#39;m working on validation to ensure the expression is valid, I&#39;d like to see if there are more efficient ways to tackle it."}, {"owner": {"reputation": 5242, "user_id": 1236858, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2729114e38602943ce02eef8b2aeccf8?s=128&d=identicon&r=PG", "display_name": "rcs", "link": "https://stackoverflow.com/users/1236858/rcs"}, "edited": false, "score": 0, "creation_date": 1515560886, "post_id": 48180599, "comment_id": 83341188, "body": "Perhaps you can use some library like GMP."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9085691"}, "reply_to_user": {"reputation": 5242, "user_id": 1236858, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2729114e38602943ce02eef8b2aeccf8?s=128&d=identicon&r=PG", "display_name": "rcs", "link": "https://stackoverflow.com/users/1236858/rcs"}, "edited": false, "score": 0, "creation_date": 1515561001, "post_id": 48180599, "comment_id": 83341224, "body": "No external libraries are allowed. Read to read the input from stdin, write to output the result and error messages, malloc, and free are the only functions permitted for the assignment."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1515561186, "post_id": 48180599, "comment_id": 83341276, "body": "By the way, in a deleted answer on the link I provided above was a reference to <a href=\"http://www3.cs.stonybrook.edu/~skiena/392/programs/bignum.c\" rel=\"nofollow noreferrer\">this C program</a> which may or may not be of help to you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9085691"}, "edited": false, "score": 0, "creation_date": 1515561379, "post_id": 48180599, "comment_id": 83341336, "body": "Thanks a ton, I was searching up methods to do it with a string/struct, but I never really considered anything else as I was googling. Arbitrary-precision arithmetic seems like an exact answer to my question provided I can only do it with the 4 functions provided, and that C program seems to be a good reference. Thank you."}], "owner": {"user_type": "does_not_exist", "display_name": "user9085691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1515561591, "answer_count": 0, "score": 0, "last_activity_date": 1515560805, "creation_date": 1515560613, "last_edit_date": 1515560805, "question_id": 48180599, "link": "https://stackoverflow.com/questions/48180599/how-to-add-multiply-subtract-divide-modulus-two-arbitrarily-large-numbers-for-an", "closed_reason": "Duplicate", "title": "How to add/multiply/subtract/divide/modulus two arbitrarily large numbers for an arbitrarily large result? Or in specific, how does BC manage it?", "body": "<p>Only functions allowed are write and malloc. </p>\n\n<p>I need to be able to calculate something like <code>45645646554665466546546456456448798789456456465789745321321231231231231231231231231321231321231321231467 * 45645646554665466546546456456448798789456456465789745321321231231231231231231231231321231321231321231467 - (4564564655466546654654645645644879878945645646578974532132123123123123123123123123132123132123132123146745645646554665466546546456456448798789456456465789745321321231231231231231231231231321231321231321231467 + 456456465546654665465464564564487987894564564657897453213212312312312312312312312313212313212313212314674564564655466546654654645645644879878945645646578974532132123123123123123123123123132123132123132123146745645646554665466546546456456448798789456456465789745321321231231231231231231231231321231321231321231467)</code></p>\n\n<p>How would I go about doing this(and in arbitrary bases to boot, ie. up to base 128 if necessary). </p>\n\n<p>I'm thinking addition/subtraction/multiplication won't be too bad, just very tedious, but it seems like modulus/division will be trouble. </p>\n"}, {"tags": ["c", "size", "notepad"], "comments": [{"owner": {"reputation": 597, "user_id": 2869323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rtIcR.jpg?s=128&g=1", "display_name": "Vitor Figueredo", "link": "https://stackoverflow.com/users/2869323/vitor-figueredo"}, "edited": false, "score": 0, "creation_date": 1515559743, "post_id": 48180443, "comment_id": 83340869, "body": "I THINK you might be counting your line breaks. You can read a file, looking for line breaks do your properties might be considering that."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1515560348, "post_id": 48180443, "comment_id": 83341037, "body": "If you&#39;re running this on Windows, the line endings in the file will be two characters: carriage return plus line feed. But <code>fgets</code> will only see the line feed. So what you&#39;re seeing makes sense if there&#39;s nothing after the <code>c</code> on the last line, and you&#39;re running on Windows."}, {"owner": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 0, "creation_date": 1515573420, "post_id": 48180443, "comment_id": 83346050, "body": "You&#39;re missing the curly brackets for delimiting the <code>while</code> body."}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 8718926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eedb47e5b986617bc0bf97a7e5ed1007?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishk Tanwar", "link": "https://stackoverflow.com/users/8718926/kanishk-tanwar"}, "edited": false, "score": 0, "creation_date": 1515560603, "post_id": 48180511, "comment_id": 83341111, "body": "That means strlen function did not count carriage return right?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 142, "user_id": 8718926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eedb47e5b986617bc0bf97a7e5ed1007?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishk Tanwar", "link": "https://stackoverflow.com/users/8718926/kanishk-tanwar"}, "edited": false, "score": 1, "creation_date": 1515567214, "post_id": 48180511, "comment_id": 83343206, "body": "@kanishktanwar: <code>strlen</code> counts all characters (including special characters like <code>\\n</code>, <code>\\r</code> ...) until the NUL character (<code>&#39;\\0&#39;</code> or simply <code>0</code>) is reached."}], "tags": [], "owner": {"reputation": 2352, "user_id": 8881495, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D8qrxYu9G-E/AAAAAAAAAAI/AAAAAAAAABs/KWxB0w0phBY/photo.jpg?sz=128", "display_name": "Fifi", "link": "https://stackoverflow.com/users/8881495/fifi"}, "is_accepted": true, "score": 1, "last_activity_date": 1515572453, "last_edit_date": 1515572453, "creation_date": 1515559966, "answer_id": 48180511, "question_id": 48180443, "link": "https://stackoverflow.com/questions/48180443/small-snippet-for-finding-text-file-size/48180511#48180511", "title": "Small snippet For Finding Text File Size", "body": "<p>Check how newline is encoded in your file. Depending on your system, new line can be encoded on two characters in your strings:</p>\n\n<ul>\n<li>Carriage Return (\\r or CR)</li>\n<li>Line Feed (\\n or LF)</li>\n<li><strong>Both</strong> Carriage Return + Line feed (\\r\\n or CRLF)</li>\n</ul>\n\n<p>Check the <a href=\"https://en.wikipedia.org/wiki/Newline.\" rel=\"nofollow noreferrer\">Wikipedia page</a> for more details</p>\n"}], "owner": {"reputation": 142, "user_id": 8718926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eedb47e5b986617bc0bf97a7e5ed1007?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishk Tanwar", "link": "https://stackoverflow.com/users/8718926/kanishk-tanwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 48180511, "answer_count": 1, "score": -1, "last_activity_date": 1515572453, "creation_date": 1515559449, "question_id": 48180443, "link": "https://stackoverflow.com/questions/48180443/small-snippet-for-finding-text-file-size", "title": "Small snippet For Finding Text File Size", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\nFILE *fp;\nchar s[80];\nint len=0;\n\n\nfp=fopen(\"pink.txt\",\"r\");\n\n\nwhile(fgets(s,79,fp)!=NULL)\n\nlen=len+strlen(s);   /* length of each string */\n       /* spaces and newlines are also counted */\n\nfclose(fp);\n\nprintf(\"length of file = %d\",len);\n\n    return 0;\n}\n</code></pre>\n\n<p>i worked on this snippet it counts the string and add them into a variable len,\nwhich is eventually used as size of the text, as characters occupy one byte,\nbut when i click on the properties of the notepad it gives me totally wrong answer. 15 bytes vs 18 bytes on notepad, also if i remove every new line and spaces both my code and notepad gives accurate answer, so i know its because of new line, can some one explain what is wrong.</p>\n\n<p>here is what inside the text file.</p>\n\n<pre><code>qwe\nert\nasd\nzxc\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515559020, "post_id": 48180246, "comment_id": 83340685, "body": "You really have a local header <code>&quot;stdlib.h&quot;</code>?? and <code>&quot;stdio.h&quot;</code>?? and ...?? Seems like you are mistaking the <code>&quot;</code> for <code>&lt;&gt;</code>?"}, {"owner": {"reputation": 505, "user_id": 8739916, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cd397da0457716a13e78bc2fd1343811?s=128&d=identicon&r=PG&f=1", "display_name": "JollyRoger", "link": "https://stackoverflow.com/users/8739916/jollyroger"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515559599, "post_id": 48180246, "comment_id": 83340832, "body": "@DavidC.Rankin It works well without adding mm_print_mem function. But I change after saw your comment but it did not solve my problem."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515559958, "post_id": 48180246, "comment_id": 83340930, "body": "Let me take a closer look. Also, why are you declaring <code>metadata</code> as a global pointer instead of declaring in <code>main()</code> and passing as a parameter to your functions, as required? (and it&#39;s <code>-Wextra</code> not <code>-Werror</code>)"}, {"owner": {"reputation": 505, "user_id": 8739916, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cd397da0457716a13e78bc2fd1343811?s=128&d=identicon&r=PG&f=1", "display_name": "JollyRoger", "link": "https://stackoverflow.com/users/8739916/jollyroger"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515560549, "post_id": 48180246, "comment_id": 83341091, "body": "Because I want that user should not interact with metadata informations, just the allocation functions that they should see. And -Wextra did not work as well."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515565770, "post_id": 48180246, "comment_id": 83342717, "body": "Well, whether you passing the list as a parameter prevents just as much user interaction with the metadata information as declaring it global does (and you avoid potential name collisions, etc.) Yes, <code>-Werror</code> is fine when creating a shared object lib, I glossed over that part until I looked close at what you were doing. Take a look at the example and let me know if you have questions."}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 8739916, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cd397da0457716a13e78bc2fd1343811?s=128&d=identicon&r=PG&f=1", "display_name": "JollyRoger", "link": "https://stackoverflow.com/users/8739916/jollyroger"}, "edited": false, "score": 0, "creation_date": 1515592112, "post_id": 48181420, "comment_id": 83357476, "body": "Thanks for the answer."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1515565389, "creation_date": 1515565389, "answer_id": 48181420, "question_id": 48180246, "link": "https://stackoverflow.com/questions/48180246/implementing-dynamic-memory-management-functions/48181420#48181420", "title": "Implementing Dynamic Memory Management Functions", "body": "<p>You make things a bit difficult by not providing a <a href=\"http://stackoverflow.com/help/mcve\"><strong>A Minimal, Complete, and Verifiable example</strong></a>, but a short example will help. Without seeing your <code>load</code> and <code>alloc</code> functions, you leave us guessing a bit at exactly where your problem is located or the extent of you problems.</p>\n\n<p>That said a short example illustrating your <code>mm_print_mem();</code> function should at least get that part straightened out. (<strong>note:</strong> the example uses a <em>cirular linked list</em> where the last node points to the first and first->prev points to the last. You can adjust the test and assignments for <code>metadata-&gt;prev</code> and <code>last-&gt;next</code> if you want <code>NULL</code> at both ends)</p>\n\n<p>While you can use <code>#pragma once</code>, you will find greater portability just using traditional header-guards to prevent multiple includes, e.g. <code>#ifndef HEADERNAME</code>, then <code>#define</code> it, e.g.</p>\n\n<pre><code>#ifndef  __mm_alloc_h__\n#define  __mm_alloc_h__  1\n\n#include &lt;stdlib.h&gt;\n\ntypedef struct METADATA {\n    struct METADATA *next;\n    struct METADATA *prev;\n    int free;\n    size_t size;\n} METADATA;\n\nMETADATA *metadata;\n\n// void *mm_malloc(size_t size);\n// void *mm_realloc(void *ptr, size_t size);\n// void mm_free(void *ptr);\nvoid mm_print_mem();\n\n#endif\n</code></pre>\n\n<p>Your <code>mm_alloc.c</code> is fine, but your loop control was a bit strange with the <em>magic number</em> <code>10</code> included as a condition. With the example list, you simply iterate and increment nodes until <code>currentPtr-&gt;next</code> (e.g. <code>currentPtr</code> after assignment) is equal to <code>metadata</code> (completing the circle)</p>\n\n<pre><code>#include \"mm_alloc.h\"\n#include &lt;stdio.h&gt;\n\nvoid mm_print_mem() {\n\n    METADATA *currentPtr = metadata;\n\n    printf (\"\\nstart_addr\\tsize\\tfree\\tprev\\t\\tnext\\n\"\n            \"=========================================================\\n\"\n            \"HEAD OF LL %p\\n\", metadata);\n\n    for (;;) {\n        printf (\"%p\\t%d\\t%d\\t%p\\t%p\\n\", currentPtr, (int)currentPtr-&gt;size,\n                currentPtr-&gt;free,currentPtr-&gt;prev,currentPtr-&gt;next);\n        currentPtr = currentPtr-&gt;next;\n        if (currentPtr == metadata)\n            break;\n    }\n}\n</code></pre>\n\n<p>I wrote a simple test program that allocates and fills <code>20</code> nodes for you showing the independent handling of the 1st and remaining nodes, e.g,</p>\n\n<pre><code>#include \"mm_alloc.h\"\n#include &lt;stdio.h&gt;\n\n#define MAX 20\n\nint main (void) {\n\n    int i;\n\n    for (i = 0; i &lt; MAX; i++) {\n        METADATA *node = malloc (sizeof *node);\n        if (!node) {\n            perror (\"malloc node\");\n            return 1;\n        }\n        node-&gt;next = node-&gt;prev = NULL;\n        node-&gt;free = MAX - i - 1;\n        node-&gt;size = i;\n\n        if (!metadata) {        /* 1st node is self-referencing */\n            node-&gt;prev = node;  /* in circular linked-list */\n            node-&gt;next = node;\n            metadata = node;\n        }\n        else {  /* add rest at end as metadata-&gt;prev */\n            node-&gt;prev = metadata-&gt;prev;\n            node-&gt;next = metadata;\n            metadata-&gt;prev-&gt;next = node;\n            metadata-&gt;prev = node;\n        }\n    }\n    mm_print_mem();\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> you should free the node when you are done with them)</p>\n\n<p><strong>Compile Shared Object Library &amp; Test Program</strong></p>\n\n<pre><code>$ gcc -Wall -Werror -fPIC -o mm_alloc.o -c mm_alloc.c\n$ gcc -shared -o libmm_alloc.so mm_alloc.o\n</code></pre>\n\n<p>When compiling the test program, make sure your program can find your shared library. using the linker option <code>-rpath</code> is a good way to specify the location for a custom library if not in the standard library search path locations. (just note it must be in the same place on any system you copy it too)</p>\n\n<p>(line-continuation are used below to allow the compile string to fit)</p>\n\n<pre><code>$ gcc -L\"/path/to/your/lib/dir\" \\\n  -Wl,-rpath=\"/path/to/your/lib/dir\" \\\n  -Wall -o mm_alloc_tst mm_alloc_tst.c -lmm_alloc\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./mm_alloc_tst\n\nstart_addr      size    free    prev            next\n=========================================================\nHEAD OF LL 0x208d010\n0x208d010       0       19      0x208d3a0       0x208d040\n0x208d040       1       18      0x208d010       0x208d070\n0x208d070       2       17      0x208d040       0x208d0a0\n0x208d0a0       3       16      0x208d070       0x208d0d0\n0x208d0d0       4       15      0x208d0a0       0x208d100\n0x208d100       5       14      0x208d0d0       0x208d130\n0x208d130       6       13      0x208d100       0x208d160\n0x208d160       7       12      0x208d130       0x208d190\n0x208d190       8       11      0x208d160       0x208d1c0\n0x208d1c0       9       10      0x208d190       0x208d1f0\n0x208d1f0       10      9       0x208d1c0       0x208d220\n0x208d220       11      8       0x208d1f0       0x208d250\n0x208d250       12      7       0x208d220       0x208d280\n0x208d280       13      6       0x208d250       0x208d2b0\n0x208d2b0       14      5       0x208d280       0x208d2e0\n0x208d2e0       15      4       0x208d2b0       0x208d310\n0x208d310       16      3       0x208d2e0       0x208d340\n0x208d340       17      2       0x208d310       0x208d370\n0x208d370       18      1       0x208d340       0x208d3a0\n0x208d3a0       19      0       0x208d370       0x208d010\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"comments": [{"owner": {"reputation": 505, "user_id": 8739916, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cd397da0457716a13e78bc2fd1343811?s=128&d=identicon&r=PG&f=1", "display_name": "JollyRoger", "link": "https://stackoverflow.com/users/8739916/jollyroger"}, "edited": false, "score": 0, "creation_date": 1515592100, "post_id": 48182536, "comment_id": 83357465, "body": "Thanks for the answer."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1515570360, "creation_date": 1515570360, "answer_id": 48182536, "question_id": 48180246, "link": "https://stackoverflow.com/questions/48180246/implementing-dynamic-memory-management-functions/48182536#48182536", "title": "Implementing Dynamic Memory Management Functions", "body": "<p>You have at least a problem in the declaration of the global variable <code>metadata</code>. It is declared as <code>METADATA *metadata;</code> in an <strong>included</strong> file. So it has correctly external linkage, but is <em>defined</em> in every translation unit, when one single <em>definition</em> should exist in a full program. Not doing so is explicitely undefined behaviour, with no diagnostic required.</p>\n\n<p>There are different ways to fix that problem: </p>\n\n<ul>\n<li><p>declare it extern in the include file</p>\n\n<pre><code>extern METADATA *metadata;\n</code></pre>\n\n<p>and define it in only one translation unit without the <code>extern</code> specifier:</p>\n\n<pre><code>#include \"mm_alloc.h\"    // extern declaration\n...\nMETADATA * metadata;     // single definition in whole program\n</code></pre></li>\n<li><p>put all the library functions in one single translation unit (if it makes sense), <em>define</em> <code>metadata</code> in that file and remove any reference to it from the mm_alloc.h file. After all, it is private data for the library...</p></li>\n<li><p>remove the reference to <code>metadata</code> from the mm_alloc.h include file which should only declare the external interface for the library, <em>define</em> it in one single file of the library (at file level without the <code>extern</code> specifier) and <em>declare</em> it in all other files from the library as <code>extern METADATA *metadata;</code></p></li>\n</ul>\n\n<p>Without seeing the source for the other functions I cannot say whether there are other problems...</p>\n"}], "owner": {"reputation": 505, "user_id": 8739916, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cd397da0457716a13e78bc2fd1343811?s=128&d=identicon&r=PG&f=1", "display_name": "JollyRoger", "link": "https://stackoverflow.com/users/8739916/jollyroger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 48181420, "answer_count": 2, "score": 0, "last_activity_date": 1515570360, "creation_date": 1515557976, "question_id": 48180246, "link": "https://stackoverflow.com/questions/48180246/implementing-dynamic-memory-management-functions", "title": "Implementing Dynamic Memory Management Functions", "body": "<p>I tryed to implement dynamic memory managemet functions and succeed. However when I try to implement another function that prints some information about memory with the exact same way, I got segmentation fault. I am using Ubuntu, gcc.</p>\n\n<p>Here is my related code:</p>\n\n<p>In mm_alloc.c: (Other functions malloc, free etc. are also here)</p>\n\n<pre><code>#include \"mm_alloc.h\"\n#include \"stdlib.h\"\n#include \"stdio.h\"\n#include \"unistd.h\"\n#include \"string.h\"\n\nvoid mm_print_mem() {\n\n   printf( \"\\nstart_addr\\tsize\\tfree\\tprev\\tnext\\n\");\n   printf(\"=============================\\n\");\n\n    printf(\"HEAD OF LL %p\\n\", metadata);\n    METADATA *currentPtr = metadata;\n    int i = 0;\n    while (currentPtr!= NULL  &amp;&amp; i &lt;= 10) {\n        printf(\"%p\\t%d\\t%d\\t%p\\t%p\\n\", currentPtr, (int)currentPtr-\n&gt;size, currentPtr-&gt;free,currentPtr-&gt;prev,currentPtr-&gt;next);\n        if (currentPtr-&gt;next == NULL) break;\n        currentPtr = currentPtr-&gt;next;\n        i++;\n    }\n    return;\n}\n</code></pre>\n\n<p>mm_alloc.h:</p>\n\n<pre><code>#pragma once\n\n#include &lt;stdlib.h&gt;\n\ntypedef struct METADATA{\n    struct METADATA *next;\n    struct METADATA *prev;\n    int free;\n    size_t size;\n}METADATA;\n\nMETADATA *metadata;\n\nvoid *mm_malloc(size_t size);\nvoid *mm_realloc(void *ptr, size_t size);\nvoid mm_free(void *ptr);\nvoid mm_print_mem();\n</code></pre>\n\n<p>And the test function. Here, I got segmentation fault when I call mm_print_mem function, others work well.</p>\n\n<pre><code>int main() {\n    load_alloc_functions();\n\n    int *dizi = (int *)mm_malloc(5 * sizeof(int));\n    dizi[4] = 5;\n    dizi[2] = 10;\n    printf(\"%d - %d\\n\", dizi[4], dizi[2]);\n    mm_print_mem();\n\n    return 0;\n}\n</code></pre>\n\n<p>I use these commands on Ubuntu in order to link files and run the test file.</p>\n\n<pre><code>gcc -c -Wall -Werror -fpic mm_alloc.c\ngcc -shared -o libfoo.so 14011085.so\ngcc mm_test.c -o try -ldl\n./try\n</code></pre>\n\n<p>Notice that even the inside of mm_print_mem was empty, it gives segmentation fault as well. Where am I doing wrong?</p>\n"}, {"tags": ["c", "macros", "c-preprocessor", "preprocessor"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1515558889, "post_id": 48180166, "comment_id": 83340643, "body": "Yes - not using macros."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515559200, "post_id": 48180166, "comment_id": 83340729, "body": "Note that with FP numbers employing <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">NaN</a>, this will not return the expected answer for <code>min(1.0, NaN, NaN)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1515559612, "post_id": 48180440, "comment_id": 83340833, "body": "Typical good macro guidelines employ <code>()</code> around each argument usage.  <code>(min2(min2(a, b), (c)))</code> --&gt; <code>(min2(min2((a), (b)), (c)))</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515559859, "post_id": 48180440, "comment_id": 83340895, "body": "@chux Yes, but since <code>min2</code> already has the brackets, I did not add it to <code>min</code>. You can see I added it around <code>c</code> though."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 1, "last_activity_date": 1515565522, "last_edit_date": 1515565522, "creation_date": 1515559435, "answer_id": 48180440, "question_id": 48180166, "link": "https://stackoverflow.com/questions/48180166/find-mina-b-c-or-maxa-b-c-with-using-define-macro-preprocessor-in-c/48180440#48180440", "title": "find min(a,b,c) or max(a,b,c) with using #define macro preprocessor in c", "body": "<p>I think the key point you missed in the question is \"macros\" not and macro. You can simplify this a lot if you break it down further as follows - </p>\n\n<pre><code>#define min2(a, b) ((a) &lt; (b) ? (a) : (b))\n#define min(a, b, c) (min2(min2((a), (b)), (c)))\n</code></pre>\n\n<p>This is also much easier to comprehend. </p>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1515565709, "post_id": 48180535, "comment_id": 83342693, "body": "As per my understanding, the compiler should usually take care of the re-evaluation issues, unless of course the variables are explicitly marked as <code>volatile</code>."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 3, "creation_date": 1515566055, "post_id": 48180535, "comment_id": 83342801, "body": "You have been taught wrong. Consider: <code>max( ++x, y )</code>. What happens to x?"}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": false, "score": 2, "last_activity_date": 1515560133, "creation_date": 1515560133, "answer_id": 48180535, "question_id": 48180166, "link": "https://stackoverflow.com/questions/48180166/find-mina-b-c-or-maxa-b-c-with-using-define-macro-preprocessor-in-c/48180535#48180535", "title": "find min(a,b,c) or max(a,b,c) with using #define macro preprocessor in c", "body": "<p>Yes. Write functions.</p>\n\n<pre><code>int min2( int x, int y        ) { return x &lt; y ? x : y; }\nint min3( int x, int y, int z ) { return min2( x, min2( y, z ) ); }\n</code></pre>\n\n<p>If you wish for pretty, you can write some variadic macros that choose the correct function based on the number of arguments. Those are a bear to write, though.</p>\n\n<p>If you wish to stick with <em>only</em> macros, your choices are much less friendly. <strong>Ajay B</strong>\u2019s solution (fixed as per commentary) works well.</p>\n\n<p>GCC supports some <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.4.2/gcc/Typeof.html#Typeof\" rel=\"nofollow noreferrer\">nice extensions</a> that eliminate re-evaluation issues:</p>\n\n<pre><code>#define max(a,b) \\\n   ({ typeof (a) _a = (a); \\\n       typeof (b) _b = (b); \\\n     _a &gt; _b ? _a : _b; })\n</code></pre>\n\n<p>You can then easily write any n-ary macro you wish that does not suffer from parenthetical or re-evaluation horrors.</p>\n\n<pre><code>#define max3(a,b,c) max(a,max(b,c))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1515560474, "creation_date": 1515560474, "answer_id": 48180584, "question_id": 48180166, "link": "https://stackoverflow.com/questions/48180166/find-mina-b-c-or-maxa-b-c-with-using-define-macro-preprocessor-in-c/48180584#48180584", "title": "find min(a,b,c) or max(a,b,c) with using #define macro preprocessor in c", "body": "<p>Your solution, and all portable macro-based ones, are a good reason why the use of macros should be limited as much as possible. Nowadays, I pretty much use them for little more than conditional compilation.</p>\n\n<p>In terms of defining constants, you are better off with enumerations.</p>\n\n<p>In terms of function-like macros, you're far better off using functions which you can suggest to the compiler to be made inline, or just rely on the compiler to figure that out (they're usually pretty good at that).</p>\n\n<hr>\n\n<p>The reason why function-like macros are a bad idea is because, being simple text substitution, the sequence:</p>\n\n<pre><code>#define mymax(a, b) (a) &gt; (b) ? (a) : (b)\nint x = mymax(y++, complexFunction());\n</code></pre>\n\n<p>will actually evaluate <code>y++</code> and/or call <code>complexFunction()</code> <em>more than once,</em> something a real function would not do.</p>\n\n<p>By all means use them provided you understand the limitations. Me, I'll rely on the compiler doing the right thing for functions so that I don't have to worry about the dark corners of C too much :-)</p>\n"}], "owner": {"reputation": 45, "user_id": 8423084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8UuP.jpg?s=128&g=1", "display_name": "Sillyon", "link": "https://stackoverflow.com/users/8423084/sillyon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3868, "favorite_count": 0, "accepted_answer_id": 48180440, "answer_count": 3, "score": 1, "last_activity_date": 1515565522, "creation_date": 1515557342, "question_id": 48180166, "link": "https://stackoverflow.com/questions/48180166/find-mina-b-c-or-maxa-b-c-with-using-define-macro-preprocessor-in-c", "title": "find min(a,b,c) or max(a,b,c) with using #define macro preprocessor in c", "body": "<p>this is the question what asked in my exam is: \"write cource code of min(a,b,c) with macros in c language.\"</p>\n\n<pre><code>#define min(a,b,c) ((a)&lt;(b)?((a)&lt;(c)?(a):(c)):((b)&lt;(c)?(b):(c)))\n</code></pre>\n\n<p>is there better way to solve min/max(x,y,z) problem?</p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 0, "creation_date": 1515574073, "post_id": 48179615, "comment_id": 83346457, "body": "Why is <code>main()</code> returning -1 ?"}, {"owner": {"reputation": 139, "user_id": 9069919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5998224f44d85dc35724d0810d20c98b?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;n", "link": "https://stackoverflow.com/users/9069919/mart%c3%adn"}, "reply_to_user": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 0, "creation_date": 1515587003, "post_id": 48179615, "comment_id": 83354376, "body": "@schaiba Because the parent process will reach that line <code>(return -1)</code> only if the execution of <code>ps</code> fails and that is not the result I expect. Now, I don&#39;t know if that&#39;s the correct value to return in case of an error, but I definitely would not return 0 because that&#39;s the value to be returned when the process finish normally."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515693981, "post_id": 48179615, "comment_id": 83408124, "body": "strongly suggest using the functions: <code>popen()</code> and <code>pclose()</code>.  The <code>popen()</code> will open a process and run the command (one of its&#39; parameters). and the resulting process will have <code>stdin</code> receiving from the returned pipe pointer from the call to <code>popen()</code>   That will be MUCH easier than all those calls to <code>pipe()</code>, etc"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 9069919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5998224f44d85dc35724d0810d20c98b?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;n", "link": "https://stackoverflow.com/users/9069919/mart%c3%adn"}, "edited": false, "score": 0, "creation_date": 1515586738, "post_id": 48184183, "comment_id": 83354215, "body": "Thank you so much! That did the trick. After your answer now I realize that a pipe &quot;splits&quot; after forking, not before, so I was working with just two file descriptors and closing them, not with the four I&#39;m supposed to work with"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 0, "last_activity_date": 1515576583, "creation_date": 1515576583, "answer_id": 48184183, "question_id": 48179615, "link": "https://stackoverflow.com/questions/48179615/program-to-execute-ps-aux-grep-root-wc-l-using-pipes-in-c/48184183#48184183", "title": "Program to execute ps aux | grep root | wc -l using pipes in C", "body": "<p>Forking program is not excessively complex but requires very strict coding practices because when it goes wrong it is harder to debug. Here I had to first let only parent run (just <code>ps</code>), then parent and child (<code>ps | wc</code>). At that moment I noticed that operations on <code>child_grandchild_fd</code> were interleaved amont operations on <code>parent_child_fd</code>, but it gave expected results.</p>\n\n<p>But at the moment of uncommenting the grandchild part, I noticed that your code was closing <code>child_grandchild_fd</code> <strong>before the fork</strong>, so when you try to use it in grandchild, you only dup already closed handles. So the grandchild reads from a closed handle and exits before using the content of the pipes.</p>\n\n<p>The fix is trivial: just fork at first, then manage the pipe in the branches:</p>\n\n<pre><code>...\nif (pipe(child_grandchild_fd) == -1) {\n  perror(\"Error creating child_grandchild_fd\");\n  exit(EXIT_FAILURE);\n}\n\nclose(parent_child_fd[1]);\n\ndup2(parent_child_fd[0],0);\nclose(parent_child_fd[0]);\n\nif ((grandchild = fork()) == -1) {\n  perror(\"Error forking child\");\n  exit(EXIT_FAILURE);\n}else if(grandchild == 0){\n  close(child_grandchild_fd[1]);\n  dup2(child_grandchild_fd[0],0);\n  execlp(\"/usr/bin/wc\",\"/usr/bin/wc\",\"-l\",(char*)NULL);\n\n  perror(\"Grandchild failed executing wc\");\n  exit(EXIT_FAILURE);\n}\ndup2(child_grandchild_fd[1],1);              // moved after the fork\nclose(child_grandchild_fd[0]);\nclose(child_grandchild_fd[1]);\nexeclp(\"/usr/bin/grep\",\"/usr/bin/grep\",\"root\",(char*)NULL);\nperror(\"Child failed executing grep\");\nexit(EXIT_FAILURE);\n...\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 9069919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5998224f44d85dc35724d0810d20c98b?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;n", "link": "https://stackoverflow.com/users/9069919/mart%c3%adn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 48184183, "answer_count": 1, "score": 0, "last_activity_date": 1515576583, "creation_date": 1515552831, "last_edit_date": 1515552972, "question_id": 48179615, "link": "https://stackoverflow.com/questions/48179615/program-to-execute-ps-aux-grep-root-wc-l-using-pipes-in-c", "title": "Program to execute ps aux | grep root | wc -l using pipes in C", "body": "<p>I have to write a program that displays the same output as if I write <code>ps aux | grep root | wc -l</code> in the terminal. After searching for answers in this web and not finding anything, and trying to understand <a href=\"https://gist.github.com/mplewis/5279108\" rel=\"nofollow noreferrer\">this program</a> from GitHub (which doesn't finish properly when I run it), this has been my humble attempt:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n\n// Program to execute ps aux | grep root | wc -l\n\nint main(int argc, char const *argv[]) {\n\n  int parent_child_fd[2];\n  pid_t child,grandchild;\n\n  if (pipe(parent_child_fd) == -1) {\n    perror(\"Error creating parent_child_fd\");\n    return EXIT_FAILURE;\n  }\n  if ((child = fork()) == -1) {\n    perror(\"Error forking child\");\n    return EXIT_FAILURE;\n  }else if(child == 0){\n    int child_grandchild_fd[2];\n\n    if (pipe(child_grandchild_fd) == -1) {\n      perror(\"Error creating child_grandchild_fd\");\n      exit(EXIT_FAILURE);\n    }\n\n    close(parent_child_fd[1]);\n    close(child_grandchild_fd[0]);\n\n    dup2(parent_child_fd[0],0);\n    close(parent_child_fd[0]);\n    dup2(child_grandchild_fd[1],1);\n    close(child_grandchild_fd[1]);\n\n    if ((grandchild = fork()) == -1) {\n      perror(\"Error forking child\");\n      exit(EXIT_FAILURE);\n    }else if(grandchild == 0){\n      close(child_grandchild_fd[1]);\n      dup2(child_grandchild_fd[0],0);\n      execlp(\"/usr/bin/wc\",\"/usr/bin/wc\",\"-l\",(char*)NULL);\n\n      perror(\"Grandchild failed executing wc\");\n      exit(EXIT_FAILURE);\n    }\n\n    execlp(\"/bin/grep\",\"/bin/grep\",\"root\",(char*)NULL);\n    perror(\"Child failed executing grep\");\n    exit(EXIT_FAILURE);\n  }\n\n  close(parent_child_fd[0]);\n  dup2(parent_child_fd[1],1);\n  close(parent_child_fd[1]);\n\n  execlp(\"/bin/ps\",\"/bin/ps\",\"aux\", (char*)NULL);\n  perror(\"Parent failed executing ps\");\n\n  return -1;\n}\n</code></pre>\n\n<p>However, I always get the same output:</p>\n\n<p><em>Signal 17 (CHLD) caught by ps (3.3.12).\n/bin/ps:ps/display.c:66: please report this bug</em></p>\n\n<p>Could someone give me an explanation why this program doesn't work properly? Because I'm sure it's not because of the supposed bug I have to report.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1515549882, "post_id": 48179260, "comment_id": 83338655, "body": "I presume a <i>singly-linked</i> list? (e.g. no <code>prev</code> pointer?). You can use two-levels of iteration beginning with <code>head</code> and <code>next</code>. Iterate from <code>next</code> to <code>tail</code> on the inner-iteration, then increment <code>head-&gt;next</code> and do it again. Very inefficient, but workable."}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515550069, "post_id": 48179260, "comment_id": 83338686, "body": "@DavidC.Rankin It&#39;s a singly linked list with no head. Could you please show some pseudocode ? I didn&#39;t understand much of what you said."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1515550347, "post_id": 48179260, "comment_id": 83338741, "body": "Sure, it is like nested loop, you will iterate <code>type *outer = head; while (outer-&gt;next != NULL) { type *inner = head-&gt;next; while (inner != NULL) { &#47;* do your comparison *&#47;; inner = inner-&gt;next; } outer = outer-&gt;next }</code>  (where <code>type</code> is whatever struct you are using for your <code>node</code>)"}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515551436, "post_id": 48179260, "comment_id": 83339005, "body": "@DavidC.Rankin thanks."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515591705, "post_id": 48179260, "comment_id": 83357220, "body": "So, the new node must be inserted at the end, too? <b>and</b> be compared exactly once to any other node ? How many new nodes can be generated by one complete <code>N*(N-1)&#47;2</code> pass?"}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515592016, "post_id": 48179260, "comment_id": 83357406, "body": "@wildplasser The function resolve(node* n1, node* n2) will analyse if from the 2 given nodes it is possible to generate a new one."}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515592498, "post_id": 48179260, "comment_id": 83357767, "body": "@wildplasser In my program it is being inserted at the end, but it doesn&#39;t need exctly to be inserted at the end, but I only want to make sure all the nodes, including the new genarated one will be compared with previous as well till there&#39;s no more nodes to be compared."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1515550759, "post_id": 48179314, "comment_id": 83338831, "body": "Yes, like this. I would have coded it a bit differently, but there is nothing wrong with however you want to put the pieces together as long as they work correctly and are readable. Even a <code>for</code> makes sense here as well. (as does <code>while</code> or <code>do - white</code>)."}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "edited": false, "score": 0, "creation_date": 1515591097, "post_id": 48179314, "comment_id": 83356849, "body": "@Roman Muravchuck I found a problema in this code, I think I didn&#39;t express my ideas well, could you please check my edit ?"}, {"owner": {"reputation": 41, "user_id": 5574368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLfeJ.jpg?s=128&g=1", "display_name": "Roman Muravchuck", "link": "https://stackoverflow.com/users/5574368/roman-muravchuck"}, "edited": false, "score": 1, "creation_date": 1515591857, "post_id": 48179314, "comment_id": 83357317, "body": "The problem that newly created nodes is not compared with previous? In this case you need to compare newly created nodes with current and previous. Do this in the resolve() function."}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "edited": false, "score": 0, "creation_date": 1515592275, "post_id": 48179314, "comment_id": 83357584, "body": "@RomanMuravchuck the function resolve is to determine if from 2 nodes a new one can be generated, what could I do inside of it to make sure a new node will be compared with a previous exactly one time ?"}, {"owner": {"reputation": 41, "user_id": 5574368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLfeJ.jpg?s=128&g=1", "display_name": "Roman Muravchuck", "link": "https://stackoverflow.com/users/5574368/roman-muravchuck"}, "edited": false, "score": 0, "creation_date": 1515592422, "post_id": 48179314, "comment_id": 83357703, "body": "Example (again JS): <code>function resolve(curNode, nextNode){     if( checkConditionForNewNode() ){         var newNode = list.push(generateSomeData());         resolve(curNode, newNode);         var current = list.first;         while(current !== null &amp;&amp; current !== curNode){             resolve(current, newNode);             current = current.next;         }     } } </code> In case you always check just next nodes dont care about double comparison with previous."}, {"owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "edited": false, "score": 0, "creation_date": 1515610247, "post_id": 48179314, "comment_id": 83369066, "body": "@RomanMuravchuck I tested and it is still inconsistent, I will try to keep track of the nodes that I already computed  to avoid doing the same calculation, but anyways thanks for the help."}, {"owner": {"reputation": 41, "user_id": 5574368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLfeJ.jpg?s=128&g=1", "display_name": "Roman Muravchuck", "link": "https://stackoverflow.com/users/5574368/roman-muravchuck"}, "edited": false, "score": 0, "creation_date": 1515611765, "post_id": 48179314, "comment_id": 83369790, "body": "Be sure that you compare new node with previous up to the current. Nodes after current node will be compared on the next step, so don&#39;t check they with new node."}], "tags": [], "owner": {"reputation": 41, "user_id": 5574368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wLfeJ.jpg?s=128&g=1", "display_name": "Roman Muravchuck", "link": "https://stackoverflow.com/users/5574368/roman-muravchuck"}, "is_accepted": false, "score": 2, "last_activity_date": 1515550244, "creation_date": 1515550244, "answer_id": 48179314, "question_id": 48179260, "link": "https://stackoverflow.com/questions/48179260/how-to-do-all-the-possible-comparisons-of-2-nodes-in-a-linked-list-that-is-growi/48179314#48179314", "title": "How to do all the possible comparisons of 2 nodes in a linked list that is growing", "body": "<p>Well... you can loop through the list from first to last and compare all next nodes with current one.\nIn this case you ensure that all previous nodes was compared.\nFor example (JavaScript):</p>\n\n<pre><code>var list = new LinkedList();\nfillList(list);\nvar current = list.first;\nwhile(current.next !== null){\n    var current2 = current.next;\n    do{\n        resolve(current, current2);\n        current2 = current2.next;\n    }while(current2 !== null);\n    current = current.next;\n}\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 6868271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a14f95450cb1818f30fa5f4987572f84?s=128&d=identicon&r=PG&f=1", "display_name": "Goun2", "link": "https://stackoverflow.com/users/6868271/goun2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515590967, "creation_date": 1515549659, "last_edit_date": 1515590967, "question_id": 48179260, "link": "https://stackoverflow.com/questions/48179260/how-to-do-all-the-possible-comparisons-of-2-nodes-in-a-linked-list-that-is-growi", "title": "How to do all the possible comparisons of 2 nodes in a linked list that is growing", "body": "<p>I have a program which I have some initial nodes in a linked list, and I need to put a pair of nodes inside a function <code>resolve(node *node 1, node* node2)</code>, this function can generate a new node or not, and I'm not alowed to compare the same pair of nodes more than one time, the condition for the function to stop is when there are no distinct nodes to be compared anymore.</p>\n\n<p>\u00b0 The elements of the singly linked list are being inserted at the end.</p>\n\n<p>I've been trying to solve this problem for 2 days, but I can't think of a way to compare all the possible nodes, that fact that more nodes can be generated make the problem difficult to solve.</p>\n\n<p><strong>@edit</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/p6cwD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p6cwD.png\" alt=\"enter image description here\"></a></p>\n\n<p>The black point is the first node where the distributive starts.</p>\n\n<pre><code>resolve(node* node1, node* nodesafter)\n</code></pre>\n\n<p>The elipse is the node generated.</p>\n\n<p>But the only node generated is not being compared with the node at the top.</p>\n\n<p>In this case 6 comparisons a being made, in my code only 5 are being made.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515549982, "post_id": 48179258, "comment_id": 83338667, "body": "Awesome. I missed that I believe. I just tried to do a printf(&quot;%s&quot;, service); and the compiler gives me segmentation fault on that printf statement. And as far as the arguments argv[0] is the files name. So I don&#39;t need that part, just what the user adds when running it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1515550080, "post_id": 48179258, "comment_id": 83338689, "body": "Also, always compare <code>if (argc &lt; 3) { &#47;* handle error *&#47; }</code>. You can use <code>!= 2</code>, etc.., but <i>validate</i> the availability of arguments. You can even use successive <i>ternary</i> operators providing a default for each argument if you like."}, {"owner": {"reputation": 4002, "user_id": 5797593, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LN9CK.jpg?s=128&g=1", "display_name": "Matt Goodrich", "link": "https://stackoverflow.com/users/5797593/matt-goodrich"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515550170, "post_id": 48179258, "comment_id": 83338701, "body": "Updated my solution with those considerations BrianJarcus, and good addition @DavidC.Rankin"}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515550298, "post_id": 48179258, "comment_id": 83338726, "body": "Thank you David C. Rankin. I had that part of my original code but I slimmed this code down to just the issue I am running into. Matt Goodrich, I can print the port, another issue I have is printing the service."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515550497, "post_id": 48179258, "comment_id": 83338775, "body": "@MattGoodrich Much better. Always try and incorporate all necessary validations in your code (even for examples). Remember, when answering questions on SO, you step into the role of teacher. No slacker profs here..."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515550603, "post_id": 48179258, "comment_id": 83338794, "body": "I will make sure to include everything next time. Also, your last edited code is what I have right now, and it produced a segmentation fault for the printf statement."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1515550610, "post_id": 48179258, "comment_id": 83338798, "body": "this would not cause a segmentation fault. argv[0] is the program name. The incorrect char type will cause a compiler warning. My guess is that not enough args wre passed in."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515550772, "post_id": 48179258, "comment_id": 83338837, "body": "@prm100 this is during compile that it produces this error."}, {"owner": {"reputation": 4002, "user_id": 5797593, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LN9CK.jpg?s=128&g=1", "display_name": "Matt Goodrich", "link": "https://stackoverflow.com/users/5797593/matt-goodrich"}, "edited": false, "score": 0, "creation_date": 1515550806, "post_id": 48179258, "comment_id": 83338843, "body": "The error produced is because you do not have <code>#include &lt;stdlib.h&gt;</code>. I have added this to my sample code."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515550933, "post_id": 48179258, "comment_id": 83338871, "body": "Hmm, weird because I have that included. My code is exactly like yours."}, {"owner": {"reputation": 4002, "user_id": 5797593, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LN9CK.jpg?s=128&g=1", "display_name": "Matt Goodrich", "link": "https://stackoverflow.com/users/5797593/matt-goodrich"}, "edited": false, "score": 0, "creation_date": 1515550973, "post_id": 48179258, "comment_id": 83338886, "body": "You have <code>#include &lt;stdio.h&gt;</code>, not both <code>#include &lt;stdio.h&gt;</code> and <code>#include &lt;stdlib.h&gt;</code>"}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515551091, "post_id": 48179258, "comment_id": 83338919, "body": "My code is on another computer or I would copy it here. But it does have both. It also has &lt;string.h&gt; but that shouldn&#39;t matter."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515551405, "post_id": 48179258, "comment_id": 83339000, "body": "Program received seignal SIGSEGV, Segmentation fault. In msvcrt !_beginthreadex () (C:\\Windwos\\system32\\msvcrt.dll). BUT, if I run the program anyways, it works as intended. I have tried the code you made earlier today. I thought I was doing it right, but I was getting this error so I thought it wasn&#39;t working. Not sure why I am getting this error but it appears to be working."}, {"owner": {"reputation": 4002, "user_id": 5797593, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LN9CK.jpg?s=128&g=1", "display_name": "Matt Goodrich", "link": "https://stackoverflow.com/users/5797593/matt-goodrich"}, "edited": false, "score": 0, "creation_date": 1515551514, "post_id": 48179258, "comment_id": 83339022, "body": "^ Please share how you are compiling and running your program."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1515551600, "post_id": 48179258, "comment_id": 83339045, "body": "I am using Codeblocks and using the mingw compiler all on default settings. Not sure what to show."}, {"owner": {"reputation": 4002, "user_id": 5797593, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LN9CK.jpg?s=128&g=1", "display_name": "Matt Goodrich", "link": "https://stackoverflow.com/users/5797593/matt-goodrich"}, "edited": false, "score": 0, "creation_date": 1515551779, "post_id": 48179258, "comment_id": 83339092, "body": "Typically you will compile from the command line with something like <code>gcc test.c</code> and execute with <code>.&#47;a.out these are args</code>, but it sounds like you are using your IDE (Codeblocks) for these processes. In my opinion these go beyond the scope of your question and justifies research on your end to verify your IDE is configured correctly. Then ask another Stack Overflow question if you still have problems, indicating it&#39;s a Codeblocks/mingw issue. I have tested the code in my solution and it works as intended."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 1, "creation_date": 1515551901, "post_id": 48179258, "comment_id": 83339126, "body": "That is true. I am still learning the way C works. I am more of a Python user which everything is easier. Thank you for your help."}], "tags": [], "owner": {"reputation": 4002, "user_id": 5797593, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LN9CK.jpg?s=128&g=1", "display_name": "Matt Goodrich", "link": "https://stackoverflow.com/users/5797593/matt-goodrich"}, "is_accepted": true, "score": 1, "last_activity_date": 1515550930, "last_edit_date": 1592644375, "creation_date": 1515549645, "answer_id": 48179258, "question_id": 48179250, "link": "https://stackoverflow.com/questions/48179250/cant-accept-multiple-command-line-arguments-and-assign-to-variable/48179258#48179258", "title": "Can&#39;t accept multiple command line arguments and assign to variable", "body": "<p>When you write <code>char service = argv[2];</code>, you are assigning a char pointer to a char. You know <code>argv</code> is a char pointer array, because you define it as <code>char *argv[]</code>. Fix by just adding <code>char *service = argv[2];</code></p>\n<p>So your rewritten code could look like this:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n    if (argc &lt; 3) {\n        printf(&quot;Requires more arguments&quot;);\n        return 1;\n    }\n\n    int port = atoi(argv[1]);\n    char *service = argv[2];   \n    printf(&quot;%s&quot;, service); //From edit\n    return 0;\n}\n</code></pre>\n<p>You may want to add a check for the value of <code>argc</code> (i.e. <code>argc &gt;= 3</code>), since it will seg fault if there aren't three arguments.</p>\n<h3>Edit (response to comment):</h3>\n<p>To print the service, use:</p>\n<p><code>printf(&quot;%s&quot;, service);</code></p>\n<p>The <code>%s</code> specifies you will print a string of characters (<code>char *</code>) and you simply use <code>service</code>, because you need to specify the pointer.</p>\n<h3>Edit 2:</h3>\n<p>If you don't add <code>#include &lt;stdlib.h&gt;</code>, you will receive something along the lines of &quot;warning: implicit declaration of 'atoi' is invalid in C99&quot;, which may also produce an error depending on your compiler settings.</p>\n"}], "owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 48179258, "answer_count": 1, "score": 2, "last_activity_date": 1515550930, "creation_date": 1515549516, "question_id": 48179250, "link": "https://stackoverflow.com/questions/48179250/cant-accept-multiple-command-line-arguments-and-assign-to-variable", "title": "Can&#39;t accept multiple command line arguments and assign to variable", "body": "<p>I am learning C and I am not used to pointers and the way C handles strings. I am trying to create a program that accepts multiple command line arguments and assigns them to variables so that I can later use them. I can get the program to accept the first argument and assign it as a int. But when I try to accept the second argument I get a SEGMENTATION FAULT. I have tried testing by removing the second variable (service) and then assigning port to argv[2] and it doesn't work. It is something about accepting the second argument that the compiler does not like but I am not able to figure it out.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    int port = atoi(argv[1]);\n    char service = argv[2];   \n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux-device-driver", "embedded-linux", "mmap", "ethernet"], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 9206948, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bbnpxPN-vbM/AAAAAAAAAAI/AAAAAAAAH_Y/z90eH_yDWqA/photo.jpg?sz=128", "display_name": "y s", "link": "https://stackoverflow.com/users/9206948/y-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1515727696, "creation_date": 1515727696, "answer_id": 48219150, "question_id": 48179097, "link": "https://stackoverflow.com/questions/48179097/mmap-very-slow-when-using-o-sync/48219150#48219150", "title": "mmap very slow when using O_SYNC", "body": "<p>I don't know why <code>iperf</code> is so fast, but how <code>mmap</code>'ing device memory works.</p>\n\n<p>Let's look at <a href=\"https://elixir.free-electrons.com/linux/latest/source/drivers/char/mem.c#L341\" rel=\"nofollow noreferrer\"><code>mmap_mem()</code> function</a>, which is called by user's <code>mmap</code> call. According to <a href=\"https://elixir.free-electrons.com/linux/latest/source/drivers/char/mem.c#L278\" rel=\"nofollow noreferrer\">this line</a>, this function maps memory as noncached if <code>O_SYNC</code> is specified, and as (maybe) <strong>writeback</strong> else. So doing <code>vma-&gt;vm_page_prot = __pgprot_modify(vma-&gt;vm_page_prot, L_PTE_MT_MASK, L_PTE_MT_WRITEBACK);</code> may make it faster.</p>\n\n<p>So here we enabled a cache of a memory area. Then how to synchronize the content with FPGA?</p>\n\n<p>One way is to synchronize by software. There are <a href=\"https://elixir.free-electrons.com/linux/latest/source/arch/arm/mm/dma.h#L17\" rel=\"nofollow noreferrer\"><code>dmac_map_area()</code></a> and <a href=\"https://elixir.free-electrons.com/linux/latest/source/arch/arm/mm/dma.h#L18\" rel=\"nofollow noreferrer\"><code>dmac_unmap_area()</code></a> calls which correspond to <a href=\"https://elixir.free-electrons.com/linux/latest/source/arch/arm/mm/cache-v7.S#L425\" rel=\"nofollow noreferrer\"><code>v7_dma_map_area()</code></a> and <a href=\"https://elixir.free-electrons.com/linux/latest/source/arch/arm/mm/cache-v7.S#L438\" rel=\"nofollow noreferrer\"><code>v7_dma_unmap_area()</code></a> accordingly. These functions take three parameters: user address <code>addr</code>, the size <code>size</code> and DMA direction <code>dir</code>.</p>\n\n<p>When we call <code>dmac_map_area(addr, size, DMA_TO_DEVICE)</code>, the content of CPU cache is written to memory. So do this when the CPU has finished to write to memory and the device is going to read from the location.</p>\n\n<p>When we call <code>dmac_unmap_area(addr, size, DMA_FROM_DEVICE)</code>, the content of CPU cache is marked as \"invalid\", and when we read from the location the new content from device is read to CPU cache. So do this when the device has finished to write to memory and the CPU is going to read from the location.</p>\n\n<p>The other way is to use dedicated hardware. According to <a href=\"https://www.altera.com.cn/content/dam/altera-www/global/en_US/pdfs/literature/ab/ab07_soc_fpga.pdf\" rel=\"nofollow noreferrer\">this pdf</a>, Cyclone V has Accelerator Coherency Port (ACP), which enables FPGA to read cache contents of ARM. I think this maybe faster than software, but because I don't know how to use ACP, please try googling.</p>\n"}], "owner": {"reputation": 574, "user_id": 2610220, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/71abff9b2880595fa7856969bf8c7201?s=128&d=identicon&r=PG", "display_name": "WenJuan", "link": "https://stackoverflow.com/users/2610220/wenjuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1400, "favorite_count": 2, "accepted_answer_id": 48219150, "answer_count": 1, "score": 0, "last_activity_date": 1558353190, "creation_date": 1515548126, "last_edit_date": 1515552424, "question_id": 48179097, "link": "https://stackoverflow.com/questions/48179097/mmap-very-slow-when-using-o-sync", "title": "mmap very slow when using O_SYNC", "body": "<p>Brief description of our project: We are using CycloneV in our project, FPGA will write data to DDR using AXI bus and our application needs to send the data out using Ethernet. We benchmark our Ethernet throughput using iperf and it can achieve a speed of about 700Mbps. When we test our application throughput, the result we are getting is just 400Mbps. We write a simple server code without using <code>/dev/mem</code>, then populate the memory with random data using <code>dd</code> command and the application reads the file to send out. We notice that the throughput is actually near to iperf benchmark. We found out that when we remove O_SYNC during open <code>/dev/mem</code>, the throughput can be achieved close to that of iperf. But the issue now is that we get intermittent wrong data if we don't use O_SYNC.</p>\n\n<p>We allocate the contiguous memory using <code>dma_alloc_coherent</code>:</p>\n\n<pre><code>p_ximageConfig-&gt;fpgamem_virt = dma_alloc_coherent(NULL, Dma_Size, &amp;(p_ximageConfig-&gt;fpgamem_phys), GFP_KERNEL);\n</code></pre>\n\n<p>and we pass the phys memory to userspace to mmap using IOCTL:</p>\n\n<pre><code>uint32 DMAPHYSADDR = getDmaPhysAddr();\npImagePool = ((volatile unsigned char*)mmap( 0,MAPPED_SIZE_BUFFER, PROT_READ|PROT_WRITE, MAP_SHARED, _fdFpga, DMAPHYSADDR));\n</code></pre>\n\n<p>We have tried following methods:</p>\n\n<ol>\n<li><p>Writing our own mmap in our driver: We still get wrong data intermittently if we do not sync. Sync method that we tried is <strong>pgprot_noncached</strong> and <strong>pgprot_dmacoherent</strong> but it can only achieve 300Mbps.</p></li>\n<li><p>We tried to use <strong>dma_mmap_coherent</strong>: The result we get is about 500Mbps.</p></li>\n</ol>\n\n<p>Is there any method that can help us achieve a performance that is close to iperf performance?</p>\n"}, {"tags": ["c", "recursion", "stack-overflow"], "comments": [{"owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "edited": false, "score": 0, "creation_date": 1515544377, "post_id": 48178640, "comment_id": 83337405, "body": "How many? Until the stack is used up. Under Windows the system can add additional memory, so... it may take really  a lot. In your case, you don&#39;t have many local variables (only a pointer), so it&#39;s just this pointer and the function frame - really too little."}, {"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "reply_to_user": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "edited": false, "score": 0, "creation_date": 1515544491, "post_id": 48178640, "comment_id": 83337422, "body": "is it normal to have stack overflow after 500000 recursive calls ?on CentOs 7"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515544547, "post_id": 48178640, "comment_id": 83337432, "body": "This looks <a href=\"https://stackoverflow.com/questions/48173404/how-to-know-a-c-programs-stack-overflows\">awfully familiar</a> ... 500k calls would do it, but it completely depends on your system&#39;s stack size and what you&#39;re pushing there, take a look <a href=\"https://stackoverflow.com/questions/7535994/how-do-i-find-the-maximum-stack-size\">here</a>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515545124, "post_id": 48178640, "comment_id": 83337574, "body": "If you ever need more than 100 levels of recursion, then recursion isn&#39;t the right solution to your problem (not counting &quot;tail&quot; recursion which most decent compilers will convert to iteration for you)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1515545274, "post_id": 48178640, "comment_id": 83337609, "body": "The default stack size on a Linux machine is 8 MiB.  If you need more than about 16 bytes of data per call (including return addresses etc), you&#39;d be running into problems at 500,000 calls deep (but not at 500,000 calls if you&#39;ve returned from 499,900 of them already).  It is the number of levels of recursive call that cause trouble - stack overflows - and not the total number of calls."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515545670, "post_id": 48178640, "comment_id": 83337697, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48173404/how-to-know-a-c-programs-stack-overflows\">how to know a c program&#39;s stack overflows?</a>  Editing your original post with updated information, or questions would be sufficient to update the active questions list and draw people to visit.  That is always preferable to asking the same question twice."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 0, "creation_date": 1515544659, "post_id": 48178684, "comment_id": 83337458, "body": "my system is Centos 7 , RAM 4 GB, possessor core i7, 500000 recursive calls in enough to stack overflow in this system?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 0, "creation_date": 1515545116, "post_id": 48178684, "comment_id": 83337570, "body": "@mehrdad - Why don&#39;t you try it and find out?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 0, "creation_date": 1515546116, "post_id": 48178684, "comment_id": 83337810, "body": "@mehrdad Check <code>ulimit -s</code>."}], "tags": [], "owner": {"reputation": 1447, "user_id": 4301453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/dTvct.png?s=128&g=1", "display_name": "Jonathan Woollett-light", "link": "https://stackoverflow.com/users/4301453/jonathan-woollett-light"}, "is_accepted": false, "score": 0, "last_activity_date": 1515544443, "creation_date": 1515544443, "answer_id": 48178684, "question_id": 48178640, "link": "https://stackoverflow.com/questions/48178640/how-many-recursive-function-calls-causes-stack-overflow/48178684#48178684", "title": "how many recursive function calls causes stack overflow?", "body": "<p>For each time a function recurs, your program takes more memory on the stack, the memory it takes for each function depends upon the function and variables within it. The number of recursions that can be done of a function is entirely dependant upon your system.</p>\n\n<p>There is no general number of recursions that will cause stack overflow.</p>\n\n<p>Removing the variable 'neighbour' will allow for the function to recur further as each recursion takes less memory, but it will still eventually cause stack overflow.</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 1, "creation_date": 1515545130, "post_id": 48178733, "comment_id": 83337575, "body": "thank you for your answer, my code is fine, but the algorithm that I use must be implemented with recursive function, and for small recursive depth i have no problem and my results is good."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1515545313, "post_id": 48178733, "comment_id": 83337617, "body": "Since stack size is a settable value in most environments, your answer to 1 is not convincing.  i.e. Stack overflow does not necessarily mean <i>wrong</i> code.  It just means the stack size needs to be adjusted up for that particular application."}, {"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1515545387, "post_id": 48178733, "comment_id": 83337631, "body": "@ryyker I can see that interpretation. I&#39;ll update my wording a bit."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515545407, "post_id": 48178733, "comment_id": 83337639, "body": "Regarding 1, systems often limit stack size more than actually necessary. You might have an entirely good algorithm that simply requires recursion, and re-implementing it as a loop with a stack structure on the heap would let it work on much larger amounts of data."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515545463, "post_id": 48178733, "comment_id": 83337651, "body": "@ryyker This is kind of like saying <code>malloc</code> failing because you ran out of memory means you just need to add more RAM. You&#39;re correct that it&#39;s not necessarily <i>wrong</i> to overflow the stack or run out of RAM, but your first response should be to optimize your use of finite resources rather than just add more."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1515545757, "post_id": 48178733, "comment_id": 83337715, "body": "@Schwern True to some extent, but (at least on Linux) you get \u201cunlimited\u201d heap by default (that is, until all the RAM on the system is actually being used and Linux kills something), but only 8 MiB stack. The stack is a finite resource no matter what, but it is an <i>artificially limited</i> resource by default. (Here I mean \u201cartificial\u201d as saying that it doesn\u2019t represent a limit the hardware has; I don\u2019t know enough about the tradeoffs to say that it\u2019s a bad idea to put some limit in place, although a default of 8 MiB regardless of physical memory does seem small.)"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515545926, "post_id": 48178733, "comment_id": 83337763, "body": "@DanielH You&#39;re correct that it is artificial. It is also one that you, as the developer, do not control. And a normal user can only make it so large. So again, &quot;just increase the stack&quot; is a poor first response; it burdens the user with special configuration requirements."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1515546606, "post_id": 48178733, "comment_id": 83337943, "body": "@Schwern: Developers can control stack size. E.g., with Apple\u2019s ld, specify \u201c-stack_size <i>hexadecimal number</i>\u201d. (If using Xcode, add \u201c-Wl,-stack_size,<i>hexadecimal number</i>\u201d to Other Linker Flags.)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1515546673, "post_id": 48178733, "comment_id": 83337957, "body": "@Schwern - Analogy is weak :), but I get, and do not fully disagree with the point I you are conveying.  Anecdotally, the default stack size on the environment I use is 250 kBytes.  A recent application I wrote for use on Windows uses variable length arrays to accommodate sizes that are only known at run-time.  In this case, my software which was arguably not perfect, but completely adequate for its purpose caused a stack overflow.  Given the nature of the application (a Windows app) I simply upped the stack size available to the app. (10 seconds) verses debugging and editing code. (&gt; 10 secs)"}, {"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515546891, "post_id": 48178733, "comment_id": 83338010, "body": "@ryyker that seems more of a business anecdote, not one that is holistically beneficial to the user."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1515546951, "post_id": 48178733, "comment_id": 83338025, "body": "@Schwern I don\u2019t know if this is typical or Red Hat\u2013specific, but on my Fedora, CentOS 6, and, most relevantly for the question, CentOS 7 systems, the default hard limit is \u201cunlimited\u201d, which is the default soft limit for heap size. Obviously a sysadmin can change that and might limit stack more than heap, but by default you can go as far as you want."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515547114, "post_id": 48178733, "comment_id": 83338064, "body": "@AustinBrunkhorst - it was, directed as a response to Schwern.  Business case or no, sometimes it is not a wise to spend excess time on a lab tool that works perfectly fine."}, {"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515547244, "post_id": 48178733, "comment_id": 83338095, "body": "@ryyker no I understand. My experiences have been the same, it&#39;s just a dangerous mindset to adhere to. Are you more comfortable with my updated answer?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1515547562, "post_id": 48178733, "comment_id": 83338162, "body": "Yes, the content of your answer is good, but the comments under your answer are spectacular  :)"}, {"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "edited": false, "score": 0, "creation_date": 1515547726, "post_id": 48178733, "comment_id": 83338193, "body": "Cheers! We might as well write a book about the stack, here in this comment thread."}], "tags": [], "owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "is_accepted": false, "score": 2, "last_activity_date": 1515546797, "last_edit_date": 1515546797, "creation_date": 1515544788, "answer_id": 48178733, "question_id": 48178640, "link": "https://stackoverflow.com/questions/48178640/how-many-recursive-function-calls-causes-stack-overflow/48178733#48178733", "title": "how many recursive function calls causes stack overflow?", "body": "<ol>\n<li><p>Yes and no - if you come across a stack overflow in your code, it could mean a few things</p>\n\n<ul>\n<li><p>Your algorithm is not implemented in a way that respects the amount of memory on the stack you have been given. You may adjust this amount to suit the needs of the algorithm.</p>\n\n<p>If this is the case, it's <em>more common</em> to change the algorithm to more efficiently utilize the stack, rather than add more memory. Converting a recursive function to an iterative one, for example, saves a lot of precious memory. </p></li>\n<li><p>It's a bug trying to eat all your RAM. You forgot a base case in the recursion or mistakenly called the same function. We've all done it at <em>least</em> 2 times.</p></li>\n</ul></li>\n<li><p>It's not necessarily <em>how many</em> calls cause an overflow - it's dependent upon how much memory each individual call takes up on a stack frame. Each function call uses up stack memory until the call returns. Stack memory is statically allocated -- you can't change it at runtime (in a sane world). It's a last-in-first-out (LIFO) data structure behind the scenes.</p></li>\n<li><p>It's not preventing it, it's just changing how many calls to <code>grow_Wolff_cluster</code> it takes to overflow the stack memory. On a 32-bit system, removing <code>neighbor</code> from the function costs a call to <code>grow_Wolff_cluster</code> 4 bytes less. It adds up quickly when you multiply that in the hundreds of thousands.</p></li>\n</ol>\n\n<p>I suggest you learn more about how stacks work for you. <a href=\"https://softwareengineering.stackexchange.com/questions/195385/understanding-stack-frame-of-function-call-in-c-c\">Here's a good resource</a> over on the software engineering stack exchange. And another here on <a href=\"https://stackoverflow.com/questions/23981391/how-exactly-does-the-callstack-work\">stack overflow</a> (zing!)</p>\n"}, {"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 1, "creation_date": 1515546417, "post_id": 48178767, "comment_id": 83337892, "body": "Note: My results are with <code>-g</code>. With <code>-O3</code> I can&#39;t get the stack to overflow. I suspect the compiler has optimized away my simple recursion."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 5, "last_activity_date": 1515546250, "last_edit_date": 1515546250, "creation_date": 1515545107, "answer_id": 48178767, "question_id": 48178640, "link": "https://stackoverflow.com/questions/48178640/how-many-recursive-function-calls-causes-stack-overflow/48178767#48178767", "title": "how many recursive function calls causes stack overflow?", "body": "<blockquote>\n  <p><em>I want to know that is this normal?</em></p>\n</blockquote>\n\n<p>Yes. There's only so much stack size.</p>\n\n<blockquote>\n  <p><em>In the code below, removing local variable neighbor can prevent from stack overflow?</em></p>\n</blockquote>\n\n<p>No. Even with no variables and no return values the function calls themselves must be stored in the stack so the stack can eventually be unwound.</p>\n\n<p>For example...</p>\n\n<pre><code>void recurse() {\n    recurse();\n}\n\nint main (void)\n{\n    recurse();\n}\n</code></pre>\n\n<p>This still overflows the stack.</p>\n\n<pre><code>$ ./test\nASAN:DEADLYSIGNAL\n=================================================================\n==94371==ERROR: AddressSanitizer: stack-overflow on address 0x7ffee7f80ff8 (pc 0x00010747ff14 bp 0x7ffee7f81000 sp 0x7ffee7f81000 T0)\n    #0 0x10747ff13 in recurse (/Users/schwern/tmp/./test+0x100000f13)\n\nSUMMARY: AddressSanitizer: stack-overflow (/Users/schwern/tmp/./test+0x100000f13) in recurse\n==94371==ABORTING\nAbort trap: 6\n</code></pre>\n\n<blockquote>\n  <p><em>In general how many recursive function calls causes stack overflow?</em></p>\n</blockquote>\n\n<p>That depends on your environment and function calls. Here on OS X 10.13 I'm limited to 8192K by default.</p>\n\n<pre><code>$ ulimit -s\n8192\n</code></pre>\n\n<p>This simple example with <code>clang -g</code> can recurse 261976 times. With <code>-O3</code> I can't get it to overflow, I suspect compiler optimizations have eliminated my simple recursion.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid recurse() {\n    puts(\"Recurse\");\n    recurse();\n}\n\nint main (void)\n{\n    recurse();\n}\n</code></pre>\n\n<p>Add an integer argument and it's 261933 times.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid recurse(int cnt) {\n    printf(\"Recurse %d\\n\", cnt);\n    recurse(++cnt);\n}\n\nint main (void)\n{\n    recurse(1);\n}\n</code></pre>\n\n<p>Add a double argument, now it's 174622 times.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid recurse(int cnt, double foo) {\n    printf(\"Recurse %d %f\\n\", cnt, foo);\n    recurse(++cnt, foo);\n}\n\nint main (void)\n{\n    recurse(1, 2.3);\n}\n</code></pre>\n\n<p>Add some stack variables and it's 104773 times.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid recurse(int cnt, double foo) {\n    double this = 42.0;\n    double that = 41.0;\n    double other = 40.0;\n    double thing = 39.0;\n    printf(\"Recurse %d %f %f %f %f %f\\n\", cnt, foo, this, that, other, thing);\n    recurse(++cnt, foo);\n}\n\nint main (void)\n{\n    recurse(1, 2.3);\n}\n</code></pre>\n\n<p>And so on. But I can increase my stack size in this shell and get twice the calls.</p>\n\n<pre><code>$ ./test 2&gt; /dev/null | wc -l\n174622\n$ ulimit -s 16384\n$ ./test 2&gt; /dev/null | wc -l\n349385\n</code></pre>\n\n<p>I have a hard upper limit to how big I can make the stack of 65,532K or 64M.</p>\n\n<pre><code>$ ulimit -Hs\n65532\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515546231, "post_id": 48178786, "comment_id": 83337843, "body": "This is nicely written, but it does not answer the numbered questions in OP\u2019s question or explain the mistaken concepts inherent in them. E.g., Q1: Yes, it is normal for many calls to overflow the stack. Q2: The number of calls it takes to overflow the stack depends on how much space each function needs. Q3: Removing <code>neighbor</code> could reduce the space one call uses and increase the number of calls that could be made before overflow occurs, but it will not prevent it. None of these are addressed directly in this answer."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1515547072, "post_id": 48178786, "comment_id": 83338054, "body": "@EricPostpischil I don\u2019t have them nicely numbered, but I did address all of them. Respectively, by answers are \u201cIt\u2019s normal for a lot of calls to overwhelm the stack, but I don\u2019t know if 500,000 is a reasonable number in your environment\u201d, \u201cIt\u2019s not the number of calls that\u2019s relevant but the frame size\u201d, and \u201cRemoving <code>neighbor</code> reduces frame size so makes the number of calls needed to get an overflow higher\u201d."}], "tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1515545272, "creation_date": 1515545272, "answer_id": 48178786, "question_id": 48178640, "link": "https://stackoverflow.com/questions/48178640/how-many-recursive-function-calls-causes-stack-overflow/48178786#48178786", "title": "how many recursive function calls causes stack overflow?", "body": "<p>A stack overflow isn\u2019t defined by the C standard, but by the implementation. The C standard defines a language with unlimited stack space (among other resources) but does have a section about how implementations are allowed to impose limits.</p>\n\n<p>Usually it\u2019s the operating system that actually first creates the error. The OS doesn\u2019t care about how many calls you make, but about the <em>total size</em> of the stack. The stack is composed of <em>stack frames</em>, one for each function call. Usually a stack frame consists of some combination of the following five things (as an approximation; details can vary a lot between systems):</p>\n\n<ol>\n<li>The parameters to the function call (probably not actually here, in this case; they\u2019re probably in registers, although this doesn\u2019t actually buy anything with recursion).</li>\n<li>The return address of the function call (in this case, the address of the <code>++i</code> instruction in the <code>for</code> loop).</li>\n<li>The <em>base pointer</em> where the previous stack frame starts</li>\n<li>Local variables (at least those that don\u2019t go in registers)</li>\n<li>Any registers the caller wants to save when it makes a new function call, so the called function doesn\u2019t overwrite them (some registers may be saved by the caller instead, but it doesn\u2019t particularly matter for stack size analysis). This is why passing parameters in registers doesn\u2019t help much in this case; they\u2019ll end up on the stack sooner or later.</li>\n</ol>\n\n<p>Because some of these (specifically, 1., 4., and 5.) can vary in size by a lot, it can be difficult to estimate how big an average stack frame is, although it\u2019s easier in this case because of the recursion. Different systems also have different stack sizes; it currently looks like by default I can have 8 MiB for a stack, but an embedded system would probably have a lot less.</p>\n\n<p>This also explains why removing a local variable gives you more available function calls; you reduced the size of each of the 500,000 stack frames.</p>\n\n<hr>\n\n<p>If you want to increase the amount of stack space available, look into the <a href=\"http://man7.org/linux/man-pages/man2/setrlimit.2.html\" rel=\"nofollow noreferrer\"><code>setrlimit(2)</code> function</a> (on Linux like the OP; it may be different on other systems). First, though, you might want to try debugging and refactoring to make sure you need all that stack space.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12620886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-riMZCZIQOKw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdu2MaQjUmV5Spi_iKGNCXtFnn20w/photo.jpg?sz=128", "display_name": "Patrice Charbonneau", "link": "https://stackoverflow.com/users/12620886/patrice-charbonneau"}, "is_accepted": false, "score": 0, "last_activity_date": 1585955657, "creation_date": 1585955657, "answer_id": 61021777, "question_id": 48178640, "link": "https://stackoverflow.com/questions/48178640/how-many-recursive-function-calls-causes-stack-overflow/61021777#61021777", "title": "how many recursive function calls causes stack overflow?", "body": "<p>This is a simple c# function that will show you how many iteration your computer can take before stack overflow (as a reference, I have run up to 10478):</p>\n\n<pre><code>    private void button3_Click(object sender, EventArgs e)\n    {\n        Int32 lngMax = 0;\n        StackIt(ref lngMax);\n    }\n\n    private void StackIt(ref Int32 plngMax, Int32 plngStack = 0)\n    {\n        if (plngStack &gt; plngMax)\n        {\n            plngMax = plngStack;\n            Console.WriteLine(plngMax.ToString());\n        }\n\n        plngStack++;\n        StackIt(ref plngMax, plngStack);\n    }\n</code></pre>\n\n<p>in this simple case, the condition check: \"if (plngStack > plngMax)\" could be removed, \nbut if you got a real recursive function, this check will help you localize the problem.</p>\n"}], "owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3656, "favorite_count": 1, "accepted_answer_id": 48178767, "answer_count": 5, "score": 1, "last_activity_date": 1585955657, "creation_date": 1515544037, "question_id": 48178640, "link": "https://stackoverflow.com/questions/48178640/how-many-recursive-function-calls-causes-stack-overflow", "title": "how many recursive function calls causes stack overflow?", "body": "<p>I am working on a simulation problem written in c, the main part of my program is a recursive function.\nwhen the recursive depth reaches approximately 500000 it seems stack overflow occurs.</p>\n\n<p><strong>Q1</strong> : I want to know that is this normal?</p>\n\n<p><strong>Q2</strong> : in general how many recursive function calls causes stack overflow?</p>\n\n<p><strong>Q3</strong> : in the code below, removing local variable <code>neighbor</code> can prevent from stack overflow?</p>\n\n<p>my code:</p>\n\n<pre><code>/*\n * recursive function to form Wolff Cluster(= WC)\n */\nvoid grow_Wolff_cluster(lattic* l, Wolff* wolff, site *seed){\n\n    /*a neighbor of site seed*/\n    site* neighbor;\n\n    /*go through all neighbors of seed*/\n    for (int i = 0 ; i &lt; neighbors ; ++i) {\n\n\n        neighbor = seed-&gt;neighbors[i];\n\n        /*add to WC according to the Wolff Algorithm*/\n        if(neighbor-&gt;spin == seed-&gt;spin &amp;&amp; neighbor-&gt;WC == -1 &amp;&amp; ((double)rand() / RAND_MAX) &lt; add_probability)\n        {\n            wolff-&gt;Wolff_cluster[wolff-&gt;WC_pos] = neighbor;\n            wolff-&gt;WC_pos++;                  // the number of sites that is added to WC\n            neighbor-&gt;WC = 1;          // for avoiding of multiple addition of site\n            neighbor-&gt;X = 0;\n\n\n            ///controller_site_added_to_WC();\n\n\n            /*continue growing Wolff cluster(recursion)*/\n            grow_Wolff_cluster(l, wolff, neighbor);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 1277, "user_id": 7868639, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3117f075e0c1ef80f6304bb92f45c77c?s=128&d=identicon&r=PG&f=1", "display_name": "itsundefined", "link": "https://stackoverflow.com/users/7868639/itsundefined"}, "edited": false, "score": 0, "creation_date": 1515543995, "post_id": 48178604, "comment_id": 83337317, "body": "Go read on what a Prime is. You are doing it wrong."}, {"owner": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1515544030, "post_id": 48178604, "comment_id": 83337322, "body": "you can use the <code>checkPrime</code> function to do both but basically you just need to recursively call check prime with the arg passed <code>-1</code> but the important bit is the base case that checks if the arg <code>==2</code> where 2 is the smallest prime"}, {"owner": {"reputation": 9, "user_id": 8128364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f01eeb312a6ef906ffbde92a6e241d3?s=128&d=identicon&r=PG&f=1", "display_name": "Leaf", "link": "https://stackoverflow.com/users/8128364/leaf"}, "reply_to_user": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1515544152, "post_id": 48178604, "comment_id": 83337354, "body": "@mad.meesh I know i can do both with checkPrime but in the exercise it says that i must do it with another recursive function."}, {"owner": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1515544200, "post_id": 48178604, "comment_id": 83337362, "body": "and like the guy with the funny name above me says you\u2019re not actually checking for prime here you\u2019re just checking for parity basically"}, {"owner": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1515544277, "post_id": 48178604, "comment_id": 83337373, "body": "ok well with your second function do what i said and that is calling the function recursively with <code>arg-1</code>"}, {"owner": {"reputation": 9, "user_id": 8128364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f01eeb312a6ef906ffbde92a6e241d3?s=128&d=identicon&r=PG&f=1", "display_name": "Leaf", "link": "https://stackoverflow.com/users/8128364/leaf"}, "reply_to_user": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1515544303, "post_id": 48178604, "comment_id": 83337384, "body": "@mad.meesh Parity is what i wanted to ask but English isn&#39;t my main language so i confused the terms..."}, {"owner": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1515544369, "post_id": 48178604, "comment_id": 83337402, "body": "oh then if it\u2019s parity then just keep calling the function with <code>arg-2</code> that is if <code>arg</code> is even to begin with otherwise you will need a special case that calls it with <code>-1</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1515544899, "post_id": 48178604, "comment_id": 83337514, "body": "@Leaf then if it&#39;s not primes you are looking for, then please correct your questions. Otherwise it&#39;s confusing and people in the feature that happen to find your question will be confused as well."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1515545878, "post_id": 48178604, "comment_id": 83337753, "body": "&quot;Parity&quot; - you keep using that word, I do not think it means what you think it means :-) I would suggest &quot;evenness&quot; as an alternative, if you need a property, otherwise just use a phrase like &quot;check if a number is even&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515546294, "post_id": 48178604, "comment_id": 83337859, "body": "Your smaller prime function isn&#39;t returning anything.  Your check prime function isn&#39;t doing a good job; it gives the wrong answer for 9 and 15, for example.  There are lots of questions about primes on SO; please go and look at them for ideas.  Once you&#39;ve got your basic prime checker working sensibly, you can move on to the recursive &quot;how many smaller primes&quot; function.  Having said that, you could code it more efficiently if your prime checker kept a track of how many prime factors it had tried.  Sieve of Eratosthenes is a good search term.  You don&#39;t needs Atkins"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1515546733, "post_id": 48178604, "comment_id": 83337971, "body": "I should also mention that using recursion to find all even numbers below a given number is a spectacularly <i>bone-headed</i> idea (you may want to use more tact than I, if you communicate that to your educator). The best use cases for recursion are where the &quot;solution search space&quot; is reduced a <i>lot</i> in each recursion level (like halved in a binary search). Recursively finding all even numbers less than <code>100,000,000</code> is not going to do your stack any favours :-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515551671, "post_id": 48178604, "comment_id": 83339066, "body": "To check <i>parity</i> recursively <code>int checkParity (unsigned number) { return number ? checkParity(number &#47; 2) ^ (number % 2) : 0; }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 9056489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756e62c955f8ade5fd695dbfe95952e7?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelGL", "link": "https://stackoverflow.com/users/9056489/michaelgl"}, "is_accepted": true, "score": 0, "last_activity_date": 1515665004, "creation_date": 1515665004, "answer_id": 48204319, "question_id": 48178604, "link": "https://stackoverflow.com/questions/48178604/c-recursive-function-smaller-prime-numbers/48204319#48204319", "title": "C - Recursive function smaller prime numbers", "body": "<p>I saw from the comments,that you actually want to check if a number is even,and if so,you want to know how many smaller even numbers there are using recursion,not prime numbers as mentioned in the title,so my answer will refer that.</p>\n\n<p>You could use something like this:</p>\n\n<pre><code>int smallerPrime (int number) {\n    static int count = -1; // so that the number itself will not be counted\nif(number &lt;1)   //excluding 0 or negative numbers\n        return 0;\n    if(number !=2) {//we know the number has to be even so no check is needed\n            ++count;\n       smallerPrime(number - 2);\n        return count+1; // the +1 is in order to count 2 as well\n    }\n    else {\n        return 0;\n    }\n</code></pre>\n\n<p>So for example:\nInput 10 would give output 4 (8,6,4,2)</p>\n\n<p>As mentioned by paxdiablo,using recursion here is not the best idea.</p>\n\n<p>In case of very big numbers,your program will probably crash.</p>\n\n<p>Furthermore,note that this code works for positive numbers only,as i am not sure if you want to count anything but them(Negative numbers (like -2,-4 and so on) and 0 are also considered even).\nI excluded them here.</p>\n\n<p>In main,you need to put the return value of <code>checkPrime</code> in some variable,and use it to determine if you need to use <code>smallerPrime</code> function.\nSo you should correct that in your code.</p>\n\n<p>Of course,you can do it all in one function with some small changes.</p>\n"}], "owner": {"reputation": 9, "user_id": 8128364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f01eeb312a6ef906ffbde92a6e241d3?s=128&d=identicon&r=PG&f=1", "display_name": "Leaf", "link": "https://stackoverflow.com/users/8128364/leaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 48204319, "answer_count": 1, "score": -2, "last_activity_date": 1515665004, "creation_date": 1515543772, "question_id": 48178604, "link": "https://stackoverflow.com/questions/48178604/c-recursive-function-smaller-prime-numbers", "title": "C - Recursive function smaller prime numbers", "body": "<p>i got this exercise where it wants me to create a function to check if a number is \"Prime\", and than create another function to print how many smaller prime numbers are there from the one i checked. The thing is i need to create a recursive function to check the number of smaller prime numbers using the first function(the one that checks if a number is prime or not). This is what i got so far, and i'm stuck here. The recursive function is confusing for me.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n   int a;\n   scanf(\"%d\", &amp;a);\n   checkPrime(a);\n   smallerPrime(a);\n}\n\nint checkPrime (int number) {\n    if(number % 2 == 0) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\nint smallerPrime (int number) {\n        if(checkPrime(number) % 2 != 0){\n            return ;\n        } else {\n            return ;\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "wow64"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1515544149, "post_id": 48178586, "comment_id": 83337351, "body": "the <code>GetModuleHandleEx</code> simply returned saved module name, used for load dll. the <code>Wow64DisableWow64FsRedirection</code> have not and can not any effect for this. you can use say <code>GetMappedFileName</code> for get real file system path"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515544691, "post_id": 48178586, "comment_id": 83337464, "body": "@RbMm: Where was it saved in, <code>PEB</code> struct? So yeah, <code>GetMappedFileName</code> returns the correct path, sort of. It&#39;s in device-path form. Do you know of any easy way to convert it to the form used by Explorer, i.e. <code>C:\\ </code> instead of <code>\\Device\\HardiskVolumeN</code>? And btw, <code>GetMappedFileName</code> doesn&#39;t need <code>Wow64DisableWow64FsRedirection</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515544834, "post_id": 48178586, "comment_id": 83337495, "body": "it saved in <code>_LDR_DATA_TABLE_ENTRY</code> the <code>GetModuleFileNameEx</code> return from here. even preserve case in file name/path. you can easy test this by self - load some dll and use unusual case combination in name - <code>GetModuleFileNameEx</code> - return you exactly this back. when  <code>GetMappedFileName</code> - return you true file system path"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515544887, "post_id": 48178586, "comment_id": 83337510, "body": "@RbMm: <code>_LDR_DATA_TABLE_ENTRY</code> that&#39;s in the kernel space, right?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515544935, "post_id": 48178586, "comment_id": 83337520, "body": "of course <code>GetMappedFileName</code> not depend from <code>Wow64DisableWow64FsRedirection</code> too (this is shell over <code>ZwQueryVirtualMemory(,,MemoryMappedFilenameInformation..)</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515544959, "post_id": 48178586, "comment_id": 83337528, "body": "no, <code>_LDR_DATA_TABLE_ENTRY</code> - this is user space"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515544995, "post_id": 48178586, "comment_id": 83337538, "body": "and for what you need convert nt path to win32 form ?"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515578346, "post_id": 48178586, "comment_id": 83349194, "body": "@RbMm: Sorry, I was gone for a while. So yeah, like you pretty much surmised in your answer, I need it for the shell APIs."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515578729, "post_id": 48178586, "comment_id": 83349434, "body": "for shell api unfortunately need only driver letter path, so need <code>IOCTL_MOUNTMGR_QUERY_POINTS</code> for convert path"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1515578839, "post_id": 48178586, "comment_id": 83349496, "body": "@RbMm: Yeah, thanks. I wish MS had a single API for those conversions."}], "answers": [{"tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 6, "last_activity_date": 1515552414, "creation_date": 1515552414, "answer_id": 48179574, "question_id": 48178586, "link": "https://stackoverflow.com/questions/48178586/how-to-disable-wow64-file-system-redirection-for-getmodulefilenameex/48179574#48179574", "title": "How to disable WOW64 file system redirection for GetModuleFileNameEx?", "body": "<p>when we load dll via <code>LoadLibrary[Ex]</code> or <code>LdrLoadDll</code> - first some pre-process transmitted dll name (say convert <code>api-*</code> to actual dll name or redirect dll name based on manifest - well known example <code>comctl32.dll</code>) and then use this (possible modified) dll name to load file as dll. but wow fs redirection - not preprocessed at this stage. if dll was successfully loaded - system allocate <a href=\"http://processhacker.sourceforge.net/doc/ntldr_8h_source.html#l00102\" rel=\"noreferrer\"><code>LDR_DATA_TABLE_ENTRY</code></a> structure and save transmitted (after pre-process) dll name here as is. </p>\n\n<p>the <code>GetModuleFileNameEx</code> simply walk throughout <a href=\"http://processhacker.sourceforge.net/doc/ntldr_8h_source.html#l00102\" rel=\"noreferrer\"><code>LDR_DATA_TABLE_ENTRY</code></a> double linked list and search entry where <code>DllBase == hModule</code> - if found - copy <code>FullDllName</code> to <code>lpFilename</code> (if buffer big enough). so it simply return dll path used during load dll. the <code>Wow64DisableWow64FsRedirection</code> have no any effect to this call.</p>\n\n<p>if we want get real (canonical) full path to dll - need use <code>GetMappedFileNameW</code> or <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/dn957455(v=vs.85).aspx\" rel=\"noreferrer\"><code>ZwQueryVirtualMemory</code></a> with <a href=\"http://processhacker.sourceforge.net/doc/ntmmapi_8h_source.html#l00009\" rel=\"noreferrer\"><code>MemoryMappedFilenameInformation</code></a></p>\n\n<p>so code can be (if we hope that <code>MAX_PATH</code> is enough)</p>\n\n<pre><code>WCHAR path[MAX_PATH];\nGetMappedFileNameW(NtCurrentProcess(), hmod, path, RTL_NUMBER_OF(path));\n</code></pre>\n\n<p>or if use ntapi and correct handle any path length:</p>\n\n<pre><code>NTSTATUS GetDllName(PVOID AddressInDll, PUNICODE_STRING NtImageName)\n{\n    NTSTATUS status;\n\n    union {\n        PVOID buf;\n        PUNICODE_STRING ImageName;\n    };\n\n    static volatile UCHAR guz;\n    PVOID stack = alloca(guz);\n\n    SIZE_T cb = 0, rcb = 0x200;\n\n    do \n    {\n        if (cb &lt; rcb)\n        {\n            cb = RtlPointerToOffset(buf = alloca(rcb - cb), stack);\n        }\n\n        if (0 &lt;= (status = ZwQueryVirtualMemory(NtCurrentProcess(), AddressInDll, \n            MemoryMappedFilenameInformation, buf, cb, &amp;rcb)))\n        {\n            return RtlDuplicateUnicodeString(\n                RTL_DUPLICATE_UNICODE_STRING_NULL_TERMINATE, \n                ImageName, NtImageName);\n        }\n\n    } while (status == STATUS_BUFFER_OVERFLOW);\n\n    return status;\n}\n    UNICODE_STRING NtImageName;\n    if (0 &lt;= GetDllName(hmod, &amp;NtImageName))\n    {\n        RtlFreeUnicodeString(&amp;NtImageName);\n    }\n</code></pre>\n\n<p>about question \"way to convert it to the win32 form\" - there is a counter question - for what ?\nat first we can use it as is with <code>NtOpenFile</code> (well documented api), at second - the simplest way convert to win32 form, accepted by <code>CreateFileW</code> - add <code>\\\\?\\globalroot</code> prefix to nt path. but not all win32 api (primary shell api) accept this form. if we want exactly dos-device form path (aka <code>X:</code>) need use <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff560474(v=vs.85).aspx\" rel=\"noreferrer\"><code>IOCTL_MOUNTMGR_QUERY_POINTS</code></a> - got the array of <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff562286(v=vs.85).aspx\" rel=\"noreferrer\"><code>MOUNTMGR_MOUNT_POINT</code></a> inside <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff562288(v=vs.85).aspx\" rel=\"noreferrer\"><code>MOUNTMGR_MOUNT_POINTS</code></a> structure and search for DeviceName which is prefix for our nt path and SymbolicLinkName have driver letter form. code can be ~</p>\n\n<pre><code>#include &lt;mountmgr.h&gt;\n\nULONG NtToDosPath(HANDLE hMM, PUNICODE_STRING ImageName, PWSTR* ppsz)\n{\n    static MOUNTMGR_MOUNT_POINT MountPoint;\n\n    static volatile UCHAR guz;\n\n    PVOID stack = alloca(guz);\n    PMOUNTMGR_MOUNT_POINTS pmmp = 0;\n    DWORD cb = 0, rcb = 0x200, BytesReturned;\n\n    ULONG err = NOERROR;\n\n    do \n    {\n        if (cb &lt; rcb) cb = RtlPointerToOffset(pmmp = (PMOUNTMGR_MOUNT_POINTS)alloca(rcb - cb), stack);\n\n        if (DeviceIoControl(hMM, IOCTL_MOUNTMGR_QUERY_POINTS, \n            &amp;MountPoint, sizeof(MOUNTMGR_MOUNT_POINT), \n            pmmp, cb, &amp;BytesReturned, 0))\n        {\n            if (ULONG NumberOfMountPoints = pmmp-&gt;NumberOfMountPoints)\n            {\n                PMOUNTMGR_MOUNT_POINT MountPoints = pmmp-&gt;MountPoints;\n\n                do \n                {\n                    UNICODE_STRING SymbolicLinkName = {\n                        MountPoints-&gt;SymbolicLinkNameLength,\n                        SymbolicLinkName.Length,\n                        (PWSTR)RtlOffsetToPointer(pmmp, MountPoints-&gt;SymbolicLinkNameOffset)\n                    };\n\n                    UNICODE_STRING DeviceName = {\n                        MountPoints-&gt;DeviceNameLength,\n                        DeviceName.Length,\n                        (PWSTR)RtlOffsetToPointer(pmmp, MountPoints-&gt;DeviceNameOffset)\n                    };\n\n                    PWSTR FsPath;\n\n                    if (RtlPrefixUnicodeString(&amp;DeviceName, ImageName, TRUE) &amp;&amp; \n                        DeviceName.Length &lt; ImageName-&gt;Length &amp;&amp;\n                        *(FsPath = (PWSTR)RtlOffsetToPointer(ImageName-&gt;Buffer, DeviceName.Length)) == '\\\\' &amp;&amp;\n                        MOUNTMGR_IS_DRIVE_LETTER(&amp;SymbolicLinkName))\n                    {\n                        cb = ImageName-&gt;Length - DeviceName.Length;\n\n                        if (PWSTR psz = new WCHAR[3 + cb/sizeof(WCHAR)])\n                        {\n                            *ppsz = psz;\n\n                            psz[0] = SymbolicLinkName.Buffer[12];\n                            psz[1] = ':';\n                            memcpy(psz + 2, FsPath, cb + sizeof(WCHAR));\n\n                            return NOERROR;\n                        }\n\n                        return ERROR_NO_SYSTEM_RESOURCES;\n                    }\n\n                } while (MountPoints++, --NumberOfMountPoints);\n            }\n\n            return ERROR_NOT_FOUND;\n        }\n\n        rcb = pmmp-&gt;Size;\n\n    } while ((err = GetLastError()) == ERROR_MORE_DATA);\n\n    return err;\n}\n\n\nULONG NtToDosPath(PWSTR lpFilename, PWSTR* ppsz)\n{\n    HANDLE hMM = CreateFile(MOUNTMGR_DOS_DEVICE_NAME, FILE_GENERIC_READ, \n        FILE_SHARE_VALID_FLAGS, 0, OPEN_EXISTING, 0, 0);\n\n    if (hMM == INVALID_HANDLE_VALUE)\n    {\n        return GetLastError();\n    }\n\n    UNICODE_STRING us;\n\n    RtlInitUnicodeString(&amp;us, lpFilename);\n\n    ULONG err = NtToDosPath(hMM, &amp;us, ppsz);\n\n    CloseHandle(hMM);\n\n    return err;\n}\n\n    PWSTR psz;\n    if (NtToDosPath(path, &amp;psz) == NOERROR)\n    {\n        DbgPrint(\"%S\\n\", psz);\n        delete [] psz;\n    }\n</code></pre>\n\n<p>also we can change in code to <code>MOUNTMGR_IS_VOLUME_NAME(&amp;SymbolicLinkName)</code> for get volume (persistent) name form instead driver letter form</p>\n"}], "owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4132, "favorite_count": 0, "accepted_answer_id": 48179574, "answer_count": 1, "score": 1, "last_activity_date": 1575564835, "creation_date": 1515543584, "last_edit_date": 1575564835, "question_id": 48178586, "link": "https://stackoverflow.com/questions/48178586/how-to-disable-wow64-file-system-redirection-for-getmodulefilenameex", "title": "How to disable WOW64 file system redirection for GetModuleFileNameEx?", "body": "<p>I'm running the following from a 32-bit process on a 64-bit Windows 10:</p>\n\n<pre><code>#ifndef _DEBUG\n    WCHAR buffPath[MAX_PATH] = {0};\n    FARPROC pfn = (FARPROC)::GetModuleHandleEx;\n    HMODULE hMod = NULL;\n    ::GetModuleHandleEx(GET_MODULE_HANDLE_EX_FLAG_FROM_ADDRESS | \n        GET_MODULE_HANDLE_EX_FLAG_UNCHANGED_REFCOUNT,\n        (LPCTSTR)pfn, &amp;hMod);\n\n    PVOID pOldVal = NULL;\n    if(::Wow64DisableWow64FsRedirection(&amp;pOldVal))\n    {\n        ::GetModuleFileNameEx(::GetCurrentProcess(), hMod, buffPath, _countof(buffPath));\n        ::Wow64RevertWow64FsRedirection(pOldVal);\n\n        wprintf(L\"Path=%s\\n\", buffPath);\n    }\n#else\n#error run_in_release_mode\n#endif\n</code></pre>\n\n<p>and I'm expecting to receive the path as <code>c:\\windows\\syswow64\\KERNEL32.DLL</code>, but it gives me:</p>\n\n<pre><code>Path=C:\\Windows\\System32\\KERNEL32.DLL\n</code></pre>\n\n<p>Any idea why?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 5, "creation_date": 1515543681, "post_id": 48178557, "comment_id": 83337255, "body": "Please don&#39;t post pictures of your output, put the output in your question. For all we know, the output could be correct, because we don&#39;t see how the array passed to <code>adat</code> is initialized. The original array might have already garbage to begin with."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515546544, "post_id": 48178557, "comment_id": 83337918, "body": "If you have <code>int main(void) { data adat[5] = { ... }; lista(5, &amp;adat); ... }</code>, you might get something similar to what you show -- you&#39;d be passing a pointer to an array instead of just an array, and happiness is not the result.  But that&#39;s just a guess (and there are obscure technical reasons it may not be a good guess).  If you&#39;ve coded correctly, that can&#39;t be the mistake; you&#39;d have prototype mismatch errors and the code wouldn&#39;t compile.  But the problem isn&#39;t in the code you show; the problem is in the code you don&#39;t show, so we can&#39;t help.  Read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1515546731, "post_id": 48178557, "comment_id": 83337970, "body": "Voting to close since the question does not contain a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515552432, "post_id": 48178557, "comment_id": 83339233, "body": "Curious that <code>data</code> has <code>char nev[40];</code>, yet format uses <code>&quot;%-15s&quot;</code>.  Recommend using <code>&quot;%-39.39s&quot;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515552517, "post_id": 48178557, "comment_id": 83339248, "body": "Problem is likely because un-posted code uses <code>feof()</code> and does not check the return values of <code>fscanf()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1515546513, "creation_date": 1515546513, "answer_id": 48178928, "question_id": 48178557, "link": "https://stackoverflow.com/questions/48178557/uninterpretable-format-when-trying-to-list-the-arrays-content/48178928#48178928", "title": "Uninterpretable format when trying to list the array&#39;s content", "body": "<p>Your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n  int cikkszam;\n  char nev[40];\n  int ar;\n} data;\n\nint lista(int listadb, data adat[]) {\n  int j = 0;\n  int i = 0;\n  //system(\"cls\");\n\n  for(i = 0; i &lt; listadb; i++) {\n    for(j = i + 1; j &lt; listadb; j++) {\n      if (adat[i].cikkszam &gt; adat[j].cikkszam) {\n        data temp = adat[i];\n        adat[i] = adat[j];\n        adat[j] = temp;\n      }\n    }\n  }\n\n  for (i = 0; i &lt; listadb; i++) {\n    printf (\"%-15d \\t %-15s \\t %-15d\\n\", adat[i].cikkszam, adat[i].nev, adat[i].ar);\n  }\n\n  //system(\"pause\");\n  return 0;\n}\n\n\nint main() {\n    data d[] = {\n            {1, \"abc\", 3},\n            {4, \"def\", 5,},\n            {567, \"fdsaf\", -35,},\n            {-1231, \"aaaaa\", 32135,},\n            {-333, \"bbbb\", 654,},\n    };\n    lista(sizeof(d)/sizeof(d[0]), d);\n    return 0;\n}\n</code></pre>\n\n<p>Gives me the following output:</p>\n\n<pre><code>-1231                aaaaa               32135          \n-333                 bbbb                654            \n1                    abc                 3              \n4                    def                 5              \n567                  fdsaf               -35       \n</code></pre>\n\n<p>The code you have provided is working correctly. My guess may only be that the error is somewhere outside the source code you have provided.</p>\n"}], "owner": {"reputation": 3, "user_id": 8965700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63e0379d65b336c76db9e495702a678?s=128&d=identicon&r=PG&f=1", "display_name": "J.JOHN", "link": "https://stackoverflow.com/users/8965700/j-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "closed_date": 1515551882, "accepted_answer_id": 48178928, "answer_count": 1, "score": -1, "last_activity_date": 1515546513, "creation_date": 1515543325, "last_edit_date": 1515544277, "question_id": 48178557, "link": "https://stackoverflow.com/questions/48178557/uninterpretable-format-when-trying-to-list-the-arrays-content", "closed_reason": "Not suitable for this site", "title": "Uninterpretable format when trying to list the array&#39;s content", "body": "<p>I ran into a problem when I tried to list my Array's content on my new Project. So the problem is that when I list the content of the Array, it writes random numbers instead of the correct content. The counter is working, everything is working well, only this function cannot make a correct output :/ </p>\n\n<p>Listing function:</p>\n\n<pre><code>typedef struct {\n  int cikkszam;\n  char nev[40];\n  int ar;\n} data;\n\nint lista(int listadb, data adat[]) {\n  int j = 0;\n  int i = 0;\n  system(\"cls\");\n\n  for(i = 0; i &lt; listadb; i++) {\n    for(j = i + 1; j &lt; listadb; j++) {\n      if (adat[i].cikkszam &gt; adat[j].cikkszam) {\n        data temp = adat[i];\n        adat[i] = adat[j];\n        adat[j] = temp;\n      }\n    }\n  }\n\n  for (i = 0; i &lt; listadb; i++) {\n    printf (\"%-15d \\t %-15s \\t %-15d\\n\", adat[i].cikkszam, adat[i].nev, adat[i].ar);\n  }\n\n  system(\"pause\");\n}\n</code></pre>\n\n<p>And the output is something like this:\n<a href=\"https://i.stack.imgur.com/oVBiP.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Thanks for your help in advance!</p>\n"}, {"tags": ["c", "arm", "stm32", "cpu-registers"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515541807, "post_id": 48178263, "comment_id": 83336830, "body": "<i>Why store something then write it and then retrieve it from memory discarted wroten content?</i> what? Can you please rewrite your question so that we can understand what you mean and not guess? Also what does <i>to hug a command</i> mean?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1515550782, "post_id": 48178263, "comment_id": 83338839, "body": "this was just asked and answered recently."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1515551065, "post_id": 48178263, "comment_id": 83338911, "body": "very standard to read-modify-write a registers contents so that some percentage of the register can be completely changed to the desired value in what the control register sees as a single write.  anything else can bring chaos to what the register controls."}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1515545057, "post_id": 48178626, "comment_id": 83337555, "body": "<i>but my guess is that the author of the code did not want the MCU to be in an intermediate state while tinkering with the registers.</i> not only that, but when you are initializing certain units (like uart, i2c, etc.) you sometimes have precise order into which some bits have to be set and cleared."}], "tags": [], "owner": {"reputation": 724, "user_id": 4873907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/744993b2ee1d447ea162c90a0e2e8af0?s=128&d=identicon&r=PG&f=1", "display_name": "Francis Straccia", "link": "https://stackoverflow.com/users/4873907/francis-straccia"}, "is_accepted": false, "score": 1, "last_activity_date": 1515543957, "creation_date": 1515543957, "answer_id": 48178626, "question_id": 48178263, "link": "https://stackoverflow.com/questions/48178263/code-that-hugs-commands-between-save-and-retrieve-mechanism/48178626#48178626", "title": "Code that hugs commands between save and retrieve mechanism", "body": "<p>I can't see anything strange:</p>\n\n<p>Lines 7-10 and 12-18 copy what seems to be the contents of a register to a local variable, do some operation on it and then store the result back to the original register.</p>\n\n<p>The reason why this may happen are multiple, but my guess is that the author of the code did not want the MCU to be in an intermediate state while tinkering with the registers. </p>\n\n<p>For example, what happens to the core after line 8 but before line 9? </p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1515545607, "creation_date": 1515545607, "answer_id": 48178828, "question_id": 48178263, "link": "https://stackoverflow.com/questions/48178263/code-that-hugs-commands-between-save-and-retrieve-mechanism/48178828#48178828", "title": "Code that hugs commands between save and retrieve mechanism", "body": "<p>It is to make the operations \"atomic\". All changes to the registers in one write operation. </p>\n"}, {"comments": [{"owner": {"reputation": 204, "user_id": 5242210, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/BEURj.jpg?s=128&g=1", "display_name": "Tedi", "link": "https://stackoverflow.com/users/5242210/tedi"}, "edited": false, "score": 0, "creation_date": 1515659697, "post_id": 48178847, "comment_id": 83386326, "body": "Thanks. I understand now."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 3, "last_activity_date": 1515545836, "creation_date": 1515545836, "answer_id": 48178847, "question_id": 48178263, "link": "https://stackoverflow.com/questions/48178263/code-that-hugs-commands-between-save-and-retrieve-mechanism/48178847#48178847", "title": "Code that hugs commands between save and retrieve mechanism", "body": "<p>This is used for speed optimization and to avoid unwanted states in memory-mapped registers.<br>\nImagine some example memory-mapped variable EXT->ABC. Imagine such exaggerated example situation:  </p>\n\n<ul>\n<li>We have some hardware memory address that is accessible via memory-mapped EXT->ABC variable</li>\n<li>We know that bit 1 is set and bit 2 is cleared in EXT->ABC</li>\n<li>We want to clear bit 1 and set bit 2 and leave all other bits unchanged in EXT->ABC</li>\n<li>Hardware doesn't allow bit 1 and bit 2 in EXT->ABC register to be both cleared or both set. Such states are forbidden and may result in undefined behavior (that means in ANY behavior, for example software reset).</li>\n<li>Reading and writing to EXT->ABC register is very very slow.</li>\n</ul>\n\n<p>If we operate on EXT->ABC variable directly:</p>\n\n<pre><code>CLEAR_BIT(EXT-&gt;ABC, 1); // expands to: EXT-&gt;ABC = EXT-&gt;ABC &amp; ~1;\nSET_BIT(EXT-&gt;ABC, 2);   // expands to: EXT-&gt;ABC = EXT-&gt;ABC | 2;\n</code></pre>\n\n<p>this will result in a forbidden state in between the two lines, as bit 1 and bit 2 will be set. Also, in these 2 lines, EXTI->IMR is accessed 4 times.\nTo resolve this, we need to store the value in EXTI->IMR register somewhere, modify needed bits, and then write the modified value to EXTI->IMR register. So we will:</p>\n\n<pre><code>uint32_t temp;\ntemp = EXT-&gt;ABC; // store\nCLEAR_BIT(temp, 1);\nSET_BIT(temp, 2);\nEXT-&gt;ABC = temp; // write\n</code></pre>\n\n<p>We read <em>once</em> from a memory-mapped variable, modify&amp;play with the value, do whatever we want. After that, we write <em>once</em> to memory-mapped variable. That way EXT->ABC register is touched only twice and code is written safely, so that no undefined/forbidden/unwanted states occur.<br>\nFor example: as for lines 7-10: to access <code>SYSCFG-&gt;EXTICR[position &gt;&gt; 2U]</code> you need multiple cpu operations (calculate <code>position &gt;&gt; 2U</code>, multiple by <code>sizeof(SYSCFG-&gt;EXTICR)</code>, add to <code>SYSCFG-&gt;EXTICR</code> address, dereference). Maybe it was developer intention to execute these lines faster. Or you need to clear bits <code>0x0F&lt;&lt;(4*(position&amp;0x03)</code> when writting to <code>(GPIO_GET_INDEX(GPIOx))&lt;&lt;(4*position&amp;0x03)</code>.</p>\n"}], "owner": {"reputation": 204, "user_id": 5242210, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/BEURj.jpg?s=128&g=1", "display_name": "Tedi", "link": "https://stackoverflow.com/users/5242210/tedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48178847, "answer_count": 3, "score": -4, "last_activity_date": 1515545836, "creation_date": 1515541250, "question_id": 48178263, "link": "https://stackoverflow.com/questions/48178263/code-that-hugs-commands-between-save-and-retrieve-mechanism", "title": "Code that hugs commands between save and retrieve mechanism", "body": "<p>Recently I am implementing the internal peripherals of STM32F0 family mcu in a c library.</p>\n\n<p>While I was looking at how ST managed to do the same with their HAL library I stepped into this piece of code...</p>\n\n<pre><code>  1 /*--------------------- EXTI Mode Configuration ------------------------*/\n  2 /* Configure the External Interrupt or event for the current IO */\n  3 if((GPIO_Init-&gt;Mode &amp; EXTI_MODE) == EXTI_MODE) \n  4 {\n  5  /* Enable SYSCFG Clock */\n  6  __HAL_RCC_SYSCFG_CLK_ENABLE();\n\n  7  temp = SYSCFG-&gt;EXTICR[position &gt;&gt; 2];\n  8  CLEAR_BIT(temp, (0x0FU) &lt;&lt; (4U * (position &amp; 0x03U)));\n  9  SET_BIT(temp, (GPIO_GET_INDEX(GPIOx)) &lt;&lt; (4U * (position &amp; 0x03U)));\n  10 SYSCFG-&gt;EXTICR[position &gt;&gt; 2] = temp;\n\n  11 /* Clear EXTI line configuration */\n  12  temp = EXTI-&gt;IMR;\n  13  CLEAR_BIT(temp, (uint32_t)iocurrent);\n  14  if((GPIO_Init-&gt;Mode &amp; GPIO_MODE_IT) == GPIO_MODE_IT)\n  15  {\n  16   SET_BIT(temp, iocurrent); \n  17  }\n  18  EXTI-&gt;IMR = temp;\n</code></pre>\n\n<p>What I am trying to understand is <strong>why</strong> the pair commands in lines <strong>7-10</strong> and <strong>12-18</strong> are used. <strong>Why</strong> are there? Why store something then write it and then retrieve it from memory discarted wroten content?\nIs it about multitasking and race conditions? I do not fully understand!</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1515541583, "post_id": 48178240, "comment_id": 83336767, "body": "Welcome to Stack Overflow. Sadly there are several sins in your code. At this point I&#39;d like to encourage you to read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>. If <code>fopen</code> returns <code>NULL</code>, it&#39;s most likely because the file doesn&#39;t exist or you don&#39;t have reading permissions on the file. <code>errno</code> is set in this case, use it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1515546854, "post_id": 48178240, "comment_id": 83337998, "body": "Unless the file name is too long, you&#39;ve got a newline at the end of it.  That is not going to lead to happiness.  Remove the newline returned by <code>fgets()</code>.  On Unix-like systems, newlines are allowed in file names, but Windows may prevent such names being created. Also, <code>t</code> is not allowed (officially) in <code>fopen()</code> open modes on Unix-like systems.  That&#39;s a Windows-ism.  You can specify <code>b</code> in the open mode; that means &#39;binary&#39;, but it is a no-op on Unix (it matters on Windows)."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1515547319, "creation_date": 1515547319, "answer_id": 48179012, "question_id": 48178240, "link": "https://stackoverflow.com/questions/48178240/invalid-argument-when-creating-a-file/48179012#48179012", "title": "&quot;Invalid argument&quot; when creating a file", "body": "<p>There are quite a few wrong things your code.</p>\n\n<p>1.\nThe correct signatures of <code>main</code> are</p>\n\n<ul>\n<li><code>int main(void);</code></li>\n<li><code>int main(int argc, char **argv)</code></li>\n<li><code>int main(int argc, char *argv[])</code></li>\n</ul>\n\n<p>See <a href=\"https://stackoverflow.com/questions/2108192/what-are-the-valid-signatures-for-cs-main-function\">What are the valid signatures for C&#39;s main() function?</a></p>\n\n<p>2.\nThe behaviour of <code>fflush(stdin)</code> is undefined. See <a href=\"https://stackoverflow.com/a/2979217/1480131\">Using <code>fflush(stdin)</code></a>.\n<code>fflush</code> works with <strong>output</strong> buffers, it tells the OS that is should write\nthe buffered content. <code>stdin</code> is an <strong>input</strong> buffer, flushing makes no sense.</p>\n\n<p>3.\nUse <code>fgets</code> like this:</p>\n\n<pre><code>char name_file[30];\nfgets(name_file, sizeof name_file, stdin);\n</code></pre>\n\n<p>It's more robust using <code>sizeof name_file</code> because this will give you always\nthe correct size. If you later change the declaration of <code>name_file</code> to\nan <code>char</code> array with less than 30 spaces, but forget to change the size parameter in <code>fgets</code>, you\nmight end up with a buffer overflow.</p>\n\n<p>4.\nYou are passing to <code>creation</code> the uninitialized pointer <code>p</code> that is pointing\nto nowhere. In said function you cannot read nor write with the pointer <code>a</code>.\nYou need to allocate memory prior to the call of <code>creation</code>. At least judging\nfrom the code you posted.</p>\n\n<p>5.\n<code>fgets</code> preserves the newline (<code>'\\n'</code>) character, so\n<code>name_file</code> is containing the newline character. I really don't know if newline\nis allowed in file names. I did a google search but found conflicting answers.\nI don't think that you want to have newlines in your file names, anyway. It's\nbest to remove it before passing it to <code>fopen</code> (which might be the reason for\nthe error 22):</p>\n\n<pre><code>char name_file[30];\nfgets(name_file, sizeof name_file, stdin);\nint len = strlen(name_file);\nif(name_file[len - 1] == '\\n')\n    name_file[len - 1] = 0;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9195726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2e1078ee466b6f5b859d6962559d1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9195726/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "accepted_answer_id": 48179012, "answer_count": 1, "score": -1, "last_activity_date": 1515752639, "creation_date": 1515541118, "last_edit_date": 1515752639, "question_id": 48178240, "link": "https://stackoverflow.com/questions/48178240/invalid-argument-when-creating-a-file", "title": "&quot;Invalid argument&quot; when creating a file", "body": "<p>Could you help me with the creation of a text file as right now the *fp pointer to the file is returning NULL to the function fopen ?</p>\n\n<p>Using the library <code>errno.h</code> and <code>extern int errno</code> I get \"Value of errno: 22\".</p>\n\n<p><code>if (!fp)perror(\"fopen\")</code> gives me \"Error opening file: Invalid argument\".</p>\n\n<p>In my main function I enter the name of the file:</p>\n\n<pre><code>void main()\n{\n    float **x;\n    int i,j;\n    int l,c;\n    char name_file[30];\n    FILE *res;\n\n    /* some lines omitted */\n\n    printf(\"\\nEnter the name of the file =&gt;\"); \n    fflush (stdin);\n    fgets(name_file,30,stdin);\n    printf(\"Name of file : %s\", name_file);\n\n    res=creation(name_file,l,c,x);\n    printf(\"\\nThe created file\\n\");\n    readfile(res,name_file);\n}\n</code></pre>\n\n<p>The function to create the text file:</p>\n\n<pre><code>FILE *creation(char *f_name,int l, int c, float **a) // l rows - c colums - a array \n{   FILE *fp;\n    int i,j;\n\n    fp = fopen(f_name,\"wt+\"); // create for writing and reading\n\n    fflush(stdin);\n\n/* The pointer to the file is NULL: */\n\n    if (!fp)perror(\"fopen\"); // it's returning Invalid argument\n    printf(\"%d\\n\",fp); //0 ??\n\n    if(fp==NULL) { printf(\"File could not be created!\\n\"); exit(1); }\n\n    fflush(stdin);\n    for(i=0;i&lt;l;i++)\n  {\n     for(j=0;j&lt;c;j++)\n     {\n        fprintf(fp,\"%3.2f\",a[i][j]); // enter every score of the array in the text file\n     }\n     fprintf(fp,\"\\n\");\n  }\n\n    return fp;\n}\n</code></pre>\n\n<p>Function to read the file and check if it is correct:</p>\n\n<pre><code>**void readfile(FILE *fp,char *f_name)**\n{\n  float a;\n  rewind(fp);\n  if(fp==NULL) { printf(\"File %s could not open\\n\",f_name); exit(1); }\n  while(fscanf(fp,\"%3.2f\",&amp;a)!= EOF)\n    printf(\"\\n%3.2f\",a);\n  fclose(fp);\n}\n</code></pre>\n"}, {"tags": ["c", "variables", "struct", "wireshark"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515541046, "post_id": 48178134, "comment_id": 83336612, "body": "Suggestion: &quot;struct is large (&gt; 650 bytes) and contains compound elements and typedefs.&quot;  --&gt; Posting that structure (or a facsimile of it) would lead to improved quality of answers.  Posting sample code of &quot;I would then be able to decode the data&quot; would help too to clarify your coding goals."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515541166, "post_id": 48178134, "comment_id": 83336648, "body": "For the offsets, <a href=\"http://en.cppreference.com/w/cpp/types/offsetof\" rel=\"nofollow noreferrer\"><code>offsetof</code></a> can help. For more than that, I\u2019d check if the compiler offered an API to access this information; I know Clang does and I\u2019m pretty sure GCC does. What compiler is being used."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1515541278, "post_id": 48178134, "comment_id": 83336684, "body": "&quot;without regard to the original compiler&quot;: Different compilers and different compiler settings will align the data differently. This sounds like a problem more complicated than you think?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515548878, "post_id": 48178134, "comment_id": 83338464, "body": "I expect the correct answer is to compile with debugging information and somehow extract this from that. I don\u2019t know enough about the various debugging information standards to help with that, though I wouldn\u2019t be surprised if some standard tool could do it."}, {"owner": {"reputation": 168, "user_id": 4113608, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Ncslv.jpg?s=128&g=1", "display_name": "alindber", "link": "https://stackoverflow.com/users/4113608/alindber"}, "edited": false, "score": 0, "creation_date": 1515550716, "post_id": 48178134, "comment_id": 83338821, "body": "The compiler used is gcc in 32 bit linux. I know that I can use <code>offset</code> to get what I need but I was hoping for some sort of automated script or code that would list all struct elements and type, then use that to loop through the generated list and using <code>offset</code> to get the required info."}, {"owner": {"reputation": 3917, "user_id": 2755698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=128&d=identicon&r=PG", "display_name": "Christopher Maynard", "link": "https://stackoverflow.com/users/2755698/christopher-maynard"}, "edited": false, "score": 0, "creation_date": 1515559731, "post_id": 48178134, "comment_id": 83340868, "body": "I don&#39;t know if your protocol is amenable to ASN.1 or not, and I don&#39;t personally have much experience with ASN.1, so I don&#39;t this will help you or not, but have you looked into ASN.1?  For example, see: <a href=\"https://wiki.wireshark.org/Asn2wrs\" rel=\"nofollow noreferrer\">wiki.wireshark.org/Asn2wrs</a>,  <a href=\"https://code.wireshark.org/review/gitweb?p=wireshark.git;a=tree;f=epan/dissectors/asn1;hb=HEAD\" rel=\"nofollow noreferrer\">code.wireshark.org/review/gitweb?p=wireshark.git;a=tree;f=ep&zwnj;&#8203;an/&hellip;</a>, ..."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515600237, "post_id": 48178134, "comment_id": 83363193, "body": "@alindber When I said \u201cedit this into the question\u201d, I meant you should hit the edit link under the question tags and put it there, not as a comment. People are more likely to see it if it\u2019s in the question itself."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515604263, "post_id": 48178134, "comment_id": 83365763, "body": "If you do find a way to automate this, using my method below or any other method, I\u2019d be interested in whatever tool you create. I have a lot of smaller <code>struct</code>s I\u2019d like to teach to Wireshark if it were easy enough."}], "answers": [{"tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1515604107, "creation_date": 1515604107, "answer_id": 48192644, "question_id": 48178134, "link": "https://stackoverflow.com/questions/48178134/extract-variable-names-and-offsets-from-a-compound-c-struct/48192644#48192644", "title": "Extract variable names and offsets from a compound C struct", "body": "<p>Disclaimer: I haven\u2019t used this myself beyond what you see here, especially not in complex situations; I\u2019m only posting this as an answer because it\u2019s better than the current lack-of-an-answer, but don\u2019t be surprised if there are better options or critical information missing from this answer.</p>\n\n<hr>\n\n<p>It looks like all the information you need is available in the debug information when you compile with the <code>-g</code> flag. You can see it in close-to-raw format with</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>objdump -Wi object_file.o\n</code></pre>\n\n<p>This isn\u2019t the most useful format, and there are tools to analyze it for you. One of them is <code>pahole</code> (<a href=\"https://git.kernel.org/pub/scm/devel/pahole/pahole.git/tree/\" rel=\"nofollow noreferrer\">sources</a>, <a href=\"https://lwn.net/Articles/335942/\" rel=\"nofollow noreferrer\">LWN article</a>, <a href=\"https://linux.die.net/man/1/pahole\" rel=\"nofollow noreferrer\">man page</a>); I haven\u2019t used it enough to recommend it, but it seems at least worth investigating further. It may be under <code>dwarves</code> or something in your package manager because it\u2019s part of a collection of related tools for handling DWARF debug information.</p>\n\n<p>It seems to output exactly the information you want, with a few flags. It\u2019s easier to parse the original C, but it still looks more like it\u2019s intended for humans than for computer parsing; I haven\u2019t found a flag that looks purely intended for machine parsing. Here\u2019s an example <code>pahole</code> run:</p>\n\n<p>Input <code>struct.c</code></p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nstruct simple {\n  int32_t i32;\n  char c;\n  uint64_t u64;\n} simple_object;\n\nstruct complicated {\n  struct simple nested_simple;\n  union {\n    float union_float;\n    uint32_t union_int;\n  } nested_union;\n  struct {\n    double d;\n    char c;\n  } nested_struct;\n  char some_chars[5];\n  struct simple_packed nested_simple_packed;\n  enum {COMPLICATED_ENUM1, COMPLICATED_ENUM2, COMPLICATED_ENUM3} enumeration;\n} complicated_object;\n</code></pre>\n\n<p>After running\n</p>\n\n<pre><code>gcc -g structs.c -c -o structs.o \npahole --expand_types structs.o\n</code></pre>\n\n<p>you get</p>\n\n<pre><code>struct simple {\n        /* typedef int32_t -&gt; __int32_t */ int                        i32;               /*     0     4 */\n        char                       c;                                                    /*     4     1 */\n\n        /* XXX 3 bytes hole, try to pack */\n\n        /* typedef uint64_t -&gt; __uint64_t */ long unsigned int          u64;             /*     8     8 */\n\n        /* size: 16, cachelines: 1, members: 3 */\n        /* sum members: 13, holes: 1, sum holes: 3 */\n        /* last cacheline: 16 bytes */\n};\nstruct complicated {\n        struct simple {\n                /* typedef int32_t -&gt; __int32_t */ int                i32;               /*     0     4 */\n                char               c;                                                    /*     4     1 */\n\n                /* XXX 3 bytes hole, try to pack */\n\n                /* typedef uint64_t -&gt; __uint64_t */ long unsigned int  u64;             /*     8     8 */\n        } nested_simple; /*     0    16 */\n        union {\n                float              union_float;                                          /*           4 */\n                /* typedef uint32_t -&gt; __uint32_t */ unsigned int       union_int;       /*           4 */\n        } nested_union;                                                                  /*    16     4 */\n\n        /* XXX 4 bytes hole, try to pack */\n\n        struct {\n                double             d;                                                    /*    24     8 */\n                char               c;                                                    /*    32     1 */\n        } nested_struct;                                                                 /*    24    16 */\n        char                       some_chars[5];                                        /*    40     5 */\n\n        /* XXX 3 bytes hole, try to pack */\n\n        enum {\n                COMPLICATED_ENUM1 = 0,\n                COMPLICATED_ENUM2 = 1,\n                COMPLICATED_ENUM3 = 2,\n        } enumeration;                                                                   /*    48     4 */\n\n        /* size: 56, cachelines: 1, members: 5 */\n        /* sum members: 45, holes: 2, sum holes: 7 */\n        /* padding: 4 */\n        /* last cacheline: 56 bytes */\n};\n</code></pre>\n"}], "owner": {"reputation": 168, "user_id": 4113608, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Ncslv.jpg?s=128&g=1", "display_name": "alindber", "link": "https://stackoverflow.com/users/4113608/alindber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515604107, "creation_date": 1515540381, "last_edit_date": 1515545641, "question_id": 48178134, "link": "https://stackoverflow.com/questions/48178134/extract-variable-names-and-offsets-from-a-compound-c-struct", "title": "Extract variable names and offsets from a compound C struct", "body": "<p>I am working on a Wireshark plugin that must decode a large packet that is created by writing a struct into the packet.  If I am able to know the variable names and offset of the original structure, I would then be able to decode the data without regard to the original compiler.  The struct is large (> 650 bytes) and contains compound elements and typedefs.</p>\n\n<p>The construction of the struct changes based on the version of software generating the data.  I have access to the raw header files and the compiler used in creating the software, thus I can create a framework to extract the detail I need for use in Wireshark.</p>\n\n<p>I have been successful in hand coding the decode for a few of the variables and offsets needed but the size and complexity of the structure require more automation than I can do by hand. </p>\n\n<p>Any suggestion on how to do this would be most welcome.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1515540518, "post_id": 48178128, "comment_id": 83336463, "body": "<code>sizeof(alle_rytterdata2017)</code> will give you the size of a pointer, not the size of the array"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1515540682, "post_id": 48178128, "comment_id": 83336505, "body": "indeed. You need to pass in the size of the array. Also, <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1515541878, "post_id": 48178128, "comment_id": 83336856, "body": "As a developer it&#39;s crucial to learn how to debug your programs: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1515542057, "post_id": 48178128, "comment_id": 83336908, "body": "@pm100 I think maybe it should be <code>sizeof(*alle_rytterdata2017)</code> to get the size of the array type?"}, {"owner": {"reputation": 1, "user_id": 9021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce235046e3555e8c4ddcdd935c9842be?s=128&d=identicon&r=PG&f=1", "display_name": "ulla hula", "link": "https://stackoverflow.com/users/9021928/ulla-hula"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515542366, "post_id": 48178128, "comment_id": 83336978, "body": "@ChristianGibbons I tried to change it to sizeof(*alle_rytterdata2017) but it still didnt work for some reason."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515542578, "post_id": 48178128, "comment_id": 83337041, "body": "@ullahula the <code>sizeof</code> operator returns the number of bytes needed to hold the value of a variable. <code>alle_rytterdata2017</code> is a pointer, <code>sizeof(alle_rytterdata2017)</code> gives you the numbers of bytes needed to store a pointer, <code>sizeof(*alle_rytterdata2017)</code> gives you the numbers of bytes needed to store a <code>rytterdata2017</code> object. <code>opgave_2</code> must get from the caller the number of elements as well."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515542740, "post_id": 48178128, "comment_id": 83337077, "body": "@ullahula Interesting.  I tried it on my machine with some test code of my own and it worked; I would think it would be equivalent in effect to Kamul&#39;s solution."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce235046e3555e8c4ddcdd935c9842be?s=128&d=identicon&r=PG&f=1", "display_name": "ulla hula", "link": "https://stackoverflow.com/users/9021928/ulla-hula"}, "edited": false, "score": 0, "creation_date": 1515541105, "post_id": 48178189, "comment_id": 83336631, "body": "Sorry to bother you again, but are you saying that the structure of my qsort is wrong because your example seems very different from mine. Also, thank you for your quick answer."}, {"owner": {"reputation": 673, "user_id": 4417436, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cD633.jpg?s=128&g=1", "display_name": "jelic98", "link": "https://stackoverflow.com/users/4417436/jelic98"}, "reply_to_user": {"reputation": 1, "user_id": 9021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce235046e3555e8c4ddcdd935c9842be?s=128&d=identicon&r=PG&f=1", "display_name": "ulla hula", "link": "https://stackoverflow.com/users/9021928/ulla-hula"}, "edited": false, "score": 0, "creation_date": 1515541321, "post_id": 48178189, "comment_id": 83336695, "body": "It&#39;s difficult to read variable names in you code so I posted this shorter version that is also easier to understand. To qsort pass array, number of strings, size of each string and pointer to function which you want to use. Feel free to accept this answer."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1515541889, "post_id": 48178189, "comment_id": 83336859, "body": "The asker&#39;s example compares two sets of strings, so just passing in strcmp as the comparison function to qsort will likely not fit their needs."}], "tags": [], "owner": {"reputation": 673, "user_id": 4417436, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cD633.jpg?s=128&g=1", "display_name": "jelic98", "link": "https://stackoverflow.com/users/4417436/jelic98"}, "is_accepted": false, "score": 0, "last_activity_date": 1515540753, "creation_date": 1515540753, "answer_id": 48178189, "question_id": 48178128, "link": "https://stackoverflow.com/questions/48178128/my-qsort-array-of-strings-in-alphabetical-order-wont-work/48178189#48178189", "title": "My qsort array of strings in alphabetical order won&#39;t work", "body": "<p>Program below sorts array of strings using pointer to <code>strcmp</code> function which compares strings alphabetically. Before this just read from file into <code>str</code> array.</p>\n\n<pre><code>int main () {\n  int i;\n  char str[3][10] = {\"one\", \"two\", \"three\"};\n\n  qsort(str, 3, 10, (int(*) (const void*, const void*)) strcmp);\n\n  for(i = 0; i &lt; 3; i++) {\n      printf(\"%s\\n\", str[i]);\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515542535, "post_id": 48178376, "comment_id": 83337032, "body": "Note: <code>()</code> are not needed in <code>sizeof(arr[0])</code>.  <code>sizeof arr[0]</code> is enough."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1515541987, "creation_date": 1515541987, "answer_id": 48178376, "question_id": 48178128, "link": "https://stackoverflow.com/questions/48178128/my-qsort-array-of-strings-in-alphabetical-order-wont-work/48178376#48178376", "title": "My qsort array of strings in alphabetical order won&#39;t work", "body": "<p>The problem is with the parameter size passed to qsort function.<br>\n<code>sizeof(alle_rytterdata2017)</code> will give you size of a pointer to rytterdata2017.<br>\n<code>qsort</code> however sorts data that are of <code>rytterdata2017</code> size. You should pass <code>sizeof(arr[0])</code> or <code>sizeof(rytterdata017)</code> to <code>qsort</code>.</p>\n\n<p>Please include more source code, with struct definitions for future questions.<br>\nI have written the following code for testing:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct\n{\n  char rytterhold[20];\n  char nationalitet[20];\n  char rytterFornavn[20];\n} rytterdata2017;\n\nint sammenlign_hold(const void *p1, const void *p2) {\nrytterdata2017 *resultat1 = (rytterdata2017 *)p1;\nrytterdata2017 *resultat2 = (rytterdata2017 *)p2;\nint temp;\nif ((temp = strcmp(resultat1 -&gt; rytterhold, resultat2 -&gt; rytterhold)) == 0) \nreturn strcmp(resultat1 -&gt; rytterFornavn, resultat2 -&gt; rytterFornavn);\n    else\n    return temp; \n // strcmp(resultat1 -&gt; rytterhold, resultat2 -&gt; rytterhold);\n // tip: don't call strcmp twice, it is cpu extensive\n}\n\nvoid opgave_2(rytterdata2017 *alle_rytterdata2017, size_t PERSONER) {\nrytterdata2017 arr[100];\nint k = 0;\nint i = 0;\nfor (i = 0; i &lt; PERSONER; i++) {\n if(strcmp(alle_rytterdata2017[i].nationalitet, \"DEN\") == 0) {\n           strcpy(arr[k].rytterFornavn,    alle_rytterdata2017[i].rytterFornavn);\n           strcpy(arr[k].rytterhold, alle_rytterdata2017[i].rytterhold);\n           k++;\n       }\n   }\n\n // qsort(arr, k, sizeof(alle_rytterdata2017), sammenlign_hold); // no error, but sizeof(alle_rytterdata2017) is ont size of the object stored in arr\n qsort(arr, k, sizeof(arr[0]), sammenlign_hold);\n // or qsort(arr, k, sizeof(*alle_rytterdata2017), sammenlign_hold);\n // or qsort(arr, k, sizeof(alle_rytterdata2017[0]), sammenlign_hold);\n // or qsort(arr, k, sizeof(rytterdata2017), sammenlign_hold);\n // on my machine:\n // sizeof(alle_rytterdata2017) = 8\n // sizeof(*alle_rytterdata2017) = sizeof(rytterdata2017) = 60\n\nfor (int i = 0; i &lt; k; i++) {\nprintf(\"%s %s \\n\", arr[i].rytterhold, arr[i].rytterFornavn);\n} }\nint\nmain ()\n{\n    rytterdata2017 arr[] = {\n        {\"c\",\"DEN\",\"b\"},\n        {\"a\",\"DEN\",\"e\"},\n        {\"c\",\"DEN\",\"a\"},\n        {\"d\",\"DEN\",\"c\"},\n        {\"d\",\"DEN\",\"a\"},\n        {\"b\",\"DEN\",\"a\"},\n    };\n    opgave_2(arr, sizeof(arr)/sizeof(arr[0]));\n  return 0;\n}\n</code></pre>\n\n<p>Which produces:</p>\n\n<pre><code>a e \nb a \nc a \nc b \nd a \nd c \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce235046e3555e8c4ddcdd935c9842be?s=128&d=identicon&r=PG&f=1", "display_name": "ulla hula", "link": "https://stackoverflow.com/users/9021928/ulla-hula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515545508, "creation_date": 1515540315, "last_edit_date": 1515545508, "question_id": 48178128, "link": "https://stackoverflow.com/questions/48178128/my-qsort-array-of-strings-in-alphabetical-order-wont-work", "title": "My qsort array of strings in alphabetical order won&#39;t work", "body": "<p>I'm currently having problems with my qsort. I'm trying to sort an array of strings I read from a file in the qsort function. I want it to be read alphabetically, but it isnt working. I would've liked to attached my file as well, but it is very long. This is my code:</p>\n\n<pre><code>int sammenlign_hold(const void *p1, const void *p2) {\n    rytterdata2017 *resultat1 = (rytterdata2017 *)p1;\n    rytterdata2017 *resultat2 = (rytterdata2017 *)p2;\n\n    if (strcmp(resultat1 -&gt; rytterhold, resultat2 -&gt; rytterhold) == 0)\n        return strcmp(resultat1 -&gt; rytterFornavn, resultat2 -&gt; rytterFornavn);\n    else\n        return strcmp(resultat1 -&gt; rytterhold, resultat2 -&gt; rytterhold);\n} \n\nvoid opgave_2(rytterdata2017 *alle_rytterdata2017) {\n    rytterdata2017 arr[100];\n\n    int k = 0;\n    int i = 0; \n\n    for (i = 0; i &lt; PERSONER; i++) {\n        if(strcmp(alle_rytterdata2017[i].nationalitet, \"DEN\") == 0) {\n           strcpy(arr[k].rytterFornavn,    alle_rytterdata2017[i].rytterFornavn);\n           strcpy(arr[k].rytterhold, alle_rytterdata2017[i].rytterhold);\n           k++;\n       }       \n   }\n\n    qsort(arr, k, sizeof(alle_rytterdata2017), sammenlign_hold); \n\n    for (int i = 0; i &lt; k; i++) {\n        printf(\"%s %s \\n\", arr[i].rytterhold, arr[i].rytterFornavn);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "memory-management", "malloc", "realloc"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1515538421, "post_id": 48177778, "comment_id": 83335811, "body": "Recommend letting us in on &quot;the error&quot; Could be very helpful in figuring out what went wrong."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1515538681, "post_id": 48177778, "comment_id": 83335897, "body": "My guess: <code>edit_print</code> contains a buffer overrun error. You masked this bug by giving it some extra room to overrun into."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515538976, "post_id": 48177778, "comment_id": 83335986, "body": "OT: This does not explain the error, yet <code>sizeof(char) * length + 1</code> is semantically incorrect.  The <code>sizeof() </code> should multiple by the sum of <code>length + 1</code>.  But since, in this case, <code>sizeof(char)==1</code> --&gt; no problem."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1515539145, "post_id": 48177778, "comment_id": 83336040, "body": "First of all, &quot;sizeof(char)&quot; is defined to be 1, so is irrelevant and superfluous everywhere. Then, the only code that seems to do anything with all this memory you&#39;re allocating is edit_print(), which you&#39;re not showing us."}, {"owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515548682, "post_id": 48177778, "comment_id": 83338409, "body": "@LeeDanielCrocker I added the function"}, {"owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1515548723, "post_id": 48177778, "comment_id": 83338424, "body": "@user4581301 the error is in the header. Thats all im getting."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515550049, "post_id": 48177778, "comment_id": 83338682, "body": "@rhoward207 Prior to each <code>... = realloc(ptr, sz);</code>, add <code>fprintf(stderr, &quot;%d %p %zu\\n&quot;, __LINE__, (void*)ptr, sz);</code> and report the last output before code dies."}, {"owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515550573, "post_id": 48177778, "comment_id": 83338789, "body": "@chux what is sz in the arguments?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515550722, "post_id": 48177778, "comment_id": 83338822, "body": "In <code>realloc(NULL, sizeof(char) * size);</code>, <code>sz</code> is <code>sizeof(char) * size</code>,  In <code>realloc(str, sizeof(char) * length + 1);</code>, <code>sz</code> is <code>sizeof(char) * length + 1</code>.  In <code>realloc(str, sizeof(char) * (size += 20));</code> <code>sz</code> is <code>sizeof(char) * (size + 20));</code>  (not <code>+=</code>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515550738, "post_id": 48177778, "comment_id": 83338827, "body": "General comment: A weak design attribute is testing the size <i>after</i> setting an element of the array.  A better approach would test space availability first before <code>str[length++] = inputch;</code> and before <code>str[length++] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515550953, "post_id": 48177778, "comment_id": 83338877, "body": "Minor: <code>if ((!*end) &amp;&amp; num &gt; 0)</code> ---&gt; <code>if (options[2] != end &amp;&amp; (!*end) &amp;&amp; num &gt; 0)</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515551226, "post_id": 48177778, "comment_id": 83338953, "body": "Instead of including <code>process_options()</code> code.  A <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> would have used <code>size_t space_size_arg = 3;</code> - assuming that still fails.  GTG"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516751678, "post_id": 48177778, "comment_id": 83815398, "body": "arent you allocated the buffer <code>str</code> for the next string on each loop. Are they all the same size? First time you have str = 10 bytes, then you count chars and realloc str to the size you just read. But that buffer is used fro the next string"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "edited": false, "score": 0, "creation_date": 1515548335, "post_id": 48177963, "comment_id": 83338340, "body": "unfortunately your suggestion does not fix the error. I will edit my post to include what I am seeing. I also added edit_print. thank for the info about sizeof(type)."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515549656, "post_id": 48177963, "comment_id": 83338603, "body": "Please provide a <a href=\"http://stackoverflow.com/help/mcve\"><b>A Minimal, Complete, and Verifiable example</b></a> for further help."}, {"owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "edited": false, "score": 0, "creation_date": 1515552121, "post_id": 48177963, "comment_id": 83339173, "body": "@chux after adding fprintf, last few lines: #####  ####### ####### ######               # ####### ###### 100 0x55da9f4416a0 41 #     # #     # #     # #     #              # #     # #     # 100 0x55da9f4416a0 41 #       #     # #     # #     #              # #     # #     # 100 0x55da9f4416a0 44 *** Error in `./project1&#39;: corrupted size vs. prev_size: 0x000055da9f4416c0 *** Aborted (core dumped)"}, {"owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "edited": false, "score": 0, "creation_date": 1515553025, "post_id": 48177963, "comment_id": 83339379, "body": "fprintf(stderr, &quot;%d %p %zu\\n&quot;, <b>LINE</b>, (void*)str, sizeof(char)*length+1); @chux"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "edited": false, "score": 0, "creation_date": 1515553341, "post_id": 48177963, "comment_id": 83339439, "body": "@rhoward207 Notice that the problem occurs on the first non-blank line shorter than prior ones.    Certainly the issue is in shrinking the allocation.  The 100 is suspicious as no line is longer than about 75 characters - hmmmm."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1515540548, "last_edit_date": 1515540548, "creation_date": 1515539178, "answer_id": 48177963, "question_id": 48177778, "link": "https://stackoverflow.com/questions/48177778/c-realloc-error-corrupted-size-vs-prev-size/48177963#48177963", "title": "C - realloc error: corrupted size vs prev_size", "body": "<p><code>size</code> needs updating when <code>inputch == '\\n'</code>.</p>\n\n<p><code>char *tmp = realloc(str, sizeof(char) * length + 1 /* or no +1 */);</code> can shrink the allocation.  which makes a later <code>if (length == size)</code> invalid (the true allocation size is smaller) and so <code>str[length++] = inputch;</code> lost memory access protection.  Update <code>size</code> to fix that hole.</p>\n\n<p><code>+1</code> not needed - it simply hid the problem as the <code>+ 1</code> did not shrink the allocation as much.</p>\n\n<pre><code>  char *tmp = realloc(str, sizeof(char) * length);\n  if (tmp == NULL) {\n    exit(0);\n  } else {\n    str = tmp;\n  }\n  size = length; // add\n</code></pre>\n\n<hr>\n\n<p>Concerning <code>sizeof(char)*</code> code.  The idea of scaling by the size of the target type is good, yet with <code>char</code> it is not important as it is <em>always</em> 1.  <a href=\"https://stackoverflow.com/questions/48177778/c-realloc-error-corrupted-size-vs-prev-size/48177963#comment83336040_48177778\">@Lee Daniel Crocker</a></p>\n\n<p>If code wants to reflect that the type of the target may change, do not use <code>size(the_type)</code>, use <code>sizeof(*the_pointer)</code>.  Easier to code, review and maintain.</p>\n\n<pre><code>// Don't even need to code the type `str` points to\ntmp = realloc(str, sizeof *str * length);\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6279704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoeLT.jpg?s=128&g=1", "display_name": "rhoward", "link": "https://stackoverflow.com/users/6279704/rhoward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18689, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516749656, "creation_date": 1515538107, "last_edit_date": 1516749656, "question_id": 48177778, "link": "https://stackoverflow.com/questions/48177778/c-realloc-error-corrupted-size-vs-prev-size", "title": "C - realloc error: corrupted size vs prev_size", "body": "<p>Could someone please explain the error?<br>\nI was getting the error until, on a whim, I changed the line from:</p>\n\n<pre><code>char *tmp = realloc(str, sizeof(char)*length);\n// to                                           added 1\nchar *tmp = realloc(str, sizeof(char) * length + 1);\n</code></pre>\n\n<p>I thought that multiplying <code>sizeof(char)</code> by length would reallocate a new memory area of <code>size=sizeof(char)*length</code>. I'm not understanding why adding 1 fixes the problem.</p>\n\n<pre><code>    void edit_print(char *inputStr, size_t space_size) {\n      size_t ch_position = 0;\n      size_t space_column_count = 0;\n      size_t num_spaces_left = 0;\n      while ((inputStr[ch_position] != '\\0')) {\n        if ((inputStr[ch_position] == '\\t') &amp;&amp; (space_size !=0)) {\n          num_spaces_left = (space_size-(space_column_count % space_size));\n          if (ch_position == 0 || !(num_spaces_left)) {\n            for (size_t i=1; i &lt;= space_size; i++) {\n              putchar(' ');\n              space_column_count++;\n            }\n            ch_position++;\n          } else {\n            for (size_t i=1; i &lt;= num_spaces_left; i++) {\n              putchar(' ');\n              space_column_count++;\n            }\n            ch_position++;\n          }\n        } else {\n          putchar(inputStr[ch_position++]);\n          space_column_count++;\n        }\n      }\n      printf(\"\\n\");\n    }\n\n        int main(int argc, char *argv[]) {\n          size_t space_size_arg = 3; \n          int inputch;\n          size_t length = 0;\n          size_t size = 10;\n          char *str = realloc(NULL, sizeof(char) * size);\n          printf(\"Enter stuff\\n\");\n\n          while ((inputch = getchar()) != EOF) {\n            if (inputch == '\\n') {\n              str[length++] = '\\0';\n\n              //changed line below\n              char *tmp = realloc(str, sizeof(char) * length + 1);\n\n              if (tmp == NULL) {\n                exit(0);\n              } else {\n                str = tmp;\n              }\n              edit_print(str, space_size_arg);\n              length = 0;\n            } else {\n              str[length++] = inputch;\n              if (length == size) {\n                char *tmp = realloc(str, sizeof(char) * (size += 20));\n                if (tmp == NULL) {\n                  exit(0);\n                } else {\n                  str = tmp;\n                }\n              }\n            }\n          }\n          free(str);\n          return 0;\n        }\n</code></pre>\n\n<p>EDIT: the error message I original got was the one in the heading of this post. After making the changes suggested by chux, the error is \"realloc(): invalid next size: *hexnumber**\"</p>\n"}, {"tags": ["c", "timer", "embedded", "microcontroller", "microchip"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515537888, "post_id": 48177702, "comment_id": 83335628, "body": "Does code <code>TMR2 = 0;                   &#47;&#47;Clear contents of TMR2 and TMR3</code> clear the contents of TMR2 <i>and</i> TMR3 as commented?"}, {"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515548802, "post_id": 48177702, "comment_id": 83338453, "body": "For 32bit timer, you are disabling, clearing and enabling bits on timer 3 interrupt - I suppose 32 bit timer interrupt would be timer 3 interrupt. But you donot have timer 3 interrupt vector defined?   Use full link <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/61105F.pdf\" rel=\"nofollow noreferrer\">ww1.microchip.com/downloads/en/DeviceDoc/61105F.pdf</a>"}, {"owner": {"reputation": 93, "user_id": 8003647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1df4d65fdd3fc998fcb56a46b35850?s=128&d=identicon&r=PG&f=1", "display_name": "Miao", "link": "https://stackoverflow.com/users/8003647/miao"}, "reply_to_user": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515575464, "post_id": 48177702, "comment_id": 83347260, "body": "@Sudhee Yes you are right, this was the problem, now it&#39;s working. I should use _TIMER_3_VECTOR instead of _TIMER_2_VECTOR"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515585952, "post_id": 48183870, "comment_id": 83353690, "body": "Oh Great!... Thanks!"}], "tags": [], "owner": {"reputation": 93, "user_id": 8003647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1df4d65fdd3fc998fcb56a46b35850?s=128&d=identicon&r=PG&f=1", "display_name": "Miao", "link": "https://stackoverflow.com/users/8003647/miao"}, "is_accepted": false, "score": 1, "last_activity_date": 1515575645, "creation_date": 1515575645, "answer_id": 48183870, "question_id": 48177702, "link": "https://stackoverflow.com/questions/48177702/timer-32-bit-on-pic32-cant-use-interrupts/48183870#48183870", "title": "TIMER 32-bit on pic32 can&#39;t use interrupts", "body": "<p>Like said by @Sudhee for making the code work I should replace only this part:\n_TIMER_2_VECTOR became _TIMER_3_VECTOR</p>\n\n<pre><code>void __ISR(_TIMER_3_VECTOR, ipl1)Timer32Handler(void){\n    LATAINV = 0b101;\n    IFS0bits.T3IF = 0; //Interrupt flag putted at zero\n    IFS0bits.T2IF = 0; //Interrupt flag putted at zero\n\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8003647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1df4d65fdd3fc998fcb56a46b35850?s=128&d=identicon&r=PG&f=1", "display_name": "Miao", "link": "https://stackoverflow.com/users/8003647/miao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515575645, "creation_date": 1515537644, "question_id": 48177702, "link": "https://stackoverflow.com/questions/48177702/timer-32-bit-on-pic32-cant-use-interrupts", "title": "TIMER 32-bit on pic32 can&#39;t use interrupts", "body": "<p>Hi I have a PIC32MX370F512L from microchip.</p>\n\n<p>I want to use TIMER2 and TIMER3 as a 32-bit timer for interrupts.</p>\n\n<p>I CAN use 16-bit Timer interrupt but CAN'T use 32-bit Timer interrupt, I will show you both codes:</p>\n\n<p>16-bit timer:</p>\n\n<pre><code>void init16(){\nT2CONbits.ON = 0;           //Timer disabled\n\nT2CON = 0;      //Stop any 16-bit Timer2 operation\n\nT2CONbits.T32 = 0;          //16 bit mode on, tmr2 \nT2CONbits.TCKPS = 0b100;    //prescaler \nT2CONbits.TCS = 0;          //Select internal peripheral clock\nPR2 = 0x0000FFFF;\n\nTMR2 = 0;                   //Clear contents of TMR2\n\nT2CONbits.ON = 1;           //Timer enable\n\n//====INTERRUPT PART========\nIEC0bits.T2IE   = 0;        //Disable interrupt\nIPC2bits.T2IP = 1; //Priority 1\n//IPC3bits.T3IS = 0; //Sub-priority 3\n\nIFS0bits.T2IF = 0; //Interrupt flag putted at zero\n//IFS0bits.T3IF = 0; //Interrupt flag putted at zero\nIEC0bits.T2IE   = 1;        //Enable interrupt\n}\n</code></pre>\n\n<p>32-bit timer:</p>\n\n<pre><code>void init32(){\n\nT2CONbits.ON = 0;           //Timer disabled\n\nT2CON = 0;      //Stop any 16/32-bit Timer2 operation\nT3CON = 0;      //Stop any 16-bit Timer3 operation\n\nT2CONbits.T32 = 1;          //32 bit mode on, tmr2 + tmr3\nT2CONbits.TCKPS = 0b100;    //Prescaler\nT2CONbits.TCS = 0;          //Select internal peripheral clock\nPR2 = 0x000FFFFF;\n//PR3 = 0;\n\nTMR2 = 0;                   //Clear contents of TMR2 and TMR3\n\nT2CONbits.ON = 1;           //Timer enable\n\n//====INTERRUPT PART========\nIEC0bits.T3IE = 0;        //Disable interrupt\nIPC3bits.T3IP = 1; //Priority 1\n//IPC3bits.T3IS = 0; //Sub-priority 0\n\nIFS0bits.T3IF = 0; //Interrupt flag putted at zero\n//IFS0bits.T3IF = 0; //Interrupt flag putted at zero\nIEC0bits.T3IE = 1;        //Enable interrupt\n}\n</code></pre>\n\n<p>main :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;p32xxxx.h&gt;\n#include &lt;plib.h&gt;\n#include \"timer32Interrupt.h\"\n#include &lt;xc.h&gt;\n\n/* Disable JTAG to use RA0 */\n#pragma config JTAGEN = OFF\n#pragma config FWDTEN = OFF //Watchdog disabled\n\n/* Device Config Bits in DEVCFG1: */\n#pragma config FNOSC = FRCPLL   //Fast RC Osc with PLL\n#pragma config FSOSCEN = OFF    //Secondary Oscillator disabled\n#pragma config POSCMOD = XT     //Primary Oscillator mode: Resonator, crystal or resonator\n#pragma config OSCIOFNC = ON    //CLKO Output Signal Active on the OSCO Pin\n#pragma config FPBDIV = DIV_2   //Peripheral Clock Divisor:  PBCLK is SYSCLK divided by 2\n\n/* Device Config Bits in DEVCFG2: */\n#pragma config FPLLIDIV = DIV_2 //PLL Input Divider\n#pragma config FPLLMUL = MUL_20 //PLL Multiplier\n#pragma config FPLLODIV = DIV_2 //System PLL Output Clock Divider: PLL Divide by 2\n\n\nvoid main(){\n    TRISA = 0;\n    LATA = 0;\n    LATAbits.LATA0 = 1;\n    //LATAbits.LATA0 =~LATAbits.LATA0\n\n    INTEnableSystemMultiVectoredInt();\n    init32();\n    //init16();\n\n    while(1){\n        int i = 0;\n        if(TMR2 &gt;= PR2 - 10 ){\n\n            //LATAbits.LATA0 =~LATAbits.LATA0;\n            //LATAbits.LATA2 =~LATAbits.LATA2;\n            LATAINV = 0b10;\n        }\n\n    }\n\n\n\n}\n\n\nvoid __ISR(_TIMER_2_VECTOR, ipl1)Timer32Handler(void){\n    LATAINV = 0b101;\n    IFS0bits.T3IF = 0; //Interrupt flag putted at zero\n    IFS0bits.T2IF = 0; //Interrupt flag putted at zero\n\n}\n</code></pre>\n\n<p>The 16 bit implementation works and the 32 not, enabling interrupt on TIMER3 and not on TIMER2 is required in the data-sheet, section 14.3.4 of the timers.</p>\n"}, {"tags": ["c", "gtk", "glade"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1515536212, "post_id": 48177396, "comment_id": 83335025, "body": "You&#39;re not planning on trying to display things like message dialogs from within a signal handler, are you?  The <b>only</b> functions that can safely be called from within a signal handler are <a href=\"https://stackoverflow.com/questions/8493095/what-constitutes-asynchronous-safeness\">async-signal-safe functions</a>."}, {"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1515543159, "post_id": 48177396, "comment_id": 83337168, "body": "I&#39;m not <i>trying</i> to do that. It seems as though that is what is happening with the functions defined above. I&#39;m just looking for clarification on how the signal handlers should be constructed given the Glade XML file having predefined the message dialog windows."}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515549849, "post_id": 48178780, "comment_id": 83338647, "body": "Jose, I appreciate the thorough response, however this did not answer the original question. Please see the edit to the original question for clarification. Thanks!"}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515581792, "post_id": 48178780, "comment_id": 83351397, "body": "@LeighK The example can be applied to your goal. The basic step here is to retrieve the auto-instantiated Widgets from the Glade XML definition via GtkBuilder. The GtkBuilder function, get_object, allows you to get the glade widgets by name. So in your callback, you can pass the builder object or the dialog. Later i can try to complement my answer."}, {"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515596385, "post_id": 48178780, "comment_id": 83360424, "body": "Jose, I just ran your example and it seems that you are indeed correct. However, there are some differences. First, I am used to seeing the GtkBuilder being referenced in main. You do not reference it in main, but rather within the &quot;on_button_clicked&quot; signal handler (and then unreference it). I imagine I can reference it both in main and within the signal handler I am interested in writing though?"}, {"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515596391, "post_id": 48178780, "comment_id": 83360432, "body": "The biggest issue is that your &quot;on_button_clicked&quot; signal handler is being fed a pointer to the  GtkButton you created in main. In my case, it needs to be linked to the GtkImageMenuItem &quot;gtk-about.&quot; I am not sure how this would be done. Aside from that caveat, I suspect the signal handler you have written would do the job."}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515596778, "post_id": 48178780, "comment_id": 83360684, "body": "@LeighK the button clicked event, callback, signal handler (name it as you like), has a prototype/signature which is void *user_function (GtkButton *button, gpointer user_data). When you connect a function to handle that event it must follow that convention. button is the widget that triggered the event. user_data is the place for you to pass more arguments, be it simple or more, encapsulated in a structure, object as e.g. Regarding GtkBuilder, the instantiated widgets are destroyed when you destroy them programmatically. If i passed builder, then i could not destroy the dialog but hide it"}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515596947, "post_id": 48178780, "comment_id": 83360787, "body": "@LeighK g_object_unref (builder) its a good rule so that you destroy unnecessary widgets/objects inside builder but there are situations where you keep builder for later use."}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515597231, "post_id": 48178780, "comment_id": 83360993, "body": "@LeighK you must check which signals are emitted by the menu widget and check that prototype but as a rule, the first callback argument its the widget/object that triggered it. Edit: the prototype is similar but as said, the first argument is the menuItem, check the &quot;activate&quot; signal : <a href=\"https://developer.gnome.org/gtk3/stable/GtkMenuItem.html#GtkMenuItem-activate\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/&hellip;</a>"}, {"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 0, "creation_date": 1515604781, "post_id": 48178780, "comment_id": 83366058, "body": "Jose, I appreciate the assistance here but unfortunately I am not making much progress (and this seems like it should be a simple thing to do). The GtkImageMenuItem for &quot;Quit&quot; has an activate signal handler that I named &quot;file_quit_clicked&quot; and all I need that to do is open up the GtkMessageDialog &quot;quit_dialog&quot; that is entirely defined within the Glade file. I got something to work using your outline above but the GtkButtons in the dialog window trigger the &quot;g_return_if_fail&quot; function, and what I have seems way too convoluted for something that should seemingly be simple and straightforward."}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "edited": false, "score": 2, "creation_date": 1515605521, "post_id": 48178780, "comment_id": 83366485, "body": "@LeighK It&#39;s straightforward. You simply must understand the &quot;Gtk&quot; framework. Care to join the Gtk chat so that we can try and aid you, by fully understand the problem and elaborate on the answer. Chat: <a href=\"https://chat.stackoverflow.com/rooms/160557/gtk\">chat.stackoverflow.com/rooms/160557/gtk</a>"}], "tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": false, "score": 4, "last_activity_date": 1515625977, "last_edit_date": 1515625977, "creation_date": 1515545246, "answer_id": 48178780, "question_id": 48177396, "link": "https://stackoverflow.com/questions/48177396/signal-handlers-for-message-dialogs-in-gtk-using-glade-and-c/48178780#48178780", "title": "Signal Handlers for Message Dialogs in GTK+ using Glade (and C)", "body": "<p>If understood correctly, instead of creating the dialogs programmatically, you want to create the dialogs via glade. </p>\n\n<p>By using glade you must use <a href=\"https://developer.gnome.org/gtk3/stable/GtkBuilder.html\" rel=\"nofollow noreferrer\">GtkBuilder</a>.</p>\n\n<p>Let's say you create a simple Yes, No dialog with glade (<strong>yesno_dialog.ui</strong>):</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Generated with glade 3.20.2 --&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"3.20\"/&gt;\n  &lt;object class=\"GtkDialog\" id=\"dialog1\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"modal\"&gt;True&lt;/property&gt;\n    &lt;property name=\"default_width\"&gt;275&lt;/property&gt;\n    &lt;property name=\"default_height\"&gt;130&lt;/property&gt;\n    &lt;property name=\"type_hint\"&gt;dialog&lt;/property&gt;\n    &lt;child internal-child=\"vbox\"&gt;\n      &lt;object class=\"GtkBox\"&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n        &lt;property name=\"spacing\"&gt;2&lt;/property&gt;\n        &lt;child internal-child=\"action_area\"&gt;\n          &lt;object class=\"GtkButtonBox\"&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"hexpand\"&gt;True&lt;/property&gt;\n            &lt;property name=\"layout_style\"&gt;spread&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkButton\" id=\"button1\"&gt;\n                &lt;property name=\"label\"&gt;gtk-yes&lt;/property&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                &lt;property name=\"receives_default\"&gt;True&lt;/property&gt;\n                &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"expand\"&gt;True&lt;/property&gt;\n                &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                &lt;property name=\"position\"&gt;0&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkButton\" id=\"button2\"&gt;\n                &lt;property name=\"label\"&gt;gtk-no&lt;/property&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                &lt;property name=\"receives_default\"&gt;True&lt;/property&gt;\n                &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"expand\"&gt;True&lt;/property&gt;\n                &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                &lt;property name=\"position\"&gt;1&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;True&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;0&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkLabel\"&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"halign\"&gt;center&lt;/property&gt;\n            &lt;property name=\"valign\"&gt;center&lt;/property&gt;\n            &lt;property name=\"hexpand\"&gt;True&lt;/property&gt;\n            &lt;property name=\"vexpand\"&gt;True&lt;/property&gt;\n            &lt;property name=\"label\" translatable=\"yes\"&gt;Are you sure to quit?&lt;/property&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;1&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n    &lt;action-widgets&gt;\n      &lt;action-widget response=\"1\"&gt;button1&lt;/action-widget&gt;\n      &lt;action-widget response=\"2\"&gt;button2&lt;/action-widget&gt;\n    &lt;/action-widgets&gt;\n    &lt;child&gt;\n      &lt;placeholder/&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n\n<p>Which should look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/asjPZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/asjPZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Notice the response_id as 1 for later reference.</p>\n\n<p>Let's test a simple window with a button which will trigger a dialog via its <a href=\"https://developer.gnome.org/gtk3/stable/GtkButton.html#GtkButton-clicked\" rel=\"nofollow noreferrer\">clicked</a> signal handler / callback:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nvoid on_button_clicked (GtkButton *button, gpointer user_data) {\n   int response;\n   GtkWidget  *dialog;\n   GtkBuilder *builder;\n\n   g_return_if_fail (user_data != NULL);\n\n   builder = gtk_builder_new_from_file(\"yesno_dialog.ui\");\n\n   dialog = GTK_WIDGET(gtk_builder_get_object (builder, \"dialog1\"));\n   gtk_window_set_transient_for (GTK_WINDOW(dialog), GTK_WINDOW(user_data));\n\n   gtk_widget_show_all(dialog);\n\n   response = gtk_dialog_run(GTK_DIALOG(dialog));\n\n   gtk_widget_destroy(dialog);\n\n   g_object_unref(G_OBJECT(builder));\n\n   g_print (\"Response is %s\\n\", response == 1 ? \"Yes\" : \"No\");\n}\n\n\nint main(int argc, char *argv[]) {\n   GtkWidget *button;\n   GtkWidget *window;\n\n   gtk_init(&amp;argc,&amp;argv);\n\n   button = gtk_button_new_with_label(\"Press for dialog\");\n   window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n   gtk_container_add(GTK_CONTAINER(window), button);\n\n   g_signal_connect(G_OBJECT(button), \"clicked\", G_CALLBACK(on_button_clicked), window);\n   g_signal_connect(G_OBJECT(window), \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n\n   gtk_widget_show_all(window);\n\n   gtk_main();\n\n   return 0;\n}\n</code></pre>\n\n<p>When you construct a dialog programmatically with standard response ids then you can use the predefined enumerators to check the response. Using glade, even though we've defined Stock buttons, we must define (user-defined) response ids so that the gtk_dialog_run functions understands that the user has chosen a response.</p>\n\n<p>Compiling with:</p>\n\n<pre><code>gcc -o dialog main.c `pkg-config --cflags --libs gtk+-3.0`\n</code></pre>\n\n<p>Should result in something similar to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/odfPg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/odfPg.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "edited": false, "score": 1, "creation_date": 1515668953, "post_id": 48196448, "comment_id": 83392258, "body": "<code>gint result = gtk_dialog_run (GTK_DIALOG (dialog));</code> does not need the <code>GTK_DIALOG()</code> macro as it was defined as a GtkDialog. I&#39;ll edit the answer to reflect that."}, {"owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "reply_to_user": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "edited": false, "score": 2, "creation_date": 1515694459, "post_id": 48196448, "comment_id": 83408404, "body": "Good deal Jose. Many thanks for all of your assistance with working out the solution!"}], "tags": [], "owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1515668982, "last_edit_date": 1515668982, "creation_date": 1515620099, "answer_id": 48196448, "question_id": 48177396, "link": "https://stackoverflow.com/questions/48177396/signal-handlers-for-message-dialogs-in-gtk-using-glade-and-c/48196448#48196448", "title": "Signal Handlers for Message Dialogs in GTK+ using Glade (and C)", "body": "<p>After discussions with @Jose Fonte, the solution to my question is the following:</p>\n\n<pre><code>// Signal Handler for Clicking File -&gt; Quit\nvoid file_quit_clicked (__attribute__((unused)) GtkMenuItem *item, gpointer user_data) \n{\n    GtkBuilder *builder = (GtkBuilder *) user_data;\n\n    GtkDialog *dialog = GTK_DIALOG(gtk_builder_get_object(builder, \"quit_dialog\"));\n\n    gtk_widget_show_all(GTK_WIDGET(dialog));\n\n    // This switch statement and gtk_widget_hide is needed so that the dialog window can be closed \n    // and reopened again without causing errors (i.e. if the user clicks \"no\" when asked \"are you\n    // sure you want to quit.\" Without these, the window errors out the second time opened.\n    gint result = gtk_dialog_run (dialog);\n    switch (result)\n    {\n        case GTK_RESPONSE_ACCEPT:\n           // do_application_specific_something (); - Nothing Required\n           break;\n        default:\n           // do_nothing_since_dialog_was_cancelled (); - Nothing Required\n           break;\n    }\n    gtk_widget_hide(GTK_WIDGET(dialog));\n\n}\n</code></pre>\n\n<p>with the following snippet inserted into the main function:</p>\n\n<pre><code>    // So the \"Are you sure you want to quit?\" Dialog Box is hidden after clicking \"x\"\n    GtkDialog *quit_dialog = GTK_DIALOG(gtk_builder_get_object(builder, \"quit_dialog\"));\n    gtk_widget_hide_on_delete (GTK_WIDGET(quit_dialog));\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 6317692, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08fc3b47488367878c7d9ad65d9a1687?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh K", "link": "https://stackoverflow.com/users/6317692/leigh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1978, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1515668982, "creation_date": 1515535925, "last_edit_date": 1515549763, "question_id": 48177396, "link": "https://stackoverflow.com/questions/48177396/signal-handlers-for-message-dialogs-in-gtk-using-glade-and-c", "title": "Signal Handlers for Message Dialogs in GTK+ using Glade (and C)", "body": "<p>I am having trouble figuring out how to write signal handlers in my C code for the message dialogs that I am creating in GLADE. If I were not using GLADE, the signal handler would include the necessary information to construct the message dialog itself. For example, an \"are you sure you want to quit?\" message dialog would have the form:</p>\n\n<pre><code>void show_question(GtkWidget *widget, gpointer window) {\n\n  GtkWidget *dialog;\n  dialog = gtk_message_dialog_new(GTK_WINDOW(window),\n          GTK_DIALOG_DESTROY_WITH_PARENT,\n          GTK_MESSAGE_QUESTION,\n          GTK_BUTTONS_YES_NO,\n          \"Are you sure to quit?\");\n  gtk_window_set_title(GTK_WINDOW(dialog), \"Question\");\n  gtk_dialog_run(GTK_DIALOG(dialog));\n  gtk_widget_destroy(dialog);\n}\n</code></pre>\n\n<p>Likewise, an \"about window\" would have the form:</p>\n\n<pre><code>void show_about(GtkWidget *widget, gpointer data) {\n\n  GdkPixbuf *pixbuf = gdk_pixbuf_new_from_file(\"battery.png\", NULL);\n\n  GtkWidget *dialog = gtk_about_dialog_new();\n  gtk_about_dialog_set_name(GTK_ABOUT_DIALOG(dialog), \"Battery\");\n  gtk_about_dialog_set_version(GTK_ABOUT_DIALOG(dialog), \"0.9\"); \n  gtk_about_dialog_set_copyright(GTK_ABOUT_DIALOG(dialog), \"(c) Jan Bodnar\");\n  gtk_about_dialog_set_comments(GTK_ABOUT_DIALOG(dialog), \"Battery is a simple tool for battery checking.\");\n  gtk_about_dialog_set_website(GTK_ABOUT_DIALOG(dialog), \"http://www.batteryhq.net\");\n  gtk_about_dialog_set_logo(GTK_ABOUT_DIALOG(dialog), pixbuf);\n  g_object_unref(pixbuf), pixbuf = NULL;\n  gtk_dialog_run(GTK_DIALOG (dialog));\n  gtk_widget_destroy(dialog);\n}\n</code></pre>\n\n<p>Now that I am fully creating these windows within GLADE, I am not sure what form the signal handler should take (in C) in order to connect, say, clicking Help -> About to the about window created in GLADE, or connecting clicking File -> Quit with the \"are you sure you want to quit\" message dialog created in GLADE. I am new to both GTK+ and Glade and I can't seem to find anything that has been of use in resolving this. Any help would be greatly appreciated.</p>\n\n<p>EDIT: Below is an example glade XML file that consists of two top level windows. The first is the main window with a single box containing a menu bar. The second is an about dialog. What I am looking for is help in writing the signal handler that will open the about window after clicking File -> About in the menu bar.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Generated with glade 3.18.3 --&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"3.12\"/&gt;\n  &lt;object class=\"GtkWindow\" id=\"window1\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;child&gt;\n      &lt;object class=\"GtkBox\" id=\"box1\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkMenuBar\" id=\"menubar1\"&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkMenuItem\" id=\"menuitem1\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"label\" translatable=\"yes\"&gt;_File&lt;/property&gt;\n                &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                &lt;child type=\"submenu\"&gt;\n                  &lt;object class=\"GtkMenu\" id=\"menu1\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem1\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-new&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                       &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                     &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem2\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-open&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem3\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-save&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem4\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-save-as&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkSeparatorMenuItem\" id=\"separatormenuitem1\"&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem5\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-quit&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkMenuItem\" id=\"menuitem2\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"label\" translatable=\"yes\"&gt;_Edit&lt;/property&gt;\n                &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                &lt;child type=\"submenu\"&gt;\n                  &lt;object class=\"GtkMenu\" id=\"menu2\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem6\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-cut&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem7\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-copy&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                     &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem8\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-paste&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem9\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-delete&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n           &lt;child&gt;\n              &lt;object class=\"GtkMenuItem\" id=\"menuitem3\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"label\" translatable=\"yes\"&gt;_View&lt;/property&gt;\n                &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkMenuItem\" id=\"menuitem4\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"label\" translatable=\"yes\"&gt;_Help&lt;/property&gt;\n                &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                &lt;child type=\"submenu\"&gt;\n                  &lt;object class=\"GtkMenu\" id=\"menu3\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkImageMenuItem\" id=\"imagemenuitem10\"&gt;\n                        &lt;property name=\"label\"&gt;gtk-about&lt;/property&gt;\n                        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                       &lt;property name=\"use_stock\"&gt;True&lt;/property&gt;\n                      &lt;/object&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;0&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n  &lt;object class=\"GtkAboutDialog\" id=\"window_about\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"type_hint\"&gt;dialog&lt;/property&gt;\n    &lt;property name=\"program_name\"&gt;Glade&lt;/property&gt;\n    &lt;property name=\"logo_icon_name\"&gt;image-missing&lt;/property&gt;\n    &lt;child internal-child=\"vbox\"&gt;\n      &lt;object class=\"GtkBox\" id=\"aboutdialog-vbox1\"&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n        &lt;property name=\"spacing\"&gt;2&lt;/property&gt;\n        &lt;child internal-child=\"action_area\"&gt;\n          &lt;object class=\"GtkButtonBox\" id=\"aboutdialog-action_area1\"&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"layout_style\"&gt;end&lt;/property&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;False&lt;/property&gt;\n            &lt;property name=\"position\"&gt;0&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;placeholder/&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n"}, {"tags": ["c", "arrays", "char", "malloc"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1515534536, "post_id": 48177106, "comment_id": 83334325, "body": "you need <code>calloc</code> if you need zero-init. And if you think it&#39;s zero, why nul-terminating?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515534575, "post_id": 48177106, "comment_id": 83334340, "body": "Should be completely random, but at most 9, because you have not put anything into the memory you allocated, so it&#39;s contents are undetermined."}, {"owner": {"reputation": 838, "user_id": 8083156, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/p3H3n.jpg?s=128&g=1", "display_name": "arst3k", "link": "https://stackoverflow.com/users/8083156/arst3k"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515534863, "post_id": 48177106, "comment_id": 83334466, "body": "@LeeDanielCrocker but why Visual studio behaves in a different why compared to the other compilers?  So should I initialize the memory, add the terminating zero and then use the strlen () function?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515534941, "post_id": 48177106, "comment_id": 83334514, "body": "@arst3k What are you even trying to do here? What is the point to measure an uninitialized string?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515535151, "post_id": 48177106, "comment_id": 83334596, "body": "Contents of memory from malloc() is <i>undefined</i>. There&#39;s no reason to think it should be the same from one compiler to the next, or even one run to the next on the same machine. Malloc just grabs whatever memory is available and assigns it to you. Whatever it might have had in it from previous use is still there. Why would C bother putting anything into it? That&#39;s just a waste of time."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515535227, "post_id": 48177106, "comment_id": 83334627, "body": "@LeeDanielCrocker Well, <code>calloc</code> is doing it."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515535250, "post_id": 48177106, "comment_id": 83334639, "body": "Calloc is <i>defined</i> to do it. That&#39;s its job."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1515535649, "post_id": 48177106, "comment_id": 83334803, "body": "<i>The output of printf() on Visual studio is: <code>9</code></i>  Change from debug to release (or the other way - or any other version of the MSVC run time library that you have available) and see what happens..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515537460, "post_id": 48177106, "comment_id": 83335486, "body": "<code>char *p = malloc((newDim + 1) * sizeof(char));</code> --&gt; <code>char *p = calloc(newDim + 1u, sizeof *p);</code> and let <code>calloc()</code> set all to 0."}], "answers": [{"comments": [{"owner": {"reputation": 838, "user_id": 8083156, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/p3H3n.jpg?s=128&g=1", "display_name": "arst3k", "link": "https://stackoverflow.com/users/8083156/arst3k"}, "edited": false, "score": 0, "creation_date": 1515535817, "post_id": 48177129, "comment_id": 83334875, "body": "I had not thought about it ... thank you!"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 5, "last_activity_date": 1515534421, "creation_date": 1515534421, "answer_id": 48177129, "question_id": 48177106, "link": "https://stackoverflow.com/questions/48177106/diferent-behaviour-in-different-environments-for-uninitialised-malloced-memory/48177129#48177129", "title": "diferent behaviour in different environments for uninitialised malloced memory", "body": "<p><code>malloc</code> is not initializing the memory allocated, so the allocated space might have zeros in arbitrary places giving different string lengths.</p>\n"}], "owner": {"reputation": 838, "user_id": 8083156, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/p3H3n.jpg?s=128&g=1", "display_name": "arst3k", "link": "https://stackoverflow.com/users/8083156/arst3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "closed_date": 1515540818, "accepted_answer_id": 48177129, "answer_count": 1, "score": 2, "last_activity_date": 1533793138, "creation_date": 1515534308, "last_edit_date": 1533793138, "question_id": 48177106, "link": "https://stackoverflow.com/questions/48177106/diferent-behaviour-in-different-environments-for-uninitialised-malloced-memory", "closed_reason": "Duplicate", "title": "diferent behaviour in different environments for uninitialised malloced memory", "body": "<p>I was implementing a program related to the use of dynamic allocation in C.<br>\nTesting the same piece of code on Visual Studio 2017 and on other IDEs (Dev C ++, Codeblocks, etc.) I have different behaviors:</p>\n\n<pre><code>size_t newDim = 9;\nchar *p = malloc((newDim + 1) * sizeof(char));\np[newDim] = '\\0';\nprintf(\"%d\\n\", strlen(p));\n</code></pre>\n\n<p>The output of printf() on Visual studio is: <code>9</code><br>\nother IDEs: <code>3</code> sometimes <code>4</code>.<br>\nBut when I fill the array with dim-1 characters, the same printf() produces a correct output on the other IDEs. I think that the different compilers have a different way of managing the allocated memory, could someone explain the problem in more detail?<br>\nThank you </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515534378, "post_id": 48177104, "comment_id": 83334251, "body": "Which errno code are you getting? There&#39;s a list of possible errors at the end of <code>man recvfrom</code>."}, {"owner": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515534541, "post_id": 48177104, "comment_id": 83334328, "body": "Resource temporarily unavailable"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515534557, "post_id": 48177104, "comment_id": 83334335, "body": "I mean the number, the <code>Exxxx</code> code. That&#39;s the English message and it&#39;s not one of the expected results from calling that function. Is it possibly <code>EAGAIN</code>?"}, {"owner": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515534706, "post_id": 48177104, "comment_id": 83334397, "body": "I get only this: [ERROR] (src/info.c:77: errno: Resource temporarily unavailable) Failed to receive a message."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515688641, "post_id": 48177104, "comment_id": 83405012, "body": "what is the contents of <code>info.h</code>?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515689374, "post_id": 48177104, "comment_id": 83405471, "body": "You may need the &#39;keep alive&#39; option on the socket, set with the <code>setsockopt()</code> function.  It could be the server has not yet responded or the server hung-up,  Suggest using the function: <code>perror()</code> to get the reason the system thinks the function failed.   If the returned status is <code>EAGAIN</code> then loop, calling the <code>recvfrom()</code> function until either an error (other than EAGAIN) or the returned value from the function is 0 (the server hung up) or some actual data is received."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515689517, "post_id": 48177104, "comment_id": 83405576, "body": "the returned value from <code>recvfrom()</code> can be &lt;0, =0, or &gt;0.  From the other uses of the <code>check()</code> function, I suspect it does not do that 3 way checking properly"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515689716, "post_id": 48177104, "comment_id": 83405711, "body": "the posted code is failing to check the results of the calls to <code>malloc()</code>, <code>sendto()</code>,  This means when any of those function calls fails, the code will blissfully continue, even though it should be reporting the error, cleaning up, and calling <code>exit()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "edited": false, "score": 0, "creation_date": 1515535333, "post_id": 48177204, "comment_id": 83334681, "body": "Thank you, but it the function doesn&#39;t work either with an IP address, which is responding when you ping it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "edited": false, "score": 0, "creation_date": 1515535432, "post_id": 48177204, "comment_id": 83334716, "body": "It&#39;s worth adding a <code>select</code> call here for the timeout feature alone, though."}, {"owner": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "edited": false, "score": 0, "creation_date": 1515536035, "post_id": 48177204, "comment_id": 83334957, "body": "You mean, use select to catch a signal, and if it catches the signal, the data can be returned by recvfrom. What is the name of that signal?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "edited": false, "score": 0, "creation_date": 1515536632, "post_id": 48177204, "comment_id": 83335171, "body": "It&#39;s not a signal so much as a &quot;ready to read&quot; indicator. I&#39;ve found <a href=\"http://www.unpbook.com\" rel=\"nofollow noreferrer\">this book</a> to be really helpful, but you might know of another reference that covers this topic. &quot;Signal&quot; in UNIX programming means something like <code>SIGKILL</code> or <code>SIGINT</code>, process-level signals."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1515534879, "creation_date": 1515534879, "answer_id": 48177204, "question_id": 48177104, "link": "https://stackoverflow.com/questions/48177104/error-from-recvfrom/48177204#48177204", "title": "Error from recvfrom", "body": "<p>According to the documentation for <code>recvfrom</code> this is expected if you're using a non-blocking call:</p>\n\n<blockquote>\nIf no messages are available at the socket, the receive call waits for a message to arrive, unless the socket is nonblocking (see <code>fcntl(2)</code>) in which case the value -1 is returned and the external vari-\n     able errno set to <code>EAGAIN</code>.  The receive calls normally return any data available, up to the requested amount, rather than waiting for receipt of the full amount requested; this behavior is affected by the\n     socket-level options <code>SO_RCVLOWAT</code> and <code>SO_RCVTIMEO</code> described in <code>getsockopt(2)</code>.\n</blockquote>\n\n<p>You can look up <code>errno</code> values in <code>/usr/include/sys/errno.h</code> if you're curious as to what values map to what errors.</p>\n\n<p>If you want this function to block you may need to set the <code>MSG_WAITALL</code> flag which \"requests that the operation block until the full request is satisfied\".</p>\n\n<p>Normally in low-level UNIX socket code you'd do a <code>select</code> on that socket to wait for a read signal, then call <code>recvfrom</code> to receive the data if and only if that signal triggered. You can also do a non-blocking receive and on an <code>EAGAIN</code> just wait a short period of time before trying again, though that is less efficient.</p>\n"}], "owner": {"reputation": 25, "user_id": 8814468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ede66bc7723c1520902c090de674bc6?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8814468/john-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 48177204, "answer_count": 1, "score": 0, "last_activity_date": 1515534879, "creation_date": 1515534296, "question_id": 48177104, "link": "https://stackoverflow.com/questions/48177104/error-from-recvfrom", "title": "Error from recvfrom", "body": "<p>I try to make a function that sends a icmp packet to another computer and when the other computer sends something back, the function returns a 1, else a 0. But the recvfrom function returns an error: \"errno: Resource temporarily unavailable\". I work on an Mac OS X, so I don't include headers from the linux kernel. Can anyone help me, cause I'm stuck.  </p>\n\n<pre><code>#include \"info.h\"\n\n\nchar *getip()\n{\n    char buffer[256];\n    struct hostent *h;\n\n    gethostname(buffer, 256);\n    h = gethostbyname(buffer);\n\n    return inet_ntoa(*(struct in_addr *)h-&gt;h_addr);\n\n}\n\n\nint host_alive(char *dst_addr, char *src_addr)\n{\n    struct ip *ippacket;\n    struct ip *ip_reply;\n    struct icmp *icmppacket;\n    struct sockaddr_in connection;\n    struct timeval tv;\n    char *packet;\n    char *buffer;\n    int optval;\n    int addrlen;\n    int size;\n    int sock = 0;\n\n    packet = malloc(sizeof(struct ip) + sizeof(struct icmp));\n    buffer = malloc(sizeof(struct ip) + sizeof(struct icmp));\n\n    check(getuid() == 0, \"Root priviliges are needed. Try: sudo ./bin/main\");\n\n    ippacket = (struct ip *) packet;\n    icmppacket = (struct icmp *) (packet + sizeof(struct ip));\n\n    ippacket-&gt;ip_hl = 5;\n    ippacket-&gt;ip_v = 4;\n    ippacket-&gt;ip_tos = 0;\n    ippacket-&gt;ip_len = sizeof(struct ip) + sizeof(struct icmp);\n    ippacket-&gt;ip_id = htons(random());\n    ippacket-&gt;ip_ttl = 255;\n    ippacket-&gt;ip_p = IPPROTO_ICMP;\n    inet_aton(src_addr, &amp;ippacket-&gt;ip_src);\n    inet_aton(dst_addr, &amp;ippacket-&gt;ip_dst);\n\n    tv.tv_sec = 5;\n    tv.tv_usec = 0;\n\n    check((sock = socket(AF_INET, SOCK_RAW, IPPROTO_ICMP)) != -1,\\\n          \"Failed to create socket\");\n\n    check(setsockopt(sock, IPPROTO_IP, IP_HDRINCL, &amp;optval, sizeof(int)) != -1,\\\n          \"Failed to set the option to the socket.\");\n    check(setsockopt(sock, SOL_SOCKET, SO_RCVTIMEO, (const char *)&amp;tv, sizeof(struct timeval)) != -1,\\\n          \"Failed to set the option to the socket.\");\n\n    icmppacket-&gt;icmp_type = ICMP_ECHO;\n    icmppacket-&gt;icmp_code = 0;\n    icmppacket-&gt;icmp_id = 0;\n    icmppacket-&gt;icmp_seq = 0;\n    icmppacket-&gt;icmp_cksum = in_cksum((unsigned short *)icmppacket, sizeof(struct icmp));\n\n    ippacket-&gt;ip_sum = in_cksum((unsigned short *)ippacket, sizeof(struct ip));\n\n    connection.sin_family = AF_INET;\n    connection.sin_addr.s_addr = inet_addr(dst_addr);\n\n    sendto(sock, packet, ippacket-&gt;ip_len, 0, (struct sockaddr *)&amp;connection,\\\n          sizeof(struct sockaddr));\n\n    addrlen = sizeof(connection);\n    check((size = recvfrom(sock, buffer, sizeof(struct ip) + sizeof(struct icmp), 0,\\\n      (struct sockaddr *)&amp;connection, (socklen_t *)&amp;addrlen)) != -1,\\\n      \"Failed to receive a message.\");\n\n    printf(\"Received %d byte reply from %s:\\n\", size , dst_addr);\n    ip_reply = (struct ip*) buffer;\n    printf(\"ID: %d\\n\", ntohs(ip_reply-&gt;ip_id));\n    printf(\"TTL: %d\\n\", ip_reply-&gt;ip_ttl);\n\n    close(sock);\n\n    free(packet);\n    free(buffer);\n\n    return 1;\n\n  error:\n    if (sock)\n        close(sock);\n    free(packet);\n    free(buffer);\n    return 0;\n}\n\n\nunsigned short in_cksum(unsigned short *addr, int len)\n{\n    int sum = 0;\n    u_short answer = 0;\n    u_short *w = addr;\n    int nleft = len;\n\n    while (nleft &gt; 1) {\n        sum += *w++;\n        nleft -= 2;\n    }\n\n    if (nleft == 1) {\n        *(u_char *) (&amp;answer) = *(u_char *) w;\n        sum += answer;\n    }\n    sum = (sum &gt;&gt; 16) + (sum &amp; 0xffff);\n    sum += (sum &gt;&gt; 16);\n    answer = ~sum;\n    return (answer);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "math", "limits"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515530333, "post_id": 48176305, "comment_id": 83332433, "body": "Define &quot;extremely large&quot;. Do you mean greater than 2^64? If so you can&#39;t do this with a <code>long long</code> and you&#39;ll need some kind of <a href=\"https://gmplib.org\" rel=\"nofollow noreferrer\">bignum library</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1515530351, "post_id": 48176305, "comment_id": 83332443, "body": "The idea of such a challenges is not to use builtin <code>sqrt</code> functions but use your own algorithm."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515530361, "post_id": 48176305, "comment_id": 83332449, "body": "@tadman: 10**400000 is probably higher than that :)"}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515530409, "post_id": 48176305, "comment_id": 83332475, "body": "@tadman in the task it is said input can be as large as 10^400000"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1515530412, "post_id": 48176305, "comment_id": 83332477, "body": "@Jean-Fran&#231;oisFabre I may not be good at math but I think it has a very high probability of being too big for a 64-bit int."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1515530452, "post_id": 48176305, "comment_id": 83332494, "body": "very high like 100% :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1515530457, "post_id": 48176305, "comment_id": 83332497, "body": "You&#39;re going to have to research square root algorithms and implement your own solution if you&#39;re not allowed to use third party libraries. See also <a href=\"https://stackoverflow.com/questions/3581528/how-is-the-square-root-function-implemented\">this approach</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1515530488, "post_id": 48176305, "comment_id": 83332513, "body": "@Jean-Fran&#231;oisFabre I&#39;m going to go with 99.99999999...% just to be on the safe side."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1515530522, "post_id": 48176305, "comment_id": 83332532, "body": "@tadman: better safe than sorry. That said, <code>sqrt(10**400000) = 10**200000</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1515530597, "post_id": 48176305, "comment_id": 83332561, "body": "10 ** 400000 is approximately <code>542101086242752217003726400434970855712890625000[...399930 zeroes redacted...]000</code> times larger than the maximum value that would fit <code>uint64_t</code>."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 2, "creation_date": 1515530635, "post_id": 48176305, "comment_id": 83332579, "body": "As large as <i>10^400000</i>?!  Are you sure you don&#39;t mean <code>10^40</code>?  Values that large <i>cannot</i> be represented in native types, not even <code>long double</code>.  You&#39;re going to have to use a third-party bignum library, or learn how to implement one of your own."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 45308, "user_id": 3483203, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/592wq.png?s=128&g=1", "display_name": "user3483203", "link": "https://stackoverflow.com/users/3483203/user3483203"}, "edited": false, "score": 0, "creation_date": 1515530662, "post_id": 48176305, "comment_id": 83332591, "body": "@chrisz no, 10^400000 is just restriction, input can be any number between 1 to 10^400000"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1515530679, "post_id": 48176305, "comment_id": 83332603, "body": "@JohnBode I would even ask how one can have it as an input.."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1515530762, "post_id": 48176305, "comment_id": 83332648, "body": "@EugeneSh. 400k digits? That easily fits in a string."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515530767, "post_id": 48176305, "comment_id": 83332654, "body": "@EugeneSh.: Don&#39;t we all have a couple of hours to type in up to 400000 digits?"}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1515530781, "post_id": 48176305, "comment_id": 83332659, "body": "@JohnBode Unfortunately, it is 10^400000."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1515530895, "post_id": 48176305, "comment_id": 83332704, "body": "@arkang: Yee ha.  You&#39;re going to want to look at <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1515530896, "post_id": 48176305, "comment_id": 83332705, "body": "Is the number being expressed in 10^n notation? If so this could be pretty easy."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1515530960, "post_id": 48176305, "comment_id": 83332739, "body": "@tadman no, if it was 10^n that indeed would be easy"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515531033, "post_id": 48176305, "comment_id": 83332765, "body": "Even if you have to roll your own, I&#39;d be absolutely sure to check against a reference implementation like GMP."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515531081, "post_id": 48176305, "comment_id": 83332785, "body": "@tadman i&#39;ll definetely check"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1515531088, "post_id": 48176305, "comment_id": 83332788, "body": "@tadman How long do you think such a calculation will take with GMP (just curious, never worked with it)? Anyway, I am pretty sure that the OP have misunderstood the assignment."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1515531160, "post_id": 48176305, "comment_id": 83332826, "body": "@EugeneSh. My guess would be instant. I don&#39;t see what&#39;s so outlandish about the assignment."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1515531494, "post_id": 48176305, "comment_id": 83332982, "body": "@melpomene It depends on the algorithm used and the efficiency of the bignum representation. There&#39;s a binary search approach that shouldn&#39;t be too punishing."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1515531579, "post_id": 48176305, "comment_id": 83333025, "body": "@tadman Eh? It&#39;s just <code>mpz_sqrt(result, input);</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515531662, "post_id": 48176305, "comment_id": 83333068, "body": "&quot;but then it gives wrong answers.&quot;  --&gt; Post the number inputted, result and expected result."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515531852, "post_id": 48176305, "comment_id": 83333146, "body": "@chux the problem is that inputs are unknown"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515531910, "post_id": 48176305, "comment_id": 83333165, "body": "Post samples from the  &quot;My code works fine for first 12 inputs, &quot;, especially ones that give &quot;wrong answers.&quot;."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515532078, "post_id": 48176305, "comment_id": 83333235, "body": "@chux the user can see the results for the inputs (correct, time limit error or incorrect answer) and time consumed to execute, but not the input or answer itself"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515532111, "post_id": 48176305, "comment_id": 83333250, "body": "Why does code use <code>abs(int)</code> instead of the correct <code>llabs(long long int j)</code> -  Is that the problem?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515532179, "post_id": 48176305, "comment_id": 83333286, "body": "@arkang You coding goals <i>must</i> have some description as to the syntax, range of inputs and expected outputs."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "edited": false, "score": 0, "creation_date": 1515532255, "post_id": 48176305, "comment_id": 83333319, "body": "oh, I forgot to fix it here, because I copied from notepad, but when I sent the answer I used llabs, so it is not the problem"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515532473, "post_id": 48176305, "comment_id": 83333415, "body": "@arkang  Any other fictional code? - Post your true code.  suggest cut and paste."}, {"owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515532486, "post_id": 48176305, "comment_id": 83333422, "body": "@chux Do you think it will help? Because the aim of the question is not to get solution to the task I am doing, but just to get some ideas on how to deal with these crazy numbers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515532594, "post_id": 48176305, "comment_id": 83333476, "body": "@arkang Yes it will help.  The trouble is that you have only <i>described</i> the crazy numbers and have not posted their results nor expected output.  Posting true sample inputs, output and expected output is a great assist.  Lacking that, the post lacks useful information."}], "answers": [{"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 0, "last_activity_date": 1515532514, "last_edit_date": 1515532514, "creation_date": 1515532194, "answer_id": 48176680, "question_id": 48176305, "link": "https://stackoverflow.com/questions/48176305/calculating-square-root-for-extremely-large-numbers-in-c/48176680#48176680", "title": "Calculating square root for extremely large numbers in C", "body": "<p>In a nutshell, you can roll a long square root algorithm by the dichotomic method as follows:</p>\n\n<ul>\n<li><p>choose a long number representation (array of unsigned ints);</p></li>\n<li><p>implement long addition and subtraction (pretty trivial, except for carries);</p></li>\n<li><p>implement halving (also requires some care for carries);</p></li>\n<li><p>implement long comparison (similar to subtraction).</p></li>\n</ul>\n\n<p>[Note that addition allows you to implement doubling and quadrupling, and halving also yields division by four.]</p>\n\n<p>Then set <code>d= 1</code> and repeatedly double <code>d</code> until <code>d\u00b2 &gt; N</code>. (Every time you double <code>d</code>, you quadruple <code>d\u00b2</code>.)</p>\n\n<p>Next, set <code>a= 0</code> so that the invariant</p>\n\n<pre><code>a\u00b2 \u2264 N &lt; (a + d)\u00b2\n</code></pre>\n\n<p>is established, and repeatedly halve <code>d</code> while keeping the invariant. This is achieved by</p>\n\n<p><code>d= d/2;</code> if <code>N &lt; (a + d)\u00b2</code>, set <code>a= a + d</code>; else keep <code>a</code> unchanged. </p>\n\n<p>In the end, you will narrow down to</p>\n\n<pre><code>a\u00b2 \u2264 N &lt; (a + 1)\u00b2\n</code></pre>\n\n<p>so that <code>a</code> is the integer square root.</p>\n\n<p>To evaluate the condition </p>\n\n<pre><code>N &lt; (a + d)\u00b2 = a\u00b2 + 2ad + d\u00b2,\n</code></pre>\n\n<p>or</p>\n\n<pre><code>N - a\u00b2 &lt; 2ad + d\u00b2,\n</code></pre>\n\n<p>it suffices to keep a trace of the terms <code>N - a\u00b2</code>, <code>2ad</code> and <code>d\u00b2</code> and update them as you modify <code>d</code> or <code>a</code>. This only takes the aforemetioned primitive operations.</p>\n"}], "owner": {"reputation": 95, "user_id": 7769056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874a291ad53af1f25a585f0289396f7?s=128&d=identicon&r=PG&f=1", "display_name": "ar kang", "link": "https://stackoverflow.com/users/7769056/ar-kang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2022, "favorite_count": 0, "closed_date": 1515534283, "answer_count": 1, "score": -1, "last_activity_date": 1515532519, "creation_date": 1515530258, "last_edit_date": 1515532519, "question_id": 48176305, "link": "https://stackoverflow.com/questions/48176305/calculating-square-root-for-extremely-large-numbers-in-c", "closed_reason": "Duplicate", "title": "Calculating square root for extremely large numbers in C", "body": "<p>I am solving some tasks from school olimpiads, and I got stuck on one question. I found the solution for the task, but my solution requires square rooting. My code works fine for first 12 inputs, but then it gives wrong answers. I guess that it is due to extremely large inputs, which can be as large as 10^400000. So I would like to know if there are ways to calculate whole number parts of square roots of these extremely large inputs in C. Here is the code:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(){\n    long long n;\n    scanf(\"%lld\", &amp;n);\n    long long ans;\n    ans = sqrtl(n-1);\n    long long result;\n    result = ans+1-llabs(n-ans*ans-(ans+1));\n    printf(\"%lld\\n\", result);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["javascript", "c", "arrays", "pointers", "emscripten"], "answers": [{"tags": [], "owner": {"reputation": 1813, "user_id": 1514010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BLtSx.png?s=128&g=1", "display_name": "zakki", "link": "https://stackoverflow.com/users/1514010/zakki"}, "is_accepted": false, "score": 0, "last_activity_date": 1515665145, "creation_date": 1515665145, "answer_id": 48204371, "question_id": 48176068, "link": "https://stackoverflow.com/questions/48176068/emscripten-oob-exception-within-c-from-javascript/48204371#48204371", "title": "Emscripten OOB Exception within C from Javascript", "body": "<p><code>i2wasm()</code> returns <code>char*</code>, so <code>dataPtr</code> is <code>char**</code>.</p>\n\n<p>And <code>_printIntMatrix(pointerHeap, nbData)</code> means <code>_printIntMatrix(pointerHeap | 0, nbData)</code>, eventually it is <code>_printIntMatrix(NULL, nbData)</code>.</p>\n\n<p>So if <code>printIntMatrix</code> doesn't need <code>char ***mat</code>, <code>_printIntMatrix(dataPtr, nbData);</code> would work.</p>\n"}], "owner": {"reputation": 444, "user_id": 1202623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cbae78493ed2188bfb70b0c078ceb2c3?s=128&d=identicon&r=PG", "display_name": "Nikkolasg", "link": "https://stackoverflow.com/users/1202623/nikkolasg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515665145, "creation_date": 1515529113, "question_id": 48176068, "link": "https://stackoverflow.com/questions/48176068/emscripten-oob-exception-within-c-from-javascript", "title": "Emscripten OOB Exception within C from Javascript", "body": "<p>I'm trying to pass an array of strings from JS to C using Emscripten. I pass my array to C but when I try to deference, it does not work, it raises \"index out of bounds\". I've tried many different things so I'll post the minimal amount of code that can reproduce the issue (at least on my machine!). I'm sure I missed something...</p>\n\n<p>Basically trying to put a string into an array (of strings) and give that to C for printing (I'm doing other stuff of course). Feel free to change the \"gmp_<em>\" or \"mpz_</em>\" to your (that's not the problem).</p>\n\n<p>Javascript: </p>\n\n<pre><code>    var nbData = 1;\n    var nbColPerData = 1;\n    var data = new Uint32Array(nbColPerData);\n    data[0] = this.i2wasm(this.mod);\n\n    var nBytes = data.length * data.BYTES_PER_ELEMENT;\n    var dataPtr = Module._malloc(nBytes);\n    var dataHeap = new Uint8Array(Module.HEAP8.buffer,dataPtr,nBytes);\n    dataHeap.set(new Uint8Array(data.buffer));\n\n    // create array of pointers\n    var pointers = new Uint32Array(nbData);\n    for (var i =0; i &lt; pointers.length; i++) {\n        pointers[i] = dataPtr + i * data.BYTES_PER_ELEMENT;\n        console.log(\"pointers[\"+i+\"] = \" + pointers[i].toString(16));\n    }\n\n    // create pointer array on the heap\n    var nPointerBytes= pointers.length * pointers.BYTES_PER_ELEMENT;\n    var pointerPtr = Module._malloc(nPointerBytes);\n    var pointerHeap = new Uint8Array(Module.HEAP8.buffer, pointerPtr,nPointerBytes);\n    pointerHeap.set( new Uint8Array(pointers.buffer));\n\n    printIntMatrix(pointerHeap,nbData)\n\n    Module._free(pointerHeap.byteOffset);\n    Module._free(dataHeap.byteOffset);\n</code></pre>\n\n<p>i2wasm (hexadecimal string to int array for wasm, works properly):</p>\n\n<pre><code>    return allocate(intArrayFromString(integer),'i8',ALLOC_NORMAL);\n</code></pre>\n\n<p>C code:</p>\n\n<pre><code>void EMSCRIPTEN_KEEPALIVE printInt(char *hex) {\n    mpz_t n;\n    mpz_init(n);\n    printf(\"printing INT at %p\\n\",hex);\n    /////////////////////////////////////\n    // HERE IT PANICS !\n    /////////////////////////////////////\n    printf(\"printing INT value: %c\\n\",*hex);\n    if (mpz_set_str(n,hex,16) != 0) {\n        printf(\"hexadecimal invalid\");\n        return;\n    }\n\n    gmp_printf(\"printInt: %Zd\\n\",n);\n    mpz_clear(n);\n}\n\nvoid EMSCRIPTEN_KEEPALIVE printIntMatrix(char **mat, int n) {\n    printf(\"printIntMatrix !!\\n\");\n    for(int i = 0; i &lt; n; i++) {\n        printf(\"matrix[%d] =&gt; \\n\",i);\n        printf(\"matrix[%d] =&gt; %p\\n\",i,mat[i]);\n        printInt(mat[i]);\n        printf(\"matrix[%d] =&gt; %p DONE\\n\",i,mat[i]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 61, "user_id": 4786733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvcO6.jpg?s=128&g=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/4786733/anton"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1515530697, "post_id": 48176038, "comment_id": 83332614, "body": "@HighPerformanceMark I updated it to use a parallel for, but it basically does the same as before, since the marked section gets executed in parallel"}, {"owner": {"reputation": 61, "user_id": 4786733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvcO6.jpg?s=128&g=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/4786733/anton"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1515531230, "post_id": 48176038, "comment_id": 83332855, "body": "@HighPerformanceMark I can see the system using 4 threads to the full extent, what do they do then?"}, {"owner": {"reputation": 61, "user_id": 4786733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvcO6.jpg?s=128&g=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/4786733/anton"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1515531540, "post_id": 48176038, "comment_id": 83333006, "body": "@HighPerformanceMark furthermore I aim to parallelise the partitioning here, most of the questions on SO focus on parallising the sorting of the sub arrays"}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1515531574, "post_id": 48176038, "comment_id": 83333022, "body": "Good luck with that, you&#39;re way beyond my capabilities to help further."}], "owner": {"reputation": 61, "user_id": 4786733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvcO6.jpg?s=128&g=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/4786733/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515667367, "creation_date": 1515528998, "last_edit_date": 1515667367, "question_id": 48176038, "link": "https://stackoverflow.com/questions/48176038/pragma-omp-parallel-overhead", "title": "Pragma omp parallel overhead", "body": "<p>I have a problem with a <code>#pragma omp parallel</code> section in my code.\nI hava program which should sort a given array of integers with quicksort using multiple threads. For this in every step every thread gets assigned a portion of the array, partitions it and returns how many elements are smaller than a given global pivot. The code executes without errors, but the more threads I tell omp to use, the slower it executes. I added logging for the execution times and it seems like a huge part of the program is spent on overhead for OpenMP. The overhead seems to be consistent, so the speed difference is proportional to the size of the array to sort.</p>\n\n<p>Here is the code which is executed in parallel:</p>\n\n<pre><code>void create_count_elems_lower(int lower, int upper, int global_pivot_position, int *block_sizes, int *data,\n                              int *count_elems_lower) {\n    assert(lower &gt;= 0);\n    times_function_called++;\n    int pivot = data[global_pivot_position];\n    double start = omp_get_wtime();\n    double wait_start = 0;\n    double wait_time = 0;\n    #pragma omp parallel for\n    for (int i = 0; i &lt; omp_get_max_threads(); ++i) {\n        double start_thread = omp_get_wtime();\n        int lower_p = lower;\n        lower_p += i == 0 ? 0 : block_sizes[i - 1] * i;\n        count_elems_lower[i] = partition_fixed_pivot(lower_p, lower_p + block_sizes[i], pivot, data) -\n                               lower_p; // - lower_p since it needs to be relative\n        assert(count_elems_lower[i] &gt;= 0);\n        double end_thread = omp_get_wtime();\n        double time_spent = end_thread - start_thread;\n        time_spent_per_thread_sum += time_spent;\n        if (max_time_spent_per_thread[i] &lt; time_spent) {\n            max_time_spent_per_thread[i] = time_spent;\n        }\n        if (wait_start == 0) {\n            wait_start = end_thread;\n        } else {\n            double time_waiting = end_thread - wait_start;\n            if (time_waiting &gt; wait_time) {\n                wait_time = time_waiting;\n            }\n        }\n    }\n    double end = omp_get_wtime();\n    time_spent_in_function += end - start;\n    time_spent_idling += wait_time;\n}\n</code></pre>\n\n<p>And here the testing function:</p>\n\n<pre><code>printf(\"Num threads: %d\\n\", num_threads);\ndouble start = omp_get_wtime();\ntest_sort_big();\ndouble end = omp_get_wtime();\nprintf(\"total: %f\\n\", end - start);\nprintf(\"times function called: %f\\n\", times_function_called);\nprintf(\"time spent in create_count_elems_lower: %f\\n\", time_spent_in_function);\nprintf(\"time spent per thread approx: %f\\n\", time_spent_per_thread_sum / num_threads);\nprintf(\"time spent idling: %f\\n\", time_spent_idling);\nfor (int i = 0; i &lt; num_threads; ++i) {\n    printf(\"max time spent by thread %d: %f \\t\", i, max_time_spent_per_thread[i]);\n}\n</code></pre>\n\n<p>The program gets compiled and linked with:</p>\n\n<pre><code>gcc      -fopenmp  -O3  -c -o tests/tests.o tests/tests.c\ngcc      -fopenmp  -o build_test tests/tests.o array_utils.o datagenerator.o quicksort.o\n</code></pre>\n\n<p>And the results are:</p>\n\n<pre><code>Num threads: 1\nTesting sorting of 10000000 Elements\ntotal: 9.204632\ntimes function called: 10000000.000000\ntime spent in create_count_elems_lower: 5.914602\ntime spent per thread approx: 1.610363\ntime spent idling: 0.000000\nmax time spent by thread 0: 0.041889 \n\n\nNum threads: 4\nTesting sorting of 10000000 Elements\ntotal: 16.955334\ntimes function called: 10000000.000000\ntime spent in create_count_elems_lower: 12.598185\ntime spent per thread approx: 0.874607\ntime spent idling: 2.130419\nmax time spent by thread 0: 0.016055    max time spent by thread 1: 0.013543    max time spent by thread 2: 0.013532    max time spent by thread 3: 0.018599 \n</code></pre>\n\n<p>I run Fedora 27 64 bit with an Intel\u00ae Core\u2122 i7-2760QM CPU @ 2.40GHz \u00d7 8 </p>\n\n<p><strong>Edit:</strong>\nAs it turned out the overhead was the problem, since the method gets called a lot of times with only one thread, changing the algorithm to a simple sort when only one thread is available improved the runtime a lot.</p>\n"}, {"tags": ["c", "fwrite", "stdio"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1515527152, "post_id": 48175611, "comment_id": 83330898, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1515527355, "post_id": 48175611, "comment_id": 83330996, "body": "128 &quot;as a&quot; signed 8-bit byte <i>is</i> -1.. a matter of perspective?"}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515527365, "post_id": 48175611, "comment_id": 83331001, "body": "It&#39;s pretty clear. I want the numbers to be stored correctly. The problem is they&#39;re being stored with 1&#39;s peculiarly in significant bits. I can ask the same question again with different words if you like."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1515527427, "post_id": 48175611, "comment_id": 83331022, "body": "You know the difference between <code>int</code>s and <code>unsigned int</code>s, right? No? Look it up."}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515527479, "post_id": 48175611, "comment_id": 83331045, "body": "You&#39;re right, I don&#39;t know why it&#39;s -128."}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515527499, "post_id": 48175611, "comment_id": 83331056, "body": "Yes I know the difference."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515527508, "post_id": 48175611, "comment_id": 83331059, "body": "@TraceMyers, you have described the nature of the misbehavior fairly clearly, but you have <i>not</i> adequately described the code and data that produce the error.  Follow Stargateur&#39;s link for more information if you are unfamiliar with the concept of an MCVE."}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515527607, "post_id": 48175611, "comment_id": 83331100, "body": "There is nothing that happens between storing the int in the struct and writing it that would change the information above."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1515527615, "post_id": 48175611, "comment_id": 83331106, "body": "@TraceMyers: You haven&#39;t shown where you&#39;re assigning the values to the struct; you need to provide enough code for someone to reproduce your problem (and no more), to make an adequate <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Odds are, you&#39;re assigning to <code>num</code> from a type like <code>char</code> that happens to be signed under your particular compiler and build settings; when the (signed) <code>char</code> is expanded to a (signed) <code>int</code>, sign extension occurs, and you see this result. People commonly assume <code>char</code> has a particular default signedness, or don&#39;t understand how sign extension works, and have problems like this."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1515527803, "post_id": 48175611, "comment_id": 83331193, "body": "@TraceMyers Right now, we just have to take your word for it that <code>num</code> is 199. But the output you show us tells us that <code>num</code> is not 199. You have posted conflicting statements. Noone that reads your question can resolve this conflict with the current information. If you want someone to try to fix your problem, the fastest way you get an answer if you post a complete piece of runnable code that re-produces the error you are seeing on your machine, or that you debug your code using a debugger and verify all your assumptions (such that you really are sure that num is 199)"}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515527848, "post_id": 48175611, "comment_id": 83331206, "body": "Maybe those are the odds, and I suppose I shouldn&#39;t assume I have the trust of anybody to not do something that silly. I edited to show that it&#39;s not so."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 1, "creation_date": 1515527957, "post_id": 48175611, "comment_id": 83331255, "body": "Please reduce your original program to the smallest complete program that demonstrates the error. Your sample code is too big (it has a lot of irrelevant detail) and too small (it is not a complete program.)  Good MCVEs generate good answers. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1515527960, "post_id": 48175611, "comment_id": 83331257, "body": "@nos the point of asking the question was to see if I was somehow using fwrite incorrectly. I guess my question has been answered.  I edited the question. beside creating a file, the above code should work."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1515528265, "post_id": 48175611, "comment_id": 83331404, "body": "@TraceMyers: I don&#39;t see anything obviously wrong off-hand; if you want to check if the data is correct when you reach <code>fwrite</code>, you might try inserting a <code>printf(&quot;%d %d \\&quot;%s\\&quot;\\n&quot;, p-&gt;num, p-&gt;qoh, p-&gt;name);</code> before the <code>fwrite</code> calls, so you can check that the values are what you expect in the first place."}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1515529108, "post_id": 48175611, "comment_id": 83331800, "body": "@ShadowRanger I have done that. That&#39;s mainly why I&#39;m confused."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1515530901, "post_id": 48175611, "comment_id": 83332708, "body": "The problem is <b>in the code that you didn&#39;t show</b>: the code that <b>prints the bytes incorrectly</b> (please read about signedness of <code>char</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515529287, "post_id": 48175989, "comment_id": 83331898, "body": "Thanks for the help. I&#39;m fairly new.  Strangely, I see this when i run yours:  ff ff ff c7  3  0  0  0 46 6f...  And if I load it in, I get -57."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515529587, "post_id": 48175989, "comment_id": 83332053, "body": "@TraceMyers What do you mean &quot;I load it&quot; ? you never give code that load your file. How do you look the bytes of your files ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515529794, "post_id": 48175989, "comment_id": 83332157, "body": "@TraceMyers, If my program produces that output for you then something is pretty wrong.  Either your C implementation is non-conforming, or your output is being mangled after the fact, or whatever mechanism you are using to examine the (binary) output is misleading you.  I find it particularly suspicious that the output you present appears to be inconsistent with respect to the endianness of <code>int</code>, though I suppose you might have transcribed it incorrectly."}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515529934, "post_id": 48175989, "comment_id": 83332242, "body": "I must be reading it wrong both in the dump and in the main program."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515530076, "post_id": 48175989, "comment_id": 83332301, "body": "Well, @TraceMyers, that is part of why we ask for an MCVE.  By the way, what big-endian platform are you testing this on?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515530398, "post_id": 48175989, "comment_id": 83332468, "body": "I can confirm that the output file contains <code>c7 00 00 00 03 00 00 00  46 6f 6f 00</code>.  @TraceMyers which compiler are you using? Have you another compiler and have you tried the other one?"}, {"owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "edited": false, "score": 0, "creation_date": 1515531217, "post_id": 48175989, "comment_id": 83332850, "body": "It&#39;s little endian. The bad hex dump was on me.  The problem was I was storing the read bytes in a signed char buffer.  I&#39;ll chalk that up to 99% of stackoverflow problems being simple things the person neglects to mention. Kind of embarassing. I&#39;ll get better at asking questions. Thanks for the help."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1515528754, "creation_date": 1515528754, "answer_id": 48175989, "question_id": 48175611, "link": "https://stackoverflow.com/questions/48175611/fwrite-writing-all-1s-to-more-significant-bits-if-sign-bit-of-any-single-byte/48175989#48175989", "title": "fwrite() writing all 1&#39;s to more significant bits if sign bit of any single byte is 1 (writing int)", "body": "<blockquote>\n  <p>Am I using fwrite wrong?</p>\n</blockquote>\n\n<p>No, you are using it correctly.  Ergo, the problem with the result has to do either with the data you are writing or the stream you are writing it to.</p>\n\n<p>Consider this complete program, adapted from your original code sample:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct part{\n    int num;\n    int qoh;\n    char *name;\n    struct part *next;\n};\n\nint main(void) {\n    struct part sp = { 199, 3, \"Foo\" };\n    FILE *fp = fopen(\"out\", \"wb\");\n\n    for (struct part *p = &amp;sp; p != NULL; p = p-&gt;next) {\n        fwrite(&amp;(p-&gt;num), sizeof(int), 1, fp);\n        fwrite(&amp;(p-&gt;qoh), sizeof(int), 1, fp);\n        fwrite(p-&gt;name, sizeof(char), strlen(p-&gt;name) + 1, fp);\n    }\n\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p><em>This</em> would be a reasonable MCVE, except for the fact that it does not in fact reproduce the error for me.  Here's a hex dump of the resulting output:</p>\n\n<pre><code>c7 00 00 00 03 00 00 00 46 6f 6f 00\n</code></pre>\n\n<p>From this you can see that my machine uses little-endian representation for its <code>int</code>s, but also that it does not produce mangled integers such as you describe.</p>\n\n<p>Having answered your basic question, I'm not inclined to sort through your relatively substantial code to figure out where and how the problem arises.  I still recommend the exercise of reducing that to an MCVE, however, as that has a decent chance of helping you discover the nature of the problem for yourself, or at least the key statements involved in it.</p>\n"}], "owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "closed_date": 1515531154, "accepted_answer_id": 48175989, "answer_count": 1, "score": -1, "last_activity_date": 1515528754, "creation_date": 1515527062, "last_edit_date": 1515528426, "question_id": 48175611, "link": "https://stackoverflow.com/questions/48175611/fwrite-writing-all-1s-to-more-significant-bits-if-sign-bit-of-any-single-byte", "closed_reason": "Not suitable for this site", "title": "fwrite() writing all 1&#39;s to more significant bits if sign bit of any single byte is 1 (writing int)", "body": "<pre><code>for (struct part *p = first; p != NULL; p = p-&gt;next;) {\n    fwrite(&amp;(p-&gt;num), sizeof(int), 1, inventory);\n    fwrite(&amp;(p-&gt;qoh), sizeof(int), 1, inventory);\n    fwrite(p-&gt;name, sizeof(char), strlen(p-&gt;name) + 1, inventory);\n}\n</code></pre>\n\n<p>p is a pointer to a struct instance that looks like this:</p>\n\n<pre><code>struct part{\n    int num;\n    int qoh;\n    char *name;\n    struct part *next;\n};\n</code></pre>\n\n<p>If i store the number 8, 104, 3176, etc. in num, things are fine. However, if I store 128, 32768, or any number that uses the most significant bit of a byte (any number with a byte 1XXX-XXX), fwrite writes all 1's into all of the more significant bytes in the file, turning 128 to -128, 199 to -57, etc.</p>\n\n<p>This changing of the bytes doesn't happen during program execution - only on saving to file. Looking at num = 199 and qoh = 3, after written to file, the bytes are as such:</p>\n\n<pre><code>ff ff ff c7 00 00 00 03\n</code></pre>\n\n<p>which should be</p>\n\n<pre><code>00 00 00 c7 00 00 00 03\n</code></pre>\n\n<p>I load the file into the inventory program and it loads as expected looking at the bytes. num = -57, not 199.</p>\n\n<p>Am I using fwrite wrong?</p>\n\n<p>Here's the storing part, as requested.</p>\n\n<pre><code>void part_new(void) {\n    struct part *new;\n    int num, qoh;\n    char *name;\n\n    printf(\"\\nEnter a part number: \");\n    scanf(\"%d\", &amp;num);\n    while(getchar() != '\\n');\n\n    for (struct part *p = first; p != NULL; p = p-&gt;next) {\n        if (p-&gt;num == num) {\n            printf(\"Duplicate part number, name: %s. Canceling action.\\n\", p-&gt;name);\n            return;\n        }\n    }\n    printf(\"Enter a name: \");\n    if ((name = input(PART_NAME_MAX_CHARS)) == NULL) {\n        printf(\"Bad input.\\n\");\n        return;\n    }\n    printf(\"Enter a QOH: \");\n    scanf(\"%d\", &amp;qoh);\n    while(getchar() != '\\n');\n\n    new = malloc(sizeof(struct part));\n    new-&gt;num = num;\n    new-&gt;qoh = qoh;\n    new-&gt;name = malloc(strlen(name) + 1);\n    strncpy(new-&gt;name, name, strlen(name) + 1);\n    free(name);\n    part_into_list(new);\n\n    return;\n}\n</code></pre>\n\n<p>and the save function:</p>\n\n<pre><code>    bool save_file(char *fname) {\n    FILE *inventory;\n    struct part *del;\n\n    if ((inventory = fopen(fname, \"wb\")) == NULL) {\n        printf(\"\\nCould not save %s.\\n\", fname);\n        return false;\n    }\n\n    fseek(inventory, 0 , SEEK_SET);\n    for (struct part *p = first; p != NULL; p = p-&gt;next) {\n        fwrite(&amp;(p-&gt;num), sizeof(int), 1, inventory);\n        fwrite(&amp;(p-&gt;qoh), sizeof(int), 1, inventory);\n        fwrite(p-&gt;name, sizeof(char), strlen(p-&gt;name) + 1, inventory);\n    }\n\n    printf(\"%s saved.\\n\", fname);\n    fclose(inventory);\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 5, "creation_date": 1515526242, "post_id": 48175319, "comment_id": 83330464, "body": "<code>maxPlace</code> isn&#39;t assigned unless you ever enter the conditional <code>if (array[i] &gt; max)</code>, though it is used unconditionally in the line <code>array[maxPlace] = temp</code>. Try setting maxPlace to 0 on declaration and see if that helps."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1515526548, "post_id": 48175319, "comment_id": 83330599, "body": "A segmentation fault means that you can <i>either</i> run in a debugger, and it will show you precisely where the fault occurs, and the value of every variable and memory location at that point, <i>or</i> run it with a reasonable (non-zero) core size limit, and load the resulting core file in your debugger for roughly the same result. Do one of those, and if you can&#39;t see the problem, come back with the stack trace, line, values etc."}, {"owner": {"reputation": 21, "user_id": 9194970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a039942fb2d79895a1d92476f5ffcf49?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Ouf", "link": "https://stackoverflow.com/users/9194970/ahmed-ouf"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1515526618, "post_id": 48175319, "comment_id": 83330641, "body": "@GovindParmar This indeed appeared to be the problem. Initialized to 0 and it worked. Thank you."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1515527068, "post_id": 48175319, "comment_id": 83330850, "body": "@AhmedOuf In fact this declaration         int max = array[0]; is redundant, It is enough to declare int maxPlace = 0;"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1515531409, "post_id": 48175319, "comment_id": 83332941, "body": "I like this question because it has only one glaring bug, and because it caused this awesome answer to happen."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1515535662, "post_id": 48175319, "comment_id": 83334811, "body": "In the future try running your program inside <code>gdb</code> and when the segfault happens run <code>bt</code> and it will tell you the exact line it crashed on"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 4, "last_activity_date": 1515528394, "last_edit_date": 1515528394, "creation_date": 1515527861, "answer_id": 48175780, "question_id": 48175319, "link": "https://stackoverflow.com/questions/48175319/recursion-segmentation-fault-core-dumped/48175780#48175780", "title": "Recursion - Segmentation fault (core dumped)", "body": "<p>Because <code>maxPlace</code> might be uninitialized. And because you're reading input incorrectly such that you'll always get <code>N</code> elements even if the user only put in 1.</p>\n\n<hr>\n\n<p>It's illustrative to show how I tracked this down. Normally I'd track down a segfault using <a href=\"http://www.valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> which would tell me the offending line, but that's currently broken on OS X. So here's the old fashioned way with prints and deduction.</p>\n\n<p>First, the <code>-fsanitize=address</code> compiler flag will cause a runtime failure if you walk off the end of allocated memory, such as using an uninitialized variable. This can usually catch memory errors as soon as they happen rather than far down the road. It will also tell you what function it happened in.</p>\n\n<pre><code>$ make\ncc -fsanitize=address -Wall -Wshadow -Wwrite-strings -Wextra -Wconversion -std=c99 -pedantic -g `pkg-config --cflags glib-2.0`   -c -o test.o test.c\ncc `pkg-config --libs glib-2.0` -lssl -lcrypto -fsanitize=address  test.o   -o test\n\n$ ./test\nEnter a series of integrs: 5\nASAN:DEADLYSIGNAL\n=================================================================\n==80879==ERROR: AddressSanitizer: SEGV on unknown address 0x7ffee6679358 (pc 0x0001095a7cac bp 0x7ffee6659330 sp 0x7ffee66592b0 T0)\n    #0 0x1095a7cab in selection_sort (/Users/schwern/tmp/./test+0x100001cab)\n    #1 0x1095a78db in main (/Users/schwern/tmp/./test+0x1000018db)\n    #2 0x7fff73819114 in start (/usr/lib/system/libdyld.dylib+0x1114)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (/Users/schwern/tmp/./test+0x100001cab) in selection_sort\n==80879==ABORTING\nAbort trap: 6\n</code></pre>\n\n<p>Now I know it's in <code>selection_sort()</code>. I can start adding debugging print statements to narrow it down. That <code>for</code> loop is suspect, maybe you're walking off the array, so I started with that. I'll also want to know if you recurse, so I've put a print on that.</p>\n\n<pre><code>puts(\"Entering loop\");\nfor (i = 1; i &lt; length; i ++)\n{\n    printf(\"i: %d\\n\", i);\n    if (array[i] &gt; max)\n    {\n        max = array[i];\n        maxPlace = i;\n    }\n    puts(\"Loop next\");\n}\nputs(\"Leaving loop\");\n\ntemp = array[length - 1];\narray[length - 1] = max;\narray[maxPlace] = temp;\n\nputs(\"Recursing\");\nselection_sort(array, length - 1);\n</code></pre>\n\n<p>And try that...</p>\n\n<pre><code>$ ./test\nEnter a series of integrs: 5\nEntering loop\ni: 1\nLoop next\ni: 2\nLoop next\ni: 3\nLoop next\ni: 4\nLoop next\ni: 5\nLoop next\ni: 6\nLoop next\ni: 7\nLoop next\ni: 8\nLoop next\ni: 9\nLoop next\nLeaving loop\nASAN:DEADLYSIGNAL\n</code></pre>\n\n<p>Nope, you're not walking off the array. But you're also not recursing. So it has to be in just the few lines of code after the loop. Ok, mark those up. Nothing fancy, numbers are fine when the scope is this small.</p>\n\n<pre><code>puts(\"1\");\ntemp = array[length - 1];\nputs(\"2\");\narray[length - 1] = max;\nputs(\"3\");\narray[maxPlace] = temp;\n</code></pre>\n\n<p>Run that...</p>\n\n<pre><code>$ ./test\nEnter a series of integrs: 5\nEntering loop\ni: 1\nLoop next\ni: 2\nLoop next\ni: 3\nLoop next\ni: 4\nLoop next\ni: 5\nLoop next\ni: 6\nLoop next\ni: 7\nLoop next\ni: 8\nLoop next\ni: 9\nLoop next\nLeaving loop\n1\n2\n3\nASAN:DEADLYSIGNAL\n</code></pre>\n\n<p>Now I know it's after <code>3</code> and before <code>recursing</code>. That means it's <code>array[maxPlace] = temp;</code>. Ok, what's in <code>maxPlace</code>?</p>\n\n<pre><code>puts(\"1\");\ntemp = array[length - 1];\nputs(\"2\");\narray[length - 1] = max;\nprintf(\"maxPlace: %d\\n\", maxPlace);\narray[maxPlace] = temp;\n</code></pre>\n\n<p>Run that...</p>\n\n<pre><code>$ ./test\nEnter a series of integrs: 5\nEntering loop\ni: 1\nLoop next\ni: 2\nLoop next\ni: 3\nLoop next\ni: 4\nLoop next\ni: 5\nLoop next\ni: 6\nLoop next\ni: 7\nLoop next\ni: 8\nLoop next\ni: 9\nLoop next\nLeaving loop\n1\n2\nmaxPlace: 32766\nASAN:DEADLYSIGNAL\n</code></pre>\n\n<p><code>maxPlace</code> being 32766 means it probably contains garbage. Now that I know what variable is the problem I can look at how it's declared, initialized, and set to discover there's a case where it will never be initialized: if the list is sorted in descending order.</p>\n\n<hr>\n\n<p>But I only put in one number, 5! Shouldn't <code>if (length &lt; 2)</code> have caught that? No, because you're always iterating over <code>N</code> elements no matter how much input you read.</p>\n\n<pre><code>printf(\"Enter a series of integrs: \");\nfor(i = 0; i &lt; N; i ++)\n{\n    scanf(\"%d\", &amp;array[i]);\n}\n</code></pre>\n\n<p>If I put in <code>5</code> and then hit <code>ctrl-d</code> to end input, <code>scanf</code> will only set <code>array[0] = 5</code>. But the loop will continue running for 1 to 9. <code>scanf</code> will fail because <code>stdin</code> is closed. The rest of the array will be uninitialized.</p>\n\n<p>And you're sorting <code>N</code> elements, not the number read. So you'll always sort 10 elements whether they're initialized or not.</p>\n\n<p>You're getting lucky that they happen to be 0.</p>\n\n<pre><code>$ ./test\nEnter a series of integrs: 5\nIn sorted order: 0 0 0 0 0 0 0 0 0 5 \n</code></pre>\n\n<p>Instead, you should be reading until <code>N</code> or until <code>scanf</code> fails, whichever comes first. This will also protect you from garbage input. And also only sort and print up to the number of integers read, not the maximum capacity of the array.</p>\n\n<pre><code>int main (void)\n{\n    int array[N];\n    int num_ints;\n\n    printf(\"Enter a series of integrs: \");\n    for(num_ints = 0; num_ints &lt; N; num_ints++)\n    {\n        if( scanf(\"%d\", &amp;array[num_ints]) &lt; 1 ) {\n            break;\n        }\n    }\n\n    selection_sort(array, num_ints);\n\n    printf(\"In sorted order: \");\n    for(int i = 0; i &lt; num_ints; i ++)\n    {\n        printf(\"%d \", array[i]);\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9194970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a039942fb2d79895a1d92476f5ffcf49?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Ouf", "link": "https://stackoverflow.com/users/9194970/ahmed-ouf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 48175780, "answer_count": 1, "score": 1, "last_activity_date": 1515531425, "creation_date": 1515525883, "last_edit_date": 1515531425, "question_id": 48175319, "link": "https://stackoverflow.com/questions/48175319/recursion-segmentation-fault-core-dumped", "title": "Recursion - Segmentation fault (core dumped)", "body": "<p>So I'm writing a code as an exercise for recursion. Its purpose is to sort an array of integers in an ascending order by recursively replacing the last element of the array with the largest one. I keep getting segmentation fault error and can't find out where the problem is. Here is the code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define N 10\n\nvoid selection_sort(int array[], int length);\n\nint main (void)\n{\n    int array[N];\n    int i;\n\n    printf(\"Enter a series of integrs: \");\n    for(i = 0; i &lt; N; i ++)\n    {\n        scanf(\"%d\", &amp;array[i]);\n    }\n\n    selection_sort(array, N);\n\n    printf(\"In sorted order: \");\n    for(i = 0; i &lt; N; i ++)\n    {\n        printf(\"%d \", array[i]);\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n\nvoid selection_sort(int array[], int length)\n{\n    int max = array[0];\n    int temp;\n    int i;\n    int maxPlace;\n\n    if (length &lt; 2)\n    {\n        return;\n    }\n\n    for (i = 1; i &lt; length; i ++)\n    {\n        if (array[i] &gt; max)\n        {\n            max = array[i];\n            maxPlace = i;\n        }\n    }\n    temp = array[length - 1];\n    array[length - 1] = max;\n    array[maxPlace] = temp;\n\n    selection_sort(array, length - 1);\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "dynamic", "malloc"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1515524171, "post_id": 48174924, "comment_id": 83329546, "body": "You should not cast <code>malloc</code> - it is bad practice"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1515524263, "post_id": 48174924, "comment_id": 83329588, "body": "Why are you using a variable with the same name inside a loop that is using the same name"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1515524518, "post_id": 48174924, "comment_id": 83329689, "body": "<code>matrice = malloc (nrows * sizeof *matrice)</code> (that&#39;s <code>sizeof (int*)</code>). Then it&#39;s <code>matrice[r] = malloc (ncols * sizeof *matrice[r]);</code> (that&#39;s <code>sizeof (int)</code>). Note: you must validate each allocation succeeds, e.g. <code>if (!matrice[r]) { &#47;* handle error *&#47; }</code>"}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 1, "creation_date": 1515524927, "post_id": 48174924, "comment_id": 83329858, "body": "You are on the right track and finding root cause and solving the following is part of learning, understanding, and using dynamic memory allocation: &quot;when I compile the program everything is ok, but if I run it the terminal tells me Segmentation fault (core dumped) and exits&quot;."}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1515525535, "post_id": 48174924, "comment_id": 83330148, "body": "You also need to have a clear understanding and mental picture of how your two dimensional matrix lays out in the memory,  In your case, your two dim matrix consists of a block a memory containing an array of pointers, one pointer for one column. The number of such pointers is same as number of rows (and thus first malloc should be for the size=number of rows times size of (int *), This is the first thing you need to fix in your code as already pointed by @David C Rankin"}, {"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 0, "creation_date": 1515540373, "post_id": 48174924, "comment_id": 83336419, "body": "If you are not limited to C89, using variable length arrays would make your example a lot cleaner"}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515525442, "post_id": 48175079, "comment_id": 83330101, "body": "what&#39;s the point in doing <code>arr = NULL</code>? in the <code>free2D</code> function?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1515525641, "post_id": 48175079, "comment_id": 83330205, "body": "Freeing alone does not set the variable to <code>NULL</code>, and It helps when using dynamic memory, in say an array of struct in large projects, where topology includes several places that may, or may not, need to use the struct array, to test its current condition for <code>NULL</code>, i.e. whether it has already be allocated, or needs to be.  If NULL, allocate, else do not."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515525739, "post_id": 48175079, "comment_id": 83330245, "body": "but in this case, it&#39;s only setting the local variable <code>arr</code> to <code>NULL</code> at the end of the function, it has no meaning for the caller of <code>free2D</code>. If it were something like <code>*arr = NULL</code> (I know it doesn&#39;t fit to the signature) I could understand."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515525931, "post_id": 48175079, "comment_id": 83330330, "body": "@Pablo I consider it good practice for the reasons ryyker stated. For a program this short there&#39;s really no point in <code>free</code>ing either since the OS will reclaim the memory when the process exits."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1515525982, "post_id": 48175079, "comment_id": 83330349, "body": "Yes, in the way the example code illustrates you are correct.  Normally though, I would create a typedef struct object with global scope, then from that <code>typedef</code>, create a pointer with <code>extern</code> scope so it is visible in multiple modules."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1515526571, "post_id": 48175079, "comment_id": 83330612, "body": "@ryyker I get the point, when there the pointers are part of something larger. I was only talking about the last line. It doesn&#39;t harm and it isn&#39;t wrong either."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1515526191, "last_edit_date": 1515526191, "creation_date": 1515524826, "answer_id": 48175079, "question_id": 48174924, "link": "https://stackoverflow.com/questions/48174924/create-dynamic-matrix-with-c/48175079#48175079", "title": "create dynamic matrix with C", "body": "<p>The exact issue in your post has been answered in the comments (and now in the accepted answer), but one other suggestion would be to consolidate the allocation of the <em>2D</em> matrix into a function, such as:</p>\n\n<pre><code>int ** Create2D(int c, int r)\n{   \n    int **arr;\n    int    y;\n\n    arr   = calloc(c, sizeof(int *));\n    for(y=0;y&lt;c;y++)\n    {\n        arr[y] = calloc(r, sizeof(int));    \n    }\n    return arr;\n}\n</code></pre>\n\n<p>This would require some architectural changes to the loops in your code (which, by the way are part of your problem), and simplify things overall.</p>\n\n<p>After using the array this code produces, as always it should be freed.  This can be done in similar fashion by creating a single function to do it:</p>\n\n<pre><code>void free2D(ssize_t **arr, ssize_t c)\n{\n    int i;\n    if(!arr) return;\n    for(i=0;i&lt;c;i++)\n    {\n        free(arr[i]);\n        arr[i] = NULL;\n    }\n    free(arr);\n    arr = NULL;\n}\n</code></pre>\n\n<p>Usage, for example would be similar to:</p>\n\n<pre><code>... \nint ** twoDArray = Create2D(colonne, righe);\nif(twoDArray)\n{ \n   // use array \n   //...\n   free2D(twoDArray, colonne);\n}\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1515525653, "post_id": 48175110, "comment_id": 83330213, "body": "When dynamically allocating memory to <code>righe</code> x <code>colonne</code> 2D array, do you think this is correct -&gt; <code>matrice = (int **) malloc(righe * colonne * sizeof(int *));</code>?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515525723, "post_id": 48175110, "comment_id": 83330238, "body": "<code>malloc(righe * colonne * sizeof(int *));</code> is going to give you a dimension more <code>int*</code>s than you want. OP needs to pick either <code>righe</code> or <code>colonne</code> and <code>malloc</code> that many <code>int*</code>s, iterate over it and <code>malloc</code> the other number of <code>int</code>s for each iteration. Also, casting the result of <code>malloc</code> in <code>c</code> is <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">frowned upon</a>"}, {"owner": {"reputation": 366, "user_id": 8366717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yY4lP.png?s=128&g=1", "display_name": "Jango", "link": "https://stackoverflow.com/users/8366717/jango"}, "edited": false, "score": 0, "creation_date": 1515525997, "post_id": 48175110, "comment_id": 83330358, "body": "You are right, guys! Since there is one allocation per row, the initial allocation should be based only on the number of rows. I fixed it in the answer."}], "tags": [], "owner": {"reputation": 366, "user_id": 8366717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yY4lP.png?s=128&g=1", "display_name": "Jango", "link": "https://stackoverflow.com/users/8366717/jango"}, "is_accepted": false, "score": 1, "last_activity_date": 1515525943, "last_edit_date": 1515525943, "creation_date": 1515524983, "answer_id": 48175110, "question_id": 48174924, "link": "https://stackoverflow.com/questions/48174924/create-dynamic-matrix-with-c/48175110#48175110", "title": "create dynamic matrix with C", "body": "<p>You missed a \"*\" and nested wrong the two last loops. I believe this is what you want:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int **matrice;\n    int righe, colonne;\n    int r, c;\n\n    printf(\"Quante RIGHE deve avere la matrice? \");\n    scanf(\"%d\", &amp;righe);\n\n    printf(\"Quante COLONNE deve avere la matrice? \");\n    scanf(\"%d\", &amp;colonne);\n\n    matrice = (int **) malloc(righe * sizeof(int *)); //&lt;&lt;&lt; here\n\n    for(r=0; r&lt;righe; r++)\n    {\n        matrice[r] = (int *) malloc(colonne * sizeof(int));\n\n        for(c = 0; c &lt; colonne; ++c) //&lt;&lt;&lt; here\n        {\n            printf(\"Elemento[%d][%d]: \", r, c);\n            scanf(\"%d\", &amp;matrice[r][c]);\n        }\n    }\n\n    for(r = 0; r &lt; righe; ++r) //&lt;&lt;&lt; here\n        for(c = 0; c &lt; colonne; ++c)\n            printf (\"%d\\n\", matrice[r][c]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 71, "user_id": 1274150, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c79253b9728e2ccf7a0623ca3528d530?s=128&d=identicon&r=PG", "display_name": "Pankaspe", "link": "https://stackoverflow.com/users/1274150/pankaspe"}, "edited": false, "score": 0, "creation_date": 1515525393, "post_id": 48175180, "comment_id": 83330073, "body": "Sure, glad to help!"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 5, "last_activity_date": 1515525246, "creation_date": 1515525246, "answer_id": 48175180, "question_id": 48174924, "link": "https://stackoverflow.com/questions/48174924/create-dynamic-matrix-with-c/48175180#48175180", "title": "create dynamic matrix with C", "body": "<p>You have a number of steps out of order, and your ordering of you for loops to fill your <code>matrice</code> is incorrect. You also lack validation for all input and all allocation. To correct the problems you can do something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    int **matrice;\n    int righe, colonne;\n    int r, c;\n\n    printf(\"Quante RIGHE deve avere la matrice? \");\n    if (scanf(\"%d\", &amp;righe) != 1) {\n        fprintf (stderr, \"error: invalid input - righe.\\n\");\n        return 1;\n    }\n\n    printf(\"Quante COLONNE deve avere la matrice? \");\n    if (scanf(\"%d\", &amp;colonne) != 1) {\n        fprintf (stderr, \"error: invalid input - colonne.\\n\");\n        return 1;\n    }\n\n    matrice = malloc (righe * sizeof *matrice);\n    if (!matrice) {\n        perror (\"matrice\");\n        return 1;\n    }\n\n    for (r = 0; r &lt; righe; r++){\n        matrice[r] = malloc (colonne * sizeof *matrice[r]);\n        if (!matrice[r]) {\n            perror (\"matrice[r]\");\n            return 1;\n        }\n\n        for (c = 0; c &lt; colonne; c++){\n            printf (\"Elemento[%d][%d]: \",r, c);\n            if (scanf (\"%d\", &amp;matrice[r][c]) != 1) {\n                fprintf (stderr, \"error: matrice[r][c].\\n\");\n                return 1;\n            }\n        }\n    }\n\n    // print out\n    for (r = 0; r &lt; righe; r++){\n        for (c = 0; c &lt; colonne; c++)\n            printf (\" %3d\", matrice[r][c]);\n        putchar ('\\n');\n        free (matrice[r]);\n    }\n    free (matrice);\n}\n</code></pre>\n\n<p><strong>note</strong> don't forget to <code>free</code> the memory you allocate.</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/arrmatrice\nQuante RIGHE deve avere la matrice? 3\nQuante COLONNE deve avere la matrice? 3\nElemento[0][0]: 1\nElemento[0][1]: 2\nElemento[0][2]: 3\nElemento[1][0]: 4\nElemento[1][1]: 5\nElemento[1][2]: 6\nElemento[2][0]: 7\nElemento[2][1]: 8\nElemento[2][2]: 9\n   1   2   3\n   4   5   6\n   7   8   9\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515527621, "post_id": 48175192, "comment_id": 83331108, "body": "@yano ups, you&#39;re right. I fixed my answer. Thanks for pointing that out."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1515527579, "last_edit_date": 1515527579, "creation_date": 1515525296, "answer_id": 48175192, "question_id": 48174924, "link": "https://stackoverflow.com/questions/48174924/create-dynamic-matrix-with-c/48175192#48175192", "title": "create dynamic matrix with C", "body": "<p>The <code>malloc</code> calls are the problem, you are allocating the wrong number of\nbytes.</p>\n\n<p>The matrix is created by having a pointer to an array that holds pointers to\narrays of <code>int</code>.</p>\n\n<pre><code>int **matrix = calloc(rows, sizeof(*matrix));\nif(matrix == NULL)\n    // handle the error\n</code></pre>\n\n<p>Now you have to initialize the columns:</p>\n\n<pre><code>for(int i = 0; i &lt; rows; ++i)\n    matrix[i] = calloc(cols, sizeof *matrix[i]);\n    if(matrix[i] == NULL)\n        // handle the error\n</code></pre>\n\n<p>Now you can access every cell by <code>matrix[i][j]</code>.</p>\n\n<p>Freeing the matrix is also easy:</p>\n\n<pre><code>for(int i = 0; i &lt; rows; ++i)\n    free(matrix[i]);\nfree(matrix);\n</code></pre>\n\n<p>Note that I used <code>calloc</code> instead of <code>malloc</code>. The difference (other than\nusing 2 parameters instead of one) is that <code>calloc</code> sets the allocated memory\nto 0. This is a huge help when you are doing error handling and want to free\nthe memory. <code>free(NULL)</code> is not forbidden.</p>\n\n<p>It's a good practice to create dedicated functions like <code>create_matrix</code> and\n<code>free_matrix</code>. There having everything set to 0 is really handy.</p>\n\n<p>Last thing: I recommend not using <code>sizeof(&lt;data type&gt;)</code> when calling <code>malloc</code>\nand <code>calloc</code>. It's easy to miss the correct type, miss a <code>*</code> or make mistakes\nin general. <code>sizeof *var</code> however returns <strong>always</strong> the correct number of\nbytes.</p>\n"}], "owner": {"reputation": 71, "user_id": 1274150, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c79253b9728e2ccf7a0623ca3528d530?s=128&d=identicon&r=PG", "display_name": "Pankaspe", "link": "https://stackoverflow.com/users/1274150/pankaspe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 48175180, "answer_count": 4, "score": 0, "last_activity_date": 1515527579, "creation_date": 1515524067, "question_id": 48174924, "link": "https://stackoverflow.com/questions/48174924/create-dynamic-matrix-with-c", "title": "create dynamic matrix with C", "body": "<p>I try to understand the malloc and dynamic allocation with c, but when I compile the program everything is ok, but if I run it the terminal tells me <strong>Segmentation fault (core dumped)</strong> and exits</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    int **matrice;\n    int righe, colonne;\n    int r, c;\n\n    printf(\"Quante RIGHE deve avere la matrice? \");\n    scanf(\"%d\", &amp;righe);\n\n    printf(\"Quante COLONNE deve avere la matrice? \");\n    scanf(\"%d\", &amp;colonne);\n\n    matrice = (int**) malloc(righe*colonne*sizeof(int));\n\n    for(r=0; r&lt;righe; r++){\n        matrice[r] = (int*) malloc(colonne*sizeof(int));\n\n        for(r=0; r&lt;righe; r++){\n            for(c=0; c&lt;colonne; c++){\n                printf(\"Elemento[%d][%d]: \",r, c);\n                scanf(\"%d\", &amp;matrice[r][c]);\n            }\n\n            // print out\n            for(r=0; r&lt;righe; r++){\n                for(c=0; c&lt;colonne; c++){\n                    printf (\"%d\\n\", matrice[r][c]);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1515523887, "post_id": 48174795, "comment_id": 83329371, "body": "You may find the <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">documentation for <code>scanf</code></a>, and particularly the section of format specifiers and how they work, to be helpful. I suspect you need a <code>[set]</code> configuration, but you will ultimately confirm that."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1515524338, "post_id": 48174795, "comment_id": 83329619, "body": "This kind of parsing job is better done with <code>fgets</code> (or <code>getline</code>, if available) and <code>strtok</code> (or <code>strsep</code>, if available).  <code>scanf</code> is almost always more trouble than it&#39;s worth, even ignoring  how<code>%s</code> is every bit as dangerous as <code>gets</code> and numeric overflow provokes undefined behavior."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515528788, "post_id": 48174795, "comment_id": 83331661, "body": "&quot;I still don&#39;t understand why &quot;%s|%s&quot; gives ... Number:01234|MY_NAME, Name:\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u256001234|MY_NAME&quot;.  Is &quot;Number:01234|MY_NAME&quot; confusing?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515530101, "post_id": 48174795, "comment_id": 83332310, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 0, "last_activity_date": 1515530226, "creation_date": 1515530226, "answer_id": 48176295, "question_id": 48174795, "link": "https://stackoverflow.com/questions/48174795/is-01234my-name-ss/48176295#48176295", "title": "Is &quot;01234|MY_NAME&quot; = &quot;%s|%s&quot;?", "body": "<p>The <code>%s</code> directive tells <code>fscanf</code> to skip over any initial whitespace and read 1 or more non-whitespace characters into the argument <code>char *</code>.</p>\n\n<p><code>01234|MY_NAME</code> is all non-spacey, so it ends up being placed in <code>str1</code> by the first <code>%s</code>.</p>\n\n<p>Then the <code>|</code> in the format string tells <code>fscanf</code> to read a literal <code>|</code> character. This fails because there is no input left. At this point <code>fscanf</code> gives up and returns <code>1</code> to indicate that it successfully filled one of the variables.</p>\n\n<p>However, your program ignores the return value from <code>fscanf</code>, so it doesn't realize what happened. It blindly outputs <code>str1</code> (containing <code>01234|MY_NAME</code>) and <code>str2</code> (which is uninitialized and prints garbage until it happens to find a <code>'\\0'</code> in memory).</p>\n"}], "owner": {"reputation": 11, "user_id": 9194610, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hYb5UPm2eHs/AAAAAAAAAAI/AAAAAAAACF4/Vohaaw7BQHQ/photo.jpg?sz=128", "display_name": "Tr&#237; Tr\u1ea7n Minh", "link": "https://stackoverflow.com/users/9194610/tr%c3%ad-tr%e1%ba%a7n-minh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "closed_date": 1515531542, "answer_count": 1, "score": -2, "last_activity_date": 1533844074, "creation_date": 1515523603, "last_edit_date": 1533844074, "question_id": 48174795, "link": "https://stackoverflow.com/questions/48174795/is-01234my-name-ss", "closed_reason": "Duplicate", "title": "Is &quot;01234|MY_NAME&quot; = &quot;%s|%s&quot;?", "body": "<p>I'm having trouble understanding the result of this:</p>\n\n<pre><code>    fscanf(FILE,\"%s|%s\", str1, str2);\n    printf(\"Number:%s, Name:%s\", str1, str2);\n</code></pre>\n\n<p>Content of FILE: </p>\n\n<pre><code> 01234|MY_NAME\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code> Number:01234, Name:My_NAME\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> Number:01234|MY_NAME, Name:\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u256001234|MY_NAME\n</code></pre>\n\n<p>Can someone explain why it gives that output?  </p>\n\n<p>P/s: I've solved it with this code:</p>\n\n<pre><code>    fscanf(FILE,\"%[^|]|%[^|]\", str1, str2);\n    printf(\"Number:%s, Name:%s\", str1, str2);\n</code></pre>\n\n<p>But I still don't understand why \"%s|%s\" gives the previous output.</p>\n"}, {"tags": ["c", "fonts", "bitmap"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515523789, "post_id": 48174743, "comment_id": 83329316, "body": "Too easy, sorry... The warning is correct. <code>put_char(&quot;c&quot;, ...</code> \u2013 you feed it a <i>string address</i> and not a single character code <code>&#39;c&#39;</code>. So you get the bitmap of some high number, out of range for your character definitions."}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515523979, "post_id": 48174743, "comment_id": 83329425, "body": "The prototype of the set_pixel function is the following: <code>set_pixel(int x, int y, uint32_t rgb)</code>"}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515524079, "post_id": 48174743, "comment_id": 83329489, "body": "Changing &quot;c&quot; with &#39;c&#39; as you suggest have no effect, the &quot;ghost mark&quot; disappears, but the output stays black."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515524166, "post_id": 48174743, "comment_id": 83329542, "body": "Well there you go. Are you sure you can &quot;add&quot; <code>r | g | b</code> from plain colors as you did? Or did you remember to shift them into the right positions beforehand? If not, maybe your pixels are too dark. In case of doubt, hardcode full white in your function."}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515524288, "post_id": 48174743, "comment_id": 83329597, "body": "Calling the <code>set_pixel</code> separately function with exactly the same colors in the same position outputs the intended color (grey) without problems, but I will try the bright white in a moment"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515524426, "post_id": 48174743, "comment_id": 83329648, "body": "Mmmm... I see you defined the characters rotated clockwise. I don&#39;t think the putpixel order is a problem after all."}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515524647, "post_id": 48174743, "comment_id": 83329741, "body": "This code is part of a little project I have in github, despite the project needs compilation and an emulator (is a little operative system), maybe is useful to see the code in more context, if you find it useful, here is the code: <a href=\"https://github.com/TheStr3ak5/CKA\" rel=\"nofollow noreferrer\">github.com/TheStr3ak5/CKA</a> , the involved files are <a href=\"https://github.com/TheStr3ak5/CKA/blob/master/kernel/arch/x86_64-uefi/tty.c\" rel=\"nofollow noreferrer\">github.com/TheStr3ak5/CKA/blob/master/kernel/arch/x86_64-uef&zwnj;&#8203;i/&hellip;</a> <a href=\"https://github.com/TheStr3ak5/CKA/blob/master/kernel/arch/x86_64-uefi/font.h\" rel=\"nofollow noreferrer\">github.com/TheStr3ak5/CKA/blob/master/kernel/arch/x86_64-uef&zwnj;&#8203;i/&hellip;</a> <a href=\"https://github.com/TheStr3ak5/CKA/blob/master/kernel/includes/tty.h\" rel=\"nofollow noreferrer\">github.com/TheStr3ak5/CKA/blob/master/kernel/includes/tty.h</a> uefi directory, if not, just ignore this message."}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515533305, "post_id": 48174743, "comment_id": 83333794, "body": "Indeed, changing output color to 255/255/255 in rgb code (white) had no effect, the output still without showing"}], "owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1533847790, "creation_date": 1515523403, "last_edit_date": 1533847790, "question_id": 48174743, "link": "https://stackoverflow.com/questions/48174743/problems-printing-a-bitmap-font", "title": "Problems printing a bitmap font", "body": "<p>Lately I'm trying to print a bitmap font in C, using only a set_pixel function (that only sets the color of a pixel in a determinate coordinate of the screen).<br>\nThe problem is that when I try my code, this code does not work at all. \nI will write the code down, do you know why this is failing?<br>\nThe only reason I could find is a warning that my compiler (clang) reports:  </p>\n\n<pre><code>x86_64-uefi/tty.c:67:11: warning: incompatible pointer to integer conversion passing 'char [2]' to parameter of type 'char' [-Wint-conversion]\n        put_char(\"c\", 1, 1, r | g | b);\n</code></pre>\n\n<p>That I don't know how to fix.</p>\n\n<p>Files involved:<br>\n 1: tty.c (The one that prints)</p>\n\n<pre><code>#include \"font.h\"\n#include \"tty.h\"\nKABI void put_char(char c, uint8_t x, uint8_t y, uint32_t rgb) \n{\n    uint8_t i,j;\n\n    // Convert the character to an index\n    c = c &amp; 0x7F;\n    if (c &lt; ' ') {\n        c = 0;\n    } else {\n        c -= ' ';\n    }\n\n    // 'font' is a multidimensional array of [96][char_width]\n    // which is really just a 1D array of size 96*char_width.\n    const uint8_t* chr = font[c*CHAR_WIDTH];\n\n    // Draw pixels\n    for (j=0; j&lt;CHAR_WIDTH; j++) {\n        for (i=0; i&lt;CHAR_HEIGHT; i++) {\n            if (chr[j] &amp; (1&lt;&lt;i)) {\n                set_pixel(x+j, y+i, rgb);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>2: tty.h (the header of tty.c)  </p>\n\n<pre><code>#pragma once\n\n// Types (uint8_t, etc.)\n#include \"typedefs.h\"\n\n// tty_init: Cleans the screen and setup all.\nKABI void tty_init(void);\n\nKABI void put_char(char c, uint8_t x, uint8_t y, uint32_t rgb);\n</code></pre>\n\n<p>3: font.h (I made it a little bit shorter)</p>\n\n<pre><code>// Our types (uint8_t, etc.)\n#include \"typedefs.h\"\n#define CHAR_WIDTH 6\n#define CHAR_HEIGHT 8\nconst unsigned char font[96][6] = {\n    {0x00,0x00,0x00,0x00,0x00,0x00}, //  \n    {0x2e,0x00,0x00,0x00,0x00,0x00}, // !\n    {0x03,0x00,0x03,0x00,0x00,0x00}, // \"\n    {0x0a,0x1f,0x0a,0x1f,0x0a,0x00}, // #\n    {0x2e,0x2a,0x6b,0x2a,0x3a,0x00}, // $\n    {0x0e,0x2a,0x1e,0x08,0x3c,0x2a}, // %\n    {0x3e,0x2a,0x2a,0x22,0x38,0x08}, // &amp;\n    {0x03,0x00,0x00,0x00,0x00,0x00}, // '\n...\n    {0x3e,0x24,0x24,0x24,0x3c,0x00}, // b\n    {0x3c,0x24,0x24,0x24,0x24,0x00}, // c\n...\n    {0x00,0x00,0x00,0x00,0x00,0x00}\n};\n</code></pre>\n\n<p>Calling the tty_init function output the following:\n<a href=\"https://i.stack.imgur.com/hegSu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hegSu.png\" alt=\"enter image description here\"></a>\nApparently nothing, but if you take a closer look (the font is pretty small), it prints just a line of 6 pixels, \nThanks in advance!</p>\n\n<p>I don't know if it has something to do, but...    </p>\n\n<p>Notes: <code>KABI</code> stands for <code>__attribute__((sysv_abi))</code><br>\nand the pixel line is printed at the top of the \"represented\" string.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1515523215, "post_id": 48174670, "comment_id": 83329031, "body": "<code>char namn</code> =&gt; <code>char *namn</code>. The warnings of your compiler should probably have helped you."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1515523421, "post_id": 48174670, "comment_id": 83329130, "body": "The way you prevent this from happening is the <b>enable compiler warnings</b> and do not accept code until it compiles -- without warning. For gcc add <code>-Wall -Wextra -pedantic</code> to your compile string. For clang, add <code>-Weverything</code>, for VS (<code>cl.exe</code>) add <code>&#47;W3</code> (or <code>&#47;W4</code> for truly everything)"}, {"owner": {"reputation": 1, "user_id": 9077069, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-APs61_mrAWw/AAAAAAAAAAI/AAAAAAAABkA/CNeTx9Fm1pY/photo.jpg?sz=128", "display_name": "98Basu", "link": "https://stackoverflow.com/users/9077069/98basu"}, "edited": false, "score": 0, "creation_date": 1515523424, "post_id": 48174670, "comment_id": 83329132, "body": "Wow... Should&#39;ve noticed that. Thank you."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1515524158, "post_id": 48174670, "comment_id": 83329537, "body": "Also, <code>sizeof(char)</code> is <i>defined</i> to be one."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 2, "last_activity_date": 1533844526, "last_edit_date": 1533844526, "creation_date": 1515523318, "answer_id": 48174715, "question_id": 48174670, "link": "https://stackoverflow.com/questions/48174670/dynamic-memory-allocation-trouble/48174715#48174715", "title": "Dynamic memory allocation trouble", "body": "<p>Since <code>namn</code> is of type <code>char</code>, the return value of <code>malloc</code> is truncated to the size of a char, which is insufficient to store a valid pointer value.</p>\n\n<p>Fix is:</p>\n\n<pre><code>char *namn;\n</code></pre>\n\n<p>Your compiler probably issues a lot of warnings when compiling. It's always interesting to read them. Example with <code>gcc</code> (without options: default warning setting):</p>\n\n<pre><code>L:\\&gt;gcc test.c\ntest.c: In function 'main':\ntest.c:11:6: warning: assignment makes integer from pointer without a cast [-Wint-conversion]\n namn = malloc((strlen(fornamn)+strlen(efternamn)+1)*sizeof(char));\n      ^\n</code></pre>\n\n<p>Aside, you can limit user input and avoid buffer overflow with:</p>\n\n<pre><code>scanf(\"%24s\", fornamn);\nscanf(\"%24s\", efternamn);\n</code></pre>\n\n<p>And <code>sizeof(char)</code> is always 1. So no need to specify it when allocating string memory.</p>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 7002816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zZvm.jpg?s=128&g=1", "display_name": "LosWochos", "link": "https://stackoverflow.com/users/7002816/loswochos"}, "is_accepted": false, "score": 0, "last_activity_date": 1515523350, "creation_date": 1515523350, "answer_id": 48174727, "question_id": 48174670, "link": "https://stackoverflow.com/questions/48174670/dynamic-memory-allocation-trouble/48174727#48174727", "title": "Dynamic memory allocation trouble", "body": "<p>The variable namn is a simple char. Malloc returns a pointer to the memory. Hence, you need a char pointer (char *namn).</p>\n"}], "owner": {"reputation": 1, "user_id": 9077069, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-APs61_mrAWw/AAAAAAAAAAI/AAAAAAAABkA/CNeTx9Fm1pY/photo.jpg?sz=128", "display_name": "98Basu", "link": "https://stackoverflow.com/users/9077069/98basu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1533844526, "creation_date": 1515523135, "last_edit_date": 1533844458, "question_id": 48174670, "link": "https://stackoverflow.com/questions/48174670/dynamic-memory-allocation-trouble", "title": "Dynamic memory allocation trouble", "body": "<p>The program stops running after memory is allocated to \"namn\". Why?<br>\nThe goal is to enter two SEPARATE strings and concatenate them, then print.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char namn, fornamn[25], efternamn[25];\n    scanf(\"%s\", fornamn);\n    scanf(\"%s\", efternamn);\n\n    namn = malloc((strlen(fornamn)+strlen(efternamn)+1)*sizeof(char));\n    strcpy(namn, fornamn);\n    strcat(namn, efternamn);\n    printf(\"%s\", namn);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1515523055, "post_id": 48174637, "comment_id": 83328948, "body": "What would you expect to happen instead?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1515523060, "post_id": 48174637, "comment_id": 83328953, "body": "Did you read the spec on scanf(). E.g. <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/fscanf</a>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1515523264, "post_id": 48174637, "comment_id": 83329059, "body": "@jimmm  It is a fantastic!"}, {"owner": {"reputation": 33, "user_id": 9194757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68f6a2ecef5c7c4bf487ae95cb9f2d9?s=128&d=identicon&r=PG&f=1", "display_name": "jimmm", "link": "https://stackoverflow.com/users/9194757/jimmm"}, "edited": false, "score": 0, "creation_date": 1515523428, "post_id": 48174637, "comment_id": 83329135, "body": "I just want know what role doe space have.. . Anyway I got a answer thanks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515523589, "post_id": 48174637, "comment_id": 83329216, "body": "Please check that what the question now says is more or less what you intended it to say.  However, I&#39;m still confused about what you are puzzled about? Values aren&#39;t sent to the program for processing until you hit the return key; you won&#39;t see any data in the array until after the return is hit. If you put one number per line, you&#39;ll hit the return key 10 times; if you stack them up on a single line with spaces in between, you may only need to hit return once. The final newline will be left in the buffer for the subsequent input. Check that <code>scanf()</code> succeeds \u2014 <code>if (scanf(&quot;%d&quot;, &amp;a[i]) != 1)</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1515523680, "post_id": 48174637, "comment_id": 83329261, "body": "It is unclear whether you&#39;re confused about (a) how standard-input line buffering can work, or (b) how formatted input reads skip whitespace."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "edited": false, "score": 0, "creation_date": 1515523963, "post_id": 48174637, "comment_id": 83329413, "body": "I was confused about this at first as well. It seems OP is expecting that pressing <code>space</code> should effectively be the same as pressing <code>return</code> for each number.  Does someone know if I&#39;m wrong in saying that <code>scanf</code> reads the string entered before pressing <code>return</code>, then parses through it according to the format symbol? e.g. OP is entering the following string <code>&quot;1 2 3 4 5 6 7 8 9 0\\n\\r&quot;</code>, then scanf (using format <code>%d</code>) linearly iterates through that string and when it finds a substring of digits surrounded by a separator, it places it in the array?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515524799, "post_id": 48174637, "comment_id": 83329803, "body": "@jimmm The only answer I can give now is \u201cIt inserts the space character, separating the numbers\u201d. I expect that\u2019s not actually useful; could you please clarify what about the behavior is confusing? Are you surprised that you need to press space and thing that entering \u201c1234567890\u201d should have the same behavior? Are you confused that it returns more than the first number on the line? Where, specifically, does the behavior differ from your expectations; what input gives a different result than you\u2019d expect?"}, {"owner": {"reputation": 33, "user_id": 9194757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68f6a2ecef5c7c4bf487ae95cb9f2d9?s=128&d=identicon&r=PG&f=1", "display_name": "jimmm", "link": "https://stackoverflow.com/users/9194757/jimmm"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515525486, "post_id": 48174637, "comment_id": 83330124, "body": "@Daniel H I just know what function does space bar has.  I didn&#39;t confused about something. Is this question ambiguous enough to confuse you? then i&#39;m sorry .. when i ask next time, i will think thoroughly. ."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515526070, "post_id": 48174637, "comment_id": 83330386, "body": "@jimmm If you know what function the space has in the expression, then why are you asking what function the space has in the expression? Yes, the question is ambiguous to be confusing, which is why I and WhozCraig ask what you mean, and why Jonathan Leffler and galois thought you meant different things. That\u2019s why I asked the clarifying questions."}, {"owner": {"reputation": 33, "user_id": 9194757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68f6a2ecef5c7c4bf487ae95cb9f2d9?s=128&d=identicon&r=PG&f=1", "display_name": "jimmm", "link": "https://stackoverflow.com/users/9194757/jimmm"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515526340, "post_id": 48174637, "comment_id": 83330504, "body": "@Daniel H I missed &#39;want&#39;..// I just want know what function does space bar has/// this was my first question.. sorry \u3160\u3160\u3160"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515526695, "post_id": 48174637, "comment_id": 83330682, "body": "@jimmm I\u2019m not asking for an apology; you\u2019re new and asking good questions is a skill. If you understood the design and behavior of <code>scanf</code> at least in regards to spaces in the input, then there\u2019s no need to ask questions about it. My questions were asking you to get more specific. Do you understand the behavior of <code>scanf</code> but are wondering why it was designed that way; if so, what alternative design would you compare it to? Do you not understand the behavior of <code>scanf</code>, in which case what specific behavior don\u2019t you understand?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1515527037, "post_id": 48174637, "comment_id": 83330834, "body": "@jimmm: It&#39;s not that the space bar itself has a specific function - you&#39;d get the same result if you used the Tab or Enter keys.  It&#39;s the fact that you introduce <i>whitespace</i> between the three numbers - that splits them into three separate inputs as far as <code>scanf</code> is concerned."}, {"owner": {"reputation": 33, "user_id": 9194757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68f6a2ecef5c7c4bf487ae95cb9f2d9?s=128&d=identicon&r=PG&f=1", "display_name": "jimmm", "link": "https://stackoverflow.com/users/9194757/jimmm"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515527859, "post_id": 48174637, "comment_id": 83331215, "body": "@Daniel H I think this question is caused by a lack of understanding the behavior of scanf. I didn&#39;t understand that when i use scanf, what function can seperate each value. so i asked this question. and i got answer. (Next time i will ask  more specific question)."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515530120, "post_id": 48174637, "comment_id": 83332323, "body": "@jimmm If you found one of the answers below good, you should click the checkmark under the voting buttons to mark it as accepted."}], "answers": [{"comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1515523147, "post_id": 48174667, "comment_id": 83328994, "body": "Only whitespace is a separator."}, {"owner": {"reputation": 1509, "user_id": 1004589, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/7ddbf81e9b120c162fbee0efb2af36fb?s=128&d=identicon&r=PG", "display_name": "Md Monjur Ul Hasan", "link": "https://stackoverflow.com/users/1004589/md-monjur-ul-hasan"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1515523194, "post_id": 48174667, "comment_id": 83329017, "body": "White space, tab, enter... all are separators"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 3, "creation_date": 1515523238, "post_id": 48174667, "comment_id": 83329045, "body": "Those are all called whitespace. But your answer makes it sound like anything other than digits would be a separator, which is not true."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1515524862, "post_id": 48174667, "comment_id": 83329833, "body": "For example, <code>,</code> isn\u2019t a separator, but from just your answer I\u2019d expect it to be."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1515527316, "post_id": 48174667, "comment_id": 83330982, "body": "@interjay: from the perspective of the <code>%d</code> conversion specifier, <i>any</i> non-decimal-digit character marks the end of the input, whitespace or not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515527803, "post_id": 48174667, "comment_id": 83331192, "body": "<code>&quot;%d&quot;</code> does not consider leading white-space as a reason to stop scanning.  A single <code>&#39;-&#39;</code>, <code>&#39;+&#39;</code> is OK too.   (white-spaces)(+-)[digits] is accepted, after that, scanning stops"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1515528000, "post_id": 48174667, "comment_id": 83331279, "body": "@JohnBode Marks the end of the input, yes. But \u201cseparator\u201d implies it can separate two different values. If you enter <code>1,2,3,4,5,6,7,8,9,0</code> into the program in the question, it won\u2019t work."}], "tags": [], "owner": {"reputation": 1509, "user_id": 1004589, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/7ddbf81e9b120c162fbee0efb2af36fb?s=128&d=identicon&r=PG", "display_name": "Md Monjur Ul Hasan", "link": "https://stackoverflow.com/users/1004589/md-monjur-ul-hasan"}, "is_accepted": false, "score": -2, "last_activity_date": 1515523102, "creation_date": 1515523102, "answer_id": 48174667, "question_id": 48174637, "link": "https://stackoverflow.com/questions/48174637/why-does-pushing-space-bar-not-put-a-value-in-array/48174667#48174667", "title": "Why does pushing space bar not put a value in array?", "body": "<p>As you are using scanf() with %d, the input stream is accepting integer values, and considering others as separator. </p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1515526909, "post_id": 48174945, "comment_id": 83330774, "body": "Nice answer, I don&#39;t understand why I am thus far the only upvoter. Btw, ain&#39;t it about time you found a job ;-) ? The financial services industry is crying out for capable C++ developers."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1515526065, "last_edit_date": 1515526065, "creation_date": 1515524140, "answer_id": 48174945, "question_id": 48174637, "link": "https://stackoverflow.com/questions/48174637/why-does-pushing-space-bar-not-put-a-value-in-array/48174945#48174945", "title": "Why does pushing space bar not put a value in array?", "body": "<p>From the C Standard (7.21.6.2 The fscanf function)</p>\n\n<p>12 The conversion specifiers and their meanings are:</p>\n\n<pre><code>d   Matches an optionally signed decimal integer, whose format is the same as\n    expected for the subject sequence of the strtol function with the value 10\n    for the base argument. The corresponding argument shall be a pointer to\n    signed integer.\n</code></pre>\n\n<p>And (7.22.1.4 The strtol, strtoll, strtoul, and strtoull functions)</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>...First, they decompose the input string into three parts: an initial, possibly empty, sequence of white-space characters (as\n  specified by the isspace function), a subject sequence resembling an\n  integer represented in some radix determined by the value of base, and\n  a final string of one or more unrecognized characters, including the\n  terminating null character of the input string. Then, they attempt to\n  convert the subject sequence to an integer, and return the result.</li>\n  </ol>\n</blockquote>\n\n<p>For such an input</p>\n\n<p>1<code>space</code>2<code>space</code>3<code>space</code>\nthe first <em>subject sequence</em> is 1, the second <em>subject sequence</em> (after skipping white-space characters) is 2, and the third <em>subject sequence</em> is 3. They are used to store integers correspondingly in a[0], a[1], and a[2] because each <em>subject sequence</em> represents a valid integer.</p>\n\n<p>Take into account that in general implementations use the so-called <em>line buffering</em> for text streams.</p>\n\n<p>From the C Standard (7.21.3 Files)</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>... When a stream is line buffered, characters are intended to be \n  transmitted to or from the host environment as a block <strong>when a\n  new-line character is encountered</strong>.</li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 33, "user_id": 9194757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68f6a2ecef5c7c4bf487ae95cb9f2d9?s=128&d=identicon&r=PG&f=1", "display_name": "jimmm", "link": "https://stackoverflow.com/users/9194757/jimmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 48174945, "answer_count": 2, "score": 0, "last_activity_date": 1515536498, "creation_date": 1515522951, "last_edit_date": 1515536498, "question_id": 48174637, "link": "https://stackoverflow.com/questions/48174637/why-does-pushing-space-bar-not-put-a-value-in-array", "title": "Why does pushing space bar not put a value in array?", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main(){ \n    printf(\"Enter 10 numbers: \");\n    int a[10], i = 0;\n    for (i = 0; i &lt; 10; i++)\n    {\n        scanf(\"%d\", &amp;a[i]);\n    }\n}\n</code></pre>\n\n<p>When I put value in each array, why pushing the space bar can put a value in the array?</p>\n\n<p>For example when I write 1<kbd>space</kbd>2<kbd>space</kbd>3<kbd>space</kbd> then each value is put in each array (a[0], a[1], a[2]).</p>\n\n<p>Why is this happening?</p>\n"}, {"tags": ["c", "makefile", "compilation"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515522939, "post_id": 48174621, "comment_id": 83328881, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/how-to-fix-undefined-reference-unresolved-external-symbol-error\">How to fix undefined reference/unresolved external symbol error</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "edited": false, "score": 0, "creation_date": 1515523716, "post_id": 48174729, "comment_id": 83329279, "body": "Thanks, that solved my issue! I&#39;ll accept it as soon as stackoverflow will allow me to do it :)"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1515523358, "creation_date": 1515523358, "answer_id": 48174729, "question_id": 48174621, "link": "https://stackoverflow.com/questions/48174621/how-to-solve-undefined-reference-to-pow-already-linked-with-lm/48174729#48174729", "title": "How to solve &#39;undefined reference to pow&#39; (already linked with -lm)?", "body": "<p><code>-lm</code> should go into <code>LDLIBS</code>, not <code>CFLAGS</code> in the Makefile.</p>\n\n<pre><code>LDLIBS = -lm\n</code></pre>\n\n<p>See <a href=\"https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html</a></p>\n\n<p>Although, <code>CFLAGS</code> is also passed to the compiler, ``-lm<code>needs to be at the *end* of the commandline. That's why specifying it in</code>CFLAGS<code>doesn't work because it needs to be passed at the *linking* stage (specifying</code>-lm` at the end provides equivalent functionality).</p>\n"}], "owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 48174729, "answer_count": 1, "score": 0, "last_activity_date": 1515523358, "creation_date": 1515522885, "question_id": 48174621, "link": "https://stackoverflow.com/questions/48174621/how-to-solve-undefined-reference-to-pow-already-linked-with-lm", "title": "How to solve &#39;undefined reference to pow&#39; (already linked with -lm)?", "body": "<p>I'm using the function <code>pow()</code> of <code>math.h</code> in my project. <strong>I added the <code>-lm</code> flag</strong> to the <code>Makefile</code> but I still get the following error trying to run <code>make</code>:</p>\n\n<pre><code>rudp_comm.c:(.text+0x3c1): undefined reference to `pow'\nrudp_comm.c:(.text+0x458): undefined reference to `pow'\n</code></pre>\n\n<p><strong>How to fix this problem?</strong></p>\n\n<p>Here's the complete <code>Makefile</code>:</p>\n\n<pre><code>CC := gcc\nCFLAGS := -Wall -Wextra -Wpedantic -O3 -lm\nSRC := client/client.c client/client_func.c client/client_func.h server/server.c server/server_func.c server/server_func.h common/conf.c common/conf.h common/file_list.c common/file_list.h common/rudp_comm.c common/rudp_comm.h\nOBJ := $(SRC:.c=.o)\n\n.PHONY: all\n\nall: client/client server/server\n\nclient/client: client/client.o client/client_func.o common/conf.o common/file_list.o common/rudp_comm.o\n\nclient/client.o: client/client.c client/client_func.h common/rudp_comm.h\nclient/client_func.o: client/client_func.c client/client_func.h common/conf.h common/file_list.h\n\nserver/server: server/server.o server/server_func.o common/conf.o common/file_list.o common/rudp_comm.o\n\nserver/server.o: server/server.c server/server_func.h common/rudp_comm.h\nserver/server_func.o: server/server_func.c server/server_func.h common/conf.h common/file_list.h\n\ncommon/conf.o: common/conf.c common/conf.h\ncommon/file_list.o: common/file_list.c common/file_list.h\ncommon/rudp_comm.o: common/rudp_comm.c common/rudp_comm.h\n\n\nclean:\n        rm -f client/*.o server/*.o common/*.o core\n\ncleanall:\n        rm -f client/*.o server/*.o common/*.o core client/client server/server\n</code></pre>\n\n<p>In <code>rudp_comm.c</code> of course I included the library (<code>#include \"rudp_comm.h\"</code>), so I really can't guess what the problem could be!</p>\n"}, {"tags": ["c", "arrays", "pointers", "malloc"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1515522107, "post_id": 48174407, "comment_id": 83328436, "body": "This array[inp] = &amp;n; does not make sense because all elements of the array will have the same value: address of the variable n."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515522170, "post_id": 48174407, "comment_id": 83328469, "body": "Why the double pointer? Don&#39;t you just want a 1D array of ints? And no, malloc inside a loop is a bad idea. realloc is better."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515522387, "post_id": 48174407, "comment_id": 83328583, "body": "Don&#39;t use <code>malloc</code> for this - it&#39;s all wrong. Use <code>realloc</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1515522406, "post_id": 48174407, "comment_id": 83328597, "body": "... and a pointer with an initial NULL value."}, {"owner": {"reputation": 45, "user_id": 9138715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a559939f48e5896463fcb16b106592b5?s=128&d=identicon&r=PG&f=1", "display_name": "user9138715", "link": "https://stackoverflow.com/users/9138715/user9138715"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1515522469, "post_id": 48174407, "comment_id": 83328625, "body": "@LeeDanielCrocker I am going to be adding more 1D arrays into it later on."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515523215, "post_id": 48174407, "comment_id": 83329030, "body": "@user9138715 - No, your update is not correct! BTW: Why do you want a double pointer?"}, {"owner": {"reputation": 45, "user_id": 9138715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a559939f48e5896463fcb16b106592b5?s=128&d=identicon&r=PG&f=1", "display_name": "user9138715", "link": "https://stackoverflow.com/users/9138715/user9138715"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515523384, "post_id": 48174407, "comment_id": 83329113, "body": "@4386427 can you please explain what I did wrong? I need a double pointer to add more arrays to it later on, so a 2D array."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515523545, "post_id": 48174407, "comment_id": 83329188, "body": "@user9138715 - you can&#39;t store <code>int</code> values in a pointer-to-pointer-to-int."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515523654, "post_id": 48174407, "comment_id": 83329243, "body": "@user9138715 An <code>int*</code> can point to an array of <code>int</code>. But a <code>int**</code> can only point to an array of <code>int*</code>. Therefor you can&#39;t save <code>int</code> into that memory."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515523704, "post_id": 48174407, "comment_id": 83329272, "body": "Well, you can, but you must allocate memory for each of the pointers you allocate. E.g. <code>int **foo</code>. Then <code>foo = malloc (10 * sizeof *foo)</code> to allocate 10 pointers to <code>int</code>. Then to allocate the first array <code>foo[0] = malloc (20 * sizeof *foo[0]);</code> to allocate storage for <code>20</code> <code>int</code> in array <code>foo[0]</code> and so on."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515523776, "post_id": 48174407, "comment_id": 83329310, "body": "@DavidC.Rankin - true, true... but that&#39;s not what OP is doing. The example after the edit stores integer values directly into integer pointers. That&#39;s bad"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1515523843, "post_id": 48174407, "comment_id": 83329346, "body": "Yes, but that is what he is describing attempting to do, even though if there is just 1 array of <code>int</code>, then there is no need for the pointer-to-pointer."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515524164, "post_id": 48174407, "comment_id": 83329541, "body": "@user9138715 Compare your second example with the second example in my answer. You&#39;ll notice a few but important differences"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 0, "last_activity_date": 1515523458, "last_edit_date": 1515523458, "creation_date": 1515522605, "answer_id": 48174553, "question_id": 48174407, "link": "https://stackoverflow.com/questions/48174407/pointer-of-a-pointer-and-memory-allocation/48174553#48174553", "title": "pointer of a pointer and memory allocation", "body": "<p>You code is wrong for at least these reasons.</p>\n\n<p>1) You keep doing <code>malloc</code> to <code>array</code> and thereby loose previously <code>malloced</code> blocks. The function to use is <code>realloc</code> when extending the size of dynamic memory.</p>\n\n<p>2) You store the address of <code>n</code> instead of the value of <code>n</code></p>\n\n<p>Besides that it seems strange to use a double pointer. Why not do like:</p>\n\n<pre><code>int *array = NULL;\nint n = 1, inp = 0;\nwhile(n){ // scan till the input is 0\n    scanf(\"%d\", &amp;n);\n    array = realloc(array, sizeof(int)*(inp+1));\n    array[inp] = n;\n    inp++;\n}\n</code></pre>\n\n<p><strong>EDIT after OPs update</strong></p>\n\n<p>If you really want to use a double pointer (i.e. <code>int **array;</code>), you need to allocate memory in two levels.</p>\n\n<p>That could look like:</p>\n\n<pre><code>int **array = malloc(sizeof *array);\n*array = NULL;\nint n = 1, inp = 0;\nwhile(n){ // scan till the input is 0\n    scanf(\"%d\", &amp;n);\n    *array = realloc(*array, sizeof(int)*(inp+1));\n    (*array)[inp] = n;\n    inp++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 8366717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yY4lP.png?s=128&g=1", "display_name": "Jango", "link": "https://stackoverflow.com/users/8366717/jango"}, "is_accepted": false, "score": 0, "last_activity_date": 1515530874, "last_edit_date": 1515530874, "creation_date": 1515522985, "answer_id": 48174642, "question_id": 48174407, "link": "https://stackoverflow.com/questions/48174407/pointer-of-a-pointer-and-memory-allocation/48174642#48174642", "title": "pointer of a pointer and memory allocation", "body": "<p>What you're doing in your code is allocating progressively larger areas of memory and saving the input value in the last position of each new area, while losing the pointers to the previously allocated areas. A commom and efficient solution for what you want (which is used in C++'s vectors, I believe) is to allocate some minimum amount of space, then check at each iteration if you are on the verge of exceeding it. In case you are, reallocate the area doubling the space. Something like this:</p>\n\n<pre><code>int i = 0; //iterator\nint s = 1; //array size\nint n;     //input (use do-while so you don't have to worry about initial value)\n\n//it doesn't have to be bidimensional for a single series\nint * array = (int *) malloc(sizeof(int) * s);\n\ndo\n{\n    if(i == s)\n    {\n        s *= 2;\n        array = (int *) realloc(array, sizeof(int) * s);\n    }\n    scanf(\"%d\", &amp;n);\n    array[i++] = n; //assign with the value, not with the address\n}\nwhile(n)\n</code></pre>\n\n<p><strong>UPDATE:</strong> if you really need to use **int, do it like this:</p>\n\n<pre><code>int n, i = 0, s = 1;\n\nint ** array = (int **) malloc(sizeof(int*) * s);\n\ndo\n{\n    if(i == s)\n    {\n        s *= 2;\n        array = (int **) realloc(array, sizeof(int *) * s);\n    }\n    scanf(\"%d\", &amp;n);\n    array[i] = (int *) malloc(sizeof(int));\n    array[i][0] = n;\n    ++i;\n}\nwhile(n)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9138715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a559939f48e5896463fcb16b106592b5?s=128&d=identicon&r=PG&f=1", "display_name": "user9138715", "link": "https://stackoverflow.com/users/9138715/user9138715"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 48174553, "answer_count": 2, "score": 1, "last_activity_date": 1516468702, "creation_date": 1515521894, "last_edit_date": 1515523298, "question_id": 48174407, "link": "https://stackoverflow.com/questions/48174407/pointer-of-a-pointer-and-memory-allocation", "title": "pointer of a pointer and memory allocation", "body": "<p>If I have <code>int **array</code> and want to place a series of numbers in it (I don't know its size), <code>5 3 4 0</code> or <code>9 1 5 8 3 0</code> as an example. As far as I know I should be using <code>malloc</code></p>\n\n<p>So I did something like this</p>\n\n<pre><code>int **array;\nint n = 1, inp = 0;\nwhile(n){ // scan till the input is 0\n    scanf(\"%d\", &amp;n);\n    array = (int**)malloc(sizeof(int*)*(inp+1)); //since inp start at 0\n    array[inp] = &amp;n; //is this even correct?\n    inp++;\n}\n</code></pre>\n\n<p>My first question is: Will this method (the loop) upgrade/expand the size of the <code>array</code> or is what I am doing a waste of memory?</p>\n\n<p>The second question is how can I print/edit the values of this <code>array</code>?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>From your answers I have came up with the following.</p>\n\n<pre><code>int **array;\nint n = 1, inp = 0;\narray = (int**)malloc(sizeof(int*));\nwhile(n){\n    scanf(\"%d\", &amp;n);\n    realloc( array, sizeof((int*)(inp+1)));\n    array[inp] = n;\n    inp++;\n}\n</code></pre>\n\n<p>Is this the correct way to do it?</p>\n\n<p>Note* I am aware that it does not have to be a pointer of a pointer, but I need it to be for something else later on.</p>\n"}, {"tags": ["c", "file", "text", "directory", "double"], "comments": [{"owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1515523214, "post_id": 48174403, "comment_id": 83329029, "body": "That was it! Thank you so much!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515529568, "post_id": 48174403, "comment_id": 83332047, "body": "Many compilers with warnings fully enabled would have warned about <code>double variable; ...  fscanf(f, &quot;%1f&quot;, &amp;variable);</code>.  Save time, enable all warnings."}], "owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515521881, "creation_date": 1515521881, "question_id": 48174403, "link": "https://stackoverflow.com/questions/48174403/c-program-reading-doubles-into-a-text-file-from-directory-program-recognizes-a", "title": "C program- reading doubles into a text file from directory, program recognizes as zero values", "body": "<p>I'm trying to read doubles from multiple text files in a directory. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;dirent.h&gt;\n\nint main()\n{\n\nDIR *ptr;\ndouble variable;\nint n, i;\nFILE *f, *fpointer;\n\nn=0;\ni=0;\n\n//Open directory \nstruct dirent *directory;\n  ptr = opendir(\"faketext\");\n  while((directory = readdir(ptr)) != NULL)\n  {\n   if ( !strcmp(directory-&gt;d_name, \".\") || !strcmp(directory-&gt;d_name, \"..\") )\n     {\n\n       } else {\n    n++;\n     }\n  }\n\n  rewinddir(ptr);\n\nchar *filesList[n];\n\n//Put file names into the array\n\nwhile((directory = readdir(ptr)) != NULL) {\nif ( !strcmp(directory-&gt;d_name, \".\") || !strcmp(directory-&gt;d_name, \"..\") )\n{}\nelse {\n    filesList[i] = (char*) malloc (strlen(directory-&gt;d_name)+1);\n    strncpy (filesList[i],directory-&gt;d_name, strlen(directory-&gt;d_name) );\n    i++;\n}\n}\nclosedir(ptr);\n\n//Open file names from directory, read data, print data to both the terminal and new text file \n\nfor(i=0; i&lt;n; i++){\n char buf[0x100];\n snprintf(buf, sizeof(buf), \"faketext/%s\", filesList[i]);\n f = fopen(buf, \"r\");\n if(f == NULL){\n    printf(\"Trouble opening file.\");\n   }\n fscanf(f, \"%1f\", &amp;variable);\n printf(\"%f\\t\",variable);\n\n char buf2[0x100];\n snprintf(buf2, sizeof(buf2), \"faketext/%s_data.txt\", filesList[i]);\n fpointer = fopen(buf2, \"w\");\n fprintf(fpointer, \"%f\", variable);\n}\n\n\nfclose(fpointer);\nfclose(f);\nreturn 0;\n\n}\n</code></pre>\n\n<p>This program works beautifully with variable set to integers and floats. However, I'm adapting this program to work with scientific research, and I need the precision of the double. When I read in the files, the code returns 0.000000 for each of the doubles (both in the terminal and the new text file), although the decimals stored in each of the original text files are nonzero. </p>\n\n<p>I've made sure that when I scan in the doubles, the function is set to scan with \"%1f\" for doubles, as that seems to be the most common error for this kind of thing. \nI'm pretty new to C and have had no formal training in it, so any feedback is appreciated. </p>\n"}, {"tags": ["c", "string", "algorithm", "search"], "comments": [{"owner": {"reputation": 193, "user_id": 1144173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/74955b669a539604faed4b813b3b1152?s=128&d=identicon&r=PG", "display_name": "ZenJ", "link": "https://stackoverflow.com/users/1144173/zenj"}, "edited": false, "score": 1, "creation_date": 1515539520, "post_id": 48174394, "comment_id": 83336167, "body": "Just not to overlook the obvious: string.h has function strstr that does the job."}, {"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "reply_to_user": {"reputation": 193, "user_id": 1144173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/74955b669a539604faed4b813b3b1152?s=128&d=identicon&r=PG", "display_name": "ZenJ", "link": "https://stackoverflow.com/users/1144173/zenj"}, "edited": false, "score": 0, "creation_date": 1515544734, "post_id": 48174394, "comment_id": 83337473, "body": "@ZenJ: Yes, I know but it doesn&#39;t give me the ability to manipulate the string."}], "answers": [{"comments": [{"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515529568, "post_id": 48174510, "comment_id": 83332048, "body": "Good job, but your code in some cases does not work well. for example, when I changed the target word to &quot;llo&quot; the result was that <a href=\"http://i.cubeupload.com/L2ITe1.jpg\" rel=\"nofollow noreferrer\">The result</a>. Concerning your note 2, I think my question is clear, not ambiguous."}, {"owner": {"reputation": 9897, "user_id": 2576706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ze8c.jpg?s=128&g=1", "display_name": "Ludovic Feltz", "link": "https://stackoverflow.com/users/2576706/ludovic-feltz"}, "reply_to_user": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515530922, "post_id": 48174510, "comment_id": 83332718, "body": "@LionKing Yes you are right i do not reset currIndex when i detect the end of the word. I know your question is clear but it look like you did not search enough for a solution and posted a question too soon :) but maybe i am wrong (i edited my answer but it did not made any error when the index was out of bound?)"}, {"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515533163, "post_id": 48174510, "comment_id": 83333726, "body": "Thank you, but unfortunately, the problem still exists."}, {"owner": {"reputation": 9897, "user_id": 2576706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ze8c.jpg?s=128&g=1", "display_name": "Ludovic Feltz", "link": "https://stackoverflow.com/users/2576706/ludovic-feltz"}, "reply_to_user": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515533639, "post_id": 48174510, "comment_id": 83333938, "body": "@LionKing People on SO can&#39;t solve all your problem... sorry :/"}], "tags": [], "owner": {"reputation": 9897, "user_id": 2576706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ze8c.jpg?s=128&g=1", "display_name": "Ludovic Feltz", "link": "https://stackoverflow.com/users/2576706/ludovic-feltz"}, "is_accepted": false, "score": 1, "last_activity_date": 1515530978, "last_edit_date": 1515530978, "creation_date": 1515522393, "answer_id": 48174510, "question_id": 48174394, "link": "https://stackoverflow.com/questions/48174394/searching-for-block-of-characters-word-in-a-text/48174510#48174510", "title": "Searching for block of characters (word) in a text", "body": "<p>You should check every letter of your pattern from the beginning (and not check the whole pattern). Try this (not tested):</p>\n\n<pre><code>int currIndex = 0;\n\nfor (i = 0; i &lt; textLen; i++) {\n  printf(\"%c\", text[i]);\n  if (text[i] == patt[currIndex]) {\n      for (j = 0; j &lt; pattLen; j++) {\n          if(text[i+j] != patt[j]){\n              continue;\n          }\n      }\n      printf(\" &lt;--\");\n      currIndex++;\n      if(currIndex==pattLen)\n          currIndex = 0;\n  }\n  else{\n      currIndex = 0;\n  }\n  printf(\"\\n\");\n}\n</code></pre>\n\n<p><strong>Note:</strong> It is <strong>not</strong> the best way to achieve this but the easiest with your example</p>\n\n<p><strong>Note 2:</strong> This question should be closed as it is:</p>\n\n<blockquote>\n  <p>Questions seeking debugging help (\"why isn't this code working?\") must\n  include the desired behavior, a specific problem or error and the\n  shortest code necessary to reproduce it in the question itself.\n  Questions without a clear problem statement are not useful to other\n  readers. See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable\n  example.</a></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1515522726, "post_id": 48174567, "comment_id": 83328760, "body": "An array is not necessary if you keep the index of the first matched charcater after a full match has been found."}, {"owner": {"reputation": 9897, "user_id": 2576706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ze8c.jpg?s=128&g=1", "display_name": "Ludovic Feltz", "link": "https://stackoverflow.com/users/2576706/ludovic-feltz"}, "edited": false, "score": 0, "creation_date": 1515522736, "post_id": 48174567, "comment_id": 83328767, "body": "I though of this solution too, i think it is a better answer than me so i upvoted you :)"}, {"owner": {"reputation": 9897, "user_id": 2576706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ze8c.jpg?s=128&g=1", "display_name": "Ludovic Feltz", "link": "https://stackoverflow.com/users/2576706/ludovic-feltz"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515522767, "post_id": 48174567, "comment_id": 83328786, "body": "@usr2564301 Yeah that is basically like my solution but i prefer this approch"}, {"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515528153, "post_id": 48174567, "comment_id": 83331345, "body": "Thank you. <code>Is that enough of a hint?</code> if with a simple example, it will be so good."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515529290, "post_id": 48174567, "comment_id": 83331899, "body": "@LionKing: SO is not a coding service.  Where are you stuck in implementing those two steps?"}, {"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515529709, "post_id": 48174567, "comment_id": 83332115, "body": "@Prune: I&#39;m just confused."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 2, "creation_date": 1515533629, "post_id": 48174567, "comment_id": 83333934, "body": "Then you need help beyond the expressed charter of Stack Overflow.  I suggest some on-line tutorials to help you with language and design details, and perhaps a local classmate or tutor."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 2, "last_activity_date": 1515522649, "creation_date": 1515522649, "answer_id": 48174567, "question_id": 48174394, "link": "https://stackoverflow.com/questions/48174394/searching-for-block-of-characters-word-in-a-text/48174567#48174567", "title": "Searching for block of characters (word) in a text", "body": "<p>You have to do a full substring match <em>before</em> you print; mark the applicable characters on a first pass, and then have a second pass to print the results.  In your case, you'd create a second array, with boolean values corresponding to the first, something like</p>\n\n<p>text  = \"Hello xyz world\";\nmatch    000000111100000</p>\n\n<p>I assume that you can find a basic substring match program online.  Printing on the second pass will be easy: you already have the logic.  Instead of <code>if (text[i] == patt[j])</code>, just use <code>if match[i]</code>.</p>\n\n<p>Is that enough of a hint?</p>\n"}, {"comments": [{"owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515544817, "post_id": 48177805, "comment_id": 83337492, "body": "Thank you, but in some cases, for example, &quot;world&quot;, &quot;rld&quot; it doesn&#39;t work well with them. Take a look <a href=\"https://onlinegdb.com/BJatRAM4z\" rel=\"nofollow noreferrer\">online compiler</a>."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "edited": false, "score": 0, "creation_date": 1515568341, "post_id": 48177805, "comment_id": 83343658, "body": "@LionKing: My bad, I forgot to control what happened what the searched pattern was at the end of the text string =&gt; need a <code>&lt;=</code> instead of <code>&lt;</code>. Previous code was stopping one step too early. Fixed by the edit."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1515568272, "last_edit_date": 1515568272, "creation_date": 1515538256, "answer_id": 48177805, "question_id": 48174394, "link": "https://stackoverflow.com/questions/48174394/searching-for-block-of-characters-word-in-a-text/48177805#48177805", "title": "Searching for block of characters (word) in a text", "body": "<p>You need to make sure that there is a full match before starting to print any <code>&lt;--</code>. And to avoid to do  accesses passed end of array on <code>patt</code>, you will have to stop searching when less than <code>pattLen</code> characters remain in array.</p>\n\n<p>Then when you have found a full match, you can print the content of <code>patt</code> followed with <code>&lt;--</code> and increment position of pointer of <code>pattLen-1</code>. And at the end you will have to copy remaining characters from text.</p>\n\n<p>Code could become:</p>\n\n<pre><code>// The Text\nconst char * text = \"Hello xyz world\";\n// The target word\nconst char * patt = \"xyz \";\nsize_t textLen = strlen(text),\n    pattLen = strlen(patt), i, j;\n\nfor (i = 0; i &lt;= textLen - pattLen; i++) {  // don't search if less that pattLen remains\n    printf(\"%c\", text[i]);\n    if (text[i] == patt[0]) {               // first char matches\n        int found = 1;                      // be optimistic...\n        for (j = 1; j &lt; pattLen; j++) {\n            if (patt[j] != text[i + j]) {\n                found = 0;\n                break;                      // does not fully match, go on\n            }\n        }\n        if (found) {                        // yeah, a full match!\n            printf(\" &lt;--\");                 // already printed first char\n            for (j = 1; j &lt; pattLen; j++) {\n                printf(\"\\n%c &lt;--\", patt[j]);// print all others chars from patt\n            }\n            i += pattLen - 1;               // increase index...\n        }\n    }\n    printf(\"\\n\");\n}\nwhile (i &lt; textLen) {\n    printf(\"%c\\n\", text[i++]);              // process the end of text\n}\n</code></pre>\n\n<p>Above code gives expected output for <code>\"xyz \"</code> and also <code>\"llo\"</code>...</p>\n"}], "owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48177805, "answer_count": 3, "score": 0, "last_activity_date": 1515568272, "creation_date": 1515521852, "last_edit_date": 1592644375, "question_id": 48174394, "link": "https://stackoverflow.com/questions/48174394/searching-for-block-of-characters-word-in-a-text", "title": "Searching for block of characters (word) in a text", "body": "<p>I want to search for a block of characters (word) in a text.<br />\nFor example, I have the next text &quot;Hello xyz world&quot;, and I want to search for &quot;xyz &quot;, note the space after the word.</p>\n<pre><code>// The Text\nconst char * text = &quot;Hello xyz world&quot;;\n// The target word\nconst char * patt = &quot;xyz &quot;;\nsize_t textLen = strlen(text),\n  pattLen = strlen(patt), i, j;\n\nfor (i = 0; i &lt; textLen; i++) {\n  printf(&quot;%c&quot;, text[i]);\n  for (j = 0; j &lt; pattLen; j++) {\n    if (text[i] == patt[j]) {\n      printf(&quot; &lt;--&quot;);\n      break;\n    }\n  }\n  printf(&quot;\\n&quot;);\n}\n</code></pre>\n<p>The result must be like following:</p>\n<p><a href=\"https://i.stack.imgur.com/OhCYC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OhCYC.jpg\" alt=\"\" /></a></p>\n<p>But unfortunately, the result as the following:</p>\n<p><a href=\"https://i.stack.imgur.com/oKEpv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oKEpv.jpg\" alt=\"\" /></a></p>\n<p>It collects all the similar characters in the whole text, not just the target characters (the word).</p>\n<p>How to fix that problem?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 1922, "user_id": 8868108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNHxq.png?s=128&g=1", "display_name": "Green", "link": "https://stackoverflow.com/users/8868108/green"}, "edited": false, "score": 0, "creation_date": 1515521871, "post_id": 48174283, "comment_id": 83328327, "body": "first replace scanf to fgets. scanf is not a safe function."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1515521932, "post_id": 48174283, "comment_id": 83328354, "body": "Maybe the issue is that <code>realloc</code> does not initialize the memory (where <code>calloc</code> does) and that&#39;s where the junk comes from."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9194611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0495cd94ed9f09e2baf7de2b338ec83c?s=128&d=identicon&r=PG&f=1", "display_name": "Ori Moldovan", "link": "https://stackoverflow.com/users/9194611/ori-moldovan"}, "edited": false, "score": 0, "creation_date": 1515522983, "post_id": 48174435, "comment_id": 83328911, "body": "thanks,  the accurate code I entered is    arr[size-1]=0; I had to make it 0 so the IF in the loop will be able to change it."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 2, "last_activity_date": 1515522042, "creation_date": 1515522042, "answer_id": 48174435, "question_id": 48174283, "link": "https://stackoverflow.com/questions/48174283/c-i-get-printing-out-random-numbers-not-address-instead-of-scanned-number/48174435#48174435", "title": "C, I get printing out random numbers (not address) instead of scanned number", "body": "<p>You have a problem here:</p>\n\n<pre><code>            size++;\n            arr = (int*)realloc(arr, size*sizeof(int));\n            if (!arr) {\n                 printf(\"ERROR! Not enough memory!\\n\");\n                exit(1); \n            }\n            for (i = 0; i&lt;size; i++ ){\n                 if (arr[i]&lt;num){       // arr[size-1] has indeterminate value\n                 swap(&amp;num,&amp;arr[i]);\n                }\n            }\n</code></pre>\n\n<p>After <code>realloc</code> you access the whole array but you have never written to the new element. Remember that <code>realloc</code> leaves new memory with indeterminate values.</p>\n\n<p>Maybe you miss a </p>\n\n<pre><code>arr[size-1] = num;\n</code></pre>\n\n<p>before the loop</p>\n"}], "owner": {"reputation": 3, "user_id": 9194611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0495cd94ed9f09e2baf7de2b338ec83c?s=128&d=identicon&r=PG&f=1", "display_name": "Ori Moldovan", "link": "https://stackoverflow.com/users/9194611/ori-moldovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 48174435, "answer_count": 1, "score": 0, "last_activity_date": 1618083097, "creation_date": 1515521394, "last_edit_date": 1618083097, "question_id": 48174283, "link": "https://stackoverflow.com/questions/48174283/c-i-get-printing-out-random-numbers-not-address-instead-of-scanned-number", "title": "C, I get printing out random numbers (not address) instead of scanned number", "body": "<p>I got the next code and for the first 6 scans in the loop its works just fine but in the 7th time its changes one of the numbers in the Array to <code>313***</code> (where <code>*</code> is random number). if I continue scanning numbers its still made this error once in 4-6 scanning.</p>\n<p>Anyone know what that means?</p>\n<pre><code>int* take2(int num){\n            static int size=0;\n            int i,mid;\n            static int* arr;\n            if (size==0){\n                 arr = (int*)calloc(1, sizeof(int));\n                if (!arr) {\n                    printf(&quot;ERROR! Not enough memory!\\n&quot;);\n                    exit(1); \n                }\n                size=1;\n                arr[0]=num;\n            }\n            else {\n                size++;\n                arr = (int*)realloc(arr, size*sizeof(int));\n                if (!arr) {\n                     printf(&quot;ERROR! Not enough memory!\\n&quot;);\n                    exit(1); \n                }\n                for (i = 0; i&lt;size; i++ ){\n                     if (arr[i]&lt;num){\n                     swap(&amp;num,&amp;arr[i]);\n                    }\n                }\n            }\n            mid=size/2;\n            printf(&quot;the middle number is: %d\\n&quot;,arr[mid]);\n            for (i = 0; i&lt;size; i++ ){\n              printf(&quot; ,%d&quot;,arr[i]);\n            }\n            return arr;\n    }\n</code></pre>\n<p>the main is:</p>\n<pre><code>void main(){\n    int flag1=1;\n    int num1;\n    int *arr1;\n    while(flag1){\n      printf(&quot;\\n enter a number: \\n if you want to exit press -1\\n&quot;);\n      scanf(&quot;%d&quot; ,&amp;num1 );\n      if (num1==-1) break;\n      arr1=take2(num1);\n    }\n    free(arr1);\n}\n</code></pre>\n<p>when I run this function (in the main I scanning for numbers in loop..) i get after 7 numbers the next output:(this output is after 7 scanning)</p>\n<pre><code>the middle number is: 3\n ,6 ,5 ,4 ,3 ,2 ,1\n enter a number:\n if you want to exit press -1\n7\nthe middle number is: 4\n ,7 ,6 ,5 ,4 ,3 ,2 ,31361\n enter a number:\n if you want to exit press -1\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "answers": [{"comments": [{"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1515546119, "post_id": 48178462, "comment_id": 83337811, "body": "Wow -- it never occurred to me that the code would just keep using new request objects, so I misinterpreted the problem entirely."}], "tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": false, "score": 1, "last_activity_date": 1515542567, "creation_date": 1515542567, "answer_id": 48178462, "question_id": 48174258, "link": "https://stackoverflow.com/questions/48174258/mpi-status-gets-wrong-sender/48178462#48178462", "title": "MPI status gets wrong sender", "body": "<p>You are not using <code>MPI_Waitany()</code> correctly.</p>\n\n<p>It should be</p>\n\n<pre><code>MPI_Status status;\nMPI_Waitany(N_computed,request,&amp;index_completed,&amp;status);\ndest = status.MPI_SOURCE;\n</code></pre>\n\n<p>note :</p>\n\n<ul>\n<li>you need an extra loop to <code>MPI_Wait()</code> the last <code>size - 1</code> requests</li>\n<li>you can revamp your algorithm and use <code>MPI_Request request[size-1];</code> and hence save some memory</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1515579065, "post_id": 48183762, "comment_id": 83349636, "body": "Please edit your question and add the error message."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1515579843, "post_id": 48183762, "comment_id": 83350167, "body": "Also, try <code>MPI_Waitall(..., MPI_STATUSES_IGNORE)</code>"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1515580950, "post_id": 48183762, "comment_id": 83350873, "body": "Why do you think wasting memory with an array of <code>MPI_Status</code> would be smarter ? Array or not, there is no initialization. If you want to declare the variable in the outermost block, then go ahead. You now have a buffer overflow on the <code>request</code> array. You have to adjust your code to match the new size."}, {"owner": {"reputation": 163, "user_id": 5435576, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5d135aac48900ff8e8dd28017bcdc417?s=128&d=identicon&r=PG&f=1", "display_name": "rugrag", "link": "https://stackoverflow.com/users/5435576/rugrag"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1515582453, "post_id": 48183762, "comment_id": 83351754, "body": "By the way, why do you suggest to use MPI_Request request[size-1] ? shouldn&#39;t we have one request for each Irecv?? this point is still unclear"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1515582867, "post_id": 48183762, "comment_id": 83351963, "body": "Your algorithm requires only one request per peer, so <code>size - 1</code> requests are enough."}], "tags": [], "owner": {"reputation": 163, "user_id": 5435576, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5d135aac48900ff8e8dd28017bcdc417?s=128&d=identicon&r=PG&f=1", "display_name": "rugrag", "link": "https://stackoverflow.com/users/5435576/rugrag"}, "is_accepted": false, "score": 0, "last_activity_date": 1515580343, "last_edit_date": 1515580343, "creation_date": 1515575291, "answer_id": 48183762, "question_id": 48174258, "link": "https://stackoverflow.com/questions/48174258/mpi-status-gets-wrong-sender/48183762#48183762", "title": "MPI status gets wrong sender", "body": "<p>I forgot to add a line in the initial post in which I wait for all the pending requests: by the way if I initialize a new status everytime I do Waitany the master process crashes; I need to track which processes are still pending in order to wait the proper number of times... \nthanks by the way</p>\n\n<p>EDIT: now it works even if I find it not very smart; would it be possible to initialize an array of MPI_Status at the beginning instead of doing it each time before a wait?</p>\n\n<pre><code>//master\nif (rank == 0) {\n\n    int N_chunks = 10;\n    MPI_Request request[size-1];\n    int N_computed = 0;\n    int dest;\n    int index_completed;\n\n    //initialize array of vec\n    vec send[N_chunks];\n    vec recv[N_chunks];\n\n\n\n    //initial case\n    for(int i=1;i&lt;size;i++){\n\n      MPI_Send(&amp;send[N_computed], 1, mpi_vec_type, i, tag, MPI_COMM_WORLD);\n      MPI_Irecv(&amp;recv[N_computed], 1, mpi_vec_type, i, tag, MPI_COMM_WORLD, &amp;request[N_computed]);\n      N_computed++;\n    }\n\n\n\n    // loop\n    while (N_computed &lt; N_chunks){\n\n      MPI_Status status;\n      //get processed messages\n      MPI_Waitany(N_computed,request,&amp;index_completed,&amp;status);\n\n      //get sender ID dest\n      dest = status.MPI_SOURCE;\n\n      MPI_Send(&amp;send[N_computed], 1, mpi_vec_type, dest, tag, MPI_COMM_WORLD);\n      MPI_Irecv(&amp;recv[N_computed], 1, mpi_vec_type, dest, tag, MPI_COMM_WORLD, &amp;request[N_computed]);\n\n      N_computed++;\n    }\n\n    //wait other process to send back their load\n    for(int i=0;i&lt;size-1;i++){\n\n      MPI_Status status;\n      MPI_Waitany(N_computed, request, &amp;index_completed,&amp;status);\n\n    }\n\n\n    //end\n    printf(\"Ms finish\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 5435576, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5d135aac48900ff8e8dd28017bcdc417?s=128&d=identicon&r=PG&f=1", "display_name": "rugrag", "link": "https://stackoverflow.com/users/5435576/rugrag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515580343, "creation_date": 1515521255, "last_edit_date": 1515573197, "question_id": 48174258, "link": "https://stackoverflow.com/questions/48174258/mpi-status-gets-wrong-sender", "title": "MPI status gets wrong sender", "body": "<p>I am solving a load balance problem using MPI: a Master process sends tasks to the slaves processes and collect results as they compute and send back their job. \nSince I want to improve performances more as possible I use non-blocking communications: Master sends several tasks and then wait until one process sends back its response so that the master can send additional work to it and so on.</p>\n\n<p>I use MPI_Waitany() since I don't know in advance which slave process responses first, then I get the sender from the status and I can send the new job to it.</p>\n\n<p>My problem is that sometimes the sender I get is wrong (a rank not in MPI_COMM_WORLD) and the program crashes; other times it works fine.</p>\n\n<p>Here's the code. thanks!</p>\n\n<pre><code>//master\nif (rank == 0) {\n\n    int N_chunks = 10;\n    MPI_Request request[N_chunks];\n    MPI_Status status[N_chunks];\n    int N_computed = 0;\n    int dest,index_completed;\n\n    //initialize array of my data structure\n    vec send[N_chunks];\n    vec recv[N_chunks];\n\n\n    //send one job to each process in communicator\n    for(int i=1;i&lt;size;i++){\n\n      MPI_Send( &amp;send[N_computed], 1, mpi_vec_type, i, tag, MPI_COMM_WORLD);\n      MPI_Irecv(&amp;recv[N_computed], 1, mpi_vec_type, i, tag, MPI_COMM_WORLD,  \n                &amp;request[N_computed]);\n      N_computed++;\n    }\n\n    // loop\n    while (N_computed &lt; N_chunks){\n\n      //get processed messages\n      MPI_Waitany(N_computed,request,&amp;index_completed,status);\n\n      //get sender ID dest\n      dest = status[index_completed].MPI_SOURCE;\n\n      //send a new job to that process\n      MPI_Send( &amp;send[N_computed], 1, mpi_vec_type, dest, tag, MPI_COMM_WORLD);\n      MPI_Irecv(&amp;recv[N_computed], 1, mpi_vec_type, dest, tag, MPI_COMM_WORLD,\n                &amp;request[N_computed]);\n\n      N_computed++;\n  }\n\n  MPI_Waitall(N_computed,request,status);\n\n  //close all process\n  printf(\"End master\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "glib"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 2647168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d480bf91050295d59f4f0dc768f721c1?s=128&d=identicon&r=PG", "display_name": "Douglas Santos", "link": "https://stackoverflow.com/users/2647168/douglas-santos"}, "edited": false, "score": 0, "creation_date": 1515521096, "post_id": 48174029, "comment_id": 83327969, "body": "Thanks, Barmar. I do know that, for the general case, this is true. My doubt is if this can be expected for GLib&#39;s data structures too, as the documentation leaves this open <a href=\"https://developer.gnome.org/glib/stable/glib-Threads.html\" rel=\"nofollow noreferrer\">here</a>: &quot;GLib itself is internally completely thread-safe (all global data is automatically locked), but individual data structure instances are not automatically locked for performance reasons. For example, you must coordinate accesses to the same GHashTable from multiple threads.&quot;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 29, "user_id": 2647168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d480bf91050295d59f4f0dc768f721c1?s=128&d=identicon&r=PG", "display_name": "Douglas Santos", "link": "https://stackoverflow.com/users/2647168/douglas-santos"}, "edited": false, "score": 1, "creation_date": 1515521165, "post_id": 48174029, "comment_id": 83328003, "body": "Why would they be any different? Do you think that reading a structure might need to modify it behind the scenes?"}, {"owner": {"reputation": 29, "user_id": 2647168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d480bf91050295d59f4f0dc768f721c1?s=128&d=identicon&r=PG", "display_name": "Douglas Santos", "link": "https://stackoverflow.com/users/2647168/douglas-santos"}, "edited": false, "score": 0, "creation_date": 1515521341, "post_id": 48174029, "comment_id": 83328080, "body": "I edited my comment before seeing your answer, sorry. As I said, documentation leaves a doubt, and I don&#39;t have experience with GLib. I must admit, though, that it would make no sense if GLib would require such locks."}, {"owner": {"reputation": 1943, "user_id": 1391824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b30c131f358c299e7b5c89870c3761?s=128&d=identicon&r=PG", "display_name": "TingPing", "link": "https://stackoverflow.com/users/1391824/tingping"}, "edited": false, "score": 0, "creation_date": 1515661132, "post_id": 48174029, "comment_id": 83387071, "body": "GHashTable is absolutely not threadsafe, reading the source is the easiest way to verify that."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1515520321, "creation_date": 1515520321, "answer_id": 48174029, "question_id": 48173893, "link": "https://stackoverflow.com/questions/48173893/is-glibs-ghashtable-thread-safe-for-read-only-accesses-from-multiple-threads/48174029#48174029", "title": "Is GLib&#39;s GHashTable thread-safe for read-only accesses from multiple threads?", "body": "<p>In general, mutual exclusion is only needed when you could be modifying data concurrently with reading or modifying in another thread. If all accesses (after the hash table is filled in during initialization) are just reading, there's no need for locks.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 2647168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d480bf91050295d59f4f0dc768f721c1?s=128&d=identicon&r=PG", "display_name": "Douglas Santos", "link": "https://stackoverflow.com/users/2647168/douglas-santos"}, "edited": false, "score": 0, "creation_date": 1515521944, "post_id": 48174210, "comment_id": 83328360, "body": "I think that this wouldn&#39;t be a problem in my case, as you said, but it is an interesting point to keep in mind. Could you point me one or more links where this is further explained? Thanks!"}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 29, "user_id": 2647168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d480bf91050295d59f4f0dc768f721c1?s=128&d=identicon&r=PG", "display_name": "Douglas Santos", "link": "https://stackoverflow.com/users/2647168/douglas-santos"}, "edited": false, "score": 1, "creation_date": 1515535668, "post_id": 48174210, "comment_id": 83334815, "body": "@DouglasSantos There&#39;s some videos here: <a href=\"http://concurrencyfreaks.blogspot.co.uk/2013/02/the-new-memory-model-in-c11-and-c11.html\" rel=\"nofollow noreferrer\">concurrencyfreaks.blogspot.co.uk/2013/02/&hellip;</a> FWIW C11 and C++11 have very similar requirements in regards to memory consistency models. cppreference has a good breakdown of the different types of ordering requirement, which are also applicable to C: <a href=\"http://en.cppreference.com/w/c/atomic/memory_order\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/atomic/memory_order</a> - and of course the most authoritative source is the language specification itself, though it&#39;s not light reading."}], "tags": [], "owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "is_accepted": false, "score": 1, "last_activity_date": 1515521040, "creation_date": 1515521040, "answer_id": 48174210, "question_id": 48173893, "link": "https://stackoverflow.com/questions/48173893/is-glibs-ghashtable-thread-safe-for-read-only-accesses-from-multiple-threads/48174210#48174210", "title": "Is GLib&#39;s GHashTable thread-safe for read-only accesses from multiple threads?", "body": "<p>Strictly speaking, C makes no guarantees, unless you have <em>some</em> sort of synchronisation, that data written by one thread is going to be visible or coherent to others.</p>\n\n<p>You need a memory operation with \"release\" semantics after setting up the hash table, and one with \"acquire\" semantics in the other threads before they read it.</p>\n\n<p>It's probably enough that the reading threads are created after the hash table is created, though I'm not 100% certain of this.</p>\n"}], "owner": {"reputation": 29, "user_id": 2647168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d480bf91050295d59f4f0dc768f721c1?s=128&d=identicon&r=PG", "display_name": "Douglas Santos", "link": "https://stackoverflow.com/users/2647168/douglas-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 48174029, "answer_count": 2, "score": 1, "last_activity_date": 1515521040, "creation_date": 1515519794, "question_id": 48173893, "link": "https://stackoverflow.com/questions/48173893/is-glibs-ghashtable-thread-safe-for-read-only-accesses-from-multiple-threads", "title": "Is GLib&#39;s GHashTable thread-safe for read-only accesses from multiple threads?", "body": "<p>I want to create a GHashTable in program's initialization, which would be later concurrently accessed for reading only by newly created threads.</p>\n\n<p>Is it safe to do so without a lock?</p>\n"}, {"tags": ["c", "gcc", "floating-point"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515519847, "post_id": 48173876, "comment_id": 83327315, "body": "<code>sizeof(281474976710656)</code> is just giving you <code>sizeof(int)</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1515519997, "post_id": 48173876, "comment_id": 83327388, "body": "<i>I can still store a 8 bytes real value in a float</i>  You can?  How?  All you can store is the floating-point <i>representation</i> of that 8-byte value.  And you lose a lot of information in the conversion."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1515521525, "post_id": 48173876, "comment_id": 83328158, "body": "@cleblanc this is not necessary true, could be sizeof(long) as well sizeof(long long)"}, {"owner": {"reputation": 1365, "user_id": 7610883, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d5b2f292c46f7ef87ab8a0adb47154fa?s=128&d=identicon&r=PG&f=1", "display_name": "cmdLP", "link": "https://stackoverflow.com/users/7610883/cmdlp"}, "edited": false, "score": 0, "creation_date": 1515521653, "post_id": 48173876, "comment_id": 83328221, "body": "You cast the value <code>0xFFFFFFFFFFFF</code> to a float, the compiler converts this, it does not <code>reinterpret_cast</code> the variable. Do you notice, that <code>0xFFFFFFFFFFFF</code> is not an even number as its representation as a float <code>281474976710656.000000</code> is, this is caused by the mantissa, which cannot store the least significant bits of the integer constant."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1515523237, "post_id": 48173876, "comment_id": 83329044, "body": "If a compiler insulted me, I would remove it from my system. &lt;g&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1515520342, "post_id": 48173970, "comment_id": 83327566, "body": "A float doesn&#39;t &#39;run out&#39; of precision."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1515520429, "post_id": 48173970, "comment_id": 83327607, "body": "@nicomp It has limits on what it can represent depending on how many bits are available for the significant digits. Assuming this is a <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">32-bit IEEE floating point value</a> then it&#39;s a fluke the approximation is so close to the intended value, and then only because it&#39;s all 1 bits in the original."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1515520848, "post_id": 48173970, "comment_id": 83327847, "body": "I think you want to say that when converting from a base 10 number to a base 2 number for storage in a float type you may run out of precision before the conversion is complete."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1515520118, "creation_date": 1515520118, "answer_id": 48173970, "question_id": 48173876, "link": "https://stackoverflow.com/questions/48173876/size-of-a-float-variable-and-compilation/48173970#48173970", "title": "Size of a float variable and compilation", "body": "<p>This doesn't store \"8 bytes\" of data, that value gets converted to an integer by the compiler, then converted to a <code>float</code> for assignment:</p>\n\n<pre><code>float someFloatNumb = 0xFFFFFFFFFFFF; // 6 bytes of data\n</code></pre>\n\n<p>Since <code>float</code> can represent large values, this isn't a big deal, but you will lose a lot of precision if you're only using 32-bit floats. Notice there's a slight but important difference here:</p>\n\n<pre><code>float value = 281474976710656.000000;\nint value   = 281474976710655;\n</code></pre>\n\n<p>This is because <code>float</code> becomes an approximation when it runs out of precision.</p>\n\n<p>Capacities don't \"grow\" for standard C types. You'll have to use a <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">\"bignum\" library</a> for that.</p>\n"}, {"comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1515522420, "post_id": 48174034, "comment_id": 83328606, "body": "0xFFFF FFFF FFFF +1 == 0x1 0000 0000 0000, you omitted a zero in your equation."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1515522515, "post_id": 48174034, "comment_id": 83328647, "body": "@nicomp True, fixed. Thanks for the catch."}, {"owner": {"reputation": 123, "user_id": 7973514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1aM5G.jpg?s=128&g=1", "display_name": "Pythalex", "link": "https://stackoverflow.com/users/7973514/pythalex"}, "edited": false, "score": 0, "creation_date": 1515523167, "post_id": 48174034, "comment_id": 83329002, "body": "I have a question, why would the value be incremented when a float is initialized with this value ?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1515523358, "post_id": 48174034, "comment_id": 83329104, "body": "It is not incremented, it ends up one higher because the representation can only get as close as off-by-one to the attempted value."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 0, "last_activity_date": 1515523508, "last_edit_date": 1515523508, "creation_date": 1515520341, "answer_id": 48174034, "question_id": 48173876, "link": "https://stackoverflow.com/questions/48173876/size-of-a-float-variable-and-compilation/48174034#48174034", "title": "Size of a float variable and compilation", "body": "<p>0xFFFFFFFFFFFF == 281474976710655</p>\n\n<p>If you init a float with that value, it will end up being<br>\n0xFFFFFFFFFFFF +1 == 0x1000000000000 == 281474976710656 == 1&lt;&lt;48</p>\n\n<p>That fits easily in a 4byte float, simple mantisse, small exponent.<br>\nIt does however NOT store the correct value (one lower) because that IS hard to store in a float.</p>\n\n<p>Note that the \" +1\" does not imply incrementation. It ends up one higher because the representation can only get as close as off-by-one to the attempted value. You may consider that \"rounding up to the next power of 2 mutliplied by whatever the mantisse can store\". Mantisse, by the way, usually is interpreted as a fraction between 0 and 1.<br>\nGetting closer would indeed require the 48 bits of your initialisation in the mantisse; plus whatever number of bits would be used to store the exponent; and maybe a few more for other details.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1515532045, "last_edit_date": 1515532045, "creation_date": 1515521963, "answer_id": 48174419, "question_id": 48173876, "link": "https://stackoverflow.com/questions/48173876/size-of-a-float-variable-and-compilation/48174419#48174419", "title": "Size of a float variable and compilation", "body": "<p>1)</p>\n\n<blockquote>\n  <p>Does sizeof(variable) simply get the variable type and return sizeof(type), which in this case would explain the result ?</p>\n</blockquote>\n\n<p>Except for <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">variable-length arrays</a>, <code>sizeof</code> doesn't evaluate its operand. So yes, all it cares is the type. So <code>sizeof(someFloatNumb)</code> is 4 which is equivalent to <code>sizeof(float)</code>. This explains <code>printf(\"%i\\n\", sizeof(someFloatNumb));</code>.</p>\n\n<p>2)</p>\n\n<blockquote>\n  <p>[..] But I can still store a 8 bytes real value in a float, and my compiler says nothing about it.\n  Does/Can gcc grow the capacity of a type ? (managing multiple variables behind the curtains to allow us that sort of things)</p>\n</blockquote>\n\n<p>No. Capacity doesn't grow. You simply misunderstood how floats are represented/stored. <code>sizeof(float)</code> being 4 doesn't mean\nit can't store more than 2^32 (assuming 1 byte == 8 bits). See <a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic#Internal_representation\" rel=\"nofollow noreferrer\">Floating point representation</a>.\nWhat the maximum value of a <code>float</code> can represent is defined by the constant <code>FLT_MAX</code> (see <code>&lt;float.h&gt;</code>). <code>sizeof(someFloatNumb)</code> simply yields how many bytes the object (<code>someFloatNumb</code>) takes up in memory which isn't necessarily equal to the <em>range</em> of values it can represent.\nThis explains why <code>printf(\"%f\\n\", someFloatNumb);</code> prints the value as expected (and there's no automatic \"capacity growth\").</p>\n\n<p>3)</p>\n\n<blockquote>\n  <p>printf(\"%i\\n\", sizeof(281474976710656));</p>\n</blockquote>\n\n<p>This is slightly more involved. As said before in (1), <code>sizeof</code> only cares about the type here. But the type of <code>281474976710656</code> is not necessarily <code>int</code>.\nThe C standard defines the <em>type</em> of integer constants according to the smallest type that can represent the value. See <a href=\"https://stackoverflow.com/a/42115024/1275169\">https://stackoverflow.com/a/42115024/1275169</a> for an explanation.</p>\n\n<p>On my system <code>281474976710656</code> can't be represented in an <code>int</code> and it's stored in a <code>long int</code> which is likely to be case on your system as well. So what you see is essentially equivalent to <code>sizeof(long)</code>. </p>\n\n<p>There's no portable way to determine the <em>type</em> of integer constants. But since you are using <code>gcc</code>, you could use a little trick with <code>typeof</code>:</p>\n\n<pre><code>typeof(281474976710656) x;\nprintf(\"%s\", x); /* deliberately using '%s' to generate warning from gcc. */\n</code></pre>\n\n<p>generates:</p>\n\n<blockquote>\n  <p>warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 2\n  has type \u2018long int\u2019 [-Wformat=]\n       printf(\"%s\", x);</p>\n</blockquote>\n\n<hr>\n\n<p>P.S: <code>sizeof</code> results a <code>size_t</code> for which the correct format specifier is <code>%zu</code>. So that's what you should be using in your 1st and 3rd printf statements.</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1515533172, "creation_date": 1515533172, "answer_id": 48176877, "question_id": 48173876, "link": "https://stackoverflow.com/questions/48173876/size-of-a-float-variable-and-compilation/48176877#48176877", "title": "Size of a float variable and compilation", "body": "<blockquote>\n  <p>But I can still store a 8 bytes real value in a float, and my compiler\n  says nothing about it.</p>\n</blockquote>\n\n<p>That's not what's happening.</p>\n\n<pre><code>float someFloatNumb = 0xFFFFFFFFFFFF;\n</code></pre>\n\n<p><code>0xFFFFFFFFFFFF</code> is an integer constant. Its value, expressed in decimal, is <code>281474976710655</code>, and its type is <em>probably</em> either <code>long</code> or <code>long long</code>. (Incidentally, that value can be stored in 48 bits, but most systems don't have a 48-bit integer type, so it will probably be stored in 64 bits, of which the high-order 16 bits will be zero.)</p>\n\n<p>When you use an expression of one numeric type to initialize an object of a different numeric type, the value is <em>converted</em>. This conversion doesn't depend on the size of the source expression, only on its numeric value. For an integer-to-float conversion, the result is the closest representation to the integer value. There may be some loss of precision (and in this case, there is). Some compilers may have options to warn about loss of precision, but the conversion is perfectly valid so you probably won't get a warning by default.</p>\n\n<p>Here's a small program to illustrate what's going on:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    long long ll = 0xFFFFFFFFFFFF;\n    float f      = 0xFFFFFFFFFFFF;\n    printf(\"ll = %lld\\n\", ll);\n    printf(\"f  = %f\\n\", f);\n}\n</code></pre>\n\n<p>The output on my system is:</p>\n\n<pre><code>ll = 281474976710655\nf  = 281474976710656.000000\n</code></pre>\n\n<p>As you can see, the conversion has lost some precision. <code>281474976710656</code> is an exact power of two, and floating-point types generally can represent those exactly. There's a very small difference between the two values because you chose an integer value that's very close to one that can be represented exactly.  If I change the value:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    long long ll = 0xEEEEEEEEEEEE;\n    float f      = 0xEEEEEEEEEEEE;\n    printf(\"ll = %lld\\n\", ll);\n    printf(\"f  = %f\\n\", f);\n}\n</code></pre>\n\n<p>the apparent loss of precision is much larger:</p>\n\n<pre><code>ll = 262709978263278\nf  = 262709979381760.000000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1515666328, "creation_date": 1515666328, "answer_id": 48204781, "question_id": 48173876, "link": "https://stackoverflow.com/questions/48173876/size-of-a-float-variable-and-compilation/48204781#48204781", "title": "Size of a float variable and compilation", "body": "<p>Look at the value printed... <code>0xFFFF...FFFF</code> is an odd value, but the value printed in your example is even.  You are feeding the <code>float</code> variable with an <code>int</code> value that is converted to <code>float</code>.  The conversion is loosing precision, as expected by the value used, which doesn't fit in the 23 bits reserved to the target variable mantissa.  And finally you get an approximation with is the value <code>0x1000000....0000</code> (the next value, which is the closest value to the one you used, as posted @Yunnosch in his answer)</p>\n"}], "owner": {"reputation": 123, "user_id": 7973514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1aM5G.jpg?s=128&g=1", "display_name": "Pythalex", "link": "https://stackoverflow.com/users/7973514/pythalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 48174419, "answer_count": 5, "score": 1, "last_activity_date": 1515666328, "creation_date": 1515519724, "last_edit_date": 1515522428, "question_id": 48173876, "link": "https://stackoverflow.com/questions/48173876/size-of-a-float-variable-and-compilation", "title": "Size of a float variable and compilation", "body": "<p>I'm struggling to understand the behavior of <code>gcc</code> in this. The size of a float is of 4 bytes for my architecture. But I can still store a 8 bytes real value in a float, and my compiler says nothing about it.</p>\n\n<p>For example I have :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char** argv){\n\n    float someFloatNumb = 0xFFFFFFFFFFFF;\n    printf(\"%i\\n\", sizeof(someFloatNumb));\n    printf(\"%f\\n\", someFloatNumb);\n    printf(\"%i\\n\", sizeof(281474976710656));\n\n    return 0;\n}\n</code></pre>\n\n<p>I expected the compiler to insult me, or displaying a disclaimer of some sort, because I shouldn't be able to something like that, at least I think it's kind of twisted wizardry.</p>\n\n<p>The program simply run :</p>\n\n<pre><code>4\n281474976710656.000000\n8\n</code></pre>\n\n<p>So, if I print the size of <code>someFloatNumb</code>, I get 4 bytes, which is expected. But the affected value isn't, as seen just below.</p>\n\n<p>So I have a few questions:</p>\n\n<ul>\n<li><p>Does sizeof(variable) simply get the variable type and return sizeof(type), which in this case would explain the result?</p></li>\n<li><p>Does/Can gcc grow the capacity of a type? (managing multiple variables behind the curtains to allow us that sort of things)</p></li>\n</ul>\n"}, {"tags": ["c", "linux", "shell", "stream", "popen"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515520334, "post_id": 48173573, "comment_id": 83327564, "body": "Does <code>cmd</code> generate the data line-by-line as you expect if you run <code>cmd | cat</code>?  Or does it get batched?  Standard I/O behaves differently if standard output is a terminal compared to a pipe or a file.  Gut feel, that&#39;s your problem here.  You may have to make <code>cmd</code> flush its standard output more frequently.  It should be less of an issue if <code>cmd</code> is a shell script that has <code>echo</code> or <code>printf</code> statements, or other commands, generating the output.  But the <code>cmd | cat</code> technique will show you a lot."}, {"owner": {"reputation": 420, "user_id": 3834483, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/69d80ccee9cc947b19357d70b74e5025?s=128&d=identicon&r=PG&f=1", "display_name": "banguru", "link": "https://stackoverflow.com/users/3834483/banguru"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515521263, "post_id": 48173573, "comment_id": 83328049, "body": "I will check it with the <code>cmd|cat</code> technique as you mentioned , but need atleast 9-10 hours more as need to do that at work!"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1515567116, "post_id": 48173573, "comment_id": 83343168, "body": "The C library buffers the output from the <code>printf()</code> calls by default, because there is no newline in it. Add a <code>fflush(stdout);</code> (before the second <code>if</code> clause in the loop) to ensure everything thus far buffered is actually output, too."}], "owner": {"reputation": 420, "user_id": 3834483, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/69d80ccee9cc947b19357d70b74e5025?s=128&d=identicon&r=PG&f=1", "display_name": "banguru", "link": "https://stackoverflow.com/users/3834483/banguru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515518552, "creation_date": 1515518552, "question_id": 48173573, "link": "https://stackoverflow.com/questions/48173573/pipe-stream-obtained-from-popen-not-giving-data-as-expected", "title": "pipe stream obtained from popen not giving data as expected", "body": "<p>I have a command (say <code>cmd</code>).Below the representative output from this in a linux shell. </p>\n\n<pre><code>output line 1\noutput line 2\n.\n.\nCheckpoint 1\n.\noutput line 20\noutput line 21\n.\n.\nCheckpoint 2\nCheckpoint 3\nCheckpoint 4\n.\n.\nCheckpoint 8\n</code></pre>\n\n<p>There is considerable time difference between appearance of <code>Checkpoint 2</code> &amp; <code>Checkpoint 3</code> , <code>Checkpoint 3</code> &amp; <code>Checkpoint 4</code> etc(around 2 secs each).</p>\n\n<p>I used popen as below to execute same command and parse the output.</p>\n\n<pre><code>FILE *fp;\nint status;\nchar path[65000];\n\n\nfp = popen(\"cmd\", \"r\");\nif (fp == NULL)\n/* Handle error */;\n\n\nwhile(1) \n{    \n    while (fgets(path, PATH_MAX, fp) != NULL) \n    {\n        print(\"%s\\n\",path);\n\n        if(!strncmp(\"Checkpoint\",path,strlen(\"Checkpoint\"))\n           printf(\"Reached : %s \",path);\n\n        if(!strncmp(\"Checkpoint 8\",path,strlen(\"Checkpoint 8\"))\n            break;\n    }\n\n}\n\nstatus = pclose(fp);\nif (status == -1) {\n    /* Error reported by pclose() */\n} else {\n\n}\n</code></pre>\n\n<p>But with the logs obtained from above program (which is printed by the print statements in the program) , the Checkpoint logs appear on the screen almost simultaneously.  </p>\n\n<p>So I cant see the time difference of about 2 secs between <code>Checkpoint 2</code> &amp; <code>Checkpoint 3</code> , <code>Checkpoint 3</code> &amp; <code>Checkpoint 4</code> etc and it is almost 0. </p>\n\n<p>I really cant see what might be wrong in my code snippet which parses <code>cmd</code>  output.</p>\n"}, {"tags": ["c", "debugging", "stack-overflow"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1515518078, "post_id": 48173404, "comment_id": 83326360, "body": "Catch the crash in a debugger. Look at the function call stack. If it&#39;s full of <code>grow_Wolff_cluster</code> calls only, then you have a stack overflow."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1515518170, "post_id": 48173404, "comment_id": 83326421, "body": "recursive algorithms often produce elegant solutions, but practically they can be dangerous for these reasons, and generally should be avoided unless you&#39;re <i>sure</i> it will only recurse a safe number of times. I don&#39;t know what you&#39;re doing here, but you&#39;re probably best-served re-implementing it in a non-recursive manner."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1515518283, "post_id": 48173404, "comment_id": 83326495, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> <a href=\"https://stackoverflow.com/questions/2069367/how-to-debug-using-gdb\" title=\"how to debug using gdb\">stackoverflow.com/questions/2069367/how-to-debug-using-gdb</a> should be helpful reads. Maybe also <a href=\"https://ericlippert.com/2014/03/21/find-a-simpler-problem/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/21/find-a-simpler-problem</a> to get back to firm ground of something working reliably, then start incrementing again."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1515518354, "post_id": 48173404, "comment_id": 83326535, "body": "MOst basic method: put some printfs at strategic points of your program and see what is displayed."}, {"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 0, "creation_date": 1515518377, "post_id": 48173404, "comment_id": 83326549, "body": "yes it is full of the recursive function, it is too slow i cannot navigate to see how many of them is there. but after all i have a recursive function and i expect to see lots of the recursive function"}, {"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 0, "creation_date": 1515518574, "post_id": 48173404, "comment_id": 83326644, "body": "no need for printf, the Clion debugger says it is inside of the recursive function"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1515527040, "post_id": 48173404, "comment_id": 83330836, "body": "Successful recursive functions typically have two paths:  (1) stop recursing or (2) make progress and then recurse.  Your function seems to recurse based (at least in part) on a random number, which seems suspiciously like you have no guarantee that you&#39;re making progress toward termination and thus you might recurse until you blow the stack."}, {"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1515534657, "post_id": 48173404, "comment_id": 83334377, "body": "@Adrian McCarthy, NO! the recursive function is fine and it is working good for small problem but when problem size gets larger it blow up. and its not based on a random number!! in the if condition there is some other conditions that terminates the function(for more information you can see Ising Model Wolff single cluster allgorithm)"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1515541042, "post_id": 48173404, "comment_id": 83336609, "body": "Does every site have the same number of neighbors?  What is that number, and what is the total number of sites?  The first reference I found for the algorithm says that the cluster size can grow as large as the total number of sites in the volume.  If there&#39;s a high connectivity, then, in the worst case, the recursive depth could match the total number of sites."}, {"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1515543352, "post_id": 48173404, "comment_id": 83337204, "body": "@Adrian McCarthy, you are right the recursive depth could match the total number of sites, total number of sites is something from 30*30*30 up to 150*150*150 for my problem, and up to 80*80*80(=512000) program works fine but for larger than this stack overflows. so , for recursive depth of 512000 stack overflow is normal??!"}, {"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1515543402, "post_id": 48173404, "comment_id": 83337214, "body": "@Adrian McCarthy, yes every site have exactly 6 neighbors."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "edited": false, "score": 0, "creation_date": 1515534749, "post_id": 48173898, "comment_id": 83334419, "body": "thank I will try this, GDB is installed by default?!"}], "tags": [], "owner": {"reputation": 314, "user_id": 8182823, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-6Wl_m8HSpjY/AAAAAAAAAAI/AAAAAAAAAEM/RQdHIO7x2ew/photo.jpg?sz=128", "display_name": "QuesterDesura", "link": "https://stackoverflow.com/users/8182823/questerdesura"}, "is_accepted": true, "score": 3, "last_activity_date": 1515576433, "last_edit_date": 1515576433, "creation_date": 1515519819, "answer_id": 48173898, "question_id": 48173404, "link": "https://stackoverflow.com/questions/48173404/how-to-know-a-c-programs-stack-overflows/48173898#48173898", "title": "how to know a c program&#39;s stack overflows?", "body": "<p>Use the GDB Debugger and look at the Call Stack.</p>\n\n<pre><code>gdb main\nr\nbt\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 48173898, "answer_count": 1, "score": 1, "last_activity_date": 1515576433, "creation_date": 1515517972, "question_id": 48173404, "link": "https://stackoverflow.com/questions/48173404/how-to-know-a-c-programs-stack-overflows", "title": "how to know a c program&#39;s stack overflows?", "body": "<p>i am simulating a problem(3d Ising Model) in c but when the problem size gets larger the program stop and the below error appears :</p>\n\n<pre><code>Process finished with exit code 139 (interrupted by signal 11: SIGSEGV)\n</code></pre>\n\n<p>in the program I have a recursive function that does all the works, i suspect that the error is because of stack overflow(in the recursive function) but i do not know how to be sure.</p>\n\n<p>and if it is because of stack overflow, is there any way to solve this problem without changing program design?</p>\n\n<p>i am using Clion IDE. </p>\n\n<pre><code>/*\n * recursive function to form Wolff Cluster(= WC)\n */\nvoid grow_Wolff_cluster(lattic* l, Wolff* wolff, site *seed){\n\n    /*a neighbor of site seed*/\n    site* neighbor;\n\n    /*go through all neighbors of seed*/\n    for (int i = 0 ; i &lt; neighbors ; ++i) {\n\n\n        neighbor = seed-&gt;neighbors[i];\n\n        /*add to WC according to the Wolff Algorithm*/\n        if(neighbor-&gt;spin == seed-&gt;spin &amp;&amp; neighbor-&gt;WC == -1 &amp;&amp; ((double)rand() / RAND_MAX) &lt; add_probability)\n        {\n            wolff-&gt;Wolff_cluster[wolff-&gt;WC_pos] = neighbor;\n            wolff-&gt;WC_pos++;                  // the number of sites that is added to WC\n            neighbor-&gt;WC = 1;          // for avoiding of multiple addition of site\n            neighbor-&gt;X = 0;\n\n\n            ///controller_site_added_to_WC();\n\n\n            /*continue growing Wolff cluster(recursion)*/\n            grow_Wolff_cluster(l, wolff, neighbor);\n        }\n    }\n}\n</code></pre>\n"}]