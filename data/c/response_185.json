[{"tags": ["c", "pipe", "fork", "unistd.h"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532564776, "post_id": 51529099, "comment_id": 90027010, "body": "the sequence of read/write operations is not correct."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532564837, "post_id": 51529099, "comment_id": 90027018, "body": "when calling <code>fork()</code> there are three kinds of returns, but the posted code is only checking the &#39;child&#39; return."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532565067, "post_id": 51529099, "comment_id": 90027057, "body": "regarding: <code>for(int i = 0; i &lt; n; i++){         n = fork();</code>  this is modifying the value in <code>n</code> every time through the loop.  <code>n</code> will be -1 or 0 or some large number.  Suggest using a different variable (with a type of <code>pid_t</code>) for the returned value from <code>fork()</code>,  Suggest keeping an array of the values returned from <code>fork()</code> to make it easy to gather all the sub processes"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532565257, "post_id": 51529099, "comment_id": 90027090, "body": "The question is about a run time problem.  When asking about a run time problem, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can help you correct the problem."}, {"owner": {"reputation": 126, "user_id": 5590273, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/932199136859670/picture?type=large", "display_name": "Jaden Wang", "link": "https://stackoverflow.com/users/5590273/jaden-wang"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532566056, "post_id": 51529099, "comment_id": 90027223, "body": "Regarding comment 1: What is the correct sequence of operations? 2: What would belong in the parent? 3: Got it, thanks."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532567550, "post_id": 51529099, "comment_id": 90027484, "body": "You stated you do not want a full answer, so I just pointed out some problems, not how to fix them"}, {"owner": {"reputation": 126, "user_id": 5590273, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/932199136859670/picture?type=large", "display_name": "Jaden Wang", "link": "https://stackoverflow.com/users/5590273/jaden-wang"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532567923, "post_id": 51529099, "comment_id": 90027557, "body": "Thanks, so other than the order of read and write, the rest should be correct?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532671471, "post_id": 51529099, "comment_id": 90070354, "body": "Have your read all the comments?  Each one is about some problem in the posted code.  Just fixing the order of activities is only one of the problems."}], "owner": {"reputation": 126, "user_id": 5590273, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/932199136859670/picture?type=large", "display_name": "Jaden Wang", "link": "https://stackoverflow.com/users/5590273/jaden-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 599, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532561981, "creation_date": 1532561981, "question_id": 51529099, "link": "https://stackoverflow.com/questions/51529099/c-read-and-write-between-parent-and-multiple-child-processes", "title": "C: Read and write between parent and multiple child processes", "body": "<p>Say I have a function called <code>worker(int in, int out)</code> that performs some task based on the given <code>in</code> file descriptor and takes the result and writes it to <code>out</code>. </p>\n\n<p>It might look something like:</p>\n\n<pre><code>while (read(in, buffer, some_max_length) &gt; 0){\n    // Do something with buffer\n    .\n    .\n    write(out, some_other_info, some_size);\n} \n</code></pre>\n\n<p>Say I also have a main process that spawns a variable amount of processes that might look something like:</p>\n\n<pre><code>// Assume I have done error checking.\narray_of_write_pipes[n][2];\narray_of_read_pipes[n][2]; // Assume these have already been populated.\n\nwhile(there is a word from stdin){\n    // Spawn n processes \n    for(int i = 0; i &lt; n; i++){\n        n = fork();\n        if(n == 0){\n            write(array_of_read_pipes[i][1], some_data, some_max_length);\n            worker(some_other_data, array_of_read_pipes[i][0], array_of_write_pipes[i][1]);\n            exit(0);\n        }\n    }\n\n    // Block of code waiting for all children to terminate.\n\n    // Collect the results of each child process\n\n    for(i = 0; i &lt; n; i++){\n        while (read(array_of_write_pipes[i][0], buffer, some_max_length) &gt; 0){\n            // Do something with buffer\n            .\n            .\n\n        } \n    }\n}\n</code></pre>\n\n<p>At the moment, it seems to hang.</p>\n\n<p>My end goal is to have the main process send the same word to each child process. Each child process then performs the task via <code>worker()</code>. Then, the child process sends its results back to the main process for further processing.</p>\n\n<p>At this moment, I'm not even sure if I'm even remotely going in the right direction. \nI tried to keep this question as general as possible except for the parts dealing with piping. If I'm missing any information, please let me know. Just a disclaimer, this is a homework related problem and I do <strong>not</strong> want the full answer, just whether or not my thought process is correct. If not, what am I missing?</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1532560918, "post_id": 51528890, "comment_id": 90026272, "body": "I think <code>fgetc(stdin)</code> leaves the newline character in the buffer."}, {"owner": {"reputation": 11, "user_id": 10108886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QtH8aWGxEIc/AAAAAAAAAAI/AAAAAAAALLo/LJ44cV-YM_Y/photo.jpg?sz=128", "display_name": "Nguyen Silver Dude Hoa", "link": "https://stackoverflow.com/users/10108886/nguyen-silver-dude-hoa"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1532562647, "post_id": 51528890, "comment_id": 90026612, "body": "Should I change fgetc to fgets or gets ?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532565510, "post_id": 51528890, "comment_id": 90027128, "body": "the function: <code>fgetc()</code> returns an <code>int</code>, not a char."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532565779, "post_id": 51528890, "comment_id": 90027176, "body": "OT:  <code>gets()</code> has been depreciated for years and completely removed from the latest C standard.  I.E. NEVER use <code>gets()</code>"}, {"owner": {"reputation": 11, "user_id": 10108886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QtH8aWGxEIc/AAAAAAAAAAI/AAAAAAAALLo/LJ44cV-YM_Y/photo.jpg?sz=128", "display_name": "Nguyen Silver Dude Hoa", "link": "https://stackoverflow.com/users/10108886/nguyen-silver-dude-hoa"}, "edited": false, "score": 0, "creation_date": 1532568992, "post_id": 51528890, "comment_id": 90027758, "body": "Hello, so now I replace the response = fgetc(stdin) with scanf(&quot;%c&quot;, response).  It give me the error of segmentation fault (11)"}, {"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 1, "creation_date": 1532570988, "post_id": 51528890, "comment_id": 90028176, "body": "Your root process never communicates <code>response</code> or <code>n</code>.  Thus, they are all uninitialized garbage on the other ranks.  Your output condition is also <code>rank != 0 &amp;&amp; rank == 0</code>"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1532701047, "post_id": 51528890, "comment_id": 90086580, "body": "<b>all</b> the ranks must invoke <code>MPI_Reduce(..., MPI_COMM_WORLD)</code> (and they should likely participate to the computation too)"}], "answers": [{"tags": [], "owner": {"reputation": 332, "user_id": 9500333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David Daverio", "link": "https://stackoverflow.com/users/9500333/david-daverio"}, "is_accepted": false, "score": 0, "last_activity_date": 1532831917, "creation_date": 1532831917, "answer_id": 51576783, "question_id": 51528890, "link": "https://stackoverflow.com/questions/51528890/program-does-not-take-input-from-user-to-loop-itself-again/51576783#51576783", "title": "Program does not take input from user to loop itself again.", "body": "<p>It behave as it should from what you coded :-).\nThe comment from ptb is the answer of your question.... But lets do it :-).</p>\n\n<pre><code>while (response == 'y')\n{\n  if (rank == 0)\n  {  /*I am root node*/\n     printf(\"__________________________________\\n\");\n     printf(\"\\nEnter the number of intervals: (0 will exit)\\n\");\n     n = fgetc(stdin);\n  }\n  /* here we have to: broadcast to all processes the value of response\n     in fact all processes have to wait that root get the new value and then\n     get this value from the root. Fortunately MPI_Broadcast is a blocking\n     opperation, so no MPI_Barrier are needed...*/\n  MPI_Bcast(&amp;n,1,MPI_INT,0,MPI_COMM_WORLD);\n\n  /* then your computation is done by every processes (in fact in your interval\n     boundaries you indeed take that process 0 has the first interval... i am not \n     sure your math a correct, I did not check them) */\n\n  int_size = 1.0 / (double) n;                  //calcs interval size\n  part_sum = 0.0;\n\n  for (i = rank * n / num_proc; i &lt;= (rank + 1)* n / num_proc; i += 1)\n  {                                                         //calcs partial sums\n    x = int_size * ((double)i - 0.5);\n    part_sum += (4.0 / (1.0 + x*x));\n  }\n  temp_pi = int_size * part_sum;\n  //collects all partial sums computes pi\n  MPI_Reduce(&amp;temp_pi,&amp;calc_pi, 1, MPI_DOUBLE, MPI_SUM, 0, MPI_COMM_WORLD);\n\n  if (rank == 0)\n  {                                                     /*I am server*/\n     printf(\"pi is approximately %f\", calc_pi);\n     printf(\". Error is %f\", fabs(calc_pi - actual_pi));\n     printf(\"\\n\");\n     printf(\"_______________________________________\");\n     printf(\"\\n\");\n  }\n\n  if (rank == 0)\n  { /*I am root node*/\n    printf(\"\\nCompute with new intervals? (y/n)\\n\");\n    response = fgetc(stdin);\n  }\n  /* here we have to: broadcast to all processes the value of response\n     in fact all processes have to wait that root get the new value and then\n     get this value from the root. Fortunately MPI_Broadcast is a blocking\n     opperation, so no MPI_Barrier are needed..., lol same than with n...*/\n  MPI_Bcast(&amp;response,1,MPI_CHAR,0,MPI_COMM_WORLD);    \n} //end while\n</code></pre>\n\n<p>I did not try to compile... so there is maybe some typos...</p>\n"}], "owner": {"reputation": 11, "user_id": 10108886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QtH8aWGxEIc/AAAAAAAAAAI/AAAAAAAALLo/LJ44cV-YM_Y/photo.jpg?sz=128", "display_name": "Nguyen Silver Dude Hoa", "link": "https://stackoverflow.com/users/10108886/nguyen-silver-dude-hoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532831917, "creation_date": 1532560299, "question_id": 51528890, "link": "https://stackoverflow.com/questions/51528890/program-does-not-take-input-from-user-to-loop-itself-again", "title": "Program does not take input from user to loop itself again.", "body": "<p>I have this code down here and it working for calculating but it does not take the input of the user to do the loop again and calculate for the user again or cancel.  the function is near the end with if(rank == 0) { ... }.  I need help figure out what am I missing    </p>\n\n<pre><code>#include &lt;math.h&gt; //include files\n#include &lt;stdio.h&gt;\n#include \"mpi.h\"\n\nvoid printit()\n{\n   printf(\"\\n*********************************\\n\");\n   printf(\"Welcome to the pi calculator!\\n\");\n   printf(\"Programmer: K. Spry\\n\");\n   printf(\"You set the number of divisions\\n\");\n   printf(\"for estimating the integral: \\n\\tf(x)=4/(1+x^2)\");\n   printf(\"\\n\");\n   printf(\"*********************************\\n\");\n}                      //end printit\n                                                          //function prototypes\n\nint main(int argc, char* argv[])\n{\n   double actual_pi = 3.141592653589793238462643;\n                                                                               //for comparison later\n   int n, rank, num_proc, i;\n   double temp_pi, calc_pi, int_size, part_sum, x;\n   char response = 'y';\n   MPI_Init(&amp;argc, &amp;argv);\n   MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n   MPI_Comm_size(MPI_COMM_WORLD, &amp;num_proc);\n   if (rank == 0)\n   {\n        printit();\n   }             /* I am root node, print out welcome */\n\n   while (response == 'y')\n   {\n      if (rank == 0)\n      {            /*I am root node*/\n         printf(\"__________________________________\\n\");\n         printf(\"\\nEnter the number of intervals: (0 will exit)\\n\");\n         n = fgetc(stdin);\n      }\n\n      else\n      {\n         int_size = 1.0 / (double) n;                  //calcs interval size\n         part_sum = 0.0;\n\n         for (i = rank * n / num_proc; i &lt;= (rank + 1)* n / num_proc; i += 1)\n         {                                                         //calcs partial sums\n              x = int_size * ((double)i - 0.5);\n              part_sum += (4.0 / (1.0 + x*x));\n         }\n         temp_pi = int_size * part_sum;\n                                       //collects all partial sums computes pi\n\n         MPI_Reduce(&amp;temp_pi,&amp;calc_pi, 1, MPI_DOUBLE, MPI_SUM, 0, MPI_COMM_WORLD);\n         if (rank == 0)\n         {                                                     /*I am server*/\n            printf(\"pi is approximately %f\", calc_pi);\n            printf(\". Error is %f\", fabs(calc_pi - actual_pi));\n            printf(\"\\n\");\n            printf(\"_______________________________________\");\n            printf(\"\\n\");\n         }\n      }                                                                        //end else\n     if (rank == 0)\n     { /*I am root node*/\n        printf(\"\\nCompute with new intervals? (y/n)\\n\");\n        response = fgetc(stdin);\n     }\n   } //end while\n   MPI_Finalize();                                             //terminate MPI\n   return 0;\n}\n</code></pre>\n\n<p>The problem I have is with the if inside the loop while that ask user to Compute with new intervals and user will input Y or N to response.  The problem is when users do input, it stop working and never loop.  </p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532558675, "post_id": 51528455, "comment_id": 90025786, "body": "<code>&amp;word[0]</code> can be written as just <code>word</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1532558769, "post_id": 51528455, "comment_id": 90025815, "body": "<code>hash_table</code> is an array of pointers. Did you ever initialize them to point to nodes?"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1532560465, "post_id": 51528455, "comment_id": 90026186, "body": "@FranklinEstein Couple of issues: your <code>hash()</code> function could probably use a bit of a rewrite.  As it is right now, its result will only ever depend on the first letter of the word.  Secondly if you&#39;re inside GDB when it crashes, use the <code>bt</code> command to print a stack backtrace.  Assuming your debug options to the compiler are set correctly, that&#39;ll tell you (A) where you crashed, and (B) how you got there."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1532562203, "post_id": 51528455, "comment_id": 90026515, "body": "<code>bool loaded = &amp;load;</code> is legal, but it makes no sense. <code>&amp;load</code> is the address of the <code>load</code> function (it&#39;s not called). That address is non-null, so converting it to <code>bool</code> simply yields <code>true</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1532562241, "post_id": 51528455, "comment_id": 90026525, "body": "Please show us a complete program. The code currently in your question has no <code>#include</code> directives and no <code>main</code> function. Read this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1532562331, "post_id": 51528455, "comment_id": 90026544, "body": "Incidentally, the &quot;No such file or directory&quot; message is not relevant. It just means that your program crashed in the runtime library, and gdb was unable to see the library source code. It&#39;s the segmentation fault that&#39;s relevant -- and gdb should be able to tell you where in your own code it occurred. (Try the <code>where</code> command after you get that message.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1532562399, "post_id": 51528455, "comment_id": 90026562, "body": "<code>if (loaded == true)</code> is more clearly written as <code>if (loaded)</code>"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1532563043, "post_id": 51528455, "comment_id": 90026695, "body": "Crashes inside of malloc(), in my experience, generally point to memory corruption done on the buffers it allocates - things like writing before or after your allocated buffer.  Make sure your array writes aren&#39;t going past the beginning/end of arrays.  Assert that your hash is indeed returning a value in range..."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1532563175, "post_id": 51528455, "comment_id": 90026721, "body": "assert that length &gt;= 26 too..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1532563395, "post_id": 51528455, "comment_id": 90026759, "body": "@dgnuff The <code>load()</code> function never assigns anything to <code>hash_table[hash(new_node-&gt;word)]</code>. It assumes this is already populated with the head of a linked list."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532563491, "post_id": 51528455, "comment_id": 90026776, "body": "@Barmar You&#39;re right.  It <i>reads</i> the hash table, but doesn&#39;t <i>write</i> it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1532563575, "post_id": 51528455, "comment_id": 90026795, "body": "@dgnuff But I just realized that the hash table is a global variable, so it&#39;s initialized to all null pointers automatically."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1532563692, "post_id": 51528455, "comment_id": 90026814, "body": "Yup.  failure to populate the table is not going to cause UB because the OP is doing a good job of checking pointers for <code>NULL</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532565770, "post_id": 51528455, "comment_id": 90027174, "body": "Memory leaks don&#39;t cause segmentation faults. You probably have a buffer overflow somewhere."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532565822, "post_id": 51528455, "comment_id": 90027182, "body": "Read <a href=\"https://stackoverflow.com/questions/33047452/definitive-list-of-common-reasons-for-segmentation-faults\">Definitive list of common reasons for segmentation faults</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532566434, "post_id": 51528455, "comment_id": 90027290, "body": "regarding: <code>if (&amp;load)</code>  This will ALWAYS evaluate to <code>true</code>,  probably not what you want"}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1532566459, "post_id": 51528455, "comment_id": 90027297, "body": "What have you done that main isn&#39;t in the backtrack?"}, {"owner": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532566644, "post_id": 51528455, "comment_id": 90027331, "body": "@user3629249 what should I do instead?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532567371, "post_id": 51528455, "comment_id": 90027439, "body": "I don&#39;t know what you were trying to accomplish with that <code>if (&amp;load)</code> statement, so I cannot advise you"}, {"owner": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532568614, "post_id": 51528455, "comment_id": 90027688, "body": "@user3629249 I want the equivalent of if(load == true)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1532572575, "post_id": 51528455, "comment_id": 90028500, "body": "Understand, instead of <code>unsigned int hash(const char word[LENGTH + 1])</code>, it perfectly fine (and more readable) to simply use a pointer as the parameter, e.g. <code>unsigned int hash(const char *word)</code>, and similarly <code>int x = atoi(&amp;word[0]);</code> is simply <code>int x = atoi(word);</code>. On access, an array is converted to a pointer to its first element."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532671326, "post_id": 51528455, "comment_id": 90070313, "body": "<code>load</code> is the name of one of the functions in your posted code.  So it will always have a value (its&#39; address) so the condition will ALWAYS be true"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "edited": false, "score": 0, "creation_date": 1532565444, "post_id": 51529327, "comment_id": 90027120, "body": "Thank you very much, but the segmentation fault still occurs. I will add an update of the corresponding file."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "edited": false, "score": 0, "creation_date": 1532565681, "post_id": 51529327, "comment_id": 90027152, "body": "I said I didn&#39;t think this was the cause of the fault. The problem is somewhere else, it corrupted memory, and caused the error to happen during this function."}, {"owner": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "edited": false, "score": 0, "creation_date": 1532565892, "post_id": 51529327, "comment_id": 90027202, "body": "Yes, I know, but valgrind for some reason says that the total heap usage was 0 allocs, 0 frees, 0 bytes allocated..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "edited": false, "score": 0, "creation_date": 1532565920, "post_id": 51529327, "comment_id": 90027207, "body": "There are other ways to cause memory corruption."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1532564059, "creation_date": 1532564059, "answer_id": 51529327, "question_id": 51528455, "link": "https://stackoverflow.com/questions/51528455/c-segmentation-fault-malloc-c-no-such-file-or-directory/51529327#51529327", "title": "C Segmentation fault malloc.c: No such file or directory", "body": "<p>There are several problems in the <code>load()</code> function, but I'm not sure they're responsible for the segmentation fault.</p>\n\n<ol>\n<li><p>You're calling <code>hash(new_node-&gt;word)</code> before you copy from <code>word</code> into <code>new_node-&gt;word</code>. You should hash <code>word</code> instead.</p></li>\n<li><p>You're never actually putting the new node into the hash table. You're setting <code>head</code> to the new node after you link it to the old head, but the hash table still points to the old head.</p></li>\n</ol>\n\n<p>Updated code:</p>\n\n<pre><code>// Loads dictionary into memory, returning true if successful else false\nbool load(const char *dictionary)\n{\n    char word[LENGTH + 1];\n    FILE *dictionary_file = fopen(dictionary, \"r\");\n    if (dictionary_file == NULL)\n    {\n        unload ();\n        return false;\n    }\n\n    while (fscanf(dictionary_file, \"%s\", word) != EOF)\n    {\n        //allocate memory for node\n        node *new_node = malloc(sizeof(node));\n        if (new_node == NULL)\n        {\n            unload();\n            return false;\n        }\n\n        //insert node into linked list\n        int hashcode = hash(word);\n        node *head = hash_table[hashcode];\n\n        //place word in node\n        strcpy(new_node-&gt;word, word);\n\n        //connect nodes\n        new_node-&gt;next = head;\n        hash_table[hashcode] = new_node;\n    }\n    fclose(dictionary_file);\n    return true;\n}\n</code></pre>\n\n<p>I don't see anything in the code you posted that would cause a segmentation fault, so you probably have undefined behavior in some other code that you didn't include. Use a tool like <code>valgrind</code> to help find it.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1532566796, "creation_date": 1532566796, "answer_id": 51529565, "question_id": 51528455, "link": "https://stackoverflow.com/questions/51528455/c-segmentation-fault-malloc-c-no-such-file-or-directory/51529565#51529565", "title": "C Segmentation fault malloc.c: No such file or directory", "body": "<p>regarding: </p>\n\n<pre><code>const char *dictionary;\nFILE *dictionary_file = fopen(dictionary, \"r\");\n</code></pre>\n\n<p>(probably the cause of the seg fault)  </p>\n\n<p>the pointer <code>dictionary</code> is not initialized before being passed to <code>fopen()</code></p>\n\n<p>so the code is trying to read from some 'random' location in memory for some 'random' number of bytes (until a NUL byte is encountered) to try to obtain the name of the file to be opened.</p>\n\n<p>OT:  when calling C library functions, like <code>fopen()</code>, always follow the call with a check for any errors.</p>\n\n<p>When compiling, always enable the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )</p>\n"}], "owner": {"reputation": 11, "user_id": 10135963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ia5B1w4boa8/AAAAAAAAAAI/AAAAAAAAAAw/2DXABY0a3jQ/photo.jpg?sz=128", "display_name": "Franklin Estein", "link": "https://stackoverflow.com/users/10135963/franklin-estein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7432, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1613606475, "creation_date": 1532557111, "last_edit_date": 1532565786, "question_id": 51528455, "link": "https://stackoverflow.com/questions/51528455/c-segmentation-fault-malloc-c-no-such-file-or-directory", "title": "C Segmentation fault malloc.c: No such file or directory", "body": "<p>Here is my code: </p>\n\n<pre><code>// Implements a dictionary's functionality\n\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"dictionary.h\"\n\n// Maximum length for a word\n#define LENGTH 45\n\n//define struct node\ntypedef struct node\n{\n    char word[LENGTH + 1];\n    struct node *next;\n}\nnode;\n\n//hash function\nunsigned int hash(const char word[LENGTH + 1])\n{\n    int x = atoi(&amp;word[0]);\n    int y;\n    if(isupper(word[0]))\n    {\n        y = (x + 13) % 26;\n    }\n    if(islower(word[0]))\n    {\n        y = (x + 7) % 26;\n    }\n    if(isalpha(word[0]) == 0)\n    {\n        return 0;\n    }\n    return y;\n}\n\n//make a hash table of linked lists\nnode* hash_table[26];\n\n// Returns true if word is in dictionary else false\nbool check(const char *word)\n{\n    node *head = hash_table[hash(word)];\n    node *cursor = head;\n    while (cursor != NULL)\n    {\n        if (strcasecmp(word, cursor-&gt;word) == 0)\n        {\n            return true;\n        }\n        cursor = cursor-&gt;next;\n    }\n    return false;\n}\n\n// Loads dictionary into memory, returning true if successful else false\nbool load(const char *dictionary)\n{\n    char word[LENGTH + 1];\n    FILE *dictionary_file = fopen(dictionary, \"r\");\n    if (dictionary_file == NULL)\n    {\n        unload ();\n        return false;\n    }\n\n    while (fscanf(dictionary_file, \"%s\", word) != EOF)\n    {\n        //allocate memory for node\n        node *new_node = malloc(sizeof(node));\n        if (new_node == NULL)\n        {\n            unload();\n            return false;\n        }\n\n        //insert node into linked list\n        int index = hash(word);\n        node *head = hash_table[hash(word)];\n\n        //place word in node\n        strcpy(new_node-&gt;word, word);\n\n        //connect nodes\n        new_node-&gt;next = head;\n        hash_table[index] = new_node;\n        }\n    fclose(dictionary_file);\n    return true;\n}\n\n// Returns number of words in dictionary if loaded else 0 if not yet loaded\nunsigned int size(void)\n{\n    int sum = 0;\n    if (&amp;load)\n    {\n        char word[LENGTH + 1];\n        const char *dictionary;\n        FILE *dictionary_file = fopen(dictionary, \"r\");\n        while (fscanf(dictionary_file, \"%s\", word) != EOF)\n        {\n            sum++;\n        }\n    }\n    return sum;\n}\n\n// Unloads dictionary from memory, returning true if successful else false\nbool unload(void)\n{\n    char word[LENGTH + 1];\n    node *head = hash_table[hash(word)];\n    node *cursor = head;\n\n    while (cursor != NULL)\n    {\n        node *temp = cursor;\n        cursor = cursor-&gt;next;\n        free(temp);\n    }\n\n    if (cursor == NULL)\n    {\n        return true;\n    }\n    else\n    {\n       return false;\n    }\n}\n</code></pre>\n\n<p>When I run it through the GDB, I get this message that indicates a segmentation fault: </p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n_int_malloc (av=0x7ffff728d760 &lt;main_arena&gt;, bytes=56) at malloc.c:3777\n3777    malloc.c: No such file or directory.\n</code></pre>\n\n<p>Here is the GDB response when I type \"where\":</p>\n\n<pre><code>#0  _int_malloc (av=0x7ffff728d760 &lt;main_arena&gt;, bytes=56) at malloc.c:3777\n#1  0x00007ffff6f4dae0 in __GI___libc_malloc (bytes=56) at malloc.c:2893\n#2  0x0000000000422abf in load (dictionary=0x382e332d6e696168 &lt;error: Cannot access memory at address 0x382e332d6e696168&gt;)\n    at dictionary.c:66\n#3  0x722d72656c69706d in ?? ()\n#4  0x61732f62696c2f74 in ?? ()\n#5  0x5f72657a6974696e in ?? ()\n#6  0x732f6e6f6d6d6f63 in ?? ()\n#7  0x72657a6974696e61 in ?? ()\n#8  0x632e7367616c665f in ?? ()\n#9  0x6165720000000063 in ?? ()\n#10 0x0063632e31720064 in ?? ()\n#11 0x2828000000000000 in ?? ()\n#12 0x5f76625f706d7421 in ?? ()\n#13 0x287469427465672e in ?? ()\n#14 0x6c00292929786469 in ?? ()\n#15 0x6c6f6f742d6d766c in ?? ()\n</code></pre>\n\n<p>Does anyone have an idea of why the segmentation fault arises? When I run the program through valgrind, the system indicates that no memory has been leaked. Does anyone have an idea of how to fix this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20825, "user_id": 892629, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fe7fca180a7f092bcbf8236611b81029?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/892629/david"}, "edited": false, "score": 0, "creation_date": 1532555565, "post_id": 51528204, "comment_id": 90024951, "body": "Did you try running it to see if it works?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1532555689, "post_id": 51528204, "comment_id": 90024994, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8625740/how-do-i-define-and-pass-in-a-file-name-to-fopen-from-command-line\">How do I define and pass in a file name to fopen() from command line?</a>"}, {"owner": {"reputation": 11, "user_id": 9135069, "user_type": "registered", "profile_image": "https://graph.facebook.com/2064243303822953/picture?type=large", "display_name": "Martin \u0160imara", "link": "https://stackoverflow.com/users/9135069/martin-%c5%a0imara"}, "reply_to_user": {"reputation": 20825, "user_id": 892629, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fe7fca180a7f092bcbf8236611b81029?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/892629/david"}, "edited": false, "score": 1, "creation_date": 1532555765, "post_id": 51528204, "comment_id": 90025024, "body": "@David Of course... I&#39;m asking &#39;cause ti doesn&#39;t work"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1532555782, "post_id": 51528204, "comment_id": 90025027, "body": "The user shouldn&#39;t escape the backslash. You only need to do that in source code."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1532557392, "post_id": 51528204, "comment_id": 90025510, "body": "While I won&#39;t start a religious war over the relative merits of <code>char* path;</code> and <code>char *path;</code> it&#39;s fairly clear that the desire is for all four variables to be pointers.  In that case, this code will exhibit undefined behavior when executing the two <code>scanf()</code> statements.  Also, using the same variable name for two different variables, e.g. <code>name1</code> is probably not going to work as desired."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1532561123, "post_id": 51528204, "comment_id": 90026309, "body": "You can&#39;t do this, because variable names in C only exist in your code, not in the compiled program. I assume that you want the user to input the file name later and be able to get the corresponding <code>FILE*</code> based on that name. For that, you need to create some sort of lookup table. You would use an <code>std::map</code> in C++, but I&#39;m not sure how this would be done in C."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1532597806, "post_id": 51528204, "comment_id": 90038808, "body": "<i>char* name1, name2, path1, path2;</i> A perfect example of why defining more than one variable on a line is generally a very bad idea.  That declares <b>one</b> <code>char *</code> - <code>name1</code>, and <b>three</b> plain <code>char</code> variables.  <code>name2</code>, <code>path1</code>, and <code>path2</code> are all simple <code>char</code> variables.  Stuffing as much code as you can onto one line is generally a very bad idea - unless you like to hide bugs."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 4, "last_activity_date": 1532555953, "creation_date": 1532555953, "answer_id": 51528286, "question_id": 51528204, "link": "https://stackoverflow.com/questions/51528204/custom-file-name-in-c/51528286#51528286", "title": "Custom FILE name in C", "body": "<p>Escape sequences aren't processed in data that's read from a stream, so the user should type <code>c:\\file.txt</code>, not <code>c:\\\\file.txt</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1532597108, "post_id": 51535354, "comment_id": 90038411, "body": "Perhaps reading this <a href=\"https://stackoverflow.com/questions/9449241/where-is-path-max-defined-in-linux\">question/answer</a> would be better that using your own <code>MAX_PATH</code>. Also change <code>scanf</code> to ensure that no buffer overruns"}], "tags": [], "owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "is_accepted": false, "score": 1, "last_activity_date": 1532597114, "last_edit_date": 1532597114, "creation_date": 1532596934, "answer_id": 51535354, "question_id": 51528204, "link": "https://stackoverflow.com/questions/51528204/custom-file-name-in-c/51535354#51535354", "title": "Custom FILE name in C", "body": "<p>You have problem with all strings:</p>\n\n<pre><code>char* name1, name2, path1, path2;\n</code></pre>\n\n<p><code>name1</code> is uninitialized pointer,  <code>name2</code>, <code>path1</code> and <code>path2</code> are single characters variables.</p>\n\n<p>I guess it should be something like this:</p>\n\n<pre><code>#define MAX_NAME 40\n#define MAX_PATH 255 \nchar name1[MAX_NAME], name2[MAX_NAME], path1[MAX_PATH], path2[MAX_PATH];\n</code></pre>\n\n<p>Another issue: </p>\n\n<pre><code>FILE* name1;\nFILE* name2;\n</code></pre>\n\n<p><code>name1</code> and <code>name2</code> are declared in the same scope, so I guess you get an \"Already defined\" error.</p>\n\n<p>So, if you want to attached name and path to a <code>FILE*</code>, the best way to do so is to use a <code>struct</code> as follows:</p>\n\n<pre><code>typedef struct File_t\n{\n  char name[MAX_NAME];\n  char path[MAX_PATH];\n  FILE* file;\n};\n\nFile_t file1, file2;\nscanf(\"%s, %s\", file1.name, file1.path);\nfile1.file = fopen(file1.path, \"a+\");\n\nscanf(\"%s, %s\", file2.name, file2.path);\nfile2.file = fopen(file2.path, \"a+\");\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9135069, "user_type": "registered", "profile_image": "https://graph.facebook.com/2064243303822953/picture?type=large", "display_name": "Martin \u0160imara", "link": "https://stackoverflow.com/users/9135069/martin-%c5%a0imara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532597114, "creation_date": 1532555515, "last_edit_date": 1532556597, "question_id": 51528204, "link": "https://stackoverflow.com/questions/51528204/custom-file-name-in-c", "title": "Custom FILE name in C", "body": "<p>I wanna ask you, if is it possible to have user inputed name of FILE*... something like this: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char* name1, name2, path1, path2;\n    printf(\"Insert first file name and path\\nExample: file, c:\\\\path\\\\to\\\\file.txt\");\n    scanf(\"%s, %s\", name1, path1);\n    printf(\"Insert second file name and path\\nExample: file, c:\\\\path\\\\to\\\\file.txt\");\n    scanf(\"%s, %s\", name2, path2);\n    FILE* name1;\n    FILE* name2;\n    name1 = fopen(path1, \"a+\");\n    name2 = fopen(path2, \"a+\");\n    ...\n}\n</code></pre>\n\n<p>So on the console will be:</p>\n\n<pre><code>Insert file name and path\nExample: file, c:\\path\\to\\file.txt\n</code></pre>\n\n<p>so if user inserts:</p>\n\n<pre><code>File1, c:\\file1.txt\nFile2, c:\\file2.txt\n</code></pre>\n\n<p>I would like the \"code\" to look something like this:</p>\n\n<pre><code>FILE* File1;\nFile1 = fopen(\"c:\\file1.txt\", \"a+\");\n\nFILE* File2;\nFile2 = fopen(\"c:\\file2.txt\", \"a+\");\n</code></pre>\n\n<p>Thanks for help ;) </p>\n"}, {"tags": ["c", "user-input"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1532555595, "post_id": 51528147, "comment_id": 90024960, "body": "Always validate the return of <code>scanf</code> and then following <code>scanf</code> add <code>for (int c = getchar(); c != &#39;\\n&#39; &amp;&amp; c != EOF; c = getchar()) {}</code> to remove any additional characters (including the <code>&#39;\\n&#39;</code> generated by pressing <code>[Enter]</code>) <b>before</b> your next input attempt. You can also use <code>fgets</code> (e.g. <code>fgets (line, sizeof line, stdin)</code>) to read the entire line and then simply check if <code>*line - &#39;0&#39;</code> is <code>1, 2 or 3</code> and user a large enough buffer to insure it can contain the entire input (and validate that it did)"}, {"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1532555632, "post_id": 51528147, "comment_id": 90024971, "body": "Have you tried getchar instead?"}, {"owner": {"reputation": 1854, "user_id": 224935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/59h0o.jpg?s=128&g=1", "display_name": "Jay Elston", "link": "https://stackoverflow.com/users/224935/jay-elston"}, "edited": false, "score": 0, "creation_date": 1532555637, "post_id": 51528147, "comment_id": 90024972, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7469139/what-is-equivalent-to-getch-getche-in-linux\">What is Equivalent to getch() &amp; getche() in Linux?</a>"}, {"owner": {"reputation": 1854, "user_id": 224935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/59h0o.jpg?s=128&g=1", "display_name": "Jay Elston", "link": "https://stackoverflow.com/users/224935/jay-elston"}, "edited": false, "score": 0, "creation_date": 1532555702, "post_id": 51528147, "comment_id": 90025000, "body": "Also look at: <a href=\"https://stackoverflow.com/questions/32781937/getting-a-single-character-without-pressing-enter\" title=\"getting a single character without pressing enter\">stackoverflow.com/questions/32781937/&hellip;</a>"}, {"owner": {"reputation": 193, "user_id": 1144173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/74955b669a539604faed4b813b3b1152?s=128&d=identicon&r=PG", "display_name": "ZenJ", "link": "https://stackoverflow.com/users/1144173/zenj"}, "edited": false, "score": 0, "creation_date": 1532559440, "post_id": 51528147, "comment_id": 90025977, "body": "You may want to detect a keyboard event instead <a href=\"https://stackoverflow.com/questions/220818/detect-keyboard-event-in-c\" title=\"detect keyboard event in c\">stackoverflow.com/questions/220818/detect-keyboard-event-in-&zwnj;&#8203;c</a>"}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1532555544, "creation_date": 1532555544, "answer_id": 51528210, "question_id": 51528147, "link": "https://stackoverflow.com/questions/51528147/how-to-limit-user-input-to-a-single-char-only/51528210#51528210", "title": "How to limit user input to a single char only", "body": "<blockquote>\n  <p>Is there a way to limit the user input to a single char between a given range?</p>\n</blockquote>\n\n<p><em>No</em>.</p>\n\n<p>The user can input whatever he likes, but when your program receives that input, it's your duty to treat it right.</p>\n\n<p>For example, you could read the whole input line as a string, check its length, and if it's not the desired length (1 in your case), inform the user.</p>\n"}, {"comments": [{"owner": {"reputation": 8780, "user_id": 318716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Jwj3.png?s=128&g=1", "display_name": "Joseph Quinsey", "link": "https://stackoverflow.com/users/318716/joseph-quinsey"}, "edited": false, "score": 0, "creation_date": 1532561458, "post_id": 51528577, "comment_id": 90026363, "body": "A canonical answer for anyone&#39;s first C assignment."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 3, "last_activity_date": 1532559011, "last_edit_date": 1532559011, "creation_date": 1532557957, "answer_id": 51528577, "question_id": 51528147, "link": "https://stackoverflow.com/questions/51528147/how-to-limit-user-input-to-a-single-char-only/51528577#51528577", "title": "How to limit user input to a single char only", "body": "<blockquote>\n  <p>Is there a way to limit the user input to a single char between a\n  given range? I've also tried <code>fgets()</code></p>\n</blockquote>\n\n<p><strong>Yes</strong> (but it is your responsibility to isolate and use the 1st character typed and discard the rest)</p>\n\n<p>You can take the input any way you like, e.g. <code>scanf</code>, <code>getchar</code>, <code>fgets</code>, etc.., but it is your responsibility to <strong>validate</strong> every aspect of the input. E.g., </p>\n\n<ol>\n<li>did I get a valid character?,</li>\n<li>was it in the required range?,</li>\n<li>did the user cancel input by generating a manual <code>EOF</code> (e.g. <kbd>Ctrl+d</kbd> on Linux or <kbd>Ctrl+z</kbd> on windoze, but see: <a href=\"http://proc-x.com/2017/06/ctrlz-does-not-generate-eof-in-windows-10/\" rel=\"nofollow noreferrer\">CTRL+Z does not generate EOF in Windows 10</a>),</li>\n<li>did the user enter more than the number of characters requested (or did a cat step on the keyboard)?, and finally</li>\n<li>have I emptied the input buffer (e.g. <code>stdin</code>) before I attempt my next input?</li>\n</ol>\n\n<p>While you <em>can</em> use <code>scanf</code> or <code>getchar</code>, it is probably easier for new C programmers to use <code>fgets</code> which will read upto and <strong>include</strong> the trailing <code>'\\n'</code> in the buffer filled. (you may need multiple reads with a fixed size buffer to consume a line that exceeds the buffer length -- but this is easily handled with a loop).</p>\n\n<p>Also, since you will use a character array as the buffer (which is converted to a pointer to the first element (character) on access), you can simply dereference the buffer to obtain the first-character to validate it is <code>1-3</code>.</p>\n\n<p>Putting it altogether, it sounds like you are asking to do something similar to the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXC 1024   /* do NOT skimp on buffer size */\n\nint main (void) {\n\n    char buf[MAXC] = \"\";\n\n    puts (\"press [Enter] alone or generate manual EOF to exit.\\n\");\n    while (1) {\n        size_t len = 0;\n        fputs (\"enter single char 1-3: \", stdout);\n        if (!fgets (buf, sizeof buf, stdin)) {  /* validate read */\n            /* manual EOF */\n            fputs (\"(user canceled input)\\n\", stderr);\n            break;\n        }\n        if (*buf == '\\n')       /* check for [Enter] alone */\n            break;\n        if (*buf &lt; '1' || '3' &lt; *buf)   /* if not 1-3, error */\n            fprintf (stderr, \"  error: invalid input '%c'\\n\", *buf);\n        else    /* otherwise good value */\n            printf (\"  '%c' - accepted.\\n\", *buf);\n        len = strlen (buf);    /* get length of input (+ '\\n') */\n        if (len &gt; 2)    /* check if more than 1 character entered */\n            puts (\"  (additional characters entered)\");\n        /* validate entire line read */\n        while (len &amp;&amp; buf[len-1] != '\\n') {\n            fgets (buf, sizeof buf, stdin);\n            len = strlen (buf);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/single123\npress [Enter] alone or generate manual EOF to exit.\n\nenter single char 1-3: 0\n  error: invalid input '0'\nenter single char 1-3: 1\n  '1' - accepted.\nenter single char 1-3: 2\n  '2' - accepted.\nenter single char 1-3: 3\n  '3' - accepted.\nenter single char 1-3: 4\n  error: invalid input '4'\nenter single char 1-3: 100\n  '1' - accepted.\n  (additional characters entered)\nenter single char 1-3: 20000\n  '2' - accepted.\n  (additional characters entered)\nenter single char 1-3: 33333\n  '3' - accepted.\n  (additional characters entered)\nenter single char 1-3: 4444444444444444444444444444444\n  error: invalid input '4'\n  (additional characters entered)\nenter single char 1-3:\n</code></pre>\n\n<p><strong>Using <code>getchar()</code></strong></p>\n\n<p><code>getchar()</code> (and <code>scanf()</code> for that matter) provide an equally easy way to do the same thing, the difference being you will be handling things a character at a time from your input buffer rather than buffering the first buffer size number of characters -- and you must remove any additional character -- including the <code>'\\n'</code> generated by pressing <kbd>Enter</kbd>, yourself. The code is actually a few lines shorter, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    puts (\"press [Enter] alone or generate manual EOF to exit.\\n\");\n\n    while (1) {\n        int c;          /* note: c must be declared as 'int' */\n        fputs (\"enter single char 1-3: \", stdout);\n        c = getchar();\n        if (c == EOF) { /* manual EOF */\n            fputs (\"(user canceled input)\\n\", stderr);\n            break;\n        }\n        if (c == '\\n')  /* check for [Enter] alone */\n            break;\n        if (c &lt; '1' || '3' &lt; c)     /* if not 1-3, error */\n            fprintf (stderr, \"  error: invalid input '%c'\\n\", c);\n        else    /* otherwise good value */\n            printf (\"  '%c' - accepted.\\n\", c);\n        /* check if more than 1 character entered */\n        if ((c = getchar()) != '\\n') {\n            puts (\"  (additional characters entered)\");\n            /* remove additional characters */\n            do {\n                c = getchar();\n            } while (c != '\\n' &amp;&amp; c != EOF);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>(use/output is the same)</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1743, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1532559011, "creation_date": 1532555229, "question_id": 51528147, "link": "https://stackoverflow.com/questions/51528147/how-to-limit-user-input-to-a-single-char-only", "title": "How to limit user input to a single char only", "body": "<p>I have to get user input but only a single character either 1-3. If the user inputs anything else, an error message should return. I have the following, which is a portion of my code:</p>\n\n<pre><code>char val = 'i';\nwhile (1) {\n   if (val == 'i') {\n      printf(\"Enter option: (1/2/3)\\n\");\n      scanf(\" %c\", &amp;num);\n   }\n   else if (num == '1') {\n      //do things\n   }\n   else if (num == '2') {\n      //do things\n   }\n   else if (num == '3') {\n      //do things\n   }\n   else {\n      // return error\n   }\n</code></pre>\n\n<p>My problem is, I'm taking in a <code>%c</code> so a single char, but the user might input something such as <code>123</code> and it would still take in the first char, in this case <code>1</code>. The else statement at the end doesn't take care of all other alternate cases.</p>\n\n<p>Is there a way to limit the user input to a single char between a given range? I've also tried <code>fgets()</code> and <code>strncmp()</code> but had problems with those too.</p>\n"}, {"tags": ["c", "kernel", "minix"], "comments": [{"owner": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 1, "creation_date": 1532556052, "post_id": 51528069, "comment_id": 90025117, "body": "The ip.h names are the bit position, the table values are the bit mask"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532556541, "post_id": 51528275, "comment_id": 90025280, "body": "Wouldn&#39;t it then be <code>x &lt;&lt; i</code> where <code>x</code> is either 0 or 1?"}, {"owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532557009, "post_id": 51528275, "comment_id": 90025404, "body": "Oh! I think I get it! You take <code>1 &lt;&lt; i</code> and AND it with some value and that results in <code>x &lt;&lt; i</code>, correct?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532559786, "post_id": 51528275, "comment_id": 90026054, "body": "@JakeKing: I added some examples of simple operations on bit masks."}, {"owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532562491, "post_id": 51528275, "comment_id": 90026577, "body": "Wait, so couldn&#39;t the bitmask just be done with <code>value &amp; RECEIVE</code> and <code>(value &amp; ECHO) | (value &amp; SENDREC)</code>?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532564580, "post_id": 51528275, "comment_id": 90026976, "body": "@JakeKing: What is <code>value</code>? If it is just a 0 or 1 for on or off, then, no, <code>value &amp; RECEIVE</code> is not what you want. <code>value &amp; RECEIVE</code> does not shift the bit to the desired location. Experiment with writing some code that shifts bits and ANDs and ORs them (and displays the results in hexadecimal or binary)."}, {"owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532606744, "post_id": 51528275, "comment_id": 90044299, "body": "But isn&#39;t <code>SENDREC</code> supposed to be 0011b? That&#39;s setting on two bits instead of one. <code>1 &lt;&lt; SENDREC</code> would mask a value of only a single bit. Also aren&#39;t all of the bits supposed to fit in a half-byte?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532610429, "post_id": 51528275, "comment_id": 90046753, "body": "@JakeKing: A bit mask does <b>not</b> use the values of codes. A code number for <b>one</b> system call is simply a number, such as the codes 1, 2, 3, 4, or 8 defined in <code>kernel&#47;ipc.h</code>. A <b>bit mask</b> is a set of bits, where each bit represents one item. Typically, the bits representing an integer are numbered 0, 1, 2, 3, 4, 5, and so on, where bit 0 represents value 1, bit 1 represents value 2, bit 2 represents value 4, bit 3 represents value 8, and so on. To form a bit mask from the call codes, each call code <code>C</code> is assigned to the bit in position <code>C</code>, meaning the bit with value <code>1&lt;&lt;C</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1532610490, "post_id": 51528275, "comment_id": 90046795, "body": "@JakeKing: If a bit mask has bits 3 and 8 set, it means that codes 3 and 8 are allowed, meaning that <code>SENDREC</code> and <code>ECHO</code> are allowed. The bit mask with bits 3 and 8 set is the bit mask formed by adding the values 2^3 and 2^8, which is 8 + 256 = 264."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1532610240, "last_edit_date": 1532610240, "creation_date": 1532555894, "answer_id": 51528275, "question_id": 51528069, "link": "https://stackoverflow.com/questions/51528069/why-bit-shift-left-on-system-call-bits/51528275#51528275", "title": "Why bit shift left on system call bits?", "body": "<p>The values formed in the code you show from <code>kernel/table.c</code> are not the values of the code numbers for system calls. They are bit masks for the system calls.</p>\n\n<p>Bit masks are commonly used to implement sets. Suppose we have three objects, such as an apple, a banana, and a cherry, and we wish to record whether some set X does or does not contain an apple, does or does not contain a banana, and does or does not contain a cherry.</p>\n\n<p>We can do this by assigning the bit at position 0 (value 1) to represent an apple, the bit at position 1 (value 2) to represent a banana, and the bit at position 2 (value 4) to represent a cherry. Then whether any set X does or does not contain these items can be represented by a number which does or does not have the corresponding bits set. For example, the number 5 has bits at positions 0 and 2 set, so it represents a set that contains an apple and a cherry but not a banana.</p>\n\n<p>The code in <code>kernel/table.c</code> assigns bits in a bit mask so that the system call with code <em>i</em> is represented by the bit at position <em>i</em>. Thus, the value of the bit in the bit mask for the system call with code <em>i</em> has value <code>1 &lt;&lt; i</code>.</p>\n\n<p>Here is a table showing the values of the call codes and the values of their bit masks:</p>\n\n<pre>\n    Call Name    Code Number    Bit Mask\n    SEND         1              2\n    RECEIVE      2              4\n    SENDREC      3              8\n    NOTIFY       4              16\n    ECHO         8              256\n</pre>\n\n<p>The way these are used is that, to represent a set containing several calls, the bit mask values for those calls are added together (or, equivalent, combined with a bitwise OR operation). So the set containing <code>SEND</code>, <code>RECEIVE</code>, and <code>SENDREC</code> is represented by 2+4+8 = 14.</p>\n\n<p>So <code>1 &lt;&lt; SENDREC</code> is the value of the bit that represents <code>SENDREC</code> in the mask, and <code>1 &lt;&lt; ECHO</code> is the value of the bit that represents <code>ECHO</code> in the mask. The OR of these values, <code>1 &lt;&lt; SENDREC | 1 &lt;&lt; ECHO</code>, is a bit mask that includes <code>SENDREC</code> and <code>ECHO</code> but does not include <code>SEND</code> or the other codes.</p>\n\n<p>Some operations on bit masks are:</p>\n\n<ul>\n<li>If <code>i</code> is the number of an item, <code>1&lt;&lt;i</code> is the value of the bit that represents it in the set.</li>\n<li>To add one item <code>i</code> to a set <code>X</code>, OR the bit into the set, with <code>X |= 1&lt;&lt;i</code>.</li>\n<li>To take the union of two sets <code>X</code> and <code>Y</code>, OR them, with <code>X | Y</code>.</li>\n<li>To take the intersection of two sets <code>X</code> and <code>Y</code>, AND them, with <code>X &amp; Y</code>.</li>\n</ul>\n"}], "owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532610240, "creation_date": 1532554775, "last_edit_date": 1532555945, "question_id": 51528069, "link": "https://stackoverflow.com/questions/51528069/why-bit-shift-left-on-system-call-bits", "title": "Why bit shift left on system call bits?", "body": "<p>In <a href=\"https://github.com/danielbarter/minix_book/blob/minix_book/kernel/ipc.h\" rel=\"nofollow noreferrer\">kernel/ipc.h</a> Tanenbaum defines the system call bits as:</p>\n\n<pre><code>/* System call numbers that are passed when trapping to the kernel. The \n * numbers are carefully defined so that it can easily be seen (based on \n * the bits that are on) which checks should be done in sys_call().\n */\n#define SEND           1    /* 0 0 0 1 : blocking send */\n#define RECEIVE        2    /* 0 0 1 0 : blocking receive */\n#define SENDREC        3    /* 0 0 1 1 : SEND + RECEIVE */\n#define NOTIFY         4    /* 0 1 0 0 : nonblocking notify */\n#define ECHO           8    /* 1 0 0 0 : echo a message */\n</code></pre>\n\n<p>but then in <a href=\"https://github.com/danielbarter/minix_book/blob/minix_book/kernel/table.c\" rel=\"nofollow noreferrer\">kernel/table.c</a> the system call bits are defined as:</p>\n\n<pre><code>/* Define system call traps for the various process types. These call masks\n * determine what system call traps a process is allowed to make.\n */\n#define TSK_T   (1 &lt;&lt; RECEIVE)                   /* clock and system */\n#define SRV_T   (~0)                             /* system services */\n#define USR_T   ((1 &lt;&lt; SENDREC) | (1 &lt;&lt; ECHO))   /* user processes */\n</code></pre>\n\n<p><strong>Why is everything bit shifted over to the left?</strong> <code>1 &lt;&lt; RECEIVE</code> would be <strong>0100</strong> instead of <strong>0010</strong>. Doesn't that mean that the clock and system tasks can NOTIFY but not RECEIVE? </p>\n"}, {"tags": ["c", "gdb", "scanf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532549120, "post_id": 51526829, "comment_id": 90022267, "body": "Is your input containing any zeros?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532549487, "post_id": 51526829, "comment_id": 90022423, "body": "Or newline characters? Or even whitespaces? What the <code>scanf</code>  line looks like? What your input looks like?"}, {"owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532549621, "post_id": 51526829, "comment_id": 90022475, "body": "I have added the hexdump above, there is a newline at the end but no zeros or newlines otherwise. Also, the same thing happens when I input seemingly arbitrary non-printable characters with e.g. <code>(gdb) r &lt;&lt;&lt; $(python -c &quot;print(&#39;\\x...&#39;)&quot;)</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1532549667, "post_id": 51526829, "comment_id": 90022494, "body": "Here you go. <code>0x0d</code> is a newline character (CR) which is terminating the input for <code>scanf</code> (if it is something like <code>scanf(&quot;%s&quot;...)</code>."}, {"owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532549798, "post_id": 51526829, "comment_id": 90022547, "body": "Huh, I didn&#39;t think about that, that might be it. In that case, would it be impossible to write that specific byte into the buffer?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532549829, "post_id": 51526829, "comment_id": 90022559, "body": "With such a <code>scanf</code>? No."}, {"owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532550006, "post_id": 51526829, "comment_id": 90022644, "body": "Okay, thank you. I think that cleared things up (on second inspection my &quot;arbitrary&quot; test input did always include a <code>0x0d</code> byte)."}], "owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532550064, "creation_date": 1532548971, "last_edit_date": 1532550064, "question_id": 51526829, "link": "https://stackoverflow.com/questions/51526829/non-printable-input-is-not-handled-correctly-in-gdb", "title": "Non-printable input is not handled correctly in GDB", "body": "<p>I'm experimenting with buffer overflow vulnerabilities and have a given (compiled) C program which uses <code>scanf</code> to read data input by the user into a buffer without necessary overflow prevention checks in place. I believe I have almost figured out how to exploit this but I'm currently failing to debug my approach because I cannot figure out how to pass non-printable input characters to the vulnerable program while debugging it using <code>GDB</code>.</p>\n\n<p>From reading the documentation and other answers on here this should be easily possible by writing the input bytes to a file and then passing that file as input to GDB like so: <code>(gdb) r &lt; input.txt</code>. But strangely enough, when I then check the contents of the vulnerable buffer in memory after the call to <code>scanf</code>, its contents are completely different from the input byte sequence, except for the first byte (which is <code>\\xa1</code>). I have tried the same thing with a file containing only ASCII characters and in that case, the buffer contents after the call to <code>scanf</code> match the file contents.</p>\n\n<p>I'm at a loss here, could this be a GDB issue? Or some <code>scanf</code> peculiarity? (I don't have the C program's source code).</p>\n\n<p>EDIT: I have added the result of <code>hexdump -C input.txt</code> below.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>00000000  a1 0d 84 04 08 e0 ff 90  90 90 90 90 90 90 90 90  |................|\n00000010  90 90 90 90 90 90 90 90  90 90 90 90 90 90 90 90  |................|\n*\n000000d0  48 d6 ff ff 48 d6 ff ff  0a                       |H...H....|\n000000d9\n</code></pre>\n"}, {"tags": ["java", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 9152, "user_id": 2338547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QT3fG.png?s=128&g=1", "display_name": "markspace", "link": "https://stackoverflow.com/users/2338547/markspace"}, "edited": false, "score": 1, "creation_date": 1532546631, "post_id": 51526206, "comment_id": 90021190, "body": "What is your transfer speed in bytes/second?  Are you close to the actual limits of hardware on your system?  Is there any reason you think you actually can go faster?"}, {"owner": {"reputation": 35205, "user_id": 2891664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9df9d7af70d46f8db2ecd4392bb76087?s=128&d=identicon&r=PG&f=1", "display_name": "Radiodef", "link": "https://stackoverflow.com/users/2891664/radiodef"}, "edited": false, "score": 1, "creation_date": 1532547121, "post_id": 51526206, "comment_id": 90021387, "body": "You should make sure you&#39;re benchmarking properly first. See for example <a href=\"https://stackoverflow.com/q/504103/2891664\">stackoverflow.com/q/504103/2891664</a> and <a href=\"https://www.ibm.com/developerworks/java/library/j-jtp02225/\" rel=\"nofollow noreferrer\">ibm.com/developerworks/java/library/j-jtp02225</a> (Using <code>currentTimeMillis</code> isn&#39;t a good idea, for starters.)"}, {"owner": {"reputation": 11, "user_id": 7847357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93967ed02f89b06fcb4d0925c0a2e3ca?s=128&d=identicon&r=PG&f=1", "display_name": "C. Wallace", "link": "https://stackoverflow.com/users/7847357/c-wallace"}, "edited": false, "score": 0, "creation_date": 1532547290, "post_id": 51526206, "comment_id": 90021462, "body": "Hardware: Intel(R) Core(TM) i7-7820HQ CPU @ 2.90GHz, 64 bit"}], "owner": {"reputation": 11, "user_id": 7847357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93967ed02f89b06fcb4d0925c0a2e3ca?s=128&d=identicon&r=PG&f=1", "display_name": "C. Wallace", "link": "https://stackoverflow.com/users/7847357/c-wallace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532546383, "creation_date": 1532546383, "question_id": 51526206, "link": "https://stackoverflow.com/questions/51526206/getdirectbufferaddress-does-not-perform-better-than-getdoublearrayelements", "title": "GetDirectBufferAddress does not perform better than GetDoubleArrayElements", "body": "<p>I am sending large amounts of data from Java to C++ using JNI and in an attempt to minimize the cost of transferring the data and avoid unnecessary copies, I tried implementing GetDirectBufferAddress to access the memory location directly instead of GetDoubleArrayElements. I also ran performance metrics on both methods from the Java side via <code>System.currentTimeMillis()</code> and got the following performance times:</p>\n\n<p>GetDoubleArrayElements: 98 ms\nGetDirectBufferAddress: 96 ms</p>\n\n<p>Virtually no performance increase. Is there any reason this might be happening? I allocated the ByteBuffers on the Java side using <code>ByteBuffer.allocateDirect().order(ByteOrder.nativeOrder)</code> and <code>arrBuff.putDouble(arr[i])</code>. Am I missing something? Any reference material would be greatly appreciated, I'm just trying to learn.</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532545867, "post_id": 51525876, "comment_id": 90020864, "body": "Don&#39;t return a Go slice to C code, since C code doesn&#39;t know what a Go slice is. Give it a an array pointer just like you would in plain C."}, {"owner": {"reputation": 53, "user_id": 4196220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9wG0t.jpg?s=128&g=1", "display_name": "Alain Gilbert", "link": "https://stackoverflow.com/users/4196220/alain-gilbert"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1532546123, "post_id": 51525876, "comment_id": 90020991, "body": "I tried a lot of different things. I cannot figure it out. I know I should not return a slice, I should probably return an unsafe.Pointer or something similar. But I think it will be easier for other people to understand what I&#39;m trying to do with this example. If you have any example of how to do it, I would really appreciate it :)"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4196220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9wG0t.jpg?s=128&g=1", "display_name": "Alain Gilbert", "link": "https://stackoverflow.com/users/4196220/alain-gilbert"}, "edited": false, "score": 0, "creation_date": 1532559037, "post_id": 51526362, "comment_id": 90025888, "body": "It&#39;s nice that the code can compile with <code>go run</code>, but if you separate the C code in it&#39;s own file, and you compile the shared library... you&#39;ll get a runtime error <code>panic: runtime error: cgo result has Go pointer</code>."}], "tags": [], "owner": {"reputation": 133105, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1532547458, "last_edit_date": 1532547458, "creation_date": 1532546993, "answer_id": 51526362, "question_id": 51525876, "link": "https://stackoverflow.com/questions/51525876/use-go-slice-in-c/51526362#51526362", "title": "Use Go slice in C", "body": "<blockquote>\n  <p>Use Go slice in C</p>\n</blockquote>\n\n<hr>\n\n<p>Here's an example of C printing a Go <code>byte</code> slice:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n\nvoid printbuf(size_t len, unsigned char *buf) {\n    printf(\"%lu [\", len);\n    if (!buf) {\n        len = 0;\n    }\n    size_t maxwidth = 16;\n    size_t width = len &lt;= maxwidth ? len : maxwidth;\n    for (size_t i = 0; i &lt; width; i++) {\n        if (i &gt; 0) {\n            printf(\" \");\n        }\n        printf(\"%02X\", buf[i]);\n    }\n    if (width &lt; len) {\n        printf(\" ...\");\n    }\n    printf(\"]\\n\");\n}\n*/\nimport \"C\"\n\nfunc cbuf(buf []byte) (size C.size_t, ptr *C.uchar) {\n    var bufptr *byte\n    if cap(buf) &gt; 0 {\n        bufptr = &amp;(buf[:1][0])\n    }\n    return C.size_t(len(buf)), (*C.uchar)(bufptr)\n}\n\nfunc main() {\n    buf := make([]byte, 24, 32)\n    for i := range buf {\n        buf[i] = byte(i)\n    }\n    bufsize, bufptr := cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>24 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n</code></pre>\n\n<hr>\n\n<p><code>func Test() []T</code>  has the wrong return values for C. Return a length and an array pointer, like <code>cbuf</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1532547071, "creation_date": 1532547071, "answer_id": 51526388, "question_id": 51525876, "link": "https://stackoverflow.com/questions/51525876/use-go-slice-in-c/51526388#51526388", "title": "Use Go slice in C", "body": "<p>To start, C doesn't know about the Go slice type, nor how to manipulate it, so you should return an array pointer just like you would in C.</p>\n\n<p>You also can't allocate the slice in Go then return a pointer to the allocated memory without some way to keep it from being GC'ed. In this example it's probably simpler to just allocate the array in C.</p>\n\n<pre><code>p := C.malloc(C.size_t(2))\n\n// make a slice for convenient indexing\narr := (*[1 &lt;&lt; 30]*T)(p)[:2:2]\narr[0] = &amp;T{C.int(1), C.CString(\"a\")}\narr[1] = &amp;T{C.int(2), C.CString(\"abc\")}\n\nreturn p\n</code></pre>\n\n<p>You will also of course need to handle the array size, which you could do with by combining it into a struct like you did for strings, or accept a second pointer parameter to set to the return size.</p>\n\n<p>Don't forget that since you are allocating the memory in C, you are also responsible for freeing it. This goes for both the <code>malloc</code> call, as well as for the <code>C.CString</code> arrays.</p>\n"}], "owner": {"reputation": 53, "user_id": 4196220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9wG0t.jpg?s=128&g=1", "display_name": "Alain Gilbert", "link": "https://stackoverflow.com/users/4196220/alain-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1163, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1532547458, "creation_date": 1532544875, "question_id": 51525876, "link": "https://stackoverflow.com/questions/51525876/use-go-slice-in-c", "title": "Use Go slice in C", "body": "<p>I'm trying to build a go shared library with a function that returns a slice.<br>\nHow can I use the slice from C code ?</p>\n\n<pre><code>package main\n\nimport \"C\"\n\ntype T struct {\n    A C.int\n    B *C.char\n}\n\n//export Test\nfunc Test() []T {\n    arr := make([]T, 0)\n    arr = append(arr, T{C.int(1), C.CString(\"a\")})\n    arr = append(arr, T{C.int(2), C.CString(\"abc\")})\n    return arr\n}\n\nfunc main() {}\n</code></pre>\n\n<p><code>go build -o lib.so -buildmode=c-shared main.go</code></p>\n\n<p>I now have a <code>lib.so</code> and a <code>lib.h</code></p>\n\n<p>What would be the C code to print the values of the array ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"lib.h\"\n\ntypedef struct {\n  int   A;\n  char* B;\n} T;\n\nint main() {\n  GoSlice a = Test();\n  for (int i = 0; i &lt; 2; i++){\n    printf(\"%s\\n\", ((T *)a.data)[i].B);\n  }\n}\n</code></pre>\n\n<p><code>gcc -o main main.c ./lib.so</code></p>\n"}, {"tags": ["c", "variables", "gcc", "memory", "opencl"], "comments": [{"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532542846, "post_id": 51525142, "comment_id": 90019537, "body": "You have <code>printf(&quot;%lu&quot;)</code>, then <code>run_on_gpu</code>, then another <code>printf(&quot;%lu&quot;)</code> - looks like it&#39;s doing what it&#39;s supposed to?"}, {"owner": {"reputation": 3712, "user_id": 409110, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a1d3012a5ab47f24ea1f860832582ba4?s=128&d=identicon&r=PG", "display_name": "Amit", "link": "https://stackoverflow.com/users/409110/amit"}, "reply_to_user": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532545204, "post_id": 51525142, "comment_id": 90020558, "body": "@valiano the value being printed is different. in run_on_gpu the value is 549755813890, but it&#39;s expected to be 9"}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532546333, "post_id": 51525142, "comment_id": 90021066, "body": "Got it. But shouldn&#39;t the expected output be <code>9</code>, <code>size 9</code>, <code>9</code>?"}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532546431, "post_id": 51525142, "comment_id": 90021112, "body": "And just to verify, <code>password_length</code> == <code>cnt</code> == 9?"}, {"owner": {"reputation": 3712, "user_id": 409110, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a1d3012a5ab47f24ea1f860832582ba4?s=128&d=identicon&r=PG", "display_name": "Amit", "link": "https://stackoverflow.com/users/409110/amit"}, "reply_to_user": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532546528, "post_id": 51525142, "comment_id": 90021148, "body": "@valiano sorry, updated that. And no, password_length was something i added later, forgot to undo when pasting here. But the result is as described in the question"}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532546773, "post_id": 51525142, "comment_id": 90021249, "body": "Thanks for updating. I would suggest adding <code>c</code> and <code>opencl</code> tags to the question, it may helps getting the right attention"}, {"owner": {"reputation": 3680, "user_id": 889742, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/9b925f6c8896aadcdd447b60ee5bb574?s=128&d=identicon&r=PG", "display_name": "Gonen I", "link": "https://stackoverflow.com/users/889742/gonen-i"}, "edited": false, "score": 0, "creation_date": 1532547288, "post_id": 51525142, "comment_id": 90021458, "body": "Amit, start removing parameters (except count) from run_on_gpu one by one. When the problem goes away, you found your culprit."}, {"owner": {"reputation": 10144, "user_id": 7256341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RXEvi.jpg?s=128&g=1", "display_name": "valiano", "link": "https://stackoverflow.com/users/7256341/valiano"}, "edited": false, "score": 0, "creation_date": 1532547852, "post_id": 51525142, "comment_id": 90021680, "body": "<code>run_on_gpu</code> takes 10 parameters, and latter ones may be passed on the stack (just a theory). What happens when <code>cnt</code> becomes the first parameter?"}], "answers": [{"comments": [{"owner": {"reputation": 5977, "user_id": 1745695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b932c5253c45af61dc443fbc1b9c935c?s=128&d=identicon&r=PG", "display_name": "Dithermaster", "link": "https://stackoverflow.com/users/1745695/dithermaster"}, "edited": false, "score": 0, "creation_date": 1532727013, "post_id": 51526792, "comment_id": 90098413, "body": "Great observation! On the host side, one should alway use the cl_&lt;type&gt; types instead of &quot;native&quot; types; they are designed to be the same size as the device types."}], "tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": false, "score": 2, "last_activity_date": 1532548773, "creation_date": 1532548773, "answer_id": 51526792, "question_id": 51525142, "link": "https://stackoverflow.com/questions/51525142/how-is-this-variable-value-changing-in-the-function/51526792#51526792", "title": "How is this variable value changing in the function?", "body": "<p>At a SWAG, there's a parameter mismatch in the use and definition of <code>run_on_gpu()</code>.  <code>549755813890</code> isn't very interesting till you view it as a 64 bit hex number.  At which point it becomes <code>0x00000080:00000002</code>, colon inserted between 32 bit groups.  That just screams at me that somehow the parameter <code>cnt</code> in <code>run_on_gpu()</code> is overlaying two other 32 bit values.</p>\n\n<p>It's worth noting that this would be consistent with GCC on a 64 bit system, but not 32 bit GCC or MSVC on any platform.  To the best of my knowledge 64 bit GCC is the only \"desktop\" compiler that treats <code>unsigned long</code> as 64 bits, all others treat it as 32 bits.</p>\n"}], "owner": {"reputation": 3712, "user_id": 409110, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a1d3012a5ab47f24ea1f860832582ba4?s=128&d=identicon&r=PG", "display_name": "Amit", "link": "https://stackoverflow.com/users/409110/amit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1532548773, "creation_date": 1532541844, "last_edit_date": 1532546809, "question_id": 51525142, "link": "https://stackoverflow.com/questions/51525142/how-is-this-variable-value-changing-in-the-function", "title": "How is this variable value changing in the function?", "body": "<p>I have this code:</p>\n\n<pre><code>device_params_t *device_params = malloc(sizeof(device_params_t));\n\nget_device_params(device_params, platform_id, workWithUser ? \"check_pdfs_user\" : \"check_pdfs_owner\", program_buffer, program_size);\n\nint password_len = strlen(password_prefix) + password_digits + strlen(password_suffix);\n\nunsigned int prefix_length = strlen(password_prefix), suffix_length = strlen(password_suffix);\nunsigned long count;\n\n// while (number &lt; max_password) {\n    count = max_password - number;\n    count = count &gt; batch_size ? batch_size : count;\n    printf(\"%lu\\n\", count);\n    run_on_gpu(device_params, params, number, password_prefix, prefix_length, password_suffix, suffix_length, password_len, count, &amp;found);\n    printf(\"%lu\\n\", count);\n    if (found) {\n        // break;\n    }\n    number += count;\n// }\n</code></pre>\n\n<p>This is the get_device_params function:</p>\n\n<pre><code>void get_device_params(device_params_t* params, cl_platform_id platform_id, const char *kernel_func, char *program_buffer, size_t program_size) {\n    clGetDeviceIDs(platform_id, CL_DEVICE_TYPE_GPU, 0, NULL, &amp;params-&gt;device_count);\n    params-&gt;device_ids = (cl_device_id*) malloc(sizeof(cl_device_id) * params-&gt;device_count);\n    int err = clGetDeviceIDs(platform_id, CL_DEVICE_TYPE_GPU, params-&gt;device_count, params-&gt;device_ids, NULL);\n    if (err != CL_SUCCESS)\n    {\n        printf(\"Error: Failed to create a device group! %d\\n\", err);\n        free(params-&gt;device_ids);\n        return;\n    }\n\n    int i;\n    size_t local, min_local = 0;\n\n    params-&gt;context = clCreateContext(NULL, params-&gt;device_count, params-&gt;device_ids, NULL, NULL, &amp;err);\n    if (err != CL_SUCCESS)\n    {\n        printf(\"Error: Failed to create a compute context!\\n\");\n        goto out1;\n    }\n\n    cl_program program = build_program(params-&gt;context, params-&gt;device_ids, program_buffer, program_size);\n    if (!program)\n    {\n        printf(\"Error: Failed to create compute program!\\n\");\n        goto out1;\n    }\n\n    params-&gt;kernel = clCreateKernel(program, kernel_func, &amp;err);\n    if (!params-&gt;kernel || err != CL_SUCCESS)\n    {\n        printf(\"Error: Failed to create compute kernel!\\n\");\n        goto out1;\n    }\n\n    params-&gt;commands = malloc(sizeof(cl_command_queue) * params-&gt;device_count);\n\n    for(i = 0; i &lt; params-&gt;device_count; i++) {\n        params-&gt;commands[i] = clCreateCommandQueue(params-&gt;context, params-&gt;device_ids[i], 0, &amp;err);\n        if (!params-&gt;commands[i])\n        {\n            printf(\"Error: Failed to create a command commands! %d\\n\", err);\n            goto out1;\n        }\n\n        err = clGetKernelWorkGroupInfo(params-&gt;kernel, params-&gt;device_ids[i], CL_KERNEL_WORK_GROUP_SIZE, sizeof(local), &amp;local, NULL);\n        if (err != CL_SUCCESS)\n        {\n            printf(\"Error: Failed to retrieve kernel work group info! %d\\n\", err);\n            goto out1;\n        }\n\n        min_local = min_local &gt; local ? local : min_local;\n    }\n\n    params-&gt;local = min_local;\n\n    return;\n\n    out1:\n    if (params-&gt;kernel) {\n        clReleaseKernel(params-&gt;kernel);\n    }\n    if (params-&gt;commands) {\n        for(i = 0; i &lt; params-&gt;device_count; i++) {\n            clReleaseCommandQueue(params-&gt;commands[i]);\n        }\n    }\n    if (params-&gt;context) {\n        clReleaseKernel(params-&gt;context);\n    }\n    clReleaseProgram(program);\n\n    return;\n}\n</code></pre>\n\n<p>The run_on_gpu is defined as:</p>\n\n<pre><code>void run_on_gpu(device_params_t *device_params, PDFParams *params, unsigned long start, char *prefix, unsigned int prefix_length, char *suffix, unsigned int suffix_length, int password_length, const unsigned long cnt, bool *found)\n{\n    printf(\"size %lu\\n\", cnt);\n}\n</code></pre>\n\n<p>Now what's happening is this:</p>\n\n<pre><code>9\nsize 549755813890\n9\n</code></pre>\n\n<p>I expect it to be:</p>\n\n<pre><code>9\nsize 9\n9\n</code></pre>\n\n<p>Not sure what's going on!</p>\n"}, {"tags": ["c", "linker", "rust", "ffi"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1532551408, "post_id": 51524371, "comment_id": 90023298, "body": "Where did you tell cargo to link your library ?"}, {"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 1, "creation_date": 1532551833, "post_id": 51524371, "comment_id": 90023479, "body": "FWIW, a <code>usize</code> and an <code>int</code> are <b>not</b> guaranteed to be the same size. You should be using <code>libc::c_int</code> in Rust to ensure you match."}, {"owner": {"reputation": 562, "user_id": 1922722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39fbebb5bebce94df3a38e3e44649f57?s=128&d=identicon&r=PG", "display_name": "nwn", "link": "https://stackoverflow.com/users/1922722/nwn"}, "edited": false, "score": 1, "creation_date": 1532551911, "post_id": 51524371, "comment_id": 90023515, "body": "<a href=\"https://stackoverflow.com/a/27959146/1922722\">Possibly relevant</a>"}, {"owner": {"reputation": 2434, "user_id": 4591251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22ad6242d3ca1d772c46a5d00389d925?s=128&d=identicon&r=PG", "display_name": "Ross MacArthur", "link": "https://stackoverflow.com/users/4591251/ross-macarthur"}, "edited": false, "score": 0, "creation_date": 1532594865, "post_id": 51524371, "comment_id": 90036979, "body": "Is there a difference between using <code>libc::c_int</code> and <code>std::os::raw::c_int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "is_accepted": true, "score": 3, "last_activity_date": 1532611254, "last_edit_date": 1532611254, "creation_date": 1532551540, "answer_id": 51527388, "question_id": 51524371, "link": "https://stackoverflow.com/questions/51524371/how-can-i-link-libraries-to-my-c-code-and-use-that-in-a-rust-binary/51527388#51527388", "title": "How can I link libraries to my C code and use that in a Rust binary?", "body": "<p>From the <a href=\"https://doc.rust-lang.org/cargo/reference/build-scripts.html\" rel=\"nofollow noreferrer\">Cargo documentation for build scripts</a>:</p>\n\n<blockquote>\n  <p><code>rustc-link-lib=[KIND=]NAME</code> indicates that the specified value is a\n  library name and should be passed to the compiler as a <code>-l</code> flag. The\n  optional <code>KIND</code> can be one of <code>static</code>, <code>dylib</code> (the default), or <code>framework</code>,\n  see <code>rustc --help</code> for more details.</p>\n</blockquote>\n\n<p>Add this to your build script:</p>\n\n<pre><code>println!(\"cargo:rustc-link-lib=nl-genl-3\");\nprintln!(\"cargo:rustc-link-lib=nl-3\");\n</code></pre>\n\n<p>And remove the <code>link</code> attributes from your Rust code.</p>\n\n<hr>\n\n<p>The problem is that your linker flags are stating that the Rust code needs to link to the C libraries, but that's not fully true. Your <em>C code</em> needs to link to the libraries, and your Rust code needs to link to the compiled C code. If you look at the arguments, you'll see this (abridged) output</p>\n\n<ul>\n<li><code>deps/derp-5a7445c256565e2d.1vmrdj4gsxr690x4.rcgu.o</code> (your Rust code)</li>\n<li><code>-l nl-genl-3</code> (system library)</li>\n<li><code>-l nl-3</code> (system library)</li>\n<li><code>-l nl</code> (your C shim)</li>\n</ul>\n\n<p>Argument order to linkers is important. If something isn't needed when the object is processed by the linker, <em>it won't be used</em>.</p>\n\n<p>Here, the Rust code adds a dependency on code from the <code>nl</code> library, so the linker is on the lookout for those symbols. When <code>nl-3</code> and <code>nl-genl-3</code> are processed, we don't need any of the symbols from them, so they are mostly ignored. When <code>nl</code> is processed, we resolve the dependency from the Rust code, but <code>nl</code> needs the symbols from <code>nl-genl-3</code> and <code>nl-3</code>, which will not be processed again.</p>\n\n<p>It's not obvious, but the <code>compile</code> method from <code>cc</code> automatically prints out a <code>cargo:rustc-link-lib</code> line to tie its build result into your Rust code.</p>\n\n<p>See also:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/40833078/155423\">How do I specify the linker path in Rust?</a></li>\n<li><a href=\"https://stackoverflow.com/q/40602708/155423\">Linking Rust application with a dynamic library not in the runtime linker search path</a></li>\n</ul>\n"}], "owner": {"reputation": 2434, "user_id": 4591251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22ad6242d3ca1d772c46a5d00389d925?s=128&d=identicon&r=PG", "display_name": "Ross MacArthur", "link": "https://stackoverflow.com/users/4591251/ross-macarthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 1, "accepted_answer_id": 51527388, "answer_count": 1, "score": 1, "last_activity_date": 1532611254, "creation_date": 1532538697, "last_edit_date": 1532551439, "question_id": 51524371, "link": "https://stackoverflow.com/questions/51524371/how-can-i-link-libraries-to-my-c-code-and-use-that-in-a-rust-binary", "title": "How can I link libraries to my C code and use that in a Rust binary?", "body": "<p>I am trying to include a C file in my Rust project. The C file uses system dependencies. Below is a minimal example that does not compile when I run <code>cargo build</code>.</p>\n\n<p>If I take the failing command that Cargo is running and I append <code>\"-l\" \"nl-genl-3\" \"-l\" \"nl-3\"</code> the command <em>does</em> succeed. Is it putting the the linker flags in the wrong place, because those flags definitely <em>are</em> in the command?</p>\n\n<p><strong>src/main.rs</strong></p>\n\n<pre><code>#[link(name = \"nl-genl-3\")]\n#[link(name = \"nl-3\")]\nextern \"C\" {\n    fn nl_test(help_me_pls: usize) -&gt; usize;\n}\n\nfn main() {\n    unsafe {\n        println!(\"nl.c function result: {:?}\", nl_test(6));\n    }\n}\n</code></pre>\n\n<p><strong>src/nl.c</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;linux/nl80211.h&gt;\n#include &lt;netlink/netlink.h&gt;\n#include &lt;netlink/genl/genl.h&gt;\n\nint nl_test(int help_me_pls) {\n    struct nl_sock* socket = nl_socket_alloc();\n    nl_socket_free(socket);\n    return help_me_pls;\n}\n</code></pre>\n\n<p><strong>build.rs</strong></p>\n\n<pre><code>extern crate cc;\n\nfn main() {\n    cc::Build::new()\n        .include(\"/usr/include/libnl3\")\n        .file(\"src/nl.c\")\n        .compile(\"libnl.a\");\n}\n</code></pre>\n\n<p><strong>Cargo.toml</strong></p>\n\n<pre><code>[package]\nname = \"derp\"\nversion = \"0.1.0\"\n\n[build-dependencies]\ncc = \"1.0\"\n</code></pre>\n\n<p>I get the following output when I run <code>cargo build</code></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>   Compiling cc v1.0.18\n   Compiling derp v0.1.0 (file:///root/derp)\nerror: linking with `cc` failed: exit code: 1\n  |\n  = note: \"cc\" \"-Wl,--as-needed\" \"-Wl,-z,noexecstack\" \"-L\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.1vmrdj4gsxr690x4.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.1y16o1qfye96o7m0.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.3rngp6bm2u2q5z0y.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.4oc10dk278mpk1vy.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.4xq48u46a1pwiqn7.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.51s1w397y42gpez1.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.8xzrsc1ux72v29j.rcgu.o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.oa3rad818d8sgn4.rcgu.o\" \"-o\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d\" \"/root/derp/target/debug/deps/derp-5a7445c256565e2d.crate.allocator.rcgu.o\" \"-Wl,--gc-sections\" \"-pie\" \"-Wl,-z,relro,-z,now\" \"-nodefaultlibs\" \"-L\" \"/root/derp/target/debug/deps\" \"-L\" \"/root/derp/target/debug/build/derp-c3cdcf1fbd0c70b2/out\" \"-L\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib\" \"-l\" \"nl-genl-3\" \"-l\" \"nl-3\" \"-Wl,-Bstatic\" \"-Wl,--whole-archive\" \"-l\" \"nl\" \"-Wl,--no-whole-archive\" \"-Wl,--start-group\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/libstd-774f1a5992f88ec5.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/libpanic_unwind-a65ab1ab71045d14.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/liballoc_jemalloc-5cced33d7a39db8e.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/libunwind-76fba694360269fc.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/liballoc_system-b3f660c2be971c37.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/liblibc-64d840c62d40ace0.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/liballoc-b3d8b67c899d207d.rlib\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/libcore-d9124265921c5963.rlib\" \"-Wl,--end-group\" \"/root/.rustup/toolchains/stable-armv7-unknown-linux-gnueabihf/lib/rustlib/armv7-unknown-linux-gnueabihf/lib/libcompiler_builtins-1aad7d9a81def783.rlib\" \"-Wl,-Bdynamic\" \"-l\" \"dl\" \"-l\" \"rt\" \"-l\" \"pthread\" \"-l\" \"pthread\" \"-l\" \"gcc_s\" \"-l\" \"c\" \"-l\" \"m\" \"-l\" \"rt\" \"-l\" \"pthread\" \"-l\" \"util\" \"-l\" \"util\"\n  = note: /root/derp/target/debug/build/derp-c3cdcf1fbd0c70b2/out/libnl.a(nl.o): In function `nl_test':\n          /root/derp/src/nl.c:6: undefined reference to `nl_socket_alloc'\n          /root/derp/src/nl.c:7: undefined reference to `nl_socket_free'\n          collect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c", "snmp", "net-snmp"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7952416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5c7c6db1d97ec15f74c1dbeff2a98e?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/7952416/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1532541574, "creation_date": 1532541574, "answer_id": 51525081, "question_id": 51524220, "link": "https://stackoverflow.com/questions/51524220/net-snmp-api-use-users-credentials/51525081#51525081", "title": "net-snmp api use user&#39;s credentials", "body": "<p>The issue was traced back to the daemon's service file not exporting the home directory needed for the daemon to parse the configuration file.</p>\n\n<p>So, in the service file, I added:</p>\n\n<pre><code>[Service]\n...\nEnvironment=HOME=/root\n...\n</code></pre>\n\n<p>Stopped the daemons, did a daemon-reload, and restarted my daemon process (and dependent processes). Behavior was as expected.</p>\n"}], "owner": {"reputation": 13, "user_id": 7952416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5c7c6db1d97ec15f74c1dbeff2a98e?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/7952416/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532541574, "creation_date": 1532538024, "question_id": 51524220, "link": "https://stackoverflow.com/questions/51524220/net-snmp-api-use-users-credentials", "title": "net-snmp api use user&#39;s credentials", "body": "<p>I have a program that makes SNMP calls to other machines. However, my current implementation for establishing the session has the credentials hard-coded, such as:</p>\n\n<pre><code>const char *our_v3_passphrase = \"The Net-SNMP Demo Password\";\n\n /*\n * Initialize the SNMP library\n */\ninit_snmp(\"snmpdemoapp\");\n\n/*\n * Initialize a \"session\" that defines who we're going to talk to\n */\nsnmp_sess_init( &amp;session );                   /* set up defaults */\nsession.peername = strdup(\"test.net-snmp.org\");\n\n/* set the SNMPv3 user name */\nsession.securityName = strdup(\"SHAUser\");\nsession.securityNameLen = strlen(session.securityName);\n\n/* set the security level to authenticated, but not encrypted */\nsession.securityLevel = SNMP_SEC_LEVEL_AUTHNOPRIV;\n\n/* set the authentication method to SHA */\nsession.securityAuthProto = usmHMACSHA1AuthProtocol;\nsession.securityAuthProtoLen = sizeof(usmHMACSHA1AuthProtocol)/sizeof(oid);\nsession.securityAuthKeyLen = USM_AUTH_KU_LEN;\n\n/* set the authentication key to a SHA hashed version of our\n   passphrase \"The Net-SNMP Demo Password\" (which must be at least 8\n   characters long) */\nif (generate_Ku(session.securityAuthProto,\n                session.securityAuthProtoLen,\n                (u_char *) our_v3_passphrase, strlen(our_v3_passphrase),\n                session.securityAuthKey,\n                &amp;session.securityAuthKeyLen) != SNMPERR_SUCCESS) {\n    snmp_perror(argv[0]);\n    snmp_log(LOG_ERR,\n             \"Error generating Ku from authentication pass phrase. \\n\");\n    exit(1);\n}\n\n/*\n * Open the session\n */\nss = snmp_open(&amp;session);          \n\nif (!ss) {\n  snmp_sess_perror(\"ack\", &amp;session);\n  SOCK_CLEANUP;\n  exit(1);\n}\n</code></pre>\n\n<p>I would like to derive the SNMP credentials from the machine instead of hard-coding them, using net-snmp's paths for resolving where configuration files are stored.</p>\n\n<p>I have a configuration file in ~/.snmp/snmp.conf that contains entries such as:</p>\n\n<pre><code>defVersion 3\ndefSecurityName SHAUser\ndefAuthPassphrase \"The Net-SNMP Demo Password\"\ndefAuthType SHA\ndefSecurityLevel authNoPriv\n</code></pre>\n\n<p>I can get this to work when I run the program by itself (removing the hard-coded credentials and just not setting securityName or generating the KU):</p>\n\n<pre><code> /*\n * Initialize the SNMP library\n */\ninit_snmp(\"snmpdemoapp\");\n\n/*\n * Initialize a \"session\" that defines who we're going to talk to\n */\nsnmp_sess_init( &amp;session );                   /* set up defaults */\nsession.peername = strdup(\"test.net-snmp.org\");\n/*\n * Open the session\n */\nss = snmp_open(&amp;session);          \n\nif (!ss) {\n  snmp_sess_perror(\"ack\", &amp;session);\n  SOCK_CLEANUP;\n  exit(1);\n}\n</code></pre>\n\n<p>but if I use this as part of a daemon, the credentials aren't being found. I verified the credentials weren't being derived by listening to tcp port 161 and observing the outgoing SNMP traffic being sent without the securityName being set (just blank).</p>\n\n<p>The service manager I'm using is systemd.</p>\n\n<p>My question is: How do I configure the net-snmp API such that it takes the credentials of the user running the program, when the program is ran as a daemon process?</p>\n"}, {"tags": ["c", "arrays", "printf"], "comments": [{"owner": {"reputation": 518, "user_id": 9930113, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8e-E84RDLBA/AAAAAAAAAAI/AAAAAAAACvg/JQBs3fP7dgo/photo.jpg?sz=128", "display_name": "involtus", "link": "https://stackoverflow.com/users/9930113/involtus"}, "edited": false, "score": 0, "creation_date": 1532535421, "post_id": 51523477, "comment_id": 90015875, "body": "it&#39;s the same if i change the <code>i&lt;=4&#39; to </code>i&lt;5<code>. Changing it to </code>i&lt;5` prints 6 dots which is equally strange but that has already been answered on another question. Thanks!"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 5, "creation_date": 1532535432, "post_id": 51523477, "comment_id": 90015879, "body": "You aren&#39;t NULL-terminating your string."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 7, "last_activity_date": 1532537777, "last_edit_date": 1532537777, "creation_date": 1532535428, "answer_id": 51523513, "question_id": 51523477, "link": "https://stackoverflow.com/questions/51523477/array-showing-random-characters-at-the-end/51523513#51523513", "title": "Array showing random characters at the end", "body": "<p><code>%s</code> with <code>printf()</code> expects a pointer to a  <em>string</em>, that is, pointer to the initial element of a null terminated character array. Your array is not null terminated.</p>\n\n<p>Thus, in search of the terminating null character, <code>printf()</code> goes out of bound, and subsequently, invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You have to null-terminate your array, if you want that to be used as a <em>string</em>.</p>\n\n<p>Quote: <code>C11</code>, chapter \u00a77.21.6.1, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p><code>s</code> </p>\n  \n  <p>If no l length modifier is present, the argument shall be a pointer to the initial element of an array of character type.<sup>280)</sup> Characters from the array are\n  written up to (but not including) the terminating null character. If the\n  precision is specified, no more than that many bytes are written. <strong>If the\n  precision is not specified or is greater than the size of the array, the array shall\n  contain a null character.</strong></p>\n</blockquote>\n\n<p><strong>Quick solution:</strong></p>\n\n<ul>\n<li>Increase the array size by 1, <code>char orig[6];</code>.</li>\n<li>Add a null -terminator in the end. After the loop body, add <code>orig[i] = '\\0';</code></li>\n</ul>\n\n<p>And then, print the result. </p>\n"}, {"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1532535706, "post_id": 51523520, "comment_id": 90015997, "body": "You don&#39;t have enough space for the null terminator"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1532535745, "post_id": 51523520, "comment_id": 90016019, "body": "<code>orig[i] = &#39;\\0&#39;;</code> is actually off by one."}, {"owner": {"reputation": 753, "user_id": 4751603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T7MnH.jpg?s=128&g=1", "display_name": "Gangai Johann", "link": "https://stackoverflow.com/users/4751603/gangai-johann"}, "edited": false, "score": 0, "creation_date": 1532536100, "post_id": 51523520, "comment_id": 90016180, "body": "From ascii table, <code>\\0</code> is char represented as <code>NUL &#39;\\0&#39; (null character)</code>"}], "tags": [], "owner": {"reputation": 753, "user_id": 4751603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T7MnH.jpg?s=128&g=1", "display_name": "Gangai Johann", "link": "https://stackoverflow.com/users/4751603/gangai-johann"}, "is_accepted": false, "score": 1, "last_activity_date": 1532536017, "last_edit_date": 1532536017, "creation_date": 1532535463, "answer_id": 51523520, "question_id": 51523477, "link": "https://stackoverflow.com/questions/51523477/array-showing-random-characters-at-the-end/51523520#51523520", "title": "Array showing random characters at the end", "body": "<p>You need to add a <code>NUL</code> character (<code>\\0</code>) at the end of your string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nmain()\n{\n  int  i,t;\n  char orig[6];\n\n  for(i=0;i&lt;=4;i++){\n    orig[i] = '.';\n  }\n\n  orig[i] = '\\0';\n  printf(\"%s\\n\", orig);\n}\n</code></pre>\n\n<p>If you do not know what <code>\\0</code> is, I strongly recommand you to check the ascii table (<a href=\"https://www.asciitable.com/\" rel=\"nofollow noreferrer\">https://www.asciitable.com/</a>).</p>\n\n<p>Good luck</p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 4, "last_activity_date": 1532537211, "last_edit_date": 1532537211, "creation_date": 1532535935, "answer_id": 51523650, "question_id": 51523477, "link": "https://stackoverflow.com/questions/51523477/array-showing-random-characters-at-the-end/51523650#51523650", "title": "Array showing random characters at the end", "body": "<pre><code>char orig[5];//creates an array of 5 char.  (with indices ranging from 0 to 4)\n\n|?|?|?|0|0|0|0|0|?|?|?|?|\n      |         ^memory you do not own (your mysterious characters)\n      ^start of orig\n\nfor(i=0;i&lt;=4;i++){  //attempts to populate array with '.'\n    orig[i] = '.';\n\n|?|?|?|.|.|.|.|.|?|?|?|?|\n      |         ^memory you do not own (your mysterious characters)\n      ^start of orig\n</code></pre>\n\n<p>This results in a non null terminated char array, which will invoke undefined behavior if used in a function that expects a C string.  C strings must contain enough space to allow for null termination.  Change your declaration to the following to accommodate.</p>\n\n<pre><code>char orig[6];\n</code></pre>\n\n<p>Then add the null termination to the end of your loop:</p>\n\n<pre><code>  ...\n  for(i=0;i&lt;=4;i++){\n    orig[i] = '.';\n  }\n  orig[i] = 0;\n</code></pre>\n\n<p>Resulting in:</p>\n\n<pre><code>|?|?|?|.|.|.|.|.|0|?|?|?|\n      |           ^memory you do not own\n      ^start of orig\n</code></pre>\n\n<p><em>Note</em>: Because the null termination results in a C string, the function using it knows how to interpret its contents (i.e. no undefined behavior), and your mysterious characters are held at bay.</p>\n"}, {"tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": false, "score": 1, "last_activity_date": 1533396781, "last_edit_date": 1533396781, "creation_date": 1532535944, "answer_id": 51523654, "question_id": 51523477, "link": "https://stackoverflow.com/questions/51523477/array-showing-random-characters-at-the-end/51523654#51523654", "title": "Array showing random characters at the end", "body": "<p><code>prinftf</code> takes starting pointer of any memory location, array in this case and print till it encounter a <code>\\0</code> character. These type of strings are called as <code>null</code> terminated strings. </p>\n\n<p>So please add a <code>\\0</code> at the end and put in characters till (size of array - 2) like this :</p>\n\n<pre><code>main(){\n  int i,t;\n  char orig[5];\n  for(i=0;i&lt;4;i++){ //less then size of array -1\n    orig[i] = '.';\n  }\n  orig[i] = '\\0'\n  printf(\"%s\\n\", orig);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1532543952, "post_id": 51523787, "comment_id": 90020014, "body": "Your answer contains a <i>very good</i> explanation of why many C functions that process strings require the strings to have null termination.  +1."}], "tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": false, "score": 2, "last_activity_date": 1532537283, "last_edit_date": 1532537283, "creation_date": 1532536462, "answer_id": 51523787, "question_id": 51523477, "link": "https://stackoverflow.com/questions/51523477/array-showing-random-characters-at-the-end/51523787#51523787", "title": "Array showing random characters at the end", "body": "<p>There is a difference between an array and a character array. You can consider a character array is an special case of array in which each element is of type <code>char</code> in C and the array should be ended (terminated) by a character <code>null</code> (<code>ASCII value 0</code>).</p>\n\n<p><code>%s</code> format specifier with <code>printf()</code> expects a pointer to a character array which is terminated by a <code>null</code> character. Your array is not null terminated and hence, <code>printf</code> function goes beyond 5 characters assigned by you and prints garbage values present after your 5th character ('.').  </p>\n\n<p>To solve your issues, you need to statically allocate the character array of size one more than the characters you want to store. In your case, a character array of size 6 will work.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(){\n  int i,t;\n  char orig[6]; // If you want to store 5 characters, allocate an array of size 6 to store null character at last position.\n\n  for (i=0; i&lt;=4; i++) {\n    orig[i] = '.';\n  }\n\n  orig[5] = '\\0';\n\n  printf(\"%s\\n\", orig);\n}\n</code></pre>\n\n<p>There is a reason to waste one extra character space for the null character. The reason being whenever you pass any array to a function, then only pointer to first element is passed to the function (pushed in function's stack). This makes for a function impossible to determine the end of the array (means operators like <code>sizeof</code> won't work inside the function and <code>sizeof</code> will return the size of the pointer in your machine). That is the reason, functions like <code>memcpy</code>, <code>memset</code> takes an additional function arguments which mentions the array sizes (or the length upto which you want to operate). </p>\n\n<p>However, using character array, function can determine the size of the array by looking for a special character (<code>null</code> character).</p>\n"}], "owner": {"reputation": 518, "user_id": 9930113, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8e-E84RDLBA/AAAAAAAAAAI/AAAAAAAACvg/JQBs3fP7dgo/photo.jpg?sz=128", "display_name": "involtus", "link": "https://stackoverflow.com/users/9930113/involtus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 51523513, "answer_count": 5, "score": 3, "last_activity_date": 1533396781, "creation_date": 1532535291, "last_edit_date": 1532535765, "question_id": 51523477, "link": "https://stackoverflow.com/questions/51523477/array-showing-random-characters-at-the-end", "title": "Array showing random characters at the end", "body": "<p>I wanted to test things out with arrays on C as I'm just starting to learn the language. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain(){\n  int i,t;\n  char orig[5];\n  for(i=0;i&lt;=4;i++){\n    orig[i] = '.';\n  }\n\n  printf(\"%s\\n\", orig);\n}\n</code></pre>\n\n<p>Here is my output:</p>\n\n<pre><code>.....\ufffd\n</code></pre>\n\n<p>It is exactly that. What are those mysterious characters? What have i done wrong?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 5, "creation_date": 1532534660, "post_id": 51523276, "comment_id": 90015473, "body": "In <code>strcpy(ops1, &amp;temp);</code>, <code>&amp;temp</code> is not a pointer to a null-terminated string."}, {"owner": {"reputation": 1318, "user_id": 42552, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d3d8778bfd7699f34e9346683b4458db?s=128&d=identicon&r=PG", "display_name": "JosephDoggie", "link": "https://stackoverflow.com/users/42552/josephdoggie"}, "edited": false, "score": 1, "creation_date": 1532534667, "post_id": 51523276, "comment_id": 90015481, "body": "Please add motivation for what this does and why.  Perhaps there is a better way?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1532534827, "post_id": 51523276, "comment_id": 90015560, "body": "Why do you need this <code>strcpy</code> at all?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1532535320, "post_id": 51523276, "comment_id": 90015827, "body": "For minimal changes, I suggest making <code>temp</code> a 2 char array and set <code>temp[1] = &#39;\\0&#39;;</code> to null-terminate it. (Other code changes involving <code>temp</code> are required after changing it to an array, but those should be pretty obvious.)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10062575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tVtKlpHp864/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7os7BwxjwroCuaw4tTpCOvR5p7aJQ/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10062575/anonymous"}, "edited": false, "score": 0, "creation_date": 1532608413, "post_id": 51523867, "comment_id": 90045393, "body": "Thanks. Actually, I knew this way is better. But I couldn&#39;t figure out what goes wrong with my code."}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 1, "last_activity_date": 1532536768, "creation_date": 1532536768, "answer_id": 51523867, "question_id": 51523276, "link": "https://stackoverflow.com/questions/51523276/seg-fault-due-to-strcpy-and-strcat/51523867#51523867", "title": "Seg fault due to strcpy and strcat", "body": "<p>You don't need <code>strcpy()</code> and <code>strcat()</code> in case of single character . You can directly copy by help of <strong>index</strong> like <code>ops1[j] = string[i];</code>.</p>\n\n<p>Also you forget to add <code>ops1[j] = '\\0';</code> string terminator. You need to specify <code>\\0</code> to end a string.</p>\n\n<p>Your <code>while(string[i] != ' ')</code> will not end <code>(is an infinite loop)</code> because <code>i</code> is not changing in that loop. This problem can be solved with help of a single loop.</p>\n\n<p>Try this code :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char string[30], ops1[30];\n    char t[2];\n    int op1, i, j;\n    strcpy(string, \"hey ssup\");\n\n    j = 0;\n    i = 0;\n    while (string[i] != '\\0')\n    {\n        ops1[j++] = string[i]; // coping\n\n        if (string[i] == ' ')  // stops when first ' ' found\n        {\n            break;\n        }\n        i++;\n    }\n    ops1[j] = '\\0';\n    printf(\"%s\", ops1);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output :-</strong></p>\n\n<pre><code>hey\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1532540783, "post_id": 51524548, "comment_id": 90018532, "body": "<code>strcpy(&amp;ops1[i], &amp;temp)</code> is just as wrong here as in the original question."}, {"owner": {"reputation": 264, "user_id": 8228063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXfbv.jpg?s=128&g=1", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/8228063/sarthak"}, "reply_to_user": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1532543139, "post_id": 51524548, "comment_id": 90019666, "body": "@mlp Can you tell me the error in this cause it prints correct output."}, {"owner": {"reputation": 19, "user_id": 10062575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tVtKlpHp864/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7os7BwxjwroCuaw4tTpCOvR5p7aJQ/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10062575/anonymous"}, "edited": false, "score": 0, "creation_date": 1532609141, "post_id": 51524548, "comment_id": 90045853, "body": "Yes, it works. Thanks. But if &quot;string&quot; is scanned instead of hard-coding it, it seg  faults again. I guess it has to do something with the compiler."}, {"owner": {"reputation": 264, "user_id": 8228063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXfbv.jpg?s=128&g=1", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/8228063/sarthak"}, "edited": false, "score": 0, "creation_date": 1532702074, "post_id": 51524548, "comment_id": 90087198, "body": "I don&#39;t think so ...you can use scanf(&quot;%[^\\n]%*c&quot;,string) for scanning a string and it will work perfectly."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1535395093, "post_id": 51524548, "comment_id": 91041238, "body": "The second argument to <code>strcpy()</code> must be a pointer to a NUL-terminated array of <code>char</code>; <code>&amp;temp</code> is <i>not</i> such a thing."}], "tags": [], "owner": {"reputation": 264, "user_id": 8228063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXfbv.jpg?s=128&g=1", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/8228063/sarthak"}, "is_accepted": false, "score": -1, "last_activity_date": 1532540841, "last_edit_date": 1532540841, "creation_date": 1532539422, "answer_id": 51524548, "question_id": 51523276, "link": "https://stackoverflow.com/questions/51523276/seg-fault-due-to-strcpy-and-strcat/51524548#51524548", "title": "Seg fault due to strcpy and strcat", "body": "<p><strong>you are getting seg fault because of the second while loop, correct code is below</strong></p>\n\n<pre><code>    int main()\n\n    {\n\n    char string[30], ops1[30], temp;\n    char t[2];\n    int  i=0;\n    strcpy(string, \"hey ssup\");\n    while(1) \n      {\n        if(string[i]!= ' ')\n          {\n            temp = string[i];\n            strcpy(&amp;ops1[i], &amp;temp);\n\n\n           }    \n       else\n         {\n          ops1[i]='\\0';\n        break;\n           }\n        i++;\n\n         }\n    printf(\"%s\\n\", ops1);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10062575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tVtKlpHp864/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7os7BwxjwroCuaw4tTpCOvR5p7aJQ/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10062575/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532540841, "creation_date": 1532534511, "last_edit_date": 1532534877, "question_id": 51523276, "link": "https://stackoverflow.com/questions/51523276/seg-fault-due-to-strcpy-and-strcat", "title": "Seg fault due to strcpy and strcat", "body": "<p>Why do I get segfualt in the code below? I expect it to print the first word \"hey\". I know there are other ways to do what I am trying to do, but I wonder why this fails. Please help.</p>\n\n<pre><code>int main(){\n    char string[30], ops1[30], temp;\n    char t[2];\n    int op1, i=0;\n    strcpy(string, \"hey ssup\");\n    while(string[i] != '\\0') {\n        if(string[i]!= ' '){\n            temp = string[i];\n            strcpy(ops1, &amp;temp);\n            i++;\n            while(string[i] != ' ') {\n                temp = string[i];\n                strcpy(t, &amp;temp);\n                strcat(ops1, t);\n            }\n        }\n        i++;\n    }\n    printf(\"%s\", ops1);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "dev-c++"], "comments": [{"owner": {"reputation": 1493, "user_id": 10032505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/clhpj.jpg?s=128&g=1", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/10032505/mohammad"}, "edited": false, "score": 2, "creation_date": 1532535171, "post_id": 51523265, "comment_id": 90015733, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24881/how-do-i-fix-for-loop-initial-declaration-used-outside-c99-mode-gcc-error\">How do I fix &quot;for loop initial declaration used outside C99 mode&quot; GCC error?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10114092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDgVH.jpg?s=128&g=1", "display_name": "Muhammad Ahmed", "link": "https://stackoverflow.com/users/10114092/muhammad-ahmed"}, "edited": false, "score": 0, "creation_date": 1532534931, "post_id": 51523312, "comment_id": 90015615, "body": "got it! do the same error occurs in Turbo C++ and Microsoft Visual Studio ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 29, "user_id": 10114092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDgVH.jpg?s=128&g=1", "display_name": "Muhammad Ahmed", "link": "https://stackoverflow.com/users/10114092/muhammad-ahmed"}, "edited": false, "score": 1, "creation_date": 1532534995, "post_id": 51523312, "comment_id": 90015643, "body": "@MuhammadAhmed Yes, though I would advise <i>not</i> to use Turbo C as it is <b>very</b> outdated."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1532534809, "last_edit_date": 1532534809, "creation_date": 1532534637, "answer_id": 51523312, "question_id": 51523265, "link": "https://stackoverflow.com/questions/51523265/error-in-for-loop-c-language-in-dev-c/51523312#51523312", "title": "Error in for loop (C language) in Dev C++", "body": "<p>Declaring a variable in the first part of a <code>for</code> loop was a feature added to C as part of the C99 standard.  However, most compilers by default use the old C89 standard that don't support this construct.</p>\n\n<p>You need to move the declaration of <code>i</code> outside of the <code>for</code> loop:</p>\n\n<pre><code>int i;\nfor(i=0;i&lt;=10;i++)\n{\n    ...\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10114092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDgVH.jpg?s=128&g=1", "display_name": "Muhammad Ahmed", "link": "https://stackoverflow.com/users/10114092/muhammad-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1491, "favorite_count": 1, "accepted_answer_id": 51523312, "answer_count": 1, "score": 0, "last_activity_date": 1532534809, "creation_date": 1532534472, "question_id": 51523265, "link": "https://stackoverflow.com/questions/51523265/error-in-for-loop-c-language-in-dev-c", "title": "Error in for loop (C language) in Dev C++", "body": "<p>I'm having problem in running this code in <strong>Dev C++</strong>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nmain()\n{\n    /*\n    Write a program to calculate overtime pay of 10 employees.\n    Overtime is paid at the rate of Rs. 12.00 per hour for every hour worked above 40 hours. \n    Assume that employees do not work for fractional part of an hour.\n    */\n\n    int sal,pay,re;\n\n    for(int i=0;i&lt;=10;i++)\n    {\n        printf(\"Write down your over time(in hours):    \");\n        scanf(\"%d\",&amp;sal);\n        re = sal - 40;\n        pay = re * 12;\n        printf(\"Your pay is %d \",pay);\n    }\n\n}\n</code></pre>\n\n<p>I'm receiving the following error</p>\n\n<blockquote>\n  <p>[Error] 'for' loop initial declarations are only allowed in C99 or C11 mode</p>\n</blockquote>\n"}, {"tags": ["c", "google-cloud-platform", "malloc", "google-cloud-error-reporting"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1532534167, "post_id": 51523093, "comment_id": 90015228, "body": "Other programs, including the OS, consume some memory, too. Without having used google cloud engine before, I would assume that counts towards your quota."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1532536165, "post_id": 51523093, "comment_id": 90016205, "body": "Don&#39;t use <code>malloc</code> in C++ programs."}], "answers": [{"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1532535391, "post_id": 51523300, "comment_id": 90015864, "body": "Why would malloc be limited by physical memory?  It is asking for address space, not physical memory..."}, {"owner": {"reputation": 1193, "user_id": 1347817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ded00eca8a936bc0cd1fd8d82fbb2752?s=128&d=identicon&r=PG", "display_name": "mmccaff", "link": "https://stackoverflow.com/users/1347817/mmccaff"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1532536408, "post_id": 51523300, "comment_id": 90016323, "body": "@Yakk-AdamNevraumont malloc asks for a virtual address space, but if swap space is not configured at an os level, isn&#39;t it then limited by physical resources?"}, {"owner": {"reputation": 1167, "user_id": 7586189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e805c3d53c754785d05a137f41a0c6?s=128&d=identicon&r=PG&f=1", "display_name": "user7586189", "link": "https://stackoverflow.com/users/7586189/user7586189"}, "edited": false, "score": 1, "creation_date": 1532536463, "post_id": 51523300, "comment_id": 90016341, "body": "@mmccaff, you are quite right, swap space is NOT configured! according to the result of free"}, {"owner": {"reputation": 1167, "user_id": 7586189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e805c3d53c754785d05a137f41a0c6?s=128&d=identicon&r=PG&f=1", "display_name": "user7586189", "link": "https://stackoverflow.com/users/7586189/user7586189"}, "edited": false, "score": 0, "creation_date": 1532537197, "post_id": 51523300, "comment_id": 90016698, "body": "and by default, Compute Engine instances do not have any swap space. Thank you!"}], "tags": [], "owner": {"reputation": 1193, "user_id": 1347817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ded00eca8a936bc0cd1fd8d82fbb2752?s=128&d=identicon&r=PG", "display_name": "mmccaff", "link": "https://stackoverflow.com/users/1347817/mmccaff"}, "is_accepted": true, "score": 2, "last_activity_date": 1532534583, "creation_date": 1532534583, "answer_id": 51523300, "question_id": 51523093, "link": "https://stackoverflow.com/questions/51523093/memory-allocation-c-programming-limit-on-google-cloud-engine/51523300#51523300", "title": "memory allocation (C programming) limit on Google cloud engine", "body": "<p>Use the <code>free</code> command to see how much free memory you have. It will also show how much swap space you have available.</p>\n\n<p>The server might be configured for 13GB memory, but surely other things (like the OS) are using memory for other things, and not all 13GB are available for your application.</p>\n\n<p>Are you expecting to be able to malloc more memory than you have physically available, using swap space?</p>\n"}], "owner": {"reputation": 1167, "user_id": 7586189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81e805c3d53c754785d05a137f41a0c6?s=128&d=identicon&r=PG&f=1", "display_name": "user7586189", "link": "https://stackoverflow.com/users/7586189/user7586189"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 51523300, "answer_count": 1, "score": 0, "last_activity_date": 1532537434, "creation_date": 1532533815, "last_edit_date": 1532537434, "question_id": 51523093, "link": "https://stackoverflow.com/questions/51523093/memory-allocation-c-programming-limit-on-google-cloud-engine", "title": "memory allocation (C programming) limit on Google cloud engine", "body": "<p>The configuration of the Google cloud engine is 2 vCPUs, 13 GB memory, ubuntu-1604.</p>\n\n<p>It seems that the max memory size \"malloc\" can allocate is a bit less than 13GB (12GB in the following example works, mallocing 12.5GB would fail..). Is this because that the virtual memory is somehow not turned on? Any other possible reasons?</p>\n\n<pre><code>  unsigned long input_size = 1024*1024*1024*3;\n  unsigned int *h_data = (unsigned int *)malloc(input_size*sizeof(unsigned int));\n</code></pre>\n"}, {"tags": ["c", "user-input"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1532533653, "post_id": 51522978, "comment_id": 90014914, "body": "When the user enters &quot;1&quot; they ultimately enter two characters: <code>&#39;1&#39;</code> and newline character <code>&#39;\\n&#39;</code>. The latter is generated by <code>Enter</code> key. Your &quot;ERROR&quot; message is the reaction to that <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1532533654, "post_id": 51522978, "comment_id": 90014916, "body": "<a href=\"https://stackoverflow.com/q/29658685/2173917\">related</a>?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1532533664, "post_id": 51522978, "comment_id": 90014923, "body": "You also never bother to check if <code>scanf()</code> actually reads a character.  That will cause all kinds of problems for more complex code."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532534193, "post_id": 51522978, "comment_id": 90015239, "body": "Please don&#39;t post code with line numbers."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1532534492, "post_id": 51522978, "comment_id": 90015390, "body": "@AnT - yes you got it very correct. kelp99 - Also, Please use switch case when you have a long ladder of if else if. Like in this case."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 5, "last_activity_date": 1532533738, "creation_date": 1532533738, "answer_id": 51523060, "question_id": 51522978, "link": "https://stackoverflow.com/questions/51522978/why-are-my-if-else-statements-not-working/51523060#51523060", "title": "Why are my if/else statements not working?", "body": "<p>The <code>%c</code> format specifier to <code>scanf</code> accepts <strong>any</strong> single character, including a space or newline.  </p>\n\n<p>If for example the user inputs \"1\", they are actually sending the character \"1\" <em>and</em> a newline character.  The \"1\" character is read of the first iteration of the loop and the newline stays in the input buffer.  On the next iteration, <code>scanf</code> immediately reads the newline in the buffer.  And because the character code for a newline doesn't match any of your <code>if</code> cases, it falls through to the <code>else</code>.</p>\n\n<p>Change the <code>scanf</code> call to add a leading space.  That will consume any whitespace:</p>\n\n<pre><code>scanf(\" %c\", &amp;num);\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1532534490, "answer_count": 1, "score": -1, "last_activity_date": 1532541393, "creation_date": 1532533474, "last_edit_date": 1532541393, "question_id": 51522978, "link": "https://stackoverflow.com/questions/51522978/why-are-my-if-else-statements-not-working", "closed_reason": "Duplicate", "title": "Why are my if/else statements not working?", "body": "<p>I'm starting to write code for a small bank account program, but my if/else statements aren't working. At the top of the loop, I use <code>scanf</code> to get user input about which option needs to be executed next. The first one always works, but after that, the error statements always get printed.</p>\n\n<p>For example, the user types <code>1</code>. What gets printed is:</p>\n\n<pre><code>case 1\nERROR, please try again\n</code></pre>\n\n<p>Only case 1 should be printing, why is the Error message printing too? I tried using <code>switch case</code> statements but that didn't work either. </p>\n\n<hr>\n\n<p><strong>Here's my code:</strong></p>\n\n<pre><code>char num = '7';\nwhile (1) {\n    if(num == '7') {  \n        printf(\"0. Exit\\n1. Deposit\\n2. Withdrawal\\n3. Add account\\n\");\n        printf(\"4. Remove account\\n5. Balance inquiry\\n6. View accounts\\n\");\n        printf(\"Enter option: (0/1/2/3/4/5/6)\\n\");\n        scanf(\"%c\", &amp;num);\n    }\n    else if (num == '0') {\n        exit(0);\n    }\n    else if (num == '1') {\n        printf(\"case 1\\n\");\n        num = '7';\n    }\n    else if (num == '2') {\n        printf(\"case 2\\n\");\n        num = '7';\n    }\n    else if (num == '3') {\n        printf(\"case 3\\n\");\n        num = '7';\n    }\n    else if (num == '4') {\n        printf(\"case 4\\n\");\n        num = '7';\n    }\n    else if (num == '5') {\n        printf(\"case 5\\n\");\n        num = '7';\n    }\n    else if (num == '6') {\n        printf(\"case 6\\n\");\n        num = '7';\n    }\n    else {\n        printf(\"ERROR, please try again\\n\");\n        num = '7';\n    } \n}\n</code></pre>\n"}, {"tags": ["c", "memory-access"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1532531316, "post_id": 51522213, "comment_id": 90013356, "body": "This is undefined behavior as it breaks strict aliasing."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1532531479, "creation_date": 1532531479, "answer_id": 51522327, "question_id": 51522213, "link": "https://stackoverflow.com/questions/51522213/c-access-memory-directly-using-address/51522327#51522327", "title": "C - access memory directly using address?", "body": "<p>The ordering of bytes within a datatype is known as <strong>endianness</strong> and is system specific.  What you describe with the least significant byte (LSB) first is called <strong>little endian</strong> and is what you would find on x86 based processors.</p>\n\n<p>As for accessing particular bytes of a representation, you can use a pointer to an <code>unsigned char</code> to point to the variable in question to view the specific bytes.  For example:</p>\n\n<pre><code> float num = 3.15;\n unsigned char *p = (unsigned char *)&amp;num;\n int i;\n\n for (i=0; i&lt;sizeof(num); i++) {\n     printf(\"byte %d = %02x\\n\", i, p[i]);\n}\n</code></pre>\n\n<p>Note that this is only allowed to access bytes via a character pointer, not an <code>int *</code>, as the latter violates strict aliasing.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10134002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BvWU.jpg?s=128&g=1", "display_name": "jonathan", "link": "https://stackoverflow.com/users/10134002/jonathan"}, "edited": false, "score": 0, "creation_date": 1532587838, "post_id": 51522377, "comment_id": 90032870, "body": "Thanks for the reply. I had confusion in the questions above and I found the answer was endianness. When I added line &quot; char *ptr2 = (char *)&amp;num; &quot; at the end and checked the output with integer type it always gave me -102 whereas I expected 64(0100000 in binary). It actually pointed the fourth 8 bits(10011010). Problem solved :)"}], "tags": [], "owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "is_accepted": true, "score": 1, "last_activity_date": 1532531628, "creation_date": 1532531628, "answer_id": 51522377, "question_id": 51522213, "link": "https://stackoverflow.com/questions/51522213/c-access-memory-directly-using-address/51522377#51522377", "title": "C - access memory directly using address?", "body": "<p>The code you wrote is not actually valid C.  C has a rule called \"strict aliasing,\" which states that if a region of memory contains a value of one type (i.e. <code>float</code>), it cannot be accessed as though it was another type (i.e. <code>int</code>).  This rule has its origins in some performance optimizations that let the compiler generate faster code.  I can't say it's an obvious rule, but it's the rule.</p>\n\n<p>You can work around this by using <code>union</code>.  If you make a union like <code>union { float num, int numAsInt }</code>, you can store a float and then read it as an integer.  The result is <em>unspecified</em>.  Alternatively, you are always permitted to access the bytes of a value as chars (just not anything larger).  <code>char</code> is given special treatment (presumably to make it so you can copy a buffer of data as bytes, then cast it to your data's type and access it, which is something that happens a lot in low level code like network stacks).</p>\n\n<p>Welcome to a fun corner of learning C.  There's <em>unspecified</em> behavior and <em>undefined</em> behavior.  Informally, unspecified behavior says \"we won't say what happens, but it will be reasonable.\"  The C spec will not say what order the bytes are in.  But it will say that you will get some bytes.  Undefined behavior is nastier.  Undefined behavior says <em>anything</em> can happen, ranging from compiler errors to exceptions at runtime, to absolutely nothing at all (making you think your code is valid when it is not).</p>\n\n<p>As for the values, dbush points out in his answer that the order of the bytes is defined by the platform you are on.  You are seeing a \"little endian\" representation of a IEE754 floating point number.  On other platforms, it may be different.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1532532481, "creation_date": 1532532481, "answer_id": 51522674, "question_id": 51522213, "link": "https://stackoverflow.com/questions/51522213/c-access-memory-directly-using-address/51522674#51522674", "title": "C - access memory directly using address?", "body": "<p>Union punning is much safer:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef     union\n    {\n        unsigned char uc[sizeof(double)];\n        float f;\n        double d;\n    }u_t;\n\nvoid print(u_t u, size_t size, int endianess)\n{\n    size_t start = 0;\n    int increment = 1;\n\n    if(endianess)\n    {\n        start = size - 1;\n        increment = -1;\n    }\n\n    for(size_t index = 0; index &lt; size; index++)\n    {\n        printf(\"%hhx \", u.uc[start]);\n        start += increment;\n    }\n    printf(\"\\n\");\n}\n\n\nint main(void) \n{\n    u_t u;  \n    u.f = 3.15f;\n\n    print(u, sizeof(float),0);\n    print(u, sizeof(float),1);\n\n    u.d = 3.15;\n    print(u, sizeof(double),0);\n    print(u, sizeof(double),1);\n    return 0;\n}\n</code></pre>\n\n<p>you can test it yourself: <a href=\"https://ideone.com/7ABZaj\" rel=\"nofollow noreferrer\">https://ideone.com/7ABZaj</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10134002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BvWU.jpg?s=128&g=1", "display_name": "jonathan", "link": "https://stackoverflow.com/users/10134002/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 51522377, "answer_count": 3, "score": 0, "last_activity_date": 1532532767, "creation_date": 1532531180, "last_edit_date": 1532532767, "question_id": 51522213, "link": "https://stackoverflow.com/questions/51522213/c-access-memory-directly-using-address", "title": "C - access memory directly using address?", "body": "<p>I've been lightly studying C for a few weeks now with some book.</p>\n\n<pre><code>int main(void)\n{\n    float num = 3.15;\n    int *ptr = (int *)&amp;num; //so I can use line 8 and 10\n\n    for (int i = 0; i &lt; 32; i++)\n    {\n        if (!(i % 8) &amp;&amp; (i / 8))\n            printf(\" \");\n        printf(\"%d\", *ptr &gt;&gt; (31 - i) &amp; 1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>output : 01000000 01001001 10011001 10011010\n</code></pre>\n\n<p>As you see <code>3.15</code> in single precision <code>float</code> is <code>01000000 01001001 10011001 10011010</code>.\nSo let's say <code>ptr</code> points to address <code>0x1efb40</code>.</p>\n\n<p><strong>Here are the questions:</strong></p>\n\n<ol>\n<li><p>As I understood in the book, first 8 bits of <code>num</code> data is stored in <code>0x1efb40</code>, 2nd 8 bits in <code>0x1efb41</code>, next 8 bits in <code>0x1efb42</code> and last 8 bits in <code>0x1efb43</code>. Am I right?</p></li>\n<li><p>If I'm right, is there any way I can directly access the 2nd 8 bits with hex address value <code>0x1efb41</code>? Thereby can I change the data to something like <code>11111111</code>?</p></li>\n</ol>\n"}, {"tags": ["c", "operating-system", "locks", "test-and-set"], "comments": [{"owner": {"reputation": 20747, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1532530924, "post_id": 51522009, "comment_id": 90013063, "body": "The book is likely assuming that such a case is a coding mistake that should never happen."}, {"owner": {"reputation": 339, "user_id": 7176819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RVIgMnC3xPY/AAAAAAAAAAI/AAAAAAAAA0w/10m1bsn9GUs/photo.jpg?sz=128", "display_name": "Aviral Verma", "link": "https://stackoverflow.com/users/7176819/aviral-verma"}, "reply_to_user": {"reputation": 20747, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1532531636, "post_id": 51522009, "comment_id": 90013616, "body": "Thanks! I was not sure if they assume it to be a coding mistake or if it was something that I missed. I&#39;m sure the actual code for such lock would be much more complicated."}], "owner": {"reputation": 339, "user_id": 7176819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RVIgMnC3xPY/AAAAAAAAAAI/AAAAAAAAA0w/10m1bsn9GUs/photo.jpg?sz=128", "display_name": "Aviral Verma", "link": "https://stackoverflow.com/users/7176819/aviral-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532530999, "creation_date": 1532530543, "last_edit_date": 1532530999, "question_id": 51522009, "link": "https://stackoverflow.com/questions/51522009/implementation-of-a-lock-using-test-and-set", "title": "Implementation of a lock using test and set", "body": "<p>Below is the code is given in <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\">OSTEP book</a> regarding the implementation of a lock using test and set instruction. My question is that in such implementation, couldn't a thread that is not holding the lock call the unlock function and take away the lock?</p>\n\n<pre><code>typedef struct __lock_t {\n int flag;\n } lock_t;\n\n void init(lock_t *lock) {\n // 0 indicates that lock is available, 1 that it is held\n lock-&gt;flag = 0;\n }\n\n void lock(lock_t *lock) {\n while (TestAndSet(&amp;lock-&gt;flag, 1) == 1)\n ; // spin-wait (do nothing)\n }\n\n void unlock(lock_t *lock) {\n lock-&gt;flag = 0;\n }\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio"], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 1, "last_activity_date": 1532531837, "creation_date": 1532531837, "answer_id": 51522448, "question_id": 51521356, "link": "https://stackoverflow.com/questions/51521356/multiple-dllmain-functions/51522448#51522448", "title": "Multiple DLLMain functions", "body": "<p>Rename one of the <code>DLLMain</code> functions to something else (I'll call it <code>CDLLMain</code>), then call that renamed function from the other <code>DLLMain</code>.  Care must be taken when deciding where to make the call to <code>CDLLMain</code> (first thing in <code>DLLMain</code>, last before returning (if safe to do so), or somewhere in the middle), in handling the return value from it (can you continue in <code>DLLMain</code> or do you need to return), and potential duplicated effort in the two <code>DLLMain</code> functions.</p>\n"}, {"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1532532430, "creation_date": 1532532430, "answer_id": 51522655, "question_id": 51521356, "link": "https://stackoverflow.com/questions/51521356/multiple-dllmain-functions/51522655#51522655", "title": "Multiple DLLMain functions", "body": "<p>If you cannot change the C source create a second DLL project and have your C++-based DLL depend on that second library. Each DLL can have a DllMain of its own. You could even use forwarding exports so that it appears that your C++ DLL exports the symbols from the secondary library.</p>\n\n<p>A forwarding export is done with the following in your library's .DEF file:</p>\n\n<pre><code>EXPORTS\nEntryName=realldll.RealEntryName\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532532430, "creation_date": 1532528687, "last_edit_date": 1532528991, "question_id": 51521356, "link": "https://stackoverflow.com/questions/51521356/multiple-dllmain-functions", "title": "Multiple DLLMain functions", "body": "<p>I have a C++ program that has a <code>DLLMain</code> function that runs some code when this program (which is actually a DLL) is loaded by another one. This is working fine.</p>\n\n<p>Now, when I compile this same C++ program this time including an <code>.obj</code> file (made from C code) that already has a <code>DLLMain</code> function defined, the compiler (in this case, VS2010 for Windows) complains that the <code>DLLMain</code> is already defined.</p>\n\n<p>Without using the linker flag <code>/FORCE:MULTIPLE</code> how can one have both <code>DLLMain</code> functions (defined in the C and the C++ programs) coexisting and running in the same final DLL?</p>\n\n<p>FYI, in GCC for Linux using <code>static void __attribute__((constructor)) _my_initializer(void)</code> works fine (i.e. both initializers can coexist in the same final <code>.so</code> file and run).</p>\n"}, {"tags": ["c", "struct", "memcpy"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1532523645, "post_id": 51519549, "comment_id": 90007789, "body": "This attribute does nothing with regards to <i>strict aliasing</i> rule."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1532525863, "post_id": 51519549, "comment_id": 90009388, "body": "It depends on details of code use not discussed.  Post samples of the code expressing your ideas to add clarity."}, {"owner": {"reputation": 69, "user_id": 10092274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604afb6082e9cb70cc4b99a9d827b9de?s=128&d=identicon&r=PG&f=1", "display_name": "camixetew", "link": "https://stackoverflow.com/users/10092274/camixetew"}, "edited": false, "score": 0, "creation_date": 1532525934, "post_id": 51519549, "comment_id": 90009432, "body": "I&#39;ll get back home and I&#39;ll try to post clarify it more"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532526537, "post_id": 51519549, "comment_id": 90009871, "body": "A <i>byte</i> buffer? That would be some <code>char []</code>? A <code>char *</code> is allowed to alias any other pointer, it&#39;s an explicit exception from the strict aliasing rule. So you can cast a pointer to your struct to <code>char *</code> -- and back as well as long as the original definition is &quot;visible&quot;. For a real answer, <b>we need to see code</b>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1532527209, "post_id": 51519549, "comment_id": 90010400, "body": "@EugeneSh.: OP does not say they expect the packed attribute to allow aliasing of the structure. They say they are copying the bytes to the packed structure using memcpy. Hence they insert the bytes into the structure using memcpy, which is supported by C, and then access the structure via its nominal type, which is support and which is not aliasing. (There is aliasing in that the bytes of the structure are accessed as bytes via memcpy, but that is supported.)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532527307, "post_id": 51519549, "comment_id": 90010469, "body": "@EricPostpischil I just stated that this specific attribute does not remove the rule violation in case it is already there, as aliasing and packing are orthogonal."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1532527565, "creation_date": 1532527565, "answer_id": 51520968, "question_id": 51519549, "link": "https://stackoverflow.com/questions/51519549/c-memcpy-byte-buffer-to-packed-struct-good-decision/51520968#51520968", "title": "C memcpy byte buffer to packed struct, good decision?", "body": "<p>If you have ensured that the packed structure lays out the bytes as desired on all the target platforms you wish to support, then copying the bytes into the structure via <code>memcpy</code> and then accessing them through the structure members is fine.</p>\n\n<p>Depending on circumstances, it may be advisable to copy the structure members to a normal (not packed) structure for further use, so that unaligned members in the packed structure are not repeatedly accessed, which may be inefficient. Ultimately, this may be equivalent to issuing multiple <code>memcpy</code> calls to copy bytes from the buffer into individual members of the normal structure.</p>\n\n<p>Using <code>memcpy</code> is certainly at least as efficient as parsing the buffer, as <code>memcpy</code> is about the simplest thing one can do with data. But whether it is more efficient or just the same depends on what sort of parsing you would be doing. Once you have the data in a structure, you will still have to operate on it in whatever ways your application requires anyway, so the <code>memcpy</code> would not seem to eliminate any real work that must be done.</p>\n"}], "owner": {"reputation": 69, "user_id": 10092274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604afb6082e9cb70cc4b99a9d827b9de?s=128&d=identicon&r=PG&f=1", "display_name": "camixetew", "link": "https://stackoverflow.com/users/10092274/camixetew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532527565, "creation_date": 1532523589, "question_id": 51519549, "link": "https://stackoverflow.com/questions/51519549/c-memcpy-byte-buffer-to-packed-struct-good-decision", "title": "C memcpy byte buffer to packed struct, good decision?", "body": "<p>I am aware that type casting a buffer to struct is violating strict aliasing rule and that it's not portable</p>\n\n<p>However is memcpy() a buffer to struct <strong>with attribute packed</strong> not voiding that rule, is it a good decision rather then parsing the contents of the buffer ? Lets keep in mind that both always have a fixed size</p>\n"}, {"tags": ["c", "string", "char"], "comments": [{"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "edited": false, "score": 1, "creation_date": 1532524262, "post_id": 51519406, "comment_id": 90008209, "body": "Not &amp;s just s because s already gets decayed to pointer."}, {"owner": {"reputation": 5359, "user_id": 7851115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uyswM.jpg?s=128&g=1", "display_name": "Joshua Detwiler", "link": "https://stackoverflow.com/users/7851115/joshua-detwiler"}, "edited": false, "score": 0, "creation_date": 1532524781, "post_id": 51519406, "comment_id": 90008553, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s\">What is the difference between char s&#91;&#93; and char *s?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1532525675, "post_id": 51519406, "comment_id": 90009239, "body": "Note: <code>fgets(str,20,stdin); </code> reads the prior line&#39;s left-over <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1532525719, "post_id": 51519406, "comment_id": 90009279, "body": "Post the input used (including &lt;Enter&gt;) and output seen  and expected."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 0, "last_activity_date": 1532527678, "last_edit_date": 1532527678, "creation_date": 1532527119, "answer_id": 51520805, "question_id": 51519406, "link": "https://stackoverflow.com/questions/51519406/trying-to-print-char-string-terminated-with-space-and-string-terminated-with-new/51520805#51520805", "title": "Trying to print char,string terminated with space and string terminated with new line in a single program", "body": "<p><code>scanf()</code> actually <strong>parses</strong> input, reading it is just a side-effect of parsing. <code>fgets()</code> on the other hand is intended for reading.</p>\n\n<p>The <code>%s</code> format specifier for <code>scanf()</code> means <em>accept anything that isn't whitespace</em>. This especially means that <strong>reading</strong> will stop at the first <em>whitespace</em> character, because it can't be parsed according to the format string (<code>%s</code> accepts non-whitespace and there's nothing following in the format string).</p>\n\n<p>So, if you just enter a single word and hit the <kbd>Enter</kbd> key, this key generates a newline character (<code>\\n</code>). This is a whitespace, your <code>scanf()</code> ignores it. <code>fgets()</code> is specified to read anything up to (and including) a newline. In your code, it immediately finds a newline, so that's all it reads.</p>\n\n<p>Note this explanation is a <strong>guess</strong> based on your description of what you see. With different input, it could fail in a different way. Keep in mind your question should include the exact input you provide, the exact output you get and what you expected instead in order to avoid such guessing work.</p>\n\n<hr>\n\n<p>Also note that <code>scanf(\"%s\", ...)</code> is potentially undefined behavior and a security risk just as bad as <code>gets()</code>. If the input in your example code doesn't contain a whitespace in the first 10 characters, you will overflow your buffer. <strong>Never write code like this</strong>. The immediate solution is to always give <em>field widths</em> with <code>scanf()</code> format specifiers that parse to strings -- in your example <code>scanf(\"%9s\", ...)</code>. The better solution is not to use <code>scanf()</code> at all. ever. For more information, see also my <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">beginners' guide away from <code>scanf()</code></a>.</p>\n\n<hr>\n\n<p>A simple solution for what you're trying to do without using <code>scanf()</code> could look like this:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(void)\n{\n    char buf[1024];\n\n    if (!fgets(buf, 1024, stdin)) return EXIT_FAILURE;\n    char *c = buf;\n    while (*c &amp;&amp; isspace(*c)) ++c;\n    if (*c) printf(\"%c\\n\", *c);\n\n    if (!fgets(buf, 1024, stdin)) return EXIT_FAILURE;\n    char *word = strtok(buf, \" \\t\\n\");\n    puts(word);\n\n    if (!fgets(buf, 1024, stdin)) return EXIT_FAILURE;\n    puts(buf);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8029723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aj-69vra2GQ/AAAAAAAAAAI/AAAAAAAAA0I/sEsRDZzoVC0/photo.jpg?sz=128", "display_name": "Rajeswari_Rajasingh", "link": "https://stackoverflow.com/users/8029723/rajeswari-rajasingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532527678, "creation_date": 1532523177, "last_edit_date": 1532524246, "question_id": 51519406, "link": "https://stackoverflow.com/questions/51519406/trying-to-print-char-string-terminated-with-space-and-string-terminated-with-new", "title": "Trying to print char,string terminated with space and string terminated with new line in a single program", "body": "<p>In the below program I am trying to get char and strings from the user and want to print char,string terminated with white space and string terminated with new line in a single program.but only char and string terminated with white space only get printed..String terminated with new line is not get printed..So do you find any mistake i had made ? or any solution to the above problem ? Please reply..Thanks in advance..</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main() \n{\n    char ch;\n    char s[10];\n    char str[20];\n    scanf( \"%c\",&amp;ch);\n    printf(\"%c\\n\",ch);\n    scanf(\"%s\",&amp;s);\n    printf(\"%s\\n\",s);\n    fgets(str,20,stdin); \n    printf(\"%s\", str);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "byte-order-mark"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1532520059, "post_id": 51518244, "comment_id": 90005222, "body": "File contents <i>always</i> start at byte 0.  You need to know what those contents represent."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1532521041, "post_id": 51518244, "comment_id": 90005982, "body": "<a href=\"https://en.wikipedia.org/wiki/Byte_order_mark#Byte_order_marks_by_encoding\" rel=\"nofollow noreferrer\">There aren&#39;t that many cases to test</a>. So.. test them."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532526575, "post_id": 51518597, "comment_id": 90009906, "body": "&quot;if 4 first chars are FF FE 00 00&quot; is problematic.  It could be BOM-little endian UTF-32 or BOM-little endian UTF-16 followed by a UTF-16_null_character.  Further processing of following data can usually discern which."}, {"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532526640, "post_id": 51518597, "comment_id": 90009963, "body": "BOM is for text files. You&#39;re not suppose to have null characters in a text file"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532526813, "post_id": 51518597, "comment_id": 90010100, "body": "Unicode 11.0.0 has code 0 as a character.  &quot;You&#39;re not suppose to have null characters in a text file&quot; is a common thought, yet what specification are you using to support that?  C does not specify that."}, {"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532527697, "post_id": 51518597, "comment_id": 90010751, "body": "That&#39;s not a specification, just the fact that 0 is not a text character, and of course cannot be in C specification, not a question of language. Any text editor will consider as binary a file containing a 0 character"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532537298, "post_id": 51518597, "comment_id": 90016748, "body": "Interesting.  What text editor are you using that treats a null character as binary and not as text? I edited a 12-byte file &quot;\\xFF\\xFE\\0\\0\\x41\\x0\\x42\\x0\\x43\\x0\\xA\\x0&quot; using MS word pad and it displayed and updated as if it had a little endian UTF-16 BOM (not 32 as this answer suggests) and little endian UTF-16 text, preserving the 2-byte <i>null characters</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532537881, "post_id": 51518597, "comment_id": 90017045, "body": "To be fair, It might be that MS word pad does not understand little endian UTF-32, even if it did work well with 2-byte null characters."}], "tags": [], "owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "is_accepted": false, "score": 7, "last_activity_date": 1532526180, "last_edit_date": 1532526180, "creation_date": 1532520778, "answer_id": 51518597, "question_id": 51518244, "link": "https://stackoverflow.com/questions/51518244/c-how-to-skip-bom-when-checking-if-x-is-at-the-start-of-a-file/51518597#51518597", "title": "C how to skip BOM when checking if x is at the start of a file", "body": "<p>You should read the first characters to know if BOM is present or not.</p>\n\n<ul>\n<li>if 4 first chars are FF FE 00 00 : little endian UTF-32</li>\n<li>else if 2 first chars are FF FE : little endian UTF-16</li>\n<li>else if 4 first chars are 00 00 FE FF : big endian UTF-32</li>\n<li>else if 2 first chars are FE FF : big endian UTF-16</li>\n<li>else if 3 firsts chars are EF BB BF : UTF-8</li>\n<li>etc...</li>\n</ul>\n\n<p>Depending on the BOM length, you know at which index the real file data starts.</p>\n\n<p>You can find a more complete list of BOM on wikipedia page : <a href=\"https://en.wikipedia.org/wiki/Byte_order_mark#Byte_order_marks_by_encoding\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Byte_order_mark#Byte_order_marks_by_encoding</a></p>\n"}], "owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532550367, "creation_date": 1532519660, "last_edit_date": 1532550367, "question_id": 51518244, "link": "https://stackoverflow.com/questions/51518244/c-how-to-skip-bom-when-checking-if-x-is-at-the-start-of-a-file", "title": "C how to skip BOM when checking if x is at the start of a file", "body": "<p>In a C array/string, How to i correctly detect if something is at the start of a file if the file has a BOM as sometimes the BOM takes up 1 character, other times the BOM takes up 3 characters, and other times the BOM is not present, resulting in the actual location of x to not always start on index 0</p>\n\n<p>Most of the time it is this (in hex) \"ef bb bf\"\nFor example:</p>\n\n<pre><code>ef bb bf 23 21 2f 62 69 6e 2f 62 61 73 68 0a 61 20 26 26 20 62 0a 67 20 : ...#!/bin/bash.a &amp;&amp; b.g \n</code></pre>\n\n<p>Would it be something like this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nstruct BOM {\n    int is_BOM;\n    int length;\n    int type;\n    char * type_as_string;\n    char * BOM;\n}\n\nint matches(char * BOM_, char * string_, int length_) {\n    char * b = BOM_+1;\n    for(int i = 0; i &lt; length_; i++) {\n        if (string_[i] == b[i]) matches = 1;\n        else {\n            matches = 0;\n            break;\n        }\n    }\n    return matches;\n}\n\n#define ifbom(bom_struct, is_BOM_, length_, type_, type_as_string_, BOM_, string_) if (matches(BOM_, string_, length_)) { \\\n    bom_struct.is_BOM = is_BOM_; \\\n    bom_struct.length = length_; \\\n    bom_struct.type = type_; \\\n    bom_struct.type_as_string = type_as_string_; \\\n    bom_struct.BOM = BOM_+1 /* remove the ^ at the start */ ; \\\n}\n\n#define elifbom(bom_struct, is_BOM_, length_, type_, type_as_string_, BOM_, string_) else ifbom(bom_struct, is_BOM_, length_, type_, type_as_string_, BOM_, string_)\n\n#define elbom(bom_struct, is_BOM_, length_, type_, type_as_string_, BOM_) else { \\\n    bom_struct.is_BOM = is_BOM_; \\\n    bom_struct.length = length_; \\\n    bom_struct.type = type_; \\\n    bom_struct.type_as_string = type_as_string_; \\\n    bom_struct.BOM = BOM_; \\\n}\n\n#define cat 0\n#define hex 1\n#define both 2\n#define json 3\n\nint mode;\n\nvoid __hexdump(unsigned char *buffer, unsigned long index, unsigned long width)\n{\n    unsigned long i;\n    if (mode == both || mode == hex) {\n    for (i = 0; i &lt; index; i++)\n        printf(\"%02x \", buffer[i]);\n    }\n    if (mode == both) {\n    for (unsigned long spacer = index; spacer &lt; width; spacer++)\n        printf(\"\\t\");\n    printf(\": \");\n    }\n    if (mode == cat || mode == both || mode == json) {\n    for (i = 0; i &lt; index; i++)\n    {\n        if (buffer[i] &lt; 32 || buffer[i] &gt;= 127)\n            printf(\".\");\n        else\n            printf(\"%c\", buffer[i]);\n    }\n    }\n    printf(\"\\n\");\n}\n\nint __hexdump_string(char *infile, unsigned long start, unsigned long stop, unsigned long width)\n{\n    char ch;\n    unsigned long f_index = 0;\n    unsigned long bb_index = 0;\n    unsigned char *byte_buffer = malloc(width);\n    if (byte_buffer == NULL)\n    {\n        printf(\"Could not allocate memory for byte_buffer\\n\");\n        return -1;\n    }\n    while (*infile)\n    {\n        ch = *infile;\n        if ((f_index &gt;= start) &amp;&amp; (f_index &lt;= stop))\n        {\n            byte_buffer[bb_index] = ch;\n            bb_index++;\n        }\n        if (bb_index &gt;= width)\n        {\n            __hexdump(byte_buffer, bb_index, width);\n            bb_index = 0;\n        }\n        f_index++;\n        infile++;\n    }\n    if (bb_index)\n        __hexdump(byte_buffer, bb_index, width);\n    free(byte_buffer);\n    return 0;\n}\n\n#define builtin__BOM_print(bom_struct) { \\\n    printf(\"%s.is_BOM = %s\\n%s.length = %d\\n%s.type = %d\\n%s.type_as_string = %s\\n%s.BOM = \", #bom_struct, bom_struct.is_BOM?\"yes\":\"no\", #bom_struct, bom_struct.length, #bom_struct, bom_struct.type, #bom_struct,bom_struct.type_as_string, #bom_struct); \\\n    mode = both; \\\n    __hexdump_string(bom_struct.BOM, 0, bom_struct.length, 5); \\\n}\n\n\nstruct BOM builtin__BOM_get(char * string) {\n    struct BOM bom;\n    ifbom(bom, true, 3, 1, \"UTF-8\", \"^\\xef\\xbb\\xbf\", string)\n    elifbom(bom, true, 2, 2, \"UTF-16 (BE)\", \"^\\xfe\\xff\", string)\n    elifbom(bom, true, 2, 3, \"UTF-16 (LE)\", \"^\\xff\\xfe\", string)\n    elifbom(bom, true, 4, 4, \"UTF-32 (BE)\", \"^\\x00\\x00\\xfe\\xff\", string)\n    elifbom(bom, true, 4, 5, \"UTF-32 (LE)\", \"^\\xff\\xfe\\x00\\x00\", string)\n    elifbom(bom, true, 5, 6, \"UTF-7\", \"^\\x2b\\x2f\\x76\\x38\\x3d\", string)\n    elifbom(bom, true, 4, 7, \"UTF-7\", \"^\\x2b\\x2f\\x76\\x38\", string)\n    elifbom(bom, true, 4, 8, \"UTF-7\", \"^\\x2b\\x2f\\x76\\x39\", string)\n    elifbom(bom, true, 4, 9, \"UTF-7\", \"^\\x2b\\x2f\\x76\\x2b\", string)\n    elifbom(bom, true, 4, 10, \"UTF-7\", \"^\\x2b\\x2f\\x76\\x2f\", string)\n    elifbom(bom, true, 3, 11, \"UTF-1\", \"^\\xf7\\x64\\x4c\", string)\n    elifbom(bom, true, 4, 12, \"UTF-EBCDIC\", \"^\\xdd\\x73\\x66\\x73\", string)\n    elifbom(bom, true, 3, 13, \"SCSU\", \"^\\x0e\\xfe\\xff\", string)\n    elifbom(bom, true, 3, 14, \"BOCU-1\", \"^\\xfb\\xee\\x28\", string)\n    elifbom(bom, true, 4, 15, \"GB-18030\", \"^\\x84\\x31\\x95\\x33\", string)\n    elbom(bom, false, 0, 0, \"Not present\", \"Not present\")\n\n    return (struct BOM) bom;\n}\n\nint main()\n{\n    struct BOM t = builtin__BOM_get(\"test\");\n    builtin__BOM_print(t);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "c89"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 3, "creation_date": 1532519802, "post_id": 51518207, "comment_id": 90005034, "body": "Global (and static) variables are initialized with 0, yes. There&#39;s probably a duplicate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532519817, "post_id": 51518207, "comment_id": 90005042, "body": "Yes. Next question please ;)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1532519996, "post_id": 51518207, "comment_id": 90005172, "body": "It is not undefined behavior."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1532520293, "post_id": 51518207, "comment_id": 90005395, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11152160/initializing-a-struct-to-0\">Initializing a struct to 0</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532520615, "post_id": 51518207, "comment_id": 90005639, "body": "Global and static variables are alwaqys initialized with 0, regardless if it&#39;s <code>struct</code>s, arrays or simple variables (such as <code>char</code>, <code>int</code> etc.)."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1532520727, "post_id": 51518207, "comment_id": 90005728, "body": "See 3rd answer of duplicate question link."}, {"owner": {"reputation": 517, "user_id": 6240779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE9Q1.png?s=128&g=1", "display_name": "SairesArt", "link": "https://stackoverflow.com/users/6240779/sairesart"}, "edited": false, "score": 0, "creation_date": 1532521584, "post_id": 51518207, "comment_id": 90006356, "body": "Thanks all! I read that thread before, but was unsure about the wording."}], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 6240779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE9Q1.png?s=128&g=1", "display_name": "SairesArt", "link": "https://stackoverflow.com/users/6240779/sairesart"}, "edited": false, "score": 0, "creation_date": 1532521765, "post_id": 51518826, "comment_id": 90006477, "body": "Thanks! Your excerpt explains it perfectly. I was a bit confused by the C99 passage often cited and CTRL+F through the C89 standard before to read <b><code>If there are fewer initializers in a list than there are members of an aggregate, the remainder of the aggregate shall be initialized implicitly the same as objects that have static storage duration. </code></b> just to be confused by the language and C99&#39;s usage of &quot;brace-enclosed list&quot; in the equivalent passage."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1532521460, "creation_date": 1532521460, "answer_id": 51518826, "question_id": 51518207, "link": "https://stackoverflow.com/questions/51518207/c-initilized-global-struct-with-uninitilized-member-ints-defined-beheviour/51518826#51518826", "title": "C initilized global struct with uninitilized member ints defined beheviour?", "body": "<p>For a global struct, all fields will be initialized to 0 / NULL.  This is detailed in section 6.7.9p10 of the current <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p>If an object that has automatic storage duration is not initialized\n  explicitly, its value is indeterminate. If an object that has static\n  or thread storage duration is not initialized explicitly, then:</p>\n  \n  <ul>\n  <li>if it has pointer type, it is initialized to a null pointer;</li>\n  <li>if it has arithmetic type, it is initialized to (positive or unsigned) zero;</li>\n  <li><strong>if it is an aggregate, every member is initialized (recursively) according to these rules, and any padding is initialized to zero bits;</strong></li>\n  <li>if it is a union, the first named member is initialized (recursively) according to these rules, and any padding is initialized\n  to zero bits;</li>\n  </ul>\n</blockquote>\n\n<p>The old <a href=\"http://port70.net/~nsz/c/c89/c89-draft.html#3.5.7\" rel=\"nofollow noreferrer\">C89 standard</a> has similar language in section 3.5.7:</p>\n\n<blockquote>\n  <p>an object that has static storage duration is not initialized\n  explicitly, it is initialized implicitly as if every member that has\n  arithmetic type were assigned 0 and every member that has pointer type\n  were assigned a null pointer constant. If an object that has automatic\n  storage duration is not initialized explicitly, its value is\n  indeterminate</p>\n  \n  <p>...</p>\n  \n  <p>If the aggregate contains members that are aggregates or unions, or if\n  the first member of a union is an aggregate or union, the rules apply\n  recursively to the subaggregates or contained unions</p>\n</blockquote>\n\n<p>So in your case, <code>instance.a</code> is guaranteed to be set to 0.</p>\n"}], "owner": {"reputation": 517, "user_id": 6240779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE9Q1.png?s=128&g=1", "display_name": "SairesArt", "link": "https://stackoverflow.com/users/6240779/sairesart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 51518826, "answer_count": 1, "score": 2, "last_activity_date": 1532521460, "creation_date": 1532519533, "last_edit_date": 1532519876, "question_id": 51518207, "link": "https://stackoverflow.com/questions/51518207/c-initilized-global-struct-with-uninitilized-member-ints-defined-beheviour", "title": "C initilized global struct with uninitilized member ints defined beheviour?", "body": "<p>Uninitilized Global int are always 0 as per defined beheviour, this is not true if it is not global. What about Global structs?\nDoes</p>\n\n<pre><code>struct s\n{\n    int a;\n}instance;\n\nint main()\n{    \n    printf(\"%d\\n\", instance.a);\n    return 0;\n}\n</code></pre>\n\n<p>always print <code>0</code> or is it technically undefined beheviour?</p>\n"}, {"tags": ["c", "assembly", "embedded", "stack-pointer"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532519401, "post_id": 51517892, "comment_id": 90004748, "body": "<i>Thus 624*4 = 2496 Bytes get allocated or what?</i>.   Unless compile target is 64bit.  then double it."}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532519444, "post_id": 51517892, "comment_id": 90004780, "body": "@ryyker, target is 32bit"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1532519499, "post_id": 51517892, "comment_id": 90004815, "body": "Can you show C code that generates this assy section?"}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532520136, "post_id": 51517892, "comment_id": 90005271, "body": "@ the code which actually produces the error, is already between the assembly instr. see <code>dslimb_t accum[2*DIGITS] = {0};</code>"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1532521632, "post_id": 51517892, "comment_id": 90006393, "body": "If the <code>a10</code> is &quot;stack pointer&quot; and it is <code>0xD0000600</code> before call, and you want 2496 bytes, then you are out of luck, as there&#39;s only 0x600 bytes left (1536 bytes). You have to move that local variable to other part of memory. Usually on such constrained systems one does design whole memory consumption/usage alongside the algorithm and has some kind of memory map, then the C code does less of the common dynamic allocation, which makes the source usually a bit less elegant/clean, but as you have limited resources, sometimes it&#39;s better than other hacks."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1532521727, "post_id": 51517892, "comment_id": 90006458, "body": "You can also check, if you can bump up the stack size somewhere in linker script or build options. But fully understanding the memory consumption is still probably a must, as basically if you call two functions with similar request inside, it will fail again, even if separately each of them works. (I think I can actually turn this into answer ... will rethink it and post+delete comments, if it really fits)"}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1532522543, "post_id": 51517892, "comment_id": 90007013, "body": "@Ped7g thank you sir, i just checked allocating an arroy of size one, that worked! do have an idea why calloc() did not work? my heap should be 4k big..."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1532524240, "post_id": 51517892, "comment_id": 90008193, "body": "@jonnyx make some &quot;map&quot; of how the memory chips of your systems are used, track down where the code lands, where is stack, where are data, read-only data, and see yourself, if you are already like filling the system up, or there&#39;s enough of unused memory, but the current configuration (linker script + build options) just position you into situation where you run out of resources at runtime. Then redesign your code and build process (linking) to use the available resources more effectively, making your code work (or rewrite your code to require less memory by using more efficient algorithm)."}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "edited": false, "score": 0, "creation_date": 1532523804, "post_id": 51519445, "comment_id": 90007911, "body": "thank you for this great explanation! helped me alot!"}], "tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": true, "score": 6, "last_activity_date": 1532523630, "last_edit_date": 1532523630, "creation_date": 1532523274, "answer_id": 51519445, "question_id": 51517892, "link": "https://stackoverflow.com/questions/51517892/stack-pointer-points-to-reserved-memory/51519445#51519445", "title": "Stack Pointer points to reserved Memory", "body": "<p>As the \"stack pointer\" <code>a10</code> is <code>0xD0000600</code> before, and stack grows downward on this platform, and the memory chip assigned to this area starts at <code>0xD0000000</code> => you have only 0x600 bytes of stack memory available for locals and other function calls (and their locals!).</p>\n\n<blockquote>\n  <p>Does anybody know what I might be doing wrong here?</p>\n</blockquote>\n\n<p>But you are trying to allocate 0x9C0 bytes (plus few more for <code>b</code> and <code>c</code>, unless those end in registers, and the optimizer is smart enough to not allocate stack space for them), which leads to going outside of the designed memory area, and first write instruction then will crash. Actually if you would request many more bytes, you can accidentally start inside the Scratch-pad RAM (the resulting address being very close to <code>0xC0000000</code>), then the code will crash during clearing the array, once it would left the scratch-pad area.</p>\n\n<blockquote>\n  <p>But the generated assembly code tries to do in line 5?</p>\n</blockquote>\n\n<p>The generated code doesn't check for memory availability in C, related to this kind of problems the C is \"unsafe\" programming language, and it's responsibility of programmer + maintainer/operator to build the code and run it in such environment where the stack has enough space. Or add checks into code which is so dynamic, that it's not possible to evaluate the stack usage during development and the code should handle full-stack situations gracefully.</p>\n\n<blockquote>\n  <p>I also tried to use calloc to allocate memory on the heap (instead of the stack like the code above does right?) but the programm still crashed.</p>\n</blockquote>\n\n<p>Seems like different problem, or you have also full heap (from comment \"heap should be 4k\" - that sounds like very tiny heap, maybe you exhausted it with other dynamic allocations already, also fragmentation may prevent your memory allocator to return continuous valid 3k block for your array). Heap allocators tend to return <code>NULL</code> when their pool is exhausted, but maybe your platform is so limited, that the memory allocator is missing such safety code in implementation, to make it smaller.</p>\n\n<blockquote>\n  <p>I also copied the line dslimb_t accum[2*DIGITS] = {0} to the start of the program where it was executed without an error.</p>\n</blockquote>\n\n<p>Then it's global variable, which gets placed into the <code>.data</code>-like segment, which is placed into sufficiently big memory area.</p>\n\n<p>And yes, 624 32 bit integers needs at least 2496 (624*4) bytes of memory (in C language you usually pay zero price for abstraction, so in this case any piece of 2496 byte long memory, which is aligned as your platform requires, is enough to make this possible, in other languages like Java the total cost of such array is considerably higher, as there's also GC housekeeping and the array management data, so you can probably count about 3000-3500 bytes needed on such platform).</p>\n\n<hr>\n\n<p>Usually when one develops on so much constrained system (asking for 3k of stack space for locals sounds as something completely negligible in desktop/web world of programming, but on small embedded systems or old 8/16 bit computers that may be serious amount of memory), it may help to design the code and algorithm in \"data driven\" way, i.e. you plan your memory usage completely, including where the code resides (and how big it can be), where the local/global variables are, and to be aware what is the maximum stack needed to run through all states of the code.</p>\n\n<p>You can check why the stack is so low in the first place - the \"local data RAM\" seems to be ~110k big, so maybe you have enough space there, and there's some option during build to resize the stack (or linker script can be adjusted).</p>\n\n<p>Actually you should check your whole memory consumption design, i.e. what data you really need to have in memory, where it is, which are temporary and what are they life cycle, etc (at least at rough kilobytes estimate), and check that against the physically available memory on the chip, so you can get the idea how carelessly you can write the code, or eventually if you are already out of memory for your particular task, even before the start of implementation. (you can start by checking the linker map file, to see how much of the code is produced, and how big are the fixed variables in <code>.data/.bss/.rodata/etc</code> sections, then check all local variables and heap allocations)</p>\n\n<p>Then maybe allocate the required memory in some kind of structs. Do you even need any dynamic allocation? Can't you simply design whole <code>.data</code> segment already in the code as few global <code>struct</code> variables, grouping various data by the abstraction where they belong, and use those globals in the other code, without any dynamic allocation at all?</p>\n\n<p>Also if you are writing some kind of library/support function, make sure you don't exhaust all resources of the platform, otherwise it's not clear how one would use your functionality alongside their real task. :)</p>\n"}], "owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 51519445, "answer_count": 1, "score": 3, "last_activity_date": 1532523630, "creation_date": 1532518481, "last_edit_date": 1532520003, "question_id": 51517892, "link": "https://stackoverflow.com/questions/51517892/stack-pointer-points-to-reserved-memory", "title": "Stack Pointer points to reserved Memory", "body": "<p>I am debugging a code for a cryptographic implementation on a Tricore TC275 from Infineon   (<a href=\"https://www.infineon.com/dgdl/tc_v131_instructionset_v138.pdf?fileId=db3a304412b407950112b409b6dd0352\" rel=\"nofollow noreferrer\">reference</a> assembly language).</p>\n\n<pre><code>PMI_PSPR (wx!p): org = 0xC0000000, len = 24K  /*Scratch-Pad RAM (PSPR)*/ \nDMI_DSPR (w!xp): org = 0xD0000000, len = 112K  /*Local Data RAM (DSPR)*/ \n</code></pre>\n\n<p>The stack pointer <strong>a[10]</strong> always points to a reserved memory area after a call to the mac function.</p>\n\n<pre><code>###### typedefs ######\ntypedef uint16_t limb_t;\ntypedef limb_t gf_t[DIGITS]; //DIGITS=312\ntypedef int32_t dslimb_t;\n################################\n\n/**Multiply and accumulate c += a*b*/\nvoid mac(gf_t c, const gf_t a, const gf_t b)\n1: 0xC0000812:   D9 AA 40 9F   LEA     a10,[a10]-0x9C0 //Load eff. addr.\n       /*Reference non-Karatsuba MAC */\n       dslimb_t accum[2*DIGITS] = {0};\n2: 0xC0000816:   40 A2         MOV.AA  a2,a10\n3: 0xC0000818:   D2 02         MOV     e2,0x0 //move 0x0 to d2 and d3\n4: 0xC000081A:   C5 03 37 40   LEA     a3,0x137 // 0.5*length of accum\n5: 0xC000081E:   89 22 48 01   ST.D    [a2+]0x8,e2 //&lt;= fails here\n6: 0xC0000822:   FC 3E         LOOP    a3,0xC000081E \n7: 0xC0000824:   40 AF         MOV.AA  a15,a10\n\n###contents of relevant registers###\n                 before        after\n1: a[10]         D000 0600     CFFF FC40 (not definend in memory map?)\n2: a[2]          D000 0A06     CFFF FC40\n3: d[2]          0000 0002     0000 0000\n3: d[3]          0000 0000     0000 0000 (would have been set to zero too)\n4: a[3]          0000 0186     0000 0137 (#of iterations in loop)\n5: a[2]          CFFF FC40     (store failed here)\nvalue@CFFF FC40  ???? ????     ???? ???? (write is not allowed I guess)\n</code></pre>\n\n<p><code>0x9C0 = 2496 (base10)</code> and the length of the array accum is <code>624</code>, each element containing an <code>int32_t</code>. Thus <code>624*4 = 2496 Bytes</code> get allocated or what?  </p>\n\n<p>But at this address in memory, no writes are allowed as far as I understand the memory map which is given to the linker... But the generated assembly code tries to do in line 5?</p>\n\n<p>Does anybody know what I might be doing wrong here? I also tried to use calloc to allocate memory on the heap (instead of the stack like the code above does right?) but the programm still crashed.</p>\n\n<p>I also copied the line <code>dslimb_t accum[2*DIGITS] = {0}</code> to the start of the program where it was executed without an error.</p>\n\n<p>Thank you very much for any help!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>mac is called like that, uniform samples some uniform random numbers</p>\n\n<pre><code>gf_t sk_expanded[DIM],b,c;\nfor (unsigned i=0; i&lt;DIM; i++) {\n    noise(sk_expanded[i],ctx,i);\n}\nfor (unsigned i=0; i&lt;DIM; i++) {\n    noise(c,ctx,i+DIM); //noisy elements in c after call\n    for (unsigned j=0; j&lt;DIM; j++) {\n        uniform(b,pk,i+DIM*j); //uniform random numbers in b after call\n        mac(c,b,sk_expanded[j]); //fails here on first call\n    }\n    contract(&amp;pk[MATRIX_SEED_BYTES+i*GF_BYTES], c);\n}\n</code></pre>\n\n<p>this code runs on my host machine, but on my tricore microcontroller it fails in the first mac() function call.       </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1532516686, "post_id": 51517322, "comment_id": 90003032, "body": "They&#39;re both correct, it depends what order you want to show the bits in"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1532517055, "post_id": 51517322, "comment_id": 90003239, "body": "You mean the second code prints <code>02000000</code>? <code>printf(&quot;%d&quot;, (val &gt;&gt; j) &amp; 1);</code> should not print anything than <code>0</code> or <code>1</code>. It should never print a <code>2</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1532517091, "post_id": 51517322, "comment_id": 90003255, "body": "The second will not output a <code>2</code>.  The two samples explicitly print out the BYTES in opposite order.    The second is less preferable, since it is possible for <code>&gt;&gt;</code> on an <code>int</code> to give undefined behaviour, and a <code>char</code> type is not guaranteed to be 8 bits."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532517126, "post_id": 51517322, "comment_id": 90003275, "body": "Your first snippet shows how the bytes are stored in memory. The second snippet prints the bits. The first depends on endianess, the second does not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532517979, "post_id": 51517322, "comment_id": 90003856, "body": "What type is <code>val</code>? How is it assigned? <code>printf(&quot;%d&quot;, (val &gt;&gt; j) &amp; 1);</code> is a problem unless <code>val</code> is <code>unsigned</code>.  A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would improve this post."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1532519016, "post_id": 51517322, "comment_id": 90004510, "body": "The undefined behaviour of ((int)a)&gt;&gt;n does not effect  (((int)a)&gt;&gt;n) &amp;  1 for small n. n &lt; (sizeof(int) * 8)"}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1532525585, "post_id": 51517322, "comment_id": 90009161, "body": "Just to settle an argument below, Can you tell us what hardware platform you&#39;re using?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 0, "last_activity_date": 1532525341, "last_edit_date": 1532525341, "creation_date": 1532517088, "answer_id": 51517455, "question_id": 51517322, "link": "https://stackoverflow.com/questions/51517322/printing-actual-bit-representation-of-integers-in-c/51517455#51517455", "title": "Printing actual bit representation of integers in C", "body": "<p>It depends on your definition of \"correct\".</p>\n\n<p>The first one will print the data exactly like it's laid out in memory, so I bet that's the one you're getting the maybe unexpected <code>02000000</code> for. *) IMHO, that's the <em>correct</em> one. It could be done simpler by just aliasing with <code>unsigned char *</code> directly (<code>char</code> pointers are always allowed to alias any other pointers, in fact, accessing representations is a usecase for <code>char</code> pointers mentioned in the standard):</p>\n\n<pre><code>int x = 2;\nunsigned char *rep = (unsigned char *)&amp;x;\nfor (int i = 0; i &lt; sizeof x; ++i) printf(\"0x%hhx \", rep[i]);\n</code></pre>\n\n<hr>\n\n<p>The second one will print only the <em>value bits</em> **) and take them in the order from the most significant byte to the least significant one. I wouldn't call it correct because it also assumes that bytes have 8 bits, and because the shifting used is implementation-defined for negative numbers. ***) Furthermore, just ignoring padding bits doesn't seem correct either if you really want to see the <em>representation</em>.</p>\n\n<p><strong>edit</strong>: As <a href=\"https://stackoverflow.com/users/6782754/gerhardh\">commented by Gerhardh</a> meanwhile, this second code doesn't print <em>byte by byte</em> but <em>bit by bit</em>. So, the output you claim to see isn't possible. Still, it's the same principle, it only prints value bits and starts at the most significant one.</p>\n\n<hr>\n\n<p>*) You're on a \"little endian\" machine. On these machines, the <em>least</em> significant byte is stored first in memory. Read more about <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Endianness on wikipedia</a>.</p>\n\n<p>**) Representations of types in C may also have <em>padding bits</em>. Some types aren't allowed to include padding (like <code>char</code>), but <code>int</code> is allowed to have them. This second option doesn't alias to <code>char</code>, so the padding bits remain invisible.</p>\n\n<p>***) A <strong>correct</strong> version of this code (for printing all the value bits) must <strong>a)</strong> correctly determine the number of value bits (<code>8 * sizeof int</code> is wrong because bytes (<code>char</code>) can have more then 8 bits, even <code>CHAR_BIT * sizeof int</code> is wrong, because this would also count padding bits if present) and <strong>b)</strong> avoid the implementation-defined shifting behavior by first converting to <code>unsigned</code>. It could look for example like this:</p>\n\n<pre><code>#define IMAX_BITS(m) ((m) /((m)%0x3fffffffL+1) /0x3fffffffL %0x3fffffffL *30 \\\n                  + (m)%0x3fffffffL /((m)%31+1)/31%31*5 + 4-12/((m)%31+3))\n\nint main(void)\n{\n    int x = 2;\n\n    for (unsigned mask = 1U &lt;&lt; (IMAX_BITS((unsigned)-1) - 1); mask; mask &gt;&gt;= 1)\n    {\n        putchar((unsigned) x &amp; mask ? '1' : '0');\n    }\n    puts(\"\");\n}\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/4589384/2371524\">this answer</a> for an explanation of this strange macro.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532517438, "post_id": 51517490, "comment_id": 90003472, "body": "&quot;<i>The correct one is 00000002</i>&quot; &lt;- really? I&#39;d argue <code>0x00 0x00 0x06</code> could very well be a &quot;correct&quot; representation for <code>2</code>."}, {"owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "edited": false, "score": 0, "creation_date": 1532517478, "post_id": 51517490, "comment_id": 90003511, "body": "the question is about hex representation"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532517521, "post_id": 51517490, "comment_id": 90003545, "body": "What&#39;s &quot;hex representation&quot;? The question is about <b>representation</b>, which is the actual bit pattern <b>in memory</b>."}, {"owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "edited": false, "score": 0, "creation_date": 1532517601, "post_id": 51517490, "comment_id": 90003599, "body": "as I answered, it can be different, little endian will be the oposite then big endian"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532517653, "post_id": 51517490, "comment_id": 90003631, "body": "See my example in the first comment. I made up an <code>int</code> with 22 value bits and 2 padding bits. And now?"}], "tags": [], "owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "is_accepted": false, "score": 0, "last_activity_date": 1532518672, "last_edit_date": 1532518672, "creation_date": 1532517183, "answer_id": 51517490, "question_id": 51517322, "link": "https://stackoverflow.com/questions/51517322/printing-actual-bit-representation-of-integers-in-c/51517490#51517490", "title": "Printing actual bit representation of integers in C", "body": "<p>The correct Hex representation as string is 00000002 as if you declare the integer with hex represetation.</p>\n\n<pre><code>int n = 0x00000002; //n=2\n</code></pre>\n\n<p>or as you where get when printing integer as hex like in:</p>\n\n<pre><code>printf(\"%08x\", n);\n</code></pre>\n\n<p>But when printing integer bytes 1 byte after the other, you also must consider the <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianess</a>, which is the byte order in multi-byte integers:</p>\n\n<p>In big endian system (some UNIX system use it) the 4 bytes will be ordered in memory as:</p>\n\n<pre><code> 00 00 00 02 \n</code></pre>\n\n<p>While in little endian system (most of OS) the bytes will be ordered in memory as:</p>\n\n<pre><code> 02 00 00 00\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1532518240, "post_id": 51517747, "comment_id": 90004008, "body": "&quot;we right numbers most significant digit first&quot; --&gt; How about &quot;sixteen&quot;?  Looks like least significant digit first? ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532518575, "post_id": 51517747, "comment_id": 90004212, "body": "Endianness isn&#39;t all there is to this question, representations are widely implementation-defined (possible padding bits, position of the sign bit, ...), so it&#39;s really about telling which code prints the actual representation."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532520964, "post_id": 51517747, "comment_id": 90005916, "body": "@chux Is six a digit? There is a digit called six. I&#39;ve confused myself now."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1532521142, "post_id": 51517747, "comment_id": 90006050, "body": "@FelixPalmen Platforms that don&#39;t use all the bits or don&#39;t use twos-complement as now pretty obscure. I think answers should be at level of the question. Too much information isn&#39;t always better."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532524785, "post_id": 51517747, "comment_id": 90008556, "body": "@Persixty unfortunately, to decide about the &quot;correctness&quot; of such code, this knowledge is needed."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1532525097, "post_id": 51517747, "comment_id": 90008769, "body": "@FelixPalmen &quot;Widely&quot;, eh?  I will bet you $100 that the OP is using a conventional 2&#39;s complement little-endian machine today, and that he will never encounter anything else during his entire programming career."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1532525283, "post_id": 51517747, "comment_id": 90008921, "body": "@FelixPalmen Agreed by strict reading of the standard and a review of all known implementations. But as I said there is such a thing as relevance."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532525433, "post_id": 51517747, "comment_id": 90009035, "body": "@SteveSummit Unless he&#39;s found something in his grandad&#39;s basement. There are PDP-11s running nuclear reactors in Canada. But they&#39;re 2s-complement! Oh, and it scares the crap out of me if something is working on a nuclear reactor and posting questions on Stack Overflow..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532525448, "post_id": 51517747, "comment_id": 90009054, "body": "@SteveSummit &#39;widely&#39; refered to the amount of freedom the implementation has as opposed to the amount of rules it actually has to follow -- not to the numbers of existing systems."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532525500, "post_id": 51517747, "comment_id": 90009098, "body": "And all this reasoning is void anyways. As long as the standard doesn&#39;t mandate anything, it&#39;s <b>never</b> safe to rely on it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532528033, "post_id": 51517747, "comment_id": 90010986, "body": "@FelixPalmen &quot;Wide latitude&quot;: fair enough."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1532600488, "post_id": 51517747, "comment_id": 90040552, "body": "@FelixPalmen I&#39;ve thought about your point. I now agree it needs to be mentioned. While I&#39;ll still fall of my chair if it&#39;s valuable to talk about the full scope of what the C Language Specification admits. I&#39;ve added a Footnote to the answer. Though still advising that in practice this is something the OP is unlikely to meet. To be honest unlikely but lucky! I&#39;d love to program a computer using signed magnitude just for novelty."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532601139, "post_id": 51517747, "comment_id": 90040950, "body": "@Persixty thanks, IMHO this really improves the answer. I thought it&#39;s necessary to tell &quot;the whole story&quot; because the question is asking about correctness of code. <i>padding bits</i> are the next issue, btw :) Never seen any machine using padding in <code>int</code> or anything other than 2&#39;s complement, sure, but as long as C allows it, you know ...."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1532601637, "post_id": 51517747, "comment_id": 90041237, "body": "@FelixPalmen I meant to mention padding bits! Thanks again."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1532601836, "post_id": 51517747, "comment_id": 90041356, "body": "@FelixPalmen My previous resistance was that we are almost certainly wasting the OPs time if we leave them thinking they might actually encounter these arcane beasts!."}], "tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 3, "last_activity_date": 1532601688, "last_edit_date": 1532601688, "creation_date": 1532518004, "answer_id": 51517747, "question_id": 51517322, "link": "https://stackoverflow.com/questions/51517322/printing-actual-bit-representation-of-integers-in-c/51517747#51517747", "title": "Printing actual bit representation of integers in C", "body": "<p>Welcome to the exotic world of endian-ness.</p>\n\n<p>Because we write numbers most significant digit first, you might imagine the most significant byte is stored at the lower address.</p>\n\n<p>The electrical engineers who build computers are more imaginative.</p>\n\n<p>Someimes they store the most significant byte first but on your platform it's the least significant.</p>\n\n<p>There are even platforms where it's all a bit mixed up - but you'll rarely encounter those in practice.</p>\n\n<p>So we talk about big-endian and little-endian for the most part. It's a joke about Gulliver's Travels where there's a pointless war about which end of a boiled egg to start at. Which is itself a satire of some disputes in the Christian Church. But I digress.</p>\n\n<p>Because your first snippet looks at the value as a series of bytes it encounters then in endian order.</p>\n\n<p>But because the <code>&gt;&gt;</code> is defined as operating on bits it is implemented to work 'logically' without regard to implementation.</p>\n\n<p>It's right of C to not define the byte order because hardware not supporting the model C chose would be burdened with an overhead of shuffling bytes around endlessly and pointlessly.</p>\n\n<p>There sadly isn't a built-in identifier telling you what the model is - though code that does can be found.</p>\n\n<p>It will become relevant to you if (a) as above you want to breakdown integer types into bytes and manipulate them or (b) you receive files for other platforms containing multi-byte structures.</p>\n\n<p>Unicode offers something called a BOM (Byte Order Marker) in UTF-16 and UTF-32.\nIn fact a good reason (among many) for using UTF-8 is the problem goes away. Because each component is a single byte.  </p>\n\n<p><strong>Footnote:</strong>\nIt's been pointed out quite fairly in the comments that I haven't told the whole story.\nThe C language specification admits more than one representation of integers and particularly signed integers. Specifically signed-magnitude, twos-complement and ones-complement.</p>\n\n<p>It also permits 'padding bits' that don't represent part of the value.</p>\n\n<p>So in principle along with tackling endian-ness we need to consider representation.</p>\n\n<p><strong>In principle</strong>. All modern computers use twos complement and extant machines that use anything else are very rare and unless you have a genuine requirement to support such platforms, I recommend assuming you're on a twos-complement system.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532520697, "post_id": 51518334, "comment_id": 90005709, "body": "&quot;<i>The result is also independent of how the &gt;&gt; operator is implemented for signed ints</i>&quot; &lt;- are you sure? Probably correct in practice, but all the standard (in 6.5.7 p5) has to say: &quot;<i>If <code>E1</code> has a signed type and a negative value, the resulting value is implementation-defined.</i>&quot;"}], "tags": [], "owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1532519974, "creation_date": 1532519974, "answer_id": 51518334, "question_id": 51517322, "link": "https://stackoverflow.com/questions/51517322/printing-actual-bit-representation-of-integers-in-c/51518334#51518334", "title": "Printing actual bit representation of integers in C", "body": "<p>The first prints the bytes that represent the integer in the order they appear in memory. Platforms with different endian will print different results as they store integers in different ways.</p>\n\n<p>The second prints the bits that make up the integer value most significant bit first. This result is independent of endian. The result is also independent of how the >> operator is implemented for signed ints as it does not look at the bits that  may be influenced by the implementation.</p>\n\n<p>The second is a better match to the question \"Printing actual bit representation of integers in C\".  Although there is a lot of ambiguity.</p>\n"}], "owner": {"reputation": 61, "user_id": 10132998, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qdsR_WmLF1w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rzVLHH_J6jmBPwREgsy76-sCG8uQ/mo/photo.jpg?sz=128", "display_name": "alex solanki", "link": "https://stackoverflow.com/users/10132998/alex-solanki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1532601688, "creation_date": 1532516637, "last_edit_date": 1532518142, "question_id": 51517322, "link": "https://stackoverflow.com/questions/51517322/printing-actual-bit-representation-of-integers-in-c", "title": "Printing actual bit representation of integers in C", "body": "<p>I wanted to print the actual bit representation of integers in C. These are the two approaches that I found.</p>\n\n<p><strong>First:</strong></p>\n\n<pre><code>union int_char {\n    int val;\n    unsigned char c[sizeof(int)];\n} data;\n\ndata.val = n1;\n// printf(\"Integer: %p\\nFirst char: %p\\nLast char: %p\\n\", &amp;data.f, &amp;data.c[0], &amp;data.c[sizeof(int)-1]);\n\nfor(int i = 0; i &lt; sizeof(int); i++)\n    printf(\"%.2x\", data.c[i]);\n    printf(\"\\n\");\n</code></pre>\n\n<hr>\n\n<p><strong>Second:</strong></p>\n\n<pre><code>for(int i = 0; i &lt; 8*sizeof(int); i++) {\n    int j = 8 * sizeof(int) - 1 - i;\n    printf(\"%d\", (val &gt;&gt; j) &amp; 1);\n}\nprintf(\"\\n\");\n</code></pre>\n\n<p>For the second approach, the outputs are <code>00000002</code> and <code>02000000</code>. I also tried the other numbers and it seems that the bytes are swapped in the two. Which one is correct?</p>\n"}, {"tags": ["c", "windows", "filter-driver"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532516643, "post_id": 51517213, "comment_id": 90003004, "body": "I removed the <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> tag, but this was a mere guess. Please tag the language you&#39;re actually using, if it&#39;s C, replace the C++ tag with C."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1532516720, "post_id": 51517213, "comment_id": 90003049, "body": "File copying implies file creation, so if file creation is blocked it makes sense that copying is also blocked."}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "edited": false, "score": 0, "creation_date": 1532516741, "post_id": 51517213, "comment_id": 90003066, "body": "@Felix Palment: thanks for the update, code is created in C. Removed C++ tag"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1532516892, "post_id": 51517213, "comment_id": 90003159, "body": "@Jesper Juhl: Thanks for update but is there any alternative solution? As its a requirement in my project"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1532517458, "post_id": 51517213, "comment_id": 90003490, "body": "but copy file include creation new file. because this it and blocked. and impossible determinate by what reason created new file - for copy some content from another file or by some another"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532518780, "post_id": 51517213, "comment_id": 90004341, "body": "@RbMm before checking the  IRP we are checking the device type. The above code is only executed for external device"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532518841, "post_id": 51517213, "comment_id": 90004383, "body": "and so what ? how this related to copy files/ block creation ?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532522078, "post_id": 51517213, "comment_id": 90006714, "body": "@RbMm Why would copying a file <b>from</b> the device require to <b>create</b> a file on that device? That file should be created in the destination folder."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532522304, "post_id": 51517213, "comment_id": 90006858, "body": "but need open file for copy. you block any file open"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532523514, "post_id": 51517213, "comment_id": 90007696, "body": "@RbMm, while commenting the above code. the file copying and open operations are working"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532523769, "post_id": 51517213, "comment_id": 90007881, "body": "i complete not understand what is &quot;working&quot; for you. how i view you block any file open"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532525980, "post_id": 51517213, "comment_id": 90009462, "body": "@RbMm while  removing the above code then copying and file opening is working.but while using the code  its not working"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532527006, "post_id": 51517213, "comment_id": 90010225, "body": "you block file open. so what you want ?"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532579684, "post_id": 51517213, "comment_id": 90029904, "body": "@RbMm I need to block only file/folder creation"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532580973, "post_id": 51517213, "comment_id": 90030203, "body": "@RbMm So,  <b>Is it possible to allow open and disable create options for files/folders</b> ?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1532581757, "post_id": 51517213, "comment_id": 90030424, "body": "of course yes. you need look for <code>CreateDisposition</code> parameter: <a href=\"https://github.com/Microsoft/Windows-driver-samples/blob/master/filesys/fastfat/create.c#L764\" rel=\"nofollow noreferrer\"><code>CreateDisposition = IrpSp-&gt;Parameters.Create.Options &gt;&gt; 24;</code></a> - if it <code>FILE_OPEN</code> - allow, otherwise disable"}, {"owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "edited": false, "score": 0, "creation_date": 1532585483, "post_id": 51517213, "comment_id": 90031711, "body": "OK. can you please mention Createdispostion datatype"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1532585908, "post_id": 51517213, "comment_id": 90031892, "body": "what is data type ? simply int. i show you example from fastfat. <code>CreateDisposition</code> this is exactly parameter from <code>IoCreateFile</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1532603568, "post_id": 51534319, "comment_id": 90042370, "body": "usually you need compare with <code>FILE_OPEN</code> and allow only this option, else another deny. say instead <code>FILE_CREATE</code> disposition we can use <code>FILE_OPEN_IF</code> - if file not exist - both disposition will have same effect. can be used <code>FILE_OVERWRITE_IF</code> and so on"}], "tags": [], "owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1532593692, "creation_date": 1532593692, "answer_id": 51534319, "question_id": 51517213, "link": "https://stackoverflow.com/questions/51517213/how-to-block-file-and-folder-creation-in-legacy-filter-driver-for-windows/51534319#51534319", "title": "How to block file and folder creation in Legacy filter driver for windows", "body": "<p>Thanks a lot, @RbMm.\nThis issue was solved using CREATE DISPOSITION. Below I am posting the code that I used to solve this issue. As a reference to others, </p>\n\n<pre><code>              if((irpSp-&gt;Parameters.Create.Options)&amp;FILE_DIRECTORY_FILE)\n                   {\n                       if((irpSp-&gt;Parameters.Create.Options &gt;&gt; 24) == FILE_CREATE)\n                       {\n                           Irp-&gt;IoStatus.Status = STATUS_ACCESS_DENIED;//Deny Access\n                           Irp-&gt;IoStatus.Information = 0;\n                           IoCompleteRequest(Irp, IO_NO_INCREMENT);\n                           return STATUS_ACCESS_DENIED;\n                       }\n                   }\n                   else if((irpSp-&gt;Parameters.Create.Options)&amp;FILE_NON_DIRECTORY_FILE)\n                   {\n                       if((irpSp-&gt;Parameters.Create.Options &gt;&gt; 24) == FILE_CREATE)\n                       {\n                           Irp-&gt;IoStatus.Status = STATUS_ACCESS_DENIED;//Deny Access\n                           Irp-&gt;IoStatus.Information = 0;\n                           IoCompleteRequest(Irp, IO_NO_INCREMENT);\n                           return STATUS_ACCESS_DENIED;\n                       }\n            }\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8724364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a881c0a307777c28633a15ebd837a14f?s=128&d=identicon&r=PG&f=1", "display_name": "NIKHIL V S", "link": "https://stackoverflow.com/users/8724364/nikhil-v-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 1, "accepted_answer_id": 51534319, "answer_count": 1, "score": 0, "last_activity_date": 1532593692, "creation_date": 1532516189, "last_edit_date": 1532517947, "question_id": 51517213, "link": "https://stackoverflow.com/questions/51517213/how-to-block-file-and-folder-creation-in-legacy-filter-driver-for-windows", "title": "How to block file and folder creation in Legacy filter driver for windows", "body": "<p>I am trying to create a legacy filter driver for windows to block the \"creation of file and folder\" in external storage devices.</p>\n\n<p>I tried with the following code</p>\n\n<pre><code>if( lDeviceType==cwUSBDRIVE || lDeviceType==cwEXTERNALHDD)\n{\n  if(irpSp-&gt;MajorFunction==IRP_MJ_CREATE)\n  {\n   if((irpSp-&gt;Parameters.Create.Options)&amp;FILE_DIRECTORY_FILE)\n    {\n            Irp-&gt;IoStatus.Status = STATUS_ACCESS_DENIED;//Deny Access\n        Irp-&gt;IoStatus.Information = 0;\n        IoCompleteRequest(Irp, IO_NO_INCREMENT);\n        return STATUS_ACCESS_DENIED;\n    }\n   else if((irpSp-&gt;Parameters.Create.Options)&amp;FILE_NON_DIRECTORY_FILE)\n   {\n\n        Irp-&gt;IoStatus.Status = STATUS_ACCESS_DENIED;//Deny Access\n        Irp-&gt;IoStatus.Information = 0;\n        IoCompleteRequest(Irp, IO_NO_INCREMENT);\n         return STATUS_ACCESS_DENIED;\n\n   }\n  }\n}\n</code></pre>\n\n<p>while working with the code it block's the file/folder creation. But it also block's file copying from device and file opening operations.</p>\n\n<p>I need to block the creation of file\\folder and allow the copying from the device and opening the files. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1532514430, "post_id": 51516564, "comment_id": 90001577, "body": "<code>++(*c)</code> is incrementing the char, not the pointer."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1532514527, "post_id": 51516564, "comment_id": 90001653, "body": "@stark I thought so too, but then why is the next <code>printf(&quot;%c\\n&quot;, *c);</code> printing 3 and not 2?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1532514528, "post_id": 51516564, "comment_id": 90001654, "body": "Regarding knowing when the pointer changed (as opposed to what it points to), you can always just use <code>%p</code> and print the value of the pointer if you want to see it. Or single step through your code in a <i>debugger</i> and watch the value of <code>c</code> (as well as the value of <code>*c</code>)."}, {"owner": {"reputation": 167, "user_id": 8676215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7FSj.jpg?s=128&g=1", "display_name": "tgtrmr", "link": "https://stackoverflow.com/users/8676215/tgtrmr"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1532514529, "post_id": 51516564, "comment_id": 90001657, "body": "@stark but does *++c increase the pointer?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1532514810, "post_id": 51516564, "comment_id": 90001838, "body": "@tgtrmr Of course it does. That&#39;s what <code>++c</code> does."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1532514860, "post_id": 51516564, "comment_id": 90001867, "body": "<code>*++c</code> is equivalent to <code>*(++c)</code>. So it increments the pointer, then dereferences the new value."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1532515066, "post_id": 51516564, "comment_id": 90002003, "body": "<code>printf(&quot;%c\\n&quot;, ++(*c)); &#47;&#47; 3 </code> This increments the character. The array now looks <code>&quot;1334567890&quot;</code> and after <code>printf(&quot;%c\\n&quot;, ++(*c)); &#47;&#47; 4</code> it looks like this: <code>&quot;1434567890&quot;</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1532515072, "post_id": 51516564, "comment_id": 90002008, "body": "@tgtrmr Printing the content of <code>i</code> using <code>%s</code> in each of those output lines would probably be helpful in understanding what is going on. The first five relevant lines report on, and change, the value at <code>i[1]</code>. The next line moves <code>c</code> to point to <code>i[2]</code>. The line after that just regurgitates the value reported on the prior line (<code>c</code> still points to <code>i[2]</code>). The last two lines repeat that process, moving <code>c</code> to point to <code>i[3]</code>, reporting the dereference, then reporting it again. Stepping through with a debugger make everything I just said crystal clear."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1532515171, "post_id": 51516564, "comment_id": 90002068, "body": "@PaulOgilvie - <code>c</code> doesn&#39;t change, it&#39;s just that incrementing the code point of <code>&#39;2&#39;</code> produces the code point of <code>&#39;3&#39;</code>. They must be sequential."}, {"owner": {"reputation": 167, "user_id": 8676215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7FSj.jpg?s=128&g=1", "display_name": "tgtrmr", "link": "https://stackoverflow.com/users/8676215/tgtrmr"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532515369, "post_id": 51516564, "comment_id": 90002218, "body": "@Gerhardh Thanks, man! That helped a lot!"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532515378, "post_id": 51516564, "comment_id": 90002228, "body": "See <a href=\"http://c-faq.com/ptrs/unopprec2.html\" rel=\"nofollow noreferrer\">question 4.3</a> in the old <a href=\"http://c-faq.com/\" rel=\"nofollow noreferrer\">C FAQ list</a>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1532515446, "post_id": 51516564, "comment_id": 90002280, "body": "Ah...<code>++(*c)</code> means to increment the character at <code>*c</code> and then use this changed value for <code>printf</code>. But now I am confused as how to write &quot;get the char at <code>c</code>, increment it and print it? (using <code>++</code>, not using <code>+1</code>)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1532517316, "post_id": 51516564, "comment_id": 90003386, "body": "@PaulOgilvie If you mean without changing the value of the original char, then the answer is that you can&#39;t do it using <code>++</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1532517469, "post_id": 51516564, "comment_id": 90003499, "body": "If you want to know when the pointer change its value why don&#39;t you just print the value after each step? Like: <code>printf(&quot;%p\\n&quot;, (void*)c);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "is_accepted": true, "score": 2, "last_activity_date": 1532518056, "creation_date": 1532518056, "answer_id": 51517762, "question_id": 51516564, "link": "https://stackoverflow.com/questions/51516564/when-do-pointers-change/51517762#51517762", "title": "When do pointers change?", "body": "<p>You are incrementing the contents and not the pointer.\nThis version shows the contents and the offset of the pointer into the contents of the array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char i[] = \"1234567890\";\n    char *c = &amp;i[1];\n\n    printf(\"Start:\\n\");\n    printf(\"%c\\n\", *c); // 2\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", ++(*c)); // 3 \n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", *c); // 3\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n\n    printf(\"%c\\n\", ++(*c)); // 4\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", *c); // 4\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", *++c); //3\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", *c); // 3\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", *++c); // 4\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n    printf(\"%c\\n\", *c); // 4\n    printf(\"%s %d\\n\",i,c - &amp;i[0]);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>It produces...</p>\n\n<pre><code>2                                                                                                                       \n1234567890 1                                                                                                            \n3                                                                                                                       \n1334567890 1                                                                                                            \n3                                                                                                                       \n1334567890 1                                                                                                            \n4                                                                                                                       \n1434567890 1                                                                                                            \n4                                                                                                                       \n1434567890 1                                                                                                            \n3                                                                                                                       \n1434567890 2                                                                                                            \n3                                                                                                                       \n1434567890 2                                                                                                            \n4                                                                                                                       \n1434567890 3                                                                                                            \n4                                                                                                                       \n1434567890 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1532518319, "creation_date": 1532518319, "answer_id": 51517848, "question_id": 51516564, "link": "https://stackoverflow.com/questions/51516564/when-do-pointers-change/51517848#51517848", "title": "When do pointers change?", "body": "<p>Here is a modification of your program.  It prints the array <code>i[]</code>, and an indication of where the pointer <code>c</code> is pointing, after each step.  (That pointer indication is printed a little trickily; I'll explain in a minute.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char i[] = \"1234567890\";\n    char *c = &amp;i[1];\n\n    printf(\"Start:\\n\");\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", ++(*c));\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", ++(*c));\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *++c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *++c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    printf(\"%c\\n\", *c);\n    printf(\"%s\\n\", i); printf(\"%*s^\\n\", (int)(c-i), \"\");\n    return 0;\n}\n</code></pre>\n\n<p>If you run this, it should help you see when <code>c</code> has moved and when it hasn't.  It should help you see where <code>c</code> points when the pointed-to character has been modified.</p>\n\n<p>The trick is the call</p>\n\n<pre><code>printf(\"%*s^\\n\", (int)(c-i), \"\");\n</code></pre>\n\n<p>The idea here is to print a <code>'^'</code> character offset from the left margin by a distance equivalent to the position <code>c</code> in the array <code>i</code>.  If <code>c</code> points to the beginning of <code>i</code>, we want to print 0 spaces, then <code>^</code>.  If <code>c</code> points one cell into <code>i</code>, we want to print one space, then <code>^</code>.  And so on.  The printf format <code>%*s</code> prints a string in a field with a width given by an argument.  I'm using that to print N spaces.  The argument I give it is <code>c-i</code>, which is the number of spaces I want to print.  The string I tell it to print is <code>\"\"</code>, the empty string.  I'm telling it to print the empty string in a field of width N, so its padding spaces (the ones printf adds to pad the string out to a width of N) are all that it prints, and all that I want it to print.  Then I print the <code>^</code>, and it comes out in the right spot.</p>\n"}], "owner": {"reputation": 167, "user_id": 8676215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7FSj.jpg?s=128&g=1", "display_name": "tgtrmr", "link": "https://stackoverflow.com/users/8676215/tgtrmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 51517762, "answer_count": 2, "score": 2, "last_activity_date": 1532518319, "creation_date": 1532514318, "last_edit_date": 1532514871, "question_id": 51516564, "link": "https://stackoverflow.com/questions/51516564/when-do-pointers-change", "title": "When do pointers change?", "body": "<p>I'm trying to understand pointer arithmetic and I thought I got it.\nWhen do pointers change? </p>\n\n<p>They cannot be increased/decreased by <code>ptr[-4]</code> neither by <code>*(ptr + 5)</code>, but <code>ptr++</code>, <code>++ptr</code>.</p>\n\n<p>I tried some code and I stumbled upon this:\nWhy is it suddenly decreasing, or do not add up to <code>6</code>?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char i[] = \"1234567890\";\n    char *c = &amp;i[1];\n\n    printf(\"Start:\\n\");\n    printf(\"%c\\n\", *c); // 2\n    printf(\"%c\\n\", ++(*c)); // 3 \n    printf(\"%c\\n\", *c); // 3\n    printf(\"%c\\n\", ++(*c)); // 4\n    printf(\"%c\\n\", *c); // 4\n    printf(\"%c\\n\", *++c); //3\n    printf(\"%c\\n\", *c); // 3\n    printf(\"%c\\n\", *++c); // 4\n    printf(\"%c\\n\", *c); // 4\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "glsl"], "answers": [{"comments": [{"owner": {"reputation": 2060, "user_id": 4043273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100001236868090/picture?type=large", "display_name": "wdc", "link": "https://stackoverflow.com/users/4043273/wdc"}, "edited": false, "score": 0, "creation_date": 1532524565, "post_id": 51518949, "comment_id": 90008393, "body": "Thanks for the answer. I don&#39;t have experience with shader storage buffer, but I will try if I don&#39;t succeed with the current approach."}, {"owner": {"reputation": 2060, "user_id": 4043273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100001236868090/picture?type=large", "display_name": "wdc", "link": "https://stackoverflow.com/users/4043273/wdc"}, "edited": false, "score": 0, "creation_date": 1532525199, "post_id": 51518949, "comment_id": 90008853, "body": "Although, I know the exact structure of the buffer, it goes three by three floats : <code>x,y,z</code> and then <code>r,g,b</code>. Is there a way to access only <code>x,y,z</code> parts, modify them, and store them back to the buffer, using image loading and <code>imageBuffer</code> as I did in above example? The problem is that <code>imageLoad</code> returns only <code>vec4</code>."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 2060, "user_id": 4043273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100001236868090/picture?type=large", "display_name": "wdc", "link": "https://stackoverflow.com/users/4043273/wdc"}, "edited": false, "score": 0, "creation_date": 1532525570, "post_id": 51518949, "comment_id": 90009152, "body": "Yes, as written in my comment to the other answer: using an <code>rgb32f</code> image should do the trick I think. Image loads/stores just work on entire elements. If you want your elements to just have three components, you have to use an element format with just three components. However, I&#39;m not sure why exactly you would use image load/store to access a buffer like this. Is there any specific reason? It seems unnecessarily complicated to me\u2026"}, {"owner": {"reputation": 2060, "user_id": 4043273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100001236868090/picture?type=large", "display_name": "wdc", "link": "https://stackoverflow.com/users/4043273/wdc"}, "edited": false, "score": 0, "creation_date": 1532525953, "post_id": 51518949, "comment_id": 90009446, "body": "Not some specific reason, I just saw this approach in the OpenGL Red Book. I will try the storage buffer now."}, {"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 2, "creation_date": 1532536694, "post_id": 51518949, "comment_id": 90016447, "body": "@MichaelKenzel: There is no rgb32f image format. Image texture can only consist of 1, 2 or 4 channels."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "reply_to_user": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 2, "creation_date": 1532537010, "post_id": 51518949, "comment_id": 90016602, "body": "@BDL indeed, I must have misread that in the spec. Then there&#39;s no simple way to achieve what he wants to achieve with image load/store at all."}, {"owner": {"reputation": 2060, "user_id": 4043273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100001236868090/picture?type=large", "display_name": "wdc", "link": "https://stackoverflow.com/users/4043273/wdc"}, "edited": false, "score": 0, "creation_date": 1532601866, "post_id": 51518949, "comment_id": 90041378, "body": "Just one more question. In your example of storage buffer, is <code>vertex_data[]</code> the whole buffer, or some part of it? Do I need to check the workgroups to know where in the buffer I am, or I can just iterate through the whole buffer from start to finish inside of &#39;vertex_data[]&#39; ?"}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1532602197, "post_id": 51518949, "comment_id": 90041568, "body": "What <code>vertex_data[]</code> becomes depends on how you bind your buffer to it. If you bind the whole buffer (e.g. with <code>glBindBufferBase()</code>), then it will be the whole buffer. You can get the length of the array via <code>vertex_data.length()</code>. I&#39;m not sure what you mean by &quot;iterate from start to finish inside of &#39;vertex_data[]&#39;&quot;."}], "tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": true, "score": 3, "last_activity_date": 1532522136, "last_edit_date": 1532522136, "creation_date": 1532521810, "answer_id": 51518949, "question_id": 51516363, "link": "https://stackoverflow.com/questions/51516363/how-to-modify-specific-attribute-of-a-vertex-in-compute-shader/51518949#51518949", "title": "How to modify specific attribute of a vertex in compute shader", "body": "<p>Vertex Array State defined by functions like <code>glVertexAttribPointer()</code> is only relevant when drawing with the graphics pipeline. It defines the mapping from buffer elements to input vertex attributes. It does not have any effect in compute mode.</p>\n\n<p>It is you yourself who defines the layout of your vertex buffer(s) and sets up the Vertex Array accordingly. Thus, you necessarily know where in your buffer to find which component of which attribute. If you didn't then you couldn't ever use the buffer to draw anything either.</p>\n\n<p>I'm not sure why exactly you chose to use image load/store to access your vertex data in your compute shader. I would suggest simply binding it as a <a href=\"https://www.khronos.org/opengl/wiki/Shader_Storage_Buffer_Object\" rel=\"nofollow noreferrer\">shader storage buffer</a>. Assuming your buffers just contain a bunch of floats, the probably simplest approach would be to just interpret them as an array of floats in your compute shader:</p>\n\n<pre><code>layout(std430, binding = 0) buffer VertexBuffer\n{\n    float vertex_data[];\n};\n</code></pre>\n\n<p>You can then just access the i-th float in your buffer as <code>vertex_data[i]</code> in your compute shader via a normal index, just like any other array\u2026</p>\n\n<p>Apart from all that, I should point out that the <code>glVertexAttribPointer()</code> call in your code above sets up the buffer for only one vertex attribute consisting of 4 floats rather than two attributes of 3 floats each.</p>\n"}], "owner": {"reputation": 2060, "user_id": 4043273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100001236868090/picture?type=large", "display_name": "wdc", "link": "https://stackoverflow.com/users/4043273/wdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 2, "accepted_answer_id": 51518949, "answer_count": 1, "score": 2, "last_activity_date": 1532540209, "creation_date": 1532513665, "last_edit_date": 1532517291, "question_id": 51516363, "link": "https://stackoverflow.com/questions/51516363/how-to-modify-specific-attribute-of-a-vertex-in-compute-shader", "title": "How to modify specific attribute of a vertex in compute shader", "body": "<p>I have a buffer containing <code>6</code> values, the first three being position and the other three are the color of the vertex. I want to modify those values in the compute shader, but only positions, not the color. I achieved this by using Image Load/Store, but I used all vertex data, not only a part of it (one attribute). So basically I don't know how to get only one attribute in compute shader, and modify it, and write it back to the buffer.</p>\n\n<hr>\n\n<p><strong>This is the code that worked for one (and only) attribute.</strong></p>\n\n<pre><code>glVertexAttribPointer(0, 4, GL_FLOAT, GL_FALSE, 0, NULL);\nglEnableVertexAttribArray(0);\n\nglGenTextures(1, &amp;position_tbo);\nglBindTexture(GL_TEXTURE_BUFFER, position_tbo);\nglTexBuffer(GL_TEXTURE_BUFFER, GL_RGBA32F, position_buffer);\n</code></pre>\n\n<hr>\n\n<p><strong>glsl:</strong></p>\n\n<pre><code>layout (local_size_x = 128) in;\n\nlayout (rgba32f, binding = 0) uniform imageBuffer position_buffer;\n\nvoid main(void)\n{\n    vec4 pos = imageLoad(position_buffer, int(gl_GlobalInvocationID.x));\n\n    pos.xyz = (translation * vec4(pos.xyz, 1.0)).xyz;\n\n    imageStore(position_buffer, int(gl_GlobalInvocationID.x), pos);\n}\n</code></pre>\n\n<p>So how do I store only part of the vertex data into <code>pos</code>, not all attributes? Where do I specify what attribute goes into <code>pos</code>? And if I <code>imageStore</code> some specific attribute back to the buffer, am I sure that only that part of the buffer will be changed (the attribute I want to modify) and other attributes will remain the same?</p>\n"}, {"tags": ["c", "struct", "arm", "malloc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532512112, "post_id": 51515810, "comment_id": 90000029, "body": "This design looks wrong to me, use an array instead of individual fields."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1532512222, "post_id": 51515810, "comment_id": 90000089, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532512891, "post_id": 51515810, "comment_id": 90000587, "body": "defining the size of a structure to a constant number seems a bad idea anyways. But then, this whole code just leaves a big question mark here."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532514098, "post_id": 51515810, "comment_id": 90001364, "body": "BTW: If you have an array with only 1 element, you probably don&#39;t need an array."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "edited": false, "score": 0, "creation_date": 1532513495, "post_id": 51516169, "comment_id": 90000993, "body": "And how to use memcpy to copy raw data in array to structure? I tried it, but it didn&#39;t work."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "edited": false, "score": 0, "creation_date": 1532513590, "post_id": 51516169, "comment_id": 90001045, "body": "Just as with every other data object: <code>memcpy(LimitySenzoru, set_limits, sizeof(*LimitySenzoru));</code> Of course you mustn&#39;t forget to provide memory for <code>LimitySenzoru</code> to point to."}, {"owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "edited": false, "score": 0, "creation_date": 1532513959, "post_id": 51516169, "comment_id": 90001272, "body": "This solution is working fine: <code>memcpy(LimitySenzoru, set_limits, sizeof(*LimitySenzoru));</code>. When I tried it, I forgot on * in sizeof(*LimitySenzoru)"}, {"owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "edited": false, "score": 0, "creation_date": 1532515390, "post_id": 51516169, "comment_id": 90002235, "body": "So in ARM it is working fine. But I tried implenet in online compiler, and I have mistake: <a href=\"https://onlinegdb.com/BkeuV0SVQ\" rel=\"nofollow noreferrer\">link</a> Any idea, what is wrong?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "edited": false, "score": 0, "creation_date": 1532515507, "post_id": 51516169, "comment_id": 90002316, "body": "Yes. Read my comment above. &quot;Of course you mustn&#39;t forget...&quot; No one likes <code>NULL</code>pointers."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 0, "last_activity_date": 1532513028, "creation_date": 1532513028, "answer_id": 51516169, "question_id": 51515810, "link": "https://stackoverflow.com/questions/51515810/fill-structure-with-data-in-array/51516169#51516169", "title": "Fill structure with data in array", "body": "<p>You have a dangling pointer:</p>\n\n<pre><code>/* fill structure by datas */\nLimitySenzoru = (Plimits)set_limits;\n/* free memory */\nfree(set_limits);\n</code></pre>\n\n<p>After this youf global variable <code>LimitySenzoru</code> points to the memory location that was freed. After freeing you are not allowed to access this memory location any longer. Otherwise you have <em>undefined behaviour</em>.</p>\n\n<p>From the comment you seem to mix some concepts.</p>\n\n<p>You do <em>not</em> fill any data into any struct. You simply copy a pointer. Nothing else.\nYou either need to keep the allocated memory and not <code>free</code> it or you need to allocate memory for <code>LimitySenzoru</code> and do some <code>memcpy</code> to fill data from one struct into the other.</p>\n"}], "owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 51516169, "answer_count": 1, "score": 0, "last_activity_date": 1532518886, "creation_date": 1532511991, "last_edit_date": 1532518886, "question_id": 51515810, "link": "https://stackoverflow.com/questions/51515810/fill-structure-with-data-in-array", "title": "Fill structure with data in array", "body": "<p>I have an array with raw data with the size of <code>64 bytes</code></p>\n\n<pre><code>#define SIZE_OF_LIMITS_STRUCTURE 64\nuint32_t *set_limits = (uint32_t *)malloc(SIZE_OF_LIMITS_STRUCTURE);\n</code></pre>\n\n<p>I fill This array with actual data from memory.</p>\n\n<hr>\n\n<p>And I have a structure (size of the structure is <code>64 bytes</code>)</p>\n\n<pre><code>typedef struct {\n    uint8_t A\n    uint8_t B\n    uint8_t C\n    uint8_t D\n    uint8_t E\n    uint8_t F\n    uint8_t G\n    uint8_t H\n    uint16_t I\n    uint16_t J\n    uint16_t K\n    uint16_t L\n    uint16_t M\n    uint16_t N\n    uint16_t O\n    uint16_t P\n    uint16_t Q\n    uint16_t R\n    uint16_t S\n    uint16_t T\n    uint16_t U\n    uint16_t V\n    uint16_t W\n    uint16_t X\n    uint16_t Y\n    uint16_t Z\n    uint16_t AA\n    uint16_t BB\n    uint16_t CC\n    uint16_t DD\n    uint16_t EE\n    uint16_t FF\n    uint16_t GG\n    uint16_t HH\n    uint16_t II\n    uint16_t JJ\n} __attribute__ ((packed)) Limits,  *Plimits;\n</code></pre>\n\n<p>And I need to update value in this structure with data in the array:</p>\n\n<pre><code>LimitySenzoru = (Plimits)set_limits;\n</code></pre>\n\n<p>And the function is wrong. And I don't know why.</p>\n\n<hr>\n\n<p>Here is the complete function to fill structure:</p>\n\n<pre><code>volatile Plimits LimitySenzoru = NULL;\n\nvoid update_structure(void)\n{\n    uint32_t *set_limits = (uint32_t *)malloc(SIZE_OF_LIMITS_STRUCTURE);\n    uint32_t addr = ADDRESS_OF_LIMITS_IN_MEM;\n    uint32_t test[] = {0};\n\n    for(uint8_t i = 0; i &lt; SIZE_OF_LIMITS_STRUCTURE/4; ++i)\n    {\n        Read_from_memory_32(addr, test); //read datas from memory to array\n        set_limits[i] = test[0];\n        addr += 4;\n    }\n\n    /* fill structure by datas */\n    LimitySenzoru = (Plimits)set_limits;\n\n    /* free memory */\n    free(set_limits);\n}\n</code></pre>\n\n<p>When I fill the structure, with data and print it:</p>\n\n<pre><code>datas = [4, 8, 18, 21, 0, 5, 30, 31, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 92, 94, 99, 101, 104, 109, 113, 119, 125, 126, 128, 129, 132, 134, 135, 137, 138, 141, 150, 151, 153, 159, 161, 167, 169, 170, 178, 179, 183, 187, 195, 197, 204, 206, 207, 208, 213, 218, 223, 230, 240, 248]\n</code></pre>\n\n<p><code>The first 4 values (A, B, C, D)</code> are <code>0</code>.\nWhen I disable <code>free</code>, the structure filling is completed, but it doesn't refresh value.</p>\n\n<p>Any idea, how to fill structure with raw datas?</p>\n"}, {"tags": ["c", "algorithm", "data-structures", "computation-theory", "turing-machines"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1532538009, "post_id": 51515346, "comment_id": 90017120, "body": "Before you get too far, why do it in C? You are talking a lot about objects and containers. Newer languages (dare I say c++) have those in bucket loads!"}, {"owner": {"reputation": 705, "user_id": 9593060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892710857405653/picture?type=large", "display_name": "Mattia Surricchio", "link": "https://stackoverflow.com/users/9593060/mattia-surricchio"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1532555602, "post_id": 51515346, "comment_id": 90024962, "body": "Yep, i&#39;m aware of that, but it&#39;s a costraint imposed by a project!"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1532598563, "post_id": 51515346, "comment_id": 90039342, "body": "Ok. Well remember you have realloc if you need to grow a list."}], "owner": {"reputation": 705, "user_id": 9593060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892710857405653/picture?type=large", "display_name": "Mattia Surricchio", "link": "https://stackoverflow.com/users/9593060/mattia-surricchio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536177329, "creation_date": 1532510604, "question_id": 51515346, "link": "https://stackoverflow.com/questions/51515346/computational-tree-and-graphs-to-simulate-nd-turing-machine", "title": "Computational Tree and Graphs to simulate ND Turing Machine", "body": "<p>I'm trying to write a C code to simulate a Non Deterministic Turing Machine. So far i've already implemented the input tape and the transition tape, using a simple double linked list for the first, and a linked list for the second.</p>\n\n<p>The idea was to build a Computational Tree like this: <a href=\"https://ptolemy.berkeley.edu/projects/embedded/research/vis/doc/VisUser/vis_user/_5935_figure250.gif\" rel=\"nofollow noreferrer\">Computational Tree</a></p>\n\n<p>Where each node consists in a configuration of my Turing Machine: </p>\n\n<ol>\n<li>Current State</li>\n<li>Content of the Input Tape</li>\n<li>Position of the Pointer in the Input tape</li>\n</ol>\n\n<p>Because of non determinism i have to check and run recursively through the whole tree, which implies avery large amount of memory allocation ( 1 node for each possible configuration ).</p>\n\n<p>Is there a better data structure to simulate a ND Turing Machine? I was thinking about <strong>Orientated Graphs</strong> (which is also what you usually use to describe a Turing Machine on paper) and implement it using an <strong>Adjacency List</strong> like suggested here: <a href=\"https://www.geeksforgeeks.org/graph-and-its-representations/\" rel=\"nofollow noreferrer\">Adjacency list</a> (because i don't know a priori the number of possible states, and arrays in C are not dynamic).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 4, "creation_date": 1532510049, "post_id": 51515139, "comment_id": 89998590, "body": "<code>a.data</code> is a <b>pointer</b>, so you can&#39;t just use <code>.</code> (<code>-&gt;</code> would be appropriate). And then, <code>a.data</code> has type <code>void *</code>, you can&#39;t ever dereference that!"}, {"owner": {"reputation": 752, "user_id": 7659542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/bCzvu.jpg?s=128&g=1", "display_name": "traducerad", "link": "https://stackoverflow.com/users/7659542/traducerad"}, "edited": false, "score": 0, "creation_date": 1532510214, "post_id": 51515139, "comment_id": 89998705, "body": "@FelixPalmen true about the arrow. I didn&#39;t pay attention to that when writing this simplified code snippet. But doing A.data-&gt;function, doesn&#39;t work. What is the correct way of doing this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532510299, "post_id": 51515139, "comment_id": 89998761, "body": "As I said, <code>a.data</code> is a pointer <b>to <code>void</code></b>. That&#39;s an unknown/generic pointer. You can&#39;t dereference it. I see no reason why you use <code>void *</code> in the first place, just use the correct type."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1532510341, "post_id": 51515139, "comment_id": 89998791, "body": "What are you trying to do? A.data is of type <code>void*</code>. If you want to use it as B_t object, you need to tell the compiler that it&#39;s a B_t object (he&#39;s just a child, not very smart). You need to cast it if you want to use as B_t object, like <code>((B_t*)A.data)-&gt;function()</code>."}, {"owner": {"reputation": 752, "user_id": 7659542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/bCzvu.jpg?s=128&g=1", "display_name": "traducerad", "link": "https://stackoverflow.com/users/7659542/traducerad"}, "edited": false, "score": 0, "creation_date": 1532510355, "post_id": 51515139, "comment_id": 89998800, "body": "@FelixPalmen I need this because I may need to point to any type of structure. Depending on the type of structure you have different functions."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532510421, "post_id": 51515139, "comment_id": 89998851, "body": "then you need to remember that type in another way (e.g. a custom defined enum) and cast as appropriate before dereferencing. C doesn&#39;t have <b>any</b> type information in the resulting program, so there&#39;s really no way to know what to do with a <code>void *</code>."}, {"owner": {"reputation": 752, "user_id": 7659542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/bCzvu.jpg?s=128&g=1", "display_name": "traducerad", "link": "https://stackoverflow.com/users/7659542/traducerad"}, "edited": false, "score": 0, "creation_date": 1532510435, "post_id": 51515139, "comment_id": 89998857, "body": "@FelixPalmen Long story short, it&#39;s about encapsulation. B can be &quot;encapsulated&quot; in any type of structure: A_t, C_t, ... I need to access the parent"}, {"owner": {"reputation": 752, "user_id": 7659542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/bCzvu.jpg?s=128&g=1", "display_name": "traducerad", "link": "https://stackoverflow.com/users/7659542/traducerad"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1532510557, "post_id": 51515139, "comment_id": 89998954, "body": "@KamilCuk segmentation fault: <a href=\"https://paste.ubuntu.com/p/qtfvSMW4pK/\" rel=\"nofollow noreferrer\">paste.ubuntu.com/p/qtfvSMW4pK</a>"}, {"owner": {"reputation": 752, "user_id": 7659542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/bCzvu.jpg?s=128&g=1", "display_name": "traducerad", "link": "https://stackoverflow.com/users/7659542/traducerad"}, "edited": false, "score": 0, "creation_date": 1532510708, "post_id": 51515139, "comment_id": 89999067, "body": "@FelixPalmen Casting doesn&#39;t seem to work, it gives a segmentation fault for some reason. (cf. above)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532511608, "post_id": 51515139, "comment_id": 89999698, "body": "Casting does not replace a missing initialization.<code>B.function</code> is not initialized."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532512452, "post_id": 51515139, "comment_id": 90000274, "body": "@Gerhardh <code>B.function = myfunction;</code> &lt;- I&#39;d say it is ..."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532512526, "post_id": 51515139, "comment_id": 90000333, "body": "@FelixPalmen The version with cast is in the pastebin link. Not the code in the question body. The line you quote was removed there."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 4, "last_activity_date": 1532512300, "last_edit_date": 1532512300, "creation_date": 1532510745, "answer_id": 51515392, "question_id": 51515139, "link": "https://stackoverflow.com/questions/51515139/c-request-for-member-in-something-not-a-structure-or-union/51515392#51515392", "title": "C - request for member in something not a structure or union", "body": "<p>data is of type void *, you need to type cast before de-referencing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct\n{\n    void *data;\n} A_t;\n\ntypedef struct\n{\n    void (*function)(void);\n} B_t;\n\nvoid myfunction(void)\n{\n    fprintf(stdout, \"Hello world.\\n\");\n}\n\nint main(int p_argc, char *p_argv[])\n{\n    A_t A;\n    B_t B;\n\n    B.function = myfunction;\n    A.data = &amp;B;\n    ((B_t*)(A.data))-&gt;function();\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 752, "user_id": 7659542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/bCzvu.jpg?s=128&g=1", "display_name": "traducerad", "link": "https://stackoverflow.com/users/7659542/traducerad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 51515392, "answer_count": 1, "score": 0, "last_activity_date": 1532512300, "creation_date": 1532509947, "question_id": 51515139, "link": "https://stackoverflow.com/questions/51515139/c-request-for-member-in-something-not-a-structure-or-union", "title": "C - request for member in something not a structure or union", "body": "<p>Long story short I am trying to access a function inside one of my structures. Below is a simplified verson of my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct\n{\n    void *data;\n} A_t;\n\ntypedef struct\n{\n    void (*function)(void);\n} B_t;\n\nvoid myfunction(void)\n{\n    fprintf(stdout, \"Hello world.\\n\");\n}\n\nint main(int p_argc, char *p_argv[])\n{\n    A_t A;\n    B_t B;\n\n    B.function = myfunction;\n    A.data = &amp;B;\n    A.data.function();\n\n    return 0;\n}\n</code></pre>\n\n<p>When trying to compile this code I get:</p>\n\n<pre><code>main.c:24:11: error: request for member \u2018function\u2019 in something not a structure or union\n A.data.function();\n</code></pre>\n\n<p>Could somebody explain me how to properly access this function via the A-structure?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "gcc", "g++", "stm32", "redefinition"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4449578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c779bd2b349c4a9164bc446c92cd?s=128&d=identicon&r=PG&f=1", "display_name": "Ril Dank", "link": "https://stackoverflow.com/users/4449578/ril-dank"}, "edited": false, "score": 0, "creation_date": 1532515004, "post_id": 51515564, "comment_id": 90001961, "body": "I have tried redefining <code>_write(int, const void*, size_t)</code> but it is not linked. Anything more I should do to make it work ? Also, where can I  get the list of all other functions that I should redefine ?"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 97, "user_id": 4449578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c779bd2b349c4a9164bc446c92cd?s=128&d=identicon&r=PG&f=1", "display_name": "Ril Dank", "link": "https://stackoverflow.com/users/4449578/ril-dank"}, "edited": false, "score": 0, "creation_date": 1532515399, "post_id": 51515564, "comment_id": 90002244, "body": "What do you mean by <i>not linked</i>? Does the linker fail with an error message (then copy it here), or is it silently ignored, and not showing up in the <code>.map</code> file? Are you indeed using <code>newlib</code> and the supplied headers or something else? What other library functions did you replace?"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 97, "user_id": 4449578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c779bd2b349c4a9164bc446c92cd?s=128&d=identicon&r=PG&f=1", "display_name": "Ril Dank", "link": "https://stackoverflow.com/users/4449578/ril-dank"}, "edited": false, "score": 0, "creation_date": 1532515731, "post_id": 51515564, "comment_id": 90002434, "body": "<a href=\"https://sourceware.org/newlib/libc.html#Syscalls\" rel=\"nofollow noreferrer\">The user-supplied functions are documented here</a>, with trivial implementation examples. You don&#39;t have to actually implement all of them, only the ones that the linker can&#39;t resolve."}, {"owner": {"reputation": 97, "user_id": 4449578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c779bd2b349c4a9164bc446c92cd?s=128&d=identicon&r=PG&f=1", "display_name": "Ril Dank", "link": "https://stackoverflow.com/users/4449578/ril-dank"}, "edited": false, "score": 0, "creation_date": 1532517941, "post_id": 51515564, "comment_id": 90003825, "body": "I&#39;ve redefined only <code>_write</code>. Actually, it is in the .map but when I debug, I cannot set a breakpoint inside the function, that&#39;s why I was thinking it was ignored by the linker. Yes, I&#39;m using newlib. I didn&#39;t replace any other library function."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 3, "last_activity_date": 1532511251, "creation_date": 1532511251, "answer_id": 51515564, "question_id": 51515052, "link": "https://stackoverflow.com/questions/51515052/redefining-fputc-function-when-using-arm-none-eabi-toolchain/51515564#51515564", "title": "Redefining fputc function when using arm-none-eabi toolchain", "body": "<p>The <code>arm-none-eabi-</code> toolchain is using newlib, which lets you redefine <code>_write(int fd, const void *buf, size_t count)</code> instead, all stdio output functions would then use that interface. <code>fd==1</code> would correspond to <code>stdout</code>, <code>fd==2</code> to <code>stderr</code>. You must provide a few more stub functions, like</p>\n\n<pre><code>void _exit(int) {\n  while(1)\n    ;\n}\n</code></pre>\n\n<p>etc. Most of them are trivial, but <code>printf()</code> requires a working <code>_sbrk()</code> too, because it uses <code>malloc()</code> internally.</p>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 4344152, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/9sjMm.jpg?s=128&g=1", "display_name": "Pavel Lebedeff", "link": "https://stackoverflow.com/users/4344152/pavel-lebedeff"}, "is_accepted": false, "score": 1, "last_activity_date": 1607204545, "last_edit_date": 1607204545, "creation_date": 1607197017, "answer_id": 65161155, "question_id": 51515052, "link": "https://stackoverflow.com/questions/51515052/redefining-fputc-function-when-using-arm-none-eabi-toolchain/65161155#65161155", "title": "Redefining fputc function when using arm-none-eabi toolchain", "body": "<p>Just had the same problem converting project from Keil to Cube. Found this elegant <a href=\"https://gist.github.com/glegrain/ca92f631e578450a933c67ac3497b4df\" rel=\"nofollow noreferrer\">STM32 printf retarget to UART</a> solution on GitHub (and please forgive the copy-paste):</p>\n<pre><code>/*# 7- Retarget printf to UART (std library and toolchain dependent) #########*/\n\n#if defined(__GNUC__)\nint _write(int fd, char * ptr, int len)\n{\n  HAL_UART_Transmit(&amp;huart1, (uint8_t *) ptr, len, HAL_MAX_DELAY);\n  return len;\n}\n#elif defined (__ICCARM__)\n#include &quot;LowLevelIOInterface.h&quot;\nsize_t __write(int handle, const unsigned char * buffer, size_t size)\n{\n  HAL_UART_Transmit(&amp;huart1, (uint8_t *) buffer, size, HAL_MAX_DELAY);\n  return size;\n}\n#elif defined (__CC_ARM)\nint fputc(int ch, FILE *f)\n{\n    HAL_UART_Transmit(&amp;huart1, (uint8_t *)&amp;ch, 1, HAL_MAX_DELAY);\n    return ch;\n}\n#endif\n\n// OR:\n\n// Add syscalls.c with GCC\n\n#ifdef __GNUC__\n#define PUTCHAR_PROTOTYPE int __io_putchar(int ch)\n#else\n#define PUTCHAR_PROTOTYPE int fputc(int ch, FILE *f)\n#endif /* __GNUC__ */\n\n/**\n  * @brief  Retargets the C library printf function to the USART.\n  * @param  None\n  * @retval None\n  */\nPUTCHAR_PROTOTYPE\n{\n  HAL_UART_Transmit(&amp;huart1, (uint8_t *)&amp;ch, 1, HAL_MAX_DELAY);\n  return ch;\n}\n</code></pre>\n<p>This may or may not work in your particular case, but you get the Idea...\nIn my case, I had to prepend function type with <code>extern &quot;C&quot;</code> :</p>\n<pre><code>extern &quot;C&quot; int _write(int fd, char * ptr, int len)\n{\n  HAL_UART_Transmit(&amp;huart1, (uint8_t *) ptr, len, HAL_MAX_DELAY);\n  return len;\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 4449578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c779bd2b349c4a9164bc446c92cd?s=128&d=identicon&r=PG&f=1", "display_name": "Ril Dank", "link": "https://stackoverflow.com/users/4449578/ril-dank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1607204545, "creation_date": 1532509671, "last_edit_date": 1532511321, "question_id": 51515052, "link": "https://stackoverflow.com/questions/51515052/redefining-fputc-function-when-using-arm-none-eabi-toolchain", "title": "Redefining fputc function when using arm-none-eabi toolchain", "body": "<p>We have an <code>STM32</code> C/C++ project and we have redefined the weak <code>fputc(int, FILE *)</code> function in order to redirect <code>printf</code> output to some <code>UART</code> channel.</p>\n\n<p>Up until now, we were building the project under <strong>IAR</strong> with the <a href=\"https://en.wikipedia.org/wiki/IAR_Systems\" rel=\"nofollow noreferrer\"><strong>IAR compiler</strong></a>. The logging through <code>UART</code> was working fine.</p>\n\n<p>We have now switched to the <code>arm-none-eabi toolchain</code> and are building the project with <code>g++</code>. But it looks like the redefinition of the <code>fputc</code> function is not linked anymore and so the <code>UART</code> logging is not working.</p>\n\n<p>How can I force the use of the redefined function by <code>printf</code>?</p>\n"}, {"tags": ["c", "makefile", "cmake", "infineon"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 6843805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479d4002423e7a780d7ca0542f609760?s=128&d=identicon&r=PG&f=1", "display_name": "KPR", "link": "https://stackoverflow.com/users/6843805/kpr"}, "is_accepted": true, "score": 3, "last_activity_date": 1532512921, "last_edit_date": 1532512921, "creation_date": 1532512397, "answer_id": 51515950, "question_id": 51514346, "link": "https://stackoverflow.com/questions/51514346/cmake-toolchain-file-for-custom-toolchain-c-compiler-option-different-meaning/51515950#51515950", "title": "CMake toolchain file for custom toolchain (-c compiler option different meaning)", "body": "<p>OK I was able to find solution. To achieve it I had to overwrite default behavior by setting   <code>CMAKE_&lt;LANG&gt;_COMPILE_OBJECT</code> variable,  so in my case bellow lines </p>\n\n<pre><code>set(target_compiler ${CMAKE_C_COMPILER})\nset(CMAKE_C_FLAGS \"-c 99\")\nset(CMAKE_C_COMPILE_OBJECT \"${target_compiler} &lt;INCLUDES&gt; &lt;FLAGS&gt; -o &lt;OBJECT&gt; &lt;SOURCE&gt;\")\n</code></pre>\n\n<p>solved my problem  </p>\n"}], "owner": {"reputation": 91, "user_id": 6843805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479d4002423e7a780d7ca0542f609760?s=128&d=identicon&r=PG&f=1", "display_name": "KPR", "link": "https://stackoverflow.com/users/6843805/kpr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 51515950, "answer_count": 1, "score": 1, "last_activity_date": 1539263044, "creation_date": 1532507637, "question_id": 51514346, "link": "https://stackoverflow.com/questions/51514346/cmake-toolchain-file-for-custom-toolchain-c-compiler-option-different-meaning", "title": "CMake toolchain file for custom toolchain (-c compiler option different meaning)", "body": "<p>I try to create CMake toolchain file for Tasking Aurix compiler (ctc) in which <code>-c</code> option have different meaning: </p>\n\n<pre><code>-c --iso=&lt;year&gt;                    ISO C standard (90, 99) (default: 99)\n</code></pre>\n\n<p>Is it possible to omit <code>-c</code> parameter for object files recipes or maybe it's possible to set custom template for such recipes?</p>\n\n<p>Currently I have ugly workaround for it so after CMake I call script which edit generated makefile's and change option <code>-c</code> to <code>-c 99</code> but preferably I would like to be able to generate valid makefile's from CMake directly. </p>\n"}, {"tags": ["c", "pointers", "memory-management", "constants", "qualifiers"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1532505747, "post_id": 51513615, "comment_id": 89995819, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2819535/unable-to-free-const-pointers-in-c\">Unable to free const pointers in C</a>"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1532506147, "post_id": 51513615, "comment_id": 89996067, "body": "@SanderDeDycker Yeah suppressing the warning by casting is the obvious answer and it works. However, you have to be very careful when doing this, so I want to see if someone can provide a safer alternative. For example, maybe there is a way to &quot;lock&quot; some memory, preventing subsequent writing operations."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1532506780, "post_id": 51513615, "comment_id": 89996458, "body": "the accepted (and most voted) answer in the duplicate question isn&#39;t the only answer - it&#39;s just the one that the community supports most. Other answers recommend not using <code>const</code> in this case eg. You could do <code>char* u = malloc(...); const char* cu = u; puts(cu); free(u);</code> - ie. use <code>u</code> only for the de-allocation, and <code>cu</code> for everything else."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1532518928, "post_id": 51513615, "comment_id": 90004446, "body": "<code>The returned string is &quot;SOME DUDE&quot;</code> is not completely correct. <code>username</code> does not certainly point to a <i>string</i> as the data pointed to by <code>username</code> does not certainly contain a <i>null character</i>."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532524957, "post_id": 51513615, "comment_id": 90008675, "body": "@chux My bad, forgot to add a NUL terminator. Good catch."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 2, "last_activity_date": 1532513858, "creation_date": 1532513858, "answer_id": 51516410, "question_id": 51513615, "link": "https://stackoverflow.com/questions/51513615/how-to-const-qualify-dynamically-allocated-data/51516410#51516410", "title": "How to const-qualify dynamically allocated data?", "body": "<p>First of all, you must understand that there's nothing ever preventing your compiled code from overwriting any data, be it declared <code>const</code> or not. Still <code>const</code> correctness helps you spotting logical errors in your code, so it's a good idea.</p>\n\n<p>For your concrete problem, I would suggest doing a little OOP-like information hiding here. You could e.g. model a user session like this:</p>\n\n<p><strong>session.h</strong>:</p>\n\n<pre><code>#ifndef SESSION_H\n#define SESSION_H\n\ntypedef struct Session Session;\n\nSession *Session_create(void);\nint Session_setUsername(Session *self, const char *username);\nconst char *Session_Username(const Session *self);\nvoid Session_destroy(Session *self);\n\n#endif\n</code></pre>\n\n<p><strong>session.c</strong>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"session.h\"\n\nstruct Session\n{\n    char *username;\n};\n\nSession *Session_create(void)\n{\n    Session *self = calloc(1, sizeof *self);\n    return self;\n}\n\nint Session_setUsername(Session *self, const char *username)\n{\n    free(self-&gt;username);\n    self-&gt;username = malloc(strlen(username) + 1);\n    if (!self-&gt;username) return -1;\n    strcpy(self-&gt;username, username);\n    return 0;\n}\n\nconst char *Session_Username(const Session *self)\n{\n    return self-&gt;username;\n}\n\nvoid Session_destroy(Session *self)\n{\n    if (!self) return;\n    free(self-&gt;username);\n    free(self);\n}\n</code></pre>\n\n<p>Now, if you have somewhere in your code a <code>const Session *</code>, you won't be able to manipulate any session data. You can only get a <code>const</code> pointer to your username.</p>\n"}], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532513858, "creation_date": 1532505219, "question_id": 51513615, "link": "https://stackoverflow.com/questions/51513615/how-to-const-qualify-dynamically-allocated-data", "title": "How to const-qualify dynamically allocated data?", "body": "<p>According to <a href=\"https://stackoverflow.com/a/11057357/5399734\">this answer</a>, constants shouldn't be deleted because they may not be allocated in the first place. However, there exists some cases where I want to protect dynamically allocated data. For example, when managing user sessions<sup>\u2020</sup>, I want to make sure that data like the current user name won't accidentally get overwritten by other functions, but the session data are indeed allocated when they are parsed from the request.</p>\n\n<p>Here is a code example to give you a better idea. Please keep in mind that things are greatly simplified, though.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nconst char *request = \"www.example.com/index?first-name=SOME&amp;last-name=DUDE\";\n\nchar *get_username_from_request(const char *req) {\n    char *first_name = strstr(req, \"first-name\") + strlen(\"first-name\") + 1;\n    char *last_name = strstr(req, \"last-name\") + strlen(\"last-name\") + 1;\n\n    char *username = malloc(10);\n    memcpy(username, first_name, 4);\n    username[4] = ' ';\n    memcpy(username + 5, last_name, 4);\n\n    /* The returned string is \"SOME DUDE\" */\n    return username;\n}\n\nint main(void) {\n    char *username = get_username_from_request(request);\n    printf(\"Welcome, %s.\\n\", username);\n    free(username);\n    return 0;\n}\n</code></pre>\n\n<p>I really want to use <code>const char *username = get_username_from_request(request);</code> instead, but Clang emits a warning when I make this change:</p>\n\n<pre><code>/Applications/CLion.app/Contents/bin/cmake/bin/cmake --build /Users/nalzok/CLionProjects/zero/cmake-build-debug --target zero -- -j 2\nScanning dependencies of target zero\n[ 50%] Building C object CMakeFiles/zero.dir/main.c.o\n/Users/nalzok/CLionProjects/zero/main.c:24:10: warning: passing 'const char *' to parameter of type 'void *' discards qualifiers [-Wincompatible-pointer-types-discards-qualifiers]\n    free(username);\n         ^~~~~~~~\n/usr/include/stdlib.h:151:18: note: passing argument to parameter here\nvoid     free(void *);\n                    ^\n1 warning generated.\n[100%] Linking C executable zero\n[100%] Built target zero\n</code></pre>\n\n<p>Any idea is appreciated.</p>\n\n<p><sub>\u2020: Well, <a href=\"https://bitbucket.org/nalzok/kernod\" rel=\"nofollow noreferrer\">believe it or not</a>, I'm writing a Web application in C.</sub></p>\n"}, {"tags": ["c", "unions"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1532504790, "post_id": 51513418, "comment_id": 89995305, "body": "Those <code>bit_word</code> members are all in an union, each of them represents same memory. Those <code>bit_word</code> members should be inside a <code>struct</code> that is inside that union to group them together."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1532504906, "post_id": 51513418, "comment_id": 89995366, "body": "what @KamilCuk said, plus there&#39;s no guarantee about padding of bit fields, so a portable solution can&#39;t be done with a union ... just provide macros / (inline) functions to access the individual bits using some masking instead."}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1532505297, "post_id": 51513418, "comment_id": 89995583, "body": "Thanks @KamilCuk, it worked correctly when I declared ascii_7_bits_word_0, parity_bit_word_0, ascii_7_bits_word_1, parity_bit_word_1 inside a struct in that union. But why it did not worked in the previous kinda declaration, I still did not get it?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1532507142, "post_id": 51513418, "comment_id": 89996694, "body": "union can hold only one of ALL it&#39;s members, <a href=\"https://en.cppreference.com/w/c/language/union\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/union</a> , not first and all the the rest."}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1532507913, "post_id": 51513418, "comment_id": 89997173, "body": "Thanks @KamilCuk, actually you should have written this as an answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 2, "creation_date": 1532508910, "post_id": 51514518, "comment_id": 89997828, "body": "There <i>are</i> guarantees about padding of bitfield structures. C11 6.7.2.1p11 &quot;shall be packed into adjacent bits of the same unit&quot;. The <i>order</i> of the packing and the size of the units is implementation-defined, but that is still predictable and must be documented by your compiler (if you don&#39;t know the value of <code>CHAR_BIT</code> for your platform, take a step back before playing with bits...). Within a unit, the order of bitfields is also only important if the value needs to be reinterpreted as something else (OK, in this particular case it does; in most cases bit-order is meaningless in C)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1532509051, "post_id": 51514518, "comment_id": 89997926, "body": "@Leushenko well, that was imprecise indeed, still you can&#39;t write code like this and expect it to behave as intended on any system. Changed the text a bit to just refer your comment, explaning it all in detail would IMHO be a bit too much for an answer here."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 4, "last_activity_date": 1532509244, "last_edit_date": 1532509244, "creation_date": 1532508206, "answer_id": 51514518, "question_id": 51513418, "link": "https://stackoverflow.com/questions/51513418/extracting-bit-positions-in-a-union-of-16-bits-in-c/51514518#51514518", "title": "Extracting bit positions in a union of 16 bits in C", "body": "<p>Looking at this:</p>\n\n<pre><code>typedef union {\n    uint8_t full_8_char_byte[2];\n    uint8_t ascii_7_bits_word_0 : 7; /* another way of representing LSP 7 ASCII bits */\n    uint8_t parity_bit_word_0 : 1;   /* another way of representing MSP parity bit */\n    uint8_t ascii_7_bits_word_1 : 7; /* another way of representing LSP 7 ASCII bits */\n    uint8_t parity_bit_word_1 : 1;   /* another way of representing MSP parity bit */\n} ip_char_t;\n</code></pre>\n\n<p>The comments suggest you expect the 4 bitfield members to map the bits of the first array member. That won't work, because <strong>all</strong> members of a <code>union</code> are alternative possible contents, which also means every member will be placed at the very beginning. What you probably meant to write instead is</p>\n\n<pre><code>typedef union {\n    uint8_t full_8_char_byte[2];\n    struct {\n        uint8_t ascii_7_bits_word_0 : 7; /* another way of representing LSP 7 ASCII bits */\n        uint8_t parity_bit_word_0 : 1;   /* another way of representing MSP parity bit */\n        uint8_t ascii_7_bits_word_1 : 7; /* another way of representing LSP 7 ASCII bits */\n        uint8_t parity_bit_word_1 : 1;   /* another way of representing MSP parity bit */\n    };\n} ip_char_t;\n</code></pre>\n\n<p>So this union can <em>either</em> contain your array <em>or</em> a struct with bitfields.</p>\n\n<hr>\n\n<p>Note that this doesn't solve your problem in a portable way: There are no strict guarantees about how your bitfield will be arranged, see Leushenko's comment for details! For solving this problem portably, you can for example provide macros to access the individual bits, e.g.</p>\n\n<pre><code>typedef uint8_t ip_char_t[2];\n\n#define ascii_7_bits_word(x,i) ((x)[i] &amp; 0x7f)\n#define parity_bit_word(x,i) ((x)[i] &gt;&gt; 7)\n</code></pre>\n\n<p>Or, if you also need to write to the bits or want to enforce type safety, write (inline) functions instead.</p>\n"}], "owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 51514518, "answer_count": 1, "score": 1, "last_activity_date": 1532509244, "creation_date": 1532504497, "last_edit_date": 1532505347, "question_id": 51513418, "link": "https://stackoverflow.com/questions/51513418/extracting-bit-positions-in-a-union-of-16-bits-in-c", "title": "Extracting bit positions in a union of 16 bits in C", "body": "<p>I want to declare a <code>union</code> in C which mainly contains a <code>16-bit</code> word, and I should be able to read/write the <strong>LSP</strong> <code>7 bits</code> and <code>8th bit</code> separately for each byte in the <code>16-bit</code> word, so I declared something like:</p>\n\n<pre><code>typedef union {\n    uint8_t full_8_char_byte[2];\n    uint8_t ascii_7_bits_word_0 : 7; /* another way of representing LSP 7 ASCII bits */\n    uint8_t parity_bit_word_0 : 1;   /* another way of representing MSP parity bit */\n    uint8_t ascii_7_bits_word_1 : 7; /* another way of representing LSP 7 ASCII bits */\n    uint8_t parity_bit_word_1 : 1;   /* another way of representing MSP parity bit */\n} ip_char_t;\n</code></pre>\n\n<p>Now, when I write <code>7-bit</code> values to these individual bytes in the <code>16-bit</code> word:</p>\n\n<pre><code>x.full_8_char_byte[0] = 0x7E;\nx.full_8_char_byte[1] = 0x7E;\n</code></pre>\n\n<hr>\n\n<p><strong>The following simple program:</strong></p>\n\n<pre><code>int main()\n{\n    ip_char_t x;\n    x.full_8_char_byte[0] = 0x7E;\n    x.full_8_char_byte[1] = 0x7E;\n\n    printf(\"%c   %c\\n\", x.full_8_char_byte[1], x.full_8_char_byte[0]);\n    printf(\"%u   %u\\n\", x.full_8_char_byte[1], x.full_8_char_byte[0]);\n    printf(\"%X   %X\\n\\n\", x.full_8_char_byte[1], x.full_8_char_byte[0]);\n\n    printf(\"%c   %c\\n\", x.ascii_7_bits_word_1, x.ascii_7_bits_word_0);\n    printf(\"%u   %u\\n\", x.ascii_7_bits_word_1, x.ascii_7_bits_word_0);\n    printf(\"%X   %X\\n\\n\", x.ascii_7_bits_word_1, x.ascii_7_bits_word_0);\n\n    printf(\"%d   %d\\n\", x.parity_bit_word_1, x.parity_bit_word_0);\n    return 0;\n}\n</code></pre>\n\n<p><strong>gives the correct output as follows:</strong></p>\n\n<pre><code>~   ~  \n126   126   \n7E   7E\n\n~   ~ \n126   126 \n7E   7E\n\n0   0\n</code></pre>\n\n<p><strong>but when I initialized <code>x.full_8_char_byte[1] to a 8-bit value</code>:</strong></p>\n\n<pre><code>x.full_8_char_byte[0] = 0x7E;\nx.full_8_char_byte[1] = 0xFF;\n</code></pre>\n\n<p><strong>the output I get is:</strong></p>\n\n<pre><code>\ufffd   ~ \n255   126 \nFF   7E\n\n~   ~ \n126   126 \n7E   7E\n\n0   0\n</code></pre>\n\n<p>Similar thing happens when I initialize <code>x.full_8_char_byte[0] to 0xFF</code>, my question is why the value in <code>x.ascii_7_bits_word_1</code> and <code>x.parity_bit_word_1</code> did not reflected per change in <code>x.full_8_char_byte[1]</code>?</p>\n"}, {"tags": ["c", "ascii"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532505019, "post_id": 51513452, "comment_id": 89995429, "body": "about the <code>EOF</code> problem: It&#39;s actually even worse, if you <b>have</b> signed <code>char</code>, <code>-1</code> could be a valid character, which will then be misinterpreted as <code>EOF</code>."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1532505271, "post_id": 51513452, "comment_id": 89995569, "body": "@FelixPalmen I agree that the loop is faulty either way, but the failure mode when <code>char</code> is <code>unsigned</code> is much more likely to be noticed or seen as troublesome. In a similar tone that people suggest avoiding <code>scanf</code>, I&#39;d suggest avoiding <code>getchar</code> for this reason... you can get much clearer, easy to understand code by using <code>fread</code> instead, i.e. <code>while (fread(&amp;ch, 1, 1, stdin))</code>..."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 381, "user_id": 1988938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc91207512e8f63b898c6d97455aea73?s=128&d=identicon&r=PG&f=1", "display_name": "Applik", "link": "https://stackoverflow.com/users/1988938/applik"}, "edited": false, "score": 1, "creation_date": 1532505522, "post_id": 51513452, "comment_id": 89995709, "body": "@Applik Welcome to StackOverflow. The upvote and tick feature is how we thank people, here... If this answer solves your problem, accept it as your solution by clicking the &quot;tick&quot;. If it doesn&#39;t, let me know... but I think it solves your problem. You&#39;re welcome. :)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 381, "user_id": 1988938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc91207512e8f63b898c6d97455aea73?s=128&d=identicon&r=PG&f=1", "display_name": "Applik", "link": "https://stackoverflow.com/users/1988938/applik"}, "edited": false, "score": 0, "creation_date": 1533959039, "post_id": 51513452, "comment_id": 90549738, "body": "@Applik C has plenty of pitfalls, but if we avoid what allows them, C becomes useless... buffer overflows, so we shouldn&#39;t use arrays or <code>strcpy</code> or <code>memcpy</code> or anything that can cause those... right? Race conditions, so we should avoid threads entirely... <code>goto</code>, so we should avoid that too... we should avoid all of these tools that <i>can be used to write poor code</i> even though they <i>can also be used in reasonable ways</i>... We need to go back to caveman days, with rock and fire because knives are too dangerous... in fact, fire is too dangerous too... rocks... hmmm, life has its pitfalls..."}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": true, "score": 5, "last_activity_date": 1532504611, "creation_date": 1532504611, "answer_id": 51513452, "question_id": 51513402, "link": "https://stackoverflow.com/questions/51513402/how-to-print-out-newline-ascii/51513452#51513452", "title": "How to print out newline ASCII?", "body": "<pre><code>while ((ch = getchar() != EOF))\n</code></pre>\n\n<p>This assigns the value <code>getchar() != EOF</code> to <code>ch</code>. You probably meant to write:</p>\n\n<pre><code>while ((ch = getchar()) != EOF)\n</code></pre>\n\n<p>P.S. <code>ch</code> should be of type <code>int</code>, as <code>EOF</code> is a negative value which <code>char</code> isn't required to be able to represent (<code>char</code> might be <code>unsigned</code>) and thus on some systems, you might never see this condition evaluate false if <code>ch</code> is (erroneously) <code>char</code> (thus you'd have an infinite loop on such systems).</p>\n"}], "owner": {"reputation": 381, "user_id": 1988938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc91207512e8f63b898c6d97455aea73?s=128&d=identicon&r=PG&f=1", "display_name": "Applik", "link": "https://stackoverflow.com/users/1988938/applik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 51513452, "answer_count": 1, "score": 1, "last_activity_date": 1532507788, "creation_date": 1532504452, "last_edit_date": 1532507788, "question_id": 51513402, "link": "https://stackoverflow.com/questions/51513402/how-to-print-out-newline-ascii", "title": "How to print out newline ASCII?", "body": "<p>Trying to print out the decimal equivalent <code>\\n</code> (newline) with below code. When it is executed I press enter and <kbd>Ctrl</kbd> + <kbd>Z</kbd> but nothing is printed on screen. I expect 10 to be printed. What am I missing? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char ch;\n\n    while ((ch = getchar() != EOF))\n    {\n        if (ch == '\\n')\n        {\n            printf(\"\\\\n=%d\\n\", ch);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32", "real-time-clock"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1532503909, "post_id": 51513166, "comment_id": 89994735, "body": "probably off-topic here (maybe more a hardware issue than a software one).  Consider using <a href=\"https://en.wikipedia.org/wiki/Network_Time_Protocol\" rel=\"nofollow noreferrer\">NTP</a>. How to use NTP is a different question that could be operating system specific"}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1532568997, "post_id": 51513166, "comment_id": 90027759, "body": "I&#39;m voting to close this question as off-topic because it is about a hardware real-time-clock module and not about programming."}, {"owner": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 0, "creation_date": 1532584548, "post_id": 51513166, "comment_id": 90031382, "body": "You may get a better response on <a href=\"https://electronics.stackexchange.com\">Electrical Engineering</a>. However, be sure to read <a href=\"https://electronics.stackexchange.com/help/on-topic\">their on topic page</a> and verify that any question you post there is appropriate for that site."}, {"owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "reply_to_user": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 1, "creation_date": 1532586158, "post_id": 51513166, "comment_id": 90032003, "body": "@JimGarrison This is not a hardware topic, its a question concerning the software used to calibrate the hardware"}], "answers": [{"comments": [{"owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "edited": false, "score": 0, "creation_date": 1532517551, "post_id": 51515017, "comment_id": 90003569, "body": "The module has an LSE running at 32KHz. LSE is integrated into the module chip"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "edited": false, "score": 0, "creation_date": 1532519523, "post_id": 51515017, "comment_id": 90004833, "body": "Right, edited out."}, {"owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "edited": false, "score": 0, "creation_date": 1532524483, "post_id": 51515017, "comment_id": 90008347, "body": "RTC needs to run off LSE as low power sleep is required, the question is more: RTC is running off a 20ppm LSE but has more error than 20ppm what software errors can lead to this"}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 3, "last_activity_date": 1532519497, "last_edit_date": 1532519497, "creation_date": 1532509571, "answer_id": 51515017, "question_id": 51513166, "link": "https://stackoverflow.com/questions/51513166/how-to-improve-accuracy-of-cmwx1zzabz-091-rtc-real-time-clock/51515017#51515017", "title": "How to improve accuracy of CMWX1ZZABZ-091 RTC (Real Time Clock)", "body": "<p><em>(false statement about LSE removed)</em></p>\n\n<blockquote>\n  <p>How can I calibrate the RTC using TXCO?</p>\n</blockquote>\n\n<p><strong>TXCO can supply HSE, and you can derive the RTC clock from HSE through a series of prescalers.</strong></p>\n\n<p>Section 8.5 in the <a href=\"https://www.st.com/resource/en/user_manual/dm00329995.pdf\" rel=\"nofollow noreferrer\">User Manual</a> says,</p>\n\n<blockquote>\n  <p>When an accurate external-high-speed clock is needed by the STM32, the TCXO_OUT clock pin is supplied by the module pin PH0_OSC_IN by closing SB13.</p>\n</blockquote>\n\n<p>First, close SB13 with a drop of tin.</p>\n\n<p>PH0_OSC_IN is the HSE bypass clock source. Set <code>HSEBYP</code> then <code>HSEON</code> in <code>RCC-&gt;CR</code> to have an accurate 32 MHz HSE clock. But wait, first you have to set <code>RTCPRE</code> to <code>3</code> in order to prescale it by 16 for the RTC module. Select this as the RTC clock in <code>RCC-&gt;CSR</code>.</p>\n\n<p>Now the RCC generates a 2 MHz clock for the RTC (f<sub>RTCCLK</sub> = 2000000). You scale it further down to 1 Hz (f<sub>CK_SPRE</sub> = 1) with the <code>RTC-&gt;PRER</code> register. It has two bitfields, <code>PREDIV_A</code> can go from <code>0</code> to <code>127</code>, <code>PREDIV_S</code> from <code>0</code> to <code>32767</code>. Solving the integer equation</p>\n\n<p>f<sub>CK_SPRE</sub> = f<sub>RTCCLK</sub> <code>/ ((PREDIV_S + 1) \u00d7 (PREDIV_A + 1))</code></p>\n\n<p>with the above constraints gives</p>\n\n<pre><code>PREDIV_S = 24999\nPREDIV_A = 79\n</code></pre>\n\n<p>so using</p>\n\n<pre><code>RTC-&gt;PRER = (79 &lt;&lt; 16) | 24999;\n</code></pre>\n\n<p>you'd have an accurate 1 Hz clock for RTC.</p>\n"}, {"tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 0, "last_activity_date": 1532532487, "creation_date": 1532532487, "answer_id": 51522676, "question_id": 51513166, "link": "https://stackoverflow.com/questions/51513166/how-to-improve-accuracy-of-cmwx1zzabz-091-rtc-real-time-clock/51522676#51522676", "title": "How to improve accuracy of CMWX1ZZABZ-091 RTC (Real Time Clock)", "body": "<p><strong>Running RTC from LSE, but calibrating it to HSE.</strong></p>\n\n<p>Do the first steps in <a href=\"https://stackoverflow.com/a/51515017/5131711\">my previous answer</a> to obtain an accurate HSE clock, but leave it running from LSE.</p>\n\n<p>From the Reference Manual,</p>\n\n<blockquote>\n  <p><strong>22.4.12 RTC smooth digital calibration</strong></p>\n  \n  <p>The RTC frequency can be digitally calibrated with a resolution of about 0.954 ppm with a range from -487.1 ppm to +488.5 ppm.</p>\n</blockquote>\n\n<p>The calibration is done in the <code>RTC-&gt;CALR</code> register, it can be smoothly adjusted even while the clock is running. The adjust period must be 32 seconds for 0.954 ppm accuracy.</p>\n\n<p>Configure the RTC Periodic Wakeup Timer to generate an interrupt every 32 seconds. Connect the RTC Alarm to the TI1 Input of <code>TIM21</code> in the <code>TIM21-&gt;OR</code> register. Configure TIM21 to capture a TI1 edge. As the timer is only 16 bits, you have to count the overflows (update events) in the TIM21 interrupt handler. When the Capture event occurs, you have the elapsed number of cycles, high halfword in the update count, low halfword in the capture register. If it differs significantly from the nominal value of 32 * 32 * 10<sup>6</sup>, adjust <code>RTC-&gt;CALR</code> and repeat.</p>\n\n<p>The difficulty is getting it right when the update and the capture occurs at approximately at the same time, so the code can't reliably decide which one has occured first. I'll give some more thought to it later.</p>\n"}, {"tags": [], "owner": {"reputation": 461, "user_id": 5872574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44adbaa7965d31c58d087bbd25386317?s=128&d=identicon&r=PG", "display_name": "rel", "link": "https://stackoverflow.com/users/5872574/rel"}, "is_accepted": true, "score": 4, "last_activity_date": 1532598517, "last_edit_date": 1532598517, "creation_date": 1532536484, "answer_id": 51523797, "question_id": 51513166, "link": "https://stackoverflow.com/questions/51513166/how-to-improve-accuracy-of-cmwx1zzabz-091-rtc-real-time-clock/51523797#51523797", "title": "How to improve accuracy of CMWX1ZZABZ-091 RTC (Real Time Clock)", "body": "<blockquote>\n  <p>How can I calibrate the RTC using TXCO?</p>\n</blockquote>\n\n<p>A while ago I asked myself the same question, and it took a while until I've found a solution, since there are many options documented in the reference manual and the topic can be quite confusing.</p>\n\n<p>In my case, I needed to calibrate the RTC on a board without a HSE resonator (it was a small wrist watch prototype with only an LSE crystal (32.768 kHz), the board didn't have a HSE, and was clocked from the unstable RC internal oscillator). But the method that worked for me should be applicable in your situation as well.</p>\n\n<p>The keys to my RTC calibration method were:</p>\n\n<ol>\n<li><strong>A fast, stable reference clock.</strong> I've used a STM32F4 discovery board (with an 8 MHz HSE crystal, and a APB clock speed of 25 MHz (PLL'ed up), used by timers for the measurement described below).</li>\n<li><strong>A very accurate 1PPS calibration input</strong> (1 Pluse Per Second). -  I've used a GPS module with a 1PPS output on one of the pins.</li>\n</ol>\n\n<p>The calibration steps were as follows in my case:</p>\n\n<ol>\n<li><strong>Count the number of system clock ticks between multiple 1PPS events</strong> on a pin connected to the 1PPS signal source (GPS module in my case) with the Input Capture method of a Counter/Timer (choose the right timer width (16 vs 32 bit) and clock division (preferably no division to get maximum resolution)). Then take the average, to know the deviation from the assumed clock speed (25 MHz in my case). It should be stable, and not vary much during the measurement (32 seconds calibration time was enough).</li>\n<li>Then <strong>count the number of system clock ticks between multiple 1 Hz Calibration output ticks (driven by LSE of the target MCU)</strong> (using Input Capture on a different pin), and take the average.</li>\n<li>Now <strong>calculate the LSE correction required</strong>. And use the RTC calibration registers on the target STM32 to adjust the RTC (see also <strong>RTC Smooth Calibration</strong> in the reference manual or this <a href=\"https://www.st.com/content/ccc/resource/technical/document/application_note/7a/9c/de/da/84/e7/47/8a/DM00025071.pdf/files/DM00025071.pdf/jcr:content/translations/en.DM00025071.pdf\" rel=\"nofollow noreferrer\">Application Note (AN3371)</a>).</li>\n<li>Redo steps 1 and 2 to <strong>verify the correction</strong>.</li>\n</ol>\n\n<p>Make sure to undo any RTC correction before starting the calibration:</p>\n\n<pre><code> if (HAL_RTCEx_SetSmoothCalib(\n        &amp;hrtc,\n        RTC_SMOOTHCALIB_PERIOD_32SEC,\n        RTC_SMOOTHCALIB_PLUSPULSES_RESET,\n        0) != HAL_OK) {\n    error_handler();\n  }\n  start_calibration();\n</code></pre>\n\n<p>To calculate the correction, I've use something similar to this:</p>\n\n<pre><code>const float corr = calib_avg_ext_rtc / calib_avg_1pps;\n\nlog(\"correction:\\r\\n%f / %f =\\r\\n%.20f\\r\\n\\r\\n\", \n  calib_avg_ext_rtc, calib_avg_1pps, corr);\n\nconst float c = corr - 1.0f;\nif (corr &gt; 1.0f) {\n  log(\"RTC crystal vibrates too fast!\\r\\n\");\n  log(\"correction: %.20f ppm\\r\\n\", -1.0e6f * c);\n}\nelse if (corr &lt; 1.0f) {\n  log(\"RTC crystal vibrates too slow!\\r\\n\");\n  log(\"correction: %.20f ppm\\r\\n\",  1.0e6f * c);\n}\nelse {\n  log(\"your RTC crystal is running exactly at the right speed. - STRANGE!\\r\\n\");\n}\n\nconst int16_t calib32s = (int16_t)roundf(c * 32*32768);\nif (calib32s != 0) {\n  log(\"correction value (ticks +/- 32 s interval):\\r\\n\");\n  if (corr &lt; 1.0f) {\n    log(\"MINUS %d\\r\\n\", -calib32s); /* clock TOO SLOW, REMOVE cycles */\n    log(\"\\r\\nuse this on the target:\\r\\n\");\n    log(\"HAL_RTCEx_SetSmoothCalib(&amp;hrtc, RTC_SMOOTHCALIB_PERIOD_32SEC,\\\n        RTC_SMOOTHCALIB_PLUSPULSES_RESET, %d);\",\n      -calib32s);\n  }\n  else {\n    log(\"PLUS %d\\r\\n\", calib32s); /* clock TOO FAST, ADD cycles */\n    log(\"\\r\\nuse this on the target:\\r\\n\");\n    log(\"HAL_RTCEx_SetSmoothCalib(&amp;hrtc, RTC_SMOOTHCALIB_PERIOD_32SEC,\\\n        RTC_SMOOTHCALIB_PLUSPULSES_SET, 0x1FF - %d);\",\n      calib32s);\n  }\n}\nelse {\n  log(\"calibration complete! NO FURTHER CORRECTION REQUIRED\\r\\n\");\n}\n</code></pre>\n\n<p>After measuring the required correction, I've copy-pasted the code manually and had to flash the target board to verify the calibration. Later on, it would nicer to have the option to do the calibration while the device is already deployed...</p>\n\n<p>I've used this on an STM32L011, but the method is more or less independent from the type of MCU. In my case, I used the 8 MHz HSE and a 32-bit counter on the STM32F4 discovery board. But this method should work in modified form also without additional hardware (besides the 1PPS source), when a fast, stable HSE is present. - I managed to get less then 1 PPM deviation, and the RTC kept time accurately for several of days (changes in temperature can influence the accuracy quite a bit, as I had to find out).</p>\n\n<p>The findings were also discussed in the STM32 forum, but the page is down right now, so I can't point you to <a href=\"https://community.st.com/message/193960-re-rtc-calibration-stm32l011g4\" rel=\"nofollow noreferrer\">that</a>...</p>\n"}], "owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1587, "favorite_count": 1, "closed_date": 1532584535, "accepted_answer_id": 51523797, "answer_count": 3, "score": 1, "last_activity_date": 1532598517, "creation_date": 1532503718, "question_id": 51513166, "link": "https://stackoverflow.com/questions/51513166/how-to-improve-accuracy-of-cmwx1zzabz-091-rtc-real-time-clock", "closed_reason": "Needs more focus", "title": "How to improve accuracy of CMWX1ZZABZ-091 RTC (Real Time Clock)", "body": "<p>I'm using the B-L072Z-LRWAN1 with the CMWX1ZZABZ-091 LoRa\u00ae /Sigfox\u2122 module (Murata)</p>\n\n<p>The internal RTC (real time clock) is inaccurate and I'm seeing 10 seconds loss per day for some modules. </p>\n\n<p>My question is, why could this be? Datasheet says 1.73 seconds / 20ppm for the LSE. The TXCO is 2ppm. How can I calibrate the RTC using TXCO? </p>\n\n<p>I know there is also temperature that influences the accuracy but I think that is in an insignificant range i.e. does not explain 10seconds /day.</p>\n"}, {"tags": ["c", "zos", "mvs"], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 3220554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deSUR.jpg?s=128&g=1", "display_name": "phunsoft", "link": "https://stackoverflow.com/users/3220554/phunsoft"}, "edited": false, "score": 1, "creation_date": 1532891897, "post_id": 51580325, "comment_id": 90132742, "body": "I was looking for RACF message, and cold not find any, so I thought the problem is not related to lack of authority. After all, all return codes were zero indicating a success call. However, as it turnes out, you need to setup the profiles in the JESJOBS class as desrcibed in the manual. Once I had the proper authority, the cancel request succeeded and the expected number of SSJF elements was returned."}, {"owner": {"reputation": 77, "user_id": 8461805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0WaBG8FaYgw/AAAAAAAAAAI/AAAAAAAAAIc/AgJDcLwwuFM/photo.jpg?sz=128", "display_name": "Timoth&#233;e", "link": "https://stackoverflow.com/users/8461805/timoth%c3%a9e"}, "edited": false, "score": 0, "creation_date": 1532934979, "post_id": 51580325, "comment_id": 90142677, "body": "I thought it could be that too but didn&#39;t test it. Thank you a lot for your help and your time, you really helped me!"}], "tags": [], "owner": {"reputation": 801, "user_id": 3220554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deSUR.jpg?s=128&g=1", "display_name": "phunsoft", "link": "https://stackoverflow.com/users/3220554/phunsoft"}, "is_accepted": true, "score": 1, "last_activity_date": 1532867263, "creation_date": 1532867263, "answer_id": 51580325, "question_id": 51512986, "link": "https://stackoverflow.com/questions/51512986/mvs-jes2-purge-job-with-iefssreq-macro/51580325#51580325", "title": "MVS JES2 purge job with IEFSSREQ macro", "body": "<p>I could not see something obvious. I tried to get your code working on our system, but I'm not good enough in C, unfortunately to complete what is not shown above.</p>\n\n<p>Alternatively, I tried to get it running in plain assembler. I'm getting same results as you. I tried PURGE and CANCEL requests. All don't seem to do anything. However, when specifying an invalid jobid, IEFSSREQ complains with corresponding return codes, so I know the IEFSSREQ is being invoked correctly. Must be something stupid.</p>\n\n<p>Sorry I can't be of more help so far</p>\n"}], "owner": {"reputation": 77, "user_id": 8461805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0WaBG8FaYgw/AAAAAAAAAAI/AAAAAAAAAIc/AgJDcLwwuFM/photo.jpg?sz=128", "display_name": "Timoth&#233;e", "link": "https://stackoverflow.com/users/8461805/timoth%c3%a9e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 51580325, "answer_count": 1, "score": 0, "last_activity_date": 1532867263, "creation_date": 1532503121, "last_edit_date": 1532523362, "question_id": 51512986, "link": "https://stackoverflow.com/questions/51512986/mvs-jes2-purge-job-with-iefssreq-macro", "title": "MVS JES2 purge job with IEFSSREQ macro", "body": "<p>I want to purge/cancel/spin a job by requesting the action to JES2 with the IEFSSREQ macro. Everything seems to work well but no job is affected by the request. I thought it was a filter problem in the SSJM structure but when I specify nothing in the filters I have no error (I should have one according to the documentation) and no job is affected as well.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>char *pcJobId = \"JOB03101\";\nint iRc;\nchar * __ptr32 pworkArea = __malloc31(60);\nmemset(pworkArea, 0, 60);\nstruct ssib * __ptr32 pSSIB = __malloc31(sizeof(struct ssib));\nstruct ssob * __ptr32 pSSOB = __malloc31(sizeof(struct ssob));\nstruct ssjm * __ptr32 pSSJM = __malloc31(sizeof(struct ssjm));\n\nmemset(pSSIB, 0, sizeof(struct ssib));\nmemcpy(pSSIB-&gt;ssibid, \"SSIB\", 4);\npSSIB-&gt;ssiblen = SSIBSIZE;\nmemcpy(pSSIB-&gt;ssibssnm, \"JES2\", 4);\n\nmemset(pSSJM, 0, sizeof(struct ssjm));\nmemcpy(pSSJM-&gt;ssjmeye, \"SSJMPL  \", 8);\npSSJM-&gt;ssjmlen = SSJMSIZE;\npSSJM-&gt;ssjmvrm = SSJMVRM1;\npSSJM-&gt;ssjmopt1 = SSJMPSYN;\npSSJM-&gt;ssjmreqp._ssjmtype = SSJMPRG;\npSSJM-&gt;ssjmsel1 = SSJMSOJI;\nmemcpy(pSSJM-&gt;ssjmojbi, pcJobId, 8);\n\nmemset(pSSOB, 0, sizeof(struct ssob));\nmemcpy(pSSOB-&gt;ssobid, \"SSOB\", 4);\npSSOB-&gt;ssoblen = SSOBHSIZ;\npSSOB-&gt;ssobfunc = (short int)85;\npSSOB-&gt;ssobssib = pSSIB;\npSSOB-&gt;ssobindv = (int)pSSJM;\n\nvoid * __ptr32 * pParmList = __malloc31(4);\n*pParmList = (void * __ptr32) ((int32_t)pSSOB | (int32_t)0x80000000); // the high-order bit must be on\niRc = 0;\n__asm(\" SAM31\\n\"\n      \" SYSSTATE AMODE64=NO\\n\"\n      \" IEFSSREQ\\n\"\n      \" SYSSTATE AMODE64=YES\\n\"\n      \" SAM64\\n\"\n      : \"=XL:NR:r15\"(iRc)\n      : \"XL:NR:r1\"(pParmList), \"XL:NR:r13\"(pworkArea)\n      : \"r0\", \"r1\", \"r13\", \"r14\", \"r15\");\nprintf(\"IEFSSREQ rc=%d\\n\", iRc);\nprintf(\"ssobretn=%d\\n\", pSSOB-&gt;ssobretn);\nprintf(\"ssjmretn=%d\\n\", pSSJM-&gt;ssjmretn);\nprintf(\"ssjmret2=%d\\n\", pSSJM-&gt;ssjmret2);\nprintf(\"ssjmnsjf=%d\\n\", pSSJM-&gt;ssjmnsjf);\nprintf(\"ssjmsjf8=%p\\n\", pSSJM-&gt;ssjmsjf8);\nfree(pworkArea);\nfree(pSSOB);\nfree(pParmList);\nfree(pSSJM);\n</code></pre>\n\n<p>According to the documentation I get feedback for every jobs affected by the request in the SSJMSJF8 pointer and the SSJMNSJF should be the number of feedbacks I get, which is also the number of jobs affected by the request.</p>\n\n<p>My code print this:</p>\n\n<pre><code>IEFSSREQ rc=0\nssobretn=0\nssjmretn=0\nssjmret2=0\nssjmnsjf=0\nssjmsjf8=0\n</code></pre>\n\n<p>Here is a link to the documentation I talked about. I'm using the Modify Job Function Call (number 85) and this is page 460.</p>\n\n<p><a href=\"https://www-304.ibm.com/servers/resourcelink/svc00100.nsf/pages/zOSV2R3SA380679/\" rel=\"nofollow noreferrer\">https://www-304.ibm.com/servers/resourcelink/svc00100.nsf/pages/zOSV2R3SA380679/</a>$file/ieaf200_v2r3.pdf</p>\n"}, {"tags": ["java", "c"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1532502718, "post_id": 51512844, "comment_id": 89994054, "body": "If not you could&#39;t do what you are doing. Note that in C nothing prevent you to declare <code>struct node;</code> before."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532502807, "post_id": 51512844, "comment_id": 89994097, "body": "First of all, ask one question per language. I could explain you how that works for C (which has the notion of an <i>incomplete type</i>), but not for java. Although it&#39;s probably a somewhat similar concept, the java explanation WILL be different."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532504471, "post_id": 51512927, "comment_id": 89995104, "body": "&quot;<i>You&#39;re merely allocating memory for an instance of the structure</i>&quot; &lt;- no idea for java, but that&#39;s not correct for C -- you&#39;re  just allocating memory for a <b>pointer</b> to the struct. (in fact, not even allocating it yet, just defining the contents of the struct to include a pointer ...)"}, {"owner": {"reputation": 4860, "user_id": 279236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJLyB.png?s=128&g=1", "display_name": "jwenting", "link": "https://stackoverflow.com/users/279236/jwenting"}, "edited": false, "score": 0, "creation_date": 1532504729, "post_id": 51512927, "comment_id": 89995263, "body": "@FelixPalmen yes. should have read &quot;memory for a pointer to an instance of the structure&quot;."}], "tags": [], "owner": {"reputation": 4860, "user_id": 279236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJLyB.png?s=128&g=1", "display_name": "jwenting", "link": "https://stackoverflow.com/users/279236/jwenting"}, "is_accepted": true, "score": 5, "last_activity_date": 1532504744, "last_edit_date": 1532504744, "creation_date": 1532502924, "answer_id": 51512927, "question_id": 51512844, "link": "https://stackoverflow.com/questions/51512844/why-is-it-possible-to-declare-class-typein-java-or-struct-typein-c-before-de/51512927#51512927", "title": "Why is it possible to declare class type(in Java) or struct type(in C) before defining itself?", "body": "<p>You're merely allocating memory for a pointer to an instance of the structure. How much memory is needed for that is irrelevant at compile time, and at runtime will be known. </p>\n\n<p>All that's needed when the field is allocated is knowing how much memory the pointer (or reference in Java, which is essentially similar in this context) takes, not how much memory will be needed to store whatever it's referring to.</p>\n\n<p>And yes, that's overly simplified, especially in the case of Java. But that's the general idea.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10127456, "user_type": "registered", "profile_image": "https://graph.facebook.com/489596051476575/picture?type=large", "display_name": "whitehat", "link": "https://stackoverflow.com/users/10127456/whitehat"}, "edited": false, "score": 0, "creation_date": 1532505152, "post_id": 51513357, "comment_id": 89995506, "body": "thanks for answer, it was point that i was wondering. it was helpful"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 3, "last_activity_date": 1532504407, "last_edit_date": 1532504407, "creation_date": 1532504275, "answer_id": 51513357, "question_id": 51512844, "link": "https://stackoverflow.com/questions/51512844/why-is-it-possible-to-declare-class-typein-java-or-struct-typein-c-before-de/51513357#51513357", "title": "Why is it possible to declare class type(in Java) or struct type(in C) before defining itself?", "body": "<p><strong>Answer for C</strong>:</p>\n\n<p>C distiguishes between <em>complete</em> and <em>incomplete</em> types. A type can be introduced as an <em>incomplete</em> type and later be <em>completed</em> in the same translation unit. The difference is that for a <em>complete</em> type, the compiler knows the storage size -- for an <em>incomplete</em> type, it doesn't.</p>\n\n<p>If you write</p>\n\n<pre><code>struct foo;\n</code></pre>\n\n<p>you already declared a type, but it's at this stage <em>incomplete</em>. With an incomplete type, it's possible to use <em>pointers</em> to that type, but not objects of the type itself. Now, in your example:</p>\n\n<pre><code>struct node{\n    struct node *p_node;   //here\n};\n</code></pre>\n\n<p>The <em>incomplete</em> type <code>struct node</code> is already known after the first line. Therefore, it's perfectly legal to use a <em>pointer</em> to that type in the second line. In the third line, the type is <em>complete</em> and you can now use objects of type <code>struct node</code>.</p>\n\n<p>Side note: There's exactly one <em>incomplete type</em> in C that can't be completed: <code>void</code>. So you can always use pointers to void (<code>void *</code>), but never a <code>void</code> value.</p>\n"}], "owner": {"reputation": 63, "user_id": 10127456, "user_type": "registered", "profile_image": "https://graph.facebook.com/489596051476575/picture?type=large", "display_name": "whitehat", "link": "https://stackoverflow.com/users/10127456/whitehat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 51512927, "answer_count": 2, "score": 3, "last_activity_date": 1532504744, "creation_date": 1532502586, "last_edit_date": 1532504478, "question_id": 51512844, "link": "https://stackoverflow.com/questions/51512844/why-is-it-possible-to-declare-class-typein-java-or-struct-typein-c-before-de", "title": "Why is it possible to declare class type(in Java) or struct type(in C) before defining itself?", "body": "<p>Here, I want to show some examples I wonder in C and Java</p>\n\n<p>In C programming, </p>\n\n<pre><code>struct node{\n    struct node *p_node;   //here\n};\n</code></pre>\n\n<p>In Java programming,</p>\n\n<pre><code>public class node{\n    public node nd= new node();  //here\n}\n</code></pre>\n\n<p>Both of them are have common point of declaring <code>class(struct)</code> type before defining itself perfectly.</p>\n\n<p>Over examples, you can see: <code>struct node *p</code> line  and <code>public node nd= new node();</code> line are described before '}' or ';'. </p>\n\n<p>In this line, how they know the type despite of self type is not defined perfectly? </p>\n"}, {"tags": ["c", "gcc", "fortran", "gfortran"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "edited": false, "score": 0, "creation_date": 1532526934, "post_id": 51514467, "comment_id": 90010179, "body": "Thanks for the explanation and code @Vladimir F! Is it possible to have just Fortran code and still achieve a way to call some Fortran code when users import the module?"}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "edited": false, "score": 0, "creation_date": 1532528353, "post_id": 51514467, "comment_id": 90011227, "body": "I do not think so."}, {"owner": {"reputation": 904, "user_id": 5713492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9b69203363ac125851bb19d781168d6?s=128&d=identicon&r=PG", "display_name": "user5713492", "link": "https://stackoverflow.com/users/5713492/user5713492"}, "edited": false, "score": 0, "creation_date": 1532531590, "post_id": 51514467, "comment_id": 90013581, "body": "Can you get away with just writing the prototype in C and then writing the actual subroutine in Fortran? In Windows you would just write a Fortran DllMain."}, {"owner": {"reputation": 32261, "user_id": 75652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/303ee8d24a8776dcf67b30c1d4e8b064?s=128&d=identicon&r=PG", "display_name": "janneb", "link": "https://stackoverflow.com/users/75652/janneb"}, "edited": false, "score": 0, "creation_date": 1532808609, "post_id": 51514467, "comment_id": 90115478, "body": "No, the Fortran compiler does not look at any C prototypes when compiling a Fortran procedure."}, {"owner": {"reputation": 32261, "user_id": 75652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/303ee8d24a8776dcf67b30c1d4e8b064?s=128&d=identicon&r=PG", "display_name": "janneb", "link": "https://stackoverflow.com/users/75652/janneb"}, "edited": false, "score": 0, "creation_date": 1532808774, "post_id": 51514467, "comment_id": 90115523, "body": "In principle, you could edit the object file and add the Fortran procedure to the constructors list, but this is certainly a lot more troublesome than just having a small C wrapper."}], "tags": [], "owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "is_accepted": false, "score": 5, "last_activity_date": 1532509359, "last_edit_date": 1532509359, "creation_date": 1532508027, "answer_id": 51514467, "question_id": 51512450, "link": "https://stackoverflow.com/questions/51512450/how-to-automatically-run-user-code-upon-loading-fortran-module/51514467#51514467", "title": "How to automatically run user-code upon loading Fortran module", "body": "<p><em>\"For sure that this feature must exist in gfortran since it comes from GCC\"</em> That is clearly false. It simply does not have to exist. gfortran does support the <code>!GCC$ ATTRIBUTES</code> directive, but the number of attributes supported is limited.</p>\n\n<p>You can write your constructor in C and let it be part of the same library and call any Fortran code you want.</p>\n\n<p>Example:</p>\n\n<p>library.f90:</p>\n\n<pre><code>subroutine sub() bind(C)\n write(*,*) \"Hello!\"\nend subroutine\n</code></pre>\n\n<p>init_library.c:</p>\n\n<pre><code>void sub(void);\nstatic void __attribute__((constructor)) _init(void)\n{\n    sub();\n}\n</code></pre>\n\n<p>load_library.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;dlfcn.h&gt;\ntypedef void (*foo)(void);\nint main(int argc, char* argv[])\n{\n\n    void *lib = dlopen(\"library.so\", RTLD_NOW);\n    if(lib == NULL)\n        return printf(\"ERROR: Cannot load library\\n\");\n    dlclose(lib);\n}\n</code></pre>\n\n<p>compile and run:</p>\n\n<pre><code>&gt; gfortran -c -fPIC init_library.c\n&gt; gfortran -c -fPIC library.f90\n&gt; gfortran -shared library.o init_library.o -o library.so\n&gt; gfortran load_library.c -ldl\n&gt; ./a.out \n Hello!\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1532509359, "creation_date": 1532501219, "question_id": 51512450, "link": "https://stackoverflow.com/questions/51512450/how-to-automatically-run-user-code-upon-loading-fortran-module", "title": "How to automatically run user-code upon loading Fortran module", "body": "<p>In C using GCC, one can use the following function to have some code called upon loading a shared library:</p>\n\n<pre><code>static void __attribute__((constructor)) _my_initializer(void)\n{\n    ...\n}\n</code></pre>\n\n<p>After some search on the web, I could not find the equivalent in Fortran using GCC (i.e. gfortran). For sure that this feature must exist in gfortran since it comes from GCC (thus it should be available in all languages supported by GCC). Any pointers?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1532500659, "post_id": 51512180, "comment_id": 89992976, "body": "<code>%lu</code> should be <code>%ld</code>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 9, "creation_date": 1532500994, "post_id": 51512180, "comment_id": 89993165, "body": "some numbers are divisible by <i>both</i> 3 and 5 (eg. 15) - you should not add them twice !"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1532501024, "post_id": 51512180, "comment_id": 89993183, "body": "Exactly what @SanderDeDycker said. Merge the two <code>for</code> loops into one. Or don&#39;t add numbers that are multiples of 3 in the second loop"}, {"owner": {"reputation": 3, "user_id": 10131647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da94ffdbaed9f9495565a47f50fe581?s=128&d=identicon&r=PG&f=1", "display_name": "Raheef", "link": "https://stackoverflow.com/users/10131647/raheef"}, "edited": false, "score": 0, "creation_date": 1532501353, "post_id": 51512180, "comment_id": 89993344, "body": "Thank You Guys!! that was very helpful"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532519853, "post_id": 51512180, "comment_id": 90005072, "body": "Note: To solve &quot;Sum of all the multiples of A or B below N&quot;, a loop is not needed."}], "answers": [{"comments": [{"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1532503266, "post_id": 51512521, "comment_id": 89994368, "body": "However here it using %lu in place of %ld here not make much diff. Still I am accepting your suggestion. %ld should be used for long. And %lu for unsigned long."}, {"owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 0, "creation_date": 1532503407, "post_id": 51512521, "comment_id": 89994455, "body": "You don&#39;t need continue to make sure that if number is divisible by 3 it will not be tested for divisible by 5... An else if do the same job and better..."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 0, "creation_date": 1532503557, "post_id": 51512521, "comment_id": 89994541, "body": "@Aryboo - accepted. But already mentioned even more optimized way just below the code."}, {"owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 0, "creation_date": 1532503613, "post_id": 51512521, "comment_id": 89994573, "body": "Indeed but don&#39;t say that <code>continue</code> is a good thing to do for that x)"}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "reply_to_user": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 0, "creation_date": 1532503929, "post_id": 51512521, "comment_id": 89994750, "body": "@Aryboo - Accepted your suggestion and edited it appropriately. Thanks :)"}, {"owner": {"reputation": 3780, "user_id": 1312489, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eb2ecf8dd654081848f8078aa344cf14?s=128&d=identicon&r=PG", "display_name": "Pandey_Laxman", "link": "https://stackoverflow.com/users/1312489/pandey-laxman"}, "edited": false, "score": 0, "creation_date": 1533308410, "post_id": 51512521, "comment_id": 90313692, "body": "The above solution by brute force has linear time complexity O(1000) but problem can be solved in Constant time complexity O(1) that is best, plz look below answer by @Eric"}], "tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": true, "score": 8, "last_activity_date": 1533540479, "last_edit_date": 1533540479, "creation_date": 1532501495, "answer_id": 51512521, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/51512521#51512521", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>Some numbers will be divisible by both 3 and 5, you should not add them twice. \nA code like this will give correct result:</p>\n\n<pre><code>long int x,total = 0;\n\nfor(x = 0; x &lt; 1000; ++x)\n{\n    if(x % 3 == 0)\n        total = total + x;\n    else if(x % 5 == 0)\n        total = total + x;\n}\n\nprintf(\"%ld\", total);\n</code></pre>\n\n<p>in the code above <code>if else if</code> make sure that if a number is divisible by 3 or by 5. And allow to sum up on this basis.</p>\n\n<p>It can further be optimized to:</p>\n\n<pre><code>for(x= 0; x &lt; 1000; ++x)\n{\n    if(x%3 == 0 || x%5 == 0)\n        total = total + x;\n}\n</code></pre>\n\n<blockquote>\n  <p>Above solution is O(n) for better time complexity O(1) we can use\n  <a href=\"https://en.wikipedia.org/wiki/Arithmetic_progression\" rel=\"nofollow noreferrer\">Arithmetic Progression</a> with interval of 3 and 5.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/Y5mpJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5mpJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>n = total number of multiples of given number(Num) in given range (1...R). in this case (1...1000)</p>\n\n<p>a1 = first multiple. Here it will be 3 or 5.</p>\n\n<p>an = last multiple. i.e 3Xn</p>\n\n<p>Hence, following code will calculate Sum of series with interval 3/5 (Num) for given range 1...lastOfRange (excluding lastOfRange).</p>\n\n<pre><code>long SumOfSeries(long Num, long lastOfRange)\n{\n    long multiplesCount = (lastOfRange-1) / Num; //(lastOfRange-1) to exlude the last number 1000 here\n    long result = multiplesCount * (Num + (multiplesCount * Num)) / 2;//Num = a1, (multiplesCount * Num) = an.\n    return result;\n}\n</code></pre>\n\n<p>and this can be called as:</p>\n\n<pre><code>long N = 1000;\nSum = SumOfSeries(3, N) + SumOfSeries(5, N) - SumOfSeries(3*5, N);\nprintf(\"%ld\", total);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1532502433, "post_id": 51512555, "comment_id": 89993896, "body": "It would be ever so slightly more performant to do the modulo check on the +5 loop instead of the +3. (200 vs 333 modulo branches)"}, {"owner": {"reputation": 59, "user_id": 8487340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc51fe61ebda41befdd8704d76458f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Amal John", "link": "https://stackoverflow.com/users/8487340/amal-john"}, "reply_to_user": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 1, "creation_date": 1532504991, "post_id": 51512555, "comment_id": 89995415, "body": "Yes adding the if the the +5 loop is optimal Thanks ;)"}], "tags": [], "owner": {"reputation": 59, "user_id": 8487340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc51fe61ebda41befdd8704d76458f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Amal John", "link": "https://stackoverflow.com/users/8487340/amal-john"}, "is_accepted": false, "score": 2, "last_activity_date": 1532501619, "creation_date": 1532501619, "answer_id": 51512555, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/51512555#51512555", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>What you are doing is some calculation error. You see there are some common multiples of 5 and 3 like 15,30,45... so since you are adding these in both the sums you are getting a higher value.</p>\n\n<p>A slight modification to the code will do the trick.</p>\n\n<pre><code>for(x= 0; x &lt; 1000; x += 3) \n{\n   if(x%5)\n   {\n       a = a + x;\n   }\n}\n\nfor(y = 0; y &lt; 1000; y += 5)  \n     b = b + y;\n\nz = a + b;\nprintf(\"%lu\", z);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1532519700, "last_edit_date": 1532519700, "creation_date": 1532501882, "answer_id": 51512632, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/51512632#51512632", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>Direct translation of your python code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[])\n{\n  int sum = 0;\n\n  for (int x = 0; x &lt; 1000; x++)\n  {\n    if (x % 5 == 0 || x % 3 == 0)\n      sum += x;\n  }\n\n  printf(\"%d\", sum);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532565695, "post_id": 51516009, "comment_id": 90027156, "body": "Thanks for the edit @Jabberwocky , I couldn&#39;t figure out how to get the code block to work after a bullet list. The horizontal line apparently will do the trick."}], "tags": [], "owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1532520296, "last_edit_date": 1532520296, "creation_date": 1532512611, "answer_id": 51516009, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/51516009#51516009", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>For the fun of it, I decided on giving the problem some additional constraints.</p>\n\n<ul>\n<li>The loop iterator can not take values that aren't a multiple</li>\n<li>The numbers must be added to the sum in numerical order.</li>\n</ul>\n\n<hr>\n\n<pre><code>int sum_multiples(long int m1,long int m2,long int lim)\n{\n    long int sum=0;\n    for(long int i=m1;i&lt;lim;i=((i+m1)/m1)*m1&gt;((i+m2)/m2)*m2?((i+m2)/m2)*m2:((i+m1)/m1)*m1) sum+=i;\n    return sum;\n}\nint  main(int argc, char *argv[])\n{\n    printf(\"Total: %ld \\n\",sum_multiples(3,5,1000));\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 5, "last_activity_date": 1558667251, "last_edit_date": 1558667251, "creation_date": 1532521475, "answer_id": 51518833, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/51518833#51518833", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>The answer can be computed with simple arithmetic without any iteration. Many Project Euler questions are intended to make you think about clever ways to find solutions without just using the raw power of computers to chug through calculations.</p>\n\n<p>Given positive integers <em>N</em> and <em>F</em>, the number of positive multiples of <em>F</em> that are less than <em>N</em> is floor((<em>N</em>-1)/<em>F</em>). (floor(<em>x</em>) is the greatest integer not greater than <em>x</em>.) For example, the number of multiples of 5 less than 1000 is floor(999/5) = floor(199.8) = 199.</p>\n\n<p>Let <em>n</em> be this number of multiples, floor((<em>N</em>-1)/<em>F</em>).</p>\n\n<p>The first multiple is <em>F</em> and the last multiple is <em>n</em>\u2022<em>F</em>. For example, with 1000 and 5, the first multiple is 5 and the last multiple is 199\u20225 = 995.</p>\n\n<p>The multiples are evenly spaced, so the average of all of them equals the average of the first and the last, so it is (<em>F</em> + <em>n</em><i>F</i>)/2.</p>\n\n<p>The total of the multiples equals their average multiplied by the number of them, so the total of the multiples of <em>F</em> less than <em>N</em> is <em>n</em> \u2022 (<em>F</em> + <em>n</em>\u2022<em>F</em>)/2.</p>\n\n<p>As we have seen in other answers and in comments, adding the sum of multiples of 3 and the sum of multiples of 5 counts the multiples of both 3 and 5 twice. We can correct for this by subtracting the sum of those numbers. Multiples of both 3 and 5 are multiples of 15.</p>\n\n<p>Thus, we can compute the requested sum using simple arithmetic without any iteration:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nstatic long SumOfMultiples(long N, long F)\n{\n    long NumberOfMultiples = (N-1) / F;\n    long FirstMultiple = F;\n    long LastMultiple = NumberOfMultiples * F;\n\n    return NumberOfMultiples * (FirstMultiple + LastMultiple) / 2;\n}\n\n\nint main(void)\n{\n    long N = 1000;\n    long Sum = SumOfMultiples(N, 3) + SumOfMultiples(N, 5) - SumOfMultiples(N, 3*5);\n\n    printf(\"%ld\\n\", Sum);\n}\n</code></pre>\n\n<p>As you do other Project Euler questions, you should look for similar ideas.</p>\n"}, {"tags": [], "owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "is_accepted": false, "score": 0, "last_activity_date": 1542776733, "last_edit_date": 1542776733, "creation_date": 1542762979, "answer_id": 53403964, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/53403964#53403964", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>Your solution with for-loop will be O(n). </p>\n\n<p>I found a more generic solution O(1).</p>\n\n<p>Here we can use another multiplies, even non-primes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nlong gcd(long a, long b) {  \n    return b == 0 ? a : gcd(b, a % b);  \n}\n\nlong lcm(long a, long b) {  \n    return a / gcd(a, b) * b;  \n}  \n\nlong sumMultiple(long mult, long to) {\n    to = to / mult;\n    to *= to + 1;\n    return (to &gt;&gt; 1) * mult;\n}\n\nlong calc(long a, long b, long n) {\n    n--;\n    return sumMultiple(a, n) + sumMultiple(b, n) - sumMultiple(lcm(a,b), n);\n}\n\nint main() {\n    int n = 1000;\n    printf(\"Sum of multiplies of 3 and 5 is %ld\\n\", calc(3,5,n));\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10954426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9df26762e89029e943460ce13e1d5e?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Furqan", "link": "https://stackoverflow.com/users/10954426/muhammad-furqan"}, "is_accepted": false, "score": 0, "last_activity_date": 1560213610, "creation_date": 1560213610, "answer_id": 56535041, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c/56535041#56535041", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\nint sum;\nint i;\nsum=0;\nfor(i=0;i&lt;1000;++i)\n{\nif((i%3==0)||(i%5==0))\n   {\n    sum=sum+i;\n   }\n}\n\nprintf(\"%d\",sum);\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Output is 233168</p>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 10131647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da94ffdbaed9f9495565a47f50fe581?s=128&d=identicon&r=PG&f=1", "display_name": "Raheef", "link": "https://stackoverflow.com/users/10131647/raheef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3018, "favorite_count": 0, "accepted_answer_id": 51512521, "answer_count": 7, "score": 0, "last_activity_date": 1560213610, "creation_date": 1532500138, "last_edit_date": 1592644375, "question_id": 51512180, "link": "https://stackoverflow.com/questions/51512180/sum-of-all-the-multiples-of-3-or-5-below-1000-gives-a-wrong-answer-in-c", "title": "Sum of all the multiples of 3 or 5 below 1000 gives a wrong answer in C", "body": "<p>Project Euler problem:</p>\n<blockquote>\n<p>If we list all the natural numbers below <code>10</code> that are multiples of <code>3 or 5</code>, we get <code>3, 5, 6 and 9</code>. The sum of these multiples is <code>23</code>.</p>\n<p>Find the sum of all the multiples of <code>3 or 5</code> below <code>1000</code>.</p>\n</blockquote>\n<p><strong>My C code:</strong></p>\n<pre><code>long int x;\n\nlong int y;\n\nlong int z = 0;\n\nlong int a = 0;\n\nlong int b = 0;\n   \nfor(x= 0; x &lt; 1000; x += 3)  \n    a = a + x;\n   \nfor(y = 0; y &lt; 1000; y += 5)  \n    b = b + y;\n   \nz = a + b;\nprintf(&quot;%lu&quot;, z);\n   \nreturn 0;\n</code></pre>\n<p>But I'm getting <code>266333</code> as the output which is wrong. I checked the answer with Python and I got it right. I would like to know what I'm doing wrong with the C code. The right answer is <code>233168</code></p>\n<p><strong>My Python code:</strong></p>\n<pre><code>print(sum(x for x in range(1000) if x % 3 == 0 or x % 5 == 0))\n</code></pre>\n"}, {"tags": ["c", "windows", "libevent"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1532503135, "post_id": 51512129, "comment_id": 89994291, "body": "Looks like you are running this from a regular command prompt. If you want to make your life easier, run this under a developer command prompt instead. It&#39;s a pre-configured environment, set up when installing Visual Studio."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10117560, "user_type": "registered", "profile_image": "https://graph.facebook.com/456392394751542/picture?type=large", "display_name": "Zachery Kish", "link": "https://stackoverflow.com/users/10117560/zachery-kish"}, "edited": false, "score": 0, "creation_date": 1532505299, "post_id": 51513209, "comment_id": 89995585, "body": "Ok so it seems to have built properly, how should I go about getting the .lib files for libevent_core? All I can find in the build directory is event_core.lib."}, {"owner": {"reputation": 29277, "user_id": 291641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9df10b741c091f5db29f951dc9918a34?s=128&d=identicon&r=PG", "display_name": "patthoyts", "link": "https://stackoverflow.com/users/291641/patthoyts"}, "reply_to_user": {"reputation": 3, "user_id": 10117560, "user_type": "registered", "profile_image": "https://graph.facebook.com/456392394751542/picture?type=large", "display_name": "Zachery Kish", "link": "https://stackoverflow.com/users/10117560/zachery-kish"}, "edited": false, "score": 0, "creation_date": 1532514600, "post_id": 51513209, "comment_id": 90001700, "body": "On Windows libraries are not typically prefixed with lib so you would provide event_core.lib to the compiler for the link step. The cmake command generates a number of sample projects (ie: hello_world) so you can inspect one of those to see what is required."}], "tags": [], "owner": {"reputation": 29277, "user_id": 291641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9df10b741c091f5db29f951dc9918a34?s=128&d=identicon&r=PG", "display_name": "patthoyts", "link": "https://stackoverflow.com/users/291641/patthoyts"}, "is_accepted": true, "score": 0, "last_activity_date": 1532503838, "creation_date": 1532503838, "answer_id": 51513209, "question_id": 51512129, "link": "https://stackoverflow.com/questions/51512129/cannot-build-libevent-on-windows/51513209#51513209", "title": "cannot build libevent on windows", "body": "<p>The <a href=\"https://github.com/libevent/libevent\" rel=\"nofollow noreferrer\">libevent</a> README.md file does not suggest using nmake. It points you to using CMake and the existing Makefile.nmake has a big comment at the top suggesting it might not work. So install cmake (you can use <a href=\"https://chocolatey.org/\" rel=\"nofollow noreferrer\">Chocolatey</a> 'choco install cmake') then run the commands as documented.</p>\n\n<pre><code>mkdir build\ncmake -DEVENT__DISABLE_OPENSSL=ON ..\ncmake --build .\n</code></pre>\n\n<p>This worked for me using Visual Studio 2017 with the git checkout of branch release-2.1.8-stable. I added the disable-openssl option as it failed without this and I didn't want to spend time installing that separately.</p>\n"}], "owner": {"reputation": 3, "user_id": 10117560, "user_type": "registered", "profile_image": "https://graph.facebook.com/456392394751542/picture?type=large", "display_name": "Zachery Kish", "link": "https://stackoverflow.com/users/10117560/zachery-kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 1, "accepted_answer_id": 51513209, "answer_count": 1, "score": 0, "last_activity_date": 1532503838, "creation_date": 1532499892, "last_edit_date": 1532501342, "question_id": 51512129, "link": "https://stackoverflow.com/questions/51512129/cannot-build-libevent-on-windows", "title": "cannot build libevent on windows", "body": "<p>So I have been trying to build libevent on Windows. However, it keeps giving me the following output when I run <code>nmake MakeFile.nmake</code>...</p>\n\n<pre><code>        cl /IWIN32-Code /IWIN32-Code/nmake /Iinclude /Icompat /DHAVE_CONFIG_H /I.  \n/Ox /W3 /wd4996 /nologo /c event.c buffer.c bufferevent.c bufferevent_sock.c bufferevent_pair.c \nlistener.c evmap.c log.c evutil.c strlcpy.c signal.c bufferevent_filter.c evthread.c bufferevent_ratelim.c \nevutil_rand.c evutil_time.c win32select.c evthread_win32.c buffer_iocp.c event_iocp.c bufferevent_async.c \nevent.c\nevent.c(31): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nbuffer.c\nbuffer.c(32): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nbufferevent.c\nbufferevent.c(31): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nbufferevent_sock.c\nbufferevent_sock.c(32): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nbufferevent_pair.c\nbufferevent_pair.c(29): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nlistener.c\nlistener.c(30): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nevmap.c\nevmap.c(30): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nlog.c\nlog.c(44): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nevutil.c\nevutil.c(31): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nstrlcpy.c\nstrlcpy.c(37): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nsignal.c\nsignal.c(34): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nbufferevent_filter.c\nbufferevent_filter.c(31): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nevthread.c\nevthread.c(34): fatal error C1083: Cannot open include file: 'stdlib.h': No such file or directory\nbufferevent_ratelim.c\nbufferevent_ratelim.c(30): fatal error C1083: Cannot open include file: 'sys/types.h': No such file or directory\nevutil_rand.c\nevutil_rand.c(38): fatal error C1083: Cannot open include file: 'limits.h': No such file or directory\nevutil_time.c\nevutil_time.c(31): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nwin32select.c\nwin32select.c(33): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nevthread_win32.c\nevthread_win32.c(34): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nbuffer_iocp.c\ninclude\\event2/buffer.h(82): fatal error C1083: Cannot open include file: 'stdarg.h': No such file or directory\nevent_iocp.c\nevent_iocp.c(32): fatal error C1083: Cannot open include file: 'winsock2.h': No such file or directory\nGenerating Code...\nCompiling...\nbufferevent_async.c\nbufferevent_async.c(36): fatal error C1083: Cannot open include file: 'errno.h': No such file or directory\nGenerating Code...\nNMAKE : fatal error U1077: '\"C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\n\\VC\\bin\\cl.EXE\"' : return code '0x2'\nStop.\n</code></pre>\n\n<p>It seems as if it cannot find certain files. So I found the directory where winsock2.h and other files were located and added a environment variable to those files but I still get the same error. I also noticed that I could not actually find sys/types.h and limits.h on my system. I would really appreciate if someone could help figure out what is causing this issue. thanks.</p>\n\n<p>Update:\nSo I have determined where all of the files needed on my system are and I have tried adding an environment variable to the appropriate directories, however, they still cannot be found when I run nmake.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1532496641, "post_id": 51511396, "comment_id": 89991232, "body": "Perhaps you should read more about <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>fscanf</code> (and family)</a>, and what it returns? And get a book or two to read, since you&#39;re using <code>fscanf</code> wrong in other ways as well, and any book or tutorial (good <i>and</i> bad) should have told you how to use <code>scanf</code> which is really the same as <code>fscanf</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532512399, "post_id": 51511396, "comment_id": 90000229, "body": "&quot;But based upon what I read here, fscanf() should spit out a string (or actually a pointer to one)&quot; NO! You are supposed to feed a pointer into <code>scanf</code>. Not the other way around. If you scan for 2 strings how would you expect a function to return 2 pointers at a time? And maybe some additional integers`?"}, {"owner": {"reputation": 31, "user_id": 7343122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GI1tc.png?s=128&g=1", "display_name": "mrwesleycrusher", "link": "https://stackoverflow.com/users/7343122/mrwesleycrusher"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1532539269, "post_id": 51511396, "comment_id": 90017756, "body": "@Someprogrammerdude I read the documentation, and I don&#39;t understand why scanf is relevant since I am trying to read from a file, could you elaborate?"}, {"owner": {"reputation": 31, "user_id": 7343122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GI1tc.png?s=128&g=1", "display_name": "mrwesleycrusher", "link": "https://stackoverflow.com/users/7343122/mrwesleycrusher"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532539433, "post_id": 51511396, "comment_id": 90017862, "body": "@Gerhardh I expected it to return an array, but obviously I didn&#39;t understand what the reference material was telling me about how it returned values."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1532540896, "post_id": 51511396, "comment_id": 90018592, "body": "<code>scanf(...)</code> is equal to <code>fscanf(stdin, ...)</code>."}, {"owner": {"reputation": 31, "user_id": 7343122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GI1tc.png?s=128&g=1", "display_name": "mrwesleycrusher", "link": "https://stackoverflow.com/users/7343122/mrwesleycrusher"}, "edited": false, "score": 0, "creation_date": 1614541828, "post_id": 51511396, "comment_id": 117410943, "body": "I would just like to say that 2 years ago when I was writing my first C program (this) it was incredibly disheartening to get so much down voting because I didn&#39;t understand how C-style functions worked. I am glad I know better now, but this place is so toxic."}], "answers": [{"tags": [], "owner": {"reputation": 1644, "user_id": 8990695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sG6bg.jpg?s=128&g=1", "display_name": "Mr. Roshan", "link": "https://stackoverflow.com/users/8990695/mr-roshan"}, "is_accepted": false, "score": 0, "last_activity_date": 1532497078, "creation_date": 1532497078, "answer_id": 51511494, "question_id": 51511396, "link": "https://stackoverflow.com/questions/51511396/a-value-of-type-int-cannot-be-used-to-initialize-an-entity-of-type-const-char/51511494#51511494", "title": "a value of type &quot;int&quot; cannot be used to initialize an entity of type &quot;const char *&quot;", "body": "<blockquote>\n  <p>fscanf()</p>\n</blockquote>\n\n<p>On success, the <code>fscanf()</code> <code>function</code> returns the number of items of the argument list successfully filled.</p>\n\n<blockquote>\n  <p>Declaration</p>\n</blockquote>\n\n<pre><code>int fscanf(FILE *stream, const char *format, ...)\n</code></pre>\n\n<p>As you are trying to set <code>int</code> value to <code>char const*</code> cause the error</p>\n\n<p>Read more about it :-<a href=\"https://stackoverflow.com/questions/15318360/fscanf-return-value\">fscanf return value</a></p>\n"}, {"comments": [{"owner": {"reputation": 25908, "user_id": 242520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0623460a9ea717d56fd359f797f98d77?s=128&d=identicon&r=PG", "display_name": "ta.speot.is", "link": "https://stackoverflow.com/users/242520/ta-speot-is"}, "edited": false, "score": 0, "creation_date": 1532497357, "post_id": 51511537, "comment_id": 89991495, "body": "<i>The correct way to use <code>fscanf</code> would be this ... <code>fscanf(fileStream, &quot;%s&quot;, &quot;Hello World&quot;);</code></i> Um..."}, {"owner": {"reputation": 3936, "user_id": 7571171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zfVoB.png?s=128&g=1", "display_name": "Thomas Flinkow", "link": "https://stackoverflow.com/users/7571171/thomas-flinkow"}, "reply_to_user": {"reputation": 25908, "user_id": 242520, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0623460a9ea717d56fd359f797f98d77?s=128&d=identicon&r=PG", "display_name": "ta.speot.is", "link": "https://stackoverflow.com/users/242520/ta-speot-is"}, "edited": false, "score": 0, "creation_date": 1532497384, "post_id": 51511537, "comment_id": 89991511, "body": "@ta.speot.is realized my mistake. I mixed it up with <code>fputs</code>, but I&#39;m editing that part right now."}], "tags": [], "owner": {"reputation": 3936, "user_id": 7571171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zfVoB.png?s=128&g=1", "display_name": "Thomas Flinkow", "link": "https://stackoverflow.com/users/7571171/thomas-flinkow"}, "is_accepted": false, "score": 0, "last_activity_date": 1532497366, "last_edit_date": 1592644375, "creation_date": 1532497298, "answer_id": 51511537, "question_id": 51511396, "link": "https://stackoverflow.com/questions/51511396/a-value-of-type-int-cannot-be-used-to-initialize-an-entity-of-type-const-char/51511537#51511537", "title": "a value of type &quot;int&quot; cannot be used to initialize an entity of type &quot;const char *&quot;", "body": "<p><code>fscanf</code> does not return a string, it returns an <code>int</code> indicating the number of arguments assigned:</p>\n<blockquote>\n<p><strong>Return value</strong></p>\n<p>1-3) Number of receiving arguments successfully assigned (which may be zero in case a matching failure occurred before the first receiving argument was assigned), or EOF if input failure occurs before the first receiving argument was assigned.</p>\n<p>4-6) Same as (1-3), except that EOF is also returned if there is a runtime constraint violation.</p>\n</blockquote>\n<p><sub>Taken from <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">the documentation</a>.</sub></p>\n<hr />\n<p>The correct way to use <code>fscanf</code> would be this:</p>\n<pre><code>FILE* fileStream;    \n\nchar str1[32];\nchar str2[32];\n\n// Open the file here...\n\nint successfullyAssigned = fscanf(fileStream, &quot;%s %s&quot;, str1, str2);\n</code></pre>\n<p>as you see, the <code>fscanf</code> <strong>takes</strong> a pointer to the file and it also <strong>takes</strong> pointers to the strings it should assign (i.e. <code>str1</code>, <code>str2</code>). If everything went as it should, <code>sucessfullyAssigned</code> is now <code>2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7343122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GI1tc.png?s=128&g=1", "display_name": "mrwesleycrusher", "link": "https://stackoverflow.com/users/7343122/mrwesleycrusher"}, "is_accepted": true, "score": 0, "last_activity_date": 1532533951, "last_edit_date": 1532533951, "creation_date": 1532499232, "answer_id": 51511975, "question_id": 51511396, "link": "https://stackoverflow.com/questions/51511396/a-value-of-type-int-cannot-be-used-to-initialize-an-entity-of-type-const-char/51511975#51511975", "title": "a value of type &quot;int&quot; cannot be used to initialize an entity of type &quot;const char *&quot;", "body": "<p>The function fscanf() uses side-effects to assign a value to a variable. The input arguments to the function are as follows: (file ptr, format literal for what type of input you want, pointer to allocated space for that input).</p>\n\n<p>It is platform independent. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n\nint** readPGM(char* filename, int* numCols, int* numRows){\n   FILE* inputPGM;\n   inputPGM = fopen(filename, \"r\");\n   //read magic number\n   char* magicNumber = (char *)malloc(3*sizeof(char));\n   fscanf(inputPGM, \"%s\", magicNumber);\n   //skip commented line\n   char* temporaryVar = (char *)malloc(100*sizeof(char));\n   fscanf(inputPGM,\"%s\",temporaryVar);\n   free((void *)temporaryVar);\n   //read width and height\n   fscanf(inputPGM, \"%d %d\", numRows, numCols);\n   free((void *)magicNumber);\n   return NULL;\n   } \n\n//start of the edge detection\nint main(){\n   static char filename[] = \"sample.pgm\";\n   int* numCols = (int*)malloc(sizeof(int));\n   int* numRows = (int*)malloc(sizeof(int));\n   int** data = readPGM(filename, numRows, numCols);\n   printf(\"Done!\\n\");\n   free(numCols);\n   free(numRows);\n   return 0;\n   }\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7343122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GI1tc.png?s=128&g=1", "display_name": "mrwesleycrusher", "link": "https://stackoverflow.com/users/7343122/mrwesleycrusher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 0, "accepted_answer_id": 51511975, "answer_count": 3, "score": -6, "last_activity_date": 1532533951, "creation_date": 1532496577, "last_edit_date": 1532499314, "question_id": 51511396, "link": "https://stackoverflow.com/questions/51511396/a-value-of-type-int-cannot-be-used-to-initialize-an-entity-of-type-const-char", "title": "a value of type &quot;int&quot; cannot be used to initialize an entity of type &quot;const char *&quot;", "body": "<p>I am attempting to write my own C code to read some <code>pgm version 5 images</code> I have exported from GIMP. I am trying to compile with the nvcc compiler on an Ubuntu machine, but it is giving me the following error: </p>\n\n<pre><code>error: a value of type \"int\" cannot be used to initialize an entity of type \"const char *\"\n</code></pre>\n\n<p><strong>Which refers to this line</strong></p>\n\n<pre><code>char const* magicNumber = fscanf(inputPGM, \"s\");\n</code></pre>\n\n<p>But based upon what I read <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fscanf.htm\" rel=\"nofollow noreferrer\"><strong>here</strong></a>, <code>fscanf()</code> should spit out a <code>string</code> (or actually a pointer to one) when given those arguments. Does <code>fscanf()</code> vary between platforms? Is there some cool pointer nonsense that I am misusing?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n\nint** readPGM(char* filename, int* numCols, int* numRows) {\n    FILE *inputPGM;\n    inputPGM = fopen(filename, \"r\");\n\n    //read magic number\n    char const* magicNumber = fscanf(inputPGM, \"s\");\n\n    //skip commented line\n    fscanf(inputPGM,\"s\");\n\n    //read width and height\n    int width = fscanf(inputPGM, \"s\");\n    int height = fscanf(inputPGM, \"s\");\n\n    return NULL;\n} \n\nint main() {\n    static char filename[] = \"sample.pgm\";\n    int* numCols = (int*)malloc(sizeof(int));\n    int* numRows = (int*)malloc(sizeof(int));\n    int** data = readPGM(filename, numCols, numRows);\n\n    printf(\"Done!\\n\");\n\n    free(numCols);\n    free(numRows);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1532497533, "post_id": 51511389, "comment_id": 89991574, "body": "It seems to me the +8 should move outside the parenthesis as sw32(I think) is swapping endian of context-&gt;src, it seems safer to do any addition after the swap is done."}, {"owner": {"reputation": 11, "user_id": 10131447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WwGGA.png?s=128&g=1", "display_name": "Jack Hu", "link": "https://stackoverflow.com/users/10131447/jack-hu"}, "reply_to_user": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1532505470, "post_id": 51511389, "comment_id": 89995682, "body": "the sw32() will swapping endian of context-&gt;src array from index 8 to 12."}], "owner": {"reputation": 11, "user_id": 10131447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WwGGA.png?s=128&g=1", "display_name": "Jack Hu", "link": "https://stackoverflow.com/users/10131447/jack-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1516, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532496753, "creation_date": 1532496540, "last_edit_date": 1532496753, "question_id": 51511389, "link": "https://stackoverflow.com/questions/51511389/program-terminated-with-signal-8-arithmetic-exception-with-blosc", "title": "Program terminated with signal 8, Arithmetic exception with blosc", "body": "<p>Please refer the following stack trace:</p>\n\n<pre><code>_Program terminated with signal 8, Arithmetic exception.\n#0  0x00007f6cba9fe187 in blosc_run_decompression_with_context () from   /usr/lib64/libblosc.so.1\n(gdb) bt\n#0  0x00007f6cba9fe187 in blosc_run_decompression_with_context () from /usr/lib64/libblosc.so.1\n#1  0x00007f6cba9fe35c in blosc_decompress_ctx () from /usr/lib64/libblosc.so.1_\n</code></pre>\n\n<p>It seems that the function <code>blosc_run_decompression_with_context()</code> did not check the <code>context-&gt;blocksize</code> whether is zero, which will be divided.</p>\n\n<p>Please focus the line 1421 of c-blosc/blosc/blosc.c</p>\n\n<pre><code>context-&gt;blocksize = sw32_(context-&gt;src + 8);      /* block size */\n</code></pre>\n\n<p>'the context->block size' is possible be zero.</p>\n\n<p>Does anyone meet this problem and know how to fix it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1532491797, "post_id": 51510623, "comment_id": 89989969, "body": "<a href=\"https://www.tutorialspoint.com/cprogramming/switch_statement_in_c.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/switch_statement_in_c.htm</a>"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1532491863, "post_id": 51510623, "comment_id": 89989979, "body": "add <code>break;</code> before <code>default</code>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1532491958, "post_id": 51510623, "comment_id": 89990001, "body": "<code>fp</code> is not init to anything."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1532491999, "post_id": 51510623, "comment_id": 89990009, "body": "<code>struct frame_entry* newptr = realloc(f, sizeof(struct frame_entry));</code> invalid <code>f</code> if realloc is a success."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 3, "creation_date": 1532492024, "post_id": 51510623, "comment_id": 89990016, "body": "Your code don&#39;t make sense, there are simply too many big errors."}, {"owner": {"reputation": 1, "user_id": 5654766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745073a17b17d3a6537c08ad4094bb33?s=128&d=identicon&r=PG&f=1", "display_name": "Devries", "link": "https://stackoverflow.com/users/5654766/devries"}, "edited": false, "score": 0, "creation_date": 1532492584, "post_id": 51510623, "comment_id": 89990140, "body": "Helo Stargateur, I deleted some part of my code to make these mode easier to read"}, {"owner": {"reputation": 1, "user_id": 5654766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745073a17b17d3a6537c08ad4094bb33?s=128&d=identicon&r=PG&f=1", "display_name": "Devries", "link": "https://stackoverflow.com/users/5654766/devries"}, "edited": false, "score": 0, "creation_date": 1532492714, "post_id": 51510623, "comment_id": 89990170, "body": "Hello Thiru Shetty, I tried your suggestion but the issue still exist."}, {"owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "edited": false, "score": 2, "creation_date": 1532493253, "post_id": 51510623, "comment_id": 89990284, "body": "Don&#39;t delete code that my be needed to understand the root of the problem. Or even better, create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This may help you to find and solve the problem by yourself. Also, did you take the <a href=\"https://stackoverflow.com/tour\">tour</a> yet?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532504249, "post_id": 51510623, "comment_id": 89994955, "body": "Why do you think <code>fp</code> would be zero? You don&#39;t set it to <code>NULL</code> after closing."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1532512122, "post_id": 51510623, "comment_id": 90000035, "body": "Please <a href=\"https://stackoverflow.com/posts/51510623/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 8487340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc51fe61ebda41befdd8704d76458f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Amal John", "link": "https://stackoverflow.com/users/8487340/amal-john"}, "is_accepted": false, "score": 1, "last_activity_date": 1532500350, "creation_date": 1532500350, "answer_id": 51512228, "question_id": 51510623, "link": "https://stackoverflow.com/questions/51510623/while-loop-continue-running-after-using-return-to-break-in-c/51512228#51512228", "title": "While loop continue running after using return to break in C", "body": "<p>This might be caused because you are using a pointer variable ie; <code>f</code> which is reallocted.\n<code>realloc()</code> function may first try to increase the size of the block that a points to. However, it can instead allocate a new block, copy the data (or as much of the data as will fit) to the new block, and free the old block.</p>\n\n<p>So while realloc() runs <code>f</code> may be pointing to an already deallocted memory. You should not use the variable <code>f</code>  instead use <code>newptr</code>.</p>\n\n<p>Plus the file pointer is not properly initialized. It is a good practice to check if the file pointer is properly initialized or not.</p>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 7715071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87129542ce2b44b57c1b1b45f90615cf?s=128&d=identicon&r=PG&f=1", "display_name": "BobTheBuilder", "link": "https://stackoverflow.com/users/7715071/bobthebuilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1532502945, "last_edit_date": 1532502945, "creation_date": 1532502384, "answer_id": 51512784, "question_id": 51510623, "link": "https://stackoverflow.com/questions/51510623/while-loop-continue-running-after-using-return-to-break-in-c/51512784#51512784", "title": "While loop continue running after using return to break in C", "body": "<p>The first thing I noticed was that you are trying to read from a file pointer that is not initialized in the line <code>ch = fgetc(fp);</code> where fp is not initialized to any valid file. But I agree this might not cause a segfault. Like the answer above said, you need to use the new pointer after a call to <code>realloc</code>. </p>\n\n<p>Since <code>null</code> is equivalent of the integer <code>0</code>, the loop runs because <code>f-&gt;len</code> never exceeds <code>MAX_FRAME_LEN</code>. This results in the loop running infinitely.</p>\n"}], "owner": {"reputation": 1, "user_id": 5654766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745073a17b17d3a6537c08ad4094bb33?s=128&d=identicon&r=PG&f=1", "display_name": "Devries", "link": "https://stackoverflow.com/users/5654766/devries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1546359356, "creation_date": 1532491522, "last_edit_date": 1592644375, "question_id": 51510623, "link": "https://stackoverflow.com/questions/51510623/while-loop-continue-running-after-using-return-to-break-in-c", "title": "While loop continue running after using return to break in C", "body": "<p>I got a segmentation fault in C programming, here is my simplified code:</p>\n<pre><code>int read(struct frame_entry *f)\n{\n    struct frame_entry* newptr = realloc(f, sizeof(struct frame_entry));\n    int ret = 0;\n    FILE *fp;\n    char ch;\n\n    while (f-&gt;len &lt; MAX_FRAME_LEN)\n    {\n        ch = fgetc(fp);\n\n        switch(ch) {\n        case FRAME_END:\n            if (f-&gt;len){\n                fclose(fp);\n                return ret;\n            }\n        default:\n            f-&gt;frame[f-&gt;len++] = ch;\n            break;\n        }\n    }\n\nframe_tail:\n    fclose(fp);\n    return ret;\n}\n</code></pre>\n<p>The running result is:\n1, enter case FRAME_END\n2, fclose(fp)\n3, function return\n4, while continue running but fp is zero\n5, ch = fgetc(fp); drop a segmentation fault</p>\n<p>The question is: why while loop continue running after function return?</p>\n<hr />\n<h1>Solved</h1>\n<p>Finally I found that the problem is that struct frame_entry contains a file descriptor which opened, and I use fdopen to convert this file descriptor to a file pointer, but when I use fclose(fp) to free this file pointer, the file descriptor also be freed, then fgetc(fp) will cause segfault.</p>\n"}, {"tags": ["c", "multithreading", "sockets", "select", "signals"], "comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1532489547, "post_id": 51510251, "comment_id": 89989594, "body": "There are probably high level libraries that already do it way better than any simple code will."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1532489697, "post_id": 51510251, "comment_id": 89989613, "body": "I think using a unix pipe to turn an a-synchronous event (signal) into a synchronous event is a valid way to handle this. <code>select</code> should return if the unix pipe is in the set of descriptors and becomes readable."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1532490152, "post_id": 51510251, "comment_id": 89989691, "body": "You are talking about thousands of connections; probably should not use <code>select</code> as it has an upper limit.on the descriptor integer value (and is inefficient for larger numbers). <code>poll</code> does not have an upper integer limit, but still does not scale well for a large number of descriptors. <code>epoll</code> scales better since it does not have to iterate over a set of active descriptors. Instead, the kernel reports which descriptor is active. <code>epoll</code> is a linux-only system call though"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1532490326, "post_id": 51510251, "comment_id": 89989721, "body": "If this is on Linux, just use <code>signalfd</code>. (Signals are so annoying they added a way to avoid them completely!). Otherwise, the self-pipe trick <i>should</i> let <code>select</code> return."}, {"owner": {"reputation": 1, "user_id": 10130928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042617a658be8667624c4907aab01bdd?s=128&d=identicon&r=PG&f=1", "display_name": "MeGaDiLdO", "link": "https://stackoverflow.com/users/10130928/megadildo"}, "edited": false, "score": 0, "creation_date": 1532493617, "post_id": 51510251, "comment_id": 89990375, "body": "I need to let  <code>select()</code> return for sure! Yeah, i&#39;m on unix. epool is interesting, but can someone give me a link with a full C example?"}], "owner": {"reputation": 1, "user_id": 10130928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042617a658be8667624c4907aab01bdd?s=128&d=identicon&r=PG&f=1", "display_name": "MeGaDiLdO", "link": "https://stackoverflow.com/users/10130928/megadildo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532493522, "creation_date": 1532488138, "last_edit_date": 1532493522, "question_id": 51510251, "link": "https://stackoverflow.com/questions/51510251/how-to-return-from-a-select-with-sigint", "title": "How to return from a select with SIGINT", "body": "<p>I need your help to solve this problem.<br>\nI have to create a multi-threaded client-server program on unix, based on AF_UNIX\nsockets, that must handle up to some thousands simultaneous connections and also must do different things based on the type of signal received, like shutdown when server receives a <code>SIGINT</code>. </p>\n\n<p>I thought of doing this disabling, initially, <code>SIGINT</code> and the other signals from the main's thread sigmask, then starting up a dispatching thread, that keeps (I know that's really inefficient this) waiting on <code>select()</code> for I/0 requests, accepts the new connection and then reads exactly <code>sizeof(request)</code> bytes, where <code>request</code> is a well-known structure, then creating also a thread that handles the signals received, the only one that re-enables the signals, using <code>sigwait()</code>, and finally starting up the other server thread to execute the real work.</p>\n\n<p>I have this questions:   </p>\n\n<ul>\n<li>I would like to let <code>select()</code> return even if the dispatcher thread is stuck in it. I've red of a <em>self-pipe trick</em> about this, but I think I made it wrong, because even if I let the signal-handling thread write in the pipe that's in the select's read set, <code>select()</code> won't return. How could I let <code>select()</code> return?</li>\n<li>I've read something about <code>epoll()</code>, that's the efficient to handle many simultaneous connections efficiently. Should i, and if how, use it? I can't figure it out only reading <code>man epoll</code>, and on my text book it's not even mentioned.</li>\n<li>There are some good practices that I could use for handling system's failures? I almost check every system call's return value to, eventually, handle the error to free memory and other stuff like this, but my code keeps growing a lot, and almost for the same operations repeated many times. How could I write a cleanup function that could free memory before returning with <code>abort()</code>? </li>\n</ul>\n\n<p>Anyway, thanks a lot in advice for your help, this platform is really amazing, and when I'll get more expert, I'll pay the community back giving my help! </p>\n\n<p>(Sorry for my English, but it's not my mother language)</p>\n"}, {"tags": ["c", "string", "whitespace", "trim"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1532487896, "post_id": 51509941, "comment_id": 89989304, "body": "Because the string constant <code>&quot;mystring  &quot;</code> is constant.  Try using it to initialize a modifiable array: <code>char str[] = &quot;mystring  &quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 9708329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb027c8cab5f2bae1ee00c97a51c8633?s=128&d=identicon&r=PG&f=1", "display_name": "plexik", "link": "https://stackoverflow.com/users/9708329/plexik"}, "is_accepted": true, "score": 3, "last_activity_date": 1532487968, "creation_date": 1532487968, "answer_id": 51510231, "question_id": 51509941, "link": "https://stackoverflow.com/questions/51509941/segmentation-fault-when-removing-trailing-whitespace-from-string-in-c/51510231#51510231", "title": "Segmentation fault when removing trailing whitespace from string in c", "body": "<p>The issue here is that the line causing the crash is attempting to modify a string literal, which results in undefined behavior.</p>\n\n<p>According to <a href=\"https://en.cppreference.com/w/c/language/string_literal\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/language/string_literal</a> ,</p>\n\n<blockquote>\n  <p>String literals are not modifiable (and in fact may be placed in read-only memory such as .rodata). If a program attempts to modify the static array formed by a string literal, the behavior is undefined.</p>\n</blockquote>\n\n<p>You'll have to make sure to pass a <code>char*</code> to a modifiable array, such as one you allocate yourself with <code>malloc()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1905, "user_id": 8713450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed61e21ec072346277da9569f1c9f966?s=128&d=identicon&r=PG&f=1", "display_name": "ceno980", "link": "https://stackoverflow.com/users/8713450/ceno980"}, "edited": false, "score": 0, "creation_date": 1532498117, "post_id": 51510328, "comment_id": 89991812, "body": "What is the difference between using *(++end) over *(end++)?"}, {"owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "reply_to_user": {"reputation": 1905, "user_id": 8713450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed61e21ec072346277da9569f1c9f966?s=128&d=identicon&r=PG&f=1", "display_name": "ceno980", "link": "https://stackoverflow.com/users/8713450/ceno980"}, "edited": false, "score": 0, "creation_date": 1532504169, "post_id": 51510328, "comment_id": 89994899, "body": "In the case of (++end) the end pointer is incremented before the operation of setting the value to &#39;\\0&#39;. In the case of (end++) the end pointer is incremented AFTER the operation of setting the value to &#39;\\0&#39;.  When you reach this line the end pointer is at letter &#39;g&#39; of string. The way you had it would give length 7 (mystrin) instead of 8 (mystring). :-)"}], "tags": [], "owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "is_accepted": false, "score": 2, "last_activity_date": 1532489466, "last_edit_date": 1532489466, "creation_date": 1532488913, "answer_id": 51510328, "question_id": 51509941, "link": "https://stackoverflow.com/questions/51509941/segmentation-fault-when-removing-trailing-whitespace-from-string-in-c/51510328#51510328", "title": "Segmentation fault when removing trailing whitespace from string in c", "body": "<p>The other responses are correct - but i'm surprised your compiler did not pick up the error. Below compiles and runs fine with Visual Studio 2017.</p>\n\n<p>Note a little bug also in trim()</p>\n\n<pre><code>*(++end) = '\\0'; NOT\n*(end++) = '\\0';\n</code></pre>\n\n<p>All good now. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nchar *trim(char *str) {\n    char *end;\n    end = str + strlen(str) - 1;\n    while (end &gt; str &amp;&amp; isspace((unsigned char)*end)) {\n        end--;\n    }\n    *(++end) = '\\0'; //this line causes the segfault\n    return str;\n}\n\nint main(void) {\n    char str0[] = \"mystring  \"; // minor change here\n    char *str = str0;           // minor change here\n    printf(\"before trim string is %s\\n\", str);\n    printf(\"length before: %d\\n\", strlen(str)); //should be 10\n\n    str = trim(str);\n    printf(\"after trim string is %s\\n\", str);\n    printf(\"length after: %d\\n\", strlen(str)); //should be 8\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 8050827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dd1c951387118e9bd64d4bfc57d646?s=128&d=identicon&r=PG&f=1", "display_name": "Hejun", "link": "https://stackoverflow.com/users/8050827/hejun"}, "is_accepted": false, "score": 2, "last_activity_date": 1532489928, "creation_date": 1532489928, "answer_id": 51510448, "question_id": 51509941, "link": "https://stackoverflow.com/questions/51509941/segmentation-fault-when-removing-trailing-whitespace-from-string-in-c/51510448#51510448", "title": "Segmentation fault when removing trailing whitespace from string in c", "body": "<p>When a string is processed with a pointer, the compiler assigns the storage address of the first character of the constant string after \"=\" to the pointer, and the constant string exists in the read-only memory.\nYou can try these two code to observation difference:</p>\n\n<pre><code>int main()\n{\n    char str[] = \"abcd\";\n    *str = 'c';\n    printf(\"%s\\n\", str);\n    return 0;\n}\n\nint main()\n{\n    char *str = \"abcd\";\n    *str = 'c';    // error\n    printf(\"%s\", str);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1905, "user_id": 8713450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed61e21ec072346277da9569f1c9f966?s=128&d=identicon&r=PG&f=1", "display_name": "ceno980", "link": "https://stackoverflow.com/users/8713450/ceno980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 51510231, "answer_count": 3, "score": 1, "last_activity_date": 1532489928, "creation_date": 1532485250, "question_id": 51509941, "link": "https://stackoverflow.com/questions/51509941/segmentation-fault-when-removing-trailing-whitespace-from-string-in-c", "title": "Segmentation fault when removing trailing whitespace from string in c", "body": "<p>I am trying to remove the white spaces at the end of a string. I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nchar *trim(char *str) {\n   char *end;\n   end = str + strlen(str) - 1;\n   while(end &gt; str &amp;&amp; isspace((unsigned char)*end)) {\n      end--;\n   }\n   *(end++) = '\\0'; //this line causes the segfault\n   return str;\n}\n\nint main(void) {\n   char *str = \"mystring  \";\n   printf(\"before trim string is %s\\n\", str);\n   printf(\"length before: %d\\n\", strlen(str)); //should be 10\n   str = trim(str);\n   printf(\"after trim string is %s\\n\", str);\n   printf(\"length after: %d\\n\", strlen(str)); //should be 8\n   return 0;\n}\n</code></pre>\n\n<p>When I run the code, I get a segmentation fault. What I'm not sure about is why incrementing the pointer 'end' by 1, and then changing the value it points to from a white space to the null terminator causes the segfault. I have read that incrementing a pointer in C such that the pointer does not point to an element of an array is undefined behaviour. However, wouldn't the white spaces at the end of \"mystring\" still be part of the char array str[]? Any help is really appreciated.</p>\n"}, {"tags": ["c++", "c", "winapi"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 1654381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec906ed1c5187441abafacfe3488b04c?s=128&d=identicon&r=PG", "display_name": "loa_in_", "link": "https://stackoverflow.com/users/1654381/loa-in"}, "is_accepted": false, "score": 1, "last_activity_date": 1532480591, "creation_date": 1532480591, "answer_id": 51509487, "question_id": 51509468, "link": "https://stackoverflow.com/questions/51509468/how-to-simulate-mouse-cursor-movement-in-c/51509487#51509487", "title": "How to simulate mouse cursor movement in C++", "body": "<p>You will have to call SetCursorPos multiple times with coordinates first close to your point, then gradually closer to (0,0). Without some intentional delay it will just appear to happen instantly anyway, so keep that in mind.</p>\n"}, {"comments": [{"owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "edited": false, "score": 0, "creation_date": 1541563541, "post_id": 51509534, "comment_id": 93256791, "body": "you sir are genius lol. now I want to figure out how to make it go in a spiral to a point. I adapted your code to pull the mouse back to the center of the screen... very smoothly ;) now for some spirals"}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1532481439, "last_edit_date": 1532481439, "creation_date": 1532481062, "answer_id": 51509534, "question_id": 51509468, "link": "https://stackoverflow.com/questions/51509468/how-to-simulate-mouse-cursor-movement-in-c/51509534#51509534", "title": "How to simulate mouse cursor movement in C++", "body": "<p>You will need to gradually progress your mouse a little bit at a time. Consider, for example the following pseudo-code function:</p>\n\n<pre><code>def moveMouse (endX, endY, stepCount, stepDelay):\n    GetCurrentPosTo(startX, startY);\n    for step = 1 to stepCount\n        currX = startX + (endX - startX) * step / stepCount\n        currY = startY + (endY - startY) * step / stepCount\n        SetCurrentPosFrom(currX, currY)\n        DelayFor(stepDelay)\n    endfor\nenddef\n</code></pre>\n\n<p>This calculates the current position (within the loop) as some fraction of the journey from <code>(startX, startY)</code> to <code>(endX, endY)</code>, adjusting for the number of steps you wish to take.</p>\n\n<p>So using a <code>stepCount</code> of 100 and <code>stepDelay</code> of ten milliseconds, the mouse cursor would smoothly move over the period of a second.</p>\n\n<p>There could be <em>other</em> possibilities such as moving the cursor at a specific speed rather than taking a specific time, or specifying a minimum speed and maximum time to combine <em>both</em> methods.</p>\n\n<p>I'll leave that as an extra exercise. Suffice to say it would involve the <em>same</em> method of moving the cursor a little at a time rather than just setting its position to the final value immediately.</p>\n"}, {"tags": [], "owner": {"reputation": 332, "user_id": 2010012, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/01f47bec1cf38b0bc2ba112a6613fe1c?s=128&d=identicon&r=PG", "display_name": "james28909", "link": "https://stackoverflow.com/users/2010012/james28909"}, "is_accepted": false, "score": 1, "last_activity_date": 1541603007, "last_edit_date": 1541603007, "creation_date": 1541572137, "answer_id": 53184541, "question_id": 51509468, "link": "https://stackoverflow.com/questions/51509468/how-to-simulate-mouse-cursor-movement-in-c/53184541#53184541", "title": "How to simulate mouse cursor movement in C++", "body": "<p>Heres my little concoction from around the web!</p>\n\n<p>It spins the mouse, and rather fluidly, in an <a href=\"https://computergraphics.stackexchange.com/questions/1820/archimedean-spiral-in-c\">Archimedean spiral</a> from the center of the screen outward. You can also mess with the math in the loop, specifically the `cos()` and `sin()` functions to get it to do different movements. Purely for educational purposes only.</p>\n\n<p>Enjoy :)</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\n\nvoid moveMouse(int x, int y){\n\n    int count = 800;\n    int movex, movey;\n    float angle = 0.0f;\n\n    // set mouse at center screen\n    SetCursorPos(x/2, y/2); \n\n    // begin spiral! :)\n    for(int i = 0; i &lt;= count; i++){\n        angle = .3 * i;\n        movex = (angle * cos(angle) * 2) + x/2;\n        movey = (angle * sin(angle) * 2) + y/2;\n        SetCursorPos(movex, movey);\n        Sleep(1);\n    }\n\n}\n\nint main(){\n    int Height = GetSystemMetrics(SM_CYSCREEN);\n    int Width = GetSystemMetrics(SM_CXSCREEN);\n    moveMouse(Width,Height);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 885101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9453697b2f79e8ab52841e7c72fa67df?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/885101/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1556821380, "creation_date": 1556821380, "answer_id": 55958161, "question_id": 51509468, "link": "https://stackoverflow.com/questions/51509468/how-to-simulate-mouse-cursor-movement-in-c/55958161#55958161", "title": "How to simulate mouse cursor movement in C++", "body": "<p>Try this code I used to debug inputs..  I put it where it runs every frame.  Get the mouse position, and set the mouse position.  Your mouse should not be moving or the math is wrong..</p>\n\n<pre><code>{\n    POINT       pos;\n    GetCursorPos(&amp;pos);\n\n    INPUT input[1];\n    memset(&amp;input, 0, sizeof(input));\n\n    int left    = GetSystemMetrics(SM_XVIRTUALSCREEN);\n    int top     = GetSystemMetrics(SM_YVIRTUALSCREEN);\n    int width   = GetSystemMetrics(SM_CXVIRTUALSCREEN);\n    int heigth  = GetSystemMetrics(SM_CYVIRTUALSCREEN);\n\n    // 0x1000 because 0 to 0xffff is not 65535, its 65536.\n    // we add 0.5f to the location to put us in the center of the pixel. to avoid rounding errors.  Take it out and your mouse will move up and to the left.\n    POINT Desired;\n    Desired.x = ((float)(pos.x - left ) + 0.5f) * (float) (0x10000) / (float) (width);\n    Desired.y = ((float)(pos.y - top) + 0.5f) * (float) (0x10000) / (float) (heigth);\n\n    // move to new location\n    input[0].type           = INPUT_MOUSE;\n    input[0].mi.dx          = Desired.x;\n    input[0].mi.dy          = Desired.y;\n    input[0].mi.mouseData   = 0;\n    input[0].mi.dwFlags     = MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_MOVE_NOCOALESCE | MOUSEEVENTF_MOVE | MOUSEEVENTF_VIRTUALDESK;\n    input[0].mi.time        = 0;\n\n    SendInput(1, &amp;input[0], sizeof(INPUT));\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10130679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1d8dce7f093ff5dfd431c510599c5c?s=128&d=identicon&r=PG&f=1", "display_name": "John K", "link": "https://stackoverflow.com/users/10130679/john-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3852, "favorite_count": 0, "accepted_answer_id": 51509534, "answer_count": 4, "score": 0, "last_activity_date": 1556821380, "creation_date": 1532480337, "last_edit_date": 1532482880, "question_id": 51509468, "link": "https://stackoverflow.com/questions/51509468/how-to-simulate-mouse-cursor-movement-in-c", "title": "How to simulate mouse cursor movement in C++", "body": "<p>I'm creating a program on my spare time and I'm trying to simulate mouse cursor movements.</p>\n\n<p>I'm trying to make it so that when I start my program it'll move my cursor from [x,y] to [0,0] (which is the top-left corner of my screen).</p>\n\n<p>Is there anyway to do this without having it teleport?</p>\n\n<p>Here is what I have so far for my mouse cursor movement program:</p>\n\n<pre><code>POINT p;\nGetCursorPos( &amp;p );\ndouble mouseX = p.x;\ndouble mouseY = p.y;\nSetCursorPos(0, 0);\n</code></pre>\n\n<p>Any way to actually see my mouse being moved instead of just teleporting to [0,0] instantly?</p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1532471243, "post_id": 51508362, "comment_id": 89985755, "body": "The scope of <code>middle</code> is inside the <code>do-while</code>, you need to declare it outside of the the loop for it to be used in the while test."}, {"owner": {"reputation": 25, "user_id": 8580328, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005528470794/picture?type=large", "display_name": "Hassan Abdul-Kareem", "link": "https://stackoverflow.com/users/8580328/hassan-abdul-kareem"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1532471403, "post_id": 51508362, "comment_id": 89985823, "body": "but in that case how would I constantly alter it so I&#39;d find the <code>givenNumber</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532471808, "post_id": 51508362, "comment_id": 89985930, "body": "Cut and paste in the true code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532471909, "post_id": 51508362, "comment_id": 89985959, "body": "Review <code>int middle = start + end &#47; 2;</code>  It OK when <code>start == 0</code>."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1532471956, "post_id": 51508362, "comment_id": 89985972, "body": "You need to understand what a variable declaration is. You only say <code>int middle;</code> when you declare the variable, which in this case should be in the outer scope or <code>binary_search</code>.  Every time after that you need to omit the <code>int</code> since the variable has already been declared.  Read up on this."}, {"owner": {"reputation": 25, "user_id": 8580328, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005528470794/picture?type=large", "display_name": "Hassan Abdul-Kareem", "link": "https://stackoverflow.com/users/8580328/hassan-abdul-kareem"}, "edited": false, "score": 0, "creation_date": 1532472316, "post_id": 51508362, "comment_id": 89986090, "body": "So from what you&#39;ve just said it means that in the given block whether it&#39;s while or do or whatever, you only need to declare it once, and later use it normally. Okay, I will read, thanks."}, {"owner": {"reputation": 25, "user_id": 8580328, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005528470794/picture?type=large", "display_name": "Hassan Abdul-Kareem", "link": "https://stackoverflow.com/users/8580328/hassan-abdul-kareem"}, "edited": false, "score": 0, "creation_date": 1532472346, "post_id": 51508362, "comment_id": 89986098, "body": "I pasted the original code from the compiler without any edits, though."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1532475936, "post_id": 51508362, "comment_id": 89987004, "body": "I would recommend unaccepting the answer you accepted. That code has a huge amount of flaws."}], "answers": [{"comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1532474867, "post_id": 51508625, "comment_id": 89986756, "body": "There&#39;s no way this could work.  You are shadowing <code>middle</code> all over the place in this code."}, {"owner": {"reputation": 25, "user_id": 8580328, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005528470794/picture?type=large", "display_name": "Hassan Abdul-Kareem", "link": "https://stackoverflow.com/users/8580328/hassan-abdul-kareem"}, "edited": false, "score": 1, "creation_date": 1532475974, "post_id": 51508625, "comment_id": 89987017, "body": "It worked as in just a code, but practically, the code is useless."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1532475983, "post_id": 51508625, "comment_id": 89987019, "body": "The loop <i>always</i> returns on the <i>first</i> iteration (i.e. all four of the <code>if&#47;else</code> clauses have a <code>return</code>)"}], "tags": [], "owner": {"reputation": 609, "user_id": 2442528, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HMlQY.png?s=128&g=1", "display_name": "Fadi Hanna AL-Kass", "link": "https://stackoverflow.com/users/2442528/fadi-hanna-al-kass"}, "is_accepted": false, "score": -2, "last_activity_date": 1532472795, "creation_date": 1532472795, "answer_id": 51508625, "question_id": 51508362, "link": "https://stackoverflow.com/questions/51508362/binary-search-implemention-mostly-code-structure-problems-aka-newbie-problems/51508625#51508625", "title": "Binary search implemention ( mostly code structure problems, aka newbie problems)", "body": "<ol>\n<li>You can't declare a variable inside a while statement. Move it to the top of your function.</li>\n<li>You have a misplaced curly brace in your code.</li>\n</ol>\n\n<p>Try this:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define size 1000\n\nint binary_search(int array[size], int givenNumber) {\n  int middle;\n  do {\n    int start = 0;\n    int end = size;\n    int middle = start + end / 2;\n    int left = size - 1;\n    int right = size + 1;\n\n    if (array[middle] == givenNumber) {\n      printf(\"location: %d, number: %i\", middle, givenNumber);\n      return middle;\n    } else if (array[left] &lt; givenNumber) {\n\n      int start = 0;\n      int end = array[left];\n      int middle = start + end / 2;\n      return middle;\n    } else if (array[right] &gt; middle) {\n\n      int start = array[right];\n      int end = size;\n      int middle = start + end / 2;\n      return middle;\n    } else {\n      return -1;\n    }\n  } while (middle != givenNumber);\n}\n\nint main() {\n  int sorted_array[size];\n  for (int i = 0; i &lt; size; i++) {\n    sorted_array[i] = i;\n  }\n  return binary_search(sorted_array, 349);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 8580328, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005528470794/picture?type=large", "display_name": "Hassan Abdul-Kareem", "link": "https://stackoverflow.com/users/8580328/hassan-abdul-kareem"}, "edited": false, "score": 0, "creation_date": 1532529464, "post_id": 51509180, "comment_id": 90012044, "body": "Thanks for your notes, it directed me into the right path. I have updated the code, please look into it."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 2, "last_activity_date": 1532551302, "last_edit_date": 1532551302, "creation_date": 1532477407, "answer_id": 51509180, "question_id": 51508362, "link": "https://stackoverflow.com/questions/51508362/binary-search-implemention-mostly-code-structure-problems-aka-newbie-problems/51509180#51509180", "title": "Binary search implemention ( mostly code structure problems, aka newbie problems)", "body": "<p>There are a number of issues:</p>\n\n<ol>\n<li>The loop does <em>not</em> iterate. All parts of <code>if/else</code> have a <code>return</code></li>\n<li><em>massive</em> amount of \"shadowing\" of variables</li>\n<li>size is <em>invariant</em> so left/right are <em>always</em> set to the same thing</li>\n<li><code>left</code> and <code>right</code> should be started at <code>0</code> and <code>size - 1</code> respectively</li>\n<li>variables are used <em>inconsistently</em> (e.g. <code>start</code> is both an array index and an array <em>value</em>)</li>\n<li>The function is more complex than it needs to be and has some extraneous variables</li>\n<li>Your binary search algorithm is suspect</li>\n</ol>\n\n<p>First and foremost, I'd recommend removing all \"sub-scoped\" variable declarations that shadow outer scoped ones (i.e. put all variables at the outermost scope).</p>\n\n<p>Do this until you're more comfortable with these declarations. Learn more about the difference between:</p>\n\n<ol>\n<li>variable declaration: <code>int x;</code></li>\n<li>variable declaration with initializer: <code>int x = 5;</code></li>\n<li>variable assignment: <code>x = 5;</code></li>\n</ol>\n\n<hr>\n\n<p>I've annotated your original function, created a test/diagnostic function and created a refactored function that passes the diagnostic test:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define size 1000\n\nint\nbinary_fixed(int *array, int givenNumber)\n{\n    int left;\n    int right;\n    int middle;\n    int curval;\n    int retindex = -1;\n\n    left = 0;\n    right = size - 1;\n\n    while (left &lt;= right) {\n        middle = (left + right) / 2;\n        curval = array[middle];\n\n        if (curval == givenNumber) {\n            retindex = middle;\n            break;\n        }\n\n        if (curval &gt; givenNumber)\n            right = middle - 1;\n        else\n            left = middle + 1;\n    }\n\n    return retindex;\n}\n\nint\nbinary_search(int *array, int givenNumber)\n{\n    int middle;\n\n    // NOTE/BUG: this does _not_ iterate\n    // NOTE/BUG: _massive_ amount of \"shadowing\" of variables\n    // NOTE/BUG: size is _invariant_ so left/right are _always_ set to the\n    // same thing\n    // NOTE/BUG: left and right should start at 0 and size - 1 respectively\n    // NOTE/BUG: variables are used _inconsistently_ (e.g. start is both\n    // an array index and an array _value_)\n    do {\n        int start = 0;\n        int end = size;\n        int middle = start + end / 2;\n        int left = size - 1;\n        int right = size + 1;\n\n        if (array[middle] == givenNumber) {\n            printf(\"location: %d, number: %i\\n\", middle, givenNumber);\n            return middle;\n        }\n        else if (array[left] &lt; givenNumber) {\n\n            int start = 0;\n            int end = array[left];\n            int middle = start + end / 2;\n\n            return middle;\n        }\n        else if (array[right] &gt; middle) {\n\n            int start = array[right];\n            int end = size;\n            int middle = start + end / 2;\n\n            return middle;\n        }\n        else {\n            return -1;\n        }\n    } while (middle != givenNumber);\n\n    printf(\"BADRETURN givenNumber=%d\\n\", givenNumber);\n}\n\nint sorted_array[size];\n\nvoid\ntest(const char *who,int (*fnc)(int *,int))\n{\n    int i;\n    int r;\n\n    for (i = 0; i &lt; size; i++) {\n        r = fnc(sorted_array, i);\n\n        if (r != i) {\n            printf(\"ERROR -- EXPECTED: %d ACTUAL: %d (from %s)\\n\", i, r, who);\n            // break;\n        }\n    }\n}\n\nint\nmain()\n{\n\n    for (int i = 0; i &lt; size; i++) {\n        sorted_array[i] = i;\n    }\n\n    //test(\"ORIGINAL\",binary_search);\n    test(\"FIXED\",binary_fixed);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Since you're coming from <code>python</code>, here are a few points that may help with your understanding.</p>\n\n<p>Arrays are passed to functions as <em>pointers</em>, so in the function argument list, <code>int *array</code> is equivalent. Doing <code>int array[size]</code> is an advanced technique. Avoid it for now. In C, you can't do <code>array.count</code> as you can in python. So, for now, pass the count as an additional argument.</p>\n\n<p>Pointers are something that python doesn't have, so you'll have to learn about how to use them. Once you get the hang of them, they are quite powerful and can make code run quite fast.</p>\n\n<p>In C [and most languages <em>except</em> python [and php]], the default scope is <em>global</em>. It's the reverse of python. In python, unless you specify <code>global x</code>, then <code>x</code> is private to the function. In other languages, to have <code>x</code> be local to the function, you have to declare it at function scope.</p>\n\n<p>In C, <em>all</em> variables <em>must</em> be declared <em>somewhere</em>: global scope, function scope [or a block scope within a function], or as an argument. And, each declaration must specify an explicit type. There is no equivalent of javascript's declaration of <code>var x</code>. After that, <code>x</code> could be either a string or a value depending upon what you set it to: (e.g. <code>x = 23</code> or <code>x = \"abc\"</code>)</p>\n\n<p>In C, <code>x</code> must be given a type such as: <code>int x;</code> or <code>double x;</code> or <code>int *x;</code> or <code>char *x</code>.</p>\n\n<hr>\n\n<p>Here is your revised code with annotations:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// NOTE: this is hardwired\n#define size 14\n\n// NOTE: this is _global_ scope -- while not absolutely wrong, using function\n// scope below is faster/better and provides better isolation -- this doesn't\n// scale as well\nint start = 0;\nint end = size - 1;\nint middle;\nint left;\nint right;\n\n// NOTE: in C, using \"int *array\" is equivalent [and in many cases preferred]\n// NOTE: the array count should be passed in as a separate argument\nint\nbinary_search(int array[size], int givenValue)\n{\n    // NOTE: this is _function_ scope\n\n    // NOTE: this calc of middle is extraneous because it is recalculated\n    // below\n    middle = (start + end) / 2;\n    printf(\"\\nstart: %d \\nend: %d \\nmiddle: %d \\n\\n\", start, end, middle);\n\n    // NOTE/BUG: this function combines _both_ a loop implementation and a\n    // recursive implementation -- we have to pick one or the other as trying\n    // to do both messes things us -- the recursion is broken [see below]\n\n    // NOTE: this loop checks start vs end _twice_ in the loop -- it only\n    // needs to check in one place -- convert this to \"while (start &lt;= end) {\"\n    // instead of a \"do {...} while (whatever);\" loop [which is usually not\n    // as good]\n    do {\n        if (start &gt; end) {\n            printf(\"item isn't found\");\n            break;\n\n            // NOTE/BUG: this return will _never_ be executed because we\n            // break out of the loop and what is worse we'll return an\n            // unknown/undefined value because\n            return -1;\n        }\n\n        middle = (start + end) / 2;\n\n        // NOTE/BUG: these are reversed\n        left = middle - 1;\n        right = middle + 1;\n\n        if (array[middle] == givenValue) {\n            printf(\"Location: %d, Number: %d\", middle, givenValue);\n            return middle;\n            break;\n        }\n\n        // NOTE/BUG: these recursive calls do nothing because they do _not_\n        // further limit the scope and cause infinite recursion -- to make\n        // a recursive version work, start/end would need to be arguments:\n        //   return binary_search(array,givenValue,start,end)\n        // and we shouldn't loop -- the recursive calls just aren't needed\n\n        // NOTE/BUG: the tests here are broken -- they are the reverse of\n        // the correct ones\n\n        if (array[middle] &gt; givenValue) {\n            end = right;\n            return binary_search(array, givenValue);\n        }\n\n        if (array[middle] &lt; givenValue) {\n            start = left;\n            return binary_search(array, givenValue);\n        }\n\n        // NOTE/BUG: this extra test is extraneous and would be done too late\n        // if the array size was zero -- a case that isn't handled here\n    } while (start &lt;= end);\n\n    // NOTE/BUG: when we break out of the loop, we need to return _some_ value\n    // here -- this would be flagged by the compiler using the -Wall option\n}\n\nint\nmain(void)\n{\n    int array[size] = { 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 14, 24, 53, 100 };\n\n    // NOTE/BUG: the return value from main can only handle numbers 0-255\n    // better to print the return value\n    return binary_search(array, 24);\n}\n</code></pre>\n\n<hr>\n\n<p>Here is a working version of your revised code.</p>\n\n<p>The loop is now a simple <code>while</code>. The function takes a <em>separate</em> count argument. It loops instead of recurses. The reversed <code>if</code> logic has been fixed. Again, a diagnostic test has been added.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint\nbinary_search(int *array, int size, int givenValue)\n{\n    // NOTE: this is _function_ scope\n    int start = 0;\n    int end = size - 1;\n    int middle;\n    int left;\n    int right;\n    int match_index;\n\n    // assume failure\n    match_index = -1;\n\n    // NOTE: this calc of middle is extraneous because it is recalculated\n    // below\n    middle = (start + end) / 2;\n    printf(\"\\nstart: %d \\nend: %d \\nmiddle: %d \\n\\n\", start, end, middle);\n\n    while (start &lt;= end) {\n        middle = (start + end) / 2;\n        left = middle - 1;\n        right = middle + 1;\n\n        if (array[middle] == givenValue) {\n            printf(\"Location: %d, Number: %d\\n\", middle, givenValue);\n            match_index = middle;\n            break;\n        }\n\n        if (array[middle] &gt; givenValue) {\n            end = left;\n        }\n\n        if (array[middle] &lt; givenValue) {\n            start = right;\n        }\n    }\n\n    if (match_index &lt; 0)\n        printf(\"match not found -- givenValue=%d\\n\",givenValue);\n\n    return match_index;\n}\n\nint\nmain(void)\n{\n    int array[] = { 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 14, 24, 53, 100 };\n    int count = sizeof(array) / sizeof(array[0]);\n    int curidx;\n    int valwant;\n    int match;\n\n    printf(\"%d\\n\",binary_search(array, count, 24));\n\n    // run diagnostic on all values\n    for (curidx = 0;  curidx &lt; count;  ++curidx) {\n        // get value to search for\n        valwant = array[curidx];\n\n        match = binary_search(array,count,valwant);\n\n        if (match != curidx) {\n            printf(\"fault: curidx=%d valwant=%d match=%d\\n\",\n                curidx,valwant,match);\n        }\n    }\n\n    // test lower range failure\n    valwant = array[0] - 1;\n    match = binary_search(array,count,valwant);\n    if (match &gt;= 0)\n        printf(\"fault: valwant=%d match=%d\\n\",valwant,match);\n\n    // test upper range failure\n    valwant = array[count - 1] + 1;\n    match = binary_search(array,count,valwant);\n    if (match &gt;= 0)\n        printf(\"fault: valwant=%d match=%d\\n\",valwant,match);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": false, "score": 0, "last_activity_date": 1532477460, "creation_date": 1532477460, "answer_id": 51509184, "question_id": 51508362, "link": "https://stackoverflow.com/questions/51508362/binary-search-implemention-mostly-code-structure-problems-aka-newbie-problems/51509184#51509184", "title": "Binary search implemention ( mostly code structure problems, aka newbie problems)", "body": "<p>A typical binary search implementation would either loop or recurse until the number is found.  The naive recursive code is something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define size 1000\n\nint binary_search(int array[size], int givenNumber, int start, int end) {\n    int middle;\n    middle = (start + end) / 2;\n\n    if (start &gt; end)\n        return -1;\n\n    if (array[middle] == givenNumber) {\n        printf(\"location: %d, number: %i\", middle, givenNumber);\n        return middle;\n    } else if (array[middle] &lt; givenNumber) {\n        return binary_search(array, givenNumber, middle + 1, end);\n    } else { // if (array[middle] &gt; givenNumber)\n        return binary_search(array, givenNumber, start, middle - 1);\n    }\n}\n\nint main() {\n    int sorted_array[size];\n    for (int i = 0; i &lt; size; i++) {\n                            sorted_array[i] = i * 2;\n    }\n    if (binary_search(sorted_array, 349, 0, size - 1) &lt; 0) {\n        printf(\"value not found\\n\");\n    }\n    if (binary_search(sorted_array, 34, 0, size - 1) &lt; 0) {\n        printf(\"value not found\\n\");\n    }\n}\n</code></pre>\n\n<p>Notice in the recursion we call binary_search each time with a new start and end range based on the sorted array and the provided input in <code>givenNumber</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 8580328, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005528470794/picture?type=large", "display_name": "Hassan Abdul-Kareem", "link": "https://stackoverflow.com/users/8580328/hassan-abdul-kareem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 51509180, "answer_count": 3, "score": 0, "last_activity_date": 1532551302, "creation_date": 1532471074, "last_edit_date": 1532529340, "question_id": 51508362, "link": "https://stackoverflow.com/questions/51508362/binary-search-implemention-mostly-code-structure-problems-aka-newbie-problems", "title": "Binary search implemention ( mostly code structure problems, aka newbie problems)", "body": "<p>I have just learned my very first steps in C (I used to code in python) and as a such I'm facing great difficulty with the syntax, and as well as with binary search implementation. (I'm new to programming.) </p>\n\n<p>So here's my code: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define size 1000\n\nint binary_search(int array[size], int givenNumber) {\n  do {\n    int start = 0;\n    int end = size;\n    int middle = start + end / 2;\n    int left = size - 1;\n    int right = size + 1;\n\n    if (array[middle] == givenNumber) {\n      printf(\"location: %d, number: %i\", middle, givenNumber);\n      return middle;\n    } else if (array[left] &lt; givenNumber) {\n\n      int start = 0;\n      int end = array[left];\n      int middle = start + end / 2;\n      return middle;\n    } else if (array[right] &gt; middle) {\n\n      int start = array[right];\n      int end = size;\n      int middle = start + end / 2;\n      return middle;\n    } else {\n      return -1;\n      break;\n    }\n  }\n  } while (int middle != givenNumber)\n\nint main() {\n  int sorted_array[size];\n  for (int i = 0; i &lt; size; i++) {\n    sorted_array[i] = i;\n  }\n  return binary_search(sorted_array, 349);\n}\n</code></pre>\n\n<p>My problems are:</p>\n\n<p>1 - when compiling, the error is something along the lines of \"in while block \"middle\" isn't defined\" </p>\n\n<p>I have no clue on why the value isn't passing from the do block to the while block. Note that I added \"return middle\" to each if / else-if block, as I I thought it <strong>may</strong> help.</p>\n\n<p>2- I'm not even quite sure if my <strong>own</strong> implementation of this binary search is correct. I have looked up how to implement it but I found it next to impossible to read the syntax, this is just to give a heads up.</p>\n\n<p><strong>UPDATE</strong>:\nI have reconstructed the whole code according to the notes users have given in the answers below, and well, my algorithm is working and now it could find any number in any given array, however I'm unable to figure out a way to tell if the array doesn't have that <code>givenNumber</code> as it would get eventually stuck.</p>\n\n<p>Here's an input/output:\n<code>int array[size] = {1,2,3,4,5,6,8,9,10,11,14,24,53,100};</code></p>\n\n<p>function:  <code>binary_search(array, 24);</code></p>\n\n<p>output: <code>Location: 11, Number: 24</code></p>\n\n<p>Which is pretty good, however if I enter a number which doesn't exist in the array, the loop continues to search endlessly (gets stuck in recursion)</p>\n\n<pre><code>here's the updated code:\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define size 14\nint start = 0;\nint end = size -1;\nint middle;\nint left;\nint right;\nint binary_search(int array[size], int givenValue)\n{\n\n    middle = (start + end) / 2;\n    printf(\"\\nstart: %d \\nend: %d \\nmiddle: %d \\n\\n\",start, end, middle);\n\n    do\n    {\n        if (start &gt; end)\n        {\n            printf(\"item isn't found\");\n            break;\n            return -1;\n        }\n        middle = (start+end)/2;\n        left =  middle -1;\n        right = middle +1;\n        if (array[middle] ==  givenValue)\n        {\n            printf(\"Location: %d, Number: %d\", middle, givenValue);\n            return middle;\n            break;\n        }\n        if(array[middle] &gt; givenValue)\n        {\n            end = right;\n            return binary_search(array, givenValue);\n        }\n        if(array[middle] &lt; givenValue)\n        {\n            start = left;\n            return binary_search(array, givenValue);\n        }\n\n    }\n    while (start &lt;= end);\n}\n\nint main(void)\n{\n    int array[size] = {1,2,3,4,5,6,8,9,10,11,14,24,53,100};\n    return binary_search(array, 24);\n}\n</code></pre>\n\n<p>My condition is that if <code>start</code> is greater than <code>end</code> then the item doesn't exist, and it doesn't work at all because <code>left/right</code> keeps getting stuck at the same values (Run the code to know what I mean)</p>\n\n<p>How do I fix this issue?</p>\n"}, {"tags": ["c", "build", "automation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532468593, "post_id": 51507939, "comment_id": 89984968, "body": "Deployment of what? Changes in what?"}, {"owner": {"reputation": 15, "user_id": 7116024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f62584a62f95751b2f5ed75f50331c?s=128&d=identicon&r=PG&f=1", "display_name": "HelplessInterns", "link": "https://stackoverflow.com/users/7116024/helplessinterns"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532468699, "post_id": 51507939, "comment_id": 89985017, "body": "C executable(s), config file changes etc."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532468789, "post_id": 51507939, "comment_id": 89985054, "body": "Executables are not C, they are binary. This is not related to C unless you are interested in compiling the executable on each target machine. Which doesn&#39;t make much sense if these have the same architecture and OS."}, {"owner": {"reputation": 15, "user_id": 7116024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f62584a62f95751b2f5ed75f50331c?s=128&d=identicon&r=PG&f=1", "display_name": "HelplessInterns", "link": "https://stackoverflow.com/users/7116024/helplessinterns"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532469105, "post_id": 51507939, "comment_id": 89985158, "body": "I understand that. I am really looking for a good way to push out the executable, make config changes and bring up and down the application on each machine easily.. Something like Jenkins"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1532469301, "post_id": 51507939, "comment_id": 89985224, "body": "Can you make SSH connections to the servers?  If you can, I&#39;d set up an update account (same specs on each; same uid and gid on all servers), so that some central machines can SSH to that account on each using keys only, then automate the updates using shell scripts that &quot;push&quot; the changes. Use one virtual machine for testing; virtual machine so that you can revert the pushed changes, and retry until it works without issues. Always test pushes on the virtual machine first."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1532470918, "post_id": 51507939, "comment_id": 89985665, "body": "If you are familiar with and like Jenkins, why don&#39;t you use it?"}, {"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "edited": false, "score": 0, "creation_date": 1532499193, "post_id": 51507939, "comment_id": 89992295, "body": "Jenkins have continuous integration for C/C++. Check out <a href=\"https://jenkins.io/blog/2017/07/07/jenkins-conan/\" rel=\"nofollow noreferrer\">jenkins.io/blog/2017/07/07/jenkins-conan</a>"}, {"owner": {"reputation": 15, "user_id": 7116024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f62584a62f95751b2f5ed75f50331c?s=128&d=identicon&r=PG&f=1", "display_name": "HelplessInterns", "link": "https://stackoverflow.com/users/7116024/helplessinterns"}, "reply_to_user": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1532539273, "post_id": 51507939, "comment_id": 90017761, "body": "@TonyB The current release of Jenkins is not compatible with the old version of java we have. The environment I work in is a safety critical environment (scada control for large power lines) so we can&#39;t install new software easily."}], "owner": {"reputation": 15, "user_id": 7116024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f62584a62f95751b2f5ed75f50331c?s=128&d=identicon&r=PG&f=1", "display_name": "HelplessInterns", "link": "https://stackoverflow.com/users/7116024/helplessinterns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532468647, "creation_date": 1532468493, "last_edit_date": 1532468647, "question_id": 51507939, "link": "https://stackoverflow.com/questions/51507939/best-options-for-automated-deployments-in-a-primarily-c-based-environment", "title": "Best options for automated deployments in a primarily C based environment", "body": "<p>I am working in a Real Time SCADA environment that is primarily C and Pascal based(some KSH and C++ as well). The servers all are running AIX(about 70 servers) . Currently we manually deploy every change. What are some options for automated deployment? We also have Java 1.5 installed in our environment. </p>\n"}, {"tags": ["c", "gcc", "permissions", "executable", "system-calls"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1532467086, "post_id": 51507616, "comment_id": 89984372, "body": "It shoud be a file, not a directory."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1532467225, "post_id": 51507616, "comment_id": 89984419, "body": "The compiler automatically sets execute permissions when it&#39;s creating the executable file. It probably does it with the third argument to <code>open()</code>, so I suspect you&#39;re not implementing that properly."}, {"owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467414, "post_id": 51507616, "comment_id": 89984504, "body": "@Barmar sorry my mistake. I meant file :X"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1532467517, "post_id": 51507616, "comment_id": 89984548, "body": "The compiler (actually the linker) probably does <code>open(outputfile, O_CREAT|O_WRONLY, 0555)</code> so that the file should get read and execute permissions. Make sure you implement this correctly."}, {"owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467546, "post_id": 51507616, "comment_id": 89984557, "body": "@Barmar I printed creation permissions and it appears to be 33204 <code>printf(&quot;permissions: %s %d\\n&quot;, path, mode);</code>; regular file with 204 permission right? And why is that way?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467583, "post_id": 51507616, "comment_id": 89984572, "body": "You should print permissions in octal so it&#39;s understandable."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467674, "post_id": 51507616, "comment_id": 89984604, "body": "Actually, it probably uses <code>0555</code>, and relies on <code>umask</code> to remove the group and world write permissions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467719, "post_id": 51507616, "comment_id": 89984627, "body": "<code>33204</code> is <code>0100664</code>"}, {"owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467735, "post_id": 51507616, "comment_id": 89984634, "body": "100664 in octal mode; But still why exe permissions are not set? (I printed this on the first line of <code>create</code> syscall)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467767, "post_id": 51507616, "comment_id": 89984652, "body": "Maybe it creates it without execute permissions, then calls <code>chmod()</code> when it&#39;s done."}, {"owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532467845, "post_id": 51507616, "comment_id": 89984682, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/176677/discussion-between-data-chanturia-and-barmar\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "is_accepted": true, "score": 0, "last_activity_date": 1532469327, "creation_date": 1532469327, "answer_id": 51508071, "question_id": 51507616, "link": "https://stackoverflow.com/questions/51507616/net-raid-fs-with-fuse-gcc-hello-c-o-a-out-a-out-is-not-executable/51508071#51508071", "title": "Net raid FS with FUSE, gcc -hello.c -o a.out, a.out is not executable", "body": "<p>I lacked <code>chmod</code> syscall implementation. <code>chmod</code> makes it work all right. Thanks @Barmar for help!</p>\n"}], "owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 51508071, "answer_count": 1, "score": 1, "last_activity_date": 1532469327, "creation_date": 1532466800, "last_edit_date": 1532467376, "question_id": 51507616, "link": "https://stackoverflow.com/questions/51507616/net-raid-fs-with-fuse-gcc-hello-c-o-a-out-a-out-is-not-executable", "title": "Net raid FS with FUSE, gcc -hello.c -o a.out, a.out is not executable", "body": "<p>I'm writing net raid FS with FUSE on ubuntu. Here are syscalls I've implemented: <code>create</code> <code>open</code> <code>read</code> <code>write</code> <code>release</code> <code>unlink</code> <code>mkdir</code> <code>opendir</code> <code>readdir</code> <code>releasedir</code> <code>rmdir</code> <code>getattr</code> and <code>rename</code>.</p>\n\n<p>Everything works fine, but here is such case: I wrote \"hello world\" in c and tried typing this: <code>gcc hello.c -o a.out</code>. <code>a.out</code> is fine, but it's just a file, not executable (When I set manually 0777 permissions it executes fine on <code>./a.out</code>).</p>\n\n<p>When permissions must be set, and how? And when compiling, how to know which files should be set exe permissions? Based on what?</p>\n"}, {"tags": ["c", "memory", "malloc", "free"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1532464859, "post_id": 51507181, "comment_id": 89983464, "body": "I believe they wanted to hear the key phrase &quot;memory fragmentation&quot;."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1532465016, "post_id": 51507181, "comment_id": 89983540, "body": "I&#39;m guessing that&#39;s what they wanted to hear, too, but depending on the program&#39;s malloc/free pattern, it might not have that problem at all. (I&#39;m also not at all sure how the answer changes if the &quot;memory heap&quot; is &quot;very large&quot;.)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532465253, "post_id": 51507181, "comment_id": 89983638, "body": "@SteveSummit It might be even completely wrong if we assume different <code>malloc&#47;free</code> implementations. For instance FreeRTOS have 3 different implementations in the box, one of these have <code>free</code> doing nothing. So the correct answer would be - we will run out of memory very fast."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1532465872, "post_id": 51507181, "comment_id": 89983895, "body": "Interesting what is the meaning of &quot;very large&quot;"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1532465931, "post_id": 51507181, "comment_id": 89983927, "body": "If you have a very large memory heap, you may be able to perform memory block <code>coalescing</code> when memory is returned to the free list.  You could also do this is the heap is small, but intuitively, I think that it is more likely to be successful with a larger heap."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1532466044, "post_id": 51507181, "comment_id": 89983976, "body": "@EugeneSh.with the larger heap, I am just guessing that the frees are more likely to return adjacent memory locks.  I&#39;m just guessing though."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1532466616, "post_id": 51507181, "comment_id": 89984191, "body": "@bruceg <code>void free(void *memblock);</code> does not return a value."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1532467020, "post_id": 51507181, "comment_id": 89984346, "body": "@WeatherVane that&#39;s true. When free is called, the underlying memory management system may be able to coalesce adjacent blocks in the free list.  There is no action required by the caller."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1532467104, "post_id": 51507181, "comment_id": 89984381, "body": "You might also want to read about <code>jemalloc</code>: <a href=\"https://www.facebook.com/notes/facebook-engineering/scalable-memory-allocation-using-jemalloc/480222803919/\" rel=\"nofollow noreferrer\">facebook.com/notes/facebook-engineering/&hellip;</a>"}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1532468381, "post_id": 51507181, "comment_id": 89984887, "body": "You could always have your own malloc/free which uses something like the buddy algorithm (<a href=\"https://en.wikipedia.org/wiki/Buddy_memory_allocation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Buddy_memory_allocation</a>).  Not very efficient in terms of memory usage but great for excessive processing of free lists etc."}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "is_accepted": false, "score": 6, "last_activity_date": 1532464915, "creation_date": 1532464915, "answer_id": 51507215, "question_id": 51507181, "link": "https://stackoverflow.com/questions/51507181/result-of-using-millions-of-mallocs-and-frees-in-your-c-code/51507215#51507215", "title": "Result of using millions of malloc()s and free()s in your C code?", "body": "<p>One thing that may happen is that your memory will be fragmented, especially if you allocate block of different sizes.</p>\n\n<p>Thus, if your memory size is not large, some malloc may fail, even if the total free memory is bigger that requested.</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 6776901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a498de335f405787866f5020cdf558c8?s=128&d=identicon&r=PG&f=1", "display_name": "Batwoman05", "link": "https://stackoverflow.com/users/6776901/batwoman05"}, "edited": false, "score": 0, "creation_date": 1532538174, "post_id": 51523794, "comment_id": 90017212, "body": "After reading all comments - I&#39;m pretty sure the recruiter wanted to hear &quot;memory fragmentation&quot; in my response."}], "tags": [], "owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "is_accepted": false, "score": 0, "last_activity_date": 1532536482, "creation_date": 1532536482, "answer_id": 51523794, "question_id": 51507181, "link": "https://stackoverflow.com/questions/51507181/result-of-using-millions-of-mallocs-and-frees-in-your-c-code/51523794#51523794", "title": "Result of using millions of malloc()s and free()s in your C code?", "body": "<p>This is really a stupid question without more qualifiers. Suppose you do</p>\n\n<pre><code> for (;;)\n {\n    free (malloc(SOMEVALUE)) ;\n }\n</code></pre>\n\n<p>In that case very little is going to happen. </p>\n\n<p>Let's assume that mallocs and frees occur in a random order. If you have an malloc implementation that uses fixed sized blocks, you are going to get a different result than if you use one with variable sized blocks (=memory fragmentation). </p>\n\n<p>The result you get is entirely dependent upon the malloc implementation and the sequence of the calls to malloc and free.</p>\n"}], "owner": {"reputation": 185, "user_id": 6776901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a498de335f405787866f5020cdf558c8?s=128&d=identicon&r=PG&f=1", "display_name": "Batwoman05", "link": "https://stackoverflow.com/users/6776901/batwoman05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1532536482, "creation_date": 1532464762, "last_edit_date": 1532466071, "question_id": 51507181, "link": "https://stackoverflow.com/questions/51507181/result-of-using-millions-of-mallocs-and-frees-in-your-c-code", "title": "Result of using millions of malloc()s and free()s in your C code?", "body": "<p>I was recently asked this question in an interview. </p>\n\n<p>Suppose there is a large library of <strong>C</strong> programs and each program constantly <code>malloc()</code>s and <code>free()</code>s blocks of data. What do you think will happen if there are a million calls to <code>malloc()</code> and <code>free()</code> in one run of your program. What will you add to your answer if you have been given a very large memory heap storage?</p>\n"}, {"tags": ["python", "c", "opencl", "pyopencl"], "comments": [{"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1532512354, "post_id": 51506971, "comment_id": 90000190, "body": "I&#39;m not familiar with pyopencl, so if it&#39;s a problem with the way you call into that I&#39;m afraid I can&#39;t help you. One thing I will say is that OpenCL 1.0 implementations by default do not support bytewise writes (e.g. char/uchar) to global memory, unless they support the <a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/cl_khr_byte_addressable_store.html\" rel=\"nofollow noreferrer\">cl_khr_byte_addressable_store</a> extension, <i>and it is enabled</i>. Nowadays, you&#39;re probably on a newer version than 1.0, but I suggest checking and making sure just in case."}, {"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1532512477, "post_id": 51506971, "comment_id": 90000292, "body": "Another suggestion: make sure you check the return values for all OpenCL calls, including the kernel enqueueing call. I would not be surprised if the error happened earlier than where it&#39;s currently crashing."}, {"owner": {"reputation": 763, "user_id": 6419581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tmJu.png?s=128&g=1", "display_name": "Gakuo", "link": "https://stackoverflow.com/users/6419581/gakuo"}, "reply_to_user": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1532531564, "post_id": 51506971, "comment_id": 90013554, "body": "Further tests result in the behaviour shown above. Some indices of the char array inputs to the kernel are inaccessible. They return null. Which most likely explain the failure."}, {"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1532534029, "post_id": 51506971, "comment_id": 90015137, "body": "Have you checked the OpenCL version and byte addressable situation? This sounds like it might be the problem"}], "owner": {"reputation": 763, "user_id": 6419581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tmJu.png?s=128&g=1", "display_name": "Gakuo", "link": "https://stackoverflow.com/users/6419581/gakuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532531403, "creation_date": 1532463849, "last_edit_date": 1532531403, "question_id": 51506971, "link": "https://stackoverflow.com/questions/51506971/string-operations-on-opencl", "title": "String operations on OpenCL", "body": "<p><strong>EDIT</strong></p>\n\n<p>I did some tests on the char array inputs to the kernel. I noticed a rather odd behaviour: consider the Kernel program and accompanying PyOpenCL code:</p>\n\n<pre><code>#!/usr/bin/env python3\n\nimport pyopencl as cl\nimport numpy as np\nimport seq\n\n# Write down our kernel as a multiline string.\nkernel = \"\"\"\n__kernel void dragon(\n    const int N,\n    __global char *AplusB,   \n    __global char *AminusB,\n    __global char *plusMinus,   \n    __global char *minusMinus,\n    __global char *output\n    )\n{   \n    int idx = get_global_id(0);\n\n    if (idx &lt; N){\n        char b =AplusB[12];\n                     printf(\"\\\\ %c \\\\n\",b);\n\n    }\n\n}\n\"\"\"\n#declare constants\nnumber_of_expansions = 4\ntotal_probelem_size =7\nresulting_str_size=62\n\n# Step 1: Create a context.\n# This will ask the user to select the device to be used.\ncontext = cl.create_some_context()\n# Create a queue to the device.\nqueue = cl.CommandQueue(context)\n# Create the program.\nprogram = cl.Program(context, kernel).build()\n# Create the input string\nAplusB =np.array(('FX+YF++-FX-YF+'))\nAminusB= np.array(('FX+YF+--FX-YF+'))\nplusMinus= np.array(('+-'))\nminusMinus = np.array(('--'))\n\n# Send the data to the guest memory.\nmf = cl.mem_flags\nAplusBBuf = cl.Buffer(context, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=AplusB)\nAminusBBuf= cl.Buffer(context, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=AminusB)\nplusMinusBuf = cl.Buffer(context, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=plusMinus)\nminusMinusBuf = cl.Buffer(context, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=minusMinus)\n\n# Create the memory on the device to put the result into.\nout_buf = cl.Buffer(context, mf.WRITE_ONLY, size=resulting_str_size) \ncopied_str = np.zeros(resulting_str_size)\n# Initiate the kernel.\ndragon = program.dragon\ndragon.set_scalar_arg_dtypes([np.int32, None, None,None,None,None])\n\nglobal_work_size = total_probelem_size\n# Execute C = A * B.\ndragon(queue, (global_work_size,), None,total_probelem_size,AplusBBuf, AminusBBuf,plusMinusBuf,minusMinusBuf,out_buf)\n# Wait for the queue to be completely processed.\nqueue.finish()\n# Read the array from the device.\ncl.enqueue_copy(queue, copied_str, out_buf).wait()\nprint (copied_str)\n\n\"https://stackoverflow.com/questions/17603740/how-to-pass-a-list-of-strings-to-an-opencl-kernel-using-pyopencl\"\n</code></pre>\n\n<p>Notice that in the kernel I try to print out characters inside the buffer <code>AplusB</code>. It appears I can only print out characters at indices 0, 4, 8,and 12. <code>AplusB</code>is of size 14. What could be the explanation of this behavior.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1532464031, "post_id": 51506968, "comment_id": 89983051, "body": "<code>int intergralPart = (int)num; float decimalPart = num - integralPart</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1532464057, "post_id": 51506968, "comment_id": 89983067, "body": "Show a <a href=\"https://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>. The number you are passing to <code>modf</code> is not 59. It is slightly under 59 but appears as 59 when printed with a limited number of digits. Then <code>modf</code> properly separates the number into 58 and a number slightly under 1. The latter appears as 1 when printed with a limited number of digits."}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1532464281, "post_id": 51506968, "comment_id": 89983205, "body": "Are you performing any arithmetic on <code>lat_seconds</code> in your actual code? If so, then the link i commented above is applicable."}, {"owner": {"reputation": 33, "user_id": 10023119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjXRTsaJVlE/AAAAAAAAAAI/AAAAAAAAFcA/GCH529Tw0jQ/photo.jpg?sz=128", "display_name": "SoraPro", "link": "https://stackoverflow.com/users/10023119/sorapro"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532464623, "post_id": 51506968, "comment_id": 89983366, "body": "@EricPostpischil My apologies, looks like for the time being pm100 has taken care of that for me."}, {"owner": {"reputation": 33, "user_id": 10023119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjXRTsaJVlE/AAAAAAAAAAI/AAAAAAAAFcA/GCH529Tw0jQ/photo.jpg?sz=128", "display_name": "SoraPro", "link": "https://stackoverflow.com/users/10023119/sorapro"}, "reply_to_user": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1532464684, "post_id": 51506968, "comment_id": 89983389, "body": "@BenJones I&#39;m not performing arithmetic. I simply need to take the integer value then convert it to a string."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1532464756, "post_id": 51506968, "comment_id": 89983419, "body": "@TeddyF: What is the output if you replace <code>%f</code> with <code>%.24f</code>? (It prints the value using 24 decimals.)"}, {"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1532464869, "post_id": 51506968, "comment_id": 89983472, "body": "That&#39;s odd, this is clearly a floating point precision error, but for assignment of integer value, I would not expect error."}, {"owner": {"reputation": 33, "user_id": 10023119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjXRTsaJVlE/AAAAAAAAAAI/AAAAAAAAFcA/GCH529Tw0jQ/photo.jpg?sz=128", "display_name": "SoraPro", "link": "https://stackoverflow.com/users/10023119/sorapro"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1532464998, "post_id": 51506968, "comment_id": 89983533, "body": "@NominalAnimal   tmp_intpart = 58.000000000000000000000000  tmp_fracpart=0.999999999983856469043531"}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1532468024, "post_id": 51507360, "comment_id": 89984740, "body": "is there a reason <code>fractional</code> is an integer type?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 0, "creation_date": 1532469685, "post_id": 51507360, "comment_id": 89985330, "body": "I think OP wanted it, but maybe I did not read the question carefully. Otherwise I do not see any problems."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1532465533, "creation_date": 1532465533, "answer_id": 51507360, "question_id": 51506968, "link": "https://stackoverflow.com/questions/51506968/how-can-i-extract-the-integer-and-the-fractional-part-of-a-double-in-c-when-the/51507360#51507360", "title": "How can I extract the integer and the fractional part of a double in C when the fractional part is 0?", "body": "<p>A bit limited one.</p>\n\n<p>ndigits- how many fractional digits\nr - to round or not to round</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid split(double number, int *intpart, unsigned *fractional, int ndigits, int r)\n{\n    long long longnum;\n    long mult = 1;\n\n    for(int x = 0; x &lt; ndigits; x++)\n    {\n        mult *= 10;\n    }\n\n    longnum = (long long)(r ? round(number * mult) : number * mult);\n\n    *intpart = longnum / mult;\n    *fractional = abs(longnum) % mult;\n}\n\n\nint main(void) {\n    double x = 5678.67897;\n    int i;\n    unsigned f;\n\n    split(x, &amp;i, &amp;f, 3, 1);\n    printf(\"x = %f, i = %d, f = %u\\n\", x, i, f);\n    split(x, &amp;i, &amp;f, 3, 0);\n    printf(\"x = %f, i = %d, f = %u\\n\", x, i, f);\n    return 0;\n}\n</code></pre>\n\n<p>and the result:</p>\n\n<pre><code>x = 5678.678970, i = 5678, f = 679\nx = 5678.678970, i = 5678, f = 678\n</code></pre>\n\n<p>Test yourself : <a href=\"https://ideone.com/XMYdGO\" rel=\"nofollow noreferrer\">https://ideone.com/XMYdGO</a></p>\n"}], "owner": {"reputation": 33, "user_id": 10023119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjXRTsaJVlE/AAAAAAAAAAI/AAAAAAAAFcA/GCH529Tw0jQ/photo.jpg?sz=128", "display_name": "SoraPro", "link": "https://stackoverflow.com/users/10023119/sorapro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "closed_date": 1532467848, "answer_count": 1, "score": -1, "last_activity_date": 1532465533, "creation_date": 1532463841, "last_edit_date": 1532464188, "question_id": 51506968, "link": "https://stackoverflow.com/questions/51506968/how-can-i-extract-the-integer-and-the-fractional-part-of-a-double-in-c-when-the", "closed_reason": "Duplicate", "title": "How can I extract the integer and the fractional part of a double in C when the fractional part is 0?", "body": "<p>For example, I have a double 59.00</p>\n\n<p>I want to store 59 in one variable and 0 in another.</p>\n\n<p>I tried using modf like so:</p>\n\n<pre><code>double lat_seconds, intpart, fracpart;  \nlat_seconds = 59.000000;     \n\nfracpart = modf(lat_seconds, &amp;intpart);\n</code></pre>\n\n<p>But when I print out the results I get:</p>\n\n<pre><code>  printf(\"intpart=%f\\n\", intpart); \\\\ intpart=58.000000\n  printf(\"fracpart=%f\\n\", fracpart); \\\\fracpart=1.000000\n</code></pre>\n\n<p>I assume modf produces a result of 1.00 when the decimal is equal to 0 but why am I getting an integral of 58.00 as opposed to 59.00 and what adjustments need to be made to get the desired result? </p>\n"}, {"tags": ["c", "data-structures", "queue", "heap"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532461388, "post_id": 51506395, "comment_id": 89981782, "body": "So what is the &quot;right most node in the last level&quot; in this image?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1532461774, "post_id": 51506395, "comment_id": 89981971, "body": "If you use the array representation for a binary heap (for the example, <code>{ 10, 14, 19, 26, 31, 42, 27, 44, 35, 33 }</code>), the rightmost element in the deepest level (33 in the example) is the last element in the array. So, if array <code>A[]</code> has <code>N</code> binary heap elements, the rightmost element in the deepest level is <code>A[N-1]</code>."}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532461818, "post_id": 51506395, "comment_id": 89981994, "body": "@EugeneSh. 33 is the last one"}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1532462005, "post_id": 51506395, "comment_id": 89982096, "body": "@NominalAnimal I am creating heap just like BST (but with the logic that it will always tend to completion level by level) &amp; in Queue used for BFS I am storing the addresses of the nodes."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1532462209, "post_id": 51506395, "comment_id": 89982192, "body": "Using an array of pointers to the nodes to represent the heap (so no pointers in the nodes themselves) ought to be simpler/more robust to implement. Is there a deeper reason for using a tree structure here?"}, {"owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1532462298, "post_id": 51506395, "comment_id": 89982237, "body": "@NominalAnimal Just want to make things dynamically - no prior knowledge of no. of nodes."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1532462683, "post_id": 51506395, "comment_id": 89982425, "body": "No need to. Because the pointers in the array point to nodes (and not to array entries), the array itself can be reallocated as needed. Do you want an &quot;answer&quot; -- extended comment, really! -- showing an example of such?"}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1532463897, "post_id": 51506395, "comment_id": 89982983, "body": "You could have an algorithm that keeps track of depth as you go, visiting the leftmost node fist and keeping track of deepest updating deepest if you reach a node with equal or greater depth. Visiting the leftmost nodes first will ensure that you get 33 in the end. Alternatively you could go rightmost first and update the node only if the depth is greater"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1532490591, "post_id": 51506395, "comment_id": 89989771, "body": "possible duplicate of <a href=\"https://stackoverflow.com/q/40586802/56778\">stackoverflow.com/q/40586802/56778</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 3, "last_activity_date": 1532482641, "last_edit_date": 1532482641, "creation_date": 1532480737, "answer_id": 51509500, "question_id": 51506395, "link": "https://stackoverflow.com/questions/51506395/how-can-one-find-the-last-right-most-node-on-the-last-level-of-tree-which-is-a/51509500#51509500", "title": "How can one find the last (right most) node on the last level of tree which is a heap (almost complete tree)?", "body": "<p>Let's look at a complete binary tree, ignoring the values stored at the nodes, but numbering the nodes <a href=\"https://en.wikipedia.org/wiki/Binary_heap#Heap_implementation\" rel=\"nofollow noreferrer\">as if they were stored in an array</a>, starting the numbering from 1 at the root:\n<img src=\"https://www.nominal-animal.net/answers/tree-heap.svg\" alt=\"Binary heap tree\">\nIf we traverse from root to any target node (except root itself), with left edges (red) 0, and right edges (blue) 1, we see a pattern:</p>\n\n<pre><code>Path     Edges   Target (binary)\n\u2500\u2500\u2500\u2500\u2500    \u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n1 \u2192 2    0       1 0\n1 \u2192 3    1       1 1\n1 \u2192 4    0 0     1 0 0\n1 \u2192 5    0 1     1 0 1\n1 \u2192 6    1 0     1 1 0\n1 \u2192 7    1 1     1 1 1\n1 \u2192 8    0 0 0   1 0 0 0\n1 \u2192 9    0 0 1   1 0 0 1\n1 \u2192 10   0 1 0   1 0 1 0\n1 \u2192 11   0 1 1   1 0 1 1\n1 \u2192 12   1 0 0   1 1 0 0\n1 \u2192 13   1 0 1   1 1 0 1\n1 \u2192 14   1 1 0   1 1 1 0\n1 \u2192 15   1 1 1   1 1 1 1\n</code></pre>\n\n<p>The path from root to the desired node is the same as the binary representation of the number of that node (root being 1), ignoring the most significant binary digit!</p>\n\n<p>So, in a complete tree, to reach the <code>K</code>'th node, with root being 1, we first find the largest power of two smaller than <code>K</code>, and traverse according to the binary digits below that, in descending order, with zero indicating left, and one right.</p>\n\n<p>Let's say our node structures are something like</p>\n\n<pre><code>typedef  struct node  node;\nstruct node {\n    struct node  *left;\n    struct node  *right;\n    /* plus node data fields */\n};\n</code></pre>\n\n<p>then finding the <code>i</code>th node, <code>i = 1</code> for root, can be implemented as</p>\n\n<pre><code>node *ith_node(node *root, const size_t i)\n{\n    size_t  b = i; \n\n    /* Sanity check: If no tree, always return NULL. */\n    if (!root || i &lt; 1)\n        return NULL;\n\n    /* If i is 1, we return the root. */\n    if (i == 1)\n        return root;\n\n    /* Set b to the value of the most significant binary digit\n       set in b. This is a known trick. */\n    while (b &amp; (b - 1))\n        b &amp;= b - 1;        \n\n    /* We ignore that highest binary digit. */\n    b &gt;&gt;= 1;\n\n    /* Walk down the tree as directed by b. */\n    while (b) {\n        if (i &amp; b) {\n            if (root-&gt;right)\n                root = root-&gt;right;\n            else\n                return NULL; /* Not a complete tree, or outside the tree. */\n        } else {\n            if (root-&gt;left)\n                root = root-&gt;left;\n            else\n                return NULL; /* Not a complete tree, or outside the tree. */\n        }\n\n        /* Next step. */\n        b &gt;&gt;= 1;\n    }\n\n    /* This is where we arrived at. */\n    return root;\n}\n</code></pre>\n\n<p>In practice, if you have a complete binary tree with <code>N</code> nodes, <code>ith_node(root, N)</code> will return a pointer to the final node.</p>\n\n<p>If you want the path, with least significant bit being the first edge from root, you can use e.g.</p>\n\n<pre><code>/* (*path) will contain the path to ith node, root being i=1,\n   and the return value is the number of steps needed.\n   Returns -1 if an error occurs. */\nint  path_to_ith(const size_t i, size_t *path)\n{\n    size_t  b = i;\n    size_t  p = 0;\n    int     n = 0;\n\n    if (i &lt; 1)\n        return -1; /* Invalid i! */\n\n    /* Set b to the value of the most significant binary digit set. */\n    while (b &amp; (b - 1))\n        b &amp;= b - 1;        \n\n    /* Ignore most significant digit. */\n    b &gt;&gt;= 1;\n\n    /* Reverse the rest of the bits in b, into p. */\n    while (b) {\n        p = (p &lt;&lt; 1) + (b &amp; 1);\n        b &gt;&gt;= 1;\n        n++;\n    }\n\n    /* Store path. */\n    if (path)\n        *path = p;\n\n    /* Return the number of edges (bits) in path. */\n    return n;\n}\n</code></pre>\n\n<p>Note that the functions above are predicated on the tree being complete: i.e., all levels except possibly the last are filled, with last level having all leftmost nodes filled. That is, if node N using the numbering shown in the illustration above is filled, then nodes 1 to N-1 must also be filled.</p>\n\n<p>The logic in the above example works. However, because the example code is written in one sitting without proper review, there might be bugs in there. So, if you have any issues with the example code, or indeed anywhere in this answer, please let me know in a comment, so I can check and fix as necessary.</p>\n\n<hr>\n\n<p>Note that binary heaps are typically represented using an array.</p>\n\n<p>(To use proper array indexing, we switch here to zero-based indexing; i.e. from this point forward, the root is at index 0.)</p>\n\n<p>The nodes then have no pointers. To support deletion, we usually store the index to the heap array the node resides in, but otherwise the nodes have just data. (If you need to change key value, or delete entries other than the root, you usually add a data field specifying the current heap array index. It does slow things a bit, though, so it's usually not needed. I'll omit it for simplicity.)</p>\n\n<pre><code>typedef  double  heap_key;\n\ntypedef struct {\n    /* Data only! */\n} heap_data;\n\ntypedef struct {\n    heap_key   key;\n    heap_data *val;\n} reference;\n\ntypedef struct {\n    size_t     max;  /* Current max heap size, nodes */\n    size_t     len;  /* Number of nodes in this heap */\n    reference *ref;  /* Array of references to nodes */\n} heap;\n#define  HEAP_INIT { 0, 0, NULL }\n\nstatic inline void heap_init(heap *h)\n{\n    if (h) {\n        h-&gt;max = 0;\n        h-&gt;len = 0;\n        h-&gt;ref = NULL;\n    }\n}\n</code></pre>\n\n<p>Note that the reference array in <code>heap</code> is dynamically allocated/reallocated as needed, so there is no inherent limit to the size of the heap (other than memory, of course).</p>\n\n<p>The <code>HEAP_INIT</code> macro allows one to initialize a heap when declared. In other words, <code>heap h = HEAP_INIT;</code> is equivalent to <code>heap h; heap_init(&amp;h);</code>.</p>\n\n<p>To add a new element into such a heap is very straightforward:</p>\n\n<pre><code>static int heap_add(heap *h, heap_data *d, const heap_key k)\n{\n    size_t  i;\n\n    if (!h)\n        return -1; /* No heap specified. */\n\n    /* Ensure there is room for at least one more entry. */\n    if (h-&gt;len &gt;= h-&gt;max) {\n        size_t     max;\n        reference *ref;\n\n        /* Minimum size is 15 references; then double up\n           to 1966080 entries; then set next multiple of\n           1024*1024 + 1024*1024-2. */\n        if (h-&gt;len &lt; 15)\n            max = 15;\n        else\n        if (h-&gt;len &lt; 1966080)\n            max = 2 * h-&gt;len;\n        else\n            max = (h-&gt;len | 1048575) + 1048574;\n\n        ref = realloc(h-&gt;ref, max * sizeof h-&gt;ref[0]);\n        if (!ref)\n            return -2; /* Out of memory; cannot add more. */\n\n        h-&gt;max = max; \n        h-&gt;ref = ref;\n    }\n\n    i = h-&gt;len++;\n    h-&gt;ref[i].key = key;\n    h-&gt;ref[i].val = data;\n\n    /* Omitted:  Percolate 'i' towards root,\n                 keeping the heap order property for keys. */\n\n    /* if (!i) \"i is root\";\n       For all other cases, the parent is at index ((i-1)/2), and\n       if (i&amp;1) \"i is a left child, sibling is (i+1)\";\n       else     \"i is a right child, sibling is (i-1)\";\n    */\n\n    return 0;\n}\n</code></pre>\n\n<p>In the heap array, if you have <code>n</code> nodes, node at index <code>i</code> (root having index 0) has</p>\n\n<ul>\n<li><p>Parent at index <code>(i - 1)/2</code> if and only if <code>i &gt; 0</code></p></li>\n<li><p>Left child at index <code>2*i+1</code> if and only if <code>2*i+1 &lt; n</code></p></li>\n<li><p>Right child at index <code>2*i+2</code> if and only if <code>2*i+2 &lt; n</code></p></li>\n</ul>\n\n<p>The indexes for nodes at level <code>k</code> are consecutive, from <code>(1 &lt;&lt; k) - 1</code> to <code>(2 &lt;&lt; k) - 2</code>, inclusive (when root has index 0 and level 0).</p>\n\n<p>A node with index <code>i</code> (root having index 0 and level 0) is at level <code>k</code>, is <code>floor(log2(i+1))</code> or obtained via for example the following function:</p>\n\n<pre><code>static inline size_t  ith_level(size_t  i)\n{\n    size_t  n = 0;\n    size_t  t = (i + 1) / 2;\n\n    while (t) {\n        t &gt;&gt;= 1;\n        n++;\n    }\n\n    return n;\n}\n</code></pre>\n\n<p>Again, the logic in the above example works. However, because the example code is written in one sitting without proper review, there might be bugs in there. So, if you have any issues with the example code, or indeed anywhere in this answer, please let me know in a comment, so I can check and fix as necessary.</p>\n"}], "owner": {"reputation": 869, "user_id": 8977557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9435a87062e0ef32514b0aafcfae5d20?s=128&d=identicon&r=PG&f=1", "display_name": "Agrudge Amicus", "link": "https://stackoverflow.com/users/8977557/agrudge-amicus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2550, "favorite_count": 0, "accepted_answer_id": 51509500, "answer_count": 1, "score": 0, "last_activity_date": 1532482641, "creation_date": 1532461285, "last_edit_date": 1532462409, "question_id": 51506395, "link": "https://stackoverflow.com/questions/51506395/how-can-one-find-the-last-right-most-node-on-the-last-level-of-tree-which-is-a", "title": "How can one find the last (right most) node on the last level of tree which is a heap (almost complete tree)?", "body": "<p>I was trying to find the right most node in the last level of a heap (<strong>tree representation</strong> in order to delete a particular element in a min/max heap. </p>\n\n<p>Nearly everywhere online folks have written to replace the node which is to be deleted with the rightmost node of the heap situated at the lowest level - which I understand perfectly but how can I find the last node?</p>\n\n<p><strong>Solution according to me</strong>: I have a solution which is to traverse that tree (heap structure) using level order traversal (Breadth first search) while storing the addresses of the nodes - once when there is only one element left in the Queue with no child nodes, I'll use that for replacement. Right most node in this example is <strong>33</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YnvRQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YnvRQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Is there any other method/link which I can use as using queue seems quite lengthy?</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1532459397, "post_id": 51505918, "comment_id": 89980895, "body": "<code>Square(5+2)</code> will be expanded as <code>5+2*5+2</code>, which is 17 (BODMAS rule)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 3, "creation_date": 1532459691, "post_id": 51505918, "comment_id": 89981023, "body": "I can&#39;t believe there is no duplicate!"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532461793, "post_id": 51505918, "comment_id": 89981979, "body": "Of course there is..."}], "answers": [{"comments": [{"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459633, "post_id": 51505959, "comment_id": 89980990, "body": "To be more precise, according to you define, it will expand to ((5+2)*(5+2)) :)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459684, "post_id": 51505959, "comment_id": 89981018, "body": "@jaudo Correct.  Edited."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1532463240, "post_id": 51505959, "comment_id": 89982676, "body": "Small detail explanation: the outermost parentheses are not needed for safety of the argument(s) themselves (<code>x</code>), but to protect the resulting expression if reused in another expression; <i>bad</i> example: <code>#define X2(X) (X)+(X)</code>, used as <code>X2(2) * X2(2)</code> similarly failing (8 instead of 16) as question&#39;s original code..."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 6, "last_activity_date": 1532459670, "last_edit_date": 1532459670, "creation_date": 1532459404, "answer_id": 51505959, "question_id": 51505918, "link": "https://stackoverflow.com/questions/51505918/preprocessor-operation-with-sum-as-parameter/51505959#51505959", "title": "Preprocessor operation with sum as parameter", "body": "<p>Preprocessor macros in C do a direct symbol substitution.  So this:</p>\n\n<pre><code>Square(5+2)\n</code></pre>\n\n<p>Turns into this:</p>\n\n<pre><code>(5+2*5+2)\n</code></pre>\n\n<p>While is evaluated as:</p>\n\n<pre><code>(5+(2*5)+2)\n</code></pre>\n\n<p>Which is 17.</p>\n\n<p>You should always parenthesize macro arguments to prevent issues like this:</p>\n\n<pre><code>#define Square(x) ((x)*(x)) \n</code></pre>\n\n<p>Then the above invocation will expand to:</p>\n\n<pre><code>((5+2)*(5+2))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1532462656, "creation_date": 1532462656, "answer_id": 51506697, "question_id": 51505918, "link": "https://stackoverflow.com/questions/51505918/preprocessor-operation-with-sum-as-parameter/51506697#51506697", "title": "Preprocessor operation with sum as parameter", "body": "<p>While <a href=\"https://stackoverflow.com/users/1687119/dbush\">dbush</a> explained correct <a href=\"https://stackoverflow.com/a/51505959/1312382\">parenthesising in macros</a> already, there is a much safer alternative: inline functions:</p>\n\n<pre><code>static inline int square(int x)\n{\n    return x*x;\n}\n</code></pre>\n\n<p>It is not <em>always</em> possible to convert macros into an inline function (e. g. for logging, if you want to use <code>__FILE__</code> and <code>__LINE__</code> macros), or it is, but you have to define multiple different versions (one for int, one for double, ...), so inline functions aren't the Holy Grail either, but as arguments are evaluated <em>before</em> the function is entered, you are safe from the type of error you made and additionally, you are prevented from multiple evaluation of the argument(s) (which sometimes can even result in undefined behaviour:</p>\n\n<pre><code>int x = 7;\n// inline function:\nint y = square(x++); // safe\n// macro:\nint z = Square(x++); // expands to z = (x++)*(x++) which is undefined behaviour!\n</code></pre>\n\n<p>So if you can have inline functions without unreasonable code overhead, prefer them...</p>\n"}], "owner": {"reputation": 29, "user_id": 8145020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l1r2__K62OU/AAAAAAAAAAI/AAAAAAAAAFo/X0qXadyUYio/photo.jpg?sz=128", "display_name": "Ginel Guiu", "link": "https://stackoverflow.com/users/8145020/ginel-guiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "closed_date": 1532462851, "accepted_answer_id": 51505959, "answer_count": 2, "score": 0, "last_activity_date": 1532462656, "creation_date": 1532459257, "last_edit_date": 1532459335, "question_id": 51505918, "link": "https://stackoverflow.com/questions/51505918/preprocessor-operation-with-sum-as-parameter", "closed_reason": "Duplicate", "title": "Preprocessor operation with sum as parameter", "body": "<p>Right, so I'm trying to understand C preprocessor and man it is a hustle.</p>\n\n<p>I have a simple </p>\n\n<pre><code>#define Square(x)(x*x) \n</code></pre>\n\n<p>and I need to find out what <code>Square(5+2)</code> returns upon calling. As a newbie in this area, I immediately thought it would show <code>49</code>, but lo and behold it came back with <code>17</code>. And for some good minutes I tried to find out how the hell could that play out like that. </p>\n\n<p>Can someone explain this to me? As comprehensive as possible would be good, since I am a bit dumb.</p>\n"}, {"tags": ["c", "ruby", "windows", "winapi", "fiddle"], "comments": [{"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459506, "post_id": 51505870, "comment_id": 89980932, "body": "Do you know what each API call returned (VirtualAlloc, VirtualProtect, ...). In particular what does CreateThread returns, and if null, what does GetLastError returns?"}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459763, "post_id": 51505870, "comment_id": 89981049, "body": "<code>VirtualAlloc</code> returns an integer, a reference to that function. <code>CreateThread</code> just spawn the pry process so I couldn&#39;t know. I&#39;ve suspected the <code>VirtualProtec</code> but if the python calls didn&#39;t need it then why would the ruby do?"}, {"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459946, "post_id": 51505870, "comment_id": 89981116, "body": "I mean, do you know what value is returned? As your code is not working, you need to test the API call return value to be sure it succeed. For example VirtualAlloc returns NULL if it fails. It has not reason to, but you should check every API call return, that&#39;s a good practice."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532460173, "post_id": 51505870, "comment_id": 89981222, "body": "In my case, <code>VirtualAlloc</code> returns its reference. so it didn&#39;t fail. And you&#39;re right, I&#39;ve to check all returns and I did. The Fiddle documentation is no mature enough and no too many useful references for it.   Note: that when I use a TCP shell it opens a TCP server but not the other functionalities (eg executing the remote commands)"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1532460337, "post_id": 51505870, "comment_id": 89981297, "body": "Do you understand the <i>&quot;shell code&quot;</i>? It doesn&#39;t appear to be fully location-independent. Moving it around in memory is thus going to fail."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "edited": false, "score": 0, "creation_date": 1532460454, "post_id": 51505870, "comment_id": 89981339, "body": "Yes I do and I tested it with the python version using the same functions and it works. Please check the first link in the references."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1532460755, "post_id": 51505870, "comment_id": 89981483, "body": "Since you understand the code, attach a debugger and single-step through it to find out, where it fails to produce the desired result."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "edited": false, "score": 0, "creation_date": 1532511675, "post_id": 51505870, "comment_id": 89999742, "body": "Of course, still it&#39;s not in the shellcode at all, it&#39;s how should I deal with the Windows APIs using Fiddle in Ruby."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532636255, "post_id": 51505870, "comment_id": 90061516, "body": "@jaudo I tried to use <code>GetLastError</code>, it returns <code>0</code> always after each function."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1532998146, "post_id": 51505870, "comment_id": 90173890, "body": "Just for my own curiosity if you would be willing to answer, but why not just invoke the functions? Why all this need for binary strings and virtual memory, etc? To be honest, this looks like it is intended either for A) evil things, or B) trying to obfuscate code, which is rather silly to use Ruby in the first place if that is the intention."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1533151293, "post_id": 51505870, "comment_id": 90246103, "body": "@ForeverZer0 The invoking the APIs takes time and efforts each time I want to do farther tasks. Further tasks (shellcode) are generated using bigger frameworks like Metasploit and others.  Regarding the why doing it in ruby, it&#39;s for Red Teaming porpuses and not evil.  The idea is to run a shellcode in memory without touching the desk in the first place. Again this is for PT/RT purposes no evil in it. And I&#39;m asking how to buffer a shellcode, create a thread that executes the code regardless the shellcode contents.   Thanks for asking to make that clear"}], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "is_accepted": true, "score": 0, "last_activity_date": 1537196988, "last_edit_date": 1537196988, "creation_date": 1533586391, "answer_id": 51714973, "question_id": 51505870, "link": "https://stackoverflow.com/questions/51505870/how-to-use-fiddle-with-windows-api-dll-to-run-a-shellcode-in-ruby/51714973#51714973", "title": "How to use Fiddle with Windows API (dll) to run a shellcode in Ruby", "body": "<p>Well, I think this code works perfectly</p>\n\n<pre><code>require 'fiddle'\nrequire 'fiddle/import'\nrequire 'fiddle/types'\n\n# MessageBoxA\nshellcode =\n    \"\\xd9\\xeb\\x9b\\xd9\\x74\\x24\\xf4\\x31\\xd2\\xb2\\x77\\x31\\xc9\\x64\" +\n    \"\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x46\\x08\\x8b\\x7e\" +\n    \"\\x20\\x8b\\x36\\x38\\x4f\\x18\\x75\\xf3\\x59\\x01\\xd1\\xff\\xe1\\x60\" +\n    \"\\x8b\\x6c\\x24\\x24\\x8b\\x45\\x3c\\x8b\\x54\\x28\\x78\\x01\\xea\\x8b\" +\n    \"\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3\\x34\\x49\\x8b\\x34\\x8b\\x01\" +\n    \"\\xee\\x31\\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1\\xcf\\x0d\" +\n    \"\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\\x75\\xe1\\x8b\\x5a\\x24\\x01\" +\n    \"\\xeb\\x66\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\" +\n    \"\\xe8\\x89\\x44\\x24\\x1c\\x61\\xc3\\xb2\\x08\\x29\\xd4\\x89\\xe5\\x89\" +\n    \"\\xc2\\x68\\x8e\\x4e\\x0e\\xec\\x52\\xe8\\x9f\\xff\\xff\\xff\\x89\\x45\" +\n    \"\\x04\\xbb\\x7e\\xd8\\xe2\\x73\\x87\\x1c\\x24\\x52\\xe8\\x8e\\xff\\xff\" +\n    \"\\xff\\x89\\x45\\x08\\x68\\x6c\\x6c\\x20\\x41\\x68\\x33\\x32\\x2e\\x64\" +\n    \"\\x68\\x75\\x73\\x65\\x72\\x30\\xdb\\x88\\x5c\\x24\\x0a\\x89\\xe6\\x56\" +\n    \"\\xff\\x55\\x04\\x89\\xc2\\x50\\xbb\\xa8\\xa2\\x4d\\xbc\\x87\\x1c\\x24\" +\n    \"\\x52\\xe8\\x5f\\xff\\xff\\xff\\x68\\x6f\\x78\\x58\\x20\\x68\\x61\\x67\" +\n    \"\\x65\\x42\\x68\\x4d\\x65\\x73\\x73\\x31\\xdb\\x88\\x5c\\x24\\x0a\\x89\" +\n    \"\\xe3\\x68\\x52\\x49\\x58\\x20\\x68\\x47\\x53\\x41\\x42\\x68\\x40\\x4b\" +\n    \"\\x49\\x4e\\x31\\xc9\\x88\\x4c\\x24\\x0a\\x89\\xe1\\x31\\xd2\\x52\\x53\" +\n    \"\\x51\\x52\\xff\\xd0\\x31\\xc0\\x50\\xff\\x55\\x08\"\n\n\ninclude Fiddle\n\nkernel32 = Fiddle.dlopen('kernel32')\n\nputs \"[-] VirtualAlloc\"\nptr = Function.new(kernel32['VirtualAlloc'], [4,4,4,4], 4).call(0, (shellcode.size), 0x3000, 0x40)\nFunction.new(kernel32['VirtualProtect'], [4,4,4,4], 4).call(ptr, shellcode.size, 0, 0)\n\nputs \"[-] Create buffer\"\nbuf = Fiddle::Pointer[shellcode]\n\nputs \"[-] RtlMoveMemory\"\nFunction.new(kernel32['RtlMoveMemory'], [4, 4, 4], 4).call(ptr, buf, shellcode.size)\n\nputs \"[-] CreateThread\"\n# thread = Function.new(kernel32['CreateThread'], [4,4,4,4,4,4], 4).call(Fiddle::NULL, 0, ptr, 0, 0, 0) # Works\nthread = Function.new(kernel32['CreateThread'], [4,4,4,4,4,4], 4).call(0, 0, ptr, 0, 0, 0)              # Works\nFunction.new(kernel32['WaitForSingleObject'], [4,4], 4).call(thread, -1)\n</code></pre>\n\n<p>Note: The Shellcode should be OS architecture compatible. In our case, this MessageBoxA is 32-bit compatible. </p>\n\n<p><strong>Reference</strong></p>\n\n<ul>\n<li><a href=\"https://king-sabri.net/how-to-execute-shellcode-using-ruby-on-windows-and-linux/\" rel=\"nofollow noreferrer\">How to Execute Raw Shellcode Using Ruby On Windows and Linux</a></li>\n</ul>\n\n<p>HTH Someone one day</p>\n"}], "owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 51714973, "answer_count": 1, "score": 6, "last_activity_date": 1537196988, "creation_date": 1532459075, "last_edit_date": 1533580411, "question_id": 51505870, "link": "https://stackoverflow.com/questions/51505870/how-to-use-fiddle-with-windows-api-dll-to-run-a-shellcode-in-ruby", "title": "How to use Fiddle with Windows API (dll) to run a shellcode in Ruby", "body": "<p>I'm trying to use ruby Fiddle standard library to Windows APIs to run a shellcode </p>\n\n<p>The idea of the code is to </p>\n\n<ol>\n<li>having a hexdicemial shellcode raw that executes anything (eg. MessageBoxA)</li>\n<li>call <code>kernel32.dll</code></li>\n<li>allocate a memory for this shellcode. <code>VirtualAlloc</code> </li>\n<li>create a buffer for this shellcode </li>\n<li>move the shellcode to that allocation. <code>RtlMoveMemory</code> </li>\n<li>create a new thread to execute that shellcode. <code>CreateThread</code></li>\n<li>wait for the execution/thread to end. <code>WaitForSingleObject</code></li>\n</ol>\n\n<p>here is the code: </p>\n\n<pre><code>require 'fiddle'\nrequire 'fiddle/import'\nrequire 'fiddle/types'\n\nshellcode = # MessageBoxA\n\"\\x31\\xd2\\xb2\\x30\\x64\\x8b\\x12\\x8b\\x52\\x0c\\x8b\\x52\\x1c\\x8b\\x42\" +  \n\"\\x08\\x8b\\x72\\x20\\x8b\\x12\\x80\\x7e\\x0c\\x33\\x75\\xf2\\x89\\xc7\\x03\" + \n\"\\x78\\x3c\\x8b\\x57\\x78\\x01\\xc2\\x8b\\x7a\\x20\\x01\\xc7\\x31\\xed\\x8b\" + \n\"\\x34\\xaf\\x01\\xc6\\x45\\x81\\x3e\\x46\\x61\\x74\\x61\\x75\\xf2\\x81\\x7e\" + \n\"\\x08\\x45\\x78\\x69\\x74\\x75\\xe9\\x8b\\x7a\\x24\\x01\\xc7\\x66\\x8b\\x2c\" + \n\"\\x6f\\x8b\\x7a\\x1c\\x01\\xc7\\x8b\\x7c\\xaf\\xfc\\x01\\xc7\\x68\\x79\\x74\" + \n\"\\x65\\x01\\x68\\x6b\\x65\\x6e\\x42\\x68\\x20\\x42\\x72\\x6f\\x89\\xe1\\xfe\" + \n\"\\x49\\x0b\\x31\\xc0\\x51\\x50\\xff\\xd7\"\n\ninclude Fiddle \nkernel32 = Fiddle.dlopen('kernel32')\n\nputs \"[-] VirtualAlloc\"\nptr = Function.new(kernel32['VirtualAlloc'], [4,4,4,4], 4).call(0, (shellcode.size), 0x3000, 0x40)\nFunction.new(kernel32['VirtualProtect'], [4,4,4,4], 4).call(ptr, shellcode.size, 0, 0)\n\nputs \"[-] Create buffer\"\nbuf = Fiddle::Pointer[shellcode]\n\nputs \"[-] RtlMoveMemory\"\nFunction.new(kernel32['RtlMoveMemory'], [4, 4, 4], 4).call(ptr, buf, shellcode.size)\n\nputs \"[-] CreateThread\"\n# thread = Function.new(kernel32['CreateThread'], [4, 4, 4, 4, 4, -4], 4).call(0, 0, ptr, 0, 0, 0)\nthread = Function.new(kernel32['CreateThread'], [4,4,4,4,4,4], 4).call(Fiddle::NULL, 0, ptr, 0, 0, 0)\n\npp Function.new(kernel32['WaitForSingleObject'], [4,4], 4).call(thread, -1)\n</code></pre>\n\n<p>The problem is the MessageBoxA never get executed, when I try to something like a bind shell, the TCP connection starts successfully when I connect but I can't execute commands and it ends once I send anything twice like pressing enter twice. </p>\n\n<p>I checked the buffer <code>buf</code> size and contents <code>buf.size</code>, <code>buf.to_str</code> and it's accurate.</p>\n\n<p>Am I missing something here? </p>\n\n<p>Thanks! </p>\n\n<p>Note: I don't want to call the MessageBoxA API directly I need to execute it from the shellcode. </p>\n"}, {"tags": ["c", "return", "void"], "comments": [{"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 1, "creation_date": 1532458949, "post_id": 51505760, "comment_id": 89980659, "body": "<a href=\"https://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c\" title=\"what should main return in c and c\">stackoverflow.com/questions/204476/&hellip;</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1532459209, "post_id": 51505760, "comment_id": 89980807, "body": "This program is not valid C program. Any C compiler that compiles it, does that on &quot;grabage in - garbage out&quot; principles. The behavior is undefined. So, whatever you &quot;successfully executed &quot; has nothing to do with C language."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1532459483, "post_id": 51505760, "comment_id": 89980921, "body": "@AnT: It is not <i>undefined</i> behaviour. The C99 specification calls out that conforming implementations are permitted to do this, and requires that it be <i>implementation defined</i> behaviour. If you&#39;re not clear on the difference, do a web search and all will become clear."}, {"owner": {"reputation": 4124, "user_id": 2828480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/30ce285bfd170cf3834d9591fab207e0?s=128&d=identicon&r=PG&f=1", "display_name": "Konrad", "link": "https://stackoverflow.com/users/2828480/konrad"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1532459728, "post_id": 51505760, "comment_id": 89981037, "body": "@AnT yeah some compilers allow <code>void main</code> and there&#39;s nothing wrong with that, it&#39;s just a shortcut if you don&#39;t care about the return value. Eric is right"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 4124, "user_id": 2828480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/30ce285bfd170cf3834d9591fab207e0?s=128&d=identicon&r=PG&f=1", "display_name": "Konrad", "link": "https://stackoverflow.com/users/2828480/konrad"}, "edited": false, "score": 0, "creation_date": 1532460030, "post_id": 51505760, "comment_id": 89981152, "body": "@Konrad: In particular, Microsoft compilers allow void main, but I do not know if they allow value returns in a void main. Whether there is something <i>morally</i> wrong with it is debatable, but it is <i>de jure</i> allowed by the specification. :-)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1532460735, "post_id": 51505760, "comment_id": 89981473, "body": "@Eric Lippert: Absolutely wrong! &quot;Permitted to do&quot; <i>what</i> exactly? <code>return 0</code> in a <code>void</code> function is a <b>constraint violation</b> in all C compilers. No exceptions. Every C compiler is required to issue a diagnostic for this code. After that the behavior is undefined. Not implementation defined, but explicitly <i>undefined</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532461205, "post_id": 51505760, "comment_id": 89981708, "body": "@user9121710  &quot;but it just gave a warning&quot; --&gt; Append the warning to the question.  That will improve the question."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532462153, "post_id": 51505760, "comment_id": 89982163, "body": "As you know, returning a value from a <code>void</code> function is against the rules.  Now that you&#39;ve experimented, I suggest these additional experiments: (1) <code>float a = 1, b = 0, c; c = a &#47; b;</code> Dividing by 0 is illegal.  Do you get a floating point exception? (2) <code>int a = 80000, b=a, c; c = a * b;</code>  The product does not fit in 32 bits; the behavior is undefined. But what actually happens? (3) Go the controlled street intersection nearest your house at 3:00 tomorrow morning.  Wait until the light is red.  Cross the street.  Do you get hit by a car?  Does a policeman give you a citation for jaywalking?"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1532459116, "post_id": 51505805, "comment_id": 89980761, "body": "Interpreting zero for success is not merely typical; it is specified by the C standard."}, {"owner": {"reputation": 3017, "user_id": 390720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z3gAr.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/390720/jay"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532459301, "post_id": 51505805, "comment_id": 89980855, "body": "True however in systems which are not completely compliant to C or were developed before standards I mention typically."}], "tags": [], "owner": {"reputation": 3017, "user_id": 390720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z3gAr.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/390720/jay"}, "is_accepted": false, "score": 1, "last_activity_date": 1532458798, "creation_date": 1532458798, "answer_id": 51505805, "question_id": 51505760, "link": "https://stackoverflow.com/questions/51505760/using-return-0-with-void-main/51505805#51505805", "title": "Using return 0 with void main()?", "body": "<p>This return value of main is typically utilized the operating system where the program runs to determine if there was an error during execution or not, typically the value 0 is success and other values are interpreted as an error by convention.</p>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1532460812, "post_id": 51505842, "comment_id": 89981514, "body": "The question is not about <code>void main</code>, but rather about <code>return 0</code> in a <code>void</code> function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1532461027, "post_id": 51505842, "comment_id": 89981620, "body": "@AnT Even if <code>return 0</code> in a <code>void</code> function is permitted or not, <code>main()</code> has additional specifications that may differ.  Assuming the question &quot;Using return 0 with void main()?&quot; is about <code>main()</code> and not functions in general is reasonable."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532461166, "post_id": 51505842, "comment_id": 89981684, "body": "@chux: While <code>main</code> does have &quot;additional specifications&quot;, none of them allow this. So, no, &quot;additional specifications&quot; of <code>main</code> have nothing to do with this."}], "tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 3, "last_activity_date": 1532458969, "creation_date": 1532458969, "answer_id": 51505842, "question_id": 51505760, "link": "https://stackoverflow.com/questions/51505760/using-return-0-with-void-main/51505842#51505842", "title": "Using return 0 with void main()?", "body": "<blockquote>\n  <p>i have doubt why the program executes without a error and then also return some value when i have used void main()</p>\n</blockquote>\n\n<p>The C standard says that the right thing to do is <code>int main</code>, and that a conforming implementation is permitted to allow other signatures on <code>main</code> if it so chooses. </p>\n\n<p>Apparently your implementation chooses to allow this non-standard usage, and that the behaviour it exhibits is a warning at compile time followed by the observed behaviour at runtime.</p>\n\n<p>But you already knew that. The compiler does what the compiler does because the compiler authors wrote it that way. If you want to know why they made those choices, ask them. Since you have not said what compiler you are using, we have nothing more to go on.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532461115, "post_id": 51506324, "comment_id": 89981663, "body": "Good detailed answer!"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 2, "last_activity_date": 1532461211, "last_edit_date": 1532461211, "creation_date": 1532460921, "answer_id": 51506324, "question_id": 51505760, "link": "https://stackoverflow.com/questions/51505760/using-return-0-with-void-main/51506324#51506324", "title": "Using return 0 with void main()?", "body": "<p>Your code is not a valid C code. C language does not allow you to use <code>return 0</code> in a <code>void</code> function. It is a <strong>constraint violation</strong>, i.e. what we colloquially call <em>an error</em>. Every conforming C compiler is required to issue a diagnostic message for this code, after which the behavior of your code is undefined from the point of view of standard C language.</p>\n\n<p>According to your description, your compiler did issue a diagnostic message for this code, as required by the language specification. After that, whatever behavior you observed from the compiled code might (or might not be) defined by your specific compiler, but it is no longer defined by the language itself.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 3, "last_activity_date": 1532466183, "last_edit_date": 1592644375, "creation_date": 1532466183, "answer_id": 51507491, "question_id": 51505760, "link": "https://stackoverflow.com/questions/51505760/using-return-0-with-void-main/51507491#51507491", "title": "Using return 0 with void main()?", "body": "<p>Using <code>return 0;</code> in a function that returns <code>void</code> is a <em>constraint violation</em>:</p>\n<blockquote>\n<strong>6.8.6.4 The return statement</strong><br><br>\n<strong>Constraints</strong><br>\n<br>\n1 A <code>return</code> statement with an expression shall not appear in a function whose return type\nis <code>void</code>. A <code>return</code> statement without an expression shall only appear in a function\nwhose return type is <code>void</code>.\n</blockquote>\n<p><sup><em><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011 online draft</a></em></sup></p>\n<p>The compiler <em>must</em> issue a diagnostic for a constraint violation (the warning you saw during compilation) - however, the compiler <em>may</em> continue to translate the program and generate an executable (the difference between a warning and an error, and whether it halts translation, is up to the implementation).</p>\n<p>Secondly, unless your compiler's documentation <em>explicitly</em> lists <code>void</code> as a valid return type for <code>main</code>, using <code>void main</code> results in undefined behavior - at that point, the compiler is not required to handle the situation in any particular way.</p>\n<p>Usually, trying to figure out how you got a specific result from undefined behavior is a waste of time, since the behavior may not be repeatable.  In this case, you told the compiler <code>main</code> wasn't going to return a value and it generated the machine code accordingly.  It's likely that the register used for that return value was overwritten as soon as <code>main</code> returned.</p>\n"}], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 51507491, "answer_count": 4, "score": -1, "last_activity_date": 1532466183, "creation_date": 1532458643, "last_edit_date": 1532460404, "question_id": 51505760, "link": "https://stackoverflow.com/questions/51505760/using-return-0-with-void-main", "title": "Using return 0 with void main()?", "body": "<p>I was just trying to see what would happen, if I use <code>return 0</code> statement with <code>void main()</code>. I was expecting that the compiler would give an error but it just gave a warning and successfully executed the program but at last, returned some non zero value, now I have doubt why the program executes without an error and then also return some value when I have used <code>void main()</code>?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid main()\n{\n    printf(\"Hello World\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1532458746, "post_id": 51505715, "comment_id": 89980571, "body": "Actually the error is in the return statement. The function&#39;s return type is <code>struct node</code> while it should&#39;ve been <code>struct node *</code>. Seems like a typo."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1532458832, "post_id": 51505715, "comment_id": 89980610, "body": "@r3musn0x I actually suspect the error is in the definition of the function, given the use of <code>malloc()</code>."}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1532459029, "post_id": 51505715, "comment_id": 89980708, "body": "@AndrewHenle, I meant that the compilation error is in the return statement and not the line the OP commented. The actual error is of course in the return type."}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "is_accepted": false, "score": 5, "last_activity_date": 1532458718, "creation_date": 1532458718, "answer_id": 51505783, "question_id": 51505715, "link": "https://stackoverflow.com/questions/51505715/how-can-i-typecast-struct-returned-by-malloc-to-struct-type/51505783#51505783", "title": "How can i typecast struct returned by malloc to struct type?", "body": "<p>Your <code>createnode</code> function returns <code>struct node</code> but you return a <code>struct node*</code></p>\n\n<p>You should change the method signature to make it return a <code>struct node*</code></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 7954033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AlYNFx1v42M/AAAAAAAAAAI/AAAAAAAAAB0/RHwpUJkmz3A/photo.jpg?sz=128", "display_name": "himanshu shrivastava", "link": "https://stackoverflow.com/users/7954033/himanshu-shrivastava"}, "edited": false, "score": 0, "creation_date": 1533111108, "post_id": 51505790, "comment_id": 90221081, "body": "Thanks for helping"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1532458741, "creation_date": 1532458741, "answer_id": 51505790, "question_id": 51505715, "link": "https://stackoverflow.com/questions/51505715/how-can-i-typecast-struct-returned-by-malloc-to-struct-type/51505790#51505790", "title": "How can i typecast struct returned by malloc to struct type?", "body": "<p>This </p>\n\n<pre><code>struct node createnode()\n{ ...\n</code></pre>\n\n<p>means your function returns a <code>struct node</code>, and <strong>not</strong> a <code>struct node *</code>.</p>\n\n<pre><code>struct node createnode()\n{\nstruct node *n;\nn=(struct node *)malloc(sizeof(struct node));\nreturn(n);\n}\n</code></pre>\n\n<p>Note that <code>n</code> is a <code>struct node *</code> - a <em>pointer</em> to a <code>struct node</code>.</p>\n\n<p>You left off the <code>*</code> in your function definition:</p>\n\n<pre><code>struct node *createnode()\n{\nstruct node *n;\nn=malloc(sizeof(struct node));\nreturn(n);\n}\n</code></pre>\n\n<p>Note that in C you do <em>not</em> have to cast a <code>void</code> pointer.  In fact, you can hide potential problems if you do.</p>\n"}, {"tags": [], "owner": {"reputation": 7332, "user_id": 1641198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815c90f5e93c176813333043e3d3d880?s=128&d=identicon&r=PG", "display_name": "DrC", "link": "https://stackoverflow.com/users/1641198/drc"}, "is_accepted": false, "score": 4, "last_activity_date": 1532458759, "creation_date": 1532458759, "answer_id": 51505794, "question_id": 51505715, "link": "https://stackoverflow.com/questions/51505715/how-can-i-typecast-struct-returned-by-malloc-to-struct-type/51505794#51505794", "title": "How can i typecast struct returned by malloc to struct type?", "body": "<p>You declared your function as returning a node, but are trying to return a node *.  You probably want to change your function declaration.  <code>struct node *createnode() ...</code></p>\n"}, {"tags": [], "owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "is_accepted": false, "score": 1, "last_activity_date": 1532458869, "last_edit_date": 1532458869, "creation_date": 1532458780, "answer_id": 51505800, "question_id": 51505715, "link": "https://stackoverflow.com/questions/51505715/how-can-i-typecast-struct-returned-by-malloc-to-struct-type/51505800#51505800", "title": "How can i typecast struct returned by malloc to struct type?", "body": "<p>Change <code>struct node createnode()</code> to <code>struct node* createnode()</code>.</p>\n\n<p>You are trying to return a pointer to <code>node</code>, when you are expected to return a <code>node</code>.</p>\n"}], "owner": {"reputation": 5, "user_id": 7954033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AlYNFx1v42M/AAAAAAAAAAI/AAAAAAAAAB0/RHwpUJkmz3A/photo.jpg?sz=128", "display_name": "himanshu shrivastava", "link": "https://stackoverflow.com/users/7954033/himanshu-shrivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 51505790, "answer_count": 4, "score": 0, "last_activity_date": 1532460389, "creation_date": 1532458515, "last_edit_date": 1532460389, "question_id": 51505715, "link": "https://stackoverflow.com/questions/51505715/how-can-i-typecast-struct-returned-by-malloc-to-struct-type", "title": "How can i typecast struct returned by malloc to struct type?", "body": "<p>How can i typecast address returned by malloc to struct node type?<br>\nwhen i try to compile the following code it shows error every time regarding change in type.</p>\n\n<pre><code>struct node {\n    int info;\n    struct node *link;\n};\nstruct node createnode() {\n    struct node *n;\n    n = (struct node *) malloc( sizeof(struct node) );\n    // error: incompatible types when returning type 'struct node *' but 'struct node' was expected\n    return n;\n}\n</code></pre>\n"}, {"tags": ["java", "c"], "comments": [{"owner": {"reputation": 13832, "user_id": 1122135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d21ba1a66bb0bf71d15ca8d512ba056?s=128&d=identicon&r=PG", "display_name": "Robert Rouhani", "link": "https://stackoverflow.com/users/1122135/robert-rouhani"}, "edited": false, "score": 0, "creation_date": 1532458121, "post_id": 51505577, "comment_id": 89980264, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5670862/bytebuffer-allocate-vs-bytebuffer-allocatedirect\">ByteBuffer.allocate() vs. ByteBuffer.allocateDirect()</a>"}, {"owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "reply_to_user": {"reputation": 13832, "user_id": 1122135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d21ba1a66bb0bf71d15ca8d512ba056?s=128&d=identicon&r=PG", "display_name": "Robert Rouhani", "link": "https://stackoverflow.com/users/1122135/robert-rouhani"}, "edited": false, "score": 2, "creation_date": 1532458197, "post_id": 51505577, "comment_id": 89980312, "body": "No @RobertRouhani. I&#39;m aware of <code>ByteBuffer</code> <code>allocate</code> vs <code>allocateDirect</code>. But my doubt is whether <code>direct</code> and <code>register</code> in C are similar.."}, {"owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "reply_to_user": {"reputation": 13832, "user_id": 1122135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d21ba1a66bb0bf71d15ca8d512ba056?s=128&d=identicon&r=PG", "display_name": "Robert Rouhani", "link": "https://stackoverflow.com/users/1122135/robert-rouhani"}, "edited": false, "score": 1, "creation_date": 1532458575, "post_id": 51505577, "comment_id": 89980503, "body": "Means does <code>ByteBuffer</code> does not allocate memory in heap? What exactly process memory space mean here?"}, {"owner": {"reputation": 13832, "user_id": 1122135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d21ba1a66bb0bf71d15ca8d512ba056?s=128&d=identicon&r=PG", "display_name": "Robert Rouhani", "link": "https://stackoverflow.com/users/1122135/robert-rouhani"}, "edited": false, "score": 0, "creation_date": 1532458749, "post_id": 51505577, "comment_id": 89980576, "body": "The JVM asks the OS for a block of memory that it can lock, rearrange, and use however it wants. Almost everything you allocate in Java is memory contained inside this block. The OS itself does something similar, but with a block of memory for each process. ByteBuffer is one of the few (if not only) ways of asking the OS for another block of memory outside of what the JVM asked for when it started up."}, {"owner": {"reputation": 13832, "user_id": 1122135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d21ba1a66bb0bf71d15ca8d512ba056?s=128&d=identicon&r=PG", "display_name": "Robert Rouhani", "link": "https://stackoverflow.com/users/1122135/robert-rouhani"}, "edited": false, "score": 0, "creation_date": 1532458909, "post_id": 51505577, "comment_id": 89980645, "body": "The main benefit and reason they exist is so that you can use the JNI to pass memory around to code written in other languages (typically C/C++) without having to ask the JVM to lock a section of it&#39;s heap for you, or to make a full copy of the buffer before passing it to native code. This is all described in the question I marked this as a duplicate of (which is why I marked it as duplicate)"}, {"owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "reply_to_user": {"reputation": 13832, "user_id": 1122135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d21ba1a66bb0bf71d15ca8d512ba056?s=128&d=identicon&r=PG", "display_name": "Robert Rouhani", "link": "https://stackoverflow.com/users/1122135/robert-rouhani"}, "edited": false, "score": 0, "creation_date": 1532458977, "post_id": 51505577, "comment_id": 89980677, "body": "&quot;asking the OS for another block of memory outside of what the JVM asked for when it started up&quot; - Means who deallocates (or) free&#39;s the memory allocated something like this? Is this the job of the OS to do garbage collection on these type of objects?"}, {"owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "reply_to_user": {"reputation": 2637, "user_id": 1223719, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ad70d70b92a9e95b3a2530ea36613e6b?s=128&d=identicon&r=PG", "display_name": "aglassman", "link": "https://stackoverflow.com/users/1223719/aglassman"}, "edited": false, "score": 0, "creation_date": 1532459142, "post_id": 51505577, "comment_id": 89980775, "body": "@aglassman : I hope we can have these technical discussions here.."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1532460104, "post_id": 51505577, "comment_id": 89981192, "body": "I would say the C equivalent of DirectByteBuffer is &quot;all variables&quot;."}], "owner": {"reputation": 2268, "user_id": 6680585, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eMjQ1.jpg?s=128&g=1", "display_name": "Tom Taylor", "link": "https://stackoverflow.com/users/6680585/tom-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532457918, "creation_date": 1532457918, "question_id": 51505577, "link": "https://stackoverflow.com/questions/51505577/is-direct-bytebuffer-in-java-similar-to-registers-in-c", "title": "Is direct ByteBuffer in Java similar to Registers in C?", "body": "<p><a href=\"https://docs.oracle.com/javase/6/docs/api/java/nio/ByteBuffer.html\" rel=\"nofollow noreferrer\">ByteBuffer</a> says that it could be either direct or non-direct. Given a direct byte buffer, the JVM will make a best effort to perform native I/O operations directly upon it. That is, it will attempt to avoid copying the buffer's content to (or from) an intermediate buffer before (or after) each invocation of one of the underlying operating system's native I/O operations.</p>\n\n<p>Is this similar to <code>Registers</code> in C?</p>\n\n<pre><code>int main()\n{\n  register int i = 10;\n  int *a = &amp;i;\n  printf(\"%d\", *a);\n  getchar();\n  return 0;\n}\n</code></pre>\n\n<p>Where the value is stored directly in the register instead of loading it to memory. </p>\n"}, {"tags": ["c", "python-3.x", "extension-methods"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1532463222, "post_id": 51505391, "comment_id": 89982667, "body": "&quot;return MyClass pointer converted to (void *).&quot; Could you please clarify this? Maybe show a &quot;dummy&quot; version of <code>my_func</code> that still reproduces the crash."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 4511322, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100002123430537/picture?type=large", "display_name": "gjivanya", "link": "https://stackoverflow.com/users/4511322/gjivanya"}, "edited": false, "score": 0, "creation_date": 1532458287, "post_id": 51505489, "comment_id": 89980357, "body": "Thanks for the comment.  Warning message disappears after changing &#39;O&#39; to &quot;O&quot;. But Segfault error still exists."}, {"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "reply_to_user": {"reputation": 293, "user_id": 4511322, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100002123430537/picture?type=large", "display_name": "gjivanya", "link": "https://stackoverflow.com/users/4511322/gjivanya"}, "edited": false, "score": 0, "creation_date": 1532458594, "post_id": 51505489, "comment_id": 89980515, "body": "You should be using &amp;my_func instead of my_func() (pointer vs function return value)"}, {"owner": {"reputation": 293, "user_id": 4511322, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100002123430537/picture?type=large", "display_name": "gjivanya", "link": "https://stackoverflow.com/users/4511322/gjivanya"}, "edited": false, "score": 0, "creation_date": 1532458970, "post_id": 51505489, "comment_id": 89980671, "body": "again the same problem"}, {"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "reply_to_user": {"reputation": 293, "user_id": 4511322, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100002123430537/picture?type=large", "display_name": "gjivanya", "link": "https://stackoverflow.com/users/4511322/gjivanya"}, "edited": false, "score": 0, "creation_date": 1532459036, "post_id": 51505489, "comment_id": 89980716, "body": "I can&#39;t help you more because I don&#39;t know python :("}], "tags": [], "owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "is_accepted": false, "score": 1, "last_activity_date": 1532457541, "creation_date": 1532457541, "answer_id": 51505489, "question_id": 51505391, "link": "https://stackoverflow.com/questions/51505391/how-to-parse-void-to-pyobject/51505489#51505489", "title": "How to parse void* to PyObject", "body": "<p>Here is the prototype of Py_BuildValue:</p>\n\n<pre><code>PyObject *Py_BuildValue(char *format, ...);\n</code></pre>\n\n<p>So the first argument should be \"O\" and not 'O'.</p>\n\n<p>I'm not sure about you second arg either : you are using my_func() result instead of getting a pointer to this function.</p>\n"}], "owner": {"reputation": 293, "user_id": 4511322, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100002123430537/picture?type=large", "display_name": "gjivanya", "link": "https://stackoverflow.com/users/4511322/gjivanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532457541, "creation_date": 1532457101, "question_id": 51505391, "link": "https://stackoverflow.com/questions/51505391/how-to-parse-void-to-pyobject", "title": "How to parse void* to PyObject", "body": "<p>I want to write a wrapper for my C function as I want to call it from python code.So my wrapper function is </p>\n\n<pre><code>static PyObject* my_func_wrapper(PyObject *self, PyObject *args) \n{\n    PyObject* obj_Ptr = my_func(); \n    return Py_BuildValue('O', obj_Ptr);\n}\n</code></pre>\n\n<p>My C my_func() has no params, and return MyClass pointer converted to (void *). </p>\n\n<p>When I run my setup.py script I'm getting this </p>\n\n<pre><code>warning: passing argument 1 of \u2018Py_BuildValue\u2019 makes pointer from integer without a cast [-Wint-conversion]\n Py_BuildValue('O', obj_Ptr);\n</code></pre>\n\n<p>and when I call my_func_wrapper from python I'm getting Seg.Fault Error in return line.</p>\n\n<p>How can I fix this? </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "arrays", "malloc", "free"], "comments": [{"owner": {"reputation": 1503, "user_id": 6901184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZKRBgaWMhAY/AAAAAAAAAAI/AAAAAAAAC80/ry3so1Pwh-A/photo.jpg?sz=128", "display_name": "Mart&#237;n Zaragoza", "link": "https://stackoverflow.com/users/6901184/mart%c3%adn-zaragoza"}, "edited": false, "score": 0, "creation_date": 1532456387, "post_id": 51505191, "comment_id": 89979362, "body": "you want to free the memory of the first array element?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532456497, "post_id": 51505191, "comment_id": 89979413, "body": "No, it is not possible."}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 0, "creation_date": 1532456509, "post_id": 51505191, "comment_id": 89979422, "body": "You cannot free just part of an allocated block. Don&#39;t worry about micro optimizations- just skip the first element the simple way."}, {"owner": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 1, "creation_date": 1532456522, "post_id": 51505191, "comment_id": 89979432, "body": "What is your goal exactly?"}, {"owner": {"reputation": 13, "user_id": 8727429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa2da38bd46df7e17c3867790b566c5?s=128&d=identicon&r=PG&f=1", "display_name": "g.delv", "link": "https://stackoverflow.com/users/8727429/g-delv"}, "edited": false, "score": 0, "creation_date": 1532456926, "post_id": 51505191, "comment_id": 89979640, "body": "I built a queue and it is built on a dinamic array because I don&#39;t know how much is the maximum of the elements in the queue. So when I reach the size limit I use &#39;realloc&#39; function making it bigger. When I dequeue an element I would like to free that part of the memory because probably there will be a lot of memory lost instead."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1532457235, "post_id": 51505191, "comment_id": 89979800, "body": "Then your design is not good enough. Either use a ring buffer or a linked list."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1532457240, "post_id": 51505191, "comment_id": 89979803, "body": "You are going about it the wrong way.  Do a little more research on how queues can be implemented and how you can re-use the space at the beginning of the array by wrapping around."}, {"owner": {"reputation": 13, "user_id": 8727429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa2da38bd46df7e17c3867790b566c5?s=128&d=identicon&r=PG&f=1", "display_name": "g.delv", "link": "https://stackoverflow.com/users/8727429/g-delv"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1532458959, "post_id": 51505191, "comment_id": 89980664, "body": "@ChristianGibbons I can&#39;t use the space at the beginning becuase when the queue is full I reallocate memory beacause I don&#39;t know how much space I need"}, {"owner": {"reputation": 13, "user_id": 8727429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa2da38bd46df7e17c3867790b566c5?s=128&d=identicon&r=PG&f=1", "display_name": "g.delv", "link": "https://stackoverflow.com/users/8727429/g-delv"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532458991, "post_id": 51505191, "comment_id": 89980685, "body": "@EugeneSh. What do you mean with ring buffer?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1532459022, "post_id": 51505191, "comment_id": 89980704, "body": "@g.delv <a href=\"https://stackoverflow.com/questions/827691/how-do-you-implement-a-circular-buffer-in-c\" title=\"how do you implement a circular buffer in c\">stackoverflow.com/questions/827691/&hellip;</a>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1532459064, "post_id": 51505191, "comment_id": 89980730, "body": "Your question is about freeing elements at the beginning.  Instead of freeing them, you should be recycling them.  Do some research on ring buffers as Eugene Sh. mentioned; that should get you started."}, {"owner": {"reputation": 13, "user_id": 8727429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa2da38bd46df7e17c3867790b566c5?s=128&d=identicon&r=PG&f=1", "display_name": "g.delv", "link": "https://stackoverflow.com/users/8727429/g-delv"}, "edited": false, "score": 0, "creation_date": 1532459200, "post_id": 51505191, "comment_id": 89980800, "body": "Ok thank you very much guys"}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "is_accepted": false, "score": 3, "last_activity_date": 1613664700, "last_edit_date": 1613664700, "creation_date": 1532456485, "answer_id": 51505240, "question_id": 51505191, "link": "https://stackoverflow.com/questions/51505191/free-a-single-element-from-a-dynamic-array-in-c/51505240#51505240", "title": "Free a single element from a dynamic array in C", "body": "<p>You cannot &quot;free&quot; a single portion of an allocated memory block.\nIf you want to &quot;ignore&quot; the first element, you could use A+1 which points to the second element.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1532457045, "creation_date": 1532457045, "answer_id": 51505379, "question_id": 51505191, "link": "https://stackoverflow.com/questions/51505191/free-a-single-element-from-a-dynamic-array-in-c/51505379#51505379", "title": "Free a single element from a dynamic array in C", "body": "<p>When you allocate a chuck of memory, you can't deallocate a part of it.  It has to be the whole chunk.  More specifically, you can only pass to <code>free</code> exactly what was returned by <code>malloc</code> / <code>calloc</code> / <code>realloc</code>.</p>\n\n<p>What you can do is use <code>realloc</code> to resize a memory region, however this is not something you want to do too frequently as it can affect performance.  A good rule is to double the size when you want to expand and half the size when you want to contract.</p>\n"}], "owner": {"reputation": 13, "user_id": 8727429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa2da38bd46df7e17c3867790b566c5?s=128&d=identicon&r=PG&f=1", "display_name": "g.delv", "link": "https://stackoverflow.com/users/8727429/g-delv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 51505379, "answer_count": 2, "score": 1, "last_activity_date": 1613664700, "creation_date": 1532456263, "last_edit_date": 1532457992, "question_id": 51505191, "link": "https://stackoverflow.com/questions/51505191/free-a-single-element-from-a-dynamic-array-in-c", "title": "Free a single element from a dynamic array in C", "body": "<p>I have a problem in a C program: I would like to free the first element from a dynamic array but I don't know if it is possible nor how I could do it.\nFor instance if I allocate an array A made of 10 integers like this:</p>\n\n<pre><code>int *A;\nA=(int*)malloc(sizeof(int)*10);\n</code></pre>\n\n<p>is it possible to free the first position of the array? In which way?\nI must optimize the program so I can't do some <code>memcpy</code> ignoring the first element or similar stuff because it would be a slowdown.</p>\n"}, {"tags": ["c", "linker", "avr", "atmega", "avr-gcc"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4091511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6f8a84d1ee0e656234cc36c111c770?s=128&d=identicon&r=PG&f=1", "display_name": "Ragonz", "link": "https://stackoverflow.com/users/4091511/ragonz"}, "is_accepted": true, "score": 0, "last_activity_date": 1532537564, "creation_date": 1532537564, "answer_id": 51524084, "question_id": 51505057, "link": "https://stackoverflow.com/questions/51505057/avr-ld-avr51-architecture-of-input-file-main-o-is-incompatible-with-avr-outp/51524084#51524084", "title": "avr-ld: avr:51 architecture of input file `main.o&#39; is incompatible with avr output", "body": "<p>There is a workaround to force <code>avr-ld</code> to use an linkerscript.</p>\n\n<h2>Workaround</h2>\n\n<p>If avr-ld is giving the error:</p>\n\n<p><code>avr-ld: avr:51 architecture of input file 'main.o' is incompatible with avr output</code></p>\n\n<p>You must add the desired architecture with the option <code>-m</code>, for example:</p>\n\n<pre><code>avr-ld  -o main.elf main.o  -g -mavr51\n</code></pre>\n\n<p>If this does not work you get following error:</p>\n\n<pre><code>avr-ld: cannot open linker script file ldscripts/avr51.xn: No such file or directory\n</code></pre>\n\n<p>You must force using the right linkerscript with the <code>-T</code> option:</p>\n\n<pre><code>avr-ld  -o main.elf main.o  -g -mavr51 -T /usr/lib/avr/ldscripts/avr51.xn\n</code></pre>\n\n<p>And the linker should work.</p>\n"}], "owner": {"reputation": 11, "user_id": 4091511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6f8a84d1ee0e656234cc36c111c770?s=128&d=identicon&r=PG&f=1", "display_name": "Ragonz", "link": "https://stackoverflow.com/users/4091511/ragonz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 51524084, "answer_count": 1, "score": 1, "last_activity_date": 1532537564, "creation_date": 1532455710, "last_edit_date": 1532517523, "question_id": 51505057, "link": "https://stackoverflow.com/questions/51505057/avr-ld-avr51-architecture-of-input-file-main-o-is-incompatible-with-avr-outp", "title": "avr-ld: avr:51 architecture of input file `main.o&#39; is incompatible with avr output", "body": "<p>I tried to use <a href=\"https://github.com/olikraus/u8g2/tree/master/sys/avr/atmega328\" rel=\"nofollow noreferrer\"><strong>this Code/Guide</strong></a> on an <code>ATmega1284p</code>.</p>\n\n<p>The problem that I encounter is that the linker does not work, and I get following error message after executing (code builds well for <code>ATmega88</code>):</p>\n\n<pre><code>avr-ld  -o main.elf main.o  -g\n\navr-ld: avr:51 architecture of input file `main.o' is incompatible with avr output\n</code></pre>\n\n<hr>\n\n<p><strong>For information</strong></p>\n\n<pre><code>avr-gcc -v    \nUsing built-in specs.\n    COLLECT_GCC=avr-gcc\n    COLLECT_LTO_WRAPPER=/usr/lib/gcc/avr/4.8.2/lto-wrapper\n    Target: avr\n    Configured with: ../src/configure -v --enable-languages=c,c++ --prefix=/usr/lib --infodir=/usr/share/info --mandir=/usr/share/man --bindir=/usr/bin --libexecdir=/usr/lib --libdir=/usr/lib --enable-shared --with-system-zlib --enable-long-long --enable-nls --without-included-gettext --disable-libssp --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=avr\n    Thread model: single\n</code></pre>\n\n<hr>\n\n<p><strong>Complete build instructions</strong></p>\n\n<pre><code>avr-gcc -std=c99 -g -Os -mmcu=atmega1284p -DF_CPU=8000000 -I. -DUART_BAUDRATE=57600 -Wstrict-prototypes -Wextra -ffunction-sections -fdata-sections -Wl,-gc-sections -o main.o -o main.o *.c \navr-ld  -o main.elf main.o  -g\navr-objcopy -j .text -j .data -O ihex main.o main.hex\navr-size -C --mcu=atmega1284p main.elf\n</code></pre>\n\n<hr>\n\n<p><strong>avr-objdump output of main.o</strong></p>\n\n<pre><code>avr-objdump -f main.o\n\nmain.o:     Dateiformat elf32-avr\nArchitektur: avr:51, Flags 0x00000112:\nEXEC_P, HAS_SYMS, D_PAGED\nStartadresse 0x00000000\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32", "i2c"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7184866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3818806a04d1b3fb21518c5199339911?s=128&d=identicon&r=PG&f=1", "display_name": "Taala", "link": "https://stackoverflow.com/users/7184866/taala"}, "edited": false, "score": 0, "creation_date": 1532453809, "post_id": 51504457, "comment_id": 89977999, "body": "So this errata has nothing to do with slave holding the bus ? I also tried by giving clock pulses, in such a way of giving clock pulse and recovering we must check SDA&#39;s state right ? In that case the SDA should be made as GPIO input or GPIO output ?? I tried it with output, the bus got recovered, but in the next cycle the same slave which was very well communicating sends an NACK for the address (there is always a spike in the 9th clock). I dont know whether am doing any wrong in handling the GPIO which causes such a spike. help me through it if possible"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 41, "user_id": 7184866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3818806a04d1b3fb21518c5199339911?s=128&d=identicon&r=PG&f=1", "display_name": "Taala", "link": "https://stackoverflow.com/users/7184866/taala"}, "edited": false, "score": 0, "creation_date": 1532454765, "post_id": 51504457, "comment_id": 89978497, "body": "When you interrupt the transmission (by reset for example) when the slave is sending data and it is waiting for the clocks - then the micro (master) is not guilty."}, {"owner": {"reputation": 41, "user_id": 7184866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3818806a04d1b3fb21518c5199339911?s=128&d=identicon&r=PG&f=1", "display_name": "Taala", "link": "https://stackoverflow.com/users/7184866/taala"}, "edited": false, "score": 0, "creation_date": 1532478420, "post_id": 51504457, "comment_id": 89987537, "body": "Ya I got your point. I am having one more query. If we are going to generate clock and see whether the SDA is up or not, then why should we convert SDA from AF to GPIO ? Cant we read the status of GPIO in AF mode itself with just SCL being converted to GPIO Output ?? If we should convert SDA to be GPIO also, then should it be configured as input or output ? (with pullup / open drain config ? ) what is the reason for it. Please enlight me"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 41, "user_id": 7184866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3818806a04d1b3fb21518c5199339911?s=128&d=identicon&r=PG&f=1", "display_name": "Taala", "link": "https://stackoverflow.com/users/7184866/taala"}, "edited": false, "score": 0, "creation_date": 1532481646, "post_id": 51504457, "comment_id": 89988217, "body": "Because I2C is off and we need to check the state of the GPIO. This is the correct  way. When you read the state of the GPIO is has to be input."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1532455153, "last_edit_date": 1532455153, "creation_date": 1532453312, "answer_id": 51504457, "question_id": 51504229, "link": "https://stackoverflow.com/questions/51504229/in-stm32f101-controller-i2c-busy-flag-is-set-due-to-communication-interrupted-d/51504457#51504457", "title": "In STM32F101 controller, I2C BUSY flag is set due to communication interrupted due to reset. Recovery mechanism is also failing", "body": "<p>This not the issue in this case. The slave device is keeping the SDA low. To exit from this deadlock you need to provide between 8 and 12 clocks. You need to toggle the SCL pin, and after every clock you need to check if the SDA line has been released by the slave device. This has nothing in common with this errata.</p>\n\n<p>After this is good to reset the I2C peripheral.</p>\n"}], "owner": {"reputation": 41, "user_id": 7184866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3818806a04d1b3fb21518c5199339911?s=128&d=identicon&r=PG&f=1", "display_name": "Taala", "link": "https://stackoverflow.com/users/7184866/taala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2910, "favorite_count": 0, "closed_date": 1532469350, "answer_count": 1, "score": 0, "last_activity_date": 1532455153, "creation_date": 1532452422, "question_id": 51504229, "link": "https://stackoverflow.com/questions/51504229/in-stm32f101-controller-i2c-busy-flag-is-set-due-to-communication-interrupted-d", "closed_reason": "Not suitable for this site", "title": "In STM32F101 controller, I2C BUSY flag is set due to communication interrupted due to reset. Recovery mechanism is also failing", "body": "<p>In STM32F101 with some mishap with the reset, BUSY flag is held high. To come out of it, I followed the steps given in page 26 of following document from STM :</p>\n\n<p><a href=\"https://www.st.com/content/ccc/resource/technical/document/errata_sheet/7d/02/75/64/17/fc/4d/fd/CD00190234.pdf/files/CD00190234.pdf/jcr:content/translations/en.CD00190234.pdf\" rel=\"nofollow noreferrer\">https://www.st.com/content/ccc/resource/technical/document/errata_sheet/7d/02/75/64/17/fc/4d/fd/CD00190234.pdf/files/CD00190234.pdf/jcr:content/translations/en.CD00190234.pdf</a></p>\n\n<p>While doing the steps,I could able to do the 1st step. In the second step (Set SCL and SDA as open drain output with their values high) , I have set both SCL and SDA as output open drain, but could if I set the pins high, only SCL's IDR register is set high and SDA pin's IDR register could not be set (but it's ODR register is set). Because of this I could not able to continue with further steps. Please help me through this</p>\n"}, {"tags": ["c++", "c", "embedded-linux", "fpga", "xilinx"], "owner": {"reputation": 33, "user_id": 9759131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Casa Vinzaglio", "link": "https://stackoverflow.com/users/9759131/casa-vinzaglio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532458892, "creation_date": 1532451669, "last_edit_date": 1532458892, "question_id": 51504040, "link": "https://stackoverflow.com/questions/51504040/failed-to-open-xillybus-device-files-while-running-host-application-on-zedboa", "title": "&quot;Failed to open Xillybus device file(s) while running host application on zedboard running Xillinux", "body": "<p>I am writing a code where I have to read from input files and then read the output. One of the files is large and is around <code>38 MB</code>. I'm not very good at programming so by looking at some tutorials and <code>xillybux</code> programming guide, I wrote the following code to read from two files, write them to the logic and then read them. My motive is to calculate the time of reading and writing for my future project. But when I try to run the program I get the following error</p>\n\n<pre><code>Failed to open Xillybus device file(s), device resource busy\n</code></pre>\n\n<p>I don't know what I have done wrong. The code which I had written is below</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string&gt;\n#include &lt;cstdlib&gt;\n\n#define N ((cols+1)*rows + cols) \n\nint main(int argc, char *argv[]) \n{\n    int fdr, fdw;\n    FILE *ftime_rw;\n    FILE *fp;\n    FILE *U, *V, *RI;\n    int rc, donebytes;\n    int *tologic, *fromlogic;\n    pid_t pid;\n    int i,j;\n    struct timeval tv1, tv2;\n    double time_rw;\n    char *buf;\n    int temp;\n    int rows= 575;\n    int cols= 18689;\n\n    fdr = open(\"/dev/xillybus_read_32\", O_RDONLY);\n    fdw = open(\"/dev/xillybus_write_32\", O_WRONLY);\n\n    if ((fdr &lt; 0) || (fdw &lt; 0)) \n    {\n        perror(\"Failed to open Xillybus device file(s)\");\n        exit(1);\n    }\n\n    U = fopen(\"U.txt\", \"r\"); \n    V = fopen(\"V.txt\", \"r\");  \n    RI = fopen(\"RI.txt\", \"a\");\n\n    if(U==NULL || V==NULL || RI==NULL )\n    { \n        printf(\"Write in their respective files!\\n\");\n        exit(1);\n    }\n\n    for (i=0; i&lt;rows; i++) // Read \n    { \n        fscanf(U,\"%d\", &amp;temp);\n        fprintf(RI,\"%d\\n\", temp);\n    }\n\n    for(j=0; j&lt;rows; j++)\n    { \n        for (i=0; i&lt;cols; i++) // Read \n        { \n            fscanf(V,\"%d\", &amp;temp);\n            fprintf(RI,\"%d \", temp);\n        }\n\n        fclose(U);\n        fclose(V);\n        fclose(RI);\n\n\n        tologic = (int*)malloc(sizeof(int)* N);\n\n        if (!tologic) \n        {\n            fprintf(stderr, \"failed to allocate memory\\n\");\n            exit(1);\n        }\n        RI = fopen(\"RI.txt\", \"r\");\n\n        for(j=0; j&lt;rows; j++)\n        { \n            for (i=0; i&lt;cols; i++)\n            fscanf(RI,\"%d\", &amp;tologic[N]);\n\n            fclose(RI);\n\n            pid = fork();  // writer + reader\n\n            if (pid &lt; 0) \n            { \n                perror(\"Failed to fork()\");\n                exit(1);\n            }\n\n            if (pid) // writer process\n            {\n                close(fdr);\n                buf = (char *)tologic;\n                donebytes=0;\n\n                gettimeofday(&amp;tv1, NULL);  // start count time\n\n                while (donebytes &lt; sizeof(int)*N)  // write N integers\n                {\n                    rc = write(fdw, tologic + donebytes, sizeof(int)*N - donebytes);\n\n                    if ((rc &lt; 0) &amp;&amp; (errno == EINTR))\n                        continue;\n\n                    if (rc &lt;= 0) \n                    {\n                        perror(\"write() failed\");\n                        exit(1);\n                    }\n\n                    donebytes += rc;\n                }\n                gettimeofday(&amp;tv2, NULL);  // stop count time\n\n                time_rw = (double) (tv2.tv_usec-tv1.tv_usec);\n\n                printf(\"Writer. Total time = %f usec\\n\", time_rw); \n\n                if(close(fdw)==-1)\n                    printf(\"ERROR closing write_32 file!\\n\");\n\n                return 0;\n            } \n            else  // reader process\n            {\n                close(fdw);\n                fromlogic =(int*)malloc(sizeof(int)* N);\n\n                if (! fromlogic)\n                {\n                    fprintf(stderr, \"failed to allocate memory\\n\");\n                    exit(1);\n                }\n                buf = (char *)fromlogic;\n                donebytes = 0;\n\n                donebytes = 0;\n\n                gettimeofday(&amp;tv1, NULL);  // start count time\n\n                while (donebytes &lt; sizeof(int)*rows)  // read num_rows integers \n                {\n                    rc = read(fdr, fromlogic + donebytes, sizeof(int)*rows - donebytes);\n\n                    if ((rc &lt; 0) &amp;&amp; (errno == EINTR))\n                        continue;\n\n                    if (rc &lt; 0) \n                    {\n                        perror(\"read() failed\");\n                        exit(1);\n                    }\n\n                    if (rc == 0) \n                    {\n                        fprintf(stderr, \"Reached read EOF!? Should never happen.\\n\");\n                        exit(0);\n                    }\n\n                    donebytes += rc;\n                }\n\n                gettimeofday(&amp;tv2, NULL);  // stop count time\n\n                time_rw = (double) (tv2.tv_usec-tv1.tv_usec);\n\n                printf(\"Reader. Total time = %f usec\\n\", time_rw);\n\n                for (i=0; i&lt;rows; i++)  // Integers read from logic\n                    printf(\"Reader process : %d\\n\", fromlogic[i]);\n\n                sleep(1); // Let debug output drain (if used)\n\n                if(close(fdr)==-1)\n                    printf(\"ERROR closing read_32 file!\\n\");\n\n                return 0;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "function", "stack", "element"], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1532452313, "post_id": 51504124, "comment_id": 89977081, "body": "@AymenTM It&#39;s generally not a good idea to use global variables, but if you do then you don&#39;t need to pass it as a parameter."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532452720, "post_id": 51504124, "comment_id": 89977330, "body": "Idk maybe your right man, I was thinking like if you have multiple stacks then you would need to pass it to know what stack to pop..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1532452734, "post_id": 51504124, "comment_id": 89977338, "body": "Better yet, have a <code>struct Stack {node *head;}</code> and pass <code>pop(&amp;stack)</code>. Same data, but better encapsulation."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532452991, "post_id": 51504124, "comment_id": 89977514, "body": "@AymenTM It&#39;s still better to not rely on globals.  In either case, the code above should work."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532455001, "post_id": 51504124, "comment_id": 89978621, "body": "@AymenTM Regarding your last edit, this answer address that."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532455277, "post_id": 51504124, "comment_id": 89978766, "body": "@dbush I indeed tried it.. but it didn&#39;t work :/  Error:   *** Error in `./stackList&#39;: double free or corruption (fasttop): 0x00000000024dd0b0 *** Aborted"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532455523, "post_id": 51504124, "comment_id": 89978908, "body": "@AymenTM There was a missing <code>*</code> in the declaration.  Try it now."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532455818, "post_id": 51504124, "comment_id": 89979075, "body": "Well what ya know.. it worked ! :D @dbush Is da man ! Thx brother."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532455895, "post_id": 51504124, "comment_id": 89979124, "body": "@AymenTM Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532598818, "post_id": 51504124, "comment_id": 90039500, "body": "Hey @dbush, im curious.. why do we check to see if &quot;stack_head&quot;  != NULL but not  &quot;deleteNode&quot;  ? When we create &quot;deleteNode&quot;, aren&#39;t we allocating memory, enough memory to store the value of &quot;stack_head&quot;? And assuming thats true (which idk correct me if im wrong), shouldn&#39;t we check if we had enough memory to create &quot;deleteNode&quot;  ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1532603447, "post_id": 51504124, "comment_id": 90042297, "body": "@notAymen <code>deleteNode</code> is a local variable which is allocated when declared, just like any other.  The fact that it can hold a pointer doesn&#39;t change that.  When the value of <code>*stack_node</code> is assigned to <code>deleteNode</code> that means they have the same value, so either both are NULL or both are not NULL, so no need to check both."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1532455492, "last_edit_date": 1532455492, "creation_date": 1532452015, "answer_id": 51504124, "question_id": 51503954, "link": "https://stackoverflow.com/questions/51503954/how-to-implement-a-pop-function-that-returns-the-popped-element-i-e-the-dat/51504124#51504124", "title": "How to implement a &#39;Pop&#39; function that returns the &quot;popped&quot; element (i.e the data/value) ? (linked list stacks)", "body": "<p>The parameter <code>stack_head</code> is local to the function <code>pop</code>, so when you modify it the result is not visible outside of the function.</p>\n\n<p>You need to pass the <em>address</em> of the variable you want to modify, then in the function you dereference the pointer parameter to change what it points to.</p>\n\n<p>So change your function to this:</p>\n\n<pre><code>VALUE pop(node **stack_head) {\n\n    node *deleteNode = *stack_head;\n\n    if (!*stack_head) {\n        fprintf(stderr, \"\\nPop failed. --&gt; ...\\n\");\n        return 0;\n    }\n\n    VALUE popped_item = (*stack_head)-&gt;item;\n\n    *stack_head = (*stack_head)-&gt;next;\n\n    free(deleteNode);\n    return popped_item;\n}\n</code></pre>\n\n<p>And call it like this:</p>\n\n<pre><code>node *stack_head = NULL;\n// do something to push onto the stack\nVALUE v = pop(&amp;stack_head);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1534143723, "last_edit_date": 1534143723, "creation_date": 1533651970, "answer_id": 51729193, "question_id": 51503954, "link": "https://stackoverflow.com/questions/51503954/how-to-implement-a-pop-function-that-returns-the-popped-element-i-e-the-dat/51729193#51729193", "title": "How to implement a &#39;Pop&#39; function that returns the &quot;popped&quot; element (i.e the data/value) ? (linked list stacks)", "body": "<p>Okay, this will be a pretty long digest, but hopefully worth it. You can see a testcase of the code I've presented as my conclusion <a href=\"https://ideone.com/2LN6ik\" rel=\"nofollow noreferrer\">here</a> and obtain a modular version of the code <a href=\"https://gist.github.com/Sebbyastian/6335a126744bad438c8f32c079110b95\" rel=\"nofollow noreferrer\">here</a>. My suggestion would be that you use a structure like this:</p>\n\n<pre><code>struct {\n    size_t top;\n    T value[];\n}\n</code></pre>\n\n<p>The reason you probably shouldn't use <em>classical linked lists</em> for this (or <em>anything</em>, really) is covered by <a href=\"https://www.youtube.com/watch?v=YQs6IC-vgmo\" rel=\"nofollow noreferrer\">this video courtesy of Bjarne Stroustrup</a>. The basis of the problem is that the majority of your overhead is in <em>allocation</em> and <em>cache misses</em> which don't occur so much when you keep <em>everything in one allocation</em>.</p>\n\n<p>If I were to write this for convenient use, perhaps:</p>\n\n<pre><code>#define stack_of(T) struct { size_t top; T value[]; }\n</code></pre>\n\n<p>This should allow you to declare empty stacks fairly sensibly, like:</p>\n\n<pre><code>int main(void) {\n    stack_of(int) *fubar = NULL;\n}\n</code></pre>\n\n<p>This is familiar enough to templates in other languages to work fairly well, and also not a hideous abuse of the preprocessor. I'm sure I've written a <code>push_back</code> function <a href=\"https://stackoverflow.com/questions/3536153/c-dynamically-growing-array/46351960#46351960\">somewhere</a> which we can adapt to <a href=\"https://gist.github.com/Sebbyastian/20ef140be74f3f2ddd2135a44f4a94f2\" rel=\"nofollow noreferrer\">this version of <code>push</code></a> which I've linked to externally as it's not important for the conclusion of this answer (bear with me here; we'll come back to that momentarily)...</p>\n\n<p>So now we have <code>stack_of(T)</code> and <code>push(list, value)</code> which we can use like:</p>\n\n<pre><code>int main(void) {\n    stack_of(int) *fubar = NULL;\n    push(fubar, 42);\n    push(fubar, -1);\n}\n</code></pre>\n\n<hr>\n\n<p>The simplest solution for <code>pop</code> might be something like:</p>\n\n<pre><code>#define pop(list) (assert(list &amp;&amp; list-&gt;top), list-&gt;value[--list-&gt;top]))\n</code></pre>\n\n<p>... but this does suffer a drawback we'll discuss later. For now we have as a testcase:</p>\n\n<pre><code>int main(void) {\n    stack_of(int) *fubar = NULL;\n    int x;\n    push(fubar, 42);\n    push(fubar, -1);\n    x = pop(fubar); printf(\"popped: %d\\n\", x);\n    x = pop(fubar); printf(\"popped: %d\\n\", x);\n    x = pop(fubar); printf(\"popped: %d\\n\", x);\n}\n</code></pre>\n\n<p>... and as you'll see during debug the <code>assert</code> fails during execution telling us we've popped more than we've pushed... probably a good thing to have. Still, this doesn't actually reduce the size of the stack. To do that we actually need something more like <code>push</code> again, except we get rid of these lines:</p>\n\n<pre><code>    list-&gt;top = y;                  \\\n    list-&gt;value[x] = v;             \\\n</code></pre>\n\n<p>So there's an opportunity for refactoring. Thus I bring you <code>operate()</code>:</p>\n\n<pre><code>#define operate(list, ...) {                                         \\\n    size_t x = list ? list-&gt;top : 0                                  \\\n         , y = x + 1;                                                \\\n    if ((x &amp; y) == 0) {                                              \\\n        void *temp = realloc(list, sizeof *list                      \\\n                                 + (x + y) * sizeof list-&gt;value[0]); \\\n        if (!temp)                                                   \\\n            return EXIT_FAILURE;                                     \\\n        list = temp;                                                 \\\n    }                                                                \\\n    __VA_ARGS__;                                                     \\\n}\n</code></pre>\n\n<p>Now we can redefine <code>push</code> in terms of <code>operate</code>:</p>\n\n<pre><code>#define push(list, v) operate(list, list-&gt;value[x] = v; list-&gt;top = y)\n</code></pre>\n\n<p>... and <code>pop</code> looks kind of like it did before, but with an invocation of <code>operate</code> on the end to cause <code>list</code> to shrink (from quadruple its size, for example when you've popped 3 elements off of a list of 4) to no larger than double its size.</p>\n\n<pre><code>#define pop(list) (assert(list &amp;&amp; list-&gt;top), list-&gt;value[--list-&gt;top]); \\\n                  operate(list, )\n</code></pre>\n\n<hr>\n\n<p>Summing it all up, you can see a testcase of the code I've presented <a href=\"https://ideone.com/2LN6ik\" rel=\"nofollow noreferrer\">here</a> and obtain a modular version of the code <a href=\"https://gist.github.com/Sebbyastian/6335a126744bad438c8f32c079110b95\" rel=\"nofollow noreferrer\">here</a>...</p>\n"}], "owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 51504124, "answer_count": 2, "score": 2, "last_activity_date": 1566817108, "creation_date": 1532451325, "last_edit_date": 1566817108, "question_id": 51503954, "link": "https://stackoverflow.com/questions/51503954/how-to-implement-a-pop-function-that-returns-the-popped-element-i-e-the-dat", "title": "How to implement a &#39;Pop&#39; function that returns the &quot;popped&quot; element (i.e the data/value) ? (linked list stacks)", "body": "<p>Confused as to how to implement a single function that would at the same time pop the element and return it as return value. </p>\n\n<p>So far all I've seen are pop functions that return a pointer to the new head of the stack.</p>\n\n<hr>\n\n<p>Here's a start, but...  </p>\n\n<pre><code>#define VALUE int\n\ntypedef struct node_t {\n    VALUE item;\n    struct node_t *next;\n} node;\n\n.\n.\n.\n\n// Function\nVALUE pop(node *stack_head) {\n\n    // Used to store the node we will delete\n    node *deleteNode = stack_head;\n\n    // Error Checking        //  &lt;&lt;====== (btw, is this actually necessary ?)\n    if (!deleteNode || !stack_head) {\n\n        if (!stack_head) fprintf(stderr, \"\\nPop failed. --&gt; ...\\n\");\n        if (!deleteNode) fprintf(stderr, \"\\nPop Failed. --&gt; ...\\n\");\n        return 0;\n    }\n\n    // Storing the value in a variable\n    VALUE popped_item = stack_head-&gt;item;\n\n    // Updating the head\n    stack_head = stack_head-&gt;next;    &lt;&lt;====== THERE'S A PROBLEM HERE ! (i think)\n\n    // Freeing/Deleting the 'popped' node\n    free(deleteNode);\n\n    // Return 'popped' value\n    return popped_item;\n}\n</code></pre>\n\n<p>.\n.\n.</p>\n\n<p><code>stack_head = stack_head-&gt;next;</code></p>\n\n<p>Doesn't actually change the address that the pointer <code>stack_head</code> (i.e the head of the stack) points to... and so the value is indeed returned for the first pop but subsequent pops return errors.</p>\n\n<p>Yes because it is a local variable but then how would you change the actual pointer (the one that points to the head of the stack) to point to the new head of the stack?</p>\n"}, {"tags": ["c", "valgrind", "libcurl"], "comments": [{"owner": {"reputation": 12011, "user_id": 641451, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/IcOuq.jpg?s=128&g=1", "display_name": "mgarciaisaia", "link": "https://stackoverflow.com/users/641451/mgarciaisaia"}, "edited": false, "score": 0, "creation_date": 1532451094, "post_id": 51503838, "comment_id": 89976445, "body": "May those be a bug? Re-run with <code>--leak-check=full --show-leak-kinds=all</code> and possibly fix them/report them to upstream"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1532454291, "post_id": 51503838, "comment_id": 89978273, "body": "It is not unusual that libraries allocate some pseudo-static buffers with malloc when a function is called first. These are often not freed at exit, but they are technically not memory-leaks. curl might do that itself or indirect through calls to other libraries (i.e. libcrypto/libssl etc). Since they do not really leak memory, you can usually safely ignore that"}, {"owner": {"reputation": 5, "user_id": 10090729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f21a462f82e86def5d238324486789a?s=128&d=identicon&r=PG&f=1", "display_name": "OskrD", "link": "https://stackoverflow.com/users/10090729/oskrd"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1532470433, "post_id": 51503838, "comment_id": 89985524, "body": "Thanks, in fact with more detailed flags, valgrind tracks the blocks to that libraries. I was just wondering if I could freed those blocks, although it actually isn&#39;t a memory leak, just like you said @Ctx ."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10090729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f21a462f82e86def5d238324486789a?s=128&d=identicon&r=PG&f=1", "display_name": "OskrD", "link": "https://stackoverflow.com/users/10090729/oskrd"}, "edited": false, "score": 0, "creation_date": 1532471624, "post_id": 51506053, "comment_id": 89985878, "body": "Ok, so in this case, Isn&#39;t anything missing? Is it something inherent to libcurl? Before ask, I read that is not a real [error] (<a href=\"https://stackoverflow.com/a/3857638/10090729\">stackoverflow.com/a/3857638/10090729</a>), but I just want to be sure I&#39;m not missing anything there."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "reply_to_user": {"reputation": 5, "user_id": 10090729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f21a462f82e86def5d238324486789a?s=128&d=identicon&r=PG&f=1", "display_name": "OskrD", "link": "https://stackoverflow.com/users/10090729/oskrd"}, "edited": false, "score": 0, "creation_date": 1532473463, "post_id": 51506053, "comment_id": 89986386, "body": "libcurl is special because it provides that curl_global_cleanup function. Most libraries do not. The OS will free memory on process exit anyway, so many libraries do not bother."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": true, "score": 2, "last_activity_date": 1532473378, "last_edit_date": 1532473378, "creation_date": 1532459782, "answer_id": 51506053, "question_id": 51503838, "link": "https://stackoverflow.com/questions/51503838/why-libcurl-still-leaves-reachable-blocks-after-cleanup-calls/51506053#51506053", "title": "Why libcurl still leaves reachable blocks after cleanup calls?", "body": "<p>libcurl links against many libraries, and some of them do not have a function like <code>curl_global_cleanup</code> which reverts initialization and frees all memory.  This happens when libcurl is linked against NSS for TLS support, and also with libssh2 and its use of libgcrypt.  GNUTLS as the TLS implementation is somewhat cleaner in this regard.</p>\n\n<p>In general, this is not a problem because these secondary libraries are only used on operating systems where memory is freed on process termination, so an explicit cleanup is not needed (and would even slow down process termination).  Only with certain memory debuggers, the effect of missing cleanup routines is visible, and valgrind deals with this situation by differentiating between actual leaks (memory to which no pointers are left) and memory which is still reachable at process termination (so that it could have been used again if the process had not terminated).</p>\n"}], "owner": {"reputation": 5, "user_id": 10090729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f21a462f82e86def5d238324486789a?s=128&d=identicon&r=PG&f=1", "display_name": "OskrD", "link": "https://stackoverflow.com/users/10090729/oskrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 51506053, "answer_count": 1, "score": 0, "last_activity_date": 1532473378, "creation_date": 1532450914, "question_id": 51503838, "link": "https://stackoverflow.com/questions/51503838/why-libcurl-still-leaves-reachable-blocks-after-cleanup-calls", "title": "Why libcurl still leaves reachable blocks after cleanup calls?", "body": "<p>I have been using libcurl to handle get/post requests and valgrind always shows me the same amount of reachable blocks (21). What I missing in the standard cURL's configuration to avoid that?</p>\n\n<p>This is the simplest code with the \"error\":</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;curl/curl.h&gt;\n\nint main(int argc, char const *argv[]) {\n\n  CURL *curl;\n\n  curl_global_init(CURL_GLOBAL_ALL);\n  curl = curl_easy_init();\n  \u00b7\n  \u00b7\n  \u00b7\n  curl_easy_cleanup(curl);\n  curl_global_cleanup();\n\n  return 0;\n\n}\n</code></pre>\n\n<p>I compile with</p>\n\n<pre><code>$ gcc -o test cURL.c -lcurl\n</code></pre>\n\n<p>Valgrind check</p>\n\n<pre><code>$ valgrind --leak-check=full --track-origins=yes ./test\n\n==4295== Memcheck, a memory error detector\n==4295== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==4295== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==4295== Command: ./test\n==4295== \n==4295== \n==4295== HEAP SUMMARY:\n==4295==     in use at exit: 858 bytes in 21 blocks\n==4295==   total heap usage: 4,265 allocs, 4,244 frees, 185,353 bytes allocated\n==4295== \n==4295== LEAK SUMMARY:\n==4295==    definitely lost: 0 bytes in 0 blocks\n==4295==    indirectly lost: 0 bytes in 0 blocks\n==4295==      possibly lost: 0 bytes in 0 blocks\n==4295==    still reachable: 858 bytes in 21 blocks\n==4295==         suppressed: 0 bytes in 0 blocks\n==4295== Reachable blocks (those to which a pointer was found) are not shown.\n==4295== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==4295== \n==4295== For counts of detected and suppressed errors, rerun with: -v\n==4295== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "process", "fork", "pid"], "comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 1, "creation_date": 1532450437, "post_id": 51503648, "comment_id": 89976059, "body": "What output are you getting? How do you know what the right exit order is without printing <code>x</code>?"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1532450591, "post_id": 51503648, "comment_id": 89976139, "body": "where do you <code>wait()</code> ?"}, {"owner": {"reputation": 508, "user_id": 9912583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdgIw.png?s=128&g=1", "display_name": "Light Yagami", "link": "https://stackoverflow.com/users/9912583/light-yagami"}, "edited": false, "score": 0, "creation_date": 1532450655, "post_id": 51503648, "comment_id": 89976178, "body": "I am getting required statements but they are NOT in right order. I mean, first I want to get list of all created child processes and after that I want to get list of excited processes."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1532451010, "post_id": 51503648, "comment_id": 89976387, "body": "Then you should a) not have a recursive <code>func()</code> but start child processes in a loop and store child PIDs in an array b) call <code>wait()</code> until all child processes have exited"}, {"owner": {"reputation": 508, "user_id": 9912583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdgIw.png?s=128&g=1", "display_name": "Light Yagami", "link": "https://stackoverflow.com/users/9912583/light-yagami"}, "edited": false, "score": 0, "creation_date": 1532451081, "post_id": 51503648, "comment_id": 89976437, "body": "Isn&#39;t it possible to make small changes to my code. Should I change it completely?"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1532451106, "post_id": 51503648, "comment_id": 89976453, "body": "At the moment you <i>don&#39;t</i> &quot;create &#39;n&#39; child processes from parent process&quot;"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1532451164, "post_id": 51503648, "comment_id": 89976476, "body": "yes you should. Recursion is not what you should do here"}], "owner": {"reputation": 508, "user_id": 9912583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdgIw.png?s=128&g=1", "display_name": "Light Yagami", "link": "https://stackoverflow.com/users/9912583/light-yagami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532450453, "creation_date": 1532450184, "last_edit_date": 1532450453, "question_id": 51503648, "link": "https://stackoverflow.com/questions/51503648/print-exit-order-of-child-processes", "title": "Print exit order of child processes", "body": "<p>I have this code. My aim is to create 'n' child processes from parent process and print the pid of each child processes once it is created.</p>\n\n<p>Then I'll ask each child process to sleep for random duration using <code>rand_r</code> function and <code>exit</code>. I want to print the exit order of child processes <em>i.e</em> I want to print their pids in their exit order.</p>\n\n<p>This is my C code. It is not giving required output:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint func(int n) \n{\n    if(n==0){return 0;}\n    int pid=fork();\n\n    unsigned int k=n;\n    int x=rand_r(&amp;k) % 3;\n    //printf(\"here: %d\\n\", x);\n\n    if(pid==0){\n        printf(\"Child %d is created\\n\",getpid());\n        func(n-1);\n        sleep(x);\n        printf(\"Child %d exited\\n\",getpid());\n        exit(0);\n    }\n    return 1;\n}\n\n\nint main(int argc, char *argv[]){\n    char *inp = argv[1];\n    int n = atoi(inp);\n    func(n);\n\n    return 0;\n}\n</code></pre>\n\n<p>I want output like this:</p>\n\n<pre><code>Child 7432 is created \nChild 7433 is created \nChild 7434 is created \nChild 7435 is created   \nChild 7433 exited \nChild 7432 exited \nChild 7435 exited \nChild 7434 exited\n</code></pre>\n"}, {"tags": ["c", "code-coverage", "gcov", "gcovr"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6491319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5ac28ded741ebde0a6672259c6a7b1?s=128&d=identicon&r=PG&f=1", "display_name": "B. Devore-McDonald", "link": "https://stackoverflow.com/users/6491319/b-devore-mcdonald"}, "edited": false, "score": 1, "creation_date": 1532626049, "post_id": 51513590, "comment_id": 90056761, "body": "Thanks for linking this with the answer from Github!"}], "tags": [], "owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "is_accepted": true, "score": 1, "last_activity_date": 1532505135, "creation_date": 1532505135, "answer_id": 51513590, "question_id": 51503170, "link": "https://stackoverflow.com/questions/51503170/gcovr-object-directory-option-not-working-as-expected-with-gcda-files-in-a-di/51513590#51513590", "title": "Gcovr --object-directory option not working as expected with .gcda files in a different directory than .o files", "body": "<p>This was <a href=\"https://github.com/gcovr/gcovr/issues/273\" rel=\"nofollow noreferrer\">cross-posted to the gcovr issue tracker on GitHub</a>, here's the summary:</p>\n\n<p>Gcovr currently expects that the .gcda and .gcno files are right next to each other (which is usually the case). The search paths affect where gcovr searches for these files. The --object-directory only provides a default value for the search paths, but here you have overridden that with an explicit search path. The gcovr --object-directory option is not passed through to the gcov --object-directory option.</p>\n\n<p>As of gcovr 4.1 there is no option to solve this. You will have to copy the .gcno files from the build directory into each directory with coverage data. Alternatively you can run gcov manually and then aggregate the .gcov files with <code>gcovr -g ...</code>.</p>\n\n<p>Additional notes:</p>\n\n<ul>\n<li>gcov is not interested in the .o object files, only the .gcda files (written during test execution) and the .gcno files (written during compilation).</li>\n<li>gcovr and lcov are not directly related</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 6491319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5ac28ded741ebde0a6672259c6a7b1?s=128&d=identicon&r=PG&f=1", "display_name": "B. Devore-McDonald", "link": "https://stackoverflow.com/users/6491319/b-devore-mcdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 51513590, "answer_count": 1, "score": 0, "last_activity_date": 1532505135, "creation_date": 1532448415, "last_edit_date": 1532448862, "question_id": 51503170, "link": "https://stackoverflow.com/questions/51503170/gcovr-object-directory-option-not-working-as-expected-with-gcda-files-in-a-di", "title": "Gcovr --object-directory option not working as expected with .gcda files in a different directory than .o files", "body": "<p>The program I want to profile with gcovr (or gcov/lcov) is located on a shared filesystem, along with the build directory from compiling the program, and I have multiple workers with which I intend to test my program, in parallel. To solve the race condition problem (the workers will <em>all</em> run my program, therefore <em>all</em> generating gcda files, named the same, in the same location on the shared filesystem), I redirect the gcda files to a separate target directory on each worker (as described <a href=\"https://stackoverflow.com/questions/7671612/crossprofiling-with-gcov-but-gcov-prefix-and-gcov-prefix-strip-is-ignored\">here</a>), and I have been running the following command:</p>\n\n<pre><code>gcovr -v -r /absolute/path/to/root --html --html-details -o test-details.html --object-directory=/absolute/path/to/object/dir /absolute/path/to/gcda/dir\n</code></pre>\n\n<p>where the last path is the <code>search_paths</code>, described <a href=\"https://gcovr.com/guide.html#cmdoption-gcovr-arg-search-paths\" rel=\"nofollow noreferrer\">here</a>. I expected this to look in <code>/absolute/path/to/root</code> for the program source, <code>/absolute/path/to/object/dir</code> for the .o files, and <code>/absolute/path/to/gcda/dir</code> for the gcda files. However, I ran it with <code>-v</code> and I'm seeing that gcovr is running gcov commands in the form of this, from the root dir:</p>\n\n<pre><code>gcov /absolute/path/to/gcda/dir/file.gcda --branch-counts --branch-probabilities --preserve-paths --object-directory /absolute/path/to/gcda/dir\n</code></pre>\n\n<p>Again, I expected it to run in the form of this (look at the --object-directory path):</p>\n\n<pre><code>gcov /absolute/path/to/gcda/dir/file.gcda --branch-counts --branch-probabilities --preserve-paths --object-directory /absolute/path/to/object/dir\n</code></pre>\n\n<p>It behaves properly when run like the latter command, but gcovr is running the former. I'm only using gcovr instead of gcov because I have a large project (I know gcovr is built off of lcov). Does anyone know why it is behaving like this? (Is this the way it is supposed to run?) How can I make it so it behaves the way I want? Thanks in advance!</p>\n"}, {"tags": ["c", "loops", "infinite"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1532447376, "post_id": 51502853, "comment_id": 89974206, "body": "How do you know your call to <code>scanf()</code> actually worked?  You&#39;re ignoring the return value."}, {"owner": {"reputation": 564, "user_id": 1165946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fYEZj.png?s=128&g=1", "display_name": "rdowell", "link": "https://stackoverflow.com/users/1165946/rdowell"}, "edited": false, "score": 0, "creation_date": 1532447606, "post_id": 51502853, "comment_id": 89974325, "body": "What would you assume happens when <code>scanf</code> is expecting an integer input (<code>%d</code>) and you give it a non-integer value?"}, {"owner": {"reputation": 1244, "user_id": 10002294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ARNs5.jpg?s=128&g=1", "display_name": "Uclydde", "link": "https://stackoverflow.com/users/10002294/uclydde"}, "reply_to_user": {"reputation": 564, "user_id": 1165946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fYEZj.png?s=128&g=1", "display_name": "rdowell", "link": "https://stackoverflow.com/users/1165946/rdowell"}, "edited": false, "score": 0, "creation_date": 1532447776, "post_id": 51502853, "comment_id": 89974434, "body": "@rdowell I assumed it would take the decimal value of the ascii character, in this case &#39;g&#39;, which is 103, and use that value. Is this incorrect?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1532448103, "post_id": 51502853, "comment_id": 89974631, "body": "@JulianBraha If that were the case, then &#39;1&#39; would be read as 49, which is the ascii code for that character."}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "is_accepted": false, "score": 0, "last_activity_date": 1532447687, "creation_date": 1532447687, "answer_id": 51502948, "question_id": 51502853, "link": "https://stackoverflow.com/questions/51502853/loop-is-not-working-correctly/51502948#51502948", "title": "Loop is not working correctly", "body": "<p>If you do not trust user input, you should read input as a string (with gets for example) and then parse this string.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1532447833, "creation_date": 1532447833, "answer_id": 51502993, "question_id": 51502853, "link": "https://stackoverflow.com/questions/51502853/loop-is-not-working-correctly/51502993#51502993", "title": "Loop is not working correctly", "body": "<p>When <code>scanf</code> encounters characters that don't match the given format specifier, those characters are left in the input buffer.  The <code>%d</code> format specifier expects decimal digits, so it stops reading once a non-digit is read.</p>\n\n<p>By entering \"g\", the <code>scanf</code> call reads nothing and the \"g\" is left in the buffer.  The same happens on subsequent iterations, resulting in an infinite loop.</p>\n\n<p>Use <code>fgets</code> instead to read a line of text, then use <code>sscanf</code> to attempt to read a number from that line.  If it returns 1 the conversion was successful.  If it returns 0, non-numeric input was read and you read another line:</p>\n\n<pre><code>for(;;) {\n    char line[100];\n    fgets(line, sizeof(line), stdin);\n    int result = sscanf(line, \"%d\", &amp;playerMove);\n\n    if (result == 1 &amp;&amp; playerMove &gt; 0 &amp;&amp; playerMove &lt; 10)\n        printf(\"\\nYou have selected position %d. \\n\\n\", playerMove);\n        break;\n    } else {\n        printf(\"Invalid selection. Please enter a number 1 - 9:\\n\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1244, "user_id": 10002294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ARNs5.jpg?s=128&g=1", "display_name": "Uclydde", "link": "https://stackoverflow.com/users/10002294/uclydde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 51502993, "answer_count": 2, "score": 0, "last_activity_date": 1532447833, "creation_date": 1532447298, "question_id": 51502853, "link": "https://stackoverflow.com/questions/51502853/loop-is-not-working-correctly", "title": "Loop is not working correctly", "body": "<p>I'm trying to make my loop take a user input, and if the value is 1 through 9, the loop finishes (this part is working properly). But if the user input is not a number 1 - 9, then the program should display an error message, then ask for user input once more, and re-check if the input is a number 1 - 9. When testing this, if I input the letter 'g', then the program spits out the error message indefinitely, rather than just once. Why is this?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>int playerMove;\n\nprintf(\"Please enter a number 1 - 9:\\n\");\n\n  for(;;)\n  {\n   scanf(\"%d\", &amp;playerMove);\n\n    if(playerMove &gt; 0 &amp;&amp; playerMove &lt; 10)\n    {\n      printf(\"\\nYou have selected position %d. \\n\\n\", playerMove);\n      break;\n    }\n\n    else \n    {\n      printf(\"Invalid selection. Please enter a number 1 - 9:\\n\");\n    }\n  }\n</code></pre>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532444167, "post_id": 51501631, "comment_id": 89971825, "body": "It is not working right? And hard to debug? And apparently hard to read. Get rid of the statements making it even worse, such as <code>*++argv[0]</code> as the very first step."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1532445418, "post_id": 51501631, "comment_id": 89972764, "body": "How did you break inputting lines?"}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "edited": false, "score": 0, "creation_date": 1532445681, "post_id": 51501631, "comment_id": 89972983, "body": "No clue. I&#39;ve now tried it on two different windows machines using 3 different versions of the program (all three versions were ripped from the link above). I assume that if they were on that site, they&#39;d work. I also assumed that they wouldn&#39;t all suffer from the same problem of having the output differ like I&#39;m having. Which is why I think it&#39;s a problem with windows/the compiler that I&#39;m using, and not the code."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1532445764, "post_id": 51501631, "comment_id": 89973053, "body": "Try writing input to a text file and call <code>tail3 -n 4 &lt; tail.txt</code>. The program works for me (linux and win7 cmd)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532446537, "post_id": 51501631, "comment_id": 89973624, "body": "What exactly is your input? 1&lt;Enter&gt;2&lt;Enter&gt;3&lt;Enter&gt;...&lt;Ctrl+Z&gt;&lt;Enter&gt;. &lt;Enter&gt; meaning press Enter key and &lt;Ctrl+Z&gt; meaning press Ctrl+Z keys."}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "edited": false, "score": 0, "creation_date": 1532446599, "post_id": 51501631, "comment_id": 89973667, "body": "So using IO redirection like that works. I hadn&#39;t tried that. I was running the program straight from the command line, and just typing 1-10 on a new line, and then entering EOF."}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532446723, "post_id": 51501631, "comment_id": 89973758, "body": "@Jabberwocky Yes, that it exactly what I was doing. However, as I just commented above, doing &quot;.\\tail3.exe -n 4 &lt; tail.txt&quot; or &quot;.\\tail3.exe &lt; tail.txt&quot; prints the correct output, where &quot;tail.txt&quot; contains &quot;1\\n2\\n\\3...\\n10\\n&quot;. So the code works, I&#39;m just still left wondering why the input from the console yields such wild results."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1532447152, "post_id": 51501631, "comment_id": 89974055, "body": "Strange that &lt;Ctrl+Z&gt; isn&#39;t echoed. If I do it I see <code>^Z</code> on the screen"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532447488, "post_id": 51501631, "comment_id": 89974255, "body": "Here on my Windows 10 it works as expected from a cmd console but it does not work as exepected from a powershell console, apparently it has something to do with powershell."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532447779, "post_id": 51501631, "comment_id": 89974436, "body": "... wait, now it works also in powershell (?!) very strange. Put this at the beginning of the program to be sure that argc and argv are what you expect: <code>printf(&quot;argc = %d\\n&quot;, argc);   for (int i = 0; i &lt; argc; i++)     printf(&quot;argv[%d] = %s\\n&quot;, i, argv[i]); </code>"}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "edited": false, "score": 0, "creation_date": 1532447852, "post_id": 51501631, "comment_id": 89974476, "body": "Yeah, it is odd. Thanks for all of your help Jabberwocky and Ingo Leonhardt. I really appreciate ya&#39;ll taking the time to look into it. It seems to also work for me in cmd, but not Powershell."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532447928, "post_id": 51501631, "comment_id": 89974517, "body": "Please try what I&#39;ve suggested in my last comment and tell us what the output is using powershell, I&#39;m somewhat curious."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532448017, "post_id": 51501631, "comment_id": 89974574, "body": "@Jabberwocky, there&#39;s no such thing as a CMD console or PowerShell console. They both use a regular Windows console (conhost.exe). Possibly the console mode flags could be different for you or the OP. I compiled this using Visual C++ 19.11, and it worked fine when run in the console in Windows 10.0.17134 -- from CMD and PoweShell there&#39;s no difference. It won&#39;t work in PowerShell ISE, but that&#39;s not the console and not designed for interactive console apps."}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "edited": false, "score": 0, "creation_date": 1532448042, "post_id": 51501631, "comment_id": 89974591, "body": "Yeah, argc and argv are what I expect them to be. It&#39;s just that, later on during the execution, it skips print lines, ends early, or it prints some, and then just exits randomly."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1532448061, "post_id": 51501631, "comment_id": 89974603, "body": "@eryksun yes, maybe I used the wrong terms."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532448143, "post_id": 51501631, "comment_id": 89974665, "body": "@RobertStefanic indeed very strange, try to printf the values returned by <code>getchar</code>"}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532449175, "post_id": 51501631, "comment_id": 89975324, "body": "@Jabberwocky That works as expected. I think eryksun was onto something where we could possibly be launching PS in different modes."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1532451055, "post_id": 51501631, "comment_id": 89976419, "body": "Are you using any programs that modify the behavior of the console, such as conemu or ansicon? Try running the executable directly from Explorer. Add a final <code>getchar()</code> before exiting to prevent the console window from immediately closing."}, {"owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "edited": false, "score": 0, "creation_date": 1532451538, "post_id": 51501631, "comment_id": 89976672, "body": "Not to my knowledge; however, I just tried your suggestion for running it from explorer and adding <code>getchar()</code> to the end of main, and it worked perfectly fine. I had initially thought the problem was the compiler/Windows, but now it&#39;s looking like it&#39;s a problem with my environment."}], "owner": {"reputation": 242, "user_id": 6421957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3Qq.jpg?s=128&g=1", "display_name": "Robert Stefanic", "link": "https://stackoverflow.com/users/6421957/robert-stefanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550702802, "creation_date": 1532443764, "last_edit_date": 1550702802, "question_id": 51501631, "link": "https://stackoverflow.com/questions/51501631/c-program-compiled-on-windows-gives-varied-output", "title": "C program compiled on Windows gives varied output", "body": "<p>I was getting suspicious that it wasn't just my code, and I couldn't figure out why my code's output was so varied. It would sometimes print some lines, and other times, it wouldn't print anything. </p>\n\n<p>Thinking it was something weird, I started ripping code from <a href=\"https://clc-wiki.net/wiki/K%26R2_solutions:Chapter_5:Exercise_13\" rel=\"nofollow noreferrer\">here</a>, and sure enough, I'm still getting this weird unexpected behavior where the program doesn't always print.</p>\n\n<p>I took an example from the K&amp;R C book. It's the exercise where you're trying to mimic tail. However, when I compile the code below and run it, the output varies, even though I've used the same input each time.\nI ran this code specifically:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAXLINES        1024\n#define MAXINPUT        10240\n#define DEF_NUM_LINES   10\n\nint  getlines   (char *);\nvoid parse_args (int, char **);\n\nchar  linestr[MAXINPUT];\nchar *lineptr[MAXLINES];\n\nint num_of_lines = DEF_NUM_LINES;\n\nint main (int argc, char *argv[])\n{\n        int lines;\n        int ltp = 0;\n        int i; int c;\n\n        *lineptr = linestr;\n\n        /* Parse the argument strings passed to the program */\n        if (argc &gt; 1) {\n                parse_args(argc, argv);\n        }\n\n        /* Get the input from the user */\n        lines = getlines(linestr);\n\n        if (num_of_lines == 0) {\n                num_of_lines = 10;\n        }\n\n        ltp = lines &lt; num_of_lines ? lines : num_of_lines;\n        printf (\"\\n&gt;&gt;&gt; Printing %d line(s):\\n\", ltp);\n        if (ltp == DEF_NUM_LINES) {\n                printf (\"&gt;&gt;&gt; The default number of lines to print is \");\n                printf (\"%d\\n\", DEF_NUM_LINES);\n        }\n        printf (\"\\n\");\n\n        for (i = lines; i &gt; 0; i--) {\n                while ((c = *lineptr[0]++) != '\\n') {\n                        if (i &lt;= ltp) {\n                                printf (\"%c\", c);\n                        }\n                }\n                if (c == '\\n' &amp;&amp; i &lt;= ltp) {\n                        printf (\"\\n\");\n                }\n        }\n\n        return 0;\n}\n\nint getlines (char *buffer)\n{\n        int i, count = 0;\n        char c;\n\n        for (i = 0; (c = getchar()) != EOF &amp;&amp; i &lt; MAXINPUT; i++) {\n                *buffer++ = c;\n                if (c == '\\n') {\n                        lineptr[++count] = buffer;\n                }\n\n        }\n        *buffer++ = '\\0';\n\n        return count;\n}\n\nvoid parse_args (int argc, char **argv)\n{\n        char c;\n\n        while (--argc &gt; 0 &amp;&amp; (*++argv)[0] == '-') {\n                c = *++argv[0];\n                switch (c) {\n                case 'n':\n                        num_of_lines = atoi(*(argv + 1));\n                        break;\n                }\n        }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Z9zGe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z9zGe.png\" alt=\"Odd output for tail\"></a></p>\n\n<p>In the first two instances of running it, the output is the same, but it's not correct. It doesn't print the number of that should have been printed on line 40, and it looks like the program just stopped executing. </p>\n\n<p>Then running it a third time, it didn't even print those lines that were printed in the first two instances of running the program!</p>\n\n<p>I've also used the same input, and received different output than the examples in the picture! In another instance, the program actually output some (but not all) of the lines.</p>\n\n<p>How can the output differ so much? It's so puzzling how in one instance of running the program, it'll print some of the lines, and in other instances, it won't. Does it have something to do with powershell/cmd's output and not the code? I really have no clue.</p>\n\n<p>I'm currently using Visual Studio Developer Command Prompt to compile this code. Any ideas as to why the program sometimes prints lines, and other times it doesn't? My initial guess is that it has something to do with Windows because I've wrestled with the Windows Console Handles in the past.</p>\n\n<p>EDIT:\nThis was embarrassing. In short, once I sorted everything out, I finally figured out the problem. The keymapping on my keyboard was changed and so Ctrl-Z was really Ctrl-C, which explained why my output varied. </p>\n"}, {"tags": ["c", "clock"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532443312, "post_id": 51501410, "comment_id": 89971192, "body": "What do you think why it&#39;s defined as a macro? Of course, you should not assume it&#39;s the same on every system!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532443339, "post_id": 51501410, "comment_id": 89971209, "body": "AFAIK, POSIX defines it to 1&#39;000&#39;000. So you seem to be on a non-POSIX system."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1532443608, "post_id": 51501410, "comment_id": 89971405, "body": "btw, <code>%u</code> is the wrong format specifier for printing a <code>double</code>."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 7, "last_activity_date": 1532445263, "last_edit_date": 1532445263, "creation_date": 1532444443, "answer_id": 51501862, "question_id": 51501410, "link": "https://stackoverflow.com/questions/51501410/clocks-per-sec-in-c-language-found-the-time-h-library/51501862#51501862", "title": "CLOCKS_PER_SEC in C language found the time.h library", "body": "<blockquote>\n  <p>Does CLOCKS_PER_SEC varies from system to system or is it constant for an operating system or is it dependent on the processor of that particular system?</p>\n</blockquote>\n\n<p><code>CLOCKS_PER_SEC</code> is ultimately determined by the compiler and its standard library implementation, not the OS.  Although the machine, OS and other factors contribute to what a compiler provides.</p>\n\n<blockquote>\n  <p>help me explain the output of my code...is it right?</p>\n</blockquote>\n\n<p>No. <code>printf(\"\\nTotal time:%u\",(double)(end - start)/CLOCKS_PER_SEC);</code> is using <code>\"%u\"</code> to print a <code>double</code>. <a href=\"https://stackoverflow.com/questions/51501410/clocks-per-sec-in-c-language-found-the-time-h-library/51501862#comment89971405_51501410\">@Felix Palmen</a></p>\n\n<p><code>CLOCKS_PER_SEC</code> is not necessarily an <code>unsigned</code>.<br>\n<code>clock_t</code> is not necessarily an <code>int</code>.  <a href=\"https://stackoverflow.com/questions/1083142/what-s-the-correct-way-to-use-printf-to-print-a-clock-t\">Ref</a><br>\nUsing the wrong <code>printf()</code> specifiers renders the output uninformative.<br>\nTip: enable all compiler warnings.</p>\n\n<p>Cast to a wide type and use a matching print specifier.</p>\n\n<pre><code>clock_t start\n// printf(\"Starting Time:%u\\n\",start);\nprintf(\"Starting Time:%g\\n\", (double) start);\n\n// printf(\"CLOCKS_PER_SEC:%u\",CLOCKS_PER_SEC);\nprintf(\"CLOCKS_PER_SEC:%g\\n\", (double) CLOCKS_PER_SEC);\n\n// printf(\"\\nTotal time:%u\",(double)(end - start)/CLOCKS_PER_SEC);\nprintf(\"Total time:%g\\n\",(double)(end - start)/CLOCKS_PER_SEC);\n</code></pre>\n\n<p>Or even consider <code>long double</code>.</p>\n\n<pre><code>long double t = (long double)(end - start)/CLOCKS_PER_SEC;\nprintf(\"Total time:%Lg\\n\", t);\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9234367, "user_type": "registered", "profile_image": "https://graph.facebook.com/933400383495165/picture?type=large", "display_name": "UltraRadiantx", "link": "https://stackoverflow.com/users/9234367/ultraradiantx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3905, "favorite_count": 0, "accepted_answer_id": 51501862, "answer_count": 1, "score": 2, "last_activity_date": 1532445263, "creation_date": 1532443163, "last_edit_date": 1532443902, "question_id": 51501410, "link": "https://stackoverflow.com/questions/51501410/clocks-per-sec-in-c-language-found-the-time-h-library", "title": "CLOCKS_PER_SEC in C language found the time.h library", "body": "<p>Does CLOCKS_PER_SEC varies from system to system or is it constant for an operating system or is it dependent on the processor of that particular system??\nAnd also do help me explain the output of my code...is it right??</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\nint main()\n{\nint a;\nlong int b;\nclock_t start, end;\n\nstart = clock();\n\n//Code for which the time is to be calculated\nfor(a=0;;a++)\n{\n    if(a&lt;0)\n    {\n        break;\n    }\n}\nprintf(\"int : %u\\n\",a);\nfor(b=0;;b++)\n{\n    if(b&lt;0)\n    {\n        break;\n    }\n}\nprintf(\"long int :%u\\n\",b);\n//code is over\n\nend = clock();\n\n//CLOCKS_PER_SECOND : the number of clock ticks per second\nprintf(\"Starting Time:%u\\n\",start);\nprintf(\"Ending Time:%u\\n\",end);\nprintf(\"CLOCKS_PER_SEC:%u\",CLOCKS_PER_SEC);\nprintf(\"\\nNumber of clock ticks:%u\",(end - start));\nprintf(\"\\nTotal time:%u\",(double)(end - start)/CLOCKS_PER_SEC);\nreturn 0;\n}\n</code></pre>\n\n<p><strong>output:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>int : 2147483648\nlong int :2147483648\nStarting Time:0\nEnding Time:9073\nCLOCKS_PER_SEC:1000\nNumber of clock ticks:9073\nTotal time:1099511628\nProcess returned 0 (0x0)   execution time : 15.653 s\nPress any key to continue.\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "latency"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532443084, "post_id": 51501261, "comment_id": 89971021, "body": "Have you seen <i><a href=\"https://stackoverflow.com/questions/47618619/periodic-latency-spikes-from-udp-socket-caused-by-periodic-sendto-recvfrom-d\">this post</a></i>?"}, {"owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532443733, "post_id": 51501261, "comment_id": 89971502, "body": "I didn&#39;t, thanks. It seems a different case. I have no threads and it is not a matter of spikes, latency just gets worse if client loop runs more frequently."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1532450695, "post_id": 51501261, "comment_id": 89976198, "body": "What is the value of <code>strlen(data_to_send)</code>? 3 bytes?"}, {"owner": {"reputation": 4747, "user_id": 611560, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/25ee461bdf2849f6db82054c73192ea1?s=128&d=identicon&r=PG", "display_name": "Yann Droneaud", "link": "https://stackoverflow.com/users/611560/yann-droneaud"}, "edited": false, "score": 1, "creation_date": 1532452293, "post_id": 51501261, "comment_id": 89977072, "body": "Have you used proper scheduler for your processes ? increased their priority ? pinned your processes to a dedicated CPU core ?"}, {"owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "edited": false, "score": 0, "creation_date": 1532504020, "post_id": 51501261, "comment_id": 89994800, "body": "I set affinity for ethernet irq, the system is not loaded at all."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1532512840, "post_id": 51501261, "comment_id": 90000558, "body": "Why sleep at all? What is to be gained? You&#39;re in blocking mode: <code>recv()</code> will return when there is data available to be read, and not before. Sleeping is just literally a waste of time."}, {"owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "edited": false, "score": 0, "creation_date": 1532513455, "post_id": 51501261, "comment_id": 90000973, "body": "I don&#39;t think so, I want to wait a while before sending a new packet, if I do not sleep I will send send a packet just after having received it flooding the server."}], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "edited": false, "score": 0, "creation_date": 1532503894, "post_id": 51503716, "comment_id": 89994724, "body": "right the latency of the execution of recvfrom, in this case is round-trip time. Between the client and the server there is just a Netgear 10GB switch, no router."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1532510047, "last_edit_date": 1532510047, "creation_date": 1532450479, "answer_id": 51503716, "question_id": 51501261, "link": "https://stackoverflow.com/questions/51501261/latency-of-recvfrom-varies-with-the-frequency-it-is-called/51503716#51503716", "title": "latency of recvfrom varies with the frequency it is called", "body": "<p>Note that you send packets to <code>192.168.1.240</code> through the local network over the wire (unless you set up a host-local virtual network). The packets first go through your switch/router and then to your server. And the reverse way back. So, you effectively measure a round-trip time here, not the latency of <code>recvfrom</code>.</p>\n"}], "owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1532510047, "creation_date": 1532442764, "question_id": 51501261, "link": "https://stackoverflow.com/questions/51501261/latency-of-recvfrom-varies-with-the-frequency-it-is-called", "title": "latency of recvfrom varies with the frequency it is called", "body": "<p>I don't understand the behavior of recvfrom in the following situation:\nI have a loop that sends and receives udp packets and sleeps a bit; depending on that bit receiving (recvfrom) latency varies.\nIf I sleep for 22 milliseconds or more the latency is around 170 microsecond, if I sleep 21 milliseconds or less the latency is around 1 millisecond.\nWhat am I missing? Why the latency varies so much? I thought about interrupt coalescence but I checked with ethtool and it is disabled.</p>\n\n<p>The code is from <a href=\"https://gist.github.com/suyash/0f100b1518334fcf650bbefd54556df9\" rel=\"nofollow noreferrer\">https://gist.github.com/suyash/0f100b1518334fcf650bbefd54556df9</a> and slightly modified.</p>\n\n<p>client.c:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n#include &lt;inttypes.h&gt;\n\n#define TIMESPEC_NSEC(ts) ((ts)-&gt;tv_sec * 1000000000ULL + (ts)-&gt;tv_nsec)\n\nuint64_t realtime_now()\n{\n   struct timespec now_ts;\n   clock_gettime(CLOCK_MONOTONIC, &amp;now_ts);\n   return TIMESPEC_NSEC(&amp;now_ts);\n}\n\nint main() {\n   const char* server_name = \"192.168.1.240\";\n   const int server_port = 8877;\n\n   struct sockaddr_in server_address;\n   memset(&amp;server_address, 0, sizeof(server_address));\n   server_address.sin_family = AF_INET;\n   inet_pton(AF_INET, server_name, &amp;server_address.sin_addr);\n   server_address.sin_port = htons(server_port);\n   int sock;\n   if ((sock = socket(PF_INET, SOCK_DGRAM, 0)) &lt; 0) {\n       printf(\"could not create socket\\n\");\n       return 1;\n   }\n\n  const char* data_to_send = \"...\";\n  struct timespec ts;\n  ts.tv_nsec = 21 *1000*1000;\n  ts.tv_sec =  0;\n  uint64_t t0,t1;\n  while(1)\n  {\n    int len =sendto(sock, data_to_send, strlen(data_to_send), 0,\n                    (struct sockaddr*)&amp;server_address,sizeof(server_address));\n\n    char buffer[100];\n    t0 = realtime_now();\n    recvfrom(sock, buffer, len, 0, NULL, NULL);\n    t1 = realtime_now();\n    printf(\"%\" PRIu64 \"\\n\",t1 - t0);\n    buffer[len] = '\\0';\n    printf(\"recieved: '%s'\\n\", buffer);\n    int err = nanosleep(&amp;ts, NULL);\n    if (err == EINTR)\n    {\n        err = 0;\n    }\n    if(err!=0)\n    {\n        perror(\"nanosleep failed\");\n        break;\n    }\n  }\n  close(sock);\n  return 0;\n }\n</code></pre>\n\n<p>server.c</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) {\n    int SERVER_PORT = 8877;\n    struct sockaddr_in server_address;\n    memset(&amp;server_address, 0, sizeof(server_address));\n    server_address.sin_family = AF_INET;\n    server_address.sin_port = htons(SERVER_PORT);\n    server_address.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    int sock;\n    if ((sock = socket(PF_INET, SOCK_DGRAM, 0)) &lt; 0) {\n        printf(\"could not create socket\\n\");\n        return 1;\n    }\n\n    if ((bind(sock, (struct sockaddr *)&amp;server_address,\n              sizeof(server_address))) &lt; 0) {\n        printf(\"could not bind socket\\n\");\n        return 1;\n    }\n    struct sockaddr_in client_address;\n    socklen_t client_address_len = sizeof(client_address);\n    while (true) {\n        char buffer[100];\n        int len = recvfrom(sock, buffer, sizeof(buffer), 0,\n                           (struct sockaddr *)&amp;client_address,\n                           &amp;client_address_len);\n\n        buffer[len] = '\\0';\n        sendto(sock, buffer, len, 0, (struct sockaddr *)&amp;client_address,\n               sizeof(client_address));\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 5, "creation_date": 1532442082, "post_id": 51501004, "comment_id": 89970308, "body": "In short: no. But this is an <a href=\"https://www.google.co.uk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiD7Pm_97fcAhUR26QKHV0MB0IQFgg0MAE&amp;url=https%3A%2F%2Fmeta.stackexchange.com%2Fquestions%2F66377%2Fwhat-is-the-xy-problem&amp;usg=AOvVaw1RW8UpIl7QYxoW-PU7zAk9\" rel=\"nofollow noreferrer\">XY problem</a>: you think you want to set the limits of some existing types, what you really want is a bignum library."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1532442397, "post_id": 51501004, "comment_id": 89970539, "body": "You have to use or write code for big numbers. For smaller numbers, you could use bit-fields or bit-masks."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532445919, "post_id": 51501004, "comment_id": 89973169, "body": "@davmac: Many people asking about taking a remainder with large numbers are working on some challenge problem, and what they really need is not big-number libraries but to think about is how elementary arithmetic works and how they can use it."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532447189, "post_id": 51501004, "comment_id": 89974079, "body": "@EricPostpischil regardless, it&#39;s an XY problem. The point is, ask about your goal, not about how to achieve one potential solution that (a) might not be possible or practical and (b) might not be the easiest/best solution for the problem. By asking about a particular solution you risk missing out on good and useful information. Fortunately in this case OP elaborated so that we could recognise that this is an XY problem."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532447436, "post_id": 51501004, "comment_id": 89974232, "body": "@davmac: My point is your comment exhibits an XY problem itself. It assumed a particular solution was needed."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532447639, "post_id": 51501004, "comment_id": 89974342, "body": "@EricPostpischil it was intended more an example. If OP can give more details about the goal, we can perhaps give a better answer. Right now &quot;bignum library&quot; looks like a pretty good bet to me. (Although that&#39;s based on &quot;mega-great numbers&quot; which is admittedly contradicted by OP&#39;s follow-up example of 1537849)."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532448202, "post_id": 51501004, "comment_id": 89974715, "body": "@AhmedMagdy: what precisely do you mean by &quot;mega-great numbers&quot;? Your example modulus isn&#39;t very big. Are you asking how to do math (including the modulus operation) with &quot;bigger&quot; numbers than you typically can with C, or is the 1537849 value representative of what you need (in which case using <code>uint64_t</code> should be enough on typical implementations)?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1532456609, "post_id": 51501004, "comment_id": 89979481, "body": "Moreover, why choose C when there are languages that handle big numbers natively, like Python?"}, {"owner": {"reputation": 25, "user_id": 10128402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oOoMGqqZTkk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oUG_me5C6MqJPCPc-1MYzb8wRaCg/mo/photo.jpg?sz=128", "display_name": "Ahmed Magdy", "link": "https://stackoverflow.com/users/10128402/ahmed-magdy"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532540898, "post_id": 51501004, "comment_id": 90018594, "body": "@davmac : obviously 1537849 isn&#39;t a great number, it&#39;s the number to which i want to take the modulus. say some expression theoretically evaluates to 2^1000 (a mega-great number by any standard) and i want (2^1000) modulus 1537849 (a quite modest number). i&#39;m aware my question was ill-formatted but forgive me since i&#39;m completely novice to this site."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1532556299, "post_id": 51501004, "comment_id": 90025190, "body": "@AhmedMagdy What was a bit unclear was &quot;I&#39;m solving some problem which involves some mega-great numbers&quot;, yet all examples <i>started</i> with small-ish numbers like:  1537849, 2, 1000, 1, 64, 63.  For computers, these are not &quot;big&quot; numbers.  The <i>result</i> of the desired function is also small-ish as when all is done, &quot;something mod 1537849&quot; will be in the range [0...1537848].  Numbers like <code>2^1000</code> are <i>derived</i> from your starting numbers.  The point: to get to the result, code need not calculate  <code>2^1000</code>.  Thus the &quot;mega-great numbers&quot; are <i>not</i> needed if all starting numbers fit in <code>uint64_t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532451653, "post_id": 51501052, "comment_id": 89976732, "body": "Suggesting GMP may send OP in the wrong direction, depending on what their problem really is. We ought to learn more about the problem before recommending specific solutions, at least without mentioning alternatives, such as implementing modulo arithmetic in a way that limits the size of numbers needed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532502425, "post_id": 51501052, "comment_id": 89993887, "body": "I don&#39;t think so. From the text of the question, there are already these &quot;mega great numbers&quot; before even wanting to calculate in a ring. If this answer wasn&#39;t correct, it&#39;s the question&#39;s fault."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532519586, "post_id": 51501052, "comment_id": 90004875, "body": "If you search Stack Overflow for \u201c1000000007\u201d, you will find numerous questions where the questioner is attempting some challenge problem that asks them to find some number modulo 1000000007. Quite often, the questioner thinks they must compute some horrendously large number and then take the remainder, when in fact the problems are desgined to be solvable using modest arithmetic. Thus, a na&#239;ve questioner\u2019s assertion that they need to compute the remainder of very large number is not to be trusted without a statement of the actual problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532519733, "post_id": 51501052, "comment_id": 90004984, "body": "@EricPostpischil as far as I&#39;m concerned, if there&#39;s an answerable question, I provide an answer. After all, this is a Q&amp;A site."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532519937, "post_id": 51501052, "comment_id": 90005127, "body": "I have not disputed that you have provided an answer. I have piunted out that your answer fails to consider all that we know about these types of questions, and there is a considerable possibility that this answer will send OP down the wrong path. It is not hard to write an answer that informs a questioner about multiple options and explaining dependencies on what their problem actually is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1532519995, "post_id": 51501052, "comment_id": 90005171, "body": "@EricPostpischil so do it if you must."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 3, "last_activity_date": 1532442050, "creation_date": 1532442050, "answer_id": 51501052, "question_id": 51501004, "link": "https://stackoverflow.com/questions/51501004/setting-ones-own-type-limits-in-c/51501052#51501052", "title": "Setting one&#39;s own type limits in C?", "body": "<blockquote>\n  <p>Can I set my own limits for data types in C?</p>\n</blockquote>\n\n<p>No, short of writing your own compiler and libraries.</p>\n\n<blockquote>\n  <p>I'm solving some problem which involves some mega-great numbers which easily exceed the types' limits</p>\n</blockquote>\n\n<p>There are algorithms for handling huge numbers in parts ... and there are libraries that already do the work for you, e.g. have a look at the <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">GNU multi precision arithmetic library (GMP)</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532447379, "post_id": 51501518, "comment_id": 89974207, "body": "From the question: <i>&quot;I wonder if it&#39;s possible to reset the limits of data types such that the <b>values are automatically taken modulo</b> the number I wish when the outcome of any of the operations exceeds my specified number, <b>just as the processor normally does but with the limits I wish</b>&quot;</i>. My interpretation is that OP is not asking for unlimited wide math, but specifically for math which is <i>automatically</i> modulo some N."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532447944, "post_id": 51501518, "comment_id": 89974535, "body": "(in other words: OP is asking for modulo after every operation, already)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532449438, "post_id": 51501518, "comment_id": 89975482, "body": "@davmac As &quot;possible to reset the limits of data types such that the values are automatically taken modulo the number&quot; for an arbitrary number is not possible to apply a type and OP asked for &quot;if such a thing isn&#39;t possible, what is the most efficient way&quot;, OP is allowing for alternate approaches  and is not barring unlimited wide math.  This answer asserts only N-bit math is needed."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532455173, "post_id": 51501518, "comment_id": 89978710, "body": "I suppose it is unclear whether OP is asking for math that exceeds magnitude of the available integer types - I had assumed they were, but maybe they are not. I have commented on the question to ask for clarification."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 25, "user_id": 10128402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oOoMGqqZTkk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oUG_me5C6MqJPCPc-1MYzb8wRaCg/mo/photo.jpg?sz=128", "display_name": "Ahmed Magdy", "link": "https://stackoverflow.com/users/10128402/ahmed-magdy"}, "edited": false, "score": 0, "creation_date": 1532699057, "post_id": 51501518, "comment_id": 90085385, "body": "@AhmedMagdy you should consider marking this answer as <i>accepted</i> if you feel it is the best useful answer."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1532444017, "last_edit_date": 1532444017, "creation_date": 1532443477, "answer_id": 51501518, "question_id": 51501004, "link": "https://stackoverflow.com/questions/51501004/setting-ones-own-type-limits-in-c/51501518#51501518", "title": "Setting one&#39;s own type limits in C?", "body": "<blockquote>\n  <p>Can I set my own limits for data types in C? </p>\n</blockquote>\n\n<p>The limits of basic types are fixed per the compiler.</p>\n\n<blockquote>\n  <p>I wish to perform many additions and multiplications and to take the final result modulo some desired number, say 1537849</p>\n</blockquote>\n\n<p>At any stage in the addition and multiplication, code can repeatedly perform the modulo.  If the original numbers are N-bit, than at most N-bit math is needed - although it is easier to do with 2N-bit math.  Unlimited wide math is inefficient and not needed for this task.</p>\n\n<p>Example code for <code>+</code>, <code>*</code> and <code>pow()</code> with modulo limitations:<br>\n<a href=\"https://codereview.stackexchange.com/q/187257/29485\">Modular exponentiation without range restriction</a></p>\n\n<pre><code>uintmax_t addmodmax(uintmax_t a, uintmax_t b, uintmax_t mod);\nuintmax_t mulmodmax(uintmax_t a, uintmax_t b, uintmax_t mod);\nuintmax_t powmodmax(uintmax_t x, uintmax_t expo, uintmax_t mod);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10128402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oOoMGqqZTkk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oUG_me5C6MqJPCPc-1MYzb8wRaCg/mo/photo.jpg?sz=128", "display_name": "Ahmed Magdy", "link": "https://stackoverflow.com/users/10128402/ahmed-magdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 51501518, "answer_count": 2, "score": 1, "last_activity_date": 1532788213, "creation_date": 1532441913, "last_edit_date": 1532788213, "question_id": 51501004, "link": "https://stackoverflow.com/questions/51501004/setting-ones-own-type-limits-in-c", "title": "Setting one&#39;s own type limits in C?", "body": "<p>Can I set my own limits for data types in C? I'm solving some problem which involves some mega-great numbers, and I wish to perform many additions and multiplications and to take the final result modulo some desired number, say 1537849. So I wonder if it's possible to reset the limits of data types such that the values are automatically taken modulo the number I wish when the outcome of any of the operations exceeds my specified number, just as the processor normally does but with the limits I wish. And if such a thing isn't possible, what is the most efficient way to negotiate such a problem?</p>\n\n<p>edit:</p>\n\n<p>Consider one would want to calculate (2^1000) % 1537849 and place the result in the variable <code>monster</code>. Below is my attempt to conquer the problem:</p>\n\n<pre><code>uint64_t monster = 1;\nuint32_t power = 1000;\nfor (uint32_t i = 0; i &lt; power; i ++ ) {\n    monster *= 2;\n    if (i%64==63) monster %= 1537849;\n}\nmonster %= 1537849;\n</code></pre>\n\n<p>Is there any better way of doing so (different algorithm, using libraries, whatever ...)??</p>\n"}, {"tags": ["c", "encryption", "sha"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532440521, "post_id": 51500378, "comment_id": 89969151, "body": "What exactly do you mean by <i>&quot;turning your message digest into plain-text&quot;</i>?"}, {"owner": {"reputation": 1, "user_id": 6748371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df37c266945c111e4d78ec938532bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Doku Software", "link": "https://stackoverflow.com/users/6748371/doku-software"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532440584, "post_id": 51500378, "comment_id": 89969200, "body": "Getting the original message back."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532440594, "post_id": 51500378, "comment_id": 89969212, "body": "Digest is kind of &quot;summary&quot;. You can turn &quot;summary&quot; into a full text."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1532440748, "post_id": 51500378, "comment_id": 89969323, "body": "@DokuSoftware you can&#39;t. If the size of the message is say 1Mb, the size of the digest will still be only 64 bytes long. So getting the original 1Mb message back from the 64 bytes digest would be rather miraculous"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532440752, "post_id": 51500378, "comment_id": 89969328, "body": "In other words: 1) Cryptographic hashes such as SHA1 are <i>trapdoor functions</i>. 2) They contain <i>much</i> less information than the hashed data, so many different data can have the same hash. Conclusion - it is impossible to get the plaintext."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532440768, "post_id": 51500378, "comment_id": 89969339, "body": "Unless the original message size &lt;= message digest length, some information must have been lost.  In general, not possible."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532440880, "post_id": 51500378, "comment_id": 89969421, "body": "Hint: read <a href=\"https://en.wikipedia.org/wiki/Cryptographic_hash_function\" rel=\"nofollow noreferrer\">this</a>, or rather <a href=\"http://www.unixwiz.net/techtips/iguide-crypto-hashes.html\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1532440891, "post_id": 51500378, "comment_id": 89969435, "body": "@chux I am pretty sure the information is lost even for small messages, otherwise it would be &quot;easy&quot; to exclude the corresponding hashes from the potential collisions."}, {"owner": {"reputation": 1, "user_id": 6748371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df37c266945c111e4d78ec938532bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Doku Software", "link": "https://stackoverflow.com/users/6748371/doku-software"}, "edited": false, "score": 0, "creation_date": 1532441236, "post_id": 51500378, "comment_id": 89969676, "body": "I made some edits to the post so you can see where the problem is from. I am trying to decrypt and encrypt messages using identity based encryption but I want to get back to a plain-text message not the message digest."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532441263, "post_id": 51500378, "comment_id": 89969694, "body": "Did you even read the previous comments?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532441533, "post_id": 51500378, "comment_id": 89969892, "body": "A message digest algorithm is <i>not</i> an encryption algorithm.  (It is not a compression algorithm, either).  It is not reversible.  Moreover, it&#39;s not just that no one has written the inverse algorithm yet -- it is specifically <i>designed</i> to be impossible to write that inverse algorithm.  That&#39;s the whole point.  (If you find a way to reverse it, you have &quot;cracked&quot; it; it was broken.)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532441715, "post_id": 51500378, "comment_id": 89970046, "body": "@EugeneSh.: Hashes are not trapdoor functions. A trapdoor function is one that is easy to compute in the forward direction but is hard to compute in the reverse direction unless you have special information, called the trapdoor. Hashes are many-to-one functions. Trapdoor functions are generally one-to-one functions (which is implied by the fact that they are invertible)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532442107, "post_id": 51500378, "comment_id": 89970335, "body": "@EricPostpischil You are right, have to brush up the terminology..."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 4, "last_activity_date": 1532442100, "creation_date": 1532442100, "answer_id": 51501073, "question_id": 51500378, "link": "https://stackoverflow.com/questions/51500378/sha1-message-digest-to-plain-text/51501073#51501073", "title": "SHA1 Message digest to plain-text", "body": "<p>First, it is mathematically impossible to recover an original message from a message digest. A message digest is a <strong>small</strong> amount of information that is intended to act as a sort of fingerprint for a <strong>large</strong> amount of information. For example, in one of the simplest forms, a message digest might be simply the sum of the numerical values of the characters in a message. You obviously cannot recover the original message just from the sum of its characters. (Two messages that are anagrams would have the same sum, so the sum would not tell you which of the two messages was the original. And a message changed by increasing one character and decreasing another would have the same sum as the original message, so, again, the sum would not distinguish them.) This is just an example\u2014actual cryptographic hashes are more complicated than simple sums.</p>\n\n<p>Second, cryptographic hashes and the message digests they produce are usually <strong>designed</strong> to be difficult to invert. It is intended to be difficult to find <strong>any</strong> message whose digest equals a given value.</p>\n\n<p>If you want cryptographic functions that change a message to a cryptic form and then invert it, you are looking for <strong>encryption</strong> and <strong>decryption</strong>, not hashes or digests.</p>\n"}, {"tags": [], "owner": {"reputation": 4747, "user_id": 611560, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/25ee461bdf2849f6db82054c73192ea1?s=128&d=identicon&r=PG", "display_name": "Yann Droneaud", "link": "https://stackoverflow.com/users/611560/yann-droneaud"}, "is_accepted": false, "score": 0, "last_activity_date": 1532453049, "creation_date": 1532453049, "answer_id": 51504383, "question_id": 51500378, "link": "https://stackoverflow.com/questions/51500378/sha1-message-digest-to-plain-text/51504383#51504383", "title": "SHA1 Message digest to plain-text", "body": "<p>If you know every possible messages beforehand, you have the list of every of them, you can produces the SHA-1 digests for each, hoping there's no collision (btw, if you found one, please share). Then, at receive time, you lookup which SHA-1 you received and match with the known possible messages.</p>\n\n<p>It's not secure, as an observer could identify the behavior of your system in the response of every SHA-1, or it could have access to the database of known message.</p>\n\n<p>So it's almost pointless.</p>\n\n<p>You could assign each message a arbitrary number, it would work the same, and it would be faster and shorter.</p>\n"}], "owner": {"reputation": 1, "user_id": 6748371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df37c266945c111e4d78ec938532bdd?s=128&d=identicon&r=PG&f=1", "display_name": "Doku Software", "link": "https://stackoverflow.com/users/6748371/doku-software"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 51501073, "answer_count": 2, "score": 0, "last_activity_date": 1532453049, "creation_date": 1532440254, "last_edit_date": 1532441118, "question_id": 51500378, "link": "https://stackoverflow.com/questions/51500378/sha1-message-digest-to-plain-text", "title": "SHA1 Message digest to plain-text", "body": "<p>How can I turn my message digest into plain-text (getting the original message back). I compute a message digest using the following function. The SHA1 code can be found in <a href=\"https://github.com/tylabs/quicksand_lite/blob/master/sha1.c\" rel=\"nofollow noreferrer\">https://github.com/tylabs/quicksand_lite/blob/master/sha1.c</a> I can not find a function that will make the conversion for me. Is there any algorithm that can do this?</p>\n\n<p>I am also trying to decrypt and encrypt messages this is where the problem comes from. </p>\n\n<pre><code>int main()\n{\n\n  char qbits[5];\n  char rbits[5];\n  char ID[SIZE];   //User ID\n  char message[SIZE];   //User message\n  char shamessage[SIZE]; //The input message digest(sha1 result)\n\n  char xor_result[SIZE]; //Sender XOR result---V\n  char xor_result_receiver[SIZE];  //Receiver XOR result\n  memset(xor_result, 0, sizeof(char)*SIZE);\n  memset(xor_result_receiver, 0, sizeof(char)*SIZE);\n\n\n  pairing_t pairing;   //The pair of bilinear map\n\n  element_t P, Ppub, s, U, Qid, Sid;\n  mpz_t messagehash;\n  mpz_init(messagehash);\n\n  printf(\"\\n############SETUP############\\n\");\n    printf(\"Please enter rbits:\");\n  scanf(\"%[0-9]\", rbits);\n    getchar();\n  printf(\"\\nPlease enter qbits:\");\n  scanf(\"%[0-9]\", qbits);\n    getchar();\n\n  setup_sys(atoi(rbits), atoi(qbits), P, Ppub, pairing, s);\n  printf(\"System parameters have been set!\\n\");\n  element_printf(\"P = %B\\n\", P);\n  element_printf(\"Ppub = %B\\n\", Ppub);\n\n\n    printf(\"###########EXTRACT###########\\n\");\n    element_init_G1(Qid, pairing);\n  element_init_G1(Sid, pairing);\n  printf(\"Plase enter your ID:\");\n  scanf(\"%[ a-zA-Z0-9+*-!.,&amp;*@{}$#]\", ID);\n  printf(\"\\nID=%s\\n\", ID);\n    getchar();\n    get_private_key(ID, pairing, s, Sid);\n  get_public_key(ID, pairing, Qid);\n  printf(\"##########ENCRPTION##########\\n\");\n    printf(\"\\nPlase enter the message to encrypt:\");\n  scanf(\"%[ a-zA-Z0-9+*-!.,&amp;*@{}$#]\", message);\n  getchar();\n  printf(\"The original message=%s\", message);\n\n    sha_fun(message, shamessage);   //Get the message digest\n  printf(\"\\nThe message hash=%s\\n\", shamessage);\n\n    element_init_G1(U, pairing);\n  encryption(shamessage, ID, P, Ppub, U, xor_result, pairing);\n  printf(\"Send &lt;U,V&gt; to the receiver!\\n\");\n\n  printf(\"##########DECRYPTION##########\");\n  decryption(Sid, pairing, U, xor_result, xor_result_receiver);\n  printf(\"\\nThe recovery message digest is %s\\n\", xor_result_receiver);\n  printf(\"The original message digest is %s\\n\", shamessage);\n\n  if (strcmp(xor_result_receiver, shamessage) == 0) {\n\n    printf(\"Yeah!The message has been decrpted!\\n\");\n  }\n\n  else {\n    printf(\"Oops!The message can not be decrpted!\\n\");\n  }\n\n  //Free space\n  element_clear(P);\n  element_clear(Ppub);\n  element_clear(Qid);\n  element_clear(Sid);\n  element_clear(U);\n  element_clear(s);\n  pairing_clear(pairing);\n\n  return 0;\n}\n</code></pre>\n\n<p>And my output is a message digest but I need it to be plain-text. </p>\n\n<pre><code>############SETUP############\nPlease enter rbits:6\n\nPlease enter qbits:6\nSystem parameters have been set!\nP = [456, 103]\nPpub = [176, 88]\n###########EXTRACT###########\nPlase enter your ID:friedrich12\n\nID=friedrich12\nPrivate key Sid = [184, 383]\n\nPublic key Qid = [99, 84]\n##########ENCRPTION##########\n\nPlase enter the message to encrypt:code\nThe original message=code\nThe message hash=E6FB06210FAFC02FD7479DDBED2D042CC3A5155E\nU = [456, 103]\nPublic key Qid = [99, 84]\n\nV=3D958162F64322BFC65D7655DFE6B61D89945F35\nSend &lt;U,V&gt; to the receiver!\n##########DECRYPTION##########\nThe recovery message digest is E6FB06210FAFC02FD7479DDBED2D042CC3A5155E\nThe original message digest is E6FB06210FAFC02FD7479DDBED2D042CC3A5155E\nYeah!The message has been decrpted!\n</code></pre>\n"}, {"tags": ["c", "r", "ode", "compiled-language"], "comments": [{"owner": {"reputation": 9402, "user_id": 1552004, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/8Wmgh.png?s=128&g=1", "display_name": "Lyngbakr", "link": "https://stackoverflow.com/users/1552004/lyngbakr"}, "edited": false, "score": 0, "creation_date": 1533053991, "post_id": 51500318, "comment_id": 90201410, "body": "How complex is your actual system of equations compared to the one you present above? The reason I ask is that \u2013 in my experience \u2013 there is only a substantial reduction in run time when using <code>ode</code> with C when the calculation of the derivatives is quite complex (e.g., 40 coupled, nonlinear ODEs). For the situation above, I would think about other ways of reducing run time before investing the effort in recoding the model, such as requesting less precision (i.e., <code>atol</code>, <code>rtol</code>) or alternative ODE solvers (e.g., <code>vode</code> can be fast)."}, {"owner": {"reputation": 457, "user_id": 1704801, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49c93116545b825b3c8350b2254b7cca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/1704801/pascal"}, "reply_to_user": {"reputation": 9402, "user_id": 1552004, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/8Wmgh.png?s=128&g=1", "display_name": "Lyngbakr", "link": "https://stackoverflow.com/users/1552004/lyngbakr"}, "edited": false, "score": 0, "creation_date": 1533109541, "post_id": 51500318, "comment_id": 90220255, "body": "It has around 10 ODEs. Thanks for the tips."}], "owner": {"reputation": 457, "user_id": 1704801, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49c93116545b825b3c8350b2254b7cca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/1704801/pascal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532442343, "creation_date": 1532440087, "last_edit_date": 1532442343, "question_id": 51500318, "link": "https://stackoverflow.com/questions/51500318/speed-up-parallelised-solving-of-ode-containing-events", "title": "Speed up parallelised solving of ODE containing events", "body": "<p>The following code represents a simplified version of my actual problem:</p>\n\n<pre class=\"lang-r prettyprint-override\"><code># Libraries\nlibrary(desolve)\nlibrary(parallel)\n\n# End time\nmax_time &lt;- 300\n\n# Time vector\ntime &lt;- seq(0, max_time, 0.1)\n\n# Number of events\nn_events &lt;- c(6, 60, 600, 6000)\n\n# p1 values\np1_vars &lt;- 10^c(-4, -2, 0, 2)\n\n# Parameters\np &lt;- data.frame(p1 = 1.14*24,\n                p2 = 0.14*24,\n                p3 = 0.06*24,\n                p4 = 0.5,\n                p5 = 0.05,\n                p6 = 0,\n                p7 = 0.218,\n                p8 = 0.477,\n                p9 = 0.5/6)\n\n# Initial conditions\nx0 &lt;- c(x1 = 0,\n        x2 = 0,\n        x3 = 2e11,\n        x4 = 8e11)\n\n# Model\nsys &lt;- function(t, y, p) {\n  dy = numeric(4)\n\n  dy[1] = p$p2*y[2] - (p$p3 + p$p1)*y[1]\n  dy[2] = p$p3*y[1] - p$p2*y[2]\n  dy[3] = (p$p4 - p$p7 - p$p8)*y[3] + p$p5*y[4] - p$p9*y[1]*y[3]\n  dy[4] = p$p7*y[3] - (p$p5 + p$p6)*y[4]\n  list(dy)\n}\n\n# Number of corse to parallelise\nn_cores &lt;- detectCores() - 1\n\n# Initialise\ninput.df &lt;- data.frame(eventfreq = rep(n_events/max_time, length(p1_vars)),\n                       par = rep(p1_vars, each = length(n_events)))\n\nres.df &lt;- data.frame(eventfreq = NaN,\n                     par = NaN,\n                     out = NA)\n\n# Parallel function\npar_fcn &lt;- function(i) {\n\n  # p1 value\n  p$p1 &lt;- input.df$par[i]\n\n  # Event value\n  ev_val &lt;- 1000/input.df$eventfreq[i]*max_time\n\n  # Events\n  ev &lt;- data.frame(var = 'x1',\n                   time = seq(0, max_time, by = 1/input.df$eventfreq[i]),\n                   value = 100,\n                   method = 'add')\n\n  # Solve ODE\n  sim.df &lt;- as.data.frame(ode(y = x0, times = time, func = sys, p = p, events = list(data = ev)))\n\n  # Fill\n  res.df$eventfreq &lt;- input.df$eventfreq[i]\n  res.df$par &lt;- input.df$par[i]\n  res.df$out &lt;- sim.df$x3 + sim.df$x4\n\n  # Return\n  return(res.df)\n}\n\n# Evaluate in parallel\nres_parallel &lt;- mclapply(seq_len(nrow(input.df)), par_fcn, mc.cores = n_cores)\nout.df &lt;- do.call(rbind, res_parallel)\n</code></pre>\n\n<p>As you can see, I try to solve an ODE with <code>desolve</code> for a range of parameter values and different number of events. Even though, I parallelised the code and spread it across 7 cores, my actual problem still takes very long. I've identified the ODE solver as the bottleneck, especially when the number of events gets large.</p>\n\n<p>Are there any ideas how this code could be speeded up?</p>\n\n<p>I've also been looking into implementing this in compiled code according to the vignette <a href=\"https://cran.r-project.org/web/packages/deSolve/vignettes/compiledCode.pdf\" rel=\"nofollow noreferrer\">R Package deSolve: Writing Code in Compiled Languages</a>. But I'm too inexperienced in C to do it completely on my own.</p>\n\n<p>Here's what I got so far:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/*file model.c */\n#include &lt;R.h&gt;\nstatic double p[9];\n#define p1 p[0]\n#define p2 p[1]\n#define p3 p[2]\n#define p4 p[3]\n#define p5 p[4]\n#define p6 p[5]\n#define p7 p[6]\n#define p8 p[7]\n#define p9 p[8]\n\n/* initialiser */\nvoid initmod(void (*odeparms)(int *, double *))\n{\n    int N = 9;\n    odeparms(&amp;N, p);\n}\n\n/* Events */\nvoid event(int *n, double *t, double *y)\n{\n    y[0] = y[0] + 100;\n}\n\n/* Derivatives */\nvoid derivs (int *neq, double *t, double *y, double *ydot, double *yout, int *ip)\n{\n    if (ip[0] &lt; 1) error(\"nout should be at least 1\");\n    ydot[0] = p2*y[1] - (p3 + p1)*y[0];\n    ydot[1] = p3*y[0] - p2*y[1];\n    ydot[2] = (p4 - p7 - p8)*y[2] + p5*y[3] - p9*y[0]*y[2];\n    ydot[3] = p7*y[2] - (p5 + p6)*y[3];\n\n    yout[0] = y[0];\n    yout[1] = y[2] + y[3];\n}\n\n/* END file model.c */\n</code></pre>\n\n<p>Therein, I especially can't follow the vignette of how to pass the <code>n_events</code> and <code>p1_vars</code> parameter to the C code.</p>\n\n<p>Any help or hints would be greatly appreciated.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532439385, "post_id": 51499996, "comment_id": 89968275, "body": "For such small programs you should start using a debugger to see where it fails."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532439410, "post_id": 51499996, "comment_id": 89968297, "body": "the <i>described</i> logic looks fine to me. The code is at least overcomplicated, have a look at the <code>strcpy()</code> function. And then: give a testcase that actually fails!"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532439454, "post_id": 51499996, "comment_id": 89968341, "body": "Isn&#39;t your compiler giving you warnings? It should."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 4, "creation_date": 1532439496, "post_id": 51499996, "comment_id": 89968376, "body": "You shall not forget to allocate memory for terminating <code>&#39;\\0&#39;</code> byte of strings!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1532439514, "post_id": 51499996, "comment_id": 89968398, "body": "obvious bug: <code>strcat(s2, s2);</code> -&gt; <code>strcat(str2, s2);</code>. .. and <code>strstr()</code> should be called on your <b>local</b> strings. And yes, room for the terminator is missing in your local strings."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532439588, "post_id": 51499996, "comment_id": 89968443, "body": "Why do you copy in a <code>while</code> loop instead of using <code>strcpy</code>? Or why do you copy <code>s1</code> at all?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532440159, "post_id": 51499996, "comment_id": 89968872, "body": "well, what the program is <b>trying</b> to do: <a href=\"https://ideone.com/q0SFEM\" rel=\"nofollow noreferrer\">ideone.com/q0SFEM</a>"}, {"owner": {"reputation": 1094, "user_id": 5476399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0F2n.jpg?s=128&g=1", "display_name": "blkpingu", "link": "https://stackoverflow.com/users/5476399/blkpingu"}, "edited": false, "score": 0, "creation_date": 1532442915, "post_id": 51499996, "comment_id": 89970893, "body": "how about including a stacktrace?"}], "answers": [{"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1532489704, "last_edit_date": 1532489704, "creation_date": 1532488793, "answer_id": 51510315, "question_id": 51499996, "link": "https://stackoverflow.com/questions/51499996/if-a-string-is-rotation-of-other-all-test-cases-not-running/51510315#51510315", "title": "If a string is rotation of other. All test cases Not running", "body": "<p>You are just copying from one string to another, and the copy routine has several problems. </p>\n\n<ol>\n<li><p><code>char str1[l1]</code> is not large enough. It should be <code>char str1[l1 + 1]</code>. The extra 1 is for the null character. </p></li>\n<li><p>The string should always end  with null character <code>'\\0'</code>. </p></li>\n<li><p><code>s1</code> and <code>s2</code> are incremented until they reach the null character, so by that time <code>s1</code> and <code>s2</code> are empty. </p></li>\n</ol>\n\n<p>Try the following code for copying the strings, you will see <code>s1/s2</code> will be empty, <code>str1/str2</code> are just copies of the original <code>s1/s2</code>.</p>\n\n<p>You can fix the copying as follows:</p>\n\n<pre><code>char str1[l1 + 1], str2[l2 + 1];\n\nint i;\ni = 0;\nwhile(*s1 != '\\0')\n{\n    str1[i] = *s1;\n    i++;\n    s1++;\n}\nstr1[i] = '\\0';\n\ni = 0;\nwhile(*s2 != '\\0')\n{\n    str2[i] = *s2;\n    i++;\n    s2++;\n}\nstr2[i] = '\\0';\n\nprintf(\"s1=%s, s2=%s, str1=%s, str2=%s\\n\", s1, s2, str1, str2);\n//output: s1=, s2=, str1=old_s1, str2=old_s2\n</code></pre>\n\n<p>But this doesn't really achieve anything. If you just want to check <code>\"rahul\"</code> is the reverse of <code>\"hulra\"</code>, keep <code>s1</code> as it is, copy <code>s2</code> to <code>reverse_s2</code> in reverse order, and compare the two strings as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint ifRotation(const char *s1, const char *s2)\n{\n    if(!s1 || !s2)\n        return 0;\n\n    int len2 = strlen(s2);\n    char reverse_s2[len2 + 1];\n\n    //copy s2 to reverse_s2 in reverse order:\n    int i = 0;\n    for(i = 0; i &lt; len2; i++)\n        reverse_s2[i] = s2[len2 - i - 1];\n    reverse_s2[i] = '\\0'; //add null character\n\n    int result = strcmp(s1, reverse_s2) == 0;\n\n    return result;\n}\n\nint main(void) \n{\n    printf(\"%d\\n\", ifRotation(\"rahul\", \"hulra\"));\n    printf(\"%d\\n\", ifRotation(\"rahul\", \"luhar\"));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 9814782, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rahul Ranjan", "link": "https://stackoverflow.com/users/9814782/rahul-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532489704, "creation_date": 1532439203, "last_edit_date": 1532439886, "question_id": 51499996, "link": "https://stackoverflow.com/questions/51499996/if-a-string-is-rotation-of-other-all-test-cases-not-running", "title": "If a string is rotation of other. All test cases Not running", "body": "<p>I am using the logic of concatenation the 2nd string and then searching first string in it.\nBut for some reason, the code does not run for all test cases.</p>\n\n<p><strong>example</strong> </p>\n\n<pre><code>s1 = rahul , s2 = hulra\n\ns2.s2 = hulrahulra\n</code></pre>\n\n<p>and then search <code>s1</code> in <code>s2.s2</code> using <code>strstr()</code> function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nint ifRotation(char *s1, char *s2)\n{\n    int l1 = strlen(s1);\n    int l2 = strlen(s2);\n\n    char str1[l1], str2[l2+ l2];\n\n    int i;\n    i = 0;\n\n    while(*s1 != '\\0')\n    {\n        str1[i] = *s1;\n        i++;\n        s1++;   \n    }\n    i = 0;\n    while(*s2 != '\\0')\n    {\n        str2[i] = *s2;\n        i++;\n        s2++;   \n    }\n\n    strcat(s2, s2);\n\n    if(strstr(s2, s1))\n    {\n        return 1;\n    }\n    return 0;\n}\n\nint main() {\n    //code\n\n    int queries;\n\n    scanf(\"%d\", &amp;queries);\n    int array[queries];\n    char str1[100];\n    char str2[100];\n    int i = 0;\n    while(i &lt; queries)\n    {\n        scanf(\"%s\", &amp;str1);\n        scanf(\"%s\", &amp;str2);\n        array[i] = ifRotation(str1, str2);\n        i++;\n    }\n\n    i = 0;\n    while(i &lt; queries)\n    {\n        printf(\"%d\\n\", array[i]);\n        i++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Please tell me what's wrong with the code?</p>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1532438591, "post_id": 51499747, "comment_id": 89967653, "body": "The only way to &quot;assign&quot; arrays is to <code>memcpy</code> (or loop)."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 3, "creation_date": 1532438871, "post_id": 51499747, "comment_id": 89967877, "body": "Do you want it the C (dbushs answer) or C++ (Igors answer) way?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1532439032, "post_id": 51499747, "comment_id": 89967994, "body": "With Verilog you work with hardware, on programming language you work with CPU and CPU usually do not have instructions to do such bit manipulaton (and it is usually not necessary). Probably is  it not a good idea to move logic from Verilog to C one by one."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1532439070, "post_id": 51499747, "comment_id": 89968021, "body": "@hellow He got both :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1532439155, "post_id": 51499747, "comment_id": 89968074, "body": "Apart from what @Slava said - what could be a purpose of rewriting Verilog code in C (unless it is SystemC) ?"}, {"owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1532439178, "post_id": 51499747, "comment_id": 89968101, "body": "@Slava That&#39;s true but I&#39;m writing this code for <a href=\"https://en.wikipedia.org/wiki/High-level_synthesis\" rel=\"nofollow noreferrer\">HLS</a> so the C will be converted to gates, not executed with a CPU."}, {"owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532439269, "post_id": 51499747, "comment_id": 89968190, "body": "@EugeneSh. Obfuscation and timing closure."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532439286, "post_id": 51499747, "comment_id": 89968208, "body": "@CharlesClayton Then you probably shouldn&#39;t blindly &quot;translate&quot; the code, but rewrite using statements optimized for HLS and use corresponding paradigms.."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1532439785, "post_id": 51499747, "comment_id": 89968583, "body": "Then you explicitly should mention that from the begining, and I hardly doubt that C++ is applicable here"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1532443068, "post_id": 51499747, "comment_id": 89971001, "body": "You should pick a language, <code>C</code> or <code>C++</code> ? Which one are you actually rewriting in?"}], "answers": [{"comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 3, "creation_date": 1532438962, "post_id": 51499802, "comment_id": 89967942, "body": "Note that in C++ this won&#39;t work if the type of array elements is not trivially-copyable. In C, of course, everything is trivially copyable."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1532438674, "creation_date": 1532438674, "answer_id": 51499802, "question_id": 51499747, "link": "https://stackoverflow.com/questions/51499747/how-to-succinctly-assign-a-range-of-one-array-to-a-range-of-another-array/51499802#51499802", "title": "How to succinctly assign a range of one array to a range of another array?", "body": "<p>You can use <code>memcpy</code> to copy multiple array elements:</p>\n\n<pre><code>memcpy(&amp;data_out[index*WIDTH], &amp;data_in[i*WIDTH], WIDTH*sizeof(*data_in));\n</code></pre>\n\n<p>The first parameter is the destination memory address, the second is the source address, and the third is the number of bytes to copy.  </p>\n\n<p>Note that you need to multiply the number of element by the size of an element in bytes to get the total byte count.</p>\n"}, {"comments": [{"owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 1, "creation_date": 1532442153, "post_id": 51499808, "comment_id": 89970370, "body": "This is the preferred answer for C++. But it is not applicable to C."}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 5, "last_activity_date": 1532438682, "creation_date": 1532438682, "answer_id": 51499808, "question_id": 51499747, "link": "https://stackoverflow.com/questions/51499747/how-to-succinctly-assign-a-range-of-one-array-to-a-range-of-another-array/51499808#51499808", "title": "How to succinctly assign a range of one array to a range of another array?", "body": "<p>Something along these lines:</p>\n\n<pre><code>std::copy(data_in + i*WIDTH, data_in + (i+1)*WIDTH, data_out + index*WIDTH);\n</code></pre>\n\n<p>or equivalently</p>\n\n<pre><code>std::copy(&amp;data_in[i*WIDTH], &amp;data_in[i*WIDTH]+WIDTH, &amp;data_out[index*WIDTH]);\n</code></pre>\n"}], "owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 51499808, "answer_count": 2, "score": 2, "last_activity_date": 1532438857, "creation_date": 1532438537, "last_edit_date": 1532438857, "question_id": 51499747, "link": "https://stackoverflow.com/questions/51499747/how-to-succinctly-assign-a-range-of-one-array-to-a-range-of-another-array", "title": "How to succinctly assign a range of one array to a range of another array?", "body": "<p><strong>Background reading</strong></p>\n\n<p>I'm re-writing some Verilog code in C/C++, and in Verilog you can do something like this:</p>\n\n<pre><code>for (i = 0; i &lt; N; i = i + 1) begin\n     if (condition(i)) begin\n          data_out[index*WIDTH +: WIDTH] = data_in[i*WIDTH +: WIDTH];\n          index = index + 1;\n     end\nend\n</code></pre>\n\n<p>Where at this line:</p>\n\n<pre><code>data_out[index*WIDTH +: WIDTH] = data_in[i*WIDTH +: WIDTH];\n</code></pre>\n\n<p>We're saying assign the section of <code>data_in</code> starting at position <code>i*WIDTH</code> up to <code>i*WIDTH + WIDTH - 1</code> to the section of <code>data_out</code> starting at position <code>index*WIDTH</code> up to <code>index*WIDTH + WIDTH - 1</code>. </p>\n\n<p>Similarly, in Python I could do something like this:</p>\n\n<pre><code>&gt;&gt;&gt; arr1 = ['a', 'b', 'c', 'd']\n&gt;&gt;&gt; arr2 = [1, 2, 3, 4, 5]\n&gt;&gt;&gt; \n&gt;&gt;&gt; arr1[1:3] = arr2[0:2]\n&gt;&gt;&gt; \n&gt;&gt;&gt; print arr1, arr2\n['a', 1, 2, 'd'] [1, 2, 3, 4, 5]       \n</code></pre>\n\n<p>I know I can write this in C by using an extra loop:</p>\n\n<pre><code>for (i = 0; i &lt; N; i = i + 1) {\n      if (condition(i)) {\n           for (k = 0; k &lt; WIDTH; k = k + 1) {\n               data_out[index*WIDTH + k] = data_in[i*WIDTH + k];\n           }\n           index = index + 1;\n      }\n }\n</code></pre>\n\n<p>But this is a little tedious when these assignments happen quite often and in nested loops. I'm hoping there's a smarter way.</p>\n\n<p><strong>Question</strong></p>\n\n<p>Is there a succinct way to write:</p>\n\n<pre><code>arr1[INDEX_A to INDEX_B] = arr2[INDEX_C to INDEX_D];\n</code></pre>\n\n<p>or </p>\n\n<pre><code>arr1[STARTING_POSITION_A to SOME_WIDTH] = arr2[STARTING_POSITION_B to SOME_WIDTH];\n</code></pre>\n\n<p>I'm specifically interested in an array of <em>booleans</em> if that simplifies the problem. </p>\n\n<p>I can also use C++ for this, but would prefer if the code used simple data types and arrays instead of vectors because it's getting synthesized to hardware and the simpler it is the easier that is. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532435320, "post_id": 51498397, "comment_id": 89965143, "body": "&quot;Foo1.c and Bar1.c are used in Foobar1.c and they are included in the Foobar.h&quot; You call your include files *.c?"}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1532435386, "post_id": 51498397, "comment_id": 89965184, "body": "It can be done with only one make file. I think you need to create intermediate object file. You are missing a -o for building the objects, you need to not make an executable, compile only. (is that a -C option?) You do not need LIBS stuff for the object files. Im not sure you can have multiple C files to one object simply. I would expect to see one object file for each c file. Lots more improvements after that."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1532435510, "post_id": 51498397, "comment_id": 89965266, "body": "Looks like you should sort the contents of your code - you seem to have the same function declared in multiple files"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1532435833, "post_id": 51498397, "comment_id": 89965499, "body": "Is that makefile exactly what you used? It seems to lack <code>-o</code> arguments for some targets ..."}, {"owner": {"reputation": 1, "user_id": 10126269, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ff-NCpkm6ns/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rgbWL1-DsN-tCsdOEcz-k7oYXVbQ/mo/photo.jpg?sz=128", "display_name": "Falcon AMS", "link": "https://stackoverflow.com/users/10126269/falcon-ams"}, "edited": false, "score": 0, "creation_date": 1532436050, "post_id": 51498397, "comment_id": 89965648, "body": "I&#39;m pretty sure that is not the case, I have only used one definition for each function, and I have #ifndef, #define and #endif  in the .h files."}, {"owner": {"reputation": 1, "user_id": 10126269, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ff-NCpkm6ns/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rgbWL1-DsN-tCsdOEcz-k7oYXVbQ/mo/photo.jpg?sz=128", "display_name": "Falcon AMS", "link": "https://stackoverflow.com/users/10126269/falcon-ams"}, "edited": false, "score": 0, "creation_date": 1532436060, "post_id": 51498397, "comment_id": 89965653, "body": "Do you mean that I should have -o for every target in the makefile, or only for the execution target"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1532436920, "post_id": 51498397, "comment_id": 89966276, "body": "The error messages say otherwise - it is clearly saying that <code>Foo1_func1</code> is declared in &quot;main.c&quot; and &quot;Foobar.c&quot; and possibly elsewhere too"}, {"owner": {"reputation": 1, "user_id": 10126269, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ff-NCpkm6ns/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rgbWL1-DsN-tCsdOEcz-k7oYXVbQ/mo/photo.jpg?sz=128", "display_name": "Falcon AMS", "link": "https://stackoverflow.com/users/10126269/falcon-ams"}, "edited": false, "score": 0, "creation_date": 1532437186, "post_id": 51498397, "comment_id": 89966471, "body": "But my main.c has only includes for the folder1/Foobar1.h and folder2/Foo2.h  and in the main function is only printf(&quot;hello&quot;); so i think it&#39;s somthing with linking files"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1532437789, "post_id": 51498397, "comment_id": 89967058, "body": "So which file contains <code>Foo1_func1</code> then?"}, {"owner": {"reputation": 1, "user_id": 10126269, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ff-NCpkm6ns/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rgbWL1-DsN-tCsdOEcz-k7oYXVbQ/mo/photo.jpg?sz=128", "display_name": "Falcon AMS", "link": "https://stackoverflow.com/users/10126269/falcon-ams"}, "edited": false, "score": 0, "creation_date": 1532437988, "post_id": 51498397, "comment_id": 89967203, "body": "the decleration in Foo1.c , and Foobar1.c use Foo1.func1"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532438446, "post_id": 51498397, "comment_id": 89967544, "body": "Is creating a makefile something you are required to do?  If not, you may want to consider using an integrated development environment (IDE) such as <i><a href=\"http://www.codeblocks.org/downloads/26\" rel=\"nofollow noreferrer\">Code::Blocks</a></i>, or <i><a href=\"https://www.eclipse.org/downloads/\" rel=\"nofollow noreferrer\">Eclipse</a></i>.  In an IDE such as these, the work of the makefile is removed from the developer for the most part, thus removing its complexities from the effort of creating a project."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1532438702, "post_id": 51498397, "comment_id": 89967732, "body": "Because this is your post, all comments under it will automatically flag you as the recipient, but you need to specify explicitly who you are responding to.  So when replying to a specific commentor, you can direct your response to the right person by proceeding their moniker with an ampersand at the beginning of your reply, i.e. such as:  @ryyker - No, I am not required to use a makefile..."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1532445901, "post_id": 51498397, "comment_id": 89973155, "body": "And which header file has the prototype for <code>Foo1_func1</code> that you&#39;re using to tell Foobar1.c about the function?"}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1532445353, "post_id": 51501659, "comment_id": 89972705, "body": "That isn&#39;t running the executable - that&#39;s compiling it into an executable called &quot;run&quot;"}, {"owner": {"reputation": 140, "user_id": 7686412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f40f26fd471e5b444ee89c8af5a938b?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7686412/mary"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1533126658, "post_id": 51501659, "comment_id": 90230810, "body": "Yep, I know. I just paste the wrong parts in the code."}], "tags": [], "owner": {"reputation": 140, "user_id": 7686412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f40f26fd471e5b444ee89c8af5a938b?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7686412/mary"}, "is_accepted": false, "score": 0, "last_activity_date": 1532443814, "creation_date": 1532443814, "answer_id": 51501659, "question_id": 51498397, "link": "https://stackoverflow.com/questions/51498397/c-makefile-with-subfolders-and-several-c-files-error-ld/51501659#51501659", "title": "C makefile with subfolders and several .c files (error. ld)", "body": "<p>You're running the executable (.o) without first compile the .c</p>\n\n<pre><code>run: main.o Foobar1.o Foo2.o\n    $(CC) main.o Foobar1.o Foo2.o -o run $(LIBS)\n</code></pre>\n\n<p>[...]</p>\n\n<p>And here you should rm using *.o, its safer.</p>\n\n<pre><code>clean:\n    rm -rf *o run\n</code></pre>\n\n<p>The right order is:\n1 - .h  (library) \n2 - .c (code)\n3 - .o (executable)</p>\n"}], "owner": {"reputation": 1, "user_id": 10126269, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ff-NCpkm6ns/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rgbWL1-DsN-tCsdOEcz-k7oYXVbQ/mo/photo.jpg?sz=128", "display_name": "Falcon AMS", "link": "https://stackoverflow.com/users/10126269/falcon-ams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532443814, "creation_date": 1532434545, "last_edit_date": 1532434661, "question_id": 51498397, "link": "https://stackoverflow.com/questions/51498397/c-makefile-with-subfolders-and-several-c-files-error-ld", "title": "C makefile with subfolders and several .c files (error. ld)", "body": "<p>I'm trying to create a makefile for my project but it's not working at all.\nI have the following directory structure</p>\n\n<pre><code>projectroot\n   |\n   |-----main.c\n   |\n   |-----makefile\n   |\n   |-----folder1\n   |       |\n   |       |-----Foobar1.c\n   |       |-----Foo1.c\n   |       |-----Bar1.c\n   |       |-----Foobar1.h\n   |\n   |-----folder2\n   |       |-----Foo2.c\n   |       |-----Foo2.h\n</code></pre>\n\n<p>Foo1.c and Bar1.c are used in Foobar1.c and they are included in the Foobar.h and it workes if i run them (Foobar1.c) in the folder1 directory.</p>\n\n<p>The main.c is useing functions from both Foobar1.c and Foo2.c </p>\n\n<pre><code>CC = gcc \nCFLAGS = -c -Wall\nLIBS = -lm\nall: run\n\nrun: main.o Foobar1.o Foo2.o\n    $(CC) main.o Foobar1.o Foo2.o -o run $(LIBS)\n\nmain.o: main.c\n    $(CC) $(CFLAGS) main.c $(LIBS)\n\nFoobar1.o: folder1/Foobar1.c folder1/Foo1.c folder1/Bar1.c\n    $(CC) $(CFLAGS) folder1/Foobar1.c folder1/Foo1.c folder1/Bar1.c $(LIBS)\n\nFoo2.o: folder2/Foo2.c\n    $(CC) $(CFLAGS) folder2/Foo2.c $(LIBS)\n\nclean:\n    rm -rf *o run\n</code></pre>\n\n<p>I tried to create a Makefile for whole project in the root directory and I got this error:</p>\n\n<pre><code>gcc -Wall main.c -lm\ngcc -Wall folder1/Foobar1.c folder1/Foo1.c folder1/Bar1.c -lm\ngcc -Wall folder2/Foo2.c  -lm\ngcc main.o Foobar1.o Foo2.o -o run -lm\n\nFoobar.o: In function 'Foo1_func1':\nFoobar.c: (.text+0x0): multiple definitions of 'Foo1_func1'\nmain.o:main.c:(.text+0x0): first defined here\n\nFoobar.o: In function 'Bar1_func1':\nFoobar.c: (.text+0x6a4): multiple definitions of 'Bar1_func1'\nmain.o:main.c:(.text+0x6a4): first defined here\n\nFoobar.o: In function 'Bar1_func2':\nFoobar.c: (.text+0xed8): multiple definitions of 'Bar1_func2'\nmain.o:main.c:(.text+0xed8): first defined here\n\ncollect2: error: ld returned 1 exit status\nmakefile:13: recipe for target \"run\" failed\nmake: *** [run] error 1\n</code></pre>\n\n<p>and I also tried to create a makefile for each sub-folder and one in the root directory it did work for the sub-makefile but I don't know how to write the root makefile I tried with this</p>\n\n<p>in folder1</p>\n\n<pre><code>CC = gcc \nCFLAGS = -c -Wall\nLIBS = -lm\nall: bar\n\nbar: Foobar1.o\n    $(CC) Foobar1.o -o bar $(LIBS)\nFoobar1.o: Foobar1.c Foo1.c Bar1.c\n    $(CC) $(CFLAGS) Foobar1.c $(LIBS)\nclean:\n    rm -rf *o bar\n</code></pre>\n\n<p>in folder2</p>\n\n<pre><code>CC = gcc \nCFLAGS = -c -Wall\nLIBS = -lm\nall: foo\n\nfoo: Foo2.o\n    $(CC) Foo2.o -o bar $(LIBS)\nFoo2.o: Foo2.c \n    $(CC) $(CFLAGS) Foo2.c $(LIBS)\nclean:\n    rm -rf *o foo\n</code></pre>\n\n<p>and in the root directory. is it the correct way to do this?</p>\n\n<pre><code>CC = gcc \nCFLAGS = -c -Wall\nLIBS = -lm\nall:\n    +$(MAKE) -C folder1\n    +$(MAKE) -C folder2\nrun: main.o folder1/Foobar1.o folder2/Foo2.o\n    $(CC) main.o folder1/Foobar1.o folder2/Foo2.o -o run $(LIBS)\nmain.o: main.c\n     $(CC) $(CFLAGS) main.c $(LIBS)\nclean:\n    rm -rf *o run\n</code></pre>\n\n<p>Please help, it is my first time to write a makefile. </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10127613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b66c276e2588c50e4d5a78f2f4532b?s=128&d=identicon&r=PG&f=1", "display_name": "N.A.", "link": "https://stackoverflow.com/users/10127613/n-a"}, "edited": false, "score": 0, "creation_date": 1532437730, "post_id": 51498792, "comment_id": 89967001, "body": "Thank You. At first I did try to make it global with declaration <code>MPI_GETSET msg</code> which was not working, since it was defined later in <code>main()</code>. But when I set (as global var.) <code>MPI_Datatype MPI_GETSET</code> it compiles."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "reply_to_user": {"reputation": 1, "user_id": 10127613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b66c276e2588c50e4d5a78f2f4532b?s=128&d=identicon&r=PG&f=1", "display_name": "N.A.", "link": "https://stackoverflow.com/users/10127613/n-a"}, "edited": false, "score": 0, "creation_date": 1532509929, "post_id": 51498792, "comment_id": 89998510, "body": "Sure, feel free to accept this answer if it solved your problem."}], "tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": false, "score": 1, "last_activity_date": 1532435764, "creation_date": 1532435764, "answer_id": 51498792, "question_id": 51498367, "link": "https://stackoverflow.com/questions/51498367/error-variable-not-declared-inside-function/51498792#51498792", "title": "error: variable not declared inside function", "body": "<p>The scope of <code>MPI_GETSET</code> is the <code>main()</code> subroutine.</p>\n\n<p>A direct consequence is this variable is not defined inside the <code>get()</code> subroutine.</p>\n\n<p>You basically have two options in order to move forward :</p>\n\n<ul>\n<li>pass <code>MPI_GETSET</code> as a <strong>parameter</strong> of the <code>get()</code> subroutine</li>\n<li>declare <code>MPI_GETSET</code> as a <strong>global variable</strong></li>\n</ul>\n\n<p>If your compiler is recent enough (note you might need some extra flags), a third option would be to declare the <code>get()</code> subroutine <strong>inside</strong> the <code>main()</code> subroutine.\n(feel free to refer to <a href=\"https://stackoverflow.com/questions/2608158/nested-function-in-c\">Nested function in C</a>)</p>\n"}], "owner": {"reputation": 1, "user_id": 10127613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b66c276e2588c50e4d5a78f2f4532b?s=128&d=identicon&r=PG&f=1", "display_name": "N.A.", "link": "https://stackoverflow.com/users/10127613/n-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532436536, "creation_date": 1532434421, "last_edit_date": 1532436536, "question_id": 51498367, "link": "https://stackoverflow.com/questions/51498367/error-variable-not-declared-inside-function", "title": "error: variable not declared inside function", "body": "<p>The problem is that MPI structure declared inside main() is not visible inside functions. Compiler gives following error:</p>\n\n<pre><code>my_prog.c: In function \u2018void get(int)\u2019:\nmy_prog.c:585:21: error: \u2018MPI_GETSET\u2019 was not declared in this scope\nMPI_Send(&amp;msg, 1, MPI_GETSET, rank, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p>Code sections are:</p>\n\n<pre><code>struct mpi_send{\n  int job;\n  int z;\n  int img;\n  short grp;\n  short stp;\n};\n\nmpi_send msg;\n\nint main(int argc, char** argv) {\n    MPI_Init(&amp;argc, &amp;argv);\n...\n    MPI_Datatype MPI_GETSET;\n    MPI_Datatype type[5] = {MPI_INT,MPI_INT,MPI_INT,MPI_SHORT,MPI_SHORT};\n    int blocklen[5] = {1,1,1,1,1};\n    MPI_Aint disp[5];\n    disp[0]=sizeof(int); disp[1]=sizeof(int); disp[2]=sizeof(int);\n    disp[3]=sizeof(short); disp[4]=sizeof(short);\n    MPI_Type_create_struct(5, blocklen, disp, type, &amp;MPI_GETSET);\n    MPI_Type_commit(&amp;MPI_GETSET);\n...\n    get(13);\n}\n\nvoid get(int z){\n...\n    MPI_Send(&amp;msg, 1, MPI_GETSET, rank, 0, MPI_COMM_WORLD);\n    MPI_Recv(&amp;msg, 1, MPI_GETSET, rank, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n...\n}\n</code></pre>\n\n<p>I would appreciate clarification why I can not use MPI_GETSET inside functions.\nThanks in advance.</p>\n"}, {"tags": ["c", "assembly", "compiler-construction", "compiler-optimization"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1532434336, "post_id": 51498309, "comment_id": 89964447, "body": "What optimization level is the compiler set to?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532434537, "post_id": 51498309, "comment_id": 89964573, "body": "Most likely because you compile without optimisation, try using the <code>-O4</code> flag (assuming you use gcc or clang)"}, {"owner": {"reputation": 274, "user_id": 9830700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fygNx.jpg?s=128&g=1", "display_name": "Riolku", "link": "https://stackoverflow.com/users/9830700/riolku"}, "edited": false, "score": 0, "creation_date": 1532435360, "post_id": 51498309, "comment_id": 89965171, "body": "How can I compile with the most optimization?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1532435414, "post_id": 51498309, "comment_id": 89965201, "body": "@Riolku Depends on your compiler.  With gcc and clang, <code>-O3</code> should do the trick."}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1532435563, "post_id": 51498309, "comment_id": 89965305, "body": "See also <a href=\"https://stackoverflow.com/questions/14666665/trying-to-understand-gcc-option-fomit-frame-pointer\" title=\"trying to understand gcc option fomit frame pointer\">stackoverflow.com/questions/14666665/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 274, "user_id": 9830700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fygNx.jpg?s=128&g=1", "display_name": "Riolku", "link": "https://stackoverflow.com/users/9830700/riolku"}, "edited": false, "score": 2, "creation_date": 1532435566, "post_id": 51498580, "comment_id": 89965308, "body": "@Riolku That&#39;s to align the stack to 16 bytes for the call to <code>puts</code> as required by the ABI."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 1, "creation_date": 1532435665, "post_id": 51498580, "comment_id": 89965381, "body": "@ThomasJager why -O4 and not just -O3? AFAIK any number above 3 has no further effect."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1532435725, "post_id": 51498580, "comment_id": 89965417, "body": "@davmac I couldn&#39;t remember where it ended, so I went with the comment by Jabberwocky on the question."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 274, "user_id": 9830700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fygNx.jpg?s=128&g=1", "display_name": "Riolku", "link": "https://stackoverflow.com/users/9830700/riolku"}, "edited": false, "score": 0, "creation_date": 1532437609, "post_id": 51498580, "comment_id": 89966870, "body": "@Riolku I&#39;ve edited the answer to answer this, based on the comments"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1532442977, "post_id": 51498580, "comment_id": 89970938, "body": "The x86-64 System V ABI has <i>always</i> required 16-byte stack-alignment, hasn&#39;t it?  Is that &quot;since gcc4.5&quot; claim talking about 32-bit code, or am I mistaken?  <a href=\"https://stackoverflow.com/q/49391001\">Why does System V / AMD64 ABI mandate a 16 byte stack alignment?</a>.  I think it was around gcc4.1 / 4.2 that <code>gcc -m32</code> started assuming 16-byte stack alignment."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1532443108, "post_id": 51498580, "comment_id": 89971040, "body": "@PeterCordes According to what I&#39;ve seen, the patches to align at 16 bytes instead of 4 were officially added in 4.5, but I&#39;ve edited to avoid talking about things I don&#39;t really know."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1532443633, "post_id": 51498580, "comment_id": 89971420, "body": "They were definitely in by 4.4.7, if <a href=\"https://godbolt.org/g/vEKY78\" rel=\"nofollow noreferrer\">godbolt.org/g/vEKY78</a> is any indication.  <code>-mpreferred-stack-boundary=2</code> changes the code-gen to not reserve as much stack in a non-leaf function that just calls a one-arg function, even in 4.1.2.  And 4.4.7 properly handles <code>__attribute__((aligned(32)))</code> (unlike 4.1).  Anyway, this is all for <code>-m32</code>; I don&#39;t think <code>-m64</code> ever did less than 16-byte alignment."}, {"owner": {"reputation": 274, "user_id": 9830700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fygNx.jpg?s=128&g=1", "display_name": "Riolku", "link": "https://stackoverflow.com/users/9830700/riolku"}, "edited": false, "score": 0, "creation_date": 1532447672, "post_id": 51498580, "comment_id": 89974367, "body": "Compiling with -O3, my code does the following: <code>mov edi, OFFSET FLAT hello</code> <code>jmp puts</code>  this is even more optimized :P"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1532460605, "post_id": 51498580, "comment_id": 89981401, "body": "@PeterCordes : I believe GCC 4.5 was the release where the default for GCC was <code>-mpreferred-stack-boundary=4</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1532460804, "post_id": 51498580, "comment_id": 89981509, "body": "@MichaelPetch: You&#39;re still talking about <code>-m32</code>, right?  Anyway, my testing on Godbolt shows that <i>those</i> builds of gcc behave like <code>-mpreferred-stack-boundary=4</code>.  But maybe 4.4.7 backported the patch from 4.5?  Or maybe Matt configured the old gcc versions with more modern configs?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1532460857, "post_id": 51498580, "comment_id": 89981537, "body": "Yes, I said that in the context of <code>-m32</code>, as 64-bit has always had a minimum 16 byte alignment."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1532461607, "post_id": 51498580, "comment_id": 89981888, "body": "@PeterCordes Looking at GCC release history 4.5.0 was released ~2 years before 4.4.7 was released.I&#39;ll bet that 4.4.7 included the change to the default stack boundary"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 274, "user_id": 9830700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fygNx.jpg?s=128&g=1", "display_name": "Riolku", "link": "https://stackoverflow.com/users/9830700/riolku"}, "edited": false, "score": 1, "creation_date": 1532461950, "post_id": 51498580, "comment_id": 89982070, "body": "@Riolku: a tail-call is only possible in a <code>void</code> function like <code>void foo(){puts(&quot;msg&quot;);}</code>, or if you do <code>return puts(&quot;msg&quot;);</code> in <code>main</code>.  Otherwise the implicit <code>return 0</code> at the end of <code>main</code> means that an optimized tail-call isn&#39;t possible."}], "tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": true, "score": 2, "last_activity_date": 1532443040, "last_edit_date": 1532443040, "creation_date": 1532435086, "answer_id": 51498580, "question_id": 51498309, "link": "https://stackoverflow.com/questions/51498309/why-does-main-initialize-stack-frame-when-there-are-no-variables/51498580#51498580", "title": "Why does main initialize stack frame when there are no variables", "body": "<p>Having these steps in every compiled function is the \"baseline\" for the compiler, unoptimized. It looks clean in disassembly, and makes sense. However, the compiler can optimize the output to reduce overhead from code that has no real effect. You can see this by compiling with different optimization levels.</p>\n\n<p>What you got is like <a href=\"https://godbolt.org/g/kX4TAZ\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>.LC0:\n  .string \"Hello, World!\"\nmain:\n  push rbp\n  mov rbp, rsp\n  mov edi, OFFSET FLAT:.LC0\n  call puts\n  mov eax, 0\n  pop rbp\n  ret\n</code></pre>\n\n<p>That's compiled in GCC with no optimization.</p>\n\n<p>Adding the flag -O4 gives <a href=\"https://godbolt.org/g/yKia7E\" rel=\"nofollow noreferrer\">this</a> output:</p>\n\n<pre><code>.LC0:\n  .string \"Hello, World!\"\nmain:\n  sub rsp, 8\n  mov edi, OFFSET FLAT:.LC0\n  call puts\n  xor eax, eax\n  add rsp, 8\n  ret\n</code></pre>\n\n<p>You'll notice that this still moves the stack pointer, but it skips changing the base pointer, and avoid the time-consuming memory access associated with that.</p>\n\n<p>The stack is assumed to be aligned on a 16-byte boundary. With the return address having been pushed, this leaves another 8 bytes to be subtracted to get to the boundary before the function call.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 0, "last_activity_date": 1532435102, "creation_date": 1532435102, "answer_id": 51498585, "question_id": 51498309, "link": "https://stackoverflow.com/questions/51498309/why-does-main-initialize-stack-frame-when-there-are-no-variables/51498585#51498585", "title": "Why does main initialize stack frame when there are no variables", "body": "<p>It's very common for compilers to generate unoptimized code in the least complicated way possible (or at least the least complicated way that doesn't lead to code that's so bad that the optimizer won't be able to fix it) to keep the code simple and to stick to the one-responsibility principle (in the sense that making code more efficient is the optimizer's job).</p>\n\n<p>Generating code to initialize the stack for all functions is less complicated than only doing so where necessary. Since the optimizer will be able to remove the unnecessary code anyway (and it will do so in more cases than a simple \"does this function have any local variables?\" check would), generating the unnecessary code won't have any effect as long as optimizations are enabled (and if they're not, it's expected that the generated code will contain inefficiencies).</p>\n\n<p>If we did add a \"does this function have any local variables?\" check to the function that generates the stack-initialization code, we'd be re-inventing a less powerful version of an optimization that the optimizer already performs anyway, so we'd be violating the one-responsibility principle and increasing the complexity of the part of the compiler that could otherwise be relatively simple (as opposed to the optimizer, which is full of complicated algorithms anyway).</p>\n"}, {"tags": [], "owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "is_accepted": false, "score": 0, "last_activity_date": 1532436354, "creation_date": 1532436354, "answer_id": 51498995, "question_id": 51498309, "link": "https://stackoverflow.com/questions/51498309/why-does-main-initialize-stack-frame-when-there-are-no-variables/51498995#51498995", "title": "Why does main initialize stack frame when there are no variables", "body": "<p>The stack frame makes it possible to inspect the call stack during runtime. This is useful:</p>\n\n<ul>\n<li>when debugging</li>\n<li>in code that relies on <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Return-Address.html\" rel=\"nofollow noreferrer\">__builtin_frame_address</a>(<em>level</em>) with <em>level</em> > 0</li>\n</ul>\n\n<p>As already pointed out by others, a compiler may omit the stackframe on higher optimization levels.<br>\nSee also:\n<a href=\"https://stackoverflow.com/questions/14735010/how-do-you-get-gccs-builtin-frame-address-to-work-with-o2\">How do you get gcc&#39;s __builtin_frame_address to work with -O2?</a></p>\n"}], "owner": {"reputation": 274, "user_id": 9830700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fygNx.jpg?s=128&g=1", "display_name": "Riolku", "link": "https://stackoverflow.com/users/9830700/riolku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 51498580, "answer_count": 3, "score": 1, "last_activity_date": 1532443040, "creation_date": 1532434265, "question_id": 51498309, "link": "https://stackoverflow.com/questions/51498309/why-does-main-initialize-stack-frame-when-there-are-no-variables", "title": "Why does main initialize stack frame when there are no variables", "body": "<p>why does this code:</p>\n\n<pre><code>#include \"stdio.h\"\nint main(void) {\n    puts(\"Hello, World!\");\n}\n</code></pre>\n\n<p>decide to initialize a stack frame? Here is the assembly code:</p>\n\n<pre><code>.LC0:\n        .string \"Hello, World!\"\nmain:\n        push    rbp\n        mov     rbp, rsp\n        mov     edi, OFFSET FLAT:.LC0\n        call    puts\n        mov     eax, 0\n        pop     rbp\n        ret\n</code></pre>\n\n<p>Why does the compiler initialize a stack frame only for it to be destroyed later, withoput it ever being used? This surely wont cause any errors on the outside of the main function because I never use the stack, so I wont cause any errors. Why is it compiled this way?</p>\n"}, {"tags": ["c", "linux", "cat"], "comments": [{"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 0, "creation_date": 1532433533, "post_id": 51497978, "comment_id": 89963860, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16163154/read-from-pipe-line-by-line-in-c\">read from pipe line by line in c</a>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1532434117, "post_id": 51497978, "comment_id": 89964288, "body": "&quot;but i&#39;ve always used <code>scanf</code>only from keyboard input.&quot; In that case <code>stdin</code> was reading from your keyboard. But still it was <code>stdin</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1532436483, "post_id": 51497978, "comment_id": 89965948, "body": "<code>cat</code> should be completely unrelated, your first snippet is a classical <a href=\"http://porkmail.org/era/unix/award.html\" rel=\"nofollow noreferrer\">useless use of cat</a>. (correct command: <code>.&#47;main &lt;input_000.txt &gt;my_output.txt</code>)"}, {"owner": {"reputation": 705, "user_id": 9593060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892710857405653/picture?type=large", "display_name": "Mattia Surricchio", "link": "https://stackoverflow.com/users/9593060/mattia-surricchio"}, "edited": false, "score": 0, "creation_date": 1532436887, "post_id": 51497978, "comment_id": 89966252, "body": "@FelixPalmen Why is it useless? I&#39;m reporting the command given by our professor. The input txt goes into C code (which act as a filter) and print the result into the second txt. <a href=\"http://www.linfo.org/cat.html\" rel=\"nofollow noreferrer\">link</a> here there&#39;s a similar example &#39;cat file1 file2 file3 | sort &gt; file4&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1532437027, "post_id": 51497978, "comment_id": 89966344, "body": "@MattiaSurricchio well, follow my link. In short, the shell can feed a file to <code>stdin</code>, that&#39;s what input redirection is for. <code>cat</code> is for concatenating, if you only read a single file, it&#39;s most of the time useless -- and costs you another process."}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 9593060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892710857405653/picture?type=large", "display_name": "Mattia Surricchio", "link": "https://stackoverflow.com/users/9593060/mattia-surricchio"}, "edited": false, "score": 0, "creation_date": 1532434013, "post_id": 51498017, "comment_id": 89964194, "body": "In order to save the output, i can both use fwrite(stdout) and printf?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 705, "user_id": 9593060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892710857405653/picture?type=large", "display_name": "Mattia Surricchio", "link": "https://stackoverflow.com/users/9593060/mattia-surricchio"}, "edited": false, "score": 1, "creation_date": 1532465634, "post_id": 51498017, "comment_id": 89983795, "body": "@MattiaSurricchio Do you mean that you want to save the output from <code>printf</code> (and other functions writing to <code>stdout</code>) to also write to a file? Then I suggest you use <a href=\"http://man7.org/linux/man-pages/man1/tee.1.html\" rel=\"nofollow noreferrer\">the <code>tee</code> command</a> instead of redirecting your output."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1532434309, "last_edit_date": 1532434309, "creation_date": 1532433469, "answer_id": 51498017, "question_id": 51497978, "link": "https://stackoverflow.com/questions/51497978/use-cat-command-with-c-code/51498017#51498017", "title": "Use Cat command with C code", "body": "<p>That's how pipes works, it sets up so the output of the left-hand side of the pipe will be written to standard input for the right-hand side program.</p>\n\n<p>In short if you can read input from <code>stdin</code> (like you do with plain <code>scanf</code>) then you won't have to do any changes at all.</p>\n\n<p>Redirection works just about the same. Redirecting to a file (<code>&gt;</code>) will make all writes to <code>stdout</code> go to the file. Redirecting from a file (<code>&lt;</code>) will make all reads from <code>stdin</code> come from the file.</p>\n"}, {"tags": [], "owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1532433563, "creation_date": 1532433563, "answer_id": 51498053, "question_id": 51497978, "link": "https://stackoverflow.com/questions/51497978/use-cat-command-with-c-code/51498053#51498053", "title": "Use Cat command with C code", "body": "<p>You can use getline (or <code>scanf</code> indeed) to read the <code>stdin</code> (fd = 0) and save it in a <code>char*</code> in your C code... Then you only need to write in the <code>stdout</code> (fd = 1) and your <code>&gt;</code> will do the job to write in your file</p>\n"}, {"tags": [], "owner": {"reputation": 140, "user_id": 7686412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f40f26fd471e5b444ee89c8af5a938b?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7686412/mary"}, "is_accepted": false, "score": 1, "last_activity_date": 1532444891, "creation_date": 1532444891, "answer_id": 51502033, "question_id": 51497978, "link": "https://stackoverflow.com/questions/51497978/use-cat-command-with-c-code/51502033#51502033", "title": "Use Cat command with C code", "body": "<p>What you need is something like this inside your function...</p>\n\n<pre><code>FILE *input = fopen(\"input.txt\",\"rw\"); //rw (read-write)\nFILE *output= fopen(\"output.txt\",\"rw\"); //rw (read-write)\nchar inputArray[500];\nchar outputArray[500];\n\nwhile(fscanf(input,\"%s\", inputArray) != EOF){\n      //read the line and save in 'inputArray'\n      //you can also use %c to find each caracter, in your case I think it's better...you can //save each caracter in a array position, or something like that\n}\n\nwhile(number of lines you need or the number of lines from your input file){\n      fprintf(output,\"%s\\n\",output); //this will write the string saved in 'outputArray'\n}\n</code></pre>\n\n<p>If you don't want to use it...then you can give your main.c the input using &lt; and saving the output ></p>\n\n<p>./main.o &lt; input.txt > output.txt </p>\n\n<p>(something like that, its not safer because the terminal could have the settings to use other type of charset...</p>\n"}], "owner": {"reputation": 705, "user_id": 9593060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892710857405653/picture?type=large", "display_name": "Mattia Surricchio", "link": "https://stackoverflow.com/users/9593060/mattia-surricchio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5410, "favorite_count": 0, "accepted_answer_id": 51498017, "answer_count": 3, "score": 0, "last_activity_date": 1550750500, "creation_date": 1532433351, "question_id": 51497978, "link": "https://stackoverflow.com/questions/51497978/use-cat-command-with-c-code", "title": "Use Cat command with C code", "body": "<p>I'm using the cat command for a school project. </p>\n\n<p>What i need is to give a txt file as input to my code and then evaluate the output (saved in a txt file).\nSo far i'm using this in my command line:</p>\n\n<pre><code>cat input_000.txt | ./main &gt; my_output.txt\n</code></pre>\n\n<p>Where ./main is my C code.</p>\n\n<p>The input_000.txt is structured like this:</p>\n\n<pre><code>0 a a R 3\n1 a b L 4\n4 c b R 1\necc...\n</code></pre>\n\n<p>I have a certain number of lines made of 5 characters (with spaces between them).</p>\n\n<p>How do i get the content of each line in my C code? I've been told so use standard input, but i've always used <code>scanf</code>only from keyboard input.</p>\n\n<p>Does it still work in this case? </p>\n\n<p>And how should i save my output? I usually use <code>fwrite</code>, but in this case is everything managed by the <code>cat</code> command</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1532432301, "post_id": 51497563, "comment_id": 89963032, "body": "Please show your code as well as the verbatim error message. Read this <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1532438962, "post_id": 51497563, "comment_id": 89967941, "body": "Before it printed &quot;linker command failed with exit code 1&quot; there were some other lines, likely including words like &quot;Undefined symbols&quot; and &quot;symbol(s) not found&quot;.  What did those lines say?"}, {"owner": {"reputation": 1542, "user_id": 443136, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/96f1ca62e16935890751ea3b4d7d84c8?s=128&d=identicon&r=PG", "display_name": "Valerio Santinelli", "link": "https://stackoverflow.com/users/443136/valerio-santinelli"}, "edited": false, "score": 0, "creation_date": 1532444892, "post_id": 51497563, "comment_id": 89972351, "body": "You should post the code that you&#39;re running so that we can help you"}, {"owner": {"reputation": 1, "user_id": 10127608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da00b0d0b9a678b412d73b35b996be1?s=128&d=identicon&r=PG", "display_name": "Hazardkadam251999", "link": "https://stackoverflow.com/users/10127608/hazardkadam251999"}, "edited": false, "score": 0, "creation_date": 1532664492, "post_id": 51497563, "comment_id": 90068525, "body": "I have added clarification guys, thank you for helping, Ask other things if needed but I really need to get this working"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10127608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da00b0d0b9a678b412d73b35b996be1?s=128&d=identicon&r=PG", "display_name": "Hazardkadam251999", "link": "https://stackoverflow.com/users/10127608/hazardkadam251999"}, "edited": false, "score": 0, "creation_date": 1532689070, "post_id": 51553102, "comment_id": 90079628, "body": "Thank you very much, This worked. Just answer me, How can I type other programs in the same folder or project without this error occuring. Sorry I am new to this and Thank you very much."}, {"owner": {"reputation": 4299, "user_id": 5329717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NOuLF.png?s=128&g=1", "display_name": "Kamil.S", "link": "https://stackoverflow.com/users/5329717/kamil-s"}, "reply_to_user": {"reputation": 1, "user_id": 10127608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da00b0d0b9a678b412d73b35b996be1?s=128&d=identicon&r=PG", "display_name": "Hazardkadam251999", "link": "https://stackoverflow.com/users/10127608/hazardkadam251999"}, "edited": false, "score": 0, "creation_date": 1532689232, "post_id": 51553102, "comment_id": 90079718, "body": "@Hazardkadam251999 to write code broken into multiple files you should get familiar with the concept of <code>headers</code> aka <code>.h</code> files in <code>C</code> language and your function names must be unique. This goes beyond your original question though."}, {"owner": {"reputation": 1, "user_id": 10127608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da00b0d0b9a678b412d73b35b996be1?s=128&d=identicon&r=PG", "display_name": "Hazardkadam251999", "link": "https://stackoverflow.com/users/10127608/hazardkadam251999"}, "edited": false, "score": 0, "creation_date": 1532689355, "post_id": 51553102, "comment_id": 90079790, "body": "yes I am learning that now  and thank you very much for helping"}], "tags": [], "owner": {"reputation": 4299, "user_id": 5329717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NOuLF.png?s=128&g=1", "display_name": "Kamil.S", "link": "https://stackoverflow.com/users/5329717/kamil-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1532691828, "last_edit_date": 1532691828, "creation_date": 1532677190, "answer_id": 51553102, "question_id": 51497563, "link": "https://stackoverflow.com/questions/51497563/xcode-mach-o-linker-id-error/51553102#51553102", "title": "Xcode Mach-O Linker ID error", "body": "<p>XCode standard template for command line project in C language contains <code>main.c</code> which contains example implementation:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, const char * argv[]) {\n    // insert code here...\n    printf(\"Hello, World!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>You haven't shown us your project file structure but I assume you didn't remove <code>main.c</code> from your project. Your screenshot indicates you created <code>Example.c</code> also containing <code>main()</code> function definition. In <code>C</code> language all functions are on the same flat global level (there no are namespaces &amp; classes) hence the <code>linker</code> (final stage of crafting an executable) complains about duplicated <code>_main</code> symbol. To solve this problem you should either:</p>\n\n<ol>\n<li>Move your test code in main function from <code>Example.c</code> to the <code>main.c</code> one. And get rid of <code>Example.c</code> whatsoever.</li>\n<li>Rename your function in <code>Example.c</code> to <strong>something else</strong> than <code>main()</code> and call it inside <code>int main(int argc, const char * argv[])</code> in <code>main.c</code>.</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 10127608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da00b0d0b9a678b412d73b35b996be1?s=128&d=identicon&r=PG", "display_name": "Hazardkadam251999", "link": "https://stackoverflow.com/users/10127608/hazardkadam251999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1532691828, "creation_date": 1532432084, "last_edit_date": 1532667511, "question_id": 51497563, "link": "https://stackoverflow.com/questions/51497563/xcode-mach-o-linker-id-error", "title": "Xcode Mach-O Linker ID error", "body": "<p>I am new to xcode an I am trying to learn C Language using Xcode. When I try to run it I get error apple mach- o linker and link command failed with exit code 1. I dont understand other answers on stack overflow about removing pods or library paths. Please Help and tell me each and every step to fix this error.\n{Edit}\nSorry for the very little information. Here is the code and the error</p>\n\n<p><a href=\"https://i.stack.imgur.com/RM15Y.png\" rel=\"nofollow noreferrer\"><code>The Code which was Simple</code></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/8txR2.png\" rel=\"nofollow noreferrer\">Click here for The error which is disturbing</a></p>\n\n<pre><code>    Ld /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Products/Debug/Education normal x86_64\n    cd /Users/pratikkadam/Documents/GitHub/Education\n    export MACOSX_DEPLOYMENT_TARGET=10.13\n    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch x86_64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk -L/Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Products/Debug -F/Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Products/Debug -filelist /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Intermediates.noindex/Education.build/Debug/Education.build/Objects-normal/x86_64/Education.LinkFileList -Xlinker -rpath -Xlinker @executable_path/../Frameworks -Xlinker -rpath -Xlinker @loader_path/../Frameworks -mmacosx-version-min=10.13 -Xlinker -object_path_lto -Xlinker /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Intermediates.noindex/Education.build/Debug/Education.build/Objects-normal/x86_64/Education_lto.o -Xlinker -export_dynamic -Xlinker -no_deduplicate -fobjc-link-runtime -L/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift_static/macosx -Xlinker -force_load_swift_libs -lc++ -framework Foundation -Xlinker -add_ast_path -Xlinker /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Intermediates.noindex/Education.build/Debug/Education.build/Objects-normal/x86_64/Education.swiftmodule -Xlinker -dependency_info -Xlinker /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Intermediates.noindex/Education.build/Debug/Education.build/Objects-normal/x86_64/Education_dependency_info.dat -o /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Products/Debug/Education\n\nduplicate symbol _main in:\n    /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Intermediates.noindex/Education.build/Debug/Education.build/Objects-normal/x86_64/Example.o\n    /Users/pratikkadam/Library/Developer/Xcode/DerivedData/Education-dhazvkwqsporefgyqgfaxhlzhscj/Build/Intermediates.noindex/Education.build/Debug/Education.build/Objects-normal/x86_64/main.o\nld: 1 duplicate symbol for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n"}, {"tags": ["python", "c++", "c", "linux", "data-structures"], "comments": [{"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1532431697, "post_id": 51497357, "comment_id": 89962652, "body": "Do you care whether e.g. <code>char *branch</code> is a valid pointer?"}, {"owner": {"reputation": 743, "user_id": 10021094, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hOsAzTvp3OY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3qaF7JQwaEdJHQp3np6K8YQQMGFA/mo/photo.jpg?sz=128", "display_name": "Kai Guther", "link": "https://stackoverflow.com/users/10021094/kai-guther"}, "edited": false, "score": 5, "creation_date": 1532431832, "post_id": 51497357, "comment_id": 89962743, "body": "Is it feasible to define default constructors for all the structs that fill the members with random values?"}, {"owner": {"reputation": 165, "user_id": 5354674, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHJgbdkBHc8/AAAAAAAAAAI/AAAAAAAAABQ/Ctl7q3eTOe8/photo.jpg?sz=128", "display_name": "Mayank Kataruka", "link": "https://stackoverflow.com/users/5354674/mayank-kataruka"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1532432150, "post_id": 51497357, "comment_id": 89962939, "body": "yes @pbn,  it must be a valid pointer."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 2, "creation_date": 1532432232, "post_id": 51497357, "comment_id": 89962982, "body": "Well then they are not <code>random values</code>"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 5, "creation_date": 1532432412, "post_id": 51497357, "comment_id": 89963108, "body": "Why is it tagged C++, C AND python?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1532432446, "post_id": 51497357, "comment_id": 89963141, "body": "@MayankKataruka: A valid pointer to a random string? Like: generate a random string, and then <code>str(n)cpy</code> it to the struct so you have a valid pointer? Why? I can&#39;t even..."}, {"owner": {"reputation": 165, "user_id": 5354674, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHJgbdkBHc8/AAAAAAAAAAI/AAAAAAAAABQ/Ctl7q3eTOe8/photo.jpg?sz=128", "display_name": "Mayank Kataruka", "link": "https://stackoverflow.com/users/5354674/mayank-kataruka"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1532432715, "post_id": 51497357, "comment_id": 89963338, "body": "@pbn  char *branch = &quot;some_random_value&quot;; Now branch will contain a pointer to this string."}, {"owner": {"reputation": 165, "user_id": 5354674, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHJgbdkBHc8/AAAAAAAAAAI/AAAAAAAAABQ/Ctl7q3eTOe8/photo.jpg?sz=128", "display_name": "Mayank Kataruka", "link": "https://stackoverflow.com/users/5354674/mayank-kataruka"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1532432748, "post_id": 51497357, "comment_id": 89963365, "body": "@YSC , I was looking for a solution, even a script should be fine"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1532440076, "post_id": 51497357, "comment_id": 89968796, "body": "Some language environments have reflection, which lets you write a program that can dynamically determine the names and types of variables in nested structures, and set the values. If you want to do something similar for C, you need to parse the structure definitions and generate code."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 5001502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153410573162710/picture?type=large", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/5001502/ben-jones"}, "edited": false, "score": 1, "creation_date": 1532440419, "post_id": 51498495, "comment_id": 89969072, "body": "This is the only &quot;simple&quot; way to do this... but I wouldn&#39;t recommend it!"}], "tags": [], "owner": {"reputation": 816, "user_id": 1254598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d414cfcb5ebe38af8e65acbe8ad02a0a?s=128&d=identicon&r=PG", "display_name": "Sunil Shahu", "link": "https://stackoverflow.com/users/1254598/sunil-shahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1532440254, "last_edit_date": 1532440254, "creation_date": 1532434822, "answer_id": 51498495, "question_id": 51497357, "link": "https://stackoverflow.com/questions/51497357/traverse-my-data-structure-and-enter-random-values-to-it/51498495#51498495", "title": "Traverse my data structure, and enter random values to it", "body": "<p>Following pseudo code will assign random values. However, the pointers will not be valid pointers! It just fills the whole memory area with sequential values. </p>\n\n<pre><code>unsigned long int i;        // in case your structure is too Big!\nstruct MediaAuthType_e *my_MediaAuthType_e;\nmy_MediaAuthType_e = malloc(sizeof(struct MediaAuthType_e));\nchar *tmp = (char *)my_MediaAuthType_e;\n\nfor(i = 0; i &lt; sizeof(struct MediaAuthType_e); i++)\n{\n    *tmp = (i%255);         // Assign some values at each byte, use your logic to assign random values.\n    tmp++;\n}\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5354674, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHJgbdkBHc8/AAAAAAAAAAI/AAAAAAAAABQ/Ctl7q3eTOe8/photo.jpg?sz=128", "display_name": "Mayank Kataruka", "link": "https://stackoverflow.com/users/5354674/mayank-kataruka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532440254, "creation_date": 1532431431, "last_edit_date": 1532436629, "question_id": 51497357, "link": "https://stackoverflow.com/questions/51497357/traverse-my-data-structure-and-enter-random-values-to-it", "title": "Traverse my data structure, and enter random values to it", "body": "<p>I am having a very big data structure.\nOnly 1 structure. \nNow, this structure has many sub-structures under it and so on.\nI have to put random values to each variable of this structure.\nI would have done it manually, but there are more than 10000 variables under it.\nIt's a long and deep structure, that have structure under structure.</p>\n\n<p>for eg -> This is just an example, actual structure is very big</p>\n\n<pre><code>struct qwerty{\n    unsigned short  catch;\n    unsigned short  port;\n    MediaAuthType_e     mediaAuth;\n    typeShortNatmr    NAT;\n    typeDynEpDom      domain;\n    typeRDomList      domainlist;\n    typeDom domainSize;\n};\n</code></pre>\n\n<p>Now each of these data types has substructure under it \neg for MediaAuthType_e data type above we have a structre as </p>\n\n<pre><code>struct MediaAuthType_e\n{\n    int nunkhdr;\n    msg_body_list* unknown_msg_body;\n    int unknown_msg_body_count;\n    SipLssHandle Handle;\n    InfoEntry *dfo;\n    char* ua_uri;\n    char* accept;\n    void* s_contact;\n    char* branch;\n    char* chargeNum;\n    int 100Supported;\n    int 100Required;\n };\n</code></pre>\n\n<p>and so on .</p>\n\n<p>Can someone please help?\nI just have to store random values to each of my variables?\nCan I automate this process?</p>\n\n<p>EDIT:</p>\n\n<p>Why I am doing this is, \nI have to encode the data to xdr format and decode it to get the same value</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1532431655, "post_id": 51497346, "comment_id": 89962628, "body": "<code>(buffer[index] &lt;&lt; 8) | (buffer[index])</code>? Should it not be <code>(buffer[index] &lt;&lt; 4) | (buffer[index + 1])</code>? And then do <code>index += 2</code> in the loop."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1532431792, "post_id": 51497346, "comment_id": 89962706, "body": "Also, should your function not <i>return</i> the checksum?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1532431981, "post_id": 51497346, "comment_id": 89962827, "body": "If you want a one-byte checksum, your last line should involve <code>(~(tempChecksum &amp; 0xFF) + 1) &amp; 0xFF;</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1532432042, "post_id": 51497346, "comment_id": 89962864, "body": "Oh and as an addendum to my first comment, I know of <i>no</i> encodings where e.g. <code>1 == &#39;1&#39;</code>. So you need to convert the characters from their encoded values into proper values."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532432502, "post_id": 51497346, "comment_id": 89963176, "body": "How do you read the buffer? Where do you convert the hex digits to binary values?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1532442006, "post_id": 51497346, "comment_id": 89970246, "body": "Which language, C or C++?  The C++ language has <code>std::string</code>, <code>std::vector</code> and <code>std::bitset</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1532466451, "post_id": 51497346, "comment_id": 89984130, "body": "&quot;convert to decimal and back to hex&quot; is not a requirement. You can do addition in any base (base 2 is used by the computer)"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1549760424, "post_id": 51497346, "comment_id": 96018880, "body": "It is not a decimal value, and you don&#39;t want to conver it to hex. It is already a hex value, and you want to convert each pair of hex gpsigits to binary."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1549764097, "post_id": 51497346, "comment_id": 96019390, "body": "@user207421: You&#39;d want to convert the hex digits (e.g. the characters <code>&quot;89AB&quot;</code>) to integers (e.g. <code>0x89, 0xAB</code>) and not to binary (e.g. the characters <code>&quot;1000100110101011&quot;</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 4167623, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fb4713d16d988bb387175b365bbf7eee?s=128&d=identicon&r=PG&f=1", "display_name": "donguy76", "link": "https://stackoverflow.com/users/4167623/donguy76"}, "edited": false, "score": 1, "creation_date": 1532465101, "post_id": 51498516, "comment_id": 89983571, "body": "I was not able to get this working. In fact i tried with much larger data involving more than 100 bytes."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1532434895, "creation_date": 1532434895, "answer_id": 51498516, "question_id": 51497346, "link": "https://stackoverflow.com/questions/51497346/bitwise-operator-to-calculate-checksum/51498516#51498516", "title": "Bitwise operator to calculate checksum", "body": "<p>Using addition to obtain a checksum is at least weird. Common checksums use bitwise xor or full crc. But assuming it is really what you need, it can be done easily with <code>unsigned char</code> operations:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar checksum(const char *hex, int n) {\n    unsigned char ck = 0;\n    for (int i=0; i&lt;n; i+=1) {\n        unsigned val;\n        int cr = sscanf(hex + 2 * i, \"%2x\", &amp;val);   // convert 2 hexa chars to a byte value\n        if (cr == 1) ck += val;\n    }\n    return ck;\n}\nint main() {\n    char hex[] = \"3133455D332015550F23315D\";\n    char ck = checksum(hex, 11);\n\n    printf(\"%2x\", (unsigned) (unsigned char) ck);\n    return 0;\n}\n</code></pre>\n\n<p>As the operation are made on an <code>unsigned char</code> everything exceeding a byte value is properly discarded and you obtain your value (26 in your example).</p>\n"}], "owner": {"reputation": 515, "user_id": 4167623, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fb4713d16d988bb387175b365bbf7eee?s=128&d=identicon&r=PG&f=1", "display_name": "donguy76", "link": "https://stackoverflow.com/users/4167623/donguy76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1465, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549759837, "creation_date": 1532431375, "last_edit_date": 1549759837, "question_id": 51497346, "link": "https://stackoverflow.com/questions/51497346/bitwise-operator-to-calculate-checksum", "title": "Bitwise operator to calculate checksum", "body": "<p>Am trying to come up with a C/C++ function to calculate the checksum of a given array of hex values.</p>\n\n<p>char *hex = \"3133455D332015550F23315D\";</p>\n\n<p>For e.g., the above buffer has 12 bytes and then last byte is the checksum.</p>\n\n<p>Now what needs to done is, convert the 1st 11 individual bytes to decimal and then take there sum.</p>\n\n<p>i.e., 31 = 49, \n      33 = 51,.....</p>\n\n<p>So 49 + 51 + .....................</p>\n\n<p>And then convert this decimal value to Hex. And then take the LSB of that hex value and convert that to binary.</p>\n\n<p>Now take the 2's complement of this binary value and convert that to hex. At this step, the hex value should be equal to 12th byte.</p>\n\n<p>But the above buffer is just an example and so it may not be correct.</p>\n\n<p>So there're multiple steps involved in this. </p>\n\n<p>Am looking for an easy way to do this using bitwise operators. </p>\n\n<p>I did something like this, but it seems to take the 1st 2 bytes and doesn't give me the right answer.</p>\n\n<pre><code>int checksum (char * buffer, int size){\n    int value = 0;\n    unsigned short tempChecksum = 0;\n    int checkSum = 0;\n\n    for (int index = 0; index &lt; size - 1; index++) {\n        value = (buffer[index] &lt;&lt; 8) | (buffer[index]);\n        tempChecksum += (unsigned short) (value &amp; 0xFFFF);\n     }\n\n      checkSum = (~(tempChecksum &amp; 0xFFFF) + 1) &amp; 0xFFFF;  \n}\n</code></pre>\n\n<p>I couldn't get this logic to work. I don't have enough embedded programming behind me to understand the bitwise operators. Any help is welcome.</p>\n\n<p><strong>ANSWER</strong></p>\n\n<p>I got this working with below changes.</p>\n\n<pre><code>for (int index = 0; index &lt; size - 1; index++) {\n            value = buffer[index];\n            tempChecksum += (unsigned short) (value &amp; 0xFFFF);\n         }\n    checkSum = (~(tempChecksum &amp; 0xFF) + 1) &amp; 0xFF;\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1532431500, "post_id": 51497333, "comment_id": 89962540, "body": "Begin by checking what <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code></a> <i>returns</i>!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1532432077, "post_id": 51497333, "comment_id": 89962898, "body": "Your code looks terribly complicated, all this digit1 to digit8 stuff can probably be replaced by a single loop. And all those <code>goto</code>s are terrible too. I&#39;m not sure if this code can be saved, I&#39;d throw it away and rethink it from scratch."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532435438, "post_id": 51497333, "comment_id": 89965212, "body": "Did you read the chapters about arrays in your text book yet? They could improve the code drastically."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10139466, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WCDqBrwv9ak/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ql7faJImC2wDB4A_imfRM_Fq8gwA/mo/photo.jpg?sz=128", "display_name": "Benny", "link": "https://stackoverflow.com/users/10139466/benny"}, "is_accepted": false, "score": 0, "last_activity_date": 1532655331, "last_edit_date": 1532655331, "creation_date": 1532651906, "answer_id": 51549236, "question_id": 51497333, "link": "https://stackoverflow.com/questions/51497333/cs50-credit-loop-if-not-card-number/51549236#51549236", "title": "CS50 Credit, loop if not card number", "body": "<p>Prompt the user to type in the credit card number, use a do while loop so that if the number is less than 0, you will keep asking the user for a card number.</p>\n\n<pre><code>int main(void)\n{\nlong long credit_card_number;\n\ndo\n{\n  credit_card_number = get_long_long(\"Enter Valid Credit Card Number: \");\n}\nwhile (credit_card_number &lt; 0);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14813378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e4a77cb3c15d14fd326fb3d97091867?s=128&d=identicon&r=PG&f=1", "display_name": "CerenSusuz", "link": "https://stackoverflow.com/users/14813378/cerensusuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1608989393, "creation_date": 1608989393, "answer_id": 65456885, "question_id": 51497333, "link": "https://stackoverflow.com/questions/51497333/cs50-credit-loop-if-not-card-number/65456885#65456885", "title": "CS50 Credit, loop if not card number", "body": "<pre><code>#include &lt;cs50.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    long long cardnumber = 0;\n    do\n    {\n        cardnumber = get_long(&quot;Number: &quot;);\n    }\n    while (cardnumber &lt; 0);\n    int count = 0;\n    long long digits = cardnumber;\n    while (digits &gt; 0)\n    {\n        digits = digits/10;\n        count++;\n    }\n    if ((count != 13) &amp;&amp; (count != 15) &amp;&amp; (count != 16))\n    {\n        printf(&quot;INVALID\\n&quot;);\n    }\n    int number[count];\n    for (int i = 0; i &lt; count; i++)\n    {\n        number[i] = cardnumber % 10;\n        cardnumber = cardnumber / 10;\n    }\n    int originalnumber[count];\n    for (int i = 1; i &lt; count; i++)\n    {\n        originalnumber[i] = number[i];\n    }\n    for (int i = 1; i &lt; count; i+=2)\n    {\n        number[i] = number[i] * 2;\n    }\n    int v = 0;\n    int temp;\n    if (count == 13)\n    {\n      for (int i = 0; i &lt; count; i++)\n      {\n        temp = (number[i] % 10) + (number[i]/10 % 10);\n        v = v + temp;\n      }\n      if (originalnumber[12] == 4 &amp;&amp; v % 10 == 0)\n      {\n        printf(&quot;VISA\\n&quot;);\n      }\n      else\n      {\n        printf(&quot;INVALID\\n&quot;);\n      }\n    }\n    if (count == 15)\n    {\n      for (int i = 0; i &lt; count; i++)\n      {\n        temp = (number[i] % 10) + (number[i]/10 % 10);\n        v = v + temp;\n      }\n      if (originalnumber[14] == 3 &amp;&amp; v % 10 == 0 &amp;&amp; (originalnumber[13] == 4 || originalnumber[13] == 7))\n      {\n        printf(&quot;AMEX\\n&quot;);\n      }\n      else\n      {\n        printf(&quot;INVALID\\n&quot;);\n      }\n    }\n    if (count == 16)\n    {\n      for (int i = 0; i &lt; count; i++)\n      {\n        temp = (number[i] % 10) + (number[i]/10 % 10);\n        v = v + temp;\n      }\n      if (originalnumber[15] == 4 &amp;&amp; v % 10 == 0)\n      {\n        printf(&quot;VISA\\n&quot;);\n      }\n      else if (originalnumber[15] == 5 &amp;&amp; v % 10 == 0 &amp;&amp; (originalnumber[14] == 1 || originalnumber[14] == 2 || originalnumber[14] == 3 || originalnumber[14] == 4 || originalnumber[14] == 5))\n        {\n            printf(&quot;MASTERCARD\\n&quot;);\n        }\n      else\n      {\n        printf(&quot;INVALID\\n&quot;);\n      }\n    }\n  \n}  \n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 10073459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965ac25f812ea2831d08595837b8af45?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10073459/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1608989393, "creation_date": 1532431330, "last_edit_date": 1532432118, "question_id": 51497333, "link": "https://stackoverflow.com/questions/51497333/cs50-credit-loop-if-not-card-number", "title": "CS50 Credit, loop if not card number", "body": "<p>I have nearly finished the Credit task of PSET1 (CS50) although I have run into a problem trying to get the program to not allow an entry that isn't a card number (E.g \"Foo\" or \"t\" or anything other than a number) and then loop.</p>\n\n<p>I have attempted various while statements and goto statements although none of these attempts have been sucessful</p>\n\n<p>Also any other suggestions would be appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\nint main(void)\n{\n        //gets cardnumber &amp; counts digits entered\n        long long cardnumber;\n        int count = 0;\n            {\n                //prompts user for a cardnumber\n                printf(\"Enter a cardnumber: \");\n                scanf(\"%lld\", &amp;cardnumber);\n            }\n        //Prints count of digits entered (will likely not need this part)\n        //else printf(\"Number of digits: %d\", count); printf(\"\\n\");\n        //Finds first 8 digits for checksum)\n\n        int digit1 = (((cardnumber % 100) / 10) * 2);\n        int digit2 = (((cardnumber % 10000) / 1000) * 2);\n        int digit3 = (((cardnumber % 1000000) / 100000) * 2);\n        int digit4 = (((cardnumber % 100000000) / 10000000) * 2);\n        int digit5 = (((cardnumber % 10000000000) / 1000000000) * 2);\n        int digit6 = (((cardnumber % 1000000000000) / 100000000000) * 2);\n        int digit7 = (((cardnumber % 100000000000000) / 10000000000000) * 2);\n        int digit8 = (((cardnumber % 10000000000000000) / 1000000000000000) * 2);\n\n        //Sum first 8 digits of checksum\n\n        int check1 = ((digit1 % 10) + (digit1 / 10));\n        check1 = (check1 + (digit2 % 10)) + (digit2 / 10);\n        check1 = (check1 + (digit3 % 10)) + (digit3 / 10);\n        check1 = (check1 + (digit4 % 10)) + (digit4 / 10);\n        check1 = (check1 + (digit5 % 10)) + (digit5 / 10);\n        check1 = (check1 + (digit6 % 10)) + (digit6 / 10);\n        check1 = (check1 + (digit7 % 10)) + (digit7 / 10);\n        check1 = (check1 + (digit8 % 10)) + (digit8 / 10);\n\n        //Sum last 8 digits of checksum &amp; Sum of first 8 (check1)\n\n        int digit9 = ((cardnumber % 10) / 1);\n        int digit10 = ((cardnumber % 1000) / 100);\n        int digit11 = ((cardnumber % 100000) / 10000);\n        int digit12 = ((cardnumber % 10000000) / 1000000);\n        int digit13 = ((cardnumber % 1000000000) / 100000000);\n        int digit14 = ((cardnumber % 100000000000) / 10000000000);\n        int digit15 = ((cardnumber % 10000000000000) / 1000000000000);\n        int digit16 = ((cardnumber % 1000000000000000) / 100000000000000);\n\n        //add to remaining digits to those that were multiplied by 2\n\n        int checksum = (check1 + digit9 + digit10 + digit11 + digit12 + digit13 + digit14 + digit15 + digit16);\n\n        // Check first 2 digits\n\n        if (cardnumber / 10000000000000 == 34 || cardnumber / 10000000000000 == 37 )\n        goto Amex;\n\n        if (cardnumber / 100000000000000 == 51 || cardnumber / 100000000000000 == 52 || cardnumber / 100000000000000 == 53 || cardnumber / 100000000000000 == 54 || cardnumber / 100000000000000 == 55 )\n        goto Master;\n\n        if (cardnumber / 1000000000000000 == 4 )\n        goto Visa;\n        else\n            {\n                printf(\"INVALID\\n\");\n                (I = 0);\n            }\n        goto End;\n        // Amex start with 34 or 37\n        Amex:;\n        char A;\n        if (cardnumber / 10000000000000 == 34 || cardnumber / 10000000000000 == 37 )\n            {\n                A = 1;\n            }\n        else\n            {\n                A = 0;\n            }\n        goto End;\n        // Mastercard start with 51, 52, 53, 54, 55\n        Master:;\n        char M;\n        if (cardnumber / 100000000000000 == 51 || cardnumber / 100000000000000 == 52 || cardnumber / 100000000000000 == 53 || cardnumber / 100000000000000 == 54 || cardnumber / 100000000000000 == 55 )\n            {\n                M = 1;\n            }\n        else\n            {\n                M = 0;\n            }\n        goto End;\n        //Visa start with 4\n        Visa:;\n        char V;\n        if (cardnumber / 1000000000000000 == 4 )\n            {\n                V = 1;\n            }\n        else\n            {\n                V = 0;\n            }\n        goto End;\n        End:;\n        while(cardnumber != 0)\n            {\n                // cardnumber = cardnumber/10\n                cardnumber /= 10;\n                ++count;\n            }\n        // if cardnumber &lt;13 or &gt;16 digits error \"invalid card\" given\n        if (count &gt; 16 || count &lt; 13)\n            {\n                printf(\"INVALID\\n\");\n                (I = 0);\n            }\n            // Keep track of first 2 digits &amp; validate checksum\n        char T;\n        if (checksum % 10 == 0)\n            {\n                T = 1;\n            }\n        else\n            {\n                T = 0;\n            }\n        if (T == 0) printf(\"INVALID\\n\");\n            {\n                (I = 0);\n            }\n        // - Amex (15 digits, start with 34 or 37)\n        if (count == 15 &amp;&amp; T == 1 &amp;&amp; A == 1)\n            {\n                printf(\"AMEX\\n\");\n            }\n        // - Mastercard (16 digits, start with 51, 52, 53, 54, 55)\n        if (count == 16 &amp;&amp; T == 1 &amp;&amp; M == 1)\n            {\n                printf(\"MASTERCARD\\n\");\n            }\n        // - Visa (13 &amp; 16 digits, start with 4)\n        if ((count == 13 &amp;&amp; T == 1 &amp;&amp; V == 1) || (count == 16 &amp;&amp; T == 1 &amp;&amp; V == 1))\n        {\n            printf(\"VISA\\n\");\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct", "stack", "micro-optimization"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1532430657, "post_id": 51496986, "comment_id": 89962049, "body": "you could just measure the difference in performance between the two alternatives."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532430788, "post_id": 51496986, "comment_id": 89962118, "body": "It depends on your architecture, in many cases, I would expect passing a pointer to be better in terms of performance. But: Passing the whole value can have architectural benefits. You can work with immutable objects, for example."}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 3, "creation_date": 1532430825, "post_id": 51496986, "comment_id": 89962144, "body": "My empirical rule is: if sizeof(type) &gt; 2*sizeof(void*), I prefer passing a pointer."}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "edited": false, "score": 0, "creation_date": 1532431043, "post_id": 51496986, "comment_id": 89962261, "body": "@FelixPalmen in that case, it would be x86_64 mostly"}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1532431083, "post_id": 51496986, "comment_id": 89962294, "body": "@SanderDeDycker I would like a more generic answer than &#171; on my machine it&#39;s faster &#187;"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1532431856, "post_id": 51496986, "comment_id": 89962758, "body": "@Maxux : I&#39;m afraid a generic answer is unlikely - a lot depends on the hardware, the compiler, the compiler flags, etc. The best you can hope for is a rule of thumb like Alex F&#39;s above."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1532431908, "post_id": 51496986, "comment_id": 89962784, "body": "Why is it that you want to create a new dynamic <code>mytest_t</code> and copy all fields if you already have been passed a <code>mytest_t</code>."}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1532432275, "post_id": 51496986, "comment_id": 89963014, "body": "@SanderDeDycker Yeah I know, it was looking for some technical details for hardware, not a single response working for all of them :)"}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1532432278, "post_id": 51496986, "comment_id": 89963016, "body": "@4386427 If you look closer, you will see all fields are not already pre-filled. The function which allocate the dynamic one allocate some field itself. This is a really small example, in reality, the dynamic object have lot of fields computed/filled on the fly, and some of them are passed via arguments."}, {"owner": {"reputation": 414, "user_id": 10121160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ddf4b4dceccf0ddff0f5473f401ff04?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Collie", "link": "https://stackoverflow.com/users/10121160/bruce-collie"}, "edited": false, "score": 0, "creation_date": 1532432518, "post_id": 51496986, "comment_id": 89963186, "body": "You can try using the <a href=\"https://gcc.godbolt.org\" rel=\"nofollow noreferrer\">compiler explorer</a> to compare the generated code for both of your examples. Remember to benchmark as well to make sure this kind of optimisation will actually affect your performance!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1532432584, "post_id": 51496986, "comment_id": 89963231, "body": "@Maxux The types are the same so the fields are already there. You can simply initialize the so far uninitialized fields in the passed argument instead of creating a new dynamic variable. Creating a dynamic variable is (most likely) far more expensive than all other code posted."}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1532433107, "post_id": 51496986, "comment_id": 89963593, "body": "@4386427 The dynamic variable is then pushed in a heap allocated list, it can&#39;t stay on the stack."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1532433447, "post_id": 51496986, "comment_id": 89963807, "body": "@Maxux ok, if it really has to be dynamic fine. But then your performance considerations are most likely useless. The dynamic allocation will (most likely) be far more expensive than the initialization - regardless of passing by value or passing a pointer. In other words: I think you are trying to optimize something that really takes just a few percent of the total execution time. It&#39;s most likely not worth it. Just do it the way you find your code most readable and maintainable."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1535416399, "post_id": 51496986, "comment_id": 91047906, "body": "The ABI defines how parameters of struct type are passed and returned; you could look up the ABI spec for the platform you are interested in"}], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 7686412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f40f26fd471e5b444ee89c8af5a938b?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7686412/mary"}, "is_accepted": false, "score": 0, "last_activity_date": 1532462009, "creation_date": 1532462009, "answer_id": 51506548, "question_id": 51496986, "link": "https://stackoverflow.com/questions/51496986/multiple-arguments-by-value-or-pointer-to-struct-in-c/51506548#51506548", "title": "Multiple arguments by value or pointer to struct in C", "body": "<p>It depends, if you're going to use always the same value, then a pre-filled mytest_t struct would be the better choice...BUT if you think you'll change the values at some point inside another function, then...pass the poiner to the pre-filled mytest_t is better.</p>\n\n<p>For the compiler (and OS) is better when you pass the adress (pointer) because he doesn't need to ask OS for more memory, he already have what he needs (the pointer and values).</p>\n\n<p>Your only concern should be...DON'T LOSE YOUR POINTER, and always know what you're changing when you update any data.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535406199, "post_id": 52045370, "comment_id": 91045615, "body": "(nvm, just saw the part where the OP says assume &gt;2 times bigger than 6).  x86-64 System V, used on all x86-64 systems except Windows, <a href=\"https://stackoverflow.com/questions/2535989/what-are-the-calling-conventions-for-unix-linux-system-calls-on-i386-and-x86-6/2538212#2538212\">passes the first 6 integer args in registers</a> (and also the first 8 FP args in XMM registers).  Many other calling conventions only use 4 arg-passing regs, like 32-bit ARM (and <code>uint64_t</code> takes 2 regs there), but I&#39;m not sure about AArch64.  I wouldn&#39;t be surprised if some 64-bit RISC calling conventions use more than 4."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535411018, "post_id": 52045370, "comment_id": 91046793, "body": "@PeterCordes The question said 2-3x the given 5 (or 6 - it wasn&#39;t consistent) members (so I was assuming 10-18) ... I almost mentioned using SIMD registers, but the members all appear to be random types and it wouldn&#39;t be portable without behind the scenes work."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535425888, "post_id": 52045370, "comment_id": 91049630, "body": "Yup, I typed all but the start of that comment before seeing the 2x-3x part of the question.  I had been just responding to the first line of your answer based on 6 members.  Anyway, you <i>could</i> pass multiple int args packed into SIMD registers, but as you say, you&#39;re just making things worse if they need to be used separately (or if the callee won&#39;t actually use all of them).  I wrote an answer on <a href=\"https://stackoverflow.com/q/33707228\">Why not store function parameters in float registers?</a> a few years ago."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535426137, "post_id": 52045370, "comment_id": 91049687, "body": "Totally agree it depends on the surrounding code and exactly what the caller and callee are doing.  But most likely sorting the struct by size and passing by ref will be best for 12 or more members.  <b>Definitely a case where you want to enable link-time optimization so the compiler can inline (even across compilation units) and optimize away unnecessary copying.</b>"}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "edited": false, "score": 0, "creation_date": 1535457194, "post_id": 52045370, "comment_id": 91064575, "body": "Thanks for your reply, I guess that at the end, the compiler anyway will try to optimize things to take advantage and it would be interesting to see what it produces to know better."}], "tags": [], "owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "is_accepted": false, "score": 2, "last_activity_date": 1535415117, "last_edit_date": 1535415117, "creation_date": 1535395870, "answer_id": 52045370, "question_id": 51496986, "link": "https://stackoverflow.com/questions/51496986/multiple-arguments-by-value-or-pointer-to-struct-in-c/52045370#52045370", "title": "Multiple arguments by value or pointer to struct in C", "body": "<p>From what it sounds like your number of struct members will exceed the number of parameters that can be passed in parameters (at least on any architecture's calling convention I have come across); causing the remaining values to be placed on the stack anyhow.  That is not much different than passing the struct by value entirely on the stack.  This can cause even more copying around than if you just allocated it on the stack to begin with and then passed a pointer.</p>\n\n<p>That leaves you with a few options depending on how your structs will be used.  For example:</p>\n\n<ul>\n<li><p><del>Alex F mentioned a rule of thumb <code>sizeof(type) &gt; 2*sizeof(void*)</code> (Many calling conventions allow for those \"small structs\" to be passed in registers)  You are way past that and past the number of parameters that can be passed in registers.</del></p></li>\n<li><p>If you need to support multiple architectures AND your struct is more than a few members (see thumb-rule above), a pointer to struct is the best simple option.</p></li>\n<li><p>If your struct could be easily split into commonly used members and uncommon ones, you could split it up into a hot and cold struct or a struct with a small number of hot members and a cold struct (or union of structs) containing the cold members.  (See example below)</p></li>\n</ul>\n\n<p>I mentioned the possibility that the \"cold\" struct possibly be a union of structs.  This can be useful if many of the members are superfluous depending on one of your \"hot\" members (see a html/dom parser for examples)  If that can get more of your structs to fit inside a cache line, you get the benefit of better cache locality and a reduced memory footprint (maybe - depends on how many instances of the struct there will be - is it just a context struct or will there be an array or linked list of them?).  I wouldn't necessarily recommend adding this complexity unless profiling indicates its a bottleneck or the cause of excessive resource usage.</p>\n\n<pre><code>struct mystruct {\n  struct hot{ long node_type; struct mystruct *next;} hot;\n  struct cold{ /* the rest of your members */ } cold;\n}\nvoid myfunc(struct hot x, struct cold *y);\n//or\nstruct mystruct {\n  long node_type; //hot\n  struct mystruct *next; //hot\n  struct cold{ /* the rest of your members*/ } cold;\n}\nvoid myfunc0(struct mystruct *next_node, long node_type, struct cold *y);\nvoid myfunc1(long node_type, struct cold *y);\n</code></pre>\n\n<p>On a side note, your struct, as demonstrated, will have a lot of useless padding (or require inefficient unpacking if \"packed\")  If you order your members from largest to smallest it will pack a lot better.  Unless the size of the struct exceeds cache line size (typically ~64 bytes these days), there is little to no impact if smaller members are separated from larger members that they are commonly used with.  For more insight see <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">The Lost Art of Structure Packing</a>.</p>\n\n<p>Edit:</p>\n\n<p>Once you have your struct sorted by size, it may be that your members would conveniently fit in SIMD registers and may even be conducive to SIMD operations.  Arm's typedefs seem to be consistent with standard naming conventions and convenient to use on compilers that support <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Vector-Extensions.html\" rel=\"nofollow noreferrer\">vector extensions</a>.</p>\n\n<p>Here is a relatively portable version of arm's vectors for 128 bit </p>\n\n<pre><code>typedef __INT64_TYPE__    int64x2_t   __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __UINT64_TYPE__   uint64x2_t  __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __INT32_TYPE__    int32x4_t   __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __UINT32_TYPE__   uint32x4_t  __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __INT16_TYPE__    int16x8_t   __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __UINT16_TYPE__   uint16x8_t  __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __INT8_TYPE__     int8x16_t   __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef __UINT8_TYPE__    uint8x16_t  __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef double            float64x2_t __attribute__ ((__vector_size__ (16), __may_alias__));\ntypedef float             float32x4_t __attribute__ ((__vector_size__ (16), __may_alias__));\n///similar for vector sizes 32 and 64\n</code></pre>\n\n<p>As an example for x86_64 you could pass (u)int64_t in the integer registers and, using 8 SIMD registers, an additional combination of 128 char types, 64 short, 32 int or 16 long (or even more with AVX2 or AVX512 support).  That's not to say it will be any faster though if the data is not conducive to SIMD operations.  It will depend on the usage patterns.</p>\n"}], "owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1535415117, "creation_date": 1532430176, "last_edit_date": 1535070342, "question_id": 51496986, "link": "https://stackoverflow.com/questions/51496986/multiple-arguments-by-value-or-pointer-to-struct-in-c", "title": "Multiple arguments by value or pointer to struct in C", "body": "<p>Let assume this struct:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct mytest_t {\n    uint8_t field1;\n    uint32_t field2;\n    uint64_t field3;\n    uint64_t field4;\n    uint16_t field5;\n    uint32_t field6;\n\n} mytest_t;\n</code></pre>\n\n<p>And some function which want to create this struct (a little bit like an object):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int something_with(uint8_t field1, uint32_t field2, uint64_t field3, uint16_t field5) {\n    mytest_t *object = malloc(sizeof(mytest_t));\n\n    object-&gt;field1 = field1;\n    object-&gt;field2 = field2;\n    object-&gt;field3 = field3;\n    object-&gt;field4 = 0x12345678;\n    object-&gt;field5 = field5;\n    object-&gt;field6 = 42;\n\n    dosomethingwith(object);\n    return 0;\n}\n\nvoid initial() {\n    something_with(123, 456, 789, 456);\n}\n</code></pre>\n\n<p>Theses functions are purely made for example of my situation. This function is like a helper to have a single point in the code where object is filled then forwarded to something else.</p>\n\n<p><strong>Note: this example is quite small, assume arguments would be 2 or 3 times longer.</strong></p>\n\n<p>To avoid passing lot of argument to the function, and make call really long and difficult to read, I was thinking about passing a pre-filled <code>mytest_t</code> struct as argument (let assume needed fields are correctly filled).</p>\n\n<p>Would it be better to pass the struct as value or pointer ? What's the cost of dereferencing all the field ? Does that do any difference since everything is on the stack ? Could the compiler optimize that in some way ?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void initial() {\n    mytest_t source = {\n        .field1 = 123,\n        .field2 = 456,\n        .field3 = 789,\n        // field4 not needed\n        .field5 = 456,\n        // field6 not needed\n    };\n\n    call_by_value(source);\n    call_by_ptr(&amp;source);\n}\n\nint call_by_value(mytest_t origin) {\n    mytest_t *object = malloc(sizeof(mytest_t));\n\n    object-&gt;field1 = origin.field1;\n    object-&gt;field2 = origin.field2;\n    object-&gt;field3 = origin.field3;\n    object-&gt;field4 = 0x12345678;\n    object-&gt;field5 = origin.field5;\n    object-&gt;field6 = 42;\n\n    dosomethingwith(object);\n    return 0;\n}\n\nint call_by_ptr(mytest_t *origin) {\n    mytest_t *object = malloc(sizeof(mytest_t));\n\n    object-&gt;field1 = origin-&gt;field1;\n    object-&gt;field2 = origin-&gt;field2;\n    object-&gt;field3 = origin-&gt;field3;\n    object-&gt;field4 = 0x12345678;\n    object-&gt;field5 = origin-&gt;field5;\n    object-&gt;field6 = 42;\n\n    dosomethingwith(object);\n    return 0;\n}\n</code></pre>\n\n<p>My first assumption would be passing as value would just duplicate everything on the stack and don't give any benefit, but could dereferencing the object for each field be more expensive than duplicating it ? Would the pointer version not maybe ends in a lot of cache miss and the stack version not ?</p>\n"}, {"tags": ["bash", "c", "stdin", "readline"], "comments": [{"owner": {"reputation": 586, "user_id": 5216673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5d8b8e0713574ae9a4836651a39e56?s=128&d=identicon&r=PG", "display_name": "thrig", "link": "https://stackoverflow.com/users/5216673/thrig"}, "edited": false, "score": 0, "creation_date": 1532440912, "post_id": 51503379, "comment_id": 89975342, "body": "it might be easier to look at how the heirloom bourne shell handles jobs, as that runs to ~800 lines of C code in <code>jobs.c</code> versus the ~3,300 in the &quot;too big and too slow&quot; bash"}, {"owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "reply_to_user": {"reputation": 586, "user_id": 5216673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5d8b8e0713574ae9a4836651a39e56?s=128&d=identicon&r=PG", "display_name": "thrig", "link": "https://stackoverflow.com/users/5216673/thrig"}, "edited": false, "score": 0, "creation_date": 1532441166, "post_id": 51503379, "comment_id": 89975343, "body": "I will do that. I believe the <code>&lt;defunct&gt;</code> was just due to a bug in a thread that waits on children, but looking at a more professional implementation might be a good idea anyways."}], "answers": [{"comments": [{"owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "edited": false, "score": 0, "creation_date": 1532456987, "post_id": 51504421, "comment_id": 89979666, "body": "I did not think about the second part of your answer so that is helpful. But simple closing stdin does not seem to be the right solution for the redirection part, if I run e.g. <code>cat &amp;</code> in a terminal, the spawned process should still have some stdin stream open because <code>cat</code> will try to read from it, right? But avoiding zombiefication along with dup&#39;ing stdin to /dev/null should probably do the trick."}, {"owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "edited": false, "score": 0, "creation_date": 1532459618, "post_id": 51504421, "comment_id": 89980979, "body": "On a second try, both these solutions do not work, closing stdin yields a <code>Bad file descriptor</code> error when the program loaded by <code>execve</code> tries to read from stdin. But with the <code>&#47;dev&#47;null</code> solution e.g. <code>cat</code> terminates immediate after all."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1532453176, "creation_date": 1532453176, "answer_id": 51504421, "question_id": 51503379, "link": "https://stackoverflow.com/questions/51503379/do-not-share-stdin-of-process-started-from-shell-with-shell-itself/51504421#51504421", "title": "Do not share stdin of process started from shell with shell itself", "body": "<p>Ok, so you want to be able to start asynchronous child processes with their input directly connected to /dev/null and that do not become zombies when they die, that on a Unix or Unix-like system.</p>\n\n<p>For the redirection part, the common way is to close the standard input file (file number 0) between the fork and the exec:</p>\n\n<pre><code>pid = fork();\nif (pid == 0) {        // in child\n    close(0);          // close standard input\n    execve(...);\n}\n</code></pre>\n\n<p>If you do not close files 1 and 2, the output of the child will still go to the terminal. You can close them but any output would be silently discarded...</p>\n\n<p>For the zombie () part, it is enough to ignore the SIGCHLD signal before forking:</p>\n\n<pre><code>signal(SIGCHLD, SIG_IGN);\npid = fork();                // this child will never become a zombie process\n</code></pre>\n\n<hr>\n\n<p>References: man fork, man wait, man execve</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1532449206, "question_id": 458121}, "owner": {"reputation": 2864, "user_id": 4858640, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3eef6d48a6bc20ea9c2c2825dc9c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4858640/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532460785, "creation_date": 1532429355, "last_edit_date": 1532460785, "question_id": 51503379, "link": "https://stackoverflow.com/questions/51503379/do-not-share-stdin-of-process-started-from-shell-with-shell-itself", "title": "Do not share stdin of process started from shell with shell itself", "body": "<p>I'm writing a C program with some shell-like functionalities, among them, running programs in child-processes started over a readline interface in the background.</p>\n\n<p>One problem that I currently have is that as soon as I have spawned such a child process and start typing input characters again, these characters are received by the spawned child process via stdin. This is not too surprising given that I don't modify the children's file descriptors after forking them and I understand that this means that they all share the same stream underlying <code>STDIN_FILENO</code> with the main process.</p>\n\n<p>This is, however, not what I intend. I would like my program to behave like e.g. <code>bash</code> in this regard such that after re-obtaining a prompt after starting an ongoing process in the background any characters typed on that prompt will only be seen by bash and not by the spawned process. And this is where my problem is because I don't even understand how bash does this. Looking at <code>/proc/.../fd/0</code> for <code>bash</code> and any spawned processes these always point to the same pseudoterminal. Just redirecting the spawned processes stdin to e.g. <code>/dev/null</code> also obviously produces different behavior.</p>\n\n<p>I don't need a complete implementation here, just a general hint.</p>\n\n<p>EDIT: I just figured out that redirecting stdin to <code>/dev/null</code> does kind of work if I open <code>/dev/null</code> using the <code>open</code> command with the <code>O_RDWR</code> flag.\nMy program then seems to behave the way I want except that child processes started this way show up as <code>&lt;defunct&gt;</code> when I run <code>ps</code>. I'm not sure why this happens.</p>\n\n<p>EDIT: I think I have it figured out now, the easiest way to do this seems to be to create a pseudo terminal slave and then redirect the child's stdin to it:</p>\n\n<pre><code>int master;\nint slave;\n\nopenpty(&amp;master, &amp;slave, nullptr, nullptr, nullptr);\n\ndup2(slave, STDIN_FILENO);\n</code></pre>\n"}, {"tags": ["c", "split"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1532429032, "post_id": 51496517, "comment_id": 89960986, "body": "No output? Really?"}, {"owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 1, "creation_date": 1532429216, "post_id": 51496517, "comment_id": 89961102, "body": "Just a note: you should always check if your file pointer is not NULL before using it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7322832"}, "edited": false, "score": 0, "creation_date": 1532429235, "post_id": 51496517, "comment_id": 89961114, "body": "Jup... i Dont know why, I work with Eclipse and build the C compiler into Eclipse. Everythink is still working but i dont get any output... :/"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7322832"}, "reply_to_user": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 0, "creation_date": 1532429300, "post_id": 51496517, "comment_id": 89961160, "body": "@Jesse u r right, i just forget it in my code.. for now :D."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1532429906, "post_id": 51496517, "comment_id": 89961548, "body": "@MustafaOtuzalti first thing to add: check <code>f != NULL</code> because it&#39;s probably the first issue. Then the program will crash, and applying the answer below will fix that too..."}, {"owner": {"reputation": 1439, "user_id": 1477810, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cgzi2.jpg?s=128&g=1", "display_name": "Mohammad Mirmostafa", "link": "https://stackoverflow.com/users/1477810/mohammad-mirmostafa"}, "edited": false, "score": 0, "creation_date": 1532442360, "post_id": 51496517, "comment_id": 89970519, "body": "Have you debugged your code, using breakpoint? Does your app go into <b>while</b> command?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532732441, "post_id": 51496517, "comment_id": 90099719, "body": "When compiling, always enable the warnings, then fix those warnings.  The posted code causes the compiler to output. &quot;untitled.c:36:5: warning: format not a string literal and no format arguments [-Wformat-security]        printf(string[x]);&quot;  (for <code>gcc</code>, at a minimum use: <code>gcc -ggdb -Wall -Wextra -Wconversion -pedantic -std=gnu11 -c &quot;untitled.c&quot;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532732993, "post_id": 51496517, "comment_id": 90099828, "body": "running the original posted code (except using the current source file name rather than &#39;document.txt&#39;  resulted in: <code>The Line is: #include &lt;stdio.h&gt;  Splited: #include &lt;stdio.h&gt;  Segmentation fault (core dumped)</code>  so the posted code fails even with the simplest file"}], "answers": [{"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1532429775, "post_id": 51496687, "comment_id": 89961455, "body": "Well, it did work when I tried it. And I get some output from your original code."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1532429844, "post_id": 51496687, "comment_id": 89961504, "body": "this fix or use <code>strdup</code> on the strings should work, unless the file cannot be opened. So double error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7322832"}, "edited": false, "score": 0, "creation_date": 1532430016, "post_id": 51496687, "comment_id": 89961614, "body": "can it be, that i dont get a Output, because i use Eclipse?  I will trie it with VisualStudio and told u if every think work, but thanks for know :)"}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1532429240, "creation_date": 1532429240, "answer_id": 51496687, "question_id": 51496517, "link": "https://stackoverflow.com/questions/51496517/have-code-which-should-save-string-from-file-in-an-array-but-did-not-giving-out/51496687#51496687", "title": "Have Code which should save string from file in an Array, but did not giving output if I try to print the array", "body": "<p><code>char *string[255]</code> is just an array of pointers. Change this to <code>char string[x][255]</code> where x is a number big enough to hold all rows.</p>\n"}, {"comments": [{"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1532431705, "post_id": 51497179, "comment_id": 89962661, "body": "@MustafaOtuzalti you marked this as correct and voted up then removed the vote ? Is there any problem with the solution ?"}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1532431919, "post_id": 51497179, "comment_id": 89962794, "body": "ok fine, however it can further be improved. And upvotes motivates :)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532732672, "post_id": 51497179, "comment_id": 90099769, "body": "OT: when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful.  If not successful, then call <code>perror()</code> to output to <code>stderr</code> both your error message and the text reason the system thinks the operation failed."}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1532783407, "post_id": 51497179, "comment_id": 90109364, "body": "Edited as per suggestion in last comment. Added (!=NULL) check"}], "tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": true, "score": 0, "last_activity_date": 1532783283, "last_edit_date": 1532783283, "creation_date": 1532430821, "answer_id": 51497179, "question_id": 51496517, "link": "https://stackoverflow.com/questions/51496517/have-code-which-should-save-string-from-file-in-an-array-but-did-not-giving-out/51497179#51497179", "title": "Have Code which should save string from file in an Array, but did not giving output if I try to print the array", "body": "<p>By this <code>char *string[255]</code> you have defined a array of pointer but that is not what is needed here. you should define it like array of string <code>char string[x][y]</code>. x and y depends of size needed to hold the strings.</p>\n\n<p>Also there is a potential bug in your logic here. It will give wrong result it will repeat the second split item in your result array. </p>\n\n<p>I have bit corrected it plz use this, though there are more optimization can be done in it:</p>\n\n<pre><code>FILE *fp = fopen(\"document.txt\", \"r\");\nif (!fp)\n{\n    perror( \"failed to open file\" );\n    exit( EXIT_FAILURE );\n}\n\nchar myString[100][255];\nint i = 0;\n\nchar singleLine[255];\nchar *ptr;\n\nwhile (fgets(singleLine, 255, fp) != NULL) {\n\n    printf(\"The Line is: %s\\n\", singleLine);\n    ptr = strtok(singleLine, \";\");\n\n    while (ptr != NULL) {\n        printf(\"Splited: %s\\n\", ptr);\n        strcpy(myString[i],ptr);\n        printf(\"Saved Split Result: %s\\n\", myString[i]);\n        i++;\n        ptr = strtok(NULL, \";\");\n    }\n}\n\nfor (int x = 0; x &lt; 6; x++) {\n    printf(\"%s\", myString[x]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1532734015, "creation_date": 1532734015, "answer_id": 51566679, "question_id": 51496517, "link": "https://stackoverflow.com/questions/51496517/have-code-which-should-save-string-from-file-in-an-array-but-did-not-giving-out/51566679#51566679", "title": "Have Code which should save string from file in an Array, but did not giving output if I try to print the array", "body": "<p>The following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>does not result in a seg fault event</li>\n<li>is properly/consistently indented</li>\n<li>properly checks for errors</li>\n</ol>\n\n<p>And now the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) \n{\n\n    FILE *fp = fopen(\"untitled.c\", \"r\");\n    if (!fp)\n    {\n        perror( \"fopen failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n    char *string[255];\n    int i = 0;\n\n    char singleLine[255];\n    char *ptr;\n\n    while (fgets(singleLine, 255, fp) ) \n    {\n        printf(\"The Line is: %s\\n\", singleLine);\n        ptr = strtok(singleLine, \";\");\n\n        //while (ptr != NULL) {\n        while( i &lt; 255 &amp;&amp; ptr )\n        {\n            printf(\"Splited: %s\\n\", ptr);\n            //strcpy(string[i],ptr);\n            string[i] = strdup( ptr );\n            printf(\"Saved first Split Result: %s\\n\", string[i]);\n            //i = i + 1;\n            i++;\n\n            ptr = strtok(NULL, \";\");\n            //if (ptr)   \n            //{\n            //   strcpy(string[i],ptr);\n            //   printf(\"Saved second Split Result: %s\\n\", string[i]);\n            //   i = i + 1;\n            //}\n        }\n    }\n\n    //should print me all splited Strings  \n    for (int x = 0; x &lt; 6; x++) \n    {\n        printf( \"%s\", string[x]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The following is the first part of the output of the program.</p>\n\n<pre><code>The Line is: #include &lt;stdio.h&gt;\n\nSplited: #include &lt;stdio.h&gt;\n\nSaved first Split Result: #include &lt;stdio.h&gt;\n\nThe Line is: #include &lt;stdlib.h&gt;\n\nSplited: #include &lt;stdlib.h&gt;\n\nSaved first Split Result: #include &lt;stdlib.h&gt;\n\nThe Line is: #include &lt;string.h&gt;\n\nSplited: #include &lt;string.h&gt;\n\nSaved first Split Result: #include &lt;string.h&gt;\n\nThe Line is: \n\nSplited: \n\nSaved first Split Result: \n\nThe Line is: int main(void) \n\nSplited: int main(void) \n\nSaved first Split Result: int main(void) \n</code></pre>\n\n<p>The following is the last part of the output from the program:</p>\n\n<pre><code>The Line is:    return 0;\n\nSplited:    return 0\nSaved first Split Result:   return 0\nSplited: \n\nSaved first Split Result: \n\nThe Line is: }\n\nSplited: }\n\nSaved first Split Result: }\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) \n{\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7322832"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 51497179, "answer_count": 3, "score": 0, "last_activity_date": 1537847023, "creation_date": 1532428724, "last_edit_date": 1537847023, "question_id": 51496517, "link": "https://stackoverflow.com/questions/51496517/have-code-which-should-save-string-from-file-in-an-array-but-did-not-giving-out", "title": "Have Code which should save string from file in an Array, but did not giving output if I try to print the array", "body": "<p>I am trying to learn C, and am writing a program which can </p>\n\n<ul>\n<li>open a text file </li>\n<li>split the string read from it</li>\n<li>save the result in an array, so I can work with it later. </li>\n</ul>\n\n<p>I don't get any output from my code, however. </p>\n\n<p>My Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n\nFILE *fp = fopen(\"document.txt\", \"r\");\nchar *string[255];\nint i = 0;\n\nchar singleLine[255];\nchar *ptr;\n\nwhile (fgets(singleLine, 255, fp) != NULL) {\n\n    printf(\"The Line is: %s\\n\", singleLine);\n    ptr = strtok(singleLine, \";\");\n\n    while (ptr != NULL) {\n        printf(\"Splited: %s\\n\", ptr);\n        strcpy(string[i],ptr);\n        printf(\"Saved first Split Result: %s\\n\", string[i]);\n        i = i + 1;\n\n        ptr = strtok(NULL, \";\");\n        if (ptr != NULL) {\n            strcpy(string[i],ptr);\n            printf(\"Saved second Split Result: %s\\n\", string[i]);\n            i = i + 1;\n        }\n    }\n}\n\n//should print me all splited Strings  \nfor (int x = 0; x &lt; 6; x++) {\n    printf(string[x]);\n}\nreturn 0;\n}\n</code></pre>\n\n<p>My Textfile:</p>\n\n<pre><code>TCP/1;TTL/0\n\nTCP/2;TTL/1\n\nTCP/3;TTL/32\n</code></pre>\n\n<p>How can I fix my code so that it does the steps mentioned above? </p>\n"}, {"tags": ["c", "arguments", "concat", "strcat"], "comments": [{"owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "edited": false, "score": 0, "creation_date": 1532429411, "post_id": 51496426, "comment_id": 89961213, "body": "<code>dest</code> needs to be initialized with the required length and filled with zeros. Can you show the full code?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1532429481, "post_id": 51496426, "comment_id": 89961257, "body": "Don&#39;t assume that the problem is not in the code you&#39;re not showing."}, {"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1532429722, "post_id": 51496426, "comment_id": 89961417, "body": "@klutt I updated the question with the full code :) Sorry about that"}, {"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "reply_to_user": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "edited": false, "score": 0, "creation_date": 1532429736, "post_id": 51496426, "comment_id": 89961433, "body": "@Domso I updated the question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532429752, "post_id": 51496426, "comment_id": 89961444, "body": "This code only calculates the length of the <b>last</b> command line argument ... you reset <code>j</code> to <code>0</code> each time. probably, you wanted to use <code>size</code> in your <code>malloc()</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532429830, "post_id": 51496426, "comment_id": 89961494, "body": "just using a destination buffer of reasonable length and counting as you append would be easier anyways (and the idiomatic C way to do it)."}, {"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "edited": false, "score": 0, "creation_date": 1532430053, "post_id": 51496426, "comment_id": 89961642, "body": "@FelixPalmen You&#39;re right about <code>size</code> and <code>malloc</code>, thanks! Big blunder on my part here. Fixing that didn&#39;t fix the issue tho, it seems to come from <code>\\n</code>.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532430191, "post_id": 51496426, "comment_id": 89961750, "body": "the size of your buffer <b>is</b> the issue. You also forget to add the space for all the <code>\\n</code> characters. with your code, <code>str = malloc(size + argc);</code> would be correct, I guess. (use this concise form. casting <code>void *</code> is completely superfluous and the size of a <code>char</code> is 1 <i>by definition</i>)"}, {"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "edited": false, "score": 0, "creation_date": 1532430843, "post_id": 51496426, "comment_id": 89962156, "body": "@FelixPalmen Thank you very much Felix. <code>malloc(size + 1 + argc)</code> did it! You were right about me forgetting space for the <code>\\n&#39;s</code>"}, {"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "edited": false, "score": 0, "creation_date": 1532431059, "post_id": 51496426, "comment_id": 89962275, "body": "@FelixPalmen Why does <code>(char*)malloc(sizeof(*str) * (size + 1 + argc))</code> do not work and <code>malloc(size + 1 + argc)</code> does tho?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532431173, "post_id": 51496426, "comment_id": 89962356, "body": "The <code>+1</code> is unnecessary, you append one extra character for each argument, in sum <code>argc</code> characters. Apart from that: both statements are exactly the same, given <code>str</code> has type <code>char *</code> and the result is assigned to a <code>char *</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1532431318, "post_id": 51496426, "comment_id": 89962443, "body": "Just spotted another bug: Your <code>cat()</code> function expects the whole buffer to be zeroed-out. Better write a <code>\\0</code> <b>every</b> time, then you only have to zero the first element before the first call. Right now, your whole program fails if the memory returned by <code>malloc()</code> isn&#39;t zeroed by coincidence."}, {"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "edited": false, "score": 0, "creation_date": 1532433515, "post_id": 51496426, "comment_id": 89963845, "body": "How can I <code>write a \\0 every time</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "edited": false, "score": 0, "creation_date": 1532541412, "post_id": 51506372, "comment_id": 90018863, "body": "Thank you very much for your answer. This is very instructive for a beginner like me!"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 1, "last_activity_date": 1532461151, "creation_date": 1532461151, "answer_id": 51506372, "question_id": 51496426, "link": "https://stackoverflow.com/questions/51496426/custom-strcat-is-overwhelmed-by-too-many-arguments/51506372#51506372", "title": "Custom STRCAT is overwhelmed by too many arguments", "body": "<p>There are quite a few issues with the code:</p>\n\n<ul>\n<li><p><code>sizeof (char) == 1</code> by the C standard.</p></li>\n<li><p><code>cat()</code> requires the destination to be a string (terminated by a <code>\\0</code>), but does not append it itself (except for <code>current &gt;= argc_nb - 1</code>). This is a bug.</p></li>\n<li><p><code>free(str); return str;</code> is an use-after-free bug.  If you call <code>free(str)</code>, the contents at <code>str</code> are irrevocably lost, inaccessible. The <code>free(str)</code> should simply be removed; it is not appropriate here.</p></li>\n<li><p>Arrays in C are indexed at 0. However, the <code>concator()</code> function skips the first string pointer (because <code>argv[0]</code> contains the name used to execute the program). This is wrong, and will eventually trip someone.  Instead, have <code>concator()</code> add all strings in the array, but call it using <code>concator(argc - 1, argv + 1);</code>.</p></li>\n</ul>\n\n<p>There might be even more, but at this point, I believe a rewrite from scratch, using a much more appropriate approach, is in order.</p>\n\n<p>Consider the following <code>join()</code> function:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nchar *join(const size_t parts, const char *part[],\n           const char *separator, const char *suffix)\n{\n    const size_t separator_len = (separator) ? strlen(separator) : 0;\n    const size_t suffix_len = (suffix) ? strlen(suffix) : 0;\n    size_t       total_len = 0;\n    size_t       p;\n    char        *dst, *end;\n\n    /* Calculate sum of part lengths */\n    for (p = 0; p &lt; parts; p++)\n        if (part[p])\n            total_len += strlen(part[p]);\n\n    /* Add separator lengths */\n    if (parts &gt; 1)\n        total_len += (parts - 1) * separator_len;\n\n    /* Add suffix length */\n    total_len += suffix_len;\n\n    /* Allocate enough memory, plus end-of-string '\\0' */\n    dst = malloc(total_len + 1);\n    if (!dst)\n        return NULL;\n\n    /* Keep a pointer to the current end of the result string */\n    end = dst;\n\n    /* Append each part */\n    for (p = 0; p &lt; parts; p++) {\n\n        /* Insert separator */\n        if (p &gt; 0 &amp;&amp; separator_len &gt; 0) {\n            memcpy(end, separator, separator_len);\n            end += separator_len;\n        }\n\n        /* Insert part */\n        if (part[p]) {\n            const size_t  len = strlen(part[p]);\n            if (len &gt; 0) {\n                memcpy(end, part[p], len);\n                end += len;\n            }\n        }\n    }\n\n    /* Append suffix */\n    if (suffix_len &gt; 0) {\n        memcpy(end, suffix, suffix_len);\n        end += suffix_len;\n    }\n\n    /* Terminate string. */\n    *end = '\\0';\n\n    /* All done. */\n    return dst;\n}\n</code></pre>\n\n<p>The logic is simple. First, we find out the length of each component.  Note that <code>separator</code> is only added between parts (so occurs <code>parts-1</code> times), and <code>suffix</code> at the very end.</p>\n\n<p>(The <code>(string) ? strlen(string) : 0</code> idiom just means <em>\"if <code>string</code> is non-NULL, <code>strlen(0)</code>, otherwise <code>0</code>\"</em>. We do that, because we allow NULL separator and suffix, but <code>strlen(NULL)</code> is Undefined Behaviour.)</p>\n\n<p>Next, we allocate enough memory for the result, including the end-of-string NUL char, <code>\\0</code>, that was not included in the lengths.</p>\n\n<p>To append each part, we keep the result pointer intact, and instead use a temporary <code>end</code> pointer. (It is the end of the string thus far.) We use a loop, where we copy the next part to the <code>end</code>. Before the second and subsequent parts, we copy the separator before the part.</p>\n\n<p>Next, we copy the suffix, and finally the end-of-string <code>'\\0'</code>.  (It is important to return a pointer to the beginning of the string, rather than end, of course; and that is why we kept <code>dst</code> to point to the new resulting string, and <code>end</code> at the point we appended each substring.)</p>\n\n<p>You could use it from the command line using for example the following <code>main()</code>:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    char *result;\n\n    if (argc &lt; 4) {\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"Usage: %s SEPARATOR SUFFIX PART [ PART ... ]\\n\", argv[0]);\n        fprintf(stderr, \"\\n\");\n        return EXIT_FAILURE;\n    }\n\n    result = join(argc - 3, (const char **)(argv + 3), argv[1], argv[2]);\n    if (!result) {\n        fprintf(stderr, \"Failed.\\n\");\n        return EXIT_FAILURE;\n    }\n\n    fputs(result, stdout);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>If you compile the above to e.g. <code>example</code> (I use <code>gcc -Wall -O2 example.c -o example</code>), then running</p>\n\n<pre><code>./example ', ' $'!\\n' Hello world\n</code></pre>\n\n<p>in a Bash shell outputs</p>\n\n<pre><code>Hello, world!\n</code></pre>\n\n<p>(with a newline at end). Running</p>\n\n<pre><code>./example ' and ' $'.\\n' a b c d e f g\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>a and b and c and d and e and f and g\n</code></pre>\n\n<p>(again with a newline at end). The <code>$'...'</code> is just a Bash idiom to specify special characters in strings; <code>$'!\\n'</code> is the same in Bash as <code>\"!\\n\"</code> is in C, and <code>$'.\\n'</code> is the Bash equivalent of <code>\".\\n\"</code> in C.</p>\n\n<p>(Removing the automatic newline between parts, and allowing a string rather than just one char to be used as a separator and suffix, was a deliberate choice for two reasons. The main one is to stop anyone from just copy-pasting this as an answer to some exercise. The secondary one is to show that while it might <em>sound</em> more complicated than just using single characters for them, it is actually very little additional code; and if you consider the practical use cases, allowing a string to be used as the separator opens up a lot of options.)</p>\n\n<p>The example code above is only very lightly tested, and might contain bugs. If you find any, or disagree with anything I've written above, do let me know in a comment so I can review, and fix as necessary.</p>\n"}], "owner": {"reputation": 711, "user_id": 8962453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5XY7u.png?s=128&g=1", "display_name": "Wizzardzz ", "link": "https://stackoverflow.com/users/8962453/wizzardzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 51506372, "answer_count": 1, "score": 0, "last_activity_date": 1532461151, "creation_date": 1532428452, "last_edit_date": 1532430078, "question_id": 51496426, "link": "https://stackoverflow.com/questions/51496426/custom-strcat-is-overwhelmed-by-too-many-arguments", "title": "Custom STRCAT is overwhelmed by too many arguments", "body": "<p>I am trying to code a custom <code>strcat</code> that separates arguments with <code>\\n</code> except for the last one and terminates the string with <code>\\0</code>.</p>\n\n<p>It's working fine as is up to 5 arguments, but if I try passing a sixth one I get a strange line in response :</p>\n\n<pre><code>MacBook-Pro-de-Domingo% ./test ok ok ok ok ok\nok\nok\nok\nok\nok\nMacBook-Pro-de-Domingo% ./test ok ok ok ok ok ok\nok\nok\nok\nok\nok\nP/Users/domingodelmasok\n</code></pre>\n\n<p>Here is my custom <code>strcat</code> code:</p>\n\n<pre><code>char    cat(char *dest, char *src, int current, int argc_nb)\n{\n    int i = 0;\n    int j = 0;\n\n    while(dest[i])\n        i++;\n\n    while(src[j])\n    {\n        dest[i + j] = src[j];\n        j++;\n    }\n\n    if(current &lt; argc_nb - 1)\n        dest[i + j] = '\\n';\n    else\n        dest[i + j] = '\\0';\n\n    return(*dest);\n}\n</code></pre>\n\n<p><strong>UPDATE</strong> Complete calling function:</p>\n\n<pre><code>char    *concator(int argc, char **argv)\n{\n    int i;\n    int j;\n    int size = 0;\n    char *str;\n\n    i = 1;\n\n    while(i &lt; argc)\n    {\n        j = 0;\n        while(argv[i][j])\n        {\n            size++;\n            j++;\n        }\n        i++;\n    }\n\n    str = (char*)malloc(sizeof(*str) * (size + 1));\n\n    i = 1;\n\n   while(i &lt; argc)\n   {\n        cat(str, argv[i], i, argc);\n        i++;\n    }\n\n    free(str);\n    return(str);\n}\n</code></pre>\n\n<p>What's wrong here?</p>\n\n<p>Thanks!</p>\n\n<p>Edit: Fixed blunder.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1332, "user_id": 5396597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5bc24f12645783a5fef2e275831dfc6?s=128&d=identicon&r=PG&f=1", "display_name": "mnille", "link": "https://stackoverflow.com/users/5396597/mnille"}, "edited": false, "score": 0, "creation_date": 1532428193, "post_id": 51496263, "comment_id": 89960489, "body": "Please paste your - runnable - code."}, {"owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 0, "creation_date": 1532428202, "post_id": 51496263, "comment_id": 89960495, "body": "Please include your code. This is necessary. Just copy/paste into the question window, highlight all of it and then press <code>ctrl</code>+<code>k</code> to format it"}, {"owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 0, "creation_date": 1532428281, "post_id": 51496263, "comment_id": 89960543, "body": "Please also tell us what you have tried, why it didn&#39;t work and any errors you get."}, {"owner": {"reputation": 5, "user_id": 10127204, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NzqqkjBkgCg/AAAAAAAAAAI/AAAAAAAAABc/YpVxhXFLGAg/photo.jpg?sz=128", "display_name": "Harsh raj", "link": "https://stackoverflow.com/users/10127204/harsh-raj"}, "edited": false, "score": 0, "creation_date": 1532493187, "post_id": 51496263, "comment_id": 89990268, "body": "the code has alredy been included in the form of link . I expect people here to read my question properlybefore putting my question on hold ! The problem has also been stated as when I enter  1 3 4 it should return 4 but it returns 3. I had also uploaded the question link .The people who were curious to help went through it and posted valuable comments. It is very pathetic to know that people just put your question on hold even before trying to solve it ."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10127204, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NzqqkjBkgCg/AAAAAAAAAAI/AAAAAAAAABc/YpVxhXFLGAg/photo.jpg?sz=128", "display_name": "Harsh raj", "link": "https://stackoverflow.com/users/10127204/harsh-raj"}, "edited": false, "score": 1, "creation_date": 1532494656, "post_id": 51496814, "comment_id": 89990634, "body": "Thanks for making me know where my code was wrong .  Although your code was correct, it took me time to understand what you wanted to do . Meanwhile , I corrected my code and now it works . Thanks for the quick reply (I am a beginer)   . If anyone wants to see my corrected code , : <a href=\"https://paste.ubuntu.com/p/VRqT9ycCMp/\" rel=\"nofollow noreferrer\">paste.ubuntu.com/p/VRqT9ycCMp</a>"}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": true, "score": 0, "last_activity_date": 1532430966, "last_edit_date": 1532430966, "creation_date": 1532429648, "answer_id": 51496814, "question_id": 51496263, "link": "https://stackoverflow.com/questions/51496263/me-on-with-my-code-on-codechef-elementary/51496814#51496814", "title": "me on with my code on codechef elementary", "body": "<p>Your code is wrong. In your function <code>prime()</code> due to the statement <code>b++;</code> , <code>(a+b)</code> is changing in <code>(a+b)%c</code> but the incremented <code>c</code> is never went back.So for bigger prime numbers your code <strong>will fail</strong> </p>\n\n<p>Eg:- <em>(89,1) (79,1) etc</em></p>\n\n<p>Also You don't need that <code>d[c]</code> in your code. You don't need to store every output.When you compute one output just print it .That is <code>ok</code> with code-chef. Also You can divide the problem into to functions.</p>\n\n<p>Try this simplified code :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint prime(int n);\nint make_prime(int a);\n\nint main()\n{\n    int c;\n    scanf(\"%d\", &amp;c);\n    int a, b;\n\n    for (a = 0; a &lt; c; a++)\n    {\n        int x, y;\n        scanf(\"%d %d\", &amp;x, &amp;y);\n        b = (x + y);\n\n        printf(\"%d\\n\", make_prime(b));\n\n    }\n\n    return 0;\n}\n\nint make_prime(int a) \n{\n    int c=1;\n    while(prime(a+c)==0){\n        c++;\n    }\n    return c;\n}\n\nint prime(int n){ // simple prime function\n\n    int i,flag=1;\n    for (i = 2; i &lt;= (n)/2; i++)\n    {\n        if ((n) % i == 0)\n        {\n           flag=0;\n           break;\n        }\n    }\n    return flag;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10127204, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NzqqkjBkgCg/AAAAAAAAAAI/AAAAAAAAABc/YpVxhXFLGAg/photo.jpg?sz=128", "display_name": "Harsh raj", "link": "https://stackoverflow.com/users/10127204/harsh-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1532447982, "accepted_answer_id": 51496814, "answer_count": 1, "score": -2, "last_activity_date": 1532430966, "creation_date": 1532427982, "last_edit_date": 1532428919, "question_id": 51496263, "link": "https://stackoverflow.com/questions/51496263/me-on-with-my-code-on-codechef-elementary", "closed_reason": "Needs details or clarity", "title": "me on with my code on codechef elementary", "body": "<p>I face problems with my code when I enter 1 3 4 . although I couldn't find any error as it works perfectly with other numbers / ps. the was built as a solution to the codechef problem <a href=\"https://www.codechef.com/problems/POTATOES\" rel=\"nofollow noreferrer\">POTATOES</a></p>\n\n<blockquote>\n  <p><strong>Problem summary:</strong> Write a program that inputs an integer T followed by T lines containing two space-separated positive integers. For each of these lines, output the smallest number (>1) that, when added to the sum of these two numbers, results in a sum that is a prime number.</p>\n</blockquote>\n\n<p>and my code is </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nint prime(int a,int b);\n\nint main() {\n    int c;\n    scanf(\"%d\",&amp;c);\n    int a,b,d[c];\n\n    for(a=0; a&lt;c; a++) {\n        int x,y;\n        scanf(\"%d %d\",&amp;x,&amp;y);\n        b=(x+y);\n        if(prime(x,y)-b!=0)\n            d[a]=prime(x,y)-b;\n        else d[a]=prime((x+1),y)-b;\n    }\n    for(a=0; a&lt;c; a++)printf(\"%d\\n\",d[a]);\n\n    return 0;\n}\n\nint prime(int a,int b) {\n    int c,e;\n    for(c=2; c&lt;(a+b); c++) {\n        if((a+b)%c==0) {\n            b++;\n            continue;\n        }\n        return(a+b);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "unions"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1532426599, "post_id": 51495652, "comment_id": 89959587, "body": "of course they are incompatible and the warning is correct. Declare daraArray as table of unions or cast it ."}, {"owner": {"reputation": 99, "user_id": 6821375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193080607402262/picture?type=large", "display_name": "Wouter Thys", "link": "https://stackoverflow.com/users/6821375/wouter-thys"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1532426706, "post_id": 51495652, "comment_id": 89959651, "body": "I can not change the array.. I want a struct or union or.. to easily change the uint16_t value of the array. How would I do a cast?"}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1532427455, "post_id": 51496021, "comment_id": 89960080, "body": "It is wrong my fiend. try <code>status++</code> and see if if does what you think."}, {"owner": {"reputation": 99, "user_id": 6821375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193080607402262/picture?type=large", "display_name": "Wouter Thys", "link": "https://stackoverflow.com/users/6821375/wouter-thys"}, "edited": false, "score": 0, "creation_date": 1532427877, "post_id": 51496021, "comment_id": 89960322, "body": "I assume the pointer would go the next address in the array? However for this particular case, the pointer will never change. It may be better to declare it like this: <code>static SupplyStatus_t * const status = (SupplyStatus_t*)&amp;(dataArray[6]);</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1532427939, "post_id": 51496021, "comment_id": 89960353, "body": "Not only is this wrong, even if things were &quot;correct&quot; it would still be a <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing violation</a>.  Making errors and warnings disappear by forcefully casting a value is a <b>really</b> bad idea."}, {"owner": {"reputation": 34, "user_id": 10126937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc5afa8156d9c74072eda327393d7ac?s=128&d=identicon&r=PG&f=1", "display_name": "destr", "link": "https://stackoverflow.com/users/10126937/destr"}, "edited": false, "score": 1, "creation_date": 1532428707, "post_id": 51496021, "comment_id": 89960796, "body": "Well, I just tried the code and it works. If you call status.value++ the value in dataArray will be increased. In this situation, the cast is necessary and not a bad idea - how else could you assign a union to a specific type without a cast?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1532431186, "post_id": 51496021, "comment_id": 89962364, "body": "will be increased but by how many elements of the array (one or two - what do you think)"}, {"owner": {"reputation": 34, "user_id": 10126937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc5afa8156d9c74072eda327393d7ac?s=128&d=identicon&r=PG&f=1", "display_name": "destr", "link": "https://stackoverflow.com/users/10126937/destr"}, "edited": false, "score": 0, "creation_date": 1532431608, "post_id": 51496021, "comment_id": 89962597, "body": "what do you mean? status.value++ increases the value of dataArray[6] by one"}, {"owner": {"reputation": 34, "user_id": 10126937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc5afa8156d9c74072eda327393d7ac?s=128&d=identicon&r=PG&f=1", "display_name": "destr", "link": "https://stackoverflow.com/users/10126937/destr"}, "edited": false, "score": 0, "creation_date": 1532438566, "post_id": 51496021, "comment_id": 89967632, "body": "by two. but this was not asked. dataArray represents the status and we want a pointer that points to that status. no need to increment the pointer itself - it would only point to the address where the pointer ends."}], "tags": [], "owner": {"reputation": 34, "user_id": 10126937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc5afa8156d9c74072eda327393d7ac?s=128&d=identicon&r=PG&f=1", "display_name": "destr", "link": "https://stackoverflow.com/users/10126937/destr"}, "is_accepted": true, "score": 1, "last_activity_date": 1532427179, "creation_date": 1532427179, "answer_id": 51496021, "question_id": 51495652, "link": "https://stackoverflow.com/questions/51495652/c-union-pointer-to-array/51496021#51496021", "title": "C union pointer to array", "body": "<p>The warning says that uint16_t* is not compatible with SupplyStatus_t*.\nIf you want to get rid of this warning, cast it to SupplyStatus_t*:</p>\n\n<pre><code>status = (SupplyStatus_t*)&amp;(dataArray[6]);\n</code></pre>\n\n<p>I also would put the union and struct together:</p>\n\n<pre><code>typedef union\n{\n  struct\n  {\n    unsigned statusCode : 4;\n    unsigned errorCode : 4;\n    unsigned outputEnabled : 1;\n    unsigned currentClip :1;\n    unsigned unused : 6;\n  } s;\n  uint16_t value;\n} SupplyStatus_t;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 6821375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193080607402262/picture?type=large", "display_name": "Wouter Thys", "link": "https://stackoverflow.com/users/6821375/wouter-thys"}, "edited": false, "score": 0, "creation_date": 1532427454, "post_id": 51496026, "comment_id": 89960078, "body": "But when I would change the values of the status struct, it would not change the value of the element in the array."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 99, "user_id": 6821375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193080607402262/picture?type=large", "display_name": "Wouter Thys", "link": "https://stackoverflow.com/users/6821375/wouter-thys"}, "edited": false, "score": 0, "creation_date": 1532427609, "post_id": 51496026, "comment_id": 89960176, "body": "you can cast it as I wrote in the comment but it is not conforming C. BTW always check if your union has the size you think it has. See the ideone example in my answer"}, {"owner": {"reputation": 99, "user_id": 6821375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193080607402262/picture?type=large", "display_name": "Wouter Thys", "link": "https://stackoverflow.com/users/6821375/wouter-thys"}, "edited": false, "score": 0, "creation_date": 1532427717, "post_id": 51496026, "comment_id": 89960239, "body": "Yes I see the difference now!"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1538152842, "post_id": 51496026, "comment_id": 92057676, "body": "Why is it not conforming?  It certainly isn&#39;t <i>strictly</i> conforming, but only a tiny fraction of C programs are. The Standard explicitly says that portability is not a requirement for conformance."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1532427472, "last_edit_date": 1532427472, "creation_date": 1532427193, "answer_id": 51496026, "question_id": 51495652, "link": "https://stackoverflow.com/questions/51495652/c-union-pointer-to-array/51496026#51496026", "title": "C union pointer to array", "body": "<ol>\n<li>Change <code>unsigned</code> to <code>uint16_t</code></li>\n</ol>\n\n<p>why? - test the difference:\n<a href=\"https://ideone.com/uHLzpV\" rel=\"nofollow noreferrer\">https://ideone.com/uHLzpV</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef struct {\n        uint16_t statusCode     : 4;\n        unsigned errorCode      : 4;\n        unsigned outputEnabled  : 1;\n        unsigned currentClip    : 1;\n        unsigned                : 6;\n} SupplyStruct_t;\n\ntypedef struct {\n        uint16_t statusCode     : 4;\n        uint16_t errorCode      : 4;\n        uint16_t outputEnabled  : 1;\n        uint16_t currentClip    : 1;\n        uint16_t                : 6;\n} SupplyStruct_t1;\n\n\ntypedef union {\n    SupplyStruct_t s;\n    uint16_t value;\n} SupplyStatus_t;\n\ntypedef union {\n    SupplyStruct_t1 s;\n    uint16_t value;\n} SupplyStatus_t1;\n\nint main(void) {\n    printf(\"%zu %zu\\n\", sizeof(SupplyStatus_t), sizeof(SupplyStatus_t1));\n    return 0;\n}\n</code></pre>\n\n<p>The most correct way is to declare the table as table of structs.</p>\n\n<p>If not :</p>\n\n<p>If you want too work on the bitfields you do not actually have to declare the pointer.</p>\n\n<pre><code>static SupplyStatus_t status;\nstatus.value = dataArray[6];\n</code></pre>\n\n<p>and it is almost portable and safe way</p>\n\n<p>you can also cast it explicitly </p>\n"}], "owner": {"reputation": 99, "user_id": 6821375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193080607402262/picture?type=large", "display_name": "Wouter Thys", "link": "https://stackoverflow.com/users/6821375/wouter-thys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "accepted_answer_id": 51496021, "answer_count": 2, "score": 0, "last_activity_date": 1546965067, "creation_date": 1532426078, "last_edit_date": 1546965067, "question_id": 51495652, "link": "https://stackoverflow.com/questions/51495652/c-union-pointer-to-array", "title": "C union pointer to array", "body": "<p>I have an array of unsigned 16-bit integers:</p>\n\n<pre><code>static uint16_t dataArray[7];\n</code></pre>\n\n<p>The bits of the 7th element of the array represents some kind of status. I want to get and set the values of this status in an easy way, without bit shifting and without having to copy a new value to the array every time the status changes. So I created a union with a struct, and a pointer:</p>\n\n<pre><code>typedef struct {\n        unsigned statusCode     : 4;\n        unsigned errorCode      : 4;\n        unsigned outputEnabled  : 1;\n        unsigned currentClip    : 1;\n        unsigned                : 6;\n} SupplyStruct_t;\n\ntypedef union {\n    SupplyStruct_t s;\n    uint16_t value;\n} SupplyStatus_t;\n\nstatic SupplyStatus_t * status;\n</code></pre>\n\n<p>My initialisation routine wants the status pointer to point to the 7th element of the array, so I tried:</p>\n\n<pre><code>status = &amp;(dataArray[6]);\n</code></pre>\n\n<p>Although this works, I get a warning: <em>assignment from incompatible pointer type</em></p>\n\n<p>Is there a better way to do this? I cannot change the array, but I am free to change the structure, the union or the pointer to the array.. </p>\n"}, {"tags": ["c", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "edited": false, "score": 1, "creation_date": 1532426797, "post_id": 51495809, "comment_id": 89959699, "body": "Thanks. It worked and shows me a simpler way of approach."}, {"owner": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "edited": false, "score": 0, "creation_date": 1532426891, "post_id": 51495809, "comment_id": 89959747, "body": "It would clear much more if you could explain why my code got an &quot;Runtime error&quot;."}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "reply_to_user": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "edited": false, "score": 0, "creation_date": 1532427236, "post_id": 51495809, "comment_id": 89959932, "body": "you code will not work for big numbers like <code>9999</code> .In those cases segmentation fault <i>(runtime error)</i> occurs"}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "reply_to_user": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "edited": false, "score": 0, "creation_date": 1532428209, "post_id": 51495809, "comment_id": 89960497, "body": "I have explained It in the answer. I think you are clear now."}, {"owner": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "edited": false, "score": 0, "creation_date": 1532430044, "post_id": 51495809, "comment_id": 89961636, "body": "Thanks. For the clarification. It helped."}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": true, "score": 0, "last_activity_date": 1532428161, "last_edit_date": 1532428161, "creation_date": 1532426545, "answer_id": 51495809, "question_id": 51495464, "link": "https://stackoverflow.com/questions/51495464/c-runtime-error-for-uva-1225-digit-counting/51495809#51495809", "title": "C &quot;RunTime Error&quot; for UVa 1225 &quot;Digit Counting&quot;", "body": "<p>The <code>RunTime Error</code> occurring in you code is <code>segmentation fault</code> . This is because of you usage of  <code>a[10000]</code>. In your code <code>a[j]=k;</code> you are using so much of memory.<em>(for a 2 digit number you use 2 array locations , 3 digit 3 etc)</em> So for a number greater than <code>3000</code> <em>(approx)</em> You is go out of limit <code>10000</code> and results a <code>segmentation error</code>.</p>\n\n<p>You don't need that <code>a[10000]</code> to implement the counting code.</p>\n\n<p>Try this simplified code :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int n, num, i, b[10], k, it, l;\n    scanf(\"%d\", &amp;it);\n    for (l = 0; l &lt; it; l++)\n    {\n        for (i = 0; i &lt;= 9; i++)\n        {\n            b[i] = 0;\n        }\n\n        scanf(\"%d\", &amp;n);\n        for (i = 1; i &lt;= n; i++)\n        {\n            num = i;\n            while (num != 0)\n            {\n                k = num % 10;\n                num = num / 10;\n                b[k]++;\n            }\n        }\n        printf(\"%d\", b[0]);\n\n        for (i = 1; i &lt;= 9; i++)\n        {\n            printf(\" %d\", b[i]);\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output :-</strong></p>\n\n<pre><code>2\n3\n13\n0 1 1 1 0 0 0 0 0 0\n1 6 2 2 1 1 1 1 1 1\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1594114118, "accepted_answer_id": 51495809, "answer_count": 1, "score": 0, "last_activity_date": 1594114113, "creation_date": 1532425552, "last_edit_date": 1594114113, "question_id": 51495464, "link": "https://stackoverflow.com/questions/51495464/c-runtime-error-for-uva-1225-digit-counting", "closed_reason": "Not suitable for this site", "title": "C &quot;RunTime Error&quot; for UVa 1225 &quot;Digit Counting&quot;", "body": "<p>I was solving an UVa problem. When checked in UVa it showed \"Woohoo! Your output is identical to the accepted output!\". But when i submitted the code it kept getting \"Runtime error\". I have no idea why is this happening or why \"Runtime error happens at all.\"</p>\n\n<p>Here is the problem -> <a href=\"https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=16&amp;page=show_problem&amp;problem=3666\" rel=\"nofollow noreferrer\">https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=16&amp;page=show_problem&amp;problem=3666</a></p>\n\n<p>Here is my code -></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\nint j=0,n,num,i,a[10000],b[10],k,it,l;\nscanf(\"%d\",&amp;it);\nfor(l=0; l&lt;it; l++)\n{\n\n    scanf(\"%d\",&amp;n);\n    j=0;\n    for(i=1; i&lt;=n; i++)\n    {\n        num=i;\n        while(num!=0)\n        {\n            k=num%10;\n            num=num/10;\n            a[j]=k;\n            j++;\n        }\n    }\n    a[j]=9999;\n\n    for(i=0; i&lt;=9; i++)\n    {\n        b[i]=0;\n    }\n\n    for(j=0; a[j]!=9999; j++)\n    {\n        b[a[j]]++;\n    }\n\n        printf(\"%d\",b[0]);\n\n    for(i=1; i&lt;=9; i++)\n    {\n        printf(\" %d\",b[i]);\n    }\n    printf(\"\\n\");\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "optimization"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1532423560, "post_id": 51494787, "comment_id": 89957823, "body": "Why do you think the condition might be false everytime?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1532423676, "post_id": 51494787, "comment_id": 89957897, "body": "Looks like a typo in the article - it should probably be: <code>if (!(src &amp; ~0xFFFFFFFC) &amp;&amp; !(dst &amp; ~0xFFFFFFFC))</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1532423680, "post_id": 51494787, "comment_id": 89957902, "body": "For checking alignment you might want to use <code>!(src&amp;3) &amp;&amp; !(dst&amp;3)</code> The condition in the snippet check something different"}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 2, "creation_date": 1532423803, "post_id": 51494787, "comment_id": 89957962, "body": "Also the first comment of this article notices this typo"}, {"owner": {"reputation": 179, "user_id": 6671115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/afb31cad947f2eada3740c6a8c7c9b20?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/6671115/abhi"}, "edited": false, "score": 0, "creation_date": 1532426012, "post_id": 51494787, "comment_id": 89959219, "body": "Thanks for the comment. Alignment is now clear. Can we do some more optimization in the code to make it faster ? What if we didn&#39;t check for 4 byte alignment ?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532427530, "post_id": 51494787, "comment_id": 89960125, "body": "If your CPU does not allow 32bit read access to unaligned addresses you could get SEGFAULT or wrong content. Or you could suffer from a huge penalty in speed of memory accesses...."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1532427884, "post_id": 51494787, "comment_id": 89960328, "body": "To be really optimised for larger transfers it should check if  the start is aligned - copy byte by byte the unaligned one, the copy the native length ones"}, {"owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "edited": false, "score": 0, "creation_date": 1532427958, "post_id": 51494787, "comment_id": 89960368, "body": "@Abhi you can extent the code with the use of more special-cases (e.g for 64 Bit), but you should be carefull here, since the compiler can optimize the code too."}, {"owner": {"reputation": 179, "user_id": 6671115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/afb31cad947f2eada3740c6a8c7c9b20?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/6671115/abhi"}, "edited": false, "score": 0, "creation_date": 1532428748, "post_id": 51494787, "comment_id": 89960819, "body": "Ok.Address should be aligned but is it require that both src and dest should be aligned. Otherwise we can use the method told by @ P__J__"}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1532724361, "post_id": 51559967, "comment_id": 90097521, "body": "I&#39;d suggest checking for <code>len &lt;= 8</code> before doing anything else, and using a <code>switch</code> statement to handle short copy operations.  That would avoid the need to check whether you can copy data up to the point where the source and/or destination come into alignment.  I&#39;d suggest copying data until the destination is aligned, and then if source isn&#39;t in alignment and the copy is &quot;big&quot;, having the main loop be something like <code>x = *adjustedSrc++; *dest++ = (x &lt;&lt; shift1) | (y &gt;&gt; shift2); y=x;</code>, thus avoiding any need to decompose operations into smaller chunks."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1532768618, "post_id": 51559967, "comment_id": 90105636, "body": "@supercat: good points. regarding the combination of unaligned source bytes into <code>long</code>s for storing into an aligned destination address, it is easy to overlook the byte order issue. Depending on the architecture, it might not even be faster. As a matter of fact, on x86 targets where unaligned reads and writes are allowed,  a simple read/write loop via a 64-bit type may be the fastest solution. Benchmarking is the judge."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1532770117, "post_id": 51559967, "comment_id": 90105976, "body": "Not to mention that optimizing <code>memcpy()</code> is very processor-specific. On x86, often the memcpy-opcode is best, or at least reasonable enough."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1601058338, "last_edit_date": 1601058338, "creation_date": 1532701313, "answer_id": 51559967, "question_id": 51494787, "link": "https://stackoverflow.com/questions/51494787/optimization-in-memcpy-implementation/51559967#51559967", "title": "Optimization in Memcpy implementation", "body": "<p>This article, while addressing an interesting subject, falls short of providing correct examples. The code posted is referred to as <em>GNU's newlib source code</em>. Both the GNU project and the newlib team will be surprised to learn of this unexpected convergence statement! the <em>newlib</em> is not a GNU project and most of its source code is not GPL licenced.</p>\n<p>This <em>optimized</em> implementation of <code>memcpy</code> is non portable, sub-optimal and in many aspects incorrect.</p>\n<p>The test <code>if (!(src &amp; 0xFFFFFFFC) &amp;&amp; !(dst &amp; 0xFFFFFFFC))</code> attempts to detect if the <code>src</code> and <code>dst</code> addresses are aligned on <code>long</code> boundaries. It is cumbersome and non portable for multiple reasons and downright incorrect as you noticed:</p>\n<ul>\n<li>implicit conversion from <code>void *</code> to <code>int</code> is ugly and implementation defined. The pointers should be cast as <code>(uintptr_t)</code> for better portability.</li>\n<li><code>0xFFFFFFFC</code> assumes type <code>long</code> is 4 bytes. This may be incorrect, and indeed type <code>long</code> is 8-byte long on 64-bit linux and Mac systems.</li>\n<li><code>src &amp; 0xFFFFFFFC</code> is not a check for alignment and is unlikely to be <code>0</code>, the intended test for alignment on 4-byte boundaries is <code>src &amp; 3</code>.</li>\n</ul>\n<p>Furthermore, the code fails to optimize the case where <code>src</code> and <code>dst</code> have the same alignment but are not aligned on <code>long</code> boundaries.</p>\n<p>Other possible improvements include unrolling the loops, using a switch for small values of <code>len</code>, combining bytes read from <code>src</code> into <code>long</code>s to write to <code>dst</code> once its is aligned on <code>long</code> boundaries...</p>\n<p>Here is an improved alternative:</p>\n<pre><code>#include &lt;stdint.h&gt;\n\nvoid *memcpy(void *dst, void const *src, size_t len) {\n    unsigned char *pcDst = (unsigned char *)dst;\n    unsigned char const *pcSrc = (unsigned char const *)src;\n\n    if (len &gt;= sizeof(long) * 2\n    &amp;&amp;  ((uintptr_t)src &amp; (sizeof(long) - 1)) == ((uintptr_t)dst &amp; (sizeof(long) - 1))) {\n        while (((uintptr_t)pcSrc &amp; (sizeof(long) - 1)) != 0) {\n            *pcDst++ = *pcSrc++;\n            len--;\n        }\n        long *plDst = (long *)pcDst;\n        long const *plSrc = (long const *)pcSrc;\n        /* manually unroll the loop */\n        while (len &gt;= sizeof(long) * 4) {\n            plDst[0] = plSrc[0];\n            plDst[1] = plSrc[1];\n            plDst[2] = plSrc[2];\n            plDst[3] = plSrc[3];\n            plSrc += 4;\n            plDst += 4;\n            len -= sizeof(long) * 4;\n        }\n        while (len &gt;= sizeof(long)) {\n            *plDst++ = *plSrc++;\n            len -= sizeof(long);\n        }\n        pcDst = (unsigned char *)plDst;\n        pcSrc = (unsigned char const *)plSrc;\n    }\n    while (len--) {\n         *pcDst++ = *pcSrc++;\n    }\n    return dst;\n}\n</code></pre>\n<p>Note that the casts from <code>void *</code> are unnecessary in C, but required in C++.</p>\n<p>Here are some important points to keep in mind when trying to optimize code for speed:</p>\n<ul>\n<li>no trade-offs on correctness. Fast code that fails even on border cases is useless.</li>\n<li>beware of portability issues: solutions that depend on type sizes and/or byte order may create portability problems.</li>\n<li>benchmarking will tell what works and what does not: you must carefully time the various alternatives on a variety of test cases.</li>\n<li>there is no perfect solution: faster code on one architecture can be slower on a different one including and most problematically on a future one. Benchmark on different architectures.</li>\n<li>fight complexity: avoid convoluted solutions that do not bring substantial improvements, their correctness is more difficult to prove and to maintain.</li>\n<li><code>memcpy</code> is usually optimized in assembly or implemented as a built-in by modern compilers.</li>\n</ul>\n"}], "owner": {"reputation": 179, "user_id": 6671115, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/afb31cad947f2eada3740c6a8c7c9b20?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/6671115/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1601058338, "creation_date": 1532423419, "last_edit_date": 1532717173, "question_id": 51494787, "link": "https://stackoverflow.com/questions/51494787/optimization-in-memcpy-implementation", "title": "Optimization in Memcpy implementation", "body": "<p>Below is the code which I got while searching for an optimized <code>memcpy</code> implementation.<br>\nHere's the <a href=\"https://www.embedded.com/design/configurable-systems/4024961/Optimizing-Memcpy-improves-speed\" rel=\"nofollow noreferrer\"><strong>link</strong></a></p>\n\n<pre><code>void *memcpy(void *dst, void const *src, size_t len) {\n    long *plDst = (long *)dst;\n    long const *plSrc = (long const *)src;\n\n    if (!(src &amp; 0xFFFFFFFC) &amp;&amp; !(dst &amp; 0xFFFFFFFC)) {\n        while (len &gt;= 4) {\n            *plDst++ = *plSrc++;\n            len -= 4;\n        }\n    }\n\n    char *pcDst = (char *)plDst;\n    char const *pcDst = (char const *)plSrc;\n\n    while (len--) {\n         *pcDst++ = *pcSrc++;\n    }\n\n    return (dst);\n}\n</code></pre>\n\n<p>Can somebody explain the line below to me?</p>\n\n<pre><code>if (!(src &amp; 0xFFFFFFFC) &amp;&amp; !(dst &amp; 0xFFFFFFFC))\n</code></pre>\n\n<p>Here they want to check if <code>src</code> and <code>dst</code> address are aligned to a <code>4 byte</code> boundary or not. Why are they using <code>!</code> though, as it will make the condition <code>false</code> every time?</p>\n\n<p>Secondly, is there any scope for more optimization in the above code?</p>\n"}, {"tags": ["c", "string", "packet"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1532421397, "post_id": 51494068, "comment_id": 89956516, "body": "You could send one more byte than you are actually sending ... also the <code>0x20</code> is not shown in your output"}, {"owner": {"reputation": 5001, "user_id": 1182192, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J6JgX.jpg?s=128&g=1", "display_name": "Abhineet", "link": "https://stackoverflow.com/users/1182192/abhineet"}, "edited": false, "score": 0, "creation_date": 1532421739, "post_id": 51494068, "comment_id": 89956720, "body": "char *payload = &quot; HELLOWORLD\\0&quot;;"}, {"owner": {"reputation": 587, "user_id": 9703208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/168cfbdd659ac8a46446ecf97727f78b?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay P", "link": "https://stackoverflow.com/users/9703208/vinay-p"}, "edited": false, "score": 1, "creation_date": 1532422051, "post_id": 51494068, "comment_id": 89956914, "body": "Cant you modify your receiver to take care of the issue? What is absolute need to send null appended string?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 5, "creation_date": 1532422545, "post_id": 51494068, "comment_id": 89957245, "body": "overkill. just <code>char * x =  &quot; HELLOWORLD&quot;</code>. but you need to send one char mode so probably somewhere in your code you have <code>strlen(payload)</code> and you need <code>strlen(payload) + 1</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1532423011, "post_id": 51494068, "comment_id": 89957516, "body": "This question lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1532423255, "post_id": 51494068, "comment_id": 89957651, "body": "You forgot to show how you determine the size of the packet you send. Please show the relevant code."}, {"owner": {"reputation": 69, "user_id": 10092274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604afb6082e9cb70cc4b99a9d827b9de?s=128&d=identicon&r=PG&f=1", "display_name": "camixetew", "link": "https://stackoverflow.com/users/10092274/camixetew"}, "edited": false, "score": 0, "creation_date": 1532426556, "post_id": 51494068, "comment_id": 89959554, "body": "I use strlen() but after reading your comments I understood where I did wrong"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1532421983, "post_id": 51494169, "comment_id": 89956858, "body": "You can put <code>\\x00</code> in a string literal , the original code is allowed. The presence of another <code>\\x00</code> will affect the behaviour of functions which look for a <code>\\x00</code> obviously."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1532422134, "post_id": 51494169, "comment_id": 89956969, "body": "that&#39;s what I meant: after that you cannot use <code>strlen</code> or such"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 3, "last_activity_date": 1532422212, "last_edit_date": 1532422212, "creation_date": 1532421598, "answer_id": 51494169, "question_id": 51494068, "link": "https://stackoverflow.com/questions/51494068/c-add-hex-nul-at-string-end-without-it-disappearing/51494169#51494169", "title": "C add hex NUL at string end without it disappearing", "body": "<p>you cannot put <code>\\x00</code> in a char literal because it's the delimiter for end of C string (well you <em>can</em>, but most C string functions won't be able to see it, and there's a nul-terminator at the end anyway so why add another one ?).</p>\n\n<p>That works in pure \"char array\" mode:</p>\n\n<pre><code>const char payload[] = {' ','H','E','L','L','O','W','O','R','L','D','\\x00'};\n</code></pre>\n\n<p>then send with <code>sizeof(payload)</code> as length.</p>\n\n<p>note that it's overkill when you can do:</p>\n\n<pre><code>const char *payload = \" HELLOWORLD\";\n</code></pre>\n\n<p>and send <code>payload</code> with a size of <code>strlen(payload)+1</code>. That will include the end-of-string terminator and the protocol will be respected.</p>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "is_accepted": false, "score": 3, "last_activity_date": 1532422337, "creation_date": 1532422337, "answer_id": 51494400, "question_id": 51494068, "link": "https://stackoverflow.com/questions/51494068/c-add-hex-nul-at-string-end-without-it-disappearing/51494400#51494400", "title": "C add hex NUL at string end without it disappearing", "body": "<p>The string created is correct and the null byte has been allocated. This is demonstrated by the following.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    char a[] = \"fred\";\n    char b[] = \"fred\\x00\";\n    printf(\"Hello World\\n\");\n    printf(\"size of %d\\n\",sizeof(a));\n    printf(\"size of %d\\n\",sizeof(b));\n    return 0;\n}\n</code></pre>\n\n<p>Which produces</p>\n\n<pre><code>Hello World\nsize of 5\nsize of 6\n</code></pre>\n\n<p>The issue is strlen() or similar will stop at the null so the added null is not included in the measurement of the length. The solution is obtain the length via another method. Unfortunately sizeof() is not a practical run time solution. Or just output the message with a length of strlen() + 1. Note that you will have a terminating null already so you do not need to add it to the string.  </p>\n"}], "owner": {"reputation": 69, "user_id": 10092274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604afb6082e9cb70cc4b99a9d827b9de?s=128&d=identicon&r=PG&f=1", "display_name": "camixetew", "link": "https://stackoverflow.com/users/10092274/camixetew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "closed_date": 1532481257, "answer_count": 2, "score": 0, "last_activity_date": 1532422511, "creation_date": 1532421296, "last_edit_date": 1532422511, "question_id": 51494068, "link": "https://stackoverflow.com/questions/51494068/c-add-hex-nul-at-string-end-without-it-disappearing", "closed_reason": "Not suitable for this site", "title": "C add hex NUL at string end without it disappearing", "body": "<p>I am making my own network packet and the protocol states that the payload should start with an space (0x20) and end with a NUL(0x00)</p>\n\n<p>Imaginary payload</p>\n\n<pre><code>char *payload = \" HELLOWORLD\\x00\";\n</code></pre>\n\n<p>However once I put the packet on the wire and inspect it with wireshark the packet does not end with a 00 . I understand my mistake, however I cant find a way to add 00 to a char literal without it disappearing or becoming 3030 (hex to ascii).  </p>\n\n<p>This is what happens to the payload</p>\n\n<pre><code>48 45 4c 4c 4f 57 4f 52 4c 44\n</code></pre>\n\n<p>This is what I want</p>\n\n<pre><code>48 45 4c 4c 4f 57 4f 52 4c 44 00\n</code></pre>\n\n<p>I used to overocome this by then later appending </p>\n\n<pre><code>int a = 0x00;\n</code></pre>\n\n<p>However this makes my code look worse. Any ideas ?</p>\n"}, {"tags": ["c", "windows", "winapi", "uniscribe"], "comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1532422285, "post_id": 51493855, "comment_id": 89957076, "body": "See this answer <a href=\"https://stackoverflow.com/a/38758804/4603670\">stackoverflow.com/a/38758804/4603670</a> for rotating text from <code>TextOut</code>, <code>ScriptTextOut</code> is the same."}, {"owner": {"reputation": 2197, "user_id": 799849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c2a64fda2c076abba0de85a650e7a8e3?s=128&d=identicon&r=PG", "display_name": "eyelash", "link": "https://stackoverflow.com/users/799849/eyelash"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1532423686, "post_id": 51493855, "comment_id": 89957908, "body": "Thanks, that worked. Apparently I was missing the call to <code>SetGraphicsMode</code>"}], "owner": {"reputation": 2197, "user_id": 799849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c2a64fda2c076abba0de85a650e7a8e3?s=128&d=identicon&r=PG", "display_name": "eyelash", "link": "https://stackoverflow.com/users/799849/eyelash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532420563, "creation_date": 1532420563, "question_id": 51493855, "link": "https://stackoverflow.com/questions/51493855/how-to-draw-rotated-text-with-scripttextout", "title": "How to draw rotated text with ScriptTextOut?", "body": "<p>How do I draw rotated text using the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/usp10/nf-usp10-scripttextout\" rel=\"nofollow noreferrer\"><code>ScriptTextOut</code></a> function?<br>\nI tried both <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/Gdiplusgraphics/nf-gdiplusgraphics-graphics-settransform\" rel=\"nofollow noreferrer\"><code>Graphics::SetTransform</code></a> and <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/wingdi/nf-wingdi-setworldtransform\" rel=\"nofollow noreferrer\"><code>SetWorldTransform</code></a> and they didn't seem to do the trick.</p>\n"}, {"tags": ["c", "forward-declaration"], "comments": [{"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 0, "creation_date": 1532420209, "post_id": 51493691, "comment_id": 89955889, "body": "You need to conceptualize the difference between source code compilation and runtime behavior."}, {"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 0, "creation_date": 1532420589, "post_id": 51493691, "comment_id": 89956089, "body": "Taking another approach: Programming is about structures. The linear order of source code fragments is an artefact of &#39;writing down stuff&#39;. So you wouldn&#39;t expect an intrinsic dependency between both (though some &#39;settings&#39; [ie. programming languages] may enforce it). Some introductory text on compilers might interest you."}, {"owner": {"reputation": 573, "user_id": 6551168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc01ebcf4928f369dcc46d52479c49e?s=128&d=identicon&r=PG&f=1", "display_name": "Jounathaen", "link": "https://stackoverflow.com/users/6551168/jounathaen"}, "edited": false, "score": 0, "creation_date": 1532423975, "post_id": 51493691, "comment_id": 89958082, "body": "Your question body is well formulated, but the title suggests a different question. Something like &quot;Is the order of function definitions important in C&quot; would fit better."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10025780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d73da3bf0ce9976424ca20296c84221?s=128&d=identicon&r=PG&f=1", "display_name": "J.Shim", "link": "https://stackoverflow.com/users/10025780/j-shim"}, "edited": false, "score": 3, "creation_date": 1532420487, "post_id": 51493747, "comment_id": 89956045, "body": "Ah I see, so if I put int mult(int x, int y); in the start of the second code (and define exactly what it does later) it&#39;ll be fine in C standard as well, is this correct?"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 17, "user_id": 10025780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d73da3bf0ce9976424ca20296c84221?s=128&d=identicon&r=PG&f=1", "display_name": "J.Shim", "link": "https://stackoverflow.com/users/10025780/j-shim"}, "edited": false, "score": 2, "creation_date": 1532420783, "post_id": 51493747, "comment_id": 89956184, "body": "@J.Shim yes that is called forward deceleration and is legal, and often how it&#39;s done."}, {"owner": {"reputation": 17, "user_id": 10025780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d73da3bf0ce9976424ca20296c84221?s=128&d=identicon&r=PG&f=1", "display_name": "J.Shim", "link": "https://stackoverflow.com/users/10025780/j-shim"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1532421146, "post_id": 51493747, "comment_id": 89956358, "body": "@Fredrik Alright, that still leaves me with a question. When I do the forward declaration, I&#39;d have A(forward declaration) -&gt; B(where I use the function) -&gt; C(where I define what the function from A actually does), so will it look for C when it sees A and then come back for B? And you said this is &quot;often how it&#39;s done&quot;. Why would you do it this way instead of defining the entire function first?"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 17, "user_id": 10025780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d73da3bf0ce9976424ca20296c84221?s=128&d=identicon&r=PG&f=1", "display_name": "J.Shim", "link": "https://stackoverflow.com/users/10025780/j-shim"}, "edited": false, "score": 0, "creation_date": 1532421748, "post_id": 51493747, "comment_id": 89956729, "body": "@J.Shim Exactly how the compiler does it I can&#39;t answer I&#39;m afraid, outside my comfort zone. About the other part though, usually you have forward declarations declared in a .h file and the implementation in a .c file. However if you have local/private functions you have the forward declaration in the same file, imagine if you had 20 local functions, if you didn&#39;t forward declare them you would have to sort them in the order they are used."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 17, "user_id": 10025780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d73da3bf0ce9976424ca20296c84221?s=128&d=identicon&r=PG&f=1", "display_name": "J.Shim", "link": "https://stackoverflow.com/users/10025780/j-shim"}, "edited": false, "score": 0, "creation_date": 1532442491, "post_id": 51493747, "comment_id": 89970608, "body": "@J.Shim The short answer is - compiler needs to know about the function prototype -  the supplied argument type &amp; count and the return type. If it gets to see a prototype, it is OK with going ahead. If it does not know about the prototype (yet) and get to see a function call - it has no idea of the function details - it can still go ahead to the linking stage all right - but without having any idea on the function properties - which may create problems later."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 13, "last_activity_date": 1532443612, "last_edit_date": 1592644375, "creation_date": 1532420206, "answer_id": 51493747, "question_id": 51493691, "link": "https://stackoverflow.com/questions/51493691/how-does-c-exactly-run/51493747#51493747", "title": "How does C exactly run?", "body": "<p>Well, the second code is not valid C, strictly speaking.</p>\n<p>It uses your compiler's flexibility to allow an implicit declaration of a function, which has been disallowed in C standard.</p>\n<p>The <code>C11</code> standatd explicitly mentions the <em>exclusion</em> in the &quot;Foreword&quot;,</p>\n<blockquote>\n<ol start=\"7\">\n<li>Major changes in the second edition included:</li>\n</ol>\n<p>...</p>\n<ul>\n<li>remove implicit function declaration</li>\n</ul>\n</blockquote>\n<p>You have to either</p>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Forward_declaration\" rel=\"nofollow noreferrer\">Forward declare</a> the function.</li>\n<li>Define the function before it's usage (like snippet 1).</li>\n</ul>\n<p>Enable the warning in your compiler and your compiler should produce some warning message to let you know about this <em>problem</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 516, "user_id": 5924181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364470bc9df63d2ce11f86187af94ffc?s=128&d=identicon&r=PG&f=1", "display_name": "GetHacked", "link": "https://stackoverflow.com/users/5924181/gethacked"}, "edited": false, "score": 0, "creation_date": 1532966190, "post_id": 51494826, "comment_id": 90161727, "body": "I&#39;d imagine this has something to do with Python using an <i>interpreter</i> rather than a <i>compiler</i>, no?"}, {"owner": {"reputation": 201, "user_id": 2629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7488a3782b68efd569347d46d6366e3c?s=128&d=identicon&r=PG", "display_name": "rakesh.sahu", "link": "https://stackoverflow.com/users/2629100/rakesh-sahu"}, "reply_to_user": {"reputation": 516, "user_id": 5924181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364470bc9df63d2ce11f86187af94ffc?s=128&d=identicon&r=PG&f=1", "display_name": "GetHacked", "link": "https://stackoverflow.com/users/5924181/gethacked"}, "edited": false, "score": 0, "creation_date": 1533545585, "post_id": 51494826, "comment_id": 90368533, "body": "First python is compiled into byte code and then byte code is interpreted."}], "tags": [], "owner": {"reputation": 201, "user_id": 2629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7488a3782b68efd569347d46d6366e3c?s=128&d=identicon&r=PG", "display_name": "rakesh.sahu", "link": "https://stackoverflow.com/users/2629100/rakesh-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1532423502, "creation_date": 1532423502, "answer_id": 51494826, "question_id": 51493691, "link": "https://stackoverflow.com/questions/51493691/how-does-c-exactly-run/51494826#51494826", "title": "How does C exactly run?", "body": "<p>For second code you should use forward declaration. That means first declare the function so that compiler will know you will be using this function. For now your code is executed as per C compiler flexibility.</p>\n\n<p>Python compiler is not flexible enough so it will fail to compile.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10060812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb233649ebf0c80ba22ce2fc7b01bc7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Raja", "link": "https://stackoverflow.com/users/10060812/rajat-raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1532424308, "creation_date": 1532424308, "answer_id": 51495072, "question_id": 51493691, "link": "https://stackoverflow.com/questions/51493691/how-does-c-exactly-run/51495072#51495072", "title": "How does C exactly run?", "body": "<p>You said both the codes work just fine. Well, it doesn't. The second snippet will show an error in my compiler and if it does compile correctly, it should not be used.</p>\n\n<ul>\n<li>It voids C regulations.</li>\n<li>Declaring functions before is helpful when too many user defined functions are needed.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1532433862, "last_edit_date": 1532433862, "creation_date": 1532433430, "answer_id": 51498000, "question_id": 51493691, "link": "https://stackoverflow.com/questions/51493691/how-does-c-exactly-run/51498000#51498000", "title": "How does C exactly run?", "body": "<p>As others have noted, routines should be <em>declared</em> before they are used, although they do not need to be <em>defined</em> before they are used. Additionally, older versions of C allowed some implicit declaration of routines, and some compilers still do, although this is largely archaic now.</p>\n\n<p>As to how C is able to support the calling of functions before they are defined, C programs are first <em>translated</em> into some executable format, after which a program is <em>executed</em>.</p>\n\n<p>During translation, a C compiler reads, analyzes, and processes the entire program. Any references to functions that have not yet been defined are recorded as things that need to be resolved in the program. In the process of preparing a final executable file, a linker goes through all of the processed data, finds the function definitions, and resolves the references by inserting the addresses (or other information) of the called routines.</p>\n\n<p>Most commonly, a C compiler translates source code into an object module. The object module contains machine-language instructions for the program. It also contains any data for the program that is defined in the source code, and it contains information about unresolved references that the compiler found while analyzing the source code. Multiple source files may be translated separately into multiple object modules. Sometimes these translations are done by different people at different times. A company might produce a software library which is the result of translating their source files into object modules and packaging them into a library file. Then a software developer would compile their own source files and link the resulting object modules with the object modules in the library.</p>\n\n<p>Multiple object modules can be linked together to make an executable file. This is a file that the operating system is able to load into memory and execute.</p>\n"}], "owner": {"reputation": 17, "user_id": 10025780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d73da3bf0ce9976424ca20296c84221?s=128&d=identicon&r=PG&f=1", "display_name": "J.Shim", "link": "https://stackoverflow.com/users/10025780/j-shim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 51493747, "answer_count": 4, "score": -1, "last_activity_date": 1532443612, "creation_date": 1532420020, "last_edit_date": 1532443537, "question_id": 51493691, "link": "https://stackoverflow.com/questions/51493691/how-does-c-exactly-run", "title": "How does C exactly run?", "body": "<p>I just realized when I define a function in C and use it, I can either use it and define the function later or define it and use it later. For example,</p>\n\n<pre><code>int mult (int x, int y)\n{\n  return x * y;\n}\n\nint main()\n{\n  int x;\n  int y;\n  scanf( \"%d\", &amp;x );\n  scanf( \"%d\", &amp;y );\n  printf( \"The product of your two numbers is %d\\n\", mult( x, y ) );\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>int main()\n    {\n      int x;\n      int y;\n      scanf( \"%d\", &amp;x );\n      scanf( \"%d\", &amp;y );\n      printf( \"The product of your two numbers is %d\\n\", mult( x, y ) );\n    }   \n\nint mult (int x, int y)\n    {\n      return x * y;\n    }\n</code></pre>\n\n<p>will both run just fine. However, in Python, the second code will fail since it requires <code>mult(x,y)</code> to be defined before you can use it and Python executes from top to bottom(as far as I know). Obviously, that can't be the case in C since the second one runs just fine. So how does C code actually flow?</p>\n"}, {"tags": ["c", "algorithm", "performance", "avl-tree"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1532419825, "post_id": 51493550, "comment_id": 89955672, "body": "<i>&quot; I wonder if overflow on casting from uint32_t to int&quot;</i> - I&#39;d first be concerned about <i>underflow</i> in your unsigned subtraction where <code>r</code> is greater than <code>l</code>. It will &quot;work&quot; (it isn&#39;t UB) , but it will assuredly <i>not</i> deliver the answer you&#39;re looking for. That alone makes that mechanism a poor candidate."}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1532420377, "post_id": 51493550, "comment_id": 89955995, "body": "@WhozCraig I updated question for your comment, but underflow in subtraction can be solved by casting data to a bigger data type for example like this: <code>(int64_t)*(uint32_t*)l - (int64_t)*(uint32_t*)r</code>. But casting in method result cannot be solved. and I&#39;m open to all highly efficient methods. :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1532421201, "post_id": 51493550, "comment_id": 89956395, "body": "Have you actually measured that the comparison function is a disaster?  Compared to the wrong answer you get from the replacement, correct code outperforms incorrect code.  You&#39;d have to do something dramatic like cast the values to <code>int64_t</code> before subtracting so that you get the signed result you want, and you&#39;d need to convert back to <code>int</code> (from <code>int64_t</code>) carefully to get the correctly signed result.  Are you sure that&#39;s quicker the original code?"}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1532427108, "post_id": 51493550, "comment_id": 89959852, "body": "@JonathanLeffler casting to <code>int64_t</code> have almost no effect, because almost every processor right now is 64-bit. As for speed, I check based on number of jumps in assembly code. even though optimization can create miracles and in my mentioned example clang creates jump free assembly code, but with a little more complex code, you see a lot of jumps."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1532436718, "post_id": 51493550, "comment_id": 89966124, "body": "Note that this problem goes away if you use boolean comparison functions like the STL does"}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1532443227, "post_id": 51493550, "comment_id": 89971127, "body": "@MattTimmermans can you give a small example? just remember that I cannot change the interface of comparison method, because it is defined by library."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1532451979, "post_id": 51493550, "comment_id": 89976907, "body": "Oh, sorry, I thought you were writing the AVL tree"}], "answers": [{"comments": [{"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1532434991, "post_id": 51494639, "comment_id": 89964907, "body": "great results. :) But I wonder if this method is extendable to comparing more values. for example if keys are <code>a</code>, <code>b</code>, <code>c</code> which are passed through an structure to compare function(if <code>a</code> is equal then check <code>b</code> and if <code>b</code> equal then check <code>c</code>), is it still logical to use a method like this instead of <code>if</code> or not."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1532436781, "post_id": 51494639, "comment_id": 89966161, "body": "@Afshin You can eliminate conditionals, e,g. <code>(a ? b : c)</code> should be the same as <code>(b * (a!=0) + c *(a==0))</code>. This will likely compile to jump-free code, and you can use this to build lexicographical struct comparison. But you always need to measure, compare and decide on a case by case basis, because in some cases straight <code>if</code>s might be faster."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1532423388, "last_edit_date": 1532423388, "creation_date": 1532422983, "answer_id": 51494639, "question_id": 51493550, "link": "https://stackoverflow.com/questions/51493550/avl-comparison-method-correct-approach-or-not/51494639#51494639", "title": "AVL comparison method, correct approach or not?", "body": "<p>A simple, UB-free method of comparison is as follows:</p>\n\n<pre><code>int compare (void* a, void* b)\n{\n    unsigned int aa = *(unsigned int*)a;\n    unsigned int bb = *(unsigned int*)b;\n    return (aa &gt; bb) - (aa &lt; bb);\n}\n</code></pre>\n\n<p>On x86, gcc compiles it to this rather efficient code (with -O2):</p>\n\n<pre><code>  mov ecx, DWORD PTR [rdi]\n  mov edx, DWORD PTR [rsi]\n  xor eax, eax\n  cmp ecx, edx\n  seta al\n  sbb eax, 0\n  ret\n</code></pre>\n"}], "owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 51494639, "answer_count": 1, "score": 2, "last_activity_date": 1532423388, "creation_date": 1532419567, "last_edit_date": 1532420521, "question_id": 51493550, "link": "https://stackoverflow.com/questions/51493550/avl-comparison-method-correct-approach-or-not", "title": "AVL comparison method, correct approach or not?", "body": "<p>I'm using a small <code>AVL</code> tree library and as you know, you need to define a comparison method for your <code>AVL</code> tree nodes. Libraries pass <code>AVL</code> keys to this method for sorting elements of tree. Here is the syntax of comparison method:</p>\n\n<pre><code>int compare(const void* l, const void* r)\n{\n}\n</code></pre>\n\n<p>This function should return a positive value when <code>l&gt;r</code>, zero when <code>l==r</code> and negative value when <code>l&lt;r</code> and this method's efficiency has a tremendous effect on <code>AVL</code>'s efficiency. </p>\n\n<p>Now assume that <code>AVL</code> tree keys are <code>uint32_t</code>. A simple method is using following compare function:</p>\n\n<pre><code>int compare(const void* l, const void* r)\n{\n    if (*(uint32_t*)l &gt; *(uint32_t*)r)\n        return 1;\n    if (*(uint32_t*)l &lt; *(uint32_t*)r)\n        return -1;\n    return 0;\n}\n</code></pre>\n\n<p>But this method's amortized running time is a disaster on well balanced data because of <strong>high chance of jump prediction fails on <code>if</code> statements</strong>. I normally write this comparison as following:</p>\n\n<pre><code>int compare(const void* l, const void* r)\n{\n    return *(uint32_t*)l - *(uint32_t*)r;\n    // if you want to overcome underflow in subtraction, you can write it like this:\n    // return (int64_t)*(uint32_t*)l - (int64_t)*(uint32_t*)r;\n    // But this will not solve problem with casting to int for returning result\n}\n</code></pre>\n\n<p>Which is a huge efficiency improvement. But considering return type of <code>int</code>, I wonder if overflow on casting from <code>uint32_t</code> to <code>int</code> or underflow on subtraction (or any other bigger key data size in general case) may cause incorrect tree structure. If your key values take up to 31 bits, every thing works perfectly with this compare method. But if keys take up to 32 bits, things will get tricky. For example see following results:</p>\n\n<pre><code>`l` points to value | `r` points to value | result\n--------------------------------------------------\n2                   |1                    | 1\n2                   |0xFFFFFFFF           | 3\n</code></pre>\n\n<p>This means this compare function searches both value in same side of tree, while in the first case <code>l&gt;r</code> and second one is <code>l&lt;r</code> considering both keys as unsigned values. </p>\n\n<p>I wonder if using this compare method may not result in finding a node in <code>AVL</code> tree when node really exists. what do you think? If this method may fail to find nodes, what highly efficient compare method will be suitable for these situations?</p>\n\n<p>Best Regards</p>\n"}, {"tags": ["c", "time", "avr", "atmega", "hd44780"], "comments": [{"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1532428683, "post_id": 51493265, "comment_id": 89960776, "body": "&quot;I am not sure if the LCD display I am using is or is not the bottleneck&quot; - It is not. The LCD is a really slow device in terms of throughput (how many kB of data can you visualize per second on the display?). Then, communication is synchronous and clocked by the MCU, hence can be done at any timing or jitter the MCU desires. So the bottleneck is definitely in your code somewhere. Busy-waiting for slow devices like an LCD, for example, is never a good idea. Use timers, interrupts, state-machines or whatever else you can to do things while the display is &#39;busy&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7458049, "user_type": "registered", "profile_image": "https://graph.facebook.com/1588840764489336/picture?type=large", "display_name": "0x6261627564", "link": "https://stackoverflow.com/users/7458049/0x6261627564"}, "is_accepted": false, "score": 0, "last_activity_date": 1532424796, "creation_date": 1532424796, "answer_id": 51495228, "question_id": 51493265, "link": "https://stackoverflow.com/questions/51493265/how-long-does-it-take-to-write-a-single-character-to-an-lcd-16x2-display-with-8m/51495228#51495228", "title": "How long does it take to write a single character to an LCD 16x2 display with 8MHz AVR", "body": "<p>If you check the HD44780 datasheet you can find the timing related information in Table 6:\n<a href=\"https://www.sparkfun.com/datasheets/LCD/HD44780.pdf\" rel=\"nofollow noreferrer\">https://www.sparkfun.com/datasheets/LCD/HD44780.pdf</a>\nBased on this table I estimate to set the cursor and write 4 characters should take approx. 300 us.</p>\n"}, {"tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": true, "score": 2, "last_activity_date": 1532425694, "creation_date": 1532425694, "answer_id": 51495516, "question_id": 51493265, "link": "https://stackoverflow.com/questions/51493265/how-long-does-it-take-to-write-a-single-character-to-an-lcd-16x2-display-with-8m/51495516#51495516", "title": "How long does it take to write a single character to an LCD 16x2 display with 8MHz AVR", "body": "<p>On page 52 <a href=\"https://www.sparkfun.com/datasheets/LCD/HD44780.pdf\" rel=\"nofollow noreferrer\">the datasheet</a> states the \"Enable cycle time\" t[cycE] is 500ns min. => At least 500ns are needed to send <em>one</em> word (4 or 8 bits) of data to the display.</p>\n\n<p>Add to that the processing time for each operation (37\u00b5s for most). The return home command however takes 1500\u00b5s and hence dominates the processing time.</p>\n"}], "owner": {"reputation": 69, "user_id": 7321669, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EZt9cVGLryM/AAAAAAAAAAI/AAAAAAAAAJE/Wx4P_MIr7kg/photo.jpg?sz=128", "display_name": "Cuaox", "link": "https://stackoverflow.com/users/7321669/cuaox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 51495516, "answer_count": 2, "score": 0, "last_activity_date": 1532425694, "creation_date": 1532418656, "question_id": 51493265, "link": "https://stackoverflow.com/questions/51493265/how-long-does-it-take-to-write-a-single-character-to-an-lcd-16x2-display-with-8m", "title": "How long does it take to write a single character to an LCD 16x2 display with 8MHz AVR", "body": "<p>I need to create some major improvements in my circut and I am not sure if the LCD display I am using is or is not the bottleneck.<br/>\nAssuming well designed C code, how long would it take to set cursor position to (0,0), write 4 characters (or a single character) and set cursor to next line?<br/>\nDoes checking the busy flag increase/decrease the operation time?\n<br/>\nI know measuring times like those can be problematic but I just need the order of magnitude. (Although if You have some experience with specific times please share your benchmarks).</p>\n"}]