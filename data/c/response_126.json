[{"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "edited": false, "score": 0, "creation_date": 1496879100, "post_id": 44424445, "comment_id": 75847373, "body": "Tagged as C because lambda does not make it related to C++."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1496879102, "post_id": 44424445, "comment_id": 75847374, "body": "WTB some <code>break</code> statements in that <code>switch (uMsg)</code>"}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1496879161, "post_id": 44424445, "comment_id": 75847389, "body": "@WhozCraig there are returns in the end of each case. Does not matter."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1496879349, "post_id": 44424445, "comment_id": 75847424, "body": "@EuriPinhollow There are many people here with the opposite view."}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1496879470, "post_id": 44424445, "comment_id": 75847458, "body": "@immibis this is not production code."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1496879553, "post_id": 44424445, "comment_id": 75847483, "body": "Just for my own sanity, you <i>intended</i> to specify <code>hwnd</code> as the second parameter to <code>GetMessage</code> ? Normally on the application message pump that isn&#39;t done. So.. you <i>wanted</i> that?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1496879617, "post_id": 44424445, "comment_id": 75847500, "body": "@EuriPinhollow I mean that this should be tagged C++ and not C because it is C++ and not C, even though you <i>could</i> rewrite it in C (which you haven&#39;t)."}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1496879965, "post_id": 44424445, "comment_id": 75847579, "body": "@WhozCraig yes, I was going to write a standalone window which won&#39;t interfere with the rest of program."}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1496880526, "post_id": 44424445, "comment_id": 75847720, "body": "@immibis if questions would be tagged with all technologies which are mentioned or used in them it would be total mess and I can find a busload of examples of how tags do not mention whole lot of technologies used or mentioned in question."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 5, "creation_date": 1496880540, "post_id": 44424445, "comment_id": 75847723, "body": "It is very hard to see what the mutex is supposed to accomplish.  All code runs on a single thread and mutex is re-entrant on the thread that owns it.  So sure, nothing useful will happen."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1496888276, "post_id": 44424445, "comment_id": 75849507, "body": "First, as Hans said in the comment, you don&#39;t need a mutex. Your code is single threaded.  You just need a boolean variable to gate whatever code you are trying to prevent from being reentrant."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 2, "creation_date": 1496888296, "post_id": 44424445, "comment_id": 75849509, "body": "The technical reason why your mutex isn&#39;t blocking anything is because you are reacquiring it each time in the same thread.  Each call to WndProc is guaranteed to be on the same thread. So each corresponding call to WaitForSingleObject only increments the ownership count for that mutex."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1496904261, "post_id": 44424445, "comment_id": 75854844, "body": "There is no cout in C. Please don&#39;t tag C++ questions C, especially not when you are obviously using a C++ compiler."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1496904576, "post_id": 44424445, "comment_id": 75855026, "body": "&quot;why aren&#39;t mutexes preventing the multiple threads from executing?&quot; What multiple threads? There are no threads anywhere in the question. None of this makes any sense."}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "edited": false, "score": 0, "creation_date": 1496917544, "post_id": 44424445, "comment_id": 75863525, "body": "Thanks for good points everyone, I tried to address them in question."}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1496917615, "post_id": 44424445, "comment_id": 75863575, "body": "@selbie that totally was my clue until I say multiple windows of print dialog opened while the procedure call which does it is blocking until the dialog is closed. Try running the code above."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1496919354, "post_id": 44424445, "comment_id": 75864696, "body": "No, there isn&#39;t more than one thread involved.  What you&#39;re overlooking is that window procedures are re-entrant: the call to PrintDlgEx is calling your WndProc, which, unfortunately, is calling PrintDlgEx again, and so on."}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1496920179, "post_id": 44424445, "comment_id": 75865219, "body": "@HarryJohnston that kinda explains it for me, thanks for the tip. What should I do with the question? Edit it and answer it?"}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1496950147, "post_id": 44424445, "comment_id": 75885733, "body": "@EuriPinhollow - the print dialog that you think is blocking is actually pumping windows messages.  That why you are getting re-entrant calls on the same thread."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496957732, "post_id": 44424445, "comment_id": 75889508, "body": "regarding: <code>(result=GetMessage(&amp;recent,hwnd,0,0))</code>  an assignment always results in a true condition.  Suggest something similar to: <code>(result=GetMessage(&amp;recent,hwnd,0,0)) != -1</code>"}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1497009532, "post_id": 44424445, "comment_id": 75910640, "body": "@user3629249 assignment does not return true, assignment returns the value of assignment. <code>GetMessage</code> is not inherently <code>true</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1497064316, "post_id": 44424445, "comment_id": 75934578, "body": "@EuriPinhollow, the complier will output a warning if the assignment in the <code>if</code> statement does not have the parens.  And the OP wanted to make the comparison to <code>-1</code>.  I may have misspoken about an assignment always having a condition of <code>true</code>"}, {"owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1497068745, "post_id": 44424445, "comment_id": 75935072, "body": "@user3629249 aaaaaah I see. Check out the comment on that line: <code>BOOL</code> from MS is retarded and probably is just <code>char</code>. No precision/range loss in result of assignment, return type is <code>BOOL</code> too."}], "owner": {"reputation": 322, "user_id": 6049796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84a091eb4e10af942d3de4432607a319?s=128&d=identicon&r=PG&f=1", "display_name": "Euri Pinhollow", "link": "https://stackoverflow.com/users/6049796/euri-pinhollow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1496942510, "answer_count": 0, "score": 0, "last_activity_date": 1496917520, "creation_date": 1496878973, "last_edit_date": 1496917520, "question_id": 44424445, "link": "https://stackoverflow.com/questions/44424445/winapi-mutexes-are-not-mutexing-in-specific-code", "closed_reason": "Duplicate", "title": "WinAPI: mutexes are not mutexing in specific code", "body": "<p>I am totally failing to understand the reason for this. When I compile it and run it, program continually opens printer selection dialogs. I know I can be mistaking something but I though that I can at least prevent this with mutex, why aren't mutexes preventing the multiple threads from executing? PrintDlgEx is a blocking procedure and I confirmed that there are multiple threads (????) running with debugging output. The good code would open print dialog only after previous one was closed.</p>\n\n<p>The typical output of the following code running for 5 or so seconds is:</p>\n\n<pre><code>168\ncalled pdx\ncalled pdx\n168\npdx returned\nHRES 0\npdx returned\nHRES 0\n</code></pre>\n\n<p>What definitely means that there are multiple threads running BUT I did not see those threads in ProcessExplorer. How can one thread run multiple instances of <code>WndProc</code>?</p>\n\n<p>So after it was pointed out that mutexes are thread-owned the real question now probably is why there are multiple instances of <code>WndProc</code> running?</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nHANDLE ghMutex=NULL;\n\nenum hotkey {\n    bESC\n};\n\n\nstatic LRESULT CALLBACK WndProc(\n    HWND hwnd,        // handle to window\n    UINT uMsg,        // message identifier\n    WPARAM wParam,    // first message parameter\n    LPARAM lParam)    // second message parameter\n{\n\n    static enum class mode {init,signal,noise,search} Mode;\n    static HRESULT hResult;\n    static PRINTDLGEX pdx;\n    static LPPRINTPAGERANGE pPageRanges = NULL;\n    static enum class status {printing, stopped} Status;\n    static int jobId;\n    static HANDLE printerHd;\n    JOB_INFO_1A *JobInfo1;\n\n    static bool inited;\n\n    if(ghMutex==NULL){\n        ghMutex = CreateMutex( \n            NULL,              // default security attributes\n            FALSE,             // initially not owned\n            NULL);             // unnamed mutex\n        printf(\"%d\\n\",(int)ghMutex);\n        if(ghMutex==NULL) return 0;\n    }\n\n    if(WaitForSingleObject( \n        ghMutex,\n        INFINITE)!=WAIT_OBJECT_0) return 0;\n\n    switch (uMsg) \n    {\n        case WM_TIMER:\n            {\n                if(!inited) {\n                    pdx = PRINTDLGEX{0};\n                    pPageRanges = NULL;\n\n                    // Allocate an array of PRINTPAGERANGE structures.\n                    pPageRanges = (LPPRINTPAGERANGE) GlobalAlloc(GPTR, 10 * sizeof(PRINTPAGERANGE));\n                    if (!pPageRanges)\n                        break;\n\n                    //  Initialize the PRINTDLGEX structure.\n                    pdx.lStructSize = sizeof(PRINTDLGEX);\n                    pdx.hwndOwner = GetDesktopWindow();\n                    pdx.hDevMode = NULL;\n                    pdx.hDevNames = NULL;\n                    pdx.hDC = NULL;\n                    pdx.Flags = PD_RETURNDC | PD_COLLATE | PD_NOPAGENUMS;\n                    pdx.Flags2 = 0;\n                    pdx.ExclusionFlags = 0;\n                    pdx.nPageRanges = 0;\n                    pdx.nMaxPageRanges = 10;\n                    pdx.lpPageRanges = pPageRanges;\n                    pdx.nMinPage = 1;\n                    pdx.nMaxPage = 1000;\n                    pdx.nCopies = 1;\n                    pdx.hInstance = 0;\n                    pdx.lpPrintTemplateName = NULL;\n                    pdx.lpCallback = NULL;\n                    pdx.nPropertyPages = 0;\n                    pdx.lphPropertyPages = NULL;\n                    pdx.nStartPage = START_PAGE_GENERAL;\n                    pdx.dwResultAction = 0;\n\n                    //  Invoke the Print property sheet.\n\n                    printf(\"called pdx\\n\");\n                    hResult = PrintDlgEx(&amp;pdx);\n                    printf(\"pdx returned\\n\");\n                    inited=1;\n                }\n                printf(\"HRES %d\\n\",(int)hResult);\n                if ((hResult == S_OK) &amp;&amp; pdx.dwResultAction == PD_RESULT_PRINT) \n                {\n                    // User clicked the Print button, so use the DC and other information returned in the \n                    // PRINTDLGEX structure to print the document.\n\n                    int ph=GetDeviceCaps(pdx.hDC,PHYSICALHEIGHT);\n                    int pw=GetDeviceCaps(pdx.hDC,PHYSICALWIDTH);\n                    int offX=GetDeviceCaps(pdx.hDC,PHYSICALOFFSETX);\n                    int offY=GetDeviceCaps(pdx.hDC,PHYSICALOFFSETY);\n\n                    int dimX=pw-2*offX;\n                    int dimY=ph-2*offY;\n\n\n                    DOCINFOA nao{sizeof(DOCINFOA),\"test\",NULL,NULL,0};\n\n                    jobId=StartDoc(pdx.hDC,&amp;nao);\n                    StartPage(pdx.hDC);\n        ////////////nothing\n                    EndPage(pdx.hDC);\n                    EndDoc(pdx.hDC);\n                }\n\n            } break;\n        case WM_CREATE: \n            // Initialize the window. \n            {\n                inited=false;\n                SetTimer(hwnd,1,2500,NULL);\n            }\n            break;\n\n        case WM_DESTROY: \n            // Clean up window-specific data objects.\n            {\n                CloseHandle(ghMutex);\n                ghMutex=NULL;\n            }\n            SendMessage(hwnd,WM_USER+1,0,0);\n            break;\n\n        case WM_HOTKEY:\n            {\n                DestroyWindow(hwnd);\n            }\n            break;\n        // \n        // Process other messages. \n        // \n        default: \n            ReleaseMutex(ghMutex); return DefWindowProc(hwnd, uMsg, wParam, lParam); \n    } \n    ReleaseMutex(ghMutex);return 0; \n}\n\n\nvoid testPrinter()\n{\n\n    HWND hwnd;\n    {\n        WNDCLASSA wc;\n        wc.style = CS_HREDRAW | CS_VREDRAW; \n        wc.lpfnWndProc = (WNDPROC) WndProc; \n        wc.cbClsExtra = 0; \n        wc.cbWndExtra = 0; \n        wc.hInstance = GetModuleHandle(NULL); \n        wc.hIcon = LoadIcon(NULL, IDI_APPLICATION); \n        wc.hCursor = LoadCursor(NULL, IDC_ARROW); \n        wc.hbrBackground = (HBRUSH) GetStockObject(WHITE_BRUSH); \n        wc.lpszMenuName =  \"\"; \n        wc.lpszClassName = \"PinTest\"; \n\n        if (!RegisterClass(&amp;wc)) \n           return; //cannot register window class\n\n        hwnd=CreateWindowEx(0,\"PinTest\",\"topmost print testing window without borders and title bar\",WS_VISIBLE|WS_BORDER,0,0,300,300,0,0,0,0);\n\n        RegisterHotKey(hwnd,bESC,0,VK_ESCAPE);\n    }\n\n\n    MSG recent;\n    BOOL result;\n    while((result=GetMessage(&amp;recent,hwnd,0,0))&amp;&amp;result!=-1) { //bool can be -1 in MS world\n        if(recent.message==WM_USER+1) break;\n        TranslateMessage(&amp;recent);\n        DispatchMessage(&amp;recent);\n    }\n\n\n    return;\n}\n\n\n\nint main(){\n    testPrinter();\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "ffmpeg"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1496900816, "post_id": 44424410, "comment_id": 75852973, "body": "If <code>cos</code> is missing, do you include <code>math</code> library for linking?"}, {"owner": {"reputation": 181, "user_id": 1810130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4bac9f277c2936afc89391f5108d7a?s=128&d=identicon&r=PG", "display_name": "Tony K", "link": "https://stackoverflow.com/users/1810130/tony-k"}, "edited": false, "score": 0, "creation_date": 1496903917, "post_id": 44424410, "comment_id": 75854625, "body": "What compiler flags are you using to compile the library? Be sure to enable floating point support."}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1496906366, "post_id": 44424410, "comment_id": 75856068, "body": "Your missing the header files, just look for that in internet and include that in the corresponding C source."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1496917844, "post_id": 44424410, "comment_id": 75863728, "body": "@LethalProgrammer if compiling works but the linker complains, then the headers are obviously not missing. Instead the library is not included during linking."}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 7521387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89578f94c34df8445757554da1a603ee?s=128&d=identicon&r=PG&f=1", "display_name": "Student414", "link": "https://stackoverflow.com/users/7521387/student414"}, "is_accepted": false, "score": 0, "last_activity_date": 1530089503, "creation_date": 1530089503, "answer_id": 51058451, "question_id": 44424410, "link": "https://stackoverflow.com/questions/44424410/raspberry-crosscompilation-in-eclipse/51058451#51058451", "title": "Raspberry crosscompilation in Eclipse", "body": "<p>do not need compile FFMPEG source for Raspberry PI.<br>\nyou can install it using apt-get or other package manager, and then you can using 'avcodec.h' to design your app, build by GCC in Raspberry host.  </p>\n"}], "owner": {"reputation": 49, "user_id": 6506568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea23a1177afa6555186f720d2b304afc?s=128&d=identicon&r=PG&f=1", "display_name": "gogoer", "link": "https://stackoverflow.com/users/6506568/gogoer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530089503, "creation_date": 1496878692, "last_edit_date": 1496949265, "question_id": 44424410, "link": "https://stackoverflow.com/questions/44424410/raspberry-crosscompilation-in-eclipse", "title": "Raspberry crosscompilation in Eclipse", "body": "<p>I want to compile an application for Raspberry in Eclipse (in windows). I installed SysGCC, configured Eclipse for crosscompiling. And if I create something like \"Hello world\" - everything is ok. Eclipse creates binaries which wonderfully works on Raspberry.\nBut i need use FFMPEG libraries in my application . Here the minimal code of application:</p>\n\n<pre><code>#include &lt;libavcodec/avcodec.h&gt;\n#include &lt;libavformat/avformat.h&gt;\n#include &lt;libswscale/swscale.h&gt;\n\nint main(void) {\n    av_register_all();\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I added libraries in project config. Project compiles good, but linker gives a lot of errors:</p>\n\n<pre><code>C:\\SysGCC\\Raspberry\\arm-linux-gnueabihf\\sysroot\\usr\\local\\lib\\libavcodec.a(aaccoder.o): In function `quantize_and_encode_band_cost_template':\n/usr/src/ffmpeg/libavcodec/aacenc_quantization.h:108: undefined reference to `cbrtf'\n/usr/src/ffmpeg/libavcodec/aacenc_quantization.h:108: undefined reference to `cbrtf'\n/usr/src/ffmpeg/libavcodec/aacenc_quantization.h:108: undefined reference to `cbrtf'\n/usr/src/ffmpeg/libavcodec/aacenc_quantization.h:108: undefined reference to `cbrtf'\nC:\\SysGCC\\Raspberry\\arm-linux-gnueabihf\\sysroot\\usr\\local\\lib\\libavcodec.a(aacenc_is.o): In function `quantize_and_encode_band_cost_template':\n/usr/src/ffmpeg/libavcodec/aacenc_quantization.h:108: undefined reference to `cbrtf'\nC:\\SysGCC\\Raspberry\\arm-linux-gnueabihf\\sysroot\\usr\\local\\lib\\libavcodec.a(aacenc_is.o):/usr/src/ffmpeg/libavcodec/aacenc_quantization.h:108: more undefined references to `cbrtf' follow\nC:\\SysGCC\\Raspberry\\arm-linux-gnueabihf\\sysroot\\usr\\local\\lib\\libavcodec.a(adx.o): In function `ff_adx_calculate_coeffs':\n/usr/src/ffmpeg/libavcodec/adx.c:30: undefined reference to `cos'\n/usr/src/ffmpeg/libavcodec/adx.c:34: undefined reference to `lrintf'\n/usr/src/ffmpeg/libavcodec/adx.c:35: undefined reference to `lrintf'\n/usr/src/ffmpeg/libavcodec/adx.c:30: undefined reference to `cos'\n/usr/src/ffmpeg/libavcodec/adx.c:34: undefined reference to `lrintf'\n/usr/src/ffmpeg/libavcodec/adx.c:35: undefined reference to `lrintf'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [ffmpeg] Error 1\n\n02:21:24 Build Finished (took 8s.394ms)\n</code></pre>\n\n<p>SOLVED:</p>\n\n<p>i used next command:</p>\n\n<pre><code>arm-linux-gnueabihf-gcc -L\"C:\\SysGCC\\Raspberry\\arm-linux-gnueabihf\\sysroot\\usr\\local\\lib\" -L\"C:\\SysGCC\\Raspberry\\arm-linux-gnueabihf\\lib\" -o \"ffmpeg\"  ./src/ffmpeg.o   -lc -lm -lpthread -lavformat -lavcodec -lswscale -lavutil -lavfilter -lavdevice -lswresample -lpostproc -ldl -lx264 -lgcc -lz\n</code></pre>\n\n<p>where <strong>-lc -lm -lpthread -lavformat -lavcodec -lswscale -lavutil -lavfilter -lavdevice -lswresample -lpostproc -ldl -lx264 -lgcc -lz</strong> are libraries linker needs (maybe not all of them).\nplease note that order is important.</p>\n"}, {"tags": ["c", "file", "validation", "linked-list"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1496877919, "post_id": 44424183, "comment_id": 75847042, "body": "&quot;I&#39;m currently working on a program that&#39;s supposed to read data from a text file&quot; --&gt; post what you have done so far to add clarity to  the issues to this otherwise broad question."}], "answers": [{"comments": [{"owner": {"reputation": 1530, "user_id": 2727710, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000318383381/picture?type=large", "display_name": "kamoroso94", "link": "https://stackoverflow.com/users/2727710/kamoroso94"}, "edited": false, "score": 1, "creation_date": 1496885676, "post_id": 44424357, "comment_id": 75848895, "body": "You&#39;re using C++ but the answer is tagged as C."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1496878335, "creation_date": 1496878335, "answer_id": 44424357, "question_id": 44424183, "link": "https://stackoverflow.com/questions/44424183/reading-data-from-text-file-to-linked-list-error-handling/44424357#44424357", "title": "Reading data from text file to linked list, error handling", "body": "<p>You could read try to read every part of the line as a string (because if serial number was an <code>int</code> for example, 1h6 would be truncated, and you would fail to check if it's valid). For the serial number string, you should check if it's really an integer, and if so convert to a number with <a href=\"http://www.cplusplus.com/reference/string/stoi/\" rel=\"nofollow noreferrer\"><code>std::stoi</code></a>.</p>\n\n<p>From my <a href=\"https://stackoverflow.com/a/44044016/2411320\">answer</a> and <a href=\"https://stackoverflow.com/questions/2844817/how-do-i-check-if-a-c-string-is-an-int\">How do I check if a C++ string is an int?</a>, I got this:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\ninline bool isInteger(const std::string &amp; s)\n{\n   if(s.empty() || ((!isdigit(s[0])) &amp;&amp; (s[0] != '-') &amp;&amp; (s[0] != '+'))) return false ;\n\n   char * p ;\n   strtol(s.c_str(), &amp;p, 10) ;\n\n   return (*p == 0) ;\n}\n\nint main(void)\n{\n\n    std::ifstream infile(\"thefile.txt\");\n    if (infile.is_open()) {\n        int serial_number;\n        std::string model, terminator, serial_number_str;\n        while (infile &gt;&gt; terminator &gt;&gt; model &gt;&gt; serial_number_str)\n        {\n            if(terminator == \"TERMINATOR\" &amp;&amp; isInteger(serial_number_str))\n            {\n                serial_number = std::stoi(serial_number_str);\n                std::cout &lt;&lt; terminator &lt;&lt; \" \" &lt;&lt; model &lt;&lt; \" \" &lt;&lt; serial_number &lt;&lt; \"\\n\";\n            }\n        }\n    }\n    infile.close();\n    return 0;\n}\n</code></pre>\n\n<p>which for a file of:</p>\n\n<p>Georgioss-MacBook-Pro:~ gsamaras$ cat thefile.txt </p>\n\n<pre><code>TERMINATOR T-800 1\n\nTERMINATOR T-1000 2\n\nTERMINATOR T-800 3\n\nTERMINATOR T-800 4\n\nTORMONUTTUR T-800 1h6\n\nabc 2\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ g++ main.cpp \nGeorgioss-MacBook-Pro:~ gsamaras$ ./a.out \nTERMINATOR T-800 1\nTERMINATOR T-1000 2\nTERMINATOR T-800 3\nTERMINATOR T-800 4\n</code></pre>\n\n<p>You can improve it further by using <a href=\"http://www.cplusplus.com/reference/regex/\" rel=\"nofollow noreferrer\"><code>std::regex</code></a> to check the format of <code>model</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1530, "user_id": 2727710, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000318383381/picture?type=large", "display_name": "kamoroso94", "link": "https://stackoverflow.com/users/2727710/kamoroso94"}, "is_accepted": false, "score": 1, "last_activity_date": 1496878373, "creation_date": 1496878373, "answer_id": 44424361, "question_id": 44424183, "link": "https://stackoverflow.com/questions/44424183/reading-data-from-text-file-to-linked-list-error-handling/44424361#44424361", "title": "Reading data from text file to linked list, error handling", "body": "<p>One way to not overwhelm yourself is to delegate different actions to different functions so you don't have to worry about everything at once.  I would recommend opening the file and reading one line at a time.  For each line, you can validate the format, then append the data to your linked list, otherwise do nothing and continue to the next line.  That might look something like this.</p>\n\n<pre><code>char line[128];\nwhile(fgets(line, 128, (FILE*)fh) != NULL) {\n    if(isValidLine(line)) {\n        // add data to linked list\n    }\n}\n</code></pre>\n\n<p>The logic is easy to understand there.  You just have to define your function <code>isValidLine</code> to read the line to make sure it has valid data in it, and return the corresponding boolean value.  To validate this, you might use <code>sscanf</code> or some other string tokenizer to parse the line, or do it yourself manually.  For instance, check that it starts with the string <code>\"TERMINATOR \"</code> and proceed from there.  One everything checks out, return true, but at any time the string fails your format requirements, return false right away.</p>\n"}], "owner": {"reputation": 43, "user_id": 7669230, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1807797602579227/picture?type=large", "display_name": "Jakob Eklund", "link": "https://stackoverflow.com/users/7669230/jakob-eklund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1496918369, "answer_count": 2, "score": 0, "last_activity_date": 1496878380, "creation_date": 1496877149, "last_edit_date": 1496878380, "question_id": 44424183, "link": "https://stackoverflow.com/questions/44424183/reading-data-from-text-file-to-linked-list-error-handling", "closed_reason": "Not suitable for this site", "title": "Reading data from text file to linked list, error handling", "body": "<p>I'm currently working on a program that's supposed to read data from a text file, and place said data in a linked list. I've got a pretty good idea of what I'm doing, but the thing is I'm supposed to include error handling that jumps to the next line if there is any errors in the data format in the file.</p>\n\n<p>The file contains information about a number of terminators in the form of their model and their serial number.</p>\n\n<p>An example of the data that can be read is:</p>\n\n<pre><code>TERMINATOR T-800 1\n\nTERMINATOR T-1000 2\n\nTERMINATOR T-800 3\n\nTERMINATOR T-800 4\n</code></pre>\n\n<p>In the first row above, T-800 is the model, and 1 is the serial number. The four rows above are all valid, but if the fifth row would look something like this:</p>\n\n<pre><code>TORMONUTTUR T-800 1h6\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>abc 2\n</code></pre>\n\n<p>, the data should be discarded and the program should continue reading the next row.</p>\n\n<p>I'm currently lost on this, and would appreciate just a nod in the right direction, since I'm not sure how I should even begin with this problem.</p>\n"}, {"tags": ["c++", "c", "gcc5"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1496877404, "post_id": 44424165, "comment_id": 75846888, "body": "Did you run <code>ranlib</code>?"}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1496880129, "post_id": 44424165, "comment_id": 75847625, "body": "@BoundaryImposition Is probably right, and the error message &quot;Archive has no index; run ranlib to add one&quot; gives it away. You need to run ranlib"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1496884587, "post_id": 44424165, "comment_id": 75848652, "body": "It means the archive has no index; you can run ranlib to add one."}, {"owner": {"reputation": 1985, "user_id": 4612476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719f14270bfe54a8a9cf6e831fde6aa2?s=128&d=identicon&r=PG", "display_name": "Cameron Tacklind", "link": "https://stackoverflow.com/users/4612476/cameron-tacklind"}, "edited": false, "score": 0, "creation_date": 1496957107, "post_id": 44424165, "comment_id": 75889220, "body": "Why would I need to run <code>ranlib</code> on this archive and not any others?"}], "answers": [{"tags": [], "owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "is_accepted": false, "score": 0, "last_activity_date": 1496914585, "creation_date": 1496914585, "answer_id": 44432000, "question_id": 44424165, "link": "https://stackoverflow.com/questions/44424165/using-archive-file-for-compiled-object-seems-to-break-compilation/44432000#44432000", "title": "Using archive file for compiled object seems to break compilation", "body": "<p>Hope this hint can help you: <a href=\"https://github.com/ap4y/modbus.js/issues/1\" rel=\"nofollow noreferrer\">https://github.com/ap4y/modbus.js/issues/1</a></p>\n\n<blockquote>\n  <p>Hi, you have this error because static library (libmodbus.a) have been\n  precompiled for other platform. Actually, it my mistake to leave it in\n  repository. In order to resolve this error you should compile library\n  for your platform and replace it in lib directory.</p>\n</blockquote>\n"}], "owner": {"reputation": 1985, "user_id": 4612476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719f14270bfe54a8a9cf6e831fde6aa2?s=128&d=identicon&r=PG", "display_name": "Cameron Tacklind", "link": "https://stackoverflow.com/users/4612476/cameron-tacklind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497405560, "creation_date": 1496877017, "last_edit_date": 1497405560, "question_id": 44424165, "link": "https://stackoverflow.com/questions/44424165/using-archive-file-for-compiled-object-seems-to-break-compilation", "title": "Using archive file for compiled object seems to break compilation", "body": "<p>I have a large project with a custom Makefile building everything. This is for an ARM Cortex-M0.</p>\n\n<p>One of the steps is to compile a Newlib <code>syscalls.c</code> into <code>syscalls.c.o</code>. That gets dumped into an archive file <code>newlib.a</code> which in turn is linked to the final <code>output.elf</code> for loading onto my device's flash.</p>\n\n<pre><code>$ arm-none-eabi-gcc -o output.elf .bld/*.c.o .bld/*.cpp.o .bld/libs/*.a -nostartfiles -mcpu=cortex-m0 -mthumb -Tlinker.ld -Wl,-Map=output.map --specs=nano.specs\n</code></pre>\n\n<p>If I follow the above procedure, sometimes the \"Archive has no index\":</p>\n\n<pre><code>.bld/libs/newlib.a: error adding symbols: Archive has no index; run ranlib to add one\n</code></pre>\n\n<p>And sometimes (I have not figured out how to deterministically make one or the other happen) I get an undefined reference even though <code>_init()</code> is defined, as an empty function, in <code>syscalls.c</code>.</p>\n\n<pre><code>c:/progra~2/gnutoo~1/50a5a~1.420/bin/../lib/gcc/arm-none-eabi/5.4.1/../../../../arm-none-eabi/lib/armv6-m\\libc_nano.a(lib_a-init.o): In function `__libc_init_array':\ninit.c:(.text.__libc_init_array+0x1c): undefined reference to `_init'\n</code></pre>\n\n<p>However, if I skip the <code>newlib.a</code> file and just directly link <code>syscalls.c.o</code> into the final <code>.elf</code>, it works as expected.</p>\n\n<p>What about using an archive could be causing this issue? I've also tried reordering the arguments to the linker to no avail.</p>\n\n<h3>Note (edit)</h3>\n\n<p>I did notice the <code>run ranlib to add one</code> instruction. However, this does not apply because:</p>\n\n<ol>\n<li>This is not necessary on other archives that I'm building, why is it needed here?</li>\n<li>That error doesn't happen anymore (after some fiddling. not sure what changed). The main issue is that <code>_init</code> is undefined.</li>\n</ol>\n\n<hr>\n\n<h3>Reference</h3>\n\n<ol>\n<li><p>I'm compiling other archive files in this build with no issues. The unique things here are that this archive only has one file in it and it's the only C-only archive. However, I don't see how this could affect things.</p></li>\n<li><p>This is basically how I'm compiling <code>syscalls.c</code> and archiving the <code>.o</code> file:</p>\n\n<pre><code>$ arm-none-eabi-gcc newlib/syscalls.c -o .bld/newlib/syscalls.c.o -c -std=gnu11 -Wstrict-prototypes -nostartfiles -mcpu=cortex-m0 -mthumb -O2 -pipe -ffreestanding -funsigned-bitfields -Wall -Wfatal-errors -ffunction-sections -fdata-sections -MMD -MP -MF .bld/.dep/newlib/syscalls.c.o.d\n$ arm-none-eabi-ar rcs .bld/libs/newlib.a .bld/newlib/syscalls.c.o\n</code></pre></li>\n<li><p><code>gcc</code> version</p>\n\n<pre><code>arm-none-eabi-g++ (GNU Tools for ARM Embedded Processors) 5.4.1 20160919 (release) [ARM/embedded-5-branch revision 240496]\n</code></pre></li>\n<li><p>Simplified <code>syscalls.c</code></p>\n\n<pre><code>caddr_t _sbrk(int nbytes) __attribute__((externally_visible));\nvoid _init(void) __attribute__((externally_visible));\n\n/* c++ destructor dynamic shared object needed if -fuse-cxa-atexit is used*/\nvoid *__dso_handle __attribute__ ((weak));\n\n// defined in linker script\nextern caddr_t Heap_Bank1_Start;\nextern caddr_t Heap_Bank1_End;\n\ncaddr_t _sbrk(int nbytes) { /* ... */ }\nvoid _init(void) {}\n</code></pre></li>\n</ol>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1496876173, "post_id": 44424013, "comment_id": 75846466, "body": "Please do a search. This is answered many many times on Stackoverflow and else where."}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1496876256, "post_id": 44424013, "comment_id": 75846504, "body": "There&#39;s two typical solutions. The first is to allocate a single contiguous chunk of memory that can then be accessed as if it is a 2D matrix with careful indexing. The second is to allocate an pointer to <code>double *</code> (aka <code>double **</code>), and then allocate each of those rows one by one. Search this site for a few seconds, and I&#39;m sure you&#39;ll find lots of examples of each."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496876306, "post_id": 44424013, "comment_id": 75846528, "body": "<code>int (*m)[cols] = malloc( sizeof(int[rows][cols]) );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8120038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5f0ecee936a673fb2235beab0afaf3?s=128&d=identicon&r=PG&f=1", "display_name": "MrCGenius", "link": "https://stackoverflow.com/users/8120038/mrcgenius"}, "edited": false, "score": 0, "creation_date": 1496907692, "post_id": 44424483, "comment_id": 75856989, "body": "Thanks. Now I think I have a different problem: In my for-loop that basically copies a matrix to the new allocated memory, I get the error that my counter variable j has to have the type &quot;pointer-to-object&quot;. I&#39;ve searched the web but couldn&#39;t really find a helpful answer.  <i>for (i = 0; i &lt; size; i++) {</i> \t<i>for (j = 0; j &lt; size; j++) {</i> \t\t<i>*newgen[i][j] = oldgen[i][j];</i> \t<i>}</i> <i>}</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 21, "user_id": 8120038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5f0ecee936a673fb2235beab0afaf3?s=128&d=identicon&r=PG&f=1", "display_name": "MrCGenius", "link": "https://stackoverflow.com/users/8120038/mrcgenius"}, "edited": false, "score": 0, "creation_date": 1496927441, "post_id": 44424483, "comment_id": 75870644, "body": "@MrCGenius What difference do you see between this answer&#39;s sample code <code>(*a)[0][0]</code> and your code <code>*newgen[i][j]</code>?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1496895853, "last_edit_date": 1496895853, "creation_date": 1496879308, "answer_id": 44424483, "question_id": 44424013, "link": "https://stackoverflow.com/questions/44424013/how-to-create-a-multidimensional-array-with-variable-length/44424483#44424483", "title": "How to create a multidimensional array with variable length", "body": "<blockquote>\n  <p>I can't figure out how to use malloc to create a two-dimensional array. </p>\n</blockquote>\n\n<pre><code>// Example of a 2D array.  malloc() cannot create this.\nint TwoD[height][width];\n</code></pre>\n\n<p><code>malloc()</code> can allocate memory <em>for</em> an <code>int</code>, an array, etc.  It can not create an array.  The result of <code>malloc()</code> is a pointer.  So start with a <em>pointer</em> to a 2D array.</p>\n\n<pre><code>// C99, C11\nint (*a)[height][width];\n</code></pre>\n\n<p>Allocate memory for <code>a</code></p>\n\n<pre><code>a = malloc(sizeof *a); \nassert(a); // Insure NULL was not retuned.\n</code></pre>\n\n<p>Use the memory</p>\n\n<pre><code>(*a)[0][0] = 1;\n(*a)[0][1] = 2;\n// ... \n(*a)[height-1][width-1] = height*width;\n</code></pre>\n\n<p>Free when done</p>\n\n<pre><code>free(a);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8120038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5f0ecee936a673fb2235beab0afaf3?s=128&d=identicon&r=PG&f=1", "display_name": "MrCGenius", "link": "https://stackoverflow.com/users/8120038/mrcgenius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496895853, "creation_date": 1496876054, "question_id": 44424013, "link": "https://stackoverflow.com/questions/44424013/how-to-create-a-multidimensional-array-with-variable-length", "title": "How to create a multidimensional array with variable length", "body": "<p>I'd like to create a matrix (same height and width) with a variable size, meaning that height and width depend on a variable. Now I know how to reserve store with malloc/calloc, but I can't figure out how to use malloc to create a two-dimensional array.\nOr is there a different way to solve my problem?\nThanks in advance!</p>\n"}, {"tags": ["c", "arrays", "file", "loops", "struct"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496875770, "post_id": 44423939, "comment_id": 75846350, "body": "<code>while (...) ; { ... }</code> --&gt; <code>while (...) { ... }</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1496875776, "post_id": 44423939, "comment_id": 75846351, "body": "Remove the <code>;</code> from the end of the <code>while</code> statement. It gives it an empty code block and then the intended code is run once, after the while loop ends."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8128268, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08CPpo7ckRw/AAAAAAAAAAI/AAAAAAAAGgQ/O2xIxLJ4Rt8/photo.jpg?sz=128", "display_name": "Jeff Johnson", "link": "https://stackoverflow.com/users/8128268/jeff-johnson"}, "edited": false, "score": 1, "creation_date": 1496876028, "post_id": 44423980, "comment_id": 75846412, "body": "Thank you! That totally escaped my eye."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 11, "user_id": 8128268, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08CPpo7ckRw/AAAAAAAAAAI/AAAAAAAAGgQ/O2xIxLJ4Rt8/photo.jpg?sz=128", "display_name": "Jeff Johnson", "link": "https://stackoverflow.com/users/8128268/jeff-johnson"}, "edited": false, "score": 0, "creation_date": 1496876069, "post_id": 44423980, "comment_id": 75846429, "body": "You are welcome @JeffJohnson, do not forget to <i>accept</i> the answer, since you liked it! ;)"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1496875824, "creation_date": 1496875824, "answer_id": 44423980, "question_id": 44423939, "link": "https://stackoverflow.com/questions/44423939/only-printing-last-line-of-txt-file-when-reading-into-struct-array-in-c/44423980#44423980", "title": "Only printing last line of txt file when reading into struct array in C", "body": "<p>You are using an extra semicolon which makes all the trouble, here:</p>\n\n<pre><code>while (fscanf(...) != EOF);\n{\n   ...\n</code></pre>\n\n<p>Remove it and you should be fine.</p>\n\n<p>What happens with your code is that <code>while(..);</code> is equivalent to this:</p>\n\n<pre><code>while(...)\n{\n    ; // do nothing\n}\n</code></pre>\n\n<p>thus does not enter the body (the one you think is the body) of your loop (since the actual body does nothing). However <code>scanf()</code> continues to parse the file, and then this section of your code executes:</p>\n\n<pre><code>{\n    printf(\"%f %f %f %f\\n\", p[k].Q, p[k].x, p[k].y, p[k].z);\n    k++;\n}\n</code></pre>\n\n<p>independently, where the curly braces are treated like they wanted to state scope.</p>\n"}, {"tags": [], "owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "is_accepted": false, "score": 0, "last_activity_date": 1496888135, "creation_date": 1496888135, "answer_id": 44425581, "question_id": 44423939, "link": "https://stackoverflow.com/questions/44423939/only-printing-last-line-of-txt-file-when-reading-into-struct-array-in-c/44425581#44425581", "title": "Only printing last line of txt file when reading into struct array in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define LINE_BUFFER_LEN   (512)\n#define RESERVE_NEWLINDE          0\n#define AUTO_FILTER_NEWLINDE      1\n\ntypedef int (* LINE_READER)(char * pstrLine, int uiBufferLen, void * pvData);\n\ntypedef struct st_HW_SSP_CONFIG\n{\n    const char * pstrConfigPath;\n    LINE_READER pfLineReader;\n    FILE * pstFile;\n    void * pvData;\n    int CurrentLine;\n    int Flag;\n} CONFIG_ST;\n\nint CloseConfig(CONFIG_ST * pstConfig)\n{\n    if (!pstConfig)\n    {\n        // record error\n        return -1;\n    }\n    if (fclose(pstConfig-&gt;pstFile))\n    {\n        // record error\n    }\n    return 0;\n}\n\nint OpenConfigFile(const char * pstrFilePath, CONFIG_ST * pstConfig)\n{\n    FILE * pstFile = NULL;\n    if ((!pstrFilePath) || (!pstConfig))\n    {\n        return -1;\n    }\n    pstFile = fopen(pstrFilePath, \"r\");\n    if (!pstFile)\n    {\n        return -1;\n    }\n    pstConfig-&gt;pstFile = pstFile;\n    pstConfig-&gt;pstrConfigPath = pstrFilePath;\n    pstConfig-&gt;Flag = RESERVE_NEWLINDE;\n    return 0;\n}\n\nint IsNullStr(const char *pcStr)\n{\n    const char *pcTmp = pcStr;\n    while ('\\0' != *pcTmp)\n    {\n        if (!isspace(*pcTmp))\n        {\n            return 0;\n        }\n\n        pcTmp++;\n    }\n    return 1;\n}\n\nint IsEffectiveLine(char acFileLineBuffer[LINE_BUFFER_LEN])\n{\n    if (0 == strlen(&amp;acFileLineBuffer[0]))\n    {\n        return 0;\n    }\n    if ('#' == acFileLineBuffer[0]) // strip as a comment line\n    {\n        return 0;\n    }\n    if (IsNullStr(&amp;acFileLineBuffer[0]))\n    {\n        return 0;\n    }\n    return 1;\n}\n\nvoid FilterNewLine(char* pcLine,  int MaxNumLen)\n{\n    int uiLen = strlen(pcLine);\n    if (uiLen &gt; 1)\n    {\n        if ('\\n' == pcLine[uiLen - 1])\n        {\n            pcLine[uiLen - 1] = '\\0';\n\n            if (uiLen &gt; 2)\n            {\n                if ('\\r' == pcLine[uiLen - 2])\n                {\n                    pcLine[uiLen - 2] = '\\0';\n                }\n            }\n        }\n    }\n    return;\n}\n\nint ReadConfigFile(CONFIG_ST * pstConfig)\n{\n    char acFileLineBuffer[LINE_BUFFER_LEN] = {0};\n    char * pstrRead = NULL;\n    int Ret = 0;\n\n    if (!pstConfig)\n    {\n        return -1;\n    }\n    if ((!pstConfig-&gt;pstFile) || (!pstConfig-&gt;pfLineReader))\n    {\n        return -1;\n    }\n\n    rewind(pstConfig-&gt;pstFile);\n    pstConfig-&gt;CurrentLine = 0;\n\n    do\n    {\n        memset((void *)&amp;acFileLineBuffer[0], 0, LINE_BUFFER_LEN);\n        pstrRead = fgets(&amp;acFileLineBuffer[0], LINE_BUFFER_LEN - 1, pstConfig-&gt;pstFile);\n        if (pstrRead)\n        {\n            pstConfig-&gt;CurrentLine ++;\n\n            if (0 == IsEffectiveLine(acFileLineBuffer))\n            {\n                continue;\n            }\n\n            if (AUTO_FILTER_NEWLINDE == pstConfig-&gt;Flag)\n            {\n                FilterNewLine(acFileLineBuffer, LINE_BUFFER_LEN - 1);\n            }\n\n            if (pstConfig-&gt;pfLineReader)\n            {\n                Ret = pstConfig-&gt;pfLineReader(&amp;acFileLineBuffer[0],\n                                              LINE_BUFFER_LEN,\n                                              pstConfig-&gt;pvData);\n\n                if (Ret)\n                {\n                    break;\n                }\n            }\n        }\n    }\n    while (pstrRead);\n    return Ret;\n}\n\nint ReadConfigFileEx(const char * pFilePath,\n                     LINE_READER pfReader,\n                     void * pData, int Flag)\n{\n    int Ret = 0;\n    CONFIG_ST stConfig = {0};\n\n    Ret = OpenConfigFile(pFilePath, &amp;stConfig);\n    if (Ret)\n    {\n        return Ret;\n    }\n\n    stConfig.pfLineReader = pfReader;\n    stConfig.pvData = pData;\n    stConfig.Flag = Flag;\n    Ret = ReadConfigFile(&amp;stConfig);\n    CloseConfig(&amp;stConfig);\n    return Ret;\n}\n\n\nint StringSplit(char *pcStr, char cFlag,\n                char * pstArray[], int MaxNum,\n                int *pNum)\n{\n    char * pcStrTemp = 0;\n    unsigned int uiIndex = 0;\n\n    pcStrTemp = pcStr;\n\n    while (pcStrTemp)\n    {\n        pstArray[uiIndex] = pcStrTemp;\n        pcStrTemp = strchr(pcStrTemp, cFlag);\n        if (pcStrTemp)\n        {\n            *pcStrTemp = '\\0';\n            pcStrTemp ++;\n            uiIndex ++;\n        }\n        if (uiIndex &gt;= MaxNum)\n        {\n            break;\n        }\n    }\n\n    if (0 != MaxNum)\n    {\n        *pNum = uiIndex &gt;= MaxNum ? (MaxNum - 1) : uiIndex;\n    }\n    else\n    {\n        *pNum = 0;\n    }\n\n    return 0;\n}\n\nint MyLineReader(char * pstrLine, int uiBufferLen, void * pvData)\n{\n    printf(\"Read line:[%s]\\r\\n\", pstrLine);\n\n    char *pArray[8] = {0};\n    int Num = 0;\n    int index = 0;\n    StringSplit(pstrLine, ' ', pArray, 8, &amp;Num);\n    for (index = 0; index &lt;= Num; index ++)\n    {\n        printf(\"Get value :[%s]\\r\\n\", pArray[index]);\n    }\n\n    return 0;\n}\n\nint main(int argc, char * argv[])\n{\n    int ret = 0;\n\n    if (argc != 2)\n    {\n        printf(\"Please input file to read.\\r\\n\");\n        return 0;\n    }\n\n    ret = ReadConfigFileEx(argv[1], MyLineReader, NULL, AUTO_FILTER_NEWLINDE);\n    if (ret)\n    {\n        printf(\"Open file error.\\r\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8128268, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08CPpo7ckRw/AAAAAAAAAAI/AAAAAAAAGgQ/O2xIxLJ4Rt8/photo.jpg?sz=128", "display_name": "Jeff Johnson", "link": "https://stackoverflow.com/users/8128268/jeff-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496888135, "creation_date": 1496875580, "last_edit_date": 1496876013, "question_id": 44423939, "link": "https://stackoverflow.com/questions/44423939/only-printing-last-line-of-txt-file-when-reading-into-struct-array-in-c", "title": "Only printing last line of txt file when reading into struct array in C", "body": "<p>I am reading from a txt file into an array of structures. Example txt: </p>\n\n<pre><code>-4.5 -1 0 0\n4.0 1 0 0\n8 0 1 2\n12.1 0 -6 1\n-3.2 2.5 -3.0 4\n</code></pre>\n\n<p>The 4 values of each line correspond to the 4 values in the structure. The file may contain up to 100 lines (MAX is defined as 100). With the following code I am trying to store each line into the respective index of the struct array and then print:</p>\n\n<pre><code>FILE *fileName = NULL;\ntypedef struct chargeData_struct {\n    double Q, x, y, z;\n} ChargeData;\nChargeData values[MAX], *p = values;\n\nfileName = fopen(\"charge2.txt\", \"r\");\nif (fileName == NULL)\n{\n    printf(\"ERROR: Could not open file.\");\n}\n\nint k = 0;\nwhile (fscanf(fileName, \"%lf %lf %lf %lf\", &amp;p[k].Q, &amp;p[k].x, &amp;p[k].y, &amp;p[k].z) != EOF);\n{\n    printf(\"%f %f %f %f\\n\", p[k].Q, p[k].x, p[k].y, p[k].z);\n    k++;\n}\nfclose(fileName);\n</code></pre>\n\n<p>However, only the last line of the txt file is printed. Is the same index of the struct array being overwritten each time?</p>\n"}, {"tags": ["c", "gcc", "stdin"], "comments": [{"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1496875182, "post_id": 44423865, "comment_id": 75846177, "body": "<code>stdin</code>: Standard input, for input from the terminal/console."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496875256, "post_id": 44423865, "comment_id": 75846203, "body": "&quot;But how is it implemented&quot;, too broad, this is implementation behavior. So you are asking to made an answer for all existing compiler. Choice one compiler in your tags (gcc, clang, msvs, ...)."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1496875280, "post_id": 44423865, "comment_id": 75846218, "body": "stdin is a c runtime file handle, typically this is a pointer. It is wired up automatically to the &#39;file&#39; stnadard input, typically file 1 as far as the OS is concerned"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1496875351, "post_id": 44423865, "comment_id": 75846239, "body": "find the definition of stdin in stdio.h. Look how its implemented"}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496875358, "post_id": 44423865, "comment_id": 75846242, "body": "@Stargateur okay, narrowed it"}, {"owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "edited": false, "score": 0, "creation_date": 1496875475, "post_id": 44423865, "comment_id": 75846275, "body": "It&#39;s a handle. Handle is something you get when perform some functions. And then you give it as a parameter to other functions to change it&#39;s state. List of those functions has been given to you in one answer. This is everything you need to know to use it. If you are curious about the implementation, fetch sources of some libc implementation and dig through them."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1496875486, "post_id": 44423865, "comment_id": 75846280, "body": "Stdin is a file handle to standard input, just like stdout and stderr are handles to standard output and standard error. They have no meaningful value as integers, pointers, or anything else other than file handles. It&#39;s not a pointer, you don&#39;t use it for math or dereference it or do anything else except read input from it. Implementation of it is meaningless unless you&#39;re writing an operating system, and by the time you&#39;re doing that you should understand quite well what it is and what it&#39;s for."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1496884631, "post_id": 44423865, "comment_id": 75848658, "body": "&quot;Some kind of FILE pointer&quot; - yes, that&#39;s exactly what it is... Hence why it&#39;s pointer-sized and you can use it with functions that take FILE pointers."}], "answers": [{"tags": [], "owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "is_accepted": false, "score": 4, "last_activity_date": 1496890697, "last_edit_date": 1496890697, "creation_date": 1496875284, "answer_id": 44423900, "question_id": 44423865, "link": "https://stackoverflow.com/questions/44423865/what-exactly-is-stdin/44423900#44423900", "title": "What exactly is stdin?", "body": "<p><strong>stdin</strong> (short for <em>standard input</em>) is a pointer to a <code>FILE</code> type that can only be manipulated with these functions:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/C_file_input/output\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/C_file_input/output</a></p>\n\n<p>On most (if not all) implementations, the FILE type is a structure with a integer file descriptor and a character buffer, allowing for buffered I/O operations. This file descriptor is opened in read-only mode and is normally connected to either the terminal, a pipe or a file.</p>\n\n<p>There's also <strong>stdout</strong> (standard output) and <strong>stderr</strong> (standard error), opened in writing mode.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 2112278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da46df2aadfcfbe52c744dc6fe6275f2?s=128&d=identicon&r=PG", "display_name": "J.Guarin", "link": "https://stackoverflow.com/users/2112278/j-guarin"}, "is_accepted": false, "score": 1, "last_activity_date": 1496875300, "creation_date": 1496875300, "answer_id": 44423903, "question_id": 44423865, "link": "https://stackoverflow.com/questions/44423865/what-exactly-is-stdin/44423903#44423903", "title": "What exactly is stdin?", "body": "<p>It's an abstraction of the Standard Input service the OS supports. It is modeled as a stream. <a href=\"https://www.gnu.org/software/libc/manual/html_node/Standard-Streams.html\" rel=\"nofollow noreferrer\">Check GNU LibC definitions</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496876125, "post_id": 44423904, "comment_id": 75846447, "body": "And why are the two statements always reached?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496876182, "post_id": 44423904, "comment_id": 75846470, "body": "@VidorVistrom See <a href=\"https://stackoverflow.com/a/4105123/1505939\">what is undefined behaviour</a>. Anything can happen"}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496876244, "post_id": 44423904, "comment_id": 75846497, "body": "Okay.. So that leads to UB too!"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 10, "last_activity_date": 1496875740, "last_edit_date": 1496875740, "creation_date": 1496875304, "answer_id": 44423904, "question_id": 44423865, "link": "https://stackoverflow.com/questions/44423865/what-exactly-is-stdin/44423904#44423904", "title": "What exactly is stdin?", "body": "<p><code>stdin</code> is a pointer of type <code>FILE *</code>.  The standard does not restrict the implementation beyond this,  the details of what <code>FILE</code> is is entirely up to your compiler. It could even be an incomplete type (opaque).</p>\n\n<p>Of course, trying to print a <code>FILE</code> with <code>%s</code> causes undefined behaviour (unless <code>FILE</code> is a typedef for <code>char *</code> or similar, which it almost certainly is not).</p>\n"}, {"comments": [{"owner": {"reputation": 546, "user_id": 2748628, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GdesV.png?s=128&g=1", "display_name": "bit2shift", "link": "https://stackoverflow.com/users/2748628/bit2shift"}, "edited": false, "score": 0, "creation_date": 1576980891, "post_id": 44425330, "comment_id": 105066136, "body": "File descriptors start at 0. Therefore <code>stdin</code>, <code>stdout</code>, and <code>stderr</code> are 0, 1, and 2, respectively."}], "tags": [], "owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "is_accepted": false, "score": 1, "last_activity_date": 1496886103, "creation_date": 1496886103, "answer_id": 44425330, "question_id": 44423865, "link": "https://stackoverflow.com/questions/44423865/what-exactly-is-stdin/44425330#44425330", "title": "What exactly is stdin?", "body": "<p>stdin,stdout,stderr are 3 opened files for you app to use as the default input file, output file and error out put file.</p>\n\n<p>And those 3 file have open by the system before your app start. And the files description are 1, 2 and 3.</p>\n\n<p>If you close(1), the stdin file will be closed. And then, if you open another file, the stdin will be point to the new file.</p>\n\n<p>All input APIs(scanf, get, ...) without FD are read data from input file, and output APIs without FD are put the value into stdout.</p>\n\n<p>So, if you close(1), and open a new file with return value is 1, the printf will put values into your file.</p>\n"}, {"comments": [{"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496905655, "post_id": 44428004, "comment_id": 75855644, "body": "Now that&#39;s pretty sure its a pointer to FILE. But then how does feof always return true in this case? The accepted answer to this question <a href=\"https://stackoverflow.com/questions/26948723/checking-the-stdin-buffer-if-its-empty\" title=\"checking the stdin buffer if its empty\">stackoverflow.com/questions/26948723/&hellip;</a> doesn&#39;t seem to work many times. But your efforts are appreciated."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 1, "last_activity_date": 1496902688, "creation_date": 1496902688, "answer_id": 44428004, "question_id": 44423865, "link": "https://stackoverflow.com/questions/44423865/what-exactly-is-stdin/44428004#44428004", "title": "What exactly is stdin?", "body": "<pre><code>typedef struct _IO_FILE FILE;\nextern struct _IO_FILE *stdin;\n</code></pre>\n\n<p>So it is a pointer to FILE.  </p>\n\n<p>The Standard says:</p>\n\n<blockquote>\n  <p>7.21 Input/output </p>\n</blockquote>\n\n<pre><code>stderr\nstdin\nstdout\nwhich are expressions of type \u2018\u2018pointer to FILE\u2019\u2019 that point to the FILE objects\nassociated, respectively, with the standard error, input, and output streams.\n</code></pre>\n"}], "owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18308, "favorite_count": 3, "accepted_answer_id": 44423904, "answer_count": 5, "score": 3, "last_activity_date": 1496902688, "creation_date": 1496875062, "last_edit_date": 1592644375, "question_id": 44423865, "link": "https://stackoverflow.com/questions/44423865/what-exactly-is-stdin", "title": "What exactly is stdin?", "body": "<p>I am a bit confused regarding the implementation of stdin. What exactly is it? Is it a pointer? I tried to print the size of stdin using sizeof on a 64 bit machine and got 8. I even de-referenced it using *stdin in the %s specifier and got the not used characters in the input stream( all of them). But if I compare its de referenced value inside if I get an error. I know its an input stream. But how is it implemented?</p>\n<p>Here is a sample:</p>\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n    \n    char a[10];\n\n    fgets(a,10,stdin);\n\n    printf(&quot;a: %s&quot;,a);\n    \n    printf(&quot;\\nstdin: %s&quot;,*stdin);\n\n//if(*stdin==&quot;foo&quot;){\n//    printf(&quot;True&quot;);\n//}//Error: invalid operands to binary == (have 'FILE' and 'char *')//and casting to char * doesn't help\n\n    printf(&quot;\\nSize of stdin: %d\\n&quot;,sizeof(stdin));\n\n    if(stdin!=NULL){\n        printf(&quot;This statement is always reached&quot;);//always printed even in when input is bigger than 10 chars and otherwise\n    }\n    \n\nif(!feof(stdin)){\n    printf(&quot;\\nThis statement is also always reached&quot;);\n}\n}\n</code></pre>\n<p>When I input</p>\n<blockquote>\n<p>foobar1234567890</p>\n</blockquote>\n<p>I get the result:</p>\n<blockquote>\n<p>a: foobar123</p>\n<p>stdin: <em>4567890</em></p>\n<p>Size of stdin: 8</p>\n<p>This statement is always reached</p>\n<p>This statement is also always reached</p>\n</blockquote>\n<p>And when I input</p>\n<blockquote>\n<p>foobar</p>\n</blockquote>\n<p>I get the output</p>\n<blockquote>\n<p>a: foobar</p>\n<p>stdin:</p>\n<p>Size of stdin: 4</p>\n<p>This statement is always reached</p>\n<p>This statement is also always reached</p>\n</blockquote>\n<p>I understand that stdin is kind of a FILE pointer, but I don't clearly get it. Could anyone explain the above outputs?</p>\n"}, {"tags": ["c", "embedded", "avr", "atmega"], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7292819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986e6709d8b360153849def9dcf8fea8?s=128&d=identicon&r=PG&f=1", "display_name": "Gary99", "link": "https://stackoverflow.com/users/7292819/gary99"}, "edited": false, "score": 0, "creation_date": 1496875577, "post_id": 44423644, "comment_id": 75846299, "body": "Pull up -- connected to +5V, or pull down -- connected to ground?"}, {"owner": {"reputation": 3353, "user_id": 1066647, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6af4fdacf179dace5d893487d7c78533?s=128&d=identicon&r=PG", "display_name": "FRob", "link": "https://stackoverflow.com/users/1066647/frob"}, "reply_to_user": {"reputation": 1600, "user_id": 7292819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986e6709d8b360153849def9dcf8fea8?s=128&d=identicon&r=PG&f=1", "display_name": "Gary99", "link": "https://stackoverflow.com/users/7292819/gary99"}, "edited": false, "score": 0, "creation_date": 1496889635, "post_id": 44423644, "comment_id": 75849809, "body": "@Gary99 That depends on what you switch connects to. If the switch connects to GND when closed, then add a PU to 5V. If the switch connects to 5V when closed, add a PD to GND."}, {"owner": {"reputation": 1600, "user_id": 7292819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986e6709d8b360153849def9dcf8fea8?s=128&d=identicon&r=PG&f=1", "display_name": "Gary99", "link": "https://stackoverflow.com/users/7292819/gary99"}, "reply_to_user": {"reputation": 3353, "user_id": 1066647, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6af4fdacf179dace5d893487d7c78533?s=128&d=identicon&r=PG", "display_name": "FRob", "link": "https://stackoverflow.com/users/1066647/frob"}, "edited": false, "score": 0, "creation_date": 1496927407, "post_id": 44423644, "comment_id": 75870609, "body": "@FRob  Yes.  I understand PUs and PDs quite well.  I&#39;m encouraging Narek to clarify his answer &quot;pull-up / pull-down resistor connected to ground&quot;."}], "tags": [], "owner": {"reputation": 222, "user_id": 7166007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rXoDS2O1Pho/AAAAAAAAAAI/AAAAAAAAAH4/RyXghaqXd9s/photo.jpg?sz=128", "display_name": "Narek Daduryan", "link": "https://stackoverflow.com/users/7166007/narek-daduryan"}, "is_accepted": false, "score": 1, "last_activity_date": 1496873754, "creation_date": 1496873754, "answer_id": 44423644, "question_id": 44423365, "link": "https://stackoverflow.com/questions/44423365/how-to-read-an-input-value-from-atmega32-pin/44423644#44423644", "title": "How to read an input value from atmega32 pin?", "body": "<p>Just to make sure, your button has to have a pull-up / pull-down resistor connected to ground. Without it, you can't correctly read whether the pin is on or off.</p>\n\n<p><a href=\"https://learn.sparkfun.com/tutorials/pull-up-resistors\" rel=\"nofollow noreferrer\">https://learn.sparkfun.com/tutorials/pull-up-resistors</a></p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 7156422, "user_type": "registered", "profile_image": "https://graph.facebook.com/251641538584073/picture?type=large", "display_name": "Ahmed Rifaat", "link": "https://stackoverflow.com/users/7156422/ahmed-rifaat"}, "edited": false, "score": 0, "creation_date": 1496874844, "post_id": 44423689, "comment_id": 75846074, "body": "thank you for making it clear. but it seems like the circuit isn&#39;t working i thing the problem might be in the circuit."}], "tags": [], "owner": {"reputation": 341, "user_id": 8014927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67794efc7db32a3d67d882160d834a7?s=128&d=identicon&r=PG&f=1", "display_name": "wyc", "link": "https://stackoverflow.com/users/8014927/wyc"}, "is_accepted": false, "score": 3, "last_activity_date": 1496873984, "creation_date": 1496873984, "answer_id": 44423689, "question_id": 44423365, "link": "https://stackoverflow.com/questions/44423365/how-to-read-an-input-value-from-atmega32-pin/44423689#44423689", "title": "How to read an input value from atmega32 pin?", "body": "<p>I find one logic error here:</p>\n\n<pre><code>if ((PINA&amp;0b00000010) == 1)  // button pressed\n</code></pre>\n\n<p>when the bit 1 is set, <code>(PINA&amp;0b00000010) == 2</code>.\nNormally, when you do bit check, just do this: </p>\n\n<pre><code>if (PINA&amp;0b00000010)  // button pressed\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8023951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8e258749fe8436556af16e3e6780cc?s=128&d=identicon&r=PG&f=1", "display_name": "rlphillipsiii", "link": "https://stackoverflow.com/users/8023951/rlphillipsiii"}, "is_accepted": false, "score": 1, "last_activity_date": 1496904785, "creation_date": 1496904785, "answer_id": 44428639, "question_id": 44423365, "link": "https://stackoverflow.com/questions/44423365/how-to-read-an-input-value-from-atmega32-pin/44428639#44428639", "title": "How to read an input value from atmega32 pin?", "body": "<p>You should change your hardware setup, and make your button active low, which means that pushing the button connects your GPIO pin to ground.  Instead of connecting your button to positive side of the 5V cell, connected it to the negative side.  That will let you take advantage of the internal pull resistor that you can active on your GPIO.  Once you do that, your code should be changed to look something like this:</p>\n\n<pre><code>#define DDRA (*((volatile unsigned char *)0x3A))\n#define PORTA (*((volatile unsigned char *)0x3B))\n#define PINA (*((volatile unsigned char *)0x39))\n\n#define LED_BIT 0\n#define BTN_BIT 1\n\nint main(void) \n{\n    DDRA  = (1 &lt;&lt; LED_BIT); // PA0 output\n    PORTA = (1 &lt;&lt; BTN_BIT); // enable internal pull up on PA1\n\n    while (1) {\n        if (!(PINA &amp; (1 &lt;&lt; BTN_BIT))) {  // button pressed\n            PORTA |= (1 &lt;&lt; LED_BIT);   // turn led on\n        }\n    }\n}\n</code></pre>\n\n<p>Notice that the if statement now checks to see if the PA1 is a 0 because the button is set up to connect to ground when it is pushed.  Also notice that there is a new line in there that enables an internal pull-up, which makes PA1 read a 1 while the button is not pressed.  If you don't change your button an active low configuration, you will have to use an external pull-down resistor in order for your code to work correctly.</p>\n"}], "owner": {"reputation": 7, "user_id": 7156422, "user_type": "registered", "profile_image": "https://graph.facebook.com/251641538584073/picture?type=large", "display_name": "Ahmed Rifaat", "link": "https://stackoverflow.com/users/7156422/ahmed-rifaat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5295, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1496904785, "creation_date": 1496872228, "last_edit_date": 1496875403, "question_id": 44423365, "link": "https://stackoverflow.com/questions/44423365/how-to-read-an-input-value-from-atmega32-pin", "title": "How to read an input value from atmega32 pin?", "body": "<p>I'm trying to read a value from an avr pin but it doesn't work.</p>\n\n<p>I'm trying to read a value that is coming from a push button and this button is connected to 5V DC cell.</p>\n\n<p>When I press the button the 5V should go to the atmega32 and reads it as 1, then the if statement becomes true and the led goes on.</p>\n\n<p>However, when the value becomes true the led will turn on but its not.</p>\n\n<p>bit 1 is the button\nbit 0 is the led</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>#define DDRA (*((volatile unsigned char *)0x3A))\n#define PORTA (*((volatile unsigned char *)0x3B))\n#define PINA (*((volatile unsigned char *)0x39))\n\nint main(void) {\n   DDRA |= 0b00000001;         // pin 0 output\n\n    while (1) {\n        if ((PINA&amp;0b00000010) == 1) {  // button pressed\n            PORTA |= 0b00000001;   // turn led on\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "function", "switch-statement"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1496872384, "post_id": 44423354, "comment_id": 75845144, "body": "Consider what is <code>printf(&quot;%d&quot;, f(3));</code>, then consider <code>printf(&quot;%d&quot;, f(4));</code> ...  Tis a good exercise to step through yourself."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1496873108, "post_id": 44423354, "comment_id": 75845449, "body": "Play computer with pencil and paper. Trace each step and local function values."}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1496872745, "creation_date": 1496872745, "answer_id": 44423478, "question_id": 44423354, "link": "https://stackoverflow.com/questions/44423354/c-switch-case-with-function/44423478#44423478", "title": "C switch case with function", "body": "<p>This is a recursive implementation the <a href=\"https://en.wikipedia.org/wiki/Fibonacci_number\" rel=\"nofollow noreferrer\">Fibonacci sequence</a>, where each number is the sum of the two preceding numbers.</p>\n\n<p>The switch statement works as follows:</p>\n\n<ul>\n<li>If <code>i</code> is 0, return 0</li>\n<li>If <code>i</code> is 1 or 2, return 1</li>\n<li>Otherwise, return the sum of <code>f(i-2)</code> and <code>f(i-1)</code> - this eventually boils down to the two base cases above.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "is_accepted": false, "score": 3, "last_activity_date": 1496873052, "creation_date": 1496873052, "answer_id": 44423532, "question_id": 44423354, "link": "https://stackoverflow.com/questions/44423354/c-switch-case-with-function/44423532#44423532", "title": "C switch case with function", "body": "<p>This is a recursive function to implement the <a href=\"https://en.wikipedia.org/wiki/Fibonacci_number\" rel=\"nofollow noreferrer\">Fibonacci sequence</a></p>\n\n<p>Lets consider a simpler scenario (in order to shorten response length) of if we were to call the function with argument of 4 : <strong>f(4)</strong></p>\n\n<p>Stepping through it we find:</p>\n\n<ul>\n<li>Called f(4)</li>\n<li>Hit default case statement to call f(2) + f(3)\n\n<ul>\n<li>The f(2) call will hit the case statement for 2 and return 1</li>\n<li>The f(3) call will hit the default case statement and call f(1) + f(2)\n\n<ul>\n<li>Both f(1) and f(2) will hit their respective case statements and return 1</li>\n</ul></li>\n<li>We now know the f(3) call returns f(1) + f(2) = 1 + 1 = 2</li>\n</ul></li>\n<li>We now know the f(4) call returns f(2) + f(3) = 1 + 2 = <strong>3</strong> </li>\n</ul>\n\n<p>I would recommend the same process to see why a call of f(5) would return 5. And then using the fact that f(4) = 3 and f(5) = 5, you can understand why f(6) = f(4) + f(5) = 8.</p>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 8014927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67794efc7db32a3d67d882160d834a7?s=128&d=identicon&r=PG&f=1", "display_name": "wyc", "link": "https://stackoverflow.com/users/8014927/wyc"}, "is_accepted": true, "score": 6, "last_activity_date": 1496873066, "creation_date": 1496873066, "answer_id": 44423535, "question_id": 44423354, "link": "https://stackoverflow.com/questions/44423354/c-switch-case-with-function/44423535#44423535", "title": "C switch case with function", "body": "<p>Maybe you just need to step through the code in a debug run, but this is why you have <code>f(6)=8</code></p>\n\n<pre><code>step1: f(6)\nstep2: f(6-2)              +f(6-1)\nstep3: f(4-2)+f(4-1)       +f(5-2)       +f(5-1)\nstep4: f(2)  +f(3-2)+f(3-1)+f(3-2)+f(3-1)+f(4-2)+f(4-1)\nstep5: 1     +1     +1     +1     +1     +1     +f(3-2)+f(3-1)\nstep6: 1     +1     +1     +1     +1     +1     +1     +1\nfinal: 8\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5679590"}, "is_accepted": false, "score": 1, "last_activity_date": 1496873468, "creation_date": 1496873468, "answer_id": 44423599, "question_id": 44423354, "link": "https://stackoverflow.com/questions/44423354/c-switch-case-with-function/44423599#44423599", "title": "C switch case with function", "body": "<p>This is a recursive function which contains a switch case. Generally, in a Switch case, you need a statement breaker like <strong>break</strong> or <strong>return</strong> so that only that specific case executes correctly. Since in your code <code>case 1</code> and <code>case 2</code> return to same value ie 1 your code breaks down as a sum of 8 1s and final sum is 8.</p>\n"}], "owner": {"reputation": 451, "user_id": 2696732, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/94b41cb1a813e744993892017078f4c9?s=128&d=identicon&r=PG&f=1", "display_name": "Night5talker", "link": "https://stackoverflow.com/users/2696732/night5talker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "accepted_answer_id": 44423535, "answer_count": 4, "score": -1, "last_activity_date": 1496873468, "creation_date": 1496872173, "question_id": 44423354, "link": "https://stackoverflow.com/questions/44423354/c-switch-case-with-function", "title": "C switch case with function", "body": "<p>can someone explain me this code?\nI cant understand why printed value is 8 in this code</p>\n\n<p>can someone explain it to me</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint f(int i){\n    switch (i){\n        case 0 :\n            return 0;\n        case 1:\n\n        case 2:\n            return 1;\n        default:\n\n            return f(i-2)+f(i-1);\n    }\n}\n\n\nvoid main(void) {\n\nprintf(\"%d\", f(6));\n\n}\n</code></pre>\n"}, {"tags": ["c", "tcp", "embedded", "packet", "lwip"], "comments": [{"owner": {"reputation": 5773, "user_id": 3525545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rge03.jpg?s=128&g=1", "display_name": "Mahonri Moriancumer", "link": "https://stackoverflow.com/users/3525545/mahonri-moriancumer"}, "edited": false, "score": 0, "creation_date": 1496893130, "post_id": 44423345, "comment_id": 75850581, "body": "So, assume that your tcp_bind() call fails.  How would you know?"}, {"owner": {"reputation": 316, "user_id": 2888464, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bcUJ1.jpg?s=128&g=1", "display_name": "M_J", "link": "https://stackoverflow.com/users/2888464/m-j"}, "reply_to_user": {"reputation": 5773, "user_id": 3525545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rge03.jpg?s=128&g=1", "display_name": "Mahonri Moriancumer", "link": "https://stackoverflow.com/users/3525545/mahonri-moriancumer"}, "edited": false, "score": 0, "creation_date": 1496942748, "post_id": 44423345, "comment_id": 75881715, "body": "@MahonriMoriancumer Actually, the bind doesn&#39;t fail, I&#39;m getting an ERR_MEM out of tcp_write. Are you familiar with what might cause that? ... Nice user name."}, {"owner": {"reputation": 5773, "user_id": 3525545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rge03.jpg?s=128&g=1", "display_name": "Mahonri Moriancumer", "link": "https://stackoverflow.com/users/3525545/mahonri-moriancumer"}, "edited": false, "score": 0, "creation_date": 1496957790, "post_id": 44423345, "comment_id": 75889532, "body": "I was trying to make a point.  The question code has no error handling.  Hence, trying to diagnose what is happening is difficult.  The code, currently, only indicates an error if returned by tcp_output().  I suggest that the question code be edited to better show that each call succeeded or failed; and then where you are experiencing an error.  In other words, getting an answer will likely require an edit to the question code that shows all functions up to tcp_write() have been successful, and that a specific error (ERR_MEM) was returned by tcp_write."}], "answers": [{"tags": [], "owner": {"reputation": 5773, "user_id": 3525545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rge03.jpg?s=128&g=1", "display_name": "Mahonri Moriancumer", "link": "https://stackoverflow.com/users/3525545/mahonri-moriancumer"}, "is_accepted": true, "score": 1, "last_activity_date": 1520974186, "last_edit_date": 1520974186, "creation_date": 1496958792, "answer_id": 44446168, "question_id": 44423345, "link": "https://stackoverflow.com/questions/44423345/raw-lwip-send-tcp-transmission-to-static-ip/44446168#44446168", "title": "Raw LWIP Send TCP Transmission to Static IP", "body": "<p>The tcp_write() function will fail and return ERR_MEM if:</p>\n\n<ol>\n<li>The length of the data exceeds the current send buffer size.</li>\n<li>The length of the queue of the outgoing segment is larger than the upper limit defined in lwipopts.h. </li>\n</ol>\n\n<p>The number of bytes available in the output queue can be retrieved with the tcp_sndbuf() function.</p>\n\n<p>Potential solution(s): </p>\n\n<ol>\n<li>Try again but send less data.</li>\n<li>Monitor the amount of space available in the send buffer and only send (more) data when there is space available in the send buffer.</li>\n</ol>\n\n<p>Suggestions:</p>\n\n<p>tcp_snd_buf() can be used to find out how much send buffer space is available. </p>\n\n<p>tcp_sent() can be implemented with callback function, that will be called when send butter space is available. </p>\n"}], "owner": {"reputation": 316, "user_id": 2888464, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bcUJ1.jpg?s=128&g=1", "display_name": "M_J", "link": "https://stackoverflow.com/users/2888464/m-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3628, "favorite_count": 0, "accepted_answer_id": 44446168, "answer_count": 1, "score": 1, "last_activity_date": 1520974186, "creation_date": 1496872111, "question_id": 44423345, "link": "https://stackoverflow.com/questions/44423345/raw-lwip-send-tcp-transmission-to-static-ip", "title": "Raw LWIP Send TCP Transmission to Static IP", "body": "<p>I've got the TCP Echo example working well on my hardware, and yesterday figured out how to get a UDP Broadcast working. After further thought, I've realized is that what I really need is to be able to set up a TCP Connection to a Static IP, the idea being that my hardware can connect to a server of some sort and then use that connection for all its transactions. The difference is that whereas the echo example sets up a passive connection, that binds with the incoming source (as I understand it), I want to initiate the connection deliberately to a known IP.</p>\n\n<p>Based on what I found on Wikia Here <a href=\"http://lwip.wikia.com/wiki/Raw/UDP\" rel=\"nofollow noreferrer\">Here</a></p>\n\n<p>I've attempted as a base case to implement a function that can send a packet to a Defined IP. I'm simply trying to send a packet to my PC, and I'm looking for it on Wireshark.</p>\n\n<pre><code>void echo_tx_tcp()\n{\n  err_t wr_err = ERR_OK;\n  struct tcp_pcb *l_tcp_pcb;\n  l_tcp_pcb = tcp_new();\n  ip_addr_t dest_ip =\n  { ((u32_t)0x0C0C0C2BUL) };\n  wr_err = tcp_bind(l_tcp_pcb, &amp;dest_ip, 12);\n  wr_err = tcp_connect(l_tcp_pcb, &amp;dest_ip, 12, echo_accept);\n  tcp_sent(l_tcp_pcb, echo_sent);\n\n  struct pbuf *p = pbuf_alloc(PBUF_TRANSPORT, 1024, PBUF_RAM);\n  unsigned char buffer_send[1024] = \"My Name Is TCP\";\n  p-&gt;payload = buffer_send;\n  p-&gt;len = 1024;\n  p-&gt;tot_len = 1024;\n\n  wr_err = tcp_write(l_tcp_pcb, p-&gt;payload, p-&gt;len, 1);\n  wr_err = tcp_output(l_tcp_pcb);\n\n  if(wr_err == ERR_OK)\n  {\n    p-&gt;len++;\n  }\n  return;\n}\n</code></pre>\n\n<p>The last if statement just exists so that I can inspect the wr_err value with a debugger. The err is coming  back OK but the packet is not seen on wireshark. My setup is my hardare as well as my PC connected to a router in an isolated manner. The IP Address of the PC locally is 12.12.12.43</p>\n\n<p>Am I missing a step here?</p>\n"}, {"tags": ["c", "string", "pointers", "types", "sizeof"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1496871911, "post_id": 44423257, "comment_id": 75844967, "body": "<code>sizeof(i[2])</code> doesn&#39;t do what you think it does"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496871992, "post_id": 44423257, "comment_id": 75844998, "body": "<code>i[2]</code> is a pointer, not an array."}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496872095, "post_id": 44423257, "comment_id": 75845044, "body": "@Barmar What does just &quot;foo&quot; represent then?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496872217, "post_id": 44423257, "comment_id": 75845089, "body": "<code>&quot;foo&quot;</code> is a string literal, which is like an array."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496872272, "post_id": 44423257, "comment_id": 75845103, "body": "<code>printf(&quot;%lu\\n&quot;, sizeof(i[2]));</code> --&gt; <code>printf(&quot;%zu\\n&quot;, strlen(i[2]) + 1);</code> --&gt; <code>4</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496873408, "post_id": 44423257, "comment_id": 75845572, "body": "The code in the edit doesn&#39;t seem to have anything to do with the rest of the question"}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496873441, "post_id": 44423257, "comment_id": 75845584, "body": "@M.M Its the function I&#39;ve mentioned."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496873553, "post_id": 44423257, "comment_id": 75845631, "body": "So many cast, &quot;Oh dear we are in trouble!&quot;."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496873623, "post_id": 44423257, "comment_id": 75845660, "body": "I&#39;m sensing that your real question is &quot;why does <code>i[2] = &quot;foo&quot;; getFromJudy(bla, i[2]);</code> behave differently to <code>getFromJudy(bla, &quot;foo&quot;);</code>?&quot;  If so then you should edit your question to remove the question about <code>sizeof</code>, which literally has nothing to do with that issue. Also you should include a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496873781, "post_id": 44423257, "comment_id": 75845713, "body": "Perfect example, of <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>"}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496873881, "post_id": 44423257, "comment_id": 75845754, "body": "Done the editing. It would be good if anyone has any insight on this."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496873991, "post_id": 44423257, "comment_id": 75845792, "body": "@saruftw You are far away of a good question, read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I want be able to copy and past your code and that must compile ! (only code not compilation linker ofc). What is these <code>judy</code> structure for example."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496874465, "post_id": 44423257, "comment_id": 75845949, "body": "You need a MCVE because there is no difference in the defined behaviour between the two options you&#39;ve described, so the most likely explanation is that you already caused undefined behaviour (either in your own code, or due to a bug in the judy library). The only way to proceed is to find where the bug is, and to do so requires seeing a complete program that exhibits the bug."}], "answers": [{"comments": [{"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496872205, "post_id": 44423341, "comment_id": 75845081, "body": "Somehow, the function doesn&#39;t behave accordingly. I want the function to behave as it would with &quot;foo&quot; as the argument. How can I make change to the passing of i[2] as an argument?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496872241, "post_id": 44423341, "comment_id": 75845098, "body": "@saruftw Luckily, you&#39;re concerned with strings, so you can use <code>strlen</code>; that&#39;s what it&#39;s there for."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 1, "creation_date": 1496872243, "post_id": 44423341, "comment_id": 75845099, "body": "@saruftw You can&#39;t. Pointers don&#39;t carry information about the size of the object they point to."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496872348, "post_id": 44423341, "comment_id": 75845133, "body": "@Barmar In the general case, you&#39;re right, but strings have the null-terminator which allows for library functions liked <code>strlen</code>."}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496872414, "post_id": 44423341, "comment_id": 75845154, "body": "Is there a way to type cast the value this pointer points to such that it behaves like a normal string literal?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496872464, "post_id": 44423341, "comment_id": 75845175, "body": "@saruftw That sounds like an appropriate topic for a new question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 1, "creation_date": 1496872695, "post_id": 44423341, "comment_id": 75845265, "body": "@saruftw No, it&#39;s not possible. Pointers and arrays are completely different things. Arrays can decay to pointers, but there&#39;s no way to go the other way because the information simply isn&#39;t there."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496872759, "post_id": 44423341, "comment_id": 75845290, "body": "@saruftw If you&#39;re just dealing with strings, why don&#39;t you want to use <code>strlen()</code>?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496872812, "post_id": 44423341, "comment_id": 75845308, "body": "@saruftw Why don&#39;t you just give the length to your function ?"}, {"owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496872941, "post_id": 44423341, "comment_id": 75845361, "body": "I&#39;m unable to gauge the issue I&#39;m facing here. The function doesn&#39;t behave correctly with i[2] as it does with &quot;foo&quot; and that&#39;s what I&#39;m trying to solve. @Barmar what do you mean by using strlen()?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496873088, "post_id": 44423341, "comment_id": 75845437, "body": "@saruftw What exactly do you mean by &quot;doesn&#39;t behave correctly&quot;?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 2, "creation_date": 1496873094, "post_id": 44423341, "comment_id": 75845444, "body": "@saruftw Add the function you&#39;re trying to write to the question, and we can help you fix it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "edited": false, "score": 0, "creation_date": 1496873121, "post_id": 44423341, "comment_id": 75845455, "body": "@saruftw If you want to know how many characters there are in a string, use <code>strlen(string)</code>. This works with a pointer or array."}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1496872099, "creation_date": 1496872099, "answer_id": 44423341, "question_id": 44423257, "link": "https://stackoverflow.com/questions/44423257/similar-c-strings-have-varying-sizes/44423341#44423341", "title": "Similar C strings have varying sizes", "body": "<p><code>sizeof(i[2])</code> returns the size of a pointer on your machine, which is eight bytes, since it is of type <code>char *</code>; <code>sizeof(\"foo\")</code> returns the length of the string \"foo\" plus the null terminator, which is four bytes.</p>\n"}], "owner": {"reputation": 846, "user_id": 3301488, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/35848d5d02b8a0b12b9cdc979f88a370?s=128&d=identicon&r=PG&f=1", "display_name": "saruftw", "link": "https://stackoverflow.com/users/3301488/saruftw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 44423341, "answer_count": 1, "score": -4, "last_activity_date": 1496874163, "creation_date": 1496871707, "last_edit_date": 1496873682, "question_id": 44423257, "link": "https://stackoverflow.com/questions/44423257/similar-c-strings-have-varying-sizes", "title": "Similar C strings have varying sizes", "body": "<p>I have a function which takes an argument of type <code>const unsigned char *</code> as one of its inputs.</p>\n\n<p>Function (mentioned below)</p>\n\n<p><code>someType *doSomething (someStruct *, const unsigned char *);</code>\nor <code>judyData *getFromJudy (judyConfig *, const unsigned char *)</code>.</p>\n\n<p>I also have an array of strings , <code>char* i[10]</code>.</p>\n\n<p>Suppose, <code>i[2] = \"foo\"</code>. Now, I get different results when I run</p>\n\n<p><code>doSomething(struct_instance, i[2])</code> and <code>doSomething(struct_instance, \"foo\")</code>.</p>\n\n<p>Can anyone help me out with when do such situations arise?\nIs there a way to type cast the value this pointer points to such that it behaves like a normal string literal? </p>\n\n<p>EDIT:</p>\n\n<p>Sharing code samples.</p>\n\n<p>The function:</p>\n\n<pre><code>// get an entry from the index, return it or null\njudyData *getFromJudy (judyConfig *cnf, const unsigned char *key) {\n  judyData *data;\n  JudySlot *cell;\n  int current;\n      cell = judy_slot((Judy *) cnf-&gt;idx, (unsigned char *) key, (size_t) strlen((const char *) key));\n\n  if (cell) {\n    data = (judyData *) *cell;\n    // doesn't enter this if \"foo\" is not used and i[2] is used.\n    if (data-&gt;count == 0) {\n      return NULL;\n    }\n\n    return data;\n  }\n  return NULL;\n}\n</code></pre>\n\n<p>with <code>char * i[10]</code>. It is called as</p>\n\n<p><code>data = getFromJudy (obj, \"foo\")</code></p>\n"}, {"tags": ["c", "gcc", "x86-64", "inline-assembly"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496871427, "post_id": 44423127, "comment_id": 75844810, "body": "Are you compiling for a 68k-derived architecture? If not, why do you think <code>a</code> and <code>d</code> are address and data registers? Why do you think <code>wl</code> (which isn&#39;t even defined) is an input?"}, {"owner": {"reputation": 404, "user_id": 4531164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e236a0a41b2615a8d8a1a6adba728a35?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Pavlock", "link": "https://stackoverflow.com/users/4531164/jacob-pavlock"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496876633, "post_id": 44423127, "comment_id": 75846652, "body": "@EOF Is there anyway I can determine if my architecture is derived from 68k? Also, in the definition for mulq it stated <code>mulq S</code> has the effect of <code>R[%rdx]:R%rax] &lt;- S*R[%rax]</code> I guess I wrongfully assumed rax was part of the multiplication."}, {"owner": {"reputation": 404, "user_id": 4531164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e236a0a41b2615a8d8a1a6adba728a35?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Pavlock", "link": "https://stackoverflow.com/users/4531164/jacob-pavlock"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1496877209, "post_id": 44423127, "comment_id": 75846824, "body": "@EOF I meant <code>w0</code> instead of <code>w1</code> in my intial post, but I see my mistake now. I also mistook <code>%3</code> to mean <code>u</code> instead of <code>v</code>"}], "answers": [{"tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 3, "last_activity_date": 1496874184, "last_edit_date": 1496874184, "creation_date": 1496873850, "answer_id": 44423668, "question_id": 44423127, "link": "https://stackoverflow.com/questions/44423127/trying-to-understand-inline-assembly-code-in-c/44423668#44423668", "title": "Trying to understand inline assembly code in C", "body": "<ol>\n<li>The <code>mulq</code> instruction implicitly produces result in the <code>a</code> and <code>d</code> registers (normally known as <code>rax</code> and <code>rdx</code>)</li>\n<li>Operands are indexed from zero. <code>\"0\"</code> thus means same place as the first operand, which is <code>w0</code>. <code>mulq</code> implicitly uses <code>rax</code> as one of the input operands, hence the matching constraint. Could have written it out as <code>\"a\"</code> again.</li>\n<li><code>v</code> is the operand <code>%3</code> which is the only explicit operand referenced in the <code>mulq</code> instruction. The code multiplies <code>u</code> and <code>v</code> so of course it \"comes into play\".</li>\n</ol>\n\n<p>You printed the registers wrong, on the second line you swapped <code>w0</code> and <code>u</code>, as <code>u</code> and <code>v</code> are unchanged input operands.\n<code>u*v=w1*2^64+w0</code>, that is <code>17179869183*4611684961865433149=4294966311*2^64+13835060159816138691</code></p>\n"}], "owner": {"reputation": 404, "user_id": 4531164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e236a0a41b2615a8d8a1a6adba728a35?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Pavlock", "link": "https://stackoverflow.com/users/4531164/jacob-pavlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 44423668, "answer_count": 1, "score": -1, "last_activity_date": 1496877813, "creation_date": 1496871132, "last_edit_date": 1496877813, "question_id": 44423127, "link": "https://stackoverflow.com/questions/44423127/trying-to-understand-inline-assembly-code-in-c", "title": "Trying to understand inline assembly code in C", "body": "<p>So I have some code </p>\n\n<pre><code>#define umul_ppmm(w1, w0, u, v)                         \\\n  asm (\"mulq %3\"                                        \\\n       : \"=a\" (w0), \"=d\" (w1)                           \\\n       : \"0\" ((uint64_t)(u)), \"rm\" ((uint64_t)(v)))\n</code></pre>\n\n<p>I'm trying to debug it and understand how it works.</p>\n\n<p>Currently, I am looking at <a href=\"https://www.cs.cmu.edu/~fp/courses/15213-s07/misc/asm64-handout.pdf\" rel=\"nofollow noreferrer\">This pdf</a> for reference on <code>mulq</code>.</p>\n\n<p>My understanding so far is that it is multiplying two 64 bit numbers together which would be <code>w0</code> and <code>u</code>. Then it stores the result of that multiplication in <code>w0</code> and <code>w1</code>.</p>\n\n<p>My main questions are:</p>\n\n<ol>\n<li>According to <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html#Simple-Constraints\" rel=\"nofollow noreferrer\">This GCC assembly guide on Simple Constraints</a> 'a' and 'd' in <code>\"=a\"</code> and <code>\"=d\"</code> are address and data registers respectively. How does that play in here and what exactly does that mean?</li>\n<li>What does <code>\"0\"</code> mean in this case? That same guide says that \"An operand that matches the specified operand number is allowed.\" What would be the matching operand here?</li>\n<li>How does <code>v</code> come into play? If at all?</li>\n</ol>\n\n<p>Printing out the variables before and after the function call results in</p>\n\n<blockquote>\n  <p>w1         w0           u                    v</p>\n  \n  <p>2097147    549755813889 17179869183          4611684961865433149</p>\n  \n  <p>4294966311 17179869183  13835060159816138691 4611684961865433149</p>\n</blockquote>\n"}, {"tags": ["c", "if-statement", "logical-operators"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 3, "creation_date": 1496870612, "post_id": 44422983, "comment_id": 75844443, "body": "The first printf is undefined behavior, because you have not initialized any of the variables."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 5, "creation_date": 1496870620, "post_id": 44422983, "comment_id": 75844447, "body": "None of the variables are initialized. In the end, only <code>a</code> gets set to <code>4</code> while the others still remain uninitialized."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 3, "creation_date": 1496870660, "post_id": 44422983, "comment_id": 75844471, "body": "Use <code>==</code> to test for equality. <code>a = 4</code> assigns the value 4 to <code>a</code>."}, {"owner": {"reputation": 19688, "user_id": 3149020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001905387968/picture?type=large", "display_name": "Spencer Wieczorek", "link": "https://stackoverflow.com/users/3149020/spencer-wieczorek"}, "edited": false, "score": 1, "creation_date": 1496870675, "post_id": 44422983, "comment_id": 75844479, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2003895/in-c-what-causes-an-assignment-to-evaluate-as-true-or-false-when-used-in-a-con\">In C++ what causes an assignment to evaluate as true or false when used in a control structure?</a>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1496870675, "post_id": 44422983, "comment_id": 75844480, "body": "one equal sign assigns then returns the assigned value (so it&#39;s <code>true</code> for the first assignment, the rest is skipped)"}, {"owner": {"reputation": 2750, "user_id": 1596105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/167dc957b0dcdbdc9c2a877075ac71a2?s=128&d=identicon&r=PG", "display_name": "criticalfix", "link": "https://stackoverflow.com/users/1596105/criticalfix"}, "edited": false, "score": 2, "creation_date": 1496870779, "post_id": 44422983, "comment_id": 75844527, "body": "Only <code>a</code> gets assigned because it&#39;s a short circuit.  There&#39;s no point in looking at anything past the first <code>||</code> so those other assignments don&#39;t get executed."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 1, "creation_date": 1496870830, "post_id": 44422983, "comment_id": 75844556, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/628526/is-short-circuiting-logical-operators-mandated-and-evaluation-order\">Is short-circuiting logical operators mandated? And evaluation order?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 5, "last_activity_date": 1496870855, "creation_date": 1496870855, "answer_id": 44423067, "question_id": 44422983, "link": "https://stackoverflow.com/questions/44422983/short-circuit-evaluation-evaluating-if-a-4-b-6-c-7-d-8/44423067#44423067", "title": "Short-circuit evaluation evaluating if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )", "body": "<blockquote>\n  <p>I do not understand what if would evaluate when there is only one equal sign instead of two.</p>\n</blockquote>\n\n<p>One equal sign makes it an assignment. Hence, <code>a=4</code> evaluates to <code>4</code>, which is interpreted as \"true\" by the logical \"OR\" operator <code>||</code>. At this point no further evaluation is happening due to short-circuiting, so the remaining variables retain the values that they have prior to the <code>if</code> statement.</p>\n\n<p><strong>Note:</strong> Printing unassigned variables causes undefined behavior. You should change the declaration line as follows:</p>\n\n<pre><code>int a = 0, b = 0, c = 0, d = 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496871294, "post_id": 44423072, "comment_id": 75844754, "body": "&quot;The value is always the right hand side of the assignment.&quot;  Hmmm. Not quite.  Try <code>int i;   float f = (i = 1.23);   printf(&quot;%f\\n&quot;, f);</code> . <code>(i = 1.23)</code> evaluates to <code>(int) 1</code>."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496871386, "post_id": 44423072, "comment_id": 75844794, "body": "@chux Woah, that&#39;s neat."}], "tags": [], "owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "is_accepted": false, "score": 1, "last_activity_date": 1496871337, "last_edit_date": 1496871337, "creation_date": 1496870871, "answer_id": 44423072, "question_id": 44422983, "link": "https://stackoverflow.com/questions/44422983/short-circuit-evaluation-evaluating-if-a-4-b-6-c-7-d-8/44423072#44423072", "title": "Short-circuit evaluation evaluating if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )", "body": "<blockquote>\n  <p>So the 2nd if statement ended up being true but how?</p>\n</blockquote>\n\n<p>In C, assignments are also a sort of expression that evaluate to some value. The value is (in most situations) the right hand side of the assignment. </p>\n\n<p>In this case, <code>(a = 4)</code> evaluates to 4, which is <code>true</code> in the world of C, thus short-circuiting the entire condition and skipping the assignments for <code>b</code>, <code>c</code> and <code>d</code>. Which is why only <code>a</code> is initialised while the others retain their junk values.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1496871225, "creation_date": 1496871225, "answer_id": 44423152, "question_id": 44422983, "link": "https://stackoverflow.com/questions/44422983/short-circuit-evaluation-evaluating-if-a-4-b-6-c-7-d-8/44423152#44423152", "title": "Short-circuit evaluation evaluating if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )", "body": "<p>This call of printf</p>\n\n<pre><code>    int a, b, c, d;\n\n    printf(\"a = %d, b = %d, c = %d, d = %d\\n\", a, b, c, d);\n</code></pre>\n\n<p>has undefined behavior because variables a, b, c, and d are not initialized and have indeterminate values that can be trap values.</p>\n\n<p>In the condition of the if statement</p>\n\n<pre><code>if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )\n</code></pre>\n\n<p>there is assignment expression </p>\n\n<pre><code>a = 4\n</code></pre>\n\n<p>According to the C Standard (6.5.16 Assignment operators)</p>\n\n<blockquote>\n  <p>3 An assignment operator stores a value in the object designated by\n  the left operand. <strong>An assignment expression has the value of the left\n  operand after the assignment</strong>,111) but is not an lvalue...</p>\n</blockquote>\n\n<p>And further (6.5.14 Logical OR operator)</p>\n\n<blockquote>\n  <p>3 The || operator shall yield 1 if either of its operands compare\n  unequal to 0; otherwise, it yields 0. The result has type int.\n  4 Unlike the bitwise | operator, the || operator guarantees\n  left-to-right evaluation; if the second operand is evaluated, there is\n  a sequence point between the evaluations of the first and second\n  operands. <strong>If the first operand compares unequal to 0, the second\n  operand is not evaluated.</strong></p>\n</blockquote>\n\n<p>Thus only the assignment </p>\n\n<pre><code>a = 4\n</code></pre>\n\n<p>will be performed in this if statement</p>\n\n<pre><code>if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )\n</code></pre>\n\n<p>all other variables still will be uninitialized.</p>\n\n<p>As the value of the assignment that is 4 is not equal to 0 then the if sub-statement will be executed.</p>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1496871569, "creation_date": 1496871569, "answer_id": 44423222, "question_id": 44422983, "link": "https://stackoverflow.com/questions/44422983/short-circuit-evaluation-evaluating-if-a-4-b-6-c-7-d-8/44423222#44423222", "title": "Short-circuit evaluation evaluating if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )", "body": "<p>In short, when you compare using OR,  evaluation is done until the 1st occurrence of TRUE. So only a=4 is assigned. Rest are still uninitialized. </p>\n"}], "owner": {"reputation": 23, "user_id": 8128061, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-narc7Lapzm8/AAAAAAAAAAI/AAAAAAAAARA/yHMkXGIuco4/photo.jpg?sz=128", "display_name": "Jesse Calzada", "link": "https://stackoverflow.com/users/8128061/jesse-calzada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1496874529, "creation_date": 1496870524, "last_edit_date": 1496874529, "question_id": 44422983, "link": "https://stackoverflow.com/questions/44422983/short-circuit-evaluation-evaluating-if-a-4-b-6-c-7-d-8", "title": "Short-circuit evaluation evaluating if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )", "body": "<p>The program is posted below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a, b, c, d;\n\n    printf(\"a = %d, b = %d, c = %d, d = %d\\n\", a, b, c, d);\n\n    if( (a = 4) || (b = 6) || (c = 7) || (d = 8) )\n        printf(\"a = %d, b = %d, c = %d, d = %d\\n\", a, b, c, d);\n}\n</code></pre>\n\n<p>I understand the first printf statement but in the 2nd if statement I do not understand what it would evaluate when there is only one equal sign instead of two. </p>\n\n<p>The output is :</p>\n\n<pre><code>        a = 0, b = 0, c = 32767, d = -341260496\n        a = 4, b = 0, c = 32767, d = -341260496\n</code></pre>\n\n<p>So the 2nd if statement ended up being true but how?<br>\nI thought one equal sign would be assigning a value to the variables.</p>\n"}, {"tags": ["c", "io", "console"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1496870478, "post_id": 44422937, "comment_id": 75844382, "body": "you have to use <code>curses</code> / <code>ncurses</code> library for that. Not possible with just printf"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496870564, "post_id": 44422937, "comment_id": 75844420, "body": "&quot;Create simple display&quot;, funny title. Display something is probably is hardest thing to do in C."}, {"owner": {"reputation": 273, "user_id": 7301400, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-ikx3NlkHPok/AAAAAAAAAAI/AAAAAAAAAHI/ODfnxH6xEJ4/photo.jpg?sz=128", "display_name": "Metal Evolution Studio", "link": "https://stackoverflow.com/users/7301400/metal-evolution-studio"}, "edited": false, "score": 0, "creation_date": 1496870636, "post_id": 44422937, "comment_id": 75844458, "body": "Can you suggest me articles or libraries?"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 7301400, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-ikx3NlkHPok/AAAAAAAAAAI/AAAAAAAAAHI/ODfnxH6xEJ4/photo.jpg?sz=128", "display_name": "Metal Evolution Studio", "link": "https://stackoverflow.com/users/7301400/metal-evolution-studio"}, "edited": false, "score": 0, "creation_date": 1496871097, "post_id": 44423092, "comment_id": 75844665, "body": "What about windows?"}, {"owner": {"reputation": 273, "user_id": 7301400, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-ikx3NlkHPok/AAAAAAAAAAI/AAAAAAAAAHI/ODfnxH6xEJ4/photo.jpg?sz=128", "display_name": "Metal Evolution Studio", "link": "https://stackoverflow.com/users/7301400/metal-evolution-studio"}, "edited": false, "score": 1, "creation_date": 1496871389, "post_id": 44423092, "comment_id": 75844798, "body": "Thanks. I will be try this library"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1496871188, "last_edit_date": 1496871188, "creation_date": 1496870952, "answer_id": 44423092, "question_id": 44422937, "link": "https://stackoverflow.com/questions/44422937/create-simple-display/44423092#44423092", "title": "Create simple display", "body": "<p>I doubt it that <code>printf()</code> will help you achieve your goals. If I were you, I would give a shot with <a href=\"https://www.viget.com/articles/game-programming-in-c-with-the-ncurses-library\" rel=\"nofollow noreferrer\">Ncurses</a>. Check this question too: <a href=\"https://stackoverflow.com/questions/109855/where-can-i-find-a-complete-reference-of-the-ncurses-c-api\">Where can I find a complete reference of the ncurses C API?</a></p>\n\n<p>If this library won't satisfy you, then I would suggest <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xcurses/curses.h.html\" rel=\"nofollow noreferrer\">curses.h</a>. However I doubt this will do, since Ncurses is a modern implementation of the original curses.</p>\n\n<hr>\n\n<p>For Windows: <a href=\"https://stackoverflow.com/questions/138153/is-ncurses-available-for-windows\">Is ncurses available for windows?</a></p>\n"}], "owner": {"reputation": 273, "user_id": 7301400, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-ikx3NlkHPok/AAAAAAAAAAI/AAAAAAAAAHI/ODfnxH6xEJ4/photo.jpg?sz=128", "display_name": "Metal Evolution Studio", "link": "https://stackoverflow.com/users/7301400/metal-evolution-studio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 44423092, "answer_count": 1, "score": 0, "last_activity_date": 1496871188, "creation_date": 1496870341, "last_edit_date": 1496870972, "question_id": 44422937, "link": "https://stackoverflow.com/questions/44422937/create-simple-display", "title": "Create simple display", "body": "<p>Sorry for this simple question but I don't really understand how correctly create consol on C. I wanna have several dynamic lines that will be update. I know that I can use <code>\\r</code> but it is only for one line. I want for several lines. <code>system(\"cls\")</code> not working good for this. Maybe you can help me.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main() {\n    int currInt = 0;\n\n    while (true) {\n        system(\"cls\");\n\n        printf(\"%d\", currInt);\n\n        currInt++;\n\n        if (currInt == 5) {\n            currInt = 0;\n        }\n    }\n}\n</code></pre>\n\n\n\n<p>I will be have asynchronous input data that will be display on several lines and I need have update this screen. I think about <code>system(\"cls\")</code> but it not clear screen in loop. Endless loop is important.</p>\n"}, {"tags": ["c", "io", "format", "printf", "percentage"], "comments": [{"owner": {"reputation": 2901, "user_id": 3682217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364ca137bf3408012e52bc943eb675ec?s=128&d=identicon&r=PG&f=1", "display_name": "Shammel Lee", "link": "https://stackoverflow.com/users/3682217/shammel-lee"}, "edited": false, "score": 3, "creation_date": 1496870405, "post_id": 44422924, "comment_id": 75844350, "body": "Use two percent signs <code>%%</code>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1496870685, "post_id": 44422924, "comment_id": 75844482, "body": "actually njeeds 3 %. Two to get the % , one to get the float value"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8026400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ba2483a8c8d4788fc5c58b7ac3f8eb?s=128&d=identicon&r=PG&f=1", "display_name": "Xanthius", "link": "https://stackoverflow.com/users/8026400/xanthius"}, "edited": false, "score": 0, "creation_date": 1496870651, "post_id": 44422953, "comment_id": 75844466, "body": "Thanks I tried the double %% infront of it with the call to the float but not after thanks its working now much appreciated!!"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1496870407, "creation_date": 1496870407, "answer_id": 44422953, "question_id": 44422924, "link": "https://stackoverflow.com/questions/44422924/using-sprintf-to-print-out-stings-on-a-lcd-how-can-i-use-a-percent-sign-in-this/44422953#44422953", "title": "using sprintf to print out stings on a LCD how can i use a percent sign in this function", "body": "<p>To display the <code>%</code> character in a string created or outputted by a  printf-family function, use the <code>%%</code> escape sequence:</p>\n\n<pre><code>printf(\"Your grade is 100%% on this assignment\\n\");\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Your grade is 100% on this assignment\n</code></pre>\n\n<p>See <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">this page</a>, particularly the last entry in the first table:</p>\n\n<blockquote>\n  <p>A % followed by another % character will write a single % to the stream.  </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1496870699, "post_id": 44422970, "comment_id": 75844488, "body": "needs 3 not 2.."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1496870764, "post_id": 44422970, "comment_id": 75844518, "body": "@GovindParmar see my update is that what you are saying? Nice answer BTW of yours. If you feel like it, I can delete mine. Yes that&#39;s it pm100, thanks!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1496870717, "last_edit_date": 1496870717, "creation_date": 1496870472, "answer_id": 44422970, "question_id": 44422924, "link": "https://stackoverflow.com/questions/44422924/using-sprintf-to-print-out-stings-on-a-lcd-how-can-i-use-a-percent-sign-in-this/44422970#44422970", "title": "using sprintf to print out stings on a LCD how can i use a percent sign in this function", "body": "<p>Use <code>%%</code> like this:</p>\n\n<pre><code>sprintf(line2Str,\"TL=%%%.1f\", CurrentTemp );\n</code></pre>\n\n<p>Note that need one percentage character for the float number as well.</p>\n"}], "owner": {"reputation": 17, "user_id": 8026400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ba2483a8c8d4788fc5c58b7ac3f8eb?s=128&d=identicon&r=PG&f=1", "display_name": "Xanthius", "link": "https://stackoverflow.com/users/8026400/xanthius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "closed_date": 1496870836, "answer_count": 2, "score": 0, "last_activity_date": 1496870717, "creation_date": 1496870294, "last_edit_date": 1496870585, "question_id": 44422924, "link": "https://stackoverflow.com/questions/44422924/using-sprintf-to-print-out-stings-on-a-lcd-how-can-i-use-a-percent-sign-in-this", "closed_reason": "Duplicate", "title": "using sprintf to print out stings on a LCD how can i use a percent sign in this function", "body": "<p>Hello I am new to most coding and i am writing code onto PSoC4 creator for PSoC 3 chip that uses sprintf to display a string to LCD but my function looks like </p>\n\n<pre><code>sprintf(line1Str,\"Local T\" );           //TOP row of LCD                        \nsprintf(line2Str,\"TL=%.1f\", CurrentTemp ) //Bottom row of LCD\n</code></pre>\n\n<p>My problem is that i want to be able to display the % sign in this as well as floating point.\nI have tried the special character stuff like Char38 and so forth and leaving white space and such but it seams to skip when i have this style of format. can anyone help me?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1496870150, "post_id": 44422805, "comment_id": 75844237, "body": "Oh come on, indent the code =)"}, {"owner": {"reputation": 573, "user_id": 5598842, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Qbo8r.jpg?s=128&g=1", "display_name": "NoX", "link": "https://stackoverflow.com/users/5598842/nox"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1496870824, "post_id": 44422805, "comment_id": 75844551, "body": "It is indented ! Maybe paste result from Atom IDE displays indentation differences"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1496870862, "post_id": 44422805, "comment_id": 75844564, "body": "How are you supposed to treat cells that border the 10x10 grid (those on the outside). Are they to be considered at all? Currently <code>getNeighborValue</code> appears to treat them all as dead. I don&#39;t know if this is correct, it seems like they should not be considered at all. Just a thought. FYI @gsamaras was jokingly comparing the 2-char and 4-char indentation (and noting that old farts have more difficulty with 2-char indentation due to aging eyes...)"}, {"owner": {"reputation": 573, "user_id": 5598842, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Qbo8r.jpg?s=128&g=1", "display_name": "NoX", "link": "https://stackoverflow.com/users/5598842/nox"}, "edited": false, "score": 0, "creation_date": 1496870956, "post_id": 44422805, "comment_id": 75844601, "body": "You&#39;re right, thanks for pointing this. I have to investigate here at first and treat DEAD but LIVE cells as well. Thanks ! About cells outside the grid, it is not asked, so I suppose not. It should be hard to do it if it was needed so."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 4, "creation_date": 1496871186, "post_id": 44422805, "comment_id": 75844706, "body": "It looks like you are updating the grid and counting neighbors at the same time. You need to collect all information about neighbors before you begin updating. One solution is to add a <code>neighbor_count</code> field to your <code>Cell</code> <code>struct</code>; the entire grid can be traversed, updating the <code>neighbor_count</code>s, and then the update can occur. Otherwise the counts will change as you modify the grid."}, {"owner": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "edited": false, "score": 1, "creation_date": 1496903834, "post_id": 44422805, "comment_id": 75854572, "body": "It&#39;s easiest (though not very memory efficient) to have 2 grids and generate each cell on the 2nd grid according to the rules, then swap grids."}], "answers": [{"tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": false, "score": 1, "last_activity_date": 1496909602, "creation_date": 1496909602, "answer_id": 44430202, "question_id": 44422805, "link": "https://stackoverflow.com/questions/44422805/conway-game-of-life-weird-results/44430202#44430202", "title": "Conway Game Of Life Weird Results", "body": "<p>I think, you have a major mis-understanding:</p>\n\n<p>In C: <code>struct</code>s are passed to functions <strong>by value</strong> (i.e. by copy, in opposition to arrays which are always passed \"<em>by reference</em>\" &ndash; actually, by it's start address). This is true even in your case where the struct contains an array.</p>\n\n<p>I took some code of your sample to demonstrate this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum {\n  NEW = '0',\n  LIVE = '+',\n  DEAD = '-'\n};\n\ntypedef struct {\n  char status;\n} Cell;\n\nenum { xSize = 3, ySize = 3 };\n\ntypedef struct {\n  int sizeX, sizeY;\n  Cell cell[ySize][xSize];\n} World;\n\nvoid displayWorld(World world)\n{\n  for (int y = 0; y &lt; ySize; ++y) {\n    for (int x = 0; x &lt; xSize; ++x) printf(\"+-\");\n    printf(\"+\\n\");\n    for (int x = 0; x &lt; xSize; ++x) {\n      printf(\"|%c\", world.cell[y][x].status);\n    }\n    printf(\"|\\n\");\n  }\n  for (int x = 0; x &lt; xSize; ++x) printf(\"+-\");\n  printf(\"+\\n\");\n}\n\nvoid modifyWorld(World world, int x, int y, char status)\n{\n  world.cell[y][x].status = status;\n  printf(\"Modified:\\n\");\n  displayWorld(world);\n}\n\nint main()\n{\n  World world = {\n    xSize, ySize\n  };\n  /* init world */\n  for (int y = 0; y &lt; ySize; ++y) {\n    for (int x = 0; x &lt; xSize; ++x) world.cell[y][x].status = NEW;\n  }\n  /* display world */\n  printf(\"Before call of modifyWorld():\\n\");\n  displayWorld(world);\n  /* modify world */\n  modifyWorld(world, xSize / 2, ySize / 2, LIVE);\n  /* display world */\n  printf(\"After call of modifyWorld():\\n\");\n  displayWorld(world);\n  /* done */\n  return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Before call of modifyWorld():\n+-+-+-+\n|0|0|0|\n+-+-+-+\n|0|0|0|\n+-+-+-+\n|0|0|0|\n+-+-+-+\nModified:\n+-+-+-+\n|0|0|0|\n+-+-+-+\n|0|+|0|\n+-+-+-+\n|0|0|0|\n+-+-+-+\nAfter call of modifyWorld():\n+-+-+-+\n|0|0|0|\n+-+-+-+\n|0|0|0|\n+-+-+-+\n|0|0|0|\n+-+-+-+\nDr\u00fccken Sie eine beliebige Taste . . .\n</code></pre>\n\n<p>This shows that <code>modifyWorld()</code> does change its local copy but not the original <code>world</code> declared in <code>main()</code>.</p>\n\n<p>To change this, the 1<sup>st</sup> parameter had to become a <code>World *world</code>.\nAccordingly, its contents had to be accessed by <code>-&gt;</code> instead of <code>.</code>, e.g.</p>\n\n<pre><code>world-&gt;cell[y][x].status = status;\n</code></pre>\n\n<p><strong>This affects your function <code>clearWorld()</code> exclusively.</strong></p>\n\n<p>Every other function of your sample uses a \"functional approach\" returning changed local copies as result which is assigned on caller site.</p>\n\n<p>This is not very C-stylish and inefficient but it's working correctly (concerning the storage).</p>\n\n<p>Considering this and what's suggested by the comments about updating of states you should be able to master it.</p>\n"}], "owner": {"reputation": 573, "user_id": 5598842, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Qbo8r.jpg?s=128&g=1", "display_name": "NoX", "link": "https://stackoverflow.com/users/5598842/nox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496909602, "creation_date": 1496869755, "last_edit_date": 1496897516, "question_id": 44422805, "link": "https://stackoverflow.com/questions/44422805/conway-game-of-life-weird-results", "title": "Conway Game Of Life Weird Results", "body": "<p>for a homework, I have to reproduce Conway's Game of Life project.</p>\n\n<p>Unfortunately, I got weird result, I suppose because C language is new to me, I'm more focus on php recently.</p>\n\n<p>First I give the specs of the project : </p>\n\n<pre><code> * The Game of Life\n * http://en.wikipedia.org/wiki/Conway's_Game_of_Life\n *\n * Key requirements :\n * - Limit the size of the world to 10x10 cells\n * - The world (grid) must be a struct composed by cells\n * - A cell must be a struct\n * - Each cell is in one of two possible states : Live or Dead\n * - Any live cell with fewer than two live neighbours dies, as if caused by under-population\n * - Any live cell with two or three live neighbours lives on to the next generation\n * - Any live cell with more than three live neighbours dies, as if by overcrowding\n * - Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction\n * - Between each generation, ask if it's necessary to restart the next generation or to leave the game\n * - Having dedicated function displayWorld() to display a representation of this world\n * - Having dedicated function newGeneration() to generate next step of the world\n * - In the function above, implement conditions based on cell's neighbors to define if each cell is alive or dead\n * - Alive cells are represented by a \"+\"\n * - Dead cells are represented by a \"-\"\n * - New borned cells are represented by a \"0\"\n */\n</code></pre>\n\n<p>To give more details on the weird result I get : </p>\n\n<ul>\n<li>I have hardcoded values from loadInitData function but sometime it display a 0 lost somewhere in the grid in a random location I <strong>* never *</strong> specified...</li>\n<li>Quickly, the Conway Game's of Life terminate quickly, and any live cells disappears</li>\n</ul>\n\n<p>I'm sure some bad habits have been used by myself and I'm ready to hear about more experienced developer that could point out what I've missed or did badly.</p>\n\n<p>I'm close to the result (I'm sure of it !) so thanks for any help brought here.</p>\n\n<p>Here is the code of my homework project.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define NEW '0'\n#define LIVE '+'\n#define DEAD '-'\n#define xSize 10\n#define ySize 10\n\ntypedef struct {\n    char status;\n} Cell;\n\ntypedef struct {\n    int sizeX;\n    int sizeY;\n    Cell cell[xSize][ySize];\n} World;\n\nvoid displayWorld(World grid) {\n    int x, y;\n    for (y = 0; y &lt; grid.sizeY; y++) {\n        for (x = 0; x &lt; grid.sizeX; x++) {\n            if (grid.cell[y][x].status == NEW) {\n                printf(\"0\");\n            } else if (grid.cell[y][x].status == LIVE) {\n                printf(\"+\");\n            } else {\n                printf(\"-\");\n            }\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n}\n\nint getNeighborValue(World grid, int row, int col) {\n    if (row &lt; 0 || row &gt;= grid.sizeY\n            || col &lt; 0 || col &gt;= grid.sizeX\n            || grid.cell[row][col].status != LIVE )\n    {\n        return 0;\n    } else {\n        return 1;\n    }\n}\n\nint getNeighborCount(World grid, int row, int col) {\n    int neighbor = 0;\n\n    neighbor += getNeighborValue(grid, row - 1, col - 1);\n    neighbor += getNeighborValue(grid, row - 1, col);\n    neighbor += getNeighborValue(grid, row - 1, col + 1);\n    neighbor += getNeighborValue(grid, row, col - 1);\n    neighbor += getNeighborValue(grid, row, col + 1);\n    neighbor += getNeighborValue(grid, row + 1, col - 1);\n    neighbor += getNeighborValue(grid, row + 1, col);\n    neighbor += getNeighborValue(grid, row + 1, col + 1);\n\n    return neighbor;\n}\n\nWorld newGeneration(World grid) {\n    int neighbor, x, y;\n\n    for (y = 0; y &lt; grid.sizeY; y++) {\n        for (x = 0; x &lt; grid.sizeX; x++) {\n            neighbor = getNeighborCount(grid, y, x);\n\n            if (grid.cell[y][x].status == NEW || grid.cell[y][x].status == LIVE) {\n                if (neighbor &gt; 3) {\n                    grid.cell[y][x].status = DEAD;\n                } else if (neighbor == 2 || neighbor == 3) {\n                    grid.cell[y][x].status = LIVE;\n                } else {\n                    grid.cell[y][x].status = DEAD;\n                }\n            } else {\n                if (neighbor == 3) {\n                    grid.cell[y][x].status = NEW;\n                }\n            }\n        }\n    }\n\n    return grid;\n}\n\nvoid clearWorld(World grid) {\n    int x, y;\n    for (y = 0; y &lt; grid.sizeY; y++) {\n        for (x = 0; x &lt; grid.sizeX; x++) {\n            Cell cell;\n            cell.status = DEAD;\n            grid.cell[y][x] = cell;\n        }\n    }\n}\n\nWorld loadInitData(World grid) {\n    int x, y, i, n, v;\n\n    printf(\"Enter the amount of initial organisms: \");\n    scanf(\"%d\", &amp;n);\n\n    printf(\"Would you like organisms randomly generated or defined by you (0: random; 1: you)? \");\n    scanf(\"%d\", &amp;v);\n\n    if (v == 1) {\n        for (i = 0; i &lt; n; i++) {\n            printf(\"Enter dimensions (x y) where organism %d will live: \", i + 1);\n            scanf(\"%d %d\", &amp;x, &amp;y);\n            grid.cell[y][x].status = LIVE;\n        }\n    } else {\n        // for (i = 0; i &lt; n; i++) {\n        //  x = rand() % grid.sizeX;\n        //  y = rand() % grid.sizeY;\n        //  grid.cell[y][x].status = LIVE;\n        // }\n\n        grid.cell[3][4].status = LIVE;\n        grid.cell[3][5].status = LIVE;\n        grid.cell[3][6].status = LIVE;\n        grid.cell[6][4].status = LIVE;\n        grid.cell[6][5].status = LIVE;\n        grid.cell[6][6].status = LIVE;\n        grid.cell[7][6].status = LIVE;\n        grid.cell[8][5].status = LIVE;\n    }\n\n    return grid;\n}\n\nint main() {\n    World grid;\n    grid.sizeX = xSize;\n    grid.sizeY = ySize;\n    char end;\n    int generation = 0;\n    clearWorld(grid);\n    grid = loadInitData(grid);\n    displayWorld(grid);\n    printf(\"Generation %d\\n\", 0);\n    printf(\"Press q to quit or 1 to continue: \");\n    scanf(\" %c\", &amp;end);\n\n    do {\n        grid = newGeneration(grid);\n        displayWorld(grid);\n        printf(\"Generation %d\\n\", ++generation);\n        printf(\"Press q to quit or 1 to continue: \");\n        scanf(\" %c\", &amp;end);\n    } while (end != 'q') ;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pipe"], "comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1496867964, "post_id": 44422206, "comment_id": 75843229, "body": "why are you doing like this. <code>char str[13]=&quot;Hello World\\0&quot;;</code> you don&#39;t need to add null termination with quotes, it&#39;s already added if you use double quotes."}, {"owner": {"reputation": 1288, "user_id": 6063416, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zTPqR.jpg?s=128&g=1", "display_name": "SnuKies", "link": "https://stackoverflow.com/users/6063416/snukies"}, "reply_to_user": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1496867993, "post_id": 44422206, "comment_id": 75843243, "body": "sorry, that was just something desperate"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496869190, "post_id": 44422206, "comment_id": 75843828, "body": "@SnuKies You don&#39;t even need to put the size <code>char str[] = &quot;Hello World&quot;;</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1496872543, "post_id": 44422206, "comment_id": 75845205, "body": "<code>read()</code> returns a value. Use it!"}], "answers": [{"tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 2, "last_activity_date": 1496871466, "last_edit_date": 1496871466, "creation_date": 1496869493, "answer_id": 44422744, "question_id": 44422206, "link": "https://stackoverflow.com/questions/44422206/simple-pipe-program-does-reads-strange-characters/44422744#44422744", "title": "Simple PIPE program does reads strange characters", "body": "<p>Your main problem is that you create your pipe <strong>after</strong> that you fork your process.</p>\n\n<pre><code>int cp[2];\nint res = pipe(cp); // create the pipe before\nif (res == -1) {\n    perror(\"pipe()\");\n    return 1;\n}\npid_t pid = fork(); // so child and parent share the same pipe\nif (pid == -1) {\n    perror(\"fork()\");\n    return 1;\n}\n</code></pre>\n\n<p><a href=\"http://tldp.org/LDP/lpg/node11.html\" rel=\"nofollow noreferrer\">A tutorial</a> about pipe grant by codekaizer.</p>\n\n<hr>\n\n<p><code>read()</code> is used to read bytes from a file descriptor. It will not add a nul byte at the end of the buffer.</p>\n\n<p>You must put it yourself:</p>\n\n<pre><code>char received[42];\nssize_t n = read(cp[0], received, sizeof received - 1);\nif (n == -1) {\n    perror(\"read()\");\n    return 1;\n}\nreceived[n] = '\\0';\nprintf(\"%s\\n\", received);\n</code></pre>\n"}], "owner": {"reputation": 1288, "user_id": 6063416, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zTPqR.jpg?s=128&g=1", "display_name": "SnuKies", "link": "https://stackoverflow.com/users/6063416/snukies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 44422744, "answer_count": 1, "score": 0, "last_activity_date": 1496871466, "creation_date": 1496867391, "last_edit_date": 1496868004, "question_id": 44422206, "link": "https://stackoverflow.com/questions/44422206/simple-pipe-program-does-reads-strange-characters", "title": "Simple PIPE program does reads strange characters", "body": "<p>I have created a straightforward program with processes that does one very basic thing: the child writes, the father reads.\nStrangely, the father only read strange characters and I do not know why (I've been trying for past hour to deduct why, but no success.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// cp = Child -&gt; Parent,  pc = Parent -&gt; child\nint cp[2], pc[2];\nint main (){\n    char str[13]=\"Hello World\";\n    char received[13];\n    pid_t pid;\n    pid = fork();\n    if (pid == -1){\n        printf(\"An error occured!\\n\");\n        exit(1);\n    }\n    int res = pipe(cp);\n    if (res == -1){\n        printf(\"Error when creating pipe!..\\n\");\n        exit(1);\n    }\n    //pipe(pc);\n    if (pid==0){\n        // Child process\n        close(cp[0]);\n        write(cp[1], str, 10);\n        close(cp[1]);\n        exit(0);\n    }else{\n        // Parent process\n        close(cp[1]);\n        read(cp[0], received, 10);\n        close(cp[0]);\n        printf(\"We received from child: %s\\n\", received);\n        exit(1);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Examples of outputs:\n1) We received from child: @\n2) We received from child: \ufffdXCV\ufffd</p>\n"}, {"tags": ["java", "c", "jvm", "java-native-interface"], "comments": [{"owner": {"reputation": 77832, "user_id": 3448419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54njx.png?s=128&g=1", "display_name": "apangin", "link": "https://stackoverflow.com/users/3448419/apangin"}, "edited": false, "score": 0, "creation_date": 1496873283, "post_id": 44422146, "comment_id": 75845520, "body": "To call a native method, HotSpot JVM enters a runtime stub (the fragment of machine code generated at VM startup). This runtime stub performs all the required JNI stuff - the procedure is described <a href=\"https://stackoverflow.com/a/24747484/3448419\">here</a>."}, {"owner": {"reputation": 77832, "user_id": 3448419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54njx.png?s=128&g=1", "display_name": "apangin", "link": "https://stackoverflow.com/users/3448419/apangin"}, "edited": false, "score": 0, "creation_date": 1496873617, "post_id": 44422146, "comment_id": 75845658, "body": "The sources for calling native methods from interpreter are in <a href=\"http://hg.openjdk.java.net/jdk8u/jdk8u/hotspot/file/4d9931ebf861/src/cpu/x86/vm/templateInterpreter_x86_64.cpp#l960\" rel=\"nofollow noreferrer\"><code>InterpreterGenerator::generate_native_entry</code></a>, or <a href=\"http://hg.openjdk.java.net/jdk8u/jdk8u/hotspot/file/4d9931ebf861/src/cpu/x86/vm/sharedRuntime_x86_64.cpp#l1723\" rel=\"nofollow noreferrer\"><code>SharedRuntime::generate_native_wrapper</code></a> for calling native methods from JIT-compiled code."}, {"owner": {"reputation": 77832, "user_id": 3448419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54njx.png?s=128&g=1", "display_name": "apangin", "link": "https://stackoverflow.com/users/3448419/apangin"}, "edited": false, "score": 0, "creation_date": 1496873692, "post_id": 44422146, "comment_id": 75845687, "body": "The above is true for HotSpot JVM. Other JVMs may do this differently."}], "answers": [{"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 1, "last_activity_date": 1496869592, "creation_date": 1496869592, "answer_id": 44422772, "question_id": 44422146, "link": "https://stackoverflow.com/questions/44422146/internally-called-jvm-functions-upon-jni/44422772#44422772", "title": "Internally called JVM functions upon JNI", "body": "<p>If you want to take a look at exact chain of execution I suggest to connect to JVM using gdb (or CLion) and take a look at backtrace.</p>\n\n<p>Take a look here to see how to do it:</p>\n\n<p><a href=\"http://www.owsiak.org/?p=2095\" rel=\"nofollow noreferrer\">http://www.owsiak.org/?p=2095</a></p>\n\n<p>You can also take a look here:</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=8Cjeq4l5COU\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=8Cjeq4l5COU</a></p>\n\n<p>Once you are attached to JVM, you can set breakpoint in your C code and check the backtrace from top to bottom.</p>\n\n<p>Alternatively, you can create SIGSEGV and generate full backtrace of JVM (take a look here: <a href=\"http://jnicookbook.owsiak.org/recipe-No-015/\" rel=\"nofollow noreferrer\">http://jnicookbook.owsiak.org/recipe-No-015/</a>)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user277465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1496872753, "answer_count": 1, "score": 0, "last_activity_date": 1496869592, "creation_date": 1496867125, "last_edit_date": 1496867340, "question_id": 44422146, "link": "https://stackoverflow.com/questions/44422146/internally-called-jvm-functions-upon-jni", "closed_reason": "Duplicate", "title": "Internally called JVM functions upon JNI", "body": "<p>When a method defined in C is called from Java (using JNI), what are the methods that are invoked inside the JVM? What does the execution flow look like?</p>\n\n<ol>\n<li>i.e. consider a method <code>public native void display()</code>. When this method is called from the java code as <code>object.display()</code>, what are the internal JVM methods that are called as execution proceeds towards the native code?</li>\n<li>Where can I find more documentation about this? Alternatively, which JVM function in the source can I look at and trace?</li>\n</ol>\n"}, {"tags": ["c", "geotiff"], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 3543535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001528491784/picture?type=large", "display_name": "FelipeBrubeck", "link": "https://stackoverflow.com/users/3543535/felipebrubeck"}, "is_accepted": false, "score": 0, "last_activity_date": 1497370465, "creation_date": 1497370465, "answer_id": 44526711, "question_id": 44421963, "link": "https://stackoverflow.com/questions/44421963/how-to-interpret-geotiff-strip-data-with-geotiff/44526711#44526711", "title": "How to interpret geotiff strip data with geotiff", "body": "<p>I got access to the actual pixel values in the image using this code:</p>\n\n<pre><code>TIFFReadEncodedStrip(tif,strip,buf, (tsize_t) -1);  \nuint16_t *p16;\np16 = (uint16_t *) buf;\nprintf(\"Strip: %d\\n\", strip);\nint i = 0;\nfor (i; i &lt; 64; i++) {      // the strip buffer is *length* elements long\n    printf(\"%d: %u\\n\", i+1, p16[i]);\n}\n</code></pre>\n\n<p>The key was casting the buffer to <code>uint16_t*</code>. This shows the pixel values as something understandable for humans.</p>\n"}], "owner": {"reputation": 45, "user_id": 3543535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001528491784/picture?type=large", "display_name": "FelipeBrubeck", "link": "https://stackoverflow.com/users/3543535/felipebrubeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497370465, "creation_date": 1496866306, "last_edit_date": 1497370281, "question_id": 44421963, "link": "https://stackoverflow.com/questions/44421963/how-to-interpret-geotiff-strip-data-with-geotiff", "title": "How to interpret geotiff strip data with geotiff", "body": "<p>I'm working on a code that needs to read a 4-channel geotiff image, in this case a 16-bit image (data is actually 12-bit resolution, but is encoded in 16-bit). </p>\n\n<p>My main objective is to read pixel values to use them later.\nFrom this question <a href=\"https://stackoverflow.com/questions/16034121/tiff-images-how-16bits-rgba-image-pixels-are-interlaced\">\"How 16bits-RGBA image pixels are interlaced?\"</a> I tried to use TIFFReadEncodedStrip instead of TIFFRGBAImage like this:</p>\n\n<pre><code>buf = (unsigned char*)(_TIFFmalloc(TIFFStripSize(tif)));\nTIFFReadEncodedStrip(tif,strip,buf,(tsize_t)-1);\nuint32 *p0 = buf;\nprintf(\"strip %d = %d \\n\", strip, *p0);\n</code></pre>\n\n<p>and for the p0 value that I print, which is supposed to be the actual image data, I got this:</p>\n\n<pre><code>strip 0 = 20382000\n</code></pre>\n\n<p>Checking the tags in my image I have found:</p>\n\n<pre><code>Rows per strip: 1  \nSamples per pixel: 4  \nBits per sample: 16 \nImage orientation: 1 (bottom left)  \nSize of buffer: 8 bytes\n</code></pre>\n\n<p>So my assumption is that the p0 value I'm getting from the buffer, are the four first pixels in the top left corner in the first channel of the image.\nWhat I don't understand is how do I have to interpret the values of the p0 strip I got.</p>\n\n<p>Opening the image in matlab and checking the first pixel (top-left) in each channel I got 304, 311, 314 and 314, which doesn't seem to be anything on the p0 value I'm getting.</p>\n\n<p>I don't know if it's because of the 12-bit resolution, or if I have to convert it to a type other than uint32, but I just can't make sense of that number. </p>\n\n<p>Can somebody help to decipher this number and if it corresponds to the first four pixels in the bottom left corner?</p>\n"}, {"tags": ["c", "numerical-methods", "symbolic-math", "differentiation", "automatic-differentiation"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1496865622, "post_id": 44421662, "comment_id": 75842054, "body": "I might be missing something but if you only handle polynomial functions, it&#39;s straight forward to find the differential function. aX^n -&gt; naX^n-1"}, {"owner": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496865984, "post_id": 44421662, "comment_id": 75842223, "body": "My apologies, post edited. They mostly contain polynomial but can contain other more complex expressions"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1496866556, "post_id": 44421662, "comment_id": 75842526, "body": "How to the trigs and logs appear? Are there trig functions of polynomials, or  logarithms of polynomials, etc.? (e.g. is this the complete space of functions involving x, sin(a+b<i>x), cos(a+b</i>x) and log(a+b*x) under a finite number of addition and multiplication steps)? Or are they simple trigs, logs -- maybe the space of functions of powers of x, simple trigs, and simple logs complete under addition?"}, {"owner": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "edited": false, "score": 0, "creation_date": 1496866840, "post_id": 44421662, "comment_id": 75842674, "body": "In short, yes to all of the above, i.e. the chain rule will need to be applied to evaluate it. That is, trig functions can contain polynomials, e.g. sin(2x^2 + 3x) and logarithmic may contain polynomial, e.g. ln|2x^2|. Correct, a complete space of functions involving polynomial, trig and log"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1496867083, "post_id": 44421662, "comment_id": 75842789, "body": "If you were using C++ you could create classes for the various function types (e.g. Polynomial, Sin, Cos, Log, Sum, Product, Composition) and specialize the value and derivative operators to apply whatever rule (e.g. chain rule for the derivative operator in Composition) is needed. Maybe doing something similar in plain C is possible, overloading functions on structs?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1496867099, "post_id": 44421662, "comment_id": 75842797, "body": "Identify pure polynomial functions and handle them as a special case as the differential function is easy to calculate. For more complex function I&#39;m not sure but I guess I would start out trying the numerical approach"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1496868923, "post_id": 44421662, "comment_id": 75843716, "body": "For clarification purposes, <i>&quot;How do you have these thousands of functions stored?&quot;</i> As a general proposition, symbolic differentiation is generally more computationally intensive from the standpoint of chain rule application and lookup of the trig derivatives. But it is really hard to say without some understanding of how you have the functions stored. @jwimberley covers the case for polynomials, but you would need some type of lookup/replacement table for the trig functions. There numeric seems like it would be the choice. Hard to say without a few examples."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496870213, "post_id": 44421662, "comment_id": 75844268, "body": "&quot;quickest time possible&quot; is often a trade-off with accuracy.  Knowing that relative importance is needed for a quality answer."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1496960615, "post_id": 44421662, "comment_id": 75890450, "body": "What is the &quot;automatic&quot; mode ? Isn&#39;t that an instance of a numerical method ?"}, {"owner": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496998139, "post_id": 44421662, "comment_id": 75902967, "body": "@DavidC.Rankin and chux. To be honest, I don&#39;t have exact specifications on the storage method and what acceptable accuracy is required at this very stage. I will define this more clearly in the coming month and give better clarity."}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "edited": false, "score": 0, "creation_date": 1496865992, "post_id": 44421784, "comment_id": 75842225, "body": "My apologies, post edited. They mostly contain polynomial but can contain other more complex expressions"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496866377, "post_id": 44421784, "comment_id": 75842429, "body": "@4386427 In C, yes; I wasn&#39;t writing this with any programming language in mind. I wish stackoverflow allowed LaTeX."}], "tags": [], "owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "is_accepted": false, "score": 2, "last_activity_date": 1496866655, "last_edit_date": 1496866655, "creation_date": 1496865682, "answer_id": 44421784, "question_id": 44421662, "link": "https://stackoverflow.com/questions/44421662/computational-efficiency-of-forward-mode-automatic-vs-numeric-vs-symbolic-differ/44421784#44421784", "title": "Computational Efficiency of Forward Mode Automatic vs Numeric vs Symbolic Differentiation", "body": "<p>If your functions are truly all polynomials, then symbolic derivatives are dirt simple. Letting the coefficients of the polynomial be stored in an array with entries <code>p[k] = a_k</code>, where index k corresponds to the coefficient of x^k, then the derivative is represented by the array with entries <code>dp[k] = (k+1) p[k+1]</code>. For multivariable polynomial, this extends straightforwardly to multidimensional arrays. If your polynomials are not in standard form, e.g. if they include terms like <code>(x-a)^2</code> or <code>((x-a)^2-b)^3</code> or whatever, a little bit of work is needed to transform them into standard form, but this is something you probably should be doing anyways.</p>\n"}, {"comments": [{"owner": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "edited": false, "score": 0, "creation_date": 1496997903, "post_id": 44446590, "comment_id": 75902825, "body": "Upvoted for the regula falsi suggestion - never heard of it. Im really curious as to what method the proprietary software packages use like Matlab"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "edited": false, "score": 0, "creation_date": 1496998134, "post_id": 44446590, "comment_id": 75902963, "body": "@DeanP: most probably much more sophisticated methods with bracketing and handling of multiple roots."}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 1, "last_activity_date": 1496961150, "creation_date": 1496961150, "answer_id": 44446590, "question_id": 44421662, "link": "https://stackoverflow.com/questions/44421662/computational-efficiency-of-forward-mode-automatic-vs-numeric-vs-symbolic-differ/44446590#44446590", "title": "Computational Efficiency of Forward Mode Automatic vs Numeric vs Symbolic Differentiation", "body": "<p>If the derivative is not available, you should consider using the secant or regula falsi methods. They have very decent convergence speed (\u03c6-order instead of quadratic). An additional benefit of regula falsi, is that the iterations remains confined to the initial interval, which allows reliable root separation (which Newton does not).</p>\n\n<p>Also note than in the case of numerical evaluation of the derivatives, you will require several computations of the functions, at best two of them. Then the actual convergence speed drops to \u221a2, which is outperformed by the derivative-less methods.</p>\n\n<p>Also note that the symbolic expression of the derivatives is often more costly to evaluate than the functions themselves. So one iteration of Newton costs at least two function evaluations, spoiling the benefit of the convergence rate.</p>\n"}], "owner": {"reputation": 634, "user_id": 5959372, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c820adfadf29dae95fc4edec8b099be?s=128&d=identicon&r=PG&f=1", "display_name": "Dean P", "link": "https://stackoverflow.com/users/5959372/dean-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496961150, "creation_date": 1496865199, "last_edit_date": 1496865957, "question_id": 44421662, "link": "https://stackoverflow.com/questions/44421662/computational-efficiency-of-forward-mode-automatic-vs-numeric-vs-symbolic-differ", "title": "Computational Efficiency of Forward Mode Automatic vs Numeric vs Symbolic Differentiation", "body": "<p>I am trying to solve a problem of finding the roots of a function using the Newton-Raphson (NR) method in the C language. The functions in which I would like to find the roots are mostly polynomial functions but may also contain trigonometric and logarithmic.</p>\n\n<p>The NR method requires finding the differential of the function. There are 3 ways to implement differentiation:</p>\n\n<ul>\n<li>Symbolic</li>\n<li>Numerical</li>\n<li>Automatic (with sub types being forward mode and reverse mode. For this particular question, I would like to focus on forward mode)</li>\n</ul>\n\n<p>I have thousands of these functions all requiring finding roots in the quickest time possible.</p>\n\n<p>From the little that I do know, Automatic differentiation is in general quicker than symbolic because it handles the problem of \"expression swell\" alot more efficiently.</p>\n\n<p>My question therefore is, all other things being equal, which method of differentiation is more computationally efficient: Automatic Differentiation (and more specifically, forward mode) or Numeric differentiation?</p>\n"}, {"tags": ["c", "arrays", "pointers", "structure", "scanf"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496863868, "post_id": 44421212, "comment_id": 75841041, "body": "Note that it&#39;s the last name to be read that is preserved. Because you didn&#39;t save the names separately; you just copy the pointer to <code>inName</code> into the structure, rather than allocating space and making a copy of the name.  Since <code>inName</code> is a local variable to the read function, you&#39;ll also find that the names get corrupted, sooner rather than later.  You should show the structure definition too, though it is clear that you have a <code>char *</code> for the name in the structure."}], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 6738620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4780456b21156064cae972f3fef417?s=128&d=identicon&r=PG&f=1", "display_name": "Cioaca Radu", "link": "https://stackoverflow.com/users/6738620/cioaca-radu"}, "is_accepted": true, "score": 2, "last_activity_date": 1496880024, "last_edit_date": 1496880024, "creation_date": 1496865266, "answer_id": 44421679, "question_id": 44421212, "link": "https://stackoverflow.com/questions/44421212/c-fscanf-error-with-char/44421679#44421679", "title": "C - fscanf error with char *", "body": "<p>the problem is that you read the first name and after that for every warrior in the file you just set a pointer to that first name. For every element from your file you must allocate new memory for it's name (using malloc) and copy the new name into it( using strcpy). Because you declared the name char*</p>\n\n<pre><code>warrior createWarrior(int inHp, int inColor, int inUniverse, char * inName){\n\n    warrior guerrero; \n    guerrero.hp = inHp;\n    guerrero.color = inColor;\n    guerrero.universe = inUniverse;\n\n    guerrero.name = malloc(sizeof(char) * 30); // 30 is the length of the name\n\n    strcpy(guerrero.name,inName); // copy new name \n    guerrero.posX= 0;\n    guerrero.posY= 0;\n    guerrero.ki=0;\n\n    return guerrero;\n\n}\n</code></pre>\n\n<p>There is another cool way to do it using strdup() which basically alocates new memory and copy the parameter string there ( but i've not tested this):</p>\n\n<pre><code>warrior createWarrior(int inHp, int inColor, int inUniverse, char * inName){\n\n    warrior guerrero; \n    guerrero.hp = inHp;\n    guerrero.color = inColor;\n    guerrero.universe = inUniverse;\n\n    guerrero.name = strdup(inName);\n    guerrero.posX= 0;\n    guerrero.posY= 0;\n    guerrero.ki=0;\n\n    return guerrero;\n\n}\n</code></pre>\n\n<p>Don't forget: </p>\n\n<pre><code>#include &lt;string.h&gt; \n#include &lt;stdlib.h&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 7593451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be3e2693e068372678d739f1bb74599?s=128&d=identicon&r=PG&f=1", "display_name": "Sokre", "link": "https://stackoverflow.com/users/7593451/sokre"}, "is_accepted": false, "score": 1, "last_activity_date": 1496865491, "creation_date": 1496865491, "answer_id": 44421732, "question_id": 44421212, "link": "https://stackoverflow.com/questions/44421212/c-fscanf-error-with-char/44421732#44421732", "title": "C - fscanf error with char *", "body": "<p>All of your input from scanf is written to the same memory location given for inName[50]. In each iterration you are overwritting the content, but assigning the same address to the guerrero.name. And when you print out, you get last entry printed.</p>\n\n<p>You may try this:</p>\n\n<pre><code>warrior createWarrior(int inHp, int inColor, int inUniverse, char * inName){\n...\nguerrero.name = strdup(inName);\n....\nreturn guerrero;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8127626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37faed7fbd5b4c064f417746a2208da4?s=128&d=identicon&r=PG&f=1", "display_name": "F. Retamal", "link": "https://stackoverflow.com/users/8127626/f-retamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 44421679, "answer_count": 2, "score": 2, "last_activity_date": 1496880140, "creation_date": 1496863485, "last_edit_date": 1496880140, "question_id": 44421212, "link": "https://stackoverflow.com/questions/44421212/c-fscanf-error-with-char", "title": "C - fscanf error with char *", "body": "<p>I'm trying to read a txt file with this format:</p>\n\n<pre><code>8590 2 07 Goku\n8591 2 07 Vegeta\n6973 2 07 Picolo\n5432 3 02 Jerez\n6773 3 02 Sour\n4689 4 03 Mosco\n6981 5 06 Cabba\n7891 5 06 Frost\n</code></pre>\n\n<p>The columns are: hp, universe color, universe number and name. What I do is this read the line and save the parameters in an array of structures called warrior with this format: </p>\n\n<pre><code>typedef struct Warrior{\n    int hp;\n    int color;\n    int universe;\n    char * name;\n    int posX;\n    int posY;\n    int ki;\n} warrior;\n\nwarrior createWarrior(int inHp, int inColor, int inUniverse, char * inName){\n    warrior guerrero; \n    guerrero.hp = inHp;\n    guerrero.color = inColor;\n    guerrero.universe = inUniverse;\n    guerrero.name = inName;\n    guerrero.posX= 0;\n    guerrero.posY= 0;\n    guerrero.ki=0;\n    return guerrero;\n}\n</code></pre>\n\n<p>The readFile code is: </p>\n\n<pre><code>warrior * readFile(char * nameFile, warrior * listGuerrero){\n    FILE * filePointer;\n    int sizeFile = 0, ch = 0;\n    int inHp, inColor, inUniverse;\n    char inName[50];\n\n    filePointer = fopen(nameFile, \"r\");\n\n    while(fscanf(filePointer, \"%d %d %d %s\\n\", &amp;inHp, &amp;inColor, &amp;inUniverse, inName) != EOF){\n        sizeFile ++;\n    }\n\n    rewind(filePointer);\n\n    listGuerrero = (warrior *)malloc(sizeFile*sizeof(warrior));\n    for(int k = 0; k &lt; sizeFile; k++){\n        fscanf(filePointer, \"%d %d %d %s\\n\", &amp;inHp, &amp;inColor, &amp;inUniverse, &amp;inName[0]);\n        listGuerrero[k] = createWarrior(inHp,inColor,inUniverse,inName);\n        printf(\"k: %d - HP: %d - Color: %d - Universo: %d - Nombre: %s \\n\", k, listGuerrero[k].hp, listGuerrero[k].color, listGuerrero[k].universe, listGuerrero[k].name);\n    }\n\n    fclose(filePointer);\n    return listGuerrero;\n}\n</code></pre>\n\n<p>But for some reason I can't understand, the final list of warriors all have the same name like: </p>\n\n<pre><code>j: 0 - HP: 8590 - Color: 2 - Universo: 7 - Nombre: Frost \nj: 1 - HP: 8591 - Color: 2 - Universo: 7 - Nombre: Frost \nj: 2 - HP: 6973 - Color: 2 - Universo: 7 - Nombre: Frost \nj: 3 - HP: 5432 - Color: 3 - Universo: 2 - Nombre: Frost \nj: 4 - HP: 6773 - Color: 3 - Universo: 2 - Nombre: Frost \nj: 5 - HP: 4689 - Color: 4 - Universo: 3 - Nombre: Frost \nj: 6 - HP: 6981 - Color: 5 - Universo: 6 - Nombre: Frost \nj: 7 - HP: 7891 - Color: 5 - Universo: 6 - Nombre: Frost \n</code></pre>\n\n<p>Is something wrong with the inName pointer?</p>\n\n<p>When I debug, the first iteration prints: </p>\n\n<pre><code>j: 0 - HP: 8590 - Color: 2 - Universo: 7 - Nombre: Goku\n</code></pre>\n\n<p>And the second iteration prints:</p>\n\n<pre><code>j: 0 - HP: 8590 - Color: 2 - Universo: 7 - Nombre: Vegeta \nj: 1 - HP: 8591 - Color: 2 - Universo: 7 - Nombre: Vegeta\n</code></pre>\n\n<p>and so on. </p>\n"}, {"tags": ["c", "floating-point", "int", "printf", "c99"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1496863379, "post_id": 44421125, "comment_id": 75840757, "body": "<code>int</code> must be <i>at least</i> 16 bits, but no further guarantee is made by the Standard."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1496868016, "post_id": 44421125, "comment_id": 75843254, "body": "and <code>long long</code> must be at least 64 bit per C99"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496921952, "post_id": 44421125, "comment_id": 75866424, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p8\" rel=\"nofollow noreferrer\">An <code>int</code> must be able to contain a <code>short</code></a>. Also, the Standard specifies that an <a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.2.4.2.1\" rel=\"nofollow noreferrer\"><code>int</code> must be at least 16 bits</a>, regardless of underlying architecture. <code>_Bool</code> is also promoted to <code>int</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496922009, "post_id": 44421125, "comment_id": 75866462, "body": "To add-- It is entirely possible for <code>short</code> to be the same size as <code>int</code>, or for <code>int</code> to be the same size as <code>long</code>. It is also possible to have 16 bit <code>char</code>s, in which case it would be possible to also have 16 bit <code>int</code>s, and <code>sizeof (int) == 1</code>. These are implementation details, not dependent on architecture."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1499643955, "post_id": 44421125, "comment_id": 76978184, "body": "Your programs all have undefined behaviour due to using the wrong format specifier for <code>size_t</code>. (should be <code>%zu</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 1, "last_activity_date": 1496864280, "creation_date": 1496864280, "answer_id": 44421430, "question_id": 44421125, "link": "https://stackoverflow.com/questions/44421125/better-understanding-type-promotion-of-variadic-parameters-in-c/44421430#44421430", "title": "better understanding type promotion of variadic parameters in c", "body": "<blockquote>\n  <p>So I wonder what append when I pass a <code>long long int</code> to a variable\n  argument function like printf with <code>%lld</code> format. And, again, I wonder\n  what append when I pass a <code>long double</code> variable to printf with <code>%Lf</code>\n  format (no matter if on 32 or 64 bit machines).</p>\n</blockquote>\n\n<p>Nothing happens, as the <code>long long int</code> has to be at least of the same size as <code>int</code>. Even in the most \"pesimistic\" scenario, where <code>sizeof(long long int) == sizeof(int)</code>, the argument is still passed \"as is\" (without any promotion). The same applies to <code>long double</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 0, "creation_date": 1496866726, "post_id": 44421610, "comment_id": 75842622, "body": "I talk about printf only for example. I wonder, if I write my varidic function, that I pass to it are all converted to int or only smaller? I edited original post to explain"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 0, "creation_date": 1496866804, "post_id": 44421610, "comment_id": 75842651, "body": "@mastupristi-- the rules for promotion are the same for any variadic function."}, {"owner": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 0, "creation_date": 1496868167, "post_id": 44421610, "comment_id": 75843338, "body": "@David-- for floating point types should be the same: <code>float</code> are promoted to <code>double</code>, and no conversion for <code>long double</code>. I added some other stuff"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 1, "creation_date": 1496868377, "post_id": 44421610, "comment_id": 75843442, "body": "@mastupristi-- What am I missing? Isn&#39;t that what I said: &quot;<code>floats</code> are promoted to <code>double</code>. That is all.&quot; Or, previously, &quot;The integer promotions are performed, and <code>float</code>s are converted to <code>double</code>s, but &#39;No other conversions are performed implicitly&#39;.&quot;"}, {"owner": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 0, "creation_date": 1496868638, "post_id": 44421610, "comment_id": 75843569, "body": "@David-- yes, you are right. my comment was only for sake of precision"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 0, "creation_date": 1496869700, "post_id": 44421610, "comment_id": 75844045, "body": "@mastupristi-- I added some comments about conversion rank and relative type sizes. Maybe this will help to clarify."}, {"owner": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "edited": false, "score": 0, "creation_date": 1496919395, "post_id": 44421610, "comment_id": 75864720, "body": "I added some consideration about 16 and 8 bit machines. Also added a test on 64 bit"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1498155462, "post_id": 44421610, "comment_id": 76396236, "body": "Minor:  &quot;If you pass a long double to printf() with a %Lf conversion specifier, no conversion is made:&quot; --&gt; the &quot;with a %Lf conversion specifier&quot; is not needed.  I point this out as learners sometimes incorrectly think the format string somehow affects the arguments passed."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1498159131, "post_id": 44421610, "comment_id": 76398230, "body": "@chux-- that could have been better phrased. I was iterating through the questions OP had asked, e.g., &quot;I wonder what append when I pass a <code>long double</code> variable to <code>printf</code> with <code>%Lf</code> format.&quot; I have attempted to improve my answer, clarifying about the good point that you raised and improving the citations. Hope I haven&#39;t broken anything ;)"}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 11, "last_activity_date": 1498158916, "last_edit_date": 1498158916, "creation_date": 1496865034, "answer_id": 44421610, "question_id": 44421125, "link": "https://stackoverflow.com/questions/44421125/better-understanding-type-promotion-of-variadic-parameters-in-c/44421610#44421610", "title": "better understanding type promotion of variadic parameters in c", "body": "<p>\"<code>int</code> type should be 4 byte on 32 bit machines and 8 byte on 64 bit machines, is that right?\" No. According to the Standard, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.2.4.2.1\" rel=\"noreferrer\"><code>int</code>s must be <em>at least</em> 16 bits in width (\u00a75.2.4.2.1)</a>, but there is no further stipulation.</p>\n\n<p>When you pass a <code>long long int</code> to <code>printf()</code> it is not subject to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.1p2\" rel=\"noreferrer\">the integer promotions (\u00a76.3.1.1 2)</a>:</p>\n\n<blockquote>\n  <p>The following may be used in an expression wherever an int or unsigned\n  int may be used:</p>\n  \n  <ul>\n  <li>An object or expression with an integer type (other than int or unsigned int) whose integer conversion rank is less than or equal to\n  the rank of int and unsigned int.</li>\n  <li>A bit-field of type _Bool, int, signed int, or unsigned int. </li>\n  </ul>\n  \n  <p>If an int can represent all values of the original type (as restricted\n  by the width, for a bit-field), the value is converted to an int;\n  otherwise, it is converted to an unsigned int. These are called the\n  integer promotions.58) <strong>All other types are unchanged by the integer\n  promotions</strong>.</p>\n</blockquote>\n\n<p>If you pass a <code>long double</code> to <code>printf()</code> <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.2p6\" rel=\"noreferrer\">no conversion is made (\u00a76.5.2.2 6)</a>:</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that\n  does not include a prototype, the integer promotions are performed on\n  each argument, and arguments that have type float are promoted to\n  double. These are called the default argument promotions.</p>\n</blockquote>\n\n<p>The conversion specifiers corresponding to the arguments in the <code>printf()</code> statement have no bearing on these promotions and conversions, except insofar as there will be undefined behavior if the specifiers and the types of their corresponding arguments do not match.</p>\n\n<p>So, the integer promotions are performed, and <code>float</code>s are converted to <code>double</code>s, but <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.2p8\" rel=\"noreferrer\">\"No other conversions are performed implicitly\" (\u00a76.5.2.2 8)</a>.</p>\n\n<p>Addressing your edit to the question: \"this makes me think that not all parameters are promoted to <code>int</code>.\" Correct. Only integer types with integer conversion rank \"less than or equal to the rank of <code>int</code> and <code>unsigned int</code>\" are subject to integer promotion. It is simpler for floating point types; <code>float</code>s are promoted to <code>double</code>. That is all.</p>\n\n<p>It may be worth pointing out that, according to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p10\" rel=\"noreferrer\">\u00a76.2.5 10</a>, there are three real floating point types, <code>float</code>, <code>double</code>, and <code>long double</code>. The values which may be held by a <code>float</code> are a subset of the values which may be held by a <code>double</code>, which are in turn a subset of the values which may be held by a <code>long double</code>. Hence, there is no possibility of promotion for <code>long double</code> types.</p>\n\n<p>Further, according to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.1p1\" rel=\"noreferrer\">\u00a76.3.1.1 1</a>:</p>\n\n<blockquote>\n  <p>The rank of long long int shall be greater than the rank of long int,\n  which shall be greater than the rank of int, which shall be greater\n  than the rank of short int, which shall be greater than the rank of\n  signed char.</p>\n</blockquote>\n\n<p>So there is no possibility of a <code>long long int</code> or <code>long int</code> ever being promoted to <code>int</code> or <code>unsigned int</code>.</p>\n\n<p>As for your final concern that promotion of a <code>short</code> to an <code>int</code> may, in some implementation, be impossible without losing some bits, note that <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p8\" rel=\"noreferrer\">\u00a76.2.5 8</a> guarantees that an <code>int</code> must be able to contain a <code>short</code>, since the conversion rank of an <code>int</code> must be greater than that of a <code>short</code>:</p>\n\n<blockquote>\n  <p>For any two integer types with the same signedness and different\n  integer conversion rank (see 6.3.1.1), the range of values of the type\n  with smaller integer conversion rank is a subrange of the values of\n  the other type.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1498155781, "post_id": 44435320, "comment_id": 76396416, "body": "UV for &quot;The format specifier used is irrelevant to the promotion rules.&quot;"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1496923481, "creation_date": 1496923481, "answer_id": 44435320, "question_id": 44421125, "link": "https://stackoverflow.com/questions/44421125/better-understanding-type-promotion-of-variadic-parameters-in-c/44435320#44435320", "title": "better understanding type promotion of variadic parameters in c", "body": "<blockquote>\n  <p>int type should be 4 byte on 32 bit machines and 8 byte on 64 bit machines, is that right?</p>\n</blockquote>\n\n<p>Probably not. First of all, C makes no guarantees about the size of <code>int</code>, apart from stating that it <em>must</em> be at least 2 bytes (capable of at least holding the value 2^16/2 - 1 = 32767). Nothing in C prevents <code>int</code> from being 8 bytes, but that's not very convenient.</p>\n\n<p>The convention is: all 8- and 16 bit computers use 16 bit <code>int</code>. All other computers use 32 bit <code>int</code>. This is industry de facto standard. Any deviations from this convention would be very exotic, although in theory allowed by C.</p>\n\n<hr>\n\n<blockquote>\n  <p>So I wonder what append when I pass a long long int to a variable argument function like printf with %lld format.</p>\n</blockquote>\n\n<p>You get a long long int. No promotion takes place, because the variable is not one of the mentioned small types. The format specifier used is irrelevant to the promotion rules.</p>\n\n<hr>\n\n<blockquote>\n  <p>this makes me think that not all parameters are promoted to int</p>\n</blockquote>\n\n<p>Indeed. Only the types that the standard mentions are promoted. The formal definition of the default argument promotions can be found in C11 6.5.2.2/6:</p>\n\n<blockquote>\n  <p>...the integer promotions are performed on each argument, and\n  arguments that have type float are promoted to double. These are\n  called the default argument promotions.</p>\n</blockquote>\n\n<p>Meaning that only the small integer types (see the integer promotion rule) and <code>float</code> gets promoted. No other types.</p>\n\n<hr>\n\n<p>Why you think that your examples printing various type sizes have any relevance in relation to the default argument promotions, I have no idea.</p>\n"}], "owner": {"reputation": 867, "user_id": 552247, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4434b3e12bb85cd4dc816d2568d796e2?s=128&d=identicon&r=PG&f=1", "display_name": "mastupristi", "link": "https://stackoverflow.com/users/552247/mastupristi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 2, "accepted_answer_id": 44421610, "answer_count": 3, "score": 11, "last_activity_date": 1499643679, "creation_date": 1496863185, "last_edit_date": 1499643679, "question_id": 44421125, "link": "https://stackoverflow.com/questions/44421125/better-understanding-type-promotion-of-variadic-parameters-in-c", "title": "better understanding type promotion of variadic parameters in c", "body": "<p>When a variable argument function is called in c the integer parameters are promoted to int and floating point parameters are promoted to double</p>\n\n<blockquote>\n  <p>Since the prototype doesn\u2019t specify types for optional arguments, in a call to a variadic function the <em>default argument promotions</em> are performed on the optional argument values. This means the objects of type <code>char</code> or <code>short int</code> (whether signed or not) are promoted to either <code>int</code> or <code>unsigned int</code>, as appropriate; and that objects of type <code>float</code> are promoted to type <code>double</code>. So, if the caller passes a <code>char</code> as an optional argument, it is promoted to an <code>int</code>, and the function can access it with <code>va_arg (ap, int)</code>.</p>\n</blockquote>\n\n<p><code>int</code> type should be 4 byte on 32 bit machines and 8 byte on 64 bit machines, is that right?<br>\nSo I wonder what append when I pass a <code>long long int</code> to a variable argument function like printf with <code>%lld</code> format.<br>\nAnd, again, I wonder what append when I pass a <code>long double</code> variable to printf with <code>%Lf</code> format (no matter if on 32 or 64 bit machines).</p>\n\n<p>[<strong>Edited</strong>]</p>\n\n<p>on a 32 bit machine, I tried this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"sizeof(int) %d\\n\", sizeof(int));\n    printf(\"sizeof(long int) %d\\n\", sizeof(long int));\n    printf(\"sizeof(long long int) %d\\n\", sizeof(long long int));\n    printf(\"%lld\\n\", 1LL&lt;&lt;33);\n\n    printf(\"sizeof(float) %d\\n\", sizeof(float));\n    printf(\"sizeof(double) %d\\n\", sizeof(double));\n    printf(\"sizeof(long double) %d\\n\", sizeof(long double));\n    return 0;\n}\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>sizeof(int) 4\nsizeof(long int) 4\nsizeof(long long int) 8\n8589934592\nsizeof(float) 4\nsizeof(double) 8\nsizeof(long double) 12\n</code></pre>\n\n<p>this makes me think that not all parameters are promoted to <code>int</code>, otherwise I would get printed 0 instead of 8589934592.</p>\n\n<p>Maybe only arguments smaller than <code>int</code> are promoted to <code>int</code>. And something similar could be for floating point types.</p>\n\n<p>[<strong>Edited</strong>]</p>\n\n<p>on a 64 bit machine I run this:</p>\n\n<pre><code>int main(void)\n{\n    printf(\"sizeof(int) %lu\\n\", sizeof(int));\n    printf(\"sizeof(long) %lu\\n\", sizeof(long));\n    printf(\"sizeof(long long) %lu\\n\", sizeof(long long));\n    return 0;\n}\n</code></pre>\n\n<p>and get</p>\n\n<pre><code>sizeof(int) 4\nsizeof(long) 8\nsizeof(long long) 8\n</code></pre>\n\n<p>if I understand well the standard, only <code>char</code> and <code>short</code> are promoted to <code>int</code>. I wonder what happen in smaller architecture, such like 16 bit or 8 bit MCU. I think that <code>int</code> size is dependent by architecture, but I wonder if <code>sizeof(int)</code> can be 1 on 8 bit architecture. In this case promotion of <code>short</code> to <code>int</code> could be impossible unless loosing some bits</p>\n"}, {"tags": ["c", "linux", "signal-handling"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 1, "creation_date": 1496863334, "post_id": 44421013, "comment_id": 75840729, "body": "Why not post the complete code so we can help?"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 1, "creation_date": 1496863977, "post_id": 44421013, "comment_id": 75841107, "body": "the program not responding to Linux signals, how shall I know that just looking at the skeleton while loop. post the problematic code and error code, that will help to understand the problem you face."}, {"owner": {"reputation": 23, "user_id": 8127524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cgt6RLn5w-U/AAAAAAAAAAI/AAAAAAAACRI/h_LcZRB85mg/photo.jpg?sz=128", "display_name": "Shreedutt Hegde", "link": "https://stackoverflow.com/users/8127524/shreedutt-hegde"}, "edited": false, "score": 0, "creation_date": 1496864540, "post_id": 44421013, "comment_id": 75841435, "body": "<a href=\"https://gist.github.com/schegde/fafc10fa6947c2bd738d3334198ba1f1#file-transfer-c\" rel=\"nofollow noreferrer\">gist.github.com/schegde/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 8127524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cgt6RLn5w-U/AAAAAAAAAAI/AAAAAAAACRI/h_LcZRB85mg/photo.jpg?sz=128", "display_name": "Shreedutt Hegde", "link": "https://stackoverflow.com/users/8127524/shreedutt-hegde"}, "edited": false, "score": 0, "creation_date": 1496864747, "post_id": 44421013, "comment_id": 75841556, "body": "The rio_writen and rio_readnb are functions that write and read from network socket."}, {"owner": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 1, "creation_date": 1496865466, "post_id": 44421013, "comment_id": 75841967, "body": "Try to define flags as volatile."}, {"owner": {"reputation": 23, "user_id": 8127524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cgt6RLn5w-U/AAAAAAAAAAI/AAAAAAAACRI/h_LcZRB85mg/photo.jpg?sz=128", "display_name": "Shreedutt Hegde", "link": "https://stackoverflow.com/users/8127524/shreedutt-hegde"}, "reply_to_user": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "edited": false, "score": 0, "creation_date": 1496867680, "post_id": 44421013, "comment_id": 75843114, "body": "@ErkiA Yes! that was indeed the case! Thanks. Could you re-add your  explanation as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 1711, "user_id": 3142427, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001188615168/picture?type=large", "display_name": "Erki Aring", "link": "https://stackoverflow.com/users/3142427/erki-aring"}, "is_accepted": true, "score": 1, "last_activity_date": 1496865035, "creation_date": 1496865035, "answer_id": 44421611, "question_id": 44421013, "link": "https://stackoverflow.com/questions/44421013/program-not-responding-to-linux-signals-sent-from-terminal-without-continuous-pr/44421611#44421611", "title": "Program not responding to linux signals sent from terminal without continuous printing on terminal", "body": "<p>The conditional code blocks could be optimized out, because compiler doesn't know these variables can change out of the loop. Define flags as volatile, i.e.</p>\n\n<pre><code>volatile int flag1;\n...\n</code></pre>\n\n<p>This way compiler knows not to make any assumptions about the values of these variables.</p>\n"}], "owner": {"reputation": 23, "user_id": 8127524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cgt6RLn5w-U/AAAAAAAAAAI/AAAAAAAACRI/h_LcZRB85mg/photo.jpg?sz=128", "display_name": "Shreedutt Hegde", "link": "https://stackoverflow.com/users/8127524/shreedutt-hegde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 44421611, "answer_count": 1, "score": 0, "last_activity_date": 1496865035, "creation_date": 1496862803, "question_id": 44421013, "link": "https://stackoverflow.com/questions/44421013/program-not-responding-to-linux-signals-sent-from-terminal-without-continuous-pr", "title": "Program not responding to linux signals sent from terminal without continuous printing on terminal", "body": "<p>I have a C program that goes like:  </p>\n\n<pre><code>while(1){\n    if(flag1){\n         ...\n    }\n    if(flag2){\n         ...\n    }\n}\n</code></pre>\n\n<p>Now these flags will be raised in handlers for SIGINT AND SIGTSTP signals. The terminal just shows     ^C and ^Z when Ctrl+C or Ctrl+Z is entered, but the conditional code blocks are not executed.<br>\nHowever the exact same program, but if I give a printf like below:</p>\n\n<pre><code>while(1){\n    printf(\"  \");\n    if(flag1){\n         ...\n    }\n    if(flag2){\n         ...\n    }\n}\n</code></pre>\n\n<p>The program responds to the Ctrl+Z or Ctrl+C signals, and the respective conditional code blocks are executed. \nCould someone explain this behavior? I am not sure why keeping the terminal busy with something being printed continuously, makes my program respond to the signals, while not otherwise.</p>\n"}, {"tags": ["c", "multithreading", "ncurses"], "comments": [{"owner": {"reputation": 1, "user_id": 5705302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704f26b11943b855627c660f15928834?s=128&d=identicon&r=PG", "display_name": "Sankait Laroiya", "link": "https://stackoverflow.com/users/5705302/sankait-laroiya"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496864283, "post_id": 44421007, "comment_id": 75841305, "body": "@DavidBowling Sorry, I forgot to remove it."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1496864626, "post_id": 44421007, "comment_id": 75841485, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7410447/why-getch-returns-before-press-any-key\">Why getch() returns before press any key?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1496869044, "post_id": 44421007, "comment_id": 75843767, "body": "Well, you don&#39;t have any <code>WINDOW *</code>, not even the <code>stdscr</code> which is created by <code>initscr()</code> (<code>getch()</code> implicitly works on <code>stdscr</code>). I&#39;m not sure, but I could well imagine that this is the source of your problem: <code>getch()</code> is intended to be used as long as <code>stdscr</code> exists."}], "answers": [{"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 0, "last_activity_date": 1496883432, "creation_date": 1496883432, "answer_id": 44424999, "question_id": 44421007, "link": "https://stackoverflow.com/questions/44421007/how-to-use-getch-in-a-loop-ncurses/44424999#44424999", "title": "How to use getch() in a loop (nCurses)", "body": "<p>There are at least three problems with the program:</p>\n\n<ul>\n<li><p><code>getch</code> will always return an error because you did not initialize the screen with <code>initscr</code> or <code>newterm</code>.  Likewise, the <code>cbreak</code> call does nothing except return an error.</p></li>\n<li><p>even if you initialized the screen, calling <code>getch</code> with multiple threads will not work predictably because it is not thread-safe. It's an FAQ: <a href=\"http://invisible-island.net/ncurses/ncurses.faq.html#multithread\" rel=\"nofollow noreferrer\">Why does (fill in the blank) happen when I use two threads?</a></p></li>\n<li><p>the <code>printf</code> does something, but mixing stdio (printf) and curses does not work as you'd like.  Use <code>printw</code> for curses applications.</p></li>\n</ul>\n\n<p>As for printing <strong><code>?</code></strong>, those -1's sent to a terminal which expects UTF-8 would likely decide they're not valid UTF-8 and display the <a href=\"http://www.fileformat.info/info/unicode/char/fffd/index.htm\" rel=\"nofollow noreferrer\">replacement character</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5705302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704f26b11943b855627c660f15928834?s=128&d=identicon&r=PG", "display_name": "Sankait Laroiya", "link": "https://stackoverflow.com/users/5705302/sankait-laroiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 950, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496883432, "creation_date": 1496862790, "last_edit_date": 1496864303, "question_id": 44421007, "link": "https://stackoverflow.com/questions/44421007/how-to-use-getch-in-a-loop-ncurses", "title": "How to use getch() in a loop (nCurses)", "body": "<p>This is my first time using ncurses library. So, I wanted to use getch() to get a character as it is typed by the user (without pressing return every time). However, when I run this code:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;curses.h&gt;\n\nvoid *userInput() {\nchar c;\n\nwhile((c = getch()) != '~') {\n    printf(\"%c\\n\",c);\n}\n\npthread_exit(NULL);\n\n}\n\nint main() {\n    cbreak();\n\n    pthread_t threads[4];\n\n    pthread_create(&amp;threads[0], NULL, userInput, NULL);\n\n    pthread_exit(NULL);\n}\n</code></pre>\n\n<p>It printf lots of '?'s without getting any input. Could anyone please help me understand whats wrong?\nThank you.</p>\n\n<p>EDIT: removed dead code.</p>\n"}, {"tags": ["c", "clang", "clang-format"], "comments": [{"owner": {"reputation": 1467, "user_id": 1364178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd7a325d0e5f65ea55fcc81a90df01a?s=128&d=identicon&r=PG", "display_name": "David Vereb", "link": "https://stackoverflow.com/users/1364178/david-vereb"}, "edited": false, "score": 0, "creation_date": 1496865476, "post_id": 44420839, "comment_id": 75841972, "body": "Everything in BraceWrapping is ignored if BreakBeforeBraces isn&#39;t set to Custom.  When you say you manually set each thing to true, did you also have BreakBeforeBraces set to Custom?"}, {"owner": {"reputation": 195, "user_id": 7419679, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/201735092000ec70e4246c77437ae490?s=128&d=identicon&r=PG&f=1", "display_name": "omrisim210", "link": "https://stackoverflow.com/users/7419679/omrisim210"}, "reply_to_user": {"reputation": 1467, "user_id": 1364178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd7a325d0e5f65ea55fcc81a90df01a?s=128&d=identicon&r=PG", "display_name": "David Vereb", "link": "https://stackoverflow.com/users/1364178/david-vereb"}, "edited": false, "score": 0, "creation_date": 1496876044, "post_id": 44420839, "comment_id": 75846418, "body": "@DavidVereb Yes, I did."}, {"owner": {"reputation": 1467, "user_id": 1364178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd7a325d0e5f65ea55fcc81a90df01a?s=128&d=identicon&r=PG", "display_name": "David Vereb", "link": "https://stackoverflow.com/users/1364178/david-vereb"}, "edited": false, "score": 0, "creation_date": 1497021620, "post_id": 44420839, "comment_id": 75919349, "body": "Perhaps you could post some example code so that we can try to reproduce the error on our end?  Are you sure it&#39;s seeing your .clang-format file?"}], "owner": {"reputation": 195, "user_id": 7419679, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/201735092000ec70e4246c77437ae490?s=128&d=identicon&r=PG&f=1", "display_name": "omrisim210", "link": "https://stackoverflow.com/users/7419679/omrisim210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496862245, "creation_date": 1496862213, "last_edit_date": 1496862245, "question_id": 44420839, "link": "https://stackoverflow.com/questions/44420839/clang-format-allman-style-wont-work", "title": "clang-format Allman style won&#39;t work", "body": "<p>I made my <code>.clang-format</code> and tried formatting my c file using it but the output is different from what I set it to be. In my <code>.clang-format</code> I manually set each thing in <code>BraceWrapping</code> to <code>true</code> and it doesn't work, but even in the </p>\n\n<pre><code>BasedOnStyle: None\nAlignTrailingComments: true\nBreakBeforeBraces: Allman\nColumnLimit: 0\nIndentWidth: 4\nKeepEmptyLinesAtTheStartOfBlocks: false\nSpacesBeforeTrailingComments: 1\nTabWidth: 4\nUseTab: Never\n</code></pre>\n\n<p>Did I do something wrong or is there a bug in my clang-format version? I'm using version <code>4.0.0</code></p>\n"}, {"tags": ["c", "tags", "structure", "definition"], "comments": [{"owner": {"reputation": 409, "user_id": 4657413, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6u2Hm.jpg?s=128&g=1", "display_name": "newb7777", "link": "https://stackoverflow.com/users/4657413/newb7777"}, "edited": false, "score": 0, "creation_date": 1496862398, "post_id": 44420835, "comment_id": 75840175, "body": "sorry there are 3 versions of writing the structure."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496862431, "post_id": 44420835, "comment_id": 75840198, "body": "The <code>Tag</code> immediately following <code>struct</code> when it is self-referencing, such as a linked list or tree node definition."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1496862995, "post_id": 44420835, "comment_id": 75840521, "body": "Your first example doesn&#39;t <i>define</i> a structure. It just <i>declares</i> a structure with the name <code>Tag</code>. Your 2nd example declares a structure named <code>Tag</code> and defines a variable called <code>Tag</code> of type <code>struct Tag</code>. Your 3rd example <i>defines</i> a structure with variable named <code>Tag</code>. See <a href=\"https://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration\">What&#39;s the difference between a declaration and a definition</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496862834, "post_id": 44420894, "comment_id": 75840415, "body": "Add what the third does and you have answered the question ;)"}], "tags": [], "owner": {"reputation": 465, "user_id": 2292368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9656238f23065edc53ad0731600997a8?s=128&d=identicon&r=PG", "display_name": "Jay Buckman", "link": "https://stackoverflow.com/users/2292368/jay-buckman"}, "is_accepted": false, "score": 1, "last_activity_date": 1496919587, "last_edit_date": 1496919587, "creation_date": 1496862414, "answer_id": 44420894, "question_id": 44420835, "link": "https://stackoverflow.com/questions/44420835/in-c-language-structure-subtle-difference-in-definition/44420894#44420894", "title": "In C language, Structure, subtle difference in definition", "body": "<p>The first example creates a definition for a struct named Tag.  The second also creates a variable (which happens to be a Tag struct) named Tag.  The third creates a variable named Tag with the specified structure - but the struct is never named so you can't use it again.  </p>\n\n<p>Which to use?  Personally I'd use the first one and the separately declare any type Tag variables.  If you are trying to eliminate a line of code, the second one works fine.  If you are only going to use the struct once, you could use the third one.  </p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1496879199, "last_edit_date": 1496879199, "creation_date": 1496862850, "answer_id": 44421032, "question_id": 44420835, "link": "https://stackoverflow.com/questions/44420835/in-c-language-structure-subtle-difference-in-definition/44421032#44421032", "title": "In C language, Structure, subtle difference in definition", "body": "<p>According to the C Standard (6.2.3 Name spaces of identifiers)</p>\n\n<blockquote>\n  <p>1 If more than one declaration of a particular identifier is visible\n  at any point in a translation unit, the syntactic context\n  disambiguates uses that refer to different entities. Thus, there are\n  separate name spaces for various categories of identifiers, as\n  follows:</p>\n  \n  <p>\u2014 label names (disambiguated by the syntax of the label declaration\n  and use);</p>\n  \n  <p>\u2014 the tags of structures, unions, and enumerations (disambiguated by\n  following any32) of the keywords struct, union, or enum);</p>\n  \n  <p>\u2014 the members of structures or unions; each structure or union has a\n  separate name space for its members (disambiguated by the type of the\n  expression used to access the member via the . or -> operator);</p>\n  \n  <p>\u2014 all other identifiers, called ordinary identifiers (declared in\n  ordinary declarators or as enumeration constants).</p>\n</blockquote>\n\n<p>This is</p>\n\n<pre><code>struct Tag \n{\n  type Tag;\n  &lt;and so on..&gt;\n};\n</code></pre>\n\n<p>a structure declaration with the name <code>Tag</code> and at the same time it is a structure definition because it not only introduces the type <code>struct Tag</code> but also declares its members.</p>\n\n<p>You may at first declare a structure and then define it. For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct Tag;\n\nstruct Tag\n{\n    int Tag;\n};\n\nint main(void) \n{\n    struct Tag Tag = { .Tag = 10 };\n\n    printf( \"Tag.Tag = %d\\n\", Tag.Tag );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>Tag.Tag = 10\n</code></pre>\n\n<p>In this declaration</p>\n\n<pre><code>struct Tag \n{\n  type Tag;\n  &lt;and so on..&gt;\n} Tag;\n</code></pre>\n\n<p>there is declared an object of the type <code>struct Tag</code> with the identifier <code>Tag</code>. The structure has a data member with name <code>Tag</code>. Thus there are declared two entities: a type <code>struct Tag</code> and an object with the name <code>Tag</code> of the structure type.</p>\n\n<p>In this declaration</p>\n\n<pre><code>struct \n{\n  type Tag;\n  &lt;and so on..&gt;\n} Tag;\n</code></pre>\n\n<p>there is declared an object of unnamed structure type with the identifier <code>Tag</code>. The problem with this declaration is that you can not refer to the type of the object.</p>\n\n<p>You can meet one more declaration like</p>\n\n<pre><code>typedef struct Tag \n{\n  type Tag;\n  &lt;and so on..&gt;\n} Tag;\n</code></pre>\n\n<p>In this typedef declaration the identifier <code>Tag</code> serves as an alias of the type <code>struct Tag</code>.</p>\n\n<p>Or</p>\n\n<pre><code>typedef struct  \n{\n  type Tag;\n  &lt;and so on..&gt;\n} Tag;\n</code></pre>\n\n<p>In this typedef declaration the identifier <code>Tag</code> serves as an alias of the unnamed structure type.</p>\n\n<p>The C 2011 allows to declare anonymous structures. \nFrom the C Standard (6.7.2.1 Structure and union specifiers)</p>\n\n<blockquote>\n  <p>13 An unnamed member of structure type with no tag is called an\n  anonymous structure; an unnamed member of union type with no tag is\n  called an anonymous union. The members of an anonymous structure or\n  union are considered to be members of the containing structure or\n  union. This applies recursively if the containing structure or union\n  is also anonymous.</p>\n</blockquote>\n"}], "owner": {"reputation": 409, "user_id": 4657413, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6u2Hm.jpg?s=128&g=1", "display_name": "newb7777", "link": "https://stackoverflow.com/users/4657413/newb7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 1, "accepted_answer_id": 44421032, "answer_count": 2, "score": 2, "last_activity_date": 1504912422, "creation_date": 1496862195, "last_edit_date": 1504912422, "question_id": 44420835, "link": "https://stackoverflow.com/questions/44420835/in-c-language-structure-subtle-difference-in-definition", "title": "In C language, Structure, subtle difference in definition", "body": "<p>I have seen format below for defining a structure </p>\n\n<pre><code>typedef struct Tag \n{\n  type Member1;\n  type Member2;\n  &lt;and so on..&gt;\n};\n</code></pre>\n\n<p>Some places I see the format below for defining a structure </p>\n\n<pre><code>typedef struct Tag \n{\n  type Member1;\n  type Member2;\n  &lt;and so on..&gt;\n} Tag;\n</code></pre>\n\n<p>and some places I see the format below for defining a structure </p>\n\n<pre><code>typedef struct \n{\n  type Member1;\n  type Member2;\n  &lt;and so on..&gt;\n} Tag;\n</code></pre>\n\n<p>If you notice the <code>Tag</code> syntax is after <code>struct</code> and also at the closing brace.</p>\n\n<p><strong>Questions.</strong></p>\n\n<p>1) What is the difference between the 3?</p>\n\n<p>2) Is one preferred over the other or When are the best conditions you may want to use one over the other?</p>\n"}, {"tags": ["c", "gcc", "clang", "max", "min"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1496861648, "post_id": 44420648, "comment_id": 75839739, "body": "How do you expect us to say what&#39;s wrong with your code if you don&#39;t show us your code?  Please update your question with a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>."}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1496861719, "post_id": 44420648, "comment_id": 75839788, "body": "Oh I&#39;m extremely Sorry. I&#39;ll add a code snippet!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496861953, "post_id": 44420648, "comment_id": 75839930, "body": "@PrabhatSharma add the code snippet <i>verbatim in the question</i> please, thanks!"}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496861982, "post_id": 44420648, "comment_id": 75839949, "body": "I&#39;ve added the link and marked the use of min through comments!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496862620, "post_id": 44420648, "comment_id": 75840294, "body": "@PrabhatSharma voting to close here: code must be included in the question, not in an external link."}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496863003, "post_id": 44420648, "comment_id": 75840528, "body": "Sorry, but I&#39;ve done both. Since the actual code was quite long I didn&#39;t include the whole!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496864298, "post_id": 44420648, "comment_id": 75841312, "body": "<code>typeof (b) _b = (b); \\        &#47;&#47;Min defined</code> --&gt; typeof (b) _b = (b);         //Min defined\\"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496865344, "post_id": 44420648, "comment_id": 75841897, "body": "@bluepixy: You&#39;re right. I don&#39;t saw that first!"}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496865628, "post_id": 44420648, "comment_id": 75842058, "body": "Nopes @BLUEPIXY that doesn&#39;t make any difference!"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 2, "creation_date": 1496866204, "post_id": 44420648, "comment_id": 75842325, "body": "You should check if your compiler supports typeof. If not you have to think about an alternative."}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496866754, "post_id": 44420648, "comment_id": 75842627, "body": "Clang doesn&#39;t support typeof :("}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496872011, "post_id": 44420648, "comment_id": 75845008, "body": "Note: <code>typeof</code> is a <a href=\"https://stackoverflow.com/q/12081502/2410359\">compiler extension</a> not in C11, C99,..."}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496862335, "post_id": 44420818, "comment_id": 75840140, "body": "What&#39;s the difference between both? I&#39;ve used this documentation code of typeof  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Typeof.html\" rel=\"nofollow noreferrer\">gcc doc</a>"}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496862523, "post_id": 44420818, "comment_id": 75840243, "body": "Moreover it didn&#39;t solved the problem! The errors are almost same except instead of typeof there is <i>typeof</i>"}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496862732, "post_id": 44420818, "comment_id": 75840353, "body": "Means it&#39;s all compiler specific and we should not use it. Right? But how then we define min or max function in C?"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496862905, "post_id": 44420818, "comment_id": 75840468, "body": "You could  implement it without of the use of <b>typeof</b>: <code>#define min(a,b) (((a) &lt; (b)) ? (a) : (b))</code>."}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 1, "creation_date": 1496863294, "post_id": 44420818, "comment_id": 75840705, "body": "But this will cause problem in some cases like if we write (++a, ++b) etc.   See this <a href=\"https://stackoverflow.com/questions/3437404/min-and-max-in-c\">stackoverflow.com/questions/3437404/min-and-max-in-c</a>      But I admit this will not cause any problem in my case!"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496864852, "post_id": 44420818, "comment_id": 75841623, "body": "You could use an inline function as I edited my answer."}, {"owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "edited": false, "score": 0, "creation_date": 1496865472, "post_id": 44420818, "comment_id": 75841970, "body": "Thanks! @Andre Kampling"}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": true, "score": 0, "last_activity_date": 1497530664, "last_edit_date": 1497530664, "creation_date": 1496862142, "answer_id": 44420818, "question_id": 44420648, "link": "https://stackoverflow.com/questions/44420648/implementing-min-function-in-c-by-using-typeof-compiler-extension-gives-error/44420818#44420818", "title": "Implementing min function in C by using typeof compiler extension gives error", "body": "<p>It should be:</p>\n\n<pre><code>#define min(a,b) \\\n   ({ __typeof__ (a) _a = (a); \\\n      __typeof__ (b) _b = (b); // Min defined \\\n      _a &lt; _b ? _a : _b; })\n</code></pre>\n\n<p>Your comment should <strong>not</strong> be after the <code>\\</code> but before it.\nAlso you write typeof without the underscores. It is recommended to use them, the explanation is given <a href=\"https://stackoverflow.com/questions/14877415/difference-between-typeof-typeof-and-typeof-objective-c\">here at SO</a>.</p>\n\n<blockquote>\n  <p><code>typeof()</code>, <code>__typeof__()</code> and <code>__typeof()</code> are compiler-specific extensions to the C language, because standard C does not include such an operator.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Macro without typeof:</strong></p>\n\n<p>If your compiler does <strong>not</strong> support the <code>typeof</code> \"operator\", you could define the min macro without typeof:</p>\n\n<pre><code>#define min(a,b) (((a) &lt; (b)) ? (a) : (b))\n</code></pre>\n\n<p>But with that you will have side effects when using postfix or prefix in/decrement operators on variables, because a double evaluation will occur.</p>\n\n<hr>\n\n<p><strong>Inline function:</strong></p>\n\n<p>The other possibility to make it safe is an inline function. It will be typesafe and no double evaluation will happen:</p>\n\n<pre><code>inline int min(int a, int b)\n{\n   if (a &lt; b)\n   {\n      return a;\n   }\n   return b;\n}\n</code></pre>\n\n<p>You loose type genericity, but there is no other way. You could also think of using double since integers will be implicitly casted. But remember the loose of precision.</p>\n"}], "owner": {"reputation": 56, "user_id": 8092124, "user_type": "registered", "profile_image": "https://graph.facebook.com/411398462561724/picture?type=large", "display_name": "Prabhat Sharma", "link": "https://stackoverflow.com/users/8092124/prabhat-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1732, "favorite_count": 0, "accepted_answer_id": 44420818, "answer_count": 1, "score": 0, "last_activity_date": 1497530664, "creation_date": 1496861499, "last_edit_date": 1496862172, "question_id": 44420648, "link": "https://stackoverflow.com/questions/44420648/implementing-min-function-in-c-by-using-typeof-compiler-extension-gives-error", "title": "Implementing min function in C by using typeof compiler extension gives error", "body": "<p>When i attempted to implement min function in C as C lacks this function the compiler gives an error. I've used type of for implementing it just like this </p>\n\n<p><a href=\"https://stackoverflow.com/questions/3437404/min-and-max-in-c\">MIN and MAX in C</a></p>\n\n<p><a href=\"https://gist.github.com/8befd9ba16f374c827a311812815f78a\" rel=\"nofollow noreferrer\">My code</a></p>\n\n<p>For quick reference:</p>\n\n<pre><code>&gt;#define min(a,b) \\\n  ({ typeof (a) _a = (a); \\\n  typeof (b) _b = (b); \\        //Min defined\n  _a &lt; _b ? _a : _b; })\n  .\n  .\n  .\n  c= min(c+floor(1.0/f), bi.biWidth) ;\n  r= min(r+floor(1.0/f),abs(bi.biHeight)) ;\n</code></pre>\n\n<p>Error generated:</p>\n\n<pre><code> &gt;make resize\n clang -fsanitize=integer -fsanitize=undefined -ggdb3 -O0 -std=c11 -Wall       \n -Werror -Wextra -Wno-sign-compare -Wshadow    resize.c  -lcrypt -lcs50      \n -lm  -o resize\n\nresize.c:191:18: error: implicit declaration of function 'typeof' is    \ninvalid in C99 [-Werror,-Wimplicit-function-declaration]\n          c= min(c+floor(1.0/f), bi.biWidth) ;\n             ^\nresize.c:11:6: note: expanded from macro 'min'\n({ typeof (a) _a = (a); \\\n ^\n resize.c:191:18: error: expected ';' after expression\n resize.c:11:17: note: expanded from macro 'min'\n ({ typeof (a) _a = (a); \\\n            ^\n\n resize.c:191:18: error: use of undeclared identifier '_a'\n\n resize.c:11:17: note: expanded from macro 'min'\n ({ typeof (a) _a = (a); \\\n            ^\n\n resize.c:191:18: error: expected ';' after expression\n\n resize.c:12:18: note: expanded from macro 'min'\n  typeof (b) _b = (b); \\\n\n                  ^\n\n resize.c:191:18: error: use of undeclared identifier '_b'\n\n resize.c:12:18: note: expanded from macro 'min'\n  typeof (b) _b = (b); \\\n             ^\n\n resize.c:191:18: error: use of undeclared identifier '_a'\n\n resize.c:13:5: note: expanded from macro 'min'\n _a &lt; _b ? _a : _b; })\n ^\n\n resize.c:191:18: error: use of undeclared identifier '_b'\n\n resize.c:13:10: note: expanded from macro 'min'\n _a &lt; _b ? _a : _b; })\n     ^\n\n resize.c:191:18: error: use of undeclared identifier '_b'\n\n resize.c:13:20: note: expanded from macro 'min'\n _a &lt; _b ? _a : _b; })\n               ^\n\n resize.c:193:13: error: expected ';' after expression\n     r= min(r+floor(1.0/f),abs(bi.biHeight)) ;\n        ^\n\n resize.c:11:17: note: expanded from macro 'min'\n  ({ typeof (a) _a = (a); \\\n            ^\n\n resize.c:193:13: error: use of undeclared identifier '_a'\n\n resize.c:11:17: note: expanded from macro 'min'\n ({ typeof (a) _a = (a); \\\n            ^\n\n resize.c:193:13: error: expected ';' after expression\n\n resize.c:12:18: note: expanded from macro 'min'\n  typeof (b) _b = (b); \\\n             ^\n\n resize.c:193:13: error: use of undeclared identifier '_b'\n\n resize.c:12:18: note: expanded from macro 'min'\n  typeof (b) _b = (b); \\\n             ^\n\n resize.c:193:13: error: use of undeclared identifier '_a'\n\n resize.c:13:5: note: expanded from macro 'min'\n _a &lt; _b ? _a : _b; })\n ^\n\n resize.c:193:13: error: use of undeclared identifier '_b'\n\n resize.c:13:10: note: expanded from macro 'min'\n _a &lt; _b ? _a : _b; })\n     ^\n\n resize.c:193:13: error: use of undeclared identifier '_b'\n\n resize.c:13:20: note: expanded from macro 'min'\n _a &lt; _b ? _a : _b; })\n               ^\n\n 15 errors generated.\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "tcp", "server"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496861238, "post_id": 44420519, "comment_id": 75839529, "body": "Is this about windows? As a first hint, never ever call your own type <code>something_t</code>. The <code>_t</code> suffix is reserved for the implementation (of your compiler / standard library / ...) in any POSIX environment."}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1496861651, "post_id": 44420519, "comment_id": 75839740, "body": "it&#39;s rather unix. I will use this inside my macOS GUI application and also on Windows with cygwin."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496861656, "post_id": 44420519, "comment_id": 75839743, "body": "you should probably have some <i>signal variable</i> for every <i>thread</i> to inform the thread about the shutdown request and then wait for it (e.g. <code>pthread_join()</code> with POSIX threads). Maybe you should clarify the platform <b>and</b> show some of your code in order to get an actual <i>answer</i>"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1496861974, "post_id": 44420519, "comment_id": 75839945, "body": "It is cocoa application in objective-c and I try to write for it server in C that will be cross-platform  (usable also on windows)"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1496862030, "post_id": 44420519, "comment_id": 75839973, "body": "<a href=\"https://linux.die.net/man/3/pthread_cond_signal\" rel=\"nofollow noreferrer\">linux.die.net/man/3/pthread_cond_signal</a> do you mean this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496862439, "post_id": 44420519, "comment_id": 75840201, "body": "Not necessarily, it could be something as simple as a <code>volatile sig_atomic_t</code> as you don&#39;t need <i>exact</i> synchronization, you only want the thread to eventually know that it should shut down. Of course, the thread shouldn&#39;t be stuck in a blocking call. Depending on your design, you could also need to <code>pthread_cancel()</code> your threads."}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1496862717, "post_id": 44420519, "comment_id": 75840344, "body": "Ok, it should be something like global variable (flag) indicating whether the server/each connection should close down."}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1496862902, "post_id": 44420519, "comment_id": 75840465, "body": "Shutting down socket descriptors not suffice? I read that when I do shutdown(conn_sock) from other thread it should correctly enforce connection closing ?"}], "answers": [{"tags": [], "owner": {"reputation": 3185, "user_id": 1519939, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b475f2c218b347c815314aa5710264a?s=128&d=identicon&r=PG", "display_name": "Dmitry Poroh", "link": "https://stackoverflow.com/users/1519939/dmitry-poroh"}, "is_accepted": false, "score": 1, "last_activity_date": 1496904518, "creation_date": 1496904518, "answer_id": 44428556, "question_id": 44420519, "link": "https://stackoverflow.com/questions/44420519/multithreaded-tcp-server-on-background-thread-how-to-force-close-from-main-thre/44428556#44428556", "title": "Multithreaded TCP server on background thread- how to force close from main thread", "body": "<p><strong>Should I use some mutex to synchronise access to this server_info_t structure?</strong></p>\n\n<p>You definitely should synchronize access to the shared data structure.</p>\n\n<p><strong>Should I take all connection sockets (while iteration over linked list in server_info_t structure) and close them using (shutdown + close), and then shutdown + close passive socket?</strong></p>\n\n<p>This is kind of quick and dirty solution. Better design is to inform worker thread the connection should be closed. In this case you can:</p>\n\n<ul>\n<li>Inform clients of the server about reason of the connection shutdown</li>\n<li>Complete process of current request</li>\n</ul>\n\n<p>Way to solve \"inform\" task can be different:</p>\n\n<ul>\n<li>If you use <code>select</code>/<code>poll</code>/<code>epoll</code> methods you can use designated socket (for ex. <code>socketpair</code>) to indicate stop</li>\n<li>If you use blocking calls you can use <code>pthread_cancel</code> mechanisms but they are very system-dependent</li>\n<li>If your worker thread wakeups periodically you can use kind of atomic flag</li>\n</ul>\n"}], "owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496904518, "creation_date": 1496861069, "question_id": 44420519, "link": "https://stackoverflow.com/questions/44420519/multithreaded-tcp-server-on-background-thread-how-to-force-close-from-main-thre", "title": "Multithreaded TCP server on background thread- how to force close from main thread", "body": "<p>I have GUI application this application starts server by calling\n<code>start_server()</code> function. Then there is created TCP passive socket receiving incoming connections in the server loop(we have connection sockets here) and handling them on multiple threads simultaneously. </p>\n\n<p>Now I need some end_server() function that force server and all connections to close. What is the best practice to close such servers. </p>\n\n<p>I consider doing this in such way: </p>\n\n<ol>\n<li>pass to <code>start_server()</code> function some <code>server_info_t</code> structure. </li>\n<li>then when passive socket is created its descriptor i stored in server_info_t, there is also stored its binding port number</li>\n<li>in <code>server_info_t</code> structure there is <code>on_server_start</code> callback that is called asynchronously after server has been created correctly returning some information about created server like port number on which server is listening (this enable to change <code>GUI controls</code> like status icon from red to green) </li>\n<li>then i pass the same structure <code>server_info_t</code> info server_loop and there where new connection from client is coming I will take the connection socket and store its descriptor inside server_info_t structure some linked_list_t or hash_map_t of connection sockets. </li>\n<li>now i can invoke some asynchronous callback like <code>on_client_connected</code> and pass handling of connection (connection socket) to another function (separate thread from thread pool), and then server loop waits for next connection. I also need to pass <code>server_info_t</code> structure here to remove connection_socket descriptor from <strong>linked_list</strong> of conn socket descriptors it <strong>connection handling</strong> for given client <strong>finish</strong>.  </li>\n<li>Here inside struct server_info there can be another callback function <code>on_client_disconnected</code></li>\n<li>Now outside this multithreaded server running in the background I have a GUI app that started the server, and it has the pointer to server_info_t structure that stores all information about server: port number, passive socket, linked_list of actually connected connection sockets (active sockets), callback functions pointers that should be called to inform about server events, etc. \nSo I think I could then make <code>end_server(server_info_t)</code> (ex. when user clicks <strong>STOP</strong> in <strong>GUI application</strong> user interface) and heres the magic happens... server stops. But how? </li>\n</ol>\n\n<p><strong>Should I take all connection sockets (while iteration over linked list in server_info_t structure) and close them using (shutdown + close), and then shutdown + close passive socket?</strong> </p>\n\n<p>Then I could even call some callback <code>on_server_end</code> which pointer I found in server_info_t structure. </p>\n\n<p>Should I use some mutex to synchronise access to this server_info_t structure? </p>\n"}, {"tags": ["c", "fgets", "spaces"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496859055, "post_id": 44419891, "comment_id": 75838314, "body": "What have you tried? The little code you posted has a syntax error."}, {"owner": {"reputation": 299, "user_id": 8098031, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78dd9fe580393ca0598cf1b022088b43?s=128&d=identicon&r=PG&f=1", "display_name": "StackUser", "link": "https://stackoverflow.com/users/8098031/stackuser"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496859128, "post_id": 44419891, "comment_id": 75838354, "body": "I edited it. now it&#39;s ok?"}, {"owner": {"reputation": 299, "user_id": 8098031, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78dd9fe580393ca0598cf1b022088b43?s=128&d=identicon&r=PG&f=1", "display_name": "StackUser", "link": "https://stackoverflow.com/users/8098031/stackuser"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496859240, "post_id": 44419891, "comment_id": 75838404, "body": "In generally, i tried to use &#39;strtok&#39;, but i  don&#39;t success to acheive a final solution for this problem."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 2, "creation_date": 1496859328, "post_id": 44419891, "comment_id": 75838450, "body": "@StackUser: It still doesn&#39;t show what you&#39;ve tried. Note that an exercise like this is typically given as homework, which means smart people are reluctant to give any kind of &quot;cut &amp; paste &amp; learn nothing&quot; answer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496859349, "post_id": 44419891, "comment_id": 75838461, "body": "Iterate through the string. Copy characters from one index to another. Replace any tab with space. Advance the target index if the character is not whitespace, or only 1 whitespace. Don&#39;t forget to write a new string terminator."}, {"owner": {"reputation": 299, "user_id": 8098031, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78dd9fe580393ca0598cf1b022088b43?s=128&d=identicon&r=PG&f=1", "display_name": "StackUser", "link": "https://stackoverflow.com/users/8098031/stackuser"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1496859875, "post_id": 44419891, "comment_id": 75838732, "body": "@Brendan What you want to see? a way that is not working?  If I knew how to solve this problem - I would not ask..."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1496864305, "post_id": 44419891, "comment_id": 75841316, "body": "@StackUser: Yes - some code that doesn&#39;t work, that shows that you actually tried to solve the problem and also gives people some idea which part/s of C you&#39;re having trouble with (pointers? array indexing? loops?)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1497094530, "post_id": 44419891, "comment_id": 75941201, "body": "@StackUser: you can accept one o the answers by clicking on the grey checkmark below its score."}], "answers": [{"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 1, "last_activity_date": 1496868068, "creation_date": 1496868068, "answer_id": 44422374, "question_id": 44419891, "link": "https://stackoverflow.com/questions/44419891/in-given-a-line-from-some-file-or-stdin-how-can-i-reduce-the-extra-spaces-and/44422374#44422374", "title": "In given a line from some file (or stdin) how can i reduce the extra spaces and convert the tabs to single space?", "body": "<p>like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar *reduce_and_trim(char *s);\n\nint main(void) {\n    FILE *input_file = stdin;\n    char line[50];\n    while (fgets(line,50, input_file) != NULL) {\n        printf(\"'%s'\\n\", reduce_and_trim(line));\n    }\n    fclose(input_file);\n}\n\n#include &lt;string.h&gt;\n\nchar *reduce_and_trim(char *s){\n    static const char *whitespaces = \" \\t\\n\";//\\t:tab, \\n:newline, omit \\f\\r\\v\n    size_t src = strspn(s, whitespaces);//Trim of the beginning\n    size_t des = 0;//destination\n    size_t spc = 0;//number of whitespaces\n\n    while(s[src] != '\\0'){\n        if((spc = strspn(s+src, whitespaces)) != 0){\n            src += spc;\n            s[des++] = ' ';//reduce spaces\n        } else {\n            s[des++] = s[src++];\n        }\n    }\n    if(des &amp;&amp; s[des-1] == ' ')\n        s[des-1] = 0;//Trim of end\n    else\n        s[des] = 0;\n\n    return s;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1496904499, "last_edit_date": 1496904499, "creation_date": 1496869247, "answer_id": 44422676, "question_id": 44419891, "link": "https://stackoverflow.com/questions/44419891/in-given-a-line-from-some-file-or-stdin-how-can-i-reduce-the-extra-spaces-and/44422676#44422676", "title": "In given a line from some file (or stdin) how can i reduce the extra spaces and convert the tabs to single space?", "body": "<p>Here is a simple solution:</p>\n\n<pre><code>char line[50];\nwhile (fgets(line, sizeof line, input_file) != NULL) {\n    size_t i, j;\n    for (i = j = 0; line[i] != '\\0'; i++) {\n        if (isspace((unsigned char)line[i])) {\n            while (isspace((unsigned char)line[++i]))\n                continue;\n            if (line[i] == '\\0')\n                break;\n            if (j != 0)\n                line[j++] = ' ';\n        }\n        line[j++] = line[i];\n    }\n    line[j] = '\\0';\n    printf(\"reduced input: |%s|\\n\", line);\n}\n</code></pre>\n\n<p>Now since this is homework, here are a few extra questions to answer:</p>\n\n<ul>\n<li>which include files are required?</li>\n<li>why is the cast <code>(unsigned char)line[i]</code> needed?</li>\n<li>what will happen if a line longer than 50 bytes is read from <code>input_file</code>?</li>\n<li>what is wrong with the previous question?</li>\n</ul>\n"}], "owner": {"reputation": 299, "user_id": 8098031, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78dd9fe580393ca0598cf1b022088b43?s=128&d=identicon&r=PG&f=1", "display_name": "StackUser", "link": "https://stackoverflow.com/users/8098031/stackuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496904499, "creation_date": 1496858911, "last_edit_date": 1496859113, "question_id": 44419891, "link": "https://stackoverflow.com/questions/44419891/in-given-a-line-from-some-file-or-stdin-how-can-i-reduce-the-extra-spaces-and", "title": "In given a line from some file (or stdin) how can i reduce the extra spaces and convert the tabs to single space?", "body": "<p>In given a line that exist in array. Like in this case:</p>\n\n<pre><code>char line[50];\nwhile (fgets(line,50, input_file) != NULL) {\n // how can i do it here..\n}\n</code></pre>\n\n<p>How can i reduce all the extra spaces to single space , and to reduce all the tabs (between any two words) to a single space.  </p>\n\n<p><strong>For example:</strong><br>\nIn give this line:  </p>\n\n<pre><code>   a b   abb     ace    ab \n</code></pre>\n\n<p>It's need to be:  </p>\n\n<pre><code>a b abb ace ab\n</code></pre>\n"}, {"tags": ["c", "mplab", "pic18"], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496869840, "post_id": 44420515, "comment_id": 75844111, "body": "@AndreKampling Consider <a href=\"https://meta.stackoverflow.com/a/266312/2410359\">nor is it polite...</a>"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1496901763, "post_id": 44420515, "comment_id": 75853460, "body": "@chuc: Thank you for your hint. I don&#39;t know that before and won&#39;t do that again."}, {"owner": {"reputation": 127, "user_id": 6597073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecda0dbea3860bcac877ced046dda84?s=128&d=identicon&r=PG&f=1", "display_name": "vt673", "link": "https://stackoverflow.com/users/6597073/vt673"}, "edited": false, "score": 0, "creation_date": 1500450809, "post_id": 44420515, "comment_id": 77336317, "body": "@AndreKampling, got it"}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": true, "score": 4, "last_activity_date": 1500451268, "last_edit_date": 1500451268, "creation_date": 1496861058, "answer_id": 44420515, "question_id": 44419777, "link": "https://stackoverflow.com/questions/44419777/pic18f2220-led-blinking-program-error/44420515#44420515", "title": "PIC18F2220 LED blinking program error", "body": "<p>You miss to include <code>#include &lt;xc.h&gt;</code>, instead you just set your configuration bits. The <code>xc.h</code> is the main header file that will include a lot of other header files that finally point to your special controller header file <code>#include &lt;pic18f2220.h&gt;</code>. It's done with <code>#ifdef</code> constructs that your MPLAB IDE should provide because you initially set the controller when creating a new project.</p>\n\n<p>This <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/50002173A.pdf\" rel=\"nofollow noreferrer\">guide from Microchip</a> is very helpful as beginning because it explains a lot.</p>\n\n<p>If you don't include the <code>&lt;xc.h&gt;</code> header file the register names of your controller are not known to the compiler. That is the reason for your errors.</p>\n"}], "owner": {"reputation": 127, "user_id": 6597073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecda0dbea3860bcac877ced046dda84?s=128&d=identicon&r=PG&f=1", "display_name": "vt673", "link": "https://stackoverflow.com/users/6597073/vt673"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 44420515, "answer_count": 1, "score": -4, "last_activity_date": 1500451268, "creation_date": 1496858508, "last_edit_date": 1497264662, "question_id": 44419777, "link": "https://stackoverflow.com/questions/44419777/pic18f2220-led-blinking-program-error", "title": "PIC18F2220 LED blinking program error", "body": "<p>I am a beginner in PIC programming. <a href=\"https://www.youtube.com/watch?v=mUofSucHx_E&amp;list=PL3lfkED2i6JcJH-OETxsI43e8M-7eLeL-\" rel=\"nofollow noreferrer\">This video</a> I have used to code my first program.</p>\n\n<p>This is the code I have written:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"XC8.h\"\n\nvoid main(void)\n{\n   TRISBbits.RB0 = 0;\n   OSCCON = 0x76;\n\n   while(1)\n   {\n      LATBbits.LATB0 = ~LATBbits.LATB0;\n\n      for (int countDelay=0; countDelay&lt;20; countDelay++) __delay_ms(50);\n   } \n}\n</code></pre>\n\n<p>And my <code>XC8.h</code> header file is:</p>\n\n<pre><code>// PIC18F2220 Configuration Bit Settings\n\n// 'C' source line config statements\n\n// CONFIG1H\n#pragma config OSC = RC         // Oscillator Selection bits (External RC oscillator, CLKO function on RA6)\n#pragma config FSCM = OFF       // Fail-Safe Clock Monitor Enable bit (Fail-Safe Clock Monitor disabled)\n#pragma config IESO = OFF       // Internal/External Switchover bit (Internal/External Switchover mode disabled)\n\n// CONFIG2L\n#pragma config PWRT = OFF       // Power-up Timer enable bit (PWRT disabled)\n#pragma config BOR = OFF        // Brown-out Reset enable bit (Brown-out Reset disabled)\n#pragma config BORV = 20        // Brown-out Reset Voltage bits (VBOR set to 2.0V)\n\n// CONFIG2H\n#pragma config WDT = ON         // Watchdog Timer Enable bit (WDT enabled)\n#pragma config WDTPS = 32768    // Watchdog Timer Postscale Select bits (1:32768)\n\n// CONFIG3H\n#pragma config CCP2MX = ON      // CCP2 MUX bit (CCP2 input/output is multiplexed with RC1)\n#pragma config PBAD = ANA       // PORTB A/D Enable bit (PORTB&lt;4:0&gt; pins are configured as analog input channels on Reset)\n#pragma config MCLRE = OFF      // MCLR Pin Enable bit (MCLR disabled; RE3 input is enabled in 40-pin devices only (PIC18F4X20))\n\n// CONFIG4L\n#pragma config STVR = ON        // Stack Full/Underflow Reset Enable bit (Stack full/underflow will cause Reset)\n#pragma config LVP = ON         // Single-Supply ICSP Enable bit (Single-Supply ICSP enabled)\n\n// CONFIG5L\n#pragma config CP0 = OFF        // Code Protection bit (Block 0 (000200-0007FFh) not code-protected)\n#pragma config CP1 = OFF        // Code Protection bit (Block 1 (000800-000FFFh) not code-protected)\n\n// CONFIG5H\n#pragma config CPB = OFF        // Boot Block Code Protection bit (Boot block (000000-0001FFh) is not code-protected)\n#pragma config CPD = OFF        // Data EEPROM Code Protection bit (Data EEPROM is not code-protected)\n\n// CONFIG6L\n#pragma config WRT0 = OFF       // Write Protection bit (Block 0 (000200-0007FFh) not write-protected)\n#pragma config WRT1 = OFF       // Write Protection bit (Block 1 (000800-000FFFh) not write-protected)\n\n// CONFIG6H\n#pragma config WRTC = OFF       // Configuration Register Write Protection bit (Configuration registers (300000-3000FFh) are not write-protected)\n#pragma config WRTB = OFF       // Boot Block Write Protection bit (Boot block (000000-0001FFh) is not write-protected)\n#pragma config WRTD = OFF       // Data EEPROM Write Protection bit (Data EEPROM is not write-protected)\n\n// CONFIG7L\n#pragma config EBTR0 = OFF      // Table Read Protection bit (Block 0 (000200-0007FFh) not protected from table reads executed in other blocks)\n#pragma config EBTR1 = OFF      // Table Read Protection bit (Block 1 (000800-000FFFh) not protected from table reads executed in other blocks)\n\n// CONFIG7H\n#pragma config EBTRB = OFF      // Boot Block Table Read Protection bit (Boot block (000000-0001FFh) is not protected from table reads executed in other blocks)\n\n// #pragma config statements should precede project file includes.\n// Use project enums instead of #define for ON and OFF.\n\n#define _XTAL_FREQ 8000000\n</code></pre>\n\n<p>I have followed all the steps as provided in the tutorial but I am getting the following error when I try to build the program.</p>\n\n<pre><code>make -f nbproject/Makefile-default.mk SUBPROJECTS= .build-conf\nmake[1]: Entering directory 'E:/Projects/Coding/MPLABX/Programming/XC8/XC8.X'\nmake  -f nbproject/Makefile-default.mk dist/default/production/XC8.X.production.hex\nmake[2]: Entering directory 'E:/Projects/Coding/MPLABX/Programming/XC8/XC8.X'\n\"C:\\Program Files (x86)\\Microchip\\xc8\\v1.42\\bin\\xc8.exe\" --pass1  --chip=18F2220 -Q -G  --double=24 --float=24 --emi=wordwrite --opt=+asm,+asmfile,-speed,+space,-debug --addrqual=ignore --mode=free -P -N255 --warn=-3 --asmlist -DXPRJ_default=default  --summary=default,-psect,-class,+mem,-hex,-file --output=default,-inhx032 --runtime=default,+clear,+init,-keep,-no_startup,-download,+config,+clib,-plib   --output=-mcof,+elf:multilocs --stack=compiled:auto:auto:auto \"--errformat=%f:%l: error: (%n) %s\" \"--warnformat=%f:%l: warning: (%n) %s\" \"--msgformat=%f:%l: advisory: (%n) %s\"    -obuild/default/production/XC8.p1  XC8.c \nXC8.c:15: error: (192) undefined identifier \"TRISBbits\"\nXC8.c:15: error: (196) struct/union required\nXC8.c:16: error: (192) undefined identifier \"OSCCON\"\nXC8.c:20: error: (192) undefined identifier \"LATBbits\"\nXC8.c:20: error: (196) struct/union required\nXC8.c:20: error: (196) struct/union required\nXC8.c:22: warning: (361) function declared implicit int\n(908) exit status = 1\nnbproject/Makefile-default.mk:100: recipe for target 'build/default/production/XC8.p1' failed\nmake[2]: Leaving directory 'E:/Projects/Coding/MPLABX/Programming/XC8/XC8.X'\nnbproject/Makefile-default.mk:84: recipe for target '.build-conf' failed\nmake[1]: Leaving directory 'E:/Projects/Coding/MPLABX/Programming/XC8/XC8.X'\nnbproject/Makefile-impl.mk:39: recipe for target '.build-impl' failed\nmake[2]: *** [build/default/production/XC8.p1] Error 1\nmake[1]: *** [.build-conf] Error 2\nmake: *** [.build-impl] Error 2\n\nBUILD FAILED (exit value 2, total time: 467ms)\n</code></pre>\n\n<p>Hope I have added sufficient input for the query. Since I am new to this section please feel free to ask for further information.</p>\n"}, {"tags": ["c", "bmp"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1496858402, "post_id": 44419415, "comment_id": 75837981, "body": "640 = 2*256 + 128; 480 = 256 + 224"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496858465, "post_id": 44419415, "comment_id": 75838017, "body": "I would recommend defining a header <code>struct</code> and reading the whole thing in, using functions to extract members in the correct endian fashion, or a byte array ditto."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496858679, "post_id": 44419415, "comment_id": 75838118, "body": "Another issue: <code>fopen_s(&amp;Pic, &quot;d2.bmp&quot;, &quot;r&quot;);</code> --&gt; <code>fopen_s(&amp;Pic, &quot;d2.bmp&quot;, &quot;rb&quot;);</code>  Add <code>b</code>.  Open file in binary mode."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496857722, "post_id": 44419507, "comment_id": 75837600, "body": "I don&#39;t think you can depend on the <code>fgetc()</code> calls being executed left to right. Do them as separate statements."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 1, "last_activity_date": 1496857766, "last_edit_date": 1496857766, "creation_date": 1496857604, "answer_id": 44419507, "question_id": 44419415, "link": "https://stackoverflow.com/questions/44419415/c-bmp-header-contains-wrong-information/44419507#44419507", "title": "C bmp header contains wrong information", "body": "<p><code>fgetc()</code> fetches a single byte from the file. The height and width values are stored as 32-bit little-endian. 640 is 0x280, and 480 is 0x1E0, so the values you are getting are 0x80 (128) and 0xE0 (224), just the low-order byte of the values.</p>\n\n<p>Try something like</p>\n\n<pre><code>PictureWidth = fgetc(Pic);\nPictureWidth += 256 * fgetc(Pic);\n</code></pre>\n\n<p>(Yes, they really are 32-bit values, which is four bytes, but it's unlikely that you'll run into a 70000-pixel wide BPM anytime soon).</p>\n"}], "owner": {"reputation": 3, "user_id": 8127144, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gn9-dsmio-s/AAAAAAAAAAI/AAAAAAAABUY/mGgSyA0viWE/photo.jpg?sz=128", "display_name": "Yellow", "link": "https://stackoverflow.com/users/8127144/yellow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 44419507, "answer_count": 1, "score": -2, "last_activity_date": 1496857766, "creation_date": 1496857246, "question_id": 44419415, "link": "https://stackoverflow.com/questions/44419415/c-bmp-header-contains-wrong-information", "title": "C bmp header contains wrong information", "body": "<p>I am trying to get the height and width of a bmp picture, however the values i am getting are incorrect and are not the actual size of the picture.<br>\nHere is my code for doing so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid main() {\nFILE * Pic;\nerrno_t err;\nint **PixelStrength;\nint PictureWidth, PictureHeight;\n\n\nerr = fopen_s(&amp;Pic, \"d2.bmp\", \"r\");\nif (!err)\n{\n\n    fseek(Pic, 18, SEEK_SET);\n    PictureWidth = fgetc(Pic);\n    fseek(Pic, 22, SEEK_SET);\n    PictureHeight = fgetc(Pic);\n}\n\n\nif (Pic)\n{\n    err = fclose(Pic);\n}\n}\n</code></pre>\n\n<p>I should note that this has worked for a small picture however not for any larger one. The pictures that i have tried are 640 x 480 yet the values i receive are 128 x 224. Thank you for your help.</p>\n"}, {"tags": ["c", "c-preprocessor", "qemu"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496856950, "post_id": 44419251, "comment_id": 75837185, "body": "Please read, <a href=\"https://meta.stackexchange.com/questions/22186/how-do-i-format-my-code-blocks\" title=\"how do i format my code blocks\">meta.stackexchange.com/questions/22186/&hellip;</a>. You are not a new member !"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1496857311, "post_id": 44419251, "comment_id": 75837387, "body": "&quot;<i><code>\u2018be\u2019 undeclared</code></i>&quot; well .. how and where are <code>be</code> and <code>le</code> defined?"}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "edited": false, "score": 0, "creation_date": 1496857447, "post_id": 44419251, "comment_id": 75837453, "body": "I never knew it was required to wrap in sentence code. I&#39;ve done it many times and no one has ever corrected me. The code block fix was a copy/paste error on my part. I read the link you posted and will try to utilize it in my questions moving forward. Thanks"}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1496857585, "post_id": 44419251, "comment_id": 75837530, "body": "@alk So again, this is QEMU code, not mine. I can do a search, but my understanding is &quot;be&quot;/&quot;le&quot; are not variables, but tokens to be operated on by the pre-processor. They should not have to be defined as they will become parts of function names after the pre-processor acts on them."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1496857919, "post_id": 44419251, "comment_id": 75837712, "body": "&quot;<i>... they will become parts of function names</i>&quot; yes, correct. But <i>additionally</i> they are passed to the <code>glue()</code> &quot;function calls&quot; (or what ever this is, as you do not show this to us)  as 1st parameter. The compiler&#39;s error message notify on this."}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "edited": false, "score": 0, "creation_date": 1496859144, "post_id": 44419251, "comment_id": 75838361, "body": "I can double check, but I&#39;m fairly certain that <code>glue()</code> is also a pre-processor macro. It is found in <code>{QEMU_Root}&#47;include&#47;qemu&#47;compiler.h</code>. I have updated the question to show this."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 2, "creation_date": 1496859425, "post_id": 44419251, "comment_id": 75838502, "body": "Can you compile the problem module using the option <code>-E</code> to capture the preprocessor output and show what the preprocessor is generating for the <code>CPU_CONVERT(be, 16, uint16_t)</code> line?  (just post the results for that one line)."}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "edited": false, "score": 0, "creation_date": 1496860034, "post_id": 44419251, "comment_id": 75838814, "body": "I&#39;ll see if I can get it to do that."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1496872786, "post_id": 44419251, "comment_id": 75845297, "body": "Are you certain that the header defining <code>glue</code> has been #included?"}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1496887756, "post_id": 44419251, "comment_id": 75849388, "body": "E.g., something in your library might just decide to <code>#define _bswap</code> to track something.  Now <code>_bswap</code> is an object like macro that expands to nothing, and thus if <code>endian</code> is <code>be</code>, then <code>glue(endian,_bswap)</code> becomes <code>be</code> rather than the intended <code>be_bswap</code>."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1496888767, "post_id": 44419251, "comment_id": 75849620, "body": "(delete/correct of previous comment): You really should change <code>glue(endian,_bswap)</code> and variants to something like <code>glue(glue(endian,_),bswap)</code>. This might be your problem but it&#39;s impossible to tell without your environment; but identifiers beginning with an underscore are reserved by your implementation and, by using such identifiers in an indirect-paste (aka glue macro), you&#39;re allowing such things to fiddle with what you&#39;re doing"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1496906670, "post_id": 44419251, "comment_id": 75856252, "body": "@HWalters: The implementation can only define macros starting with two underscores or an underscore followed by a capital letter. <code>_bswap</code> might be an &quot;identifier with file scope&quot;, but not a macro. So it&#39;s ok in this context. (In theory). (See section 7.1.3, also 6.10.8/2)"}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "edited": false, "score": 0, "creation_date": 1496930593, "post_id": 44419251, "comment_id": 75873240, "body": "I was working on getting the pre-processor output via the -E option in the make file, but didn&#39;t have much luck going down that route. I&#39;ll check the includes to ensure compiler.h is indeed included."}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1496952489, "post_id": 44419251, "comment_id": 75886925, "body": "@rici You hit the nail on the head. An older version of QEMU I was used to had the file <code>include&#47;qemu&#47;compiler.h</code> included in the files I included for my project. The newest version of QEMU (2.9.0 at the time of writing) has imports re-organized in a way that required me to include something that has <code>include&#47;qemu&#47;compiler.h</code> in it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1496954419, "post_id": 44419251, "comment_id": 75887930, "body": "So the problem is solved now?"}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "edited": false, "score": 1, "creation_date": 1497017844, "post_id": 44419251, "comment_id": 75916603, "body": "Yes. The problem was <code>glue</code> being treated as a function and not a pre-processor macro. Once the proper header file with the <code>glue</code> definition was included, it compiled."}, {"owner": {"reputation": 5487, "user_id": 4499941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wb0uIu6LiPk/AAAAAAAAAAI/AAAAAAAAABI/HOVGfYywvPE/photo.jpg?sz=128", "display_name": "Peter Maydell", "link": "https://stackoverflow.com/users/4499941/peter-maydell"}, "edited": false, "score": 0, "creation_date": 1497350634, "post_id": 44419251, "comment_id": 76030247, "body": "FYI, every source file in QEMU should have access to the definitions in compiler.h, because the rule is that every .c file should #include &quot;qemu/osdep.h&quot; as the first #include it does, and osdep.h includes compiler.h. (And so no .c file should directly include compiler.h.)"}, {"owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "edited": false, "score": 0, "creation_date": 1497379027, "post_id": 44419251, "comment_id": 76049979, "body": "Yes that is the header I ended up including. Is that rule in documentation somewhere? I am trying to do things the proper QEMU way, but I have a hard time finding documentation on implementing new boards/machines."}], "owner": {"reputation": 692, "user_id": 3098124, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/KCsxV.jpg?s=128&g=1", "display_name": "MrJman006", "link": "https://stackoverflow.com/users/3098124/mrjman006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1496859397, "creation_date": 1496856697, "last_edit_date": 1496859397, "question_id": 44419251, "link": "https://stackoverflow.com/questions/44419251/pre-processor-concatenation-failing", "title": "Pre-Processor Concatenation Failing", "body": "<p>I am doing some work in QEMU v2.9.0 (The latest tagged version) and in the <code>{QEMU_Root}/include/qemu/bswap.h</code> file they are generating some functions based on endianess.</p>\n\n<p>The code is shown below:</p>\n\n<pre><code>#define CPU_CONVERT(endian, size, type)\\\nstatic inline type endian ## size ## _to_cpu(type v)\\\n{\\\n    return glue(endian, _bswap)(v, size);\\\n}\\\n\\\nstatic inline type cpu_to_ ## endian ## size(type v)\\\n{\\\n    return glue(endian, _bswap)(v, size);\\\n}\\\n\\\nstatic inline void endian ## size ## _to_cpus(type *p)\\\n{\\\n    glue(endian, _bswaps)(p, size);\\\n}\\\n\\\nstatic inline void cpu_to_ ## endian ## size ## s(type *p)\\\n{\\\n    glue(endian, _bswaps)(p, size);\\\n}\\\n\nCPU_CONVERT(be, 16, uint16_t)\nCPU_CONVERT(be, 32, uint32_t)\nCPU_CONVERT(be, 64, uint64_t)\n\nCPU_CONVERT(le, 16, uint16_t)\nCPU_CONVERT(le, 32, uint32_t)\nCPU_CONVERT(le, 64, uint64_t)\n</code></pre>\n\n<p>I don't need to touch this code, but for some reason it is not compiling properly. I keep getting the error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/home/xubuntu/Development/QEMU/Source/v2.9.0/include/qemu/bswap.h:162:13: error: \u2018be\u2019 undeclared (first use in this function)\n CPU_CONVERT(be, 16, uint16_t)\n             ^\n/home/xubuntu/Development/QEMU/Source/v2.9.0/include/qemu/bswap.h:144:17: note: in definition of macro \u2018CPU_CONVERT\u2019\n     return glue(endian, _bswap)(v, size);\\\n                 ^\n/home/xubuntu/Development/QEMU/Source/v2.9.0/include/qemu/bswap.h:162:13: note: each undeclared identifier is reported only once for each function it appears in\n CPU_CONVERT(be, 16, uint16_t)\n             ^\n/home/xubuntu/Development/QEMU/Source/v2.9.0/include/qemu/bswap.h:144:17: note: in definition of macro \u2018CPU_CONVERT\u2019\n     return glue(endian, _bswap)(v, size);\\\n</code></pre>\n\n<p>The same error shows up for <code>\"le\"</code>. Any ideas what might cause something like this to happen?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>In the comments there was some confusion about what the <code>glue</code> function call actually is. It is also a pre-processor macro defined in <code>{QEMU_Root}/include/qemu/compiler.h</code></p>\n\n<pre><code>#define xglue(x, y) x ## y\n#define glue(x, y) xglue(x, y)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496856441, "post_id": 44419151, "comment_id": 75836913, "body": "Code never reads a <code>&#39;-&#39;</code>, so scanning is stuck on that.  <code>&#39;-&#39;</code> remains in <code>fp</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496856510, "post_id": 44419151, "comment_id": 75836944, "body": "<code>station</code>? And shouldn&#39;t the test from <code>fscanf</code> be <code>==1</code>?"}, {"owner": {"reputation": 434, "user_id": 7327911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c5145eaed87b7d8085486c8c89b69a3?s=128&d=identicon&r=PG&f=1", "display_name": "Theo.Fanis", "link": "https://stackoverflow.com/users/7327911/theo-fanis"}, "edited": false, "score": 0, "creation_date": 1496856606, "post_id": 44419151, "comment_id": 75837009, "body": "fixed that,sorry"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496856619, "post_id": 44419151, "comment_id": 75837015, "body": "Please post your actual <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem, which you compiled, ran, and verified. It seems as if you are guessing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496856658, "post_id": 44419151, "comment_id": 75837035, "body": "<code>if(fscanf(fp, &quot;%[^-]&quot;, word) == EOF) break;</code>  --&gt; what should code do if <code>fscanf()</code> returned 0?"}, {"owner": {"reputation": 21412, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 0, "creation_date": 1496856684, "post_id": 44419151, "comment_id": 75837043, "body": "Your &quot;minimal verifiable&quot; code doesn&#39;t compile. Please fix! Also, note that <code>sizeof(word)</code> doesn&#39;t do what you want it to."}], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 7327911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c5145eaed87b7d8085486c8c89b69a3?s=128&d=identicon&r=PG&f=1", "display_name": "Theo.Fanis", "link": "https://stackoverflow.com/users/7327911/theo-fanis"}, "edited": false, "score": 0, "creation_date": 1496857461, "post_id": 44419349, "comment_id": 75837462, "body": "Is there any way to know whether <code>fscanf</code> delimits <code>\\n</code> ? To know when the line have changed"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 434, "user_id": 7327911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c5145eaed87b7d8085486c8c89b69a3?s=128&d=identicon&r=PG&f=1", "display_name": "Theo.Fanis", "link": "https://stackoverflow.com/users/7327911/theo-fanis"}, "edited": false, "score": 1, "creation_date": 1496857629, "post_id": 44419349, "comment_id": 75837550, "body": "@Theo.Fanis To know when the line have changed, code could use <code>char delimit[2]; fscanf(fp, &quot;%1[-\\n]&quot;, delimit);</code> and test <code>delimit[0]</code>, but better code would instead read a <i>line</i> as a time with <code>fgets()</code> and then parse the line for the &quot;words&quot;."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1496857044, "creation_date": 1496857044, "answer_id": 44419349, "question_id": 44419151, "link": "https://stackoverflow.com/questions/44419151/reading-words-from-file-with-fscanf/44419349#44419349", "title": "Reading words from file with fscanf", "body": "<p>Limit input with a width specifier of 39, 1 less than the 40 bytes available to <code>word</code> as <code>fscanf()</code> will append a <em>null character</em>.  Continue reading as long as successful in that <code>fscanf()</code> returned 1.  Consume the following delimiter be it a <code>'-'</code> or <code>'\\n'</code>,</p>\n\n<pre><code>while(fscanf(fp, \"%39[^-\\n]\", word) == 1) {\n    printf(\"&lt;%s&gt;\\n\",word);\n    fscanf(fp, \"%*[-\\n]\"); // consume delimiter, no need to save.\n}\n</code></pre>\n\n<p>Note: Use <code>[^-\\n]</code> and not <code>[^\\n-]</code> as placing the <code>-</code> later looks like the beginning of an incomplete <em>scan-set</em> range.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496858169, "post_id": 44419528, "comment_id": 75837848, "body": "I don&#39;t see any answer containing regex"}, {"owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "edited": false, "score": 0, "creation_date": 1496858279, "post_id": 44419528, "comment_id": 75837908, "body": "@FelixPalmen, what I meant by regex is the messy <code>%39[^-\\n]</code> part, which is obviously confusing. You could just split the string upon a delimiter which is more simple"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496949268, "post_id": 44419528, "comment_id": 75885261, "body": "<code>%39[^-\\n]</code> is not a regular expression, and is not at all confusing if you have read the documentation for the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2\" rel=\"nofollow noreferrer\"><code>scanf()</code> family of functions</a>."}], "tags": [], "owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "is_accepted": false, "score": 1, "last_activity_date": 1496857649, "creation_date": 1496857649, "answer_id": 44419528, "question_id": 44419151, "link": "https://stackoverflow.com/questions/44419151/reading-words-from-file-with-fscanf/44419528#44419528", "title": "Reading words from file with fscanf", "body": "<p>The above answer works just fine, If you don't want regex complications in your code even though it's simple, use <code>strtok</code> after reading the whole string out. Then add it onto the array. </p>\n\n<pre><code>while(1){\n    if(fscanf(fp, \"%s\", word) == EOF) break;\n    printf(\"%s\\n\",word);\n    const char s[2] = \"-\";\n    char *token;\n    token = strtok(word, s);\n    while( token != NULL ) \n    {\n        printf(\"%s\\n\", token );\n        token = strtok(NULL, s);\n    }\n}\n</code></pre>\n\n<p>Which gives the output</p>\n\n<pre><code>Alpha-Beta-Gamma-Delta-Epsilon\n\nAlpha\nBeta\nGamma\nDelta\nEpsilon\n\nZeta-Eta-Theta-Iota-Kappa-Lamda-Mi\n\nZeta\nEta\nTheta\nIota\nKappa\nLamda\nMi\n\nNi-Ksi-Pi-Ro-Sigma\n\nNi\nKsi\nPi\nRo\nSigma\n</code></pre>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 434, "user_id": 7327911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c5145eaed87b7d8085486c8c89b69a3?s=128&d=identicon&r=PG&f=1", "display_name": "Theo.Fanis", "link": "https://stackoverflow.com/users/7327911/theo-fanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4472, "favorite_count": 0, "accepted_answer_id": 44419349, "answer_count": 2, "score": 3, "last_activity_date": 1496857649, "creation_date": 1496856333, "last_edit_date": 1496856568, "question_id": 44419151, "link": "https://stackoverflow.com/questions/44419151/reading-words-from-file-with-fscanf", "title": "Reading words from file with fscanf", "body": "<p>I have a file .txt with the following encoding:</p>\n\n<pre><code>Alpha-Beta-Gamma-Delta-Epsilon\nZeta-Eta-Theta-Iota-Kappa-Lamda-Mi\nNi-Ksi-Pi-Ro-Sigma\n</code></pre>\n\n<p>I want to read those words and store them in an array.\nI read those words with <code>fscanf(fp, \"%[^-]\", word)</code></p>\n\n<p>But when I put <code>fscanf</code> inside a while, it keeps reading the same word. If I put it inside the while statement it doesn't repeat.</p>\n\n<p><strong>The point is to read every word separately from Alpha to Sigma</strong></p>\n\n<p>I provide you a minimal-verifiable code with the problem:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    FILE *fp;\n    char *word = (char*)malloc(40);\n    int count = 0;\n    char* Words[30]; //max 30\n    fp = fopen(\"MyWords.txt\",\"r\"); //read only\n    int r = 1;\n    while(1){\n        if(fscanf(fp, \"%[^-]\", word) == EOF) break;\n        printf(\"%s\",word);\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Note:</strong> I don't want to modify the file. Also how should I handle with the <code>\\n</code> characheter</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1496855617, "post_id": 44418894, "comment_id": 75836501, "body": "I think you need to go and read about basic C syntax and semantics. This stuff unlikely to work as you expect even after you fix the syntax."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496855669, "post_id": 44418894, "comment_id": 75836533, "body": "For the 32 and 16 bit variants, use <code>uint32_t</code> and <code>uint16_t</code> (see e.g. <a href=\"http://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\">this fixed-width integer reference</a> for information about those types). Like simply <code>((uint32_t *) address) = 0x........</code>. For the 24-bit you probably have to do some manual solution where you set each byte individually. Can be simplified with a function or even a macro (though I recommend an <code>inline</code> function for it)."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1496855856, "post_id": 44418894, "comment_id": 75836617, "body": "When filling a framebuffer to a fixed color, you only need to duplicate the same 12 byte sequence to the entire framebuffer. If you have 8 bits per pixel, then all those bytes are the same, specifying the color for 12 pixels. If you have 16 bits per pixel, then those bytes specify the color for 6 consecutive pixels. If you have 24 bits per pixel, then those bytes specify the color for 4 consecutive pixels. If you have 32 bits per pixel, then those bytes specify the color for 3 consecutive pixels. So, you only need a function that can copy a 12-byte sequence over the entire framebuffer."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1496859015, "post_id": 44418894, "comment_id": 75838285, "body": "If 4-byte pixels are the largest pixel size, then just use a 4-byte variable <code>unsigned char pixel[4]</code>.  Use the low <code>pixelSize</code> bytes in your code."}, {"owner": {"reputation": 19036, "user_id": 308079, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9fc5a15f52c68f1cbcf6c1d47fdca21c?s=128&d=identicon&r=PG", "display_name": "Justin808", "link": "https://stackoverflow.com/users/308079/justin808"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496860034, "post_id": 44418894, "comment_id": 75838813, "body": "@NominalAnimal How do you deal with the pitch at the end of each line?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1496863725, "post_id": 44418894, "comment_id": 75840948, "body": "@Justin808: By ignoring it. The framebuffer aperture consists of rows of pixels, where each row is the same size (<code>pitch</code> bytes), and starts at offset <code>row * pitch</code>. The possible padding at the end of the row is unused, and only exists when the hardware prefers each row to start at an aligned address. The padding never contains non-pixel data. It is easy for hardware manufacturers to set the devices up this way, and framebuffer libraries definitely expect this, so this just happens to be the way all normal/ordinary framebuffer hardware is expected to work."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1496863880, "post_id": 44418894, "comment_id": 75841060, "body": "@Justin808: Note that there are display devices with odd requirements, that nevertheless might provide a somewhat framebuffer-like interface. Some e-ink devices could be such. However, they also tend to have other, weirder requirements (like update types and restrictions on e-ink devices) that means you cannot use a general-purpose framebuffer library on them anyway -- unless you bolt on a lot of extra functionality on top. In which case it&#39;s better to create a specialized library anyway. You mentioned no hardware quirks, so I assumed you know of none. (Most often there are none.)"}], "owner": {"reputation": 19036, "user_id": 308079, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9fc5a15f52c68f1cbcf6c1d47fdca21c?s=128&d=identicon&r=PG", "display_name": "Justin808", "link": "https://stackoverflow.com/users/308079/justin808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496855449, "creation_date": 1496855449, "question_id": 44418894, "link": "https://stackoverflow.com/questions/44418894/memory-manipulation-in-c", "title": "Memory manipulation in C", "body": "<p>I have an algorithm I would like to try get working, I guess you could call it pseudo C because it doesn't compile.</p>\n\n<pre><code>void framebufferClearScreen (framebufferColor color) {\n  unsigned int pixelSize = (systemFramebuffer-&gt;bpp &gt;&gt; 3);\n  unsigned int lineSize = (systemFramebuffer-&gt;width * pixelSize);\n  unsigned char *address = (unsigned char *)(systemFramebuffer-&gt;buffer);\n  unsigned char *maxaddress = (unsigned char *)(address + (systemFramebuffer-&gt;height * systemFramebuffer-&gt;pitch) + (systemFramebuffer-&gt;height * lineSize));\n\n  while (address != maxaddress) {\n    // Set the memory based on pixel size\n    if (systemFramebuffer-&gt;bpp == 32) {\n      (unsigned char[4]*)address = 0xFF112233;\n    } else if (systemFramebuffer-&gt;bpp == 24) {\n      (unsigned char[3]*)address = 0x112233;\n    } else if (systemFramebuffer-&gt;bpp == 16) {\n      (unsigned char[2]*)address = 0x1223;\n    }\n\n    // move to next location\n    address += pixelSize;\n\n    // If at end of line, add extra pitch\n    if (address % lineSize == 0) {\n      address += systemFramebuffer-&gt;pitch;\n    }\n  }\n}\n</code></pre>\n\n<p>So my first issue is I have no idea how to set a c type that is a specific size, <code>(unsigned char[3]*)</code> I know doesn't work but I have no idea what would be a valid 3 byte system independent sized data type, for example.</p>\n\n<p>The other bit is <code>address % lineSize</code> is also invalid.</p>\n\n<p>What do I need to do to make this work?</p>\n\n<p>My compiler is <code>arm-none-eabi-gcc (GNU Tools for ARM Embedded Processors) 4.7.4 20140401 (release)</code>.</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1496855025, "post_id": 44418708, "comment_id": 75836190, "body": "Theoretically, some of those bits might be padding bits."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1496855511, "post_id": 44418708, "comment_id": 75836442, "body": "For which purpose? Storage or calculations?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1496856348, "post_id": 44418708, "comment_id": 75836868, "body": "Calculation - the problem that prompted me to post this question was counting 1 bits in an int for parity."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1496856842, "post_id": 44418708, "comment_id": 75837129, "body": "Well, I guess as @PSkocik have noted, it won&#39;t be <i>absolutely</i> portable in terms of calculation."}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 3, "last_activity_date": 1496857683, "creation_date": 1496857683, "answer_id": 44419540, "question_id": 44418708, "link": "https://stackoverflow.com/questions/44418708/can-i-use-char-bit-as-the-basis-for-determining-the-number-of-bits-in-other-type/44419540#44419540", "title": "Can I use CHAR_BIT as the basis for determining the number of bits in other types?", "body": "<p>I agree with PSkocik's comment to the original question. C11 6.2.6 says <code>CHAR_BIT * sizeof (type)</code> yields the number of bits in the <em>object representation</em> of type <code>type</code>, but some of them may be padding bits.</p>\n\n<p>I <em>suspect</em> that your best bet for a \"no-assumptions\" code is to simply check the value of <code>ULLONG_MAX</code> (or <code>~0ULL</code> or <code>(unsigned long long)(-1LL)</code>, which should all evaluate to the same value):</p>\n\n<pre><code>#include &lt;limits.h&gt;\n\nstatic inline int ullong_bit(void)\n{\n    unsigned long long m = ULLONG_MAX;\n    int n = 0, i = 0;\n    while (m) {\n        n += m &amp; 1;\n        i ++;\n        m &gt;&gt;= 1;\n    }\n    if (n == i)\n        return i;\n    else\n        return i-1;\n}\n</code></pre>\n\n<p>If the binary pattern for the value is all ones, then the number of bits an <code>unsigned long long</code> can hold is the same as the number of binary digits in the value.</p>\n\n<p>Otherwise, the most significant bit cannot really be used, because the maximum value in binary contains zeros.</p>\n"}], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 44419540, "answer_count": 1, "score": 2, "last_activity_date": 1496857683, "creation_date": 1496854770, "question_id": 44418708, "link": "https://stackoverflow.com/questions/44418708/can-i-use-char-bit-as-the-basis-for-determining-the-number-of-bits-in-other-type", "title": "Can I use CHAR_BIT as the basis for determining the number of bits in other types?", "body": "<p>For example, does the following code make no assumptions that might be incorrect on certain systems?</p>\n\n<pre><code> // Number of bits in an unsigned long long int:\n const int ULLONG_BIT = sizeof(unsigned long long int) * CHAR_BIT;\n</code></pre>\n"}, {"tags": ["c", "sockets", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1496853841, "post_id": 44418423, "comment_id": 75835564, "body": "You need to explicitly convert to the wider type <i>before</i> shifting left, e.g. <code>mensaje = (((uint64_t) random_number) &lt;&lt; 32) | mensaje_temp;</code> Similarly. when going the other way, make sure to convert to the narrower type <i>after</i> shifting right."}, {"owner": {"reputation": 1470, "user_id": 4917411, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10153260426563544/picture?type=large", "display_name": "Polo D. Vargas", "link": "https://stackoverflow.com/users/4917411/polo-d-vargas"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1496873073, "post_id": 44418423, "comment_id": 75845425, "body": "Thanks! it worked what do you mean by narrower type im not familiar with the concept :S"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1496929734, "post_id": 44418423, "comment_id": 75872517, "body": "A type is narrower if it has fewer value bits, and wider if it has more.  That&#39;s really all there is to that."}], "owner": {"reputation": 1470, "user_id": 4917411, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10153260426563544/picture?type=large", "display_name": "Polo D. Vargas", "link": "https://stackoverflow.com/users/4917411/polo-d-vargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1496853905, "answer_count": 0, "score": 0, "last_activity_date": 1496853702, "creation_date": 1496853702, "question_id": 44418423, "link": "https://stackoverflow.com/questions/44418423/overflow-while-shiffting-c", "closed_reason": "Duplicate", "title": "Overflow while shiffting C", "body": "<p>Hello i am trying to concatenate 2 <code>uint32_t</code> to make a 64 bit message to send throw a socket. But i get the following error\n<code>warning: left shift count &gt;= width of type [-Wshift-count-overflow] uint64_t mensaje = (random_number &lt;&lt; 32) | mensaje_temp;</code>\nHere is some code sample:</p>\n\n<pre><code>void send_msg(int num, int connsocket){\n    uint8_t largo = 6;\n    uint8_t type = 11;\n    uint16_t filler = 0;\n    uint32_t random_number = num;\n    uint16_t second_part = (type &lt;&lt; 8) | largo;\n    uint32_t mensaje_temp = (filler &lt;&lt; 16) | second_part;\n    uint64_t mensaje = (random_number &lt;&lt; 32) | mensaje_temp;\n    size_t msg_length = 8;\n    char *new_msg = (char*)&amp;mensaje;\n}\n</code></pre>\n\n<p>I just did a similar thing to concatenate <code>uint8_t</code> types with a similar code and it worked, Any advice on how to manipulate safely this type of data would be great.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1496850977, "post_id": 44417455, "comment_id": 75833816, "body": "At <code>&#47;*          * Do stuff here with the command, ...*&#47;</code> command_temp is not yet NUL-terminated."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1496851004, "post_id": 44417455, "comment_id": 75833834, "body": "You forgot to NUL-terminate your string. Normally you need it only after the last character was read, but if you want to debug-print your string from gdb you have to NUL-terminate it aftrr each character."}], "owner": {"reputation": 1633, "user_id": 5433168, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh6.googleusercontent.com/-ToezIzPD6R4/AAAAAAAAAAI/AAAAAAAAABs/pnUcZxssyyQ/photo.jpg?sz=128", "display_name": "Avishay28", "link": "https://stackoverflow.com/users/5433168/avishay28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3535, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496850700, "creation_date": 1496850700, "question_id": 44417455, "link": "https://stackoverflow.com/questions/44417455/c-getting-incomplete-sequence-in-the-debugger", "title": "C - getting incomplete sequence in the debugger", "body": "<p>In this project, I get commands from the user and I have to analyze and run them. So this is the part when I actually get the command from the user with <code>getchar()</code>:</p>\n\n<pre><code> /* reset variables for the next iteration */\ncounter = 0, after_command_name = 0, size = 10, tokens_counter = 0;\nis_valid_command = true;\n\n/* Getting the command */\ncommand_temp = malloc(10 * sizeof(char));\nassert(command_temp);\nprintf(\"Please enter your command\\n\");\nwhile ( (c = getchar()) != '\\n' ) {\n    /* EOF is not allowed */\n    if ( c == EOF ) {\n        printf(\"This is not how you should exit this program, please use the \\\"halt\\\" function next time.\\n\");\n        exit(1);\n    }\n    /* Check if more memory is needed */\n    if (counter == size) {\n        if ( (command_temp = realloc(command_temp, ((size *= 10) * sizeof(char)))) == NULL ) {\n            fprintf(stderr, \"Error trying to allocate more memory.\\n\");\n            exit(0);\n        }\n    }\n    command_temp[counter] = (char) c;\n    counter++;\n}\n</code></pre>\n\n<p>But I don't get the command properly, if I enter some command called <code>mult_comp_img</code> like this <code>mult_comp_img A,     2.5</code>, \nA is the name of a variable that store a complex number, and the command should take this complex number and multiplies it with the number 2.5, I put a lot of spaces just for testing as the program should take care of extra spaces.\nNow with the above code <code>command_temp</code> should get the string <code>mult_comp_img A,     2.5</code>, but instead this is what I see when I debug the program:</p>\n\n<pre><code>command_temp = 0x607250 \"mult_com2.5\\221\", &lt;incomplete sequence \\370\\001&gt;\n</code></pre>\n\n<p>What's this <code>\\221</code> and where is A? and \"_img\"?</p>\n\n<p>I have no idea how to overcome this odd behavior of the program, I also pretty new to C.\nSomething that may be related to the bug: the above code located inside another loop, that runs as long as the user didn't enter the command <code>halt</code> to the console, this is the general structure:</p>\n\n<pre><code>int main() {\n\n    int counter, c, size;\n    *command_temp;\n\n    for(;;) {\n\n        /* reset variables for the next iteration */\n        counter = 0, after_command_name = 0, size = 10, tokens_counter = 0;\n        is_valid_command = true;\n\n        /* Getting the command */\n        command_temp = malloc(10 * sizeof(char));\n        assert(command_temp);\n        printf(\"Please enter your command\\n\");\n        while ( (c = getchar()) != '\\n' ) {\n            /* EOF is not allowed */\n            if ( c == EOF ) {\n                printf(\"This is not how you should exit this program, please use the \\\"halt\\\" function next time.\\n\");\n                exit(1);\n            }\n            /* Check if more memory is needed */\n            if (counter == size) {\n                if ( (command_temp = realloc(command_temp, ((size *= 10) * sizeof(char)))) == NULL ) {\n                    fprintf(stderr, \"Error trying to allocate more memory.\\n\");\n                    exit(0);\n                }\n            }\n            command_temp[counter] = (char) c;\n            counter++;\n        }\n\n        /*\n         * Do stuff here with the command, check it and if everything is ok run a function realted to that\n         * command, then return results to the user, and wait to the next command\n         * \n         */\n\n\n    }\n\n    //should I put this here or insinde the loop that runs \"forever\"?\n    free(command_temp);\n\n    return 0;\n}\n</code></pre>\n\n<p>This behavior never occurs in the first iteration of the for(;;) loop, so maybe it related somehow to the fact that I override the previous <code>command_temp</code> variable without using free before in every iteration?\nI'm not sure if I need to free <code>command_temp</code> in each iteration or only in the end of the program (as I do now).</p>\n\n<p>Much appreciate your help.</p>\n"}, {"tags": ["c", "linux", "ibm-mq"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user736280"}, "edited": false, "score": 0, "creation_date": 1496859244, "post_id": 44472952, "comment_id": 75941399, "body": "Is anybody can help me to solve the problem?"}, {"owner": {"reputation": 949, "user_id": 5458310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rqcmV.png?s=128&g=1", "display_name": "Bitcoin Murderous Maniac", "link": "https://stackoverflow.com/users/5458310/bitcoin-murderous-maniac"}, "edited": false, "score": 0, "creation_date": 1497061657, "post_id": 44472952, "comment_id": 75941400, "body": "Maybe need to check else where on SE communities, I&#39;ll vote to move to StackOverflow but there&#39;s Unix and Linux and SO and maybe others where you may be able to get help with your inquiry if it gets no attention here. I don&#39;t know C that well but this seems like a programming question at least."}, {"owner": {"reputation": 1024, "user_id": 6590026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4b79ef46b6629bc726f5064d9e405d22?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/6590026/seth"}, "edited": false, "score": 0, "creation_date": 1497095113, "post_id": 44472952, "comment_id": 75941401, "body": "You&#39;re net telling it where to find the header files for WebSphere and/or it fails to link them."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1497095466, "post_id": 44472952, "comment_id": 75941494, "body": "Looks like you are not linking with libraries <code>$(CC) $(CFLAGS) -o $(EXE) $(OBJS)</code> --&gt; <code>$(CC) $(CFLAGS) -o $(EXE) $(OBJS)    $(LIBS)</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1507882526, "post_id": 44472952, "comment_id": 80396995, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1497095120, "question_id": 1216930}, "owner": {"user_type": "does_not_exist", "display_name": "user736280"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507882406, "creation_date": 1496850588, "last_edit_date": 1507882406, "question_id": 44472952, "link": "https://stackoverflow.com/questions/44472952/strange-error-in-makefile-for-c-program-which-connect-to-mq-onm-linux", "title": "Strange error in makefile for C program which connect to MQ onm Linux", "body": "<p>I have created a new makefile   </p>\n\n<pre><code>CC = /usr/bin/gcc    \n\nMQM_HOME = /opt/mqm   \nCFLAGS = -g -Wall \\    \n     -I$(MQM_HOME)/inc \\    \n     -I/usr/include    \n\n\n#IBM_LIBPATH=-L/usr/vacpp/lib    \nIBM_LIBS= -liconv    \n\nMQ_LIBPATH=-L$(MQM_HOME)/lib64    \nMQLIB = $(MQ_LIBPATH) -lmqm -lmqmcs -lmqmzse    \n\nLIBS    =  $(IBM_LIBS)  $(MQLIB) -lpthreads    \n#LDFLAGS = -q64 $(IBM_LIBPATH) $(MQ_LIBPATH)    \n\nSOURCE=/home/avalanche/oleg    \ndefault: ctm_mq_con_ex    \n\nctm_mq_con_ex: ctm_mq_con_ex.o    \n# Compilation rules    \n\nEXE     = $(SOURCE)/ctm_mq_con_ex    \nMAIN    = $(SOURCE)/ctm_mq_con_ex.c    \nOBJS    = $(SOURCE)/ctm_mq_con_ex.o    \n\n.c.o:    \n    $(CC) $(CFLAGS) -c $(MAIN)    \n\n    $(CC) $(CFLAGS) -o $(EXE) $(OBJS)    \n\n\nclean:    \n     \\rm -f $(OBJS)    \n     \\rm -f $(EXE)    \n</code></pre>\n\n<p>Now it shows errors    </p>\n\n<pre><code> make -f ./ctm_mq_con_ex.mk    \n/usr/bin/gcc -g -Wall -I/opt/mqm/inc -I/usr/include -c /home/avalanche/oleg/ctm_mq    \n/usr/bin/gcc -g -Wall -I/opt/mqm/inc -I/usr/include -o /home/avalanche/oleg/ctm_mq    \n/home/avalanche/oleg/ctm_mq_con_ex.o: In function `main':    \n/home/avalanche/oleg/ctm_mq_con_ex.c:67: undefined reference to `MQCONNX'    \n/home/avalanche/oleg/ctm_mq_con_ex.c:86: undefined reference to `MQOPEN'    \n/home/avalanche/oleg/ctm_mq_con_ex.c:114: undefined reference to `MQINQ'    \n/home/avalanche/oleg/ctm_mq_con_ex.c:142: undefined reference to `MQCLOSE'    \n/home/avalanche/oleg/ctm_mq_con_ex.c:163: undefined reference to `MQDISC'   \ncollect2: ld returned 1 exit status    \n</code></pre>\n\n<p>But in my C program I put header files   </p>\n\n<pre><code>#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;    \n#include &lt;ctype.h&gt;    \n#include &lt;string.h&gt;    \n\n /* includes for WebSphere MQ */    \n#include &lt;cmqc.h&gt;                  /* For regular MQI definitions   */    \n#include &lt;cmqxc.h&gt;                 /* For MQCD definition           */    \n</code></pre>\n\n<p>Did I miss something?    </p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496850888, "post_id": 44417384, "comment_id": 75833769, "body": "<i>dereferencing</i> it would definitely be undefined, but I&#39;m not entirely sure about this. It&#39;s unproblematic in practice though."}], "answers": [{"comments": [{"owner": {"reputation": 796, "user_id": 8071511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9f7dd1f1c4105f387b5ac47deac7c44?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Logue", "link": "https://stackoverflow.com/users/8071511/paul-logue"}, "edited": false, "score": 0, "creation_date": 1496851261, "post_id": 44417650, "comment_id": 75834002, "body": "Wow. So that means I shouldn&#39;t really take the copy."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 796, "user_id": 8071511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9f7dd1f1c4105f387b5ac47deac7c44?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Logue", "link": "https://stackoverflow.com/users/8071511/paul-logue"}, "edited": false, "score": 0, "creation_date": 1496851377, "post_id": 44417650, "comment_id": 75834066, "body": "@PaulLogue What is the point anyway (add it to your question if you want answer to this) ? But yes, this is not very safe."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 3, "last_activity_date": 1504990362, "last_edit_date": 1504990362, "creation_date": 1496851228, "answer_id": 44417650, "question_id": 44417384, "link": "https://stackoverflow.com/questions/44417384/behaviour-on-setting-a-pointer-to-a-dangling-pointer/44417650#44417650", "title": "Behaviour on setting a pointer to a dangling pointer", "body": "<p>The value of <code>bar</code> is indeterminate after the close bracket.</p>\n\n<p>Quoting ISO/IEC 9899:2011, section 6.2.4 \u00a72:</p>\n\n<blockquote>\n  <p>[\u2026] The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime.</p>\n</blockquote>\n\n<p>The exact behavior of <code>int* copy = bar;</code> is ambiguous \u2014 see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1793.pdf\" rel=\"nofollow noreferrer\">N1793 \u2014 Stability of indeterminate values in C11</a> provided by <a href=\"https://stackoverflow.com/questions/44415381/does-this-code-contain-use-after-free?noredirect=1#comment75830978_44415381\">eugene-sh</a>.</p>\n"}], "owner": {"reputation": 796, "user_id": 8071511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9f7dd1f1c4105f387b5ac47deac7c44?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Logue", "link": "https://stackoverflow.com/users/8071511/paul-logue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 44417650, "answer_count": 1, "score": 2, "last_activity_date": 1504990362, "creation_date": 1496850512, "last_edit_date": 1496850939, "question_id": 44417384, "link": "https://stackoverflow.com/questions/44417384/behaviour-on-setting-a-pointer-to-a-dangling-pointer", "title": "Behaviour on setting a pointer to a dangling pointer", "body": "<p>I've come across some assertions that the behaviour on setting a pointer to something that isn't the address of a scalar or one past the address of a scalar is undefined (with similar restrictions for arrays).</p>\n\n<p>So consider this:</p>\n\n<pre><code>int main()\n{\n    int* bar;\n    {\n        int foo = 1;\n        int* b = &amp;foo;\n        bar = b;\n    }     \n    int* copy = bar;    \n}\n</code></pre>\n\n<p>Is the behaviour of <code>int* copy = bar;</code> defined? <code>bar</code> no longer points to a scalar as it's out of scope.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 3, "creation_date": 1496850345, "post_id": 44417273, "comment_id": 75833385, "body": "The operator (&lt;) cannot compare signed to unsigned, so it converts one of them to the other type. In this case, it converts y to unsigned (which makes it a large number)."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 1, "creation_date": 1496851310, "post_id": 44417273, "comment_id": 75834035, "body": "<b>ISO/IEC 9899:2011 (C)</b>  <a href=\"http://c0x.coding-guidelines.com/6.5.8.html\" rel=\"nofollow noreferrer\">&#167;6.5.8 Relational operators</a>  -1202 If both of the operands have arithmetic type, the usual arithmetic conversions are performed.  Both operands will be casted to be <code>unsigned int</code>, and in Two&#39;s Complement,  <code>unsigned int y = -1; &#47;&#47; = 4294967296 = 2^32 since integers are 32-bit.</code> Thus you&#39;re comparing <code>4294967296 &lt; 1</code> which is false."}, {"owner": {"reputation": 39, "user_id": 8126536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af00bfc1ab95ab268ec1dfe80b59637b?s=128&d=identicon&r=PG&f=1", "display_name": "jhamra", "link": "https://stackoverflow.com/users/8126536/jhamra"}, "edited": false, "score": 0, "creation_date": 1496858581, "post_id": 44417273, "comment_id": 75838068, "body": "Well that explains the outcome. But why will be y converted to an unsigned int. To match the types, x could be converted to Two&#180;s Complement."}], "answers": [{"comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1496851539, "post_id": 44417566, "comment_id": 75834162, "body": "In fact, according to the C standard, the conversion is always done to the signed type, making it unsigned."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496856316, "post_id": 44417566, "comment_id": 75836846, "body": "<code>if(y&lt;(int)x)</code> moves the problem to other pairs such as  <code>unsigned int x = INT_MAX + 2u; int y = 0;</code>"}], "tags": [], "owner": {"reputation": 81, "user_id": 8121274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6310fdcab6688699e8ea23514c2e6864?s=128&d=identicon&r=PG&f=1", "display_name": "hellvetica", "link": "https://stackoverflow.com/users/8121274/hellvetica"}, "is_accepted": false, "score": 1, "last_activity_date": 1496851449, "last_edit_date": 1496851449, "creation_date": 1496850984, "answer_id": 44417566, "question_id": 44417273, "link": "https://stackoverflow.com/questions/44417273/c-unsigned-int-x-1-smaller-than-int-y-1/44417566#44417566", "title": "C unsigned int x = 1; smaller than int y = -1;", "body": "<p>You're comparing an unsigned int with a signed int. You shouldn't do that. C fixes this by converting one of them to the type of the other. In this case it probably converts y to an unsigned int making it positive so x should be the same as y.</p>\n\n<p>You sould make them both an int, or if it's really necessary you can cast the unsigned int to an int when comparing.</p>\n\n<p><code>if(y&lt;(int)x)</code></p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496855102, "post_id": 44417819, "comment_id": 75836233, "body": "<code>isSignedLess = (signed &lt; 0) || ((unsigned &lt;= max_signed) &amp;&amp; (signed &lt; unsigned))</code> is the right idea, yet can be simplified.  <code>isSignedLess = (signed_a &lt; 0) || (signed_a &lt; unsigned_b);</code>.  The cast to bigger `signed is not always possible as a wider signed type may not exist."}, {"owner": {"reputation": 540, "user_id": 3797387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acfa9d87d0f972467ab9c2bb6e48bc2?s=128&d=identicon&r=PG&f=1", "display_name": "Green_Wizard", "link": "https://stackoverflow.com/users/3797387/green-wizard"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496857751, "post_id": 44417819, "comment_id": 75837613, "body": "First of all, as already was said, it&#39;s not recommended mixing signed and unsigned. I&#39;m just wrote a bit hacky workaround. Secondary, <code>signed_a &lt; unsigned_b</code> can cause same problem, if compiler decide to trunc unsigned to signed (yeah, &quot;standard saying....&quot;... I don&#39;t like to remember tiny details, if there is straightforward and obviously code)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496858132, "post_id": 44417819, "comment_id": 75837825, "body": "&quot;if compiler decide to trunc unsigned to signed&quot; does not happen in C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496858325, "post_id": 44417819, "comment_id": 75837936, "body": "The is UV-ed because it does not caution against &quot;mixing signed and unsigned&quot;.  Instead it address OP&#39;s issue of how to handle mixed sign-ness compares with #1."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496858554, "post_id": 44417819, "comment_id": 75838058, "body": "On 2nd look <code>isSignedLess = (signed &lt; 0) || ((unsigned &lt;= max_signed) &amp;&amp; (signed &lt; unsigned)))</code> is wrong.  <code>(unsigned &lt;= max_signed)</code> incorrectly causes false compare with <code>unsigned int x = UINT_MAX; int y = 0;</code> to fail."}, {"owner": {"reputation": 540, "user_id": 3797387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acfa9d87d0f972467ab9c2bb6e48bc2?s=128&d=identicon&r=PG&f=1", "display_name": "Green_Wizard", "link": "https://stackoverflow.com/users/3797387/green-wizard"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496859506, "post_id": 44417819, "comment_id": 75838534, "body": "Yes, there is a mistake."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496950698, "post_id": 44417819, "comment_id": 75886031, "body": "It is possible (however unlikely) for <code>long</code> and <code>long long</code> types to be the same size, making &quot;<code>signed long long</code> can store all diapason of <code>signed</code>/<code>unsigned</code> <code>int</code>s&quot; not strictly true."}], "tags": [], "owner": {"reputation": 540, "user_id": 3797387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acfa9d87d0f972467ab9c2bb6e48bc2?s=128&d=identicon&r=PG&f=1", "display_name": "Green_Wizard", "link": "https://stackoverflow.com/users/3797387/green-wizard"}, "is_accepted": false, "score": 2, "last_activity_date": 1496952349, "last_edit_date": 1496952349, "creation_date": 1496851797, "answer_id": 44417819, "question_id": 44417273, "link": "https://stackoverflow.com/questions/44417273/c-unsigned-int-x-1-smaller-than-int-y-1/44417819#44417819", "title": "C unsigned int x = 1; smaller than int y = -1;", "body": "<p>signed 1 (as byte) in bits: 00000001</p>\n\n<p>unsigned 1 in bits: 00000001</p>\n\n<p>signed -1 in bits: 10000001 (or 1 1111111, just details)</p>\n\n<p>unsigned -1 in bits: no valid representation (10000001  is 129)</p>\n\n<p>if you want safely compare signed and unsigned variables, than you have two ways:</p>\n\n<p>1) take in account signs and manually compare them (<s>e. g. <code>isSignedLess = (signed &lt; 0) || ((unsigned &lt;= max_signed) &amp;&amp; (signed &lt; unsigned))</code> </s>)</p>\n\n<p>2) cast both to bigger singed (i. e. signed long long) and than compare them (signed long long can store all diapason of signed/unsigned int's)</p>\n\n<hr>\n\n<p>As you can see in comments, both ways are kinda tricky. Just don't mix  signed and unsigned wherever you can. It's possible in 99% cases. In last 1% cases you really need to know what you doing (e. g. often had to use signed indexes with vectors, but size() - unsigned, so I ask myself hundred time \"can this vector reach MAX_INT or not? have I to do more complex code or it's ok for this task?\").</p>\n"}], "owner": {"reputation": 39, "user_id": 8126536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af00bfc1ab95ab268ec1dfe80b59637b?s=128&d=identicon&r=PG&f=1", "display_name": "jhamra", "link": "https://stackoverflow.com/users/8126536/jhamra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "closed_date": 1496851068, "answer_count": 2, "score": 0, "last_activity_date": 1496952349, "creation_date": 1496850235, "question_id": 44417273, "link": "https://stackoverflow.com/questions/44417273/c-unsigned-int-x-1-smaller-than-int-y-1", "closed_reason": "Duplicate", "title": "C unsigned int x = 1; smaller than int y = -1;", "body": "<p>i do know the differences of signed unsigened etc.\nBut i don\u00b4t understand the following code:</p>\n\n<pre><code>unsigned int x = 1;\nint y = -1;\n    if(y &lt; x)\n        printf(\"of course it is\");\n    else\n        printf(\"strange stuff\");\n</code></pre>\n\n<p>1 should be a greater number than -1, no matter which representation is used. Because \"strange stuff\" will be displayed on the console.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1496850313, "post_id": 44417265, "comment_id": 75833365, "body": "Plain old undefined behavior."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1496850528, "post_id": 44417265, "comment_id": 75833507, "body": "Turn up your compile warning level and it will likely complain."}], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 5006067, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DaDba.jpg?s=128&g=1", "display_name": "Bhavesh Jadav", "link": "https://stackoverflow.com/users/5006067/bhavesh-jadav"}, "edited": false, "score": 0, "creation_date": 1496850575, "post_id": 44417341, "comment_id": 75833543, "body": "<code>5</code> is not a garbage value. If I replace <code>hello</code> with <code>helo</code> then the output will be <code>helo4</code>. The number is length of string in <code>printf</code> statement."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1496850605, "post_id": 44417341, "comment_id": 75833554, "body": "And you could in theory get just about any value. In practice, probably whatever is left in the RAX register."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 4, "creation_date": 1496850745, "post_id": 44417341, "comment_id": 75833666, "body": "It is absolutely a garbage value. Just because you find a pizza slice in a box of pizza that I&#39;ve thrown away, and you eat it, doesn&#39;t mean that you aren&#39;t eating garbage."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 667, "user_id": 5006067, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DaDba.jpg?s=128&g=1", "display_name": "Bhavesh Jadav", "link": "https://stackoverflow.com/users/5006067/bhavesh-jadav"}, "edited": false, "score": 0, "creation_date": 1496850812, "post_id": 44417341, "comment_id": 75833715, "body": "@BhaveshJadav: It&#39;s undefined by the language. You&#39;re seeing an artifact of one compiler&#39;s implementation of the language. Change the machine architecture, the compiler, the compiler version, even the compiler options, and you might get different results."}, {"owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "reply_to_user": {"reputation": 667, "user_id": 5006067, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DaDba.jpg?s=128&g=1", "display_name": "Bhavesh Jadav", "link": "https://stackoverflow.com/users/5006067/bhavesh-jadav"}, "edited": false, "score": 0, "creation_date": 1496851299, "post_id": 44417341, "comment_id": 75834023, "body": "@BhaveshJadav I wonder of what C compiler you are using, as mine throws an error: error: void value not ignored as it ought to be."}], "tags": [], "owner": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "is_accepted": true, "score": 4, "last_activity_date": 1496850423, "creation_date": 1496850423, "answer_id": 44417341, "question_id": 44417265, "link": "https://stackoverflow.com/questions/44417265/getting-value-from-void-function-with-printf/44417341#44417341", "title": "getting value from void function with printf", "body": "<p>You are assigning return value of <code>m()</code> to <code>k</code>. Since <code>m()</code> has no return value undefined behaviour will be visible, so there will be \"garbage\" in <code>k</code> (in this case: 5).</p>\n"}], "owner": {"reputation": 667, "user_id": 5006067, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DaDba.jpg?s=128&g=1", "display_name": "Bhavesh Jadav", "link": "https://stackoverflow.com/users/5006067/bhavesh-jadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 44417341, "answer_count": 1, "score": -1, "last_activity_date": 1496850423, "creation_date": 1496850219, "question_id": 44417265, "link": "https://stackoverflow.com/questions/44417265/getting-value-from-void-function-with-printf", "title": "getting value from void function with printf", "body": "<p>I am trying to understand following C program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n   int k = m();\n    printf(\"%d\", k);\n}\nvoid m()\n{\n    printf(\"hello\");\n}\n</code></pre>\n\n<p>Above code produces output of <code>hello5</code>. I understand why it is printing <code>hello</code>, but I do not understand why there is <code>5</code> behind it. How the <code>5</code> is getting returned and stored into variable <code>k</code>? How does the flow of this program work?</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "condition-variable"], "comments": [{"owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "edited": false, "score": 0, "creation_date": 1496850990, "post_id": 44417242, "comment_id": 75833822, "body": "Please see <a href=\"https://stackoverflow.com/a/44417229/2989411\">this answer</a> - maybe it would give you some insights."}, {"owner": {"reputation": 145, "user_id": 2630827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb024f7b59a96ae41723576edbc0759?s=128&d=identicon&r=PG", "display_name": "Carsten S", "link": "https://stackoverflow.com/users/2630827/carsten-s"}, "reply_to_user": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "edited": false, "score": 0, "creation_date": 1496851635, "post_id": 44417242, "comment_id": 75834229, "body": "@ArturR.Czechowski, thanks for pointing out the other question."}, {"owner": {"reputation": 145, "user_id": 2630827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb024f7b59a96ae41723576edbc0759?s=128&d=identicon&r=PG", "display_name": "Carsten S", "link": "https://stackoverflow.com/users/2630827/carsten-s"}, "reply_to_user": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "edited": false, "score": 0, "creation_date": 1496852596, "post_id": 44417242, "comment_id": 75834824, "body": "@Miket25, I probably could have stated it more clearly. After <code>t0</code> does <code>signal</code>, <code>t1</code> is no longer waiting for the condition variable, but it is also not running, because <code>t0</code> still holds the mutex, it is instead waiting for the mutex. The thread <code>t2</code> may also be waiting for the mutex, at the beginning of <code>enter()</code>. Now <code>t0</code> releases the mutex. Bother <code>t1</code> and <code>t2</code> are waiting for it. Is <code>t1</code> handled in a special way and guaranteed to get it, or could <code>t2</code> also get it?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496854378, "post_id": 44417242, "comment_id": 75835848, "body": "In general, there could be multiple threads waiting on a single condition.  There&#39;s no guarantee which of those threads will run after a <code>pthread_cond_signal()</code>.  If other threads are using the mutex separately from the condition, there&#39;s no guarantee whether one of those threads will get the mutex first.  That&#39;s why it is crucial to check that the condition a thread is waiting on holds after getting the mutex."}, {"owner": {"reputation": 145, "user_id": 2630827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb024f7b59a96ae41723576edbc0759?s=128&d=identicon&r=PG", "display_name": "Carsten S", "link": "https://stackoverflow.com/users/2630827/carsten-s"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496854935, "post_id": 44417242, "comment_id": 75836134, "body": "@JonathanLeffler, that makes total sense, but I had often only read that you should check the condition because of spurious wake-ups. These are not a problem here, because the woken thread actually checks the condition. However, with what you are saying, it would still be an error here if at the line of the comment I argued as followed: &quot;If <code>taken</code> is false here, anyone who has entered has exited and on exit woken up a waiting thread, so no thread can be waiting.&quot; I am getting convinced now, but at first I thought that I might be paranoid."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1496855308, "post_id": 44417242, "comment_id": 75836334, "body": "In the case of Windows with Windows native mutexes, in the testing I&#39;ve done, the order in which threads ask for a lock determines the order that the threads will waken when the mutex is unlocked. In other cases, including Windows using non-native mutexes, the ordering by lock request did not occur, and it would be possible for the same thread to repeatedly get the lock, even though other threads already had pending lock requests. If the OS includes a priority boost feature for threads stuck waiting, then the priority boosted thread would get the lock."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 2630827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb024f7b59a96ae41723576edbc0759?s=128&d=identicon&r=PG", "display_name": "Carsten S", "link": "https://stackoverflow.com/users/2630827/carsten-s"}, "edited": false, "score": 0, "creation_date": 1496853981, "post_id": 44418234, "comment_id": 75835633, "body": "Thanks, your answer probably states the problem more clearly than my question ;) I would feel more comfortable if it cited something to that effect, though."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "reply_to_user": {"reputation": 145, "user_id": 2630827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb024f7b59a96ae41723576edbc0759?s=128&d=identicon&r=PG", "display_name": "Carsten S", "link": "https://stackoverflow.com/users/2630827/carsten-s"}, "edited": false, "score": 0, "creation_date": 1496855543, "post_id": 44418234, "comment_id": 75836460, "body": "I can see your difficulty finding an answer this. I had a hard time find verification myself. <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/threads-cv.pdf\" rel=\"nofollow noreferrer\">Reference</a> First paragraph on pg.3 &quot;hints&quot; that <code>t0</code> does need to &quot;re-acquire&quot; the mutex and that it is not treated specially. I&#39;ll see if I can find more."}], "tags": [], "owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "is_accepted": true, "score": 2, "last_activity_date": 1496853859, "last_edit_date": 1496853859, "creation_date": 1496853069, "answer_id": 44418234, "question_id": 44417242, "link": "https://stackoverflow.com/questions/44417242/when-will-a-thread-woken-via-a-condition-variable-run/44418234#44418234", "title": "When will a thread woken via a condition variable run?", "body": "<p>Thanks for your comment, Carsten, that cleared it up. </p>\n\n<p>No, see this <a href=\"https://stackoverflow.com/questions/16522858/understanding-of-pthread-cond-wait-and-pthread-cond-signal\">answer</a> for more reference. Given your example, <code>t2</code> could acquire the mutex before <code>t1</code> and a race condition may occur leading to unexpected outcomes. </p>\n\n<p>Reiterating, <code>t0</code> may initially have the mutex and be in the while loop holding on the line <code>pthread_cond_wait(&amp;c, &amp;m);</code>and the mutex is released atomically <a href=\"https://linux.die.net/man/3/pthread_cond_wait\" rel=\"nofollow noreferrer\">reference</a>. <code>t1</code> could call <code>leave()</code> acquiring the mutex signaling the condition <code>c</code>, and then release the mutex. <code>t0</code> will prepare to run <code>--waiting</code> by trying to acquire the now-freed mutex by <code>t1</code>, but it can become context switched by the OS. Some other thread <code>t2</code> waiting on the mutex can grab it and run <code>enter()</code> causing undesired outcomes, see <a href=\"https://en.wikipedia.org/wiki/Reentrancy_(computing)#Relation_to_thread_safety\" rel=\"nofollow noreferrer\">non-reentrant</a>. <code>t2</code> then releases the mutex. <code>t0</code> may swaps back only to see values have been mutated. </p>\n"}], "owner": {"reputation": 145, "user_id": 2630827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb024f7b59a96ae41723576edbc0759?s=128&d=identicon&r=PG", "display_name": "Carsten S", "link": "https://stackoverflow.com/users/2630827/carsten-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 44418234, "answer_count": 1, "score": 2, "last_activity_date": 1496854272, "creation_date": 1496850153, "last_edit_date": 1496854272, "question_id": 44417242, "link": "https://stackoverflow.com/questions/44417242/when-will-a-thread-woken-via-a-condition-variable-run", "title": "When will a thread woken via a condition variable run?", "body": "<p>When I wake up a thread waiting on a condition variable while holding the corresponding mutex, can I assume that the woken thread will run after I release the mutex and before anyone else (myself included) can lock the mutex again? Or can I only be sure that it will run at some point in the future?</p>\n\n<p>To be precise, assume that I have the following functions.</p>\n\n<pre><code>bool taken = false;\nint waiting = 0;\n\npthread_mutex_t m;   // properly initialised elsewhere\npthread_cond_t c;\n\nvoid enter() {\n    pthread_mutex_lock(&amp;m);\n    // Is `taken || (waiting == 0)` guaranteed here? \n    while (taken) {\n        ++ waiting;\n        pthread_cond_wait(&amp;c, &amp;m);\n        -- waiting;\n    }\n    taken = true;\n    pthread_mutex_unlock(&amp;m);\n}\n\nvoid leave() {\n    pthread_mutex_lock(&amp;m);\n    taken = false;\n    if (waiting &gt; 0) {\n        pthread_cond_signal(&amp;c);\n    }\n    pthread_mutex_unlock(&amp;m);\n}\n</code></pre>\n\n<p>(This is a toy example, not meant to be useful.)</p>\n\n<p>Also assume that all threads are using these functions as</p>\n\n<pre><code>enter()\n// some work here\nleave()\n</code></pre>\n\n<p>Can I then be sure that directly after acquiring the mutex in <code>enter()</code> (see comment in the code), if <code>taken</code> is false <code>waiting</code> has to be zero? [It seems to me that this should be the case, because the woken thread will assume to find the state that the waking thread has left behind (if the wake-up was not spurious) and this could otherwise not be guaranteed, but I did not find it clearly worded anywhere.]</p>\n\n<p>I am mainly interested in the behaviour on (modern) Linux, but of course knowing whether this is defined by POSIX would also be of interest.</p>\n\n<p>Note: This may have already been asked in <a href=\"https://stackoverflow.com/questions/44212960/can-it-be-assumed-that-pthread-cond-signal-will-wake-the-signaled-thread-atomi\">another question</a>, but I hope that mine is clearer.</p>\n\n<hr>\n\n<p>After <code>t0</code> does <code>pthread_cond_signal</code>, <code>t1</code> is no longer waiting for the condition variable, but it is also not running, because <code>t0</code> still holds the mutex; <code>t1</code> is instead waiting for the mutex. The thread <code>t2</code> may also be waiting for the mutex, at the beginning of <code>enter()</code>. Now <code>t0</code> releases the mutex. Both <code>t1</code> and <code>t2</code> are waiting for it. Is <code>t1</code> handled in a special way and guaranteed to get it, or could <code>t2</code> get it instead?</p>\n"}, {"tags": ["c", "gcc", "optimization", "constants"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496850576, "post_id": 44417223, "comment_id": 75833544, "body": "In general I would doubt that you can be guaranteed that the compiler makes such optimization. However, write the code in the way you find &quot;nice, easy and simple&quot;. Then check whether it meets your performance requirements. If it does, just be happy about it. If it doesn&#39;t, do a profiling to find where the performance killer is."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1496850640, "post_id": 44417223, "comment_id": 75833586, "body": "If compiler will come to this conclusion and pass reference instead what will happen if foo() is a long running function and there are other threads accessing and possibly modifying your huge_t instance?"}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1496850758, "post_id": 44417223, "comment_id": 75833680, "body": "@mvidelgauz then is should have been declared <code>volatile</code>.  Joking ofc.  I don&#39;t believe the compiler is allowed to make this optimisation but others may know better than me."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "reply_to_user": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "edited": false, "score": 0, "creation_date": 1496851136, "post_id": 44417223, "comment_id": 75833920, "body": "@PhilipCouling what i wanted to say is that afaik the fundamental C philosophy says that compiler doesn&#39;t make any decisions instead of you. If you want to pass reference/ponter - do it, you have language constructs for it. The optimization is only possible if final result is guaranteed to stay the same under all circumstances. Besides threading we can think of other undesired side effects of such optimization"}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1496851347, "post_id": 44417223, "comment_id": 75834057, "body": "@mvidelgauz Agreed. A better example than threading would be a function which accepts the same struct by value AND by reference.  There&#39;s no way the compiler could guarantee what the side effects of the pass by reference will be, thus pass by value MUST be kept as pass by value."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1496851645, "post_id": 44417223, "comment_id": 75834236, "body": "@mvidelgauz - Your comment is mostly correct but this part: <code>the fundamental C philosophy says that compiler doesn&#39;t make any decisions instead of you</code> is wrong. The compiler is allowed to every thing it wants to do as long as &quot;the result&quot; (aka side effects) stays the same."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1496852020, "post_id": 44417223, "comment_id": 75834467, "body": "<code>foo</code> is permitted to cast away <code>const</code> and modify its argument as long as the actual argument is not declared <code>const</code>."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1496852297, "post_id": 44417223, "comment_id": 75834646, "body": "@4386427 Under &quot;making decisions&quot; I meant changing observed results of program execution, but it&#39;s going to be terminology discussion, not for this place. Thanks for your comment :)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1496852478, "post_id": 44417223, "comment_id": 75834759, "body": "@mvidelgauz - Then we agree. Seems I misunderstood what you wanted to say. :)"}], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "edited": false, "score": 1, "creation_date": 1496851517, "post_id": 44417576, "comment_id": 75834146, "body": "In general: also if the specific compiler you are using does the optimization you are looking for, please don&#39;t assume that all the compiler does. @Philip said correclty: &quot;if you need your code to behave a certain way then write it that way.&quot;"}, {"owner": {"reputation": 972, "user_id": 1578458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2RWBA.gif?s=128&g=1", "display_name": "Jesko H&#252;ttenhain", "link": "https://stackoverflow.com/users/1578458/jesko-h%c3%bcttenhain"}, "edited": false, "score": 0, "creation_date": 1496853923, "post_id": 44417576, "comment_id": 75835609, "body": "Thanks, great reference, for some reason I did not see that post. Also, remain calm everyone, I was naming gcc just to have a concrete example and I was <i>honestly</i> just curious. I will vow solemnly to <a href=\"https://youtu.be/AKtHxKJRwp4\" rel=\"nofollow noreferrer\">not help the compiler</a> ;-)."}], "tags": [], "owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "is_accepted": true, "score": 5, "last_activity_date": 1496851471, "last_edit_date": 1496851471, "creation_date": 1496851003, "answer_id": 44417576, "question_id": 44417223, "link": "https://stackoverflow.com/questions/44417223/passing-a-large-const-struct-to-a-function/44417576#44417576", "title": "Passing a large const struct to a function", "body": "<p>If you look here:  <a href=\"https://stackoverflow.com/questions/552134/why-isnt-pass-struct-by-reference-a-common-optimization\">Why isn&#39;t pass struct by reference a common optimization?</a></p>\n\n<p>Its very unlikely that any C compiler will make this optimisation.  It's generally not a safe thing to do.</p>\n\n<p>Never assume your optimiser will do things the way you want.  Optimisers have to conform to certain rules so that they never break your code.  Sometimes you know something is safe when the optimiser cant.  If, for performance, you need your code to behave a certain way then write it that way.</p>\n"}], "owner": {"reputation": 972, "user_id": 1578458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2RWBA.gif?s=128&g=1", "display_name": "Jesko H&#252;ttenhain", "link": "https://stackoverflow.com/users/1578458/jesko-h%c3%bcttenhain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 1, "accepted_answer_id": 44417576, "answer_count": 1, "score": 3, "last_activity_date": 1496851471, "creation_date": 1496850096, "question_id": 44417223, "link": "https://stackoverflow.com/questions/44417223/passing-a-large-const-struct-to-a-function", "title": "Passing a large const struct to a function", "body": "<p>Let's say I compile the following with GCC 5.4 with <code>-O2</code> or <code>-O3</code> level of optimization.</p>\n\n<pre><code>typedef struct {\n  int data[90];\n} huge_t;\n\nint foo( const huge_t bar );\n\n// ...\n\nhuge_t x = { 0 };\nfoo(x);\n</code></pre>\n\n<p>Here, I would venture to say is not necessary to create a second copy of <code>x</code> on the stack because <code>foo</code> is not (supposed to be) modifying its argument. (When) will GCC come to the same conclusion? </p>\n\n<p>In other words, is it ok for me to work with <code>const</code> arguments of type <code>huge_t</code> for convenience, or should I be using pointers? I could imagine both versions being \"good style\" in one sense or the other and would very much appreciate an informed opinion.</p>\n"}, {"tags": ["c", "linux", "sockets", "tcp", "latency"], "comments": [{"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1496854979, "post_id": 44416839, "comment_id": 75836162, "body": "Interesting problem, but beyond my pay-grade. Maybe add a tag for the language you&#39;re programming <code>c</code>, <code>c++</code>, or ?? and the pros will notice your Q. (notice the relatively low &quot;followers&quot; for <code>tcp</code> and <code>latency</code> tags). Good luck."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1496933791, "post_id": 44416839, "comment_id": 75875826, "body": "Perhaps UDP would be a better transport mechanism for this application?  Then you would have full control over all timeout/resend/give-up mechanisms."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8080916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/901bf4d00ca7a9ef5895d0091ec4024a?s=128&d=identicon&r=PG&f=1", "display_name": "kangmj37", "link": "https://stackoverflow.com/users/8080916/kangmj37"}, "is_accepted": false, "score": 0, "last_activity_date": 1497013734, "last_edit_date": 1497013734, "creation_date": 1497013299, "answer_id": 44458544, "question_id": 44416839, "link": "https://stackoverflow.com/questions/44416839/tuning-receive-ack-timeout-on-linux-for-webserver/44458544#44458544", "title": "Tuning receive ACK timeout on Linux for Webserver", "body": "<p>Timeout is related to RTO.</p>\n\n<p>See RFC6298 2.1. Until a round-trip time (RTT) measurement has been made for a segment sent between the sender and receiver, the sender SHOULD set RTO &lt;- 1 second.</p>\n\n<p>See RFC6298 5.5. The host MUST set RTO &lt;- RTO * 2</p>\n\n<p>My Ubuntu(14.04)'s \"/proc/sys/net/ipv4/tcp_synack_retries\" is set to 5.</p>\n\n<p>In other words,</p>\n\n<pre><code>Server state.\n1. SYN/ACK First Send ===&gt; 1 second wait ...\n2. SYN/ACK Retransmission ===&gt; 2 second wait ...\n3. SYN/ACK Retransmission ===&gt; 4 second wait ...\n4. SYN/ACK Retransmission ===&gt; 8 second wait ...\n5. SYN/ACK Retransmission ===&gt; 16 second wait ...\n6. SYN/ACK Retransmission ===&gt; 32 second wait ...\n</code></pre>\n\n<p>Above total wait time is longer than 20 seconds.</p>\n\n<p>Try \"/proc/sys/net/ipv4/tcp_synack_retries\" changing.</p>\n"}], "owner": {"reputation": 11, "user_id": 2592902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75bff997ea1386a48d140f86f9975bcf?s=128&d=identicon&r=PG", "display_name": "user2592902", "link": "https://stackoverflow.com/users/2592902/user2592902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497013734, "creation_date": 1496849100, "last_edit_date": 1496932628, "question_id": 44416839, "link": "https://stackoverflow.com/questions/44416839/tuning-receive-ack-timeout-on-linux-for-webserver", "title": "Tuning receive ACK timeout on Linux for Webserver", "body": "<p>I work with remote sensing equipment for a particular university's environmental sciences department and am having trouble with latency. We have sensors in the field that periodically send updates (as POSTs) back into a box running linux and a simple web server. The devices connect via a daisy chain of wireless repeaters (we're experimenting with shortwave as an alternative to commercial cellular networks). </p>\n\n<p>Our problem comes from high latency in some of our links; approaching 20 seconds. Our sensors are unable to complete the threeway handshake to establish the connection to the server. We see the SYN get to the server and then the SYNACK get back to the remote, but by the time the ACK gets to the server from the remote the server has already sent a RST.</p>\n\n<p>Is there a way to tune the linux TCP stack so that the timeout for receiving these ACK's can be lengthened?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496849126, "post_id": 44416811, "comment_id": 75832557, "body": "If you are working on <b>C</b> pointers and memory address, you should start from now on avoid casting the result of malloc."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1496849145, "post_id": 44416811, "comment_id": 75832573, "body": "In <code>a1 = a2;</code> you copy the argument, not what it points to."}, {"owner": {"reputation": 112, "user_id": 3224664, "user_type": "registered", "profile_image": "https://graph.facebook.com/530716145/picture?type=large", "display_name": "ginginsha", "link": "https://stackoverflow.com/users/3224664/ginginsha"}, "edited": false, "score": 0, "creation_date": 1496849153, "post_id": 44416811, "comment_id": 75832583, "body": "<a href=\"https://stackoverflow.com/questions/2229498/passing-by-reference-in-c\" title=\"passing by reference in c\">stackoverflow.com/questions/2229498/passing-by-reference-in-&zwnj;&#8203;c</a>  What&#39;s happening is that both pointers are copied when Copy() is called, which doesn&#39;t change a or b, but only their copies."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1496849186, "post_id": 44416811, "comment_id": 75832605, "body": "The pointers are passed by-value, you only change the local copy of the pointer. If you want to change the value <i>pointed to</i>, write <code>*a1 = *a2</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496849242, "post_id": 44416811, "comment_id": 75832634, "body": "Note that <a href=\"http://stackoverflow.com/questions/2979209/using-fflushstdin\">using <code>fflush(stdin)</code></a> is contentious and not portable."}, {"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 0, "creation_date": 1496850042, "post_id": 44416811, "comment_id": 75833202, "body": "Don&#39;t forget to free the memory when you are done. <code>free(a)</code> in test"}, {"owner": {"reputation": 97, "user_id": 6560845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGRWM.jpg?s=128&g=1", "display_name": "Dang_Ho", "link": "https://stackoverflow.com/users/6560845/dang-ho"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496850311, "post_id": 44416811, "comment_id": 75833363, "body": "Can you tell me why @JonathanLeffler?? Can i change <code>fflush</code> via another function?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496850780, "post_id": 44416811, "comment_id": 75833697, "body": "On most platforms, the behaviour of <code>fflush(stdin)</code> is undefined, so it may do nothing or anything \u2014 and anything includes doing nasty things.  Fortunately, such functions seldom actually do nasty things, but they&#39;re allowed to crash, etc.  What to do?  I&#39;d simply drop the line.  There isn&#39;t any input left over from a previous <code>scanf()</code>, so there&#39;s no real reason to flush standard input before reading from it.  That&#39;s also the portable solution.  You can use <code>int c; while ((c = getchar()) != EOF &amp;&amp; c != &#39;\\n&#39;) ;</code> if you like, but if the user hasn&#39;t yet typed anything, that ignores their input."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496850857, "post_id": 44416811, "comment_id": 75833742, "body": "There isn&#39;t a portable solution to &#39;read up to the newline if there is any data waiting on standard input&#39;.  There are platform-specific solutions (and <code>fflush(stdin)</code> is a platform-specific solution for certain platforms \u2014 primarily Windows using the Microsoft runtime libraries)."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1496849935, "post_id": 44416894, "comment_id": 75833124, "body": "How do you intend to <code>free</code> the memory which was allocated to variable <code>a</code>? I would say that the comment above from @FelixPalmen is the correct answer."}, {"owner": {"reputation": 909, "user_id": 8041414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f488d544c535a091b7310e7d7e6a98f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jesferman", "link": "https://stackoverflow.com/users/8041414/jesferman"}, "edited": false, "score": 0, "creation_date": 1496850166, "post_id": 44416894, "comment_id": 75833278, "body": "He should store a temp pointer pointing at the same place than <code>a</code> before changing its value, to be able to free that memory"}], "tags": [], "owner": {"reputation": 909, "user_id": 8041414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f488d544c535a091b7310e7d7e6a98f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jesferman", "link": "https://stackoverflow.com/users/8041414/jesferman"}, "is_accepted": true, "score": 1, "last_activity_date": 1496851191, "last_edit_date": 1496851191, "creation_date": 1496849242, "answer_id": 44416894, "question_id": 44416811, "link": "https://stackoverflow.com/questions/44416811/pointers-and-address-in-c/44416894#44416894", "title": "Pointers and Address in C", "body": "<p>Function arguments are passed by value. So inside the function <code>Copy</code> you are modifying a copy of the pointer not the original pointer you had in the <code>Test</code> function. So when you leave the <code>Copy</code> function the pointers outside are not modified.</p>\n\n<p>Change the <code>Copy</code> to receive a <code>int **</code>, so you can change inside the value of pointers</p>\n\n<pre><code>void Copy(int **a1, int **a2)\n{\n    *a1 = *a2;\n}\n</code></pre>\n\n<p>And call the function in this way:</p>\n\n<pre><code>void Test() {\n    ...\n    Copy (&amp;a, &amp;b);\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1496849581, "creation_date": 1496849581, "answer_id": 44417019, "question_id": 44416811, "link": "https://stackoverflow.com/questions/44416811/pointers-and-address-in-c/44417019#44417019", "title": "Pointers and Address in C", "body": "<p>If you want to assign the values, such that after the call of <code>Copy</code> <code>*a == *b</code> holds, then you'd have to change your function as follows:</p>\n\n<pre><code>void Copy(int *a1, int *a2)\n{\n    *a1 = *a2;\n}\n</code></pre>\n\n<p>If you want to assign the pointers, such that after the call of <code>Copy</code> <code>a==b</code> holds, then you have to pass a pointer to the pointers:</p>\n\n<pre><code>void Copy(int **a1, int **a2)\n{\n    *a1 = *a2;\n}\n\nvoid Test() {\n    ...\n    Copy (&amp;a, &amp;b);\n    ...\n}\n</code></pre>\n\n<p>Note that <code>a==b</code> also implies that <code>*a == *b</code>.</p>\n"}], "owner": {"reputation": 97, "user_id": 6560845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGRWM.jpg?s=128&g=1", "display_name": "Dang_Ho", "link": "https://stackoverflow.com/users/6560845/dang-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 44416894, "answer_count": 2, "score": 0, "last_activity_date": 1496851191, "creation_date": 1496849007, "question_id": 44416811, "link": "https://stackoverflow.com/questions/44416811/pointers-and-address-in-c", "title": "Pointers and Address in C", "body": "<p>I write a C program. I have 2 pointers <code>*a</code> and <code>*b</code>. Now, I impose <code>*a = 20</code> and <code>*b = 10</code>. After that I impose <code>a = b</code> in subroutine but the value seem doesn't change. I expect that <code>*a = 10</code> and <code>*b = 10</code>. Please help me find a solution for this. Thank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;stdlib.h&gt;\nvoid Copy(int *a1, int *a2)\n{\n    a1 = a2;\n}\n\n\nvoid Test()\n{\n    // a = 20\n    int *a = (int *)malloc(sizeof(int));\n    *a = 20;\n\n    // b = 10\n    int *b = (int *)malloc(sizeof(int));\n    *b = 10;\n\n    Copy(a, b); // a = b\n    printf(\"\\na = %d\", *a);\n    printf(\"\\nb = %d\", *b);\n}\n\nint main(int argc, char *argv[]){\n    Test();\n    fflush(stdin);\n    printf(\"\\nPress any key to continue\");\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1496848351, "post_id": 44416540, "comment_id": 75832015, "body": "How do you call the function? Show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1496848553, "post_id": 44416540, "comment_id": 75832166, "body": "If your <code>while (str[i] != &#39;\\0&#39;)</code> loop hits a <code>&#39; &#39;</code> it does not increment <code>i</code> anymore, so it will run forever."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496848588, "post_id": 44416540, "comment_id": 75832195, "body": "Debug, put print of valors inside your code to know where it loops. Also avoid casting the result of malloc."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1496848957, "post_id": 44416540, "comment_id": 75832438, "body": "Unrelated, but you shouldn&#39;t duplicate code; just move the while loop out of the if/else: <code>if(... == letter ...) { ++count; } while(...){...}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1496849782, "last_edit_date": 1496849782, "creation_date": 1496849443, "answer_id": 44416979, "question_id": 44416540, "link": "https://stackoverflow.com/questions/44416540/a-function-produces-an-inifinite-loop/44416979#44416979", "title": "a function produces an inifinite loop", "body": "<p>Consider this input string <code>\"a b\"</code> and assume the letter is <code>c</code>.</p>\n\n<p>When <code>i</code> is <code>0</code> you enter the code below because <code>str[0]</code>is <code>a</code> which doesn't match the letter:</p>\n\n<pre><code>    else\n    {\n        while (str[i] != ' ' &amp;&amp; str[i] != '\\0' ) \n            i++;   // Increment i from 0 to 1\n    }\n</code></pre>\n\n<p>In the above block, you increment <code>i</code> to <code>1</code> and then leave the block because <code>str[1]</code> is <code>' '</code></p>\n\n<p>In the next main loop, you will again hit this code block:</p>\n\n<pre><code>    else\n    {\n        while (str[i] != ' ' &amp;&amp; str[i] != '\\0' ) \n            i++;   // No increment, i.e. i stays at 1\n    }\n</code></pre>\n\n<p>but you will <strong>not</strong> increment <code>i</code> (as <code>str[1]</code> is a space). In other words - <code>i</code> remains at <code>1</code> and you have an infinite loop.</p>\n\n<p>Maybe you can fix it by this:</p>\n\n<pre><code>    else\n    {\n        while (str[i] != ' ' &amp;&amp; str[i] != '\\0' ) \n            i++;   // No increment, i.e. i stays at 1\n\n        // Add this line to remove the spaces\n        while (str[i] == ' ') i++;\n    }\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8094523, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f8af939c7c81fecc58455b2249fa5513?s=128&d=identicon&r=PG&f=1", "display_name": "NoaRoth", "link": "https://stackoverflow.com/users/8094523/noaroth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496849782, "creation_date": 1496848312, "last_edit_date": 1496848740, "question_id": 44416540, "link": "https://stackoverflow.com/questions/44416540/a-function-produces-an-inifinite-loop", "title": "a function produces an inifinite loop", "body": "<p>I wrote the following function and when I run it , it produces an infinite loop and I dont understand why.</p>\n\n<p>This function creates a dynamic array of dynamic strings. Every such string starts with  a letter given, or with a capital letter which is compatible to the letter given:</p>\n\n<pre><code>void wordsStartWithLetter(char letter, char *str,char***newstr,int *numOfWords) \n{\n    int i=0, count=0;\n    char *word;\n    char *delimiter = \" \";\n\n    while (str[i] != '\\0')\n    {\n        if (str[i]==letter ||str[i]==(letter-32 )) //if it founds the letter at the begining of the word, than run till the space//\n        {\n            while (str[i] != ' ' &amp;&amp; str[i] != '\\0' ) \n              i++;      //counting the number of words beginng with the letter given//\n            count++;        \n        }\n        else\n        {\n            while (str[i] != ' ' &amp;&amp; str[i] != '\\0' ) \n                i++;\n        }\n    }\n\n    *newstr = (char**)malloc (sizeof(char*)*count); \n    *numOfWords=count;\n    i=0;\n\n    word = strtok(str, delimiter);      //we use strtok to separate each word from the origin string//\n\n    while(word!=NULL)            \n    {\n        if (word[0]==letter ||word[0]==letter-32)\n        {\n            (*newstr)[i]=word;                 //insert the compatible words into the new 2D-string//\n            i++;\n        }\n        word = strtok(NULL, delimiter);\n    }\n\n}\n</code></pre>\n\n<p>I call that  function the by the following way:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n\n#define SIZE 50\n\nvoid Ex();\nvoid wordsStartWithLetter(char letter, char *str,char***newstr,int *numOfWords) ;\n\nvoid main()\n{\n\n    Ex();\n}\n\nvoid Ex()\n{\n    char ch;\n    char str[SIZE];\n    char **newstr;\n    int numOfWords,i;\n\n    printf(\"please enter a string: \");\n    _flushall();\n    gets(str);\n    printf(\"plese enter a letter: \" );\n    _flushall();\n    ch=_getche();\n    wordsStartWithLetter(ch, str,&amp;newstr,&amp;numOfWords);\n\n    (\"the words of the origin string which start which %c :\\n\",ch);\n    for(i=0;i&lt;numOfWords;i++)\n        printf(\"%s\\n\",newstr[i]);\n\n    for (i=0;i&lt;numOfWords; i++)\n       free(newstr[i]);\n    free(newstr);\n}\n</code></pre>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1496848278, "post_id": 44416499, "comment_id": 75831957, "body": "Use the definitions. This is why they are provided."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496848343, "post_id": 44416499, "comment_id": 75832003, "body": "Absolutely use the definitions.  All else apart, they&#39;re more likely to be usable in the preprocessor than computations you do in your code.  And it&#39;s hard to choose different types after the program is compiled.  The problem comes when you need information that is available on some platforms but not on others \u2014 then it gets messier."}, {"owner": {"reputation": 1234, "user_id": 4847264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b6735add4b9df1cc3bf77c455125332?s=128&d=identicon&r=PG", "display_name": "Adam Bak", "link": "https://stackoverflow.com/users/4847264/adam-bak"}, "edited": false, "score": 0, "creation_date": 1496848395, "post_id": 44416499, "comment_id": 75832047, "body": "Understood, thank you, wasn&#39;t sure which way to go."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496848451, "post_id": 44416499, "comment_id": 75832094, "body": "Only the values from <code>limit.h</code> should be used in general. C doesn&#39;t give any guarantees about the representation of signed and float types, so trying to calculate something for these could gibe wrong results."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1496848912, "post_id": 44416499, "comment_id": 75832407, "body": "Use %u (or %x, or %o with or without h or hh) to print unsigned values: <code>printf(&quot;%u&quot;, (unsigned char)~0);</code>. You invoke UB on implementations where <code>sizeof (char) == sizeof (int)</code> otherwise."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1496849073, "post_id": 44416499, "comment_id": 75832517, "body": "alos you have a limit as to what is discoverable. In you example you worked out the max value of an unsigned char, but you used as input CHAR_BIT. How would you calculate CHAR_BIT? You reach the point where you cannot find things out without straying into UB"}], "owner": {"reputation": 1234, "user_id": 4847264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b6735add4b9df1cc3bf77c455125332?s=128&d=identicon&r=PG", "display_name": "Adam Bak", "link": "https://stackoverflow.com/users/4847264/adam-bak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1496848387, "creation_date": 1496848220, "last_edit_date": 1496848387, "question_id": 44416499, "link": "https://stackoverflow.com/questions/44416499/should-i-use-standard-definitions-or-computations-to-figure-out-length-of-allowa", "title": "Should I use standard definitions or computations to figure out length of allowable ranges of data types in C", "body": "<p>Looking through the <code>limits.h</code> file, I noticed that it contained information about the number of bits that a <code>char</code> contains on my system and also the maximum allowable values of certain data types. </p>\n\n<pre><code>/* Number of bits in a `char'.  */\n#undef CHAR_BIT\n#define CHAR_BIT __CHAR_BIT__\n\n/* Maximum value an `unsigned char' can hold.  (Minimum is 0).  */\n#undef UCHAR_MAX\n#define UCHAR_MAX 255\n</code></pre>\n\n<p>My question is, should I use these definitions in my programs or should I somehow compute the allowable values. I tried to create an example, but am not entirely certain if what I've done makes sense.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;math.h&gt;\n\nint main(void)\n{\n    int numberOfBitsInChar = CHAR_BIT;\n    printf(\"Maximum size of unsigned char: %.0f\\n\", pow(2.0, (double)numberOfBitsInChar) - 1);\n    printf(\"Maximum size of unsigned char: %i\\n\", UCHAR_MAX);\n    return 0;\n}\n</code></pre>\n\n<p>The first <code>printf()</code> uses a computation to obtain the maximum size of an unsigned char and the second <code>printf()</code> uses the appropriate definition. I have also seen the following code used as well.</p>\n\n<pre><code>printf(\"Maximum Unsigned Char %d\\n\",(unsigned char)~0);\n</code></pre>\n\n<p>I am wondering what the recommended practice of finding data type limits is, or if either approach (using the appropriate definition or by computation) is acceptable.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1496847296, "post_id": 44416079, "comment_id": 75831202, "body": "First off, read the file line-by-line, not character-by-character."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496847709, "post_id": 44416079, "comment_id": 75831526, "body": "Use <code>strchr</code> to search the input into the current read line."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1496849731, "post_id": 44416729, "comment_id": 75832991, "body": "You should check that the <code>fopen()</code> succeeds.  You should also explain what you&#39;ve done."}, {"owner": {"reputation": 3, "user_id": 8126053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691d007a895a20e3a8580aefb15ff5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Impuls", "link": "https://stackoverflow.com/users/8126053/impuls"}, "edited": false, "score": 0, "creation_date": 1496849901, "post_id": 44416729, "comment_id": 75833104, "body": "Thank you so much, the code works and that is exactly what I needed :)"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1496850614, "post_id": 44416729, "comment_id": 75833563, "body": "You&#39;d better hope nobody has a digit in their name :)"}, {"owner": {"reputation": 1098, "user_id": 6310890, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/I8D5N.jpg?s=128&g=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6310890/kumar"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1496850637, "post_id": 44416729, "comment_id": 75833582, "body": "@ScottHunter yes."}], "tags": [], "owner": {"reputation": 1098, "user_id": 6310890, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/I8D5N.jpg?s=128&g=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6310890/kumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1496850252, "last_edit_date": 1496850252, "creation_date": 1496848803, "answer_id": 44416729, "question_id": 44416079, "link": "https://stackoverflow.com/questions/44416079/how-to-print-a-line-from-a-file-that-has-the-exact-same-index-of-the-student/44416729#44416729", "title": "How to print a line from a file that has the exact same index of the student?", "body": "<p>If I understand your question correctly, you can do this by:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    FILE* file = fopen(\"student.txt\", \"r\");\n    if (file == NULL) {\n      printf (\"File cannot open\\n\");\n      return 1;\n    }\n    char line[256];\n    int index,search;\n    printf(\"Please enter the student index?\\n\");\n    scanf(\"%d\", &amp;search);\n    while (fgets(line, sizeof(line), file)) {\n        sscanf(line,\"%*[^0-9]%d\",&amp;index);\n        if(search == index)\n        {\n            printf(\"%s\", line);\n        }\n    }\n    fclose(file);\n    return 0;\n}\n</code></pre>\n\n<p>If I didn't, add a comment below and I will try to improve my answer. It reads file line by line and then get integer form the line. That is student index. Compare it with the search value, if it satisfy. Then print it print that line.</p>\n"}], "owner": {"reputation": 3, "user_id": 8126053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691d007a895a20e3a8580aefb15ff5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Impuls", "link": "https://stackoverflow.com/users/8126053/impuls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 44416729, "answer_count": 1, "score": -3, "last_activity_date": 1496850252, "creation_date": 1496847170, "last_edit_date": 1496847847, "question_id": 44416079, "link": "https://stackoverflow.com/questions/44416079/how-to-print-a-line-from-a-file-that-has-the-exact-same-index-of-the-student", "title": "How to print a line from a file that has the exact same index of the student?", "body": "<p>I have students in file with first name,last name and index. </p>\n\n<p>This is my txt file:</p>\n\n<pre><code>Jon Wick 1569\nMark Jones 1489\nMike Miler 2050\n</code></pre>\n\n<p>I want the user to input an index number and program should print the line with same index of student.</p>\n\n<p>this is my code:</p>\n\n<pre><code>    char ch;\n    int index;\n    FILE *pfile;\n\n    pfile = fopen(\"student.txt\",\"r\");\n    printf(\"Enter index of student: \");\n    scanf(\"%d\",&amp;index);\n    while((ch = fgetc(pfile)) != EOF){\n        ...\n    }\n\n    fclose(pfile);\n</code></pre>\n"}, {"tags": ["c", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "edited": false, "score": 2, "creation_date": 1496845527, "post_id": 44415381, "comment_id": 75829702, "body": "free prior to use ... bruh"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496845675, "post_id": 44415381, "comment_id": 75829849, "body": "@Stargateur Reference?"}, {"owner": {"reputation": 233, "user_id": 5950963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zNorX.jpg?s=128&g=1", "display_name": "Sheikh Faisal Miskhat", "link": "https://stackoverflow.com/users/5950963/sheikh-faisal-miskhat"}, "edited": false, "score": 1, "creation_date": 1496845909, "post_id": 44415381, "comment_id": 75830065, "body": "f2 is not defined and if its not a typo, there you have your first error. if f1 is called then, yes it is &quot;use after free&quot;."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496846005, "post_id": 44415381, "comment_id": 75830141, "body": "@Stargateur Oh, wait. it&#39;s not a value here. It is used as a pointer. Didn&#39;t notice the format specifier. But if it was <code>%p</code> I don&#39;t think it would be UB."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1496846723, "post_id": 44415381, "comment_id": 75830737, "body": "@EugeneSh. Sorry, it takes me time to find where I read it, <a href=\"https://stackoverflow.com/documentation/c/364/undefined-behavior/2775/read-value-of-pointer-that-was-freed#t=201706071444349704681\">stackoverflow.com/documentation/c/364/undefined-behavior/277&zwnj;&#8203;5/&hellip;</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496847008, "post_id": 44415381, "comment_id": 75830978, "body": "@Stargateur Thanks. That&#39;s a really counter-intuitive point. Just another nitpick - &quot;indeterminate&quot; is not undefined. BTW, found an interesting doc about indeterminate values stability: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1793.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/n1793.pdf</a>"}, {"owner": {"reputation": 261, "user_id": 833220, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/51e521740844cb5039ef2ffed7303271?s=128&d=identicon&r=PG", "display_name": "Vahag Vardanyan", "link": "https://stackoverflow.com/users/833220/vahag-vardanyan"}, "edited": false, "score": 0, "creation_date": 1496848067, "post_id": 44415381, "comment_id": 75831813, "body": "Sorry it was just a typo, I have fixed it already."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1496859044, "post_id": 44415381, "comment_id": 75838305, "body": "@EugeneSh. &quot;<i>... don&#39;t think it would be UB.</i>&quot; It would: <a href=\"https://stackoverflow.com/documentation/c/364/undefined-behavior/2775/read-value-of-pointer-that-was-freed#t=201706071809120620508\">stackoverflow.com/documentation/c/364/undefined-behavior/277&zwnj;&#8203;5/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1496859101, "post_id": 44415381, "comment_id": 75838336, "body": "@alk See the above comment about indeterminate VS undefined..."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1496848654, "last_edit_date": 1496848654, "creation_date": 1496846031, "answer_id": 44415597, "question_id": 44415381, "link": "https://stackoverflow.com/questions/44415381/does-this-code-contain-use-after-free/44415597#44415597", "title": "Does this code contain use-after-free?", "body": "<p>You'll get <em>undefined behaviour</em> (google that term) several times:</p>\n\n<ol>\n<li><p>in <code>f2</code> you are dereferencing <code>x</code> once it has been freed, because <code>printf</code>ing <code>x</code> with the <code>%s</code> format specifier will dereference <code>x</code>, or in other words it will access the memory pointed by <code>x</code>, and that memory will have undetermined content after calling <code>free</code>.</p></li>\n<li><p>even if you remove the <code>free(x</code>), you still get undefined behaviour, because then you are <code>printf</code>ing <code>x</code>, while <code>x</code> is pointing to valid but non initialized memory.</p></li>\n</ol>\n"}], "owner": {"reputation": 261, "user_id": 833220, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/51e521740844cb5039ef2ffed7303271?s=128&d=identicon&r=PG", "display_name": "Vahag Vardanyan", "link": "https://stackoverflow.com/users/833220/vahag-vardanyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": -8, "last_activity_date": 1496848654, "creation_date": 1496845459, "last_edit_date": 1496847755, "question_id": 44415381, "link": "https://stackoverflow.com/questions/44415381/does-this-code-contain-use-after-free", "title": "Does this code contain use-after-free?", "body": "<pre><code>int f2(char* x, int f) {\n    int i=0;\n    free(x);\n    if(f) {\n        printf(\"%s\", x); \n        return 1;\n    }\n    return 0;\n}\n\nint main(int argc, char argv) {\n    char* x = malloc(10);\n    return f2(x, argc);\n}\n</code></pre>\n\n<p>Is passing freed pointer to printf considered use-after free?</p>\n"}, {"tags": ["c", "matlab", "gcc", "makefile"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496846696, "post_id": 44415328, "comment_id": 75830708, "body": "For starters, Makefiles don&#39;t have a <code>.c</code> extension. Then, your <code>$@</code> is misplaced in your &quot;final linking&quot; rule, it belongs after <code>-o</code> (it is the output)"}, {"owner": {"reputation": 11, "user_id": 8125980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1fe0055f9fd9dcd1048910e1be428b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas &#220;belacker", "link": "https://stackoverflow.com/users/8125980/thomas-%c3%9cbelacker"}, "edited": false, "score": 0, "creation_date": 1496848016, "post_id": 44415328, "comment_id": 75831768, "body": "Thanks a lot!..."}, {"owner": {"reputation": 11, "user_id": 8125980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1fe0055f9fd9dcd1048910e1be428b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas &#220;belacker", "link": "https://stackoverflow.com/users/8125980/thomas-%c3%9cbelacker"}, "edited": false, "score": 0, "creation_date": 1496849110, "post_id": 44415328, "comment_id": 75832546, "body": "Now, I changed my code a little bit and I get the posted errors... How could I solve this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496860866, "post_id": 44415328, "comment_id": 75839286, "body": "I have no idea about matlab, maybe find some documentation there about <i>what exactly</i> a &quot;mexa64&quot; file <i>is</i>? Maybe it&#39;s a shared object and just adding <code>-shared</code> to the linking stage will do, but I really doubt it, you probably need some &quot;special matlab linking&quot;..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8125980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1fe0055f9fd9dcd1048910e1be428b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas &#220;belacker", "link": "https://stackoverflow.com/users/8125980/thomas-%c3%9cbelacker"}, "edited": false, "score": 0, "creation_date": 1496907877, "post_id": 44423458, "comment_id": 75857105, "body": "Thanks for your response. I need number 1. The main() function should be substituted by the mexFunction(). So the there should not be a main() function at all. So the mexFunction() has the functionality of the main() function."}, {"owner": {"reputation": 1302, "user_id": 2254698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXRZ3.jpg?s=128&g=1", "display_name": "informaton", "link": "https://stackoverflow.com/users/2254698/informaton"}, "reply_to_user": {"reputation": 11, "user_id": 8125980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1fe0055f9fd9dcd1048910e1be428b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas &#220;belacker", "link": "https://stackoverflow.com/users/8125980/thomas-%c3%9cbelacker"}, "edited": false, "score": 0, "creation_date": 1497017104, "post_id": 44423458, "comment_id": 75915999, "body": "If you need number 1, don&#39;t you already have it working then?  You will use &#39;mex&#39; within MATLAB, not gcc."}, {"owner": {"reputation": 1302, "user_id": 2254698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXRZ3.jpg?s=128&g=1", "display_name": "informaton", "link": "https://stackoverflow.com/users/2254698/informaton"}, "reply_to_user": {"reputation": 11, "user_id": 8125980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1fe0055f9fd9dcd1048910e1be428b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas &#220;belacker", "link": "https://stackoverflow.com/users/8125980/thomas-%c3%9cbelacker"}, "edited": false, "score": 0, "creation_date": 1497017494, "post_id": 44423458, "comment_id": 75916314, "body": "You said, &quot;The code works fine in the command window, but if I try to make it executable from matlab (.mexa64 file) it is not working.&quot;  I understand that to mean that you can get it work within the MATLAB command window (because you compiled it from mex), but the second part are you saying (a) You can&#39;t make it execute within MATLAB (contrary to what you just said) or (b) You can&#39;t build an executable from MATLAB (contrary to what you are trying to do with using a makefile and gcc)."}], "tags": [], "owner": {"reputation": 1302, "user_id": 2254698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXRZ3.jpg?s=128&g=1", "display_name": "informaton", "link": "https://stackoverflow.com/users/2254698/informaton"}, "is_accepted": false, "score": 0, "last_activity_date": 1496872619, "creation_date": 1496872619, "answer_id": 44423458, "question_id": 44415328, "link": "https://stackoverflow.com/questions/44415328/makefile-to-create-an-executable-mexa64-file-from-matlab/44423458#44423458", "title": "Makefile to create an executable .mexa64 file from matlab", "body": "<p>It is a bit unclear what you mean by an \"executable\" .mexa64 file.  </p>\n\n<ol>\n<li><p>MATLAB's <a href=\"https://www.mathworks.com/help/matlab/ref/mex.html\" rel=\"nofollow noreferrer\">mex compiler</a> will let you compile C/C++ code with MATLAB libraries into a mex file (with 64 bit architecture for you here) that you can then \"execute\" via MATLAB's command line.  This seems to be what you have gotten to work already.</p></li>\n<li><p>However, if you want to have a stand alone \"executable\" outside of MATLAB, you need to work with MATLAB's mcr compiler (see the <a href=\"https://www.mathworks.com/help/compiler/mcc.html\" rel=\"nofollow noreferrer\">reference here</a>).  There are flags that you can set in the process to be build an object file which you can then link with later on with your makefile as you are trying to now. </p></li>\n</ol>\n\n<p>So, don't mix mex compiled files which are runnable within MATLAB and mcr compiled code that is executable outside of it.  </p>\n\n<p>Apart from this, gcc is complaining that there is no main() function.  I don't see one in your code here either, but you need a main() function for a standalone executable.  </p>\n"}], "owner": {"reputation": 11, "user_id": 8125980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1fe0055f9fd9dcd1048910e1be428b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas &#220;belacker", "link": "https://stackoverflow.com/users/8125980/thomas-%c3%9cbelacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 849, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496927320, "creation_date": 1496845291, "last_edit_date": 1496927320, "question_id": 44415328, "link": "https://stackoverflow.com/questions/44415328/makefile-to-create-an-executable-mexa64-file-from-matlab", "title": "Makefile to create an executable .mexa64 file from matlab", "body": "<p>I try to write a makefile to create an executable .mexa64 file. I have to use the gcc compiler. My current working folder looks like this: </p>\n\n<pre><code>FFTW_build.c\nFFTW_func.c \nMakefile.c  \nobj (Folder, here are my object files *.o which are created)\n</code></pre>\n\n<p><strong>Source code FFTW_build.c:</strong> </p>\n\n<pre><code>#include \"mex.h\"\n\nvoid mexFunction(int nlhs, mxArray *plhs[],  int nrhs, const mxArray *prhs[])\n{\n    FFTW_perform();\n    return;\n}\n</code></pre>\n\n<p><strong>Source code FFTW_func.c:</strong> </p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;complex.h&gt;\n#include &lt;fftw3.h&gt;\n#include \"mex.h\"\n\n\nvoid FFTW_perform() {\n\n int i;\n int Npoints=10;\n fftw_complex *in, *out;\n fftw_plan plan;\n\n in = (fftw_complex*) fftw_malloc(sizeof(fftw_complex)*Npoints);\n out = (fftw_complex*) fftw_malloc(sizeof(fftw_complex)*Npoints);\n plan = fftw_plan_dft_1d(Npoints, in, out, FFTW_FORWARD, FFTW_ESTIMATE);\n mexPrintf(\"\\nCoefficcients of the expansion:\\n\\n\");\n\n for(i = 0; i &lt; Npoints; i++)\n    {\n        in[i] = (i+1)+(3*i-1)*I;\n        mexPrintf(\"%d %11.7f %11.7f\\n\", i, creal(in[i]), cimag(in[i]));\n\n    }\n\n mexPrintf(\"\\n\");\n\n    fftw_execute(plan); \n\n    mexPrintf(\"Output:\\n\\n\");\n    for(i = 0; i &lt; Npoints; i++)\n    {\n        mexPrintf(\"%d %11.7f %11.7f\\n\", i, creal(out[i]), cimag(out[i]));\n    }\n}\n</code></pre>\n\n<p><strong>Source code for Makefile.c:</strong>  </p>\n\n<pre><code>##################    Compiler    ##################\nCXX = gcc \n####################################################\n\n##################    MEXSUFFIX  ################\nMEXSUFFIX  = mexa64  \n####################################################\n\n##################   Home of my matlab version #####\nMATLABHOME = /home/tuebel/matlab\n####################################################\n\n\n##################    Object_File_Declaration_Folder    ################\n\nOBJS_MEX       = FFTW_build.o\nOBJS_FFTW_FUNC = FFTW_func.o \n\nODIR=obj\n\n_OBJ = $(OBJS_MEX) $(OBJS_FFTW_FUNC)\nOBJ  = $(patsubst %,$(ODIR)/%,$(_OBJ))\n\n\n####################################################\n\n##################    Header_Files    ################\n\n\n# Header for mex \nDIR_MEX_HEADER = /home/tuebel/matlab/extern/include\n\n_DEPS_MEX = mex.h\nDEPS_MEX  = $(patsubst %,$(DIR_MEX_HEADER)/%,$(_DEPS_MEX))\n\n\n# Header for fftw3\nDIR_FFTW_HEADER = /usr/local/include\n\n_DEPS_FFTW = fftw3.h\nDEPS_FFTW  = $(patsubst %,$(DIR_FFTW_HEADER)/%,$(_DEPS_FFTW))\n\n\n####################################################\n\n\n##################    Library_Files    ################\n\n# Libraries for mex\nMEX_LIB  = /home/tuebel/matlab/bin/glnxa64/libmex.so   \n\n# Libraries for FFTW\nFFTW_LIB = /usr/local/lib/libfftw3.a\n\n# Libraries for math_function\nMATH_LIB = -lm \n\n\n####################################################\n\n##################    Flags    ################\n\n# MEXFLAGS         = -shared -Wl,--no-undefined -Wl,-rpath-link,$(MATLABHOME)/bin/glnxa64 -L$(MATLABHOME)/bin/glnxa64 -lmex -lmat -lmx -lm\n\nMEXFLAGS         =  -shared -Wl,-rpath-link,$(MATLABHOME)/bin/glnxa64 -L$(MATLABHOME)/bin/glnxa64 -lmex -lmat -lmx -lm\nCOMPILERFLAGS    =  -fPIC -pthread -DMATLAB_MEX_FILE -ansi -D_GNU_SOURCE -fno-omit-frame-pointer -O3 -DNDEBUG\n\nFFTW_FLAGS_INCLUDE     = -I$(DIR_FFTW_HEADER)\nMEX_FLAGS_INCLUDE      = -I$(DIR_MEX_HEADER)\n\n####################################################\n\n####################  Final_Part   ######################\n\nTARGET = FFTW_MEX\n\nall: $(TARGET) \n    echo ALL DONE\n\nclean: \n    rm -f $(ODIR)/*.o \n    rm -f $(TARGET).mexa64\n    echo CLEAN DONE\n\n\n$(ODIR)/%.o: %.c $(DEPS_MEX) $(DEPS_FFTW)\n    $(CXX) -c -o $@ $&lt;  $(COMPILERFLAGS) $(MEX_FLAGS_INCLUDE) $(FFTW_FLAGS_INCLUDE)     \n\n# Final_Linking\n\n$(TARGET) : $(OBJ)  $(MATH_LIB) $(FFTW_LIB) \n    $(CXX) -o $@.$(MEXSUFFIX) $(MEX_FLAGS_INCLUDE) $(FFTW_FLAGS_INCLUDE) $^ $(MEXFLAGS) \n\n\n####################################################\n\n####################################################\n\n####################################################\n</code></pre>\n\n<p>The idea is to make a FFTW using fftw3. The code works fine in the command window, but if I try to make it executable from matlab (.mexa64 file) it is not working. I get the following error message using make: </p>\n\n<pre><code>gcc  -c -o obj/FFTW_build.o FFTW_build.c  -fPIC -pthread -DMATLAB_MEX_FILE -ansi -D_GNU_SOURCE -fno-omit-frame-pointer -O3 -DNDEBUG -I/home/tuebel/matlab/extern/include -I/usr/local/include \ngcc  -c -o obj/FFTW_func.o FFTW_func.c  -fPIC -pthread -DMATLAB_MEX_FILE -ansi -D_GNU_SOURCE -fno-omit-frame-pointer -O3 -DNDEBUG -I/home/tuebel/matlab/extern/include -I/usr/local/include \ngcc  -o FFTW_MEX.mexa64   -I/home/tuebel/matlab/extern/include -I/usr/local/include obj/FFTW_build.o obj/FFTW_func.o /usr/lib64/libm.so /usr/local/lib/libfftw3.a -shared -Wl,-rpath-link,/home/tuebel/matlab/bin/glnxa64 -L/home/tuebel/matlab/bin/glnxa64 -lmex -lmat -lmx -lm \n/usr/lib64/gcc/x86_64-suse-linux/4.8/../../../../x86_64-suse-linux/bin/ld: /usr/local/lib/libfftw3.a(lt4-problem.o): relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC\n/usr/local/lib/libfftw3.a: error adding symbols: Bad value\ncollect2: error: ld returned 1 exit status\nMakefile:92: recipe for target 'FFTW_MEX' failed\nmake: *** [FFTW_MEX] Error 1\n</code></pre>\n\n<p>Can someone help me out? This is my first Makefile and I would be glad for any help... I am also glad for corrections to the Makefile...</p>\n\n<p>Thanks a lot! </p>\n"}, {"tags": ["c", "architecture", "refactoring"], "comments": [{"owner": {"reputation": 341, "user_id": 8014927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67794efc7db32a3d67d882160d834a7?s=128&d=identicon&r=PG&f=1", "display_name": "wyc", "link": "https://stackoverflow.com/users/8014927/wyc"}, "edited": false, "score": 0, "creation_date": 1496847405, "post_id": 44415299, "comment_id": 75831294, "body": "Looking at the your MODEL_CR code and MODEL_CV code, I assume you need device specific function for the return value. If you have one method to detect all models, does it mean you must include all device specific libraries in the projects? For this reason, I vote for using separate source files and makefile options."}], "answers": [{"tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1496847775, "creation_date": 1496847775, "answer_id": 44416327, "question_id": 44415299, "link": "https://stackoverflow.com/questions/44415299/configurable-custom-code/44416327#44416327", "title": "Configurable custom code", "body": "<p>Define a shared library for each tool and a configuration file that defines what functions get called for each tool.  Load the shared libraries at startup and provide a signal catcher to reload if the configuration file changes.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1496935004, "creation_date": 1496935004, "answer_id": 44439631, "question_id": 44415299, "link": "https://stackoverflow.com/questions/44415299/configurable-custom-code/44439631#44439631", "title": "Configurable custom code", "body": "<p>the OPs question (and posted code) says that 3 places will need to be modified.</p>\n\n<ol>\n<li>the function: <code>get_tool_type()</code></li>\n<li>the header file with the definitions of <code>MODEL_CV</code>, <code>MODEL_CR</code>, etc</li>\n<li>the <code>if-then-else</code> list.</li>\n</ol>\n\n<p>were it me, I would implement a table of function pointers, have <code>get_tool_type()</code> return an index into that table.  Then all the if/then/else code would become a single statement that invokes a function from the table.</p>\n\n<p>Then any updates would be additions to the table, modifications to 'get_too_type()<code>, and the additional functions like</code>beam_off()`</p>\n\n<p>The loss of a tool type would not require any code change.</p>\n\n<p>the addition of a tool type would require appending an entry to the table, mod to <code>get_tool_type()</code> to recognize the new tool, and the new function to process the new tool type.</p>\n\n<p>Of course, this could result in code that is never executed.</p>\n"}], "owner": {"reputation": 4757, "user_id": 382485, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/422fe6da66c4912411106a60a3de4da1?s=128&d=identicon&r=PG", "display_name": "Maanu", "link": "https://stackoverflow.com/users/382485/maanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496935004, "creation_date": 1496845203, "question_id": 44415299, "link": "https://stackoverflow.com/questions/44415299/configurable-custom-code", "title": "Configurable custom code", "body": "<p>Our customer provided source code has portions of code that will be executed based on tool type. A sample code portion is given below. The function has common portions and tool specific(hardware platform) portions. The code is written in C and runs in VxWorks. Addition or deletion of new tool type has code modification. The customer wants addition or deletion new tool type with minimal code change and testing effort</p>\n\n<pre><code>int vsp_recv(char *const recv_text)\n{\n    int rc  = 0;\n    const int       type =  get_tool_type();\n    // Common Code  \n\n    if (MODEL_CR == type)\n    {\n        rc = beamoff(recv_text);                \n    }\n    else\n    {\n        rc = vsp_set(recv_text);\n    }\n\n    return(rc);\n}\n</code></pre>\n\n<p>Is it the right technique to separate the code to two methods as given below, keep them in separate source files and define separate make files to generate tool specific binary? Is there any better ways to do this?</p>\n\n<p>Tool type MODEL_CR code</p>\n\n<pre><code>int vsp_recv_tool_speccific(char *const recv_text)\n{\n    return beamoff(recv_text);              \n}\n</code></pre>\n\n<p>Tool type MODEL_CV code</p>\n\n<pre><code>int vsp_recv_tool_speccific(char *const recv_text)\n{\n    return vsp_set(recv_text);              \n}\n</code></pre>\n\n<p>Refactored method</p>\n\n<pre><code>int vsp_recv(char *const recv_text)\n{\n    int rc  = 0;\n    const int       type =  get_tool_type();\n    // Common Code  \n\n    rc = vsp_recv_tool_speccific(recv_text);                \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8125992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfa1eb8787f2aa479b428f589ba3716?s=128&d=identicon&r=PG&f=1", "display_name": "testtest1235", "link": "https://stackoverflow.com/users/8125992/testtest1235"}, "edited": false, "score": 0, "creation_date": 1496862541, "post_id": 44417229, "comment_id": 75840254, "body": "Thanks for answer. Anyway I&#39;m not sure it absolutely answers the question I was having. What happens if one write thread is waiting on pthread_cond_wait() and we have two read threads. One read threads manages to lock mutex and send broadcast. After it releases this mutex, is there any guarantee that write thread will lock mutex next as it is waiting for broadcast (another read thread is waiting to lock mutex at the same time)?"}, {"owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "reply_to_user": {"reputation": 31, "user_id": 8125992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfa1eb8787f2aa479b428f589ba3716?s=128&d=identicon&r=PG&f=1", "display_name": "testtest1235", "link": "https://stackoverflow.com/users/8125992/testtest1235"}, "edited": false, "score": 0, "creation_date": 1496874524, "post_id": 44417229, "comment_id": 75845964, "body": "@testtest1235 I&#39;ve expanded my answer with some additional informations and examples."}], "tags": [], "owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "is_accepted": false, "score": 1, "last_activity_date": 1496874483, "last_edit_date": 1496874483, "creation_date": 1496850108, "answer_id": 44417229, "question_id": 44415264, "link": "https://stackoverflow.com/questions/44415264/pthread-cond-wait-and-pthread-mutex-lock-priority/44417229#44417229", "title": "pthread_cond_wait and pthread_mutex_lock priority?", "body": "<p>Let's assume both threads, read and write, reach the <code>pthread_mutex_lock</code> in the same moment. So, either write thread acquire the mutex on <code>pthread_mutex_lock</code> call, or read thread.</p>\n\n<p>If it would be the write thread, the read one will wait on <code>pthread_mutex_lock</code>. The write, by calling <code>pthread_cond_wait</code> releases <code>mutex</code> and blocks on <code>cond</code>. It is done atomically. So, when read thread is grantex the <code>mutex</code>, we can be sure the the read one waits on <code>cond</code>. So, broadcast on <code>cond</code> reaches the write thread, it no more waits on <code>cond</code> but - still in scope of <code>pthread_cond_wait</code> - tries to get a lock on <code>mutex</code> (hold be read thread). After broadcasting <code>cond</code> the read thread releases the <code>mutex</code> and it goes to write thread. So write thread finally exits from <code>pthread_cond_wait</code> having the <code>mutex</code> locked. Remember to unlock it later.</p>\n\n<p>If it would be the read thread, the write one will wait on <code>pthread_mutex_lock</code>, the read will broadcast a signal on <code>cond</code> then release the <code>mutex</code>. After then the write thread acquires the <code>mutex</code> on <code>pthread_mutex_lock</code> and immediately releases in it <code>pthread_cond_wait</code> waiting for <code>cond</code> (please note, that previous <code>cond</code> broadcast has no effect on current <code>pthread_cond_wait</code>). In the next iteration of read thread it acquires lock on<code>mutex</code>, send broadcast on <code>cond</code> and unlock <code>mutex</code>. It means the write thread moves forward on <code>cond</code> and acquires lock on <code>mutex</code>.</p>\n\n<p>Does it answer your question about priority?</p>\n\n<hr>\n\n<p>Update after comment.</p>\n\n<p>Let's assume we have one thread (let's name it <code>A</code> for future reference) holding the lock on <code>mutex</code> and few other trying to acquire the same lock. As soon as the lock is released by first thread, there is no predictable which thread would acquire lock. Moreover, if the <code>A</code> thread has a loop and tries to reacquire lock on <code>mutex</code>, there is a chance it would be granted this lock and other threads would keep waiting. Adding <code>pthread_cond_wait</code> doesn't change anything in scope of granting a lock.</p>\n\n<p>Let me quote fragments of POSIX specification (see <a href=\"https://stackoverflow.com/a/9625267/2989411\">https://stackoverflow.com/a/9625267/2989411</a> for reference):</p>\n\n<blockquote>\n  <p>These functions atomically release mutex and cause the calling thread to block on the condition variable cond; atomically here means \"atomically with respect to access by another thread to the mutex and then the condition variable\". That is, if another thread is able to acquire the mutex after the about-to-block thread has released it, then a subsequent call to pthread_cond_broadcast() or pthread_cond_signal() in that thread shall behave as if it were issued after the about-to-block thread has blocked.</p>\n</blockquote>\n\n<p>And this is only guarantee given by standard regarding order of operations. Order of granting the lock to other threads is rather unpredictable and it changes depending on some very subtle fluctuation in timing.</p>\n\n<p>For only mutex related code, please play a little with following code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define _GNU_SOURCE\n#include &lt;pthread.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\nvoid *th(void *arg) {\n    int i;\n    char *s = arg;\n    for (i = 0; i &lt; 10; ++i) {\n        pthread_mutex_lock(&amp;mutex);\n        printf(\"%s %d\\n\", s, i);\n        //sleep(1);\n        pthread_mutex_unlock(&amp;mutex);\n#if 0\n        pthread_yield();\n#endif\n    }\n    return NULL;\n}\n\nint main() {\n    int i;\n    for (i = 0; i &lt; 10; ++i) {\n        pthread_t t1, t2, t3;\n        printf(\"================================\\n\");\n        pthread_create(&amp;t1, NULL, th, \"t1\");\n        pthread_create(&amp;t2, NULL, th, \"     t2\");\n        pthread_create(&amp;t3, NULL, th, \"            t3\");\n        pthread_join(t1, NULL);\n        pthread_join(t2, NULL);\n        pthread_join(t3, NULL);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>On one machine (single CPU) it always shows whole loop from t3, then t2 and finally from t1. On another (2 cores) the order of threads is more random, but almost always it shows whole loop for each thread before granting the mutex to other thread. Rarely there is a situation like:</p>\n\n<pre><code>t1 8\nt1 9\n            t3 0\n     t2 0\n     t2 1\n     [removed other t2 output]\n     t2 8\n     t2 9\n            t3 1\n            t3 2\n</code></pre>\n\n<p>Enable <code>pthread_yield</code> by replacing <code>#if 0</code> with <code>#if 1</code> and watch results and check output. For me it works in a way two threads display their output interlaced, then third thread finally has a chance to work. Add another or more thread. Play with sleep, etc. It confirms the random behaviour.</p>\n\n<p>If you wish to experiment a little, compile and run following piece of code. It's an example of single producer - multiple consumers model. It can be run with two parameters: first is the number of consumer threads, second is the length of produced data series. If no parameters are given there is one consumer thread and 120 items to be processed. I also recommend with sleep/usleep in places marked <code>/* play here */</code>: change the value of arguments, remove the sleep at all, move it - when appropriate - to critical section or replace with pthread_yield and observe changes in behaviour.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\nstruct data_t {\n    int seq;\n    int payload;\n    struct data_t *next;\n};\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t cond = PTHREAD_COND_INITIALIZER;\nstruct data_t *first = NULL, *last = NULL;\nint in_progress = 1;\nint num_data = 120;\n\nvoid push(int seq, int payload) {\n    struct data_t *e;\n    e = malloc(sizeof(struct data_t));\n    e-&gt;seq = seq;\n    e-&gt;payload = payload;\n    e-&gt;next = NULL;\n    if (last == NULL) {\n        assert(first == NULL);\n        first = last = e;\n    } else {\n        last-&gt;next = e;\n        last = e;\n    }\n}\n\nstruct data_t pop() {\n    struct data_t res = {0};\n    if (first == NULL) {\n        res.seq = -1;\n    } else {\n        res.seq = first-&gt;seq;\n        res.payload = first-&gt;payload;\n        first = first-&gt;next;\n        if (first == NULL) {\n            last = NULL;\n        }\n    }\n    return res;\n}\n\nvoid *producer(void *arg __attribute__((unused))) {\n    int i;\n    printf(\"producer created\\n\");\n    for (i = 0; i &lt; num_data; ++i) {\n        int val;\n        sleep(1); /* play here */\n        pthread_mutex_lock(&amp;mutex);\n        val = rand() / (INT_MAX / 1000);\n        push(i, val);\n        pthread_mutex_unlock(&amp;mutex);\n        pthread_cond_signal(&amp;cond);\n        printf(\"prod %3d %3d signaled\\n\", i, val);\n    }\n    in_progress = 0;\n    printf(\"prod end\\n\");\n    pthread_cond_broadcast(&amp;cond);\n    printf(\"prod end signaled\\n\");\n    return NULL;\n}\n\nvoid *consumer(void *arg) {\n    char c_id[1024];\n    int t_id = *(int *)arg;\n    sprintf(c_id, \"%*s c %02d\", t_id % 10, \"\", t_id);\n    printf(\"%s created\\n\", c_id);\n    while (1) {\n        struct data_t item;\n        pthread_mutex_lock(&amp;mutex);\n        item = pop();\n        while (item.seq == -1 &amp;&amp; in_progress) {\n            printf(\"%s waits for data\\n\", c_id);\n            pthread_cond_wait(&amp;cond, &amp;mutex);\n            printf(\"%s got signal\\n\", c_id);\n            item = pop();\n        }\n        if (!in_progress &amp;&amp; item.seq == -1) {\n            printf(\"%s detected end of data.\\n\", c_id);\n            pthread_mutex_unlock(&amp;mutex);\n            break;\n        }\n        pthread_mutex_unlock(&amp;mutex);\n        printf(\"%s processing %3d %3d\\n\", c_id, item.seq, item.payload);\n        sleep(item.payload % 10); /* play here */\n        printf(\"%s processed  %3d %3d\\n\", c_id, item.seq, item.payload);\n    }\n    printf(\"%s end\\n\", c_id);\n    return NULL;\n}\n\nint main(int argc, char *argv[]) {\n    int num_cons = 1;\n    pthread_t t_prod;\n    pthread_t *t_cons;\n    int i;\n    int *nums;\n    if (argc &gt; 1) {\n        num_cons = atoi(argv[1]);\n        if (num_cons == 0) {\n            num_cons = 1;\n        }\n        if (num_cons &gt; 99) {\n            num_cons = 99;\n        }\n    }\n    if (argc &gt; 2) {\n        num_data = atoi(argv[2]);\n        if (num_data &lt; 10) {\n            num_data = 10;\n        }\n        if (num_data &gt; 600) {\n            num_data = 600;\n        }\n    }\n\n    printf(\"Spawning %d consumer%s for %d items.\\n\", num_cons, num_cons == 1 ? \"\" : \"s\", num_data);\n    t_cons = malloc(sizeof(pthread_t) * num_cons);\n    nums = malloc(sizeof(int) * num_cons);\n    if (!t_cons || !nums) {\n        printf(\"Out of memory!\\n\");\n        exit(1);\n    }\n    srand(time(NULL));\n    pthread_create(&amp;t_prod, NULL, producer, NULL);\n\n    for (i = 0; i &lt; num_cons; ++i) {\n        nums[i] = i + 1;\n        usleep(100000); /* play here */\n        pthread_create(t_cons + i, NULL, consumer, nums + i);\n    }\n\n    pthread_join(t_prod, NULL);\n\n    for (i = 0; i &lt; num_cons; ++i) {\n        pthread_join(t_cons[i], NULL);\n    }\n    free(nums);\n    free(t_cons);\n\n    return 0;\n}\n</code></pre>\n\n<p>I hope I have cleared your doubts and gave you some code to experiment and gain some confidence about pthread behaviour.</p>\n"}], "owner": {"reputation": 31, "user_id": 8125992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfa1eb8787f2aa479b428f589ba3716?s=128&d=identicon&r=PG&f=1", "display_name": "testtest1235", "link": "https://stackoverflow.com/users/8125992/testtest1235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1496874483, "creation_date": 1496845107, "question_id": 44415264, "link": "https://stackoverflow.com/questions/44415264/pthread-cond-wait-and-pthread-mutex-lock-priority", "title": "pthread_cond_wait and pthread_mutex_lock priority?", "body": "<p>I have a multiple read threads and one write thread. If I lock mutex on one of the read threads and send broadcast from it, is it guaranteed that mutex will be locked by write thread waiting on pthread_cond_wait() or is there a possibility that another read thread that is wainting on pthread_mutex_lock() will lock mutex? Main question is does pthread_cond_wait() have priority over pthread_mutex_lock()?</p>\n\n<p>If not, how can I achieve that the mutex will always be locked by write thread on pthread_cond_broadcast()?</p>\n\n<p>Example</p>\n\n<p>Read thread:</p>\n\n<pre><code>pthread_mutex_lock(mutex);\npthread_cond_broadcast(cond);\npthread_mutex_unlock(mutex);\n</code></pre>\n\n<p>Write thread:</p>\n\n<pre><code>pthread_mutex_lock(&amp;mutex);\npthread_cond_wait(&amp;cond, &amp;mutex);\n</code></pre>\n"}, {"tags": ["c", "switch-statement", "setjmp"], "comments": [{"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 3, "creation_date": 1496844885, "post_id": 44414988, "comment_id": 75829210, "body": "Your <code>printf</code> statements need some <code>;</code> lovin&#39;."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1496845028, "post_id": 44414988, "comment_id": 75829326, "body": "They love double quotes, too..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1496845065, "post_id": 44414988, "comment_id": 75829356, "body": "Mind you, there&#39;s nothing like a 32 bit implementation defined character array like <code>&#39;sth.&#39;</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1496845709, "post_id": 44414988, "comment_id": 75829884, "body": "There&#39;s no assignment being done to <code>rc</code> yet its value being compared.  Are you sure this is the <b>exact</b> code you found?"}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1496844958, "post_id": 44415031, "comment_id": 75829267, "body": "What in the actual... Also they say it can be <i>the entire expression of an expression statement</i>, so that&#39;s absolutely unnecessary anyway."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 2, "creation_date": 1496844986, "post_id": 44415031, "comment_id": 75829286, "body": "cute is one term."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1496845743, "post_id": 44415031, "comment_id": 75829902, "body": "Personally,I don&#39;t think that linking to a <b>C++</b> documentation site is appropiate, especially not in sensitive (fragile) areas like this."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1496845804, "post_id": 44415031, "comment_id": 75829967, "body": "It does purport to treat C too, and my specific link is a C page. If you know of a correspondingly &quot;canonical&quot; reference for C then do please let me know."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1496845955, "post_id": 44415031, "comment_id": 75830103, "body": "Why, the C specific documentation on cppreference, of course. <a href=\"http://en.cppreference.com/w/c/program/setjmp\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/program/setjmp</a> Is linked to at the bottom of the page for the C++ documentation."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1496845711, "last_edit_date": 1496845711, "creation_date": 1496844522, "answer_id": 44415031, "question_id": 44414988, "link": "https://stackoverflow.com/questions/44414988/a-special-switch-statement-in-c/44415031#44415031", "title": "A special switch statement in C", "body": "<p>It's someone being cute: the <em>documentation</em> of the C-standard library function <code>setjmp</code> reveals that the function can only be used in a small number of places; the <em>controlling expression</em> of a <code>switch</code> being one of them.</p>\n\n<p><code>switch(setjmp(buf));</code> doesn't actually do anything other than call the function <code>setjmp(buf)</code>. The <em>body</em> of the <code>switch</code> is the empty statement <code>;</code></p>\n\n<p>Note that the considerably less obtuse</p>\n\n<pre><code>setjmp(buf);\n</code></pre>\n\n<p>is also valid. Perhaps the author uses the <code>switch</code> obfuscation to signal that they are doing something out of the ordinary.</p>\n\n<p>Reference: <a href=\"http://en.cppreference.com/w/cpp/utility/program/setjmp\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/utility/program/setjmp</a></p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496845271, "post_id": 44415241, "comment_id": 75829526, "body": "You can call it as (from C11) &quot;the entire expression of an expression statement (possibly cast to void)&quot;. I would suspect they wanted to avoid weird cases of poorly defined order of evaluation, such as <code>foo = setjmp(env1) | setjmp(env2)</code>."}, {"owner": {"reputation": 81, "user_id": 393753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5500f692351f13835aa77fed23e8023a?s=128&d=identicon&r=PG", "display_name": "Jazzinghen", "link": "https://stackoverflow.com/users/393753/jazzinghen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496845534, "post_id": 44415241, "comment_id": 75829707, "body": "Yup, that seems about right. I did not think about using it that way, actually. It looks like looking for troubles :)"}, {"owner": {"reputation": 81, "user_id": 393753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5500f692351f13835aa77fed23e8023a?s=128&d=identicon&r=PG", "display_name": "Jazzinghen", "link": "https://stackoverflow.com/users/393753/jazzinghen"}, "edited": false, "score": 0, "creation_date": 1496845694, "post_id": 44415241, "comment_id": 75829868, "body": "Mh, yeah, you are right. It&#39;s a quirk due to the fact that I work with C++. Let me get a better reference."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496846015, "post_id": 44415241, "comment_id": 75830155, "body": "I found out the real rationale and it turns out it is because they can&#39;t implement it as a function. I posted a separate answer with a quote from the C rationale."}, {"owner": {"reputation": 81, "user_id": 393753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5500f692351f13835aa77fed23e8023a?s=128&d=identicon&r=PG", "display_name": "Jazzinghen", "link": "https://stackoverflow.com/users/393753/jazzinghen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496847512, "post_id": 44415241, "comment_id": 75831395, "body": "Oh, that&#39;s nice. Thanks for the contribution, and yes, it smells like  spaghetti-code."}], "tags": [], "owner": {"reputation": 81, "user_id": 393753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5500f692351f13835aa77fed23e8023a?s=128&d=identicon&r=PG", "display_name": "Jazzinghen", "link": "https://stackoverflow.com/users/393753/jazzinghen"}, "is_accepted": false, "score": 1, "last_activity_date": 1496845794, "last_edit_date": 1496845794, "creation_date": 1496845047, "answer_id": 44415241, "question_id": 44414988, "link": "https://stackoverflow.com/questions/44414988/a-special-switch-statement-in-c/44415241#44415241", "title": "A special switch statement in C", "body": "<p>You cannot call <code>setjmp</code> outside a conditional check location, when a <code>longjmp</code> is called then the execution is resumed at the <code>setjmp</code> location stored in the <code>buf</code> parameter, returning the value passed to <code>longjmp</code>. I believe that who wrote the code just needed a conditional check location that did nothing, hence the empty <code>switch</code>.</p>\n\n<p>To know more check the POSIX reference page that provides the documentation for the function as stated in the ISO C standard: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setjmp.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/9699919799/functions/setjmp.html</a></p>\n\n<p>Also the manpage for longjmp(3) seems to provide more in-depth information: <a href=\"http://man7.org/linux/man-pages/man3/longjmp.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/longjmp.3.html</a></p>\n\n<p><strong>[Edit]</strong></p>\n\n<p>Huh, it actual looks like you can call it outside a conditional check, specifically \"The entire expression of an expression statement\". I do not know why they did it, even though I understand why it would be best called in a conditional, so you can check its return value from wherever you jumped from.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1496846288, "last_edit_date": 1496846288, "creation_date": 1496845902, "answer_id": 44415546, "question_id": 44414988, "link": "https://stackoverflow.com/questions/44414988/a-special-switch-statement-in-c/44415546#44415546", "title": "A special switch statement in C", "body": "<p>First of all, please note that <code>setjmp</code> and <code>longjmp</code> are considered incredible poor practice to use, the worst kind of spaghetti programming. Any source of learning teaching you to use these functions should be regarded with great scepticism. </p>\n\n<hr>\n\n<p>As for the reason why the weird switch statement is there, it is because of a number of artificial requirements placed on the <code>setjmp</code> function by the standard. C11 7.13.1.1</p>\n\n<blockquote>\n  <p>Environmental limits  An invocation of the setjmp macro shall appear\n  only in one of the following contexts:<br>\n  \u2014 the entire controlling\n  expression of a selection or iteration statement;<br>\n  \u2014 one operand of a\n  relational or equality operator with the other operand an integer\n  constant expression, with the resulting expression being the entire\n  controlling expression of a selection or iteration statement;<br>\n  \u2014 the operand of a unary ! operator with the resulting expression being the entire\n  controlling expression of a selection or iteration statement; or<br>\n  \u2014 the entire expression of an expression statement (possibly cast to void).</p>\n</blockquote>\n\n<p>Please note that the last point above allows code such as <code>(void) setjmp(env);</code>, so the switch statement in the question is mostly obfuscation.</p>\n\n<p>The C standard rationale 7.13.1 provides an explanation of why this \"function\" has such artificial requirements, namely because it must be implemented as a macro:</p>\n\n<blockquote>\n  <p>7.13.1.1 The setjmp macro<br>\n  One proposed requirement on setjmp is that it be usable like any other function, that is, that it be callable\n  in any expression context, and that the expression evaluate correctly\n  whether the return from setjmp is direct or via a call to longjmp.\n  Unfortunately, any implementation of setjmp as a conventional called\n  function cannot know enough about the calling environment to save any\n  temporary registers or dynamic stack locations used part way through\n  an expression evaluation. (A setjmp macro seems to help only if it expands to inline assembly code or a call\n  to a special built-in function.) The temporaries may be correct on the initial call to setjmp, but\n  are not likely to be on any return initiated by a corresponding call to longjmp. These\n  considerations dictated the constraint that setjmp be called only from within fairly simple expressions, ones not likely to need temporary storage.</p>\n</blockquote>\n\n<p>To put it plainly: if you would call a function instead of a macro, then the CPU/OS might stack away various registers that you actually want setjmp to preserve, most notably the program counter. (setjmp was specified long before the C language supported inline functions.)</p>\n"}], "owner": {"reputation": 71, "user_id": 4402334, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u3NL28sqd14/AAAAAAAAAAI/AAAAAAAAABQ/BH76w_xOUK0/photo.jpg?sz=128", "display_name": "\u5f90\u73cd\u7426", "link": "https://stackoverflow.com/users/4402334/%e5%be%90%e7%8f%8d%e7%90%a6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1496847709, "creation_date": 1496844432, "last_edit_date": 1496847709, "question_id": 44414988, "link": "https://stackoverflow.com/questions/44414988/a-special-switch-statement-in-c", "title": "A special switch statement in C", "body": "<p>I am reading CSAPP, the chapter about <code>setjmp</code> and <code>longjmp</code>, and encounter the following code snippets:</p>\n\n<pre><code>int rc;\nswitch(setjmp(buf));\nif (rc == 0)\n    foo();\nelse if (rc == 1)\n    printf(\"sth.\");\nelse if (rc == 2)\n    printf(\"sth. other\");\n...\n</code></pre>\n\n<p>The switch statement really confused me, could someone explain this usage of switch statement in C for me?</p>\n\n<hr>\n\n<p>PS: This is actually an error of CSAPP(the second edition), and the author fixes this by using normal <code>switch-case</code> statement in the third edition. Thanks for all.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 828, "user_id": 8058683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3NrPU.jpg?s=128&g=1", "display_name": "H. Figueiredo", "link": "https://stackoverflow.com/users/8058683/h-figueiredo"}, "edited": false, "score": 0, "creation_date": 1496844432, "post_id": 44414937, "comment_id": 75828819, "body": "Check the function <code>sprintf()</code>which allows you to save a different type of variable in a string. (e.g: <code>sprintf(string,&quot;%d&quot;,integer);</code>)."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 2, "creation_date": 1496844435, "post_id": 44414937, "comment_id": 75828822, "body": "You can use a <code>struct</code> to store multiple arrays, or 2D arrays which are complicated to use in C."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1496844481, "post_id": 44414937, "comment_id": 75828858, "body": "rethink <code>scanf(&quot;%s&quot;, phone_number)</code>, where <code>phone_number</code> is of type <code>int[]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 2, "last_activity_date": 1496846093, "creation_date": 1496846093, "answer_id": 44415628, "question_id": 44414937, "link": "https://stackoverflow.com/questions/44414937/stored-few-arrays-in-one-array/44415628#44415628", "title": "Stored few arrays in one array", "body": "<p>I'd define a <code>struct customer_struct</code> that represents a customer, and an array of type <code>customer_struct[]</code> that represents a list of customers as follows.</p>\n\n<pre><code>typedef struct customer_struct {\n    char name[50];\n    char last_name[50];\n    char phone_number[15];\n    char address[50];\n} Customer;\n\nvoid add_new_customer(Customer *c) {\n    printf(\"Enter name: \");\n    scanf(\"%s\", c-&gt;name);\n    printf(\"Enter last name: \");\n    scanf(\"%s\", c-&gt;last_name);\n    printf(\"Enter number: \");\n    scanf(\"%s\", c-&gt;phone_number);\n    printf(\"Enter address: \");\n    scanf(\"%s\", c-&gt;address);\n}\n\nint main(){\n\n    Customer customers[3];\n    for (int i=0; i&lt;3; i++) {\n        add_new_customer(&amp;customers[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Hope it helps :-)</p>\n"}], "owner": {"reputation": 85, "user_id": 7179079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-5_z5oHyFAh0/AAAAAAAAAAI/AAAAAAAAAKI/VKq_ZKYWy4Y/photo.jpg?sz=128", "display_name": "Bogdan Skripnik", "link": "https://stackoverflow.com/users/7179079/bogdan-skripnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 44415628, "answer_count": 1, "score": -2, "last_activity_date": 1496853319, "creation_date": 1496844314, "last_edit_date": 1496853319, "question_id": 44414937, "link": "https://stackoverflow.com/questions/44414937/stored-few-arrays-in-one-array", "title": "Stored few arrays in one array", "body": "<p>I'm trying to store all this data into one array <code>cust_data</code> and after that, add new records with a while loop. But I'm using different types of data and don't have any idea on how to make this. Could somebody explain or give link to website with explanation how to make this.</p>\n\n<pre><code>int add_new_customer() {\n    char name[50];\n    char last_name[50];\n    int phone_number;\n    char address[50];\n    printf(\"Enter name: \");\n    scanf(\"%s\", name);\n    printf(\"Enter last name: \");\n    scanf(\"%s\", last_name);\n    printf(\"Enter number: \");\n    scanf(\"%d\", phone_number);\n    printf(\"Enter address: \");\n    scanf(\"%s\", address);\n    char cust_data[100][256];\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1496843786, "post_id": 44414600, "comment_id": 75828260, "body": "Your <code>while</code> loop can easily go out of bounds."}, {"owner": {"reputation": 86, "user_id": 6044264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2d52296c121703ff0ec78ea27c0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Fighter", "link": "https://stackoverflow.com/users/6044264/phil-fighter"}, "edited": false, "score": 1, "creation_date": 1496843989, "post_id": 44414600, "comment_id": 75828431, "body": "put the <code>if</code>condition into the <code>while</code> loop. Otherwise your while loop runs into infinity after the last space character and into the seg fault."}, {"owner": {"reputation": 3, "user_id": 8125581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o0CB.png?s=128&g=1", "display_name": "Nomi", "link": "https://stackoverflow.com/users/8125581/nomi"}, "edited": false, "score": 0, "creation_date": 1496853269, "post_id": 44414600, "comment_id": 75835246, "body": "Thank you everyone! I solved it with the help of all of you!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1497201703, "post_id": 44414600, "comment_id": 75967242, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8125581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o0CB.png?s=128&g=1", "display_name": "Nomi", "link": "https://stackoverflow.com/users/8125581/nomi"}, "edited": false, "score": 0, "creation_date": 1496853254, "post_id": 44414908, "comment_id": 75835238, "body": "WOW! I did know about the string terminator (\\0) not being equivalent to space but rather just to itself, yet somehow I just forgot it when writing!  It amazes me how such a detail was left behind by me! (Maybe, it&#39;s just because I&#39;m a newb)   Well, Thank you all! You helped me a lot!"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 2, "last_activity_date": 1496844237, "creation_date": 1496844237, "answer_id": 44414908, "question_id": 44414600, "link": "https://stackoverflow.com/questions/44414600/segmentation-fault-when-non-capitalized-input-is-given-due-to-toupper-used-in-a/44414908#44414908", "title": "Segmentation fault when non-capitalized input is given due to toupper used in a condition which inturn is used inside a for loop [C]", "body": "<p>Your <code>while</code>-loop that shall set the pointer to the next blank will run out of bounds every time when a space is not the last character in the string:</p>\n\n<pre><code>    while(selectedchar != ' ')  \n    {\n        i++;\n        selectedchar=full_name[i];\n    }\n</code></pre>\n\n<p>Suppose a string like <code>\"Damien Chazelle\"</code>, and suppose that <code>i</code> points to character <code>C</code>: Then, as the string does not contain any more space from this position onwards, <code>i</code> will run out of bounds of the string. Note that string termination character <code>'\\0'</code> is not equal <code>' '</code>, so the loop will step over.</p>\n\n<p>Without interpreting the rest of your code to much, write</p>\n\n<pre><code>while(i &lt; name_length &amp;&amp; selectedchar != ' ')\n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 3, "user_id": 8125581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o0CB.png?s=128&g=1", "display_name": "Nomi", "link": "https://stackoverflow.com/users/8125581/nomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 44414908, "answer_count": 1, "score": -1, "last_activity_date": 1497201667, "creation_date": 1496843458, "last_edit_date": 1497201667, "question_id": 44414600, "link": "https://stackoverflow.com/questions/44414600/segmentation-fault-when-non-capitalized-input-is-given-due-to-toupper-used-in-a", "title": "Segmentation fault when non-capitalized input is given due to toupper used in a condition which inturn is used inside a for loop [C]", "body": "<p>I'm trying to write a program for the course CS50, where I need to get the initial of full names of people (and make sure it's all capitalized).</p>\n\n<p>Therefore, I ended up writing this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(void)\n{\n    //Asks user for input and checks for it's length\n    printf(\"What's your name?\\n\");\n    string full_name = get_string();\n    int name_length = strlen(full_name);\n    //Program to select the intitials of each word\n    for(int i=0; i&lt;name_length; i++)\n    {\n        char selectedchar = full_name[i]; //determines the currently selected character from the string on the basis of how many times the loop has run\n        if(selectedchar != ' ')          //Makes the program ignore any spaces before the name\n        {\n            if(selectedchar&gt;='A' &amp;&amp; selectedchar&lt;='z')\n            {\n                printf(\"%c\", toupper(full_name[i]));\n            }    \n            else\n            {\n                printf(\"ERROR: INVALID INITIALS. (Check the characters used.)\");\n                return 1;\n            }\n        }\n\n        //To skip printing of non-initials\n        while(selectedchar != ' ')  \n        {\n            i++;\n            selectedchar=full_name[i];\n        }\n\n        if(i&gt;=name_length)       //print a linebreak on the end of each run\n        {    \n            printf(\"\\n\");\n            return 0;\n        }\n    }\n}\n</code></pre>\n\n<p>Now, whenver I input something, I get a segment fault. E:</p>\n\n<p><strong>Input</strong> Damien Chazelle <strong>Result:</strong> DCSegmentation fault (and line break)</p>\n\n<p><strong>Input</strong> Dam!en Chazelle <strong>Result:</strong> DCSegmentation fault (and line break)</p>\n\n<p><strong>Input</strong> Damien          <strong>Result:</strong> DSegmentation fault (and line break)</p>\n\n<p><strong>Input</strong> !Damien         <strong>Result:</strong> Segmentation fault  (and line break)</p>\n\n<p>Now, I am a beginner! I have absolutely no idea of what's causing the problem or how to properly write this question. (Please pardon me for that!)</p>\n"}, {"tags": ["c", "sockets", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1496843561, "post_id": 44414462, "comment_id": 75828071, "body": "Not necessarily related, but you don&#39;t need to allocate a new buffer for every read,. You do need to check <code>nr</code> before you check for <code>io.EOF</code>. Also setting <code>SO_SNDBUF</code> on the Go connection isn&#39;t going to effect the receive buffer. Note that getting the fd from the Go connection dup&#39;ed the file descriptor and put in into blocking mode."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1496843563, "post_id": 44414462, "comment_id": 75828074, "body": "You need to drop the <code>goto</code> statements or improve the logic.  When you get <code>EAGAIN</code> your code will rapidly spin through three of them.  You also never reset <code>poll_count</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1496843640, "post_id": 44414462, "comment_id": 75828133, "body": "And <code>write()</code> returns <code>ssize_t</code>, <b>not</b> <code>int</code>."}, {"owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496844027, "post_id": 44414462, "comment_id": 75828450, "body": "@JimB the client does not close the socket after sending the data. Therefore, I&#39;m sending an initial count first and then sending the data from the client to the server. So when I allocate a huge []byte, then the <code>conn.Read</code> blocks, till EOF is received and EOF won&#39;t be received, as the socket won&#39;t be closed. Is other thoughts on this? Regarding <code>SO_SNDBUF</code>, I removed it now."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1496844051, "post_id": 44414462, "comment_id": 75828466, "body": "in &#39;C client writing&#39; this statement: <code>buffer += result;</code> should NOT be there.  It causes blocks of data to be skipped during this statement: <code>if ((result = write(fd, &amp;buffer[written], to_write - written)) &lt; 0) {</code>"}, {"owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1496844121, "post_id": 44414462, "comment_id": 75828522, "body": "@AndrewHenle I have set the poll timeout to -1, so that I really wait in the poll till the socket becomes available. But my original code was, as you have said, to have timeout as 0 and it did spin rapidly between these three and was thrown out. The <code>poll_count</code> is reset above the while loop, that is missing from what I pasted here."}, {"owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496844229, "post_id": 44414462, "comment_id": 75828621, "body": "@user3629249 Awesome. That was the problem... ah!! I first added it at the end and then I forgot and added it again at the top. Thanks buddy!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496844251, "post_id": 44414462, "comment_id": 75828643, "body": "@JAamish: you re-allocate <code>tmp</code> on every loop - you don&#39;t need to do that. You could allocate it once, or just read directly into <code>buf</code>. I&#39;m just commenting on the correctness, since you <i>must</i> check <code>nr</code> before you check the error; that&#39;s simply how using an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> is documented."}, {"owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496844292, "post_id": 44414462, "comment_id": 75828683, "body": "@JimB I&#39;m must check nr for &gt; 0, you mean"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496844327, "post_id": 44414462, "comment_id": 75828724, "body": "@JAamish: yes, that&#39;s correct."}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 8092543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOOdr.png?s=128&g=1", "display_name": "sebito91", "link": "https://stackoverflow.com/users/8092543/sebito91"}, "is_accepted": false, "score": 0, "last_activity_date": 1496896960, "last_edit_date": 1496896960, "creation_date": 1496896130, "answer_id": 44426655, "question_id": 44414462, "link": "https://stackoverflow.com/questions/44414462/o-nonblock-sock-stream-limited-to-8192/44426655#44426655", "title": "O_NONBLOCK SOCK_STREAM limited to 8192", "body": "<p>What I would do is read the data straight into a <code>bytes.Buffer</code> similar to the answer listed here:</p>\n\n<p><a href=\"https://stackoverflow.com/a/24343240/8092543\">https://stackoverflow.com/a/24343240/8092543</a></p>\n\n<p><a href=\"https://golang.org/pkg/io/#Copy\" rel=\"nofollow noreferrer\">https://golang.org/pkg/io/#Copy</a></p>\n\n<p>The beauty of the <code>io.Copy</code> is that it consumes a Writer + Reader interface, which are satisfied nicely but your <code>bytes.Buffer</code> (io.Writer) and your <code>conn.Read</code> (io.Reader). Replace your entire block with something like...</p>\n\n<pre><code>var buf bytes.Buffer\ncount, err := io.Copy(buf, conn)\nif err != nil { \n    return nil, fmt.Errorf(\"error during conn read: %v\", err)\n}\n\nreturn buf.Bytes(), nil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 0, "last_activity_date": 1496898984, "creation_date": 1496898984, "answer_id": 44427170, "question_id": 44414462, "link": "https://stackoverflow.com/questions/44414462/o-nonblock-sock-stream-limited-to-8192/44427170#44427170", "title": "O_NONBLOCK SOCK_STREAM limited to 8192", "body": "<p>This is normal behaviour. A non-blocking write can only transfer as much data as will fit into the socket send buffer. If you get a short count, you need to either loop or select on writability and retry. A blocking write on the other hand always transfers the entire data.</p>\n\n<p>Setting the send buffer size may not do anything on Unix domain sockets.</p>\n"}], "owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496898984, "creation_date": 1496843102, "last_edit_date": 1496898867, "question_id": 44414462, "link": "https://stackoverflow.com/questions/44414462/o-nonblock-sock-stream-limited-to-8192", "title": "O_NONBLOCK SOCK_STREAM limited to 8192", "body": "<p>I'm writing from c program into a <code>SOCK_STREAM</code> of a Unix Domain Socket that is being listened from a go program, using <code>net.Listen(\"unix\", sockname)</code>. When I set the socket to <code>O_NONBLOCK</code> using <code>fcntl()</code>, I see that the C program writes only 8192 bytes in the first write. After it fails, I monitor and write back the remaining data, but the read data on my server is not valid in this case.</p>\n\n<p>When I do not use <code>O_NONBLOCK</code>, then the whole of 8762 bytes are written in a single write and everything works as expected.</p>\n\n<p><strong>C Client Socket Connection</strong></p>\n\n<pre><code>    if ( (fd = socket(AF_UNIX, SOCK_STREAM, 0)) == -1) {\n        return;\n    }\n   int flags = fcntl(fd, F_GETFL, 0);\n   flags = flags|O_NONBLOCK;\n   fcntl(fd, F_SETFL, flags);\n   ...\n    if (connect(fd, (struct sockaddr*)&amp;addr, sizeof(addr)) == -1) {\n        return;\n    }\n</code></pre>\n\n<p><strong>C Client Writing</strong></p>\n\n<pre><code>        while (written &lt; to_write) {\n            int result;\n            if ((result = write(fd, &amp;buffer[written], to_write - written)) &lt; 0) {\n                if (errno == EINTR) {\n                    continue;\n                }\n                if (errno == EAGAIN) {\n                    struct pollfd pfd = { .fd = fd, .events = POLLOUT };\n                    poll_count++;\n                    if (poll_count &gt; 3) {\n                        goto end;\n                    }\n                    if ((poll(&amp;pfd, 1, -1) &lt;= 0) &amp;&amp; (errno != EAGAIN)) {\n                        goto end;\n                    }\n                    continue;\n                }\nend:\n                return written ? written : result;\n            }\n            written += result;\n            buffer += result;\n        }\n</code></pre>\n\n<p><strong>Go Server Reading</strong></p>\n\n<pre><code>buf := make([]byte, 0, count)\nvar tmpsize int32\nfor {\n    if count &lt;= 0 {\n        break\n    }\n\n    if count &gt; 100 {\n        tmpsize = 100\n    } else {\n        tmpsize = count\n    }\n\n    tmp := make([]byte, tmpsize)\n    nr, err = conn.Read(tmp)\n    if err != nil {\n        return\n    }\n\n    buf = append(buf, tmp[:nr]...)\n    count = count - int32(nr)\n}\n</code></pre>\n\n<p>What am I missing here. I'm running it on OSX. I also tried setting the <code>SO_SNDBUF</code> in the Go Server to 10000, but it does not help</p>\n\n<pre><code>err = syscall.SetsockoptInt(int(fd.Fd()), syscall.SOL_SOCKET, syscall.SO_SNDBUF, 10000)\nif err != nil {\n    return\n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "stm32", "i2c"], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 6, "last_activity_date": 1496931024, "last_edit_date": 1496931024, "creation_date": 1496843160, "answer_id": 44414479, "question_id": 44414085, "link": "https://stackoverflow.com/questions/44414085/stm32f4-i2c-without-library/44414479#44414479", "title": "STM32F4 I2C without library", "body": "<pre><code>I2C1-&gt; CR2 |= ~(I2C_CR1_SMBUS); // I2C mode\n</code></pre>\n\n<p>This line does something different that you think. If the idea was to clear that bit it shuold be</p>\n\n<pre><code>I2C1-&gt; CR2 &amp;= ~(I2C_CR1_SMBUS); // I2C mode\n</code></pre>\n\n<p>Otherwise you set all the bits in the CR2 register except I2C_CR1_SMBUS which is left unchanged.</p>\n\n<p>Another problem is that you try to set CR2 using CR1 bit definitions.</p>\n\n<p>Same is with the enable bit - wrong register.</p>\n\n<p>I2C should be reset before first use on many STM32 micros. </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6228173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af35508ee67b92f130656724e04bb76?s=128&d=identicon&r=PG&f=1", "display_name": "lalnashi", "link": "https://stackoverflow.com/users/6228173/lalnashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1496926936, "last_edit_date": 1496926936, "creation_date": 1496908698, "answer_id": 44429928, "question_id": 44414085, "link": "https://stackoverflow.com/questions/44414085/stm32f4-i2c-without-library/44429928#44429928", "title": "STM32F4 I2C without library", "body": "<p>Hi I am having the same problem with setting an STM32F4 DISCO board to go</p>\n\n<p>I noticed that you are setting </p>\n\n<pre><code>I2C1-&gt; CR2 = 8;  // set peripheral clock to 8mhz\nI2C1-&gt; CR2 = 40; // 100khz i2c clock\n</code></pre>\n\n<p>you are writing twice to the same register. \nFor the I2C clock you need to set <code>I2C1-&gt;CCR</code> to the calculated value</p>\n\n<p>I hope this helps</p>\n"}], "owner": {"reputation": 33, "user_id": 7182643, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209863324053128/picture?type=large", "display_name": "Ayberk Karaak\u0131n", "link": "https://stackoverflow.com/users/7182643/ayberk-karaak%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1496931024, "creation_date": 1496842129, "last_edit_date": 1496926899, "question_id": 44414085, "link": "https://stackoverflow.com/questions/44414085/stm32f4-i2c-without-library", "title": "STM32F4 I2C without library", "body": "<p>I have to wire a code for STM32F4 discovery and pcf8574 with I2C.</p>\n\n<p>I can't use any library function. I try something I didn't do it. I did write after init code. </p>\n\n<p>My init code</p>\n\n<pre><code>RCC-&gt;APB1ENR|=RCC_APB1ENR_I2C1EN ; // enable APB1 peripheral clock for I2C1\nRCC-&gt;AHB1ENR|=RCC_AHB1ENR_GPIOBEN; // enable clock for SCL and SDA pins\n\n//SCL on PB6 and SDA on PB7 \nGPIOB-&gt;MODER|=GPIO_MODER_MODER6; // set pin to alternate function\nGPIOB-&gt;MODER|=GPIO_MODER_MODER7; // set pin to alternate function\n\nGPIOB-&gt;OSPEEDR |=GPIO_OSPEEDER_OSPEEDR6; //set GPIO speed\nGPIOB-&gt;OSPEEDR |=GPIO_OSPEEDER_OSPEEDR7; //set GPIO speed\n\nGPIOB-&gt; OTYPER |= GPIO_OTYPER_OT_6; // set output to open drain --&gt; the line has to be only pulled low, not driven high\nGPIOB-&gt; OTYPER |= GPIO_OTYPER_OT_7; // set output to open drain --&gt; the line has to be only pulled low, not driven high\n\nGPIOB-&gt; PUPDR  |=GPIO_PUPDR_PUPDR6_0; // enable pull up resistors\nGPIOB-&gt; PUPDR  |=GPIO_PUPDR_PUPDR7_0; // enable pull up resistors\n\nGPIOB-&gt; AFR[1] = 0x44000000; // Connect I2C1 pins to AF (af4)\n\n// configure I2C1 \n\nI2C1-&gt; CR2 = 8;  // set peripheral clock to 8mhz\nI2C1-&gt; CR2 = 40; // 100khz i2c clock\nI2C1-&gt; CR2 |= ~(I2C_CR1_SMBUS); // I2C mode\nI2C1-&gt; OAR2 = 0x00; // address not important\nI2C1-&gt; CR2 |= 1;    // i2c enable;\n</code></pre>\n"}, {"tags": ["c", "macos", "driver", "kernel-extension", "xnu"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7256215"}, "edited": false, "score": 0, "creation_date": 1497010436, "post_id": 44416267, "comment_id": 75911274, "body": "Hi and thanks. just one more thing. following your response, I did some more research on that matter and found out that VNOP_READ calls <code>hfs_vop_read</code> which is part of HFS+ driver, which itself calls the cluster method of <code>cluster_read</code> which actually does all the low-level read (from cache or from disk) .. so far so good, however, I couldn&#39;t find the synonym in <code>mmap</code> which calls VNOP_MMAP that calls <code>hfs_vnop_mmap</code>, but in this function, which return ENOTSUP &quot;because we want the cluster layer to actually do all the real work.&quot; (quoted from their comment)..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7256215"}, "edited": false, "score": 0, "creation_date": 1497010549, "post_id": 44416267, "comment_id": 75911365, "body": "this leaves me with the question of who&#39;s in charge of reading the file in mmap case. of course it&#39;s the cluster layer, but who calls <code>cluster_read</code> or something similar from mmap call trace ?"}], "tags": [], "owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "is_accepted": true, "score": 2, "last_activity_date": 1496847638, "creation_date": 1496847638, "answer_id": 44416267, "question_id": 44413909, "link": "https://stackoverflow.com/questions/44413909/vnode-and-file-descriptor-in-xnu-where-does-the-file-operation-vector-is-stored/44416267#44416267", "title": "vnode and file descriptor in xnu, where does the file operation vector is stored", "body": "<blockquote>\n  <p>[\u2026] in which cases the\n  operation works through the file_descriptor vector (fg_ops) and which\n  cases the operation works through the vnode vector (vp->v_op).</p>\n</blockquote>\n\n<p>I'm going to start by answering this second part of the question first: if you trace through your call stack further, and look inside the <code>vn_read</code> function, you'll find that it contains this line:</p>\n\n<pre><code>    error = VNOP_READ(vp, uio, ioflag, ctx);\n</code></pre>\n\n<p>The <code>VNOP_READ</code> function (kpi_vfs.c) in turn has this:</p>\n\n<pre><code>_err = (*vp-&gt;v_op[vnop_read_desc.vdesc_offset])(&amp;a);\n</code></pre>\n\n<p>So the answer to your question is that for your typical file, <strong>both</strong> tables are used for dispatching operations.</p>\n\n<p>With that out of the way,</p>\n\n<blockquote>\n  <p>My question is why does this duality needed [\u2026]</p>\n</blockquote>\n\n<p>Not everything to which a process can hold a file descriptor is also represented in the file system. For example, pipes don't necessarily have to be named. A vnode doesn't make any sense in that context. So in sys_pipe.c, you'll see a different fileops table:</p>\n\n<pre><code>static const struct fileops pipeops = {\n    .fo_type = DTYPE_PIPE,\n    .fo_read = pipe_read,\n    .fo_write = pipe_write,\n    .fo_ioctl = pipe_ioctl,\n    .fo_select = pipe_select,\n    .fo_close = pipe_close,\n    .fo_kqfilter = pipe_kqfilter,\n    .fo_drain = pipe_drain,\n};\n</code></pre>\n\n<p>Similar deal for sockets.</p>\n\n<p>File descriptors track the state of a process's view of a file or object that allows file-like operations. Things like position in the file, etc. - different processes can have the same file open, and they must each have their own read/write position - so vnode:fileglob is a 1:many relationship.</p>\n\n<p>Meanwhile, using vnode objects to track things other than objects within a file system doesn't make any sense either. Additionally, the v_op table is file system specific, whereas vn_read/VNOP_READ contain code that applies to any file that's represented in a file system.</p>\n\n<p>So in summary they're really just different layers in the I/O stack.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7256215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 1, "accepted_answer_id": 44416267, "answer_count": 1, "score": 2, "last_activity_date": 1496847638, "creation_date": 1496841712, "last_edit_date": 1496847089, "question_id": 44413909, "link": "https://stackoverflow.com/questions/44413909/vnode-and-file-descriptor-in-xnu-where-does-the-file-operation-vector-is-stored", "title": "vnode and file descriptor in xnu, where does the file operation vector is stored", "body": "<p>In xnu we have the <code>vnode_t</code> entity which represent the file globally.</p>\n\n<p>Each process can access the file (assuming it has right permissions) by setting new file descriptor and set the vnode under fg_data </p>\n\n<pre><code>fp-&gt;f_fglob-&gt;fg_data = vp;\n</code></pre>\n\n<p>the vnode contain a list of basic actions for all relevant operations and is set in according to the file's FS. i.e. HFS+ driver implement such vector and set its vnode accordingly. </p>\n\n<pre><code>int     (**v_op)(void *);       /* vnode operations vector */\n</code></pre>\n\n<p>this is a vector for function pointers for all actions that may operate on the vnode. </p>\n\n<p>In addition, we have the fileops struct that is part of the file descriptor (fg_global) which describe a minimal subset of these functions:</p>\n\n<p>Here is a typical definition : </p>\n\n<pre><code>const struct fileops vnops = {\n .fo_type = DTYPE_VNODE,\n .fo_read = vn_read,\n .fo_write = vn_write,\n .fo_ioctl = vn_ioctl,\n .fo_select = vn_select,\n .fo_close = vn_closefile,\n .fo_kqfilter = vn_kqfilt_add,\n .fo_drain = NULL,\n};\n</code></pre>\n\n<p>and we set it here : </p>\n\n<pre><code>fp-&gt;f_fglob-&gt;fg_ops = &amp;vnops;\n</code></pre>\n\n<p>I saw that when reading regular file under local filesystem (HFS+), it works through the file_descriptor and not the vnode ...  </p>\n\n<pre><code> * frame #0: 0xffffff801313c67c kernel`vn_read(fp=0xffffff801f004d98, uio=0xffffff807240be70, flags=0, ctx=0xffffff807240bf10) at vfs_vnops.c:978 [opt]\nframe #1: 0xffffff801339cc1a kernel`dofileread [inlined] fo_read(fp=0xffffff801f004d98, uio=0xffffff807240be70, flags=0, ctx=0xffffff807240bf10) at kern_descrip.c:5832 [opt]\nframe #2: 0xffffff801339cbff kernel`dofileread(ctx=0xffffff807240bf10, fp=0xffffff801f004d98, bufp=140222138463456, nbyte=282, offset=&lt;unavailable&gt;, flags=&lt;unavailable&gt;, retval=&lt;unavailable&gt;) at sys_generic.c:365 [opt]\nframe #3: 0xffffff801339c983 kernel`read_nocancel(p=0xffffff801a597658, uap=0xffffff801a553cc0, retval=&lt;unavailable&gt;) at sys_generic.c:215 [opt]\nframe #4: 0xffffff8013425695 kernel`unix_syscall64(state=&lt;unavailable&gt;) at systemcalls.c:376 [opt]\nframe #5: 0xffffff8012e9dd46 kernel`hndl_unix_scall64 + 22\n</code></pre>\n\n<p>My question is why does this duality needed, and in which cases the operation works through the file_descriptor vector (fg_ops) and which cases the operation works through the vnode vector (vp->v_op).</p>\n\n<p>thanks</p>\n"}, {"tags": ["c", "makefile", "texas-instruments", "python-embedding"], "answers": [{"comments": [{"owner": {"reputation": 779, "user_id": 5765675, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/449794481879116/picture?type=large", "display_name": "Meet Taraviya", "link": "https://stackoverflow.com/users/5765675/meet-taraviya"}, "edited": false, "score": 0, "creation_date": 1496843700, "post_id": 44414360, "comment_id": 75828186, "body": "I figured out the same in the meanwhile! How to get a pyconfig.h for TI boards? Is there a work around that does not require it? How to write one if it is must?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 779, "user_id": 5765675, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/449794481879116/picture?type=large", "display_name": "Meet Taraviya", "link": "https://stackoverflow.com/users/5765675/meet-taraviya"}, "edited": false, "score": 0, "creation_date": 1496846810, "post_id": 44414360, "comment_id": 75830808, "body": "Sorry but I don&#39;t have an answer - I know what the problem is, but not the detailed solution"}], "tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 1, "last_activity_date": 1496842841, "creation_date": 1496842841, "answer_id": 44414360, "question_id": 44413249, "link": "https://stackoverflow.com/questions/44413249/embedding-python-interpreter-in-the-tm4c1294xl/44414360#44414360", "title": "Embedding python interpreter in the TM4c1294XL", "body": "<p><a href=\"https://www.freelists.org/post/rumpkernel-users/Help-in-understanding-the-underlying-issue-here,3\" rel=\"nofollow noreferrer\">From the linked problem</a></p>\n\n<p>The multiarch error message is a bit misleading. It's not failing because there's a multiarch problem, it's failing because there's a multi-OS problem. /usr/include/python*/pyconfig.h is trying to figure out where to find the real pyconfig.h from, and since it doesn't know, it's bailing out. </p>\n\n<p>You essentially need a pyconfig.h generated for the target environment. I don't know what produced pyconfig.h, perhaps building cython from source? pyconfig.h looks like something generated by gnu autoconf, so there should not be any big problems in generating it.</p>\n"}], "owner": {"reputation": 779, "user_id": 5765675, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/449794481879116/picture?type=large", "display_name": "Meet Taraviya", "link": "https://stackoverflow.com/users/5765675/meet-taraviya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505567578, "creation_date": 1496840029, "last_edit_date": 1505567578, "question_id": 44413249, "link": "https://stackoverflow.com/questions/44413249/embedding-python-interpreter-in-the-tm4c1294xl", "title": "Embedding python interpreter in the TM4c1294XL", "body": "<p>I have a python file that I want to run on the board. Hence I want to embed the python interpreter (written in C) in the board. I managed to write separate C project that runs the Python file. It compiles and runs as I want to. Here's the makefile for same:-</p>\n\n<pre><code>CC=gcc\nCFLAGS=-I python3.5 -I config -I . -c -w\nLDFLAGS= -lpython3.5m -lpthread -ldl -lutil -lm -Xlinker -export-dynamic -Wl,-O1 -Wl,-Bsymbolic-functions\n\nall: classifier trainer test link\n\ntest:\n    $(CC) $(CFLAGS) test.c\n\ntrainer: Trainer.c\n    $(CC) $(CFLAGS) Trainer.c\n    $(CC) Trainer.o $(LDFLAGS) -o Trainer\n\n.ONESHELL:\nclassifier: Classifier.c \n    $(CC) $(CFLAGS) Classifier.c\n    # $(CC) Classifier.o $(LLFLAGS) -o Classifier\n\nlink:\n    $(CC) test.o Classifier.o $(LDFLAGS) -o test\n\nclean:\n    rm -f Trainer.o Trainer Classifier.o Classifier\n</code></pre>\n\n<p><a href=\"http://dpaste.com/3BCY2RE\" rel=\"nofollow noreferrer\">http://dpaste.com/3BCY2RE</a> is my entire directory of project \"hello\" (It is not the one from the examples). </p>\n\n<p>I included \"Classifier.h\" in my \"hello.c\" and I am getting the following errors: <a href=\"http://dpaste.com/3KKCF84\" rel=\"nofollow noreferrer\">http://dpaste.com/3KKCF84</a></p>\n\n<p>Compiler include options (No preincludes):</p>\n\n<pre><code>\"${CG_TOOL_ROOT}/include\"\n\"${workspace_loc:/${ProjName}/TerrainPredict}\"\n\"${workspace_loc:/${ProjName}/TerrainPredict/config}\"\n\"${workspace_loc:/${ProjName}/TerrainPredict/python3.5}\"\n\"${SW_ROOT}/examples/boards/ek-tm4c1294xl\"\n\"${SW_ROOT}\"\n</code></pre>\n\n<p>Linker file search paths:</p>\n\n<pre><code>\"libc.a\"\n\"${workspace_loc:/${ProjName}/TerrainPredict/libterrainclf.a}\"\n\"${SW_ROOT}/driverlib/ccs/Debug/driverlib.lib\"\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>\"${CG_TOOL_ROOT}/lib\"\n\"${workspace_loc:/hello/TerrainPredict/libterrainclf.a}\"\n\"${CG_TOOL_ROOT}/include\"\n</code></pre>\n\n<p>Am I wrong with some of my configurations? Or is this some problem with python interpreter? Any help is greatly appreciated</p>\n\n<p><strong>EDIT</strong>:-\nAs @KevinDTimm suggested, the problem is that <strong>there is no pyconfig.h for my environment</strong>. This file is required by python to define important variables like source of system clock. I tried removing safety checks in existing <code>pyconfig.h</code>. The first error I am getting is in <code>pytime.h</code> as :</p>\n\n<pre><code>\"_PyTime_t need signed 64-bit integer type\"\n</code></pre>\n\n<p>Which was further because of the following code block:</p>\n\n<pre><code>#ifdef PY_INT64_T\n/* _PyTime_t: Python timestamp with subsecond precision. It can be used to\n   store a duration, and so indirectly a date (related to another date, like\n   UNIX epoch). */\ntypedef PY_INT64_T _PyTime_t;\n#define _PyTime_MIN PY_LLONG_MIN\n#define _PyTime_MAX PY_LLONG_MAX\n#else\n#  error \"_PyTime_t need signed 64-bit integer type\"\n#endif\n</code></pre>\n\n<p>It appears to me that it needs a variable that stores time. I need help in assigning that variable.</p>\n"}, {"tags": ["c", "arrays", "recursion"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496839521, "post_id": 44412880, "comment_id": 75824901, "body": "First of all, what is the initial value of <code>n</code>? Is it the max index or the number of elements in the array? You <i>have</i> space allocated for the array? And use a debugger to step through the code line by line while monitoring the variables and their values and the results of all operations."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496839641, "post_id": 44412880, "comment_id": 75824978, "body": "Why are you using <code>scanf</code>to read an array ? <code>printf</code> would do the trick without being the most complex fonction usable in C programming. Or did I misunderstood what you mean by &quot;reading&quot; ?"}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496839771, "post_id": 44412880, "comment_id": 75825087, "body": "The iterative function works for any <code>n</code> provided as input, and stores the inputs in the related array pointed by <code>*a</code>, which is of adequate size. In the main it is declared as big as <code>n</code>: es. <code>int a1[DIM]</code>; <code>read_array(a1, DIM)</code>;"}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496839864, "post_id": 44412880, "comment_id": 75825161, "body": "@Badda my intention is to read an input from standard input and store it in an array."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496840373, "post_id": 44412880, "comment_id": 75825566, "body": "&quot;I would like to read an array recursively&quot;. Why? There is absolutely no benefit from this, it will only slow down your program, eat memory and open up a great potential for bugs."}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496840478, "post_id": 44412880, "comment_id": 75825667, "body": "@Lundin, didactic purposes. I do not really appreciate recursion, but our professors totally do. The reasons to me remain obscure."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496840689, "post_id": 44412880, "comment_id": 75825849, "body": "@Worice The reason is simple: you eliminate side-effects. Take the <code>scanf()</code> out of the code of my answer and it is free of side effects, still iterates over the array. Recursion is an elegant principle for writing <i>pure</i> functions, C just isn&#39;t the language that&#39;s best suited for this programming style."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1496840697, "post_id": 44412880, "comment_id": 75825859, "body": "Add <code>printf(&quot;calling read_array with n=%d, i=%d reading into index %d\\n&quot;, n, i, n-1-i);</code> to see what&#39;s happening."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 7, "creation_date": 1496840723, "post_id": 44412880, "comment_id": 75825879, "body": "@Worice The reason for teaching recursion to students, is that when the students later become teachers, they can teach recursion to students."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1496840838, "post_id": 44412880, "comment_id": 75825962, "body": "Jokes aside, recursion is immensely overrated and does not have much of a place in real-world programming. It is mostly a failed attempt to translate math and algorithm theory into something practical. The only real-world use is extremely narrow, for example when implementing a binary search tree and you want to optimize the memory occupied by the tree, at expensive of execution speed and peak stack usage. 99% of people who think they found a use for recursion are wrong. Mostly it is a big waste of time: execution time, student time, code reader&#39;s time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496841106, "post_id": 44412880, "comment_id": 75826183, "body": "@Lundin there are often good reasons to avoid <i>mutable state</i> and recursion can be a way to achieve this. But there are often better ways as well."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1496841149, "post_id": 44412880, "comment_id": 75826222, "body": "@Worice  Show a minimal compiled program that demonstrates the problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496841791, "post_id": 44412880, "comment_id": 75826755, "body": "@Lundin for example, you wouldn&#39;t use recursion just to replace an iteration with a mutable counter. Instead, you&#39;d have a <a href=\"https://en.wikipedia.org/wiki/Map_(higher-order_function)\" rel=\"nofollow noreferrer\"><i>map</i></a>-like function that takes another function to transform each element of a sequence. Still it makes sense for a student to understand recursion."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496841872, "post_id": 44412880, "comment_id": 75826826, "body": "@Lundin  &quot;in real-world programming&quot; =&gt; &quot;in Turing Machine program&quot;. Please don&#39;t insult Lambda Calculus."}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496842347, "post_id": 44412880, "comment_id": 75827166, "body": "I am learning a lot from your discussion, guys. I would like to thank you all for your participation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496842684, "post_id": 44412880, "comment_id": 75827428, "body": "@Stargateur Recursion, in real-world computing, revolves around storing the return address to the previously executed &quot;node&quot; on the stack. If the algorithm or data container is able to store the return address through other means, for example by adding a &quot;previous&quot; pointer to every node of a BST, recursive functions (the programming language definition of such a function) aren&#39;t necessary."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496842762, "post_id": 44412880, "comment_id": 75827488, "body": "The problem arises when the algorithm theory people enter the real world, yelling &quot;recursion&quot; - what they mean then is an abstract function, able to repeatedly calling itself until some condition has been sated. This does not necessarily have to be implemented through a recursive function, as defined in programming languages. Failing to understand this difference between the abstract concept of recursion and the programming concept of recursive functions as a language feature, results in crap programs."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1496843147, "post_id": 44412880, "comment_id": 75827755, "body": "@Lundin Sorry, but this is your opinion and SO is not here to debate about that. Recursion is a concept, whatever you want, it can be use for good purpose or bad. But you can&#39;t say that this concept is bad, this is your opinion."}], "answers": [{"tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": false, "score": 1, "last_activity_date": 1496839651, "creation_date": 1496839651, "answer_id": 44413094, "question_id": 44412880, "link": "https://stackoverflow.com/questions/44412880/read-an-array-recursively/44413094#44413094", "title": "Read an array recursively", "body": "<p>Example:</p>\n\n<pre><code>int read_array_aux(int *i, int *n) {\n  if (i == n) {\n    return 0;\n  }\n  if (scanf(\"%d\", i) != 1) {\n    return -1;\n  }\n  return read_array_aux(i + 1, n);\n}\n\nint read_array_aux2(int *a, size_t i, size_t n) {\n  if (i == n) {\n    return 0;\n  }\n  if (scanf(\"%d\", a + i) != 1) {\n    return -1;\n  }\n  return read_array_aux2(a, i + 1, n);\n}\n\nint read_array(int *a, size_t n) {\n  return read_array_aux(a, a + n);\n  // return read_array_aux2(a, 0, n);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496840889, "post_id": 44413095, "comment_id": 75825997, "body": "Thanks Felix for such an elegant solution and for the details you provided me. I do not really appreciate recursion, but our professors totally do. The reasons to me remain obscure. Anyway, <code>int i</code> should assume the same value of <code>0</code>, right? Furthermore, is it possible that your code shows a <code>}</code> more than necessary?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496840994, "post_id": 44413095, "comment_id": 75826087, "body": "copy&amp;paste bummer from eliminating your <code>else</code>, I&#39;ll reformat this. And yes, knowing about recursion is important, but I&#39;d still say don&#39;t do it in C."}, {"owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "edited": false, "score": 0, "creation_date": 1496843439, "post_id": 44413095, "comment_id": 75827968, "body": "@FelixPalmen C can optimize some (if not all) cases of tail recursion, jumping to the beginning of the function instead of growing the stack."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "edited": false, "score": 0, "creation_date": 1496844197, "post_id": 44413095, "comment_id": 75828594, "body": "@ArturR.Czechowski that&#39;s nice. I just added a &quot;better&quot; recursion and I guess this would be hard to optimize ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496844395, "post_id": 44413095, "comment_id": 75828791, "body": "@Worice here&#39;s some update for you to see something closer to a pure functional recursion."}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496844870, "post_id": 44413095, "comment_id": 75829201, "body": "I am reading it just now. Thanks Felix, it is helping me having a better comprehension of the recursion! In C programming, it is the most hard concept for me. With F#, just to say, I use it regularly. It work really well."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496845361, "post_id": 44413095, "comment_id": 75829586, "body": "That&#39;s because C really isn&#39;t a functional language. But if a language provides functions and a way to pass a function to another function (like C function pointers), you <i>can</i> do functional programming. Note it&#39;s also a lot easier in C# using <i>lambda expressions</i>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 7, "last_activity_date": 1496844555, "last_edit_date": 1496844555, "creation_date": 1496839658, "answer_id": 44413095, "question_id": 44412880, "link": "https://stackoverflow.com/questions/44412880/read-an-array-recursively/44413095#44413095", "title": "Read an array recursively", "body": "<p>Your calculation of the array index is wrong. This line:</p>\n\n<pre><code>            if(scanf(\"%d\", &amp;a[n - 1 - i]) == 1){\n</code></pre>\n\n<p>assumes the <em>initial</em> value of <code>n</code>, but at the same time, you <em>decrease</em> <code>n</code> with every recursion step. That being said, it shouldn't crash but just repeatedly write the first element of <code>a</code>, because with <code>i = n - 1</code>, <code>n - 1 - i</code> is always zero.</p>\n\n<p>The idiomatic way to write such a recursion would be to recurse on <code>i</code>:</p>\n\n<pre><code>void read_array(int *a, int n, int i)\n{\n    if (i &lt; n)\n    {\n        if(scanf(\"%d\", &amp;a[i]) == 1)\n        {\n            read_array(a, n, i+1);\n        }\n    }\n}\n</code></pre>\n\n<p>and call it with the initial value for <code>i</code>, e.g. <code>read_array(a, 10, 0)</code> for reading a 10-element array.</p>\n\n<p>In practice, recursion in C is to be avoided.<sup>*</sup></p>\n\n<p><sub>* Functional languages can typically optimize recursion, C just uses the call stack with a lot of overhead.</sub></p>\n\n<hr>\n\n<p>In this example, the theoretical purpose of recursion for writing a <em>pure</em> function is somewhat defeated with a function returning <code>void</code>. If this is just about learning the principle, the functions actually should return something. You could for example create a functional \"list builder\":</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// place the side effect in a separate function\nint getValue(void)\n{\n    // could have `scanf()` here:\n    return rand();\n}\n\ntypedef struct List\n{\n    int a[10];\n    size_t length;\n} List;\n\n// non-functional helper to get around limitations of C:\n// (if it could initialize result directly with the new values, it would\n// be functional)\nList listAppend(List list, int val)\n{\n    List result = list;\n    result.a[result.length++] = val;\n    return result;\n}\n\n// recursive function without side effects:\nList buildList(List list, int (*value)())\n{\n    if (list.length &gt;= 10) return list;\n    return buildList(listAppend(list, value()), value);\n}\n\nint main(void)\n{\n    List myList = buildList((List){0}, &amp;getValue);\n\n    for (size_t i = 0; i &lt; myList.length; ++i)\n    {\n        printf(\"myList.a[%zu] is %d\\n\", i, myList.a[i]);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496842230, "post_id": 44413880, "comment_id": 75827075, "body": "Very &quot;Fsharpish&quot; exaplanation! Thanks!"}, {"owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496842762, "post_id": 44413880, "comment_id": 75827489, "body": "Very &quot;Fsharpish&quot; exaplanation! What do you think are the major differences from the suggestions proposed by Felix?"}, {"owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "reply_to_user": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "edited": false, "score": 0, "creation_date": 1496843030, "post_id": 44413880, "comment_id": 75827681, "body": "Felix solution is generally better, as it is easily modifiable for different languages, but it requires passing three parameters instead of two: array, index and size. My proposal is suited for C, as it uses its pointer arithmetic and in result requires to pass only two parameters: remainder of array and size of this remainder of array. Choose whatever suits you better."}], "tags": [], "owner": {"reputation": 1518, "user_id": 2989411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9546f7c525de9829c89ea5801a78af11?s=128&d=identicon&r=PG", "display_name": "ArturFH", "link": "https://stackoverflow.com/users/2989411/arturfh"}, "is_accepted": false, "score": 1, "last_activity_date": 1496842312, "last_edit_date": 1496842312, "creation_date": 1496841627, "answer_id": 44413880, "question_id": 44412880, "link": "https://stackoverflow.com/questions/44412880/read-an-array-recursively/44413880#44413880", "title": "Read an array recursively", "body": "<p>First, condition <code>n&lt;0</code> is wrong. Probably this is the cause of segfault.</p>\n\n<p>Also, why even bother about calculating the index? When processing any kind of list recursively it's worth to grasp the concept of head (first element of list) and tail (everything except head) of the list. So, filling an array recursively would be defined as (in pseudo code):</p>\n\n<pre><code>void read_array() {\n   read_head();\n   read_tail();\n}\n</code></pre>\n\n<p>What is head? It's the first element of current array. What's the tail? The array starting from next element. So, read_tail is equivalent of read_array, but with the beginning moved forward by one element.</p>\n\n<p>And, finally, to gather everything into one place:</p>\n\n<pre><code>void read_array(int *a, int n) {\n   if(n&lt;=0) {\n       return;\n   } else {\n       if(scanf(\"%d\", a) == 1) {\n           read_array(a+1,n-1);\n       }\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 1, "last_activity_date": 1496843116, "last_edit_date": 1496843116, "creation_date": 1496841850, "answer_id": 44413968, "question_id": 44412880, "link": "https://stackoverflow.com/questions/44412880/read-an-array-recursively/44413968#44413968", "title": "Read an array recursively", "body": "<p>As other answers have mentioned, your handling of <code>n</code> is leading to problems. You can return <code>0</code> from the base case of <code>sz == 0</code>, otherwise return the result of the next recursive call, or <code>-1</code> if <code>scanf()</code> fails. At each recursive call, increment <code>a</code> and decrement <code>sz</code>. The value returned in the calling function should be checked for input errors: <code>0</code> on success, <code>-1</code> on failure.</p>\n\n<p>Note that this is a <a href=\"https://en.wikipedia.org/wiki/Tail_recursion\" rel=\"nofollow noreferrer\">tail recursion</a>, which should be optimized by most good compilers.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint read_array(int *a, size_t sz);\n\nint main(void)\n{\n    int arr[5];\n    puts(\"Enter array elements:\");\n    if (read_array(arr, 5) != 0) {\n        fprintf(stderr, \"Input error\\n\");\n    } else {\n        for (size_t i = 0; i &lt; 5; i++) {\n            printf(\"%8d\", arr[i]);\n        }\n        putchar('\\n');\n    }\n\n    return 0;\n}\n\nint read_array(int *a, size_t sz)\n{\n    if (sz == 0 ) {\n        return 0;\n    }\n    if (scanf(\"%d\", a) == 1){\n        return read_array(a + 1, sz - 1);\n    } else {\n        return -1;\n    }\n}\n</code></pre>\n\n<p>Sample interaction:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter array elements:\n1 2 3 4 5\n       1       2       3       4       5\n\nEnter array elements:\n1 2 3 x 5\nInput error\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496842571, "post_id": 44414083, "comment_id": 75827343, "body": "Note: that this version is not tail recursive, <code>1 + read_array( a + 1, n - 1 )</code> here you need to wait the return of the function."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496842648, "post_id": 44414083, "comment_id": 75827402, "body": "@Stargateur Why do you have decided so? It entirely depends on the compiler."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496842930, "post_id": 44414083, "comment_id": 75827608, "body": "No tail recursion has nothing to do with compiler: <a href=\"https://stackoverflow.com/questions/310974/what-is-tail-call-optimization\" title=\"what is tail call optimization\">stackoverflow.com/questions/310974/&hellip;</a>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496843269, "post_id": 44414083, "comment_id": 75827850, "body": "@Stargateur You are wrong. It directly depends on compiler. For example compilers can not support the tail recursion."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496843388, "post_id": 44414083, "comment_id": 75827923, "body": "No your are talking about the optimization, tail recursion is just a fact, this function is tail recursive or not, point. Some compiler could make a non tail recursive function into a tail recursive and after optimize the call. But this is no the point. Your function is not tail recursive, this is not bad, just a fact. This link is better <a href=\"https://stackoverflow.com/questions/33923/what-is-tail-recursion\">stackoverflow.com/questions/33923/what-is-tail-recursion</a>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496843670, "post_id": 44414083, "comment_id": 75828162, "body": "gcc can optimize tail-calls. <a href=\"https://stackoverflow.com/questions/15897452/tail-recursion-in-gcc-g\">See this link</a>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496844131, "post_id": 44414083, "comment_id": 75828531, "body": "@Stargateur The fact that a function is defined a shaving tail recursion does not help the MS compiler to implement the tail recursion.:)"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496844785, "post_id": 44414083, "comment_id": 75829120, "body": "@VladfromMoscow Yes, of course, MS is always here to be annoying. Unless, you are using a language that guaranty tail recursion optimization, nobody should use recursion whatever this is tail or not. But with tail recursive, a compiler has a chance to optimize it. You could do <a href=\"https://ideone.com/MajFvW\" rel=\"nofollow noreferrer\">this</a> and your function will be tail so it has better chance to be optimize."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496844999, "post_id": 44414083, "comment_id": 75829298, "body": "@Stargateur It is an interesting modification of the function implementation.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1496842507, "last_edit_date": 1496842507, "creation_date": 1496842127, "answer_id": 44414083, "question_id": 44412880, "link": "https://stackoverflow.com/questions/44412880/read-an-array-recursively/44414083#44414083", "title": "Read an array recursively", "body": "<p>There is a bug in the function.</p>\n\n<p>As the variable <code>i</code> is initialized the following way</p>\n\n<pre><code>int i = n - 1;\n</code></pre>\n\n<p>then the second argument in this call</p>\n\n<pre><code>scanf(\"%d\", &amp;a[n - 1 - i])\n</code></pre>\n\n<p>is evaluated like</p>\n\n<pre><code>scanf(\"%d\", &amp;a[n - 1 - (n - 1)])\n</code></pre>\n\n<p>that is it is always equal to zero</p>\n\n<pre><code>scanf(\"%d\", &amp;a[0])\n</code></pre>\n\n<p>As the recursive function is called with the same value of the pointer <code>a</code> then all entered values are assigned to <code>a[0]</code>. All other elements of the array are still uninitialized.</p>\n\n<p>Though this does not serve as a reason for the abnormal execution of the function.</p>\n\n<p>It is possible that there is used a big array and the stack is too small to call the function recursively.</p>\n\n<p>In any case the function can be defined more simply and correctly the following way</p>\n\n<pre><code>size_t read_array( int *a, size_t n )\n{\n    return n &amp;&amp; scanf( \"%d\", a ) == 1 ? 1 + read_array( a + 1, n - 1 ) : 0;\n}   \n</code></pre>\n\n<p>Take into account as the input can be interrupted by the user. In this case the function returns the number of initialized elements of the array. </p>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nsize_t read_array( int *a, size_t n )\n{\n    return n &amp;&amp; scanf( \"%d\", a ) == 1 ? 1 + read_array( a + 1, n - 1 ) : 0;\n}   \n\n#define N   10\n\nint main(void) \n{\n    int a[N];\n\n    size_t n = read_array( a, N );\n\n    for ( size_t i = 0; i &lt; n; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>If to enter sequence of numbers</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9\n</code></pre>\n\n<p>then the output will be</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9\n</code></pre>\n"}], "owner": {"reputation": 3337, "user_id": 5274567, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dZoJl.png?s=128&g=1", "display_name": "Worice", "link": "https://stackoverflow.com/users/5274567/worice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 1, "accepted_answer_id": 44413095, "answer_count": 5, "score": 2, "last_activity_date": 1496844555, "creation_date": 1496839130, "question_id": 44412880, "link": "https://stackoverflow.com/questions/44412880/read-an-array-recursively", "title": "Read an array recursively", "body": "<p>I am learning how to apply recursion to arrays.</p>\n\n<p>For example, I usually read arrays itiratively, this way:</p>\n\n<pre><code>void read_array(int *a, int n){\n        int i;\n        for(i = 0; i &lt; n; ++i)\n                scanf(\"%d\", &amp;a[i]);\n        return;\n}\n</code></pre>\n\n<p>I would like to read an array recursively. I wrote the following function:  </p>\n\n<pre><code>void read_array(int *a, int n){\n        int i = n - 1;\n        if (n &lt; 0)\n                return;\n        else{\n                if(scanf(\"%d\", &amp;a[n - 1 - i]) == 1){\n                        read_array(a, n - 1);\n                        return;\n                }\n        }\n}\n</code></pre>\n\n<p>It compiles, but when running it trows a segmentation fault error. It confuses me since the function contemplates a base case <code>0</code> that should stop it. </p>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1496838208, "post_id": 44412491, "comment_id": 75823938, "body": "<code>popatend</code> is an integer and you&#39;re trying to mutiply it by a number that is less than one. What would be the result?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8038216"}, "edited": false, "score": 0, "creation_date": 1496838306, "post_id": 44412534, "comment_id": 75824029, "body": "thanks i accept answer in 12 minutes cause i cant do it right now."}], "tags": [], "owner": {"reputation": 3613, "user_id": 6818284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e1aa2b77c7bc15069e1013aba4d7104?s=128&d=identicon&r=PG&f=1", "display_name": "mikep", "link": "https://stackoverflow.com/users/6818284/mikep"}, "is_accepted": true, "score": 3, "last_activity_date": 1496838218, "creation_date": 1496838218, "answer_id": 44412534, "question_id": 44412491, "link": "https://stackoverflow.com/questions/44412491/increment-is-not-happening-in-for-loop-in-c/44412534#44412534", "title": "increment is not happening in for loop in c", "body": "<p>10/100 is integer division, so 0.</p>\n"}, {"tags": [], "owner": {"reputation": 2733, "user_id": 608425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/foir6.jpg?s=128&g=1", "display_name": "Matt Hogan-Jones", "link": "https://stackoverflow.com/users/608425/matt-hogan-jones"}, "is_accepted": false, "score": 3, "last_activity_date": 1496838531, "last_edit_date": 1496838531, "creation_date": 1496838226, "answer_id": 44412537, "question_id": 44412491, "link": "https://stackoverflow.com/questions/44412491/increment-is-not-happening-in-for-loop-in-c/44412537#44412537", "title": "increment is not happening in for loop in c", "body": "<p>When you do integer division:</p>\n\n<pre><code>  popatend=pop*(10/100);\n</code></pre>\n\n<p><code>popatend</code> will have a value of <code>0</code>, since <code>(10/100)</code> will evaluate to <code>0</code>.</p>\n\n<p>So when you add it to <code>pop</code>, the value of <code>pop</code> will not change.</p>\n\n<p>I believe this could be fixed by changing it to </p>\n\n<pre><code>  popatend=pop*(10f/100f);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1496838236, "creation_date": 1496838236, "answer_id": 44412542, "question_id": 44412491, "link": "https://stackoverflow.com/questions/44412491/increment-is-not-happening-in-for-loop-in-c/44412542#44412542", "title": "increment is not happening in for loop in c", "body": "<p>You have integer division, <code>10/100</code> will be truncated to zero. Use <code>10.0 / 100.0</code> (or plain <code>0.1</code>) instead.</p>\n"}, {"tags": [], "owner": {"reputation": 342, "user_id": 5000855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XrLk.png?s=128&g=1", "display_name": "josephmbustamante", "link": "https://stackoverflow.com/users/5000855/josephmbustamante"}, "is_accepted": false, "score": 0, "last_activity_date": 1496838615, "creation_date": 1496838615, "answer_id": 44412668, "question_id": 44412491, "link": "https://stackoverflow.com/questions/44412491/increment-is-not-happening-in-for-loop-in-c/44412668#44412668", "title": "increment is not happening in for loop in c", "body": "<p>You're using integer division when you do <code>10/100</code>, so rather than returning <code>0.1</code>, it's actually truncating to <code>0</code>. Thus, you're setting <code>popatend</code> to zero every loop (<code>popatend = pop * 0</code>), and effectively adding zero to <code>pop</code> every time. </p>\n\n<p>To fix this, you could either cast or change the types of<code>pop</code> and <code>popatend</code>, or use <code>10f/100f</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2733, "user_id": 608425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/foir6.jpg?s=128&g=1", "display_name": "Matt Hogan-Jones", "link": "https://stackoverflow.com/users/608425/matt-hogan-jones"}, "edited": false, "score": 3, "creation_date": 1496838784, "post_id": 44412707, "comment_id": 75824390, "body": "This is incorrect - the calculation is applied every iteration of the loop, year is the loop counter. It doesn&#39;t need to be in the calculation at all."}, {"owner": {"reputation": 306, "user_id": 1453487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/310b9f6435349fc4ddc61b3a35550e55?s=128&d=identicon&r=PG&f=1", "display_name": "vivi", "link": "https://stackoverflow.com/users/1453487/vivi"}, "reply_to_user": {"reputation": 2733, "user_id": 608425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/foir6.jpg?s=128&g=1", "display_name": "Matt Hogan-Jones", "link": "https://stackoverflow.com/users/608425/matt-hogan-jones"}, "edited": false, "score": 0, "creation_date": 1496839143, "post_id": 44412707, "comment_id": 75824630, "body": "Please check well, the variable &#39;year&#39; was well not at all used anywhere in ther calculation of new value, that&#39;s why he doesn&#39;t see any &#39;increment&#39;"}, {"owner": {"reputation": 342, "user_id": 5000855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XrLk.png?s=128&g=1", "display_name": "josephmbustamante", "link": "https://stackoverflow.com/users/5000855/josephmbustamante"}, "edited": false, "score": 2, "creation_date": 1496839199, "post_id": 44412707, "comment_id": 75824674, "body": "Matt is right - the way he structured the loop, it wasn&#39;t meant to be used in the calculation. If he changes it from integer division, it should work as desired, without the need to use <code>year</code>"}], "tags": [], "owner": {"reputation": 306, "user_id": 1453487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/310b9f6435349fc4ddc61b3a35550e55?s=128&d=identicon&r=PG&f=1", "display_name": "vivi", "link": "https://stackoverflow.com/users/1453487/vivi"}, "is_accepted": false, "score": -2, "last_activity_date": 1496838706, "creation_date": 1496838706, "answer_id": 44412707, "question_id": 44412491, "link": "https://stackoverflow.com/questions/44412491/increment-is-not-happening-in-for-loop-in-c/44412707#44412707", "title": "increment is not happening in for loop in c", "body": "<p>and you have <code>(year = 1; year &lt;= 10; year++)</code>, which <code>year</code> here never serve as a factor in the calculation, that's why.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8038216"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 44412534, "answer_count": 5, "score": -2, "last_activity_date": 1496959959, "creation_date": 1496838095, "last_edit_date": 1496959959, "question_id": 44412491, "link": "https://stackoverflow.com/questions/44412491/increment-is-not-happening-in-for-loop-in-c", "title": "increment is not happening in for loop in c", "body": "<p>I had written a program in C in which the population of a town increases by 10% each year, but the variable <code>pop</code> is not incrementing in the <code>for</code> loop.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() { // B main\n    int pop = 100000, year, popatend;\n    printf(\"\\nyear\\t\\t\\tpopulation\\n\\n\");\n    for (year = 1; year &lt;= 10; year++) { // B loop\n        popatend = pop * (10 / 100);\n        pop = pop + popatend;\n\n        printf(\"%d\\t\\t\\t %d\\n\", year, pop);\n    } // B loop\n} // B main\n</code></pre>\n\n<p>And this is the output:</p>\n\n<pre><code>year            population\n\n   1             100000\n   2             100000\n   3             100000\n   4             100000\n   5             100000\n   6             100000\n   7             100000\n   8             100000\n   9             100000\n  10             100000\n</code></pre>\n\n<p>I made this program in Eclipse, in ubuntu mate.</p>\n"}, {"tags": ["c", "embedded", "bootloader"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1496837833, "post_id": 44412356, "comment_id": 75823653, "body": "If you&#39;re programming in C, why did you add the C++ tag? Only add the tag of the language you&#39;re actually programming in. You could also expand on the environment, like if you&#39;re doing this for a PC platform or an embedded system. Please take some time to <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496837905, "post_id": 44412356, "comment_id": 75823705, "body": "I m sorry! If you be so kind please post the solution"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496838122, "post_id": 44412356, "comment_id": 75823865, "body": "VTC as too broad: This heavily depends on your environment. You could for example define your own entry point, use a linker script that puts this at the very start of your binary and jump there, either using assembly code or the start address cast to a function pointer -- but no good answer is possible without more details."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1496838176, "post_id": 44412356, "comment_id": 75823914, "body": "What sort of computer are you programming this on? A normal operating system just won&#39;t let you do it."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496838252, "post_id": 44412356, "comment_id": 75823978, "body": "@FelixPalmen I have already pointed in linker script &#39;link.ld&#39; to its starting address i.e. 0x18000000 is defind as entry point. What else do u need in details? I can provide you."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1496838313, "post_id": 44412356, "comment_id": 75824037, "body": "@BoundaryImposition I am programming in Linux particularly in C language"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496838444, "post_id": 44412356, "comment_id": 75824140, "body": "@kni but this starting point probably isn&#39;t <code>main()</code>."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496838599, "post_id": 44412356, "comment_id": 75824274, "body": "@FelixPalmen This starting point 0x18000000 is the starting address of RAM."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496839018, "post_id": 44412356, "comment_id": 75824557, "body": "@kni yes and you can jump there e.g. using the <code>gcc</code> specific syntax presented in the answer, just replace with your address. I just doubt that it&#39;s the code in <code>main()</code> that ends up at this address."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496839486, "post_id": 44412356, "comment_id": 75824872, "body": "@FelixPalmen 0x18000000 is the starting address of DDR3 RAM. I just want to invoke in go.c from this address"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1496840133, "post_id": 44412356, "comment_id": 75825388, "body": "On a bare metal embedded system this wouldn&#39;t be any problem. You could just set a function pointer of the correct format to point at a fixed address, then call that function. This is often how bootloaders etc that are provided as raw assembler are called. From a hosted system such as Linux, it wouldn&#39;t work though, since processes are not allowed to write into each other address spaces."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496840163, "post_id": 44412356, "comment_id": 75825411, "body": "@FelixPalmen  Another thing i forgot to mention is that I am making .elf to .srec and loading this .srec to RAM. Starting form this address 0x1800000 it has some 4bytes of data that is generated by elf to .srec to be downloaded onto memory"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496840246, "post_id": 44412356, "comment_id": 75825470, "body": "@Lundin How? can you explain by example? I didn&#39;t quite get that! May be i m so much confused now!!"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496848058, "post_id": 44412356, "comment_id": 75831804, "body": "main is not an entry point generally are you wanting to enter at main or wanting to run the code you downloaded via elf/srec/binary?"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496849836, "post_id": 44412356, "comment_id": 75833063, "body": "@old_timer I want to run the code downloaded .srec file to my target which is MAX10 FPGA"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1496870012, "post_id": 44412356, "comment_id": 75844182, "body": "@kni :  You are making increasingly less sense; An FPGA is not a <i>target</i> for software.  You might implement a soft-core processor on the FPGA and run software on that.  You said that you were running Linux, but if that were the case you would not need to do this.  Did you mean Linux was your development host environment rather than your target environment; because that is not what you were asked."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496838502, "post_id": 44412572, "comment_id": 75824193, "body": "In linker script I have given starting address 0x18000000"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496838643, "post_id": 44412572, "comment_id": 75824297, "body": "Then how should I do it?"}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496839021, "post_id": 44412572, "comment_id": 75824561, "body": "If you are sure that 0x18000000 is the RAM address of your routine just copy this address in the first line of code, in place of 0x1234567"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496839286, "post_id": 44412572, "comment_id": 75824750, "body": "I have done same as u have told me i.e. replace 0x1234567 with 0x18000000 but nothing happend!! :( :( Any other suggestions?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1496839967, "post_id": 44412572, "comment_id": 75825257, "body": "Isn&#39;t that interpreted as an address in <i>this</i> process&#39;s virtual memory space?"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496840032, "post_id": 44412572, "comment_id": 75825310, "body": "I am using your code for passing a control to led.c and led.c code is mentioned in my question. Another thing i forgot to mention is that I am making .elf to .srec and loading this .srec to RAM. Starting form this address 0x1800000 it has some 4bytes of data that is generated by elf to .srec to be downloaded onto memory"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 1, "creation_date": 1496840129, "post_id": 44412572, "comment_id": 75825382, "body": "@kni: Operating systems are abstractions. If you want to program like this I suggest bare-metal."}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496840572, "post_id": 44412572, "comment_id": 75825743, "body": "@kni: I was in fact skeptical in my answer. From what you are saying it seems that you are looking for a bootloader"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496840764, "post_id": 44412572, "comment_id": 75825897, "body": "@SimoneCifani exactly!!! Now u got it!! I am trying to implement &#39;go&#39; command of bootloader!! e.g go 0x18000000 in the ram and it should blink LEDs since I have successfully downloaded .srec file"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496841107, "post_id": 44412572, "comment_id": 75826187, "body": "@SimoneCifani I have go.c in which I have different commands in main() and I have a function to go to a specific address goto_addr() in which I wrote your routine. But writing your code it is coming in the main() of go.c rather than led.c"}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496841404, "post_id": 44412572, "comment_id": 75826432, "body": "@kni: you mean that my code makes the program jump to a different point or it doesn&#39;t jump at all?"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496841830, "post_id": 44412572, "comment_id": 75826787, "body": "@Simone Cifani It jumps to a main() in go.c rather than main () of led.c. I mean functionally it is working right. But what i need is that in go.c i want to invoke main() of led.c"}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496841979, "post_id": 44412572, "comment_id": 75826906, "body": "@kni: you are probably passing a wrong address. I found <a href=\"https://electronics.stackexchange.com/questions/87930/avr-and-bootloaders-where-to-begin\">this link</a> on writing an AVR bootloader and the code is pretty the same"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496848362, "post_id": 44412572, "comment_id": 75832027, "body": "is this an AVR or do we know what target?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496848499, "post_id": 44412572, "comment_id": 75832130, "body": "main() is not an entry point, you want to branch to the entry point which then calls main, if your new program is downloaded to 0x18000000 then use the code provided in this answer with that address.  depending on the architecture it may or may not work (may crash with an ARM cortex-m for example) but that is solve able, you are not the first person to create a bootloader."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496850065, "post_id": 44412572, "comment_id": 75833219, "body": "@old_timer The target is not AVR, it is MAX10 FPGA. Yes, my code is downloaded at 0x18000000 and when I use above mentioned code it takes me to main() of go.c rather than executing led.c program which I actually want to blink LEDS at a specified address. If you have any other link or any other suggestion please tell me? I have searched a lot but other than this solution, I found nothing. I have really searched a lot!!"}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496850814, "post_id": 44412572, "comment_id": 75833716, "body": "@kni: have you read <a href=\"https://www.altera.com/en_US/pdfs/literature/an/an730.pdf\" rel=\"nofollow noreferrer\">this document</a> from Altera?"}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496851041, "post_id": 44412572, "comment_id": 75833856, "body": "@SimoneCifani I already studied this. But I am using RISC-V soft core processor not the oneprovided by them which is NIOS-2"}, {"owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "reply_to_user": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496851161, "post_id": 44412572, "comment_id": 75833937, "body": "@kni: I am not an expert with FPGA, sorry :-("}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496859019, "post_id": 44412572, "comment_id": 75838286, "body": "main is not an entry point...the bootstrap before main is an entry point from the nature of your question I dont think you are ready to be trying to branch directly into main yet (if ever since it is the wrong thing to do)..."}], "tags": [], "owner": {"reputation": 734, "user_id": 6864400, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-d-5fGoRO7dg/AAAAAAAAAAI/AAAAAAAAAUU/9fMrJJAQFaE/photo.jpg?sz=128", "display_name": "Simone Cifani", "link": "https://stackoverflow.com/users/6864400/simone-cifani"}, "is_accepted": true, "score": 1, "last_activity_date": 1496838341, "creation_date": 1496838341, "answer_id": 44412572, "question_id": 44412356, "link": "https://stackoverflow.com/questions/44412356/writing-a-c-program-to-call-another-program-without-using-any-built-in-libraries/44412572#44412572", "title": "Writing a C program to call another program without using any built-in libraries", "body": "<p>GCC has an extension that allows jumping to an arbitrary address, so if you know the address of your led.c main you could do something like that:</p>\n\n<pre><code>void *func_ptr = (void *)0x1234567;  // address of your led routine\ngoto *func_ptr;                      \n</code></pre>\n\n<p>However, you probably don't have the address of the led routine and it is not a very safe operation. Jumping to some unknown address will probably result in a crash!!</p>\n"}, {"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496860960, "post_id": 44420397, "comment_id": 75839335, "body": "so if this is your problem upvote/accept Simone&#39;s answer"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496860991, "post_id": 44420397, "comment_id": 75839359, "body": "Note they give you the entry point if you built your binary right S705800010006A"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1496862651, "post_id": 44420397, "comment_id": 75840317, "body": "this is as simple as it gets, if your prior program has interrupts enabled for peripherals or the cache enabled, etc.  Then you need to clean up all of those things before you can launch the next program..."}, {"owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "edited": false, "score": 0, "creation_date": 1496909632, "post_id": 44420397, "comment_id": 75858151, "body": "Yup. I am parsing and then writing program to RAM."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 1, "last_activity_date": 1496860726, "creation_date": 1496860726, "answer_id": 44420397, "question_id": 44412356, "link": "https://stackoverflow.com/questions/44412356/writing-a-c-program-to-call-another-program-without-using-any-built-in-libraries/44420397#44420397", "title": "Writing a C program to call another program without using any built-in libraries", "body": "<p>So I have an sifive riscv board, going to be a little different than yours but here is an led blinker program (compiled version):</p>\n\n<pre><code>Disassembly of section .text:\n\n80001000 &lt;_start&gt;:\n80001000:   80004137            lui x2,0x80004\n80001004:   016000ef            jal x1,8000101a &lt;notmain&gt;\n80001008:   9002                    ebreak\n8000100a:   a001                    j   8000100a &lt;_start+0xa&gt;\n\n8000100c &lt;dummy&gt;:\n8000100c:   8082                    ret\n\n8000100e &lt;PUT32&gt;:\n8000100e:   00b52023            sw  x11,0(x10)\n80001012:   8082                    ret\n\n80001014 &lt;GET32&gt;:\n80001014:   00052503            lw  x10,0(x10)\n80001018:   8082                    ret\n\n8000101a &lt;notmain&gt;:\n8000101a:   1101                    addi    x2,x2,-32\n8000101c:   c84a                    sw  x18,16(x2)\n8000101e:   10012937            lui x18,0x10012\n80001022:   00890513            addi    x10,x18,8 # 10012008 &lt;_start-0x6ffeeff8&gt;\n80001026:   006805b7            lui x11,0x680\n8000102a:   ce06                    sw  x1,28(x2)\n8000102c:   ca26                    sw  x9,20(x2)\n8000102e:   c64e                    sw  x19,12(x2)\n80001030:   cc22                    sw  x8,24(x2)\n80001032:   3ff1                    jal 8000100e &lt;PUT32&gt;\n80001034:   00c90513            addi    x10,x18,12\n80001038:   006805b7            lui x11,0x680\n8000103c:   3fc9                    jal 8000100e &lt;PUT32&gt;\n8000103e:   04090513            addi    x10,x18,64\n80001042:   4581                    li  x11,0\n80001044:   001e84b7            lui x9,0x1e8\n80001048:   37d9                    jal 8000100e &lt;PUT32&gt;\n8000104a:   006809b7            lui x19,0x680\n8000104e:   0931                    addi    x18,x18,12\n80001050:   48048493            addi    x9,x9,1152 # 1e8480 &lt;_start-0x7fe18b80&gt;\n80001054:   85ce                    mv  x11,x19\n80001056:   854a                    mv  x10,x18\n80001058:   3f5d                    jal 8000100e &lt;PUT32&gt;\n8000105a:   4401                    li  x8,0\n8000105c:   8522                    mv  x10,x8\n8000105e:   0405                    addi    x8,x8,1\n80001060:   3775                    jal 8000100c &lt;dummy&gt;\n80001062:   fe941de3            bne x8,x9,8000105c &lt;notmain+0x42&gt;\n80001066:   4581                    li  x11,0\n80001068:   854a                    mv  x10,x18\n8000106a:   3755                    jal 8000100e &lt;PUT32&gt;\n8000106c:   4401                    li  x8,0\n8000106e:   8522                    mv  x10,x8\n80001070:   0405                    addi    x8,x8,1\n80001072:   3f69                    jal 8000100c &lt;dummy&gt;\n80001074:   fe941de3            bne x8,x9,8000106e &lt;notmain+0x54&gt;\n80001078:   bff1                    j   80001054 &lt;notmain+0x3a&gt;\n</code></pre>\n\n<p>the disassembly spacing is a little broken but thats okay.  The entry point IS NOT AT MAIN() for a normal program it is at the start in this case 0x80001000 NOT 0x8000101A which I intentionally name something other than main on purpose (for bare metal)...There should be no reason for you to to enter at main you should enter at the entry point...I will let you simply fail if you continue to try otherwise, you are on your own with that.</p>\n\n<p>So this represents an srec of the above.</p>\n\n<pre><code>S00F00006E6F746D61696E2E737265631F\nS3158000100037410080EF006001029001A0828023209A\nS31580001010B500828003250500828001114AC83729E0\nS31580001020011013058900B705680006CE26CA4EC68C\nS3158000103022CCF13F1305C900B7056800C93F1305E7\nS3158000104009048145B7841E00D937B709680031097C\nS3158000105093840448CE854A855D3F014422850504F4\nS315800010607537E31D94FE81454A85553701442285AF\nS30F800010700504693FE31D94FEF1BFFD\nS705800010006A\n</code></pre>\n\n<p>I/we assume you are not actually downloading that to ram as is, that will never execute, your bootloader has to parse that then write the program to ram, two different things (the program itself and a file format that describes that program).</p>\n\n<p>Assuming you get to that point, all you need to do is branch to 0x80001000 in my case or 0x18000000 in yours.</p>\n\n<p>so taking the answer already provided to you you can do this to launch the downloaded program</p>\n\n<pre><code>void hop ( void )\n{\n    void *func_ptr = (void *)0x80001000;\n    goto *func_ptr;\n}\n</code></pre>\n\n<p>which results in</p>\n\n<pre><code>Disassembly of section .text:\n\n00000000 &lt;hop&gt;:\n   0:   800017b7            lui x15,0x80001\n   4:   8782                    jr  x15\n</code></pre>\n\n<p>Or my personal preference would be:</p>\n\n<pre><code>.globl HOP\nHOP:\n    jr x11\n</code></pre>\n\n<p>which from C I would call with</p>\n\n<pre><code>HOP(0x80001000);\n</code></pre>\n\n<p>that way I can insure the instruction I wanted is used. YMMV.</p>\n\n<p>How far along this path have you gotten?  Are you stuck at the last step?  Simone provided an answer that should work just fine, there are other variations on that theme from C that you can use, but that one already appears to work.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1496870344, "creation_date": 1496870344, "answer_id": 44422938, "question_id": 44412356, "link": "https://stackoverflow.com/questions/44412356/writing-a-c-program-to-call-another-program-without-using-any-built-in-libraries/44422938#44422938", "title": "Writing a C program to call another program without using any built-in libraries", "body": "<p>There is a lot you have omitted that is likely to be relevant, but taken at face value, you simply declare a function pointer, initialised with the absolute address and invoke the function through that pointer.  </p>\n\n<p>However it may not be that simple since the called program will use the C run-time environment of the calling program; any global static objects will not be initialised  - you need to call the program entry point (which is not<code>main()</code>) to establish the run-time environment expected by the program.  In simple case it may work or appear to work to some extent.</p>\n"}], "owner": {"reputation": 7, "user_id": 8125436, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49170569ca979713a1dd53d7140b930b?s=128&d=identicon&r=PG&f=1", "display_name": "kni", "link": "https://stackoverflow.com/users/8125436/kni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "accepted_answer_id": 44412572, "answer_count": 3, "score": -1, "last_activity_date": 1496870344, "creation_date": 1496837704, "last_edit_date": 1496848957, "question_id": 44412356, "link": "https://stackoverflow.com/questions/44412356/writing-a-c-program-to-call-another-program-without-using-any-built-in-libraries", "title": "Writing a C program to call another program without using any built-in libraries", "body": "<p>I am trying to write a simple 'go-command' for boot-loader that takes me to specific address in RAM say 0x18000000 and it should execute a program that blinks led. I have two .c files say led.c and go.c in which led.c blinks two leds. But I am wondering and don't know that how can I pass a control/invoke its main() to this go.c file to go to that address and start blinking leds? But it should be done without including other header files, libraries, etc. Kindly help me!! Thanks in advance. Below code is for led.c </p>\n\n<pre><code>void delay ()\n{\n    volatile int i;\n    for(i=0;i&lt;1000000;i++)\n    {}\n\n}\nint main(void)\n{\n    *led0=0;\n    *led1=0;\n    while(1)\n    {\n        *led0=1;\n        delay();\n        *led0=0;\n        *led1=1;\n        delay();\n        *led1=0;\n    }\n}\n</code></pre>\n\n<p>In my go.c file I want to pass a control to invoke this led.c main() func</p>\n"}, {"tags": ["c", "ruby", "regex", "string", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496840121, "post_id": 44412981, "comment_id": 75825376, "body": "The only reason I might consider using a third party library is if a simple regex like <code>&#47;[\\w&#39;]+&#47;</code> is insufficient for your needs. It would be virtually impossible to write a <i>perfect</i> regex to separate words - but you could instead use a Natural Language Parser. (However, I strongly suspect that this is overkill for what you are trying to achieve...)"}, {"owner": {"reputation": 39, "user_id": 5163869, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1a8f78cfef4965e4c2c25b678aee792?s=128&d=identicon&r=PG&f=1", "display_name": "vipul Kumar", "link": "https://stackoverflow.com/users/5163869/vipul-kumar"}, "edited": false, "score": 0, "creation_date": 1496842923, "post_id": 44412981, "comment_id": 75827599, "body": "Thanks for the answer. So in my case, the word list will be around 100-200 and the text can be as big as 4-5 page content. I was looking for a different solution which could be scalable and have least performance issues."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 39, "user_id": 5163869, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1a8f78cfef4965e4c2c25b678aee792?s=128&d=identicon&r=PG&f=1", "display_name": "vipul Kumar", "link": "https://stackoverflow.com/users/5163869/vipul-kumar"}, "edited": false, "score": 0, "creation_date": 1496843727, "post_id": 44412981, "comment_id": 75828209, "body": "The above solution is only a guideline. Feel free to integrate a database or something if performance becomes an issue... But to be honest, 100-200 words across 5 pages is hardly going to be an issue! If you were dealing with <i>millions</i> of pages, then you&#39;d have more cause for concern."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1496839745, "last_edit_date": 1496839745, "creation_date": 1496839407, "answer_id": 44412981, "question_id": 44412354, "link": "https://stackoverflow.com/questions/44412354/find-text-having-highest-density-of-words/44412981#44412981", "title": "Find Text having highest density of words", "body": "<p>Here is a simple example, in <code>ruby</code>, for counting the frequency of words in a string:</p>\n\n<pre><code>def count_words(string)\n  string\n    .scan(/[\\w']+/) # Treat strings like \"don't\" as a single word\n    .each_with_object(Hash.new(0)) do |w,h|\n      h[w.downcase] += 1\n    end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>word_occurrences = count_words(\"Hello world! Hello, vipul.\")\n  =&gt; {\"hello\"=&gt;2, \"world\"=&gt;1, \"vipul\"=&gt;1}\n</code></pre>\n\n<p>You shouldn't need a third party library to implement something this simple.</p>\n\n<p>To check occurrences of a specific word, just look it up in the hash:</p>\n\n<pre><code>word_occurrences[word1.downcase]\n</code></pre>\n\n<p>To obtain a list of the \"highest density\" words, just sort by hash value:</p>\n\n<pre><code>word_occurrences.sort_by {|_word, occurrences| -occurrences}\n# Note the negative to make this descending, not ascending\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5163869, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1a8f78cfef4965e4c2c25b678aee792?s=128&d=identicon&r=PG&f=1", "display_name": "vipul Kumar", "link": "https://stackoverflow.com/users/5163869/vipul-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1496839745, "creation_date": 1496837693, "question_id": 44412354, "link": "https://stackoverflow.com/questions/44412354/find-text-having-highest-density-of-words", "title": "Find Text having highest density of words", "body": "<p>I have a hash as below:</p>\n\n<pre><code>{1=&gt;[{content=&gt;\"Text of paragraph 1..........\"},{content=&gt;\"Text of paragraph 2\"}]}\n</code></pre>\n\n<p>The above hash is created after parsing a text file . The key \"1\" represents page 1. It points to an array of hashes , each hash pointing to a paragraph with content key pointing to actual text.</p>\n\n<p>Now I have a word list like [word1,word2,word3]. I have to iterate through all the paragraph content of that page and tell which paragraph has the most occurrence of these words.</p>\n\n<p>I can write my own code where I do regex match for each of the word against the paragraph . But I wanted to know if there is any powerful string matching library that can solve this use case (in C, C++, or even ruby)</p>\n\n<p>Its just not string matching. I need a library that can extract the data that consists the highest density for the words in the word list.</p>\n"}, {"tags": ["c", "qt", "math"], "comments": [{"owner": {"reputation": 2841, "user_id": 8085668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2459e2e40fc4557954680e57b16a13f6?s=128&d=identicon&r=PG&f=1", "display_name": "WizardCoder", "link": "https://stackoverflow.com/users/8085668/wizardcoder"}, "edited": false, "score": 0, "creation_date": 1496837554, "post_id": 44412286, "comment_id": 75823466, "body": "Does this do what you want? <a href=\"https://stackoverflow.com/a/4249711/8085668\">stackoverflow.com/a/4249711/8085668</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1496838207, "post_id": 44412286, "comment_id": 75823936, "body": "I assume you are able to get the pixel coordinates from the mouse click event. Then you can treat geographic coordinates in a rather linear way: The total width in pixel is representing the difference between left and right longitute: <code>lon_pixel = lon_left + click.x &#47; width * (lon_right - lon_left)</code>"}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1496838355, "post_id": 44412286, "comment_id": 75824076, "body": "Lat/Long is not a linear 2D grid... If your image covers any &quot;substantial&quot; area then you will need to consider the curvature of the planet, and the projection of your image / map"}, {"owner": {"reputation": 103, "user_id": 7908900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bo6ZblVlV9s/AAAAAAAAAAI/AAAAAAAAAEY/WhTV9f4CtSw/photo.jpg?sz=128", "display_name": "Sourav", "link": "https://stackoverflow.com/users/7908900/sourav"}, "edited": false, "score": 0, "creation_date": 1496842302, "post_id": 44412286, "comment_id": 75827138, "body": "my map corresponds to a small region 500m by 500m, so I guess curvature can be ignored in this case"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496842510, "post_id": 44412286, "comment_id": 75827291, "body": "@Sourav It is not the size of the grid that is important, it is <i>where</i>.  If the location is near the north or south pole, simple linear transformations do not work - unless one is on <a href=\"https://www.sott.net/image/s11/223384/full/bizarroworld.jpg\" rel=\"nofollow noreferrer\">bizarro world</a> ;-)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496842626, "post_id": 44412286, "comment_id": 75827385, "body": "What are the types of Lat, Long and the two corners?  A quality answer depends on that."}], "answers": [{"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 0, "last_activity_date": 1496838241, "creation_date": 1496838241, "answer_id": 44412544, "question_id": 44412286, "link": "https://stackoverflow.com/questions/44412286/how-to-convert-latitude-and-longitude-to-pixels/44412544#44412544", "title": "how to convert latitude and longitude to pixels", "body": "<p>Assuming linear interpolation is good enough for your purposes, you can use following formula:</p>\n\n<pre><code>out = (in - inMin) * (outMax - outMin) / (inMax - inMin) + outMin\n</code></pre>\n\n<p>where <code>in*</code> are image coordinates and <code>out*</code> are map coordinates.</p>\n\n<p>You have to use formula twice; once for horizontal and once for vertical coordinate.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 7908900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bo6ZblVlV9s/AAAAAAAAAAI/AAAAAAAAAEY/WhTV9f4CtSw/photo.jpg?sz=128", "display_name": "Sourav", "link": "https://stackoverflow.com/users/7908900/sourav"}, "edited": false, "score": 0, "creation_date": 1496993651, "post_id": 44412580, "comment_id": 75900483, "body": "void pixels_to_coordinates(int _xlength, int _ylength, double&amp; _latt, double&amp; _longg) {     _longg = longg_top_left + (double)_ylength * (longg_bottom_right - longg_top_left)/ (601);     _latt =  latt_top_left  + (double)_xlength * (latt_bottom_right  - latt_top_left )/ (341); }"}, {"owner": {"reputation": 103, "user_id": 7908900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bo6ZblVlV9s/AAAAAAAAAAI/AAAAAAAAAEY/WhTV9f4CtSw/photo.jpg?sz=128", "display_name": "Sourav", "link": "https://stackoverflow.com/users/7908900/sourav"}, "edited": false, "score": 0, "creation_date": 1496993718, "post_id": 44412580, "comment_id": 75900517, "body": "I tried this code nut this shifts too much from the actual positions. A m I doing something wrong?"}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "reply_to_user": {"reputation": 103, "user_id": 7908900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bo6ZblVlV9s/AAAAAAAAAAI/AAAAAAAAAEY/WhTV9f4CtSw/photo.jpg?sz=128", "display_name": "Sourav", "link": "https://stackoverflow.com/users/7908900/sourav"}, "edited": false, "score": 0, "creation_date": 1496997438, "post_id": 44412580, "comment_id": 75902589, "body": "What is _ylength and _xlength? If they are click coordinates - exchange them (x for longitude)"}], "tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": true, "score": 1, "last_activity_date": 1496848964, "last_edit_date": 1496848964, "creation_date": 1496838359, "answer_id": 44412580, "question_id": 44412286, "link": "https://stackoverflow.com/questions/44412286/how-to-convert-latitude-and-longitude-to-pixels/44412580#44412580", "title": "how to convert latitude and longitude to pixels", "body": "<p>You should know what geodetic projection has been used to create that map and how rectangular coordinates correspond to geographic ones.</p>\n\n<p>For small map pieces you can use linear approximation, so coordinates might be calculated with linear interpolation.</p>\n\n<p>Example for x-coordinate and longitude:</p>\n\n<pre><code>Lon = LonLeft + X * (LonRight - LonLeft) / Width \n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7908900, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bo6ZblVlV9s/AAAAAAAAAAI/AAAAAAAAAEY/WhTV9f4CtSw/photo.jpg?sz=128", "display_name": "Sourav", "link": "https://stackoverflow.com/users/7908900/sourav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1097, "favorite_count": 1, "accepted_answer_id": 44412580, "answer_count": 2, "score": 1, "last_activity_date": 1496848964, "creation_date": 1496837445, "question_id": 44412286, "link": "https://stackoverflow.com/questions/44412286/how-to-convert-latitude-and-longitude-to-pixels", "title": "how to convert latitude and longitude to pixels", "body": "<p>I have two sets of Lat and Long values corresponding to <strong>two corners of a rectangle (top left and bottom right)</strong>. I want to load a image in the rectangle and as the user clicks on the locations on the rectangle/image, it should return a latitude and longitude (from the detected pixel's coordinates). What should be the calculation to convert pixels to lat and long, given the above spot of inputs.</p>\n"}, {"tags": ["java", "c", "32-bit"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1496837538, "post_id": 44412274, "comment_id": 75823451, "body": "Stupid question maybe, but do you have version 7 or 8 of the JDK installed?"}, {"owner": {"reputation": 1466, "user_id": 4950452, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/34c45d319ceb8a68f08256db8a1f77a1?s=128&d=identicon&r=PG", "display_name": "gcw", "link": "https://stackoverflow.com/users/4950452/gcw"}, "edited": false, "score": 0, "creation_date": 1496838003, "post_id": 44412274, "comment_id": 75823775, "body": "Looks like the bytecode is generated for Java 6, but you are running Java 7 our 8."}, {"owner": {"reputation": 1357, "user_id": 496038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lO2Iq.png?s=128&g=1", "display_name": "pringi", "link": "https://stackoverflow.com/users/496038/pringi"}, "edited": false, "score": 1, "creation_date": 1496838523, "post_id": 44412274, "comment_id": 75824210, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10382929/how-to-fix-java-lang-unsupportedclassversionerror-unsupported-major-minor-versi\">How to fix java.lang.UnsupportedClassVersionError: Unsupported major.minor version</a>"}], "owner": {"reputation": 21, "user_id": 6229893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1752c4348140acbb34c459564db4968?s=128&d=identicon&r=PG&f=1", "display_name": "Amol Gurmule", "link": "https://stackoverflow.com/users/6229893/amol-gurmule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1496841922, "creation_date": 1496837427, "last_edit_date": 1496841922, "question_id": 44412274, "link": "https://stackoverflow.com/questions/44412274/importing-c-code-into-32-bit-java-program", "title": "Importing c code into 32-bit java program", "body": "<p>I get an error when I do the following steps:</p>\n\n<ol>\n<li>Create a dll file of C code by eclipse and mingGW compiler (JDK 32 bit)</li>\n<li>In Java application, create a header file (JDK 32 bit)</li>\n<li>Get this dll file and call from a Java project.</li>\n</ol>\n\n<p>But I receive the following error:</p>\n\n<blockquote>\n  <p>Can't find dependent libraries for (java7 ,8)  Unsupported major.minor version 51.0 (Java 6)</p>\n</blockquote>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1496836043, "post_id": 44411752, "comment_id": 75822283, "body": "So you ask that we do your job ?"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1496836340, "post_id": 44411752, "comment_id": 75822516, "body": "See <a href=\"https://stackoverflow.com/a/28080198/5265292\">stackoverflow.com/a/28080198/5265292</a> good luck."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496842907, "post_id": 44411752, "comment_id": 75827589, "body": "<a href=\"http://csharpindepth.com/Articles/General/Decimal.aspx\" rel=\"nofollow noreferrer\">Decimal floating point in .NET</a> may help"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496843012, "post_id": 44411752, "comment_id": 75827665, "body": "Explain the requirement &quot;convert these 16 bytes back to a decimal number, but in C&quot;.  C does not specify <i>decimal number</i>,  What do you mean by that?  do you want a <code>double</code>, an integer, a string?"}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 7291581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7MeYy.png?s=128&g=1", "display_name": "ManselD", "link": "https://stackoverflow.com/users/7291581/manseld"}, "edited": false, "score": 1, "creation_date": 1565486122, "post_id": 44411824, "comment_id": 101369459, "body": "Why is this not the accepted answer? It was first to mention GetBits, which was OP&#39;s solution in the end."}, {"owner": {"reputation": 18818, "user_id": 210709, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/51074bf9fb1da9546246986784cfbdd9?s=128&d=identicon&r=PG", "display_name": "IAbstract", "link": "https://stackoverflow.com/users/210709/iabstract"}, "edited": false, "score": 0, "creation_date": 1571492678, "post_id": 44411824, "comment_id": 103263788, "body": "Out of curiosity, why on earth would <code>GetBits</code> return an <code>int[]</code> when the expected implication of <i><code>bits</code></i> is, well, binary???"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 18818, "user_id": 210709, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/51074bf9fb1da9546246986784cfbdd9?s=128&d=identicon&r=PG", "display_name": "IAbstract", "link": "https://stackoverflow.com/users/210709/iabstract"}, "edited": false, "score": 0, "creation_date": 1571506449, "post_id": 44411824, "comment_id": 103267247, "body": "@IAbstract I guess you could argue that <code>int</code> are made of bits just as much as <code>byte</code> are... :) but: I fundamentally agree"}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": false, "score": 5, "last_activity_date": 1496836159, "creation_date": 1496836159, "answer_id": 44411824, "question_id": 44411752, "link": "https://stackoverflow.com/questions/44411752/c-decimal-to-byte-and-back-in-c/44411824#44411824", "title": "C# Decimal to byte[] and back in C", "body": "<p>You don't need to use <code>MemoryStream</code>, <code>BinaryWriter</code>, etc, here; just <code>decimal.GetBits(value)</code> is fine. The contents are fully documented, here: <a href=\"https://msdn.microsoft.com/en-us/library/system.decimal.getbits(v=vs.110).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/system.decimal.getbits(v=vs.110).aspx</a>. There is a constructor that <em>accepts</em> the same format.</p>\n\n<p>Note that this gives you an <code>int[]</code>, not a <code>byte[]</code>, but... getting between <code>int</code> and <code>byte</code> is trivial; probably the easiest is to use shift and mask.</p>\n\n<p>The <code>BinaryWriter</code> version is not officially documented, but is <em>probably</em> just the integers from <code>GetBits()</code> written sequentially.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7967704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88cfa1dc3928d7d2bcbbcf46d0fb1e4?s=128&d=identicon&r=PG&f=1", "display_name": "Teddy_R", "link": "https://stackoverflow.com/users/7967704/teddy-r"}, "edited": false, "score": 0, "creation_date": 1496954537, "post_id": 44413291, "comment_id": 75887991, "body": "Thanks. I have changed to the getBits() - the bytes are are passed from PC C# to an embedded C terminal using a Mifare 1K RFID card"}], "tags": [], "owner": {"reputation": 284, "user_id": 4870514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MLfLByWAlhI/AAAAAAAAAAI/AAAAAAAAAak/52sdv5JRCzQ/photo.jpg?sz=128", "display_name": "Evgeni Lipatov", "link": "https://stackoverflow.com/users/4870514/evgeni-lipatov"}, "is_accepted": false, "score": 1, "last_activity_date": 1496852594, "last_edit_date": 1496852594, "creation_date": 1496840124, "answer_id": 44413291, "question_id": 44411752, "link": "https://stackoverflow.com/questions/44411752/c-decimal-to-byte-and-back-in-c/44413291#44413291", "title": "C# Decimal to byte[] and back in C", "body": "<p>It is not good idea to rely on internal implementation of <em>System.Decimal</em> as far as it is a subject of change.</p>\n\n<p>It is mach better to use <strong>Decimal.GetBits</strong>(value) that is well documented.</p>\n\n<p>Other question is how are you going to pass you values to unmanaged code. For example, if you are using pInvoke you just pass decimal argument to method and it will be automatically marshaled to native code (if you want specify memory representation you can use [MarshalAs(UnmanagedType.R8)] attribute). </p>\n\n<p>As far as I know, C++ by default does not have decimal type.</p>\n\n<p>However, if you really need memory representation of <em>System.Decimal</em> you can easily obtain it from source code:\n<a href=\"https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Decimal.cs\" rel=\"nofollow noreferrer\">Decimal.cs</a> and <a href=\"https://github.com/dotnet/coreclr/blob/master/src/classlibnative/bcltype/decimal.cpp\" rel=\"nofollow noreferrer\">Decimal.cpp</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7967704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88cfa1dc3928d7d2bcbbcf46d0fb1e4?s=128&d=identicon&r=PG&f=1", "display_name": "Teddy_R", "link": "https://stackoverflow.com/users/7967704/teddy-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3395, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496852594, "creation_date": 1496835957, "question_id": 44411752, "link": "https://stackoverflow.com/questions/44411752/c-decimal-to-byte-and-back-in-c", "title": "C# Decimal to byte[] and back in C", "body": "<p>I have a system that stores a decimal value on a Mifare card</p>\n\n<p>The C# decimal value is converted to a byte array of 16 bytes using this code</p>\n\n<pre><code>MemoryStream memStream = new MemoryStream();\nBinaryWriter writer = new BinaryWriter(memStream);\ntry\n{\n  try\n  {\n     writer.Write(m_Value);\n     tmp = memStream.ToArray();\n  }\n  finally\n  {\n     memStream.Close();\n  }\n}\nfinally\n{\n  writer.Close();\n}\n</code></pre>\n\n<p>which gives a 16byte representation.</p>\n\n<p>Now we have a customer which needs to read and convert these 16 bytes back to a decimal number, <strong>but in C</strong></p>\n\n<p>How is this done ?</p>\n\n<p>Can anyone find a definition/spec of the C# byte representation, i cannot</p>\n"}, {"tags": ["c", "solaris", "kernel-module"], "comments": [{"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1496836837, "post_id": 44411667, "comment_id": 75822927, "body": "Have you looked at getppid()?"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1496838286, "post_id": 44411667, "comment_id": 75824006, "body": "I cant use the fd = open(psfile, O_RDONLY)) &gt;= 0) .. I get message that open is invalid, Is this the proper way ? to open /proc/&quot;getppid()&quot;/psinfo and get the data ? from kernel space also ?"}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1496840149, "post_id": 44411667, "comment_id": 75825403, "body": "Does your program have the permissions to do this? Last I knew, /proc/ was protected."}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1496842234, "post_id": 44411667, "comment_id": 75827083, "body": "I am kernel module, Dont I have permission to do whatever i want ? How do i open  /proc/&quot;getppid()&quot;/psinfo ?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496845977, "post_id": 44411667, "comment_id": 75830128, "body": "To be the kernel, you must have access to all the kernel code.  Suggest researching for where the &#39;/prop/ is updated, then use that same function calls, only setting the &#39;mode&#39; to read rather than write."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1496846124, "post_id": 44411667, "comment_id": 75830250, "body": "for ease of readability and understanding: 1) consistently indent the code.  Indent after every opening brace &#39;{&#39;,  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces.  2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496846234, "post_id": 44411667, "comment_id": 75830356, "body": "the calls to <code>printf()</code> do not work as expected inside the kernel.  Suggest using <code>printk()</code>"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1496846664, "post_id": 44411667, "comment_id": 75830682, "body": "@user3629249 the code i put is for userspace.. thats why the printf, i updated the question.. i need it for kernel space, why from kernel would i go to filesystem to get data that already should exist within kernel."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496847100, "post_id": 44411667, "comment_id": 75831044, "body": "you might want to look into the <code>aio</code> library of functions"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "edited": false, "score": 3, "creation_date": 1496848371, "post_id": 44411667, "comment_id": 75832033, "body": "why, how would aio help me, im in kernel module, i want to get info on a process, without going to filesystem /proc/"}], "answers": [{"comments": [{"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "edited": false, "score": 0, "creation_date": 1496900664, "post_id": 44417914, "comment_id": 75852911, "body": "Thank you this is exactly what i needed, works great. Should i check curproc for null befor eusing ? is it possible to have curproc null value within context of kernel module ??"}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1496901920, "post_id": 44417914, "comment_id": 75853536, "body": "An example of a right way of finding this information would be through getppid in libc and finally getpid in the kernel. Going directly into headers does not show you how the kernel gets the information (perhaps there is more to it than just reading a field). The more important problem though is that you provided this without asking OP what they need this for. The request is odd in both that such traversal is rarely legitimate and if someone really needed to do it, they would be able to find the information on their own."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "edited": false, "score": 0, "creation_date": 1496914176, "post_id": 44417914, "comment_id": 75861141, "body": "@ilansch <i>Should i check curproc for null befor eusing ? is it possible to have curproc null value within context of kernel module ??</i>  I would check it. The posted code is for <i>OpenSolaris</i>, so there could be some differences. Given you&#39;re writing a kernel module where a null pointer dereference crashes the host, the small performance hit is probably worthwhile."}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "edited": false, "score": 0, "creation_date": 1498399402, "post_id": 44417914, "comment_id": 76475054, "body": "What is the field of process start time &quot;p_mstart&quot;  ? Its not equal to the field received from psinfo-&gt;psinfo.pr_start"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1496854390, "last_edit_date": 1496854390, "creation_date": 1496852065, "answer_id": 44417914, "question_id": 44411667, "link": "https://stackoverflow.com/questions/44411667/get-process-id-and-parent-process-in-solaris-kernel-module/44417914#44417914", "title": "get process id and parent process in solaris kernel module", "body": "<p>If you <a href=\"http://src.illumos.org/source/xref/illumos-gate/usr/src/uts/common/sys/thread.h#532\" rel=\"nofollow noreferrer\">look in <code>/usr/include/sys/thread.h</code></a>, you'll see the macro <code>currproc</code> defined:</p>\n\n<pre><code>#define curproc     (ttoproc(curthread))    /* current process pointer */\n</code></pre>\n\n<p>That returns a <code>struct proc *</code> that if non-null refers to the current process.</p>\n\n<p>The definition of <code>struct proc</code> can be <a href=\"http://src.illumos.org/source/xref/illumos-gate/usr/src/uts/common/sys/proc.h#139\" rel=\"nofollow noreferrer\">found in <code>/usr/include/sys/proc.h</code></a>:</p>\n\n<pre><code>/*\n * One structure allocated per active process.  It contains all\n * data needed about the process while the process may be swapped\n * out.  Other per-process data (user.h) is also inside the proc structure.\n * Lightweight-process data (lwp.h) and the kernel stack may be swapped out.\n */\ntypedef struct  proc {\n    /*\n     * Fields requiring no explicit locking\n     */\n    struct  vnode *p_exec;      /* pointer to a.out vnode */\n    struct  as *p_as;       /* process address space pointer */\n    struct  plock *p_lockp;     /* ptr to proc struct's mutex lock */\n    kmutex_t p_crlock;      /* lock for p_cred */\n    struct  cred    *p_cred;    /* process credentials */\n    /*\n     * Fields protected by pidlock\n     */\n    int p_swapcnt;      /* number of swapped out lwps */\n    char    p_stat;         /* status of process */\n    char    p_wcode;        /* current wait code */\n    ushort_t p_pidflag;     /* flags protected only by pidlock */\n    int     p_wdata;        /* current wait return value */\n    pid_t   p_ppid;         /* process id of parent */\n    struct  proc    *p_link;    /* forward link */\n    struct  proc    *p_parent;  /* ptr to parent process */\n    struct  proc    *p_child;   /* ptr to first child process */\n    struct  proc    *p_sibling; /* ptr to next sibling proc on chain */\n    struct  proc    *p_psibling;    /* ptr to prev sibling proc on chain */\n    struct  proc    *p_sibling_ns;  /* prt to siblings with new state */\n    struct  proc    *p_child_ns;    /* prt to children with new state */\n    struct  proc    *p_next;    /* active chain link next */\n    struct  proc    *p_prev;    /* active chain link prev */\n    struct  proc    *p_nextofkin;   /* gets accounting info at exit */\n    struct  proc    *p_orphan;\n    struct  proc    *p_nextorph;\n    struct  proc    *p_pglink;  /* process group hash chain link next */\n    struct  proc    *p_ppglink; /* process group hash chain link prev */\n    struct  sess    *p_sessp;   /* session information */\n    struct  pid     *p_pidp;    /* process ID info */\n    struct  pid     *p_pgidp;   /* process group ID info */\n    /*\n     * Fields protected by p_lock\n     */\n    kcondvar_t p_cv;        /* proc struct's condition variable */\n    kcondvar_t p_flag_cv;\n    kcondvar_t p_lwpexit;       /* waiting for some lwp to exit */\n    kcondvar_t p_holdlwps;      /* process is waiting for its lwps */\n                    /* to to be held.  */\n    uint_t  p_proc_flag;        /* /proc-related flags */\n    uint_t  p_flag;         /* protected while set. */\n                    /* flags defined below */\n    clock_t p_utime;        /* user time, this process */\n    clock_t p_stime;        /* system time, this process */\n    clock_t p_cutime;       /* sum of children's user time */\n    clock_t p_cstime;       /* sum of children's system time */\n    avl_tree_t *p_segacct;      /* System V shared segment list */\n    avl_tree_t *p_semacct;      /* System V semaphore undo list */\n    caddr_t p_bssbase;      /* base addr of last bss below heap */\n    caddr_t p_brkbase;      /* base addr of heap */\n    size_t  p_brksize;      /* heap size in bytes */\n    uint_t  p_brkpageszc;       /* preferred heap max page size code */\n    /*\n     * Per process signal stuff.\n     */\n    k_sigset_t p_sig;       /* signals pending to this process */\n    k_sigset_t p_extsig;        /* signals sent from another contract */\n    k_sigset_t p_ignore;        /* ignore when generated */\n    k_sigset_t p_siginfo;       /* gets signal info with signal */\n    void *p_sigfd;          /* signalfd support state */\n    struct sigqueue *p_sigqueue;    /* queued siginfo structures */\n    struct sigqhdr *p_sigqhdr;  /* hdr to sigqueue structure pool */\n    struct sigqhdr *p_signhdr;  /* hdr to signotify structure pool */\n    uchar_t p_stopsig;      /* jobcontrol stop signal */\n\n    /*\n     * Special per-process flag when set will fix misaligned memory\n     * references.\n     */\n    char    p_fixalignment;\n\n    /*\n     * Per process lwp and kernel thread stuff\n     */\n    id_t    p_lwpid;        /* most recently allocated lwpid */\n    int     p_lwpcnt;       /* number of lwps in this process */\n    int p_lwprcnt;      /* number of not stopped lwps */\n    int p_lwpdaemon;        /* number of TP_DAEMON lwps */\n    int p_lwpwait;      /* number of lwps in lwp_wait() */\n    int p_lwpdwait;     /* number of daemons in lwp_wait() */\n    int p_zombcnt;      /* number of zombie lwps */\n    kthread_t *p_tlist;     /* circular list of threads */\n    lwpdir_t *p_lwpdir;     /* thread (lwp) directory */\n    lwpdir_t *p_lwpfree;        /* p_lwpdir free list */\n    tidhash_t *p_tidhash;       /* tid (lwpid) lookup hash table */\n    uint_t  p_lwpdir_sz;        /* number of p_lwpdir[] entries */\n    uint_t  p_tidhash_sz;       /* number of p_tidhash[] entries */\n    ret_tidhash_t *p_ret_tidhash;   /* retired tidhash hash tables */\n    uint64_t p_lgrpset;     /* unprotected hint of set of lgrps */\n                    /* on which process has threads */\n    volatile lgrp_id_t  p_t1_lgrpid; /* main's thread lgroup id */\n    volatile lgrp_id_t  p_tr_lgrpid; /* text replica's lgroup id */\n#if defined(_LP64)\n    uintptr_t  p_lgrpres2;      /* reserved for lgrp migration */\n#endif\n    /*\n     * /proc (process filesystem) debugger interface stuff.\n     */\n    k_sigset_t p_sigmask;       /* mask of traced signals (/proc) */\n    k_fltset_t p_fltmask;       /* mask of traced faults (/proc) */\n    struct vnode *p_trace;      /* pointer to primary /proc vnode */\n    struct vnode *p_plist;      /* list of /proc vnodes for process */\n    kthread_t *p_agenttp;       /* thread ptr for /proc agent lwp */\n    avl_tree_t p_warea;     /* list of watched areas */\n    avl_tree_t p_wpage;     /* remembered watched pages (vfork) */\n    watched_page_t *p_wprot;    /* pages that need to have prot set */\n    int p_mapcnt;       /* number of active pr_mappage()s */\n    kmutex_t p_maplock;     /* lock for pr_mappage() */\n    struct  proc  *p_rlink;     /* linked list for server */\n    kcondvar_t p_srwchan_cv;\n    size_t  p_stksize;      /* process stack size in bytes */\n    uint_t  p_stkpageszc;       /* preferred stack max page size code */\n\n    /*\n     * Microstate accounting, resource usage, and real-time profiling\n     */\n    hrtime_t p_mstart;      /* hi-res process start time */\n    hrtime_t p_mterm;       /* hi-res process termination time */\n    hrtime_t p_mlreal;      /* elapsed time sum over defunct lwps */\n    hrtime_t p_acct[NMSTATES];  /* microstate sum over defunct lwps */\n    hrtime_t p_cacct[NMSTATES]; /* microstate sum over child procs */\n    struct lrusage p_ru;        /* lrusage sum over defunct lwps */\n    struct lrusage p_cru;       /* lrusage sum over child procs */\n    struct itimerval p_rprof_timer; /* ITIMER_REALPROF interval timer */\n    uintptr_t p_rprof_cyclic;   /* ITIMER_REALPROF cyclic */\n    uint_t  p_defunct;      /* number of defunct lwps */\n    /*\n     * profiling. A lock is used in the event of multiple lwp's\n     * using the same profiling base/size.\n     */\n    kmutex_t p_pflock;      /* protects user profile arguments */\n    struct prof p_prof;     /* profile arguments */\n\n    /*\n     * Doors.\n     */\n    door_pool_t     p_server_threads; /* common thread pool */\n    struct door_node    *p_door_list;   /* active doors */\n    struct door_node    *p_unref_list;\n    kcondvar_t      p_unref_cv;\n    char            p_unref_thread; /* unref thread created */\n\n    /*\n     * Kernel probes\n     */\n    uchar_t         p_tnf_flags;\n\n    /*\n     * Solaris Audit\n     */\n    struct p_audit_data *p_audit_data; /* per process audit structure */\n\n    pctxop_t    *p_pctx;\n\n#if defined(__x86)\n    /*\n     * LDT support.\n     */\n    kmutex_t    p_ldtlock;  /* protects the following fields */\n    user_desc_t *p_ldt;     /* Pointer to private LDT */\n    system_desc_t   p_ldt_desc; /* segment descriptor for private LDT */\n    ushort_t    p_ldtlimit; /* highest selector used */\n#endif\n    size_t p_swrss;         /* resident set size before last swap */\n    struct aio  *p_aio;     /* pointer to async I/O struct */\n    struct itimer   **p_itimer; /* interval timers */\n    timeout_id_t    p_alarmid;  /* alarm's timeout id */\n    caddr_t     p_usrstack; /* top of the process stack */\n    uint_t      p_stkprot;  /* stack memory protection */\n    uint_t      p_datprot;  /* data memory protection */\n    model_t     p_model;    /* data model determined at exec time */\n    struct lwpchan_data *p_lcp; /* lwpchan cache */\n    kmutex_t    p_lcp_lock; /* protects assignments to p_lcp */\n    utrap_handler_t *p_utraps;  /* pointer to user trap handlers */\n    struct corectl_path *p_corefile;    /* pattern for core file */\n    struct task *p_task;    /* our containing task */\n    struct proc *p_taskprev;    /* ptr to previous process in task */\n    struct proc *p_tasknext;    /* ptr to next process in task */\n    kmutex_t    p_sc_lock;  /* protects p_pagep */\n    struct sc_page_ctl *p_pagep;    /* list of process's shared pages */\n    struct rctl_set *p_rctls;   /* resource controls for this process */\n    rlim64_t    p_stk_ctl;  /* currently enforced stack size */\n    rlim64_t    p_fsz_ctl;  /* currently enforced file size */\n    rlim64_t    p_vmem_ctl; /* currently enforced addr-space size */\n    rlim64_t    p_fno_ctl;  /* currently enforced file-desc limit */\n    pid_t       p_ancpid;   /* ancestor pid, used by exacct */\n    struct itimerval p_realitimer;  /* real interval timer */\n    timeout_id_t    p_itimerid; /* real interval timer's timeout id */\n    struct corectl_content *p_content;  /* content of core file */\n\n    avl_tree_t  p_ct_held;  /* held contracts */\n    struct ct_equeue **p_ct_equeue; /* process-type event queues */\n\n    struct cont_process *p_ct_process; /* process contract */\n    list_node_t p_ct_member;    /* process contract membership */\n    sigqueue_t  *p_killsqp; /* sigqueue pointer for SIGKILL */\n\n    int     p_dtrace_probes; /* are there probes for this proc? */\n    uint64_t    p_dtrace_count; /* number of DTrace tracepoints */\n                    /* (protected by P_PR_LOCK) */\n    void        *p_dtrace_helpers; /* DTrace helpers, if any */\n    struct pool *p_pool;    /* pointer to containing pool */\n    kcondvar_t  p_poolcv;   /* synchronization with pools */\n    uint_t      p_poolcnt;  /* # threads inside pool barrier */\n    uint_t      p_poolflag; /* pool-related flags (see below) */\n    uintptr_t   p_portcnt;  /* event ports counter */\n    struct zone *p_zone;    /* zone in which process lives */\n    struct vnode    *p_execdir; /* directory that p_exec came from */\n    struct brand    *p_brand;   /* process's brand  */\n    void        *p_brand_data;  /* per-process brand state */\n    psecflags_t p_secflags; /* per-process security flags */\n\n    /* additional lock to protect p_sessp (but not its contents) */\n    kmutex_t p_splock;\n    rctl_qty_t  p_locked_mem;   /* locked memory charged to proc */\n                    /* protected by p_lock */\n    rctl_qty_t  p_crypto_mem;   /* /dev/crypto memory charged to proc */\n                    /* protected by p_lock */\n    clock_t p_ttime;        /* buffered task time */\n\n    /*\n     * The user structure\n     */\n    struct user p_user;     /* (see sys/user.h) */\n} proc_t;\n</code></pre>\n\n<p>So your current process id is <code>curproc-&gt;p_pidp-&gt;pid_id</code> and the parent process id is <code>curproc-&gt;p_ppid</code>.</p>\n"}], "owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "accepted_answer_id": 44417914, "answer_count": 1, "score": 0, "last_activity_date": 1497043296, "creation_date": 1496835734, "last_edit_date": 1496862065, "question_id": 44411667, "link": "https://stackoverflow.com/questions/44411667/get-process-id-and-parent-process-in-solaris-kernel-module", "title": "get process id and parent process in solaris kernel module", "body": "<p>In solaris 11.0 kernel module driver, I need to get the parent process id and start time, and continue doing it - climb up the process tree this way.  </p>\n\n<p>in Linux kernel I have struct_task contains process id, start time.<br>\nWhat is equivelant to struct_task, and how I can get it within process context ?</p>\n\n<p>Thanks</p>\n\n<p>I saw something like what i need but for <strong>userspace</strong>. but \"open\" cannot be used in kernel space..  </p>\n\n<pre><code>char psfile[64];\npid_t pid;\nint fd;\npsinfo_t psinfo;\npid = getpid();\nsprintf(psfile, \"/proc/%d/psinfo\", pid);\nif ((fd = open(psfile, O_RDONLY)) &gt;= 0) {\nif (read(fd, &amp;psinfo, sizeof(psinfo_t)) != -1) {\nprintf(\"Pid: %ld\\n\", psinfo.pr_pid);\nprintf(\"Up Start: (%ld, %ld)\\n\", psinfo.pr_start.tv_sec,  \npsinfo.pr_start.tv_nsec);\nprintf(\"Command: %s\\n\", psinfo.pr_fname);\nreturn 0;\n}\n} else {\nperror(\"Open psfino\");\n}\n</code></pre>\n\n<p>the whole concept of /proc/procid/psinfo is to allow userspace processes to read kernel data. Since im at kernel space, i need to get the data from /proc/procid/psinfo if im on kernel space, this is disk IO i avoid...</p>\n"}, {"tags": ["c", "mpi", "distributed-computing", "mpich", "leader"], "comments": [{"owner": {"reputation": 634, "user_id": 8016390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb8a7992f3527dc9d50d8ff87de9dc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Gam", "link": "https://stackoverflow.com/users/8016390/gam"}, "edited": false, "score": 1, "creation_date": 1496836903, "post_id": 44411539, "comment_id": 75822988, "body": "If you can&#39;t go out of the while loop, it means that you never go into the second if( ).  So you need to understand why."}, {"owner": {"reputation": 64, "user_id": 5009309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206530498248457/picture?type=large", "display_name": "quelotic", "link": "https://stackoverflow.com/users/5009309/quelotic"}, "reply_to_user": {"reputation": 634, "user_id": 8016390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb8a7992f3527dc9d50d8ff87de9dc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Gam", "link": "https://stackoverflow.com/users/8016390/gam"}, "edited": false, "score": 0, "creation_date": 1496838148, "post_id": 44411539, "comment_id": 75823886, "body": "it seems curious to me, the counter and incoming[1] are being incremented without a stop. Why is that when theoretically there should be a continuation on the commands executed by each node? Shouldn&#39;t the counter=counter+1 command be executed for each node, after the node received a message?"}, {"owner": {"reputation": 1617, "user_id": 5502860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c80cca7f2c363c796f87cfb054b99327?s=128&d=identicon&r=PG&f=1", "display_name": "stas.yaranov", "link": "https://stackoverflow.com/users/5502860/stas-yaranov"}, "edited": false, "score": 1, "creation_date": 1496844890, "post_id": 44411539, "comment_id": 75829216, "body": "Hey, your <code>(world_rank-1)</code> for <code>MPI_Recv</code> looks not very good. Think about root with <code>rank=0</code>."}, {"owner": {"reputation": 64, "user_id": 5009309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206530498248457/picture?type=large", "display_name": "quelotic", "link": "https://stackoverflow.com/users/5009309/quelotic"}, "edited": false, "score": 0, "creation_date": 1496846316, "post_id": 44411539, "comment_id": 75830419, "body": "Thanks! That was the problem, I split the receive into 2 ifs and it&#39;s working!"}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 5009309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206530498248457/picture?type=large", "display_name": "quelotic", "link": "https://stackoverflow.com/users/5009309/quelotic"}, "edited": false, "score": 0, "creation_date": 1496845362, "post_id": 44415200, "comment_id": 75829587, "body": "I split the receive into 2 ifs. It&#39;s working beautifully... Thanks!"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 64, "user_id": 5009309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206530498248457/picture?type=large", "display_name": "quelotic", "link": "https://stackoverflow.com/users/5009309/quelotic"}, "edited": false, "score": 0, "creation_date": 1496846746, "post_id": 44415200, "comment_id": 75830756, "body": "Your program is still incorrect! Do not rely on the nonblocking behavior that <code>MPI_Send</code> sometimes exhibits. Use <code>MPI_Sendrecv</code> for a portable conforming program."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 1, "last_activity_date": 1496844933, "creation_date": 1496844933, "answer_id": 44415200, "question_id": 44411539, "link": "https://stackoverflow.com/questions/44411539/mpi-ring-leader-election-returns-segmentation-fault/44415200#44415200", "title": "MPI Ring Leader Election returns segmentation fault", "body": "<p>In order to determine some minimum number among a number of ranks for all ranks, use <code>MPI_Allreduce</code>!</p>\n\n<ul>\n<li><code>MPI_Send</code> is blocking. It can block forever until a matching receive is posted. Your program deadlocks on the first call to MPI_Send - and any successive once should it complete by coincidence. To avoid that specifically use <code>MPI_Sendrecv</code>.</li>\n<li><code>(world_rank-1)%world_size</code> will produce <code>-1</code> for <code>world_rank == 0</code>. Using <code>-1</code> as rank number is not valid. It might coincidentially be <code>MPI_ANY_SOURCE</code>.</li>\n</ul>\n"}], "owner": {"reputation": 64, "user_id": 5009309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206530498248457/picture?type=large", "display_name": "quelotic", "link": "https://stackoverflow.com/users/5009309/quelotic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "accepted_answer_id": 44415200, "answer_count": 1, "score": 1, "last_activity_date": 1496845464, "creation_date": 1496835361, "last_edit_date": 1496845464, "question_id": 44411539, "link": "https://stackoverflow.com/questions/44411539/mpi-ring-leader-election-returns-segmentation-fault", "title": "MPI Ring Leader Election returns segmentation fault", "body": "<p>This is what I am trying to achieve.</p>\n\n<pre><code>Blue is the message.\nYellow is when the specific node changes the leader known to it.\nGreen is the final election of each node.\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eBG7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eBG7a.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code seems correct to me but it's always stuck inside the while loop no matter what I tried. For a small number of nodes during runtime it returns a segmentation fault after a while.</p>\n\n<pre><code>election_status=0;\nfirstmsg[0]=world_rank;     // self rank\nfirstmsg[1]=0;              // counter for hops\nchief=world_rank;           // each node declares himself as leader\ncounter=0;                  // message counter for each node\n\n// each node sends the first message to the next one\nMPI_Send(&amp;firstmsg, 2, MPI_INT, (world_rank+1)%world_size, 1, MPI_COMM_WORLD);\nprintf(\"Sent ID with counter to the right node [%d -&gt; %d]\\n\",world_rank, (world_rank+1)%world_size);\n\nwhile (election_status==0){\n    // EDIT: Split MPI_Recv for rank 0 and rest\n    if (world_rank==0){\n        MPI_Recv(&amp;incoming, 2, MPI_INT, world_size-1, 1, MPI_COMM_WORLD, &amp;status);\n    }\n    else {\n        MPI_Recv(&amp;incoming, 2, MPI_INT, (world_rank-1)%world_size, 1, MPI_COMM_WORLD, &amp;status);\n    }\n    counter=counter+1;\n    if (incoming[0]&lt;chief){\n        chief=incoming[0];\n    }\n    incoming[1]=incoming[1]+1;\n\n    // if message is my own and hopped same times as counter\n    if (incoming[0]==world_rank &amp;&amp; incoming[1]==counter) {\n        printf(\"Node %d declares node %d a leader.\\n\", world_rank, chief);  \n        election_status=1;\n    }\n    //sends the incremented message to the next node\n    MPI_Send(&amp;incoming, 2, MPI_INT, (world_rank+1)%world_size, 1, MPI_COMM_WORLD);  \n}\n\nMPI_Finalize();\n</code></pre>\n"}, {"tags": ["c", "arrays", "subset"], "comments": [{"owner": {"reputation": 3603, "user_id": 5156054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/AXyaZ.jpg?s=128&g=1", "display_name": "Mozahler", "link": "https://stackoverflow.com/users/5156054/mozahler"}, "edited": false, "score": 0, "creation_date": 1496835232, "post_id": 44411468, "comment_id": 75821695, "body": "Are you asking us if it possible? Or whether we can write it for you?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496835273, "post_id": 44411468, "comment_id": 75821731, "body": "Google &quot;permutations&quot;."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496835338, "post_id": 44411468, "comment_id": 75821774, "body": "For the specified input, what is you <i>actual</i> output? Have you tried stepping through the code in a debugger to see that it behaves as it should? Have you tried explaining the code to your <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck</a>? Have you tried to solve it on paper first before you started programming?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1496848458, "post_id": 44411468, "comment_id": 75832100, "body": "Shouldn&#39;t the power set also include the empty set?"}, {"owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1496899333, "post_id": 44411468, "comment_id": 75852324, "body": "No there is no need of empty set @IanAbbott"}, {"owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "reply_to_user": {"reputation": 3603, "user_id": 5156054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/AXyaZ.jpg?s=128&g=1", "display_name": "Mozahler", "link": "https://stackoverflow.com/users/5156054/mozahler"}, "edited": false, "score": 0, "creation_date": 1496899377, "post_id": 44411468, "comment_id": 75852343, "body": "I&#39;am asking whether it is possible or not @Mozahler"}, {"owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "edited": false, "score": 0, "creation_date": 1496900966, "post_id": 44411468, "comment_id": 75853041, "body": "I&#39;ve tried the program already it gives the same output as i mentioned in the question.I&#39;am asking whether there is another method for this question other than the program mentioned in my question.@Someprogrammerdude"}, {"owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "edited": false, "score": 0, "creation_date": 1496901271, "post_id": 44411468, "comment_id": 75853187, "body": "I&#39;ve tried but all the programs in the search are for getting the contiguous sub array.@Lundin"}], "answers": [{"tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": true, "score": 0, "last_activity_date": 1496836877, "last_edit_date": 1592644375, "creation_date": 1496836877, "answer_id": 44412095, "question_id": 44411468, "link": "https://stackoverflow.com/questions/44411468/how-to-get-all-possible-subsets-of-a-set/44412095#44412095", "title": "How to get all possible subsets of a set", "body": "<h3>Disclaimer: the following is intended for showing the concept of generating the powerset of a set.</h3>\n<ul>\n<li>starts with the empty set and add it to the powerset <code>sets</code>:</li>\n<li>for each element <code>el[i]</code>  of your set <code>el</code>\n<ul>\n<li>for each subset <code>add</code> already present in <code>sets</code>\n<ul>\n<li>augment <code>add</code> by pushing_back <code>el[i]</code> to it</li>\n<li>push the augmented set to <code>sets</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Here is a proof of concept in <code>c++</code></p>\n<pre><code>void generateSubset(vector&lt;int&gt;&amp; el) {\n    vector&lt;vector&lt;int&gt;&gt; sets;\n    sets.push_back(vector&lt;int&gt;());\n    for (int i = 0; i &lt; el.size() ; i++) {\n        vector&lt;vector&lt;int&gt;&gt; ssets;\n        for (int j = 0 ; j &lt; sets.size() ; j++ ) {\n            vector&lt;int&gt; add(sets[j]);\n            add.push_back(el[i]);\n            ssets.push_back(add);\n        }\n        sets.insert(sets.end(), begin(ssets), end(ssets));\n    }\n    \n//print the subsets\n    for (int j = 0 ; j &lt; sets.size() ; j++ ) {\n        auto v = sets[j];\n        for (auto a : v) {\n            cout &lt;&lt; a &lt;&lt; &quot; &quot;;\n        }\n        cout &lt;&lt; endl;\n    }\n    cout &lt;&lt; &quot;#subsets &quot;&lt;&lt;sets.size() &lt;&lt; endl;\n}\n\n\n\nint main() {\n    vector&lt;int&gt; a = {1, 2, 3};\n    generateSubset(a);\n}\n</code></pre>\n<p>Hope this helps understanding how to generate the powerset.</p>\n"}], "owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 44412095, "answer_count": 1, "score": -1, "last_activity_date": 1496845358, "creation_date": 1496835132, "last_edit_date": 1496845358, "question_id": 44411468, "link": "https://stackoverflow.com/questions/44411468/how-to-get-all-possible-subsets-of-a-set", "title": "How to get all possible subsets of a set", "body": "<p>Can someone explain to me how to generate all subsets of a set using an algorithm which has complexity lower or equal to the following?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid printPowerSet(char *set, int set_size)\n{\n    /*set_size of power set of a set with set_size\n      n is (2**n -1)*/\n    unsigned int pow_set_size = pow(2, set_size);\n    int counter, j;\n\n    /*Run from counter 000..0 to 111..1*/\n    for(counter = 0; counter &lt; pow_set_size; counter++)\n    {\n      for(j = 0; j &lt; set_size; j++)\n       {\n          /* Check if jth bit in the counter is set\n             If set then pront jth element from set */\n          if(counter &amp; (1&lt;&lt;j))\n            printf(\"%c\", set[j]);\n       }\n       printf(\"\\n\");\n    }\n}\n\n/*Driver program to test printPowerSet*/\nint main()\n{\n    char set[] = {'a','b','c'};\n    printPowerSet(set, 3);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>For example if my input is </p>\n\n<pre><code>3\n2 3 4 \n</code></pre>\n\n<p>I should get my output as </p>\n\n<pre><code>{2} {3} {4} {2,3} {2,4} {3,4} {2,3,4}\n</code></pre>\n"}, {"tags": ["c", "loops", "while-loop", "scanf"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1496831356, "post_id": 44410075, "comment_id": 75818927, "body": "We should have some <i>beginners guide away from <code>scanf()</code></i>. For starters, the <code>s</code> is wrong, because <code>[]</code> is already a conversion and <code>scanf()</code> would look for a literal <code>s</code> after it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496831389, "post_id": 44410075, "comment_id": 75818952, "body": "Then, when you fixed that, you&#39;ll have to deal with the newline character that&#39;s left after the first <code>scanf()</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496831395, "post_id": 44410075, "comment_id": 75818958, "body": "at 2nd time reject newline in <code>scanf(&quot;%[^\\n]s&quot;, s)</code> After that the same."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496831408, "post_id": 44410075, "comment_id": 75818974, "body": "For reading whole lines, just use <code>fgets()</code> and avoid all <code>scanf()</code>-trouble. (<b>including</b> buffer overflows -- they can be avoided with <code>scanf()</code> as well of course)"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "edited": false, "score": 1, "creation_date": 1496833850, "post_id": 44410869, "comment_id": 75820682, "body": "And if you use &quot;scanf(&quot;%[^\\r\\n]s&quot;, s);&quot;  the scanf also can stop from the infinity loop, but you cannot input any more."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1496833957, "post_id": 44410869, "comment_id": 75820762, "body": "This is completely wrong. Note the <code>\\n</code> is the newline character <b>in C</b> and when reading in text mode, any platform-specific newline is translated to just <code>\\n</code>. Also note the windows newline is <code>\\r\\n</code>, not <code>\\n\\r</code>. And it goes on: <code>%[^\\n]</code> doesn&#39;t match newline, it matches <i>anything <b>but</b> newline</i>"}, {"owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "edited": false, "score": 0, "creation_date": 1496834240, "post_id": 44410869, "comment_id": 75820971, "body": "I am not sure now , I have try to use this scanf: &quot;scanf(&quot;% [^\\n]s&quot;, s);&quot; (has s space at the beginning) and the result like the same with &quot;scanf(&quot;%[^\\r\\n]s&quot;, s);&quot; it&#39;s can stop the loop, but cannot input any more."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496834454, "post_id": 44410869, "comment_id": 75821129, "body": "<code>&quot;% [^\\n]s&quot;</code> --&gt; <code>&quot; %[^\\n]&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1496835698, "post_id": 44410869, "comment_id": 75822040, "body": "@Jimmy: Not my downvote, but trust me, your answer is wrong, please see mine for an explanation."}], "tags": [], "owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "is_accepted": false, "score": -1, "last_activity_date": 1496833396, "creation_date": 1496833396, "answer_id": 44410869, "question_id": 44410075, "link": "https://stackoverflow.com/questions/44410075/why-this-c-program-fall-into-infinity-loop/44410869#44410869", "title": "Why this c program fall into infinity loop?", "body": "<pre><code>int main()\n{\n    int sum = 0;\n    char s[10];\n\n    int ret = scanf(\"%[^\\n]s\", s);\n    while (ret != EOF)\n    {\n        printf(\"%s\", s);\n        memset(s,0,10);\n        ret = scanf(\"%[^\\n]s\", s);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>with the debug, you can see the second ret value in the while block is 0, that's , and not equal EOF, so infinity loop.</p>\n\n<p><strong>man scanf:</strong></p>\n\n<p>RETURN VALUE</p>\n\n<p>Upon  successful  completion,  these  functions  shall  return the number of successfully matched and assigned input items; this number can be zero in the event of an early matching failure. </p>\n\n<p>That mean the other scanf is matching failure, except the first one.</p>\n\n<p>But why?</p>\n\n<p>The stdio has cache, and the matching only read \"\\n\" from the stdin, but when you input the \"Enter\", it input \"\\n\\r\", so, the \"\\r\" will in the stdin cache and become the input value for other scanf, but cannot match the input, so matching failure. And scanf return 0, and goto infinity loop.</p>\n\n<p>But if you only input \"\\n\" for each input, it's OK!</p>\n\n<p>You can press \"Alt\" and at same time press \"0\" + \"1\" + \"0\", and the release the \"Alt\", the console will input \"\\n\" only and you will get the right result , and the program will be OK, not into infinity loop!</p>\n\n<p>And this's my test result:<a href=\"https://i.stack.imgur.com/Yxduw.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1496835686, "post_id": 44411404, "comment_id": 75822031, "body": "Best, as you say, is to use <code>fgets()</code>. Second best, using <code>scanf()</code> is to compare the return value against the number of expected assignments, not <code>EOF</code>: <code>while (scanf(&quot; %9[^\\n]&quot;, s) == 1) { &#47;* ... *&#47; }</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 6, "last_activity_date": 1496836009, "last_edit_date": 1496836009, "creation_date": 1496834897, "answer_id": 44411404, "question_id": 44410075, "link": "https://stackoverflow.com/questions/44410075/why-this-c-program-fall-into-infinity-loop/44411404#44411404", "title": "Why this c program fall into infinity loop?", "body": "<p>Given</p>\n\n<pre><code>while(scanf(\"%[^\\n]s\", s)!=EOF)\n{\n   printf(\"%s\", s);\n}\n</code></pre>\n\n<p>you ask <em>\"Why this c program fall into infinity loop?\"</em></p>\n\n<p>Therefore, you have to understand how <code>scanf()</code> works. <code>scanf()</code> uses your format string to parse input from <code>stdin</code>, which is a <em>stream that delivers character by character</em>.</p>\n\n<p>Assume you have the following in <code>stdin</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>foo\\n\nbar\\n\n&lt;&lt;EOF&gt;&gt;\n</code></pre>\n\n<p>Now your format string has this conversion <code>%[^\\n]</code> which means \"match anything but newline and copy into a char buffer\". The <code>s</code> following it is just a literal <code>s</code> because it doesn't have a <code>%</code> in front of it ... so it would match a literal <code>s</code> if there was one. In other words, it doesn't matter here.</p>\n\n<p>Now, calling your <code>scanf()</code> the first time, it WILL match <code>foo</code> and consume it. it returns <code>1</code> because it matched one element. After that, <code>stdin</code> looks like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\\n\nbar\\n\n&lt;&lt;EOF&gt;&gt;\n</code></pre>\n\n<p>Note the unmatched newline <strong>is still there</strong>. Your next call again starts with a format string to match <em>anything but newline</em>, but the next character is a newline. <code>scanf()</code> matches nothing and therefore returns <code>0</code>. It cannot return <code>EOF</code> because, as you can see, <code>EOF</code> is not reached yet. Here is your infinite loop.</p>\n\n<p>So, you have to fix your format string. First, remove the <code>s</code> that never matches anything. It doesn't really hurt here, but it's still wrong. Then, you can take advantage of the <em>whitespace matching</em> of <code>scanf()</code>. Whitespace is either <em>space</em>, <em>tab</em> or <em>newline</em>. If your format string contains whitespace, <code>scanf()</code> will match <em>as much whitespace as is there</em> (this can be none as well). Therefore, an easy fix would be to just start your format string with a space, this will \"eat\" the left-over newline:</p>\n\n<pre><code>while(scanf(\" %[^\\n]\", s)!=EOF)\n{\n   printf(\"%s\", s);\n}\n</code></pre>\n\n<p>Now this is still <strong>dangerous</strong> code, because <code>[^\\n]</code> matches any amount of characters as long as there is no newline, but your buffer has only room for 9 character plus terminating <code>0</code>. So you MUST tell <code>scanf()</code> not to match more than that limit, and this can be done by putting the number between the <code>%</code> and the conversion specification:</p>\n\n<pre><code>while(scanf(\" %9[^\\n]\", s)!=EOF)\n{\n   printf(\"%s\", s);\n}\n</code></pre>\n\n<p>This code will do what you want in a safe manner, but assume you wanted to match something more specific, e.g. numbers, and you get some unexpected input: By waiting for <code>EOF</code>, you'd have your infinite loop again, because there is input that doesn't match, and so you can never reach <code>EOF</code> (as above with the unmatched newline). Therefore, always check for the number of successful matches instead. Here you expect exactly one match, so the loop should look like this:</p>\n\n<pre><code>while (scanf(\" %9[^\\n]\", s) == 1)\n{\n   printf(\"%s\", s);\n}\n</code></pre>\n\n<hr>\n\n<p>In practice, for reading whole lines, you don't need <code>scanf()</code>, just using <code>fgets()</code> would be easier. Your code could look as simple as this (the newlines will be read into <code>s</code> as well):</p>\n\n<pre><code>while (fgets(s, 10, stdin))\n{\n    printf(\"%s\", s);\n}\n</code></pre>\n\n<p>Note the second parameter <code>10</code> here: <code>fgets()</code> automatically accounts for the terminating <code>0</code> character, so you just give it the size of your buffer.</p>\n\n<p>Just a final hint: this could be <em>even simpler</em> without using <code>printf()</code> when there's no formatting to do:</p>\n\n<pre><code>while (fgets(s, 10, stdin))\n{\n    fputs(s, stdout);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8107210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da5feda0340a124ca340131b42c5263?s=128&d=identicon&r=PG&f=1", "display_name": "Aziz Ahmed", "link": "https://stackoverflow.com/users/8107210/aziz-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 44411404, "answer_count": 2, "score": 1, "last_activity_date": 1496836009, "creation_date": 1496831259, "question_id": 44410075, "link": "https://stackoverflow.com/questions/44410075/why-this-c-program-fall-into-infinity-loop", "title": "Why this c program fall into infinity loop?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  int sum=0;\n  char s[10];\n\n  while(scanf(\"%[^\\n]s\", s)!=EOF)\n  {\n    printf(\"%s\", s);\n\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>This while loop fall into infinity loop for any string input.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 1, "creation_date": 1496830350, "post_id": 44409576, "comment_id": 75818209, "body": "put an <code>else { nlines = 0; }</code> to reset the counter."}, {"owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "edited": false, "score": 0, "creation_date": 1496831096, "post_id": 44409576, "comment_id": 75818750, "body": "the same logic with this question: <a href=\"https://stackoverflow.com/questions/44402182/why-isnt-this-code-compressing-spaces-correctly/44402251#44402251\" title=\"why isnt this code compressing spaces correctly\">stackoverflow.com/questions/44402182/&hellip;</a>"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1496831620, "post_id": 44409576, "comment_id": 75819123, "body": "<code>c = &#39;\\n&#39;;</code> is absolutely in vain if <code>c == &#39;\\n&#39;</code> applies already..."}, {"owner": {"reputation": 11, "user_id": 7571937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b62952a14e092bd33d99ad225c2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "dyingStudent", "link": "https://stackoverflow.com/users/7571937/dyingstudent"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1496832186, "post_id": 44409576, "comment_id": 75819531, "body": "@Shiva \tno it still doesn&#39;t work. but thanks for answering"}, {"owner": {"reputation": 11, "user_id": 7571937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b62952a14e092bd33d99ad225c2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "dyingStudent", "link": "https://stackoverflow.com/users/7571937/dyingstudent"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1496832237, "post_id": 44409576, "comment_id": 75819567, "body": "@Aconcagua I just want to set it to only one new blank line. It doesn&#39;t matter if there&#39;s already a blank line."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1496990542, "post_id": 44409576, "comment_id": 75898730, "body": "@dyingStudent Your new code should remove <i>all</i> blank lines. If you want to leave one, you should try <code>if(nlines &gt; 1)</code>, because you need one, of course, for the single remaining empty line, but <i>another</i> one for the preceding non-empty one. That&#39;s why I needed NL1 and NL2 states in my solution, too..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1496991025, "post_id": 44409576, "comment_id": 75899009, "body": "By the way: Do you want to consider whitespace only lines as blank lines, too, or not? Do you want to entirely remove leading/trailing whitespace?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1496830727, "creation_date": 1496830727, "answer_id": 44409865, "question_id": 44409576, "link": "https://stackoverflow.com/questions/44409576/multiple-blank-lines-are-not-squeezed-in-one-blank-linec-using-i-o-redirection/44409865#44409865", "title": "Multiple blank lines are not squeezed in one blank line(C) using I/O redirection", "body": "<p>To dissect this:</p>\n\n<pre><code>if(c == '\\n') {\n        nlines++;\n</code></pre>\n\n<p>is <code>nlines</code> ever reset to zero?</p>\n\n<pre><code>        if(nlines &gt; 1){\n            c = '\\n';\n</code></pre>\n\n<p>And what happens on the third <code>\\n</code> in sequence? will <code>nlines &gt; 1</code> be true? Think about it!</p>\n\n<pre><code>        }\n}\nputchar(c);\n</code></pre>\n\n<p>I don't get this: You unconditionally output your character anyways, defeating the whole purpose of checking whether it's a newline.</p>\n\n<p>A correct solution would set a flag when <code>c</code> is a newline and not output anything. Then, when <code>c</code> is NOT a newline (<code>else</code> branch), output ONE newline if your flag is set and reset the flag. I leave the code writing to you now :)</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7571937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b62952a14e092bd33d99ad225c2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "dyingStudent", "link": "https://stackoverflow.com/users/7571937/dyingstudent"}, "edited": false, "score": 0, "creation_date": 1496831945, "post_id": 44409884, "comment_id": 75819368, "body": "Hello! I edited and added my whole program. Please take a look."}, {"owner": {"reputation": 11, "user_id": 7571937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b62952a14e092bd33d99ad225c2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "dyingStudent", "link": "https://stackoverflow.com/users/7571937/dyingstudent"}, "edited": false, "score": 0, "creation_date": 1496979897, "post_id": 44409884, "comment_id": 75895061, "body": "this code doesn&#39;t work. would you look at my code again please?"}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 1, "last_activity_date": 1496992266, "last_edit_date": 1496992266, "creation_date": 1496830790, "answer_id": 44409884, "question_id": 44409576, "link": "https://stackoverflow.com/questions/44409576/multiple-blank-lines-are-not-squeezed-in-one-blank-linec-using-i-o-redirection/44409884#44409884", "title": "Multiple blank lines are not squeezed in one blank line(C) using I/O redirection", "body": "<p>You provide too little code, the interesting part would be the loop around the code you posted...</p>\n\n<p>What you actually have to do there is <em>skipping</em> the output:</p>\n\n<pre><code>FILE* file = ...;\nchar c, prev = 0;\nwhile((c = fgets(file)) != EOF)\n{\n    if(c != '\\n' || prev != '\\n')\n        putchar(c);\n    prev = c;\n}\n</code></pre>\n\n<p>If we have an empty line following another one, then we encounter two subsequent newline characters, so both <code>c</code> and <code>prev</code> are equal to <code>'\\n'</code>, which is the situation we do not want to output <code>c</code> (the subsequent newline) &ndash; and the inverse situation is any one of both being unequal to <code>'\\n'</code>, as you see above &ndash; and <em>only then</em> you want to output your character... </p>\n\n<p>Side note: <code>prev = 0</code> &ndash; well, I need to initalise it to anything different than a newline, could as well have been <code>'s'</code> &ndash; unless, of course, you want to skip an initial empty line, too, then you would have to initialise it with <code>'\\n'</code>...</p>\n\n<p><strong>Edit</strong>, referring to your modified code: <strong>Edit2</strong> <em>(removed references to code as it changed again)</em></p>\n\n<p>As your modified code shows that you do not only want to condense blank lines, but whitespace, too, you first have to consider that you have two classes of white space, on one hand, the newlines, on the other, any others. So you have to differentiate appropriately.</p>\n\n<p>I recommend now using some kind of state machine:</p>\n\n<pre><code>#define OTH  0\n#define WS   1\n#define NL1  2\n#define NL2  3\n\nint state = OTH;\n\nwhile (( c= getchar()) != EOF )\n{\n    // first, the new lines:\n    if(c == '\\n')\n    {\n        if(state != NL2)\n        {\n            putchar('\\n');\n            state = state == NL1 ? NL2 : NL1;\n        }\n    }\n    // then, any other whitespace\n    else if(isspace(c))\n    {\n        if(state != WS)\n        {\n            putchar(' ');\n            state = WS;\n        }\n    }\n    // finally, all remaining characters\n    else\n    {\n        putchar(c);\n        state = OTH;\n    }\n}\n</code></pre>\n\n<p>First differentiation occurs to the current character's own class (newline, whitespace or other), second differentiation according to the previous character's class, which defines the current state. Output occurs always for any non-whitespace character or if the two subsequent whitespace characters only, if they are of different class (newline is a little specific, I need two states for, as we want to leave one blank line, which means we need two subsequent newline characters...).</p>\n\n<p>Be aware: whitespace only lines do not apply as blank lines in above algorithm, so they won't be eliminated (but reduced to a line containing one single space). From the code you posted, I assume this is intended...</p>\n\n<p>For completeness: This is a variant removing leading and trailing whitespace entirely and counting whitespace-only lines as empty lines:</p>\n\n<pre><code>if(c == '\\n')\n{\n    if(state != NL2)\n    {\n        putchar('\\n');\n        state = state == NL1 ? NL2 : NL1;\n    }\n}\nelse if(isspace(c))\n{\n    if(state == OTH)\n        state = WS;\n}\nelse\n{\n    if(state == WS)\n    {\n        putchar('');\n    }\n    putchar(c);\n    state = OTH;\n}\n</code></pre>\n\n<p>Secret: Only enter the whitespace state, if there was a non-ws character before, but print the space character not before you encounter the next non-whitespace.</p>\n\n<p>Coming to the newlines - well, if there <em>was</em> a normal character, we are either in state OTH or WS, but none of the two NL states. If there was only whitespace on the line, the state is not modified, thus we remain in the corresponding NL state (1 or 2) and skip the line correspondingly...</p>\n"}], "owner": {"reputation": 11, "user_id": 7571937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b62952a14e092bd33d99ad225c2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "dyingStudent", "link": "https://stackoverflow.com/users/7571937/dyingstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 44409884, "answer_count": 2, "score": 0, "last_activity_date": 1496992266, "creation_date": 1496829909, "last_edit_date": 1496979964, "question_id": 44409576, "link": "https://stackoverflow.com/questions/44409576/multiple-blank-lines-are-not-squeezed-in-one-blank-linec-using-i-o-redirection", "title": "Multiple blank lines are not squeezed in one blank line(C) using I/O redirection", "body": "<p>I am asked to squeezed two or more consecutive blank lines in the input as one blank line in the output. So I  have to use Cygwin to do I/O or test it.\nExample: ./Lab &lt; test1.txt > test2.txt</p>\n\n<p>my code is:</p>\n\n<pre><code>   int main(void){\n\n    format();\n    printf(\"\\n\");\n    return 0;\n}\n\n\nvoid format(){\n    int c;\n    size_t nlines = 1;\n    size_t nspace = 0;\n    int spaceCheck = ' '; \n\n    while (( c= getchar()) != EOF ){\n\n        /*TABS*/\n        if(c == '\\t'){\n            c = ' ';\n        }\n        /*SPACES*/\n        if (c ==' '){/*changed from isspace(c) to c==' ' because isspace is true for spaces/tabs/newlines*/\n           /* while (isspace(c = getchar())); it counts while there is space we will put one space only */\n            if(nspace &gt; 0){\n                continue;\n            }\n            else{\n                putchar(c);\n                nspace++;\n                nlines = 0;\n            }\n\n        }\n\n\n        /*NEW LINE*/\n        else if(c == '\\n'){\n            if(nlines &gt;0){\n                continue;\n            }\n            else{\n                putchar(c);\n                nlines++;\n                nspace = 0;\n            }\n\n        }   \n\n\n        else{\n            putchar(c);\n            nspace = 0;\n            nlines = 0;\n\n        }       \n\n\n\n\n\n\n\n    }\n\n}\n</code></pre>\n\n<p>However my test2.txt doesn't have the result I want. Is there something wrong in my logic/code?</p>\n"}, {"tags": ["c", "stm32", "mpu"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1496833050, "post_id": 44409532, "comment_id": 75820152, "body": "I didn&#39;t check the code but FYI, magnetometer is device inside MPU and has different I2C address."}, {"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1496864398, "post_id": 44409532, "comment_id": 75841365, "body": "Can you elaborate on <code>I do not receive any data from magnetometer</code>? What is the failure case? Do you get all zeros? Do you never see the DRDY bit set in the status register?"}], "answers": [{"tags": [], "owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "is_accepted": true, "score": 1, "last_activity_date": 1496866434, "creation_date": 1496866434, "answer_id": 44421991, "question_id": 44409532, "link": "https://stackoverflow.com/questions/44409532/no-data-from-magnetometer-on-mpu9255/44421991#44421991", "title": "No data from magnetometer on MPU9255", "body": "<p>You need to enable the I2C bypass mode on the MPU9255 to communicate with the AK8963 directly. Set the <code>BYPASS_EN</code> bit in the <em>INT Pin / Bypass Enable Configuration</em> register (register 55) at the beginning of your program with:</p>\n\n<pre><code>uint8_t BypassEnable = 0x02;\nHAL_I2C_Mem_Write(&amp;hi2c1, 0xD0, 55, I2C_MEMADD_SIZE_8BIT, &amp;BypassEnable,1,1000);\n</code></pre>\n\n<p>See here for a working example: <a href=\"https://stackoverflow.com/questions/36242308/arduino-sensor-10dof-mpu9255-cannot-fetch-magnetometer-data\">Arduino Sensor 10DOF MPU9255 cannot fetch magnetometer data</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8124670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e792102e465ed4157417055549e342da?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz B", "link": "https://stackoverflow.com/users/8124670/mateusz-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "accepted_answer_id": 44421991, "answer_count": 1, "score": 0, "last_activity_date": 1566717537, "creation_date": 1496829789, "last_edit_date": 1496881124, "question_id": 44409532, "link": "https://stackoverflow.com/questions/44409532/no-data-from-magnetometer-on-mpu9255", "title": "No data from magnetometer on MPU9255", "body": "<p>I have a problem with reading data from the magnetometer on an MPU9255. The accelerometer and gyroscope work properly, but I do not receive any data from the magnetometer. I am working on the STM32F103 target.</p>\n\n<p>Has anyone any idea what is wrong with code below?</p>\n\n<pre><code>uint8_t Settings = 0x00;\nuint8_t SettingsM = 0x00;   \nuint8_t SettingsL = 0x22;   //mode2 16bit \n//settings accelerometer and gyroscope\nHAL_I2C_Mem_Write(&amp;hi2c1, 0xD0, 27, I2C_MEMADD_SIZE_8BIT, &amp;Settings,1,1000);\nHAL_I2C_Mem_Write(&amp;hi2c1, 0xD0, 28, I2C_MEMADD_SIZE_8BIT, &amp;Settings,1,1000);\n\n//Power Down mode\nHAL_I2C_Mem_Write(&amp;hi2c1, 0x0C, 0x0A, I2C_MEMADD_SIZE_8BIT, &amp;SettingsM,1,1000);\nHAL_Delay(100);\n//16 bit output mode 2\nHAL_I2C_Mem_Write(&amp;hi2c1, 0x0C, 0x0A, I2C_MEMADD_SIZE_8BIT, &amp;SettingsL,1,1000);\nwhile (1)\n{\n    //A X\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 59, I2C_MEMADD_SIZE_8BIT, &amp;DAHx,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 60, I2C_MEMADD_SIZE_8BIT, &amp;DALx,1,100);\n    //A Y\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 61, I2C_MEMADD_SIZE_8BIT, &amp;DAHy,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 62, I2C_MEMADD_SIZE_8BIT, &amp;DALy,1,100);\n    //A Z\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 63, I2C_MEMADD_SIZE_8BIT, &amp;DAHz,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 64, I2C_MEMADD_SIZE_8BIT, &amp;DALz,1,100);\n    //Temp\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 65, I2C_MEMADD_SIZE_8BIT, &amp;DHT,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 66, I2C_MEMADD_SIZE_8BIT, &amp;DLT,1,100);\n    //G X\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 67, I2C_MEMADD_SIZE_8BIT, &amp;DGHx,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 68, I2C_MEMADD_SIZE_8BIT, &amp;DGLx,1,100);\n    //G Y\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 69, I2C_MEMADD_SIZE_8BIT, &amp;DGHy,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 70, I2C_MEMADD_SIZE_8BIT, &amp;DGLy,1,100);\n    //G Z\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 71, I2C_MEMADD_SIZE_8BIT, &amp;DGHz,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0xD0, 72, I2C_MEMADD_SIZE_8BIT, &amp;DGLz,1,100);\n\n    do\n    {\n        HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x02, I2C_MEMADD_SIZE_8BIT, &amp;ST1,1,100);\n    }\n    while (!(ST1&amp;0x01));\n\n    //0x0C - adress AK8963, 0x03-0x08 =&gt; HLx-HHz\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x03, I2C_MEMADD_SIZE_8BIT, &amp;HLx,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x04, I2C_MEMADD_SIZE_8BIT, &amp;HHx,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x05, I2C_MEMADD_SIZE_8BIT, &amp;HLy,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x06, I2C_MEMADD_SIZE_8BIT, &amp;HHy,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x07, I2C_MEMADD_SIZE_8BIT, &amp;HLz,1,100);\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x08, I2C_MEMADD_SIZE_8BIT, &amp;HHz,1,100);\n\n    HAL_I2C_Mem_Read(&amp;hi2c1, 0x0C, 0x09, I2C_MEMADD_SIZE_8BIT, &amp;H,1,100);\n\n    //accelerometer\n    Ax = (int16_t)(DAHx &lt;&lt; 8 | DALx);\n    Ay = (int16_t)(DAHy &lt;&lt; 8 | DALy);\n    Az = (int16_t)(DAHz &lt;&lt; 8 | DALz);\n    //temperature\n    T = (int16_t)(DHT &lt;&lt; 8 | DLT);\n    //gyroscope\n    Gx = (int16_t)(DGHx &lt;&lt; 8 | DGLx);\n    Gy = (int16_t)(DGHy &lt;&lt; 8 | DGLy);\n    Gz = (int16_t)(DGHz &lt;&lt; 8 | DGLz);\n    //magnetometer\n    Hx= (int16_t)(HHx &lt;&lt; 8 | HLx);\n    Hy= (int16_t)(HHy &lt;&lt; 8 | HLy);\n    Hz= (int16_t)(HHz &lt;&lt; 8 | HLz);\n\n    Ax_g = (float)Ax/16384.0;\n    Ay_g = (float)Ay/16384.0;\n    Az_g = (float)Az/16384.0;\n    Gx_g = (float)Gx/131.0;\n    Gy_g = (float)Gy/131.0;\n    Gz_g = (float)Gz/131.0;\n\n    arx = (180.0/3.141592) * atanf(Ax_g / sqrtf(Ay_g*Ay_g + Az_g*Az_g));\n    ary = (180.0/3.141592) * atanf(Ay_g / sqrtf((Ax_g*Ax_g + Az_g*Az_g)));\n\n    rx = (0.96 * arx) + (0.04 * Gx_g);\n    ry = (0.96 * ary) + (0.04 * Gy_g);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "makefile", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 3, "creation_date": 1496831567, "post_id": 44409483, "comment_id": 75819074, "body": "<code>... headers files comming from already compiled and installed custom libraries.</code> - Linux <i>kernel</i> module <b>cannot be linked</b> with <i>user space</i> libraries. That is, you may include given header files for compilation process, but resulted module will contain <i>unresolved</i> symbols, so it couldn&#39;t be loaded into the kernel."}, {"owner": {"reputation": 39, "user_id": 6464391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-a8Ng2kb69hk/AAAAAAAAAAI/AAAAAAAAAAo/shXdHvC1qUM/photo.jpg?sz=128", "display_name": "sahbi.m", "link": "https://stackoverflow.com/users/6464391/sahbi-m"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1496834687, "post_id": 44409483, "comment_id": 75821297, "body": "So what should I do instead? Actually external libraries are dynamic that&#39;s why I couldn&#39;t include once the headers in OUTDIR. I have noticed that was possible with  <i>VxWorks</i>, So my question,"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1496835526, "post_id": 44409483, "comment_id": 75821915, "body": "How do you plan to link dynamic libraries to the kernel?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1496835763, "post_id": 44409483, "comment_id": 75822083, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31928255/linking-shared-library-in-linux-kernel\">Linking shared library in linux kernel</a>"}, {"owner": {"reputation": 39, "user_id": 6464391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-a8Ng2kb69hk/AAAAAAAAAAI/AAAAAAAAAAo/shXdHvC1qUM/photo.jpg?sz=128", "display_name": "sahbi.m", "link": "https://stackoverflow.com/users/6464391/sahbi-m"}, "edited": false, "score": 0, "creation_date": 1496839894, "post_id": 44409483, "comment_id": 75825193, "body": "example deps1 = boost, deps2 = header files template, deps3= a C-iterface using the librairy in deps2"}], "answers": [{"tags": [], "owner": {"reputation": 916, "user_id": 6255743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1aa73b90ee20ce1cb24ea3a9d98f661?s=128&d=identicon&r=PG&f=1", "display_name": "Appyx", "link": "https://stackoverflow.com/users/6255743/appyx"}, "is_accepted": false, "score": 0, "last_activity_date": 1497735341, "creation_date": 1497735341, "answer_id": 44609591, "question_id": 44409483, "link": "https://stackoverflow.com/questions/44409483/how-to-build-an-out-of-tree-linux-module-with-an-additional-include-path-includ/44609591#44609591", "title": "How to build an out-of-tree linux module with an additional include path (includes external header files, librairies like yaml, boost...)", "body": "<p>You cannot link user space libraries into modules.\nBut you can link multiple files with the following Makefile:</p>\n\n<pre><code>obj-m := combinedmodule.o\ncombinedmodule-objs := part1.o part2.o\n\n\nall:\n        make -C $(KERNEL_SRC) M=$(PWD) modules\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6464391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-a8Ng2kb69hk/AAAAAAAAAAI/AAAAAAAAAAo/shXdHvC1qUM/photo.jpg?sz=128", "display_name": "sahbi.m", "link": "https://stackoverflow.com/users/6464391/sahbi-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 785, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497735341, "creation_date": 1496829662, "last_edit_date": 1496840301, "question_id": 44409483, "link": "https://stackoverflow.com/questions/44409483/how-to-build-an-out-of-tree-linux-module-with-an-additional-include-path-includ", "title": "How to build an out-of-tree linux module with an additional include path (includes external header files, librairies like yaml, boost...)", "body": "<p>I am trying to build an out-of-tree linux kernel that should take into account external headers files comming from pre- compiled and installed custom libraries. My linux module will use functions from a shared library via a  C-interface.\nHow is it possible to prevent kernel Makefile of the existence of such files?</p>\n\n<pre><code>    obj-m+= hello_module.o\n    $(MAKE) -C $(KDIR) M=$(OUTDIR) modules\n    #additional include path\n    INCLUDES :=\\ \n             -I $(PROJECT_ROOT)/deps1\n             -I $(PROJECT_ROOT)/deps2\n             -I $(PROJECT_ROOT)/deps3\n</code></pre>\n\n<p>So how can I include this in $(MAKE) line above?\nThanks in advance,\nRgds\nsahbi</p>\n"}, {"tags": ["c", "spi", "mbed", "nucleo"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1496833585, "post_id": 44409479, "comment_id": 75820514, "body": "I would say that this SPI you are trying to use is not supported. It is funny how mbed knows which SPI to use when you init it with SPI class. Try pins D10, D11 and D12 (find out order for constructor) as this SPI is the <i>first</i> one."}, {"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1496836366, "post_id": 44409479, "comment_id": 75822546, "body": "@tilz0R Tried these too. Not clear exactly which pin is for slave select I am using D10"}, {"owner": {"reputation": 24757, "user_id": 107642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/672b033bf66f18d40cff3278f12f8f90?s=128&d=identicon&r=PG", "display_name": "Jan Jongboom", "link": "https://stackoverflow.com/users/107642/jan-jongboom"}, "edited": false, "score": 0, "creation_date": 1497026063, "post_id": 44409479, "comment_id": 75922034, "body": "Did the answer <a href=\"https://developer.mbed.org/questions/78226/SPI-example-not-working-on-NUCLEO-F411RE/\" rel=\"nofollow noreferrer\">here</a> help you?"}], "owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 565, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496829649, "creation_date": 1496829649, "question_id": 44409479, "link": "https://stackoverflow.com/questions/44409479/spi-example-not-working-on-nucleo-f411re", "title": "SPI example not working on NUCLEO-F411RE", "body": "<p>I have set up a very simple spi master example, but looking at the logic analyser there is no spi clock line. So what have I done wrong in the configuration of the spi. </p>\n\n<pre><code>#include \"mbed.h\"\n#include &lt;stdio.h&gt;\n\nSPI spi(D4, D5, D3); // mosi, miso, sclk\nDigitalOut cs(A2);\n\nSerial pc(USBTX, USBRX); // tx, rx\n\nint main() {\n    cs = 1;\n    spi.format(8,3);\n    spi.frequency(1000000);\n\n    // Select the spi by seting chip select low\n    cs = 0;\n\n    // Send some data\n    spi.write(0xFA);\n\n    // Send a dummy byte to receive the contents of the WHOAMI register\n    int whoami = spi.write(0x00);\n    pc.printf(\"WHOAMI register = 0x%X\\n\", whoami);\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 3, "creation_date": 1496828175, "post_id": 44408844, "comment_id": 75816584, "body": "Did you try anything?"}, {"owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1496828316, "post_id": 44408844, "comment_id": 75816671, "body": "I tried the same by declaring chars, but since the char pointers has no capability of changing contents inside locations, it is showing error......."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1496828337, "post_id": 44408844, "comment_id": 75816685, "body": "with <code>while(*s1++=*s2++)</code> you are actually writing out of the bounds of <code>s1</code> (<code>s2</code> is larger than <code>s1</code>)"}, {"owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "edited": false, "score": 0, "creation_date": 1496828376, "post_id": 44408844, "comment_id": 75816713, "body": "Is this question substandard?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1496828383, "post_id": 44408844, "comment_id": 75816715, "body": "Will be: segmentation fault. You can&#39;t modify literal strings, that are const"}, {"owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "edited": false, "score": 0, "creation_date": 1496828442, "post_id": 44408844, "comment_id": 75816758, "body": "So, its impossible to copy strings when they are declared as char pointers?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1496828501, "post_id": 44408844, "comment_id": 75816802, "body": "No, in the way you posted. But you can, obviously, switch pointers values."}, {"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1496828633, "post_id": 44408844, "comment_id": 75816898, "body": "I think @OliverCharlesworth&#39;s comment pretty much sums it up; this question doesn&#39;t show any attempt at doing what you are asking and seeing what the results are. Sometimes the best way to learn is to take what you have, make a small change, see what breaks (whether in terms of compilation errors or changed software behavior; the latter hopefully indicated by automated tests), fix that breakage, rinse and repeat until you are at where you want to be. Hence &quot;this question does not show any research effort&quot;."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1496828954, "post_id": 44408844, "comment_id": 75817120, "body": "Your latest iteration modifies the value of the <b>local</b> pointer variable s1, since you pass the pointers by value. On the subject of modifying string literals, see <a href=\"https://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s\" title=\"what is the difference between char s and char s\">stackoverflow.com/questions/1704407/&hellip;</a>"}, {"owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "edited": false, "score": 0, "creation_date": 1496829058, "post_id": 44408844, "comment_id": 75817191, "body": "Yeah, but if I change the actual values, error happens"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1496829154, "post_id": 44408844, "comment_id": 75817263, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s\">What is the difference between char s&#91;&#93; and char *s?</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1496829254, "post_id": 44408844, "comment_id": 75817349, "body": "<i>Both</i> fragments are wrong and exhibit undefined behaviour. There is no point in learning C by experimentation."}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1496829172, "post_id": 44409233, "comment_id": 75817286, "body": "...and <code>strcp(&amp;s1,&amp;s2);</code>"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1496829108, "creation_date": 1496829108, "answer_id": 44409233, "question_id": 44408844, "link": "https://stackoverflow.com/questions/44408844/string-copy-using-character-pointers/44409233#44409233", "title": "String copy using character pointers", "body": "<pre><code>void strcp(char **s1, char **s2) {\n\n*s1=*s2;\n}\n</code></pre>\n\n<p>but it does not copy anything. After this s1 &amp; s2 in main will point to the same memory location.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1496829283, "creation_date": 1496829283, "answer_id": 44409317, "question_id": 44408844, "link": "https://stackoverflow.com/questions/44408844/string-copy-using-character-pointers/44409317#44409317", "title": "String copy using character pointers", "body": "<p>Both versions, even the one you state that it works fine, yield undefined behaviour, which may become apparent as a segmentation fault.\nGenerally, accessing memory requires the addressed memory to be <em>valid</em>, i.e. properly allocated. This is particularly true for writing to memory, as any sort of <code>strcpy</code> does.</p>\n\n<p>In the first case, you define a variable <code>char s1[]=\"Hai, I am a good boy\"</code>, which implicitly reserves a memory block of about 21 one bytes and copies the string literal provided into it. If you now copy another string into <code>s1</code>, and the other string is longer than 21 bytes, you actually address memory that is not reserved for <code>s1</code>, thereby yielding undefined behaviour.</p>\n\n<p>In the second case, when you define variable <code>char *s1=\"Hai, I am a good boy\"</code>, then no memory block to which you may write is reserved, but <code>s1</code> will rather point to a memory block in a non-writeable data segment where literal <code>\"Hai, I am a good boy\"</code> resides. Copying something to this address again yields undefined behaviour, yet for a different reason.</p>\n\n<p>So allocate memory for <code>s1</code>, e.g using <code>malloc</code>, and then copy content to it.</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1496830023, "post_id": 44409380, "comment_id": 75817951, "body": "both versions are invalid. The first one on some systems will generate segmentarion fault (as literals are stored in the read only segments), will do nothng (ARMs for example) where writing to the flash does nothing, or on some systems where access to the read only memories is complicated (8-bit AVR) will work ok asthe literals are copied to the RAM.  The second example does nothing. it only swaps the local (in the strcpy scope) variables which will vanish on function return. Both are bad. You will receive the warnings and eventually an error as *s1 is char not char *."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1496830662, "post_id": 44409380, "comment_id": 75818431, "body": "@PeterJ <code>*s1 is char not char *</code> ?? <code>*s1</code> can never be of type char. and swaping the memory address that the whole point of using pointer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1496830978, "post_id": 44409380, "comment_id": 75818670, "body": "your function call <i>strcp(&amp;s1,&amp;s2);</i> is incompatible with the function parameters <i>void strcp(char *s1, char *s2) {</i>  you pass char ** (and you will get a warning) but in the function they will be treated as char * only. So <i>*s1 = *s2;</i> will only store one character in the location pointed by s1 destructing the original pointer. this is a classical UB. Expalaining: s1 is char *, *s1 is char and &amp;s1 is char **"}], "tags": [], "owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "is_accepted": false, "score": -2, "last_activity_date": 1496829426, "creation_date": 1496829426, "answer_id": 44409380, "question_id": 44408844, "link": "https://stackoverflow.com/questions/44408844/string-copy-using-character-pointers/44409380#44409380", "title": "String copy using character pointers", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nvoid strcp(char *s1, char *s2);\n\nint main() {\n    char *s1 = \"Hi, I am a good boy\";                   //1\n    char *s2 = \"Really!! I am a good boy\";              //2\n\n    strcp(&amp;s1,&amp;s2); //Pass Address to function \n\n    printf(\"s1 = %s\", s1);\n    printf(\"\\ns2 = %s\", s2);\n\n    return 0;\n}\n\n/*\n * This method takes pointer address as arguments and simply swap the address \n * pointing to string (i.e. char array).\n */\nvoid strcp(char *s1, char *s2) { \n    char *temp = *s1;\n           *s1 = *s2;\n           *s2 = temp;\n}\n</code></pre>\n\n<p><strong>O/P :</strong> </p>\n\n<p>s1 = Really!! I am a good boy <br>\ns2 = Hi, I am a good boy</p>\n\n<p><a href=\"http://ideone.com/wTH4VO\" rel=\"nofollow noreferrer\">http://ideone.com/wTH4VO</a></p>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 7690030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11846ade17a8760f2501ab72fcc1f37?s=128&d=identicon&r=PG", "display_name": "Martin Chekurov", "link": "https://stackoverflow.com/users/7690030/martin-chekurov"}, "is_accepted": false, "score": 1, "last_activity_date": 1496832611, "creation_date": 1496832611, "answer_id": 44410579, "question_id": 44408844, "link": "https://stackoverflow.com/questions/44408844/string-copy-using-character-pointers/44410579#44410579", "title": "String copy using character pointers", "body": "<p>First of all you can't modify literal strings, that are const.\nSecond, your function strcp() doesn't care if you pass a pointer to characters or an array of characters, it should work in both cases.When you type just s1 the array is converted in to a pointer to char which points to the first element of the array.</p>\n\n<p>s1 -->(char*)&amp;s1[0]</p>\n\n<p>Since you can't modify literal strings what you can do is just switch the pointers:</p>\n\n<pre><code>void strcp(char **s1, char **s2) { \nchar *temp = *s1;\n       *s1 = *s2;\n       *s2 = temp;\n}\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1496832611, "creation_date": 1496828089, "last_edit_date": 1496828846, "question_id": 44408844, "link": "https://stackoverflow.com/questions/44408844/string-copy-using-character-pointers", "title": "String copy using character pointers", "body": "<p>Consider the following code, which works fine asusual for copying string</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid strcp(char *s1, char *s2);\n\nint main() {\n\n    char s1[]=\"Hai, I am a good boy\";                   //1\n    char s2[]=\"Really I am a good boy\";                 //2\n\n    strcp(s1,s2);\n\n    printf(\"%s\",s1);\n    return 0;\n}\n\nvoid strcp(char *s1, char *s2) {\n\n    while(*s1++=*s2++);\n}\n</code></pre>\n\n<p>What changes I have to made if I want to declare <code>s1, s2</code> as pointers to char inside <code>main()</code>?</p>\n\n<pre><code>char *s1=\"Hai, I am a good boy\";                   //1\nchar *s2=\"Really I am a good boy\";                 //2\n</code></pre>\n\n<p>I tried to copy pointer values as shown below</p>\n\n<pre><code>void strcp(char *s1, char *s2) {\n\ns1=s2;\n}\n</code></pre>\n\n<p>But it didn't work.</p>\n"}, {"tags": ["c", "function", "function-pointers", "declaration"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496827991, "post_id": 44408778, "comment_id": 75816442, "body": "That is also called <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow noreferrer\">the clockwise/spiral rule</a>."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 4, "creation_date": 1496828013, "post_id": 44408778, "comment_id": 75816456, "body": "Yes, you are correct: <a href=\"https://cdecl.org/?q=void+%28%2A%28%2Af%5B%5D%29%28%29%29%28%29\" rel=\"nofollow noreferrer\">cdecl.org/?q=void+%28%2A%28%2Af%5B%5D%29%28%29%29%28%29</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496828125, "post_id": 44408778, "comment_id": 75816547, "body": "As for the empty parentheses for a function, in C++ it means no arguments, effectively a <code>void</code> argument. In C it&#39;s a very different matter, where it is a function with an unknown number of unspecified arguments, if used in a declaration. Or it means no arguments (i.e. a <code>void</code> argument) if used in a definition."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1496828190, "post_id": 44408778, "comment_id": 75816597, "body": "Also, arrays without a specific size is allowed in two places: When defining an array with <i>initialization</i> so the compiler can deduce the size; Or last in a <code>struct</code> where it becomes a <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\"><i>flexible array member</i></a>. Other than that one must specify a size of the array."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496828229, "post_id": 44408778, "comment_id": 75816619, "body": "@Someprogrammerdude: Yep, thanks for the comment. I know that one, thats why I actually decided to take this picture as help for refreshing my knowledge, since this person seemed to understand something about it. But... well... his explanation in it self seems to ignore his own spiral, so ignoring his statement which obviously is wrong, I&#39;m now even in doubt the first text is correct."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1496828629, "post_id": 44408778, "comment_id": 75816894, "body": "The text is actually wrong. <code>f</code> is an array of unspecified length (which can only be used in two places) which contains pointers to functions that takes an unspecified amount arguments of unspecified type. The functions returns not <code>void</code> but a pointer to a function taking an unspecified number or arguments of unspecified type, and those functions return <code>void</code>. So the text misses the return type of the function-pointers in the array."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1496828885, "post_id": 44408778, "comment_id": 75817079, "body": "Well you can stare at such code, with your mind going in spiral patterns, on the verge of insanity... or you can use typedef, as has already been discussed in millions of other posts. It boils down to: 1) if you write code like this, you are insane, 2) if you try to read &amp; understand code like this, you&#39;ll get insane, and 3) the people who made this syntax possible were definitely insane."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496828915, "post_id": 44408778, "comment_id": 75817099, "body": "Also this code won&#39;t even compile in any version of C, because VLA&#39;s cannot be empty. Therefore a very bad example. C is quite hard... the person who wrote that code had just not yet realized."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496830316, "post_id": 44408778, "comment_id": 75818186, "body": "@Lundin: I have to disaggre, at least to your second post. I can aggree with point 1 and 2 of your first point and partial with your 3rd point, but your second comment is just wrong. note, this actually isn&#39;t the usage of an VLA. The standard specifies it as &quot;array of unknown size&quot;. Look it up. Its fully legit. And while this is as the title states an desastrous example, this feature finds its usage. Also look Vlads answer for an example of valid code using this feature."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496832596, "post_id": 44408778, "comment_id": 75819828, "body": "@Zaibis You can declare an array of incomplete type, but that is not meaningful unless part of a function parameter list, which isn&#39;t the case here. You would have to make a second declaration such as <code>void (* (*f[n])())();</code> later in the code. If you wish to declare a VLA of incomplete type you would write <code>type arr[*]</code>, which again only makes sense inside a function declaration. The example by Vlad does not use any incomplete type since he added an initializer list and removed the <code>;</code>, changing the meaning of the declaration."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496832717, "post_id": 44408778, "comment_id": 75819912, "body": "That is, there is no such thing as &quot;an array of unknown size&quot; in the C language. There are only arrays of incomplete type, that cannot be used in meaningful ways until their type has been completed (or before they have been adjusted to pointers, as part of a parameter list)."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496832801, "post_id": 44408778, "comment_id": 75819971, "body": "@Lundin: Not disaggreing with that, but I also don&#39;t see why that should be contradicting with anything, I said. Note this whole phrase isn&#39;t about productive code, but about all the little questionable features of C. And there are such things as  &quot;array of unknown size&quot;. I just copy pasted that exact wording from my iso/iec copy."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1496831205, "last_edit_date": 1496831205, "creation_date": 1496828798, "answer_id": 44409101, "question_id": 44408778, "link": "https://stackoverflow.com/questions/44408778/is-the-explanation-for-this-disastrous-declaration-even-correct/44409101#44409101", "title": "Is the explanation for this disastrous declaration even correct?", "body": "<p>For starters in C such a function declaration like</p>\n\n<pre><code>void f();\n</code></pre>\n\n<p>means that the number and types of parameters are defined based on the function call.</p>\n\n<p>From the C Standard (6.7.6.3 Function declarators (including prototypes))</p>\n\n<blockquote>\n  <p>14 An identifier list declares only the identifiers of the parameters\n  of the function. An empty list in a function declarator that is part\n  of a definition of that function specifies that the function has no\n  parameters. <strong>The empty list in a function declarator that is not part\n  of a definition of that function specifies that no information about\n  the number or types of the parameters is supplied</strong></p>\n</blockquote>\n\n<p>So if the function does not have parameters it is better to write</p>\n\n<pre><code>void f( void );\n</code></pre>\n\n<p>Though it is not important nevertheless for clarity let's rewrite the declaration</p>\n\n<pre><code>void(*(*f[])( ))( )\n</code></pre>\n\n<p>like</p>\n\n<pre><code>void(*(*f[])( void ))( void )\n</code></pre>\n\n<p>This declaration declares an array of unspecified size (the size of the array is determinate from the number of initializers) of pointers to functions. The functions have no parameters and return pointers to functions that in turn have no parameters and have return type void.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func2(void)\n{\n    puts(\"Hello C\");\n}\n\nvoid(*(func1)( void ))( void )\n{\n    return func2;\n}\n\nint main( void )\n{\n    void(*(*f[])( void ))( void) = { func1 };\n\n    f[0]()();\n}\n\nvoid(*(*f[])())()\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Hello C\n</code></pre>\n\n<p>The declaration can be simplified by introducing a typedef. </p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func2(void)\n{\n    puts(\"Hello C\");\n}\n\ntypedef void(*FP)(void);\n\nFP func1(void)\n{\n    return func2;\n}\n\nint main( void )\n{\n    FP ( *f[] )( void ) = { func1 };\n\n    f[0]()();\n}\n</code></pre>\n"}], "owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 2, "accepted_answer_id": 44409101, "answer_count": 1, "score": 2, "last_activity_date": 1496831205, "creation_date": 1496827888, "last_edit_date": 1496830123, "question_id": 44408778, "link": "https://stackoverflow.com/questions/44408778/is-the-explanation-for-this-disastrous-declaration-even-correct", "title": "Is the explanation for this disastrous declaration even correct?", "body": "<p>I just started a new job where I'm part of the only team working on C projects. So I presented this picture: <a href=\"https://i.stack.imgur.com/dQzjq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dQzjq.png\" alt=\"enter image description here\"></a></p>\n\n<p>which already decorated my desk on the old working place, where I just took the explanation as granted.</p>\n\n<p>The idea of putting it next to our office's door case was well received. When I got asked, if I understand what this is doing and if I could explain it later this day, I agreed and prepared my self a little bit to explain it.</p>\n\n<p>But I got stucked. Ignoring the additional hint which is semantically already wrong, I'm confused about the appearance of 2 empty argument-expression-list's.</p>\n\n<p>Wouldn't that mean, <code>void (*(*f[])())()</code>is actually: <code>f</code>, identifying an array of unspecified size, of pointers to functions that return pointers to functions which return void? </p>\n\n<p>Or am I just missing something since my C skills might have got a bit rusty?</p>\n"}, {"tags": ["c", "openssl", "aes", "rsa", "libcrypto"], "comments": [{"owner": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "edited": false, "score": 1, "creation_date": 1496827451, "post_id": 44408110, "comment_id": 75816061, "body": "Can you <a href=\"https://stackoverflow.com/posts/44408110/edit\">edit</a> this to instead include a <i>minimal, self-contained, compilable example</i> that illustrates your problem? I&#39;m pretty sure the code you included has prerequisites which are <i>not</i> included in that code; certainly just feeding it to GCC doesn&#39;t compile (I get 28 lines of diagnostic output, including several that are &quot;first use in this function&quot;)."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 6669, "user_id": 486504, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XWsKp.png?s=128&g=1", "display_name": "user", "link": "https://stackoverflow.com/users/486504/user"}, "edited": false, "score": 0, "creation_date": 1496828169, "post_id": 44408110, "comment_id": 75816580, "body": "@MichaelKj&#246;rling Thanks for trying to help. Edited, I think it is ok now"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1496828254, "post_id": 44408110, "comment_id": 75816634, "body": "AES needs symmetric key for encryption,but appears you are passing RSA key,if you have key encrypted with RSA public key, you need to decrypt it with corresponding private key,then use the decrypted key for AES decryption of data"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1496828514, "post_id": 44408110, "comment_id": 75816812, "body": "@Pras Well then where and when would I give the RSA private key to EVP for it to decrypt the wrapping key ? I know AES needs an symetric key and RSA an asymmetric one."}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 1, "creation_date": 1496829023, "post_id": 44408110, "comment_id": 75817170, "body": "Your key is encrypted with RSA, so you will decrypt it with RSA APIs like RSA_private_decrypt, not with EVP* apis, you will use them(EVP*) for data that is encrypted with AES"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1496829399, "post_id": 44408110, "comment_id": 75817468, "body": "@Pras Thanks a lot. I have been very stupid. If there is nothing else to change in the code for it to work (I will test it this afternoon), I&#39;d be glad if you could post this as an answer so I can accept it."}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 2, "creation_date": 1496831838, "post_id": 44408110, "comment_id": 75819294, "body": "Have you considered using the EVP_Seal APIs? They provide a high level interface to do exactly what you describe and hide all the low level details. See <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/EVP_SealInit.html\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.1.0/crypto/EVP_SealInit.html</a>"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1496849973, "post_id": 44408110, "comment_id": 75833150, "body": "@MattCaswell Spent the afternoon trying to use it. Honestly those EVP APIs are a hell to use, no errors when it&#39;s not working, no tutorials out there.. I don&#39;t understand why <code>EVP_OpenUpdate</code> has to be called several times ?"}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 1, "creation_date": 1496873854, "post_id": 44408110, "comment_id": 75845745, "body": "There is some sample code available at <a href=\"https://wiki.openssl.org/index.php/EVP_Asymmetric_Encryption_and_Decryption_of_an_Envelope\" rel=\"nofollow noreferrer\">wiki.openssl.org/index.php/&hellip;</a>. As for errors, if the functions return an error code you can get a more detailed error message using the various error functions, e.g. see <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/ERR_print_errors_fp.html\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.1.0/crypto/ERR_print_errors_fp.html</a> or <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/ERR_get_error.html\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.1.0/crypto/ERR_get_error.html</a>. <code>EVP_OpenUpdate</code> does <i>not</i> need to be called several times - once is enough. You may choose to call it multiple times if the encrypted data is being streamed to you."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1496904639, "post_id": 44408110, "comment_id": 75855057, "body": "@MattCaswell Ok thanks a lot. I&#39;d have two last questions, is it possible to <code>Open</code> a symmetric key which has been encrypted somehow else than with <code>Seal</code> ? And is it more verbose/more effective to use <code>ERR_get_error</code>than <code>ERR_print_errors_fp</code>?"}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 1, "creation_date": 1496910486, "post_id": 44408110, "comment_id": 75858656, "body": "Yes, as long as the key has been encrypted using RSA with PKCS#1 padding it should be fine to call <code>Open</code> with it. <code>ERR_print_errors_fp</code> is an easy call to just dump all the errors to (say) stderr. Some people want more control over the format of the error message and how it gets displayed (e.g. maybe you don&#39;t want to send it to a FILE *, but instead to some custom logging API). If you wan more control you can use <code>ERR_get_error</code> and then the various other <code>ERR_*</code> functions to get hold of the component parts and do with it as you wish."}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "reply_to_user": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1496912539, "post_id": 44408110, "comment_id": 75860007, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146147/discussion-between-badda-and-matt-caswell\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496914346, "post_id": 44409459, "comment_id": 75861256, "body": "What mode should I use ? I am still getting the same error after using the RSA-decrypted AES key"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 1, "creation_date": 1496914975, "post_id": 44409459, "comment_id": 75861731, "body": "You need to pass correct cipher type to EVP_DecryptInit_ex, depending on  length of key being used, you can use EVP_aes_128_cbc,EVP_aes_192_cbc,EVP_aes_256_cbc"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496915042, "post_id": 44409459, "comment_id": 75861780, "body": "Isn&#39;t cbc mode used with IV ?"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 1, "creation_date": 1496917610, "post_id": 44409459, "comment_id": 75863571, "body": "The cipher type should be the same that was used during the encryption, list of cipher type you can find in man page of evp_decryptinit_ex, when you mentioned no IV is used I believe you mean all zeros as IV, it is failing in EVP_DecryptUpdatetoo or just in EVP_DecryptFinal_ex?"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496923156, "post_id": 44409459, "comment_id": 75867356, "body": "Except the size of the symmetric and asymmetric keys, I have no other information about how it was encrypted. It is failing only with <code>EVP_DecryptFinal_ex</code>, but <code>EVP_DecryptUpdate</code>&#39;s result gives random values. The result is like 512 bytes long instead of something like 60. I&#39;ll try with all zeros as IV, but I thought IVs were optional."}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 1, "creation_date": 1496978610, "post_id": 44409459, "comment_id": 75894757, "body": "EVP_DecryptUpdate decrypts the final block that is not multiple of cipher block, I am not sure if it returns 1 if the data is already multiple of cipher block, can you check if data you got from EVP_DecryptUpdate is the decrypted plain data that you expect,Please note you have to be in sync with the client(the one who encrypts) on iv,encryption mode,key ie use the same one while decrypting to get correct decrypted data."}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 2, "last_activity_date": 1496829774, "last_edit_date": 1496829774, "creation_date": 1496829611, "answer_id": 44409459, "question_id": 44408110, "link": "https://stackoverflow.com/questions/44408110/decrypting-an-aes-encrypted-message-with-an-rsa-encrypted-key-with-evp-tool/44409459#44409459", "title": "Decrypting an AES-encrypted message with an RSA-encrypted key with EVP tool", "body": "<p>Your key is encrypted with RSA, so you will decrypt it with RSA APIs like <code>RSA_private_decrypt</code> first, not with EVP* APIs.</p>\n\n<p>Once you get key decrypted you need to use it with (EVP*) APIs to decrypt the data with AES.</p>\n"}, {"tags": [], "owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "is_accepted": true, "score": 2, "last_activity_date": 1496932308, "creation_date": 1496932308, "answer_id": 44438568, "question_id": 44408110, "link": "https://stackoverflow.com/questions/44408110/decrypting-an-aes-encrypted-message-with-an-rsa-encrypted-key-with-evp-tool/44438568#44438568", "title": "Decrypting an AES-encrypted message with an RSA-encrypted key with EVP tool", "body": "<p>Here is a complete working example of how you can encrypt a key using RSA, and encrypt a message using that key using AES, followed by the subsequent decryption of those things. It assumes AES-256-CBC is being used. If you want to use AES-256-GCM instead then you will need to make some changes to get and set the tag (ask me if you need some pointers on how to do this). It also assumes that the RSA encryption is done with PKCS#1 padding (which is all that the EVP_Seal* APIs support). If you need some other kind of padding then you will need to use a different method. Finally it assumes you are using OpenSSL 1.1.0. If you are using 1.0.2 then some changes will probably be necessary (at least you will need to explicitly init and de-init the library - that isn't required in 1.1.0).</p>\n\n<p>The code reads the RSA private and public keys from files called privkey.pem and pubkey.pem which are in the current working directory. I generated these files like this:</p>\n\n<pre><code>openssl genrsa -out privkey.pem 2048\nopenssl rsa -in privkey.pem -pubout -out pubkey.pem\n</code></pre>\n\n<p>I've tested this on Linux only. The code is as follows:</p>\n\n<pre><code>#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/pem.h&gt;\n#include &lt;openssl/err.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstatic int envelope_seal(EVP_PKEY *pub_key, unsigned char *plaintext,\n                         int plaintext_len, unsigned char **encrypted_key,\n                         int *encrypted_key_len, unsigned char **iv,\n                         int *iv_len,  unsigned char **ciphertext,\n                         int *ciphertext_len)\n{\n    EVP_CIPHER_CTX *ctx;\n    int len, ret = 0;\n    const EVP_CIPHER *type = EVP_aes_256_cbc();\n    unsigned char *tmpiv = NULL, *tmpenc_key = NULL, *tmpctxt = NULL;\n\n    if((ctx = EVP_CIPHER_CTX_new()) == NULL)\n        return 0;\n\n    *iv_len = EVP_CIPHER_iv_length(type);\n    if ((tmpiv = malloc(*iv_len)) == NULL)\n        goto err;\n\n    if ((tmpenc_key = malloc(EVP_PKEY_size(pub_key))) == NULL)\n        goto err;\n\n    if ((tmpctxt = malloc(plaintext_len + EVP_CIPHER_block_size(type)))\n            == NULL)\n        goto err;\n\n    if(EVP_SealInit(ctx, type, &amp;tmpenc_key, encrypted_key_len, tmpiv, &amp;pub_key,\n                    1) != 1)\n        goto err;\n\n    if(EVP_SealUpdate(ctx, tmpctxt, &amp;len, plaintext, plaintext_len) != 1)\n        goto err;\n    *ciphertext_len = len;\n\n    if(EVP_SealFinal(ctx, tmpctxt + len, &amp;len) != 1)\n        goto err;\n    *ciphertext_len += len;\n\n    *iv = tmpiv;\n    *encrypted_key = tmpenc_key;\n    *ciphertext = tmpctxt;\n    tmpiv = NULL;\n    tmpenc_key = NULL;\n    tmpctxt = NULL;\n    ret = 1;\n err:\n    EVP_CIPHER_CTX_free(ctx);\n    free(tmpiv);\n    free(tmpenc_key);\n    free(tmpctxt);\n\n    return ret;\n}\n\nint envelope_open(EVP_PKEY *priv_key, unsigned char *ciphertext,\n                  int ciphertext_len, unsigned char *encrypted_key,\n                  int encrypted_key_len, unsigned char *iv,\n                  unsigned char **plaintext, int *plaintext_len)\n{\n    EVP_CIPHER_CTX *ctx;\n    int len, ret = 0;\n    unsigned char *tmpptxt = NULL;\n\n    if((ctx = EVP_CIPHER_CTX_new()) == NULL)\n        return 0;\n\n    if ((tmpptxt = malloc(ciphertext_len)) == NULL)\n        goto err;\n\n    if(EVP_OpenInit(ctx, EVP_aes_256_cbc(), encrypted_key, encrypted_key_len,\n                    iv, priv_key) != 1)\n        return 0;\n\n    if(EVP_OpenUpdate(ctx, tmpptxt, &amp;len, ciphertext, ciphertext_len) != 1)\n        return 0;\n    *plaintext_len = len;\n\n    if(EVP_OpenFinal(ctx, tmpptxt + len, &amp;len) != 1)\n        return 0;\n    *plaintext_len += len;\n\n    *plaintext = tmpptxt;\n    tmpptxt = NULL;\n    ret = 1;\n err:\n    EVP_CIPHER_CTX_free(ctx);\n    free(tmpptxt);\n\n    return ret;\n}\n\nint main(void)\n{\n    EVP_PKEY *pubkey = NULL, *privkey = NULL;\n    FILE *pubkeyfile, *privkeyfile;\n    int ret = 1;\n    unsigned char *iv = NULL, *message = \"Hello World!\\n\";\n    unsigned char *enc_key = NULL, *ciphertext = NULL, *plaintext = NULL;\n    int iv_len = 0, enc_key_len = 0, ciphertext_len = 0, plaintext_len = 0, i;\n\n    if ((pubkeyfile = fopen(\"pubkey.pem\", \"r\")) == NULL) {\n        printf(\"Failed to open public key for reading\\n\");\n        goto err;\n    }\n    if ((pubkey = PEM_read_PUBKEY(pubkeyfile, &amp;pubkey, NULL, NULL)) == NULL) {\n        fclose(pubkeyfile);\n        goto err;\n    }\n    fclose(pubkeyfile);\n\n    if ((privkeyfile = fopen(\"privkey.pem\", \"r\")) == NULL) {\n        printf(\"Failed to open private key for reading\\n\");\n        goto err;\n    }\n    if ((privkey = PEM_read_PrivateKey(privkeyfile, &amp;privkey, NULL, NULL))\n            == NULL) {\n        fclose(privkeyfile);\n        goto err;\n    }\n    fclose(privkeyfile);\n\n    if (!envelope_seal(pubkey, message, strlen(message), &amp;enc_key, &amp;enc_key_len,\n                       &amp;iv, &amp;iv_len, &amp;ciphertext, &amp;ciphertext_len))\n        goto err;\n\n    printf(\"Ciphertext:\\n\");\n    for (i = 0; i &lt; ciphertext_len; i++)\n        printf(\"%02x\", ciphertext[i]);\n    printf(\"\\n\");\n\n    printf(\"Encrypted Key:\\n\");\n    for (i = 0; i &lt; enc_key_len; i++)\n        printf(\"%02x\", enc_key[i]);\n    printf(\"\\n\");\n\n    printf(\"IV:\\n\");\n    for (i = 0; i &lt; iv_len; i++)\n        printf(\"%02x\", iv[i]);\n    printf(\"\\n\");\n\n    if (!envelope_open(privkey, ciphertext, ciphertext_len, enc_key,\n                       enc_key_len, iv, &amp;plaintext, &amp;plaintext_len))\n        goto err;\n\n    plaintext[plaintext_len] = '\\0';\n    printf(\"Plaintext: %s\\n\", plaintext);\n\n    ret = 0;\n err:\n    if (ret != 0) {\n        printf(\"Error\\n\");\n        ERR_print_errors_fp(stdout);\n    }\n    EVP_PKEY_free(pubkey);\n    EVP_PKEY_free(privkey);\n    free(iv);\n    free(enc_key);\n    free(ciphertext);\n    free(plaintext);\n\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "accepted_answer_id": 44438568, "answer_count": 2, "score": 2, "last_activity_date": 1497598249, "creation_date": 1496826074, "last_edit_date": 1497598249, "question_id": 44408110, "link": "https://stackoverflow.com/questions/44408110/decrypting-an-aes-encrypted-message-with-an-rsa-encrypted-key-with-evp-tool", "title": "Decrypting an AES-encrypted message with an RSA-encrypted key with EVP tool", "body": "<p>For industrial purposes, I want to decrypt an <em>AES-encrypted message with an RSA-encrypted key</em> in C. At first, I thought doing it step-by-step by first, using <strong>OpenSSL libcrypto library</strong>, by first RSA decoding the key then AES decoding the data. </p>\n\n<p>I have found out that EVP tools were commonly seen as a better way to do this since it actually does what the low-levels functions do but correctly. \nHere is what I see the flow of the program : </p>\n\n<ul>\n<li>Initialize OpenSSL;</li>\n<li>Read and store the RSA private key;</li>\n<li>Initialize the decryption by specifying the decryption algorithm (AES) and the private key;</li>\n<li>Update the decryption by giving the key, the data, the key and their length</li>\n<li>Finally decrypt the data and return it.</li>\n</ul>\n\n<p>I have been a lot confused by the fact that so far we do not intend to use any IV or ADD (although IV might come up later in the project). I have followed <a href=\"https://wiki.openssl.org/index.php/EVP_Authenticated_Encryption_and_Decryption\" rel=\"nofollow noreferrer\">this guide</a> it is not very clear and does not fit the way I use EVP.</p>\n\n<p>So here is my actual code : </p>\n\n<pre><code>#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/conf.h&gt;\n#include &lt;openssl/pem.h&gt;\n#include &lt;openssl/rsa.h&gt;\n#include &lt;openssl/aes.h&gt;\n#include &lt;openssl/err.h&gt;\n#include \"openssl\\applink.c\" \n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\nconst char PRIVATE_KEY_PATH[] = \"C:/Users/Local_user/privateKey.pem\";\n\nEVP_PKEY* initializePrivateKey(void)\n{\n    FILE* privateKeyfile;\n    if ((privateKeyfile = fopen(PRIVATE_KEY_PATH, \"r\")) == NULL) // Check PEM file opening\n    {\n        perror(\"Error while trying to access to private key.\\n\");\n        return NULL;\n    }\n\n    RSA *rsaPrivateKey = RSA_new();\n    EVP_PKEY *privateKey = EVP_PKEY_new();\n\n    if ((rsaPrivateKey = PEM_read_RSAPrivateKey(privateKeyfile, &amp;rsaPrivateKey, NULL, NULL)) == NULL) // Check PEM file reading\n    {\n        fprintf(stderr, \"Error loading RSA Private Key File.\\n\");\n        ERR_print_errors_fp(stderr);\n        return NULL;\n    }\n    if (!EVP_PKEY_assign_RSA(privateKey, rsaPrivateKey))\n    {\n        fprintf(stderr, \"Error when initializing EVP private key.\\n\");\n        ERR_print_errors_fp(stderr);\n        return NULL;\n    }\n    return privateKey;\n}\nconst uint8_t* decodeWrappingKey(uint8_t const* data, const size_t data_len, uint8_t const* wrappingKey, const size_t wrappingKey_len)\n{\n    // Start Decryption\n    EVP_CIPHER_CTX *ctx;\n    if (!(ctx = EVP_CIPHER_CTX_new())) // Initialize context\n    {\n        fprintf(stderr, \"Error when initializing context.\\n\");\n        ERR_print_errors_fp(stderr);\n        return NULL;\n    }\n    EVP_PKEY *privateKey = initializePrivateKey();\n    if (1 != EVP_DecryptInit_ex(ctx, EVP_aes_256_gcm(), NULL, privateKey, NULL)) // Initialize decryption\n    {\n        fprintf(stderr, \"Error when initializing decryption.\\n\");\n        ERR_print_errors_fp(stderr);\n        return NULL;\n    } \n    uint8_t* res;\n    if ((res = calloc(data_len, sizeof(uint8_t))) == NULL) // Check memory allocating\n    {\n        perror(\"Memory allocating error \");\n        return NULL;\n    }\n    puts(\"Initialization done. Decoding..\\n\");\n    size_t res_len = 0;\n    if (1 != EVP_DecryptUpdate(ctx, res, &amp;res_len, data, data_len))\n    {\n        fprintf(stderr, \"Error when preparing decryption.\\n\");\n        ERR_print_errors_fp(stderr);\n    }\n\n\n    if (1 != EVP_DecryptFinal_ex(ctx, res, &amp;res_len))\n    {\n        fprintf(stderr, \"Error when decrypting.\\n\");\n        ERR_print_errors_fp(stderr);\n    }\n    return res;\n}\n\nvoid hexToBytes(uint8_t *des, char const *source, const size_t size) {\n\n    for (int i = 0; i &lt; size - 1; i += 2) \n        sscanf(source + i, \"%02x\", des + (i / 2));\n}\n\nint main(void) {\n    char const *strWrap = \"5f82c48f85054ef6a3b2621819dd0e969030c79cc00deb89........\";\n    char const *strData = \"ca1518d44716e3a4588af741982f29ad0a3e7a8d67.....\";\n\n    uint8_t *wrap = calloc(strlen(strWrap), sizeof(uint8_t));\n    hexToBytes(wrap, strWrap, strlen(strWrap)); // Converts string to raw data\n    uint8_t *data = calloc(strlen(strData), sizeof(uint8_t));\n    hexToBytes(data, strData, strlen(strData));\n\n    /* Load the human readable error strings for libcrypto */\n    ERR_load_crypto_strings();\n\n    /* Load all digest and cipher algorithms */\n    OpenSSL_add_all_algorithms();\n\n    /* Load config file, and other important initialisation */\n    OPENSSL_config(NULL);\n    const uint8_t *res = decodeWrappingKey(data, strlen(strData) / 2, wrap, strlen(strWrap) / 2);\n    if (res == NULL)\n        return 1;\n    return 0;\n}\n</code></pre>\n\n<p>My output is the following one : </p>\n\n<pre><code>Initialization done. Decoding..\n\nError when preparing decryption.\nError when decrypting. \n</code></pre>\n\n<p>Obviously it fails when updating and finalising the decryption but I can't figure out why and the <code>ERR_print_errors_fp(stderr);</code> which had always worked for me so far seems to be mute. </p>\n"}, {"tags": ["c", "string", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1496825500, "post_id": 44407865, "comment_id": 75814577, "body": "<code>&quot;%[^\\n]s&quot;</code> --&gt; <code>&quot;%99[^\\n]%*c&quot;</code>"}, {"owner": {"reputation": 828, "user_id": 8058683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3NrPU.jpg?s=128&g=1", "display_name": "H. Figueiredo", "link": "https://stackoverflow.com/users/8058683/h-figueiredo"}, "edited": false, "score": 0, "creation_date": 1496825599, "post_id": 44407865, "comment_id": 75814647, "body": "Change this <code>scanf(&quot;%[^\\n]s&quot;,a);</code> to <code>scanf(&quot; %s&quot;,a);</code>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 4, "creation_date": 1496825664, "post_id": 44407865, "comment_id": 75814693, "body": "<code>scanf()</code> is not very easy to use, maybe you should try <code>fgets()</code> or <code>getline()</code> (non standard :sick:)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1496825677, "post_id": 44407865, "comment_id": 75814698, "body": "Why do you want <code>scanf</code> instead of e.g. <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496826192, "post_id": 44407865, "comment_id": 75815090, "body": "If you insist on <code>scanf()</code>, @BLUEPIXY has the <i>correct</i> format string for you, but it should be explained in an answer. Nevertheless, <code>fgets()</code> would be the better function for the job."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496826582, "post_id": 44407865, "comment_id": 75815386, "body": "@BLUEPIXY That version will fail if input starts with newline"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 828, "user_id": 8058683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3NrPU.jpg?s=128&g=1", "display_name": "H. Figueiredo", "link": "https://stackoverflow.com/users/8058683/h-figueiredo"}, "edited": false, "score": 1, "creation_date": 1496826640, "post_id": 44407865, "comment_id": 75815430, "body": "@H.Figueiredo that will fail to read the OP&#39;s strings"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1496828345, "post_id": 44407865, "comment_id": 75816692, "body": "@Meenakshiyegu Is there a blank line between <i>two long sentences</i>?"}, {"owner": {"reputation": 51, "user_id": 8059598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yp8uF.jpg?s=128&g=1", "display_name": "Meenakshiyegu", "link": "https://stackoverflow.com/users/8059598/meenakshiyegu"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496855118, "post_id": 44407865, "comment_id": 75836241, "body": "@BLUEPIXY No there is no blank line between two sentence"}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496827488, "post_id": 44408225, "comment_id": 75816086, "body": "The OP is ambiguous about the input forget What I said about that you can remove your third call to fgets(). return <code>-1</code> in main is strange better to return <code>1</code>"}, {"owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496827568, "post_id": 44408225, "comment_id": 75816145, "body": "@Stargateur Thanks for your advice. I have modified my answer."}, {"owner": {"reputation": 51, "user_id": 8059598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yp8uF.jpg?s=128&g=1", "display_name": "Meenakshiyegu", "link": "https://stackoverflow.com/users/8059598/meenakshiyegu"}, "edited": false, "score": 1, "creation_date": 1496855698, "post_id": 44408225, "comment_id": 75836547, "body": "@YunbinLiu printf(&quot;%s%s&quot;,a,b); prints two sentence in new line without a &#39;\\n&#39; so does fgets read &#39;\\n&#39; as a character"}, {"owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "reply_to_user": {"reputation": 51, "user_id": 8059598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yp8uF.jpg?s=128&g=1", "display_name": "Meenakshiyegu", "link": "https://stackoverflow.com/users/8059598/meenakshiyegu"}, "edited": false, "score": 0, "creation_date": 1496886373, "post_id": 44408225, "comment_id": 75849060, "body": "@Meenakshiyegu Thanks for your advice. But it depends on the output format you want."}], "tags": [], "owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "is_accepted": false, "score": 4, "last_activity_date": 1496827357, "last_edit_date": 1496827357, "creation_date": 1496826403, "answer_id": 44408225, "question_id": 44407865, "link": "https://stackoverflow.com/questions/44407865/reading-two-long-sentences-using-scanf/44408225#44408225", "title": "reading two long sentences using scanf", "body": "<p>You could use <code>fgets</code>. And this could work for you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main() {\n    char a[100], b[100];\n\n    if (fgets(a, sizeof a, stdin) == NULL) {\n        puts(\"fgets error\");\n        return -1;\n    }\n\n    if (fgets(b, sizeof b, stdin) == NULL) {   //Read blank lines \n        puts(\"fgets error\");\n        return -1;\n    }\n\n    if (fgets(b, sizeof b, stdin) == NULL) {\n        puts(\"fgets error\");\n        return -1;\n    }\n\n    printf(\"%s\\n%s\", a, b);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496826810, "post_id": 44408350, "comment_id": 75815556, "body": "Doesn&#39;t work: <a href=\"https://ideone.com/x8k4XM\" rel=\"nofollow noreferrer\">ideone.com/x8k4XM</a>, buffer overflow vulnerability."}, {"owner": {"reputation": 491, "user_id": 5589495, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f0709007ffe60499a45c5bd1f9a8cbf1?s=128&d=identicon&r=PG", "display_name": "Deb S", "link": "https://stackoverflow.com/users/5589495/deb-s"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496826931, "post_id": 44408350, "comment_id": 75815638, "body": "need to put another enter to get next line - try it. I"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496843669, "post_id": 44408350, "comment_id": 75828160, "body": "If first character is a <code>&#39;\\n&#39;</code>, nothing is printed."}, {"owner": {"reputation": 491, "user_id": 5589495, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f0709007ffe60499a45c5bd1f9a8cbf1?s=128&d=identicon&r=PG", "display_name": "Deb S", "link": "https://stackoverflow.com/users/5589495/deb-s"}, "edited": false, "score": 1, "creation_date": 1496845373, "post_id": 44408350, "comment_id": 75829594, "body": "\\n is newline. If first character is \\n then first line does not contain anything."}], "tags": [], "owner": {"reputation": 491, "user_id": 5589495, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f0709007ffe60499a45c5bd1f9a8cbf1?s=128&d=identicon&r=PG", "display_name": "Deb S", "link": "https://stackoverflow.com/users/5589495/deb-s"}, "is_accepted": false, "score": -1, "last_activity_date": 1496826740, "creation_date": 1496826740, "answer_id": 44408350, "question_id": 44407865, "link": "https://stackoverflow.com/questions/44407865/reading-two-long-sentences-using-scanf/44408350#44408350", "title": "reading two long sentences using scanf", "body": "<p>Use like this </p>\n\n<pre><code>int main(){\n\n    char a[100];\n\n    while (scanf(\"%[^\\n]%*c\", a)==1) {\n     printf(\"%s\\n\",a); \n    }\n    return 0;\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496827611, "post_id": 44408369, "comment_id": 75816181, "body": "What if there is a buffer overflow? The user inputs a string greater that 100"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496827675, "post_id": 44408369, "comment_id": 75816218, "body": "@VidorVistrom I think it&#39;s explained in my answer regarding <code>scanf()</code> and for <code>fgets()</code>, that&#39;s what the second parameter is for."}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496828109, "post_id": 44408369, "comment_id": 75816537, "body": "If a user inputs a value greater than 100 chars, it will automatically allocate it to the other variable.. 100 is for first variable. If 100 is exceeded including the null, the other variable will get the exceeding chars"}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496828450, "post_id": 44408369, "comment_id": 75816765, "body": "input this to your program aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaaaaaaaaaa&zwnj;&#8203;aaaaaaaaaaaa"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496828956, "post_id": 44408369, "comment_id": 75817124, "body": "@VidorVistrom that would probably make a nice question. What you see as a result is not a <i>buffer overflow</i>, but the second call to <code>scanf()</code> or <code>fgets()</code> continuing to read where the first call stopped because there was no newline inside the limit of bytes to be read. For a robust program, you&#39;d have to check whether you really have read a full line. This is possible, but outside the scope of <i>this</i> question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496830056, "post_id": 44408369, "comment_id": 75817982, "body": "Yes, this will happen. @VidorVistrom just so you can understand, here&#39;s a <a href=\"https://ideone.com/Cwjzg1\" rel=\"nofollow noreferrer\">version checking whether the line was complete</a>."}, {"owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "edited": false, "score": 0, "creation_date": 1496830535, "post_id": 44408369, "comment_id": 75818336, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146046/discussion-between-vidor-vistrom-and-felix-palmen\">continue this discussion in chat</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496843525, "post_id": 44408369, "comment_id": 75828042, "body": "<code>scanf(&quot;%99[^\\n]%*c&quot;, a);</code> is a problem if the first character read is a <code>&#39;\\n&#39;</code>.  <code>a</code> is not updated, <code>&#39;\\n&#39;</code> remains in <code>stdin</code>.  Also a problem with end-of-file and rare input error."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 5, "last_activity_date": 1496827184, "last_edit_date": 1496827184, "creation_date": 1496826781, "answer_id": 44408369, "question_id": 44407865, "link": "https://stackoverflow.com/questions/44407865/reading-two-long-sentences-using-scanf/44408369#44408369", "title": "reading two long sentences using scanf", "body": "<p>This needs a <em>correct</em> answer. If you <em>insist</em> on using <code>scanf()</code>, there's only one format string that is <em>safe</em> and will do what you want:</p>\n\n<pre><code>int main() {\n    char a[100] = \"\";\n    char b[100] = \"\";\n    scanf(\"%99[^\\n]%*c\", a);\n    scanf(\"%99[^\\n]%*c\", b);\n    printf(\"%s\\n%s\", a, b);\n}\n</code></pre>\n\n<p>In your original string, you had <code>[^\\n]s</code> which is wrong, because <code>[^\\n]</code> is a conversion specifier itself, matching anything except a newline. So there shouldn't be an <code>s</code> following it.</p>\n\n<p>The next change is the <code>99</code> prepended. This ensures a maximum of <code>99</code> characters is converted -- plus one byte for the terminating <code>0</code>, you have exactly the 100 characters available in your array. Without that, if the user enters more than 99 characters, your buffer would overflow.</p>\n\n<p>The last change is to append <code>%*c</code>: <code>%c</code> will match any character, in this case the newline that is left after matching <code>%[^\\n]</code>. But you're not interested in it, you just want to consume it. This is what the <code>*</code> is for, it discards the result of the matching.</p>\n\n<hr>\n\n<p>If you can, just use <code>fgets()</code> like this, it is much simpler to use for this case:</p>\n\n<pre><code>int main() {\n    char a[100] = \"\";\n    char b[100] = \"\";\n    fgets(a, 100, stdin);\n    fgets(b, 100, stdin);\n\n    // if needed, strip newlines, e.g. like this:\n    size_t n = strlen(a);\n    if (n &amp;&amp; a[n-1] == '\\n') a[--n] = 0;\n    n = strlen(b);\n    if (n &amp;&amp; b[n-1] == '\\n') b[--n] = 0;\n\n\n    printf(\"%s\\n%s\", a, b);\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8059598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yp8uF.jpg?s=128&g=1", "display_name": "Meenakshiyegu", "link": "https://stackoverflow.com/users/8059598/meenakshiyegu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1496859355, "creation_date": 1496825400, "last_edit_date": 1496859355, "question_id": 44407865, "link": "https://stackoverflow.com/questions/44407865/reading-two-long-sentences-using-scanf", "title": "reading two long sentences using scanf", "body": "<p>I want to read two long sentences from input using <code>scanf()</code> which are in two new lines.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>int main() {\n    char a[100], b[100];\n    scanf(\"%[^\\n]s\", a);\n    scanf(\"%[^\\n]s\", b);\n    printf(\"%s\\n%s\", a, b);\n}\n</code></pre>\n\n<p><strong>Input:</strong></p>\n\n<pre><code>she is beautiful\nThat is a flower\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>she is beautiful\n</code></pre>\n\n<p>The second input is not being read by the <code>scanf()</code> statement.</p>\n\n<p><strong>How to fix it?</strong></p>\n"}, {"tags": ["c++", "c", "linux", "build", "lmdb"], "comments": [{"owner": {"reputation": 689, "user_id": 4678048, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d4cab92f164433dabd22844a55590f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jouster500", "link": "https://stackoverflow.com/users/4678048/jouster500"}, "edited": false, "score": 0, "creation_date": 1497042074, "post_id": 44407659, "comment_id": 75930024, "body": "Are you allowed to recompile the executable?"}], "answers": [{"tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": false, "score": 5, "last_activity_date": 1497287230, "last_edit_date": 1497287230, "creation_date": 1497185318, "answer_id": 44484054, "question_id": 44407659, "link": "https://stackoverflow.com/questions/44407659/how-to-force-64-bit-lmdb-to-generate-a-32-bit-database/44484054#44484054", "title": "How to force 64-bit LMDB to generate a 32-bit database?", "body": "<p>I guess, the usage of a 64 bit database on a 32 bit lmdb is hard til impossible due to the fact, that lmdb is based on memory-mapping.</p>\n\n<p>Thus, a converter would be necessary requiring the understanding of the underlying data format. This link <a href=\"https://blog.separateconcerns.com/2016-04-03-lmdb-format.html\" rel=\"nofollow noreferrer\">The LMDB file format</a> seems to be a good start for this.</p>\n\n<p>A cheap alternative seems to be to dump the file on the 64 bit platform (<a href=\"http://manpages.ubuntu.com/manpages/wily/man1/mdb_dump.1.html\" rel=\"nofollow noreferrer\"><code>mdb_dump</code></a>) and to reload it on the 32 bit platform (<a href=\"http://manpages.ubuntu.com/manpages/wily/man1/mdb_load.1.html\" rel=\"nofollow noreferrer\"><code>mdb_load</code></a>). Though, this causes limitations as pointed out in the linked man page:</p>\n\n<blockquote>\n  <p>Dumping and reloading databases that use user-defined comparison functions  will result in new databases that use the default comparison functions. <strong>In this case it is quite likely that the reloaded database will be damaged beyond  repair permitting neither record storage nor retrieval.</strong></p>\n</blockquote>\n\n<p>However, during searching the internet, I somewhere read that this can be used to port a 32 bit DB to 64 bit. I can only suspect that it should work the opposite way also (as I've never seen the format). As the dump is a text format, it should be possible &ndash; may be with an intermediate text processing step.</p>\n\n<p>Another, IMHO rather cheap alternative, would be to run a 32 bit lmdb on the 64 bit platform. As I know that is common and usual on Windows, I was not (fully) sure for Linux and found this: <a href=\"https://askubuntu.com/questions/454253/how-to-run-32-bit-app-in-ubuntu-64-bit\">SE: How to run 32-bit app in Ubuntu 64-bit?</a>. Unfortunately, the questioner stated that it is not an option in this specific case.</p>\n"}], "owner": {"reputation": 773, "user_id": 2863159, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Po2GJ.jpg?s=128&g=1", "display_name": "Rajesh Gopu", "link": "https://stackoverflow.com/users/2863159/rajesh-gopu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "answer_count": 1, "score": 9, "last_activity_date": 1497287230, "creation_date": 1496824794, "last_edit_date": 1496825844, "question_id": 44407659, "link": "https://stackoverflow.com/questions/44407659/how-to-force-64-bit-lmdb-to-generate-a-32-bit-database", "title": "How to force 64-bit LMDB to generate a 32-bit database?", "body": "<p>The executable  which uses the lmdb library is in 64 bit linux format .</p>\n\n<p>Because  dependency libraries of the executable are in 64 bit .Building executable &amp; lmdb lib as 32bit solution not possible.</p>\n\n<p>Is there any way i can force 64 bit lmdb lib to generate a 32 bit lmdb database.</p>\n\n<p>I need this 32 bit database file because the generated db will be exported to a 32 bit device. </p>\n\n<p>Note : db generated on 64bit machine will not work on 32 bit machine.</p>\n"}, {"tags": ["c", "php-extension"], "answers": [{"comments": [{"owner": {"reputation": 3627, "user_id": 3014890, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/EF8lG.png?s=128&g=1", "display_name": "Paradoxis", "link": "https://stackoverflow.com/users/3014890/paradoxis"}, "edited": false, "score": 0, "creation_date": 1496825737, "post_id": 44407713, "comment_id": 75814759, "body": "Ended up being the <code>sizeof()</code> call, replacing it with <code>strlen()</code> did the trick, thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1496824931, "creation_date": 1496824931, "answer_id": 44407713, "question_id": 44407439, "link": "https://stackoverflow.com/questions/44407439/wrapped-method-ends-up-in-the-false-block-as-but-direct-function-call-doesnt/44407713#44407713", "title": "Wrapped method ends up in the &#39;false&#39; block as but direct function call doesn&#39;t", "body": "<p>I don't think your first version works, either, as it is shown here. Chances are you have</p>\n\n<pre><code>const char name[] = \"hash\";\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>const char* name = \"hash\";\n</code></pre>\n\n<p>The code is wrong because <code>sizeof()</code> does something different than you seem to expect. It returns the actual storage size of its argument, and if this argument is a pointer, the size returned is the <em>size of the pointer</em>, not that of the object it points to.</p>\n\n<p>For the length of a string, there's the function <code>strlen()</code> in <code>string.h</code>, you should use this instead of <code>sizeof()</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>zend_bool extension_module_exists(const char* name)\n{\n    return zend_hash_str_exists(&amp;module_registry, name, strlen(name));\n}\n</code></pre>\n\n<p>Note this comes with a little overhead, as <code>strlen()</code> must scan its argument to find the first <code>0</code>-byte, which marks the end of a string in C.</p>\n\n<hr>\n\n<p>That being said, you should probably think about restructuring your module to only <em>once</em> check for the other extension and save the result in a variable.</p>\n"}], "owner": {"reputation": 3627, "user_id": 3014890, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/EF8lG.png?s=128&g=1", "display_name": "Paradoxis", "link": "https://stackoverflow.com/users/3014890/paradoxis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "closed_date": 1496827103, "accepted_answer_id": 44407713, "answer_count": 1, "score": 0, "last_activity_date": 1532430272, "creation_date": 1496824189, "last_edit_date": 1532430272, "question_id": 44407439, "link": "https://stackoverflow.com/questions/44407439/wrapped-method-ends-up-in-the-false-block-as-but-direct-function-call-doesnt", "closed_reason": "Duplicate", "title": "Wrapped method ends up in the &#39;false&#39; block as but direct function call doesn&#39;t", "body": "<p><strong>Note:</strong> I come from a Python / PHP related background and don't have too much experience with C.</p>\n\n<p>I'm currently writing a PHP extension that needs to check if another module is loaded, for this I've copied and pasted the following snippet of code throughout my extension:</p>\n\n<pre><code>#include \"php.h\"\n\nconst char* name = \"hash\";\n\nif (zend_hash_str_exists(&amp;module_registry, name, sizeof(name) - 1)) {\n    return; // Doesn't end up here, module is loaded\n}\n\n// Returns true and thus ends up here\n</code></pre>\n\n<p>I decided to put this into it's own method to make my code a lot more clean, however whenever I do this, the method seems to return <code>FALSE</code> or <code>NULL</code>. This is the method I'm using:</p>\n\n<pre><code>#include \"php.h\"\n\nzend_bool extension_module_exists(const char* name)\n{\n    return zend_hash_str_exists(&amp;module_registry, name, sizeof(name) - 1);\n}\n\nconst char* name = \"hash\";\n\nif (extension_module_exists(name) == false) {\n    return; // Now I end up here\n}\n</code></pre>\n\n<p>Could someone give me an indication of what I might be doing wrong?\nThank you.</p>\n"}, {"tags": ["c", "gcc", "assembly", "compiler-optimization"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1496822443, "post_id": 44406798, "comment_id": 75812535, "body": "<a href=\"http://c2.com/cgi/wiki?PrematureOptimization\" rel=\"nofollow noreferrer\">Premature optimization is the root of all evil</a>"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1496822448, "post_id": 44406798, "comment_id": 75812537, "body": "Have you <i>measured</i> the performance?"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 3, "creation_date": 1496822457, "post_id": 44406798, "comment_id": 75812540, "body": "Relying on compiler to magically optimize things for you is usually a hopeless practice."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1496822542, "post_id": 44406798, "comment_id": 75812601, "body": "I don&#39;t think a compiler is <i>ever</i> allowed to optimize a library call away. You could link a library where <code>printf()</code> has side-effects the compiler can&#39;t know about at the compile stage."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496822556, "post_id": 44406798, "comment_id": 75812605, "body": "Your code invoke UB, <code>%x</code> is for <code>unsigned int</code>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 6, "creation_date": 1496822596, "post_id": 44406798, "comment_id": 75812638, "body": "@FelixPalmen No, the compiler can because <code>printf()</code> is define by C standard."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1496822642, "post_id": 44406798, "comment_id": 75812676, "body": "I believe that requiring GCC to be able to parse <i>all</i> the printf formats is unrealistic. Recognising that no format is present is simple, parsing an eventual format is not."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1496822920, "post_id": 44406798, "comment_id": 75812867, "body": "@MargaretBloom when the format is a string literal and the argument can be traced as a constant expression, it seems realistic to do compile-time detection"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496823106, "post_id": 44406798, "comment_id": 75812996, "body": "I&#39;d conjecture that in real code the occurrences of this is somewhat limited; if you wanted to output 1234 you could have just written <code>puts(&quot;1234&quot;);</code> instead of jumping through hoops."}, {"owner": {"reputation": 707, "user_id": 5413164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97914965b4454c77a6c2891a9a4435cc?s=128&d=identicon&r=PG&f=1", "display_name": "weiweishuo", "link": "https://stackoverflow.com/users/5413164/weiweishuo"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496823189, "post_id": 44406798, "comment_id": 75813042, "body": "@Stargateur I have test using <code>%d</code>, and the same result."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1496823324, "post_id": 44406798, "comment_id": 75813141, "body": "@weiweishuo Have you found any cases where GCC optimizes <code>printf</code>? Maybe it&#39;s not considered an important optimization. Are you really calling <code>printf</code> with literal arguments in an inner loop where the performance is critical?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user784668"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1496823372, "post_id": 44406798, "comment_id": 75813181, "body": "@Stargateur Actually, passing an <code>int</code> for <code>%x</code> may be well-defined, as <code>va_arg</code> allows mixing signedness (7.15.1.1 in C99). GCC and Clang seem to agree with this interpretation, as they don&#39;t warn even with <code>-Wformat=2</code>."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1496823400, "post_id": 44406798, "comment_id": 75813199, "body": "Lesson learned: Instead of &quot;I thought&quot;, go for &quot;I tested&quot; next time. It&#39;s easy to point at a piece of code and figure out that this particular construct should have been optimized to something. It&#39;s actually hard to think of all possible future code someone might write and implement optimizations for it. Also, I don&#39;t think you&#39;d like a compiler that optimizes everything since it would be giant and incredibly slow."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1496823510, "post_id": 44406798, "comment_id": 75813265, "body": "@weiweishuo I didn&#39;t tell that it was going to solve your problem. I agree with Barmar. This optimization is not important. IO will be always slow. If you want performance don&#39;t use IO. <code>printf()</code> or <code>puts()</code> are similar. P.S: try <code>printf(&quot;0x1234\\n&quot;);</code>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1496823621, "post_id": 44406798, "comment_id": 75813327, "body": "@Fanael Thank, my compiler don&#39;t show any warning, that explain why. But it&#39;s better to use <code>unsigned int</code> anyway."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1496823819, "post_id": 44406798, "comment_id": 75813471, "body": "@M.M GCC still needs to figure the correct string to output based on the format. It&#39;s surely possible to implement this optimisation but maybe it was regarded as not worth the troubles of maintaining a duplicate of <code>printf</code>. Maybe in a couple of years we&#39;ll get it? :)"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1496824817, "post_id": 44406798, "comment_id": 75814106, "body": "@FelixPalmen yes it can. That&#39;s why gcc has <code>-fno-builtin</code> to disable the optimization of functions like <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.2.2/gcc/Other-Builtins.html#Other-Builtins\" rel=\"nofollow noreferrer\"><code>malloc, memcpy, memset, pow, printf, sincos, stpcpy, stpncpy...</code></a>"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1496826590, "post_id": 44406798, "comment_id": 75815393, "body": "<code>printf</code> is slower than <code>puts</code> because <code>printf</code> needs to parse the format string even if there is no format directive in it while <code>puts</code> prints its content verbatim. And both use the same buffer; so if buffering is your need, <code>puts</code> is also adequate. Note: that you hope on such an optimisation is very highly improbable (compiler would  needs to know to much about your code and needs)."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1496826975, "post_id": 44406798, "comment_id": 75815677, "body": "<code>and optimize to code like this: puts(&quot;1234&quot;);</code> ... gcc does not have AI yet. You expect too much from optimization."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496844467, "post_id": 44406798, "comment_id": 75828847, "body": "@Fanael if you read the standard strictly, then <code>printf(&quot;%x&quot;, 1);</code> is UB but <code>printf(&quot;%lx&quot;, -1);</code> is not UB.  Personally I interpret this as the specification of printf being defective.  <a href=\"https://stackoverflow.com/questions/4664100/does-printfx-1-invoke-undefined-behavior\">Link to thread on the topic</a>"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505252666, "post_id": 44414156, "comment_id": 79334389, "body": "It turns out that clang will optimize <code>const char fmt[] =  = {&#39;h&#39;, &#39;i&#39;, &#39;\\n&#39;, 0};</code> / <code>printf(fmt);</code> into a <code>puts</code>.  <a href=\"https://godbolt.org/g/aTQRKX\" rel=\"nofollow noreferrer\">godbolt.org/g/aTQRKX</a> But for gcc, it does literally have to be a string literal.  (At least indirectly; <code>const char*fmt = &quot;hi\\n&quot;;</code> and then passing that to printf optimizes, as long as there are no other args to printf.)"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505263234, "post_id": 44414156, "comment_id": 79337039, "body": "Interesting observation, @Peter. I had not considered that variation, and I&#39;m honestly kind of surprised that GCC&#39;s pattern-matching optimization does not work there."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505263757, "post_id": 44414156, "comment_id": 79337148, "body": "I was surprised too, but it makes some sense.  I guess it doesn&#39;t look at char-arrays or their initializers as string constants, since it would have to check that they contain only a single <code>0</code> byte at the end.  You can kind of see this in the asm output where gcc uses separate <code>.byte</code> directives instead of a <code>.asciz</code>, but clang notices the string-like nature and emits <code>.asciz</code> as well as doing the puts optimization."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505264391, "post_id": 44414156, "comment_id": 79337263, "body": "Hmm, I wonder if there are any real-life missed-optimizations with <code>strlen()</code> or <code>strchr()</code> on char arrays instead of strings?  This printf/puts one seems pretty artificial for a char array."}], "tags": [], "owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "is_accepted": false, "score": 6, "last_activity_date": 1505228315, "last_edit_date": 1592644375, "creation_date": 1496842271, "answer_id": 44414156, "question_id": 44406798, "link": "https://stackoverflow.com/questions/44406798/why-didnt-gcc-optimize-this-printf-to-puts/44414156#44414156", "title": "Why didn&#39;t GCC optimize this &#39;printf&#39; to &#39;puts&#39;?", "body": "<blockquote>\n<p>These codes in my project are quite low-level, and they might cause the performance bottleneck.</p>\n</blockquote>\n<p>First off, I can assuage your fears that this is not possible. The overhead of console I/O is <em>tremendous</em> (relatively speaking), so that will always be the bottleneck in your code, no matter what means you use to do it.</p>\n<blockquote>\n<p>I thought gcc should realize that <code>a</code> is a literal integer, and optimize to code like this:</p>\n<pre><code>puts(&quot;1234&quot;);\n</code></pre>\n</blockquote>\n<p>Clearly it doesn't. GCC (and Clang) <a href=\"https://github.com/gcc-mirror/gcc/blob/061c331bec278599a7b60609ae46260d17878662/gcc/gimple-fold.c#L3230\" rel=\"nofollow noreferrer\"><em>does</em> perform an optimization where <code>printf(&quot;...\\n&quot;);</code> is transformed into <code>puts(&quot;...&quot;);</code></a>, as you can see <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,source:%27%23include+%3Cstdio.h%3E%0A%0Avoid+Print(void)%0A%7B%0A++++printf(%22Hello,+world%5Cn%22)%3B%0A%7D%0A%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%231%27,t:%270%27)),k:25.518341307814996,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:g63,filters:(b:%270%27,commentOnly:%270%27,directives:%270%27,intel:%270%27),options:%27-xc+-m32+-O2%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+gcc+6.3+(Editor+%231,+Compiler+%231)%27,t:%270%27)),k:41.14832535885168,l:%274%27,m:100,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:clang391,filters:(b:%270%27,commentOnly:%270%27,directives:%270%27,intel:%270%27),options:%27-xc+-m32+-O2%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+clang+3.9.1+(Editor+%231,+Compiler+%232)%27,t:%270%27)),k:33.33333333333333,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4\" rel=\"nofollow noreferrer\">here</a>, but this only happens when you use <em>string literals</em> with <code>printf</code>. The optimizer doesn't (currently) peek into the format string, parse it, and optimize around it. You called <code>printf</code>, so you get <code>printf</code>.</p>\n<p>Compiler optimizations aren't <em>guaranteed</em>, so you shouldn't write code that <em>relies</em> on them without first verifying that the desired optimizations are in fact being applied under all circumstances in which you are interested (including code variations, compiler versions, target platforms, etc.).</p>\n<p>If you'd like to suggest this as a possible improvement for the GCC optimizer, you can suggest an enhancement on <a href=\"https://gcc.gnu.org/bugzilla/\" rel=\"nofollow noreferrer\">their Bugzilla</a>. But don't hold your breath on it being implemented any time soon. The logic required to implement this type of optimization is not really worth the effort, considering the real-world performance improvements that could be expected are minimal at best (see above).</p>\n<p>In the meantime, if you <em>absolutely</em> require this optimization with minimal changes to your code, then you can use <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Stringizing.html#Stringizing\" rel=\"nofollow noreferrer\">some macro hackery</a>:</p>\n<pre><code>#define STRINGIFY_INTERNAL(x)  #x\n#define STRINGIFY(x)           STRINGIFY_INTERNAL(x)\n\n#define foo(a)                 puts(STRINGIFY(a))\n</code></pre>\n<p>This does produce the desired output:</p>\n<pre><code>.LC0:\n        .string &quot;0x1234&quot;\nMyFunction:\n        sub     esp, 24\n        push    OFFSET FLAT:.LC0\n        call    puts\n        xor     eax, eax\n        add     esp, 28\n        ret\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1499873775, "post_id": 44597247, "comment_id": 77097485, "body": "This doesn&#39;t really explain anything: <code>printf(&quot;123\\n&quot;);</code> <a href=\"https://godbolt.org/g/Gr9uqZ\" rel=\"nofollow noreferrer\"><i>is</i> replaced by a call to <code>puts</code></a>, while the OP&#39;s code isn&#39;t, despite the original function being one and the same: <code>printf</code>, so the compiler does know something about it."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1499875124, "post_id": 44597247, "comment_id": 77098436, "body": "@Ruslan: It would be unusual for implementations of printf to do any kind of translation with strings that don&#39;t contain <code>%</code>.  It think gcc is perhaps being a bit presumptuous in assuming that they won&#39;t, but the further it goes into the realm of non-trivial format specifiers, the greater the likelihood of trouble.  I did, however, forget another point: one of the uses of code containing printf with non-trivial format strings is to <i>test</i> printf implementations.  If a programmer writes <code>printf(&quot;Hello&quot;);</code> it&#39;s likely the programmer is more interested in outputting <code>Hello\\n</code> than..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1499875303, "post_id": 44597247, "comment_id": 77098579, "body": "...in testing whether <code>printf</code> can handle such strings correctly.  But given <code>printf(&quot;%d\\n&quot;,-2147483647-1);</code> a programmer may not be interested in outputting <code>-2147483648\\n</code> but rather in confirming that a particular <code>printf</code> implementation handles the <code>INT_MIN</code> case correctly.  Having the compiler do the formatting itself would undermine that goal."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505252821, "post_id": 44597247, "comment_id": 79334450, "body": "re: testing <code>printf</code> or <code>memcpy</code> or whatever implementations: use <code>gcc -fno-builtin-printf</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505253018, "post_id": 44597247, "comment_id": 79334528, "body": "glibc <code>printf</code> <i>does</i> allow customizations by registering new conversions, or even overriding standard conversion specifiers.  (<a href=\"https://www.gnu.org/software/libc/manual/html_node/Customizing-Printf.html\" rel=\"nofollow noreferrer\">gnu.org/software/libc/manual/html_node/Customizing-Printf.h&zwnj;&#8203;tml</a>).  So in a GNU system, it&#39;s only safe to transform <code>printf</code> calls when the format string contains no conversions, because stuff that runs before <code>main</code> could have changed the behaviour for <code>%x</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505257411, "post_id": 44597247, "comment_id": 79335780, "body": "@PeterCordes: Other library versions of printf might offer additional features, like the ability to register conversions that use something other than <code>%</code>, though I don&#39;t know of any.  In my own embedded code, I sometimes use a formatting function which uses codes <code>\\200</code> to <code>\\377</code> for formatting (more compact and easier to parse than % strings if code doesn&#39;t need to output anything that isn&#39;t ASCII) but don&#39;t call it <code>printf</code>.  In any case, what do you think about the point in my comment re testing <code>printf</code> implementations."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505259723, "post_id": 44597247, "comment_id": 79336334, "body": "Like I commented earlier, if you want to test the library <code>printf</code>, use <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html\" rel=\"nofollow noreferrer\"><code>gcc -fno-builtin-printf</code></a>.  Leaving out useful but safe optimizations to standard functions doesn&#39;t make sense for gcc or clang, especially not for testability because it&#39;s easy to make the compiler not use any pre-conceived ideas about what a function with that name should do.  (This optimization would not be 100% safe in GNU C, and also not be very useful.)"}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1497643900, "creation_date": 1497643900, "answer_id": 44597247, "question_id": 44406798, "link": "https://stackoverflow.com/questions/44406798/why-didnt-gcc-optimize-this-printf-to-puts/44597247#44597247", "title": "Why didn&#39;t GCC optimize this &#39;printf&#39; to &#39;puts&#39;?", "body": "<p>A conforming library implementation could include functions beyond those defined by the Standard, which would change the way standard functions behave.  For example, a library might include a <code>__select_alternate_digits</code> function that, when invoked, would cause succeeding calls to <code>printf</code> to display numbers using something other than the normal digits.</p>\n\n<p>With such a library, given the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt; // Could legitimately include functions that aren't\n                  // defined by the Standard, but which start with __.\n\nint main(void)\n{\n  __select_alternate_digits(\"\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079\");\n  printf(\"%d\",123);\n  __select_alternate_digits(0); // Reset to default set      \n}\n</code></pre>\n\n<p>the call to <code>__select_alternate_digits</code> might cause the above program to output \"\u00b9\u00b2\u00b3\" rather than \"123\".  If the compiler bundled its own <code>printf</code> function, it could know that its behavior wasn't going to be affected by any other function calls.  If it's using an outside library, however, then unless the program is completely free of any calls to functions the compiler knows nothing about, a quality compiler should assume those functions might have effects the compiler can't predict.</p>\n"}], "owner": {"reputation": 707, "user_id": 5413164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97914965b4454c77a6c2891a9a4435cc?s=128&d=identicon&r=PG&f=1", "display_name": "weiweishuo", "link": "https://stackoverflow.com/users/5413164/weiweishuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1670, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1505228315, "creation_date": 1496822296, "last_edit_date": 1496842620, "question_id": 44406798, "link": "https://stackoverflow.com/questions/44406798/why-didnt-gcc-optimize-this-printf-to-puts", "title": "Why didn&#39;t GCC optimize this &#39;printf&#39; to &#39;puts&#39;?", "body": "<p>Here is my test code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstatic inline void foo(int a){\n    printf(\"%x\\n\", a);  \n}\n\nint main(void){\n    foo(0x1234);    \n    return 0;\n}\n</code></pre>\n\n<p>I thought GCC should realize that <code>a</code> is a literal integer, and optimize to code like this:</p>\n\n<pre><code>puts(\"1234\");\n</code></pre>\n\n<p>But I got the following assembly code:</p>\n\n<pre><code>\u25020x8048341 &lt;main+17&gt;     push   $0x1234                                        \n\u25020x8048346 &lt;main+22&gt;     push   $0x80484e0                                  \n\u25020x804834b &lt;main+27&gt;     push   $0x1                                        \n\u25020x804834d &lt;main+29&gt;     call   0x8048310 &lt;__printf_chk@plt&gt; \n</code></pre>\n\n<p>There exists a lot of such code in my project, because I always believed that GCC would optimize for me, and even in some context where could simply use 'write()', I insisted using <code>printf</code>, because I thought I would gain benefit from its buffer mechanism.</p>\n\n<p>Now I feel regret, for the overhead of paring a format string will kill any gain I have. These codes in my project are quite low-level, and they might cause the performance bottleneck.</p>\n"}, {"tags": ["c", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1496818720, "post_id": 44405617, "comment_id": 75810222, "body": "C or C++? Pick a language please."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1496818731, "post_id": 44405617, "comment_id": 75810231, "body": "If you&#39;re programming in C then please don&#39;t add the C++ tag. While the language share a common ancestor and have similar syntax, they are still very different languages."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1496818792, "post_id": 44405617, "comment_id": 75810274, "body": "As for your problem, is the question about how to catch <code>CTRL-C</code>, how to nicely tell threads to end, or a combination of both (in which case you should post two questions)? If you haven&#39;t done it yet (weird, since you have been a member for over three years), then please take some time to <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496819610, "post_id": 44405617, "comment_id": 75810798, "body": "For the first part of this problem, <a href=\"https://stackoverflow.com/questions/18291284/handle-ctrlc-on-win32\">see this question</a>"}, {"owner": {"reputation": 371, "user_id": 2039556, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19301b81d0848bfe89d8222251108ba5?s=128&d=identicon&r=PG", "display_name": "Pravin", "link": "https://stackoverflow.com/users/2039556/pravin"}, "edited": false, "score": 0, "creation_date": 1496821205, "post_id": 44405617, "comment_id": 75811755, "body": "What is meant by run infinitely? Had you use while(1) to do so? Or client task handle in any other API which takes control of thread? Could you please share thread pseudo code? There are 3 possible solution, 1. you can watch global variable in while(1) to trigger thread cleanup, 2. Before calling any blocking API in thread you can set thread cancel point and can send cancel from signal handler. or 3. you can have signal handler for thread (Don&#39;t know about window, for linux <a href=\"https://stackoverflow.com/questions/24643311/unix-pthreads-and-signals-per-thread-signal-handlers\">refer</a> )"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 371, "user_id": 2039556, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19301b81d0848bfe89d8222251108ba5?s=128&d=identicon&r=PG", "display_name": "Pravin", "link": "https://stackoverflow.com/users/2039556/pravin"}, "edited": false, "score": 0, "creation_date": 1496824056, "post_id": 44405617, "comment_id": 75813631, "body": "So once you have the [Ctrl]+[C] sorted out, how are you planning to go about a user clicking the console&#39;s close button? @Pravin: I&#39;m sorry, but Windows has a lot more options than you list. After all, multithreading was built into the system from the start. There is a rich synchronization API, that usually completely eliminates the need to poll (like your proposed solutions will)."}], "answers": [{"comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1496877357, "post_id": 44408045, "comment_id": 75846869, "body": "It may be worth noting that in Windows, <code>signal_handler</code> runs in a separate thread (and the main thread continues to run in parallel) whereas in Linux the main thread is interrupted in order to run <code>signal_handler</code>."}], "tags": [], "owner": {"reputation": 491, "user_id": 5589495, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f0709007ffe60499a45c5bd1f9a8cbf1?s=128&d=identicon&r=PG", "display_name": "Deb S", "link": "https://stackoverflow.com/users/5589495/deb-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1496825919, "creation_date": 1496825919, "answer_id": 44408045, "question_id": 44405617, "link": "https://stackoverflow.com/questions/44405617/how-to-close-all-the-threads-before-main-thread-by-interrupting-ctrlc/44408045#44408045", "title": "How to close all the threads before main thread by interrupting ctrl+c?", "body": "<p>For Windows </p>\n\n<pre><code>#include &lt;windows.h&gt; \n#include &lt;stdio.h&gt; \n\nBOOL WINAPI signal_handler(DWORD signal) {\n\n    if (signal == CTRL_C_EVENT){\n        printf(\"CTRL C caught here .\\n\");\n    }\n    return TRUE;\n}\n\nmain()\n{\n    ....\n    SetConsoleCtrlHandler(signal_handler, TRUE);\n\n   .....\n\n     printf(\"This should appear after signal_handler\\n\");\n}\n</code></pre>\n\n<p>For linux </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;signal.h&gt;    \n\nvoid signal_handler() \n{\n    printf(\"CTRL C caught here .\\n\");\n}\n\nmain() \n{\n\n    ...\n    // SIGINT is signal name create  when Ctrl+c will pressed \n    signal(SIGINT,signal_handler);  \n\n\n\n    printf(\"This should appear after signal_handler\\n\");\n\n}\n</code></pre>\n\n<p>Once ctrl-c is captured you can close all the threads and other cleanup stuff </p>\n"}], "owner": {"reputation": 27, "user_id": 3012369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a97152b915e8a2bb4f772718b69bd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Sultan23", "link": "https://stackoverflow.com/users/3012369/sultan23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 44408045, "answer_count": 1, "score": 0, "last_activity_date": 1496825919, "creation_date": 1496818615, "last_edit_date": 1496819549, "question_id": 44405617, "link": "https://stackoverflow.com/questions/44405617/how-to-close-all-the-threads-before-main-thread-by-interrupting-ctrlc", "title": "How to close all the threads before main thread by interrupting ctrl+c?", "body": "<p>I have created pool of 5 threads using <code>_beginthread()</code> in C. All the threads from pool will run infinitely to do job received from client. For example, when client will be connected, the free thread from pool will handle this. After completing its task the thread will wait for next client. Now my problem is that, whenever I enter <code>ctrl+c</code> from server, the program get terminated. But I want to close all the running and waiting threads from pool before terminating the main thread.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496817386, "post_id": 44405188, "comment_id": 75809430, "body": "Please format your code correctly."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1496817405, "post_id": 44405188, "comment_id": 75809442, "body": "Please <b><i>properly</i></b> indent your code. Machine (Compiler) can read and compile anything, but for humans, it needs to make a little <i>sense</i> while reading a block of text as <i>code</i>. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1496817422, "post_id": 44405188, "comment_id": 75809456, "body": "<code>main(void)</code>...<code>int main(void)</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1496817454, "post_id": 44405188, "comment_id": 75809477, "body": "<i>Questions seeking debugging help (why isn&#39;t this code working?) must include the desired behavior, a specific problem or error and the <b>shortest code necessary</b> to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i>"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 2, "creation_date": 1496817674, "post_id": 44405188, "comment_id": 75809583, "body": "<code>scanf(&quot; %c&quot;, ans);</code> -&gt; <code>scanf(&quot; %c&quot;, &amp;ans)</code> ?"}, {"owner": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496817705, "post_id": 44405188, "comment_id": 75809608, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5406935/reading-a-string-with-scanf\">Reading a string with scanf</a>"}, {"owner": {"reputation": 3, "user_id": 7218924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cc88e34f7c92034f851e88b9701679?s=128&d=identicon&r=PG&f=1", "display_name": "O.Hernandez", "link": "https://stackoverflow.com/users/7218924/o-hernandez"}, "edited": false, "score": 0, "creation_date": 1496817887, "post_id": 44405188, "comment_id": 75809740, "body": "Thanks for the tip. Actually I am not sure what is the problem so that&#39;s why I posted the entire code."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1496817927, "post_id": 44405188, "comment_id": 75809770, "body": "@O.Hernandez and that is the purpose of asking for <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. In the process of creating MCVE, most of the time, you will find the actual issue yourself. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1232, "user_id": 7890197, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dLDMZ.jpg?s=128&g=1", "display_name": "Badda", "link": "https://stackoverflow.com/users/7890197/badda"}, "edited": false, "score": 0, "creation_date": 1496817959, "post_id": 44405188, "comment_id": 75809803, "body": "@Badda VTC as typo then?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1496818139, "post_id": 44405188, "comment_id": 75809912, "body": "@O.Hernandez AKA &#39;I didn&#39;t do any debugging so that&#39;s why I posted the entire code&#39;."}, {"owner": {"reputation": 3, "user_id": 7218924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cc88e34f7c92034f851e88b9701679?s=128&d=identicon&r=PG&f=1", "display_name": "O.Hernandez", "link": "https://stackoverflow.com/users/7218924/o-hernandez"}, "edited": false, "score": 0, "creation_date": 1496818396, "post_id": 44405188, "comment_id": 75810050, "body": "Thanks guys for tips again! Yes I found something I forgot to add also that&#39;s why it was not working the way I wanted to. I am glad a community like you guys exist to help us who are new to programming learn! :)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1496818655, "post_id": 44405188, "comment_id": 75810192, "body": "@SouravGhosh Leaving out any of the operators relating to pointers/addresses is more likely a logical mistake (the kind appropriately being helped with here) than a simple typo. Isn&#39;t it?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1496818746, "post_id": 44405188, "comment_id": 75810241, "body": "@Yunnosch No, it&#39;s a logical mistake when you make that in all the occurrences, not in one particular case."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1496818790, "post_id": 44405188, "comment_id": 75810269, "body": "@SouravGhosh Good point."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1496823251, "post_id": 44405188, "comment_id": 75813082, "body": "The root of your problem here is that you either compile your project with no warnings enabled, or that you ignore the warnings."}], "answers": [{"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": true, "score": 0, "last_activity_date": 1496817669, "creation_date": 1496817669, "answer_id": 44405309, "question_id": 44405188, "link": "https://stackoverflow.com/questions/44405188/program-in-c-crashes-after-the-2nd-input-is-requested/44405309#44405309", "title": "Program in C crashes after the 2nd input is requested", "body": "<p>You have forgot <code>&amp;</code> inside <code>scanf</code> in line number <code>276</code>, So use this:</p>\n\n<pre><code>scanf(\" %c\", &amp;ans);\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>scanf(\" %c\", ans);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7218924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cc88e34f7c92034f851e88b9701679?s=128&d=identicon&r=PG&f=1", "display_name": "O.Hernandez", "link": "https://stackoverflow.com/users/7218924/o-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 44405309, "answer_count": 1, "score": -3, "last_activity_date": 1496817669, "creation_date": 1496817309, "last_edit_date": 1496817590, "question_id": 44405188, "link": "https://stackoverflow.com/questions/44405188/program-in-c-crashes-after-the-2nd-input-is-requested", "title": "Program in C crashes after the 2nd input is requested", "body": "<p>I am new to the C language and I know there are a few Q&amp;A out there about program crashes, but I think in this case my one is a bit specific and would prefer to make the question. I am attempting a Poker game and after running the program it crashes after I enter the \"Y\" or \"N\" command. I would appreciate any insights on how to solve this. Here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define FALSE 0\n#define TRUE 1\n\nvoid printGreeting();\nint getBet();\nchar getSuit(int suit);\nchar getRank(int rank);\nvoid getFirstHand(int cardRank[], int cardSuit[]);\nvoid getFinalHand(int cardRank[], int cardSuit[], int finalRank[],\n                  int finalSuit[], int ranksinHand[],\n                  int suitsinHand[]);\nint analyzeHand(int ranksinHand[], int suitsinHand[]);\n\nmain(void) {\n    int bet;\n    int bank = 100;\n    int i;\n    int cardRank[5];\n    int cardSuit[5];\n\n    int finalRank[5];\n    int finalSuit[5];\n    int ranksinHand[13];\n    int suitsinHand[4];\n    int winnings;\n    time_t t;\n    char suit, rank, stillPlay;\n\n    //print greeting\n    printGreeting();\n\n    // plays a new hand of draw poker\n\n    do {\n        bet = getBet();\n        srand(time(&amp;t));\n        getFirstHand(cardRank, cardSuit);\n        printf(\"Your five cards: \\n\");\n\n        for (i=0; i&lt;5; i++) {\n            suit = getSuit(cardSuit[i]);\n            rank = getRank(cardRank[i]);\n            printf(\"Card #%d: %c%c\\n\", i+1, rank, suit);\n        }\n\n\n        for (i=0; i&lt;4; i++) {\n            suitsinHand[i] = 0;\n        }\n\n        for (i=0; i&lt;13; i++) {\n            ranksinHand[i] = 0;\n        }\n\n        getFinalHand(cardRank, cardSuit, finalRank, finalSuit,\n                     ranksinHand, suitsinHand);\n\n        printf(\"Your final five cards: \\n\");\n        for (i = 0; i &lt; 5; i++) {\n            suit = getSuit(finalSuit[i]);\n            rank = getRank(finalRank[i]);\n            printf(\"Card #%d: %c%c\\n\", i+1, rank, suit);\n        }\n\n        winnings = analyzeHand(ranksinHand, suitsinHand);\n        printf(\"You won %d!\\n\", bet*winnings);\n        bank = bank - bet + (bet*winnings);\n        printf(\"\\nYour bank is now %d.\\n\", bank);\n        printf(\"\\nDo you want to play again? \");\n        scanf(\" %c\", &amp;stillPlay);\n    } while (toupper(stillPlay) == 'Y');\n\n\n    return 0;\n}\n\n/******************************************************************/\n\n// Print a quick greeting as well as tell the users the value\n// of different winning hands\n\nvoid printGreeting() {\n\n    printf(\"Here are the rules: \\n\");\n    printf(\"You start with 100 credits, and you make a bet from \");\n    printf(\"1 to 5 credits. \\n\");\n    printf(\"You are dealt 5 cards, and then you choose which \");\n    printf(\"cards to keep \");\n    printf(\"or discard.\\n\");\n    printf(\"You want to make the best possible hand. \\n\");\n    printf(\"\\nHere is the table for winnings (assuming a \");\n    printf(\"bet of 1 credit):\");\n    printf(\"\\nPair\\t\\t\\t\\t1 credit\");\n    printf(\"\\nTwo Pairs\\t\\t\\t2 credits\");\n    printf(\"\\nThree Pairs\\t\\t\\t3 credits\");\n    printf(\"\\nStraight\\t\\t\\t4 credits\");\n    printf(\"\\nFlush\\t\\t\\t\\t5 credits\");\n    printf(\"\\nFull House\\t\\t\\t8 credits\");\n    printf(\"\\nFour of a Kind\\t\\t\\t10 credits\");\n    printf(\"\\nStraight Flush\\t\\t\\t20 credits\");\n    printf(\"\\n\\nHave Fun!!\\n\\n\");\n}\n\n// Function to deal the first five cards\n\nvoid getFirstHand(int cardRank[], int cardSuit[]) {\n    int i, j;\n    int cardDup;\n\n    for (i=0; i &lt; 5; i++) {\n        cardDup = 0;\n        do {\n            cardRank[i] = (rand() %13);\n            cardSuit[i] = (rand() %4);\n\n            for (j=0; j &lt; i; j++) {\n                if ((cardRank[i] == cardRank[j]) &amp;&amp;\n                    (cardSuit[i] == cardSuit[j])) {\n                    cardDup = 1;\n                }\n            }\n        } while (cardDup == 1);\n    }\n}\n\n// Function that changes the Suit integer value to a character\n// representing the suit\n\nchar getSuit(int suit) {\n    switch (suit) {\n    case 0:\n        return('c');\n    case 1:\n        return('d');\n    case 2:\n        return('h');\n    case 3:\n        return('s');\n    }\n}\n\n// Function that changes the rank integer value to a character\n// representing the rank\n\nchar getRank(int rank) {\n    switch (rank) {\n    case 0:\n        return('A');\n    case 1:\n        return('2');\n    case 2:\n        return('3');\n    case 3:\n        return('4');\n    case 4:\n        return('5');\n    case 5:\n        return('6');\n    case 6:\n        return('7');\n    case 7:\n        return('8');\n    case 8:\n        return('9');\n    case 9:\n        return('T');\n    case 10:\n        return('J');\n    case 11:\n        return('Q');\n    case 12:\n        return('K');\n    }\n}\n\n// Function to get the user's bet, between 1 and 5\n\nint getBet() {\n    int bet;\n\n    do {\n        printf(\"How much do you want to bet? (Enter a number \");\n        printf(\"1 to 5, or 0 to quit the game):\");\n        scanf(\" %d\", &amp;bet);\n\n        if (bet &gt;= 1 &amp;&amp; bet &lt;= 5) {\n            return(bet);\n        } else if (bet == 0) {\n            exit(1);\n        } else {\n            printf(\"\\n\\nPlease enter a bet from 1-5 or \");\n            printf(\"0 to quit the game. \\n\");\n        }\n    } while ((bet &lt; 0) || (bet &gt; 5));\n}\n\n// Last function reviews the final hand and determines the value of\n// the hand\n\nint analyzeHand(int ranksinHand[], int suitsinHand[]) {\n    int num_consec = 0;\n    int i, rank, suit;\n    int straight = FALSE;\n    int flush = FALSE;\n    int four = FALSE;\n    int three = FALSE;\n    int pairs = FALSE;\n\n    for (suit = 0; suit &lt; 4; suit ++)\n        if (suitsinHand[suit] == 5)\n            flush = TRUE;\n    rank = 0;\n    while (ranksinHand[rank] == 0)\n        rank++;\n    for (; rank &lt; 13 &amp;&amp; ranksinHand[rank]; rank++)\n        num_consec++;\n    if (num_consec == 5) {\n        straight = TRUE;\n    }\n    for (rank = 0; rank &lt; 13; rank++) {\n        if (ranksinHand[rank] == 4)\n            four = TRUE;\n        if (ranksinHand[rank] == 3)\n            three = TRUE;\n        if (ranksinHand[rank] == 2)\n            pairs++;\n    }\n\n    if (straight &amp;&amp; flush) {\n        printf(\"Straight Flush\\n\\n\");\n        return(20);\n    } else if (four) {\n        printf(\"Four of a Kind\\n\\n\");\n        return(10);\n    } else if (three &amp;&amp; pairs == 1) {\n        printf(\"Full House\\n\\n\");\n        return(8);\n    } else if (flush) {\n        printf(\"Flush\\n\\n\");\n        return(5);\n    } else if (straight) {\n        printf(\"Straight\\n\\n\");\n        return(4);\n    } else if (three) {\n        printf(\"Three of a Kind\\n\\n\");\n        return(3);\n    } else if (pairs == 2) {\n        printf(\"Two Pairs\\n\\n\");\n        return(2);\n    } else if (pairs == 1) {\n        printf(\"Pair\\n\\n\");\n        return(1);\n    } else {\n        printf(\"High Card\\n\\n\");\n        return(0);\n    }\n}\n\nvoid getFinalHand(int cardRank[], int cardSuit[], int finalRank[],\n                  int finalSuit[], int ranksinHand[],\n                  int suitsinHand[]) {\n    int i, j, cardDup;\n    char suit, rank, ans;\n\n    for(i=0; i &lt; 5; i++) {\n        suit = getSuit(cardSuit[i]);\n        rank = getRank(cardRank[i]);\n        printf(\"Do you want to keep card #%d: %c%c\", i+1, rank, suit);\n        printf(\"\\nPlease answer (Y/N): \");\n        scanf(\" %c\", ans);\n        if (toupper(ans) == 'Y') {\n            finalRank[i] = cardRank[i];\n            finalSuit[i] = cardSuit[i];\n            ranksinHand[finalRank[i]]++;\n            suitsinHand[finalSuit[i]]++;\n            continue;\n        } else if (toupper(ans) == 'N') {\n            cardDup = 0;\n            do {\n                cardDup = 0;\n                finalRank[i] = (rand() % 13);\n                finalSuit[i] = (rand() % 4);\n\n                for (j=0; j &lt; 5; j++) {\n                    if ((finalRank[i] == finalRank[j]) &amp;&amp;\n                        (finalSuit[i] == finalSuit[j])) {\n                        cardDup = 1;\n                    }\n                }\n            } while (cardDup == 1);\n            ranksinHand[finalRank[i]]++;\n            suitsinHand[finalSuit[i]]++;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "linker", "raspberry-pi"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7768358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e07861cc4cdd7d59ac1904c0f6f412?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/7768358/jon"}, "edited": false, "score": 0, "creation_date": 1496895501, "post_id": 44405118, "comment_id": 75851132, "body": "Version is 2.1.0 if that helps."}, {"owner": {"reputation": 39, "user_id": 7768358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e07861cc4cdd7d59ac1904c0f6f412?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/7768358/jon"}, "edited": false, "score": 0, "creation_date": 1496896635, "post_id": 44405118, "comment_id": 75851405, "body": "I did this but am getting no output from terminal"}, {"owner": {"reputation": 39, "user_id": 7768358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e07861cc4cdd7d59ac1904c0f6f412?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/7768358/jon"}, "edited": false, "score": 0, "creation_date": 1496896943, "post_id": 44405118, "comment_id": 75851493, "body": "Nvm, got it. Needed to type ./a.out for output"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 39, "user_id": 7768358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e07861cc4cdd7d59ac1904c0f6f412?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/7768358/jon"}, "edited": false, "score": 0, "creation_date": 1496908725, "post_id": 44405118, "comment_id": 75857617, "body": "@Jon Cool!! You can also consider <a href=\"https://meta.stackexchange.com/q/5234/244062\">accepting an answer that helped you</a>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1496817389, "last_edit_date": 1592644375, "creation_date": 1496817029, "answer_id": 44405118, "question_id": 44404947, "link": "https://stackoverflow.com/questions/44404947/raspberry-pi-3-fann-create-standard-not-defined/44405118#44405118", "title": "Raspberry Pi 3 ,fann_create_standard not defined", "body": "<p>I believe, you need to change the order in which the library appears in the compilation statement.</p>\n<pre><code> gcc -lfann main.c\n</code></pre>\n<p>should be</p>\n<pre><code> gcc main.c -lfann\n</code></pre>\n<p>as the functions used in <code>main.c</code> are present in <code>libfann.so</code>.</p>\n<p>Quoting the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options\" rel=\"nofollow noreferrer\">online gcc manual</a>,</p>\n<blockquote>\n<p><code>-l library</code></p>\n<p>[....] It makes a difference where in the command you write this option; the linker searches and processes libraries and object files in the order they are specified. Thus, <code>foo.o -lz bar.o</code> searches library <code>z</code> after file <code>foo.o</code> but before <code>bar.o</code>. If <code>bar.o</code> refers to functions in <code>z</code>, those functions may not be loaded.</p>\n</blockquote>\n<p>In your case, you're facing similar scenario, for your case, the library should appear after the <code>main.c</code> as the functions from the library are used in <code>main.c</code></p>\n"}], "owner": {"reputation": 39, "user_id": 7768358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e07861cc4cdd7d59ac1904c0f6f412?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/7768358/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 44405118, "answer_count": 1, "score": 0, "last_activity_date": 1496817509, "creation_date": 1496816405, "last_edit_date": 1496817509, "question_id": 44404947, "link": "https://stackoverflow.com/questions/44404947/raspberry-pi-3-fann-create-standard-not-defined", "title": "Raspberry Pi 3 ,fann_create_standard not defined", "body": "<p>I recently downloaded the FANN(Fast artificial neural network) library via the synaptic manager for raspberry pi. I am trying to run the default application as shown below:</p>\n\n<pre><code> #include \"fann.h\"\n #include \"floatfann.h\"\n include \"fann_data.h\"\n\n int main()\n {\nconst unsigned int num_input = 2;\nconst unsigned int num_output = 1;\nconst unsigned int num_layers = 3;\nconst unsigned int num_neurons_hidden = 3;\nconst float desired_error = (const float) 0.001;\nconst unsigned int max_epochs = 500000;\nconst unsigned int epochs_between_reports = 1000;\n\nstruct fann *ann = fann_create_standard(num_layers, num_input,\n    num_neurons_hidden, num_output);\n\nfann_set_activation_function_hidden(ann, FANN_SIGMOID_SYMMETRIC);\nfann_set_activation_function_output(ann, FANN_SIGMOID_SYMMETRIC);\n\nfann_train_on_file(ann, \"xor.data\", max_epochs,\n    epochs_between_reports, desired_error);\n\nfann_save(ann, \"xor_float.net\");\n\nfann_destroy(ann);\n\nreturn 0;\n}\n</code></pre>\n\n<p>I am getting this output:</p>\n\n<pre><code>enter code here\n\n\n||=== Build: Debug in ArtificialNeuralNetworkExample (compiler: GNU GCC    Compi ler) ===|\nobj/Debug/main.o||In function `main':|\n/home/pi/Documents/ArtificialNeuralNetworkExample/main.c|14|undefined reference to `fann_create_standard'|\n/home/pi/Documents/ArtificialNeuralNetworkExample/main.c|17|undefined reference to `fann_set_activation_function_hidden'|\n/home/pi/Documents/ArtificialNeuralNetworkExample/main.c|18|undefined reference to `fann_set_activation_function_output'|\n/home/pi/Documents/ArtificialNeuralNetworkExample/main.c|20|undefined reference to `fann_train_on_file'|\n/home/pi/Documents/ArtificialNeuralNetworkExample/main.c|23|undefined reference to `fann_save'|\n/home/pi/Documents/ArtificialNeuralNetworkExample/main.c|25|undefined reference to `fann_destroy'|\n||=== Build failed: 6 error(s), 0 warning(s) (0 minute(s), 1 second(s)) ===|\n</code></pre>\n\n<p>Also tried linking the library using <code>gcc</code> as follows:</p>\n\n<pre><code>gcc -lfann main.c\n</code></pre>\n\n<p>Not sure what to do.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1496816182, "post_id": 44404831, "comment_id": 75808740, "body": "What  do you expect fopen to do with the function pointer?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1496816510, "post_id": 44404831, "comment_id": 75808926, "body": "It&#39;s because your CPU doesn&#39;t have the DWIM (Do What I Mean) instruction. Until then you need to actually tell the computer what to do because it can&#39;t read your mind."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1496818015, "post_id": 44404831, "comment_id": 75809838, "body": "Check your manual or manpage for the prototype of <code>fopen</code>. That is the contract you need to fulfil. These are the rules you have to obey. If there is a <code>const char *</code> as first parameter, YOU SHALL NOT PASS some weird fancy function pointer."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 2, "last_activity_date": 1496819009, "last_edit_date": 1496819009, "creation_date": 1496816532, "answer_id": 44404986, "question_id": 44404831, "link": "https://stackoverflow.com/questions/44404831/passing-a-function-pointer-as-parameter-to-fopen/44404986#44404986", "title": "Passing a function pointer as parameter to fopen", "body": "<p>You can't, but you can just call the function through the pointer appending <code>()</code>. For this to work, change your function to actually return <code>const char *</code> (or <code>char *</code>)</p>\n\n<p>Note you can't just return a pointer to your <code>buffer</code> because this is a local variable that is no longer existent when the function returns. You could pass a pointer to <code>buffer</code> from outside the function. Your prototype then should be</p>\n\n<pre><code>char *time_stamp(char *buf, size_t len);\n</code></pre>\n\n<p><strong>modified code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *time_stamp(char *buf, size_t len){\n    time_t rawtime;\n    struct tm * timeinfo;\n    time (&amp;rawtime);\n    timeinfo = localtime (&amp;rawtime);\n\n    strftime (buf,len,\"myFile_%F.txt\",timeinfo);\n    return buf;\n}\n\n\nint main ()\n{\n    char *(*filename_ptr)(char *, size_t);\n    filename_ptr = &amp;time_stamp;\n    char buffer[80];\n\n    FILE * fp;\n\n    fp = fopen (filename_ptr(buffer, 80), \"w+\");\n    fprintf(fp, \"%s %s %s %d\", \"We\", \"are\", \"in\", 2017);\n\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>There are other alternatives how to design this function. <a href=\"https://stackoverflow.com/users/8012646/neroku\">Neroku</a>'s answer is good when you are sure you never need the function in a threaded context. It simplifies the usage and there are even some standard C library functions designed in that way.</p>\n\n<p>The third way would be to make the buffer an <em>allocated object</em> by obtaining it from <code>malloc()</code>. This has the advantage of being thread-safe and not needing any extra arguments, the function itself controls the size of the buffer like in your original broken version. The disadvantage is that the <em>caller</em> must <code>free()</code> the memory when done with it. Example code for this (I don't recommend it here):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *time_stamp(){\n    time_t rawtime;\n    struct tm * timeinfo;\n    time (&amp;rawtime);\n    timeinfo = localtime (&amp;rawtime);\n\n    char *buf = malloc(80);\n    strftime (buf,80,\"myFile_%F.txt\",timeinfo);\n    return buf;\n}\n\n\nint main ()\n{\n    char *(*filename_ptr)();\n    filename_ptr = &amp;time_stamp;\n\n    FILE * fp;\n\n    char *filename = filename_ptr();\n    fp = fopen (filename, \"w+\");\n    free(filename);\n    fprintf(fp, \"%s %s %s %d\", \"We\", \"are\", \"in\", 2017);\n\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1496817740, "post_id": 44405024, "comment_id": 75809631, "body": "Not that it&#39;s relevant to the OP, but the <code>static</code> makes the function thread unsafe. Just to keep in mind ;)"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1496817886, "post_id": 44405024, "comment_id": 75809739, "body": "@FelixPalmen Yes, the code above is <i>thread unsafe</i>, but I am not striving for <i>thread safe</i> code."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1496818175, "post_id": 44405024, "comment_id": 75809930, "body": "In order to improve clarity of your answer and partially reduce risks with reusing it for similar future purposes, I recommed to edit that slightly risky assumption into the answer and explain in which way and in which circumstances the function needs to be used in order to be safe. Generally however, writing a threadsage function is preferrable to writing functions which can be used in a certain way inspite of being unsafe."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 2, "last_activity_date": 1496818438, "last_edit_date": 1496818438, "creation_date": 1496816706, "answer_id": 44405024, "question_id": 44404831, "link": "https://stackoverflow.com/questions/44404831/passing-a-function-pointer-as-parameter-to-fopen/44405024#44405024", "title": "Passing a function pointer as parameter to fopen", "body": "<p><code>fopen()</code> expects a <code>const char *</code> as the first argument:</p>\n\n<pre><code>FILE *fopen(const char *path, const char *mode);\n</code></pre>\n\n<p>In your function <code>time_stamp()</code> you are <strong>printing</strong>  the timestamp and returning nothing, i.e.: <code>void</code>.</p>\n\n<hr>\n\n<p>Your new <code>time_stamp()</code> function could be instead (note the <code>static</code> at the declaration of <code>buffer</code>):</p>\n\n<pre><code>const char* time_stamp(){\n   time_t rawtime;\n   struct tm * timeinfo;\n   static char buffer [80];\n   time (&amp;rawtime);\n   timeinfo = localtime (&amp;rawtime);\n\n   strftime (buffer,80,\"myFile_%F.txt\",timeinfo);\n   return buffer;\n}\n</code></pre>\n\n<p>You could then <strong>call</strong> this new function at the moment of calling <code>fopen()</code>. The value returned by <code>time_stamp()</code> will turn into the first argument of <code>fopen()</code>:</p>\n\n<pre><code>const char * (*filename_ptr)();\nfilename_ptr = &amp;time_stamp;\n// ...\nfp = fopen (filename_ptr(), \"w+\");\n</code></pre>\n\n<p>Note that the type of the value returned from <code>time_stamp()</code> matches now the type of the first argument that <code>fopen()</code> expects (i.e.: <code>const char *</code>).</p>\n\n<hr>\n\n<h1>Note on thread-safety</h1>\n\n<p>Since the function <code>time_stamp()</code> contains <em>statically allocated storage</em> (<code>buffer</code>), it is unsafe to use this function in a multi-threading program, since all the threads <em>that call this function</em> will be sharing a single instance of this storage.</p>\n"}], "owner": {"reputation": 15, "user_id": 7313354, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1baeb65411101169e1a5120b6a56fff2?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/7313354/jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1496819009, "creation_date": 1496816000, "last_edit_date": 1496816540, "question_id": 44404831, "link": "https://stackoverflow.com/questions/44404831/passing-a-function-pointer-as-parameter-to-fopen", "title": "Passing a function pointer as parameter to fopen", "body": "<p>I created a small C program for creating a time stamp and append it to a file text name:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid time_stamp(){\n    time_t rawtime;\n    struct tm * timeinfo;\n    char buffer [80];\n    time (&amp;rawtime);\n    timeinfo = localtime (&amp;rawtime);\n\n    strftime (buffer,80,\"myFile_%F.txt\",timeinfo);\n    printf (\"%s\", buffer);\n}\n\n\nint main ()\n{\n    void (*filename_ptr)();\n    filename_ptr = &amp;time_stamp;\n\n    FILE * fp;\n\n    fp = fopen (filename_ptr, \"w+\");\n    fprintf(fp, \"%s %s %s %d\", \"We\", \"are\", \"in\", 2017);\n\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>But I can't get fopen to accept the pointer to the function creating the name with the time stamp. It is expecting a const char. How can i cast my function pointer to it?</p>\n"}, {"tags": ["c", "treeview", "refresh", "gtk3"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1496818169, "post_id": 44404290, "comment_id": 75809928, "body": "Please show us your current effort on that topic. What did you try so far. Which model is used to store the data."}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1496832676, "last_edit_date": 1496832676, "creation_date": 1496832350, "answer_id": 44410482, "question_id": 44404290, "link": "https://stackoverflow.com/questions/44404290/is-it-possible-to-refresh-update-the-data-in-a-treeview/44410482#44410482", "title": "Is it possible to refresh/update the data in a treeview?", "body": "<p>I never used <code>gtk_tree_store</code>, but only <code>gtk_list_store</code>. Nevertheless the logic should be applicable for <code>gtk_tree_store</code> as well.</p>\n\n<p>Depending on the result of a new SQL-query some entries might be changed, added or deleted.</p>\n\n<p>There are basically 2 ways to update your view. </p>\n\n<p>If lines might be added and removed in your table, the easiest way might be to clean up your whole tree and populate it again.</p>\n\n<pre><code>GtkTreeIter       iter;\ngboolean          iter_valid;\n\niter_valid = gtk_tree_model_get_iter_first(GTK_TREE_MODEL(store), &amp;iter);\nwhile (iter_valid)\n{\n  // Maybe additional cleanup of related data\n  // gtk_tree_model_get(GTK_TREE_MODEL(store), &amp;iter, .... -1);\n  iter_valid = gtk_tree_store_remove(store, &amp;iter);\n}\n// Maybe update filtering and sorting afterwards\ngtk_tree_model_filter_refilter(store_filtered);\n\n// Populate again with result of SQL query.\n</code></pre>\n\n<p>If you can be sure that only the content changes, then you could just change it in the storage:</p>\n\n<pre><code>GtkTreeIter       iter;\ngboolean          iter_valid;\n\niter_valid = gtk_tree_model_get_iter_first(GTK_TREE_MODEL(store), &amp;iter);\nwhile (iter_valid)\n{\n  gtk_tree_model_get(GTK_TREE_MODEL(store), &amp;iter, &lt; add fields here &gt;, -1);\n\n  bool           update = FALSE;\n  // Check if this entry needs to be updated\n  // .... =&gt; set update = TRUE;\n\n  if (update)\n    gtk_tree_store_set(store, &amp;iter, &lt; field names and values here... &gt; -1);\n\n  iter_valid = gtk_tree_model_iter_next(GTK_TREE_MODEL(store), &amp;iter);\n}\n// Optionally update filtering and sorting...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8123379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0df90e1ae0dddcea9950ddf3bff60f0?s=128&d=identicon&r=PG&f=1", "display_name": "Vanreyn", "link": "https://stackoverflow.com/users/8123379/vanreyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1496888442, "last_edit_date": 1496888442, "creation_date": 1496884707, "answer_id": 44425175, "question_id": 44404290, "link": "https://stackoverflow.com/questions/44404290/is-it-possible-to-refresh-update-the-data-in-a-treeview/44425175#44425175", "title": "Is it possible to refresh/update the data in a treeview?", "body": "<p>I simply ended up doing an ugly patch.\nI created a function that removes the treeviews, rebuilds the stores and packs them again.</p>\n\n<pre><code>static void refresh()\n{\ngtk_container_remove(GTK_CONTAINER(box), tree_1);\ngtk_container_remove(GTK_CONTAINER(box), tree_2);\n\ntree_1 = create_view(create_and_fill(\"true\")); // Rebuild the stores and views\ntree_2 = create_view(create_and_fill(\"false\"));\n\ngtk_box_pack_start(GTK_BOX(box),tree_1,FALSE,FALSE,0);\ngtk_box_pack_start(GTK_BOX(box),tree_2,FALSE,FALSE,0);\n\ngtk_box_reorder_child(GTK_BOX(box), tree_1, x); // X being the relative position of your treeview\ngtk_box_reorder_child(GTK_BOX(box), tree_2, x);\ngtk_widget_show_all(box);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 10980522, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WffRCexrdPI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP8seiy-LdoCyTVsM3ak8dFXe0ZkQ/mo/photo.jpg?sz=128", "display_name": "Diggy Dude", "link": "https://stackoverflow.com/users/10980522/diggy-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1548908589, "last_edit_date": 1548908589, "creation_date": 1548907850, "answer_id": 54453144, "question_id": 44404290, "link": "https://stackoverflow.com/questions/44404290/is-it-possible-to-refresh-update-the-data-in-a-treeview/54453144#54453144", "title": "Is it possible to refresh/update the data in a treeview?", "body": "<p>I just wrote some code for a peer-to-peer bulletin board that can either populate a new tree or append new rows to a tree that's already populated. It uses a recursive function to get the existing iterators in the tree. An array in which to capture the iterators is passed by reference to this function. The iterator at index 0 is null, and a top-level post has 0 as its \"inReplyTo\" field.</p>\n\n<p>Here I'm only showing the relevant code for brevity. Notice that the first call to updateTree populates the bare tree with the rows in $data, then the second call appends the rows in $more.</p>\n\n<pre><code>&lt;?php\n\n  $model = new GtkTreeStore(GObject::TYPE_STRING, GObject::TYPE_LONG);\n  $tree  = new GtkTreeView($model);\n  $renderer1 = new GtkCellRendererText();\n  $column1 = new GtkTreeViewColumn('Title', $renderer1, 'text', 0);\n  $renderer2 = new GtkCellRendererText();\n  $column2 = new GtkTreeViewColumn('ID', $renderer2, 'text', 1);\n  $tree-&gt;append_column($column1);\n  $tree-&gt;append_column($column2);\n\n  function getTreeIterators($model, &amp;$iters, $iter = null)\n  {\n    if ($iter === null) {\n      $iter = $model-&gt;get_iter_first();\n    }\n    while ($iter !== null) {\n      $cols       = $model-&gt;get($iter, 1);\n      $id         = $cols[0];\n      $iters[$id] = $iter;\n      if ($model-&gt;iter_has_child($iter)) {\n        $child = $model-&gt;iter_children($iter);\n        getTreeIterators($model, $iters, $child);\n      }\n      $iter = $model-&gt;iter_next($iter);\n    }\n  } // getTreeIterators\n\n  function updateTree($treeView, $data)\n  {\n    $model    = $treeView-&gt;get_model();\n    $iters    = array();\n    $iters[0] = null;\n    getTreeIterators($model, $iters);\n    foreach($data as $item) {\n      $iters[$item-&gt;id] = $model-&gt;append($iters[$item-&gt;inReplyTo], array($item-&gt;title, $item-&gt;id));\n    }\n    $tree-&gt;expand_all();\n  } // updateTree\n\n  $data = array(\n            (object) array('id' =&gt; 1, 'inReplyTo' =&gt; 0, 'title' =&gt; 'First post'),\n            (object) array('id' =&gt; 2, 'inReplyTo' =&gt; 1, 'title' =&gt; 'Re: First post'),\n            (object) array('id' =&gt; 3, 'inReplyTo' =&gt; 0, 'title' =&gt; 'Second post'),\n            (object) array('id' =&gt; 4, 'inReplyTo' =&gt; 2, 'title' =&gt; 'Re: Re: First post'),\n            (object) array('id' =&gt; 5, 'inReplyTo' =&gt; 3, 'title' =&gt; 'Re: Second post'),\n            (object) array('id' =&gt; 6, 'inReplyTo' =&gt; 0, 'title' =&gt; 'Third post')\n          );\n\n\n   $more = array(\n            (object) array('id' =&gt; 7, 'inReplyTo' =&gt; 0, 'title' =&gt; 'Fourth post'),\n            (object) array('id' =&gt; 8, 'inReplyTo' =&gt; 1, 'title' =&gt; 'Re: That first post'),\n            (object) array('id' =&gt; 9, 'inReplyTo' =&gt; 5, 'title' =&gt; 'Re: Re: Second post')\n           );\n\n  updateTree($tree, $data);\n  updateTree($tree, $more);\n\n?&gt;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8123379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0df90e1ae0dddcea9950ddf3bff60f0?s=128&d=identicon&r=PG&f=1", "display_name": "Vanreyn", "link": "https://stackoverflow.com/users/8123379/vanreyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1233, "favorite_count": 2, "answer_count": 3, "score": 1, "last_activity_date": 1548908589, "creation_date": 1496813693, "last_edit_date": 1496847633, "question_id": 44404290, "link": "https://stackoverflow.com/questions/44404290/is-it-possible-to-refresh-update-the-data-in-a-treeview", "title": "Is it possible to refresh/update the data in a treeview?", "body": "<p>I'm new at GUI development and I've been working on a project with gtk+ 3 for some days, but I'm stuck at this point.</p>\n\n<p>My app contains two treeviews, the data in the rows is obtained from an sql query, by right clicking on a row a popup-menu appears, giving the option to set the data as \"known\", updating the database table.</p>\n\n<p>The previous data now should belong in the other treeview, and so it does when the app is restarted, but I'm looking to do it in real time.</p>\n\n<p>Is it possible to update/refresh the data in a treeview?</p>\n\n<p>The model is obtained with the function:</p>\n\n<pre><code>static GtkTreeStore* create_and_fill(char* known)\n{\n  GtkTreeStore* store;\n  GtkTreeIter iter;\n  GtkWidget* tree;\n  store = gtk_tree_store_new(2,G_TYPE_STRING,G_TYPE_STRING);\n\n  char source_mac[50] = {0};\n  char source_ip[50] = {0};\n  int num_fields;\n\n  char query[300] = {0};\n  sprintf(query, \"select mac,ip from hosts where known=%s\", known);\n  if(mysql_query(conn, query))\n  {\n    fprintf(stderr,\"%s\\n\", mysql_error(conn));\n  }\n  res = mysql_store_result(conn);\n  num_fields = mysql_num_fields(res);\n\n  while((row = mysql_fetch_row(res)))\n  {\n    sprintf(source_mac,\"%s\", row[0]);\n    sprintf(source_ip,\"%s\", row[1]);\n    gtk_tree_store_append(store, &amp;iter, NULL);\n    gtk_tree_store_set(store, &amp;iter, MAC_ADDRESS, source_mac, IP_ADDRESS, source_ip,-1);\n  }\n  gtk_tree_store_append(store, &amp;iter, NULL);\n  mysql_free_result(res);\n  return store;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "matrix"], "comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1496823741, "post_id": 44404189, "comment_id": 75813420, "body": "<code>matrix</code> is a local variable of <code>readMatrix</code>, so its lifetime is limited to the scope of that function."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1496824340, "post_id": 44404189, "comment_id": 75813804, "body": "Please, also note that you don&#39;t have a 2d-array anywhere in your code. <code>matrix</code> is 1d VLA, while the other variables you are passing around are pointers to pointers."}, {"owner": {"reputation": 1530, "user_id": 2727710, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000318383381/picture?type=large", "display_name": "kamoroso94", "link": "https://stackoverflow.com/users/2727710/kamoroso94"}, "edited": false, "score": 0, "creation_date": 1496826344, "post_id": 44404189, "comment_id": 75815218, "body": "In your <code>diaplayMatrix</code> function, you can use <code>a[k][j]</code> rather than <code>*(*(a + k) + j)</code>.  They do the same thing, but the first one is easier to read.  I&#39;d also recommend using variable names <code>i</code> and <code>j</code> rather than <code>k</code> and <code>j</code>, just for the sake of convention."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8065345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-554zzLaU5O8/AAAAAAAAAAI/AAAAAAAACYo/a6jbhDgs1ZE/photo.jpg?sz=128", "display_name": "Saket Shrivastava", "link": "https://stackoverflow.com/users/8065345/saket-shrivastava"}, "edited": false, "score": 0, "creation_date": 1496827745, "post_id": 44408068, "comment_id": 75816269, "body": "i read that variables get deallocated but the memory holds the values so we can access the values if we have the memory locations. Also the same code without using the array of pointers (b) in readMatrix and the outer loop in displayMatrix works fine."}, {"owner": {"reputation": 1530, "user_id": 2727710, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000318383381/picture?type=large", "display_name": "kamoroso94", "link": "https://stackoverflow.com/users/2727710/kamoroso94"}, "reply_to_user": {"reputation": 7, "user_id": 8065345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-554zzLaU5O8/AAAAAAAAAAI/AAAAAAAACYo/a6jbhDgs1ZE/photo.jpg?sz=128", "display_name": "Saket Shrivastava", "link": "https://stackoverflow.com/users/8065345/saket-shrivastava"}, "edited": false, "score": 0, "creation_date": 1496827898, "post_id": 44408068, "comment_id": 75816383, "body": "@SaketShrivastava theoretically, yes, but I don&#39;t recommend that.  I&#39;m pretty sure it&#39;s undefined behavior."}, {"owner": {"reputation": 7, "user_id": 8065345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-554zzLaU5O8/AAAAAAAAAAI/AAAAAAAACYo/a6jbhDgs1ZE/photo.jpg?sz=128", "display_name": "Saket Shrivastava", "link": "https://stackoverflow.com/users/8065345/saket-shrivastava"}, "edited": false, "score": 0, "creation_date": 1496828112, "post_id": 44408068, "comment_id": 75816539, "body": "int ** readMatrix(int rows, int cols) {     int i,j, matrix[rows<i>cols]; int *b; b = matrix; int **y=&amp;b;     for(i=0; i&lt; rows</i>cols; i++)     {         scanf(&quot;%d&quot;, matrix+i);     }     return y; }  void displayMatrix(int <i>*a, int rows, int cols) {     int i=0,j;             int k; k=i</i>cols;         for(j=0; j &lt; cols; j++)         {             printf(&quot;%d &quot;, *(*a + j + k));         }         printf(&quot;\\n&quot;); i=i+1;      }"}, {"owner": {"reputation": 7, "user_id": 8065345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-554zzLaU5O8/AAAAAAAAAAI/AAAAAAAACYo/a6jbhDgs1ZE/photo.jpg?sz=128", "display_name": "Saket Shrivastava", "link": "https://stackoverflow.com/users/8065345/saket-shrivastava"}, "edited": false, "score": 0, "creation_date": 1496828230, "post_id": 44408068, "comment_id": 75816621, "body": "this is what i was doing first. as you can see in the display matrix part, there is a k. if i manually change the values, it gives output but using loop to change k again gives error."}, {"owner": {"reputation": 7, "user_id": 8065345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-554zzLaU5O8/AAAAAAAAAAI/AAAAAAAACYo/a6jbhDgs1ZE/photo.jpg?sz=128", "display_name": "Saket Shrivastava", "link": "https://stackoverflow.com/users/8065345/saket-shrivastava"}, "edited": false, "score": 0, "creation_date": 1496829167, "post_id": 44408068, "comment_id": 75817275, "body": "[link]<a href=\"https://ibb.co/fxyjvv\" rel=\"nofollow noreferrer\">ibb.co/fxyjvv</a>  this is what i am doing"}], "tags": [], "owner": {"reputation": 1530, "user_id": 2727710, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000318383381/picture?type=large", "display_name": "kamoroso94", "link": "https://stackoverflow.com/users/2727710/kamoroso94"}, "is_accepted": false, "score": 1, "last_activity_date": 1496825973, "creation_date": 1496825973, "answer_id": 44408068, "question_id": 44404189, "link": "https://stackoverflow.com/questions/44404189/matrix-2d-array-with-pointer/44408068#44408068", "title": "matrix 2d array with pointer", "body": "<p>Your problem in <code>readMatrix</code> is that it returns a pointer to a local variable in that function.  You're not supposed to do that, because local variables get deallocated after the function returns, which is why you're getting a segmentation fault.</p>\n\n<p>You need to create one with <code>malloc</code> in the function (and remember to <code>free</code> it).  You will need to put <code>#include &lt;stdlib.h&gt;</code> at the top with the other headers to access these functions.  You can see the changes below to make this work.</p>\n\n<pre><code>int** readMatrix(int rows, int cols) {\n    int i, j;\n    int **matrix = malloc(rows * sizeof(int*));\n\n    for(i = 0; i &lt; rows; i++) {\n        matrix[i] = malloc(cols * sizeof(int));\n        for(j = 0; j &lt; cols; j++) {\n            scanf(\"%d\", &amp;matrix[i][j]);\n        }\n    }\n\n    return matrix;\n}\n</code></pre>\n\n<p>Now it may be helpful to have a function for freeing this data structure.  Here's how you can do that.</p>\n\n<pre><code>void freeMatrix(int **matrix, int rows) {\n    int i;\n    for(i = 0; i &lt; rows; i++) {\n        free(matrix[i]);\n    }\n    free(matrix);\n}\n</code></pre>\n\n<p>Then change the <code>main</code> function to accommodate these changes as follows.</p>\n\n<pre><code>int **a = readMatrix(rows, cols);\ndisplayMatrix(a, rows, cols);\nfreeMatrix(a, rows);\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8065345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-554zzLaU5O8/AAAAAAAAAAI/AAAAAAAACYo/a6jbhDgs1ZE/photo.jpg?sz=128", "display_name": "Saket Shrivastava", "link": "https://stackoverflow.com/users/8065345/saket-shrivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "closed_date": 1496826953, "answer_count": 1, "score": 1, "last_activity_date": 1496825973, "creation_date": 1496813233, "last_edit_date": 1496823515, "question_id": 44404189, "link": "https://stackoverflow.com/questions/44404189/matrix-2d-array-with-pointer", "closed_reason": "Duplicate", "title": "matrix 2d array with pointer", "body": "<p>This is the code I wrote to take the values of a matrix and display it</p>\n\n<pre><code>#include&lt;stdio.h&gt;   \n\nint ** readMatrix(int rows, int cols)\n{\n    int i,j, matrix[rows*cols];\n    int *b[rows];\n    int **y=b;\n\n    int k=0;\n    for(k=0; k &lt; rows; k++)\n    {\n        b[k]=&amp;matrix[k*cols];\n    }\n\n    for(i=0; i&lt; rows*cols; i++)\n    {\n        scanf(\"%d\", matrix+i);\n    }\n    return y;\n}\n\nvoid displayMatrix(int **a, int rows, int cols)\n{\n    int k=0,j;\n    for(k=0; k &lt; rows; k++)\n    {\n        for(j=0; j &lt; cols; j++)\n        {\n            printf(\"%d \", *(*(a + k) + j));\n        }\n        printf(\"\\n\");\n    }\n}\n\nint main()\n{   \n    int rows,cols;\n    printf(\"Enter the number of rows:\\n\");\n    scanf(\"%d\",&amp;rows);\n    if(rows &lt;= 0)\n    {\n        printf(\"Invalid Input\");\n    }\n    else\n    {\n        printf(\"Enter the number of columns:\\n\");\n        scanf(\"%d\",&amp;cols);\n        if(cols &lt;= 0)\n        {\n            printf(\"Invalid Input\");\n        }\n        else\n        {\n            printf(\"Enter the values:\\n\");\n            int **a = readMatrix(rows, cols);\n            displayMatrix(a, rows, cols);\n        }\n    }\n}\n</code></pre>\n\n<p>The program is getting stuck at the loop in <code>displayMatrix</code>, but it displays fine if I remove the outer for loop. </p>\n\n<p>The error I get is <code>Segmentation fault (core dumped)</code>.</p>\n\n<p>What am I doing wrong? </p>\n\n<p>PS: I have to use the above function signature with double pointers.  </p>\n"}, {"tags": ["c", "encryption", "passwords"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1496813981, "post_id": 44404098, "comment_id": 75807737, "body": "One of the simplest solutions is encoding and decoding using xor combination of password text and a static internal key. But there are a lot of more secure algorithms - mostly available as ready-to-use library (or source code). I tried google &quot;password encryption c&quot; and found some (including the suggested but not recommended <a href=\"https://kylewbanks.com/blog/Simple-XOR-Encryption-Decryption-in-Cpp\" rel=\"nofollow noreferrer\">XOR encryption</a>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496816739, "post_id": 44404098, "comment_id": 75809081, "body": "Amongst many others, see <a href=\"https://crackstation.net/hashing-security.htm\" rel=\"nofollow noreferrer\">Secure Salted Password Hashing \u2014 How to do it properly</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496844727, "post_id": 44404098, "comment_id": 75829058, "body": "Also note the recent Coding Horror blog on <a href=\"https://blog.codinghorror.com/hacker-hack-thyself/\" rel=\"nofollow noreferrer\">Hacker, Hack Thyself</a>."}], "answers": [{"comments": [{"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 1, "creation_date": 1496814912, "post_id": 44404480, "comment_id": 75808136, "body": "@JoesLie:  While Pras&#39; answer doesn&#39;t provide a decryption method, the logic is sound for a secure solution....  Provided the text file holding the password has strictly limited access."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 2, "creation_date": 1496816611, "post_id": 44404480, "comment_id": 75808989, "body": "Indeed. This is the way to design such a <i>login system</i>, in the real world. Passwords should be hashed one-way (with a <i>salt</i>, unique per user), so that if an attacker gets hold of the hashes the attacker can&#39;t merely decrypt to find out what the passwords were."}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": true, "score": 1, "last_activity_date": 1496814516, "creation_date": 1496814516, "answer_id": 44404480, "question_id": 44404098, "link": "https://stackoverflow.com/questions/44404098/c-encrypt-data-in-file-txt/44404480#44404480", "title": "C Encrypt data in file.txt", "body": "<p>You should hash password with strong hash function like SHA2 and  store the hash in your file rather than storing it in plain</p>\n\n<p>Hashing might be better in this case than encryption, as for encryption you will have to worry about storing key somewhere securely.</p>\n\n<p>When your login function needs to validate incoming password, you can just hash incoming password and match it against the hashed password from you file</p>\n"}, {"tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": false, "score": 0, "last_activity_date": 1496822327, "creation_date": 1496822327, "answer_id": 44406806, "question_id": 44404098, "link": "https://stackoverflow.com/questions/44404098/c-encrypt-data-in-file-txt/44406806#44406806", "title": "C Encrypt data in file.txt", "body": "<p>If you want to protect your login then you should use a password hash, also known as a Password Based Key Derivation Function. These functions are <em>often</em>, but not always, based on a secure hash. You <strong>should not</strong> use a cryptographic hash such as SHA-2 for this purposes.</p>\n\n<p>Common password hashes are PBKDF2, bcrypt, scrypt and Argon2. Argon2 is the most advanced one as winner of the password hashing competition. A password hash differs from a normal hash in two important aspects:</p>\n\n<ol>\n<li>it uses key strengthening techniques to make it harder for adversaries to use a dictionary or brute force attack (in the form of an iteration count or work factor and possibly additional memory / threading related parameters);</li>\n<li>it uses a salt - stored with the password hash - to avoid rainbow table attacks and to avoid duplicate hash values - which would show that an identical password is being used.</li>\n</ol>\n\n<p>So although Pras is right about not using encryption I would not recommend a secure hash <em>unless you are sure that the password is large enough and unique</em>. In general those restrictions can nor should be enforced on password based authentication systems.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8017372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 44404480, "answer_count": 2, "score": 0, "last_activity_date": 1496822327, "creation_date": 1496812783, "question_id": 44404098, "link": "https://stackoverflow.com/questions/44404098/c-encrypt-data-in-file-txt", "title": "C Encrypt data in file.txt", "body": "<p>I have problem in encrypting my plain text in C.\nI am able to write and read the file in C \nInside the text:</p>\n\n<pre><code>ID  Promo   Points  Password    Name\n1   NONE    0       awdawdawd   daw\n</code></pre>\n\n<p>Which in this case it just print password in plain text, Is it possible to encrypt the data any method, which shows like this:</p>\n\n<pre><code>ID  Promo   Points  Password    Name\n1   NONE    0      ENCRYPTEDDATA daw\n</code></pre>\n\n<p>Of course the password wont be \"ENCRYPTEDDATA\", I just want it avoid plain text which user can easily see the file. \nThe reason I create file cause I need to read it from the file and make a login function. \nMy program itself able to decrypt the password when in request of checking id and password.\nIt can use any method only the program can encrypt and decrypt the data\nAny solution guys?\nIf possible I also need to limit the encrypted text</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1496812196, "post_id": 44403942, "comment_id": 75807096, "body": "I get no error with this. please verify your code"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1496812209, "post_id": 44403942, "comment_id": 75807100, "body": "Show your input."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 1, "creation_date": 1496812228, "post_id": 44403942, "comment_id": 75807106, "body": "<code>scanf(&quot;%d %d&quot;, &amp;a, &amp;b);</code> Note the whitespace."}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1496812529, "post_id": 44403942, "comment_id": 75807202, "body": "<a href=\"https://stackoverflow.com/questions/4236853/floating-point-exception-c-why-and-what-is-it\" title=\"floating point exception c why and what is it\">stackoverflow.com/questions/4236853/&hellip;</a>"}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1496812536, "post_id": 44403942, "comment_id": 75807206, "body": "<a href=\"https://stackoverflow.com/questions/31808661/why-am-i-getting-floating-point-exception-8\" title=\"why am i getting floating point exception 8\">stackoverflow.com/questions/31808661/&hellip;</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1496812749, "post_id": 44403942, "comment_id": 75807282, "body": "Probably it is estimated that overflow occurred  in the calculation of a large factorial.  So divide by 0 occurred."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 2, "creation_date": 1496816957, "post_id": 44403942, "comment_id": 75809184, "body": "@Shiva: The white space in the format string is irrelevant; <code>%d</code> skips leading white space anyway.  The spaces between the arguments are purely cosmetic."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496817166, "post_id": 44403942, "comment_id": 75809308, "body": "These days, a &#39;floating point exception&#39; almost invariably means &#39;integer divide by zero&#39; \u2014 computations on floating point numbers generate infinities or NaN (not a number) values rather than a full floating point exception signal.  So, look for reasons why you ended up dividing by zero. Your <code>uniquePaths()</code> function shouldn&#39;t assign to a <code>float</code> and then return an <code>int</code>.  Note too that the arithmetic is done using integer arithmetic, not floating point arithmetic.  All you are doing is losing precision (changing from 32-bit <code>int</code> to 23 bits of mantissa, and then converting back again)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496844582, "post_id": 44403942, "comment_id": 75828940, "body": "Maybe <a href=\"https://stackoverflow.com/q/31808661/2410359\">Why am I getting &#39;Floating point exception: 8&#39;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1496854589, "post_id": 44403942, "comment_id": 75835958, "body": "With 32-bit <code>int</code>, any inputs <code>a,b</code> whose sum exceeds 64, will likely overflow the <code>fact(A-1)*fact(B-1)</code> with a UB result of 0.  Then <code>int&#47;int 0</code> causes the &quot;Floating point exception&quot;.  Posting inputs used would help clarify this post."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496844707, "post_id": 44404443, "comment_id": 75829045, "body": "The test that is truly needed is if the product <code>(fact(A - 1) * fact(B - 1))</code> is zero."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496849407, "post_id": 44404443, "comment_id": 75832768, "body": "@chux A factorial is always positive, also the postcondition asserts that is the case."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496853935, "post_id": 44404443, "comment_id": 75835613, "body": "With an <code>int</code> quotient, the result near <code>INT_MAX</code>, that assigned to <code>float</code> could then get a rounded value of <code>INT_MAX+1</code>.  Although this passes the  <code>assert(m &gt;= 1);</code>, the conversion back to <code>int</code> is <code>UB</code>, which includes a return value of 0.  Even more of concern, the product <code>fact(A - 1) * fact(B - 1)</code> may still be 0 due to <code>int</code> overflow.  The result of <code>int</code> OF is UB and a potential result is 0.  Thus the suggestion of an <code>assert(product != 0)</code> just before the <code>int</code> division of a potential 0 that often signals itself as &quot;Floating point exception&quot;."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1496931462, "post_id": 44404443, "comment_id": 75873953, "body": "@chux I missed the int to float conversion. I have changed float to int and added a zero assertion for the denominator."}], "tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1496931361, "last_edit_date": 1496931361, "creation_date": 1496814333, "answer_id": 44404443, "question_id": 44403942, "link": "https://stackoverflow.com/questions/44403942/floating-point-exception-8/44404443#44404443", "title": "Floating point exception: 8", "body": "<p>If you add pre- and postconditions using the function assert you can make sure that parameters and function results have reasonable values:</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//grid problem\nint fact(int n)\n{\n    assert(n &gt;= 0);\n    int i, f = 1;\n    if (n == 0) {\n        return 1;\n    }\n    for (i = 1; i &lt;= n; i++) {\n        f *= i;\n    }\n    assert(f &gt;= 1);\n    return f;\n}\n\n\nint uniquePaths(int A, int B)\n{\n    assert(A &gt;= 1);\n    assert(B &gt;= 1);\n    int q = fact(A - 1) * fact(B - 1);\n    assert(q &gt; 0);\n    int m = fact(A + B - 2) / q;\n    assert(m &gt;= 1);\n    return m;\n}\n\n\nint main(int argc, char const *argv[])\n{\n    int a, b;\n    //aXb grid\n    int n = scanf(\"%d%d\", &amp;a, &amp;b);\n    if (n == 2) {\n        printf(\"%d\\n\", uniquePaths(a, b));\n    } else {\n        fprintf(stderr, \"invalid input\\n\");\n        exit(1);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>On my machine, running the program above with intput <code>10 10</code>, for instance, will result in</p>\n\n<pre><code>t: t.c:16: int fact(int): Assertion `f &gt;= 1' failed.\nAborted\n</code></pre>\n\n<p>(I don't know why you get a floating point exception however.)</p>\n"}], "owner": {"reputation": 17, "user_id": 8123283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3eb54dce2122b45391c140ce56ef20?s=128&d=identicon&r=PG&f=1", "display_name": "Rajgauri Khemnar", "link": "https://stackoverflow.com/users/8123283/rajgauri-khemnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496931361, "creation_date": 1496811985, "last_edit_date": 1496812590, "question_id": 44403942, "link": "https://stackoverflow.com/questions/44403942/floating-point-exception-8", "title": "Floating point exception: 8", "body": "<p>Why am I getting the error: <code>Floating point exception: 8</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n//grid problem\nint fact(int n)\n{\n\n    int i,f=1;\n    if(n==0)\n        return 1;\n    for(i=1;i&lt;=n;i++)\n        f*=i;\n    return f;\n}\n\nint uniquePaths(int A, int B) {\n    float m;\n    m=fact(A+B-2)/(fact(A-1)*fact(B-1));\n    return m;\n}\n\nint main(int argc, char const *argv[])\n{\n    int a,b;\n    //aXb grid\n    scanf(\"%d%d\",&amp;a,&amp;b);\n    printf(\"%d\\n\",uniquePaths(a,b) );\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc", "heap"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496810108, "post_id": 44403550, "comment_id": 75806399, "body": "<code>void *mallocInFunction(void) { void *ptr = malloc (500); ... return ptr; }</code> to allow you to gauge success or failure of the allocation. Then <code>while (mallocInFunction()) {}</code> in <code>main</code>. Your memory is shared (not exactly as <i>virtual</i> memory is allocated to each executable), and when you begin running out, your system should shut down non-essential processes."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 7, "creation_date": 1496810233, "post_id": 44403550, "comment_id": 75806429, "body": "The program requests heap size increase when needed and the OS supplies more memory ... then other programs slow down because the OS ends up using disk swap space to supply other programs because your program used all the real memory. (Very roughly speaking)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1496810543, "post_id": 44403550, "comment_id": 75806518, "body": "Other programs might become slow for sometime but soon <i>should</i> recover to normal operation when their pages are swapped in. If your swap is less the OS also might have to kill some processes which it would later have to start again. If your machine is completely unusable after such an experiment, you might want to try increasing swap space (it is called Virtual Memory in windows) before the experiment. Usual swap size is equal to Physical memory size."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496810636, "post_id": 44403550, "comment_id": 75806540, "body": "@M.M. In this case the issue is probably the swap getting filled up too because the malloc is going to return NULL only after the swap is also full."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1496810773, "post_id": 44403550, "comment_id": 75806590, "body": "@AjayBrahmakshatriya I think Windows usually doesn&#39;t return NULL, it just lazy allocates and then kills processes if swap fills up"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1496810906, "post_id": 44403550, "comment_id": 75806635, "body": "@&#212;rel AFAIK <code>ulimit</code> is on *NIX systems. The OP here is using MinGW on Windows."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496811105, "post_id": 44403550, "comment_id": 75806698, "body": "@M.M Yes agreed. Explains why other processes are suffering badly too. Many services must be getting killed. But OP mentions that he gets NULL and then had to forcibly terminate. Maybe he is running in debug mode or something where the windows allocator also clears the pages on MEM_COMMIT. If the swap is full too, the commit operation would fail and I think the malloc would then return NULL."}], "answers": [{"tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 3, "last_activity_date": 1496816436, "last_edit_date": 1496816436, "creation_date": 1496811934, "answer_id": 44403929, "question_id": 44403550, "link": "https://stackoverflow.com/questions/44403550/heap-overflow-affecting-other-programs/44403929#44403929", "title": "heap overflow affecting other programs", "body": "<blockquote>\n  <p>... whether the memory for heap is shared with other programs?</p>\n</blockquote>\n\n<p>Well, the C standard doesn't exactly require a <em>heap</em>, but in the context of a task-switching, multi-user and multi-threaded OS, <em>of course</em> memory is shared between processes! The C standard doesn't require <em>any</em> of this, but this is all pretty common stuff:</p>\n\n<ul>\n<li>CPU cache memory tends to be preferred for code that's executed <em>often</em>, though this might get swapped around quite a bit; that may or may not be swapped to a <em>heap</em>.</li>\n<li>Task switching causes registers to be swapped to other forms of memory; that may or may not be swapped to a <em>heap</em>.</li>\n<li>Entire pages are swapped to and from disk, so that other programs can make use of them when your OS switches execution away from your program and to the other programs, and when it's your programs turn to execute again <em>among other reasons</em>. This may or may not involve manipulating the <em>heap</em>.</li>\n</ul>\n\n<p>FWIW, you're referring to memory that has <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.4\" rel=\"nofollow noreferrer\">allocated storage duration</a>. It's best to avoid using terms like <em>heap</em> and <em>stack</em>, as they're virtually meaningless. The memory you're referring to is on a <em>silicon chip</em>, regardless of whether it uses a <em>heap</em> or a <em>stack</em>.</p>\n\n<blockquote>\n  <p>... Is OS is not allocating certain amount of memory at the time of execution?</p>\n</blockquote>\n\n<p>Speaking of silicon chips and execution, your OS likely only has control of <em>one</em> processor (a silicon chip which contains some logic circuits and memory, among other things I'm sure) with which to execute <em>many</em> programs! To summarise this post, <strong>yes, your program is most likely <em>sharing those silicon chips</em> with other programs!</strong></p>\n\n<p>On a tangential note, I don't think <em><a href=\"https://en.wikipedia.org/wiki/Heap_overflow\" rel=\"nofollow noreferrer\">heap overflow</a></em> means what you think it means.</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 3, "last_activity_date": 1496812596, "creation_date": 1496812596, "answer_id": 44404056, "question_id": 44403550, "link": "https://stackoverflow.com/questions/44403550/heap-overflow-affecting-other-programs/44404056#44404056", "title": "heap overflow affecting other programs", "body": "<blockquote>\n  <p>So my question is whether the memory for heap is shared with other programs?</p>\n</blockquote>\n\n<p>Physical memory (RAM) is a resource that is shared by all processes. The operating system makes decisions about how much RAM to allocate to each process and adjusts that over time.</p>\n\n<blockquote>\n  <p>If not, other programs should not have affected. Is OS is not allocating certain amount of memory at the time of execution?</p>\n</blockquote>\n\n<p>At the time the program starts executing, the operating system has no idea how much memory the program will want or need. Instead, it deals with allocations as they happen. Unless configured otherwise, it will typically do everything it possibly can to allow the program's allocation to succeed because presumably there's a reason the program is doing what it's doing and the operating system won't try to second guess it.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1496812740, "creation_date": 1496812740, "answer_id": 44404089, "question_id": 44403550, "link": "https://stackoverflow.com/questions/44403550/heap-overflow-affecting-other-programs/44404089#44404089", "title": "heap overflow affecting other programs", "body": "<p>Your question cannot be answered in the context of C, the language. For C, there's no such thing as a <em>heap</em>, a <em>process</em>, ...</p>\n\n<p>But it can be answered in the context of <em>operating systems</em>. Even a bit generically because many modern multitasking OSes do similar things.</p>\n\n<p>Given a modern multitasking OS, it will use <em>virtual address spaces</em> for each process. The OS manages a fixed size of physical RAM and divides this into pages, when a process needs memory, such pages are <em>mapped</em> into the process' virtual address space (typically using a different virtual address than the physical one). So when all memory pages are claimed by the OS itself and by the processes running, the OS will typically save some of these pages that are not in active use to disk, in a <em>swap area</em>, in order to serve this page as a fresh page to the next process requesting one. But when the original page <strong>is</strong> touched (and this is typically the case with <code>free()</code>, see below), it must first be loaded from disk again, but to have a free page for this, <em>another</em> page must be saved to swap space.</p>\n\n<p>This is, like all disk I/O, slow, and it's probably what you see happening here.</p>\n\n<p>Now to fully understand this: what does <code>malloc()</code> do? It typically requests from the operating system to have the memory of the own process increased (and if necessary, the OS does this by mapping another page), and it uses this new memory by writing some information there about the block of memory requested (so <code>free()</code> can work correctly later) and ultimately returns a pointer to a block that's free to use for the program. <code>free()</code> uses the information written by <code>malloc()</code>, modifies it to indicate this block is free again, and it typically <strong>can't give any memory back to the OS</strong> because there are other <code>malloc()</code>d blocks in the same page. It will give memory back when possible, but that's the exception in a typical scenario where dynamic allocations are heavily used.</p>\n\n<p>So, the answer to your question is: Yes, the RAM is shared because there is only one set of physical RAM. The OS does the best it can to hide that fact and <em>virtualize</em> RAM, but if a process consumes all that is there, this will have visible effects.</p>\n"}, {"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496813188, "post_id": 44404096, "comment_id": 75807466, "body": "A linux OOM link for a Windows question? You might as well have used <a href=\"https://lwn.net/Articles/104185/\" rel=\"nofollow noreferrer\">this analogy</a> ;)"}, {"owner": {"reputation": 2283, "user_id": 3994228, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CKWtf.jpg?s=128&g=1", "display_name": "Milind Deore", "link": "https://stackoverflow.com/users/3994228/milind-deore"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1496813553, "post_id": 44404096, "comment_id": 75807574, "body": "My effort is to explain what happens under the hood, this is not writing on-the-stone but the chain of events (yes specific to Linux system). Example malloc() manages memory in variety of ways (best-fit, first-fit, last-fit, buddy, etc), which is implementation specific, but the protocol they all follow is same. Pease correct me if i am wrong :)"}], "tags": [], "owner": {"reputation": 2283, "user_id": 3994228, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CKWtf.jpg?s=128&g=1", "display_name": "Milind Deore", "link": "https://stackoverflow.com/users/3994228/milind-deore"}, "is_accepted": false, "score": 1, "last_activity_date": 1496812777, "creation_date": 1496812777, "answer_id": 44404096, "question_id": 44403550, "link": "https://stackoverflow.com/questions/44403550/heap-overflow-affecting-other-programs/44404096#44404096", "title": "heap overflow affecting other programs", "body": "<p><a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">malloc()</a> is not system call but libc library function. So when a program ask for allocating memory via malloc(), system call brk()/sbrk() OR mmap() to allocated page(s), more details <a href=\"http://www.inf.udec.cl/~leo/Malloc_tutorial.pdf\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Please keep in mind that the memory you get is all virtual in nature, that means if you have 3GB of physical RAM you can actually allocate almost infinite memory. So how does this happens? This happens via concept called 'paging', where system stores and retrieves data from secondary memory storage(HDD/SDD) to main memory(RAM), more details <a href=\"http://www.linux-tutorial.info/modules.php?name=MContent&amp;pageid=89\" rel=\"nofollow noreferrer\">here</a>.  </p>\n\n<p>So with this theory, out of memory usually quite rare but program like above which is checking system limits, this can happen. This is nicely explained <a href=\"http://www.linuxdevcenter.com/pub/a/linux/2006/11/30/linux-out-of-memory.html\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Now, why other programs are sort of hanged OR slow? Because they all share the same operating system and system is starving for resource. In fact at a point the system will crash and reboot again. </p>\n\n<p>Hope this helps?</p>\n"}], "owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 44404056, "answer_count": 4, "score": 4, "last_activity_date": 1496816436, "creation_date": 1496809897, "question_id": 44403550, "link": "https://stackoverflow.com/questions/44403550/heap-overflow-affecting-other-programs", "title": "heap overflow affecting other programs", "body": "<p>I was trying to create the condition for malloc to return a NULL pointer. In the below program, though I can see malloc returning NULL, once the program is forcebly terminated, I see that all other programs are becoming slow and finally I had to reboot the system. So my question is whether the memory for heap is shared with other programs? If not, other programs should not have affected. Is OS is not allocating certain amount of memory at the time of execution? I am using windows 10, Mingw.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\nvoid mallocInFunction(void)\n{\n    int *ptr=malloc(500);\n    if(ptr==NULL)\n    {\n        printf(\"Memory Could not be allocated\\n\");\n    }\n    else\n    {\n        printf(\"Allocated memory successfully\\n\");\n    }\n}\n\n\nint main (void)\n{\n    while(1)\n    {\n        mallocInFunction();\n    }\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "computer-science"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496809139, "post_id": 44403361, "comment_id": 75806136, "body": "Define them in main then pass by reference instead of by value."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1496809194, "post_id": 44403361, "comment_id": 75806149, "body": "<code>checkComplex(a == 2, b == 2, c == 2)</code>.... huh?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496812679, "post_id": 44403361, "comment_id": 75807258, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27320240/variable-changed-in-function-not-seen-by-caller\">Variable changed in function not seen by caller?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496817676, "post_id": 44403361, "comment_id": 75809586, "body": "Note that you should check that the inputs were correct (that the <code>scanf()</code> functions all read a value), and handle failures appropriately."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1496817784, "post_id": 44403361, "comment_id": 75809670, "body": "If you need to handle complex roots, why not use complex arithmetic, and print simple real values if in fact you have simple roots?  Using the <code>complex</code> data type cuts out a lot of the complexity."}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1496811440, "last_edit_date": 1496811440, "creation_date": 1496810028, "answer_id": 44403574, "question_id": 44403361, "link": "https://stackoverflow.com/questions/44403361/global-variables-to-local-variables/44403574#44403574", "title": "Global variables to local variables", "body": "<p>If you need to return multiple values, you can return a struct, or you can accept pointers to where the result should be stored. I've used both approaches in the following solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ntypedef struct {\n   double discriminant;\n   char num_roots;\n   double roots[2];\n} roots_t;\n\nvoid getData(double* ap, double* bp, double* cp) {\n   printf(\"Enter a: \");   scanf(\"%lf\", ap);\n   printf(\"Enter b: \");   scanf(\"%lf\", bp);\n   printf(\"Enter c: \");   scanf(\"%lf\", cp);\n}\n\nroots_t calculateRoots(double a, double b, double c) {\n   roots_t roots;\n   roots.discriminant = (b*b) - 4 * (a*c);\n   roots.num_roots = 0;\n   if (roots.discriminant &gt;= 0) {\n      roots.roots[roots.num_roots++] = (-b + sqrt(roots.discriminant)) / (2 * a);\n      if (roots.discriminant &gt; 0)\n         roots.roots[roots.num_roots++] = (-b - sqrt(roots.discriminant)) / (2 * a);\n      }\n   }\n\n   return roots;\n}\n\nvoid printResults(double a, double b, double c, roots_t roots) {\n   if (roots.num_roots == 2) {\n      printf(\"The quantity (b^2-4ac) is %.2lf\\n\", roots.discriminant);\n      printf(\"roots = %.2lf, %.2lf\\n\", roots.roots[0], roots.roots[1]);\n   }\n   else if (roots.num_roots == 1) {\n      printf(\"The quantity (b^2-4ac) is %.2lf\\n\", roots.discriminant);\n      printf(\"roots = %.2lf\\n\", roots.roots[0]);\n   }\n   else {\n      printf(\"The discriminant (b^2-4ac) is negative\\n\");\n      printf(\"roots = &lt;complex&gt;\\n\");\n   }\n}\n\nint main(void) {\n   double a, b, c;\n   getData(&amp;a, &amp;b, &amp;c);\n   printResults(a, b, c, calculateRoots(a, b, c));\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7792863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b10701dcc78f46450027089b716824a?s=128&d=identicon&r=PG&f=1", "display_name": "tnap", "link": "https://stackoverflow.com/users/7792863/tnap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496817611, "creation_date": 1496808743, "last_edit_date": 1496817611, "question_id": 44403361, "link": "https://stackoverflow.com/questions/44403361/global-variables-to-local-variables", "title": "Global variables to local variables", "body": "<p>My program to find the roots of a function using the quadratic formula is below. It works perfectly. However I was unable to get it to work without defining three of the variables globally; which, according to my project description, I am not supposed to do.</p>\n\n<p>Any suggestions or alterations on how to define them locally and have the calculations not get lost before the print results function is able to do so? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ndouble discriminant;\ndouble root_one = 0, root_two = 0;\ndouble a = 0, b = 0, c = 0;\n\nint checkComplex(double a, double b, double c)\n{\n    discriminant = (b * b) - 4 * (a * c);\n\n    if (discriminant == 0)\n        return 2;\n\n    else if (discriminant &gt; 0)\n        return 1;\n\n    else\n        return 0;\n}// end checkComplex\n\nvoid calculateRoots(double a, double b, double c)\n{\n    root_one = (-b + sqrt(discriminant)) / (2 * a);\n    root_two = (-b - sqrt(discriminant)) / (2 * a);\n} // end calculateRoots\n\nvoid getData()\n{\n    printf(\"Enter a: \");\n    scanf(\"%lf\", &amp;a);\n\n    printf(\"\\nEnter b: \");\n    scanf(\"%lf\", &amp;b);\n\n    printf(\"\\nEnter c: \");\n    scanf(\"%lf\", &amp;c);\n}// end getData\n\nvoid printResults()\n{\n    if (checkComplex(a, b, c) == 1)\n    {\n        calculateRoots(a, b, c);\n        printf(\"\\n\\n-----------------------------------------\\n\");\n        printf(\"\\nThe quantity (b^2-4ac) is %.2lf\", discriminant);\n        printf(\"\\n\\nfirst root = %.2lf\\nsecond root = %.2lf\\n\\n\", root_one,\n               root_two);\n    }// if discriminant is 1\n\n\n    else if (checkComplex(a, b, c) == 0)\n    {\n        printf(\"\\n\\n-----------------------------------------\\n\");\n        printf(\"The discriminant (b^2-4ac) is negative (imaginary)\");\n        printf(\"\\nTherefore, the roots are complex\\n\");\n    } // if discriminant is 0\n\n    else if (checkComplex(a == 2, b == 2, c == 2))\n    {\n        calculateRoots(a, b, c);\n        printf(\"\\n\\n-----------------------------------------\\n\");\n        printf(\"\\nThe quantity (b^2-4ac) is %.2lf\", discriminant);\n        printf(\"\\n\\nfirst root = %.2lf\\nsecond root = %.2lf\\n\\n\", root_one,\n               root_two);\n    }// if discriminant is greater than 1\n} // end printResults\n\nint main()\n{\n    getData();\n    printResults();\n    return 0;\n} // End program\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496809241, "post_id": 44403347, "comment_id": 75806158, "body": "<code>main()</code> must return an <code>int</code>. You need <code>int main(void) {}</code>, or <code>int main(int argc, char *argv[]) {}</code>."}, {"owner": {"reputation": 23, "user_id": 7298120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pl8dq.jpg?s=128&g=1", "display_name": "Grakon2702", "link": "https://stackoverflow.com/users/7298120/grakon2702"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496809563, "post_id": 44403347, "comment_id": 75806251, "body": "I use Turbo C compiler, where I can type main function just like that."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1496809602, "post_id": 44403347, "comment_id": 75806263, "body": "That is implementation dependent, and not at all portable."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1496809676, "post_id": 44403347, "comment_id": 75806286, "body": "Show exactly what &quot;nonsense&quot; you got"}, {"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496809720, "post_id": 44403347, "comment_id": 75806295, "body": "@M.M, <code>407</code> is the &quot;nonsense&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "edited": false, "score": 1, "creation_date": 1496810129, "post_id": 44403347, "comment_id": 75806405, "body": "@asimes You guess, I&#39;m asking OP to post their output"}, {"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496810197, "post_id": 44403347, "comment_id": 75806422, "body": "@M.M, That is not a guess, it is deterministic"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1496816047, "post_id": 44403347, "comment_id": 75808668, "body": "Stylistic note: it&#39;s common practice to use <i>ALLCAPS</i> identifiers for macros, so better pick another naming scheme for variables like <i>camelCase</i> or <i>underscore_separated</i>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7298120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pl8dq.jpg?s=128&g=1", "display_name": "Grakon2702", "link": "https://stackoverflow.com/users/7298120/grakon2702"}, "edited": false, "score": 0, "creation_date": 1496810344, "post_id": 44403478, "comment_id": 75806456, "body": "This helped. Thank you :)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496820556, "post_id": 44403478, "comment_id": 75811343, "body": "pow() invokes floating point arithmetic though, so there will not necessarily be an exact result."}], "tags": [], "owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "is_accepted": true, "score": 1, "last_activity_date": 1496809546, "creation_date": 1496809546, "answer_id": 44403478, "question_id": 44403347, "link": "https://stackoverflow.com/questions/44403347/simple-c-function-returns-nonsense/44403478#44403478", "title": "Simple C function returns nonsense", "body": "<p><code>sscanf</code> is expecting a C string:</p>\n\n<ul>\n<li>During the first iteration it receives <code>\"101\"</code> and <code>101 * 4</code> is <code>404</code></li>\n<li>During the second iteration it receives <code>01</code> and <code>1 * 2</code> is <code>2</code></li>\n<li>During the third iteration it receives <code>1</code> and <code>1 * 1</code> is <code>1</code></li>\n<li><code>404 + 2 + 1</code> is <code>407</code> which must be the nonsense you are seeing</li>\n</ul>\n\n<p>What you want is to convert each character:</p>\n\n<pre><code>DIGIT = bin_num[I] - '0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 572, "user_id": 2995747, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yMwTw.jpg?s=128&g=1", "display_name": "danishansari", "link": "https://stackoverflow.com/users/2995747/danishansari"}, "is_accepted": false, "score": 0, "last_activity_date": 1496809702, "creation_date": 1496809702, "answer_id": 44403511, "question_id": 44403347, "link": "https://stackoverflow.com/questions/44403347/simple-c-function-returns-nonsense/44403511#44403511", "title": "Simple C function returns nonsense", "body": "<p>You can convert string to long in one go, no need to iterate in loop. Changing your code like below can give you desired output</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\nlong bintodec(const char *bin_num) \n{\n  long DIGIT, SUBTOTAL, RESULT = 0, I, LEN, REM;\n  LEN = strlen(bin_num);\n\n  sscanf(bin_num, \"%li\", &amp;DIGIT);\n  printf(\"DIGIT = %li\\n\", DIGIT);\n\n  for (I = 0; I &lt; LEN; I++)\n  {\n    REM = DIGIT%10;\n    RESULT += REM * pow(2, I);\n\n    DIGIT /= 10;\n  }\n\n  return RESULT;\n}\n\nint main() {\n  printf(\"%li\", bintodec(\"101\"));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 6590587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6711acfbd2485de43e9bcb15d63961b?s=128&d=identicon&r=PG&f=1", "display_name": "Evan", "link": "https://stackoverflow.com/users/6590587/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1496811934, "last_edit_date": 1496811934, "creation_date": 1496811602, "answer_id": 44403850, "question_id": 44403347, "link": "https://stackoverflow.com/questions/44403347/simple-c-function-returns-nonsense/44403850#44403850", "title": "Simple C function returns nonsense", "body": "<p>Rather than debug your code, I'll present a more elegant solution. Consider:</p>\n\n<pre><code>long bintodec(const char *bin_num)\n{\n    long sum = 0;\n    for (; *bin_num != '\\0'; bin_num++) /* move pointer through string */\n    {\n        sum &lt;&lt;= 1; /* shift bits left (meaningless on first pass) */\n        sum |= (*bin_num == '1'); /* conditionally tack on new least significant bit */\n    }\n    return sum;\n}\n</code></pre>\n\n<p>Some notes:</p>\n\n<p>The key point is that the bits that encode integer type variables are identical to the binary sequence that you pass in as a string. Thus: <em>bitwise operators</em>. The only ones we need here are left bit-shift, which shifts each of the underlying bits one place to the left, and bitwise-or, which logically or's the bits of two numbers against one another. The equivalent representations render valid a pictorial understanding of the problem. </p>\n\n<p>Rather than having to pass through the entire string to determine its length, and using that to inform the pow function, we can slot incoming bits in on the right.  </p>\n\n<p>Here's what's going on within the for loop:</p>\n\n<p>1st pass:</p>\n\n<pre><code>sum &lt;&lt;= :           00000        /* more zero's contained in a long */\nstring:            \"10101\"\nptr:                ^\nsum |= :            00001\n</code></pre>\n\n<p>2nd pass:</p>\n\n<pre><code>sum:                00010\nstring:            \"10101\"\nptr:                 ^\nsum:                00010\n</code></pre>\n\n<p>3rd pass:</p>\n\n<pre><code>sum:                00100\nstring:            \"10101\"\nptr:                  ^\nsum:                00101    \n</code></pre>\n\n<p>... and so forth. </p>\n\n<p>In general, rather than invoking</p>\n\n<pre><code>pow(2, arg)\n</code></pre>\n\n<p>you should leverage the bit-shift operator, which exactly accomplishes multiplication by some power of two. (Appending a zero is multiplication by 10 in base 10). </p>\n"}], "owner": {"reputation": 23, "user_id": 7298120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pl8dq.jpg?s=128&g=1", "display_name": "Grakon2702", "link": "https://stackoverflow.com/users/7298120/grakon2702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 44403478, "answer_count": 3, "score": -2, "last_activity_date": 1496811934, "creation_date": 1496808668, "question_id": 44403347, "link": "https://stackoverflow.com/questions/44403347/simple-c-function-returns-nonsense", "title": "Simple C function returns nonsense", "body": "<p>I need to make simple function that converts binary number (string) to decimal number (long). When it returns result, it's nonsense. I've tried to return all others variables and it returned correct numbers. There is something wrong with my result variable.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"string.h\"\n#include \"math.h\"\n\nlong bintodec(const char *bin_num) {\n        long DIGIT, SUBTOTAL, RESULT = 0, I, LEN;\n        LEN = strlen(bin_num);\n        for(I = 0; I != LEN; I++) {\n                sscanf(&amp;bin_num[I], \"%li\", &amp;DIGIT);\n                SUBTOTAL = DIGIT * pow(2, LEN - I - 1);\n                RESULT = RESULT + SUBTOTAL;\n        }\n        return RESULT;\n}\n\nmain() {\n        clrscr();\n        printf(\"%li\", bintodec(\"101\"));\n        getch();\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "rust"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1496807858, "post_id": 44403154, "comment_id": 75805854, "body": "Have you tried comparing the assembly for your two versions of the C program?  Chances are that your loop is never executed, because it has no effect on your program&#39;s output."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1496815187, "post_id": 44403154, "comment_id": 75808260, "body": "@paddy update to global variables are side effects. I am not sure any compiler would optimize that."}], "answers": [{"comments": [{"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496813252, "post_id": 44403421, "comment_id": 75807483, "body": "&quot;<code>If you change the code to run the same loop before the measurement, the runtime goes down considerably. It&#39;s actually faster than the C version on my machine.</code>&quot;. Sorry, I can&#39;t catch your meaning. Could you explain it? Thx!"}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496813517, "post_id": 44403421, "comment_id": 75807564, "body": "@NanXiao added the example"}, {"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496814021, "post_id": 44403421, "comment_id": 75807752, "body": "I compile the <code>C</code> program using <code>Clang</code>, and the performance is as good as <code>gcc</code> compiler."}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496814861, "post_id": 44403421, "comment_id": 75808104, "body": "@NanXiao Yeah, I should&#39;ve just removed it instead. There were a few bad assumptions there."}, {"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496815442, "post_id": 44403421, "comment_id": 75808372, "body": "<code>Another thing I missed is that Rust puts the array in a data section, while C actually writes (memset with pattern) to the memory.</code>. I have little confused about this explanation. I think <code>C</code> also puts the global array in data section. Could you elaborate it? Thx!"}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496815590, "post_id": 44403421, "comment_id": 75808455, "body": "@NanXiao It doesn&#39;t. Compile with <code>gcc -O2 -S ...</code> and you&#39;ll see the initial values created via <code>_memset_pattern16</code> or similar. Rust just embeds the repeating values in the data section. <code>rustc --emit asm ...</code>"}, {"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496816251, "post_id": 44403421, "comment_id": 75808777, "body": "Sorry I still can&#39;t get your point. Per my understanding, data section will also reside in memory. Right? So every operation will finally update the data in array which in memory."}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 2, "creation_date": 1496816481, "post_id": 44403421, "comment_id": 75808907, "body": "What rust does is put the actual values of the array one after another in the resulting binary it compiles. So when you start the binary, they may not even be completely read from the disk yet. When you read them for the first time, they may causes page faults that need to be handled. C instead initialises the whole array in a loop at the start, so by the time you get to your loop, the range is definitely allocated and written to. Compile both with the commands I showed before and see the end of the resulting file."}, {"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1496817950, "post_id": 44403421, "comment_id": 75809798, "body": "I get your point. <code>for (j = 0; j &lt; STREAM_ARRAY_SIZE; j++) { A[j] = 1.0; }</code> in <code>C</code> program will load array from disk to memory, so in the second calculation loop, the speed will definitely fast."}, {"owner": {"reputation": 623, "user_id": 1955971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f1d7c2842d4d6be9c8f79e1384f284af?s=128&d=identicon&r=PG", "display_name": "Aleksander Fular", "link": "https://stackoverflow.com/users/1955971/aleksander-fular"}, "edited": false, "score": 5, "creation_date": 1496826213, "post_id": 44403421, "comment_id": 75815104, "body": "You could put in the first sentence of your answer something saying that rust is not at fault and the benchmark is incorrect :). So after first look at your answer one does not get the incorrect impression."}], "tags": [], "owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "is_accepted": true, "score": 9, "last_activity_date": 1496838838, "last_edit_date": 1496838838, "creation_date": 1496809188, "answer_id": 44403421, "question_id": 44403154, "link": "https://stackoverflow.com/questions/44403154/why-is-a-program-that-updates-a-large-static-floating-point-array-slower-in-rust/44403421#44403421", "title": "Why is a program that updates a large static floating point array slower in Rust than in C?", "body": "<p>Rust compiles the loop to:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>.LBB0_1:\n    movupd  xmm0, xmmword ptr [rcx + 8*rax - 48]\n    movupd  xmm1, xmmword ptr [rcx + 8*rax - 32]\n    addpd   xmm0, xmm0\n    addpd   xmm1, xmm1\n    movupd  xmmword ptr [rcx + 8*rax - 48], xmm0\n    movupd  xmmword ptr [rcx + 8*rax - 32], xmm1\n    movupd  xmm0, xmmword ptr [rcx + 8*rax - 16]\n    movupd  xmm1, xmmword ptr [rcx + 8*rax]\n    addpd   xmm0, xmm0\n    addpd   xmm1, xmm1\n    movupd  xmmword ptr [rcx + 8*rax - 16], xmm0\n    movupd  xmmword ptr [rcx + 8*rax], xmm1\n    add rax, 8\n    cmp rax, 100006\n    jne .LBB0_1\n</code></pre>\n\n<p>While GCC 7.1.0 compiles to:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>L6:\n    movsd   (%rbx), %xmm0\n    addq    $8, %rbx\n    addsd   %xmm0, %xmm0\n    movsd   %xmm0, -8(%rbx)\n    cmpq    %rbp, %rbx\n    jne     L6\n</code></pre>\n\n<p>Rust puts the array in a data section, while C actually writes (<code>memset</code> with pattern) to the memory. This means that your OS running the app likely just maps the range and relies on virtual memory to do the right thing.</p>\n\n<p>If you change the code to run the same loop before the measurement, the runtime goes down considerably. It's actually faster than the C version on my machine. (possibly due to that loop unrolling)</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>unsafe {\n    for i in 0..STREAM_ARRAY_SIZE {\n        A[i] = 2.0E0 * A[i];\n    }\n}\n\nlet now = Instant::now();\n\nunsafe {\n    for i in 0..STREAM_ARRAY_SIZE {\n        A[i] = 2.0E0 * A[i];\n    }\n}\n\nlet duration = now.elapsed();\n</code></pre>\n"}], "owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 44403421, "answer_count": 1, "score": 7, "last_activity_date": 1496838838, "creation_date": 1496807330, "last_edit_date": 1496838762, "question_id": 44403154, "link": "https://stackoverflow.com/questions/44403154/why-is-a-program-that-updates-a-large-static-floating-point-array-slower-in-rust", "title": "Why is a program that updates a large static floating point array slower in Rust than in C?", "body": "<p>I wrote a simple program to compare Rust and C performance.  </p>\n\n<p>The Rust version:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>use std::time::Instant;\n\nconst STREAM_ARRAY_SIZE: usize = 10000000;\nstatic mut A: [f64; STREAM_ARRAY_SIZE] = [1.0; STREAM_ARRAY_SIZE];\n\nfn main() {\n    let now = Instant::now();\n\n    unsafe {\n        for i in 0..STREAM_ARRAY_SIZE {\n            A[i] = 2.0E0 * A[i];\n        }\n    }\n\n    let duration = now.elapsed();\n    println!(\"{}\", (duration.as_secs() * 1_000_000_000 + duration.subsec_nanos() as u64) / 1000);\n}\n</code></pre>\n\n<p>Run it in debug &amp; release mode:  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ ./target/debug/calc\n472046 us.\n$ ./target/release/calc\n62860 us.\n</code></pre>\n\n<p>The release version has a drastic performance gain compared to debug.  </p>\n\n<p>The C version does the same thing and runs on the same server:  </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;sys/time.h&gt;\n#include &lt;stdio.h&gt;\n\n#define STREAM_ARRAY_SIZE   10000000\n\nstatic double A[STREAM_ARRAY_SIZE];\nint mysecond(void)\n{\n        struct timeval tp;\n        struct timezone tzp;\n        int i;\n\n        i = gettimeofday(&amp;tp,&amp;tzp);\n        return (tp.tv_sec * 1000000 + tp.tv_usec);\n}\n\nint main(void)\n{\n    int j = 0;\n    for (j = 0; j &lt; STREAM_ARRAY_SIZE; j++)\n    {\n        A[j] = 1.0;\n    }\n\n    int t = mysecond();\n    for (j = 0; j &lt; STREAM_ARRAY_SIZE; j++)\n    {\n        A[j] = 2.0E0 * A[j];\n    }\n    printf(\"%d us.\\n\", mysecond() - t);\n    return 0;\n}\n</code></pre>\n\n<p>Compile and run it with <code>-O0</code> and <code>-O2</code>:  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ gcc test.c\n$ ./a.out\n41626 us.\n$ gcc -O2 test.c\n$ ./a.out\n13499 us.\n</code></pre>\n\n<p>The Rust optimized version only compares to <code>gcc -O0</code>, and is very weak compared to <code>gcc -O2</code>. Is this reasonable? How can I improve the performance of the Rust version?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496817761, "post_id": 44402839, "comment_id": 75809654, "body": "There is NO need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496935984, "post_id": 44402839, "comment_id": 75877494, "body": "when calling any of the heap allocation functions (malloc, calloc, realloc) 1) always check (!=NULL) the returned value to assure the operation was successful.  2) the returned type is <code>void*</code> so can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc. 3) when calling <code>realloc()</code>, always assign the result to a temp variable then check that variable, and if not NULL, then assign to the target variable.  Otherwise, when the function fails, the pointer to the original memory is lost, resulting in a memory leak"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496936264, "post_id": 44402839, "comment_id": 75877738, "body": "the line starting with: <code>https:</code> does not compile.  Suggest modifying to: <code>&#47;&#47;https:</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496936943, "post_id": 44402839, "comment_id": 75878219, "body": "for ease of readability and understanding: 1) consistently indent the code. Indent after every opening brace &#39;{&#39;. unindent before every closing brace &#39;}&#39;. Suggest each indent level be 4 spaces. 2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line. 3) separate functions by 2 or 3 blank lines (be consistent)  4) follow the axiom:: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496937363, "post_id": 44402839, "comment_id": 75878521, "body": "this statement: <code>*(*(matrix + r)+c) = rand() % 99 + 1;</code> will not do what you are expecting.  the expression:  <code>rand() % 99 + 1</code> will become: <code>rand() % 100</code>.  Suggest: <code>(rand() % 99) + 1</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496937490, "post_id": 44402839, "comment_id": 75878588, "body": "this statement: <code>srand(2016);</code> will always result in the same sequence of values from the <code>rand()</code> function.  Suggest using something more appropriate like: <code>srand( time(void) );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496937739, "post_id": 44402839, "comment_id": 75878760, "body": "the functions (malloc, calloc, realloc) expect their parameter to be of type <code>size_t</code> not <code>int</code>, so the variable declarations for <code>rows</code>, <code>cols</code>, <code>r</code>, <code>c</code>, (and perhaps <code>i</code>) should be of type <code>size_t</code>, not <code>int</code>.   The C &#39;implicit conversion&#39; feature may save you, but should not be relied upon."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496937808, "post_id": 44402839, "comment_id": 75878815, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496938288, "post_id": 44402839, "comment_id": 75879143, "body": "in the function: <code>transpose()</code>, the variable <code>tmp</code> is not declared. suggest replace this line: <code>tmp= *(*(matrix + i) + j);</code>  with this line: <code>int tmp= *(*(matrix + i) + j);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496938928, "post_id": 44402839, "comment_id": 75879568, "body": "regarding this code block: <code>while(matrix[i] != 0)     {         free(matrix[i]);         ++i;     }</code>  the allocation of the array of pointers for the <code>matrix</code> did not  allocate an extra pointer, nor did it set such a pointer to NULL. so the loop will continue until some (random) area in memory is encountered that contains a NULL value.  Suggest using something similar to: <code>for( size_t i=0; i&lt;rows; i++ ) { free( matrix[i] ); }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496939286, "post_id": 44402839, "comment_id": 75879772, "body": "when transposing a matrix, allocate a new matrix, with the appropriate dimensions. Then copy the data from the old matrix to the new matrix, cell by cell.  trying to perform the transpose &#39;in place&#39; will result in corrupted data, possible seg fault events, corruption of the heap data structure, etc."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1496939511, "post_id": 44402839, "comment_id": 75879908, "body": "variable names (and function parameter names) should indicate <code>content</code> or <code>usage</code>  (or better, both).  parameter names like <code>m</code> and <code>n</code> and (perhaps) <code>r</code> and <code>c</code> are meaningless, even in the current context."}], "answers": [{"tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 1, "last_activity_date": 1496806543, "creation_date": 1496806543, "answer_id": 44403045, "question_id": 44402839, "link": "https://stackoverflow.com/questions/44402839/transpose-a-matrix-using-c-pointer-memory-access-error/44403045#44403045", "title": "transpose a matrix using c pointer, memory access error", "body": "<pre><code> else if(cols &lt; rows){\n matrix = (int **)realloc(matrix, cols*sizeof(int*));\n }\n</code></pre>\n\n<p>In this case you are reallocating matrix with lesser rows, but the loop that follows it still accesses it till <code>rows</code></p>\n\n<pre><code>   for (i = 0; i &lt; rows; i++) {\n    for (j = i +1 ; j &lt; cols ; j++) {\n     tmp= *(*(matrix + i) + j);\n     *(*(matrix + i) + j) = *(*(matrix + j) + i);\n     *(*(matrix + j) + i) = tmp;\n    }\n }\n</code></pre>\n\n<p><code>*(*(matrix + i) + j);</code> when i > cols will result in access to invalid memory, as matrix is reallocated to <code>cols</code> number of addresses</p>\n"}], "owner": {"reputation": 45, "user_id": 7205436, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/111429d4cd87cb99d619a09cee0df681?s=128&d=identicon&r=PG&f=1", "display_name": "hj_", "link": "https://stackoverflow.com/users/7205436/hj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496806543, "creation_date": 1496804864, "question_id": 44402839, "link": "https://stackoverflow.com/questions/44402839/transpose-a-matrix-using-c-pointer-memory-access-error", "title": "transpose a matrix using c pointer, memory access error", "body": "<p>Without newly allocating memory to 'transposed' I tried to realloc on 'matrix' <a href=\"https://codepad.remoteinterview.io/WGIBSKENXV\" rel=\"nofollow noreferrer\">https://codepad.remoteinterview.io/WGIBSKENXV</a> when I run it on web it works fine but on visual basic 2017, it gives me access violation error at double for loop part.\nThe way that just allocates new memory to 'transposed' also works okay on web, but on visual basic 2017 it gives access violation error.\nWhat is wrong??</p>\n\n<p>When I allocate memory in a defined function, should I free it in the main function? as with 'matrix'(the one that I allocated in main function)? Did I do it correctly?</p>\n\n<pre><code> # include &lt;stdio.h&gt;\n # include &lt;stdlib.h&gt;\n\n int** transpose (int **matrix, int m, int n);\n void printMatrix(int **matrix, int m, int n);\n\n int main (void){\n int rows, cols;\n int r, c, i;\n int **matrix;\n\n printf(\"Number of Rows : \");\n scanf(\"%d\", &amp;rows);\n printf(\"Number of Cols : \");\n scanf(\"%d\", &amp;cols);\n\n matrix = (int **)malloc(rows*sizeof(int*));\n for(i = 0; i &lt; rows; i++){ \n matrix[i] = (int*)malloc(cols*sizeof(int));\n }\n\n srand(2016);\n for( r = 0; r &lt; rows; r++ ){\n      for( c = 0; c &lt; cols; c++ ){\n           *(*(matrix + r)+c) = rand() % 99 + 1;\n      }\n }\n\n printf(\"Matrix produced with seed number 2016\\n\");\n printMatrix(matrix, rows, cols);\n\n matrix = transpose(matrix, rows, cols);\n\n printf(\"Transposed Matrix\\n\");\n printMatrix(matrix, rows, cols);\n\n         i = 0;\n while(matrix[i] != 0){\n        free(matrix[i]);\n        ++i;\n }\n    free(matrix);\n  /*\n    i = 0;\n    while(transposed[i] != 0){\n         free(transposed[i]);\n         ++i;\n    }\n    free(transposed);\n  */   \n    return 0;\n }\n       //When I allocate memory in a defined function, should I free it in the main function? as with 'matrix'? Did I do it correctly?\n\n int** transpose (int **matrix, int rows, int cols){\n\n int i ,j;\n\n if( rows &lt; cols ){\n for(i = 0; i &lt; rows; i++){ \n matrix[i] = (int*)realloc(matrix[i], rows*sizeof(int));\n }\n }\n else if(cols &lt; rows){\n matrix = (int **)realloc(matrix, cols*sizeof(int*));\n }\n\n   for (i = 0; i &lt; rows; i++) {\n    for (j = i +1 ; j &lt; cols ; j++) {\n     tmp= *(*(matrix + i) + j);\n     *(*(matrix + i) + j) = *(*(matrix + j) + i);\n     *(*(matrix + j) + i) = tmp;\n    }\n }\n      return matrix;\n\n // Without newly allocating memory to 'transposed' I tried to realloc on 'matrix'\n https://codepad.remoteinterview.io/WGIBSKENXV when I run it on web it works fine but on visual basic 2017, it gives me access violation error at double for loop part.\n\n\n  /*\n int ** transposed;\n transposed = (int **)malloc(cols*sizeof(int*));\n for(i = 0; i &lt; cols; i++){ \n transposed[i] = (int*)malloc(rows*sizeof(int));\n }\n\n for (i = 0; i &lt; rows; i++) {\n    for (j = 0 ; j &lt; cols; j++) {\n     *(*(transposed + j )+ i )= *(*(matrix + i) + j);\n     *(*(transposed + i) + j) = *(*(matrix + j) + i);\n    }\n }     \n return transposed;\n */\n\n // Just allocating new memory to 'transposed' works okay on web https://codepad.remoteinterview.io/WGIBSKENXV, but on visual basic 2017 it gives access violation error. When I allocate memory in a defined function, should I free it in the main function? as with 'matrix'? Did I do it correctly?\n }     \n void printMatrix(int **matrix, int m, int n){\n int i, j;\n\n for( i = 0; i &lt; m; i++ ){\n for( j = 0; j &lt; n; j++ ){\n printf(\"%4d\", *(*(matrix + i )+j) );\n }\n printf(\"\\n\");\n }\n\n }\n</code></pre>\n"}, {"tags": ["c", "dynamic", "segmentation-fault", "undefined", "heap-memory"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 5, "creation_date": 1496802651, "post_id": 44402493, "comment_id": 75804728, "body": "<code>*b[j]</code> --&gt; <code>(*b)[j]</code>"}, {"owner": {"reputation": 39, "user_id": 4377241, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001232946586/picture?type=large", "display_name": "Ritesh Sharma", "link": "https://stackoverflow.com/users/4377241/ritesh-sharma"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496858781, "post_id": 44402493, "comment_id": 75838169, "body": "@BLUEPIXY  I can&#39;t see the difference between the two, can you give some insight. Also is there some reference on how pointers actually work. I have a lot of doubts in this matter."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1496860144, "post_id": 44402493, "comment_id": 75838874, "body": "See <a href=\"http://ideone.com/bxmK5W\" rel=\"nofollow noreferrer\">DEMO</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4377241, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001232946586/picture?type=large", "display_name": "Ritesh Sharma", "link": "https://stackoverflow.com/users/4377241/ritesh-sharma"}, "edited": false, "score": 0, "creation_date": 1496858840, "post_id": 44402841, "comment_id": 75838200, "body": "b gets swapped with c after every iteration in fibo()"}], "tags": [], "owner": {"reputation": 484, "user_id": 5834521, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QBMYVTwXyGs/AAAAAAAAAAI/AAAAAAAAA8M/y7HIjlZQRVA/photo.jpg?sz=128", "display_name": "Vishwajeet Vishu", "link": "https://stackoverflow.com/users/5834521/vishwajeet-vishu"}, "is_accepted": false, "score": 0, "last_activity_date": 1496804872, "creation_date": 1496804872, "answer_id": 44402841, "question_id": 44402493, "link": "https://stackoverflow.com/questions/44402493/undefined-behaviour-on-dynamic-allocated-arrays-segmentation-fault/44402841#44402841", "title": "undefined behaviour on dynamic allocated arrays (segmentation fault)", "body": "<p>You are not updating <code>b[]</code> value as you are expecting it to be. you have stored <code>b[0]=t2</code> and after that it is not updated anywhere else. so your program gives segmentation fault at <code>b[1]</code>.So i will say just update <code>b[]</code> array and you are good to go. and also please practice to provide a little bit of comment in your code it is really hard to read.</p>\n"}, {"tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 1, "last_activity_date": 1496805014, "creation_date": 1496805014, "answer_id": 44402860, "question_id": 44402493, "link": "https://stackoverflow.com/questions/44402493/undefined-behaviour-on-dynamic-allocated-arrays-segmentation-fault/44402860#44402860", "title": "undefined behaviour on dynamic allocated arrays (segmentation fault)", "body": "<p>As pointed out in comments by BLUEPIXY, <code>*b[j]</code> should be changed to <code>(*b)[j]</code>, as you have passed b to <code>fibo</code>  as double pointer, b stores address of pointer variable from main function which in turn stores address where array is present.</p>\n\n<p><code>*b[j]</code> will get evaluated to <code>*(*(b+j))</code> address stored in b is valid(address of pointer variable b from main), <code>b+j</code> takes you to invalid address, accessing it might be leading to segment fault</p>\n\n<p>You need j'th element from array whose address is stored in b, right way to access will be  <code>(*b)[j]</code> where (*b) gets you the base address of your array </p>\n"}], "owner": {"reputation": 39, "user_id": 4377241, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001232946586/picture?type=large", "display_name": "Ritesh Sharma", "link": "https://stackoverflow.com/users/4377241/ritesh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496805014, "creation_date": 1496802383, "question_id": 44402493, "link": "https://stackoverflow.com/questions/44402493/undefined-behaviour-on-dynamic-allocated-arrays-segmentation-fault", "title": "undefined behaviour on dynamic allocated arrays (segmentation fault)", "body": "<p>This program calculates Fibonacci series of the form: t1, t2, t3 = t1 + t^2, t4 = t2+t3^2 ...</p>\n\n<p>It takes three inputs t1, t2 and nth number in the series you want to calculate. </p>\n\n<p>Since the numbers increase exponentially, i used arrays to display and perform manipulations on large numbers. </p>\n\n<h1>PROBLEM:</h1>\n\n<p>I'm stuck with some weird error on:</p>\n\n<pre><code>bsquare[j] = *b[j]\n</code></pre>\n\n<p>use inputs 0 1 8 to recreate the error, it works fine for inputs upto 7. also i tried debugging using gdb, but the debugger shows that memory is accessible when i use p **b@50 and bn also seems to be valid. Is there some undefined behaviour i'm missing out on?</p>\n\n<h2>Code</h2>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint carry = 0;\nint fibo( int **a, int **b, int **c, int n);\nvoid sum(int *a, int *b, int *c, int *an, int *bn, int *cn);\nvoid sqr(int *b, int *bn);\nint main()\n{   \n\n    int *a, *b, *c;\n    int t1, t2, n, i, bn;\n\n    scanf(\"%d%d%d\",&amp;t1, &amp;t2,&amp;n);\n\n    a = (int * ) calloc(100, sizeof(int));\n    b = (int * ) calloc(100, sizeof(int));\n    c = (int * ) calloc(100, sizeof(int));\n    a[0] = t1; b[0] = t2;\n\n    bn = fibo(&amp;a,&amp;b,&amp;c,n);\n\n    printf(\"\\nNumber is: \");\n    for(i = bn-1; i&gt;=0; i--)\n    printf(\"%d\",b[i]);\n\n    free(a);free(b);free(c);\n    return 0;\n}\nvoid sqr(int *b, int *bn)\n{   int c[50] = {0};\n    int i , j ,k = 0;\n    int temp = 0;\n    for(i = 0; i &lt; *bn; i++)\n    {    k = i;\n        carry = 0;\n        for(j = 0; j &lt; *bn ;j++)\n        {\n            temp = c[k] + b[i] * b[j] + carry;\n            if(temp&gt;9)\n            {\n                carry = temp / 10;\n                c[k] = temp % 10;\n\n            }\n            else\n            {\n                c[k] =  temp;\n                carry = 0;\n            }\n            k++;\n        }\n        if(carry !=0)\n        {c[k++] = carry;\n        }\n\n    }\n\n    for(i = 0; i&lt;k; i++)\n    {   \n        b[i] = c[i];\n\n    }\n\n    *bn = k;\n\n\n\n}\n\nvoid sum(int *a, int *b, int *c, int *an, int *bn, int *cn)\n{\n\n    int i=0 , j ,k = 0;\n    int *temp1;\n    int temp = 0;\n    for(j=0; j&lt;*cn; j++)\n     c[j] = 0;\n            *cn = 0;\n     carry = 0;\n    for(; i &lt; *bn &amp;&amp; i &lt; *an; i++)\n    {   \n        temp = a[i] + b[i] + carry;\n\n        if(temp&gt;9)\n        {\n            c[k] = temp % 10;\n            carry = temp/10;\n\n        }\n        else\n        {\n            c[k] = temp;\n            carry = 0;\n        }\n        k++;\n    }\n\n    while(i&lt;*an)\n    {\n        temp = carry + a[i];\n        if(temp&gt;9)\n        {\n            c[k] = temp % 10;\n            carry = temp/10;\n\n        }\n        else\n        {\n            c[k] = temp;\n            carry = 0;\n        }\n        k++;i++;\n    }\n\n    while(i&lt;*bn)\n    {\n        temp = carry + b[i];\n        if(temp&gt;9)\n        {\n            c[k] = temp % 10;\n            carry = temp/10;\n\n        }\n        else\n        {\n            c[k] = temp;\n            carry = 0;\n        }\n        k++;i++;\n    }\n    if(carry!=0)\n    {\n        c[k++] = carry;\n    }\n\n    *cn = k;\n\n\n\n\n}\n\nint fibo( int **a, int **b, int **c, int n)\n{\n    int i, j,*tmpdb;\n\n    int bn = 1, an = 1, cn = 0, bsn = 0, temp;\n    int bsquare[100] = {0};\n\n    for(i = 3; i&lt;= n; i++)\n        {   \n            for(j = 0; j&lt;bn; j++)\n                bsquare[j] = *b[j];\n\n            bsn = bn;\n\n            sqr(bsquare,&amp;bsn);\n            sum(*a,bsquare,*c,&amp;an,&amp;bsn,&amp;cn);\n\n            tmpdb = *a;\n            *a = *b;\n            *b = *c;\n            *c = tmpdb;\n\n            temp = an;\n            an = bn;\n            bn = cn;\n            cn = temp;\n\n\n\n        }\n    return bn;\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1496799965, "post_id": 44402182, "comment_id": 75804050, "body": "K&amp;R&#39;s <i>The C Programming Language</i> is a very outdated book which is now obsolete as modern C has evolved significantly since then. The last edition was published in 1988 - but since then we&#39;ve had C89, C90, C11 and many compiler-specific variations. My advice is to put the book away and loan a far more recent tome from your library instead, especially one that focuses on C11 (and one that advises against the many <i>unsafe</i> features of the original C standard library, like <code>gets</code>: <a href=\"https://stackoverflow.com/questions/4588581\">stackoverflow.com/questions/4588581</a> )"}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1496800296, "post_id": 44402182, "comment_id": 75804135, "body": "It works for me. I you using the standard include files?"}, {"owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496800378, "post_id": 44402182, "comment_id": 75804153, "body": "Yes I believe that I&#39;m using the standard include files. I&#39;m using &lt;stdio.h&gt;. For me, it only does it on the first &quot;double space.&quot; &quot;hello__cold__World&quot; where each _ is a blank, comes back &quot;hello_coldWorld&quot; and I cannot figure out why."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1496800428, "post_id": 44402182, "comment_id": 75804167, "body": "What is the purpose of <code>c -= &#39; &#39;</code>? This is equivalent to <code>c = c - 32</code>."}, {"owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496800618, "post_id": 44402182, "comment_id": 75804209, "body": "dai, I have actually changed it, and will edit it in my main post to be <code>--c</code>, yet the problem still arises"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1496800662, "post_id": 44402182, "comment_id": 75804218, "body": "If you&#39;re getting more than one character of output then your title is quite misleading. Obviously the loop executes more than once."}, {"owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496800965, "post_id": 44402182, "comment_id": 75804303, "body": "My apologies ninja, this is my first post here. I did not know a better way to phrase the question."}], "answers": [{"tags": [], "owner": {"reputation": 213, "user_id": 7267991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdf8318af718e0c72317d3674ce008c?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/7267991/jimmy"}, "is_accepted": false, "score": 0, "last_activity_date": 1496800434, "creation_date": 1496800434, "answer_id": 44402251, "question_id": 44402182, "link": "https://stackoverflow.com/questions/44402182/why-isnt-this-code-compressing-spaces-correctly/44402251#44402251", "title": "Why isn&#39;t this code compressing spaces correctly?", "body": "<pre><code>int main()\n{\n    int c, nl;\n    nl = 0;\n    while ((c = getchar()) != EOF)\n    {\n        if (c == ' ')\n        {\n            nl ++;\n        }\n        else\n        {\n            nl = 0;\n        }\n\n        if (nl &lt;= 1)\n        {\n            putchar(c);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496803421, "post_id": 44402271, "comment_id": 75804920, "body": "Ah okay that makes so much sense and really helps to answer my question with the whole thing. Thank you."}, {"owner": {"reputation": 348, "user_id": 6518677, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CB_YA9-tCBY/AAAAAAAAAAI/AAAAAAAAAA8/okkXHjvnMY8/photo.jpg?sz=128", "display_name": "Neel Patel", "link": "https://stackoverflow.com/users/6518677/neel-patel"}, "reply_to_user": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496804791, "post_id": 44402271, "comment_id": 75805265, "body": "@Bearz42 if your question answered correctly then close the question by accepting the answer or raise the query so other can try to solve it. That&#39;s how the stack overflow works."}], "tags": [], "owner": {"reputation": 348, "user_id": 6518677, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CB_YA9-tCBY/AAAAAAAAAAI/AAAAAAAAAA8/okkXHjvnMY8/photo.jpg?sz=128", "display_name": "Neel Patel", "link": "https://stackoverflow.com/users/6518677/neel-patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1496801796, "last_edit_date": 1496801796, "creation_date": 1496800597, "answer_id": 44402271, "question_id": 44402182, "link": "https://stackoverflow.com/questions/44402182/why-isnt-this-code-compressing-spaces-correctly/44402271#44402271", "title": "Why isn&#39;t this code compressing spaces correctly?", "body": "<p>Nice try.\nBut you have made some mistakes.<br></p>\n\n<p>You didn't set counter to the initial value when character other then the space is encountered. So if your input have multiple white spaces in between non white space character like <code>33 33 33</code> then the first white space will be printed &amp; others are skipped. So the output would be <code>33 3333</code><br><br>\nyou have to understand that the <code>char</code> data type only store single character &amp; in ASCII encoding. When you apply arithmetic operations on char, it just change the character Value. So when you decrease the char variable it refers to a another character. So ultimately it prints garbage value.<br><br>\nTry this one.</p>\n\n<pre><code>while ((c = getchar()) != EOF){\n    if (c == ' '){\n        ++nl;\n        if (nl &gt;= upper){\n            continue;\n        }\n    }\n    else{\n        nl=0;\n    }\n    putchar(c);\n}\n</code></pre>\n\n<p>Logic is simple...<br>\nIf there is multiple spaces, put the first space &amp; skip others.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496800853, "post_id": 44402281, "comment_id": 75804268, "body": "Thanks for your feedback dai. I commented and edited my post to change the <code>c -= &#39; &#39;</code> to <code>--c</code> But I am a little confused as to why you say that it is meaningless. When removed, the program does not erase the extra spaces at all."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496801150, "post_id": 44402281, "comment_id": 75804346, "body": "@Bearz42 your program shouldn&#39;t &quot;erase&quot; previous output - think about old-school computer printer output (C predates computer displays!) - you couldn&#39;t erase anything in those days - instead think about what you should be outputting next (in a &quot;forward-only&quot; manner) based on the input you&#39;ve already processed instead - this is how Regular Expressions work, for example."}, {"owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "edited": false, "score": 0, "creation_date": 1496803514, "post_id": 44402281, "comment_id": 75804957, "body": "Oh that makes sense. Thanks so much for the help!"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 0, "last_activity_date": 1496801085, "last_edit_date": 1496801085, "creation_date": 1496800669, "answer_id": 44402281, "question_id": 44402182, "link": "https://stackoverflow.com/questions/44402182/why-isnt-this-code-compressing-spaces-correctly/44402281#44402281", "title": "Why isn&#39;t this code compressing spaces correctly?", "body": "<p>The solution you've posted is more complicated than it needs to be - your also performs some operations that seem meaningless to me, such as <code>c -= ' '</code>.</p>\n\n<p>I think you should practice on devising algorithms and problem-solving in general, outside of programming in any specific language. Think about how you would do it yourself given nothing more than input strings and piece of square-lined paper and a pencil.</p>\n\n<p>In pseudo-code, the minimal solution is as-follows:</p>\n\n<pre><code>1. Read character C from input (if there is no input, end program)\n2. If character is a space character:\n    2.1. Was the last printed character a space character too? If so, don't print anything and loop back to step 1.\n3. Else, print character C and loop back to step 1.\n</code></pre>\n\n<p>In C, this can be written minimally (in C11) as:</p>\n\n<pre><code>int main( void )\n{\n    bool last_char_was_space = false;\n    int c;\n    while( ( c = getchar() ) != EOF )\n    {\n        if( last_char_was_space )\n        {\n            if( c == ' ' ) continue; // don't print anything\n            else\n            {\n                putchar( c );\n                last_char_was_space = false;\n            }\n        }\n        else\n        {\n            putchar( c );\n            if( c == ' ' )\n            {\n                last_char_was_space = true;\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This program is a simple example of a \"finite-state machine\", which is an example of a stateful algorithm and the foundational building-block of things like Regular Expressions and other types of parsers. It's an essential technique to familiarise yourself with if you want to write a program that can quickly process data with maximum performance and minimal memory usage.</p>\n"}], "owner": {"reputation": 3, "user_id": 8038428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ac40178a194e0e7ae5d9fd666e6475?s=128&d=identicon&r=PG&f=1", "display_name": "Bearz42", "link": "https://stackoverflow.com/users/8038428/bearz42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44402271, "answer_count": 3, "score": 0, "last_activity_date": 1496818568, "creation_date": 1496799792, "last_edit_date": 1496818568, "question_id": 44402182, "link": "https://stackoverflow.com/questions/44402182/why-isnt-this-code-compressing-spaces-correctly", "title": "Why isn&#39;t this code compressing spaces correctly?", "body": "<p>I'm working through K&amp;R's <em>The C Programming Language</em>. I'm working through an exercise here that says to  \"Write a program that copies all of its input to its output, replacing each string of one or more blanks by a single blank.\" </p>\n\n<p>I believe I have solved it. Somewhat. When first running the program with <code>a.out</code>, I can type in a number with multiple spaces and will get it returned with just one space. But, when I go to the next line and try again, it will return the numbers with no spaces at all. Also, if I type in a string of letters like \"<code>33  33 33</code>\" it will only leave one space for the entire line. It becomes \"<code>33 3333</code>\". </p>\n\n<p>I know that I could just Google the answer to the exercise itself but I don't think that that would help me learn why my code is behaving the way it is. Any help would be much appreciated.</p>\n\n<pre><code>main()\n{\n    int c, nl, upper;\n    nl = 0;\n    upper = 2;\n    while( ( c = getchar() ) != EOF )\n    {\n        if( c == ' ' )\n        { \n            ++nl;\n            if( nl &gt;= upper )\n            {\n                --c;\n                --nl;\n            }\n        }\n        putchar(c);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 1, "creation_date": 1496798366, "post_id": 44402003, "comment_id": 75803732, "body": "Have you googled your question?"}, {"owner": {"reputation": 682, "user_id": 7062289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PzHMLP5eA6E/AAAAAAAAAAI/AAAAAAAAAwU/32-J3Q86O-E/photo.jpg?sz=128", "display_name": "B. Wolf", "link": "https://stackoverflow.com/users/7062289/b-wolf"}, "edited": false, "score": 1, "creation_date": 1496798496, "post_id": 44402003, "comment_id": 75803762, "body": "Possible duplicate <a href=\"https://stackoverflow.com/questions/1478932/check-if-user-inputs-a-letter-or-number-in-c\" title=\"check if user inputs a letter or number in c\">stackoverflow.com/questions/1478932/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 8120919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Oi6.png?s=128&g=1", "display_name": "Morpheus Curriculum Vit&#230;", "link": "https://stackoverflow.com/users/8120919/morpheus-curriculum-vit%c3%a6"}, "reply_to_user": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1496798837, "post_id": 44402003, "comment_id": 75803816, "body": "@KickButtowski yes, I searched, but, I didn&#39;t find in the way that i wanted it"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496798973, "post_id": 44402003, "comment_id": 75803839, "body": "If you use one of the <code>scanf()</code> family of functions, you simply check the value the function returns: it is the number of successful conversions. So, if you try to read <code>int x;</code> from standard input, you can use e.g. <code>if (scanf(&quot;%d&quot;, &amp;x) == 1) { &#47;* Thank you for the value of x *&#47; } else { &#47;* Bad user! Not an integer! *&#47; }</code>"}, {"owner": {"reputation": 29, "user_id": 8120919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Oi6.png?s=128&g=1", "display_name": "Morpheus Curriculum Vit&#230;", "link": "https://stackoverflow.com/users/8120919/morpheus-curriculum-vit%c3%a6"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496799318, "post_id": 44402003, "comment_id": 75803916, "body": "@NominalAnimal thanks man, it worked"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1496813961, "post_id": 44402003, "comment_id": 75807729, "body": "@KickButtowski Google isn&#39;t an authority on programming; unfortunately, in the arena of C programming specifically, Google returns results which are <i>invalid</i> and <i>non-portable</i>. Please don&#39;t make that recommendation again."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496814123, "post_id": 44402003, "comment_id": 75807799, "body": "@user8120919 All of that information and more can be found within <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fscanf.html\" rel=\"nofollow noreferrer\">the <code>fscanf</code> manual</a>. In the future, please keep in mind that C programmers <b>are expected</b> to read manuals in order to avoid undefined behaviour. The Open Group has some nice manuals; they&#39;re usually fairly in sync with the C standard manuals, owing to the adoption of C as a system language for Opengroup/POSIX-compliant UNIX systems."}, {"owner": {"reputation": 29, "user_id": 8120919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Oi6.png?s=128&g=1", "display_name": "Morpheus Curriculum Vit&#230;", "link": "https://stackoverflow.com/users/8120919/morpheus-curriculum-vit%c3%a6"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496918405, "post_id": 44402003, "comment_id": 75864099, "body": "@Seb ok, i&#39;ll see this manuals, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8120919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Oi6.png?s=128&g=1", "display_name": "Morpheus Curriculum Vit&#230;", "link": "https://stackoverflow.com/users/8120919/morpheus-curriculum-vit%c3%a6"}, "edited": false, "score": 0, "creation_date": 1496919289, "post_id": 44406543, "comment_id": 75864655, "body": "I have searched this function before, but when I tested, was having errors, I searched more now and from what I understood, have to use char for this function, not int, which was that I was using"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 29, "user_id": 8120919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Oi6.png?s=128&g=1", "display_name": "Morpheus Curriculum Vit&#230;", "link": "https://stackoverflow.com/users/8120919/morpheus-curriculum-vit%c3%a6"}, "edited": false, "score": 0, "creation_date": 1496983610, "post_id": 44406543, "comment_id": 75895953, "body": "No, @MorpheusCurriculumVit&#230;, you have to use an <code>int</code> which stores an <code>unsigned char</code> value or <code>EOF</code>. What did I write about manuals earlier? You can <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/isdigit.html\" rel=\"nofollow noreferrer\">find the <code>isdigit</code> manual from the OpenGroup standards here</a>. It says, and I quote, &quot;The <i>c</i> argument is an <b>int</b>, the value of which the application shall ensure is a character representable as an <b>unsigned char</b> or equal to the value of the macro EOF. If the argument has any other value, the behavior is undefined.&quot; The emphasis is not mine."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1496983696, "post_id": 44406543, "comment_id": 75895977, "body": "@ddannel See the above comment for my protest against your sentence <i>&quot;It returns a non-zero value if c in a digit, otherwise il resturs 0.&quot;</i>"}], "tags": [], "owner": {"reputation": 51, "user_id": 8026121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/371086e6ed014b4274f0d7f7a06d8637?s=128&d=identicon&r=PG&f=1", "display_name": "ddannel", "link": "https://stackoverflow.com/users/8026121/ddannel"}, "is_accepted": true, "score": 0, "last_activity_date": 1496821500, "creation_date": 1496821500, "answer_id": 44406543, "question_id": 44402003, "link": "https://stackoverflow.com/questions/44402003/how-differentiating-a-char-of-an-int/44406543#44406543", "title": "How differentiating a char of an int?", "body": "<p>Try using isdigit(int c). It returns a non-zero value if c in a digit, otherwise il resturs 0. For more information type 'man isdigit'</p>\n"}], "owner": {"reputation": 29, "user_id": 8120919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Oi6.png?s=128&g=1", "display_name": "Morpheus Curriculum Vit&#230;", "link": "https://stackoverflow.com/users/8120919/morpheus-curriculum-vit%c3%a6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1496822858, "accepted_answer_id": 44406543, "answer_count": 1, "score": -1, "last_activity_date": 1497150510, "creation_date": 1496798204, "last_edit_date": 1497150510, "question_id": 44402003, "link": "https://stackoverflow.com/questions/44402003/how-differentiating-a-char-of-an-int", "closed_reason": "Needs details or clarity", "title": "How differentiating a char of an int?", "body": "<p>I want to know, if have a command that find  which is the type of that it's in the variable , if it's a char or int.\nFor example to make a program that, if anything that isn't a number is entered, show an error to user, because I am using an int variable in the scanf, but if the user type a char, the program continue, I want do it stop, when an type char are typed</p>\n"}, {"tags": ["c", "c89", "size-t"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496798521, "post_id": 44401965, "comment_id": 75803767, "body": "There is plenty about unsigned integer overflow in the standard.  Essentially it uses modulo arithmetic."}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496799064, "post_id": 44401965, "comment_id": 75803855, "body": "@Peter: Well I didn&#39;t find it. The word underflow is used 4 times in the copy that I have and none of it is about unsigned types. Also modulo arithmetic is never mentioned, just the word &quot;modulo&quot;. And normal modulo isn&#39;t necessarily defined for negative values."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1496804285, "post_id": 44401965, "comment_id": 75805140, "body": "Same as <a href=\"https://stackoverflow.com/questions/3472311/what-is-a-portable-method-to-find-the-maximum-value-of-size-t\" title=\"what is a portable method to find the maximum value of size t\">stackoverflow.com/questions/3472311/&hellip;</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496812027, "post_id": 44401965, "comment_id": 75807042, "body": "@FSMaxB - you haven&#39;t read closely enough and the standards don&#39;t spoonfeed like you are expecting.  The 1999 C standard, section 6.2.5, second sentence of para 9.  &quot;A computation involving unsigned operands can never overflow, because a result that cannot be represented by the resulting unsigned integer type is reduced modulo the number that is one greater than the largest value that can be represented by the resulting type.&quot;.  That describes the mathematical notion of modulo arithmetic. I don&#39;t have the 1989 standard handy right now, but it definitely has words with the same net meaning."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496821055, "post_id": 44401965, "comment_id": 75811660, "body": "<code>SIZE_MAX</code> is not necessarily the same thing as <code>~(size_t)0</code> nor <code>(size_t)-1</code>, so the assumption that you can &#39;determine&#39; it is flawed from the start. <code>SIZE_MAX</code> is something set by the compiler. <a href=\"https://stackoverflow.com/questions/42574890/why-is-the-maximum-size-of-an-array-too-large\">See this</a>."}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496821674, "post_id": 44401965, "comment_id": 75812068, "body": "@Peter Yes, C89 has the same paragraph essentially. It&#39;s just that a negative value modulo isn&#39;t necessarily defined. Even Wikipedia says: &quot;When either a or n is negative, the naive definition breaks down and programming languages differ in how these values are defined.&quot; And the standard doesn&#39;t explicitly specify modular arithmetic!"}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496822000, "post_id": 44401965, "comment_id": 75812256, "body": "@Lundin Determining it is not possible in the first place because it doesn&#39;t exist in C89. The goal is just to get the biggest representable value in size_t. Nothing more."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496822418, "post_id": 44401965, "comment_id": 75812526, "body": "@FSMaxB Which, as I just explained, cannot be determined by anyone else but the compiler. Regardless of if that constant exists in the standard library or not."}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1496823901, "post_id": 44401965, "comment_id": 75813521, "body": "@Lundin If I and M.M understand the standard correctly, (size_t)-1 is exactly that. The question you linked to is about actually creating objects that have a size of SIZE_MAX, which is not my question at all."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496837014, "post_id": 44401965, "comment_id": 75823077, "body": "@FSMaxB - The C standard trumps wikipedia. C99, Section 6.3.1.3, para 2 in discussing conversion between signed and unsigned types says &quot;...if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more than the maximum value that can be represented in the new type until the value is in the range of the new type.&quot; Although it doesn&#39;t use words &quot;modulo arithmetic&quot;, again it is describing the same concept - in a way that converting a negative integral value to <code>size_t</code> produces a value between 0 and the maximum value a <code>size_t</code> can represent."}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496839350, "post_id": 44401965, "comment_id": 75824785, "body": "@Peter: Please read my question. It is about C89, not C99. The C89 doesn&#39;t contain any paragraph that talks about repeatedly subtracting or adding."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1496915820, "post_id": 44401965, "comment_id": 75862378, "body": "@FSMaxB - on current machine, I have access to the C99 standard, not C89. However, one feature of C standards is that wording of some topics changed between versions without changing the meaning. One thing I do remember however: the descriptions in all C standards of conversions to unsigned types have described the concept of modulo arithmetic, even if the wording changed with time. In fact, the answer you accepted relies on that property:  <code>-1</code>, when converted to <code>size_t</code>, gives the maximum value a <code>size_t</code> can represent.  It was also a feature of K&amp;R C (i.e. it predated C89)."}], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1496798287, "post_id": 44401992, "comment_id": 75803712, "body": "You can&#39;t cast to <code>size_t</code> in preprocessor arithmetic, though, since <code>size_t</code> is a typedef."}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "edited": false, "score": 0, "creation_date": 1496798757, "post_id": 44401992, "comment_id": 75803805, "body": "@M.M Thanks. I&#39;m not too concerned about preprocessor arithmetic. It would be good to know how to do that though for others that might want to use it in the preprocessor step."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496799294, "post_id": 44401992, "comment_id": 75803911, "body": "If you happen to need it as a value, compile and run <code>#include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; int main(void) { printf(&quot;#define SIZE_MAX %zu\\n&quot;, (size_t)(-1)); return EXIT_SUCCESS; }</code> and redirect the output to a dedicated header file, say <code>size_max.h</code>, that is included in the other source files. If you use a Makefile, it&#39;s actually quite easy to set up."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496799353, "post_id": 44401992, "comment_id": 75803921, "body": "@NominalAnimal I think that&#39;s worth posting as an additional Answer. Although it would not work for cross-compilation , if the binary cannot execute on the build system."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496803106, "post_id": 44401992, "comment_id": 75804835, "body": "@NominalAnimal Perhaps <code>printf(&quot;#define SIZE_MAX %zuu\\n&quot;, (size_t)(-1));</code>, <code>u</code> added to insure value is treated as some unsigned type when it can."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496803437, "post_id": 44401992, "comment_id": 75804931, "body": "@chux: I&#39;ve seen <code>SIZE_MAX</code> defined with <code>U</code> suffix on ILP32 systems, and with <code>UL</code> on <code>LP64</code> systems. We could check <code>CHAR_BIT * sizeof (size_t)</code>, but does that make sense? Or just default to <code>UL</code> suffix, as it should not cause harm on any architecture?"}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496821798, "post_id": 44401992, "comment_id": 75812141, "body": "@NominalAnimal Compiling and running your example program is not an option, because it depends on running code on the destination platform and it relies on a GCC specific printf format specifier."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "edited": false, "score": 0, "creation_date": 1496837303, "post_id": 44401992, "comment_id": 75823278, "body": "@FSMaxB: <code>%z</code> is C99, not a GNU extension, but you could just use <code>printf(&quot;%luu\\n&quot;, (unsigned long)(size_t)(-1));</code> instead. You do not normally need the <code>_MAX</code> and similar macros to be numerical constants anyway, since you are unlikely to do preprocessor arithmetic (<code>#if SIZE_MAX &lt; 5</code> or similar) on them, but <b>if</b> you did, you would either define them &quot;by hand&quot;, or run a compile-time header-builder helper program to do so.  I shall add an explanation to the beginning of my extended comment &quot;answer&quot;."}, {"owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1496839564, "post_id": 44401992, "comment_id": 75824931, "body": "@NominalAnimal: C99 doesn&#39;t work either. If I were able to use C99, I would use SIZE_MAX directly, since SIZE_MAX is defined in C99."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "edited": false, "score": 0, "creation_date": 1496846598, "post_id": 44401992, "comment_id": 75830633, "body": "@FSMaxB: I meant, <code>%z</code> is not a GNU extension, it is from C99. I did not initially notice the C89 in your question, and that was why I used <code>%z</code>. In C89, you can use <code>printf(&quot;%luu\\n&quot;, (unsigned long)(size_t)(-1));</code> to print the value with an <code>u</code> suffix. In general, the above answer by M.M is what I too would suggest you use. My extended comment below is for those others who read your question, but cannot use this answer by M.M, because they happen to need the macro, or something similar, as a preprocessor numerical constant."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 8, "last_activity_date": 1496799314, "last_edit_date": 1496799314, "creation_date": 1496798138, "answer_id": 44401992, "question_id": 44401965, "link": "https://stackoverflow.com/questions/44401965/how-to-get-size-max-in-c89/44401992#44401992", "title": "How to get SIZE_MAX in C89", "body": "<p>You could use:</p>\n\n<pre><code>#ifndef SIZE_MAX\n#define SIZE_MAX ((size_t)(-1))\n#endif\n</code></pre>\n\n<p>The behaviour of converting <code>-1</code> to unsigned integer type is  defined under section C11 6.3.1.3  \"Conversions - Signed and unsigned integers\".  C89 had an equivalent definition, numbered 3.2.1.2.  In fact you quoted the ISO C90 definition 6.2.1.2 in your question (the difference between ANSI C89 and ISO C90 is that the sections are numbered differently).</p>\n\n<p>I would not recommend using a <code>const</code> variable, since they cannot be used in constant expressions.</p>\n\n<hr>\n\n<p>Note: This can't be used in C90 preprocessor arithmetic, which only works on integer constant expressions that contain no casts or words, so we can't use any <code>sizeof</code> tricks. In that case you might need a system-specific definition; there's no standard way for the preprocessor to detect a typedef.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1496804284, "post_id": 44402628, "comment_id": 75805139, "body": "If you are going to assume <code>unsigned long</code> (as indicated by the suffix) you may as well just do <code>#define SIZE_MAX ULONG_MAX</code>.   There are C89 platforms where <code>size_t</code> is not <code>unsigned_long</code> (e.g. one of the MS-DOS memory models has 16-bit size_t and 32-bit long)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1496808253, "post_id": 44402628, "comment_id": 75805937, "body": "I do not see any benefit using <code>UL</code> versus <code>U</code> as the constant will become as wide as needed even without an <code>L</code> or <code>LL</code>.  <code>UL</code> could make <code>SIZE_MAX</code> wider than needed, even if it is only a unicorn platform."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1496809038, "post_id": 44402628, "comment_id": 75806116, "body": "@M.M: No, not my intent. I was not aware of e.g. C11 6.4.4.1p5, <i>&quot;The type of an integer constant is the first of the corresponding list in which its value can be represented&quot;</i>, with the corresponding lists of no-suffix decimal integers only containing <code>int</code>, <code>long int</code>, and <code>long long int</code>; and <code>u</code>-suffix decimal integers containing <code>unsigned int</code>, <code>unsigned long int</code>, and <code>unsigned long long int</code>; i.e. that no-suffix decimal constants will be signed (but as large as needed), and that <code>u</code> suffix decimal constants will be unsigned but as large as needed, like chux commented to above."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 2, "last_activity_date": 1496837940, "last_edit_date": 1496837940, "creation_date": 1496803254, "answer_id": 44402628, "question_id": 44401965, "link": "https://stackoverflow.com/questions/44401965/how-to-get-size-max-in-c89/44402628#44402628", "title": "How to get SIZE_MAX in C89", "body": "<p>I recommend using the macro definition as described in <a href=\"https://stackoverflow.com/a/44401992/1475978\">M.M</a>'s answer.</p>\n\n<p>In some cases, you might need a similar macro, but as a numerical constant, so that you can use it in preprocessor directives like <code>#if VALUE &gt; 42</code> ... <code>#endif</code>. I commented that in such cases, a helper program can be run at compile time, to compute and print a header file defining such constants.</p>\n\n<p>Obviously, this will not work when cross-compiling to a different architecture; in that case, the header file must be provided by some other way. (For example, the project could have a subdirectory of pre-generated headers, and a list of known architectures for each, so that the user can simply copy the header file into place.)</p>\n\n<p>Creating a Makefile and associated facilities for running such programs (and only if the user did not copy the header file into place), is not difficult.</p>\n\n<p>First, let's say your program consists of two source files, <strong>foo.c</strong>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\nextern void hello(void);\n\nint main(void)\n{\n    hello();\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>and a <strong>bar.c</strong>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"size_max.h\"\n\n#define  STRINGIFY_(s) #s\n#define  STRINGIFY(s) STRINGIFY_(s)\n\nvoid hello(void)\n{\n    fputs(\"SIZE_MAX = \\\"\" STRINGIFY(SIZE_MAX) \"\\\".\\n\", stdout);\n}\n</code></pre>\n\n<p>The above bar.c converts the <code>SIZE_MAX</code> preprocessor macro to a string, and prints it. If we had <code>#define SIZE_MAX (size_t)(-1)</code>, it would print <code>SIZE_MAX = \"(size_t)(-1)\"</code>.</p>\n\n<p>Note that bar.c includes file size_max.h, which we do not have. This is the header file we intend to generate using our helper program, <strong>size_max.c</strong>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"#ifndef SIZE_MAX\\n\");\n    printf(\"#define SIZE_MAX %lluU\\n\", (unsigned long long)(size_t)(-1));\n    printf(\"#endif\\n\");\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>chux noted in a comment that <code>u</code> suffix (for sufficiently large unsigned integer type) might be necessary.  If that is not what you require, I'm sure you can modify the macro generator helper to suit your needs.</p>\n\n<p>M.M noted in a comment that <code>%z</code> is not supported by ANSI C/ISO C90, so the above program first creates the constant using <code>(size_t)(-1)</code>, then casts and prints it in the <code>unsigned long long</code> format.</p>\n\n<p>Now, Makefiles can be written in an OS-agnostic manner, but I'm too lazy to do that here, so I shall use the values that work with GNU tools. To make it work on other systems, you only need to modify the values of</p>\n\n<ul>\n<li><p><code>CC</code>, to reflect the compiler you use</p></li>\n<li><p><code>CFLAGS</code>, to reflect your preferred compiler options</p></li>\n<li><p><code>LD</code>, to reflect your linker, unless the same as <code>CC</code></p></li>\n<li><p><code>LDFLAGS</code>, if you need some linker flags (maybe <code>-lm</code>?)</p></li>\n<li><p><code>RM</code>, to reflect the command to delete unnecessary files</p></li>\n<li><p>File names, if your build system requires some funky file name extension for executables</p></li>\n</ul>\n\n<p>Anyway, here's the <strong>Makefile</strong>:</p>\n\n<pre><code>CC      := gcc\nCFLAGS  := -Wall -O2\nLD      := $(CC)\nLDFLAGS := $(CFLAGS)\nRM      := rm -f\n\n# Programs to be built\nPROGS   := example\n\n# Relative path to use for executing the header generator helper program\nHEADERGEN := ./headergen\n\n# Rules that do not correspond to actual files\n.PHONY: all clean headergen\n\n# Default rule is to build all binaries\nall: $(PROGS)\n\n# Clean rule removes build files and binaries\nclean:\n    -$(RM) $(PROGS) $(HELPROG) *.o size_max.h\n\n# Rule to \"rebuild\" size_max.h\nsize_max.h: size_max.c\n    -@$(RM) $(HEADERGEN) size_max.h\n    @$(CC) $(CFLAGS) $^ -o $(HEADERGEN)\n    $(HEADERGEN) &gt; size_max.h\n    @$(RM) $(HEADERGEN)\n\n# Rule to build object files from .c source files\n%.o: %.c size_max.h\n    $(CC) $(CFLAGS) -c $&lt;\n\n# Example binary requires foo.o and bar.o:\nexample: foo.o bar.o size_max.h\n    $(LD) $(LDFLAGS) foo.o bar.o -o $@\n</code></pre>\n\n<p>Note that the indentation should use tabs, not spaces, so if you copy-paste the above, run e.g. <code>sed -e 's|^  *|\\t|' -i Makefile</code> to fix it.</p>\n\n<p>Before zipping or tarring the source tree, run <code>make clean</code> to remove any generated files from it.</p>\n\n<p>Note the extra <code>size_max.h</code> in the recipe prerequisites. It tells <code>make</code> to ensure that <code>size_max.h</code> exists before it can complete the recipe.</p>\n\n<p>The downside of this approach is that you cannot use <code>$^</code> in link recipes to refer to all prerequisite file names. <code>$&lt;</code> refers to the first prerequisite file name. If you use GNU make or a compatible make, you can use <code>$(filter-out %.h, %^)</code> (to list all prerequisites except for header files), though.</p>\n\n<p>If all your binaries are built from a single source with the same name, you can replace the last two recipes with</p>\n\n<pre><code># All programs are built from same name source files:\n$(PROGS): %: %.c size_max.h\n    $(CC) $(CFLAGS) $&lt; $(LDFLAGS) -o $@\n</code></pre>\n\n<p>On my system, running</p>\n\n<pre><code>make clean all &amp;&amp; ./example\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>rm -f example  *.o size_max.h\n./headergen &gt; size_max.h\ngcc -Wall -O2 -c foo.c\ngcc -Wall -O2 -c bar.c\ngcc -Wall -O2 foo.o bar.o -o example\nSIZE_MAX = \"18446744073709551615U\".\n</code></pre>\n\n<p>and running</p>\n\n<pre><code>make CC=\"gcc-5\" CFLAGS=\"-Wall -std=c99 -pedantic -m32\" clean all &amp;&amp; ./example\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>rm -f example  *.o size_max.h\n./headergen &gt; size_max.h\ngcc-5 -Wall -std=c99 -pedantic -m32 -c foo.c\ngcc-5 -Wall -std=c99 -pedantic -m32 -c bar.c\ngcc-5 -Wall -std=c99 -pedantic -m32 foo.o bar.o -o example\nSIZE_MAX = \"4294967295U\".\n</code></pre>\n\n<p>Note that make does not detect if you change compiler options, if you edit the Makefile or use different <code>CFLAGS=</code> or <code>CC=</code> options when running make, so you do need then specify the <code>clean</code> target first, to ensure you start from a clean slate with the new settings in effect.</p>\n\n<p>During normal editing and builds, when you don't change compilers or compiler options, there is no need to <code>make clean</code> between builds. </p>\n"}], "owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2515, "favorite_count": 0, "accepted_answer_id": 44401992, "answer_count": 2, "score": 5, "last_activity_date": 1496837940, "creation_date": 1496797899, "question_id": 44401965, "link": "https://stackoverflow.com/questions/44401965/how-to-get-size-max-in-c89", "title": "How to get SIZE_MAX in C89", "body": "<p>I'm trying to get <code>SIZE_MAX</code> in C89.</p>\n\n<p>I thought of the following way to find <code>SIZE_MAX</code>:</p>\n\n<pre><code>const size_t SIZE_MAX = -1;\n</code></pre>\n\n<p>Since the standard (\u00a76.2.1.2 ANSI C) says:</p>\n\n<blockquote>\n  <p>When a signed integer is converted to an unsigned integer with equal or greater size, if the value of the signed integer is nonnegative, its value is unchanged. Otherwise: if the unsigned integer has greater size, the signed integer is first promoted to the signed integer corresponding to the unsigned integer; <strong>the value is converted to unsigned by adding to it one greater than the largest number that can be represented in the unsigned integer type</strong> 28</p>\n</blockquote>\n\n<p>With footnote 28:</p>\n\n<blockquote>\n  <p>In a two's-complement representation, there is no actual change in the bit pattern except filling the high-order bits with copies of the sign bit if the unsigned integer has greater size.</p>\n</blockquote>\n\n<p>This seems like this has defined behavior, but I'm not quite sure if I understand the wording of that paragraph correctly.</p>\n\n<p>Note that this question is explicitly about C89, so <a href=\"https://stackoverflow.com/a/2760612/1717115\">this</a> doesn't answer my question because the standard has different wording.</p>\n\n<p>If that doesn't work, the other way I came up with is:</p>\n\n<pre><code>size_t get_size_max() {\n    static size_t max = 0;\n    if (max == 0) {\n        max -= 1U;\n    }\n\n    return max;\n}\n</code></pre>\n\n<p>But I couldn't find anything about unsigned integer underflow in the standard, so I'm poking in the dark here.</p>\n"}, {"tags": ["c++", "c", "gcc", "linker", "g++"], "answers": [{"comments": [{"owner": {"reputation": 1808, "user_id": 7724939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89dd0b319756f1e0dc1d7bff5d223d88?s=128&d=identicon&r=PG&f=1", "display_name": "nglee", "link": "https://stackoverflow.com/users/7724939/nglee"}, "edited": false, "score": 0, "creation_date": 1496830331, "post_id": 44406589, "comment_id": 75818195, "body": "Thanks for the answer! But I think the quote in this answer doesn&#39;t explicitly mention the search order. It just says that <code>Using SEARCH_DIR(path) is exactly like using &#39;-L path&#39;</code>. Am I supposed to deduce from this line, with the knowledge that paths specified with <code>-L</code> are searched as they appear in order, that <code>SEARCH_DIR()</code> order also matters?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1808, "user_id": 7724939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89dd0b319756f1e0dc1d7bff5d223d88?s=128&d=identicon&r=PG&f=1", "display_name": "nglee", "link": "https://stackoverflow.com/users/7724939/nglee"}, "edited": false, "score": 0, "creation_date": 1496830397, "post_id": 44406589, "comment_id": 75818251, "body": "@devnglee how else would you understand <i>is exactly like</i>?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 1, "last_activity_date": 1496821945, "last_edit_date": 1496821945, "creation_date": 1496821628, "answer_id": 44406589, "question_id": 44401829, "link": "https://stackoverflow.com/questions/44401829/gcc-or-g-path-search-order-on-default-directories-when-linking-libraries/44406589#44406589", "title": "gcc or g++ path search order on default directories when linking libraries", "body": "<p>From the <a href=\"https://sourceware.org/binutils/docs/ld/index.html\" rel=\"nofollow noreferrer\">binutils ld manual</a> section <a href=\"https://sourceware.org/binutils/docs/ld/File-Commands.html\" rel=\"nofollow noreferrer\"><em>3.4.2 Commands Dealing with Files</em></a>:</p>\n\n<blockquote>\n  <p>SEARCH_DIR(path)</p>\n  \n  <p>The SEARCH_DIR command adds path to the list of paths where ld looks for archive libraries. Using SEARCH_DIR(path) is exactly like using `-L path' on the command line (see Command Line Options). If both are used, then the linker will search both paths. Paths specified using the command line option are searched first. </p>\n</blockquote>\n\n<p>So, yes, as the default directories are given in the <em>default linker script</em> using this <code>SEARCH_DIR()</code> command, they will be searched in the order the <code>SEARCH_DIR()</code> commands appear.</p>\n\n<p>E.g., in my <code>mingw</code> installation, the default linker script starts like this:</p>\n\n<pre><code>/* Default linker script, for normal executables */\n/* Copyright (C) 2014-2017 Free Software Foundation, Inc.\n   Copying and distribution of this script, with or without modification,\n   are permitted in any medium without royalty provided the copyright\n   notice and this notice are preserved.  */\nOUTPUT_FORMAT(pei-i386)\nSEARCH_DIR(\"=/mingw32/i686-w64-mingw32/lib\");\nSEARCH_DIR(\"=/mingw32/lib\");\nSEARCH_DIR(\"=/usr/local/lib\");\nSEARCH_DIR(\"=/lib\");\nSEARCH_DIR(\"=/usr/lib\");\n</code></pre>\n\n<p>--> A library in <code>/usr/local/lib</code> can override libraries in <code>/lib</code> and <code>/usr/lib</code>, but not libraries provided by <code>mingw</code> itself.</p>\n"}], "owner": {"reputation": 1808, "user_id": 7724939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89dd0b319756f1e0dc1d7bff5d223d88?s=128&d=identicon&r=PG&f=1", "display_name": "nglee", "link": "https://stackoverflow.com/users/7724939/nglee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 44406589, "answer_count": 1, "score": 1, "last_activity_date": 1496821945, "creation_date": 1496796683, "last_edit_date": 1496801278, "question_id": 44401829, "link": "https://stackoverflow.com/questions/44401829/gcc-or-g-path-search-order-on-default-directories-when-linking-libraries", "title": "gcc or g++ path search order on default directories when linking libraries", "body": "<p>I've seen <a href=\"https://stackoverflow.com/a/5817315/7724939\">this</a> article and learned that:</p>\n\n<ol>\n<li>Directories specified on the command line with <code>-L</code> option are searched before the default directories.</li>\n<li>The directories specified in <code>-L</code> are searched in the order in which they are specified on the command line.</li>\n</ol>\n\n<p>The question is: <strong>Is there an search order for the default directories?</strong></p>\n\n<p>For example, if I run this command:</p>\n\n<pre><code>$ gcc -Xlinker --verbose  2&gt;/dev/null | grep SEARCH | sed 's/SEARCH_DIR(\"=\\?\\([^\"]\\+\\)\"); */\\1\\n/g'  | grep -vE '^$'\n</code></pre>\n\n<p>(command copied from <a href=\"https://stackoverflow.com/a/29546339/7724939\">this article</a>)</p>\n\n<p>it prints out <code>/usr/local/lib</code> before <code>/usr/lib</code> in my machine (Ubuntu 16.04, 64-bit, gcc 5.4.0). In this case, will <code>/usr/local/lib</code> be searched before <code>/usr/lib</code>?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 13, "user_id": 8008661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839565c1727598d9e10002e42caf7a78?s=128&d=identicon&r=PG&f=1", "display_name": "joo shane", "link": "https://stackoverflow.com/users/8008661/joo-shane"}, "edited": false, "score": 0, "creation_date": 1496795452, "post_id": 44401662, "comment_id": 75803095, "body": "int main() {   int i=0;   char st[LEN];   char ch;   while(st[0]!=&#39;\\0&#39;)  {  i=0;  printf(&quot;Enter name of student:&quot;);  while(ch!=&#39;\\n&#39;)   {     ch=getchar();     st[i]=ch;     i++;   }    }   }"}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 1, "creation_date": 1496799107, "post_id": 44401662, "comment_id": 75803864, "body": "You need to iniialize &quot;ch&#39; and &quot;st&quot; before the &quot;while&quot; statements."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1496824274, "post_id": 44401711, "comment_id": 75813756, "body": "When you post an answer to a question, you are expected to explain your answer <i>within</i> the body of the question. Referring to other sites as supporting your answer is not acceptable. There is no guarantee the links will even work 3 months from now. Take the time to explain your answer. If there are concise statements that will support your answer, then limited reference to offsite information is allowed for, e,g. linking to a particular section of the C11 Standard, etc. General links to use of specific functions, while it may help the OP, does not directly answer the question."}, {"owner": {"reputation": 193, "user_id": 1144173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/74955b669a539604faed4b813b3b1152?s=128&d=identicon&r=PG", "display_name": "ZenJ", "link": "https://stackoverflow.com/users/1144173/zenj"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1496867254, "post_id": 44401711, "comment_id": 75842881, "body": "@DavidC.Rankin Aside from the question being extremely unclear and of practically zero value to the future users of SO, this is a question from the student doing his homework. The homework is meant to be done by him / her, not by SO community. Therefore, guidance provided in the answer IMO is appropriate. Besides that, more and more people nowadays think of SO as a free coding service, which happens only because many people pursuing SO reputation increase do provide this kind of service."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 193, "user_id": 1144173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/74955b669a539604faed4b813b3b1152?s=128&d=identicon&r=PG", "display_name": "ZenJ", "link": "https://stackoverflow.com/users/1144173/zenj"}, "edited": false, "score": 1, "creation_date": 1496867659, "post_id": 44401711, "comment_id": 75843103, "body": "@ZenJ while I don&#39;t disagree with your sentiment, I am a bit confused how it applies to my comment about not providing an answer that consists solely of offsite links that may or may not be working tomorrow. Perhaps my comment is unclear, but an answer that contains nothing but links to &quot;here is a link to a tutorial -- go learn...&quot; without any explanation of what part of the question it applies to are not appropriate as an answer. The poster has more than 20 reputation and can provide referrals in a comment or if the question is unclear ask for further clarification."}, {"owner": {"reputation": 334, "user_id": 3220633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/663743001/picture?type=large", "display_name": "user3220633", "link": "https://stackoverflow.com/users/3220633/user3220633"}, "edited": false, "score": 0, "creation_date": 1496999144, "post_id": 44401711, "comment_id": 75903630, "body": "Hello, I do agree that my answer was not really detailed, but so was the question. However, I did mention the different concept he needs to grasp to be able to formulate a relevant question. My feeling is that he doesn&#39;t have the vocabulary to do the google search. This being said, I did upvote your answer and apologize for being a bit cheeky!"}], "tags": [], "owner": {"reputation": 334, "user_id": 3220633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/663743001/picture?type=large", "display_name": "user3220633", "link": "https://stackoverflow.com/users/3220633/user3220633"}, "is_accepted": false, "score": 1, "last_activity_date": 1497001825, "last_edit_date": 1497001825, "creation_date": 1496795551, "answer_id": 44401711, "question_id": 44401662, "link": "https://stackoverflow.com/questions/44401662/how-to-receive-strings-from-user-to-receive-empty-string-and-print-them-in-c/44401711#44401711", "title": "how to receive strings from user to receive empty string and print them in c", "body": "<p>Alright, since I got called out, I will try to add a bit of meat around the bone. However, I will not simply hand you the code to do the task, it would spoil the fun.</p>\n\n<p>The first part is to figure out how to gather the names entered by the user and store it in a variable. C does not handle String as a data type instead they are represented by an array of char (char[]) that ends with a null bytes, the character \\00. There are many functions that allow you to take an input from a user : getchar, gets, fgets, scanf, etc. Here, you will need to do a bit of googling to figure out which one you should use for your particular case.</p>\n\n<p>Afterwards, you want to figure out how to store the strings you collected into some sort of list. You would represent that as an array of strings. As we said, strings are not a thing in C. So you need to declare an array of array of char (char[][]). It is possible to grow the size dynamically as you add new items to the list with memory manipulation functions like malloc and realloc. But to start, I suggest that you stick to a fixed size array until you understand how it works.</p>\n\n<p>The last step is to print the names you collected. Use a loop to iterate over your list of strings and print them one by one using the function printf.</p>\n\n<p>Finally here's a pseudo code that boldly describes the process :</p>\n\n<pre><code>students: List of string\ninput: String\ncount: Integer\n\n// Gather the names\nwhile 1:\n    print \"Enter the name of a student : \"\n    input = readUserInput()\n\n    if input is a null byte:\n        break the loop\n    else:\n        students[count] = input\n        increment count\n\n// Print the names\nfor i in [0, count]:\n    print students[i] + '\\n' // '\\n' represents a carriage return\n</code></pre>\n\n<hr>\n\n<p>Here are some random links that explain some of the concepts. Remember, google is your friend!</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9278226/which-is-the-best-way-to-get-input-from-user-in-c\">Which is the best way to get input from user in C?</a></p>\n\n<p><a href=\"https://www.tutorialspoint.com/cprogramming/c_arrays.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/c_arrays.htm</a></p>\n\n<p><a href=\"https://www.tutorialspoint.com/cprogramming/c_loops.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/c_loops.htm</a></p>\n\n<p><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_printf.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/c_standard_library/c_function_printf.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1496804318, "creation_date": 1496804318, "answer_id": 44402784, "question_id": 44401662, "link": "https://stackoverflow.com/questions/44401662/how-to-receive-strings-from-user-to-receive-empty-string-and-print-them-in-c/44402784#44402784", "title": "how to receive strings from user to receive empty string and print them in c", "body": "<p>sample code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define LEN 32\n\ntypedef struct student {\n    char *name;\n} Student;\n\nvoid atEnd(Student *s, int n, const char *message, int exit_code){\n    for(int i = 0; i &lt; n; ++i){\n        free(s[i].name);\n    }\n    free(s);\n    fputs(message, stderr);\n    exit(exit_code);\n}\n\nint main(void) {\n    Student *students = NULL;\n    int n = 0;//number of students\n\n    while(true){\n        char st[LEN];\n        int i, ch;\n\n        printf(\"Enter name of student:\");\n\n        for(i = 0; (ch = getchar())!= EOF &amp;&amp; ch != '\\n' &amp;&amp; i &lt; LEN-1; ++i){\n            st[i]=ch;\n        }\n        if(i == 0)\n            break;\n        else if(i == LEN-1 &amp;&amp; ch != '\\n'){\n            char *mes =\n                \"Your name is longer than the programmer assumes.\\n\"\n                \"Please tell the programmer to change the program.\\n\"\n            ;\n            atEnd(students, n, mes, EXIT_FAILURE);\n        }\n        st[i] = 0;\n        Student *temp = realloc(students, (n+1)*sizeof(*students));\n        if(!temp){\n            atEnd(students, n, \"realloc failed.\\n\", EXIT_FAILURE);\n        }\n        students = temp;\n        if(NULL == (students[n++].name = malloc(strlen(st)+1))){\n            atEnd(students, n, \"malloc failed.\\n\", EXIT_FAILURE);\n        }\n        strcpy(students[n-1].name, st);\n    }\n\n    for(int i = 0; i &lt; n; ++i){\n        puts(students[i].name);\n    }\n    atEnd(students, n, \"\", EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496832487, "post_id": 44406931, "comment_id": 75819735, "body": "side notes: 1) --&gt; <code>if (n == max) &#47;* ptr limit reached, realloc ptr *&#47;</code> 2) If <code>realloc</code> fails Memory release is not explicitly done."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496832857, "post_id": 44406931, "comment_id": 75820014, "body": "Note (1) that when reserved as <code>NULL</code>, all bits 0 and <code>NULL</code> are not necessarily the same."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496865814, "post_id": 44406931, "comment_id": 75842137, "body": "<code>if (n + 1 == max)</code> intentionally provides for a <i>sentinel NULL</i> as the last element for use in iterating. Your note on all bits 0 and NULL is well taken, though for gcc they are for practical purposes equivalent (<code>(void *)0</code>), there may be other compilers that treat them differently. If <code>realloc</code> fails, the program exits, and you are correct there is no explicit release before calling <code>exit</code> as the memory is released on <code>exit</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496866400, "post_id": 44406931, "comment_id": 75842441, "body": "I thought that is probably the intent, but I noted it. You better add comments to the code to clarify your intentions."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1496866480, "post_id": 44406931, "comment_id": 75842482, "body": "Yes, that was a good catch. It just provides the option of iterating over the pointers for the cost of an additional pointer. I&#39;ll drop a comment."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1496866687, "last_edit_date": 1496866687, "creation_date": 1496822674, "answer_id": 44406931, "question_id": 44401662, "link": "https://stackoverflow.com/questions/44401662/how-to-receive-strings-from-user-to-receive-empty-string-and-print-them-in-c/44406931#44406931", "title": "how to receive strings from user to receive empty string and print them in c", "body": "<p>You have a number of options available to you to take into consideration. First, since you are reading <em>lines-of-input</em> containing the names, using a <em>line-oriented</em> input function like <code>fgets</code> makes a lot of sense. Then you only have two considerations to check regarding end of input, (1) <code>fgets</code> returns <code>NULL</code> indicating <code>EOF</code> or (2), you check the first character of the buffer filled by <code>fgets</code> to see if it is the <code>'\\n'</code> character (indicating that <kbd>Enter</kbd> alone has been pressed.</p>\n\n<p>Next you need to consider what data structure you will use to hold the array of names until you have gathered all the input. You can use an array of <code>struct</code> as shown in the other answer, or you can simply use a *pointer-to-pointer-to-char` (a <em>double-pointer</em>) to allocate pointers, as needed, and assign the address for an allocated block of memory containing each name. </p>\n\n<p>The procedure is straight forward. First allocate some reasonably anticipated number of pointers to work with. Read names, allocate storage for each, copy the name to the allocated memory and then assign the memory address to each pointer. When you reach the limit of your currently allocated pointers, simply <code>realloc</code> additional pointers and keep going. </p>\n\n<p>Once all the names have been collected, you simply output the names (I have included the pointer index as well) and then <code>free</code> the memory of each name and then after all names are printed and freed, <code>free</code> the pointers and you are done. You can do something similar to the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nenum { MAXP = 32, MAXC = 256 };  /* constants */ \n\nvoid *xcalloc (size_t nmemb, size_t size); /* helper functions */\nvoid *xrealloc (void *ptr, size_t psz, size_t *nelem, size_t inc);\n\nint main (void) {\n\n    size_t max = MAXP, n = 0;       /* initial ptrs and counter */\n    char **a = xcalloc (max, sizeof *a);  /* mem for MAXP ptrs */ \n\n    for (;;) {                 /* loop until empty line or EOF */\n        size_t len = 0;\n        char buf[MAXC] = \"\";\n\n        /* read into buf from stdin, check if empty */\n        if (!fgets (buf, MAXC, stdin) || *buf == '\\n')\n            break;\n\n        len = strlen (buf);     /* get length of buf */\n        if (buf[len-1] == '\\n') /* test for '\\n' */\n            buf[--len] = 0;     /* remove '\\n' */\n\n        a[n] = xcalloc (len + 1, 1);    /* mem to hold buf  */\n        strcpy (a[n++], buf);           /* copy buf to a[n] */\n\n        if (n + 1 == max) /* ptr limit reached, realloc ptr\n                           * note: +1 insures a sentinel pointer\n                           * with bits zeroed as the last pointer */\n            a = xrealloc (a, sizeof *a, &amp;max, MAXP);\n    }\n\n    for (size_t i = 0; i &lt; n; i++) {    /* print and free mem */\n        printf (\"a[%3zd] : %s\\n\", i, a[i]);\n        free (a[i]);   /* free memory allocated for each name */\n    }\n    free (a);  /* free pointers */\n\n    return 0;\n}\n\n/* simple calloc with error-checking */\nvoid *xcalloc (size_t nmemb, size_t size)\n{\n    void *memptr = calloc (nmemb, size);\n    if (!memptr) {\n        fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n        exit (EXIT_FAILURE);\n    }\n\n    return memptr;\n}\n\n/* simple realloc with error-checking */\nvoid *xrealloc (void *ptr, size_t psz, size_t *nelem, size_t inc)\n{\n    void *memptr = realloc ((char *)ptr, (*nelem + inc) * psz);\n    if (!memptr) {\n        fprintf (stderr, \"realloc() error: virtual memory exhausted.\\n\");\n        exit (EXIT_FAILURE);\n    }   /* zero new memory (optional) */\n    memset ((char *)memptr + *nelem * psz, 0, inc * psz);\n    *nelem += inc; /* update number of elements allocated */\n\n    return memptr;\n}\n</code></pre>\n\n<p>Above a static buffer of <code>256</code> characters was used to read each name from <code>stdin</code>. If for any reason that may not be enough, you can always validate a complete line was read by adding a check for the length and checking for the trailing <code>'\\n'</code>.</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/readprn &lt;dat/namesfirst.txt\na[  0] : adam\na[  1] : allice\na[  2] : barny\na[  3] : beauregard\na[  4] : bell\na[  5] : benjamin\na[  6] : betty\na[  7] : bill\na[  8] : buck\na[  9] : buddy\na[ 10] : candice\na[ 11] : caset\na[ 12] : cathy\na[ 13] : charles\na[ 14] : chris\na[ 15] : chuck\na[ 16] : clark\na[ 17] : david\na[ 18] : don\na[ 19] : eli\na[ 20] : elizabeth\na[ 21] : emma\na[ 22] : eric\na[ 23] : ester\na[ 24] : frank\n</code></pre>\n\n<p>The code behaves the same if you manually type each name and then press <kbd>Enter</kbd> alone on the final line. (I just happened to have a names file)</p>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to write beyond/outside the bounds of your allocated block of memory, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/readprn &lt;dat/namesfirst.txt\n==28428== Memcheck, a memory error detector\n==28428== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==28428== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==28428== Command: ./bin/readprn\n==28428==\na[  0] : adam\n&lt;snip&gt;\na[ 24] : frank\n==28428==\n==28428== HEAP SUMMARY:\n==28428==     in use at exit: 0 bytes in 0 blocks\n==28428==   total heap usage: 26 allocs, 26 frees, 413 bytes allocated\n==28428==\n==28428== All heap blocks were freed -- no leaks are possible\n==28428==\n==28428== For counts of detected and suppressed errors, rerun with: -v\n==28428== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 13, "user_id": 8008661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839565c1727598d9e10002e42caf7a78?s=128&d=identicon&r=PG&f=1", "display_name": "joo shane", "link": "https://stackoverflow.com/users/8008661/joo-shane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1520624000, "creation_date": 1496795180, "last_edit_date": 1520624000, "question_id": 44401662, "link": "https://stackoverflow.com/questions/44401662/how-to-receive-strings-from-user-to-receive-empty-string-and-print-them-in-c", "title": "how to receive strings from user to receive empty string and print them in c", "body": "<p>how to receive strings from user to the empty string in c\nreceive the string and put into an array and then print it.</p>\n\n<pre><code>int main() {\n    int i=0;\n    char st[LEN];\n    char ch;\n\n    while(st[0]!='\\0') {\n        i=0;\n        printf(\"Enter name of student:\");\n\n        while(ch!='\\n') {\n            ch=getchar();\n            st[i]=ch;\n            i++;\n        }\n    }\n}\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/nvpYY.png\" alt=\"snapshot\"></p>\n"}]