[{"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1501718597, "post_id": 45472754, "comment_id": 77906493, "body": "Depends on what lib types (e.g. <i>libc</i>) you have on your system. Run <code>ldd a.out</code> and look for <i>statically linked</i>."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1501719191, "post_id": 45472754, "comment_id": 77906625, "body": "Have a look at a very verbose output of the compile/link process by doing            &quot;gcc -v helloworld.c -o helloworld&quot;  (without the quotes).."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1501719199, "post_id": 45472754, "comment_id": 77906630, "body": "<code>stdio.h</code> isn&#39;t linked to anything. The pre-processor includes it with your main source file, compiles the result into a relocatable object, and links that with standard C libraries, resulting in the <code>helloworld</code> executable."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1501733424, "post_id": 45472754, "comment_id": 77909694, "body": "@DOUGLASO.MOEN but it is a <code>.c</code> file and <code>gcc</code> is being used, not <code>g++</code>. Tags are wrong (or maybe the question is in general about both)."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1501739761, "post_id": 45472754, "comment_id": 77912161, "body": "See <code>ldd helloworld</code>."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1501739843, "post_id": 45472754, "comment_id": 77912190, "body": "BTW. <code>stdio.h</code> is not a library. It&#39;s header file, some kind of &quot;operating manual&quot; on how to use a library (a standard library in this case) for compiler."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501771660, "post_id": 45472754, "comment_id": 77936297, "body": "@AjayBrahmakshatriya - you are right, I overlooked the .c of the compile command.  Sorry.  I have removed my comment."}], "answers": [{"comments": [{"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1501772105, "post_id": 45472931, "comment_id": 77936672, "body": "Perhaps your next question (if not already answered) might be where / how to find the library (with stdio functions) that gets linked."}], "tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 0, "last_activity_date": 1501772243, "last_edit_date": 1501772243, "creation_date": 1501719792, "answer_id": 45472931, "question_id": 45472754, "link": "https://stackoverflow.com/questions/45472754/static-and-dynamic-linking-using-gcc/45472931#45472931", "title": "static and dynamic linking using gcc", "body": "<blockquote>\n  <p>which type of linking is this?? so the stdio.h is statically or\n  dynamically linked to my project???</p>\n</blockquote>\n\n<p>stdio.h is not linked, it is a header file, and contains code / text, no compiled objects.</p>\n\n<p>The normal link process prefers the '.so' library over the '.a' archive when both are found in the same directory.  Your simple command is linking with the .so (if that is in the correct path) or the .a (if that is found in a path with no .so equivalent).</p>\n\n<p>To achieve static linking, you have several choices, including</p>\n\n<pre><code>1) copy the '.a' archive to a directory you create, then specify that \ndirectory (-L)\n\n2) specify the path to the '.a' in the build command.   Boost example:\n\n$(CC) $(CC_FLAGS)  $&lt;  /usr/local/lib/libboost_chrono.a  -o $@  $(LIB_DIRs) $(LIB_NMs)\n</code></pre>\n\n<p>I have used both techniques, I find the first easier.  </p>\n\n<p>Note that archive code might refer to symbols in another archive.  You can command the linker to search a library multiple times.</p>\n\n<p>If you let the build link with the .so, this does not pull in a copy of the entire .so into the build.  Instead, the .so (the entire lib) is loaded into memory (if not already there) at run-time, after the program starts.  For most applications, this is considered a 'small' start-up performance hit as the program adjusts its memory map (auto-magically behind the scenes) Note that the app itself can control when to load the .so, called dynamic library.</p>\n\n<hr>\n\n<p>Unrelated:</p>\n\n<pre><code>// If your C++ 'Hello World' has no class ... why bother?\n#include &lt;iostream&gt;\n\nclass Hello_t {\npublic:\n   Hello_t()  { std::cout &lt;&lt; \"\\n  Hello\"  &lt;&lt; std::flush; }\n   ~Hello_t() { std::cout &lt;&lt;    \"World!\" &lt;&lt; std::endl; }\n   void operator() () { std::cout &lt;&lt; \" C++ \"; }\n};\nint main(int, char**) { Hello_t()(); }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 1, "last_activity_date": 1501722805, "creation_date": 1501722805, "answer_id": 45473253, "question_id": 45472754, "link": "https://stackoverflow.com/questions/45472754/static-and-dynamic-linking-using-gcc/45473253#45473253", "title": "static and dynamic linking using gcc", "body": "<p>Libraries are mostly used as shared resources so, that several different programs can reuse the same pre-compiled code in some manner. Some libraries come as standard libraries which are delivered with the operating system and/or the compiler package. Some libraries come with other third party projects.</p>\n\n<p>When you run just <code>gcc</code> in the manner of your example, you really run a compiler driver which provides you with few compilation-related functions, calling different parts of the compilation process and finally linking your application with a few standard libraries. The type of the libraries is chosen based on the qualifiers you provide. By default it will try to find dynamic (shared) libraries and if missing will attempt for static. Unless you tell it to use static libs only (-static).</p>\n\n<p>When you link to project libraries you tell the gcc/g++ which libraries to use in a manner (-lname). In such a way it will do the same as with the standard libraries, looking for '.so' first and '.a' second, unless -static is used. You can directly specify the path to the full library name as well, actually telling it which library to use. There are several other qualifiers which control the linking process, please look man for 'g++' and 'ld'.</p>\n\n<p>A library must contain real program code and data. The way it is linked to the main executable (and other libraries) is through symbol tables which are parts of the libraries. A symbol table contains entries for global functions an data.</p>\n\n<p>There is a slight difference in the structure of the shared and static libs. The former one is actually a pre-linked object, similar to an executable image with some extra info related to the symbols and relocation (such a library can be loaded at any address in the memory  and still should work correctly). The static library is actually an archive of '.o' files, ready for a full-blown linking. </p>\n\n<p>The usual steps to create a library is to compile multiple parts of your program into '.o' files which in turn could be linked in a shared library by 'ld' (or g++)  or archived in .a with 'ar'. Afterwards you can use them for linking in a manner described above.</p>\n\n<p>An object file (.o) is created one per a .cpp source file. The source file contains code and can include any number of header files, as 'stdio.h' in your case (or cstdio) or whatever. These files become a part of the source which is insured by the cpp preprocessor. The latter takes care of macros and flattening all the #include hierarchies so that the compiler sees only a single text stream which it converts into '.o'. In general header files should not contain executable code, but declarations and macros, though it is not always true. But it does not matter since they become welded with the main source file.</p>\n\n<p>Hope this would explain it. </p>\n"}], "owner": {"reputation": 11, "user_id": 8408433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b29725cd03dda064b95acd014113079?s=128&d=identicon&r=PG&f=1", "display_name": "m.abdultawab", "link": "https://stackoverflow.com/users/8408433/m-abdultawab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501772243, "creation_date": 1501718244, "question_id": 45472754, "link": "https://stackoverflow.com/questions/45472754/static-and-dynamic-linking-using-gcc", "title": "static and dynamic linking using gcc", "body": "<p>I've been recently reading about static and dynamic linking and I understood the differences and how to create static and dynamic library and link it to my project</p>\n\n<p>But, a question came to my mind that I couldn't answer or find answer for it as It's a specific question ... when I compile my code on linux using the line</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n  printf(\"hello, world!\\n\");\n}\n</code></pre>\n\n<p>compiling using this command</p>\n\n<pre><code>[root@host ~]# gcc helloworld.c -o helloworld\n</code></pre>\n\n<p>which type of linking is this??\nso the stdio.h is statically or dynamically linked to my project???</p>\n"}, {"tags": ["c", "macros", "inline", "preprocessor-directive", "dummy-variable"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1501716117, "post_id": 45472432, "comment_id": 77905897, "body": "Why don&#39;t you use regular <code>if</code> statements??"}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1501716180, "post_id": 45472432, "comment_id": 77905921, "body": "@DimChtz How do if statements improve readability?"}, {"owner": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "edited": false, "score": 0, "creation_date": 1501716220, "post_id": 45472432, "comment_id": 77905927, "body": "If you are intending on having a changing brightness on the LED, why is it a constant? Did I miss something?"}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1501716222, "post_id": 45472432, "comment_id": 77905929, "body": "@uzumaki That was a question not an answer."}, {"owner": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "edited": false, "score": 0, "creation_date": 1501716275, "post_id": 45472432, "comment_id": 77905940, "body": "Why don&#39;t you use hardware PWM? Or, if you want software PWM, you can use timer interrupt."}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1501716373, "post_id": 45472432, "comment_id": 77905967, "body": "@uzumaki I was talking about this <code>#if BRIGHTNESS &gt; 0</code> ...etc Why did he use <code>#if</code> instead of regular <code>if</code> statements in the first place."}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "edited": false, "score": 0, "creation_date": 1501716405, "post_id": 45472432, "comment_id": 77905973, "body": "@EastonBornemeier The BRIGHTNESS variable is supposed to set the overall brightness before compiling the code."}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1501716558, "post_id": 45472432, "comment_id": 77906005, "body": "@DimChtz The line of code &quot;dummy = 0;&quot; should only be compiled when the preprocessor variable BRIGHTNESS is set accordingly."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1501716774, "post_id": 45472432, "comment_id": 77906060, "body": "Beware of compiler optimizations.  Some compilers may remove dummy statements.  Have you considered decrementing or incrementing  a volatile (static volatile) variable for a delay?  You may want to use a <code>for</code> loop or call an <i>inline</i> function.  The inline function could change content based on your PWM rate (I think this would be a better fit)."}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1501716913, "post_id": 45472432, "comment_id": 77906089, "body": "@ThomasMatthews dummy is declared as volatile, I thought this would be enough. Anyway it does work, as I tested it. I can change the statement later on."}, {"owner": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "edited": false, "score": 0, "creation_date": 1501717137, "post_id": 45472432, "comment_id": 77906134, "body": "Arduino has very accurate clock, why do you want to use dummy instructions? Really, consider using timer interrupts. Something like this <a href=\"http://www.avrfreaks.net/forum/timer-interrupt-arduino-due\" rel=\"nofollow noreferrer\">avrfreaks.net/forum/timer-interrupt-arduino-due</a>  I don&#39;t have arduino to test, so google it"}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 503, "user_id": 7458932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/226f3917c60bd248fcd77f4448b19068?s=128&d=identicon&r=PG&f=1", "display_name": "devalone", "link": "https://stackoverflow.com/users/7458932/devalone"}, "edited": false, "score": 0, "creation_date": 1501717263, "post_id": 45472432, "comment_id": 77906162, "body": "@devalone I know what I&#39;m doing. I only need help to improve readability with preprocessor macros."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1501718074, "post_id": 45472432, "comment_id": 77906347, "body": "I think you may be over-complicating things here. A decent compiler should unroll a <code>for</code> loop with constant bounds. For example <code>for (int count = 0; count &lt; BRIGHTNESS; count++) {dummy = 0;}</code> should resolve to <code>dummy = 0; dummy = 0; dummy = 0; dummy = 0;</code> for <code>BRIGHTNESS</code> of 4,"}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1501718335, "post_id": 45472432, "comment_id": 77906431, "body": "@user4581301 It looks a bit cryptic but it would work, if the compiler does unroll it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1501719659, "post_id": 45472432, "comment_id": 77906742, "body": "In this I must say our definitions of cryptic differ greatly. If you want assurances that it will be unrolled, take a look at <a href=\"http://www.cs.rpi.edu/~musser/design/blitz/meta-art.html\" rel=\"nofollow noreferrer\">template metaprogramming for loops</a>. That smurf meets my definition of cryptic. A note on the link: the writer <a href=\"https://stackoverflow.com/questions/228783/what-are-the-rules-about-using-an-underscore-in-a-c-identifier\">illegally prefixes with underscores</a>. Copy the intent. Don&#39;t copy the style."}, {"owner": {"reputation": 10352, "user_id": 52273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e25c72c9528fd7a7610a15f4cad6382?s=128&d=identicon&r=PG", "display_name": "Arafangion", "link": "https://stackoverflow.com/users/52273/arafangion"}, "edited": false, "score": 0, "creation_date": 1501724723, "post_id": 45472432, "comment_id": 77907803, "body": "Out of curiosity, which compiler are you using that doesn&#39;t optimise away those obvious no-ops?"}, {"owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "reply_to_user": {"reputation": 10352, "user_id": 52273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e25c72c9528fd7a7610a15f4cad6382?s=128&d=identicon&r=PG", "display_name": "Arafangion", "link": "https://stackoverflow.com/users/52273/arafangion"}, "edited": false, "score": 0, "creation_date": 1501732582, "post_id": 45472432, "comment_id": 77909465, "body": "@Arafangion dummy is declared as volatile."}, {"owner": {"reputation": 10352, "user_id": 52273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e25c72c9528fd7a7610a15f4cad6382?s=128&d=identicon&r=PG", "display_name": "Arafangion", "link": "https://stackoverflow.com/users/52273/arafangion"}, "edited": false, "score": 0, "creation_date": 1501741147, "post_id": 45472432, "comment_id": 77912908, "body": "@uzumaki: But he doesn&#39;t read from it - I thought volatile only prevented optimisations for <i>read</i>?"}], "answers": [{"tags": [], "owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "is_accepted": true, "score": 0, "last_activity_date": 1501723071, "creation_date": 1501723071, "answer_id": 45473283, "question_id": 45472432, "link": "https://stackoverflow.com/questions/45472432/how-to-insert-a-statement-inbetween-lines-with-the-help-of-preprocessor-directiv/45473283#45473283", "title": "How to insert a statement inbetween lines with the help of preprocessor directives in C++?", "body": "<p>This is how the <code>dummy = 0;</code> statements can be added with the help of the preprocessor:</p>\n\n<pre><code>#define BRIGHTNESS 2\n#define _GETFOO(n) _FOO ## n\n#define ADD_DUMMIES(n) _GETFOO(n) ()\n\n#define _FOO0()\n#define _FOO1() dummy = 0;\n#define _FOO2() dummy = 0; dummy = 0;\n#define _FOO3() dummy = 0; dummy = 0; dummy = 0;\n#define _FOO4() dummy = 0; dummy = 0; dummy = 0; dummy = 0;\n\nuint8_t volatile dummy = 0;\n// inside loop\n        LED_STATE = ON;\n        ADD_DUMMIES(BRIGHTNESS)\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        ADD_DUMMIES(BRIGHTNESS)\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        ADD_DUMMIES(BRIGHTNESS)\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        ADD_DUMMIES(BRIGHTNESS)\n        LED_STATE = OFF;\n</code></pre>\n\n<p>The compiler inserts the same store instruction as many times inbetween the lines as the value of <code>BRIGHTNESS</code> dictates, as long as it is within the boundaries.</p>\n"}], "owner": {"reputation": 970, "user_id": 3622232, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2390a7d67be15222432449603c3bcfd6?s=128&d=identicon&r=PG&f=1", "display_name": "uzumaki", "link": "https://stackoverflow.com/users/3622232/uzumaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 45473283, "answer_count": 1, "score": -2, "last_activity_date": 1501724459, "creation_date": 1501715799, "last_edit_date": 1501724459, "question_id": 45472432, "link": "https://stackoverflow.com/questions/45472432/how-to-insert-a-statement-inbetween-lines-with-the-help-of-preprocessor-directiv", "title": "How to insert a statement inbetween lines with the help of preprocessor directives in C++?", "body": "<p>I'm trying to program an Arduino Due to PWM a LED matrix by turning the LEDs on and off very quickly. In order to control brightness I want to add extra instructions between the on and off states of the LEDs. The brightness should be set by a preprocessor variable. The Arduino has a 84MHz Cortex-M3 ARM processor.</p>\n\n<p>This is a simplification of how my code currently increases the brightness:</p>\n\n<pre><code>uint8_t volatile dummy = 0;\nuint8_t i;\n\nfor (i=0;i&lt;1&lt;&lt;current_layer;i++) { // every next layer has double the amount of pulses\n    LED_STATE = ON; // several pulses in one go speeds up the for loop\n    dummy = 0; // increases ON-time\n    LED_STATE = OFF;\n    LED_STATE = ON;\n    dummy = 0; \n    LED_STATE = OFF;\n    LED_STATE = ON;\n    dummy = 0; \n    LED_STATE = OFF;\n    LED_STATE = ON;\n    dummy = 0;\n    LED_STATE = OFF;\n}\n</code></pre>\n\n<p>Now I want to be able to increase the brightness based on a preprocessor variable like so:</p>\n\n<pre><code>#define BRIGHTNESS 2 \n// inside loop\n        LED_STATE = ON; // several pulses in one go speeds up the for loop\n        #if BRIGHTNESS &gt; 0\n        dummy = 0; // increases ON-time\n        #if BRIGHTNESS == 2\n        dummy = 0; // increases ON-time even more\n        #endif\n        #endif\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        #if BRIGHTNESS &gt; 0\n        dummy = 0;\n        #if BRIGHTNESS == 2\n        dummy = 0;\n        #endif\n        #endif\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        #if BRIGHTNESS &gt; 0\n        dummy = 0;\n        #if BRIGHTNESS == 2\n        dummy = 0;\n        #endif\n        #endif\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        #if BRIGHTNESS &gt; 0\n        dummy = 0;\n        #if BRIGHTNESS == 2\n        dummy = 0;\n        #endif\n        #endif\n        LED_STATE = OFF;\n</code></pre>\n\n<p>As you can see, this makes the code very unreadable. I would like to define a preprocessor macro that adds these dummy statements based on the value of <code>BRIGHTNESS</code>.</p>\n\n<p>This is how the code should look like:</p>\n\n<pre><code>#define BRIGHTNESS 2 \n#define B1 ... // adds dummy=0; when BRIGHTNESS &gt; 0 or else nothing at all\n#define B2 ...\n#define B3 ...\n#define B4 ...\n// inside loop\n        LED_STATE = ON;\n        B1 B2 B3 B4 // adds a number of dummy statements based on the value of BRIGHTNESS\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        B1 B2 B3 B4\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        B1 B2 B3 B4\n        LED_STATE = OFF;\n        LED_STATE = ON;\n        B1 B2 B3 B4\n        LED_STATE = OFF;\n</code></pre>\n\n<p>Even better would be a function that inserts those statements based on a variable:</p>\n\n<pre><code>#define ADD_DUMMIES ...\n// inside loop\n        LED_STATE = ON;\n        ADD_DUMMIES(BRIGHNESS)\n        LED_STATE = OFF;\n</code></pre>\n\n<p>How would I define preprocessor macros so that they insert dummy statements based on the value of <code>BRIGHTNESS</code>? </p>\n"}, {"tags": ["c", "algorithm", "binary-search-tree"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1501712603, "post_id": 45471941, "comment_id": 77904912, "body": "&quot;my method is use recursion&quot; --&gt; post the code that you have used, even if it is failing."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 1, "creation_date": 1501712720, "post_id": 45471941, "comment_id": 77904950, "body": "Welcome to StackOverflow.  Please read and follow the posting guidelines in the help documentation.  <a href=\"http://stackoverflow.com/help/on-topic\">on topic</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a> apply here."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1501712899, "post_id": 45471941, "comment_id": 77905011, "body": "When you say you &quot;cannot travel the whole tree&quot;, I presume you mean that you must minimize the number of nodes traversed.  If <i>all</i> the values in it are greater than the target number, then that still means traversing the whole tree."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1501713097, "post_id": 45471941, "comment_id": 77905086, "body": "The key, then, is at each node to decide which children, if any, to traverse.  You can make that decision pretty simply based only on the current node&#39;s value and the threshold number.  For at least some of the nodes you do traverse, you&#39;ll still need to test whether to add the node&#39;s value to your sum."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501728097, "post_id": 45472044, "comment_id": 77908539, "body": "This appears amiss.&quot;find the sum of values that are greater than a <code>num</code>&quot;.  First line should be <code>current &gt; num</code> ."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501728749, "post_id": 45472044, "comment_id": 77908690, "body": "if <code>current</code>  can appears more than once in the BST, then <code>current = num</code> needs to add both left and right."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501798460, "post_id": 45472044, "comment_id": 77952208, "body": "OOOOOOPS!  Correcting the inequalities."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501798521, "post_id": 45472044, "comment_id": 77952239, "body": "@chux: OP&#39;s discourse of the &quot;equals&quot; case suggests that duplication isn&#39;t an issue; that&#39;s why I left it as a trifurcate decision."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": true, "score": 0, "last_activity_date": 1501798473, "last_edit_date": 1501798473, "creation_date": 1501713093, "answer_id": 45472044, "question_id": 45471941, "link": "https://stackoverflow.com/questions/45471941/sum-of-nodes-greater-than-a-number-in-bst/45472044#45472044", "title": "sum of nodes greater than a number in BST", "body": "<p>You're making this a bit too complicated.  Your base case is hitting a leaf node (which you already know how to handle).  You have three recursion cases:</p>\n\n<pre><code>current &gt; num\n    result = current +\n             recur on right child +\n             recur on left  child\ncurrent = num\n    result = current +\n             recur on right child\ncurrent &lt; num\n    result = recur on right child\n\nreturn result\n</code></pre>\n\n<p>All you can do is to prune off the left subtrees that are too small as you find them.  don't waste effort looking ahead: the recursion will handle that just fine.</p>\n\n<p>Note that you <em>cannot</em> stop early dependent on the right child's value: that child may well have right-descendants with arbitrarily large values.</p>\n"}, {"tags": [], "owner": {"reputation": 985, "user_id": 6531241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XySrX.jpg?s=128&g=1", "display_name": "Karim Manaouil", "link": "https://stackoverflow.com/users/6531241/karim-manaouil"}, "is_accepted": false, "score": 0, "last_activity_date": 1501717197, "creation_date": 1501717197, "answer_id": 45472623, "question_id": 45471941, "link": "https://stackoverflow.com/questions/45471941/sum-of-nodes-greater-than-a-number-in-bst/45472623#45472623", "title": "sum of nodes greater than a number in BST", "body": "<p>So the user @Prune has already pointed out the idea which consists of getting ride of sub trees that are less than the desired value.</p>\n\n<pre><code>int sum_greater(struct bst * t, int num){\n\n    struct bstnode *ptr = t-&gt;root;\n    if(!ptr)\n        return 0;\n\n    struct bst right_tree = { t-&gt;root-&gt;right };\n    struct bst left_tree = { t-&gt;root-&gt;left };\n\n    if(ptr-&gt;item &gt; num) \n        return ptr-&gt;item + \\\n            sum_greater(&amp;left_tree, num) + \\\n                sum_greater(&amp;right_tree, num);\n    else // ptr-&gt;item =&lt; num\n        return sum_greater(&amp;right_tree, num);\n}\n</code></pre>\n\n<p>For a complete example, run the code from : <a href=\"https://pastebin.com/0UnfKvLT\" rel=\"nofollow noreferrer\">Full sum_greater code</a></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1501729359, "last_edit_date": 1501729359, "creation_date": 1501728663, "answer_id": 45474006, "question_id": 45471941, "link": "https://stackoverflow.com/questions/45471941/sum-of-nodes-greater-than-a-number-in-bst/45474006#45474006", "title": "sum of nodes greater than a number in BST", "body": "<blockquote>\n  <p>how to deal with the situation when current node is less than num.</p>\n</blockquote>\n\n<p>Only add the <em>right</em> BST in that case, when current node is less than <em>or equal</em> to <code>num</code>.  Else add both left, right and the <code>-&gt;item</code>.</p>\n\n<pre><code>int BST_sum_gt(const struct bstnode* node, int num) {\n  if (node == NULL) {\n    return 0;\n  }\n  if (node-&gt;item &gt; num) {\n    return BST_sum_gt(node-&gt;left) + node-&gt;item + BST_sum_gt(node-&gt;left);\n  }  \n  return BST_sum_gt(node-&gt;left);\n}\n\nint sum_greater(const struct bst * t, int num) {\n  return BST_sum_gt(t-&gt;root);\n}\n</code></pre>\n\n<p>Or a less recursive approach</p>\n\n<pre><code>int BST_sum_gt(const struct bstnode* node, int num) {\n  int sum = 0; \n  while (node) {\n    if (node-&gt;item &gt; num) {\n      sum += BST_sum_gt(node-&gt;left) + node-&gt;item;\n    }\n    node = node-&gt;right;\n  }  \n  return sum;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7726063, "user_type": "registered", "profile_image": "https://graph.facebook.com/191722444529149/picture?type=large", "display_name": "Fishnchips", "link": "https://stackoverflow.com/users/7726063/fishnchips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 0, "accepted_answer_id": 45472044, "answer_count": 3, "score": -2, "last_activity_date": 1501798473, "creation_date": 1501712450, "last_edit_date": 1501712648, "question_id": 45471941, "link": "https://stackoverflow.com/questions/45471941/sum-of-nodes-greater-than-a-number-in-bst", "title": "sum of nodes greater than a number in BST", "body": "<p>For a binary search tree structure in C that cannot be changed:</p>\n\n<pre><code>struct bstnode {\n  int item;\n  struct bstnode* left;\n  struct bstnode* right;\n};\n\nstruct bst {\n  struct bstnode* root;\n};\n</code></pre>\n\n<p>How can we find the sum of values that are greater than a number(num)?<br>\n(we cannot travel the whole tree or convert this bst to an array).<br>\nthe function declaration is:</p>\n\n<pre><code>int sum_greater(struct bst * t, int num)\n</code></pre>\n\n<p>Basically, my method is to use recursion:<br>\nwhen num equals item in the current node, we sum the right part of this tree.<br>\nwhen num greater than item in the current node and node->right is greater than num, we sum the right part of this tree.<br>\nBut I dont know how to deal with the situation when current node is less than num.  </p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1501712043, "post_id": 45471837, "comment_id": 77904706, "body": "You could specify only the .c files containing the implementations you want in your Makefile, and leave the .c files of the other implementations out of your program; or alternatively you could use different #ifdef guards around each implementation and pass a -DUSE_GET_VALUE_1 or whatever to the compiler so that only the implementation you want is actually compiled."}, {"owner": {"reputation": 1213, "user_id": 3263864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41c98358d847c68ff3b45bffc099d98f?s=128&d=identicon&r=PG&f=1", "display_name": "DeepDeadpool", "link": "https://stackoverflow.com/users/3263864/deepdeadpool"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1501712792, "post_id": 45471837, "comment_id": 77904976, "body": "@Jeremy I think I see what you mean with the multiple ifdef guards. That would work but isn&#39;t completely ideal. I have many more than just 2 platforms and 2 functions I&#39;m targeting IRL. These platforms also have some pretty irregular overlap with regards to interface requirements."}], "answers": [{"comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1501713789, "post_id": 45472015, "comment_id": 77905298, "body": "Maybe it&#39;s worth mentioning that <code>weak</code> is not part of the standard (concerning portability, for example). Anyway,  +1 for describing <code>weak</code>."}, {"owner": {"reputation": 1213, "user_id": 3263864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41c98358d847c68ff3b45bffc099d98f?s=128&d=identicon&r=PG&f=1", "display_name": "DeepDeadpool", "link": "https://stackoverflow.com/users/3263864/deepdeadpool"}, "edited": false, "score": 0, "creation_date": 1501714266, "post_id": 45472015, "comment_id": 77905444, "body": "Excellent suggestion. I&#39;ll try it now. Did you mean to have a space between your __ and the word weak within default.c?"}, {"owner": {"reputation": 1213, "user_id": 3263864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41c98358d847c68ff3b45bffc099d98f?s=128&d=identicon&r=PG&f=1", "display_name": "DeepDeadpool", "link": "https://stackoverflow.com/users/3263864/deepdeadpool"}, "edited": false, "score": 0, "creation_date": 1501715805, "post_id": 45472015, "comment_id": 77905828, "body": "The other thing about your suggestion is that I no longer need the #defines. +1 maintainability."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1501716531, "post_id": 45472015, "comment_id": 77905997, "body": "A propos this __ . When I was learning C in the school I had the teacher I did not like. I wrote my preprocessor to replace everything in my source A-level code with some number of underscores and if the length was longer than 31 I was adding numbers in the random places. All definitions were in the nested include files. and I gave him something like this but much longer longer - several thousands lines :) <a href=\"https://godbolt.org/g/v6jTXt\" rel=\"nofollow noreferrer\">godbolt.org/g/v6jTXt</a>. As a result I was expelled from the school (not only because of it of course :))."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1501715079, "last_edit_date": 1501715079, "creation_date": 1501712911, "answer_id": 45472015, "question_id": 45471837, "link": "https://stackoverflow.com/questions/45471837/how-can-i-choose-function-behavior-at-compile-time/45472015#45472015", "title": "How can I choose function behavior at compile time?", "body": "<p>make them <code>weak</code> in the default.c and \"normal\" in your platform files. So if the platform.c file implements this function as not weak, the weak one dfrom default.c will be replaced link time.</p>\n\n<p>It is not the part of the standard but most compilers support it (it can be pragma, attribute or something else - you need to check in the compiler documentation)</p>\n\n<p>gcc version:</p>\n\n<pre><code>#define __weak __attribute__((weak))\n\n/* interface.h *\n***************/\nint get_value_1();\nint get_value_2();\n\n/* default.c *\n*************/\n#include \"interface.h\"\n\n#ifndef GET_VALUE_1\n__weak  int get_value_1() { return -1; }\n#endif\n\n#ifndef GET_VALUE_2\n__weak int get_value_2() { return -1; }\n#endif\n\n/* platform1.c *\n***************/\n#include \"interface.h\"\n\n#ifndef GET_VALUE_1\n#define GET_VALUE_1\nint get_value_1() { return 1; }\n#endif\n\n/* platform2.c *\n***************/\n#include \"interface.h\"\n\n#ifndef GET_VALUE_2\n#define GET_VALUE_2\nint get_value_2() { return 2; }\n#endif\n</code></pre>\n"}], "owner": {"reputation": 1213, "user_id": 3263864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/41c98358d847c68ff3b45bffc099d98f?s=128&d=identicon&r=PG&f=1", "display_name": "DeepDeadpool", "link": "https://stackoverflow.com/users/3263864/deepdeadpool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 45472015, "answer_count": 1, "score": 0, "last_activity_date": 1501715079, "creation_date": 1501711786, "last_edit_date": 1501712322, "question_id": 45471837, "link": "https://stackoverflow.com/questions/45471837/how-can-i-choose-function-behavior-at-compile-time", "title": "How can I choose function behavior at compile time?", "body": "<p>I have 4 files in the following example ; a header, a default implementation file, and 2 platform-specific implementation files.I define two functions; <code>get_value_1</code> and <code>get_value_2</code>. The 'default' behavior is to return -1, but some of these functions have special implementations. I would like each function to return -1 only if another file didn't implement it.</p>\n\n<pre><code>/* interface.h *\n***************/\nint get_value_1();\nint get_value_2();\n\n/* default.c *\n*************/\n#include \"interface.h\"\n\n#ifndef GET_VALUE_1\nint get_value_1() { return -1; }\n#endif\n\n#ifndef GET_VALUE_2\nint get_value_2() { return -1; }\n#endif\n\n/* platform1.c *\n***************/\n#include \"interface.h\"\n\n#ifndef GET_VALUE_1\n#define GET_VALUE_1\nint get_value_1() { return 1; }\n#endif\n\n/* platform2.c *\n***************/\n#include \"interface.h\"\n\n#ifndef GET_VALUE_2\n#define GET_VALUE_2\nint get_value_2() { return 2; }\n#endif\n</code></pre>\n\n<p>But when I run the command <code>gcc default.c platform1.c -shared -fpic -o platform1.so</code>, it tells me that I've multiply defined the get_value_1 function, and that it was originally defined in platform1.c.</p>\n\n<p>So how can I have a set of functions where a subset of those functions can have their behavior chosen at compile time?</p>\n"}, {"tags": ["c", "windows", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 6, "creation_date": 1501708649, "post_id": 45471083, "comment_id": 77903320, "body": "You&#39;re making life more difficult by using the thread exit code.  You can do it the same way as you do for the data (<code>pDataArray</code>, sized the same as the number of threads -- so make a <code>pResultArray</code> that the thread writes into instead of reading from)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1501709715, "post_id": 45471083, "comment_id": 77903842, "body": "exit code is <code>DWORD</code> - 4 byte, when pointer can be 8 bytes (in 64bit code). so already pointer not fit to exit code. you pass some object to thread - so thread and must strore return result in this object"}, {"owner": {"reputation": 14722, "user_id": 670017, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/14e34b1f97f25732aad207e006497f90?s=128&d=identicon&r=PG", "display_name": "ahmd0", "link": "https://stackoverflow.com/users/670017/ahmd0"}, "edited": false, "score": 0, "creation_date": 1501717772, "post_id": 45471083, "comment_id": 77906269, "body": "If this is a GUI application the method to pass a string from a worker thread to the main thread is by allocating that string on the heap (operator <code>new</code> for C++ or <code>malloc</code> for C) and then by posting it in <code>WM_APP</code>-type message to the main thread (use <code>PostMessage</code> API.) Your main thread then in turn can process that message and free the string."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 14722, "user_id": 670017, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/14e34b1f97f25732aad207e006497f90?s=128&d=identicon&r=PG", "display_name": "ahmd0", "link": "https://stackoverflow.com/users/670017/ahmd0"}, "edited": false, "score": 0, "creation_date": 1501719338, "post_id": 45471083, "comment_id": 77906672, "body": "@ahmd0: This is <i>one</i> solution to the problem, and it doesn&#39;t require a GUI application. <code>new</code> and <code>malloc</code> are problematic, if the data crosses DLL boundaries. <code>HeapAlloc</code> is already better in this respect."}, {"owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "edited": false, "score": 0, "creation_date": 1501741804, "post_id": 45471083, "comment_id": 77913270, "body": "You are passing your threads pointers to a data structure (MYDATA). Why don&#39;t you just store the char*, as a char*, as a MYDATA member?"}, {"owner": {"reputation": 158, "user_id": 5668661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba225f0f15b696c13a25c3d86b42c3b8?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/5668661/helloworld"}, "edited": false, "score": 0, "creation_date": 1501758064, "post_id": 45471083, "comment_id": 77924934, "body": "Instead of trying to return char* from the thread function, pass pre-allocated char * to the thread. And copy the result to it instead of allocating and returning the data. If allocation is not possible, you can also pass a pointer to a pointer variable (char**), and do the allocation inside the thread. Just make sure to use the same allocator/deallocated method pairs."}], "answers": [{"tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 1, "last_activity_date": 1501763597, "creation_date": 1501763597, "answer_id": 45484325, "question_id": 45471083, "link": "https://stackoverflow.com/questions/45471083/how-to-return-a-char-from-a-windows-thread-function/45484325#45484325", "title": "How to return a char * from a Windows Thread function", "body": "<p>You are already passing a structure to the thread, the best solution is to add a field to it for the thread to fill in.</p>\n\n<pre><code>typedef struct {\n  const char *ip;\n  const char *openports;\n} MYDATA, *PMYDATA;\n\nDWORD CALLBACK connectPortW(LPVOID ThreadParam)\n{\n  PMYDATA data = (PMYDATA) ThreadParam;\n  data-&gt;openports = allocatestringandfillitwithlistofports(data-&gt;ip);\n  return 0;\n}\n\n...\n\nWaitForMultipleObjects(MAX_THREADS, hThreadArray, TRUE, INFINITE);\nfor(int j = 0; j &lt; MAX_THREADS; j++)\n{\n  CloseHandle(hThreadArray[j]);\n  if(pDataArray[j] != NULL)\n  {\n    parseandfreeports(pDataArray[j]);\n    HeapFree(GetProcessHeap(), 0, pDataArray[j]);\n    pDataArray[j] = NULL;    // Ensure address is not reused.\n  }\n}\n</code></pre>\n\n<p>If this is a list of IP ports then it is better to store the ports in a array of SHORTs rather than a string.</p>\n\n<p>As noted in the comments, you could allocate some memory and return it as the thread exit code in a 32-bit application but since a 64-it pointer does not fit in 4 bytes it would be impossible to port it to 64-bit.</p>\n"}], "owner": {"reputation": 113, "user_id": 6697346, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XChLl.png?s=128&g=1", "display_name": "Justin Braham", "link": "https://stackoverflow.com/users/6697346/justin-braham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 45484325, "answer_count": 1, "score": 0, "last_activity_date": 1501763597, "creation_date": 1501708375, "question_id": 45471083, "link": "https://stackoverflow.com/questions/45471083/how-to-return-a-char-from-a-windows-thread-function", "title": "How to return a char * from a Windows Thread function", "body": "<p>Hello this is somewhat of a multilayered question but basically I want my thread function to return a char *, and then I want to be able to access that result once the thread has terminated. </p>\n\n<p>Currently I am type casting the char * to a DWORD at the end of my thread function like: (openPorts is my char *)</p>\n\n<pre><code>DWORD openPortsD = (DWORD)openPorts;\n</code></pre>\n\n<p>and then immediately returning openPortsD. But this does not seem to be working.</p>\n\n<p>My thread creation logic looks like:</p>\n\n<pre><code>for (int j = 0; j &lt; MAX_THREADS; j++)\n{\n  pDataArray[j] = (PMYDATA) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sizeof(MYDATA));\n\n  if(pDataArray[j] == NULL)\n  {\n      ExitProcess(2);\n  }\n  pDataArray[j]-&gt;ip = ip;\n\n  hThreadArray[j] = CreateThread(NULL, 0, connectPortW,  pDataArray[j], 0, &amp;dwThreadIdArray[j]);\n\n  if (hThreadArray[j] == NULL) \n  {\n     ExitProcess(3);\n  }\n}\n</code></pre>\n\n<p>After I loop through my threads I then wait for my threads and then free/close them like:</p>\n\n<pre><code>WaitForMultipleObjects(MAX_THREADS, hThreadArray, TRUE, INFINITE);\n\nfor(int j = 0; j &lt; MAX_THREADS; j++)\n{\n  CloseHandle(hThreadArray[j]);\n  if(pDataArray[j] != NULL)\n  {\n    HeapFree(GetProcessHeap(), 0, pDataArray[j]);\n    pDataArray[j] = NULL;    // Ensure address is not reused.\n  }\n}\n</code></pre>\n\n<p>Now the second part would be how do I get the returned value. I understand I am supposed to use GetExitCodeThread() but I am unsure how to use it for multiple threads running. Moreover, since the return value will be a DWORD how do I get back my original string?</p>\n"}, {"tags": ["c", "cs50", "caesar-cipher"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1501705636, "post_id": 45470360, "comment_id": 77901751, "body": "There is no opposite to modulo. Modulo maps multiple inputs to the same output, there&#39;s no way to know which input it originally was."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501705681, "post_id": 45470360, "comment_id": 77901781, "body": "E.g. <code>30 % 26</code> and <code>56 % 26</code> both result in <code>4</code>, there&#39;s no way to recover the original."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1501705901, "post_id": 45470360, "comment_id": 77901919, "body": "&quot; I am currently trying to build a program the decrypts it &quot; --&gt; post that code."}, {"owner": {"reputation": 1251, "user_id": 4324721, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/w57jr.jpg?s=128&g=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/4324721/turtle"}, "edited": false, "score": 0, "creation_date": 1501706344, "post_id": 45470360, "comment_id": 77902157, "body": "It seems your question has been answered, but if you need a helpful reference/ double check when you&#39;re all done, a copy of my working caesar cypher can be found <a href=\"https://github.com/christopherdiehl/BlogPosts/blob/master/caesarCypher.c\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 282, "user_id": 8192755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NjqyP.jpg?s=128&g=1", "display_name": "m0h4mm4d", "link": "https://stackoverflow.com/users/8192755/m0h4mm4d"}, "edited": false, "score": 0, "creation_date": 1501706373, "post_id": 45470360, "comment_id": 77902171, "body": "Modulo is a one-way function. There is no reverse function for it."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1501709100, "post_id": 45470360, "comment_id": 77903579, "body": "Reverse modulo? That sounds a bit like taking a burger and trying to retrieve the cow."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7350886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZMq591AWjvA/AAAAAAAAAAI/AAAAAAAAQao/uODcGm5KBCE/photo.jpg?sz=128", "display_name": "Jack Davies", "link": "https://stackoverflow.com/users/7350886/jack-davies"}, "edited": false, "score": 0, "creation_date": 1501706255, "post_id": 45470458, "comment_id": 77902108, "body": "can you define exactly what you are using for C and P? (I am using e = (e + k)%26) and am just moving down the line with E as so I don&#39;t trip over variables"}, {"owner": {"reputation": 7, "user_id": 7350886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZMq591AWjvA/AAAAAAAAAAI/AAAAAAAAQao/uODcGm5KBCE/photo.jpg?sz=128", "display_name": "Jack Davies", "link": "https://stackoverflow.com/users/7350886/jack-davies"}, "edited": false, "score": 0, "creation_date": 1501707016, "post_id": 45470458, "comment_id": 77902511, "body": "Absolutely also double checked the math my self and found it to be 100% solid. I must have a messed up implementation in some place. I really appreciate the help."}, {"owner": {"reputation": 7, "user_id": 7350886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZMq591AWjvA/AAAAAAAAAAI/AAAAAAAAQao/uODcGm5KBCE/photo.jpg?sz=128", "display_name": "Jack Davies", "link": "https://stackoverflow.com/users/7350886/jack-davies"}, "edited": false, "score": 0, "creation_date": 1501707531, "post_id": 45470458, "comment_id": 77902782, "body": "I had been testing it and while using small numbers it works wonderfully however when I put in a key such as 467467 it butchers the output and sends back a totally different string"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 7, "user_id": 7350886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZMq591AWjvA/AAAAAAAAAAI/AAAAAAAAQao/uODcGm5KBCE/photo.jpg?sz=128", "display_name": "Jack Davies", "link": "https://stackoverflow.com/users/7350886/jack-davies"}, "edited": false, "score": 0, "creation_date": 1501707642, "post_id": 45470458, "comment_id": 77902843, "body": "@JackDavies please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input, the expected output, and the actual output as text <i>in the question</i>."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1501708032, "post_id": 45470458, "comment_id": 77903040, "body": "Note that the actual input to <code>encrypt</code> and <code>decrypt</code> is a number in the range of <code>[0, 26)</code>. The number represents a (plain or cipher) letter of the alphabet."}], "tags": [], "owner": {"reputation": 5263, "user_id": 4107809, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f83ddf73fbc4629a75d5b23f6b6be43?s=128&d=identicon&r=PG&f=1", "display_name": "mattm", "link": "https://stackoverflow.com/users/4107809/mattm"}, "is_accepted": false, "score": 7, "last_activity_date": 1501706504, "last_edit_date": 1501706504, "creation_date": 1501705893, "answer_id": 45470458, "question_id": 45470360, "link": "https://stackoverflow.com/questions/45470360/looking-for-a-direct-opposite-of-modulo-or-in-c-programming/45470458#45470458", "title": "Looking for a direct opposite of modulo or % in C programming", "body": "<p>If you want to invert a Caesar cipher, you are not looking for the inverse of the modulo operator. </p>\n\n<p>If your encryption is </p>\n\n<pre><code>int encrypt(int plaintext, int shift){\n    int ciphertext = (plaintext + shift) % 26;\n    return ciphertext;\n}\n</code></pre>\n\n<p>Then decryption is </p>\n\n<pre><code>int decrypt(int ciphertext, int shift){\n    int plaintext = (ciphertext - shift + 26) % 26;\n    return plaintext;\n}\n</code></pre>\n\n<p>for whatever your choice of <code>shift</code> was for encryption. </p>\n"}], "owner": {"reputation": 7, "user_id": 7350886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZMq591AWjvA/AAAAAAAAAAI/AAAAAAAAQao/uODcGm5KBCE/photo.jpg?sz=128", "display_name": "Jack Davies", "link": "https://stackoverflow.com/users/7350886/jack-davies"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "closed_date": 1501716261, "answer_count": 1, "score": -5, "last_activity_date": 1501707829, "creation_date": 1501705531, "last_edit_date": 1501706677, "question_id": 45470360, "link": "https://stackoverflow.com/questions/45470360/looking-for-a-direct-opposite-of-modulo-or-in-c-programming", "closed_reason": "Not suitable for this site", "title": "Looking for a direct opposite of modulo or % in C programming", "body": "<p>Built a C program that encrypts things using a Caesar Cipher. It converts it to an alphabetic number (0 = a / 1 = b / 2 = c) and then converts it pack after moving by the number of characters specified by using a modulo operator. I am currently trying to build a program the decrypts it and I need the exact opposite of a modulo operator to invert the sequence.</p>\n"}, {"tags": ["c", "fgets"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501703910, "post_id": 45469868, "comment_id": 77900815, "body": "Read repeatedly until nothing is left."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1501703946, "post_id": 45469868, "comment_id": 77900848, "body": "The size passed to <code>fgets</code> will include any newline <i>and</i> the terminating <code>&#39;\\0&#39;</code>. If you want to understand, at least put some newlines and <code>[brackets]</code> in the output, to show what is happening, such as <code>printf(&quot;Output:[%s]\\n&quot;,str);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1501704128, "post_id": 45469868, "comment_id": 77900962, "body": "&quot;Since fgets() appends a newline to the end before the null character,&quot; is incorrect.  <code>fgets()</code> reads and saves a new line like any character.  It does append a <i>null character</i>. and does stop after reading a <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501704348, "post_id": 45469868, "comment_id": 77901074, "body": "@chux Yes. I shouldn&#39;t have said append but instead retained given one."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1501704554, "post_id": 45469868, "comment_id": 77901177, "body": "Re the first two questions: it is not just a newline that remains in the input buffer but <code>E\\n</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1501704206, "post_id": 45469966, "comment_id": 77901001, "body": "The input from file may not always contain a newline, if it was the last line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1501704238, "post_id": 45469966, "comment_id": 77901019, "body": "@WeatherVane True, in that case end-of-file will eventually occur and <code>while (getchar() != &#39;\\n&#39;);</code> will be an infinite loop"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1501705229, "post_id": 45469966, "comment_id": 77901538, "body": "And the loop code should, therefore, be: <code>int c; while ((c = getchar()) != EOF &amp;&amp; c != &#39;\\n&#39;) ;</code> to handle EOF sensibly."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501705354, "post_id": 45469966, "comment_id": 77901600, "body": "@JonathanLeffler Good call.  Edited."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1501705311, "last_edit_date": 1501705311, "creation_date": 1501704175, "answer_id": 45469966, "question_id": 45469868, "link": "https://stackoverflow.com/questions/45469868/clear-input-stream-after-fgets-set-null-char-before-newline/45469966#45469966", "title": "Clear input stream after fgets set null char before newline", "body": "<p>If the string read by <code>fgets</code> doesn't end in a newline, you know it's still in the buffer.  In that case, call <code>getchar</code> in a loop until you get a newline.</p>\n\n<pre><code>fgets(str,5,stdin);\nprintf(\"Output:%s\",str);\nif (strchr(str, '\\n') == NULL) {\n    int c; \n    while ((c = getchar()) != EOF &amp;&amp; c != '\\n');\n}\n\nfgets(str,5,stdin);\nprintf(\"Output:%s\",str);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1501706689, "last_edit_date": 1501706689, "creation_date": 1501704559, "answer_id": 45470060, "question_id": 45469868, "link": "https://stackoverflow.com/questions/45469868/clear-input-stream-after-fgets-set-null-char-before-newline/45470060#45470060", "title": "Clear input stream after fgets set null char before newline", "body": "<blockquote>\n  <p>the user can go past the fixed size of the array. Since <code>fgets()</code> appends a newline to the end before the null character</p>\n</blockquote>\n\n<p>No, it does not.  It writes characters read from the input into the provided buffer, up to <em>and including</em> the first newline, or until the specified buffer size is exhausted (less one byte for the string terminator), or until an error occurs or the end of the stream is reached, whichever comes first.  The newline is not invented by <code>fgets()</code>; it comes from the input.</p>\n\n<blockquote>\n  <p>, in the event that a newline cannot fit when the user goes beyond the intended size, the null character truncates the input. Does the newline character when the user hits enter still exist in the input stream?</p>\n</blockquote>\n\n<p>All characters entered by the user and not copied into the buffer remain waiting to be read in the stream.  That will include the newline, if the user entered one.</p>\n\n<blockquote>\n  <p>If so, is this the reason why fgets()skips the second time because of the newline from the first input?</p>\n</blockquote>\n\n<p><code>fgets()</code> does not skip, but it does pick up where the previous call left off transferring characters from input to the buffer.  No characters are lost.  That means that the second call returns part of the first input line if the first call did not return the whole thing.  You need to account one way or another for the possibility that the input does not conform to your line-length expectations.</p>\n\n<blockquote>\n  <p>the issue seems to be not flushing the input stream via <code>fflush(stdin)</code>,</p>\n</blockquote>\n\n<p>No, it isn't.  Flushing is for sending buffered <em>output</em> to the underlying output device.  Flushing an input stream produces undefined behavior.  In principle, that could manifest as a buffer dump, and a given implementation might even specify such behavior, <strong><em>but you don't want that</em></strong> because there may be more data buffered than you want to get rid of.</p>\n\n<blockquote>\n  <p>but I've heard conflicting information saying as this leads to undefined behavior. My last question is, what would be the appropriate way to clear the input stream if it's the retained newline that's causing issues?</p>\n</blockquote>\n\n<p>You read from the input until you've read the newline.  There are plenty of I/O functions to choose from to accomplish this.  <code>fgets()</code> itself might prove convenient, since you're already using it:</p>\n\n<pre><code>char str[5];\n\nif (fgets(str, 5, stdin)) {\n    printf(\"Output:%s\", str);\n    // read and consume the tail of the line, if any (overwrites str)\n    while (!strchr(str, '\\n') &amp;&amp; fgets(str, 5, stdin)) { /* empty */ }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1501724935, "post_id": 45470329, "comment_id": 77907862, "body": "When you say <i>exploited</i>, do you mean that in a malicious way or a logical flaw when the length of the buffer is zero that <code>buf[0-1]</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1501725276, "post_id": 45470329, "comment_id": 77907940, "body": "@Miket25 In a malicious way.  <code>fgets()</code> reads and saves a <i>null character</i> just like any other.  so it is fairly easy to cause the first character in <code>buf[]</code> to be <code>&#39;\\0&#39;</code>.  Then <code>buf[strlen(buf) - 1]</code> causes UB.  Recall it is not <code>buf[0-1]</code>, but <code>buf[(size_t)0-1]</code> or <code>buf[SIZE_MAX]</code>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1501705467, "creation_date": 1501705467, "answer_id": 45470329, "question_id": 45469868, "link": "https://stackoverflow.com/questions/45469868/clear-input-stream-after-fgets-set-null-char-before-newline/45470329#45470329", "title": "Clear input stream after fgets set null char before newline", "body": "<p><code>fgets()</code> reads until </p>\n\n<p>1) New-line<br>\n2) Buffer is full<br>\n3) End-of-file<br>\n4) Input error (rare)</p>\n\n<p>This code reads and takes care of #3 &amp; #4</p>\n\n<pre><code> #define N 5\n char buf[N];\n if (fgets(buf, sizeof buf, stdin) == NULL) {\n   // Handle EOF or Error\n   return EOF;\n }\n</code></pre>\n\n<p>To distinguish if a <code>'\\n'</code> is present ...  (#2 from #1)</p>\n\n<pre><code> // look for a lack of \\n\n if (strchr(buf, '\\n') == NULL) {\n</code></pre>\n\n<p>And if so, read until it is found or <code>EOF</code>.</p>\n\n<pre><code>   int ch;\n   while ((ch = fgetc(stdin)) != '\\n' &amp;&amp; ch != EOF);\n }\n</code></pre>\n\n<p>--</p>\n\n<p>Do not use the following code.  It can be exploited by reading a <em>null character</em> as the first character.</p>\n\n<pre><code> size_t len = strlen(buf);\n if (buf[len - 1] != '\\n') {  // bad way to detect \\n\n</code></pre>\n\n<p>Could use</p>\n\n<pre><code> if (len &gt; 0 &amp;&amp; buf[len - 1] != '\\n') {  // Good\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501705707, "post_id": 45470331, "comment_id": 77901791, "body": "UV for the &quot;Q:Being that I can&#39;t control what the user enters... A:No, you cannot&quot;. unless code has a <code>StompOnUserOnLongLine(5);</code>"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 4, "last_activity_date": 1501705467, "creation_date": 1501705467, "answer_id": 45470331, "question_id": 45469868, "link": "https://stackoverflow.com/questions/45469868/clear-input-stream-after-fgets-set-null-char-before-newline/45470331#45470331", "title": "Clear input stream after fgets set null char before newline", "body": "<blockquote>\n  <p>Being that I can't control what the user enters...</p>\n</blockquote>\n\n<p>No, you cannot.</p>\n\n<blockquote>\n  <p>the user can go past the fixed size of the array.</p>\n</blockquote>\n\n<p>Right.  This is always a concern.  However, In general you'll want to arrange things so that this rarely happens.</p>\n\n<p>For example, if you really want to limit the user to (say) a 4-character-long input string, let him type whatever he wants, then see how much he typed, and if it was more than your limit, print a nice error message or something.  But I do not recommend calling <code>fgets(str, 5, stdin)</code> if you're expecting 4 characters of input plus a newline, because it's just way too hard to recover when (not if) the user types too much.</p>\n\n<blockquote>\n  <p>in the event that a newline cannot fit when the user goes beyond the intended size, the null character truncates the input. Does the newline character when the user hits enter still exist in the input stream?</p>\n</blockquote>\n\n<p>Absolutely yes.</p>\n\n<blockquote>\n  <p>If so, is this the reason why fgets()skips the second time because of the newline from the first input?</p>\n</blockquote>\n\n<p>Pretty much yes.</p>\n\n<p>I recommend allocating a much bigger buffer, and then proceeding something like this:</p>\n\n<pre><code>char inpbuf[512);\nif(fgets(inpbuf, sizeof(inpbuf), stdin) == NULL) {\n    fprintf(stderr, \"end of file\\n\");\n    return;\n}\nchar *p = strrchr(inpbuf, '\\n');\nif(p == NULL) {\n    fprintf(stderr, \"looks like you typed *way* too much\\n\");\n    return;\n}\n*p = '\\0';        /* erase the \\n */\nif(strlen(inpbuf) &gt; 4) {\n    fprintf(stderr, \"you typed too much (max 4)\\n\");\n    return;\n}\nstrcpy(str, inpbuf);\nprintf(\"Output:%s\", str);\n</code></pre>\n\n<p>One glitch with this code as written, though: if the user hits the end-of-file key (control-D on Unix/Linux) before hitting Return, you'll falsely get the \"looks like you typed <em>way</em> too much\" message.</p>\n"}], "owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1601, "favorite_count": 0, "accepted_answer_id": 45470060, "answer_count": 4, "score": 2, "last_activity_date": 1501706689, "creation_date": 1501703782, "last_edit_date": 1501704480, "question_id": 45469868, "link": "https://stackoverflow.com/questions/45469868/clear-input-stream-after-fgets-set-null-char-before-newline", "title": "Clear input stream after fgets set null char before newline", "body": "<p>I have a program where the user enters two inputs. Being that I can't control what the user enters, the user can go past the fixed size of the array. Since <code>fgets()</code> <strike>appends</strike> retains a newline to the end before the null character, in the event that a newline cannot fit when the user goes beyond the intended size, the null character truncates the input. Does the newline character when the user hits enter still exist in the input stream? If so, is this the reason why <code>fgets()</code>skips the second time because of the newline from the first input?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(){\n    char str[5];\n    fgets(str,5,stdin);\n    printf(\"Output:%s\",str);\n\n    fgets(str,5,stdin);\n    printf(\"Output:%s\",str);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Input</strong>\n   <code>ABCDE\\n</code></p>\n\n<p><strong>Output</strong></p>\n\n<pre><code>Output:ABCDOutput:E\n</code></pre>\n\n<p>After reading this SO answer <a href=\"https://stackoverflow.com/questions/17227981/fgets-isnt-prompting-user-a-second-time\">fgets() isn't prompting user a second time\n</a>, the issue seems to be not flushing the input stream via <code>fflush(stdin)</code>, but I've heard conflicting information saying as this leads to undefined behavior. My last question is, what would be the appropriate way to clear the input stream if it's the retained newline that's causing issues?</p>\n"}, {"tags": ["c", "linux", "bash", "makefile", "buildroot"], "comments": [{"owner": {"reputation": 24739, "user_id": 1790644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f1a2a40ddbc52508d5b53e9879961251?s=128&d=identicon&r=PG", "display_name": "Matt Clark", "link": "https://stackoverflow.com/users/1790644/matt-clark"}, "edited": false, "score": 1, "creation_date": 1501703280, "post_id": 45469650, "comment_id": 77900435, "body": "This error is going to be due to the fact that the windows Kernel was not built with support for SYSV IPC."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1501710743, "post_id": 45469650, "comment_id": 77904237, "body": "if you try &#39;./configure&#39; before run make"}, {"owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "edited": false, "score": 0, "creation_date": 1501744481, "post_id": 45469650, "comment_id": 77914950, "body": "Are you trying to build your image on the Raspberry Pi? If yes you should maybe consider building it on a desktop PC, using a cross-compiler."}], "answers": [{"tags": [], "owner": {"reputation": 3901, "user_id": 3183264, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/bhrfQ.jpg?s=128&g=1", "display_name": "slaadvak", "link": "https://stackoverflow.com/users/3183264/slaadvak"}, "is_accepted": false, "score": 2, "last_activity_date": 1505051440, "creation_date": 1505051440, "answer_id": 46141434, "question_id": 45469650, "link": "https://stackoverflow.com/questions/45469650/error-while-building-rootfs-system-for-raspberry-pi-3-using-buildroot-lack-of/46141434#46141434", "title": "Error while building rootfs system for Raspberry Pi 3 using Buildroot - lack of SysV IPC support", "body": "<p>An issue has been opened in Windows Subsystem for Linux:\n<a href=\"https://github.com/Microsoft/BashOnWindows/issues/2465\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/BashOnWindows/issues/2465</a></p>\n\n<p>SYSV IPS message queues has not yet been implemented in the current kernel:</p>\n\n<blockquote>\n  <p>The lack of Sysvipc message queues breaks fakeroot</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 467, "user_id": 2590890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a339e74da52c819943b3073ad5e86c?s=128&d=identicon&r=PG&f=1", "display_name": "applesoup", "link": "https://stackoverflow.com/users/2590890/applesoup"}, "reply_to_user": {"reputation": 33, "user_id": 8091736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7155f17dcb49df6121bbaa8ef91d6d93?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky12", "link": "https://stackoverflow.com/users/8091736/ricky12"}, "edited": false, "score": 0, "creation_date": 1543842613, "post_id": 46480886, "comment_id": 94051476, "body": "@Ricky12, consider accepting this answer since it solved your problem. (By the way, it solved mine as well.)"}], "tags": [], "owner": {"reputation": 1127, "user_id": 1082492, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9d9dbf72ffca81be4a50712c29414c5d?s=128&d=identicon&r=PG", "display_name": "shmuelie", "link": "https://stackoverflow.com/users/1082492/shmuelie"}, "is_accepted": true, "score": 5, "last_activity_date": 1506651915, "creation_date": 1506651915, "answer_id": 46480886, "question_id": 45469650, "link": "https://stackoverflow.com/questions/45469650/error-while-building-rootfs-system-for-raspberry-pi-3-using-buildroot-lack-of/46480886#46480886", "title": "Error while building rootfs system for Raspberry Pi 3 using Buildroot - lack of SysV IPC support", "body": "<p>Running in to the same issue myself and fighting with it a while I added the following command to run before building the file system</p>\n\n<pre><code>cp -f /usr/bin/fakeroot-tcp /path-to-buildroot/output/host/usr/bin/fakeroot\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6611280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63fe2b9f810278a95c882ffbd10f9e51?s=128&d=identicon&r=PG", "display_name": "sssai", "link": "https://stackoverflow.com/users/6611280/sssai"}, "is_accepted": false, "score": 1, "last_activity_date": 1511013391, "creation_date": 1511013391, "answer_id": 47366879, "question_id": 45469650, "link": "https://stackoverflow.com/questions/45469650/error-while-building-rootfs-system-for-raspberry-pi-3-using-buildroot-lack-of/47366879#47366879", "title": "Error while building rootfs system for Raspberry Pi 3 using Buildroot - lack of SysV IPC support", "body": "<p>On buildroot 2017.08.1, I modified <code>fs/common.mk:109</code> as bellow, and succeeded to make rootfs! </p>\n\n<pre class=\"lang-sh prettyprint-override\"><code># before\nPATH=$$(BR_PATH) $$(HOST_DIR)/bin/fakeroot -- $$(FAKEROOT_SCRIPT)\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code># after\nif [ `uname -r | grep \"Microsoft\"` ] ; then \\\n    cp -f `which fakeroot-tcp` $$(HOST_DIR)/bin/fakeroot ; fi\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8091736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7155f17dcb49df6121bbaa8ef91d6d93?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky12", "link": "https://stackoverflow.com/users/8091736/ricky12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2232, "favorite_count": 2, "accepted_answer_id": 46480886, "answer_count": 3, "score": 3, "last_activity_date": 1511013391, "creation_date": 1501702987, "question_id": 45469650, "link": "https://stackoverflow.com/questions/45469650/error-while-building-rootfs-system-for-raspberry-pi-3-using-buildroot-lack-of", "title": "Error while building rootfs system for Raspberry Pi 3 using Buildroot - lack of SysV IPC support", "body": "<p>I am trying to build Buildroot image for Raspberry Pi 3, as found on page:\n<a href=\"https://github.com/buildroot/buildroot/tree/f8ff7ab0be1cd3aa846829dc234d8c67b1bda0dc/board/raspberrypi\" rel=\"nofollow noreferrer\">https://github.com/buildroot/buildroot/tree/f8ff7ab0be1cd3aa846829dc234d8c67b1bda0dc/board/raspberrypi</a> .</p>\n\n<p>I am using Windows Subsystem for Linux, which I have upgraded to version of Ubuntu 16.04.02 .<br>\nVersion of Buildroot is 2017.05.2.</p>\n\n<p>However, when running make I observe following output in bash:</p>\n\n<pre><code>/home/rijad/buildroot-2017.05.2/output/host/usr/bin/fakeroot --\n/home/rijad/buildroot-2017.05.2/output/build/_fakeroot.fs\nfakeroot, while creating message channels: Function not implemented\nThis may be due to a lack of SYSV IPC support.\nfakeroot: error while starting the `faked' daemon.\nkill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]\nfs/ext2/ext2.mk:42: recipe for target '/home/rijad/buildroot-2017.05.2/output/images/rootfs.ext2' failed\nmake[1]: *** [/home/rijad/buildroot-2017.05.2/output/images/rootfs.ext2] Error 1\nMakefile:79: recipe for target '_all' failed\nmake: *** [_all] Error 2\n</code></pre>\n\n<p>Is there any way to enable SysV IPC support on WSL, or run fakeroot with TCP IPC support?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "pointers", "types", "casting", "embedded"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1501702006, "post_id": 45469370, "comment_id": 77899665, "body": "It&#39;s not redundant. The type of <code>0x40048004U</code> is an integer, not a pointer. Remember that it is types that define what operations you can or cannot do on values."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1501702028, "post_id": 45469370, "comment_id": 77899678, "body": "Because <code>0x40048004U</code> is a literal, or constant, <code>unsigned int</code>. C does not allow for literal pointers. Note that this kind of cast is a static operation, so there is no runtime performance hit."}, {"owner": {"reputation": 101, "user_id": 5258087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf9e9389edfe101baf74f8e4729409fa?s=128&d=identicon&r=PG&f=1", "display_name": "nbstrong", "link": "https://stackoverflow.com/users/5258087/nbstrong"}, "edited": false, "score": 0, "creation_date": 1501702739, "post_id": 45469370, "comment_id": 77900110, "body": "These are great answers, guys, thanks. I actually did not expect such a fast response and am working atm so will have to go over these later. Thanks so much for your time and insight."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502091584, "post_id": 45469370, "comment_id": 78043054, "body": "Unrelated to the question, the code is incorrect. When reading a hardware register, you must always do <code>*(volatile uint32_t *)0x40048004U;</code>. Otherwise the compiler might do very weird optimizations and the program might not function as intended."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1501702603, "post_id": 45469459, "comment_id": 77900028, "body": "Furthermore, the context does not convey the needed type information.  For example, just because the dereferenced result is assigned to a variable of type <code>uint32_t</code> does not mean that the pointed-to object must be of that type, as opposed to, say, an <code>int64_t</code> or a <code>uint16_t</code>."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 2, "last_activity_date": 1501702220, "creation_date": 1501702220, "answer_id": 45469459, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers/45469459#45469459", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>The type of a pointer determines what the runtime expects to find at the given address <em>and subsequent addresses</em>. If the type of <code>p</code> is <code>char *</code>, for example, <code>*p</code> is the single byte at that address. If its type is <code>int *</code>, then it expects to find (probably) 4 bytes at that address representing an integer. If the type of <code>p</code> is pointer to some 100-byte strucure, then it expect to find 100 bytes of a structure there.</p>\n\n<p>Also, the type determines pointer math. <code>p + 1</code> is the address of the next <em>thing</em> at p, and might be 1, 4, or 100 bytes later.</p>\n"}, {"tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": true, "score": 7, "last_activity_date": 1501702277, "creation_date": 1501702277, "answer_id": 45469468, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers/45469468#45469468", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>I understand you're asking why we can't just do this:</p>\n\n<pre><code>uint32_t register_value = *0x40048004U;\n</code></pre>\n\n<p>(i.e. \"why can't we dereference constant integers?\").</p>\n\n<p>There's a few answers:</p>\n\n<ul>\n<li>C's syntax for integer constants does not have any annotation for pointer values, only signed/unsigned/short/long values (using <code>U</code>, <code>L</code>, etc suffices).</li>\n<li>If you <em>could</em> do <code>*0x40048004U</code> there is no indication of the data-type of the pointer - how many bytes is the computer meant to read from the address? Is it signed? Unsigned? (remember, the type of the constant is concerned with the type of memory address, not the value it points to)</li>\n<li>So by requiring the use of an explicit cast operator <code>*(valueType*)0xDEADBEFF</code> means that the type can be specified using the same syntax as a cast of a non-constant value - without needing to introduce a new separate syntax, and as this kind of cast is a static operation there's zero runtime performance hit.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1501702913, "post_id": 45469471, "comment_id": 77900212, "body": "IIRC, <code>0x00-&gt;foo</code> <i>was</i> allowed in some pre-standard code as members had to be unique across structures.  Hence the reason for ancient structures like <code>struct tm</code> have members like <code>tm_min, tm_hour</code> rather than <code>min, hour</code>."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1501705733, "post_id": 45469471, "comment_id": 77901812, "body": "Some duckducking finds this blog post, with interesting comments from several people who had access to K and/or R: <a href=\"https://spin0r.wordpress.com/2014/11/21/kr-c/\" rel=\"nofollow noreferrer\">spin0r.wordpress.com/2014/11/21/kr-c</a> (including Rob Pike)"}], "tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 5, "last_activity_date": 1501702289, "creation_date": 1501702289, "answer_id": 45469471, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers/45469471#45469471", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>C was designed in a time when memory was small, and thousands of PhD's had not been issued for compiler type inferencing.</p>\n\n<p>While it's possible that in this particular case the compiler might infer that </p>\n\n<pre><code>uint32_t regval = *0x40048004U;\n</code></pre>\n\n<p>was supposed to be a dereference of an implied uint32_t pointer, as opposed to a missing parameter in a multiply operation, the reality is that there are cases where it might fail (for example, <code>int x = 0x00-&gt;foo</code> when there are multiple structures having members named <code>foo</code>).</p>\n\n<p>So instead, the requirement was laid down that everything has a type, and if you want to use something as though it were a different type, you have to make that explicit. And it's been that way for 45 years. Fnord.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501702501, "creation_date": 1501702501, "answer_id": 45469524, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers/45469524#45469524", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>You need to show that the integer constant will be used as the pointer. You need to show the compiler what type of object this pointer points to. And next you get the value of the object pointed by this pointer (in this case it will be 32 bit word).</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501709605, "post_id": 45469553, "comment_id": 77903804, "body": "uv&#39;d, hope you don&#39;t mind my correction of your little typo ;) As a little nitpick: &quot;<i>but C doesn&#39;t work that way.</i>&quot; &lt;- you might want to add &quot;for example because there are some implicit conversions allowed&quot; like, deducing the type of a pointer from an assignment is impossible because an uint32_t could very well be assigned from a uint8_t through implicit conversions."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501718520, "post_id": 45469553, "comment_id": 77906468, "body": "@FelixPalmen Thanks for the fix."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501718766, "post_id": 45469553, "comment_id": 77906524, "body": "And there are <i>so</i> many reasons that C doesn&#39;t work that way, that I decided not to delve into them at all, which is why I just said &quot;C doesn&#39;t work that way&quot;"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 3, "last_activity_date": 1501709455, "last_edit_date": 1501709455, "creation_date": 1501702593, "answer_id": 45469553, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers/45469553#45469553", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>The pointer-indirection operator <code>*</code> can be applied only to pointers.  Its action, of course, is to access the data object pointed to by the pointer.  <em>But it has to know the size and type of the pointed-to object</em>.</p>\n\n<p>If you just said</p>\n\n<pre><code>uint32_t regval = *0x40048004;\n</code></pre>\n\n<p>the compiler would have no way to know the size and type.  (You might think it's implicit in the fact that you're assigning to a <code>uint32_2</code> on the left hand side, but C doesn't work that way.)</p>\n\n<p>If you want something that \"remembers\" the type, just create and initialize a pointer variable:</p>\n\n<pre><code>uint32_t *regptr = (uint32_t *)0x40048004;\nuint32_t regval = *regptr;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 0, "last_activity_date": 1501710557, "creation_date": 1501710557, "answer_id": 45471572, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers/45471572#45471572", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>Type casting a pointer <em>is not</em> necessary; <code>0x40048004U</code> is not a pointer.  The cast reinterprets the literal constant <em>integer</em> as a pointer.</p>\n\n<p>Moreover, even when 0x40048004U is interpreted as an address, the compiler needs to know what data type it points to when it is dereferenced.</p>\n"}], "owner": {"reputation": 101, "user_id": 5258087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf9e9389edfe101baf74f8e4729409fa?s=128&d=identicon&r=PG&f=1", "display_name": "nbstrong", "link": "https://stackoverflow.com/users/5258087/nbstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 45469468, "answer_count": 6, "score": 3, "last_activity_date": 1587002341, "creation_date": 1501701908, "last_edit_date": 1587002341, "question_id": 45469370, "link": "https://stackoverflow.com/questions/45469370/why-cant-we-dereference-constant-integers", "title": "Why can&#39;t we dereference constant integers?", "body": "<p>In an effort to understand pointers when working with embedded systems, I am trying to understand what is happening in this code that is accessing a memory mapped register:</p>\n\n<pre><code>uint32_t regval = *(uint32_t *)0x40048004U;\n</code></pre>\n\n<p>In my mind, without the type casting it means that regval is now equal to the memory contents of the address. I imagine that should be enough but it isn't. But when type casting it, you are treating it like a pointer for a single operation, which seems a bit redundant.</p>\n\n<p>So you are treating regval like the memory contents of an unknown address that points to the memory contents of 0x40048004U? Why is the type casting even necessary?</p>\n"}, {"tags": ["c", "node.js", "electron"], "comments": [{"owner": {"reputation": 92373, "user_id": 2050455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1255d2cb06adc4d0b48adf1d90e847?s=128&d=identicon&r=PG", "display_name": "mscdex", "link": "https://stackoverflow.com/users/2050455/mscdex"}, "edited": false, "score": 0, "creation_date": 1501701682, "post_id": 45469200, "comment_id": 77899491, "body": "Did you try calling <code>fflush(stdout);</code> or disabling stdout buffering in your C program?"}, {"owner": {"reputation": 33, "user_id": 6122143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ac9444fcaa5ff976514afcb797c825?s=128&d=identicon&r=PG&f=1", "display_name": "Boi Johnny", "link": "https://stackoverflow.com/users/6122143/boi-johnny"}, "reply_to_user": {"reputation": 92373, "user_id": 2050455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1255d2cb06adc4d0b48adf1d90e847?s=128&d=identicon&r=PG", "display_name": "mscdex", "link": "https://stackoverflow.com/users/2050455/mscdex"}, "edited": false, "score": 0, "creation_date": 1501701884, "post_id": 45469200, "comment_id": 77899596, "body": "@mscdex That did the trick. Do you know the logic behind this?"}], "answers": [{"tags": [], "owner": {"reputation": 92373, "user_id": 2050455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1255d2cb06adc4d0b48adf1d90e847?s=128&d=identicon&r=PG", "display_name": "mscdex", "link": "https://stackoverflow.com/users/2050455/mscdex"}, "is_accepted": true, "score": 2, "last_activity_date": 1501702113, "creation_date": 1501702113, "answer_id": 45469435, "question_id": 45469200, "link": "https://stackoverflow.com/questions/45469200/child-process-not-capturing-binary-file-output/45469435#45469435", "title": "Child_process not capturing binary file output?", "body": "<p><code>printf()</code>/<code>fprintf()</code> buffers its output by default. You can either manually call <code>fflush(stdout);</code> after your calls to <code>fprintf()</code> to force the buffered output to stdout <em>or</em> you can disable buffering entirely with <code>setvbuf(stdout, NULL, _IONBF, 0);</code> (this must be done once and <em>before</em> any output to stdout).</p>\n"}], "owner": {"reputation": 33, "user_id": 6122143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ac9444fcaa5ff976514afcb797c825?s=128&d=identicon&r=PG&f=1", "display_name": "Boi Johnny", "link": "https://stackoverflow.com/users/6122143/boi-johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 45469435, "answer_count": 1, "score": 3, "last_activity_date": 1501702311, "creation_date": 1501701231, "last_edit_date": 1501702311, "question_id": 45469200, "link": "https://stackoverflow.com/questions/45469200/child-process-not-capturing-binary-file-output", "title": "Child_process not capturing binary file output?", "body": "<p>I am using the npm library 'child_process' in an electron project to capture the stream of standard output from a C program with spawn. However, when I attempt to log the output from 'printf' or 'fprintf' captured by child.stdout.on('data'), nothing shows up. This is my test code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char buffer[256];\n    int i = 0;\n    while(1){\n        snprintf(buffer, sizeof(buffer), \"echo %d\\n\", i);\n        printf(\"%s\\n\", buffer);\n        fprintf(stdout, \"%s\\n\", buffer);\n        system(buffer);\n        system(\"sleep 1\");\n        i++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I know that my javascript is correct because the line echo'ed by the system call is captured, and I have tested it with similar loops in a ruby script and a bash script and they have worked just fine.</p>\n\n<p>When I run the binary file in a terminal shell everything outputs just fine, but when I try to capture all three outputs (first line should be \"echo 0 \\n echo 0 \\n 0\") with child.stdout.on('data', (data) => {...}); the only thing I get back is, like I said, the \"0\" from the system call. I am at a loss for the solution.</p>\n\n<p>It might be notable that when I run this program in terminal, I can't use ^C to terminate it, as it is just picked up by stdin and carried up the screen with the output.</p>\n\n<p>Here is my javascript if necessary:</p>\n\n<pre><code>const { spawn }= require('child_process');\nlet test;\n\n// Invoked by a button that when clicked calls ipcRenderer.send('test');\nipcMain.on('test', (event, ...args) =&gt; {\n  test = spawn('./a.out', []);\n  test.stdout.on('data', (data) =&gt; {\n    console.log(data);\n  });\n});\n</code></pre>\n"}, {"tags": ["c", "linux", "root", "setuid"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1501701022, "creation_date": 1501701022, "answer_id": 45469136, "question_id": 45469100, "link": "https://stackoverflow.com/questions/45469100/execute-commands-as-root-without-root-password-or-sudo/45469136#45469136", "title": "Execute commands as root without root password or sudo", "body": "<p>You didn't set the setuid bit in the file permissions:</p>\n\n<pre><code>#-------v\nchmod u=srwx,go=xr restartor\n</code></pre>\n"}], "owner": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 1, "accepted_answer_id": 45469136, "answer_count": 1, "score": 5, "last_activity_date": 1501775326, "creation_date": 1501700888, "last_edit_date": 1501775326, "question_id": 45469100, "link": "https://stackoverflow.com/questions/45469100/execute-commands-as-root-without-root-password-or-sudo", "title": "Execute commands as root without root password or sudo", "body": "<p>I understand the implications of running a script as root, especially by a web application. However as part of my web application, I need to use curl with tor and this needs resetting the tor ip occasionally. tor can get a new ip when the service is restarted with <code>service tor restart</code>. Since only root can do that, I've written a C wrapper script to do what I need, and compiled it and set setuid root on it, and changed to root user ownership. However, it still asks me root password when it's run as an unprivileged user. As root, a service restart shouldn't ask password.</p>\n\n<p>My script:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid ExecAsRoot (char* str);\nint main ()\n{\n  setuid (0);\n  setvbuf(stdout, NULL, _IONBF, 0);\n  printf (\"Host real ip is: \");\n  ExecAsRoot(\"ip addr | grep 'state UP' -A2 | tail -n1 | awk '{print $2}' | cut -f1  -d'/'\");\n  ExecAsRoot(\"/usr/sbin/service tor restart\");\n  // sleep(2);\n  printf (\"Tor should have switched to a new ip by now.\\nNew ip is: \");\n  ExecAsRoot(\"torify curl ifconfig.co 2&gt;/dev/null\");\n  return 0;\n }\n\nvoid ExecAsRoot (char* str) {\n  system (str);\n}\n</code></pre>\n\n<p>I've done the following:</p>\n\n<pre><code>chown root restartor\nchmod u=rwx,go=xr restartor \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Host real ip is: 7.17.11.23\n==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===\nAuthentication is required to restart 'tor.service'.\nAuthenticating as: root\nPassword:\n</code></pre>\n\n<p>How can I get this to run as web user without supplying root password?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501700102, "post_id": 45468866, "comment_id": 77898631, "body": "Do you know how multidimensional arrays are laid out in the memory?"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1501700155, "post_id": 45468866, "comment_id": 77898669, "body": "You are not going to copy columns.  You are going to copy rows."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1501701001, "post_id": 45468866, "comment_id": 77899159, "body": "Make <code>sz</code> a <code>size_t</code> rather instead of a <code>double</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501701002, "post_id": 45468866, "comment_id": 77899161, "body": "The sizeof the last 3 columns is the same as the size of 3x any one element of <code>mat_copy</code>.  <code>size_t sz = 3 * sizeof mat_copy[0][0];</code> or in this case, the size of 1 row of <code>size_t sz = sizeof mat_copy[0];</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1457, "user_id": 2638548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mkJxQ.jpg?s=128&g=1", "display_name": "dlasalle", "link": "https://stackoverflow.com/users/2638548/dlasalle"}, "is_accepted": false, "score": 2, "last_activity_date": 1501700488, "creation_date": 1501700488, "answer_id": 45469012, "question_id": 45468866, "link": "https://stackoverflow.com/questions/45468866/copying-part-of-2d-array-into-another-2d-array-in-c/45469012#45469012", "title": "Copying part of 2D array into another 2D array in C", "body": "<p>You're starting from <code>1</code> in your destination instead of <code>0</code>, so you're copying past the end of the row.</p>\n\n<p>Change</p>\n\n<pre><code>memcpy(&amp;mat_copy[i][1], &amp;matrix[i][1], sz);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>memcpy(&amp;mat_copy[i][0], &amp;matrix[i][1], sz);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1501701230, "creation_date": 1501701230, "answer_id": 45469199, "question_id": 45468866, "link": "https://stackoverflow.com/questions/45468866/copying-part-of-2d-array-into-another-2d-array-in-c/45469199#45469199", "title": "Copying part of 2D array into another 2D array in C", "body": "<p>To copy the last 3 columns, you must pass the offset of columns 0 as destination.  You can further simplify the code this way:</p>\n\n<pre><code>double matrix[2][4] = {{0, 1, 2, 3}, {4, 5, 6, 7}};\ndouble mat_copy[2][3];\n\nfor (int i = 0; i &lt; 2; i++) {\n    memcpy(mat_copy[i], &amp;matrix[i][1], sizeof(mat_copy[i]));\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2480019, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a603b6921ac607bdda4dcc9cfc8d4280?s=128&d=identicon&r=PG", "display_name": "user2480019", "link": "https://stackoverflow.com/users/2480019/user2480019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1502066370, "creation_date": 1501700028, "last_edit_date": 1502066370, "question_id": 45468866, "link": "https://stackoverflow.com/questions/45468866/copying-part-of-2d-array-into-another-2d-array-in-c", "title": "Copying part of 2D array into another 2D array in C", "body": "<p>I want to write C code that takes a block of a 2D array and copies it into another 2D array by using the <code>memcpy</code> function. In the particular code I have included, I have tried to copy the last 3 columns of the 2x4 array <code>matrix</code> into the 2x3 array <code>mat_copy</code>. </p>\n\n<pre><code>double matrix[2][4] = {{0, 1, 2, 3}, {4, 5, 6, 7}};\ndouble mat_copy[2][3];\ndouble sz = sizeof(mat_copy)/2;\n\nfor (int i = 0; i &lt; 2; i++) {\n    memcpy(&amp;mat_copy[i][1], &amp;matrix[i][1], sz);\n}\n</code></pre>\n\n<p>I'm getting the output: <code>[0, 1, 2; 3, 5, 6]</code> instead of <code>[1, 2, 3; 5, 6, 7]</code>. How does the <code>memcpy</code> function choose which addresses to copy once you give the initial pointer in memory? I know my error has to do with addressing the 2D arrays, but I don't know how to change it. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1501699619, "post_id": 45468725, "comment_id": 77898353, "body": "Define &quot;not work&quot;"}, {"owner": {"reputation": 33, "user_id": 8107552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrM4FvDz85s/AAAAAAAAAAI/AAAAAAAAADQ/Jd-N_lOtpTk/photo.jpg?sz=128", "display_name": "Aayush Sharma", "link": "https://stackoverflow.com/users/8107552/aayush-sharma"}, "edited": false, "score": 0, "creation_date": 1501699654, "post_id": 45468725, "comment_id": 77898370, "body": "When user enters  &quot;Exit&quot;, the loop does not break."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 3, "creation_date": 1501699818, "post_id": 45468725, "comment_id": 77898475, "body": "You are not comparing strings, but pointers to <code>char</code>. As already suggested, use <code>strcmp()</code>."}, {"owner": {"reputation": 9119, "user_id": 1678053, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Tt3Jc.jpg?s=128&g=1", "display_name": "galdin", "link": "https://stackoverflow.com/users/1678053/galdin"}, "edited": false, "score": 0, "creation_date": 1501710304, "post_id": 45468725, "comment_id": 77904062, "body": "Welcome to StackOverflow! Check <a href=\"https://stackoverflow.com/help/mcve\">this out</a>."}], "answers": [{"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 5, "last_activity_date": 1501699903, "creation_date": 1501699903, "answer_id": 45468823, "question_id": 45468725, "link": "https://stackoverflow.com/questions/45468725/error-in-string-do-while/45468823#45468823", "title": "Error in string do while", "body": "<p><code>str</code> will <em>never</em> equal <code>\"exit\"</code>, because you're comparing the addresses of two different sections of memory. You probably want to compare the <em>contents</em> of the strings, for which there is a function <code>strcmp()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "is_accepted": false, "score": 0, "last_activity_date": 1501699927, "creation_date": 1501699927, "answer_id": 45468829, "question_id": 45468725, "link": "https://stackoverflow.com/questions/45468725/error-in-string-do-while/45468829#45468829", "title": "Error in string do while", "body": "<p>As suggested above, use <code>strcmp</code> from the <code>&lt;string.h&gt;</code> header file.</p>\n\n<pre><code>char str[6];\n\ndo {\n    printf(\"Enter the string you wanna check:\");\n    scanf(\"%s\", str);\n} while(!strcmp(str, \"exit\"));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "is_accepted": false, "score": 4, "last_activity_date": 1501700368, "last_edit_date": 1501700368, "creation_date": 1501699991, "answer_id": 45468854, "question_id": 45468725, "link": "https://stackoverflow.com/questions/45468725/error-in-string-do-while/45468854#45468854", "title": "Error in string do while", "body": "<p><code>\"exit\"</code> is a <code>char[5]</code> generated by the compiler at some address in the data segment.  This address is definitely different from the address of <code>str</code>, as two different objects cannot occupy the same location in memory.  </p>\n\n<p>The <code>!=</code> operator between expressions of type <code>char[]</code> compares two pointers.  These two pointers are the address of <code>\"exit\"</code> and the address of <code>str</code>, which, as I have already explained, will <em>never</em> be equal.</p>\n\n<p>So, the expression <code>str != \"exit\"</code> will <em>never</em> evaluate to <code>true</code>.  Which brings us to another point: your compiler should have issued a warning about this condition being always false.  Which means that you are trying to program without <code>-Wall</code>.  Don't do this, you are never going to get very far.  Always use the highest warning level, and when you see warnings, <strong><em>always fix them</em></strong>.</p>\n\n<p>To correct the problem, do as <a href=\"https://stackoverflow.com/users/3121023/user3121023\">user3121023</a> suggested <a href=\"https://stackoverflow.com/questions/45468725/error-in-string-do-while#comment77898358_45468725\">in a comment</a>, and use <code>strcmp()</code> to compare strings.</p>\n"}, {"tags": [], "owner": {"reputation": 2708, "user_id": 5424617, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f86a85c89417fa560070c4aeb5aecc56?s=128&d=identicon&r=PG", "display_name": "Md. Rezwanul Haque", "link": "https://stackoverflow.com/users/5424617/md-rezwanul-haque"}, "is_accepted": false, "score": 0, "last_activity_date": 1501700113, "creation_date": 1501700113, "answer_id": 45468895, "question_id": 45468725, "link": "https://stackoverflow.com/questions/45468725/error-in-string-do-while/45468895#45468895", "title": "Error in string do while", "body": "<p>Try :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n\n    char str[6];\n\n    do\n    {\n        printf(\"Enter the string you wanna check:\");\n        scanf(\"%s\", str);\n\n    }\n    while(strcmp(str, \"exit\") != 0);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1501700689, "creation_date": 1501700689, "answer_id": 45469046, "question_id": 45468725, "link": "https://stackoverflow.com/questions/45468725/error-in-string-do-while/45469046#45469046", "title": "Error in string do while", "body": "<p>The short answer is: it <em>does not work</em> because you must use <code>strcmp(str, \"exit\")</code> to compare the strings and loop for as long as the return value of <code>strcmp()</code> is not 0.</p>\n\n<p>The long answer is: there are more problems in this little code fragment:</p>\n\n<ul>\n<li><p>The array into which you read a word is very short and you do not limit the number of characters <code>scanf()</code> is likely to store there.  Any user input longer than 5 non space characters will cause undefined behavior.</p></li>\n<li><p>You do not check the return value of <code>scanf()</code>.  A premature end of file, such as redirecting input from an empty file, will cause an infinite loop.</p></li>\n</ul>\n\n<p>Here is how the code can be written in a safer way:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char str[80];\n\n    for (;;) {\n        printf(\"Enter the string you wanna check:\");\n        if (scanf(\"%79s\", str) != 1 || strcmp(str, \"exit\") == 0)\n            break;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8107552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wrM4FvDz85s/AAAAAAAAAAI/AAAAAAAAADQ/Jd-N_lOtpTk/photo.jpg?sz=128", "display_name": "Aayush Sharma", "link": "https://stackoverflow.com/users/8107552/aayush-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1501725351, "accepted_answer_id": 45468823, "answer_count": 5, "score": -1, "last_activity_date": 1501700689, "creation_date": 1501699589, "last_edit_date": 1501699602, "question_id": 45468725, "link": "https://stackoverflow.com/questions/45468725/error-in-string-do-while", "closed_reason": "Duplicate", "title": "Error in string do while", "body": "<pre><code>char str[6];\n\ndo\n{\n    printf(\"Enter the string you wanna check:\");\n    scanf(\"%s\", str);\n\n}\nwhile(str != \"exit\");\n</code></pre>\n\n<p>Why does this not work?</p>\n"}, {"tags": ["android", "c", "opengl-es", "android-ndk"], "comments": [{"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1501699161, "post_id": 45468469, "comment_id": 77898104, "body": "Please post a minimal reproduceable code example in the question itself. If you are using Android, then you are using opengl-es, not opengl and you should tag your question accordingly."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1501700064, "post_id": 45468469, "comment_id": 77898612, "body": "Just use the standard library to read the data from the files and store them in a string. That has nothing to do with OpenGL, it is just about how familiar you are with the C standard library."}], "answers": [{"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 0, "last_activity_date": 1501700220, "creation_date": 1501700220, "answer_id": 45468923, "question_id": 45468469, "link": "https://stackoverflow.com/questions/45468469/how-can-i-convert-vert-frag-to-char-in-c/45468923#45468923", "title": "How can I convert *.vert &amp; *.frag to char in C?", "body": "<p>You'd do it the same way that you'd load any other file:</p>\n\n<pre><code>char * get_file_contents(char const* file_name) {\n    FILE * file = fopen(\"vert.glsl\", \"r\");\n    fseek(file, 0, SEEK_END);\n    size_t size = ftell(file);\n    rewind(file);\n    char * str = malloc(size);\n    fread(str, 1, size, file);\n    fclose(file);\n    return str;\n}\n\nint main() {\n    /*...*/\n    char const* vShaderStr = get_file_contents(\"vert.glsl\");\n    char const* fShaderStr = get_file_contents(\"frag.glsl\");\n    userData-&gt;programObject = esLoadProgram ( vShaderStr, fShaderStr );\n    free(vShaderStr);\n    free(fShaderStr);\n    /*...*/\n}\n</code></pre>\n\n<p>I only program in C++, so I'm not going to try to add error handling to this code. This should be enough for you to get a start, though.</p>\n"}], "owner": {"reputation": 23, "user_id": 5339456, "user_type": "registered", "profile_image": "https://graph.facebook.com/1030574610285969/picture?type=large", "display_name": "Martin Tsiu", "link": "https://stackoverflow.com/users/5339456/martin-tsiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "closed_date": 1502315986, "accepted_answer_id": 45468923, "answer_count": 1, "score": 1, "last_activity_date": 1520860975, "creation_date": 1501698667, "last_edit_date": 1520860975, "question_id": 45468469, "link": "https://stackoverflow.com/questions/45468469/how-can-i-convert-vert-frag-to-char-in-c", "closed_reason": "Duplicate", "title": "How can I convert *.vert &amp; *.frag to char in C?", "body": "<p>I'm writing a OpenGL with NDK example.</p>\n\n<p>My shader code in <em>main.c</em>:</p>\n\n<pre><code>const char vShaderStr[] =\n      \"#version 300 es                             \\n\"\n      \"uniform mat4 u_mvpMatrix;                   \\n\"\n      \"layout(location = 0) in vec4 a_position;    \\n\"\n      \"layout(location = 1) in vec4 a_color;       \\n\"\n      \"out vec4 v_color;                           \\n\"\n      \"void main()                                 \\n\"\n      \"{                                           \\n\"\n      \"   v_color = a_color;                       \\n\"\n      \"   gl_Position = u_mvpMatrix * a_position;  \\n\"\n      \"}                                           \\n\";\n\nconst char fShaderStr[] =\n      \"#version 300 es                                \\n\"\n      \"precision mediump float;                       \\n\"\n      \"in vec4 v_color;                               \\n\"\n      \"layout(location = 0) out vec4 outColor;        \\n\"\n      \"void main()                                    \\n\"\n      \"{                                              \\n\"\n      \"  outColor = v_color;                          \\n\"\n      \"}                                              \\n\";\n\nuserData-&gt;programObject = esLoadProgram ( vShaderStr, fShaderStr );\n</code></pre>\n\n<p>I had tried this <a href=\"https://github.com/joshb/glsl_lighting/blob/master/shader.c\" rel=\"nofollow noreferrer\">snippet</a> to convert(I also change the way of create shader in <em>main.c</em>), but failed:</p>\n\n<p>I want use extern shader file by reading them in <em>main.c</em>  .</p>\n\n<p>How can I convert it?</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501698104, "post_id": 45468282, "comment_id": 77897453, "body": "See <code>max_align_t</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 19, "creation_date": 1501698116, "post_id": 45468282, "comment_id": 77897461, "body": "There can&#39;t be any portable way to know, as it is  not standardized."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501698237, "post_id": 45468282, "comment_id": 77897531, "body": "If you are &quot;wrapping&quot; <code>malloc()</code>, code can keep track and access data for questions 2 &amp; 3.  Better wrap <code>free(), realloc(), calloc()</code> too."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1501698317, "post_id": 45468282, "comment_id": 77897579, "body": "Inquiring minds want to know <i>why</i>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501698488, "post_id": 45468282, "comment_id": 77897676, "body": "Also <i>.. but a platform-specific answer is still relevant...</i> Which platform?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501698493, "post_id": 45468282, "comment_id": 77897682, "body": "@chux: No, I can&#39;t. malloc() doesn&#39;t tell you how much it allocated; you can at most track what you&#39;ve asked for."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1501698501, "post_id": 45468282, "comment_id": 77897689, "body": "The answer for the first question is available. Since <code>malloc</code> has to return memory aligned for any scalar type, it&#39;s alignment is going to be on the boundary of biggest scalar type. Answer to other questions is not possible to get without completely reimplementing malloc - which is, indeed, possible."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1501698502, "post_id": 45468282, "comment_id": 77897690, "body": "This is specific to the malloc implementation. You should browse the documentation of your malloc implementation"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1501698570, "post_id": 45468282, "comment_id": 77897722, "body": "@Justin: Of course it is, but <i>getting</i> this information doesn&#39;t need to be."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1501698617, "post_id": 45468282, "comment_id": 77897752, "body": "@SergeyA How do you know which scalar types are supported?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501698727, "post_id": 45468282, "comment_id": 77897815, "body": "@EugeneSh., well, that&#39;s something you have to know for your implementation, I guess."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1501698741, "post_id": 45468282, "comment_id": 77897826, "body": "Please note that the question does not insist on a portable way (which, indeed, does not exist), but explicitly asks for a platform-specific way, if any.  I, for one, would be interested to know of any platform-specific ways, too, because this question comes up all the time, because sometimes, being able to do these things would be truly useful."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1501698753, "post_id": 45468282, "comment_id": 77897832, "body": "@SergeyA Isn&#39;t it catch 22?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501698802, "post_id": 45468282, "comment_id": 77897871, "body": "@EugeneSh., the question says system-specific answer is OK, so this is a system-specific answer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1501698860, "post_id": 45468282, "comment_id": 77897920, "body": "@SergeyA won&#39;t it be easier just to hardcode these things to the system-specific values?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501698910, "post_id": 45468282, "comment_id": 77897942, "body": "@EugeneSh. yes. I was suggesting what those should be hardcoded <b>to</b>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501699129, "post_id": 45468282, "comment_id": 77898086, "body": "For GNU, see <a href=\"https://www.gnu.org/software/libc/manual/html_node/Summary-of-Malloc.html\" rel=\"nofollow noreferrer\">gnu.org/software/libc/manual/html_node/Summary-of-Malloc.htm&zwnj;&#8203;l</a> .  I don&#39;t see much there corresponding to what you&#39;re asking."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1501699304, "post_id": 45468282, "comment_id": 77898186, "body": "On <a href=\"https://developer.apple.com/library/content/documentation/Performance/Conceptual/ManagingMemory/Articles/MallocDebug.html\" rel=\"nofollow noreferrer\">Mac</a> and <a href=\"https://www.gnu.org/software/libc/manual/html_node/Malloc-Tunable-Parameters.html\" rel=\"nofollow noreferrer\">Linux</a>, there are environment variables that affect the behavior of <code>malloc</code>.  This isn&#39;t what you&#39;re asking for, but may help you track down other details."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1501699395, "post_id": 45468282, "comment_id": 77898231, "body": "I suppose this is where you roll your own allocator"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1501699451, "post_id": 45468282, "comment_id": 77898256, "body": "@PasserBy I was really tempted to give a similar answer :)"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1501699483, "post_id": 45468282, "comment_id": 77898279, "body": "@paddy: Link to that?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1501699592, "post_id": 45468282, "comment_id": 77898337, "body": "(nods head) How weird is SO, where you can get 3 upvotes, a nice answer and 20 comments, and at the same time 3 downvotes and a close vote, on something which isn&#39;t a meta post."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1501699605, "post_id": 45468282, "comment_id": 77898341, "body": "@einpoklum do you mean apart from the two links I gave?"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1501699764, "post_id": 45468282, "comment_id": 77898445, "body": "The &quot;portable&quot; part of the question cannot rely just on the operating system.  The compiler and perhaps even the particular implementation of the standard library contribute to the exact behavior of malloc."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1501699869, "post_id": 45468282, "comment_id": 77898498, "body": "As to how much did it actually allocate, there are a lot of ways to interpret that.  Do you want to count separate allocations that may be used for tracking the state of the allocator?  If a small allocation triggers the actual allocation of a big block that may later be used to satisfy other allocations, do you want to count the entire block?  Do you want to track memory lost to fragmentation?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1501700076, "post_id": 45468282, "comment_id": 77898618, "body": "@SergeyA Disagree with <a href=\"https://stackoverflow.com/questions/45468282/how-can-i-get-information-about-mallocs-behavior?noredirect=1#comment77897689_45468282\">boundary of biggest scalar type</a>.  Is it not the <i>size</i> of the type that matters, it is the maximum <i>alignment</i> need of the various types.  Alignment requirements may be less than the size."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501706532, "post_id": 45468282, "comment_id": 77902273, "body": "This problem has been solved in many ways before.  Unless code&#39;s needs are very unique, existing wrappers for allocation functions exist.  Basic ones are a mid-level programming task, but better ones exist in libraries - out there."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501706875, "post_id": 45468282, "comment_id": 77902439, "body": "@chux: Most problems presented on SO have been solved before in various libraries... actually I have a potentially valid motivation to not use one of them but it&#39;s completely outside the scope of this question."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1501698998, "post_id": 45468527, "comment_id": 77898011, "body": "Any implementation which doesn&#39;t align as per standard is non-conforming."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1501699045, "post_id": 45468527, "comment_id": 77898035, "body": "<code>malloc_usable_size</code> is returning the size which is corresponding to the parameter passed to <code>malloc</code> + plus the alignment, and not the actual memory usage (including the metadata - not sure if that what was asked, though)"}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501699281, "post_id": 45468527, "comment_id": 77898172, "body": "@Eugene, it&#39;s not size plus alignment, but size plus the tail due to internal fragmentation. It&#39;s not the full overhead, but I&#39;m not sure if the question was about that. Attributing the full overhead to a single allocation is in general impossible."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501699288, "post_id": 45468527, "comment_id": 77898176, "body": "@EugeneSh.: Actually I might interested in both these things, but good point."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1501699365, "post_id": 45468527, "comment_id": 77898210, "body": "Florian, if glibc malloc is incompatible with C-standard malloc in the max_align_t value, how <code>max_align_t</code> help me at all?"}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 1, "creation_date": 1501699490, "post_id": 45468527, "comment_id": 77898284, "body": "@einpoklum, it does not. <code>max_align_t</code> is useless. The C standard assumes that there is just a single C implementation, but in reality, you have a compiler, a C library, and perhaps even a separate malloc, all from different sources and on different release cycles. And the alignment bugs aren&#39;t even fixed over time due to performance concerns."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501700194, "post_id": 45468527, "comment_id": 77898697, "body": "<code>max_align_t</code> comes from the C spec.  <code>malloc()</code> must <i>at least</i> align to that."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 5, "last_activity_date": 1501700455, "last_edit_date": 1501700455, "creation_date": 1501698895, "answer_id": 45468527, "question_id": 45468282, "link": "https://stackoverflow.com/questions/45468282/how-can-i-get-information-about-mallocs-behavior/45468527#45468527", "title": "How can I get information about malloc()&#39;s behavior?", "body": "<p>glibc implements <code>malloc_usable_size</code>, which returns the actual allocation size available for application use.  Some alternative <code>malloc</code>s implement it as well.  Note that glibc can perform a non-moving <code>realloc</code> even if the requested new size is larger than the one <code>malloc_usable_size</code>, so it is not useful for this purpose.</p>\n\n<p>For the other things you are asking, there are no clear answers.  Theoretically, <code>malloc</code> should provide memory at least aligned to <code>_Alignof (max_align_t)</code>, but many implementations do not do this for various reasons:</p>\n\n<ul>\n<li><code>max_align_t</code> comes from a compiler such as GCC and thus reflects the compiler's view of the world, and not what <code>malloc</code> provides (see <a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=21120\" rel=\"nofollow noreferrer\">glibc malloc is incompatible with GCC 7</a> for an example).  The C standard assumes a uniform implementation, but in practice, the compiler, the C run-time library, and even <code>malloc</code> are separate components, built from different sources, and on different release cycles, so they can fall out of sync, and a compile-time constant such as <code>_Alignof (max_align_t)</code> will rarely accurately reflect what <code>malloc</code> does at run-time.</li>\n<li>Providing the ABI-mandated 16 byte alignment on x86-64 for allocations of 8 or 4 bytes is wasteful.</li>\n<li>A <code>malloc</code> implementation may have internal constraints which result in larger alignment then what is required by the architecture specification.  Applications obviously cannot rely on that, but it is still observable.</li>\n</ul>\n\n<p>Your question about non-moving <code>realloc</code> does not even have a proper answer: For a multi-threaded program, another thread might place an allocation which blocks the enlargement of the current allocation between the determination of the resize limit and the actual <code>realloc</code> call.  A non-moving version of <code>realloc</code> could be a useful addition, but the interface would be quite different (probably something along the lines of <em>please resize to this maximum value if possible without moving the block, otherwise return the largest possible size</em> or something like that).</p>\n"}, {"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1501700979, "post_id": 45468782, "comment_id": 77899143, "body": "This is a valid point, I suppose, but I don&#39;t want to go there."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1501701320, "post_id": 45468782, "comment_id": 77899328, "body": "I&#39;m afraid there is no <code>free</code> lunch in this field, you have to brace and enter the arena (and crush&#39;m ;-)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1501704339, "post_id": 45468782, "comment_id": 77901069, "body": "There are reasonably portable freely available malloc implementations which provide the desired interfaces (more or less). Rolling your own would be an over-reaction imho."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1501752070, "post_id": 45468782, "comment_id": 77920439, "body": "@rici: I agree with you, that&#39;s exactly my advice."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1501752100, "last_edit_date": 1501752100, "creation_date": 1501699768, "answer_id": 45468782, "question_id": 45468282, "link": "https://stackoverflow.com/questions/45468282/how-can-i-get-information-about-mallocs-behavior/45468782#45468782", "title": "How can I get information about malloc()&#39;s behavior?", "body": "<p>If you want a portable answer to these questions, your best bet is to implement your own allocation scheme.  It would be safer to not use the names <code>malloc()</code>, <code>calloc()</code>, <code>realloc()</code>, <code>free()</code>, <code>strdup()</code>, etc. because you might run into problems with dynamic name resolution, even if your reimplementation of the standard functions is conformant.</p>\n\n<p>Any source code you control could be made to call your allocator by defining a set of macros at the head of every module (via a common header file).</p>\n\n<p>Using system specific tricks to retrieve information from the allocator's metadata is risky because your program will bind to the C library dynamically, so it is possible that such structures change from one system to another, even for the same operating system.</p>\n\n<p>Re-implementing <code>malloc()</code> in terms of lower level systems calls such as <code>mmap()</code> or other system specific stuff seems deceptively simple, but it is a lot of work to make it correct, stable, efficient and reliable.  You should look at available proven alternative implementations of <code>malloc</code> and try and tailor them to your needs.</p>\n"}], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501752100, "creation_date": 1501698015, "last_edit_date": 1501699436, "question_id": 45468282, "link": "https://stackoverflow.com/questions/45468282/how-can-i-get-information-about-mallocs-behavior", "title": "How can I get information about malloc()&#39;s behavior?", "body": "<p>I'm wrapping <code>malloc()</code> for some reason. I would like to have some (system-specific, at-run-time) information beyond what I can get by merely calling it. For example:</p>\n\n<ul>\n<li>What's the minimum alignment <code>malloc()</code> is using for allocation?</li>\n<li>When allocating a specific stretch of memory, how much did it <em>actually</em> allocate (this could theoretically be more than the amount requested)?</li>\n<li>Whether (assuming no other concurrent operations) a <code>realloc()</code> will succeed with the same original address or require a move.</li>\n</ul>\n\n<p>Note: I'd like as portable as answer as possible, but a platform-specific answer is still relevant: Linux, Windows, MacOs, Un*x.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 1, "creation_date": 1501697825, "post_id": 45468165, "comment_id": 77897277, "body": "your above code is not correct for given input."}, {"owner": {"reputation": 61, "user_id": 7501217, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-9bJkpXFZyC4/AAAAAAAAAAI/AAAAAAAAAiU/3AxppvWbaFQ/photo.jpg?sz=128", "display_name": "Atanu Mondal", "link": "https://stackoverflow.com/users/7501217/atanu-mondal"}, "edited": false, "score": 0, "creation_date": 1501697902, "post_id": 45468165, "comment_id": 77897328, "body": "this is not giving the right answer. please, can you correct it?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1501697936, "post_id": 45468165, "comment_id": 77897352, "body": "it is giving the correct answer, what do you think the correct answer is?"}, {"owner": {"reputation": 61, "user_id": 7501217, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-9bJkpXFZyC4/AAAAAAAAAAI/AAAAAAAAAiU/3AxppvWbaFQ/photo.jpg?sz=128", "display_name": "Atanu Mondal", "link": "https://stackoverflow.com/users/7501217/atanu-mondal"}, "edited": false, "score": 0, "creation_date": 1501698084, "post_id": 45468165, "comment_id": 77897442, "body": "for the first test case, the actual output is showing this 32764"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1501698296, "post_id": 45468165, "comment_id": 77897570, "body": "ah - we though you were showing your output."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1501698380, "post_id": 45468165, "comment_id": 77897614, "body": "how would you do this if you were asked to do it in a conversation. I will recite a sequence of numbers to you, you cannot write them all down. When I finish you must tell me the value of the second highest number. How would you do it. Note , you can write 2 numbers down."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1501705800, "post_id": 45468165, "comment_id": 77901861, "body": "Think of doing this with cards. Separate out the Hearts. Shuffle them. Draw two cards. Now find the two highest cards; the rules are you can only draw one card at a time, and every time you draw one you must discard one so you&#39;re left with two cards in your hand."}], "answers": [{"tags": [], "owner": {"reputation": 435637, "user_id": 367273, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f1ed2b0c87f602ef30229f5c4b04eff6?s=128&d=identicon&r=PG", "display_name": "NPE", "link": "https://stackoverflow.com/users/367273/npe"}, "is_accepted": true, "score": 4, "last_activity_date": 1501698226, "creation_date": 1501698226, "answer_id": 45468336, "question_id": 45468165, "link": "https://stackoverflow.com/questions/45468165/finding-the-second-highest-number/45468336#45468336", "title": "Finding the second highest number", "body": "<p>I won't solve your homework, but will offer some hints:</p>\n\n<ol>\n<li><p>You should give your variables clear names that reflect their purpose. Names like <code>i</code>, <code>a</code>, <code>temp</code> and <code>sec</code> make the code unnecessarily hard to reason about.</p></li>\n<li><p>You should initialize all variables. For example, the initialization of <code>sec</code> is a bit iffy.</p></li>\n<li><p>You don't need two loops.</p></li>\n<li><p>The following <code>if</code> is a no-op (which means that the <code>break</code> that follows is executed unconditionally):</p>\n\n<p><code>if (a == -1) ;</code></p></li>\n</ol>\n\n<p>Finally, and most importantly, there are three cases you need to handle when iterating over the numbers:</p>\n\n<ol>\n<li><p>The current number is larger than the largest number seen thus far.</p></li>\n<li><p>The current number is not larger than the largest but is larger than the second-largest number seen thus far.</p></li>\n<li><p>The current number is not larger than the second-largest number.</p></li>\n</ol>\n\n<p>Hopefully, this'll give you enough direction to make more progress. If you get stuck, please post another question.</p>\n"}, {"comments": [{"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1501698733, "post_id": 45468364, "comment_id": 77897819, "body": "please provide a comment so that I can improve my answer , don;t just downvote"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501698825, "post_id": 45468364, "comment_id": 77897892, "body": "NMDV, <code>int sec = -INFINITY;</code> is <i>undefined behavior</i>."}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501698965, "post_id": 45468364, "comment_id": 77897989, "body": "I don&#39;t understand what that means, I just compiled this and it works. INFINITY is defined in math.h which I have included. this answer also corroborates this <a href=\"https://stackoverflow.com/questions/1923837/how-to-use-nan-and-inf-in-c\">here</a>"}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501699085, "post_id": 45468364, "comment_id": 77898064, "body": "Unless you meant to say it is undefined because it is implementation dependent , the OP did not specify his platform , I&#39;ve now edited my answer to specify mine"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501699120, "post_id": 45468364, "comment_id": 77898078, "body": "Which part do you not understand the meaning: NMDV, <code>INFINITY</code>, <i>undefined behavior</i>, or something else?"}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501699187, "post_id": 45468364, "comment_id": 77898119, "body": "about INFINITY being undefined, could you please elaborate"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501699428, "post_id": 45468364, "comment_id": 77898242, "body": "<code>INFINITY</code> is defined in <code>&lt;math.h&gt;</code>, it is some large value well outside the <code>int</code> range.  Assigning a value outside the <code>int</code> range to an <code>int</code> is the problem.  It is either <i>undefined behavior</i> or <i>implementation defined behavior</i> - I&#39;ll need to check that.  Why not use <code>sec = INT_MIN;</code> - no issues with that?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501699617, "post_id": 45468364, "comment_id": 77898351, "body": "<code>sec = -INFINITY;</code> --&gt; &quot;Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.&quot;"}], "tags": [], "owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "is_accepted": false, "score": 0, "last_activity_date": 1501699627, "last_edit_date": 1501699627, "creation_date": 1501698314, "answer_id": 45468364, "question_id": 45468165, "link": "https://stackoverflow.com/questions/45468165/finding-the-second-highest-number/45468364#45468364", "title": "Finding the second highest number", "body": "<p>How about this?</p>\n\n<p><strong>EDIT:</strong> works for me in GCC version 4.3.4 on SUSE Linux 11</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main(void) {\n  int i, a, temp, sec, largest;\n  sec = INT_MIN;\n  largest = INT_MIN;\n  while (1) {\n    scanf(\"%d\", &amp;a);\n    if (a == -1) {\n        break;\n    }\n    if (a &gt; largest) {\n        sec = largest;\n        largest = a;\n    } else if (a &gt; sec) {\n        sec = a;\n    }\n  }\n\n  printf(\"%d\", sec);\n  return 0;\n}\n</code></pre>\n\n<p>I haven't corrected some bad code smells but I've just made a quick and dirty answer</p>\n"}, {"comments": [{"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501698807, "post_id": 45468403, "comment_id": 77897874, "body": "<code>input &lt;= firstMax &amp;&amp;</code> is for safa gaurd. it woun&#39;t hurt. And I didn&#39;t use library to confure him. He seems novice."}], "tags": [], "owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "is_accepted": false, "score": 2, "last_activity_date": 1501699135, "last_edit_date": 1501699135, "creation_date": 1501698448, "answer_id": 45468403, "question_id": 45468165, "link": "https://stackoverflow.com/questions/45468165/finding-the-second-highest-number/45468403#45468403", "title": "Finding the second highest number", "body": "<p><strong>Try this.</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define INT_MIN -999999;  //define minimum value\n\nint main() {\n  int input, firstMax = INT_MIN;\n  int secMax = INT_MIN;\n  do {\n    scanf(\"%d\", &amp;input);\n    if (input == -1)\n    break;\n\n    if(input &gt; firstMax) {  //find new first max value\n        secMax = firstMax;  //set previous max to second max\n        firstMax = input;   //update first max to new value\n    }\n    else if(input &gt; secMax) {\n        secMax = input;     //new second max value is found. update it\n    }\n  } while(1); \n\n  printf(\"%d\", secMax);\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2708, "user_id": 5424617, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f86a85c89417fa560070c4aeb5aecc56?s=128&d=identicon&r=PG", "display_name": "Md. Rezwanul Haque", "link": "https://stackoverflow.com/users/5424617/md-rezwanul-haque"}, "is_accepted": false, "score": -1, "last_activity_date": 1501699245, "creation_date": 1501699245, "answer_id": 45468625, "question_id": 45468165, "link": "https://stackoverflow.com/questions/45468165/finding-the-second-highest-number/45468625#45468625", "title": "Finding the second highest number", "body": "<p>You can try this way : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\n\nint main() {\n  int a, first = INT_MIN, sec = INT_MIN;\n  while(1){\n    scanf(\"%d\", &amp;a);\n    if (a == -1)\n      break;\n\n    if(a &gt; first) {\n        sec = first;\n        first = a;\n    }\n    else if(a &gt; sec) {\n        sec = a;\n    }\n  }\n\n  printf(\"%d\", sec);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7501217, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-9bJkpXFZyC4/AAAAAAAAAAI/AAAAAAAAAiU/3AxppvWbaFQ/photo.jpg?sz=128", "display_name": "Atanu Mondal", "link": "https://stackoverflow.com/users/7501217/atanu-mondal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 0, "accepted_answer_id": 45468336, "answer_count": 4, "score": 0, "last_activity_date": 1501712643, "creation_date": 1501697601, "last_edit_date": 1501712643, "question_id": 45468165, "link": "https://stackoverflow.com/questions/45468165/finding-the-second-highest-number", "title": "Finding the second highest number", "body": "<p>I want to find the second highest number from a sequence <em>without using an array</em>.</p>\n\n<p>The instructions are the following.</p>\n\n<blockquote>\n  <p>You are given a sequence of integers as input, terminated by a\n  -1. (That is, the input integers may be positive, negative or 0. A -1\n  in the input signals the end of the input.) </p>\n  \n  <p>-1 is not considered as part of the input.  </p>\n  \n  <p>Find the second largest number in the input. You may not use arrays.</p>\n</blockquote>\n\n<p>What I did is this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int i, a, temp, sec;\n    while (1) {\n        scanf(\"%d\", &amp;a);\n        if (a == -1) ;\n            break;\n\n        temp = a;\n        while (1) {\n            scanf(\"%d\", &amp;a);\n            if (a == -1) {\n                break;\n            }\n            if (a &gt; temp) \n                sec = temp;\n            else \n                sec = a;\n        }\n    }\n\n    printf(\"%d\", sec);\n    return 0;\n}\n</code></pre>\n\n<p>Sample test cases will be like the following ones.</p>\n\n<pre><code>Sample Test Cases\nInput   \nTest Case 1 \n-840 -288 -261 -337 -335 488 -1\nOutput\n-261\nTest Case 2 \n-840 -335 -1\nOutput\n-840\n</code></pre>\n\n<p>I don't know where to get started and where I am getting wrong.</p>\n"}, {"tags": ["c", "function", "printf"], "answers": [{"comments": [{"owner": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "edited": false, "score": 0, "creation_date": 1501697584, "post_id": 45468112, "comment_id": 77897133, "body": "Is there a way to implicitly &quot;declare&quot; that I need fflush on every printf? Other than wrapping it in a function which contains fflush?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "edited": false, "score": 1, "creation_date": 1501698527, "post_id": 45468112, "comment_id": 77897706, "body": "@Droidzone You can&#39;t have executable statements, such as a function call, outside of a function.  You need to put the call to <code>setbuf</code> in a function, preferably at the start of <code>main</code>."}, {"owner": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "edited": false, "score": 0, "creation_date": 1501698992, "post_id": 45468112, "comment_id": 77898003, "body": "Worked with <code>setvbuf(stdout, NULL, _IONBF, 0);</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "edited": false, "score": 0, "creation_date": 1501699084, "post_id": 45468112, "comment_id": 77898062, "body": "@Droidzone Right!  Edited."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "edited": false, "score": 0, "creation_date": 1501761846, "post_id": 45468112, "comment_id": 77927725, "body": "@Droidzone note that it disables buffering, not that it&#39;ll call <code>fflush</code> on every <code>printf</code>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1501855883, "post_id": 45468112, "comment_id": 77978999, "body": "use   printf (&quot;Host real ip is:\\n&quot;); to avoid this misbehavior"}, {"owner": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "reply_to_user": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1501881061, "post_id": 45468112, "comment_id": 77992473, "body": "@EsmaeelE Obviously if I do that IP gets printed on another line, which wasnt what I wanted."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "reply_to_user": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "edited": false, "score": 0, "creation_date": 1501884215, "post_id": 45468112, "comment_id": 77993496, "body": "@Droidzone  Thanks for good  question that i learn some weird thing on C. fflush() the output solve it. I know what is the problem but i cant find out what is the application of it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 12, "last_activity_date": 1501856277, "last_edit_date": 1501856277, "creation_date": 1501697414, "answer_id": 45468112, "question_id": 45468072, "link": "https://stackoverflow.com/questions/45468072/output-of-printf-out-of-order/45468112#45468112", "title": "Output of printf out of order", "body": "<p>The output of <code>printf</code> is being buffered because the string being printed does not contain a newline.  As a result, the buffer does not get flushed until the  program ends, and therefore appears after the output of the <code>system</code> command.</p>\n\n<p>To flush the buffer, use <code>fflush</code>:</p>\n\n<pre><code>printf (\"Host real ip is:\");\nfflush(stdout);\nExecAsRoot(\"ip addr | grep 'state UP' -A2 | tail -n1 | awk '{print $2}' | cut -f1  -d'/'\");\n</code></pre>\n\n<p>If you want all writes to <code>stdout</code> to be unbuffered, you can use <code>setvbuf</code> to disable buffering:</p>\n\n<pre><code>setvbuf(stdout, NULL, _IONBF, 0);     // _IONBF = unbuffered\n</code></pre>\n\n<p>Or more simply:</p>\n\n<pre><code>setbuf(stdout, NULL);\n</code></pre>\n\n<p>Then all writes to <code>stdout</code> will appear immediately.</p>\n"}], "owner": {"reputation": 5328, "user_id": 1305947, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/660bcd99a216234e04adb27125cbf0a3?s=128&d=identicon&r=PG", "display_name": "Joel G Mathew", "link": "https://stackoverflow.com/users/1305947/joel-g-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1533, "favorite_count": 2, "accepted_answer_id": 45468112, "answer_count": 1, "score": 11, "last_activity_date": 1501856277, "creation_date": 1501697262, "last_edit_date": 1501761720, "question_id": 45468072, "link": "https://stackoverflow.com/questions/45468072/output-of-printf-out-of-order", "title": "Output of printf out of order", "body": "<p>I wrote the following:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\nvoid ExecAsRoot (char* str);\nint main ()\n{\n  printf (\"Host real ip is:\");\n  ExecAsRoot(\"ip addr | grep 'state UP' -A2 | tail -n1 | awk '{print $2}' | cut -f1  -d'/'\");\n  return 0;\n }\n\nvoid ExecAsRoot (char* str) {\n  system (str);\n}\n</code></pre>\n\n<p>My expected output is:</p>\n\n<pre><code>Host real ip is:7.17.11.29\n</code></pre>\n\n<p>While the actual output is:</p>\n\n<pre><code>7.17.11.29\nHost real ip is:\n</code></pre>\n\n<p>Why is this?</p>\n"}, {"tags": ["c", "linux", "shared-libraries"], "comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1501698832, "post_id": 45467653, "comment_id": 77897895, "body": "The problem may not be in the library itself, but in the way client code allocates these structs. I mean, imagine that the caller allocates an array of old <code>DynApiArg_t x[10];</code>. From the point of view of the library those objects are overlapping!"}, {"owner": {"reputation": 328, "user_id": 4844822, "user_type": "registered", "profile_image": "https://graph.facebook.com/459123704243311/picture?type=large", "display_name": "Zsigmond L\u0151rinczy", "link": "https://stackoverflow.com/users/4844822/zsigmond-l%c5%91rinczy"}, "edited": false, "score": 1, "creation_date": 1501735306, "post_id": 45467653, "comment_id": 77910332, "body": "Yes that&#39;s what version numbers are good for. Check this: <a href=\"https://www.ibm.com/developerworks/linux/library/l-shlibs/index.html\" rel=\"nofollow noreferrer\">ibm.com/developerworks/linux/library/l-shlibs/index.html</a>"}, {"owner": {"reputation": 626, "user_id": 4358702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4FIAY.jpg?s=128&g=1", "display_name": "padfoot", "link": "https://stackoverflow.com/users/4358702/padfoot"}, "reply_to_user": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1501744150, "post_id": 45467653, "comment_id": 77914742, "body": "@rodrigo Yes. I understand that the problem isn&#39;t with the library and the apps need to be updated. My question was that if we don&#39;t update the app and the lib was updated, how do I ensure the app is using the lib that it&#39;s compatible with assuming multiple version of the libs are installed."}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1545601244, "creation_date": 1545601244, "answer_id": 53907357, "question_id": 45467653, "link": "https://stackoverflow.com/questions/45467653/rebuild-a-dynamic-library-upon-argument-typedef-change/53907357#53907357", "title": "Rebuild a dynamic library upon argument typedef change", "body": "<p>There are a number of approaches to solve this problem:</p>\n\n<ol>\n<li><p>Include the API version in the dynamic library name.</p>\n\n<p>Instead of <code>dlopen(\"libfoo.so\")</code>, you use <code>dlopen(\"libfoo.so.4\")</code>. Different major versions of the library are essentially separate, and can coexist on the same system; so, the package name for that library would be e.g. <code>libfoo-4</code>. You can have <code>libfoo.so.4</code> and <code>libfoo.so.5</code> installed at the same time. Minor versions, say <code>libfoo-4.2</code>, install <code>libfoo.so.4.2</code>, and symlink <code>libfoo.so.4</code> to <code>libfoo.so.4.2</code>.</p></li>\n<li><p>Initially define the structures with zero padding (required to be zero in earlier versions of the library), and have the later versions reuse the padding fields, but keeping the structures the same size.</p></li>\n<li><p>Use versioned symbol names. This is a Linux extension, using <a href=\"http://man7.org/linux/man-pages/man3/dlvsym.3.html\" rel=\"nofollow noreferrer\"><code>dlvsym()</code></a>.  A single shared library binary can implement several versions of the same dynamic symbol. </p></li>\n<li><p>Use <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Function-Attributes.html#index-ifunc-function-attribute\" rel=\"nofollow noreferrer\">resolver functions</a> to determine the symbols at load time.  This allows e.g. hardware architecture-optimized variants of functions to be selected at run time, but is less useful with a <code>dlopen()</code>-based approach.</p></li>\n<li><p>Use a structure to describe the library API, and a versioned function to obtain/initialize that API.</p>\n\n<p>For example, version 4 of your library could implement</p>\n\n<pre><code> struct libfoo_api {\n     int   (*func1)(int arg1, int arg2);\n     double *data;\n     void  (*func2)(void);\n     /* ... */\n };\n</code></pre>\n\n<p>and only export one symbol,</p>\n\n<pre><code> int libfoo_init(struct libfoo_api *const api, const int version);\n</code></pre>\n\n<p>Calling that function would initialize the <code>api</code> structure with the symbols supported, with the assumption that the structure corresponds to the specified version. A single shared library can support multiple versions. If a version is not supported, it can return a failure.</p>\n\n<p>This is especially useful for plugin-type interfaces (although then the <code>_init</code> function is more likely to call application-provided functionality registering functions, rather than fill in a structure), as a single file can contain optimized functionality for a number of versions, optimized for a number of compatible hardware architectures (for example, AMD/Intel architectures with different SSE/AVX/AVX2/AVX512 support).</p></li>\n</ol>\n\n<p>Note that the above implementation details can be \"hidden\" in a header file, making actual C code using the shared library much simpler. It also helps making the same API work across a number of OSes, simply by changing the header file to use the approach that works best on that OS, while keeping the actual C interface the same.</p>\n"}], "owner": {"reputation": 626, "user_id": 4358702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4FIAY.jpg?s=128&g=1", "display_name": "padfoot", "link": "https://stackoverflow.com/users/4358702/padfoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1545601244, "creation_date": 1501695783, "question_id": 45467653, "link": "https://stackoverflow.com/questions/45467653/rebuild-a-dynamic-library-upon-argument-typedef-change", "title": "Rebuild a dynamic library upon argument typedef change", "body": "<p>Let's assume, I have a C structure, <code>DynApiArg_t</code>. </p>\n\n<pre><code>typedef struct DynApiArg_s {\n    uint32_t m1;\n    ...\n    uint32_t mx;\n} DynApiArg_t;\n</code></pre>\n\n<p>The pointer of this struct is passed as an arg to a function say </p>\n\n<pre><code>void DynLibApi(DynApiArg_t *arg)\n{\n     arg-&gt;m1 = 0;\n     another_fn_in_the_lib(arg-&gt;mold); /* May crash here. (1) */\n}\n</code></pre>\n\n<p>which is present in a dynamic library, <code>libdyn.so</code>. This API is invoked from an executable via a <code>dlopen/dlsym</code> procedure of invocation.</p>\n\n<p>In case this dynamic library is updated to version 2, where <code>DynApiArg_t</code> now has new member, say <code>m2</code>, as below:</p>\n\n<pre><code>typedef struct DynApiArg_s {\n    uint32_t m1;\n    OldMbr_t *mold;\n    ...\n    uint32_t mx;\n    uint32_t m2;\n    NewMbr *mnew;\n} DynApiArg_t;\n</code></pre>\n\n<p>Without a complete rebuild of the executable or other libs that call this API via a <code>dlopen/dlsym</code>, everytime this API is invoked, I see the process crashing, due to the some dereference of any member in the struct. I understand accessing m2 may be a problem. But access to member <code>mold</code> like below is seen causing crashes.</p>\n\n<pre><code>typedef void (*fnPtr_t)(DynApiArg_t*);\n\n\nvoid DynApiCaller(DynApiArg_t *arg)\n{\n     void *libhdl = dlopen(\"libdyn.so\", RTLD_LAZY | RTLD_GLOBAL);\n     fnPtr_t fptr = dlsym(libhdl, \"DynLibApi\");\n     fnptr(arg); /* actual call to the dynamically loaded API (2) */\n}\n</code></pre>\n\n<p>In the call to the API via fnptr, at line marked (2), when the old/existing members (in v1 of lib, when DynApiCaller was initially compiled) is accessed at (1), it happens to be any garbage value or even <code>NULL</code> at times.</p>\n\n<p>What is the right way to handle such updates without a complete recompilation of the executable everytime the dependant libs are updated? </p>\n\n<p>I've seen libs being named with symliks with version numbers like <code>libsolid.so.4</code>. Is there something related to this versioning system that can help me? If so can you point me to right documentations for these if any?</p>\n"}, {"tags": ["c", "gnuplot"], "comments": [{"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 0, "creation_date": 1501694229, "post_id": 45467067, "comment_id": 77895138, "body": "Search the documentation for any persistence options. I haven&#39;t used this library myself but it sounds like you want the data to persist between multiple writes, then reset on every 6th?  You&#39;ll get more useful answers with a code sample we can look at BTW."}, {"owner": {"reputation": 91, "user_id": 7122572, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ed0f1ca04053b43ad2a651b7810a981?s=128&d=identicon&r=PG&f=1", "display_name": "Emperon", "link": "https://stackoverflow.com/users/7122572/emperon"}, "reply_to_user": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 0, "creation_date": 1501694758, "post_id": 45467067, "comment_id": 77895436, "body": "yes that&#39;s correct"}, {"owner": {"reputation": 44000, "user_id": 2604213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7ThK.png?s=128&g=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/2604213/christoph"}, "edited": false, "score": 0, "creation_date": 1501701279, "post_id": 45467067, "comment_id": 77899298, "body": "Gnuplot cannot persist partial data of a single <code>plot</code>."}, {"owner": {"reputation": 91, "user_id": 7122572, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ed0f1ca04053b43ad2a651b7810a981?s=128&d=identicon&r=PG&f=1", "display_name": "Emperon", "link": "https://stackoverflow.com/users/7122572/emperon"}, "edited": false, "score": 0, "creation_date": 1501708072, "post_id": 45467067, "comment_id": 77903063, "body": "does anyone have a better and faster idea ? if I save the previus buffer in a .dat file and rewrite them with the next buffer would it be faster than my code  ?"}, {"owner": {"reputation": 3626, "user_id": 7932936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88294cbc3a02c75cfbb906658ad85e15?s=128&d=identicon&r=PG", "display_name": "user8153", "link": "https://stackoverflow.com/users/7932936/user8153"}, "edited": false, "score": 0, "creation_date": 1502227217, "post_id": 45467067, "comment_id": 78115881, "body": "While gnuplot doesn&#39;t keep the <i>data</i> from past plot commands, you could use <code>set multiplot</code> to keep the <i>output</i> from previous plot commands, and make additional plots onto the same figure as new data arrives (you might have to fix ranges and margins for that)."}, {"owner": {"reputation": 3626, "user_id": 7932936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88294cbc3a02c75cfbb906658ad85e15?s=128&d=identicon&r=PG", "display_name": "user8153", "link": "https://stackoverflow.com/users/7932936/user8153"}, "edited": false, "score": 0, "creation_date": 1502227278, "post_id": 45467067, "comment_id": 78115908, "body": "You might also be able to speed things up by sending the data to gnuplot in binary format (right now your code turns data into text, and gnuplot has to parse that to turn it back into data)."}], "owner": {"reputation": 91, "user_id": 7122572, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ed0f1ca04053b43ad2a651b7810a981?s=128&d=identicon&r=PG&f=1", "display_name": "Emperon", "link": "https://stackoverflow.com/users/7122572/emperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501714879, "creation_date": 1501693830, "last_edit_date": 1501714879, "question_id": 45467067, "link": "https://stackoverflow.com/questions/45467067/replot-buffer-in-c-gnuplot-issue", "title": "replot buffer in C, gnuplot issue", "body": "<p>I call gnuplot from my C program on a linux system.\nI need to plot an ECG data in real time.\nI have 6 buffer to fill the gnuplot's window, they don't arrive at the same time.\nI need to graficate the first when it arrives in real time(fprintf with points from array and for loop), then when the next buffer arrives I need to maintain the previus and write the next with a second for loop.\nBut I can't do it. Every time when the next buffer arrives I need to rewrite the previus ones.. It takes in the end 6 for loops(6 buffer to fill the gnuplot's window), and I can't do it because it takes too much time, and in this way I can't get data on the screen in real time.\nThere's some function in gnuplot to maintain the data written with the previus for loops, and only plot the next??\nI hope I've explained myself</p>\n\n<p>this is the previus code I used, every time I need to rewrite the old buffers.</p>\n\n<pre><code>while(1) {\n    //pulizia buffer e lettura: 4 BUFFER\n                      switch(b) {\n                      case 0:     \n                          bzero(buffer, sizeof(buffer));\n                          n = read(newsockfd, buffer, sizeof(buffer));\n                          if (n &lt; 0) errore(\"Errore lettura Socket\");\n                          b = 1;\n                          break;\n                      case 1:\n                      bzero(buffer2, sizeof(buffer2));\n                          n = read(newsockfd, buffer2, sizeof(buffer2));\n                          if (n &lt; 0) errore(\"Errore lettura Socket\");                  \n                          b = 2;\n                          break;\n                      case 2:\n                          bzero(buffer3, sizeof(buffer3));\n                          n = read(newsockfd, buffer3, sizeof(buffer3));\n                          if (n &lt; 0) errore(\"Errore lettura Socket\");\n                          b = 3;\n                          break;\n                      case 3:\n                          bzero(buffer4, sizeof(buffer4));\n                          n = read(newsockfd, buffer4, sizeof(buffer4));\n                          if (n &lt; 0) errore(\"Errore lettura Socket\");\n                          b = 0;\n                          break;\n                      }\n    }\n\n\n    //comunico con gnuplot e invio i miei dati appena letti e caricati sul buffer\n    fprintf(gnuplot, \"plot '-' with lines\\n\");\n\n    for (i = 0; i &lt; NUM_POINTS; i++)\n    { \n        fprintf(gnuplot, \"%d %d\\n\", i, buffer[i]); \n    }\n    for (i = 0; i &lt; NUM_POINTS; i++)\n    { \n        fprintf(gnuplot, \"%d %d\\n\", i+256, buffer2[i]); \n    }\n    for (i = 0; i &lt; NUM_POINTS; i++)\n    { \n        fprintf(gnuplot, \"%d %d\\n\", i+512, buffer3[i]); \n    }\n    for (i = 0; i &lt; NUM_POINTS; i++)\n    { \n        fprintf(gnuplot, \"%d %d\\n\", i+768, buffer4[i]); \n    } \n    fprintf(gnuplot, \"e \\n\");\n</code></pre>\n"}, {"tags": ["c", "gcc", "linker", "ld", "linker-scripts"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1501694057, "post_id": 45466978, "comment_id": 77895042, "body": "Make <i>two</i> linker scripts and let the Makefile to handle the environment binding."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1501694457, "post_id": 45466978, "comment_id": 77895282, "body": "You could use GCC preprocessor to add <i>C</i> style preprocessor directives to your linker script. You can manually pre-process a file without GCC trying to compile it using the <code>-E</code> option. You can also call the preprocessor directly through <code>cpp</code>. An example of this can be found in this SO Answer: <a href=\"https://stackoverflow.com/a/28837410/3857942\">stackoverflow.com/a/28837410/3857942</a>  . Alternatives are to use a macro processor like <a href=\"https://www.gnu.org/software/m4/manual/m4.html\" rel=\"nofollow noreferrer\"><i>M4</i></a>"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1501698094, "post_id": 45466978, "comment_id": 77897448, "body": "you can define a symbol in ld args at link time and use it in the conditional: `       --defsym symbol=expression`"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1501698925, "post_id": 45466978, "comment_id": 77897950, "body": "@Serge : I believe this person is looking to create link time conditionals. Although --defsym symbol will define a global symbol I know of no way of doing a conditional link time comparison of that value to alter the linker scripts effects. You could use that symbol programmaticly at run time but that doesn&#39;t seem to be the question."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1501704663, "post_id": 45466978, "comment_id": 77901234, "body": "I think that in this case (did not test) the OP could define a symbol and do <code>len = mysym</code> eliminating a need for the conditional. Yes, it will put a global symbol in the symbol table as well. it worked for me in different situations though."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1501707923, "post_id": 45466978, "comment_id": 77902976, "body": "@Serge I believe LD will consider <code>len = mysym</code> as a non constant expression.Don&#39;t believe you can use  symbols for a <code>len</code> expression."}], "owner": {"reputation": 809, "user_id": 3889600, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/69eda5b79c7f2201428b83bf55d607d7?s=128&d=identicon&r=PG&f=1", "display_name": "electro", "link": "https://stackoverflow.com/users/3889600/electro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 729, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1501701434, "creation_date": 1501693552, "last_edit_date": 1501701434, "question_id": 45466978, "link": "https://stackoverflow.com/questions/45466978/using-conditional-logic-with-env-variable-in-gcc-linker-script", "title": "Using conditional logic with env variable in GCC Linker script", "body": "<p>I have a build environment variable available, let's say for differentiating 2 hardware variants: HW_VER1 </p>\n\n<p>We are using linker script in build.</p>\n\n<p>So, we want something like this.  But, of course below gives error \"invalid syntax in flags\"</p>\n\n<pre><code>MEMORY\n{\n\n   ifeq ($(HW_VER1),YES)\n      iram0_0_seg :                         org = 0x00080400, len = 0x21C00  \n   else\n      iram0_0_seg :                         org = 0x00080400, len = 0xf1C00\n   endif\n}\n</code></pre>\n\n<p>The requirement is not to use 2 linker scripts with the same exact contents, except the len value above, and let build system decide which one based on the env variable (the one with bigger len or smaller len based on the hw ver)  </p>\n"}, {"tags": ["c", "arrays", "loops"], "comments": [{"owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "edited": false, "score": 3, "creation_date": 1501692653, "post_id": 45466655, "comment_id": 77894125, "body": "Need to see some code to understand what is happening."}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 2, "creation_date": 1501692662, "post_id": 45466655, "comment_id": 77894132, "body": "You want <code>memset()</code>"}, {"owner": {"reputation": 43118, "user_id": 743214, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b6a8b09f83788aafdb5e3bc6fab539fb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Rau", "link": "https://stackoverflow.com/users/743214/christian-rau"}, "edited": false, "score": 4, "creation_date": 1501692730, "post_id": 45466655, "comment_id": 77894172, "body": "Only if that value is a single byte, though. (And of course, that&#39;s effectively a loop, too, just not one you typed yourself.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1501692837, "post_id": 45466655, "comment_id": 77894239, "body": "Based on the sketchy information you&#39;ve given us, a loop sounds exactly right.  Is there some reason you don&#39;t want to use one?"}, {"owner": {"reputation": 1390, "user_id": 1200914, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d3c21d029de13a98c973b98f28ad6867?s=128&d=identicon&r=PG", "display_name": "Learning from masters", "link": "https://stackoverflow.com/users/1200914/learning-from-masters"}, "edited": false, "score": 0, "creation_date": 1501693075, "post_id": 45466655, "comment_id": 77894398, "body": "Because I need to do the same loop an average of 80.000 times and the array can be of a total size of 10\u2077 elements. I was wondering this to avoid wasting the time."}, {"owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "edited": false, "score": 1, "creation_date": 1501693157, "post_id": 45466655, "comment_id": 77894446, "body": "If setting it takes that long it might be better to avoid the need to set it at all. How to do that, and whether it would be a good idea would depend on your specific application though"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1501693170, "post_id": 45466655, "comment_id": 77894455, "body": "How will you avoid &quot;wasting time&quot;, if you have physically to set a value of this memory anyway? Well, that&#39;s certainly sounds as an XY-problem."}, {"owner": {"reputation": 3163, "user_id": 3250340, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/vZRom.jpg?s=128&g=1", "display_name": "Antoine C.", "link": "https://stackoverflow.com/users/3250340/antoine-c"}, "edited": false, "score": 0, "creation_date": 1501693194, "post_id": 45466655, "comment_id": 77894476, "body": "Don&#39;t worry about the &quot;time waste&quot; and implement this with your loop, I wouldn&#39;t be surprised if it took only some microseconds."}, {"owner": {"reputation": 3604, "user_id": 1293320, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/46e53d5316367e80cd4572e8b8b88d95?s=128&d=identicon&r=PG", "display_name": "Lucas Holt", "link": "https://stackoverflow.com/users/1293320/lucas-holt"}, "edited": false, "score": 0, "creation_date": 1501693244, "post_id": 45466655, "comment_id": 77894507, "body": "If you&#39;re setting 1, just do memset. It&#39;s already a tuned version of what you want to do anyway as part of libc."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3604, "user_id": 1293320, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/46e53d5316367e80cd4572e8b8b88d95?s=128&d=identicon&r=PG", "display_name": "Lucas Holt", "link": "https://stackoverflow.com/users/1293320/lucas-holt"}, "edited": false, "score": 2, "creation_date": 1501693270, "post_id": 45466655, "comment_id": 77894526, "body": "@LucasHolt Won&#39;t work for doubles."}, {"owner": {"reputation": 3604, "user_id": 1293320, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/46e53d5316367e80cd4572e8b8b88d95?s=128&d=identicon&r=PG", "display_name": "Lucas Holt", "link": "https://stackoverflow.com/users/1293320/lucas-holt"}, "edited": false, "score": 0, "creation_date": 1501693297, "post_id": 45466655, "comment_id": 77894552, "body": "Good point.. hadn&#39;t noticed that."}, {"owner": {"reputation": 1390, "user_id": 1200914, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d3c21d029de13a98c973b98f28ad6867?s=128&d=identicon&r=PG", "display_name": "Learning from masters", "link": "https://stackoverflow.com/users/1200914/learning-from-masters"}, "edited": false, "score": 0, "creation_date": 1501693696, "post_id": 45466655, "comment_id": 77894825, "body": "I don&#39;t know, maybe it was just faster to copy a chunk of memory rather than summing an index and accessing to that specifically element each time. Just asking because I needed to set a continuous subset. Never thought about this."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501693842, "post_id": 45466655, "comment_id": 77894909, "body": "Maybe you better describe the underlying problem?"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 1, "creation_date": 1501693889, "post_id": 45466655, "comment_id": 77894938, "body": "May I ask why do you set it with 1 specifically?"}, {"owner": {"reputation": 1390, "user_id": 1200914, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d3c21d029de13a98c973b98f28ad6867?s=128&d=identicon&r=PG", "display_name": "Learning from masters", "link": "https://stackoverflow.com/users/1200914/learning-from-masters"}, "edited": false, "score": 0, "creation_date": 1501694037, "post_id": 45466655, "comment_id": 77895032, "body": "Eugene: Sorry but I cannot understand you. I think I explained well the problem. Is just an optimization of the process. SHG: Because my problem requires to be a value that in this moment, I consider it has to be 1.0."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501694070, "post_id": 45466655, "comment_id": 77895050, "body": "Fundamentally, if you have 100,000 doubles that you want to set to 1.0, there is no way around the fact that you are going to have to perform 100,000 assignments.  If that&#39;s the situation, a simple loop like the one you&#39;ve written is the best way.  If there&#39;s some fancy low-level optimization, a good, modern compiler will be able to employ it for you automatically, as long as you state your intentions clearly, i.e. with a nice, simple loop."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1501694202, "post_id": 45466655, "comment_id": 77895122, "body": "Sometimes, a different data structure is more appropriate.  Rather than an array, you may want to have a tree data structure of some kind, that lets you explicitly -- and compactly -- say things like &quot;cells 100001 to 200000&quot; are all 1.0&quot;.  But it won&#39;t be a simple array, and looking values up in it will be more elaborate.  So another question you have to ask yourself is, does it need to be more efficient to set M number of cells to 1.0, or to do N number of lookups later?"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1501694202, "post_id": 45466655, "comment_id": 77895124, "body": "Can&#39;t you set it with <code>0</code>s and then every time you read the value you&#39;d interpret the 0 as 1? Because if you can - problem solved and you can use memset(0)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501694362, "post_id": 45466655, "comment_id": 77895220, "body": "@Learningfrommasters I will explain you what I mean. Your original problem might sound like &quot;return a sum of 10000000 ones&quot;. Then you can think - OK, I will set 10000000 memory variables to one and sum them up. Obviously, this solution is ridiculous, but it will face the same problem as yours. I am not saying your case is ridiculous as well, but you might miss some much simpler solution to the <i>real</i> problem."}, {"owner": {"reputation": 1390, "user_id": 1200914, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d3c21d029de13a98c973b98f28ad6867?s=128&d=identicon&r=PG", "display_name": "Learning from masters", "link": "https://stackoverflow.com/users/1200914/learning-from-masters"}, "edited": false, "score": 0, "creation_date": 1501694367, "post_id": 45466655, "comment_id": 77895223, "body": "Sorry but in my problem I can&#39;t, SHG. Ok Steve, then there&#39;s nothing more here :) Just asking because sometimes, you learn things in c that are not very frequent to use and you don&#39;t know."}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 4, "creation_date": 1501694901, "post_id": 45466655, "comment_id": 77895512, "body": "If you wanted to be very fancy (and lose portability) with a solution that is somewhat similar to the <code>memset</code> solutions above, you <i>could</i> write your first double to the start of the array, then <code>memcpy</code> that 8 bytes to the location of the start of your array + 8 bytes. Now <code>memcpy</code> both doubles to the next location, so you have 4 doubles. Now <code>memcpy</code> all four doubles to the next location, so you have 8 doubles...and so on.  (It would look pretty bizarre and it probably won&#39;t be faster than a simple loop)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 0, "creation_date": 1501695330, "post_id": 45466655, "comment_id": 77895716, "body": "@struthersneil That is very cute.  You&#39;re right, it probably won&#39;t be any faster (although, actually, it might be).  But still, very cute.  I like it."}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "reply_to_user": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1501696736, "post_id": 45466655, "comment_id": 77896584, "body": "@SHG turns out it was about twice as fast on the system I tested it on. I&#39;ll drop it in as an answer for a lark."}, {"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1501696986, "post_id": 45466655, "comment_id": 77896744, "body": "You can use threads to get speed up."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501697060, "post_id": 45466655, "comment_id": 77896803, "body": "Maybe start with a large const array of double &#39;1&#39;, to save the inefficient early stages of copying small ranges?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1501697197, "post_id": 45466655, "comment_id": 77896893, "body": "..adn then chop up the array and give each clump to a thread, as suggested by @TanveerBadar ?"}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 1, "creation_date": 1501697381, "post_id": 45466655, "comment_id": 77897002, "body": "We can do this. We can <i>make this happen.</i>"}, {"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1501735799, "post_id": 45466655, "comment_id": 77910486, "body": "Although have fun multi-threading your C app. You have my blessings to proceed forward."}], "answers": [{"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1501697754, "post_id": 45468034, "comment_id": 77897234, "body": "I tried it on my machine and got about the same times (23 and 11 s).  I suggest changing <code>&lt;cstring&gt;</code> and <code>&lt;ctime&gt;</code> to <code>&lt;string.h&gt;</code> and <code>&lt;time.h&gt;</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1501697902, "post_id": 45468034, "comment_id": 77897327, "body": "But, note to OP: at this rate, the 100,000 initializations you asked about would only take about 0.14 seconds."}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501697931, "post_id": 45468034, "comment_id": 77897349, "body": "Thanks for giving it a shot!"}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501697995, "post_id": 45468034, "comment_id": 77897391, "body": "Oh yeah OP, that&#39;s why I needed to loop 500 times. You probably shouldn&#39;t worry about this unless your circumstances are pretty bizarre."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501698151, "post_id": 45468034, "comment_id": 77897488, "body": "Yikes, I didn&#39;t even notice the extra loop!  (I thought 0.14s was a little slow.)  So, correction: At this rate the 100,000 initializations you asked about would only take about 0.0003 seconds, that is, 0.3 milliseconds or 250 microseconds.  (Give or take.  YMMV.)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501698412, "post_id": 45468034, "comment_id": 77897630, "body": "Goaaarrnnn.. someone try it with two threads doing half the array each, (even better two from a pool that just need signaling, rather than creating). :)"}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 0, "creation_date": 1501698740, "post_id": 45468034, "comment_id": 77897824, "body": "Those are illustrative 8s for illustrative purposes :)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501699693, "post_id": 45468034, "comment_id": 77898397, "body": "Fair enough.  (I do that sometimes, too.)"}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 0, "creation_date": 1501701681, "post_id": 45468034, "comment_id": 77899490, "body": "Alright, I went full pedantry mode and swapped out those magic numbers. There&#39;s no tests to make sure the <code>memcpy</code> operation does nothing silly, but I&#39;ll leave that as an exercise to the reader.  Interestingly, the <code>memcpy</code> solution was about 50% slower than the simple loop solution on my old laptop. It looks like <code>memcpy</code> is subject to hardware optimizations on newer machines."}, {"owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "edited": false, "score": 0, "creation_date": 1501702086, "post_id": 45468034, "comment_id": 77899711, "body": "Come to think of it, it&#39;s probably very sensitive to cache size."}], "tags": [], "owner": {"reputation": 2662, "user_id": 2898215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRwjX.jpg?s=128&g=1", "display_name": "struthersneil", "link": "https://stackoverflow.com/users/2898215/struthersneil"}, "is_accepted": true, "score": 4, "last_activity_date": 1501702589, "last_edit_date": 1501702589, "creation_date": 1501697145, "answer_id": 45468034, "question_id": 45466655, "link": "https://stackoverflow.com/questions/45466655/can-i-avoid-a-loop-for-writing-the-same-value-in-a-continous-subset-of-an-array/45468034#45468034", "title": "Can I avoid a loop for writing the same value in a continous subset of an array?", "body": "<p>I have a somewhat tongue-in-cheek and non-portable possibility for you to consider. If you tailored your buffer to a size that is a power of 2, you could seed the buffer with a single double, then use <code>memcpy</code> to copy successively larger chunks of the buffer until the buffer is full. </p>\n\n<p>So first you copy the first 8 bytes over the next 8 bytes...(so now you have 2 doubles)</p>\n\n<p>...then you copy the first 16 bytes over the next 16 bytes...(so now you have 4 doubles)</p>\n\n<p>...then you copy the first 32 bytes over the next 32 bytes...(so now you have 8 doubles)</p>\n\n<p>...and so on.</p>\n\n<p>It's plain to see that we won't actually call <code>memcpy</code> all that many times, and if the implementation of <code>memcpy</code> is sufficiently faster than a simple loop we'll see a benefit.</p>\n\n<p>Try building and running this and tell me how it performs on your machine. It's a very scrappy proof of concept...</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid loop_buffer_init(double* buffer, int buflen, double val)\n{\n  for (int i = 0; i &lt; buflen; i++)\n  {\n    buffer[i] = val;\n  }\n}\n\nvoid memcpy_buffer_init(double* buffer, int buflen, double val)\n{\n  buffer[0] = val;\n\n  int half_buf_size = buflen * sizeof(double) / 2;\n  for (int i = sizeof(double); i &lt;= half_buf_size; i += i)\n  {\n    memcpy((unsigned char *)buffer + i, buffer, i);\n  }\n}\n\nvoid check_success(double* buffer, int buflen, double expected_val)\n{\n  for (int i = 0; i &lt; buflen; i++)\n  {\n    if (buffer[i] != expected_val)\n    {\n      printf(\"But your whacky loop failed horribly.\\n\");\n      break;\n    }\n  }\n}\n\nint main()\n{\n  const int TEST_REPS = 500;\n  const int BUFFER_SIZE = 16777216;\n  static double buffer[BUFFER_SIZE]; // 2**24 doubles, 128MB\n\n  time_t start_time;\n  time(&amp;start_time);\n  printf(\"Normal loop starting...\\n\");\n\n  for (int reps = 0; reps &lt; TEST_REPS; reps++)\n  {\n    loop_buffer_init(buffer, BUFFER_SIZE, 1.0);\n  }\n\n  time_t end_time;\n  time(&amp;end_time);\n  printf(\"Normal loop finishing after %.f seconds\\n\", \n         difftime(end_time, start_time));\n\n  time(&amp;start_time);\n  printf(\"Whacky loop starting...\\n\");\n\n  for (int reps = 0; reps &lt; TEST_REPS; reps++)\n  {\n    memcpy_buffer_init(buffer, BUFFER_SIZE, 2.5);\n  }\n\n  time(&amp;end_time);\n  printf(\"Whacky loop finishing after %.f seconds\\n\", \n         difftime(end_time, start_time));\n\n  check_success(buffer, BUFFER_SIZE, 2.5);\n}\n</code></pre>\n\n<p>On my machine, the results were:</p>\n\n<pre><code>Normal loop starting...\nNormal loop finishing after 21 seconds\nWhacky loop starting...\nWhacky loop finishing after 9 seconds\n</code></pre>\n\n<p>To work with a buffer that was less than a perfect power of 2 in size, just go as far as you can with the increasing powers of 2 and then fill out the remainder in one final <code>memcpy</code>.</p>\n\n<p>(Edit: before anyone mentions it, <em>of course</em> this is pointless with a static double (might as well initialize it at compile time) but it'll work just as well with a nice fresh stretch of memory requested at runtime.)</p>\n\n<p>It looks like this solution is <em>very sensitive to your cache size</em> or other hardware optimizations. On my old (circa 2009) laptop the <code>memcpy</code> solution is as slow or slower than the simple loop, until the buffer size drops below 1MB. Below 1MB or so the <code>memcpy</code> solution returns to being twice as fast.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1501697355, "creation_date": 1501697355, "answer_id": 45468099, "question_id": 45466655, "link": "https://stackoverflow.com/questions/45466655/can-i-avoid-a-loop-for-writing-the-same-value-in-a-continous-subset-of-an-array/45468099#45468099", "title": "Can I avoid a loop for writing the same value in a continous subset of an array?", "body": "<blockquote>\n  <p>I have a program where I repeat a succession of methods to reproduce\n  time evolution. One of the things I have to do is to write the same\n  value for a long continue subset of elements of a very large array.\n  Knowing which elements are and which value I want, is there any other\n  way rather than doing a loop for setting these values each by each?</p>\n</blockquote>\n\n<p>In principle, you can <em>initialize</em> an array however you like without using a loop.  If that array has static duration then that initialization might in fact be extremely efficient, as the initial value is stored in the executable image in one way or another.</p>\n\n<p>Otherwise, you have a few options:</p>\n\n<ul>\n<li><p>if the array elements are of a character type then you can use <code>memset()</code>.  Very likely this involves a loop internally, but you won't have one literally in your own code.</p></li>\n<li><p>if the representation of the value you want to set has all bytes equal, such as is the case for typical representations of 0 in any arithmetic type , then <code>memset()</code> is again a possibility.</p></li>\n<li><p>as you suggested, if you have another array with suitable contents then you can copy some or all of it into the target array.  For this you would use <code>memcpy()</code>, unless there is a chance that the source and destination could overlap, in which case you would want <code>memmove()</code>.</p></li>\n<li><p>more generally, you may be able to read in the data from some external source, such as a file (e.g. via <code>fread()</code>).  Don't count on any I/O-based solution to be performant, however.</p></li>\n<li><p>you can write an analog of <code>memset()</code> that is specific to the data type of the array.  Such a function would likely need to use a loop of some form internally, but you could avoid such a loop in the caller.</p></li>\n<li><p>you can write a macro that expands to the needed loop.  This can be type-generic, so you don't need different versions for different data types.  It uses a loop, but the loop would not appear literally in your source code at the point of use.</p></li>\n<li><p>If you know in advance how many elements you want to set, then in principle, you could write that many assignment statements without looping.  But I cannot imagine why you would want so badly to avoid looping that you would resort to this for a large number of elements.</p></li>\n</ul>\n\n<p>All of those except the last actually <em>do</em> loop, however -- they just avoid cluttering your code with a loop construct at the point where you want to set the array elements.  Some of them may also be clearer and more immediately understandable to human readers.</p>\n"}], "owner": {"reputation": 1390, "user_id": 1200914, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d3c21d029de13a98c973b98f28ad6867?s=128&d=identicon&r=PG", "display_name": "Learning from masters", "link": "https://stackoverflow.com/users/1200914/learning-from-masters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 45468034, "answer_count": 2, "score": 2, "last_activity_date": 1501702589, "creation_date": 1501692535, "last_edit_date": 1501692965, "question_id": 45466655, "link": "https://stackoverflow.com/questions/45466655/can-i-avoid-a-loop-for-writing-the-same-value-in-a-continous-subset-of-an-array", "title": "Can I avoid a loop for writing the same value in a continous subset of an array?", "body": "<p>I have a program where I repeat a succession of methods to reproduce time evolution. One of the things I have to do is to write the same value for a long continue subset of elements of a very large array. Knowing which elements are and which value I want, is there any other way rather than doing a loop for setting these values each by each?</p>\n\n<p>EDIT: To be clear, I want to avoid this:</p>\n\n<pre><code>double arr[10000000];\nint i;\n\nfor (i=0; i&lt;100000; ++i)    \n    arr[i] = 1;        \n</code></pre>\n\n<p>by just one single call if it is possible. Can you assign to a part of an array the values from another array of the same size? Maybe I could have in memory a second array arr2[1000000] with all elements 1 and then do something like copying the memory of arr2 to the first 100.000 elements of arr?</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1501694073, "post_id": 45466601, "comment_id": 77895054, "body": "I think you have a very valid point. The glibc macros in <code>stdint.h</code> should be e.g. <code>#define UINT16_C(c) ((uint16_t)(c))</code> and so on, whereas right now they are just <code>#define UINT16_C(c) c</code> (or <code>c # U</code>, <code>c # UL</code>, <code>c # ULL</code> for larger types). Care to file a <a href=\"https://sourceware.org/glibc/wiki/FilingBugs\" rel=\"nofollow noreferrer\">bug report</a>? It usually only takes about a year for a tested patch to be accepted, and another year or so to dribble down to Linux distributions, in my experience."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1501694426, "post_id": 45466601, "comment_id": 77895261, "body": "Could this hinge on the <i>corresponding</i> in &quot;shall expand to an integer constant expression <i>corresponding</i> to the type <code>uint_leastN_t</code>.&quot; In <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p6\" rel=\"nofollow noreferrer\">&#167;6.2.5 6</a> there is &quot;For each of the signed integer types, there is a corresponding (but different) unsigned integer type&quot;; that is, maybe a type corresponding to an unsigned integer type need not be unsigned?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1501694536, "post_id": 45466601, "comment_id": 77895313, "body": "MSVC isn&#39;t much better: <code>#define UINT16_C(x)  (x)</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1501694565, "post_id": 45466601, "comment_id": 77895329, "body": "@dbush It is intentional"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1501696138, "post_id": 45466601, "comment_id": 77896220, "body": "@NominalAnimal No, that wouldn&#39;t be valid, because that wouldn&#39;t work in <code>#if</code> expressions."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1501699082, "post_id": 45466601, "comment_id": 77898060, "body": "@hvd: Good point. That, and <a href=\"https://stackoverflow.com/a/45467680/1475978\">Keith Thompson</a>&#39;s answer below shows my original reaction was incorrect. (As usual...)"}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1501695952, "post_id": 45467275, "comment_id": 77896106, "body": "Where is your quote from? I\u2019m surprised that conversion happens for constants."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1501696199, "post_id": 45467275, "comment_id": 77896253, "body": "&#39;Each invocation of one of these macros shall expand to an integer constant expression suitable for use in #if preprocessing directives. The type of the expression shall have the same type as would an expression of the corresponding type <b>converted according to the integer promotions</b>. The value of the expression shall be that of the argument.&#39; And then it is from the integer promotion rules. I hope that is enough"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1501697082, "post_id": 45467275, "comment_id": 77896820, "body": "Yeah, that\u2019s the relevant part I was missing."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501696469, "last_edit_date": 1501696469, "creation_date": 1501694511, "answer_id": 45467275, "question_id": 45466601, "link": "https://stackoverflow.com/questions/45466601/unexpected-types-from-uint32-c-uintn-c/45467275#45467275", "title": "Unexpected types from UINT32_C, UINTN_C", "body": "<p>On the host with 16 bit <code>short</code> and 32 bit integers <code>unsigned short</code> numbers are promoted to <code>int</code>. So the those macros are defined as:</p>\n\n<pre><code>#define INT16_C(x) (x)\n#define UINT16_C(x) (x)\n</code></pre>\n\n<p>with no 'U' suffix for the <code>unsigned short</code></p>\n\n<blockquote>\n  <p>If an int can represent all values of the original type (as restricted\n  by the width, for a bit-field), the value is converted to an int;</p>\n</blockquote>\n\n<p>Those macros do only expand to the corresponding constants (or integer literals using more common language), and do not create any objects, and have to usable in the #if. So no casts are allowed. Macros do not perform any range checks as well.</p>\n\n<pre><code>int16_t x0 = 123;\nuint16_t x1 = 123;    // no sign suffix needed\nint32_t x2 = 2147483647;\nuint32_t x3 = 2147583647U;  //sign suffix theoreticaly needed as int and unsigned int have the same rank\nint64_t x4 = 9223372036854775807LL; \nuint64_t x5 = 9237372036854775807ULL; //same as above\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501696119, "post_id": 45467680, "comment_id": 77896202, "body": "The &quot;The type of the expression shall have the same type as would an expression of the corresponding type converted according to the integer promotions. &quot; certainly explains the &quot;**1&quot; of the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501696945, "post_id": 45467680, "comment_id": 77896707, "body": "... and 7.20.4p2: explains &quot;**2&quot;.  Hmmm &quot; check the parent&quot; sounds like advice of years ago."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 11, "last_activity_date": 1541889536, "last_edit_date": 1541889536, "creation_date": 1501695869, "answer_id": 45467680, "question_id": 45466601, "link": "https://stackoverflow.com/questions/45466601/unexpected-types-from-uint32-c-uintn-c/45467680#45467680", "title": "Unexpected types from UINT32_C, UINTN_C", "body": "<p>This is covered in the parent subsection, 7.20.4.</p>\n\n<p>In the portion you quoted:</p>\n\n<blockquote>\n  <p>The macro <code>UINTN_C(value)</code> shall expand to an integer constant expression corresponding to the type <code>uint_leastN_t</code>.</p>\n</blockquote>\n\n<p>it says \"<em>corresponding to</em>\", not that the expansion is actually <em>of</em> that type.  The meaning of \"<em>corresponding to</em>\" is explained in 7.20.4p3:</p>\n\n<blockquote>\n  <p>Each invocation of one of these macros shall expand to an integer\n  constant expression suitable for use in <strong><code>#if</code></strong> preprocessing directives.\n  The type of the expression shall have the same type as would an\n  expression of the corresponding type converted according to the\n  integer promotions. The value of the expression shall be that of the\n  argument.</p>\n</blockquote>\n\n<p>Since the macros are intended to be used in an <code>#if</code> directive, they cannot use casts (the preprocessor doesn't understand casts or type names).</p>\n\n<p>In practice, such a constant expression will almost always be implicitly converted to the appropriate type, so the fact that its actual type differs from what you might expect is not generally a problem.</p>\n\n<p>As for a value outside the range of <code>uint_leastN_t</code>, that's also covered in the parent subsection, in 7.20.4p2:</p>\n\n<blockquote>\n  <p>The argument in any instance of these macros shall be an unsuffixed\n  integer constant (as defined in 6.4.4.1) with a value that does not\n  exceed the limits for the corresponding type.</p>\n</blockquote>\n\n<p>This is a \"shall\" outside a constraint, so violating it causes undefined behavior.  Don't do that.</p>\n\n<p>(When reading the C standard, it's generally a good idea to check the parent subsections for wording that might clarify or override what you're reading. I've been bitten by this myself.)</p>\n"}], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 45467680, "answer_count": 2, "score": 7, "last_activity_date": 1541889536, "creation_date": 1501692370, "question_id": 45466601, "link": "https://stackoverflow.com/questions/45466601/unexpected-types-from-uint32-c-uintn-c", "title": "Unexpected types from UINT32_C, UINTN_C", "body": "<blockquote>\n  <p><strong>7.20.4.1 Macros for minimum-width integer constants</strong><br>\n  ... The macro <code>UINTN_C(value)</code> shall expand to an integer constant expression corresponding to the type <code>uint_leastN_t</code>. For example, if <code>uint_least64_t</code> is a name for the type <code>unsigned long long int</code>, then <code>UINT64_C(0x123</code>) might expand to the integer constant <code>0x123ULL</code>.  C11dr \u00a77.20.4.1 1</p>\n</blockquote>\n\n<p>The type of <code>UINTN_C()</code> and friends are not as expected.  See \"Expected\" comments in code output.</p>\n\n<p>A) Is my compiler implementation wrong and the constant type should be <code>uint_leastN_t</code>?<br>\nor<br>\nB) Should the type of constant from <code>UINTN_C(value)</code> be the minimum of <code>uint_leastN_t</code>, <code>int</code>, <code>unsigned</code> and type needed to encode the value?<br>\nor<br>\nC) something else?</p>\n\n<hr>\n\n<p>I had expected that the type of the constants to correspond to <code>uint_leastN_t</code>, but it appears to not be so under 2 conditions:</p>\n\n<p>**1 If the macro corresponding type is below <code>int/unsigned</code>, the constant is <code>int/unsigned</code></p>\n\n<p>**2 If the value exceeds the range of the <code>uint_leastN_t</code>, then the type becomes a wider type constant. </p>\n\n<blockquote>\n  <p>\u00a76.4.4.1 \"The type of an integer constant is the first of the corresponding list in which its value can be represented ... (long list follows).</p>\n</blockquote>\n\n<hr>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\n#define type_of(X) _Generic((X), \\\n  unsigned long long: \"unsigned long long\", \\\n  unsigned long: \"unsigned long\", \\\n  unsigned: \"unsigned\", \\\n  int: \"int\", \\\n  unsigned short: \"unsigned short\", \\\n  default: \"?\" \\\n  )\n\nint main() {\n  uint_least16_t u16 = 0;\n  uint_least32_t u32 = 0;\n  uint_least64_t u64 = 0;\n  printf(\"%zu %s\\n\", sizeof(u16), type_of(u16));\n  printf(\"%zu %s\\n\", sizeof(u32), type_of(u32));\n  printf(\"%zu %s\\n\", sizeof(u64), type_of(u64));\n  puts(\"\");\n  printf(\"%zu %s\\n\", sizeof((uint_least16_t) UINT16_C(0)), type_of((uint_least16_t) UINT16_C(0)));\n  printf(\"%zu %s\\n\", sizeof UINT16_C(0), type_of(UINT16_C(0)));\n  printf(\"%zu %s\\n\", sizeof UINT16_C(0x1234), type_of(UINT16_C(0x1234)));\n  printf(\"%zu %s\\n\", sizeof UINT16_C(0x12345), type_of(UINT16_C(0x12345)));\n  printf(\"%zu %s\\n\", sizeof UINT32_C(0x12345678), type_of(UINT32_C(0x12345678)));\n  printf(\"%zu %s\\n\", sizeof UINT32_C(0x123456789), type_of(UINT32_C(0x123456789)));\n  return 0;\n\n  //round_frac_test(-2.05446162500000000e+06, 205);\n  round_frac_test(fp_rand(), 6);\n  round_frac_tests(10000);\n  puts(\"Done\");\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>2 unsigned short\n4 unsigned\n8 unsigned long long\n\n2 unsigned short\n4 int       // Expected 2 unsigned short, see **1\n4 int       // Expected 2 unsigned short, see **1\n4 int       // Expected 2 unsigned short, see **2\n4 unsigned\n8 unsigned long long  // Expected 4 unsigned, see **2\n</code></pre>\n\n<p>I am using (GNU C11 (GCC) version 5.4.0) </p>\n\n<p>In forming this post, I am leaning toward B, yet I am looking for your rational for confirmation -one way of the other.   If B is so, a disappointing part is that <code>UINTN_C()</code> could result in a <em>signed</em> type.</p>\n\n<p>I suppose that is what the \"minimum-width\" part is about.</p>\n"}, {"tags": ["c", "ptrace"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 3, "creation_date": 1501692454, "post_id": 45466519, "comment_id": 77894009, "body": "&quot;program have a few calls to sleep() to give me time to attach&quot; - suggestion: instead of <code>sleep</code> for some arbitrary time which you then hope is enough to attach yet not long enough to be annoying, why don&#39;t you just put in a call of <code>raise(SIGSTOP)</code>? Then you application will stop at the point you want and you can attach a debugger (or whatever you like) and then send the program a <code>SIGCONT</code> to continue (<code>kill -CONT &lt;pid&gt;</code>) when you are ready.."}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1501692749, "post_id": 45466519, "comment_id": 77894186, "body": "Great question. The reason is because I want to apply this to arbitrary processes after I get done with this toy example. In those cases, I may not have the source to be able to add that call in."}, {"owner": {"reputation": 218, "user_id": 2946062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05de1b7d2101dbf786bf65557ee212ed?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/2946062/howard"}, "edited": false, "score": 1, "creation_date": 1501693195, "post_id": 45466519, "comment_id": 77894477, "body": "Do you have proper permissions to <code>strace</code> your program or use <code>gdb</code>? The man page for <code>ptrace</code> indicates that <code>PTRACE_ATTACH</code> performs a check for <code>PTRACE_MODE_ATTACH_REALCREDS</code> access mode before attaching"}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "edited": false, "score": 0, "creation_date": 1501693743, "post_id": 45466519, "comment_id": 77894853, "body": "Crap! Looks like I was missing a parameter in the ptrace call. The second parameter should be the pid, not the address. Now I am getting an EIO error, which is progress-- probably happening because I am not aligned on a word."}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "reply_to_user": {"reputation": 218, "user_id": 2946062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05de1b7d2101dbf786bf65557ee212ed?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/2946062/howard"}, "edited": false, "score": 0, "creation_date": 1501695976, "post_id": 45466519, "comment_id": 77896124, "body": "Looking at this further, I&#39;m not sure why I&#39;m getting EIO. The memory is mapped (smaps reports both rss and pss for the sections), and I am starting on a page aligned boundary. @Howard, I am able to strace the process."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1501696330, "post_id": 45466519, "comment_id": 77896338, "body": "I guess you should update the question with the current state of the problem."}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "edited": false, "score": 0, "creation_date": 1501697230, "post_id": 45466519, "comment_id": 77896910, "body": "Question updated"}, {"owner": {"reputation": 218, "user_id": 2946062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05de1b7d2101dbf786bf65557ee212ed?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/2946062/howard"}, "edited": false, "score": 0, "creation_date": 1501701557, "post_id": 45466519, "comment_id": 77899431, "body": "I&#39;d be interested in whether using <code>ptrace(PTRACE_SEIZE, pid, 0, PTRACE_O_flags);</code> makes any difference in attaching. Note this doesn&#39;t send a <code>SIGSTOP</code> to the process, but may allow you to actually attach given that you are running a kernel &gt;= 3.4"}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "edited": false, "score": 0, "creation_date": 1501705452, "post_id": 45466519, "comment_id": 77901649, "body": "I changed it to a PTRACE_SEIZE with PTRACE_O_SYSGOOD, and then sent a PTRACE_INTERRUPT. For some reason, it doesn&#39;t seem to get the interrupt. I see the &quot;sleeping 200...&quot; message from the library, but then my tracer never stops the process. The process eventually continues and then ends normally."}, {"owner": {"reputation": 218, "user_id": 2946062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05de1b7d2101dbf786bf65557ee212ed?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/2946062/howard"}, "edited": false, "score": 0, "creation_date": 1501781791, "post_id": 45466519, "comment_id": 77943428, "body": "This is just conjecture, so take it with a grain of salt. I suspect that your tracee process is already suspended (via the sleep) before you are attaching. As an alternative try changing your tracer program to <code>fork()</code> and attach the child process before launching the tracee via <code>execve()</code>. That should eliminate the need for the <code>sleep()</code>"}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "edited": false, "score": 0, "creation_date": 1501790064, "post_id": 45466519, "comment_id": 77948309, "body": "Agreed, this is probably the cause. I&#39;m curious, though, how would one attach to a running process and examine memory if this doesn&#39;t work? My goal was to eventually try to grab on to existing processes rather than ones that I am starting myself."}, {"owner": {"reputation": 218, "user_id": 2946062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05de1b7d2101dbf786bf65557ee212ed?s=128&d=identicon&r=PG&f=1", "display_name": "Howard", "link": "https://stackoverflow.com/users/2946062/howard"}, "edited": false, "score": 0, "creation_date": 1501853251, "post_id": 45466519, "comment_id": 77976857, "body": "I think it might be simply because you are using the <code>sleep()</code> command in your tracee program. For instance, you could have just as easily used the <code>cat</code> command with no parameters to test your attach/read/write/etc functionality with ptrace. When <code>cat</code> receives no arguments it simply waits for user input via <code>stdin</code>, and thus is blocked until EOF. If you don&#39;t like that option, try replacing your sleep call with something akin to <code>read(0, buffer, 1);</code>"}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "edited": false, "score": 0, "creation_date": 1501872220, "post_id": 45466519, "comment_id": 77988256, "body": "Great test cases! I&#39;ll give cat a try first and report back :)"}], "owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1501697205, "creation_date": 1501692091, "last_edit_date": 1501697205, "question_id": 45466519, "link": "https://stackoverflow.com/questions/45466519/why-is-my-ptrace-failing", "title": "Why is my ptrace failing?", "body": "<p>I am playing with ptrace. I have one simple program that loads up a shared library I built and then calls two functions in it. Both the shared library and the main program have a few calls to sleep() to give me time to attach.</p>\n\n<p>When the program runs, I cat /proc/[pid]/maps to figure out where the shared object's memory is. I want to dump the contents of the loaded text section (or any other section of my choosing.</p>\n\n<p>In the ptrace program, I attach, wait for a stop, and then attempt to PTRACE_PEEKDATA to read the memory. [Fixed by update below] The problem is, I am always getting an EIO error. Why is this happening? The process clearly exists, and if I ps it, I can see it in a 't' state-- being stopped by the trace.</p>\n\n<p>Update: ESRCH error fixed (was missing parameters in ptrace call). I am now getting an EIO error instead whenever it tries to read. Why is this happening? The call to ptrace(PTRACE_PEEKDATA...) seems correct and the memory addresses are on page aligned boundaries. </p>\n\n<p>Main program (to be traced). Compile with -ldl</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\ntypedef int (*Add_t)(int, int);\ntypedef int (*Mul_t)(int, int);\n\n#define LIB_PATH \"./libmylib.so\"\n\nint main()\n{\n    void *pHandle = NULL;\n    Mul_t pfnMultiply = NULL;\n    Add_t pfnAdd = NULL;\n    int a = 5, b = 10;\n    int i=0;\n\n    printf(\"My pid: %u\\n\", getpid());\n\n    pHandle = dlopen(LIB_PATH, RTLD_NOW);\n\n    if (pHandle == NULL)\n    {\n        printf(\"Did not find library!\\n\");\n        return -1;\n    }\n\n    pfnMultiply = dlsym(pHandle, \"Mul\");\n    if (pfnMultiply == NULL)\n    {\n        printf(\"Could not find multiply symbol\");\n        return -1;\n    }\n\n    pfnAdd = dlsym(pHandle, \"Add\");\n    if (pfnAdd == NULL)\n    {\n        printf(\"Could not find add symbol\");\n        return -1;\n    }\n\n    printf(\"add function address: %p, function pointer address: %x\\n\", pfnAdd, &amp;pfnAdd);\n    printf(\"mul function address: %p, function pointer address: %x\\n\", pfnMultiply, &amp;pfnMultiply);\n\n    printf(\"a + b = %d\\n\", pfnAdd(a, b));\n    printf(\"a * b = %d\\n\", pfnMultiply(a, b));\n\n    fflush(stdout);\n\n    for (i=0; i &lt; 120; i++)\n    {\n        if (i % 10 == 0) { printf(\"sleeping: %d of %d\\n\", i, 120); }\n        fflush(stdout);\n        sleep(1);\n    }\n\n    printf(\"done!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Library. Compile with -shared -fPIC </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n#include &lt;unistd.h&gt;\n\nvolatile void *pFunc = 0xAAAAAAAA;\nvolatile void *pFunc2 = 0xBBBBBBBB;\n\nint Add(int a, int b)\n{\n    printf(\"sleeping 200...\\n\");\n    sleep(200);\n    return a + b;\n}\n\nint Mul(int a, int b)\n{\n    return a*b;\n}\n</code></pre>\n\n<p>Tracer</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/ptrace.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc, char **argv)\n{\n    unsigned int pid = (unsigned int)atoi(argv[1]);\n    unsigned long long searchStart = strtoull(argv[2], NULL, 16);\n    long long searchEnd = strtoull(argv[3], NULL, 16);\n    long long pos = searchStart;\n    int status = 0;\n\n\n\n    printf(\"Attaching to pid: %d\\n\", pid);\n\n    if (ptrace(PTRACE_ATTACH, pid, NULL, NULL) == -1)\n    {\n        printf(\"Ptrace attach failed. Error: %s\\n\", strerror(errno));\n        return -1;\n    }\n    printf(\"Attached\\n\");\n\n    printf(\"Waiting for pid to stop\\n\");\n    while (1)\n    {\n        if (waitpid(pid, &amp;status, 0) == -1)\n        {\n            printf(\"Waitpid failed. Error: %s\\n\", strerror(errno));\n            return -1;\n        }\n\n        if (WIFSTOPPED(status))\n        {\n            printf(\"stopped...\\n\");\n            if (WSTOPSIG(status) == SIGSTOP)\n            {\n                printf(\"Got SIGSTOP\\n\");\n                break;\n            }\n            else\n            {\n                printf(\"Did not get SIGSTOP\");\n                ptrace(PTRACE_CONT, pid, 0, WSTOPSIG(status));\n            }\n        }\n    }\n\n    printf(\"Process stopped\\n\");\n\n    unsigned long long value = 0;\n\n    printf(\"Looking at pos: %llx\\n\", pos);\n    value = ptrace(PTRACE_PEEKDATA, pid, (void *)&amp;pos, NULL);\n    if (value = -1)\n    { \n        printf(\"Error reading data\\n\"); \n    }\n    else\n    {\n        printf(\"Value: %llu\\n\", value);\n    }\n\n    for (pos; pos &lt; searchEnd; pos++) \n    {\n        long value = 0;\n        errno = 0;\n        value = ptrace(PTRACE_PEEKDATA, pid, (void *)&amp;pos, NULL);\n\n        if (errno != 0 &amp;&amp; value == -1)\n        {\n            switch(errno)\n            {\n                case EBUSY:\n                    printf(\"EBUSY\\n\");\n                    break;\n                case EFAULT:\n                    printf(\"EFAULT\\n\");\n                    break;\n                case EINVAL:\n                    printf(\"EINVAL\\n\");\n                    break;\n                case EIO:\n                    printf(\"EIO\\n\");\n                    break;\n                case EPERM:\n                    printf(\"EPERM\\n\");\n                    break;\n                case ESRCH:\n                    printf(\"ESRCH\\n\");\n                    break;\n            }\n            printf(\"Error: %s\\n\", strerror(errno));\n            break;\n        }\n\n        if (value != 0 &amp;&amp; value != 0xffffffffffffffff)\n        {\n            printf(\"%llx: %llx\\n\", pos, value);\n        }\n    }\n\n    printf(\"done\\n\");\n\n    sleep(800);\n    return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>user@machine:~/projects/scratch/x86$ ./call\nMy pid: 30776\nadd function address: 0x7f371292a805, function pointer address: e87569e8\nmul function address: 0x7f371292a862, function pointer address: e87569e0\nMe: 0x7f371292a805\nsleeping 200...\na + b = 15\na * b = 50\nsleeping: 0 of 120\nsleeping: 10 of 120\nsleeping: 20 of 120\nsleeping: 30 of 120\nsleeping: 40 of 120\nsleeping: 50 of 120\nsleeping: 60 of 120\nsleeping: 70 of 120\nsleeping: 80 of 120\nsleeping: 90 of 120\nsleeping: 100 of 120\nsleeping: 110 of 120\ndone!\n\nWhile that program is running...\n\nuser@machine:~/projects/scratch$ cat /proc/30776/maps | grep lib\n7f371292a000-7f371292b000 r-xp 00000000 00:5c 14136507                   /home/user/projects/scratch/x86/libmylib.so\n7f371292b000-7f3712b2a000 ---p 00001000 00:5c 14136507                   /home/user/projects/scratch/x86/libmylib.so\n7f3712b2a000-7f3712b2b000 r--p 00000000 00:5c 14136507                   /home/user/projects/scratch/x86/libmylib.so\n7f3712b2b000-7f3712b2c000 rw-p 00001000 00:5c 14136507                   /home/user/projects/scratch/x86/libmylib.so\n7f3712b2c000-7f3712ce7000 r-xp 00000000 08:01 4200143                    /lib/x86_64-linux-gnu/libc-2.19.so\n7f3712ce7000-7f3712ee7000 ---p 001bb000 08:01 4200143                    /lib/x86_64-linux-gnu/libc-2.19.so\n7f3712ee7000-7f3712eeb000 r--p 001bb000 08:01 4200143                    /lib/x86_64-linux-gnu/libc-2.19.so\n7f3712eeb000-7f3712eed000 rw-p 001bf000 08:01 4200143                    /lib/x86_64-linux-gnu/libc-2.19.so\n7f3712ef2000-7f3712ef5000 r-xp 00000000 08:01 4200131                    /lib/x86_64-linux-gnu/libdl-2.19.so\n7f3712ef5000-7f37130f4000 ---p 00003000 08:01 4200131                    /lib/x86_64-linux-gnu/libdl-2.19.so\n7f37130f4000-7f37130f5000 r--p 00002000 08:01 4200131                    /lib/x86_64-linux-gnu/libdl-2.19.so\n7f37130f5000-7f37130f6000 rw-p 00003000 08:01 4200131                    /lib/x86_64-linux-gnu/libdl-2.19.so\n7f37130f6000-7f3713119000 r-xp 00000000 08:01 4200137                    /lib/x86_64-linux-gnu/ld-2.19.so\n7f3713318000-7f3713319000 r--p 00022000 08:01 4200137                    /lib/x86_64-linux-gnu/ld-2.19.so\n7f3713319000-7f371331a000 rw-p 00023000 08:01 4200137                    /lib/x86_64-linux-gnu/ld-2.19.so\n\n\nuser@machine:~/projects/scratch$ ./trace 30776 0x7f371292a000 0x7f371292b000\nAttaching to pid: 30776\nPtrace attach failed. Error: Operation not permitted\nuser@machine:~/projects/scratch$ sudo bash\nroot@machine:~/projects/scratch# ./trace 30776 0x7f371292a000 0x7f371292b000\nAttaching to pid: 30776\nAttached\nWaiting for pid to stop\nstopped...\nGot SIGSTOP\nProcess stopped\nLooking at pos: 7f371292a000\nValue: 0\nESRCH\nError: No such process\ndone\n</code></pre>\n"}, {"tags": ["c", "heap", "pebble-watch", "heap-corruption", "cloudpebble"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1501690435, "post_id": 45465913, "comment_id": 77892788, "body": "<code>toString()</code> allocates excactly as many bytes as it uses so there&#39;s simply no extra space for anything to append by <code>strcat()</code>. You could use <code>realloc()</code>  to increase the size of <code>lvl</code> and in the end you have to <code>free()</code> it to avoid a memory leak"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1501690625, "post_id": 45465913, "comment_id": 77892917, "body": "btw. the second parameter <code>char *result</code> of <code>toString()</code> makes no sense at all, as you&#39;re doing <code>result = calloc( ... );</code>."}, {"owner": {"reputation": 175, "user_id": 8185682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4H1F.png?s=128&g=1", "display_name": "Stephen P", "link": "https://stackoverflow.com/users/8185682/stephen-p"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1501690659, "post_id": 45465913, "comment_id": 77892935, "body": "@squeamishossifrage The number 6 accounts for 3 digits, the %, the \\0, and one for just in case."}, {"owner": {"reputation": 175, "user_id": 8185682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4H1F.png?s=128&g=1", "display_name": "Stephen P", "link": "https://stackoverflow.com/users/8185682/stephen-p"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1501691604, "post_id": 45465913, "comment_id": 77893480, "body": "@IngoLeonhardt Ah, ok. Also, the second parameter does make little sense, but I included because when I tried compiling without the second parameter, it would give an error (or maybe it was a warning) about how it was returning a private variable."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8185682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4H1F.png?s=128&g=1", "display_name": "Stephen P", "link": "https://stackoverflow.com/users/8185682/stephen-p"}, "edited": false, "score": 0, "creation_date": 1501694101, "post_id": 45465983, "comment_id": 77895074, "body": "This would work, but unfortunately sprintf isn&#39;t supported by the Pebble SDK for some reason."}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 3, "last_activity_date": 1501691233, "last_edit_date": 1501691233, "creation_date": 1501690438, "answer_id": 45465983, "question_id": 45465913, "link": "https://stackoverflow.com/questions/45465913/pebble-heap-corruption-with-strncat/45465983#45465983", "title": "Pebble Heap Corruption With Str(n)cat", "body": "<p>You're allocating memory for <code>lvl</code> twice - once in <code>battery_update_proc</code> and then again in <code>toString</code>. It's the second time that is the issue as it's allocating only enough space for the digits.</p>\n\n<p>And you're then not <code>free</code>ing either chunk of memory, so you've got a memory leak too.</p>\n\n<p>As to how to fix it, why not just replace the call to <code>toString</code> with <code>sprintf(lvl,\"%d%%\",s_battery_level)</code> and then remember to call <code>free(lvl)</code> at the end of the function.</p>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 8185682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4H1F.png?s=128&g=1", "display_name": "Stephen P", "link": "https://stackoverflow.com/users/8185682/stephen-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1501694984, "creation_date": 1501694984, "answer_id": 45467416, "question_id": 45465913, "link": "https://stackoverflow.com/questions/45465913/pebble-heap-corruption-with-strncat/45467416#45467416", "title": "Pebble Heap Corruption With Str(n)cat", "body": "<p>The eventual answer to the question is that I had to modify toString to add extra space in the calloc() call. Thanks to everyone who reminded me of that technicality!</p>\n"}], "owner": {"reputation": 175, "user_id": 8185682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4H1F.png?s=128&g=1", "display_name": "Stephen P", "link": "https://stackoverflow.com/users/8185682/stephen-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 45465983, "answer_count": 2, "score": 0, "last_activity_date": 1501694984, "creation_date": 1501690209, "question_id": 45465913, "link": "https://stackoverflow.com/questions/45465913/pebble-heap-corruption-with-strncat", "title": "Pebble Heap Corruption With Str(n)cat", "body": "<p>When updating my battery display for my Pebble watchface, I get the battery level into int s_battery_level, run it through my toString function (which works 100% of the time, I've tested it), and then append a % and a null terminator, just for good measure. However, for some reason, when that line is run, I get a heap corruption error when the battery drops from 100% to 90% (or 100 to any lower-digit number). I've tried removing/adding in the null terminator, used both strcat() and strncat(), even escaping the %, and nothing has seemed to work. Once I remove the offending line, it works perfectly.</p>\n\n<p>Why is this line corrupting the heap? And optionally, how could I fix/avoid it?</p>\n\n<pre><code>static void battery_update_proc(Layer *layer, GContext *ctx) {\n  graphics_context_set_text_color(ctx, TxtColor);\n  char * lvl = calloc(6,sizeof(char));\n  lvl = toString(s_battery_level, lvl);\n  //strncat(lvl, \"%\\0\", 2);\n  //offending line above ^\n  APP_LOG(APP_LOG_LEVEL_DEBUG, \"%s\", lvl);\n  graphics_draw_text(ctx, lvl, s_txt_font, GRect(bound.origin.x + ROUND_OFFSET_BA_X, bound.size.h * .5 + ROUND_OFFSET_BA_Y, bound.size.w, 24), GTextOverflowModeWordWrap, GTextAlignmentCenter, NULL);\n}\n</code></pre>\n\n<p>And for good measure, here is the toString function:</p>\n\n<pre><code>char * toString(int value, char * result) {\n    int digit = digits(value);\n    result = calloc(digit + 1, sizeof(char));\n    result[digit] = '\\0';\n    int usedVal = 0;\n    for (int i = digit; i &gt; 0; i--)\n    {\n        int x = (value - usedVal) / pwrOf10(i - 1);\n        result[digit - i] = (char) x + '0';\n        usedVal = usedVal + (result[digit - i] - '0') * pwrOf10(i - 1);\n    }\n    return result;\n}\n\nint digits(int n) {\n    if (n &lt; 0) return digits((n == 0) ? 9999 : -n);\n    if (n &lt; 10) return 1;\n    return 1 + digits(n / 10);\n}\n\nint pwrOf10(int power) {\n    int val = 1;\n    int i = power;\n    while (i &gt; 0)\n    {\n        val *= 10;\n        i--;\n    }\nreturn val;\n}\n</code></pre>\n"}, {"tags": ["c", "meson-build"], "answers": [{"tags": [], "owner": {"reputation": 3439, "user_id": 640650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52033010f0d68daf062ecfe801d98693?s=128&d=identicon&r=PG", "display_name": "Yasushi Shoji", "link": "https://stackoverflow.com/users/640650/yasushi-shoji"}, "is_accepted": true, "score": 2, "last_activity_date": 1501741775, "creation_date": 1501741775, "answer_id": 45476500, "question_id": 45465892, "link": "https://stackoverflow.com/questions/45465892/how-to-use-openmp-in-a-c-project-built-with-meson/45476500#45476500", "title": "How to use OpenMP in a C project built with meson", "body": "<p>You need another keyword arg <code>link_args : '-fopenmp'</code> for <code>executable()</code>.</p>\n\n<pre><code>exe = executable('some_exe', 'src/main.c', c_args: '-fopenmp', link_args : '-fopenmp')\n</code></pre>\n\n<p>Meson builds C program in two phases, compiling and linking.  You can pass extra arguments with <code>c_args</code> for compiling and <code>link_args</code> for linking.</p>\n\n<p>The option <code>-fopenmp</code> enables OpenMP directives while compiling, and</p>\n\n<blockquote>\n  <p><a href=\"https://gcc.gnu.org/onlinedocs/libgomp/Enabling-OpenMP.html\" rel=\"nofollow noreferrer\">the flag also arranges for automatic linking of the OpenMP runtime\n  library</a>.</p>\n</blockquote>\n\n<p>That is, <code>-fopenmp</code> is dual purpose option.</p>\n\n<p>Now, the above is simple and good.  Once you understand it, however, you can also compile your program with <code>-fopenmp</code> to activate the OpenMP directives and link the OpenMP libraries by yourself <strong>without</strong> <code>-fopenmp</code> to the <code>link_args</code>.</p>\n\n<p>Here is a complete <code>meson.build</code>:</p>\n\n<pre><code>project('openmp_with_meson', 'c')\n\ncc = meson.get_compiler('c')\nlibgomp = cc.find_library('gomp')\n\nexe = executable('some_exe', 'src/main.c',\n         c_args: '-fopenmp',\n         dependencies : libgomp)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": false, "score": 1, "last_activity_date": 1593534664, "creation_date": 1593534664, "answer_id": 62662041, "question_id": 45465892, "link": "https://stackoverflow.com/questions/45465892/how-to-use-openmp-in-a-c-project-built-with-meson/62662041#62662041", "title": "How to use OpenMP in a C project built with meson", "body": "<p>Meson &gt;= <code>0.46</code> now has a builtin for this (<a href=\"https://mesonbuild.com/Release-notes-for-0-46-0.html#addition-of-openmp-dependency\" rel=\"nofollow noreferrer\">docs</a>):</p>\n<pre class=\"lang-py prettyprint-override\"><code>openmp = dependency('openmp') # meson builtin\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5829566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3f64ce7d12d8cb988da745174c04a2?s=128&d=identicon&r=PG&f=1", "display_name": "Kantenkopp", "link": "https://stackoverflow.com/users/5829566/kantenkopp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 45476500, "answer_count": 2, "score": 1, "last_activity_date": 1593534664, "creation_date": 1501690152, "question_id": 45465892, "link": "https://stackoverflow.com/questions/45465892/how-to-use-openmp-in-a-c-project-built-with-meson", "title": "How to use OpenMP in a C project built with meson", "body": "<p>I am quite new to meson and C, please forgive me if the answer to this question is trivial ...</p>\n\n<p>I want to use OpenMP in a C project, and I am using meson as a build tool.<br>\nI want to compile the <code>parallel for</code> example from this <a href=\"https://computing.llnl.gov/tutorials/openMP/#SECTIONS\" rel=\"nofollow noreferrer\">tutorial</a>.\nMy <code>main.c</code> looks very similar:\n</p>\n\n<pre><code>#include &lt;omp.h&gt;\n#define N       1000\n#define CHUNKSIZE   100\n\nint main(int argc, char *argv[]) {\n\n  int i, chunk;\n  float a[N], b[N], c[N];\n\n  /* Some initializations */\n  for (i=0; i &lt; N; i++)\n    a[i] = b[i] = i * 1.0;\n  chunk = CHUNKSIZE;\n\n#pragma omp parallel for      \\\n  shared(a,b,c,chunk) private(i)  \\\n  schedule(static,chunk)\n  for (i=0; i &lt; N; i++)\n    c[i] = a[i] + b[i];\n\n  return 0;\n}\n</code></pre>\n\n<p>My short <code>meson.build</code> file contains this:</p>\n\n<pre><code>project('openmp_with_meson', 'c')\n\n# add_project_arguments('-fopenmp', language: 'c')\n\nexe = executable('some_exe', 'src/main.c') #, c_args: '-fopenmp')\n</code></pre>\n\n<p>I commented out the <code>c_args</code> keyword in the call to <code>executable</code> here.<br>\nNow I end up with the following scenarios:</p>\n\n<ul>\n<li>without <code>'-fopenmp'</code> option, I get the warning, that the <code>pragma</code> is unknown and will be ignored (as I would expect): <code>../src/main.c:15:0: warning: ignoring pragma omp parallel [-Wunknown-pragmas] #pragma omp parallel for</code></li>\n<li>with the option <code>c_args: '-fopenmp'</code> inserted, I do not get the above warning anymore, instead I get errors for undefined references to <code>GOMP_parallel</code>, <code>omp_get_num_threads</code> and <code>omp_get_thread_num</code>, and nothing gets built  </li>\n<li>when I use gcc manually with <code>gcc -Wall -o manually_with_gcc ../src/main.c -fopenmp</code> the program compiles and executes without any errors.</li>\n</ul>\n\n<p>Can anyone tell me how to get the executable to compile with meson?</p>\n"}, {"tags": ["c", "linux", "pthreads", "privileges", "linux-capabilities"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8406571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b515378ee1195cc5ce82ea67cfdad7dc?s=128&d=identicon&r=PG&f=1", "display_name": "gees", "link": "https://stackoverflow.com/users/8406571/gees"}, "edited": false, "score": 0, "creation_date": 1501742465, "post_id": 45467554, "comment_id": 77913660, "body": "Thank you Florian for the answer. I also assume that pthread_setname_np tries to write to /proc/PID/comm if it is not the thread where the program is running. What do you recommend me for a solution. Is it easy to write directly to  /proc/self/task/TID/comm..? So kind of write my own pthread_setname function."}, {"owner": {"reputation": 13, "user_id": 8406571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b515378ee1195cc5ce82ea67cfdad7dc?s=128&d=identicon&r=PG&f=1", "display_name": "gees", "link": "https://stackoverflow.com/users/8406571/gees"}, "edited": false, "score": 0, "creation_date": 1502715988, "post_id": 45467554, "comment_id": 78307877, "body": "So in my final solution I give the thread name as parameter to the function invoked in pthread_create and call in this function pthread_setname_np to set the name. Because setting the name is only allowed in the own thread as described by Florian."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": true, "score": 1, "last_activity_date": 1501695462, "creation_date": 1501695462, "answer_id": 45467554, "question_id": 45465854, "link": "https://stackoverflow.com/questions/45465854/pthread-setname-np-when-capabilities-are-set/45467554#45467554", "title": "pthread_setname_np() when capabilities are set", "body": "<p>Setting a file system capability is in many ways just like making the program SUID/SGID.  In this <code>AT_SECURE == 1</code> execution mode, the kernel restricts what the original user can do with the process.  Potentially invasive actions, such as using <code>ptrace</code> to attach the the process or access to the process via <code>/proc</code>, are blocked by the kernel so that the user cannot use the program to escalate their privileges.  (glibc and other libraries disable some functionality for security reasons, too.)  Normally, these restrictions only apply to processes owned by <em>different</em> user IDs, but with capabilities (and SELinux contexts), a mere user ID comparison is no longer necessary to detect the crossing of a trust boundary.</p>\n\n<p>In glibc, <code>pthread_setname_np</code> for a thread distinct from the current thread is implemented by writing to the <code>/proc/self/task/TID/comm</code> file, so it runs into these restrictions.  The kernel could conceivable implement an exception for this kind of self-modification of a task which shares the same address space, but it seems that this is not implemented, hence the failure.  And I can't really blame the kernel people because it's difficult to get such matters correct, not introducing any vulnerabilities.</p>\n"}], "owner": {"reputation": 13, "user_id": 8406571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b515378ee1195cc5ce82ea67cfdad7dc?s=128&d=identicon&r=PG&f=1", "display_name": "gees", "link": "https://stackoverflow.com/users/8406571/gees"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 45467554, "answer_count": 1, "score": 1, "last_activity_date": 1501695462, "creation_date": 1501690023, "question_id": 45465854, "link": "https://stackoverflow.com/questions/45465854/pthread-setname-np-when-capabilities-are-set", "title": "pthread_setname_np() when capabilities are set", "body": "<p>I compiled the example program from man <a href=\"http://man7.org/linux/man-pages/man3/pthread_setname_np.3.html\" rel=\"nofollow noreferrer\">pthread_setname_np</a> with </p>\n\n<pre><code>g++ -pthread  example.cpp\n</code></pre>\n\n<p>And I set the cap_net_raw capability of my program a.out. </p>\n\n<pre><code>sudo setcap 'cap_net_raw=+eip' a.out\n</code></pre>\n\n<p>Surprisingly the program fails when executing:</p>\n\n<pre><code>$./a.out\nCreated a thread. Default name is: a.out\npthread_setname_np: Permission denied\n</code></pre>\n\n<p>when I remove the capabilities it works..</p>\n\n<pre><code>$sudo setcap 'cap_net_raw=-eip' a.out\n$./a.out\nCreated a thread. Default name is: a.out\nThe thread name after setting it is THREADFOO.\nDone\n</code></pre>\n\n<p>So for me it looks like I have less privileges when I add a capability. Can anybody explain this?</p>\n\n<p>Thanky you for your response ;-)</p>\n\n<p>Some additional info:</p>\n\n<ul>\n<li>Capabilities are supported on my target I checked it with the ping command and CAP_NET_RAW</li>\n<li>Kernel 4.4.32-rt43</li>\n<li>RFS: ext4</li>\n<li>I reduced the post to the example program I agree it makes no sense to add the CAP_NET_RAW to this program.</li>\n<li>It would work if I add the CAP_DAC_OVERRIDE but I want to avoid that.</li>\n</ul>\n"}, {"tags": ["c", "arrays", "loops", "for-loop", "while-loop"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1501685199, "post_id": 45464018, "comment_id": 77888847, "body": "You can&#39;t replace two array elements with one. What will happen to the extra space?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1501685273, "post_id": 45464018, "comment_id": 77888912, "body": "<code>a[j]=&#39;\\0&#39;;</code> Why do this."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1501685346, "post_id": 45464018, "comment_id": 77888963, "body": "Take a debugger and step through the code. You will learn a lot!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1501685363, "post_id": 45464018, "comment_id": 77888971, "body": "Don&#39;twrite<code>while(i&lt;strlen(a)-1)</code>do<code>for(int i=0;a[i]!=&#39;\\0&#39;&amp;&amp;a[i+1]!=&#39;\\0&#39;;++i)</code>instead. And use more white space because your code is as my previous statement VERY UNPLEASANT TO READ."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501686553, "post_id": 45464018, "comment_id": 77889913, "body": "fix like <a href=\"http://ideone.com/XFo0ro\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501687120, "post_id": 45464018, "comment_id": 77890373, "body": "&quot;there is no output.&quot; because <code>i==strlen(a)</code> is not true.  <code>i==strlen(a)</code> is not true due to <code>a[j]=&#39;\\0&#39;;</code> shorten the string after <code>i</code> was computed."}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501688036, "post_id": 45464884, "comment_id": 77891074, "body": "@BLUEPIXY not sure what exactly you&#39;ve spotted, but I did realise I forgot to skip over the matched &#39;b&#39;"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501688101, "post_id": 45464884, "comment_id": 77891135, "body": "It still has a mistake."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501688482, "post_id": 45464884, "comment_id": 77891428, "body": "@BLUEPIXY it&#39;s probably not perfect, but it now does what the OP is asking"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1501688552, "post_id": 45464884, "comment_id": 77891487, "body": "<code>(a[i]!=&#39;\\0&#39;)||(a[i+1]!=&#39;\\0&#39;)</code> is definitely bad."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501688577, "post_id": 45464884, "comment_id": 77891509, "body": "You are going to skip the last character"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501688899, "post_id": 45464884, "comment_id": 77891745, "body": "@AjayBrahmakshatriya I&#39;ve compiled and tested the code and it definitely doesn&#39;t skip the last character"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1501689314, "post_id": 45464884, "comment_id": 77892035, "body": "<code>(a[i]!=&#39;\\0&#39;)||((a[i])&amp;&amp;(a[i+1]!=&#39;\\0&#39;))</code> is the same as <code>a[i] || (a[i] &amp;&amp; a[i+1])</code>. that doesn&#39;t make sense. Should be <code>a[i] &amp;&amp; a[i+1]</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501689334, "post_id": 45464884, "comment_id": 77892053, "body": "BTW <code>||((a[i])&amp;&amp;(a[i+1]!=&#39;\\0&#39;))</code> : This has no meaning. So you can delete it. (The meaning does not change even if deleted)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1501689510, "post_id": 45464884, "comment_id": 77892175, "body": "@IngoLeonhardt that skips the last character tho"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501689731, "post_id": 45464884, "comment_id": 77892332, "body": "@BLUEPIXY ah, yeah - I have been trying to make that bit overly complicated haven&#39;t I :/"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501689838, "post_id": 45464884, "comment_id": 77892401, "body": "You forget to erase one parenthesis(<code>)</code>)."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1501689881, "post_id": 45464884, "comment_id": 77892427, "body": "right, you had to append them in the end. I thought the original idea was to break the loop when &quot;ab&quot; can&#39;t be found any more. Your updated version is fine"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1501689985, "last_edit_date": 1501689985, "creation_date": 1501687380, "answer_id": 45464884, "question_id": 45464018, "link": "https://stackoverflow.com/questions/45464018/how-to-replace-two-char-with-another-char-in-a-char-array-using-c/45464884#45464884", "title": "How to replace two char with another char in a char array using C?", "body": "<p>There is no output because you explicitly have coded it to only output something in one specific circumstance...which will never happen. The expression in this <code>if</code> statement will always be false</p>\n\n<pre><code>if(i==strlen(a))\n</code></pre>\n\n<p>Your example string is 6 characters long. Because your solution isn't working (you're not altering the string except to replace the 'A' of 'AB' to 'C') the length of the string will not change. So when you exit the <code>while</code> loop, the value of <code>i</code> will be <code>strlen(a)-1</code>, which cannot possibly also be the same as <code>strlen(a)</code>.</p>\n\n<p>The are a lot of ways to do what want. One possible solution is to have a second string to copy the result in to and then copy it back again like this</p>\n\n<pre><code>int i,j;\nchar a[]=\"helablo\";\nchar *b;\nb=malloc(strlen(a)+1);\n\nfor(i=0,j=0;a[i]!='\\0';i++)\n  {\n  if((a[i]=='a')&amp;&amp;(a[i+1]=='b'))\n    {\n    b[j++]='c';\n    i++;\n    }\n  else\n    {\n    b[j++]=a[i];\n    }\n  }\nb[j]='\\0';\nstrcpy(a,b);\nfree(b);\nprintf(\"%s\\n\",a);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501690664, "post_id": 45465682, "comment_id": 77892939, "body": "If I get it right won&#39;t this have a complexity of O(n^2)? It can be done in a single pass though."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501710624, "post_id": 45465682, "comment_id": 77904190, "body": "@AjayBrahmakshatriya-- I wasn&#39;t too concerned with efficiencies here, but I have added a function to my answer that uses <code>strstr()</code> and <code>memmove()</code> while avoiding the extra copying."}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 2, "last_activity_date": 1501710434, "last_edit_date": 1501710434, "creation_date": 1501689514, "answer_id": 45465682, "question_id": 45464018, "link": "https://stackoverflow.com/questions/45464018/how-to-replace-two-char-with-another-char-in-a-char-array-using-c/45465682#45465682", "title": "How to replace two char with another char in a char array using C?", "body": "<p>You could write a more general function to replace a substring with a single character, using <code>strstr()</code> to find the substring, and <code>memmove()</code> to rewrite the end of the string.</p>\n\n<p>The <code>strstr()</code> function finds the first occurrence of a substring within an input string, or returns a null pointer if no match is found. This pointer can be used to assign the desired <code>char</code> to the input string. Then <code>memmove()</code> can be used to move the characters from the end of the string to the location following the substituted character. If <code>loc</code> is a pointer to the location of the found substring, and <code>replace_len</code> is the length of the substring to be replaced, then <code>char *tail = loc + replace_len</code> points to the tail of the input string that should be kept, and <code>strlen(tail) + 1</code> is the number of characters to move, including the <code>'\\0'</code> character.</p>\n\n<p>This function only replaces the first occurrence of a substring; if it is desired to replace <em>all</em> occurrences of a substring, this function can be called in a loop. Since <code>substr_char()</code> returns a pointer to the character following the substituted character (or a null pointer when no substitution is made), the return value can be used in a loop to continue making substitutions until no more matches are found.</p>\n\n<p>The method described above is not as efficient as it might be for replacing all occurrences of a substring, since the entire tail of the string is moved, including remaining instances of the substring to be replaced, each time <code>substr_char()</code> is called. This method can be modified so that no extra characters are copied by writing a single function to replace all instances of the replacement substring. This function, <code>substr_char_all()</code>, finds the first instance of the substring, and writes the replacement character to the location indicated by <code>next</code>, and then finds the next instance of the substring in <code>tail</code>. If there is no such instance, <code>tail</code> is moved to follow the replacement character. If there is another instance of the substring, the characters preceding this instance are moved to follow the replacement character. The number of characters to move is found by subtracting <code>tail</code> from <code>loc</code>, since <code>tail</code> points to the start of the remainder of the string, and <code>loc</code> points to the start of the next substring instance. Note that both <code>tail</code> and <code>loc</code> are pointers, so the correct type to store this result is <code>ptrdiff_t</code>. The pointer <code>next</code> is then incremented to indicate the location following the moved characters, and the loop continues, writing a replacement character to the next location, and searching for more instances of the replacement substring.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stddef.h&gt;           // for ptrdiff_t, used in substr_char_all()\n\nchar * substr_char(char *str, char *substr, char c);\nvoid substr_char_all(char *st, char *subst, char c);\n\nint main(void)\n{\n    /* Replace the first occurrence of a substring with a character */\n    char string1[] = \"heablo\";\n    printf(\"Before substitution: %s\\n\", string1);\n    char *found = substr_char(string1, \"ab\", 'l');\n    printf(\"After substitution: %s\\n\", string1);\n\n    putchar('\\n');\n\n    /* Replace all occurrences of a substring with a character */\n    char string2[] = \"heababababloo\";\n    printf(\"Before substitution: %s\\n\", string2);\n    found = string2;\n    while ((found = substr_char(found, \"ab\", 'l'))) {\n        continue;\n    }\n    printf(\"After substitution: %s\\n\", string2);\n\n    /* Using the substr_char_all() function */\n    putchar('\\n');\n    char string3[] = \"heablo\";\n    printf(\"Before substitution: %s\\n\", string3);\n    substr_char_all(string3, \"ab\", 'l');\n    printf(\"After substitution: %s\\n\", string3);\n\n    putchar('\\n');\n    char string4[] = \"heababababloo\";\n    printf(\"Before substitution: %s\\n\", string4);\n    substr_char_all(string4, \"ab\", 'l');\n    printf(\"After substitution: %s\\n\", string4);\n\n    putchar('\\n');\n    char string5[] = \"some body wants some thing\";\n    printf(\"Before substitution: %s\\n\", string5);\n    substr_char_all(string5, \"some\", 'a');\n    printf(\"After substitution: %s\\n\", string5);\n\n    return 0;\n}\n\n/* Returns a pointer to the character following substitution, or NULL */\nchar * substr_char(char *st, char *subst, char c)\n{\n    char *loc = strstr(st, subst);\n    if (loc) {\n        *loc = c;\n        char *tail = loc + strlen(subst);\n        memmove(loc + 1, tail, strlen(tail) + 1);\n        ++loc;\n    }\n\n    return loc;\n}\n\nvoid substr_char_all(char *st, char *subst, char c)\n{\n    char *loc = strstr(st, subst);\n    char *next = loc;\n    while (loc) {\n        *next++ = c;\n        char *tail = loc + strlen(subst);\n        if ((loc = strstr(tail, subst))) {\n            ptrdiff_t copy_len = loc - tail;\n            memmove(next, tail, copy_len);\n            next += copy_len;\n        } else {\n            memmove(next, tail, strlen(tail) + 1);\n        }\n    }\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Before substitution: heablo\nAfter substitution: hello\n\nBefore substitution: heababababloo\nAfter substitution: hellllloo\n\nBefore substitution: heablo\nAfter substitution: hello\n\nBefore substitution: heababababloo\nAfter substitution: hellllloo\n\nBefore substitution: some body wants some thing\nAfter substitution: a body wants a thing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3062, "user_id": 5115872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lyXg.jpg?s=128&g=1", "display_name": "wrangler", "link": "https://stackoverflow.com/users/5115872/wrangler"}, "is_accepted": false, "score": 0, "last_activity_date": 1501691339, "last_edit_date": 1501691339, "creation_date": 1501690720, "answer_id": 45466068, "question_id": 45464018, "link": "https://stackoverflow.com/questions/45464018/how-to-replace-two-char-with-another-char-in-a-char-array-using-c/45466068#45466068", "title": "How to replace two char with another char in a char array using C?", "body": "<p>How about this:    </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main() {\n    int i=0,j=0;\n    char a[]=\"helablo\";\n    for(int i=0;a[i]!='\\0';i++){\n        if(a[i]=='a'&amp;&amp; a[i+1]=='b'){\n            a[i]='c';\n            for(j=i+1;j&lt;strlen(a);j++){\n                a[j]=a[j+1];\n            }\n        }\n    }\n    printf(\"%s\\n\",a);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 8385428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90b02ffc460c03ce1966b9e3b0a3998?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/8385428/aravind"}, "edited": false, "score": 0, "creation_date": 1501722904, "post_id": 45466188, "comment_id": 77907402, "body": "could you please explain for(;*o=*i;i++,o++)         *o=(i[0]==&#39;a&#39; &amp;&amp; i[1]==&#39;b&#39; &amp;&amp; i++)? &#39;c&#39;: *i;"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 25, "user_id": 8385428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90b02ffc460c03ce1966b9e3b0a3998?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/8385428/aravind"}, "edited": false, "score": 0, "creation_date": 1501728583, "post_id": 45466188, "comment_id": 77908655, "body": "@Aravind I have added explanation in the answer."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 0, "last_activity_date": 1501728561, "last_edit_date": 1501728561, "creation_date": 1501691103, "answer_id": 45466188, "question_id": 45464018, "link": "https://stackoverflow.com/questions/45464018/how-to-replace-two-char-with-another-char-in-a-char-array-using-c/45466188#45466188", "title": "How to replace two char with another char in a char array using C?", "body": "<p>This is probably the simplest way to achieve what you want. Happens in a single pass.</p>\n\n<pre><code>char* o=input;\nchar* i=input;\nfor(;*o=*i;i++,o++)\n    *o=(i[0]=='a' &amp;&amp; i[1]=='b' &amp;&amp; i++)? 'c': *i;\n</code></pre>\n\n<p>Here is the <a href=\"http://ideone.com/n66nVF\" rel=\"nofollow noreferrer\">DEMO</a></p>\n\n<p>The <code>for</code> loop simply copies a letter from input to output position 1 character at a time. This loop will go on untill <code>*i</code> is not 0 (<code>'\\0'</code>).</p>\n\n<p>So no changes will happen basically. But the line inside checks if input has a and b consequtively just where it is writting. If it is so the third part of the condition gets evaluated causing it to skip one character from input. </p>\n\n<p>And when it evaluates to true, output gets written with <code>'c'</code>. Else it overwrites the old value. </p>\n\n<p>The same code in a simple way would be as follows.</p>\n\n<pre><code>for (; *input != '\\0'; i++) {\n    if( input[0] == 'a' &amp;&amp; input[1] == 'b'){\n        input++;\n        *output = 'c';\n    } else {\n        *output = *input;\n    }\n    output++;\n}\n</code></pre>\n\n<p>I hope this one helps understanding better. The one mentioned above is just a compact (maybe complex) way to write the same logic.</p>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501694292, "post_id": 45466900, "comment_id": 77895177, "body": "Welcome to StackOverflow and thanks for helping. Your answer seems quite convincing. But would you like to  rephrase the part &quot;...  since its found  ...&quot;, that is a little clunky to read. Minor improvements would be possible with some capital letters at the start of sentences and maybe some formatting for the code parts. Not really necessary with a good explanation, but also probably an improvement, would be a code to demonstrate the described solution. Have fun."}], "tags": [], "owner": {"reputation": 1, "user_id": 8406864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa05aba0d68fcf30dbd44228fe8557?s=128&d=identicon&r=PG&f=1", "display_name": "Kishore Varma", "link": "https://stackoverflow.com/users/8406864/kishore-varma"}, "is_accepted": false, "score": 0, "last_activity_date": 1501694895, "last_edit_date": 1501694895, "creation_date": 1501693328, "answer_id": 45466900, "question_id": 45464018, "link": "https://stackoverflow.com/questions/45464018/how-to-replace-two-char-with-another-char-in-a-char-array-using-c/45466900#45466900", "title": "How to replace two char with another char in a char array using C?", "body": "<p>Your program doesn't output anything because\nyou looped till you find 'a' and 'b' continuosly .</p>\n\n<p>so for i=4 you found a[i]='a' and a[i+1]='b' since its found a[j]='\\0' where j=0 initially.so your string \"HEABLO\" became like this \"\\0EABLO\" </p>\n\n<p>when you perform strlen(a) it returns 0 and i has a value of 4 because you used a continue statement and i value doesn't get incremented it stays at 4 . </p>\n\n<p>now in while loop its checked 4&lt;0 it fails and similarly if conditional statement also fails because if(4==0) so printf doesn't gets executed</p>\n\n<p>simple code to perform your task :)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\n   char a[]=\"helabablo\";\n   char *p=a;\n   while(*(p+1)!='\\0')\n   {\n     if(*p=='a'&amp;&amp;*(p+1)=='b')\n     {\n       *(p++)='l';\n       *(p++)='\\0';\n       strcat(a,p);\n       p-=2;\n     }\n     p++;\n   }\n   printf(\"%s\\n\",a);\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8385428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90b02ffc460c03ce1966b9e3b0a3998?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/8385428/aravind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 45466188, "answer_count": 5, "score": -1, "last_activity_date": 1501728561, "creation_date": 1501685067, "last_edit_date": 1501686455, "question_id": 45464018, "link": "https://stackoverflow.com/questions/45464018/how-to-replace-two-char-with-another-char-in-a-char-array-using-c", "title": "How to replace two char with another char in a char array using C?", "body": "<p>The question is; I need to replace \"AB\" with \"C\" in a string.</p>\n\n<p>Example 1:</p>\n\n<blockquote>\n  <p>\"HEABLO\" to \"HECLO\"</p>\n</blockquote>\n\n<p>Code: </p>\n\n<pre><code>    int main() {\n    int i=0,j=0;\n    char a[]=\"helablo\";\n    while(i&lt;strlen(a)-1){\n        if(a[i]=='a'&amp;&amp; a[i+1]=='b'){\n            a[j]='\\0';\n            a[j++]='c';\n            continue;\n        }\n        i++;\n    }\n    if(i==strlen(a)){\n        printf(\"%s\\n\",a);\n    }\n    a[j]='\\0';\n    return 0;\n}\n</code></pre>\n\n<p>There is no error and there is no output.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1501684337, "post_id": 45463701, "comment_id": 77888115, "body": "Because it wants it to be 8-byte aligned? <code>uint64_t</code> is 8-byte."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501684346, "post_id": 45463701, "comment_id": 77888122, "body": "Probably some extra padding between <code>fsi_4</code> and <code>ex5</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1501684407, "post_id": 45463701, "comment_id": 77888171, "body": "How it padding <b>at the end</b> related to alignment <b>at the beginning</b>? And why not? provide a reference to the standard disallowing this."}, {"owner": {"reputation": 419, "user_id": 3878723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/566726f89bb35db7ce1c1b992c9513c6?s=128&d=identicon&r=PG&f=1", "display_name": "tyler124", "link": "https://stackoverflow.com/users/3878723/tyler124"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501684514, "post_id": 45463701, "comment_id": 77888269, "body": "@Someprogrammerdude: These are the addresses of those data members: fsi_4 address: 41973f4f, ex5 address: 41973f50. There&#39;s only a byte in between them, so the padding doesn&#39;t seem to be added there. Like I said, after examining the addresses of each data member, everything seems to come in sequential order so I think the padding must come at the end of the struct."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1501684661, "post_id": 45463701, "comment_id": 77888402, "body": "Side comment: this question is yet another demonstration of why worrying about struct padding is almost always a waste of time.  You only care about struct padding if, for some reason, you&#39;re trying to get your struct to conform to some externally-imposed storage layout.  But there are other, more portable techniques for performing I/O based on externally-imposed storage layouts -- use them!"}, {"owner": {"reputation": 3960, "user_id": 855395, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d2f0d32da67f0c84e41dc8928b7ce24?s=128&d=identicon&r=PG", "display_name": "Eran Zimmerman Gonen", "link": "https://stackoverflow.com/users/855395/eran-zimmerman-gonen"}, "edited": false, "score": 0, "creation_date": 1501684895, "post_id": 45463701, "comment_id": 77888588, "body": "Are you compiling <b>for</b> 32-bit architecture (rather than <b>on</b> a 32-bit machine)?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1501685430, "post_id": 45463701, "comment_id": 77889016, "body": "Padding is not limited to align the members within a struct. If you create an array with this struct type, each array element must be aligned as well. In this case, 8 byte alignment is required for the uint64 part."}, {"owner": {"reputation": 96, "user_id": 7255199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e318bcd1f202410e29f29eb0d4614857?s=128&d=identicon&r=PG&f=1", "display_name": "v.c", "link": "https://stackoverflow.com/users/7255199/v-c"}, "edited": false, "score": 0, "creation_date": 1501703106, "post_id": 45463701, "comment_id": 77900337, "body": "A detailed information on structure packing and padding can be found at <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">Art of Structure packing in C</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501713470, "post_id": 45463701, "comment_id": 77905220, "body": "these lines: ` uint64_t ex5;     uint64_t ex6;     uint64_t Unused_1;     uint64_t Unused_2;     uint64_t Unused_3;     uint64_t Unused_4;` in the struct are 8 bytes each, so the overall struct must be 8 byte aligned."}], "answers": [{"tags": [], "owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1501685450, "last_edit_date": 1501685450, "creation_date": 1501685244, "answer_id": 45464077, "question_id": 45463701, "link": "https://stackoverflow.com/questions/45463701/why-is-the-compiler-adding-padding-to-a-struct-thats-already-4-byte-aligned/45464077#45464077", "title": "Why is the compiler adding padding to a struct that&#39;s already 4-byte aligned?", "body": "<p>Compiler use 4 bytes boundary till fsi_4, then use 8 bytes boundary once declaration of \"uint64_t\" started thats why you are getting 80 bytes of total size.</p>\n"}, {"comments": [{"owner": {"reputation": 419, "user_id": 3878723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/566726f89bb35db7ce1c1b992c9513c6?s=128&d=identicon&r=PG&f=1", "display_name": "tyler124", "link": "https://stackoverflow.com/users/3878723/tyler124"}, "edited": false, "score": 0, "creation_date": 1501685519, "post_id": 45464105, "comment_id": 77889089, "body": "Confirmed that if I replace each uint64 with 2 uint32s the compiler doesn&#39;t add padding. Thanks!"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1501688815, "post_id": 45464105, "comment_id": 77891664, "body": "FWIW, the only &quot;modern&quot; 32-bit ABI where 64-bit types only need 4-byte alignment that I&#39;m aware of is 32-bit x86. Almost everywhere else (notably ARM) the ABI requires 8-byte alignment."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1501692714, "post_id": 45464105, "comment_id": 77894162, "body": "@R.. Note: The embedded devices I use oblige a 2 byte alignment for integers16 through 64-bit.  These devices are plentiful in 2017.  Of course that is not gcc as post is tagged."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501693741, "post_id": 45464105, "comment_id": 77894851, "body": "Respectfully disagree with the rational: &quot;because your struct contains members of type uint64_t (8 bytes), it must be aligned to an 8-byte boundary.&quot;  For a given member, the issues is not <i>size</i>, but <i>alignment</i> requirement.  It happens to be the same for OP.  Yet, as the doc says &quot;lowest common multiple of the <i>alignments</i>&quot;"}], "tags": [], "owner": {"reputation": 1896, "user_id": 7095601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eccab5ef8dde840d0f0265caa911544?s=128&d=identicon&r=PG&f=1", "display_name": "Elan Hamburger", "link": "https://stackoverflow.com/users/7095601/elan-hamburger"}, "is_accepted": true, "score": 6, "last_activity_date": 1501694155, "last_edit_date": 1501694155, "creation_date": 1501685301, "answer_id": 45464105, "question_id": 45463701, "link": "https://stackoverflow.com/questions/45463701/why-is-the-compiler-adding-padding-to-a-struct-thats-already-4-byte-aligned/45464105#45464105", "title": "Why is the compiler adding padding to a struct that&#39;s already 4-byte aligned?", "body": "<p>From the <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3/gcc/Type-Attributes.html\" rel=\"nofollow noreferrer\">GCC documentation</a>:</p>\n\n<blockquote>\n  <p>Note that the alignment of any given struct or union type is required by the ISO C standard to be at least a perfect multiple of the lowest common multiple of the alignments of all of the members of the struct or union in question.</p>\n</blockquote>\n\n<p>In other words, because your struct contains members of type <code>uint64_t</code> (aligned to 8 bytes), the struct itself must be aligned to an 8-byte boundary.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1501685890, "last_edit_date": 1501685890, "creation_date": 1501685544, "answer_id": 45464197, "question_id": 45463701, "link": "https://stackoverflow.com/questions/45463701/why-is-the-compiler-adding-padding-to-a-struct-thats-already-4-byte-aligned/45464197#45464197", "title": "Why is the compiler adding padding to a struct that&#39;s already 4-byte aligned?", "body": "<p>As OP was able to use <code>#pragma pack(1)</code>, an implementation specific directive,  it implies that the size of the structure <em>could</em> be packed to 76 bytes rather than 80 on OP's platform.</p>\n\n<p>With such packing, an array of <code>testStruct</code> would certainly cause <code>uint64_t</code> members to occur on non-octal addresses.  By padding the structure with 4, an array of <code>testStruct</code>, starting on an octal address would have <strong>all <code>uint64_t</code> members in each element aligned for potential optimal code/speed.</strong></p>\n\n<p>This is a common trade off compilers make to optimize, code, speed and memory usage.  </p>\n\n<hr>\n\n<p>Most coding tasks should not assume a packed structure.  </p>\n\n<p>For code that needs precise layout, either implementation directive like <code>#pragma pack(1)</code> are needed or for portability, another non-<code>struct</code> approach is needed.</p>\n"}], "owner": {"reputation": 419, "user_id": 3878723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/566726f89bb35db7ce1c1b992c9513c6?s=128&d=identicon&r=PG&f=1", "display_name": "tyler124", "link": "https://stackoverflow.com/users/3878723/tyler124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2547, "favorite_count": 0, "accepted_answer_id": 45464105, "answer_count": 3, "score": 1, "last_activity_date": 1501694155, "creation_date": 1501684244, "question_id": 45463701, "link": "https://stackoverflow.com/questions/45463701/why-is-the-compiler-adding-padding-to-a-struct-thats-already-4-byte-aligned", "title": "Why is the compiler adding padding to a struct that&#39;s already 4-byte aligned?", "body": "<p>This issue has been reproduced using multiple 32-bit architectures</p>\n\n<p>I have the following struct in which the sum of all the data member sizes is 76 bytes:</p>\n\n<pre><code>typedef struct\n{\n\n\n    uint32_t unused_32;\n\n    //Unrolled arrays\n    uint8_t ar1_1;\n    uint8_t ar1_2;\n\n    uint8_t ar2_1;\n    uint8_t ar2_2;\n\n    uint8_t ar3_1;\n    uint8_t ar3_2;\n\n    uint8_t ar4_1;\n    uint8_t ar4_2;\n    uint8_t ar4_3;\n    uint8_t ar4_4;\n    uint8_t ar4_5;\n    uint8_t ar4_6;\n\n\n    uint8_t ex1;\n    uint8_t ex2;\n    uint8_t ex3;\n    uint8_t ex4;\n    uint8_t fsi_1;\n    uint8_t fsi_2;\n    uint8_t fsi_3;\n    uint8_t fsi_4;\n\n\n    uint64_t ex5;\n    uint64_t ex6;\n    uint64_t Unused_1;\n    uint64_t Unused_2;\n    uint64_t Unused_3;\n    uint64_t Unused_4;\n\n    uint32_t Crc;       \n\n} testStruct;\n</code></pre>\n\n<p>However, when I do a sizeof() on the struct I get 80 bytes and I'm having trouble figuring out why. When I set the preprocessor to use the \"#pragma pack(1)\" option and do a sizeof(), it returns 76 bytes, indicating that the compiler is adding padding. </p>\n\n<p>I printed out the addresses of every data member of the structure and everything is in sequential order in memory with no 'holes'. I also added an initialization for a 32-bit integer before the struct and printed out its address, and it came right before the first datamember of the struct, indicating that the padding that's being added is at the end. </p>\n\n<p>76 bytes is already 4-byte aligned, why is the compiler adding an additional 4 bytes onto the end of the struct to make it 80 bytes? </p>\n"}, {"tags": ["c", "fortran"], "comments": [{"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1501689515, "post_id": 45463595, "comment_id": 77892179, "body": ".oOo. I will just grab my popcorn and wait paintiently for the magic solution ;) .oOo."}, {"owner": {"reputation": 2095, "user_id": 7038689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea19ae9f57b95d7abfeaa796650bd2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matt P", "link": "https://stackoverflow.com/users/7038689/matt-p"}, "edited": false, "score": 0, "creation_date": 1501699366, "post_id": 45463595, "comment_id": 77898211, "body": "Are you asking how to pass data from C into a couple of Fortran arrays?"}, {"owner": {"reputation": 298, "user_id": 3282022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dec7df028523c8b5dc8a4f197de74fcd?s=128&d=identicon&r=PG&f=1", "display_name": "user106306", "link": "https://stackoverflow.com/users/3282022/user106306"}, "reply_to_user": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1501699597, "post_id": 45463595, "comment_id": 77898338, "body": "@mko: mmm, I don&#39;t understand your comment, it&#39;s a joke? this website is precisely for do question, no? If you know about this topic, would be very useful for me point me how to solve this problem. Obviously, it&#39;s not necessary the complete code (someone suggested that?). I just ask for some guidance"}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1501699981, "post_id": 45463595, "comment_id": 77898568, "body": "@user10630 It&#39;s not about you. I fully understand your issue. In fact I have posted answer that was downwoted. So, now, I am waiting for alternative solutions from downwoters :) In my opinion, without altering the code and making it suitable for fortran-c calls you will not be able to proceed :("}, {"owner": {"reputation": 298, "user_id": 3282022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dec7df028523c8b5dc8a4f197de74fcd?s=128&d=identicon&r=PG&f=1", "display_name": "user106306", "link": "https://stackoverflow.com/users/3282022/user106306"}, "reply_to_user": {"reputation": 2095, "user_id": 7038689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea19ae9f57b95d7abfeaa796650bd2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matt P", "link": "https://stackoverflow.com/users/7038689/matt-p"}, "edited": false, "score": 0, "creation_date": 1501700113, "post_id": 45463595, "comment_id": 77898639, "body": "@MattP I want to use the C program, called triangle, inside of my Fortran rutine. Originally, triangle need the input file &quot;A.poly&quot; and generate two output files: &quot;A.1.node&quot; and &quot;A.1.ele&quot;. I need to use this output files. Is this possible? So, I need to pass data from Fortran to C (the input file A.poly of triangle software), and from C to Fortran (the output of triangle). But I don&#39;t want generate the files (read and write files)."}, {"owner": {"reputation": 298, "user_id": 3282022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dec7df028523c8b5dc8a4f197de74fcd?s=128&d=identicon&r=PG&f=1", "display_name": "user106306", "link": "https://stackoverflow.com/users/3282022/user106306"}, "reply_to_user": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1501700792, "post_id": 45463595, "comment_id": 77899031, "body": "@mko : I understand ;)   So, your suggestion is modify the C program for that their input and output files be just one and two arrays, respectively? In the case of triangle (the C program) only have one array of input and two array of output...   how can I use triangle (the C problem) inside of my Fortran code? How can I find information (or some symple example) in google or in some place?"}, {"owner": {"reputation": 2095, "user_id": 7038689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea19ae9f57b95d7abfeaa796650bd2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matt P", "link": "https://stackoverflow.com/users/7038689/matt-p"}, "edited": false, "score": 2, "creation_date": 1501700811, "post_id": 45463595, "comment_id": 77899047, "body": "So, you want to use Fortran to call a C program, avoid writing any output files and instead pass results directly back to Fortran. This is possible. You should look into Fortran&#39;s <code>ISO_C_BINDING</code>, which assists with mixed language programming, and you will need to consider whether the data types are interoperable. When you run into a specific programming question and can illustrate it with some code, you&#39;ll likely get more positive feedback. There are actually plenty of examples here on SO dealing with Fortran/C programming."}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1501702978, "post_id": 45463595, "comment_id": 77900255, "body": "This is the place you want to check: <a href=\"http://www.yolinux.com/TUTORIALS/LinuxTutorialMixingFortranAndC.html\" rel=\"nofollow noreferrer\">yolinux.com/TUTORIALS/LinuxTutorialMixingFortranAndC.html</a> You can find there lots of samples illustrating how to call C from Fortran and vice versa."}, {"owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 2, "creation_date": 1501708770, "post_id": 45463595, "comment_id": 77903388, "body": "It might also be an option to use some triangulation (?) library already written in Fortran (rather than trying to connect to a C version). For example, searching the net with &quot;triangulate fortran code&quot; gives <a href=\"http://www3.cs.stonybrook.edu/~algorith/implement/geompack/implement.shtml\" rel=\"nofollow noreferrer\">GEOMPACK</a> , <a href=\"http://people.sc.fsu.edu/~jburkardt/f_src/triangulation/triangulation.html\" rel=\"nofollow noreferrer\">triangulation</a> , etc, though I have no idea which is good or convenient to use..."}], "owner": {"reputation": 298, "user_id": 3282022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dec7df028523c8b5dc8a4f197de74fcd?s=128&d=identicon&r=PG&f=1", "display_name": "user106306", "link": "https://stackoverflow.com/users/3282022/user106306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501706907, "creation_date": 1501683930, "question_id": 45463595, "link": "https://stackoverflow.com/questions/45463595/use-c-program-inside-fortran", "title": "Use C program inside Fortran", "body": "<p>I have the C program <a href=\"https://www.cs.cmu.edu/~quake/triangle.html\" rel=\"nofollow noreferrer\">triangle</a> (free software), from</p>\n\n<p><a href=\"http://www.netlib.org/voronoi/triangle.zip\" rel=\"nofollow noreferrer\">http://www.netlib.org/voronoi/triangle.zip</a>   (this is the code)</p>\n\n<p>Triangle read a A.poly file (is in that .zip file) and generates other files (A.1.node, A.1.ele and other), running the command line</p>\n\n<pre><code>triangle A.poly\n</code></pre>\n\n<p>I need to use triangle (C program) from my fortran code but without using the input file A.poly, and not generating the files A.1.node or A.1.ele.</p>\n\n<p>I want to forgot read input file and write output files, and just use arrays inside fortran. This because I need to use this routine inside of a do loop (for loop) of hundred thousand iterations.</p>\n\n<p>There exists some way to do this?</p>\n\n<p>I'm working on linux, but I don't know if this have relevance.</p>\n"}, {"tags": ["python", "c", "callback", "ctypes"], "comments": [{"owner": {"reputation": 1, "user_id": 4637296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hwqju.jpg?s=128&g=1", "display_name": "Snowbiz", "link": "https://stackoverflow.com/users/4637296/snowbiz"}, "edited": false, "score": 0, "creation_date": 1501683411, "post_id": 45463233, "comment_id": 77887374, "body": "I was actually able to solve this problem and it was due to a silly type on one of my callback functions names. So everything is working great now! I thought about deleting my question, but I will leave it in case anyone else is able to benefit from it :)"}, {"owner": {"reputation": 787, "user_id": 6670282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/E0TSl.jpg?s=128&g=1", "display_name": "YQ.Wang", "link": "https://stackoverflow.com/users/6670282/yq-wang"}, "edited": false, "score": 0, "creation_date": 1524641605, "post_id": 45463233, "comment_id": 87049093, "body": "Hi, can you point me out how to wrap this c++ callback function to python code using ctype? <code>typedef BOOL (*PlayEndCallBack)(int UseListIndex,int UserMusicIndex,int DeviceCout,PUINT lpDeviceID,HWND hWnd,UINT TaskCode)</code>"}], "owner": {"reputation": 1, "user_id": 4637296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hwqju.jpg?s=128&g=1", "display_name": "Snowbiz", "link": "https://stackoverflow.com/users/4637296/snowbiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501682894, "creation_date": 1501682894, "question_id": 45463233, "link": "https://stackoverflow.com/questions/45463233/ctypes-callback-function-not-being-called", "title": "CTypes Callback Function not being called", "body": "<p>I am relatively new to CTypes and I have been writing a Python package to wrap a C library that was compiled to run on linux (I also do not have access to the source only the compiled shared object and header files.)</p>\n\n<p>From the header file; I have been given the following function callback signatures,</p>\n\n<pre><code>typedef void (*pxgrid_notification_cb)(jw_dom_node *node, void *arg);\ntypedef jw_dom_node *(*pxgrid_query_cb)(jw_dom_node *request, void *arg);\ntypedef void (*pxgrid_connection_disconnect_cb)(pxgrid_connection *connection, PXGRID_STATUS status, void *user_data);\ntypedef void (*pxgrid_connection_connect_cb)(pxgrid_connection *connection, void *user_data);\ntypedef void (*pxgrid_connection_account_cb)(pxgrid_connection *connection, PXGRID_STATUS status, void *user_data);\ntypedef void (*pxgrid_connection_ssl_ctx_cb)(pxgrid_connection *connection, void *ssl_ctx, void *user_data);\ntypedef int (*pxgrid_log_cb)(const char * format , va_list ap);\ntypedef size_t(*pxgrid_password_cb)(char * passwd , size_t size,void * user_data);\n</code></pre>\n\n<p>For the custom types in the signatures I have defined the types as structures using the ctypes.Structure class.</p>\n\n<pre><code>class pxgrid_connection(Structure): pass\nclass jw_dom_node(Structure): pass\nclass va_list(Structure): pass\n</code></pre>\n\n<p>***As a side note I have also tried exporting the jw_dom_node type from the library itself but was given the error that is was not able to find the symbol. Which I believe is due to the fact they are more than likely not exporting that from the compiled code. This was attempted with the following code;</p>\n\n<pre><code>self.jw_dom_node = c_int.in_dll(lib, \"jw_dom_node\")\n</code></pre>\n\n<p>I have used the c_int type as I have read that this is the default type for ctypes. Back to my previous train of thought,</p>\n\n<p>After defining the custom Structures I then declare the signatures,\n*** 'core_instance' is actually a representation of my core module, the following signatures are defined in my callbacks module and when my core module is instantiated self is passed in as an argument into the instantiation of my callbacks module. So core_instance is just my way of referencing these types from my Core class.</p>\n\n<pre><code>self.pxgrid_connection_connect_cb = CFUNCTYPE(None, POINTER(core_instance.pxgrid_connection), c_void_p)\nself.pxgrid_connection_disconnect_cb = CFUNCTYPE(None, POINTER(core_instance.pxgrid_connection), c_int, c_void_p)\nself.pxgrid_connection_account_cb = CFUNCTYPE(None, POINTER(core_instance.pxgrid_connection), c_int, c_void_p)\nself.pxgrid_notification_cb = CFUNCTYPE(None, POINTER(core_instance.jw_dom_node), c_void_p)\nself.pxgrid_query_cb = CFUNCTYPE(core_instance.jw_dom_node, POINTER(core_instance.jw_dom_node), c_void_p)\nself.pxgrid_connection_ssl_ctx_cb = CFUNCTYPE(None, POINTER(core_instance.pxgrid_connection), c_void_p, c_void_p)\nself.pxgrid_log_cb = CFUNCTYPE(int, POINTER(ctypes.c_char_p), core_instance.va_list)\nself.pxgrid_password_cb = CFUNCTYPE(ctypes.c_size_t, POINTER(ctypes.c_char), ctypes.c_size_t, c_void_p)\nself.pxgrid_message_cb = CFUNCTYPE(None, POINTER(core_instance.jw_dom_node), c_void_p)\n</code></pre>\n\n<p>After defining a CFUNCTYPE for each of my callbacks I define my actual python functions that will be used in my callbacks.</p>\n\n<pre><code>def on_connected(self):\n    print(\"on_connected callback has been called\")\n\ndef on_disconnected(self):\n    print(\"on_disconnected callback has been called\")\n\ndef on_message_cb(self):\n    print(\"on_message_cb has been called\")\n</code></pre>\n\n<p>Now that I have created the actual functions to be called I create the actual instantiations of my CFUNCTYPE signatures.</p>\n\n<pre><code>self.callback__on_connected = self.pxgrid_connection_connect_cb(self.on_connected)\nself.callback__connection_disconnect = self.pxgrid_connection_disconnect_cb(self.on_disconnected)\nself.callback__message_cb = self.pxgrid_message_cb(self.on_message_cb)\n</code></pre>\n\n<p>Now in my core module I pass in the actual callback objects into the method calls that require them. (I will try to only include the relevant pieces of code that are needed for my current question.)</p>\n\n<pre><code>connection = POINTER(self.types.pxgrid_connection)()\n\nself.lib.pxgrid_connection_set_connect_cb(ctypes.byref(connection), self.callbacks.callback__on_connected)\nself.lib.pxgrid_connection_set_disconnect_cb(ctypes.byref(connection), self.callbacks.callback__connection_disconnect)\n\n....Setting up addition properties for the connection\n\n# call method to create actual connection\nself.lib.pxgrid_connection_connect(connection)\n\n# Call method to create a notification handler and pass in callback\nself.handlers.create_session_notification(connection, self.callbacks.callback__message_cb)\n</code></pre>\n\n<p>I am able to successfully create my connection, connect to the server I am attempting to connect with and everything works great. However; none of my callbacks are ever hit. Is there something I am missing in the process of creating my CFUNCTYPE signatures and when creating the actual callbacks? Or am I just not creating my callback function signatures properly?</p>\n\n<p>I know this was a bit long-winded but I wanted to provide enough information for what I am doing to hopefully assist with receiving some guidance from someone. </p>\n\n<p>Thank you in advance, and If I am missing any information you need to answer this please let me know!</p>\n\n<p>Thank you :) </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1708, "user_id": 3569921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/077N5.jpg?s=128&g=1", "display_name": "marcusshep", "link": "https://stackoverflow.com/users/3569921/marcusshep"}, "edited": false, "score": 0, "creation_date": 1501682922, "post_id": 45463112, "comment_id": 77887005, "body": "Explicit lack of effort in creating this question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1708, "user_id": 3569921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/077N5.jpg?s=128&g=1", "display_name": "marcusshep", "link": "https://stackoverflow.com/users/3569921/marcusshep"}, "edited": false, "score": 0, "creation_date": 1501683172, "post_id": 45463112, "comment_id": 77887210, "body": "@marcusshep not necessarily, but a little more words would have been nice. I <b>guess</b> the OP only knows the use of <code>static</code> for a function-scoped variable if the function needs to find the old value when called again, which isn&#39;t the case here. So a complete explanation what <code>static</code> <b>really</b> means should answer this question."}, {"owner": {"reputation": 1708, "user_id": 3569921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/077N5.jpg?s=128&g=1", "display_name": "marcusshep", "link": "https://stackoverflow.com/users/3569921/marcusshep"}, "edited": false, "score": 0, "creation_date": 1501683459, "post_id": 45463112, "comment_id": 77887416, "body": "@FelixPalmen I would argue that a good question wouldn&#39;t leave the &quot;answerer&quot; guessing about the specifics of the question. Clearly this was copy/pasted, formatted then submitted. No signs of research or effort or understanding of the topic at hand. No &quot;thanks for your time&quot; or &quot;I expected x and got y&quot; absolutely nothing that shows an &quot;asker&quot; who is engaged in the process."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1708, "user_id": 3569921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/077N5.jpg?s=128&g=1", "display_name": "marcusshep", "link": "https://stackoverflow.com/users/3569921/marcusshep"}, "edited": false, "score": 0, "creation_date": 1501683569, "post_id": 45463112, "comment_id": 77887487, "body": "@marcusshep As I said (and I didn&#39;t ever say this was a <b>good</b> question) -- some more words would have been nice. But I&#39;m only guessing about <b>why</b> OP doesn&#39;t understand this usage of static. It&#39;s still clear what the question is. Yes, it&#39;s a poor question."}, {"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1501683672, "post_id": 45463112, "comment_id": 77887560, "body": "BTW, this is a terrible algorithm for solving this problem. Try to come up with something asymptotically faster, at least <code>n logn</code> instead of the quadratic solution you came up with."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501683772, "post_id": 45463112, "comment_id": 77887632, "body": "Unfortunately, there are tutorials and even courses/teachers telling something like &quot;use static if you need the old value again next time you call the function&quot; without explaining what <code>static</code> really means, so I&#39;m quite confident in my guess ;)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501682986, "post_id": 45463205, "comment_id": 77887061, "body": "while this is correct in general, it isn&#39;t the reason for <code>static</code> in the code shown."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1501683482, "post_id": 45463205, "comment_id": 77887431, "body": "Indeed. thx for the remark :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501683969, "post_id": 45463205, "comment_id": 77887789, "body": "nitpick: &quot;<i>variable lifetime starts at first invocation of the function</i>&quot; &lt;- it starts as soon as the program runs, but that&#39;s no difference in practice, because when it&#39;s in function scope, there&#39;s no way to access it before the function is called the first time."}, {"owner": {"reputation": 11, "user_id": 7937546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uMSt3_w5SFM/AAAAAAAAAAI/AAAAAAAAADI/E4SwFPxEVfA/photo.jpg?sz=128", "display_name": "Darsi Manoj", "link": "https://stackoverflow.com/users/7937546/darsi-manoj"}, "edited": false, "score": 0, "creation_date": 1502995794, "post_id": 45463205, "comment_id": 78443143, "body": "thanks for the answer and sorry for the question framing.i dont know how to use stack overflow ,sorry."}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 1, "last_activity_date": 1501684501, "last_edit_date": 1501684501, "creation_date": 1501682820, "answer_id": 45463205, "question_id": 45463112, "link": "https://stackoverflow.com/questions/45463112/why-the-static-is-used-rather-normal-declaration/45463205#45463205", "title": "why the static is used rather normal declaration?", "body": "<p>using <code>static</code> keyword changes the <em>storage class</em> of the variable, from local (auto) - which means variable is destroyed at end of scope, to static - which means variable lifetime starts at the start of the program and ends when it \"dies\".</p>\n\n<p>Since local variables are destroyed at end of scope, returning a local array from a function would result in <strong>Undefined-Behavior</strong>, but <code>static</code> makes sure the variable will outlive it's scope, making it safe to return it.</p>\n\n<p>Another 2 things to note while using <code>static</code>:</p>\n\n<ol>\n<li><code>result</code> is the <strong>same</strong> variable even in different invocations, unlike local variables</li>\n<li><code>result</code> (the whole array) is initialized to 0</li>\n</ol>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 3, "last_activity_date": 1501683484, "last_edit_date": 1501683484, "creation_date": 1501682936, "answer_id": 45463241, "question_id": 45463112, "link": "https://stackoverflow.com/questions/45463112/why-the-static-is-used-rather-normal-declaration/45463241#45463241", "title": "why the static is used rather normal declaration?", "body": "<p><code>static</code> is a <em>storage class specifier</em> and its main effect is to specify the <em>storage duration</em> of the object. <em>static storage duration</em> means the variable lives for the whole execution time of the program.</p>\n\n<p>In contrast, without <em>static</em>, a variable in a function scope (in general: not in the file scope) defaults to <em>automatic storage duration</em>, which means it only lives as long as the execution is inside of its scope, so it doesn't <strong>exist</strong> any more once you return from the function. You could never return a pointer to this array if it wasn't <code>static</code> -- the variable would be gone (and the pointer returned would therefore be invalid)!</p>\n\n<p>Keep in mind that this code changes <strong>the same</strong> variable on each invocation, so it is for example not thread safe (two threads could attempt to change this same variable at the same time).</p>\n"}], "owner": {"reputation": 11, "user_id": 7937546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uMSt3_w5SFM/AAAAAAAAAAI/AAAAAAAAADI/E4SwFPxEVfA/photo.jpg?sz=128", "display_name": "Darsi Manoj", "link": "https://stackoverflow.com/users/7937546/darsi-manoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "closed_date": 1501688190, "accepted_answer_id": 45463241, "answer_count": 2, "score": -4, "last_activity_date": 1532118141, "creation_date": 1501682597, "last_edit_date": 1532118141, "question_id": 45463112, "link": "https://stackoverflow.com/questions/45463112/why-the-static-is-used-rather-normal-declaration", "closed_reason": "Needs details or clarity", "title": "why the static is used rather normal declaration?", "body": "<p><strong>just a doubt.\nwhat is static vs final?</strong>\n<em>this is the code for sum of two elements in an array equals target.</em></p>\n\n<pre><code>   int *twoSum(int numbers[], int n, int target)\n        {\n\n            int temp = 0;\n            int i = 0,j;\n\n            //here i cant understand ,why the static is used rather normal declaration.\n            static int result[2];\n\n            for(i = 0; i &lt; n; i++)\n            {\n                for(j = i+1; j &lt; n; j++)\n                {\n                    if(numbers[i]+numbers[j] == target)\n                    {\n                        result[0] = i ;\n                        result[1] = j ;\n                        break;\n                    }\n                }\n            }\n            return result;\n        }\n</code></pre>\n"}, {"tags": ["android", "c", "ffmpeg"], "comments": [{"owner": {"reputation": 105, "user_id": 1907469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b606b8bbe7b1901ae4027be31823c5?s=128&d=identicon&r=PG", "display_name": "tqn", "link": "https://stackoverflow.com/users/1907469/tqn"}, "edited": false, "score": 0, "creation_date": 1501872890, "post_id": 45462842, "comment_id": 77988623, "body": "I&#39;m highly appreciate that if have any example that decode video and re-encode this frame, may be ignoring the audio stream. Hope that any suggestion :("}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 1907469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b606b8bbe7b1901ae4027be31823c5?s=128&d=identicon&r=PG", "display_name": "tqn", "link": "https://stackoverflow.com/users/1907469/tqn"}, "is_accepted": true, "score": 1, "last_activity_date": 1502357564, "creation_date": 1502357564, "answer_id": 45609773, "question_id": 45462842, "link": "https://stackoverflow.com/questions/45462842/ffmpeg-mux-video-use-libavformat-avcodec-but-output-couldnt-be-played/45609773#45609773", "title": "FFmpeg mux video use libavformat avcodec but output couldn&#39;t be played", "body": "<p>After set information for out packet, the video is playable</p>\n\n<pre><code>outPacket.pts = av_rescale_q(packet.pts,\n                                             pFormatCtx-&gt;streams[videoStreamIndex]-&gt;time_base,\n                                             videoStream.st[videoStreamIndex].time_base);\n                outPacket.dts = av_rescale_q(packet.dts,\n                                             pFormatCtx-&gt;streams[videoStreamIndex]-&gt;time_base,\n                                             videoStream.st[videoStreamIndex].time_base);\n                outPacket.duration = av_rescale_q(packet.duration,\n                                                  pFormatCtx-&gt;streams[videoStreamIndex]-&gt;time_base,\n                                                  videoStream.st[videoStreamIndex].time_base);\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 1907469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b606b8bbe7b1901ae4027be31823c5?s=128&d=identicon&r=PG", "display_name": "tqn", "link": "https://stackoverflow.com/users/1907469/tqn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "accepted_answer_id": 45609773, "answer_count": 1, "score": 1, "last_activity_date": 1502357564, "creation_date": 1501681926, "question_id": 45462842, "link": "https://stackoverflow.com/questions/45462842/ffmpeg-mux-video-use-libavformat-avcodec-but-output-couldnt-be-played", "title": "FFmpeg mux video use libavformat avcodec but output couldn&#39;t be played", "body": "<p>I'm trying write a app that take an input video and crop it to square video and ignore audio stream. Because bad performance if using command, I'm trying to use libavcodec and libavformat to do it. But the output isn't playable by any video player and duration is 0 although I wrote all frame. Here are my code.</p>\n\n<pre><code>void convert_video(char* input) {\n    AVFormatContext *pFormatCtx = NULL;\n    int             i, videoStreamIndex;\n    AVCodecContext  *pCodecCtx = NULL;\n    AVCodec         *pCodec = NULL;\n    AVFrame         *pFrame = NULL;\n    AVFrame         *pFrameSquare = NULL;\n    AVPacket        packet, outPacket;\n    int             frameFinished;\n    int             numBytes;\n    uint8_t         *buffer = NULL;\n    AVCodec         *pEncodec = NULL;\n    AVFormatContext *poFormatCxt = NULL;\n    MuxOutputStream    videoStream = {0}, audioStream = {0};\n    int tar_w, tar_h;\n\n    const enum AVPixelFormat pic_format = AV_PIX_FMT_YUV420P;\n    const enum AVCodecID codec_id = AV_CODEC_ID_H264;\n    AVDictionary    *optionsDict = NULL;\n    char output[50];\n    sprintf(output, \"%soutput.mp4\", ANDROID_SDCARD);\n\n    // Register all formats and codecs\n    av_register_all();\n\n    // Open video file\n    if(avformat_open_input(&amp;pFormatCtx, input, NULL, NULL)!=0)\n        return; // Couldn't open file\n    avformat_alloc_output_context2(&amp;poFormatCxt, NULL, NULL, output);\n\n    // Retrieve stream information\n    if(avformat_find_stream_info(pFormatCtx, NULL)&lt;0)\n        return; // Couldn't find stream information\n\n    // Find the first video stream\n    videoStreamIndex=-1;\n    for(i=0; i&lt;pFormatCtx-&gt;nb_streams; i++)\n        if(pFormatCtx-&gt;streams[i]-&gt;codec-&gt;codec_type==AVMEDIA_TYPE_VIDEO) {\n            videoStreamIndex=i;\n            break;\n        }\n    if(videoStreamIndex==-1)\n        return; // Didn't find a video stream\n\n    // Get a pointer to the codec context for the video stream\n    pCodecCtx = pFormatCtx-&gt;streams[videoStreamIndex]-&gt;codec;\n    tar_w = pCodecCtx-&gt;width &gt; pCodecCtx-&gt;height ? pCodecCtx-&gt;height : pCodecCtx-&gt;width;\n    tar_h = tar_w;\n\n    // Find the decoder for the video stream\n    pCodec=avcodec_find_decoder(pCodecCtx-&gt;codec_id);\n    pEncodec = avcodec_find_encoder(codec_id);\n\n    add_stream_mux(&amp;videoStream, poFormatCxt, &amp;pEncodec, codec_id, tar_w, tar_h);\n    videoStream.st[0].time_base = pFormatCtx-&gt;streams[videoStreamIndex]-&gt;time_base;\n    videoStream.st[0].codec-&gt;time_base = videoStream.st[0].time_base;\n    videoStream.st[0].codec-&gt;time_base.den *= videoStream.st[0].codec-&gt;ticks_per_frame;\n//    add_stream(&amp;audioStream, poFormatCxt, &amp;)\n    open_video(poFormatCxt, pEncodec, &amp;videoStream, optionsDict);\n    int ret = avio_open(&amp;poFormatCxt-&gt;pb, output, AVIO_FLAG_WRITE);\n\n    // Open codec\n    if(avcodec_open2(pCodecCtx, pCodec, &amp;optionsDict) &lt; 0)\n        return; // Could not open codec\n\n    ret = avformat_write_header(poFormatCxt, &amp;optionsDict);\n    if (ret != 0) {\n        ANDROID_LOG(\"Died\");\n    }\n\n    // Allocate video frame\n    pFrame=av_frame_alloc();\n    pFrame-&gt;format = videoStream.st-&gt;codec-&gt;pix_fmt;\n    pFrame-&gt;width = pCodecCtx-&gt;width;\n    pFrame-&gt;height = pCodecCtx-&gt;height;\n    av_frame_get_buffer(pFrame, 32);\n\n    // Allocate an AVFrame structure\n    pFrameSquare=av_frame_alloc();\n    if(pFrameSquare==NULL)\n        return;\n\n    // Determine required buffer size and allocate buffer\n    numBytes=avpicture_get_size(pic_format, tar_w,\n                                tar_h);\n    buffer = (uint8_t *)av_malloc(numBytes*sizeof(uint8_t));\n\n    // Assign appropriate parts of buffer to image planes in pFrameSquare\n    // Note that pFrameSquare is an AVFrame, but AVFrame is a superset\n    // of AVPicture\n    ret = avpicture_fill((AVPicture *)pFrameSquare, buffer, pic_format,\n                   tar_w, tar_h);\n    if (ret &lt; 0) {\n        ANDROID_LOG(\"Can't fill picture\");\n        return;\n    }\n\n    // Read frames and save first five frames to disk\n    i=0;\n    ret = av_read_frame(pFormatCtx, &amp;packet);\n    while(ret &gt;= 0) {\n        // Is this a packet from the video stream?\n        if(packet.stream_index == videoStreamIndex) {\n            // Decode video frame\n//            av_packet_rescale_ts(&amp;packet, videoStream.st-&gt;time_base, videoStream.st-&gt;codec-&gt;time_base);\n            avcodec_decode_video2(pCodecCtx, pFrame, &amp;frameFinished,\n                                  &amp;packet);\n//            while (!frameFinished) {\n//                avcodec_decode_video2(videoStream.st-&gt;codec, pFrame, &amp;frameFinished, NULL);\n//            }\n            ANDROID_LOG(\"Trying to decode frame %d with result %d\", i, frameFinished);\n            ret = av_picture_crop((AVPicture*) pFrameSquare, (AVPicture*) pFrame, pic_format, 0, 0);\n            if (ret &lt; 0) {\n                ANDROID_LOG(\"Can't crop image\");\n            }\n//            av_frame_get_best_effort_timestamp(pFrame);\n//            av_rescale_q()\n\n            if(frameFinished) {\n\n                // Save the frame to disk\n                av_init_packet(&amp;outPacket);\n//                av_packet_rescale_ts(&amp;outPacket, videoStream.st-&gt;codec-&gt;time_base, videoStream.st-&gt;time_base);\n                pFrameSquare-&gt;width = tar_w;\n                pFrameSquare-&gt;height = tar_h;\n                pFrameSquare-&gt;format = pic_format;\n                pFrameSquare-&gt;pts = ++videoStream.next_pts;\n                ret = avcodec_encode_video2(videoStream.st-&gt;codec, &amp;outPacket, pFrameSquare, &amp;frameFinished);\n\n//                int count = 0;\n//                while (!frameFinished &amp;&amp; count++ &lt; 6) {\n//                    ret = avcodec_encode_video2(videoStream.st-&gt;codec, &amp;outPacket, NULL, &amp;frameFinished);\n//                }\n                if (frameFinished) {\n                    ANDROID_LOG(\"Writing frame %d\", i);\n                    outPacket.stream_index = videoStreamIndex;\n                    av_interleaved_write_frame(poFormatCxt, &amp;outPacket);\n                }\n                av_free_packet(&amp;outPacket);\n            }\n        }\n\n        // Free the packet that was allocated by av_read_frameav_free_packet(&amp;packet);\n        ret = av_read_frame(pFormatCtx, &amp;packet);\n    }\n\n    ret = av_write_trailer(poFormatCxt);\n    if (ret &lt; 0) {\n        ANDROID_LOG(\"Couldn't write trailer\");\n    } else {\n        ANDROID_LOG(\"Video convert finished\");\n    }\n\n    // Free the RGB image\n    av_free(buffer);\n    av_free(pFrameSquare);\n\n    // Free the YUV frame\n    av_free(pFrame);\n\n    // Close the codec\n    avcodec_close(pCodecCtx);\n//    avcodec_close(pEncodecCtx);\n\n    // Close the video file\n    avformat_close_input(&amp;pFormatCtx);\n\n    return;\n}\n</code></pre>\n\n<p>Helper</p>\n\n<pre><code>#define STREAM_DURATION   10.0\n#define STREAM_FRAME_RATE 25 /* 25 images/s */\n#define STREAM_PIX_FMT    AV_PIX_FMT_YUV420P /* default pix_fmt */\n\n/* Add an output stream. */\nvoid add_stream_mux(MuxOutputStream *ost, AVFormatContext *oc,\n                       AVCodec **codec,\n                       enum AVCodecID codec_id, int width, int heigh)\n{\n    AVCodecContext *codecCtx;\n    int i;\n    /* find the encoder */\n    *codec = avcodec_find_encoder(codec_id);\n    if (!(*codec)) {\n        fprintf(stderr, \"Could not find encoder for '%s'\\n\",\n                avcodec_get_name(codec_id));\n        exit(1);\n    }\n    ost-&gt;st = avformat_new_stream(oc, *codec);\n    if (!ost-&gt;st) {\n        fprintf(stderr, \"Could not allocate stream\\n\");\n        exit(1);\n    }\n    ost-&gt;st-&gt;id = oc-&gt;nb_streams-1;\n    codecCtx = ost-&gt;st-&gt;codec;\n    switch ((*codec)-&gt;type) {\n        case AVMEDIA_TYPE_AUDIO:\n            codecCtx-&gt;sample_fmt  = (*codec)-&gt;sample_fmts ?\n                             (*codec)-&gt;sample_fmts[0] : AV_SAMPLE_FMT_FLTP;\n            codecCtx-&gt;bit_rate    = 64000;\n            codecCtx-&gt;sample_rate = 44100;\n            if ((*codec)-&gt;supported_samplerates) {\n                codecCtx-&gt;sample_rate = (*codec)-&gt;supported_samplerates[0];\n                for (i = 0; (*codec)-&gt;supported_samplerates[i]; i++) {\n                    if ((*codec)-&gt;supported_samplerates[i] == 44100)\n                        codecCtx-&gt;sample_rate = 44100;\n                }\n            }\n            codecCtx-&gt;channels        = av_get_channel_layout_nb_channels(codecCtx-&gt;channel_layout);\n            codecCtx-&gt;channel_layout = AV_CH_LAYOUT_STEREO;\n            if ((*codec)-&gt;channel_layouts) {\n                codecCtx-&gt;channel_layout = (*codec)-&gt;channel_layouts[0];\n                for (i = 0; (*codec)-&gt;channel_layouts[i]; i++) {\n                    if ((*codec)-&gt;channel_layouts[i] == AV_CH_LAYOUT_STEREO)\n                        codecCtx-&gt;channel_layout = AV_CH_LAYOUT_STEREO;\n                }\n            }\n            codecCtx-&gt;channels        = av_get_channel_layout_nb_channels(codecCtx-&gt;channel_layout);\n            ost-&gt;st-&gt;time_base = (AVRational){ 1, codecCtx-&gt;sample_rate };\n            break;\n        case AVMEDIA_TYPE_VIDEO:\n            codecCtx-&gt;codec_id = codec_id;\n            codecCtx-&gt;bit_rate = 400000;\n            /* Resolution must be a multiple of two. */\n            codecCtx-&gt;width    = width;\n            codecCtx-&gt;height   = heigh;\n            /* timebase: This is the fundamental unit of time (in seconds) in terms\n             * of which frame timestamps are represented. For fixed-fps content,\n             * timebase should be 1/framerate and timestamp increments should be\n             * identical to 1. */\n            ost-&gt;st-&gt;time_base = (AVRational){ 1, STREAM_FRAME_RATE };\n            codecCtx-&gt;time_base       = ost-&gt;st-&gt;time_base;\n            codecCtx-&gt;gop_size      = 12; /* emit one intra frame every twelve frames at most */\n            codecCtx-&gt;pix_fmt       = STREAM_PIX_FMT;\n            if (codecCtx-&gt;codec_id == AV_CODEC_ID_MPEG2VIDEO) {\n                /* just for testing, we also add B frames */\n                codecCtx-&gt;max_b_frames = 2;\n            }\n            if (codecCtx-&gt;codec_id == AV_CODEC_ID_MPEG1VIDEO) {\n                /* Needed to avoid using macroblocks in which some coeffs overflow.\n                 * This does not happen with normal video, it just happens here as\n                 * the motion of the chroma plane does not match the luma plane. */\n                codecCtx-&gt;mb_decision = 2;\n            }\n            break;\n        default:\n            break;\n    }\n    /* Some formats want stream headers to be separate. */\n    if (oc-&gt;oformat-&gt;flags &amp; AVFMT_GLOBALHEADER)\n        codecCtx-&gt;flags |= AV_CODEC_FLAG_GLOBAL_HEADER;\n}\nstatic void open_video(AVFormatContext *oc, AVCodec *codec, MuxOutputStream *ost, AVDictionary *opt_arg)\n{\n    int ret;\n    AVCodecContext *c = ost-&gt;st-&gt;codec;\n    AVDictionary *opt = NULL;\n    av_dict_copy(&amp;opt, opt_arg, 0);\n    /* open the codec */\n    ret = avcodec_open2(c, codec, &amp;opt);\n    av_dict_free(&amp;opt);\n    if (ret &lt; 0) {\n        fprintf(stderr, \"Could not open video codec: %s\\n\", av_err2str(ret));\n        exit(1);\n    }\n    /* allocate and init a re-usable frame */\n    ost-&gt;frame = alloc_picture(c-&gt;pix_fmt, c-&gt;width, c-&gt;height);\n    if (!ost-&gt;frame) {\n        fprintf(stderr, \"Could not allocate video frame\\n\");\n        exit(1);\n    }\n    /* If the output format is not YUV420P, then a temporary YUV420P\n     * picture is needed too. It is then converted to the required\n     * output format. */\n    ost-&gt;tmp_frame = NULL;\n    if (c-&gt;pix_fmt != AV_PIX_FMT_YUV420P) {\n        ost-&gt;tmp_frame = alloc_picture(AV_PIX_FMT_YUV420P, c-&gt;width, c-&gt;height);\n        if (!ost-&gt;tmp_frame) {\n            fprintf(stderr, \"Could not allocate temporary picture\\n\");\n            exit(1);\n        }\n    }\n}\n</code></pre>\n\n<p>I'm afraid that I set wrong pts or time_base of frame, and also when decoding or encoding, I see that some first frame is lost, frameFinished is 0. See a post that I've to flush decoder by <code>avcodec_decode_video2(videoStream.st-&gt;codec, pFrame, &amp;frameFinished, NULL)</code> but after try a few times, frameFinished still is 0, and with <code>avcodec_encode_video2(videoStream.st-&gt;codec, &amp;outPacket, NULL, &amp;frameFinished)</code> will throw error in next encode frame. So how I can get all frame that lost? I'm using FFmpeg version 3.0.1</p>\n"}, {"tags": ["c", "arrays", "pointers", "character", "digits"], "comments": [{"owner": {"reputation": 562, "user_id": 3397643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2da19655be5ceac32773d3be31bae20?s=128&d=identicon&r=PG&f=1", "display_name": "J0hn", "link": "https://stackoverflow.com/users/3397643/j0hn"}, "edited": false, "score": 1, "creation_date": 1501680315, "post_id": 45462127, "comment_id": 77884816, "body": "Can you post the full program? include your <code>main(){</code> part of the function?"}, {"owner": {"reputation": 1305, "user_id": 892759, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/OUvbe.jpg?s=128&g=1", "display_name": "Forever Learner", "link": "https://stackoverflow.com/users/892759/forever-learner"}, "edited": false, "score": 0, "creation_date": 1501681687, "post_id": 45462127, "comment_id": 77885985, "body": "what is the given input and which is your expected output?"}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 1, "creation_date": 1501682016, "post_id": 45462127, "comment_id": 77886261, "body": "Your title says there&#39;s a runtime error but in your question you say there&#39;s no errors... It&#39;s looks to be a program that prints only numeric characters while ignoring non-numeric characters. Though it uses the disapproved <code>gets()</code> function, in the event that the input is less than 100 char, it prints what is expected?"}, {"owner": {"reputation": 221, "user_id": 7148493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/954tp.jpg?s=128&g=1", "display_name": "Alexandre Mercier Aubin", "link": "https://stackoverflow.com/users/7148493/alexandre-mercier-aubin"}, "edited": false, "score": 0, "creation_date": 1501682053, "post_id": 45462127, "comment_id": 77886289, "body": "Yeah, he edited the post, look at the previous edits."}], "answers": [{"comments": [{"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 1, "creation_date": 1501682642, "post_id": 45462477, "comment_id": 77886770, "body": "I believe your first snippet of code is correct. <code>isdigit(int c)</code> takes an <code>int c</code> where c is the ascii value of some character, so <code>isdigit(1)</code> is false where <code>isdigit(&#39;1&#39;)</code> is true. <code>*pc</code> is not a character array, but a character after being dereferenced, so it&#39;s also valid. The last line will print 1&#39;s &amp; 0&#39;s, but it&#39;s valid :)"}, {"owner": {"reputation": 221, "user_id": 7148493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/954tp.jpg?s=128&g=1", "display_name": "Alexandre Mercier Aubin", "link": "https://stackoverflow.com/users/7148493/alexandre-mercier-aubin"}, "reply_to_user": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1501683044, "post_id": 45462477, "comment_id": 77887104, "body": "isdigit might return a 0 or a digit value greater than 0 : <a href=\"https://www.programiz.com/c-programming/library-function/ctype.h/isdigit\" rel=\"nofollow noreferrer\">programiz.com/c-programming/library-function/ctype.h/isdigit</a>"}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 1, "creation_date": 1501683340, "post_id": 45462477, "comment_id": 77887329, "body": "Ah good point. It also says zero and non-zero in &#167;7.4.1 of the C11 standard."}], "tags": [], "owner": {"reputation": 221, "user_id": 7148493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/954tp.jpg?s=128&g=1", "display_name": "Alexandre Mercier Aubin", "link": "https://stackoverflow.com/users/7148493/alexandre-mercier-aubin"}, "is_accepted": false, "score": 0, "last_activity_date": 1501681989, "last_edit_date": 1501681989, "creation_date": 1501681007, "answer_id": 45462477, "question_id": 45462127, "link": "https://stackoverflow.com/questions/45462127/checking-a-digit-in-a-character-array-using-pointer-giving-me-an-error-in-c-givi/45462477#45462477", "title": "checking a digit in a character array using pointer giving me an error in c giving me runtime error", "body": "<p>Well, isdigit takes a int as input parameter and you are giving it a char array.<br>\nYou might want to do something like this instead of what you are doing:</p>\n\n<pre><code>if(isdigit(*pc))\n    printf(\"%c\",*pc);\npc++;\n</code></pre>\n\n<p>Doing so should make an implicit cast of the character to int.</p>\n\n<p>Update:</p>\n\n<p>Have you tried printing the output of isdigit before doing the if?</p>\n\n<pre><code>printf(\"%d\",isdigit(*pc));\n</code></pre>\n\n<p>Sometimes, it returns an odd number such as 4.</p>\n"}, {"comments": [{"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1501685103, "post_id": 45463285, "comment_id": 77888757, "body": "@PaulR Thanks for letting me know; it points to an array on the stack now, and I addressed the question&#39;s issue."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1501685188, "post_id": 45463285, "comment_id": 77888834, "body": "Thanks for fixing/improving the answer - down-vote converted to up-vote!"}], "tags": [], "owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "is_accepted": false, "score": 1, "last_activity_date": 1501684826, "last_edit_date": 1592644375, "creation_date": 1501683078, "answer_id": 45463285, "question_id": 45462127, "link": "https://stackoverflow.com/questions/45462127/checking-a-digit-in-a-character-array-using-pointer-giving-me-an-error-in-c-givi/45463285#45463285", "title": "checking a digit in a character array using pointer giving me an error in c giving me runtime error", "body": "<p>Avoiding the use of <code>gets()</code>, <code>fgets()</code> accomplishes the same task, and it's safer.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(){\n    char c[100];\n    printf(&quot;Enter the string:\\n&quot;);\n    fgets(c,100,stdin);\n    int i = 0;\n    while(c[i] != '\\0'){\n        if(isdigit(c[i])){\n             printf(&quot;%c&quot;,c[i]);\n        }\n        i++;\n    }\n}\n</code></pre>\n<p><strong>Edit:</strong>\nWithout the rest of your code, a reasonable source of error is the comparison <code>isdigit(*pc) == 1</code>, by the standard,</p>\n<blockquote>\n<p><strong>C11 \u00a77.4.1</strong></p>\n<p>The functions in this subclause return nonzero (true) if and only if the value of the argument c conforms to that in the description of the function.</p>\n</blockquote>\n<p>That is, <code>int isdigit(int c);</code>. <code>isdigit</code> could be returning non-zero values for when it is true, and it can not be printed due to the comparison of just <code>1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501683445, "creation_date": 1501683445, "answer_id": 45463423, "question_id": 45462127, "link": "https://stackoverflow.com/questions/45462127/checking-a-digit-in-a-character-array-using-pointer-giving-me-an-error-in-c-givi/45463423#45463423", "title": "checking a digit in a character array using pointer giving me an error in c giving me runtime error", "body": "<p>The issue is <code>== 1</code> the isdigit is not returning 1 only non zero value. Remove it or if you want to compare with <code>1</code> for some reasons put the <code>!!</code> in the front of the isdigit</p>\n"}], "owner": {"reputation": 11, "user_id": 8367212, "user_type": "registered", "profile_image": "https://graph.facebook.com/1505163969546837/picture?type=large", "display_name": "Vishal Gupta", "link": "https://stackoverflow.com/users/8367212/vishal-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1501684826, "creation_date": 1501680181, "last_edit_date": 1501681062, "question_id": 45462127, "link": "https://stackoverflow.com/questions/45462127/checking-a-digit-in-a-character-array-using-pointer-giving-me-an-error-in-c-givi", "title": "checking a digit in a character array using pointer giving me an error in c giving me runtime error", "body": "<pre><code>char c[100];\nchar *pc;\npc = c;\nprintf(\"Enter the string:\\n\");\ngets(c);\n\nwhile(*pc != '\\0')\n{\n    if(isdigit(*pc)==1)\n        printf(\"%c\",*pc);\n    pc++;\n}\n</code></pre>\n\n<p>why this program is not giving the output since it gives no errors while executing, please help.</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 780, "user_id": 3741284, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/38b1ab011312cb05bbd578dfc03f2587?s=128&d=identicon&r=PG&f=1", "display_name": "CRoemheld", "link": "https://stackoverflow.com/users/3741284/croemheld"}, "edited": false, "score": 2, "creation_date": 1501680638, "post_id": 45462095, "comment_id": 77885080, "body": "I&#39;m not sure what you exactly mean, but if you intend to run the same function on all threads in your pool, it depends on whether you are accessing a shared resource e. g. a counter or similar."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 1708, "user_id": 3569921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/077N5.jpg?s=128&g=1", "display_name": "marcusshep", "link": "https://stackoverflow.com/users/3569921/marcusshep"}, "edited": false, "score": 0, "creation_date": 1501680771, "post_id": 45462095, "comment_id": 77885174, "body": "@marcusshep Please don&#39;t use code formatting on random phrases, only on code and variable/function names."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1501680854, "post_id": 45462095, "comment_id": 77885236, "body": "You can use the same thread function for more than one thread. If you are accessing shared data which is being modified then you probably need a mutex."}, {"owner": {"reputation": 1970, "user_id": 5646176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lmKVM.jpg?s=128&g=1", "display_name": "RonTLV", "link": "https://stackoverflow.com/users/5646176/rontlv"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1501681181, "post_id": 45462095, "comment_id": 77885513, "body": "@interjay great response !"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1501681635, "post_id": 45462095, "comment_id": 77885936, "body": "It is in fact <i>common</i> to run the same thread function concurrently in multiple threads, but that&#39;s unrelated to whether you need a mutex or other synchronization aid.  Even if there is no overlap between the functions called in various threads, you need to protect access to shared data via a mutex or similar means."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501689487, "post_id": 45462095, "comment_id": 77892159, "body": "The only way I know of screwing this up is by using self-modifying code, something which, in itself, damns your soul to the ninth level of hell for all eternity."}], "answers": [{"tags": [], "owner": {"reputation": 780, "user_id": 3741284, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/38b1ab011312cb05bbd578dfc03f2587?s=128&d=identicon&r=PG&f=1", "display_name": "CRoemheld", "link": "https://stackoverflow.com/users/3741284/croemheld"}, "is_accepted": false, "score": 2, "last_activity_date": 1501681393, "creation_date": 1501681393, "answer_id": 45462628, "question_id": 45462095, "link": "https://stackoverflow.com/questions/45462095/can-a-thread-pool-run-on-a-single-thread-function/45462628#45462628", "title": "Can a thread pool run on a single thread function?", "body": "<p><em>Is it possible for a thread pool to run on a single thread function without a mutex lock?</em></p>\n\n<p>Yes, it is <em>possible</em>. But it depends on your <code>thread_func</code> function. If you are accessing a shared resource, for example a counter and you don't use a mutex, then you might experience a <em>race-condition</em>:</p>\n\n<pre><code>int counter; // set to 2 in main function\n\nvoid* thread_func(void *p) {\n    counter = counter + 1;\n}\n</code></pre>\n\n<ul>\n<li>Thread A reads from the counter (value: 2)</li>\n<li>Thread B reads from the counter (value: 2)</li>\n<li>Thread B increases counter (value: 3)</li>\n<li>Thread A increases counter (value: 3)</li>\n</ul>\n\n<p>This happens because thread A still has the value of 2 for the counter and adds 1 which results in 3 (again) even though from normal understanding the counter value should have been 4 after both threads finished increasing the value.</p>\n\n<p>If you add a mutex, the threads have to wait for another thread which currently modifies the counter value.</p>\n"}], "owner": {"reputation": 1970, "user_id": 5646176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lmKVM.jpg?s=128&g=1", "display_name": "RonTLV", "link": "https://stackoverflow.com/users/5646176/rontlv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501681393, "creation_date": 1501680098, "last_edit_date": 1501680716, "question_id": 45462095, "link": "https://stackoverflow.com/questions/45462095/can-a-thread-pool-run-on-a-single-thread-function", "title": "Can a thread pool run on a single thread function?", "body": "<p>Is it possible for a thread pool to run on a single thread function without a mutex lock? </p>\n\n<p>Something like the following.</p>\n\n<pre><code>void* thread_func( void* p ) {\n}\n\nfor( int i = 0 ; i &lt; N ; i++ ) }\n    pthread_create( &amp;t_id, &amp;attr, thread_func, null );\n}\n</code></pre>\n\n<p>Or should I pass each <code>pthread_create</code> it's own thread function?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1501679634, "post_id": 45461862, "comment_id": 77884193, "body": "<code>&#39;AB&#39;</code> is not a legal char constant."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1501679642, "post_id": 45461862, "comment_id": 77884197, "body": "Does this actually compile with no errors? <code>&#39;AB&#39;</code> is not a char, it&#39;s <i>two</i> characters."}, {"owner": {"reputation": 147, "user_id": 7669940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b74479c2e2b6dec43eb8433b42f105b?s=128&d=identicon&r=PG&f=1", "display_name": "Jaivvignesh", "link": "https://stackoverflow.com/users/7669940/jaivvignesh"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1501679712, "post_id": 45461862, "comment_id": 77884259, "body": "@Useless Yes it is compiling without errors."}, {"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1501679970, "post_id": 45461862, "comment_id": 77884493, "body": "<a href=\"https://stackoverflow.com/a/34571914/2067492\">stackoverflow.com/a/34571914/2067492</a>"}, {"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1501680484, "post_id": 45461862, "comment_id": 77884951, "body": "It is treated as an int, and assigned to a char, so it gets truncated. <a href=\"https://stackoverflow.com/a/7755280/2067492\">stackoverflow.com/a/7755280/2067492</a> ."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1501680503, "post_id": 45461862, "comment_id": 77884966, "body": "@stark: Muli-character constants <i>are</i> legal; the standard describes them and illustrates them. It just says the value is implementation-defined."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1501680679, "post_id": 45461862, "comment_id": 77885105, "body": "<code>multichar.c:5:13: warning: multi-character character constant</code>"}, {"owner": {"reputation": 278, "user_id": 5805903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db74c52f16a0625ed6e5f09ce7d6d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Eswaran Pandi", "link": "https://stackoverflow.com/users/5805903/eswaran-pandi"}, "edited": false, "score": 0, "creation_date": 1501681940, "post_id": 45461862, "comment_id": 77886192, "body": "It is legal to assign &#39;ABCDEF&#39; in a character. Kindly see the below my post. And compiler throws error if we assign &quot;AB&quot; into character."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1501682113, "post_id": 45461862, "comment_id": 77886346, "body": "@stark <code>&#39;AB&#39;</code> and <code>&#39;A&#39;</code> are both not a <code>char</code> constant.  Both are <i>integer character constants</i> of type <code>int</code>.  <code>&#39;AB&#39;</code> comes with implementation defined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 7669940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b74479c2e2b6dec43eb8433b42f105b?s=128&d=identicon&r=PG&f=1", "display_name": "Jaivvignesh", "link": "https://stackoverflow.com/users/7669940/jaivvignesh"}, "edited": false, "score": 0, "creation_date": 1501679791, "post_id": 45461895, "comment_id": 77884331, "body": "So it is doesn&#39;t mean that it takes only the second character?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 147, "user_id": 7669940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b74479c2e2b6dec43eb8433b42f105b?s=128&d=identicon&r=PG&f=1", "display_name": "Jaivvignesh", "link": "https://stackoverflow.com/users/7669940/jaivvignesh"}, "edited": false, "score": 1, "creation_date": 1501679851, "post_id": 45461895, "comment_id": 77884391, "body": "Not at all, although we don&#39;t know the details of the implementation. But surely the reason is not that it ignores the first character and only takes the second."}, {"owner": {"reputation": 147, "user_id": 7669940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b74479c2e2b6dec43eb8433b42f105b?s=128&d=identicon&r=PG&f=1", "display_name": "Jaivvignesh", "link": "https://stackoverflow.com/users/7669940/jaivvignesh"}, "edited": false, "score": 0, "creation_date": 1501680019, "post_id": 45461895, "comment_id": 77884541, "body": "Thank you for helping me out."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501680502, "post_id": 45461895, "comment_id": 77884963, "body": "Disagree with &quot;implementation defined, whether it&#39;s 66 or not is not really predictable.&quot;.  It is predictable.  Simple review the platform&#39;s implementation."}, {"owner": {"reputation": 147, "user_id": 7669940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b74479c2e2b6dec43eb8433b42f105b?s=128&d=identicon&r=PG&f=1", "display_name": "Jaivvignesh", "link": "https://stackoverflow.com/users/7669940/jaivvignesh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501680649, "post_id": 45461895, "comment_id": 77885087, "body": "@chux can you detail it?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501681034, "post_id": 45461895, "comment_id": 77885391, "body": "@chux According to the standard apparently it should not necessarily be predictable <a href=\"https://stackoverflow.com/a/45462057/1983495\"><i>C11 $6.4.4.4 (Character constants):</i></a>. But of course is &quot;<i>not predictable</i>&quot; means that it is predictable given that you know the details about implementation, which is why I added the gcc implementation details for illustration."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501681934, "post_id": 45461895, "comment_id": 77886186, "body": "@IharobAlAsimi <i>implementation-defined behavior</i> is predictable.  With ID, each implementation documents how the choice is made."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501682266, "post_id": 45461895, "comment_id": 77886483, "body": "@chux I think that&#39;s what I said. If you think the wording can be improved please tell me directly how so."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1501682358, "post_id": 45461895, "comment_id": 77886549, "body": "Lets say an implementation defines the value as a random generated number... would that be a valid <i>implementation defined</i> or not? I certainly wouldn&#39;t call it <i>predictable</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1501682655, "post_id": 45461895, "comment_id": 77886781, "body": "@grek40 C allows for all sorts of behavior within <i>implementation-defined behavior</i>.  Is random a theoretical or do you have an example of that behavior that a compiler implemented?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501682694, "post_id": 45461895, "comment_id": 77886817, "body": "@chux I think &quot;<i>Lets say</i>&quot; means theoretical."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501682827, "post_id": 45461895, "comment_id": 77886926, "body": "@chux definitely theoretical... however, should I ever be bored of life I need to write a pathological C compiler that deliberately messes with all implementation defined possibilities and traps the user in a tetris game for any case of UB..."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1501682964, "post_id": 45461895, "comment_id": 77887037, "body": "@grek40 Even if you were to ever write such a compiler, programmers should never rely on implementation defined behavior if their code is to be portable. So your hypothetical compiler would be fun, and given it&#39;s standard compliant it will also compile useful programs."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 1, "creation_date": 1501683148, "post_id": 45461895, "comment_id": 77887190, "body": "@grek40 per<a href=\"https://stackoverflow.com/a/18420754/2410359\">this answer</a>, &quot;a user reading her compiler&#39;s documentation must be given enough information to predict exactly what will happen in the specific case.&quot;  So in the realm of possible and practical, random behavior would not meet the practical standard."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501683633, "post_id": 45461895, "comment_id": 77887534, "body": "Per <a href=\"https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char/45461895#comment77886483_45461895\">this</a> , I would use &quot;not specified&quot; instead of &quot;not predictable&quot;.  Recall that <code>char ch = &#39;A&#39;;   printf(&quot;ch is %d\\n&quot;,ch);</code> is not <i>specified</i> to print 65.  It is implementation defined behavior  (ASCII).  It is just that that behavior is hugely agreed on whereas <code>&#39;AB&#39;</code> is less consistent."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 9, "last_activity_date": 1501683952, "last_edit_date": 1592644375, "creation_date": 1501679631, "answer_id": 45461895, "question_id": 45461862, "link": "https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char/45461895#45461895", "title": "Print decimal value of a char", "body": "<p>Because <code>'AB'</code> is a multi character constant whose value is implementation defined, whether it's <code>66</code> or not is &quot;<em>not predictable</em>&quot; in principle and in practice though predictable is not the same across different implementations.</p>\n<p>Normally, you only use a single character in the middle of single quotes. If you use multiple characters,</p>\n<ol>\n<li>The compiler should warn about it.</li>\n<li>The value if the corresponding <code>int</code> is &quot;<em>not predictable</em>&quot; because it's implementation defined. Of course, given an implementation we hope that a multi character constant does always have the same value.</li>\n</ol>\n<p>If you have used <em>gcc</em>, then this is what happens <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Implementation-defined-behavior.html\" rel=\"nofollow noreferrer\">according to this source</a></p>\n<blockquote>\n<p>The compiler evaluates a multi-character character constant a character at a time, shifting the previous value left by the number of bits per target character, and then or-ing in the bit-pattern of the new character truncated to the width of a target character. The final bit-pattern is given type int, and is therefore signed, regardless of whether single characters are signed or not. If there are more characters in the constant than would fit in the target int the compiler issues a warning, and the excess leading characters are ignored.</p>\n<p>For example, <code>'ab'</code> for a target with an 8-bit char would be interpreted as \u2018<code>(int) ((unsigned char) 'a' * 256 + (unsigned char) 'b')</code>\u2019, and <code>'\\234a'</code> as \u2018<code>(int) ((unsigned char) '\\234' * 256 + (unsigned char) 'a')</code>\u2019</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1501680646, "post_id": 45462057, "comment_id": 77885086, "body": "There is nothing incorrect about using <code>&quot;%d&quot;</code> with <code>printf(&quot;ch is %d\\n&quot;,ch);</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1501687537, "post_id": 45462057, "comment_id": 77890689, "body": "&quot;and use <code>%c</code> format specifier for <code>char</code> type.&quot; No. The OP wants a decimal value."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 1, "last_activity_date": 1501680743, "last_edit_date": 1501680743, "creation_date": 1501679991, "answer_id": 45462057, "question_id": 45461862, "link": "https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char/45462057#45462057", "title": "Print decimal value of a char", "body": "<p>C11 $6.4.4.4 (Character constants):</p>\n\n<blockquote>\n  <p>A multi-char always resolves to an <strong>int</strong>, but that the exact value is\n  \u201cimplementation-dependent\u201d. That is, different compilers may resolve\n  the same multi-char to different integers. This is a portability\n  problem, and it is one of the reasons multi-chars are discouraged.</p>\n</blockquote>\n\n<p>It means <code>int ch = 'AB';</code> is ok for <code>int</code> type.But, If it were declared as type <code>char</code>, the second byte would not be retained.</p>\n\n<p>So use</p>\n\n<pre><code>char ch = 'A';\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>char ch = 'AB';\n</code></pre>\n\n<p>and use <code>%c</code> format specifier for <code>char</code> type.</p>\n\n<pre><code>printf(\"ch is %c\\n\",ch);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 1, "creation_date": 1501680573, "post_id": 45462131, "comment_id": 77885020, "body": "This will print the string in entirety instead of doing what the OP is asking."}, {"owner": {"reputation": 1, "user_id": 4094156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9818f56f63e7d780ede33722c20df54?s=128&d=identicon&r=PG&f=1", "display_name": "AndyOak", "link": "https://stackoverflow.com/users/4094156/andyoak"}, "reply_to_user": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1501682399, "post_id": 45462131, "comment_id": 77886578, "body": "You&#39;re right. The print have been changed to suit the output for the first character."}, {"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 1, "creation_date": 1501682687, "post_id": 45462131, "comment_id": 77886810, "body": "It is still incorrect, now it will print the address of first element."}], "tags": [], "owner": {"reputation": 1, "user_id": 4094156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9818f56f63e7d780ede33722c20df54?s=128&d=identicon&r=PG&f=1", "display_name": "AndyOak", "link": "https://stackoverflow.com/users/4094156/andyoak"}, "is_accepted": false, "score": -1, "last_activity_date": 1501684054, "last_edit_date": 1501684054, "creation_date": 1501680192, "answer_id": 45462131, "question_id": 45461862, "link": "https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char/45462131#45462131", "title": "Print decimal value of a char", "body": "<p>Iharob is right. <code>'AB'</code> being a multi character turns out to be not predictable. If you intend to keep the two characters <code>'AB'</code>, I'd recommend declaring this constant as a string <code>char ab[] = \"AB\";</code>. The print for a string could be <code>printf(\"ch is %d\\n\", ab[0]);</code>, to have <code>65</code> as output.</p>\n"}, {"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1501682464, "post_id": 45462658, "comment_id": 77886619, "body": "In  how far is operator precedence involved if we only have a single operator? There is no coma in the multicharacter literal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501684984, "post_id": 45462658, "comment_id": 77888663, "body": "&quot;So in this case, Right most character has more priority and stored into char <code>ch</code> and remaining characters are ignored.&quot; is incorrect - yet it certainly is a novel way of thinking about character parsing and operator precedence."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1501686475, "post_id": 45462658, "comment_id": 77889849, "body": "<b>but that the exact value is \u201cimplementation-dependent\u201d</b> Nothing more to say..."}], "tags": [], "owner": {"reputation": 278, "user_id": 5805903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db74c52f16a0625ed6e5f09ce7d6d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Eswaran Pandi", "link": "https://stackoverflow.com/users/5805903/eswaran-pandi"}, "is_accepted": false, "score": -2, "last_activity_date": 1501681471, "creation_date": 1501681471, "answer_id": 45462658, "question_id": 45461862, "link": "https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char/45462658#45462658", "title": "Print decimal value of a char", "body": "<ol>\n<li><p>First of all, this program throws a warning like</p>\n\n<pre><code>4:12: warning: multi-character character constant [-Wmultichar]\nIn function 'int main()':\n4:12: warning: overflow in implicit constant conversion [-Woverflow]\n</code></pre></li>\n<li><p>If you know the concept of <strong>Operator precedence</strong>, will help you out why you are getting the decimal value of second character <strong>(B)</strong>. In Assignment operator, precedence priority starts from Right to Left. So in this case, Right most character has more priority and stored into char <strong>ch</strong> and remaining characters are ignored. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void){\n\nchar ch = 'AB';           // Here B is assigned to 'ch' and A is ignored.\nchar ch1 = 'ABCDEFG';     // Here G is assigned to 'ch1'\n\nprintf(\"ch is %d\\n\",ch);\nprintf(\"ch1 is '%c'\\n\",ch1);\n\n}\n</code></pre></li>\n</ol>\n\n<p>Output:</p>\n\n<pre><code>ch is 66\nch1 is 'G'\n</code></pre>\n\n<p>Another example using assignment operator:</p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n\n    int main(void){\n\n    int a = (2,3,4,5,6);           // Here 6 is assigned to 'a' and remaining values are ignored.\n    printf(\"a is %d\\n\",a);\n\n    }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>a is 6\n</code></pre>\n\n<p>Kindly go through the below link for operator precedence.\n<a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/language/operator_precedence</a></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1501682356, "last_edit_date": 1501682356, "creation_date": 1501681771, "answer_id": 45462794, "question_id": 45461862, "link": "https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char/45462794#45462794", "title": "Print decimal value of a char", "body": "<pre><code>char ch = 'AB';\nprintf(\"ch is %d\\n\",ch); // Output \"ch is 66\"\n</code></pre>\n\n<blockquote>\n  <p>Why it is printing the decimal value of second character,why not the first character's decimal value?</p>\n</blockquote>\n\n<hr>\n\n<p><code>'AB'</code> is an <code>int</code> character constant.</p>\n\n<blockquote>\n  <p>The value of an integer character constant containing more than one character (e.g., 'ab'), or containing a character or escape sequence that does not map to a single-byte execution character, is implementation-defined.  C11 \u00a76.4.4.4 10</p>\n</blockquote>\n\n<p>Example:  Your output may differ.</p>\n\n<pre><code>printf(\"ch is %d\\n\",'AB'); // prints \"ch is 16706\"\n</code></pre>\n\n<p>16706 is the same value as 0x4142 which is the concatenated value of ASCII <code>A</code> and <code>B</code>.  A printout out of <code>ch is 16961</code> (0x4241) or <code>ch is 1111556096</code> (0x42410000) or others is possible.  It is <em>implementation defined behavior</em>.</p>\n\n<p>Assigning <code>16706</code> to an <code>char</code> is either implementation defined behavior or well defined - depending on if <code>char</code> is <em>signed</em> or <em>unsigned</em>.  A common ID result is to assign the lower byte, or <code>0x42</code>.\n`</p>\n\n<pre><code>printf(\"ch is %d\\n\", ch); // prints \"ch is 66\"\n</code></pre>\n\n<hr>\n\n<p>Assigning a value outside the <code>char</code> range to a <code>char</code> may raise a warning.  </p>\n\n<pre><code>// Example warning\n// warning: overflow in implicit constant conversion [-Woverflow]\nchar ch1 = 'AB';\nchar ch2 = 16706;\n</code></pre>\n\n<p>In addition, given the <em>implementation defined</em> nature of such consonant, the below may also warn:</p>\n\n<pre><code>// Example warning\n// warning: multi-character character constant [-Wmultichar]\nchar ch1 = 'AB';\n</code></pre>\n\n<p>Use of  multi-character character constant is limited to few select cases.  So few that it is more likely a coding error that a good use.</p>\n"}], "owner": {"reputation": 147, "user_id": 7669940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b74479c2e2b6dec43eb8433b42f105b?s=128&d=identicon&r=PG&f=1", "display_name": "Jaivvignesh", "link": "https://stackoverflow.com/users/7669940/jaivvignesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3287, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1529672952, "creation_date": 1501679544, "last_edit_date": 1501679865, "question_id": 45461862, "link": "https://stackoverflow.com/questions/45461862/print-decimal-value-of-a-char", "title": "Print decimal value of a char", "body": "<p>Program to print decimal value of a char: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void){\n\n  char ch = 'AB';\n  printf(\"ch is %d\\n\",ch);\n\n}\n</code></pre>\n\n<p>Why it is printing the decimal value of second character,why not the first character's decimal value?</p>\n\n<p>Output : <code>ch is 66</code></p>\n"}, {"tags": ["c", "interrupt", "stm32", "spi", "hal"], "comments": [{"owner": {"reputation": 6260, "user_id": 3820025, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zXOn4.png?s=128&g=1", "display_name": "Bence Kaulics", "link": "https://stackoverflow.com/users/3820025/bence-kaulics"}, "edited": false, "score": 0, "creation_date": 1501680038, "post_id": 45461753, "comment_id": 77884560, "body": "Show your SPI init code please."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501691482, "post_id": 45461753, "comment_id": 77893404, "body": "I would suggest the bare register approach."}, {"owner": {"reputation": 41, "user_id": 7085914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fab9fe007dded451475692b7168d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "TangoOne", "link": "https://stackoverflow.com/users/7085914/tangoone"}, "edited": false, "score": 0, "creation_date": 1501691742, "post_id": 45461753, "comment_id": 77893571, "body": "Hm... I liked the way which interrupt handling works with the StdLib. But I have to learn using HAL and I dont know if its recomended to mix HAL and bare register approach ... ?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7085914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fab9fe007dded451475692b7168d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "TangoOne", "link": "https://stackoverflow.com/users/7085914/tangoone"}, "edited": false, "score": 0, "creation_date": 1501695343, "post_id": 45466811, "comment_id": 77895722, "body": "Hey! Thanks for your reply! I can confirm that the interrupt trigger. But the problem that interrupt triggered SPI communication have no effect to writing or reading my EEPROM. Damn!"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 41, "user_id": 7085914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fab9fe007dded451475692b7168d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "TangoOne", "link": "https://stackoverflow.com/users/7085914/tangoone"}, "edited": false, "score": 0, "creation_date": 1501695530, "post_id": 45466811, "comment_id": 77895852, "body": "now you have to connect the logic analyser. No other way. Check if you have the correct clock polarity and active edge. Some time ago I have tried to use HAL (I was just curious). For anything less complex than USB or Ethernet is just not worth."}, {"owner": {"reputation": 41, "user_id": 7085914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fab9fe007dded451475692b7168d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "TangoOne", "link": "https://stackoverflow.com/users/7085914/tangoone"}, "edited": false, "score": 0, "creation_date": 1501695891, "post_id": 45466811, "comment_id": 77896073, "body": "Yes I total agree. Basically I learned that the ISR shall as short as possible. But if I see how many code only the HAL_SPI_IRQHandler() has, it seems to be not very efficent. Am I wrong? Anyway, do you think ist &quot;ok&quot; to mix HAL and own bare metal ISR handling?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 41, "user_id": 7085914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fab9fe007dded451475692b7168d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "TangoOne", "link": "https://stackoverflow.com/users/7085914/tangoone"}, "edited": false, "score": 0, "creation_date": 1501701894, "post_id": 45466811, "comment_id": 77899606, "body": "I do not see anything wrong in it. The only pointless part is if mix for the same hardware. HAL has a lots of bugs as well, and the only point of using it is the faster track of some certification. <a href=\"http://www.st.com/en/embedded-software/x-cube-classb.html\" rel=\"nofollow noreferrer\">st.com/en/embedded-software/x-cube-classb.html</a>"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1501693056, "creation_date": 1501693056, "answer_id": 45466811, "question_id": 45461753, "link": "https://stackoverflow.com/questions/45461753/stm32-hal-spi-interrupt-handling/45466811#45466811", "title": "STM32 HAL SPI Interrupt Handling", "body": "<p>Try this. I assume that counters are <code>volatile</code>. At least you will know what interrupts are triggered and if it a HAL callback configuration problem. </p>\n\n<pre><code>volatile uint32_t tmpCounterRx1 = 0, tmpCounterTx1 = 0;\n\nvoid SPI1_IRQHandler(void)\n{\n  if((SPI1 -&gt; SR &amp; SPI_SR_RXNE)) \n  {\n    tmpCounterRx1++;\n  } else    // intentional else do not remove\n  if((SPI1 -&gt; SR &amp; SPI_SR_TXE)) \n  {\n    tmpCounterTx1++;\n  }\n  /* USER CODE BEGIN SPI1_IRQn 0 */\n\n  /* USER CODE END SPI1_IRQn 0 */\n    HAL_SPI_IRQHandler(&amp;hspi1);\n    /* USER CODE BEGIN SPI1_IRQn 1 */\n\n      /* USER CODE END SPI1_IRQn 1 */\n}\n</code></pre>\n\n<p>PS I know it should be the comment but it is quite difficult to place longer pieces of the code in comments</p>\n"}], "owner": {"reputation": 41, "user_id": 7085914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fab9fe007dded451475692b7168d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "TangoOne", "link": "https://stackoverflow.com/users/7085914/tangoone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9809, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1501693056, "creation_date": 1501679264, "last_edit_date": 1501680333, "question_id": 45461753, "link": "https://stackoverflow.com/questions/45461753/stm32-hal-spi-interrupt-handling", "title": "STM32 HAL SPI Interrupt Handling", "body": "<p>Im using the STM32F4xx and want to learn to programm with the ST-HAL. \nIn the moment I try to send/ receive SPI over interrupts. </p>\n\n<p>I used the following functions to receive data over INT.:</p>\n\n<p>Init function:</p>\n\n<pre><code>void HAL_MspInit(void)\n{\n  /* USER CODE BEGIN MspInit 0 */\n\n  /* USER CODE END MspInit 0 */\n\n  HAL_NVIC_SetPriorityGrouping(NVIC_PRIORITYGROUP_0);\n\n  /* System interrupt init*/\n  /* MemoryManagement_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(MemoryManagement_IRQn, 0, 0);\n  /* BusFault_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(BusFault_IRQn, 0, 0);\n  /* UsageFault_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(UsageFault_IRQn, 0, 0);\n  /* SVCall_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(SVCall_IRQn, 0, 0);\n  /* DebugMonitor_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(DebugMonitor_IRQn, 0, 0);\n  /* PendSV_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(PendSV_IRQn, 0, 0);\n  /* SysTick_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(SysTick_IRQn, 0, 0);\n\n  /* USER CODE BEGIN MspInit 1 */\n    /* Peripheral interrupt init */\n\n    HAL_NVIC_SetPriority(SPI1_IRQn, 1, 1); //&lt;--------------------\n    HAL_NVIC_EnableIRQ(SPI1_IRQn);         //&lt;--------------------\n\n  /* USER CODE END MspInit 1 */\n}\n</code></pre>\n\n<p>Start function:</p>\n\n<pre><code>void main(void)\n{\n    HAL_SPI_Receive_IT(&amp;hspi1, buff, size);//Start the receiving process?   \n\n    while(1)\n    {\n     . . . \n    }\n}\n</code></pre>\n\n<p>Interrputhandler:</p>\n\n<pre><code>void SPI1_IRQHandler(void)\n{\n  /* USER CODE BEGIN SPI1_IRQn 0 */\n\n  /* USER CODE END SPI1_IRQn 0 */\n    HAL_SPI_IRQHandler(&amp;hspi1);\n    /* USER CODE BEGIN SPI1_IRQn 1 */\n\n      /* USER CODE END SPI1_IRQn 1 */\n}\n</code></pre>\n\n<p>Callbackfunction (defined in main file):</p>\n\n<pre><code>void HAL_SPI_RxCpltCallback(SPI_HandleTypeDef *hspi)\n{\n    volatile uint8_t y = 5;\n}\n</code></pre>\n\n<p>Before my question: Using the \"normal\" SPI_Transmit&amp;Receive functions, I transmit &amp; receive correctly. </p>\n\n<p>My problem is that I dont understand how I should use this functions. \ne.g.: Where should I call the start\" function\" when comes the Callback function, an do I have to clear Interruptflags, and so on...</p>\n\n<p>At the moment I use \"HAL_SPI_Transmit_IT\" &amp; \"HAL_SPI_Receive_IT\" in the while(1) loop. In the Rx and Tx callbackfunctions I have counter variables. I see that the tmpCounterRx counts up but the tmpCounterTx dosnt???</p>\n\n<p>E.G.:</p>\n\n<pre><code>while (1)\n{\n    HAL_SPI_Transmit_IT(&amp;hspi1, buff, size);\n    HAL_Delay(500);\n    HAL_SPI_Receive_IT(&amp;hspi1, buff, size);  \n}\n}\n\nvoid HAL_SPI_TxCpltCallback(SPI_HandleTypeDef *hspi)\n{\n    tmpCounterTx++;\n    volatile uint8_t x = 5;\n}\n\nvoid HAL_SPI_RxCpltCallback(SPI_HandleTypeDef *hspi)\n{\n    tmpCounterRx++;\n    volatile uint8_t y = 5;\n}\n</code></pre>\n\n<p>Rev. 1:</p>\n\n<p>Thanks for reply, here my SPI init function:</p>\n\n<pre><code>void MX_SPI1_Init(void)\n{\n    hspi1.Instance = SPI1;\n    hspi1.Init.Mode = SPI_MODE_MASTER;\n    hspi1.Init.Direction = SPI_DIRECTION_2LINES;\n    hspi1.Init.DataSize = SPI_DATASIZE_8BIT;\n    hspi1.Init.CLKPolarity = SPI_POLARITY_LOW;\n    hspi1.Init.CLKPhase = SPI_PHASE_1EDGE;\n    hspi1.Init.NSS = SPI_NSS_SOFT;\n    hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_32;\n    hspi1.Init.FirstBit = SPI_FIRSTBIT_MSB;\n    hspi1.Init.TIMode = SPI_TIMODE_DISABLE;\n    hspi1.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;\n    hspi1.Init.CRCPolynomial = 10;\n\n    if (HAL_SPI_Init(&amp;hspi1) != HAL_OK)\n    {\n        Error_Handler();\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "kernel"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1501679014, "post_id": 45461578, "comment_id": 77883680, "body": "Are you targeting a 64-bit system? Then what size is a pointer? And what size is an <code>int</code> (or <code>u32</code>)? Think about that and why standard <code>printf</code> have a special <code>&quot;%p&quot;</code> format to print pointers (<code>void *</code>)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501679457, "post_id": 45461578, "comment_id": 77884049, "body": "Also, what is your <code>i2hex</code> function doing? What is the meaning of the last argument?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501679772, "post_id": 45461578, "comment_id": 77884311, "body": "Lastly, Qemu allows you to attach a debugger to it. I suggest you do that and step through the code to see what it really does."}, {"owner": {"reputation": 1, "user_id": 8405580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0628642f355b153d466098ca8a2ea993?s=128&d=identicon&r=PG&f=1", "display_name": "V. Haudiquet", "link": "https://stackoverflow.com/users/8405580/v-haudiquet"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501682715, "post_id": 45461578, "comment_id": 77886835, "body": "pointer size is 32 bits (target arch is x86), int size is 32 bits too and u8,u16,u32,u64 are unsigned 8bits,16bits,32bits,64bits values (like uint8_t, uint16_t, ...)"}, {"owner": {"reputation": 1, "user_id": 8405580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0628642f355b153d466098ca8a2ea993?s=128&d=identicon&r=PG&f=1", "display_name": "V. Haudiquet", "link": "https://stackoverflow.com/users/8405580/v-haudiquet"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501682903, "post_id": 45461578, "comment_id": 77886989, "body": "i don&#39;t think that this is a problem with i2hex because even when i print the address with %d it prints 0 ; the last argument is the lenght of the output (i know that is strange but, shame on me, i did not write this function like the others itoa(), memset(), and all of that kind of things that i did just read and copy/paste)"}, {"owner": {"reputation": 1, "user_id": 8405580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0628642f355b153d466098ca8a2ea993?s=128&d=identicon&r=PG&f=1", "display_name": "V. Haudiquet", "link": "https://stackoverflow.com/users/8405580/v-haudiquet"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501683274, "post_id": 45461578, "comment_id": 77887285, "body": "i just tested it on a real computer (that has a 64bits core i5 processor) and it prints 0 too :( ++ differences between %d, %u, %x and %p are just that you are sure to have the good size printed (ex if the pointers are more than 32bits you wont see them entirely with %d), but i know that my pointers are 32bits sized so it doesnt matter"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8405580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0628642f355b153d466098ca8a2ea993?s=128&d=identicon&r=PG&f=1", "display_name": "V. Haudiquet", "link": "https://stackoverflow.com/users/8405580/v-haudiquet"}, "is_accepted": true, "score": 0, "last_activity_date": 1501794858, "creation_date": 1501794858, "answer_id": 45494617, "question_id": 45461578, "link": "https://stackoverflow.com/questions/45461578/kernel-development-memory-allocator-and-kprintf-strange-output/45494617#45494617", "title": "Kernel development, memory allocator and kprintf() strange output", "body": "<p>Alright, problem solved ! That was just a bug with u64 and all of my itoa() i2hex() functions : they were accepting 32 bits max, so there were still 32 bits on the buffer, that were read by printf instead of the other argument (the address) ! Thanks for your answers Some programmer dude, you led my to the solution !</p>\n"}], "owner": {"reputation": 1, "user_id": 8405580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0628642f355b153d466098ca8a2ea993?s=128&d=identicon&r=PG&f=1", "display_name": "V. Haudiquet", "link": "https://stackoverflow.com/users/8405580/v-haudiquet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 45494617, "answer_count": 1, "score": 0, "last_activity_date": 1501794858, "creation_date": 1501678775, "question_id": 45461578, "link": "https://stackoverflow.com/questions/45461578/kernel-development-memory-allocator-and-kprintf-strange-output", "title": "Kernel development, memory allocator and kprintf() strange output", "body": "<p>I'm currently working on a little kernel project, to learn more about system development. I'm facing an odd bug : i just made and debugged a little simple memory allocator (kmalloc() and kfree() functions only), and it works perfectly fine. When i print the addresses of the pointers returned by kmalloc(), everything works except for 1 pointer ! When i print the address of this pointer twice (with kprintf(\"addr = %x (%x)\", i64, i64)) i see \"addr = 0000 (F018)\".\nThis is the code and the output :</p>\n\n<p><a href=\"https://i.stack.imgur.com/UonAu.png\" rel=\"nofollow noreferrer\">Output on QEMU</a></p>\n\n<p>CKernel.c :</p>\n\n<pre><code>#include \"system.h\"\n#include \"multiboot.h\"\n#include \"util/util.h\"\n#include \"cpu/cpu.h\"\n#include \"video/video.h\"\n#include \"memory/mem.h\"\n\nvoid kmain(multiboot_info_t* mbt)\n{\n    //Current status : 32 bits, protected mode\n    //init\n    vga_setup();\n    gdt_install();\n    idt_install(); //TODO : ISRs ! (actually the only interrupt handler is a method that just print \"INTERRUPT\" and iret)\n    cpu_detect(); //TODO : Special handle INVALID_OPCODE\n    //TODO : Install PAGING //Need basic DYNAMIC ALLOCATION\n    //TODO : Install KHEAP\n\n    u8* i8 = kmalloc(1, 0);\n    *i8 = 244;\n    kprintf(\"i8 = %d, addr = %X\", *i8, i8);\n\n    u32* i32 = kmalloc(sizeof(u32), 0);\n    *i32 = 12;\n    kprintf(\"i32 = %d, addr = %X\", *i32, i32);\n\n    kfree(i8);\n\n    u64* i64 = kmalloc(sizeof(u64), 0);\n    *i64 = 29999344;\n    kprintf(\"i64 = %d, addr = %x (%X) (%x)\", *i64, i64, i64, i64);\n    kprintf(\"%d %x %X\", i64, i64, i64);\n\n    //Install ACPI\n    //Install PIC\n    //Install LAPIC / IOAPIC\n    //Install FPU\n\n    /*asm(\"   movb $0xFF, %al \\n \\\n              outb %al, $0xA1 \\n \\\n              outb %al, $0x21 \\n\");*/ //PIC DISABLING (DEBUG)\n    //asm(\"sti\"); //INTERRUPT ENABLING (DEBUG)\n    //asm(\"int $0x0\"); //INT CALL (DEBUG)\n\n    //print done message, to see that everything went well\n    kprint(\"[MAIN] DONE !\", 1);\n\n    //kprintf(\"Lower memory : %dk (0x%x)   Upper memory : %dk (0x%X)\", mbt-&gt;mem_lower, mbt-&gt;mem_lower, mbt-&gt;mem_upper, mbt-&gt;mem_upper);\n\n    //kter_install();\n\n    //loop infinetely\n    while(1) asm(\"hlt\");\n}\n</code></pre>\n\n<p>kmalloc.c :</p>\n\n<pre><code>#include \"../system.h\"\n#include \"util/util.h\"\n\ntypedef struct\n{\n    u32 size;\n    u8 status;\n} __attribute__ ((packed)) block_header_t;\n\n#define KHEAP_BASE_START 0xF000\n#define KHEAP_BASE_END 0xFFFF\n\nu8 base_heap_initialized = 0;\n\nstatic void merge_free_blocks();\n\n//Possible improvements : SECURITY : ADD a MAGIC number in the header, so that free() verify that it's a valid block (and malloc too)\n\nvoid* kmalloc(u32 size, u8 align)\n{\n    u32 i;\n\n    if(align == 0) align = size;\n\n    //No need to merge as kfree() did it for us, right ?\n    //merge_free_blocks();\n\n    if(!base_heap_initialized)\n    {\n        block_header_t* base_block = (block_header_t*) KHEAP_BASE_START;\n        base_block-&gt;size = KHEAP_BASE_END - (((u32) base_block) + sizeof(block_header_t));\n        base_block-&gt;status = 0;\n        base_heap_initialized = 1;\n    }\n\n    i = KHEAP_BASE_START;\n    while(i &lt; KHEAP_BASE_END)\n    {\n        block_header_t* currentBlock = (block_header_t*) i;\n        //kprintf(\"Looking block at %X... (addr = %X) (size = %d) (status = %s)\", i, i+sizeof(block_header_t), currentBlock-&gt;size, (currentBlock-&gt;status ? \"RESERVED\" : \"FREE\"));\n\n        //Check if the current block is free and large enough\n        if(!currentBlock-&gt;status &amp;&amp; currentBlock-&gt;size &gt;= size)\n        {\n            //Apply alignment contraints\n            int am = 0;\n            while((((u32)currentBlock)+sizeof(block_header_t)+am) % align != 0)\n            {\n                //kprint(\"Alignment : 1B used.\", 0);\n                am++;\n                size++;\n            }\n\n            //Recheck size after alignment contraints\n            if(currentBlock-&gt;size &gt;= size)\n            {\n                int oldSize = currentBlock-&gt;size;\n                if(oldSize - size &gt; 5)\n                {\n                    currentBlock-&gt;size = size;\n                    //Split the block if it is big\n                    block_header_t* newblock = (block_header_t*) (i+sizeof(block_header_t)+currentBlock-&gt;size);\n                    newblock-&gt;size = oldSize-size-5;\n                    newblock-&gt;status = 0;\n                    //kprintf(\"Setting up new block at %X (size = %d) (cbS = %d)\", newblock, newblock-&gt;size, currentBlock-&gt;size);\n                }\n                //Mark the block as reserved\n                currentBlock-&gt;status = 1;\n                //Return the block\n                //kprintf(\"Returning addr %X\", ((u32) (((u32)currentBlock)+sizeof(block_header_t)+am)));\n                return ((void*) ((u32)currentBlock)+sizeof(block_header_t)+am);\n            }\n        }\n        //The current block did not match, skipping to next block\n        i += (currentBlock-&gt;size+sizeof(block_header_t));\n    }\n    //Heap is full : returning null\n    kprint(\"[GRAVE] [ERROR] The kernel HEAP is FULL ! Returned pointer to NULL !\", 2);\n    return ((void*) 0);\n}\n\nvoid kfree(void* pointer)\n{\n    block_header_t* blockHeader = (block_header_t*) (pointer - sizeof(block_header_t));\n    blockHeader-&gt;status = 0;\n\n    merge_free_blocks();\n}\n\nstatic void merge_free_blocks()\n{\n    block_header_t* currBlock;\n    u32 i = KHEAP_BASE_START;\n\n    while(i &lt; KHEAP_BASE_END)\n    {\n        currBlock = (block_header_t*) i;\n        if(!currBlock-&gt;status)\n        {\n            //Joining free regions\n            block_header_t* nextBlock;\n            while(!(nextBlock = (block_header_t*) i+sizeof(block_header_t)+currBlock-&gt;size)-&gt;status)\n            {\n                currBlock-&gt;size+= (sizeof(block_header_t)+nextBlock-&gt;size);\n                i+=(sizeof(block_header_t)+nextBlock-&gt;size);\n            }\n            i += (sizeof(block_header_t)+((u32)currBlock));\n        }\n        else\n            i+= (sizeof(block_header_t)+((u32)currBlock));\n    }\n}\n</code></pre>\n\n<p>kprintf() function :</p>\n\n<pre><code>static void vkprintf(const char* args, va_list ap)\n{\n    char buffer[32];\n\n    vga_text_puts(\"[KERNEL] \", 0b00001111);\n    while(*args)\n    {\n        if(*args == '%')\n        {\n            switch(*(++args))\n            {\n                case 'u':\n                    utoa(va_arg(ap, u32), buffer);\n                    vga_text_puts(buffer, 0b00000111);\n                    break;\n                case 'i': case 'd':\n                    itoa(va_arg(ap, int32_t), buffer);\n                    vga_text_puts(buffer, 0b00000111);\n                    break;\n                case 'X': /// TODO: make it standardized\n                    i2hex(va_arg(ap, u32), buffer, 8);\n                    vga_text_puts(buffer, 0b00000111);\n                    break;\n                case 'x':\n                    i2hex(va_arg(ap, u32), buffer, 4);\n                    vga_text_puts(buffer, 0b00000111);\n                    break;\n                case 'y':\n                    i2hex(va_arg(ap, u32), buffer, 2);\n                    vga_text_puts(buffer, 0b00000111);\n                    break;\n                case 's':\n                    {\n                        char* temp = va_arg(ap, char*);\n                        vga_text_puts(temp, 0b00000111);\n                        break;\n                    }\n                case 'c':\n                    vga_text_putc((int8_t)va_arg(ap, int32_t), 0b00000111);\n                    break;\n                default:\n                    vga_text_putc(*args, 0b00000111);\n                    break;\n            }\n        }\n        else\n        {\n            vga_text_putc(*args, 0b00000111);\n        }\n\n        args++;\n    }\n    vga_text_putc('\\n', 0b00000111);\n}\n\nvoid kprintf(const char* args, ...)\n{\n    va_list ap;\n    va_start(ap, args);\n    vkprintf(args, ap);\n    va_end(ap);\n}\n</code></pre>\n\n<p>I'm sorry if this is not precise, if you need more details please let me know... This problem is not really important, as it seems that the pointer has the right address, but it is just strange and i wanted to know why...\nThanks for reading !</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "cygwin"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1501678538, "post_id": 45461381, "comment_id": 77883282, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3723795/is-stdout-line-buffered-unbuffered-or-indeterminate-by-default\">Is stdout line buffered, unbuffered or indeterminate by default?</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 2, "creation_date": 1501678547, "post_id": 45461381, "comment_id": 77883287, "body": "@Marian As you say <code>stdout</code> is line-buffered by default. But <a href=\"http://en.cppreference.com/w/c/io/puts\" rel=\"nofollow noreferrer\"><code>puts</code></a> <i>do</i> write a trailing newline, so explicit flushing should not be needed."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501678785, "post_id": 45461381, "comment_id": 77883488, "body": "To the OP: You do not redirect the output of the program to a file (using something similar to <code>.&#47;a.out &gt; some_file</code> when running)?"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1501679062, "post_id": 45461381, "comment_id": 77883721, "body": "try <code>fflush(stdout);</code> after puts."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1501679210, "post_id": 45461381, "comment_id": 77883850, "body": "Possibly related: <a href=\"https://stackoverflow.com/q/37706946/2402272\">Cygwin terminal buffers STDOUT</a>"}], "owner": {"reputation": 759, "user_id": 5410948, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fabc426325c7ee30f3200419d02e2a63?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5410948/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501678258, "creation_date": 1501678258, "question_id": 45461381, "link": "https://stackoverflow.com/questions/45461381/unexpected-behavior-of-pthread-in-cygwin", "title": "Unexpected behavior of pthread (in cygwin)", "body": "<p>I wrote the following simple code:                    </p>\n\n<pre><code>#include &lt;pthread.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid* printThreadFunction()\n{\n    puts(\"***got here*****\");   \n}\n\n\nint main (int argc, char *argv[])\n{\n     pthread_t printThread;\n     if (pthread_create(&amp;printThread, NULL, printThreadFunction, NULL) != 0) {\n             perror(\"pthread_create\");\n             exit(1);\n     }\n     pthread_join(printThread, NULL);\n}                \n</code></pre>\n\n<p>This code prints <code>***got here*****</code> as I expect. However, if I change <code>printThreadFunction()</code> to be:           </p>\n\n<pre><code>void* printThreadFunction()\n{\n        puts(\"***got here*****\");\n        while(1); // change here       \n}   \n</code></pre>\n\n<p>So the code enters an infinite loop, but no printing is being done to the screen- why is that?</p>\n"}, {"tags": ["c", "error-handling", "openmp"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 3, "creation_date": 1501675331, "post_id": 45460271, "comment_id": 77880626, "body": "<code>goto</code> is perfectly reasonable for error handling in C programs. It is the preferred mechanism in the Linux kernel, and is vastly superior to nested <code>if</code>s."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1501679859, "post_id": 45460271, "comment_id": 77884399, "body": "I actually like nested <code>if</code>s, as they make clear the scope of the section that depends on each condition.  But even then, <code>goto</code> is often invaluable for error recovery.  Do not be afraid of using <code>goto</code> where it clarifies your code.  With that said, C <i>often</i> has better alternatives."}, {"owner": {"reputation": 576, "user_id": 6648034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e100071b1105de5f4ca2e0ad4ddd2aee?s=128&d=identicon&r=PG&f=1", "display_name": "k_kaz", "link": "https://stackoverflow.com/users/6648034/k-kaz"}, "edited": false, "score": 0, "creation_date": 1501682359, "post_id": 45460271, "comment_id": 77886551, "body": "How about break, and continue statements?"}, {"owner": {"reputation": 960, "user_id": 1782553, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc4d4fbae28ecd225bd84e7e8cb6fc5e?s=128&d=identicon&r=PG", "display_name": "Jav", "link": "https://stackoverflow.com/users/1782553/jav"}, "reply_to_user": {"reputation": 576, "user_id": 6648034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e100071b1105de5f4ca2e0ad4ddd2aee?s=128&d=identicon&r=PG&f=1", "display_name": "k_kaz", "link": "https://stackoverflow.com/users/6648034/k-kaz"}, "edited": false, "score": 0, "creation_date": 1501754307, "post_id": 45460271, "comment_id": 77922185, "body": "@k_kaz what do you mean? How would you use <code>break</code> and <code>continue</code> statements in my example?"}, {"owner": {"reputation": 960, "user_id": 1782553, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc4d4fbae28ecd225bd84e7e8cb6fc5e?s=128&d=identicon&r=PG", "display_name": "Jav", "link": "https://stackoverflow.com/users/1782553/jav"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1501754389, "post_id": 45460271, "comment_id": 77922252, "body": "@John (both): thanks for your feedback! @JohnBollinger: what do you mean by &#171; <code>goto</code> is often invaluable for error recovery &#187;? Thanks"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1501765544, "post_id": 45460271, "comment_id": 77930736, "body": "@Jav, I just mean that error-recovery strategies different from &quot;abort on any error&quot; often involve control flows that are represented much more simply and clearly with the help of <code>goto</code>s than without, even when using a nested-<code>if</code> style general approach."}], "owner": {"reputation": 960, "user_id": 1782553, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc4d4fbae28ecd225bd84e7e8cb6fc5e?s=128&d=identicon&r=PG", "display_name": "Jav", "link": "https://stackoverflow.com/users/1782553/jav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501675837, "creation_date": 1501675142, "last_edit_date": 1501675837, "question_id": 45460271, "link": "https://stackoverflow.com/questions/45460271/error-handling-in-openmp", "title": "Error handling in OpenMP", "body": "<p>I use OpenMP to parallelize <code>execute</code> function calls as follow:</p>\n\n<pre><code>#pragma omp parallel num_threads(MAX_NUM_THREADS)\n{\n    int i = omp_get_thread_num();\n    statusT[i] = prepareT();\n\n    #pragma omp barrier\n    #pragma omp single\n    {\n        status = init();\n    } // implicit barrier\n\n    statusT[i] = execute1T();\n    statusT[i] = execute2T();\n}\n</code></pre>\n\n<p>I would like to find the cleanest solution allowing to handle possible errors coming from the different function calls and captured in the <code>status</code> variables.</p>\n\n<hr>\n\n<p>I thought about 2 solutions but I find none of them pretty/convenient to use.</p>\n\n<ol>\n<li><p>We could put the remaining code inside an <code>if</code> clause ; but depending on the amount of <code>execute</code> function the nested <code>if</code>s can become difficult to read.</p></li>\n<li><p>We could use a <code>goto</code> after each check that is failing to jump directly at the end of the parallelization. But I've always been told to avoid <code>goto</code>s.</p></li>\n</ol>\n\n<p><strong>My questions:</strong></p>\n\n<ul>\n<li>Would you recommend one solution more than the other and why?</li>\n<li>Does anyone think of a better alternative ?</li>\n</ul>\n"}, {"tags": ["c", "gcc", "assert"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501710854, "post_id": 45460094, "comment_id": 77904286, "body": "I do not think <code>StackNew(&amp;stringStack, sizeof(char **));</code> is correct.  <code>sizeof(char **)</code> should be the size of an element.  In this code&#39;s case that is  <code>char *</code>.  Typically those different pointer types have the same size"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501710986, "post_id": 45460094, "comment_id": 77904346, "body": "A robust <i>generic stack</i> would use <code>size_t</code>, rather than <code>int</code> for size calculations and <code>elemSize</code>."}, {"owner": {"reputation": 159, "user_id": 2013181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac48ad256f241b46efbda4246c69a6a5?s=128&d=identicon&r=PG", "display_name": "0ana", "link": "https://stackoverflow.com/users/2013181/0ana"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502102312, "post_id": 45460094, "comment_id": 78049341, "body": "The <code>sizeof(char *)</code> is a mistake on my side, I&#39;ve corrected it in the question (was playing a bit with the code and missed it when posting the question). Thank you for mentioning <code>size_t</code> for a better generic implementation. The lecture started with a stack of integers, then that version was gradually modified to be more and more generic, hopefully in the end it will turn into o a robust implementation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502115529, "post_id": 45460094, "comment_id": 78057815, "body": "Tip: With <code>friends[]</code>, ignore its type for the moment.  <code>friends</code> is an array.  Rather than <code>StackNew(&amp;stringStack, sizeof(char *));</code>, no need to code the type of the array element, instead code the array element: <code>StackNew(&amp;stringStack, sizeof friend[0]);</code>  This is correct for code regardless of the type of <code>friends[]</code>."}, {"owner": {"reputation": 159, "user_id": 2013181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac48ad256f241b46efbda4246c69a6a5?s=128&d=identicon&r=PG", "display_name": "0ana", "link": "https://stackoverflow.com/users/2013181/0ana"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502187792, "post_id": 45460094, "comment_id": 78090246, "body": "That&#39;s interesting. Why doesn&#39;t the type matter? What resource would you recommend to learn more about this, if I may ask? And thank you for the interest in my learning and trivial question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502202545, "post_id": 45460094, "comment_id": 78101468, "body": "Type does not matter as this code saves data via <code>StackPush(stack *s, void *elemAddr)</code> that is explicitly attempting to ignore the type.  The initialization routine <code>StackNew(stack *s, int elemSize)</code> only needs the <i>size</i> of an element, not the <i>type</i>.  <code>sizeof friend[0]</code> provides a direct calculation of the size of an element.  <code>sizeof(some_type)</code>  works <i>if</i> the correct type was used - which was potentially wrong with  <code>StackNew(&amp;stringStack, sizeof(char **));</code>  <a href=\"https://stackoverflow.com/\">SO</a> is a good resource."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 8, "last_activity_date": 1501674904, "creation_date": 1501674904, "answer_id": 45460191, "question_id": 45460094, "link": "https://stackoverflow.com/questions/45460094/why-does-this-code-behave-inconsistently/45460191#45460191", "title": "Why does this code behave inconsistently?", "body": "<p>You're checking <code>s-&gt;elemSize</code> before setting it. You're using an uninitialized variable.</p>\n\n<p>Fix: Either <code>assert(elemSize &gt; 0)</code> (check the function parameter, not the member of <code>s</code>), or do the <code>assert</code> after the <code>s-&gt;elemSize = elemSize</code> assignment.</p>\n"}], "owner": {"reputation": 159, "user_id": 2013181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac48ad256f241b46efbda4246c69a6a5?s=128&d=identicon&r=PG", "display_name": "0ana", "link": "https://stackoverflow.com/users/2013181/0ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 45460191, "answer_count": 1, "score": 2, "last_activity_date": 1502105294, "creation_date": 1501674592, "last_edit_date": 1502105294, "question_id": 45460094, "link": "https://stackoverflow.com/questions/45460094/why-does-this-code-behave-inconsistently", "title": "Why does this code behave inconsistently?", "body": "<p>I'm trying to implement the generic stack illustrated in lectures 5 and 6 in CS107 - Programming Paradigms (online course at Stanford). \nThe following code, representing an example presented in the lectures, compiles, but doesn't seem to behave consistently since I often get an assertion failure.</p>\n\n<p>I've noticed the behavior in Geany and gcc (<code>$ gcc --version\ngcc (Debian 6.3.0-18) 6.3.0 20170516</code>), but not on `<a href=\"https://www.tutorialspoint.com/compile_c_online.phphttp://\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/compile_c_online.php</a>' so I wonder if it is caused by something in gcc or a bug I don't seem to see now.</p>\n\n<p>Code:</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n\ntypedef struct {\n    void *elems;\n    int elemSize;\n    int logLen;\n    int allocLen;\n\n} stack;\n\nvoid StackNew(stack *s, int elemSize);\nvoid StackDispose(stack *s);\nvoid StackPush(stack *s, void *elemAddr);\nvoid StackPop(stack *s, void * elemAddr);\n\nvoid StackNew(stack *s, int elemSize)\n{\n        assert(s-&gt;elemSize &gt; 0);\n        s-&gt;elemSize = elemSize;\n        s-&gt;logLen = 0;\n        s-&gt;allocLen = 4;\n        s-&gt;elems = malloc(4 * elemSize);\n        assert(s-&gt;elems != NULL);\n}\n\nvoid StackDispose(stack *s)\n{\n    free(s-&gt;elems);\n}\n\nstatic void StackGrow(stack *s)\n{\n    s-&gt;allocLen *= 2;\n    s-&gt;elems = realloc(s-&gt;elems, s-&gt;allocLen * s-&gt;elemSize);\n}\n\nvoid StackPush(stack *s, void *elemAddr)\n{\n    if(s-&gt;logLen == s-&gt;allocLen)\n    StackGrow(s);\n    void *target = (char *) s-&gt;elems + s-&gt;logLen * s-&gt;elemSize;\n    memcpy(target, elemAddr, s-&gt;elemSize);\n    s-&gt;logLen++;\n}\n\nvoid StackPop(stack *s, void *elemAddr)\n{\n    void *source = (char *) s-&gt;elems +\n            (s-&gt;logLen - 1) * s-&gt;elemSize;\n    memcpy(elemAddr, source, s-&gt;elemSize);\n    s-&gt;logLen--;\n}\n\n\nint main(void)\n{\n  const char *friends[] = {\"Al\", \"Bob\", \"Carl\"};\n\n  stack stringStack;\n  StackNew(&amp;stringStack, sizeof(char *));\n  int i;\n  for (i = 0; i &lt; 3; i++){\n      char *copy = strdup(friends[i]);\n      StackPush(&amp;stringStack, &amp;copy);\n  }\n\n  char *name;\n\n  for (i = 0; i &lt; 3; i++) {\n    StackPop(&amp;stringStack, &amp;name);\n    printf(\"%s\\n\", name);\n    free(name);\n  }\n  StackDispose(&amp;stringStack);\n  return 0;\n\n}\n</code></pre>\n\n<p>Sample output for several consecutive executions without any source modifications:</p>\n\n<pre><code>$ ./stack4\nstack4: stack4.c:21: StackNew: Assertion 's-&gt;elemSize' &gt; 0 failed.\nAborted\n$ ./stack4\nstack4: stack4.c:21: StackNew: Assertion 's-&gt;elemSize' &gt; 0' failed.\nAborted\n$ ./stack4\nCarl\nBob\nAl\n$ ./stack4\nCarl\nBob\nAl\n$ ./stack4\nCarl\nBob\nAl\n$ ./stack4\nstack4: stack4.c:21: StackNew: Assertion 's-&gt;elemSize' &gt; 0' failed.\nAborted\n$ ./stack4\nstack4: stack4.c:21: StackNew: Assertion 's-&gt;elemSize' &gt; 0 failed.\nAborted\n$ ./stack4\nCarl\nBob\nAl\n$ ./stack4\nstack4: stack4.c:21: StackNew: Assertion 's-&gt;elemSize' &gt; 0' failed.\n</code></pre>\n"}, {"tags": ["c", "arm", "virtualization", "openwrt", "hypervisor"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502019948, "post_id": 45459918, "comment_id": 78023312, "body": "It is very unclear what you want to archive. Do you want to write your own hypervisor and run openwrt or you want to from openwrt enter the hypersivor mode. If the latter IMO is not possible and wrong."}, {"owner": {"reputation": 151, "user_id": 8404684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1605c56c165a93917a8ea77df4ee2f8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/8404684/coder"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502046466, "post_id": 45459918, "comment_id": 78031155, "body": "I have updated my question. My goal is to call the hvc instruction from a C program/kernel module. But before I can do this I need to enable the hvc instruction in the system. My question is how a minimal C kernel module with inline assembly can look that first enables the hvc instruction and then executes it."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 1, "creation_date": 1502388681, "post_id": 45459918, "comment_id": 78201026, "body": "See: <a href=\"https://stackoverflow.com/questions/tagged/trust-zone\">trust-zone</a>.  When changing from secure to normal, 90+% of the CP15 registers aren&#39;t set.  Setting the CP15 registers is <b>NOT</b> a simple copy.  Some registers must be set in order/sequences that should be investigated on a case by case basis.  It is much better to have booted Linux from NORMAL mode in the first place.  See: <a href=\"https://stackoverflow.com/questions/22080918/trustzone-monitor-mode-and-ifar-ifsr-dfar-dfsr\">TZ monitor mode and IFAR, IFSR...</a> for an inkling of your &#39;in-line&#39; assembler. Contemplate changing linux-mm (MMU, caches, etc) under its feet."}], "owner": {"reputation": 151, "user_id": 8404684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1605c56c165a93917a8ea77df4ee2f8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/8404684/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 4, "answer_count": 0, "score": 15, "last_activity_date": 1563507256, "creation_date": 1501674093, "last_edit_date": 1563507256, "question_id": 45459918, "link": "https://stackoverflow.com/questions/45459918/enter-hypervisor-mode-on-armv7-through-kernel-module", "title": "Enter Hypervisor Mode on ARMv7 through Kernel Module", "body": "<p>I am working on a project where I have a router with ARMv7 processor (Cortex A15) and OpenWRT OS. I have a shell on the router and can load kernel modules with <code>insmod</code>.</p>\n\n<p>My goal is to write a kernel module in C which changes the HVBAR register and then executes the hvc instruction to get the processor in the hyp mode.\nThis is a scientific project where I want to check if I can place my own hypervisor on a running system. But before I start to write my own hypervisor I want to check if and how I can bring the processor in the hyp mode.</p>\n\n<p>According to this picture take from armv7-a manual B.9.3.4 the system must be in insecure mode, not in user mode and the SCR.HCE bit must be set to 1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/65aMU.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/65aMU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My question is how I can prepare the processor with a C kernel module and inline assembly and then execute the hvc instruction. I want to do this with a kernel module because then I start in PL1. This pseudocode describes what I want to achieve:</p>\n\n<ol>\n<li>call smc     // to get in monitor mode</li>\n<li>set SRC.HCE to 1 // to enable hvc instruction</li>\n<li>set SRC.NS to 1 // to set the system to not secure</li>\n<li>call hvc #0  // call the hvc instruction to produce a hypervisor exception</li>\n</ol>\n"}, {"tags": ["c", "bootloader", "dfu"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501673869, "post_id": 45459776, "comment_id": 77879597, "body": "Through a function pointer initialized from a constant value (address) you get from a map-file your compiler generates, assuming you have contiguous address space and no access restrictions in either way..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501674186, "post_id": 45459776, "comment_id": 77879814, "body": "A typical scenario is that the bootloader provides some &quot;library&quot; and exposes a table of function pointers at some fixed address for that purpose, so you don&#39;t have to recompile the main code (and changing all function addresses) after every change of the bootloader. The fixed address can be achieved by putting this table in its own segment and using a linker script to correctly place this segment in the resulting binary."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501678224, "post_id": 45459776, "comment_id": 77882996, "body": "A software interrupt is a common means of accessing functions in boot code.  It is not then necessary for the main program to know where the functions are.  Commonly, a function number is pushed/whatever in a fixed manner so that the boot code can always retrieve it and switch to the desired function."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501678361, "post_id": 45459776, "comment_id": 77883120, "body": "@Martin James Common? Any examples except PC BIOS"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501678812, "post_id": 45459776, "comment_id": 77883512, "body": "@PeterJ umm.. ARM7?  Linux Kernel on Intel, (80h)?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501679161, "post_id": 45459776, "comment_id": 77883807, "body": "ARM7 do not have a bootloader. It a prehistoric family as well."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501679253, "post_id": 45459776, "comment_id": 77883880, "body": "OK, I&#39;ll admit a software interrupt is not specifically for interfacing with boot code, but it&#39;s a common method for communicating between two code units whose locations are not known to each other, eg. boot and main."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501679304, "post_id": 45459776, "comment_id": 77883927, "body": "@PeterJ ARM9 and Cortex don&#39;t have an interrupt controller and/or a software interrupt call?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501679567, "post_id": 45459776, "comment_id": 77884146, "body": "ARM9 - another prehistoric family. Cortex - see my answer  - there is an example bootloader call function. Cortex devices have the interrupt controller but before calling it it has to be disabled."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501679901, "post_id": 45459776, "comment_id": 77884428, "body": "@Martin James ARM9 family of uC, as I remember doos not have built in bootloader. One has to programmed by the user."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501682811, "post_id": 45459776, "comment_id": 77886915, "body": "Can I ask why you do not want to use thrbuilt in bootloader?"}], "answers": [{"comments": [{"owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "edited": false, "score": 0, "creation_date": 1501751758, "post_id": 45460657, "comment_id": 77920185, "body": "I know there is no simple answer. But this solution is what I was thinking about, I just was not sure how exactly should it be implemented. By the way: we used wrong compilation flags casing to link unused functions. Fixing it saved about 25% of used space.. Lesson learned."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1501676537, "last_edit_date": 1501676537, "creation_date": 1501676178, "answer_id": 45460657, "question_id": 45459776, "link": "https://stackoverflow.com/questions/45459776/how-can-i-use-one-function-from-main-application-and-bootloader-embedded/45460657#45460657", "title": "How can I use one function from main application and bootloader? (embedded)", "body": "<p>This is only a partial answer and assumes you can jump into your bootloader from your main code using the same address space. Then, a common technique is to provide your \"bootloader API\" as a table of function pointers.</p>\n\n<p>Say for example you have the following functions in your bootloader:</p>\n\n<pre><code>static int do_something(void)\n{\n    return 42;\n}\n\nstatic int do_something_else(int arg)\n{\n    return arg+5;\n}\n</code></pre>\n\n<p>Then you would declare your API in a header like this:</p>\n\n<pre><code>struct bootloaderApi\n{\n    int (*do_something)(void);\n    int (*do_something_else)(int arg);\n};\n</code></pre>\n\n<p>In the implementation of your bootloader, you define this table in its own section:</p>\n\n<pre><code>// this is GCC syntax, use whatever your compiler provides to specify the section\nstruct bootloaderApi api __attribute__((section(\"API\"))) = {\n    do_something,\n    do_something_else\n};\n</code></pre>\n\n<p>Then when building the bootloader, make sure your section is placed at a suitable fixed address. When e.g. using the GNU linker, you could have something like this in your linker script:</p>\n\n<pre><code>SECTIONS {\n  // standard sections, e.g.:\n  .text : { *(.text) }\n  .data : { *(.data) } \n  .bss :  { *(.bss)  *(COMMON) }\n\n  // your API table:\n  .API 0x10000 : { *(.API) }\n}\n</code></pre>\n\n<p>This now assumes your API table will be placed at <code>0x10000</code>. Then you could do the following to access the API from your main code:</p>\n\n<pre><code>struct bootloaderApi *api = (struct bootloaderApi *)0x10000;\n\napi-&gt;do_something();\n</code></pre>\n\n<p>All of this is just a sketch to give you an idea how to do this in a sensible way. It will heavily depend on your target platform and the toolchain you're using.</p>\n"}, {"tags": [], "owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "is_accepted": false, "score": 1, "last_activity_date": 1501679103, "last_edit_date": 1501679103, "creation_date": 1501678742, "answer_id": 45461563, "question_id": 45459776, "link": "https://stackoverflow.com/questions/45459776/how-can-i-use-one-function-from-main-application-and-bootloader-embedded/45461563#45461563", "title": "How can I use one function from main application and bootloader? (embedded)", "body": "<p>A software interrupt is a common means of accessing functions in boot code. It is not then necessary for the main program to know where the functions are. Commonly, a function number is pushed/whatever in a fixed manner so that the boot code can always retrieve it and switch to the desired function.</p>\n\n<p>Such a mechanism does not need any specially located interface area that is fixed and know to both boot and main, or any linking between the main and boot code.</p>\n\n<p>The exact mechanism/s are architecture-dependent.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501681499, "post_id": 45461605, "comment_id": 77885793, "body": "Isn&#39;t this just issuing a reboot? The second option seems more to be what the OP wants, and maybe you could elaborate on it with a more concrete example than in my answer, because you seem to know the target platform."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501681592, "post_id": 45461605, "comment_id": 77885889, "body": "No - it enters the built in bootloader."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501681649, "post_id": 45461605, "comment_id": 77885948, "body": "That&#39;s what I mean, so it&#39;s a warm-start or whatever the bootloader provides, but OP wants to share his function between <i>his</i> bootloader and application code."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501681742, "post_id": 45461605, "comment_id": 77886027, "body": "So he needs to write his own one. Probably I have misunderstood his question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501681888, "post_id": 45461605, "comment_id": 77886158, "body": "His question might admittedly already be <i>too broad</i> ... but whatever hides behind your &quot;second option&quot; seems to be what he&#39;s interested in ;) (that&#39;s why I tried to sketch a solution <b>without</b> knowing Cortex myself, and I thought you might be able to write a better one)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501681998, "post_id": 45461605, "comment_id": 77886244, "body": "Writing own bootloader is not an easy task and I afraid if it is possible to cover this topic in the simple answer on the forum. In this case question is I agree too broad. BTW how did you format my code. I was trying but the attribute part was all the time bold"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501682416, "post_id": 45461605, "comment_id": 77886590, "body": "inside a list, you have to put <i>another</i> 4 spaces for each indentation level of the list in front of each code line :)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501687173, "post_id": 45461605, "comment_id": 77890418, "body": "@Felix Palmen  Thanks :)"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501681416, "last_edit_date": 1501681416, "creation_date": 1501678838, "answer_id": 45461605, "question_id": 45459776, "link": "https://stackoverflow.com/questions/45459776/how-can-i-use-one-function-from-main-application-and-bootloader-embedded/45461605#45461605", "title": "How can I use one function from main application and bootloader? (embedded)", "body": "<p>Two possible scenarios:</p>\n\n<ol>\n<li><p>Built in bootloader. In all Cortex cores I know. Here is an example code to invoke the bootloader from the application.</p>\n\n<pre><code>#define SYSFLASH 0x1FFFD800\n\nvoid __attribute__((noreturn)) StartBootLoader(void) {\n\n    void (*BootLoad)(void) = (void (*)(void))(SYSFLASH + 4);\n\n    HAL_RCC_DeInit();  // Only the example foe HAL. PLL has to switched off, peripheral clocks as well \n    HAL_DeInit();      // All interrupts have to be disabled. \n                   // if HAL not used uC should be restored to the power-on state\n\n    SysTick -&gt; CTRL = 0;\n    SysTick -&gt; LOAD = 0;\n    SysTick -&gt; VAL = 0;\n\n    __set_PRIMASK(1);\n\n    __set_MSP(*(uint32_t *)SYSFLASH);\n    BootLoad();\n    while(1);\n}\n</code></pre></li>\n<li><p>Custom bootloader - any scenario possible</p></li>\n</ol>\n"}], "owner": {"reputation": 529, "user_id": 6290005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/490d79ddd3c49d5133ea5eec8899552d?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142", "link": "https://stackoverflow.com/users/6290005/micha%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 1, "accepted_answer_id": 45460657, "answer_count": 3, "score": 1, "last_activity_date": 1506937582, "creation_date": 1501673706, "last_edit_date": 1506937582, "question_id": 45459776, "link": "https://stackoverflow.com/questions/45459776/how-can-i-use-one-function-from-main-application-and-bootloader-embedded", "title": "How can I use one function from main application and bootloader? (embedded)", "body": "<p>First of all I need to say I develop application for embedded device based on cortex m4.</p>\n\n<p>I have functions that are common for bootloader and main application. For now I compile source files 2 times once for bootloader and app. But I am running short on space for dual bank dfu and I would like to have those functions only once in ROM. Any idea how can I achieve this? </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Using functions pointers maybe danger in some cases, check on my problems - <a href=\"https://stackoverflow.com/questions/46520290/using-pointer-functions-2-seperate-applications-on-1-device\">Using pointer functions - 2 seperate applications on 1 device</a></p>\n"}, {"tags": ["c", "windows", "kernel", "driver", "dma"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1501673881, "post_id": 45459641, "comment_id": 77879607, "body": "I am not expert on the subject, but it seems to me that this question may get put on hold as too broad. In general you should ask only one specific question at the time to make it easier to answer. Please <a href=\"https://stackoverflow.com/posts/45459641/edit\">edit</a> your question and try to increase focus on specific area, and remove parts that aren&#39;t necessary or can be asked separately."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1501675077, "post_id": 45459641, "comment_id": 77880424, "body": "<b>1.</b> use or <code>MmAllocateContiguousMemorySpecifyCache</code> or (better for you) <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff554489\" rel=\"nofollow noreferrer\"><code>MmAllocatePagesForMdlEx</code></a> with <code>MM_ALLOCATE_REQUIRE_CONTIGUOUS_CHUNKS</code> flag (win7+). <b>2.</b> <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff554629(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>MmMapLockedPagesSpecifyCache</code></a> with <i>AccessMode=UserMode</i> - *  The routine returns a user address that is valid in the context of the process in which the driver is running*"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1501675821, "post_id": 45459641, "comment_id": 77881012, "body": "in case use <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff554464(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>MmAllocateContiguousMemorySpecifyCache</code></a> you will be need then allocate space for <i>MDL</i> call <code>MmInitializeMdl</code> (macro) and <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff554498(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>MmBuildMdlForNonPagedPool</code></a> finally"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501677221, "post_id": 45459641, "comment_id": 77882176, "body": "You can look at <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366887(v=vs.85).aspx\" rel=\"nofollow noreferrer\">VirtualAlloc</a> and <a href=\"https://msdn.microsoft.com/en-us/library/ee483154.aspx\" rel=\"nofollow noreferrer\">VirtualCopy</a>. VirtualCopy is accessible only from the driver mode and allows you to map the virtual address to some fixed physical address. In your case, the application can call VirtualAlloc and pass the virtual address to the driver. The driver can then map it to a fixed physical address and pass it to the FPGA. Finally you will have to pin these pages."}], "owner": {"reputation": 31, "user_id": 7977719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2e46d2c371b9a1af46799f804d3707?s=128&d=identicon&r=PG&f=1", "display_name": "Jones", "link": "https://stackoverflow.com/users/7977719/jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501681811, "creation_date": 1501673385, "last_edit_date": 1501681811, "question_id": 45459641, "link": "https://stackoverflow.com/questions/45459641/kernel-mode-driver-development-in-windows", "title": "Kernel-Mode Driver Development in Windows", "body": "<p>I'm developing a new Kernel-Mode driver, that should run on Windows 10 (64-bit). </p>\n\n<p>This driver should allocate 48GB of <strong><em>continuous physical</em></strong> memory, and map it (its base address) to a virtual address in the user space of the Windows application that will use it. The system actually has 64GB of RAM installed on it, so it might be needed to make a segment of the memory dedicated for this use, perhaps by changing a boot entry information.</p>\n\n<p>In addition, the driver should reveal its base address somehow to an FPGA-based device, located on the PCIe slot. The purpose of this, is to use this 48GB of continuous physical allocated memory, as a DMA (Direct Memory Access). Namely, the FPGA-based device will generate data, and write it at the appropriate location in the DMA. The host software will try to read from that location, in a cyclic fashion. That is, the FPGA will override the data in the buffer, and the host will try to keep the pace, and read that data before it is overridden.</p>\n\n<p>Please note that this question only deals with the host side (the driver), and not with the FPGA side.</p>\n\n<p>So, basically my questions are:</p>\n\n<ol>\n<li><p>How do I make such an allocation (as described above)?</p></li>\n<li><p>How do I map the base address from the virtual address in the Kernel-Space, to the appropriate virtual address in the User-Space?</p></li>\n<li><p>How do I reveal that base address to the FPGA (located on the PCIe slot), so it will know where to perform its write operations?</p></li>\n<li><p>What other Callback-Functions should this driver implement, in terms of events handling?</p></li>\n</ol>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["android", "c", "sockets", "android-ndk"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1501702295, "post_id": 45458573, "comment_id": 77899849, "body": "The problem is somewhere in the code you won&#39;t show us. Questions like these without code are off-topic."}, {"owner": {"reputation": 21, "user_id": 8404491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b925bedef9afd0219a05fb1b1ff009f8?s=128&d=identicon&r=PG&f=1", "display_name": "DominikS.", "link": "https://stackoverflow.com/users/8404491/dominiks"}, "reply_to_user": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1501764985, "post_id": 45458573, "comment_id": 77930220, "body": "Sorry for that. I added the code. Thank you!"}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1501766946, "post_id": 45458573, "comment_id": 77931919, "body": "What if instead of reinstall you simply force stop the app? Or clear data?"}, {"owner": {"reputation": 21, "user_id": 8404491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b925bedef9afd0219a05fb1b1ff009f8?s=128&d=identicon&r=PG&f=1", "display_name": "DominikS.", "link": "https://stackoverflow.com/users/8404491/dominiks"}, "edited": false, "score": 0, "creation_date": 1501768736, "post_id": 45458573, "comment_id": 77933615, "body": "Stopping does not help as well as clearing the data. In fact, reinstalling the applications via Android Studio does not help. Only manually uninstalling (in the Android app settings) helps, after the error occurs for the first time."}], "owner": {"reputation": 21, "user_id": 8404491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b925bedef9afd0219a05fb1b1ff009f8?s=128&d=identicon&r=PG&f=1", "display_name": "DominikS.", "link": "https://stackoverflow.com/users/8404491/dominiks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1502208745, "creation_date": 1501670457, "last_edit_date": 1502208745, "question_id": 45458573, "link": "https://stackoverflow.com/questions/45458573/android-ndk-non-deterministic-socket-connect-time-out", "title": "Android NDK non-deterministic Socket connect() time out", "body": "<p>I have problems with client/server application that is part of a bigger system for distributed computing. The clients are Android devices that run a native Android NDK application written in C. At some point the clients send registration messages to the server application, which is also written in C and runs on a windows machine. </p>\n\n<p>The weird thing is, right after installing the Android application on the device everything works fine. However, after a while the Socket problem starts. All <code>connect()</code> function calls end with a time out on the client side. The error is not deterministic and occurs at different points in time. To make it work again, I have to uninstall the application in Android manually and reinstall it. After that I works for some time and then the error starts again. The same C code is used on clients that run on normal windows PCs and there the problem does not occur. </p>\n\n<p>The network connection is fine and I checked, if the server ports are open and reachable with the Simple Socket Tester app from the client device. I also gave Android the permission for Internet use and the parameters of the <code>connect()</code> call are correct.</p>\n\n<p>EDIT:</p>\n\n<p>Sorry for the missing code. I thought the error is obvious and based on the different platforms, since it works on windows and I am not that experienced in Android NDK. Here is the code:</p>\n\n<pre><code>int pi_connect(SOCKET s, const SOCKADDR *name, int namelen) \n{\n\n    int result = connect(s, name, namelen);\n\n    if (result &lt; 0) {\n        ALOG(\"Socket connecting error!\");\n\n        return -1;\n    }\n\n    return result;\n}\n\nSOCKET pi_socket(int af, int type, int protocol) {\n\n    SOCKET returnSocket = socket(af, type, protocol);\n    int yes = 1;\n    if (setsockopt(returnSocket, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(int)) == -1)\n    {\n        perror(\"Server-setsockopt() error!\");\n        exit(1);\n    }\n\n    if (returnSocket &lt; 0) {\n        ALOG(\"Socket creation error!\");\n\n        return -1;\n    }\n\n    return returnSocket;\n}\n\nSOCKET setupSendSocket(u_long host, int hostPort) {\n    SOCKET sendingSocket;\n    SOCKADDR_IN addr;\n\n    sendingSocket = pi_socket(AF_INET, SOCK_STREAM, 0);\n\n    memset(&amp;addr, 0, sizeof(SOCKADDR_IN));\n    addr.sin_family = AF_INET;\n    addr.sin_port = htons(hostPort);\n    addr.sin_addr.s_addr = host;\n\n    long rc = pi_connect(sendingSocket, (SOCKADDR*) &amp;addr, sizeof(SOCKADDR));\n    if (rc &lt; 0) {\n        return 0;\n    } \n    return sendingSocket;\n}\n\nvoid requestOwnIP() {\n\n    SOCKET connectedIPSocket = setupSendSocket(inet_addr(brokerIP), 34123);\n\n    if(connectedIPSocket==0)\n        return;\n\n    sendBHeartbeatMessage(connectedIPSocket);\n\n    myIP = receiveBIPMessage(connectedIPSocket);\n\n    pi_closesocket(connectedIPSocket);\n}\n</code></pre>\n\n<p>The <code>requestOwnIP()</code> function is called in the main function of the NDK application.</p>\n\n<p>EDIT 2 (some new remarks): After rebooting the device, the <code>connect()</code> is successful again and the system works for some time. Is there something stored in the process table of the operating system, that can cause this problem? I first though that it could be a high amount of sockets that are in the <code>time_wait</code> state, but I added SO_REUSEADDR and the problem is still occurring. </p>\n\n<p>I would really appreciate some help. Thank you in advance!</p>\n\n<p>Regards\nDominik</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 7, "creation_date": 1501670016, "post_id": 45458306, "comment_id": 77876851, "body": "This code is incomplete and does not compile. A SEGFAULT in such a tiny program is a good time to start learning to debug. Use gdb to run your code and check where the crash happens."}, {"owner": {"reputation": 2076, "user_id": 1866196, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TrCUq.png?s=128&g=1", "display_name": "skrtbhtngr", "link": "https://stackoverflow.com/users/1866196/skrtbhtngr"}, "edited": false, "score": 1, "creation_date": 1501670024, "post_id": 45458306, "comment_id": 77876856, "body": "Are you passing any command line argument?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1501670070, "post_id": 45458306, "comment_id": 77876898, "body": "You do not verify that <code>argc</code> is at least 2."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1501670120, "post_id": 45458306, "comment_id": 77876935, "body": "It happens because you&#39;re <b>not</b> passing a command-line argument - you must run this program as <code>.&#47;a.out hostname.com</code> / complain if <code>argc</code> is less than <code>2</code>. IOW, this is not a MCVE."}], "answers": [{"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1501670898, "post_id": 45458711, "comment_id": 77877500, "body": "The OP could also simply run the program in GDB and wait for the crash."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1801517"}, "is_accepted": false, "score": 0, "last_activity_date": 1501670809, "creation_date": 1501670809, "answer_id": 45458711, "question_id": 45458306, "link": "https://stackoverflow.com/questions/45458306/how-can-i-resolve-this-error-segmentation-fault/45458711#45458711", "title": "How can I resolve this error: segmentation fault?", "body": "<p>If you use linux,</p>\n\n<pre><code> ulimit -a\n ulimit -c ulimited // set core file size limitless\n</code></pre>\n\n<p>then run executable again.A core file will be created.This is snapshot of last stack before segmentation fault.</p>\n\n<pre><code>gdb [executable] core\n</code></pre>\n\n<p>Now You can see where segmentation fault raises.</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 8404771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b63501afefe61d978976cf9b9c0e72?s=128&d=identicon&r=PG&f=1", "display_name": "HRN", "link": "https://stackoverflow.com/users/8404771/hrn"}, "is_accepted": true, "score": 0, "last_activity_date": 1501671193, "creation_date": 1501671193, "answer_id": 45458854, "question_id": 45458306, "link": "https://stackoverflow.com/questions/45458306/how-can-i-resolve-this-error-segmentation-fault/45458854#45458854", "title": "How can I resolve this error: segmentation fault?", "body": "<p>I think your problem lies here</p>\n\n<pre><code>hp = gethostbyname(argv[1]);\n</code></pre>\n\n<p>you should have sent something on console as parameter otherwise this space (argv[1]) is invalid thus segmentation fault occurs.</p>\n\n<p>In your case parameter should be name of computer you are trying to connect to. For example:</p>\n\n<pre><code>./program hosToConnectTo\n</code></pre>\n\n<p>should do the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 493, "user_id": 7613023, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d26b07176f47775da4e7a02530bd599b?s=128&d=identicon&r=PG&f=1", "display_name": "ilomax", "link": "https://stackoverflow.com/users/7613023/ilomax"}, "is_accepted": false, "score": 0, "last_activity_date": 1501674203, "creation_date": 1501674203, "answer_id": 45459962, "question_id": 45458306, "link": "https://stackoverflow.com/questions/45458306/how-can-i-resolve-this-error-segmentation-fault/45459962#45459962", "title": "How can I resolve this error: segmentation fault?", "body": "<p>You need to check that <code>argc[1]</code> exists.\nA simple :</p>\n\n<pre><code>if (!argv[1])\n   return (-1);\n</code></pre>\n\n<p>will probably do the trick.</p>\n\n<p>Tip : Valgrind and GDB are two very powerful tools to find where your errors come from and solve them.</p>\n\n<p>It takes a bit of time to get used to reading the logs from these but I guarantee that once you'll be used to it, not only will most of your timeouts and SegFaults be much easier to solve but you'll also be able to optimise the memory consumption of your programs as it tracks memory leaks, allocs and free(s).</p>\n"}], "owner": {"reputation": 13, "user_id": 8018325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jMqh-jjAOKw/AAAAAAAAAAI/AAAAAAAAEUE/rgtRJDe6tl0/photo.jpg?sz=128", "display_name": "Phillip Musumba", "link": "https://stackoverflow.com/users/8018325/phillip-musumba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 45458854, "answer_count": 3, "score": -2, "last_activity_date": 1550029403, "creation_date": 1501669810, "last_edit_date": 1550029403, "question_id": 45458306, "link": "https://stackoverflow.com/questions/45458306/how-can-i-resolve-this-error-segmentation-fault", "title": "How can I resolve this error: segmentation fault?", "body": "<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n\nint main(int argc, char *argv[]){\n\n    int sockfd;\n    struct sockaddr_in serv_addr;\n    struct hostent *hp;\n    char buff[100];\n\n    //Create socket\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd &lt; 0){\n        perror(\"Failed to create socket!\");\n        exit(1);\n    }\n\n    serv_addr.sin_family = AF_INET;\n    hp = gethostbyname(argv[1]); *\n</code></pre>\n\n<p>I think the error might be on the above line but I don't know how to solve\nthis.</p>\n\n<p><em>When I compile, build and run this code in Geany, Linux, I get a segmentation fault error message. Why is it so and how can I resolve it?</em></p>\n"}, {"tags": ["c", "linux", "operating-system", "kernel"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1501669796, "post_id": 45458043, "comment_id": 77876702, "body": "Yes one process can access memory of another process if both have some virtual page mapped to the same physical page. That&#39;s the point of mapping a physical page to more than one process --- so that they can share memory."}, {"owner": {"reputation": 111, "user_id": 6667391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56cea37968af33ea03cb7c596ff1c5d?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Khandkar", "link": "https://stackoverflow.com/users/6667391/jay-khandkar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1501669914, "post_id": 45458043, "comment_id": 77876780, "body": "@n.m. So <code>__count</code> will be greater than 1 only if the processes are using shared memory?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1501670067, "post_id": 45458043, "comment_id": 77876895, "body": "or you can look at it the other way: shared memory is implemented by mapping the same physical page to multiple virtual pages in different processes."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1501670099, "post_id": 45458043, "comment_id": 77876919, "body": "I don&#39;t know if it is &quot;if and only if&quot;. There might be other cases, not sure."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 1, "creation_date": 1501670597, "post_id": 45458043, "comment_id": 77877277, "body": "Also, executable code (and other read-only section) from runnable files (executables and shared objects) is usually shared between all processes that use them."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1501672641, "post_id": 45458043, "comment_id": 77878720, "body": "This also happens when both processes use same code (an executable program or a shared library)."}], "owner": {"reputation": 111, "user_id": 6667391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56cea37968af33ea03cb7c596ff1c5d?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Khandkar", "link": "https://stackoverflow.com/users/6667391/jay-khandkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501669567, "creation_date": 1501669119, "last_edit_date": 1501669567, "question_id": 45458043, "link": "https://stackoverflow.com/questions/45458043/how-can-a-page-frame-be-assigned-to-more-than-one-process", "title": "How can a page frame be assigned to more than one process?", "body": "<p>I'm reading the book \"Understanding the linux kernel\", and this is what it says about the <code>__count</code> field of the page descriptor (<code>struct page</code>) :</p>\n\n<blockquote>\n  <p>_count:</p>\n  \n  <p>A usage reference counter for the page. If it is set to - 1, the corresponding page\n  frame is free and can be assigned to any process or to the kernel itself. If it is set\n  to a value greater than or equal to 0, the page frame is assigned to <strong>one or more\n  processes</strong> or is used to store some kernel data structures. The page_count() func-\n  tion returns the value of the _count field increased by one, that is, the number of\n  users of the page.</p>\n</blockquote>\n\n<p>My question is, if the same page is assigned to two processes, can't one process access memory assigned to the other by just decrementing/incrementing the linear address by a value smaller than <code>PAGE_SIZE</code>?</p>\n"}, {"tags": ["c", "linux", "windows", "gtk", "cross-compiling"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501669149, "post_id": 45457803, "comment_id": 77876215, "body": "Either that or link statically."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8102522"}, "edited": false, "score": 0, "creation_date": 1501669499, "post_id": 45457803, "comment_id": 77876462, "body": "@FelixPalmen I didn&#39;t understand what you mean??"}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "edited": false, "score": 0, "creation_date": 1501670660, "post_id": 45457803, "comment_id": 77877324, "body": "You must have the Gtk runtime on the windows 10 machine. It must be the same version as the one you compiled on linux.  The Gtk runtime is a huge set of files, not only those listed there... as soon as you copy those, windows will complain for some more. Then you have the themes, etc..."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8404771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b63501afefe61d978976cf9b9c0e72?s=128&d=identicon&r=PG&f=1", "display_name": "HRN", "link": "https://stackoverflow.com/users/8404771/hrn"}, "is_accepted": false, "score": 0, "last_activity_date": 1501670497, "creation_date": 1501670497, "answer_id": 45458585, "question_id": 45457803, "link": "https://stackoverflow.com/questions/45457803/unable-to-run-c-gtk-program-compiled-in-linux-with-mingw-cross-compiler-in-windo/45458585#45458585", "title": "Unable to run C GTK program compiled in Linux with mingw cross compiler in windows", "body": "<p>It could be because of linking executable against shared libraries instead of static libraries. Shared libraries which your program is linked with are on your linux only they do not exist on windows thus it cannot be run under windows. If you want to successfully cross compile your program you can either compile your program statically which makes it executable on windows however the resulting exe is quite large, or you could search for and install missing dlls on your windows then re run your program and see what happens.</p>\n\n<p>About Gtk not being installed on your compter, Ofcourse you should install it first then check to see if other libraries are missing</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8102522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501670497, "creation_date": 1501668435, "question_id": 45457803, "link": "https://stackoverflow.com/questions/45457803/unable-to-run-c-gtk-program-compiled-in-linux-with-mingw-cross-compiler-in-windo", "title": "Unable to run C GTK program compiled in Linux with mingw cross compiler in windows", "body": "<p>I had made a C GTK program in Linux(<a href=\"https://developer.gnome.org/gtk3/stable/gtk-getting-started.html#id-1.2.3.5\" rel=\"nofollow noreferrer\">simple gtk window program</a>) and I have compiled it with mingw cross compiler in Linux mint with <a href=\"https://stackoverflow.com/questions/45444811/how-to-compiling-c-gtk3-program-in-linux-mint-for-windows\">this</a> way.now I had send the a.exe file to my windows 10 computer to execute it.but when I click on a.exe file in windows 10 it says </p>\n\n<p><code>the program can't start because &lt;some files that I have listed in notepad in scrennshot&gt; is missing from your computer.try reinstalling the program to fix this problem</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/pD8C9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pD8C9.png\" alt=\"enter image description here\"></a></p>\n\n<p>My windows 10 doesn't have gtk installed on it.<strong>Do I need to Install gtk In my windows 10 machine?</strong></p>\n"}, {"tags": ["c", "sockets", "network-programming"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1501668566, "post_id": 45457764, "comment_id": 77875827, "body": "A classic and standard approach is <code>select()</code> or <code>poll()</code>. For high load, you need platform-dependent alternatives (like e.g. Linux&#39; <code>epoll()</code>) or a library abstracting them like <code>libevent</code>. As a question, this is too broad, sorry."}, {"owner": {"reputation": 671, "user_id": 2637717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1247081437/picture?type=large", "display_name": "Adit Ya", "link": "https://stackoverflow.com/users/2637717/adit-ya"}, "edited": false, "score": 0, "creation_date": 1501669058, "post_id": 45457764, "comment_id": 77876153, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4200172/c-socket-programming-connecting-multiple-clients-to-server-using-select\">C, socket programming: Connecting multiple clients to server using select()</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501669565, "post_id": 45457764, "comment_id": 77876509, "body": "Note, from &#39;man recv()&#39;: &#39;These calls return the number of bytes received, or -1 if an error occurred&#39;.  So, this &#39;buffer[data_len] = &#39;\\0&#39;&#39; would then be UB from an underflow write, (-1 not being false) ;("}, {"owner": {"reputation": 23, "user_id": 8076911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3a6efb6986b1e0c54f86b3f6f9b0fde6?s=128&d=identicon&r=PG&f=1", "display_name": "pratap", "link": "https://stackoverflow.com/users/8076911/pratap"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501669732, "post_id": 45457764, "comment_id": 77876645, "body": "@MartinJames that operation will be performed only if some data is received. I&#39;m checking the condition just above it.. see"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501670257, "post_id": 45457764, "comment_id": 77877038, "body": "@pratap &#39;that operation will be performed only if some data is received.&#39; no, it won&#39;t:(  recv() can also return on an error, and will return &#39;-1&#39; which, not being 0, (ie. not false), the &#39;if&#39; test will pass and the out-of-bounds write will occur: UB;("}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501668733, "post_id": 45457849, "comment_id": 77875935, "body": "While this could work, it&#39;s not a necessity to use threads and event-based implementations are often preferred. I don&#39;t think such a hint qualifies as an <i>answer</i>, it should better be a comment."}, {"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1501668939, "post_id": 45457849, "comment_id": 77876081, "body": "I can&#39;t yet post comments, I joined StackOverflow yesterday."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501669069, "post_id": 45457849, "comment_id": 77876159, "body": "That&#39;s not a good reason to post as an answer instead. Try to find some questions that allow for a direct and complete answer and answer these, and you will have enough reputation to write comments very quickly."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1501669335, "post_id": 45457849, "comment_id": 77876353, "body": "@FelixPalmen He is certainly mistaken to use the word &#39;need&#39;. He should either have said &#39;can&#39; or mentioned non-blocking multiplexed I/O, and also asynchronous I/O, which I don&#39;t see in your comments anywhere as a third solution. However this answer is certainly much more than a comment, and there is certainly &#39;could work&#39; about it: it <i>will</i> work."}, {"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1501669694, "post_id": 45457849, "comment_id": 77876614, "body": "@EJP indeed, I should have been more precise and used &#39;can&#39; rather than &#39;need&#39;. I&#39;ll made some edit about it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1501671644, "post_id": 45457849, "comment_id": 77877995, "body": "@EJP it <i>will</i> work depending on the scenario. With moderate work, any of the three alternatives you mention will work, of course. It&#39;s more like an answer in the current state, but the original version really wasn&#39;t more than a hint. As I read the help pages here, something just &quot;<i>pointing into the right direction</i>&quot; indeed <i>can</i> be an answer, it&#39;s probably not a good one without explanations."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1501672376, "post_id": 45457849, "comment_id": 77878525, "body": "@FelixPalmen I am unable to understand you. Starting a new thread per connection is what about 90% of the TCP servers on the planet already do. It will work when executed correctly. There is, and was, nothing comment-like about this answer whatsoever."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501673033, "post_id": 45457849, "comment_id": 77879031, "body": "The aren&#39;t that much different anyway, for many purposes.  Thread-per-connection, and the state-machine for handling multiple clients and calls that may block is supported by the kernel.  Select/poll, and the the state-machine for handling multiple clients must be provided by user code, as should an async strategy for avoiding blocking calls.  Pick your poison..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1501673438, "post_id": 45457849, "comment_id": 77879281, "body": "@EJP This is a <i>hint</i> in <i>one possible</i> direction just throwing in the name of a technique, and, in it&#39;s original one-sentence form, didn&#39;t explain anything about it. Depending on how you read the site rules, it could be considered a partial answer, but something like this is always better posted as a comment."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1501730864, "post_id": 45457849, "comment_id": 77909091, "body": "@FelixPalmen That stance would eliminate 90% of answers on this topic. It&#39;s an extremely well-known solution. It doesn&#39;t need elaborating every time it is mentioned."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1501737282, "post_id": 45457849, "comment_id": 77911074, "body": "@EJP which is a clear sign the question itself is too broad. There <b>are</b> a lot of possible answers, and I don&#39;t agree: <b>all</b> of them should be explained when mentioned in an answer."}], "tags": [], "owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "is_accepted": false, "score": 0, "last_activity_date": 1501670316, "last_edit_date": 1501670316, "creation_date": 1501668580, "answer_id": 45457849, "question_id": 45457764, "link": "https://stackoverflow.com/questions/45457764/how-to-handle-multiple-clients-in-socket-programming/45457849#45457849", "title": "How to handle multiple clients in socket programming?", "body": "<p>You can use multithreading to manage multiple clients at one time, so the server can listen \"at the same time\" new connections while waiting for each client messages to be received.</p>\n\n<p>When your server call <code>accept()</code>, if no client is joining, the call will \"block\" the execution until someone is joining.</p>\n\n<p>Then, for the same reason, the call of <code>recv()</code> will block the main thread until a client has sent a message.</p>\n\n<p>Using multithreading will cause the blocking of <code>recv()</code> and <code>accept()</code> won't affect the main thread.</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 8404771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b63501afefe61d978976cf9b9c0e72?s=128&d=identicon&r=PG&f=1", "display_name": "HRN", "link": "https://stackoverflow.com/users/8404771/hrn"}, "is_accepted": false, "score": 1, "last_activity_date": 1501670204, "creation_date": 1501670204, "answer_id": 45458463, "question_id": 45457764, "link": "https://stackoverflow.com/questions/45457764/how-to-handle-multiple-clients-in-socket-programming/45458463#45458463", "title": "How to handle multiple clients in socket programming?", "body": "<p>There are a couple of strategies to handle multiple clinets on server.\nFirst is to use threading which means a new thread is assigned to each new client and handles all its traffics. This way main thread is not blocked by read/write or rec/send system calls and is free to handle new incomming clients.\nSecond strategy is to use Non blocking I/O which is a little harder than the first strategy but it is quite good in both performance and resource consumption.\nThird strategy is to use a unique port number for each client, some commercial programs use this strategy but I do not personnaly advise towards it. If I were to write a server application, which I have done more than that could be counted, I would have chosen non blocking I/O, although it's a little hard to get it to work for first few tries, but it is quite worth it and work in any way better than all other strategies.\nSearch for nonblocking I/O and select() for furthur instructions</p>\n"}], "owner": {"reputation": 23, "user_id": 8076911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3a6efb6986b1e0c54f86b3f6f9b0fde6?s=128&d=identicon&r=PG&f=1", "display_name": "pratap", "link": "https://stackoverflow.com/users/8076911/pratap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4938, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1501671615, "creation_date": 1501668339, "question_id": 45457764, "link": "https://stackoverflow.com/questions/45457764/how-to-handle-multiple-clients-in-socket-programming", "title": "How to handle multiple clients in socket programming?", "body": "<p>I'm new in socket programming. I'm trying to make simple client, server program where the message sent from client appears on the server window. However it works for only one client. How to handle multiple clients. Thanks in advance.\nHere's my code<br>\nServer.c  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n#define ERROR -1\n#define MAX_DATA 1024\n\nint main(){\n  int welcomeSocket, newSocket;\n  char buffer[MAX_DATA];\n  int data_len;\n  struct sockaddr_in serverAddr;\n  int addr_size = sizeof(struct sockaddr_in);\n\n  if((welcomeSocket = socket(PF_INET, SOCK_STREAM, 0)) == ERROR){\n    printf(\"Socket: \");\n    exit(-1);\n  }\n  /* Configure settings of the server address struct */\n  serverAddr.sin_family = AF_INET;\n  serverAddr.sin_port = htons(9999);\n  serverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n  /* Set all bits of the padding field to 0 */\n  memset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero);  \n\n  /* Bind the server address struct to the socket */\n  bind(welcomeSocket, (struct sockaddr *) &amp;serverAddr, sizeof(serverAddr));\n\n  /* Listen on the socket, with 5 max connection requests queued */\n  if(listen(welcomeSocket,5) == 0)\n    printf(\"Listening\\n\");\n  else\n    printf(\"Error\\n\");\n\n  while(1){\n    /* Accept call for the incoming connection */\n    if((newSocket = accept(welcomeSocket, (struct sockaddr *)&amp;newSocket, &amp;addr_size)) == ERROR){\n      perror(\"accept\");\n      exit(-1);\n    }\n    data_len = 1;\n    while(data_len){\n      /* receive msg and print */\n      data_len = recv(newSocket, buffer, MAX_DATA, 0);\n      if(data_len){\n        buffer[data_len] = '\\0';\n        printf(\"%s\\n\", buffer);\n      }\n    }\n  }\n  printf(\"Client Disconnected\\n\");\n  close(newSocket);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "backtrace", "openbsd"], "comments": [{"owner": {"reputation": 671, "user_id": 2637717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1247081437/picture?type=large", "display_name": "Adit Ya", "link": "https://stackoverflow.com/users/2637717/adit-ya"}, "edited": false, "score": 0, "creation_date": 1501668733, "post_id": 45457154, "comment_id": 77875936, "body": "I don&#39;t have an answer if an API as such is available for OpenBSD. But if you want to implement one, please see if you could use &quot;libunwind-ptrace&quot; in OpenBSD. If its ported, use this link tutorial on fetching the backtrace .. <a href=\"https://gist.github.com/crimsonwoods/4122796\" rel=\"nofollow noreferrer\">gist.github.com/crimsonwoods/4122796</a>"}, {"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "reply_to_user": {"reputation": 671, "user_id": 2637717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1247081437/picture?type=large", "display_name": "Adit Ya", "link": "https://stackoverflow.com/users/2637717/adit-ya"}, "edited": false, "score": 0, "creation_date": 1502279307, "post_id": 45457154, "comment_id": 78138302, "body": "@AditYa Unfortunately OpenBSD is not supported by libunwind. I tried to compile it too, but to no avail."}], "answers": [{"comments": [{"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502278537, "post_id": 45473011, "comment_id": 78137761, "body": "Thanks, didn&#39;t know about gnulib. The problem with it is that it&#39;s not compiled as a library but must be directly integrated into the project, which means the project must also use GNU autotools."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "reply_to_user": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502289394, "post_id": 45473011, "comment_id": 78146806, "body": "Can&#39;t you just copy the files and integrate them with your buildsystem?"}, {"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502343617, "post_id": 45473011, "comment_id": 78169476, "body": "It is not that easy because: 1. the header (execinfo.h) is not static but generated from execinfo.in.h; 2. besides the header/source files, there are also m4 files which contain macros used in the code"}, {"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502344063, "post_id": 45473011, "comment_id": 78169623, "body": "Looking more closely at the source code (<a href=\"http://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob;f=lib/execinfo.c;h=0bcd9f078baaa6e8b0119630024ad762d8299960;hb=HEAD\" rel=\"nofollow noreferrer\">execinfo.c</a> <a href=\"http://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob;f=lib/execinfo.in.h;h=67ab08127bb0ea12aca3a8ff766194cfa4da72a5;hb=HEAD\" rel=\"nofollow noreferrer\">execinfo.in.h</a>) it seems that the functions are not even implemented. The source file just includes the header and the header contains an empty implementation."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "reply_to_user": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502344238, "post_id": 45473011, "comment_id": 78169689, "body": "Oh, that&#39;s bad. There&#39;s another implementation at source forge that&#39;s specific to openbsd..."}, {"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502345008, "post_id": 45473011, "comment_id": 78169993, "body": "I searched for gnulib on sourceforge but there is no relevant result. Do you have a link?"}, {"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1502453523, "post_id": 45473011, "comment_id": 78228836, "body": "Thanks, this one seems to work. The format of the trace is slighly different: <code>0x15f043f0 &lt;backtrace+32&gt; at .&#47;a.out</code>, and addr2line or gdb can&#39;t tell me the line for that address, but I guess there should be a way."}], "tags": [], "owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "is_accepted": false, "score": 1, "last_activity_date": 1502433486, "last_edit_date": 1502433486, "creation_date": 1501720607, "answer_id": 45473011, "question_id": 45457154, "link": "https://stackoverflow.com/questions/45457154/is-there-a-way-to-show-call-stack-programatically-on-openbsd/45473011#45473011", "title": "Is there a way to show call stack programatically on OpenBSD?", "body": "<p>On OpenBSD, you can use <a href=\"https://sourceforge.net/projects/backtrace/\" rel=\"nofollow noreferrer\">this implementation</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "edited": false, "score": 0, "creation_date": 1506325939, "post_id": 46375221, "comment_id": 79757313, "body": "I originally tested on an OpenBSD 5.8 where this package isn&#39;t available. But the question being version agnostic, I think this is the better answer."}], "tags": [], "owner": {"reputation": 121, "user_id": 8022149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e561e069dbc5a3fda6f934efe1e04b0c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul H. Hargrove", "link": "https://stackoverflow.com/users/8022149/paul-h-hargrove"}, "is_accepted": true, "score": 3, "last_activity_date": 1506131207, "creation_date": 1506131207, "answer_id": 46375221, "question_id": 45457154, "link": "https://stackoverflow.com/questions/45457154/is-there-a-way-to-show-call-stack-programatically-on-openbsd/46375221#46375221", "title": "Is there a way to show call stack programatically on OpenBSD?", "body": "<p>Not sure when it first appeared, but there <em>is</em> a libexecinfo for OpenBSD 6.1 which implements the <code>backtrace()</code> and <code>backtrace_symbols()</code> functions:</p>\n\n<pre><code>{openbsd-amd64 ~}$ pkg_info libexecinfo\nInformation for inst:libexecinfo-0.3v0\n\nComment:\nclone of backtrace facility found in the GNU libc\n\nDescription:\nThis is a quick-n-dirty BSD licensed clone of backtrace facility found\nin the GNU libc, mainly intended for porting linuxish code to BSD\nplatforms, however it can be used at any platform which has a gcc\ncompiler.\n\nMaintainer: The OpenBSD ports mailing-list &lt;ports@openbsd.org&gt;\n\nWWW: https://github.com/conformal/backtrace/wiki\n</code></pre>\n"}], "owner": {"reputation": 1956, "user_id": 423913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/044a270a95836821f6bfd2b5c0561f96?s=128&d=identicon&r=PG", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/423913/claudiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 46375221, "answer_count": 2, "score": 2, "last_activity_date": 1506131207, "creation_date": 1501666841, "question_id": 45457154, "link": "https://stackoverflow.com/questions/45457154/is-there-a-way-to-show-call-stack-programatically-on-openbsd", "title": "Is there a way to show call stack programatically on OpenBSD?", "body": "<p>Linux has the <code>backtrace()</code> function, which is a GNU extension.</p>\n\n<p>FreeBSD also introduced the <code>backtrace()</code> function since version 10.0, and NetBSD since version 7.0.</p>\n\n<p>Is there any way to accomplish this on OpenBSD?</p>\n"}, {"tags": ["c", "for-loop", "recursion", "static"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 11, "creation_date": 1501665370, "post_id": 45456517, "comment_id": 77873449, "body": "There is no recursion in your program."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 3, "creation_date": 1501665421, "post_id": 45456517, "comment_id": 77873490, "body": "In order for your program to have recursion you need to have a function that calls itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501665758, "post_id": 45456517, "comment_id": 77873721, "body": "There is no <i>stack</i> in C. If we assume an implementation using a <i>stack</i> for function calls, it&#39;s still uninteresting: there&#39;s just one function called repeatedly. Voting to close this as &quot;unclear what you&#39;re asking&quot; (but you might want to clarify)."}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 3, "last_activity_date": 1501666254, "last_edit_date": 1501666254, "creation_date": 1501665945, "answer_id": 45456764, "question_id": 45456517, "link": "https://stackoverflow.com/questions/45456517/recursion-in-c-programming/45456764#45456764", "title": "Recursion in C Programming", "body": "<p>First of all, there is no recursion in your program because there is no function at all that calls itself: neither <code>func()</code> calls <code>func()</code> nor <code>main()</code> calls <code>main()</code>.</p>\n\n<hr>\n\n<p>Since the variable <code>num</code> in the function <code>func()</code> is declared as <code>static</code>, all the calls to the function <code>func()</code> share a single copy of the variable <code>num</code>. This variable is <strong>initialized only once</strong>: the first time the function <code>func()</code> gets called. Its value is kept between calls (this variable is not allocated on the stack).</p>\n\n<p>In the following loop:</p>\n\n<pre><code>for (fun(); fun(); fun())\n   printf(\"%d \", fun());\n</code></pre>\n\n<p><code>func()</code> is called once at the very beginning and <em>3 times</em> on every loop iteration. </p>\n\n<p>Every time <code>func()</code> gets called, <code>num</code> is decremented by one. For that reason, each time the value returned by <code>func()</code> is displayed it is decremented by <em>three</em> \nwith respect to the last displayed value.</p>\n"}], "owner": {"reputation": 23, "user_id": 8332164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/42qHA.png?s=128&g=1", "display_name": "user8332164", "link": "https://stackoverflow.com/users/8332164/user8332164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1501667304, "answer_count": 1, "score": 0, "last_activity_date": 1501667161, "creation_date": 1501665286, "last_edit_date": 1501667161, "question_id": 45456517, "link": "https://stackoverflow.com/questions/45456517/recursion-in-c-programming", "closed_reason": "Duplicate", "title": "Recursion in C Programming", "body": "<p>It would be a mess if we keep using repetitive calling like this :)</p>\n\n<pre><code>int fun() \n{\n    static int num = 16;\n    return num--;\n}\n\nint main()\n{\n    for (fun(); fun(); fun())\n    printf(\"%d \", fun());\n    return 0;\n}\n</code></pre>\n\n<p>I know the concept of Static but I would like to know how this program works and prints output : <code>14 11 8 5 2</code></p>\n"}, {"tags": ["c++", "c", "vxworks", "rtos", "wind-river-workbench"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8158392, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vz0T9QwR_50/AAAAAAAAAAI/AAAAAAAAADE/8fVko8TE9yk/photo.jpg?sz=128", "display_name": "Sukum", "link": "https://stackoverflow.com/users/8158392/sukum"}, "edited": false, "score": 0, "creation_date": 1501753091, "post_id": 45478878, "comment_id": 77921236, "body": "Hi, Thanks for the solution, but unfortunately this makes a big project with a single binary. My requirement is to have DKM(.out) separately and link it to the Kernel Image Project probably using a build spec macro &quot;EXTRA_MODULES&quot;. I tried this but i&#39;m getting the following error:     dld: Redeclaration of __dso_handle dld: Redeclaration of _ctors Defined in ../../INT-AC-DKM-18/CD1_AM437X_VSB_ARMARCH7diab/INT-AC-DKM-1&zwnj;&#8203;8/Debug/INT-AC-DKM-1&zwnj;&#8203;8.out   and        ctdt.o dld: Redeclaration of _dtors . Any idea how to resolve this conflict?"}, {"owner": {"reputation": 2532, "user_id": 2139094, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b7f096622f36595ba50f9d65a39508a?s=128&d=identicon&r=PG", "display_name": "mjs", "link": "https://stackoverflow.com/users/2139094/mjs"}, "reply_to_user": {"reputation": 37, "user_id": 8158392, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vz0T9QwR_50/AAAAAAAAAAI/AAAAAAAAADE/8fVko8TE9yk/photo.jpg?sz=128", "display_name": "Sukum", "link": "https://stackoverflow.com/users/8158392/sukum"}, "edited": false, "score": 0, "creation_date": 1501763128, "post_id": 45478878, "comment_id": 77928721, "body": "No, it will, also generate the DKM .out - check in the DKM build folder. I use this exact process myself. The redeclaration errors you are getting are probably due to including the DKM as both a sub-project, and also as an EXTRA_MODULE. You might also need to force the kernel to use the correct buildspec for the DKM"}, {"owner": {"reputation": 138, "user_id": 3237904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gh5xX.jpg?s=128&g=1", "display_name": "finickyTunnel", "link": "https://stackoverflow.com/users/3237904/finickytunnel"}, "edited": false, "score": 0, "creation_date": 1501824171, "post_id": 45478878, "comment_id": 77958456, "body": "You would also need to load the DKM using ld(&quot;DKM.out&quot;), before calling the entry function as extern"}, {"owner": {"reputation": 2532, "user_id": 2139094, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b7f096622f36595ba50f9d65a39508a?s=128&d=identicon&r=PG", "display_name": "mjs", "link": "https://stackoverflow.com/users/2139094/mjs"}, "reply_to_user": {"reputation": 138, "user_id": 3237904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gh5xX.jpg?s=128&g=1", "display_name": "finickyTunnel", "link": "https://stackoverflow.com/users/3237904/finickytunnel"}, "edited": false, "score": 0, "creation_date": 1501837068, "post_id": 45478878, "comment_id": 77965459, "body": "@endTunnel not required, as this generates a vxworks image that already has the .out linked into it."}, {"owner": {"reputation": 37, "user_id": 8158392, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vz0T9QwR_50/AAAAAAAAAAI/AAAAAAAAADE/8fVko8TE9yk/photo.jpg?sz=128", "display_name": "Sukum", "link": "https://stackoverflow.com/users/8158392/sukum"}, "edited": false, "score": 0, "creation_date": 1501839101, "post_id": 45478878, "comment_id": 77966951, "body": "@mjs: Right. It does have separate &quot;.out&#39;s&quot;. Thanks for the information. Also i found an other solution to it without having the projects clubbed. Need to specify the DKM application&#39;s partial image .o object file path to the EXTRA_MODULES Macro rather than &quot;.out&quot; path. If for example the application is &quot;myApp&quot; , &quot;myapp_partialImage.o&quot; path should be specified in the Macro. Multiple paths can be specified in the Macro with the space if Multiple app needs to be linked."}, {"owner": {"reputation": 2532, "user_id": 2139094, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b7f096622f36595ba50f9d65a39508a?s=128&d=identicon&r=PG", "display_name": "mjs", "link": "https://stackoverflow.com/users/2139094/mjs"}, "reply_to_user": {"reputation": 37, "user_id": 8158392, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vz0T9QwR_50/AAAAAAAAAAI/AAAAAAAAADE/8fVko8TE9yk/photo.jpg?sz=128", "display_name": "Sukum", "link": "https://stackoverflow.com/users/8158392/sukum"}, "edited": false, "score": 1, "creation_date": 1502264578, "post_id": 45478878, "comment_id": 78127872, "body": "@Sukum I hope this helped. If so please consider upvoting and/or accepting the answer. If you eventually went with another solution, you could also post your own answer (which you can accept instead, if you wish)."}, {"owner": {"reputation": 3092, "user_id": 648368, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/nsODi.jpg?s=128&g=1", "display_name": "Tomer W", "link": "https://stackoverflow.com/users/648368/tomer-w"}, "edited": false, "score": 1, "creation_date": 1548226824, "post_id": 45478878, "comment_id": 95462075, "body": "what happens when i have <code>a.o</code>, <code>b.o</code> linked with <code>c_partial.o</code> into <code>c.out</code>... what should my VIP reference? ro include via Extra_Modules?"}], "tags": [], "owner": {"reputation": 2532, "user_id": 2139094, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b7f096622f36595ba50f9d65a39508a?s=128&d=identicon&r=PG", "display_name": "mjs", "link": "https://stackoverflow.com/users/2139094/mjs"}, "is_accepted": true, "score": 1, "last_activity_date": 1501763290, "last_edit_date": 1501763290, "creation_date": 1501749100, "answer_id": 45478878, "question_id": 45456403, "link": "https://stackoverflow.com/questions/45456403/linking-dkm-projects-to-kernel-imagevip-project-as-a-sub-project-extra-module/45478878#45478878", "title": "Linking DKM Projects to Kernel Image(VIP) project as a Sub project/Extra Module in VxWorks Workbench4", "body": "<ol>\n<li>Add the DKM project as sub-project of your VIP. You can drag and drop, or open the VIP Project Properties, and from Project References check your DKM project</li>\n<li>In usrAppInit.c, call the entry point of your DKM. You will probably want to include the appropriate header</li>\n<li>Modify the VIP include paths as required to include the header file.</li>\n<li>If required, configure the kernel to use the correct build target for the DKM. </li>\n</ol>\n\n<p>Using this approach, when you build the VIP, it will first build the child DKM projects (which will generate the .out files) then the VIP, generating a vxworks image that includes the .out files</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 8158392, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vz0T9QwR_50/AAAAAAAAAAI/AAAAAAAAADE/8fVko8TE9yk/photo.jpg?sz=128", "display_name": "Sukum", "link": "https://stackoverflow.com/users/8158392/sukum"}, "is_accepted": false, "score": 0, "last_activity_date": 1502368185, "creation_date": 1502368185, "answer_id": 45613793, "question_id": 45456403, "link": "https://stackoverflow.com/questions/45456403/linking-dkm-projects-to-kernel-imagevip-project-as-a-sub-project-extra-module/45613793#45613793", "title": "Linking DKM Projects to Kernel Image(VIP) project as a Sub project/Extra Module in VxWorks Workbench4", "body": "<p>An other solution to this problem without having the projects clubbed, Need to specify the DKM application's partial image \".o\" object file path to the EXTRA_MODULES Macro rather than \".out\" path. If for example the application is \"myApp\" , \"myapp_partialImage.o\" path should be specified in the Macro. Multiple paths can be specified in the Macro with the space if Multiple app needs to be linked</p>\n"}], "owner": {"reputation": 37, "user_id": 8158392, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vz0T9QwR_50/AAAAAAAAAAI/AAAAAAAAADE/8fVko8TE9yk/photo.jpg?sz=128", "display_name": "Sukum", "link": "https://stackoverflow.com/users/8158392/sukum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2040, "favorite_count": 0, "accepted_answer_id": 45478878, "answer_count": 2, "score": 1, "last_activity_date": 1502368185, "creation_date": 1501665016, "question_id": 45456403, "link": "https://stackoverflow.com/questions/45456403/linking-dkm-projects-to-kernel-imagevip-project-as-a-sub-project-extra-module", "title": "Linking DKM Projects to Kernel Image(VIP) project as a Sub project/Extra Module in VxWorks Workbench4", "body": "<p>How to Link/Load DKM projects with Kernel Image(VIP) project so that i can call the Entry point function of DKM project(application) from Kernel Image project's \"usrAppInit.c\" to get the application started automatically at boot time? \nCould some one please describe steps or point me to any documentation?</p>\n"}, {"tags": ["c", "enums"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1501664559, "post_id": 45456182, "comment_id": 77872893, "body": "<code>my_bool f()</code>...and then <code>return &lt;int&gt;</code>..what did you expect?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1501664586, "post_id": 45456182, "comment_id": 77872916, "body": "<code>my_bool mb</code> will have exactly the integer returned by <code>f()</code> regardless whether this integer is assigned in <code>enum my_bool</code> or not."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1501664693, "post_id": 45456182, "comment_id": 77872997, "body": "@SouravGhosh I didn&#39;t expect. I don&#39;t understand what enum should hold in this case..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501664718, "post_id": 45456182, "comment_id": 77873016, "body": "Isn&#39;t 2 a trap representation for <code>my_bool</code>?"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1501664826, "post_id": 45456182, "comment_id": 77873074, "body": "@Scheff so <code>enum</code> <b>is</b> an <code>int</code> that allows me to return it with a nice and catchy name?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1501664888, "post_id": 45456182, "comment_id": 77873115, "body": "@AjayBrahmakshatriya no, every value of the underlying integer type is fine for a variable of an <code>enum</code> type."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1501664931, "post_id": 45456182, "comment_id": 77873147, "body": "Yes, AFAIK. It&#39;s an <code>int</code> or a <code>long long int</code> depending on the enumerator values. If I only could remember the exact rule..."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1501665035, "post_id": 45456182, "comment_id": 77873236, "body": "At least I found an SO Q&amp;A: <a href=\"https://stackoverflow.com/q/1113855/7478597\">SO: Is the sizeof(enum) == sizeof(int), always?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1501665046, "post_id": 45456182, "comment_id": 77873247, "body": "@Scheff: &quot;<i>Each enumerated type shall be compatible with char, a signed integer type, or an unsigned integer type. The choice of type is implementation-defined but shall be capable of representing the values of all the members of the enumeration.</i>&quot; The enum identifiers have type <code>int</code>."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1501665077, "post_id": 45456182, "comment_id": 77873263, "body": "@CIsForCookies: All <code>enum</code> types are <i>integral</i> types, just like <code>char</code> and <code>short</code> and <code>int</code>. That doesn&#39;t mean they&#39;re literally <code>int</code>, but you can cast from one integral type to another."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1501665084, "post_id": 45456182, "comment_id": 77873270, "body": "@FelixPalmen Yepp. Read this in the link above..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665163, "post_id": 45456182, "comment_id": 77873317, "body": "@FelixPalmen My doubt was because of this <a href=\"https://stackoverflow.com/a/13423732/2858773\">stackoverflow.com/a/13423732/2858773</a> answer. Specifically the paragraph starting with <i>Regarding Trap Representation...</i>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665350, "post_id": 45456182, "comment_id": 77873435, "body": "@AjayBrahmakshatriya I don&#39;t think the example in this answer is correct. An important property of a <i>trap representation</i> is that it causes undefined behavior when accessed, and I can&#39;t find any part in the C standard that states a value not corresponding to an <code>enum</code> member would be UB..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665398, "post_id": 45456182, "comment_id": 77873468, "body": "@AjayBrahmakshatriya If this would be the case, a lot of code using <code>enum</code> for <i>flags</i> would actually be undefined."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665568, "post_id": 45456182, "comment_id": 77873600, "body": "@FelixPalmen I agree. If we agree that the example given there is wrong, there is no confusion."}], "answers": [{"comments": [{"owner": {"reputation": 5782, "user_id": 2832398, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/356c99a077310a35816f852423859f4c?s=128&d=identicon&r=PG&f=1", "display_name": "lilezek", "link": "https://stackoverflow.com/users/2832398/lilezek"}, "edited": false, "score": 0, "creation_date": 1501664676, "post_id": 45456253, "comment_id": 77872983, "body": "Is taking anything outside this range undefined behavior?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501664677, "post_id": 45456253, "comment_id": 77872984, "body": "But as far as I remember, the enum example is often used to explain trap representations. Isn&#39;t 2 a trap value for <code>my_bool</code>?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501664716, "post_id": 45456253, "comment_id": 77873015, "body": "@AjayBrahmakshatriya: No. Not at all. No idea where that&#39;s coming from."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501664746, "post_id": 45456253, "comment_id": 77873031, "body": "@MSalters IIRC it was an SO answer. Let me find it."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665028, "post_id": 45456253, "comment_id": 77873233, "body": "@MSalters My doubt was because of this <a href=\"https://stackoverflow.com/a/13423732/2858773\">stackoverflow.com/a/13423732/2858773</a> answer. Specifically the paragraph starting with <i>Regarding Trap Representation...</i>"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665242, "post_id": 45456253, "comment_id": 77873363, "body": "@AjayBrahmakshatriya: That shows a value <i>outside</i> the range of enumerators. In that example, the enumerators require 1 bit, so the value <code>2</code> (which requires 2 bits) is outside the range."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501665250, "post_id": 45456253, "comment_id": 77873369, "body": "@CIsForCookies standard says that the underlying type has to be <code>char</code> or <code>unsigned int</code>. There are no N bits types which represents the enums."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665336, "post_id": 45456253, "comment_id": 77873426, "body": "@MSalters if that is the case, you cannot create trap representations with enums. Since you can&#39;t fir 2 bits in 1 bit. Even if you <code>memcpy</code> a 2 there, it will just take one of the possible 0 or 1. Is the example in the answer no correct?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501665359, "post_id": 45456253, "comment_id": 77873441, "body": "@PeterJ: That&#39;s not an exhaustive list. Obviously the full list has to include types which can have negative values (the guaranteed range of <code>char</code> is just 0-127)"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665469, "post_id": 45456253, "comment_id": 77873526, "body": "@AjayBrahmakshatriya: I don&#39;t even know what you&#39;re trying to say there. The smallest possible object in C is a byte, which takes 8 bits. That can be 7 trap bits and one value bit. Copying a <code>2</code> would set the lowest trap bit to <code>1</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665535, "post_id": 45456253, "comment_id": 77873580, "body": "@MSalters yes that is exactly what I meant (pardon my wordings if it was not clear). So it is not possible to create trap representations with enums and hence the example on that link is wrong?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501665898, "post_id": 45456253, "comment_id": 77873815, "body": "@AjayBrahmakshatriya: Trap representations are never <i>guaranteed</i>. They are possible, but only <i>outside</i> the binary range of enumerators. E.g. <code>2*(int)highest_enumerator</code> might be a trapping value, but <code>enumerator_A | enumerator_B</code> may not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501667136, "post_id": 45456253, "comment_id": 77874768, "body": "@MSalters I can&#39;t find that possibility for enumerators in the standard, Could you give a hint in which paragraph to look for it please?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501674782, "post_id": 45456253, "comment_id": 77880212, "body": "This answer &quot;The range is defined by the bits needed to represent all enumerators&quot; and spec&#39;s &quot;&quot;Each enumerated type shall be compatible with char, a signed integer type, or an unsigned integer type.&quot; is contradictory.  If I have an enumerator with values 1,2,3, it certainly must be able to encode at least values 0-127 and not just 1-3 or 0-3."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 2, "last_activity_date": 1501664788, "last_edit_date": 1501664788, "creation_date": 1501664595, "answer_id": 45456253, "question_id": 45456182, "link": "https://stackoverflow.com/questions/45456182/how-enums-work-with-undefined-values/45456253#45456253", "title": "how enums work with undefined values?", "body": "<p>Enums can take any value in their range. The range is defined by the bits needed to represent all enumerators. In your case, you need 3 bits for <code>my_true</code>, which gives a range 0-7. </p>\n\n<p>Enumerators are essentially named constants, and there's no reason why you can't have two constants that happen to have the same value. Plenty of constants are in fact zero.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501665472, "post_id": 45456442, "comment_id": 77873533, "body": "There are more possible choices than you list here."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501665418, "last_edit_date": 1501665418, "creation_date": 1501665114, "answer_id": 45456442, "question_id": 45456182, "link": "https://stackoverflow.com/questions/45456182/how-enums-work-with-undefined-values/45456442#45456442", "title": "how enums work with undefined values?", "body": "<p>enums can be implemented as <code>char</code> ,<code>int</code> or <code>unsigned int</code> and it is left for the implementation. From the warning you get the information that your gcc compiler implements the <code>unsigned int</code>.</p>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1833, "favorite_count": 0, "accepted_answer_id": 45456253, "answer_count": 2, "score": 1, "last_activity_date": 1501665418, "creation_date": 1501664424, "question_id": 45456182, "link": "https://stackoverflow.com/questions/45456182/how-enums-work-with-undefined-values", "title": "how enums work with undefined values?", "body": "<pre><code>typedef enum {my_false, my_true = 5, my_maybe = 3} my_bool;\n\nmy_bool f(){return 2;}\nint g(){return my_true;}\n\nint main (){\n    my_bool mb = f();\n    int i = f();\n    printf(\"%d--%d\\n\", mb==i, mb);\n\n    mb = g();\n    i = g();\n    printf(\"%d--%d\\n\", mb==i, mb);\n\n    return 0;\n}\n</code></pre>\n\n<p>What is happening when a function returns <code>enum</code>?</p>\n\n<p>As I see it, in my code, <code>f()</code> can return any number, even if it's not defined inside the <code>my_bool enum</code>, but it seems that no matter what I return (like <code>2</code> in my example, the value stored inside <code>my_bool mb = f();</code> would <code>1</code> unless I return <code>0</code>or<code>my_false</code>.</p>\n\n<ol>\n<li><p>Is this what should happen? does <code>enum</code> decays immediately to <code>int</code> \nand thus has no problem with numbers that aren't defined in it?</p></li>\n<li><p>Why gcc generates warning: <code>comparison between signed and unsigned integer expressions [-Wsign-compare]...  printf(\"%d--%d\\n\", mb==i, mb);</code>? isn't <code>enum</code> a <code>signed int</code>?</p></li>\n<li>why defining the same value with different identifiers ok? (i.e. <code>typedef enum {xx = 1, yy = 1} zz;</code>)</li>\n</ol>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1501672721, "post_id": 45455821, "comment_id": 77878794, "body": "One suggestion: <code>Vec_</code> prefix for pointer typedefs is a rather unusual naming convention. First of all, a pointer is not a vector. Next, there <i>usually</i> isn&#39;t any reason even have a typedef for a pointer (the only time I&#39;ve needed it is to pass it to a macro which accepts a type as a parameter, but only works with a single_word_typedef type). Even then, the most common convention I&#39;ve seen it to prefix with <code>p</code> (i.e. something like <code>pMyGroup</code>). And note that you can typedef both symbols in <a href=\"https://pastebin.com/vshwxyxS\" rel=\"nofollow noreferrer\">a single statement</a>: <code>typedef struct { int a; int b; } Group, *pGroup;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2678, "user_id": 907810, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/fe37def808ad500c8cd4c3212fed156a?s=128&d=identicon&r=PG", "display_name": "user907810", "link": "https://stackoverflow.com/users/907810/user907810"}, "edited": false, "score": 0, "creation_date": 1501664531, "post_id": 45455995, "comment_id": 77872876, "body": "Ah.. yes, I seem to have allotted only for one vector! Thanks for pointing that out.  The hardcoded strings were just a quick example I cooked up to see and try to use those structs."}, {"owner": {"reputation": 2678, "user_id": 907810, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/fe37def808ad500c8cd4c3212fed156a?s=128&d=identicon&r=PG", "display_name": "user907810", "link": "https://stackoverflow.com/users/907810/user907810"}, "edited": false, "score": 0, "creation_date": 1501664567, "post_id": 45455995, "comment_id": 77872904, "body": "and why is it sizeof(*vec)?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 2678, "user_id": 907810, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/fe37def808ad500c8cd4c3212fed156a?s=128&d=identicon&r=PG", "display_name": "user907810", "link": "https://stackoverflow.com/users/907810/user907810"}, "edited": false, "score": 0, "creation_date": 1501664568, "post_id": 45455995, "comment_id": 77872905, "body": "@user907810 You didn&#39;t even allocate enough for one - you just allocated the size of a pointer. <code>vec</code> is a pointer and <code>*vec</code> is a struct. You want the size of two structs, so <code>2 * sizeof(*vec)</code>."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 2678, "user_id": 907810, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/fe37def808ad500c8cd4c3212fed156a?s=128&d=identicon&r=PG", "display_name": "user907810", "link": "https://stackoverflow.com/users/907810/user907810"}, "edited": false, "score": 0, "creation_date": 1501664720, "post_id": 45455995, "comment_id": 77873020, "body": "@user907810 Yes."}], "tags": [], "owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "is_accepted": true, "score": 3, "last_activity_date": 1501664706, "last_edit_date": 1501664706, "creation_date": 1501663936, "answer_id": 45455995, "question_id": 45455821, "link": "https://stackoverflow.com/questions/45455821/using-structs-with-index-to-create-vectors/45455995#45455995", "title": "Using structs with index to create vectors", "body": "<pre><code>Vec_MyStruct vec = malloc(sizeof(vec));\n\nvec[0] = bb1;\nvec[1] = bb2;\n</code></pre>\n\n<p>This is wrong. You are allocating the size of a single pointer, then writing two structs into the memory. It should be <code>malloc(2 * sizeof(*vec))</code>.</p>\n\n<p>Note that <code>typedef</code>ing a pointer is often <a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">considered bad style</a>, especially when the typedef has a confusing name such as <code>Vec_MyStruct</code>.</p>\n\n<p>As far as I can see, the other parts of your code are correct, but some are somewhat error-prone. For example, the code that allocates the strings hard-codes the sizes. I'd make a function for filling the fields of a <code>MyStruct</code> which receives the string as a parameter, then uses <code>strlen</code> to determine its size.</p>\n\n<p>Additionally, in <code>MyBigGroup</code>, you used a pointer to a local variable <code>grp.myBigGroups = &amp;perm;</code>. This will work in this small example, but could lead to issues in larger code - the pointer won't be valid after the function exits, and if you try <code>free</code>ing the memory it will cause problems.</p>\n"}], "owner": {"reputation": 2678, "user_id": 907810, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/fe37def808ad500c8cd4c3212fed156a?s=128&d=identicon&r=PG", "display_name": "user907810", "link": "https://stackoverflow.com/users/907810/user907810"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 45455995, "answer_count": 1, "score": 0, "last_activity_date": 1501664706, "creation_date": 1501663459, "question_id": 45455821, "link": "https://stackoverflow.com/questions/45455821/using-structs-with-index-to-create-vectors", "title": "Using structs with index to create vectors", "body": "<p>I came across a similar struct in a piece of code. while trying to use these I somehow got stuck. Here is what I wrote based on the structs I came across.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdint.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct MyStruct{\n    unsigned char *ptr;\n    int len;\n}MyStruct;\ntypedef MyStruct *Vec_MyStruct;\n\nstruct MyGroup {\n    int n_MyStruct;\n    Vec_MyStruct myStructs;\n};\ntypedef struct MyGroup MyGroup;\ntypedef struct MyGroup *Vec_MyGroup;\n\ntypedef struct MyBigGroup {\n    int n_MyBigGroups;\n    Vec_MyGroup myBigGroups;\n}MyBigGroup;\n\n\nint ArrayData();\n\nint main(int argc, char *argv[]){\n\n    printf(\"Started..\\n\");\n    ArrayData();\n    return 0;\n}\n\nint ArrayData()\n{\n    printf(\"ArrayData called..\\n\");\n    MyStruct bb1;\n    memset(&amp;bb1,0,sizeof(bb1));\n    bb1.ptr = (unsigned char *)malloc(6);\n    bb1.len = 6;\n    char *ch = \"Hello\";\n    memcpy(bb1.ptr, ch, bb1.len);\n    //      printf(\"1: ptr  %s\\n\", bb1.ptr);\n    //      printf(\"1: len %d\\n\", bb1.len);\n\n    MyStruct bb2;\n    memset(&amp;bb2,0,sizeof(bb2));\n    bb2.ptr = (unsigned char *)malloc(6);\n    bb2.len = 6;\n    char *c = \"World\";\n    memcpy(bb2.ptr, c, bb2.len);\n    //      printf(\"2: ptr  %s\\n\", bb2.ptr);\n    //      printf(\"2: len %d\\n\", bb2.len);\n\n\n    Vec_MyStruct vec = malloc(sizeof(vec));\n\n    vec[0] = bb1;\n    vec[1] = bb2;\n    printf(\"vec[0]: ptr  %s\\n\", vec[0].ptr);\n    printf(\"vec[0]: len %d\\n\", vec[0].len);\n    printf(\"vec[1]: ptr  %s\\n\", vec[1].ptr);\n    printf(\"vec[1]: len %d\\n\", vec[1].len);\n    //\n\n    MyGroup perm;\n    perm.n_MyStruct = 2;// 2 My_Struct vectors\n    perm.myStructs = vec;\n    printf(\"perm.myStructs[0].ptr: ptr  %s\\n\", perm.myStructs[0].ptr);\n    printf(\"perm.myStructs[0].len: len %d\\n\", perm.myStructs[0].len);\n    printf(\"perm.myStructs[1].ptr: ptr  %s\\n\", perm.myStructs[1].ptr);\n    printf(\"perm.myStructs[1].len: len %d\\n\", perm.myStructs[1].len);\n\n    MyBigGroup grp;\n    grp.n_MyBigGroups = 1;\n    grp.myBigGroups = &amp;perm;\n\n\n    printf(\"grp.myBigGroups[0].myStructs[0].ptr: ptr  %s\\n\", grp.myBigGroups[0].myStructs[0].ptr);\n    printf(\"grp.myBigGroups[0].myStructs[0].len: len %d\\n\", grp.myBigGroups[0].myStructs[0].len);\n    printf(\"grp.myBigGroups[0].myStructs[1].ptr: ptr  %s\\n\", grp.myBigGroups[0].myStructs[1].ptr);\n    printf(\"grp.myBigGroups[0].myStructs[1].len: len %d\\n\", grp.myBigGroups[0].myStructs[1].len);\n    return 0;\n}\n</code></pre>\n\n<p>So MyGroup has a \"list\" of MyStruct items. It also has a variable that tells me how many MyStruct items exist. Vec_MyStuct just points to the MyStruct.\nThere is another grouping of the MyGroup  which is the MyBigGroup.\nBut what worries me here is although the code is working just fine, I am unsure if I am allocating memory correctly.Especially the MyBigGroup.. Or is there a more efficient way to use these structs to define multiple entries of MyStructs?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "assembly", "long-integer", "sparc"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1501663117, "post_id": 45455540, "comment_id": 77871818, "body": "You seem to access <code>sum</code> in your assembler code which is <code>unsigned long long</code>. Of course you have to adapt your asm code to match the size and type of your parameters. Did you try to use C code and let the compiler to the work? If the compiler supports 8 byte integer values it can create code to manipulate them."}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1501664125, "post_id": 45455540, "comment_id": 77872571, "body": "@Gerhardh- If you look at the printf output, you can see that <code>sum</code> is computed well (=4.0e+9 for first example and 5.0e+9 for second one). In both cases, <code>sum</code> is declared as <code>unsigned long long int</code> . I don&#39;t understand why this is not the same case with using <code>nLoop &gt; 2^32</code> in assembly input parameter ?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1501666231, "post_id": 45455540, "comment_id": 77874116, "body": "Does you assembly code do the 64 bits calculations? You probably do not"}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1501666991, "post_id": 45455540, "comment_id": 77874669, "body": "@PeterJ- How to know if assembly code does the 64 bits calculations ? the line <code>&quot;add %%g2, 1, %%g2\\n\\t&quot;</code>seems to do it because output parameter (sum) at the end of assembly code gives values over 2^32 (4.0e+9 with valid times and 5.0e+9 with incorrect times)."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1501669793, "post_id": 45455540, "comment_id": 77876700, "body": "To hunt down the problem you might print the results of <code>tv1</code> and <code>tv2</code> and verify the range of the difference."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501676807, "post_id": 45455540, "comment_id": 77881809, "body": "Look at <code>int nRunning = ...; printf(&quot;avgSum = %e\\n&quot;, avgSum); averageRuntime = avgSum&#47;nRunning; printf(&quot;(Average Elapsed time, Standard deviation) = %e usec  ...\\n&quot;, averageRuntime, ...);</code> and output <code>9.617167e+06, 9.558522e+06</code>.  This makes no sense.  Is this true code and true output?  Else, I think you have memory corruption due to <code>asm()</code>."}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1501677218, "post_id": 45455540, "comment_id": 77882172, "body": "@chux- sorry, I forgot to precise that I have taken <code>nRunning=2</code> at the execution (<b>./a.out 2</b>), this is the argument of executable. <code>9.558522e+06</code> is the average of these 2 executions and <code>5.864450e+04</code>the standard deviation."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1501677308, "post_id": 45455540, "comment_id": 77882259, "body": "What <i>actual</i> instructions are produced?  For example, <code>mov</code> on SPARC is a synthetic instruction that&#39;s actually implemented as one or more <i>other</i> instructions, see <a href=\"https://docs.oracle.com/cd/E19120-01/open.solaris/816-1681/instructionset-86762/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19120-01/open.solaris/816-1681/&hellip;</a>.  I&#39;d recommend getting it working <b>without</b> hand-jammed ASM code first."}], "answers": [{"tags": [], "owner": {"reputation": 12703, "user_id": 584597, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d519ba6b69a89cc8ec99001eea2059b?s=128&d=identicon&r=PG", "display_name": "payne", "link": "https://stackoverflow.com/users/584597/payne"}, "is_accepted": false, "score": 0, "last_activity_date": 1502750552, "creation_date": 1502750552, "answer_id": 45684080, "question_id": 45455540, "link": "https://stackoverflow.com/questions/45455540/handling-of-integer-with-values-232-on-sparc-32-bits/45684080#45684080", "title": "Handling of integer with values &gt; 2^32 on Sparc 32 bits", "body": "<p>You seem to be doing 32-bit operations on one-half of a 64-bit value</p>\n\n<p>From the generated code, here's where <code>nLoop</code> is a <strong>double-load</strong> into both <code>%o4</code> and <code>%o5</code> (since it's a 64-bit <code>long long</code> value):</p>\n\n<pre><code>    ldd [%fp-24], %o4\n    clr %g1\n    clr %g2\n</code></pre>\n\n<p>And then you just work with <code>%o4</code>:</p>\n\n<pre><code>    mov %o4, %g1                ; &lt;---- what about %o5????\nloop:\n    add %g2, 1, %g2\n    subcc %g1, 1, %g1\n    bne loop\n    nop\n    mov %g2, %o4\n</code></pre>\n\n<p>To make this work, re-write your assembly code to treat <code>%o4</code> + <code>%o5</code> together as a 64-bit value.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1502761114, "post_id": 45684405, "comment_id": 78328521, "body": "-@Chris Dodd I am using  Debian Sparc 32 bits Etch (with gcc 4.1.2) from an image with QEMU. ( the image is available on <a href=\"https://people.debian.org/~aurel32/qemu/sparc/\" rel=\"nofollow noreferrer\">people.debian.org/~aurel32/qemu/sparc</a> ). From what you say, I have to create a QEMU image of Debian Sparc 64 bits instead of 32 bits. I found on <a href=\"https://people.debian.org/~glaubitz/debian-cd/2017-03-24/\" rel=\"nofollow noreferrer\">people.debian.org/~glaubitz/debian-cd/2017-03-24</a> a iso image of Debian-9 Sparc 64 bits. How to create a QEMU image from this iso under MacOS 10.9.5 : I tried to do : qemu-system-sparc -hda debian_stretch_sparc64.img debian-9.0-sparc64-NETINST-1.iso -boot d but I get error and it doesn&#39;t generate &quot;.img&quot; file"}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1502761350, "post_id": 45684405, "comment_id": 78328571, "body": "I have also tried to do : qemu-system-sparc -hda debian_stretch_sparc64.img -cdrom debian-9.0-sparc64-NETINST-1.iso -boot d . How to avoid the &quot;-cdrom&quot; flag when one hasn&#39;t got a cdrom ?"}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 0, "last_activity_date": 1502752763, "creation_date": 1502752763, "answer_id": 45684405, "question_id": 45455540, "link": "https://stackoverflow.com/questions/45455540/handling-of-integer-with-values-232-on-sparc-32-bits/45684405#45684405", "title": "Handling of integer with values &gt; 2^32 on Sparc 32 bits", "body": "<p>A lot depends on what version of sparc and what ABI your are using.  If you are using sparc v8 or earlier, you have 32 bit mode with only 32 bit registers.  In which case when you try to load 5000000000 into a 32-bit register it fails and loads 5000000000 mod 2<sup>32</sup> instead (which is 705032704).  This is what appears to be happening.</p>\n\n<p>If on the other hand you have a 64-bit sparc processor running in 32 bit mode (what is usually called v8plus), then you can use 64 bit registers, so this would work.</p>\n"}], "owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 2, "accepted_answer_id": 45684405, "answer_count": 2, "score": 12, "last_activity_date": 1502752763, "creation_date": 1501662633, "last_edit_date": 1502687190, "question_id": 45455540, "link": "https://stackoverflow.com/questions/45455540/handling-of-integer-with-values-232-on-sparc-32-bits", "title": "Handling of integer with values &gt; 2^32 on Sparc 32 bits", "body": "<p>I coded a little program that measures the time spent into a loop (via an inline Sparc assembly code snippet). </p>\n\n<p>Everything is right until I set number of iterations above roughly 4.0+9 (above 2^32).</p>\n\n<p>Here's the code snippet :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdint.h&gt;\n\nint main (int argc, char *argv[])\n{\n  // For indices\n  int i;\n  // Set the number of executions\n  int nRunning = atoi(argv[1]);\n  // Set the sums\n  double avgSum = 0.0;\n  double stdSum = 0.0;\n  // Average of execution time\n  double averageRuntime = 0.0;\n  // Standard deviation of execution time\n  double deviationRuntime = 0.0;\n\n  // Init sum\n  unsigned long long int sum = 0;\n  // Number of iterations\n  unsigned long long int nLoop = 4000000000ULL;\n  //uint64_t nLoop = 4000000000;\n\n  // DEBUG\n  printf(\"sizeof(unsigned long long int) = %zu\\n\",sizeof(unsigned long long int));\n  printf(\"sizeof(unsigned long int) = %zu\\n\",sizeof(unsigned long int));\n\n  // Time intervals\n  struct timeval tv1, tv2;\n  double diff;\n\n  // Loop for multiple executions\n  for (i=0; i&lt;nRunning; i++)\n  {\n   // Start time\n   gettimeofday (&amp;tv1, NULL);\n\n   // Loop with Sparc assembly into C source\n   asm volatile (\"clr %%g1\\n\\t\" \n                 \"clr %%g2\\n\\t\" \n                 \"mov %1, %%g1\\n\" // %1 = input parameter\n                 \"loop:\\n\\t\" \n                 \"add %%g2, 1, %%g2\\n\\t\" \n                 \"subcc %%g1, 1, %%g1\\n\\t\" \n                 \"bne loop\\n\\t\" \n                 \"nop\\n\\t\" \n                 \"mov %%g2, %0\\n\" // %0 = output parameter\n                 : \"=r\" (sum)     // output\n                 : \"r\" (nLoop)    // input\n                 : \"g1\", \"g2\");   // clobbers\n\n   // End time\n   gettimeofday (&amp;tv2, NULL);\n\n   // Compute runtime for loop\n   diff = (tv2.tv_sec - tv1.tv_sec) * 1000000ULL + (tv2.tv_usec - tv1.tv_usec);\n\n   // Summing diff time\n   avgSum += diff;\n   stdSum += (diff*diff);\n\n   // DEBUG\n   printf(\"diff = %e\\n\", diff);\n   printf(\"avgSum = %e\\n\", avgSum);\n\n  }\n  // Compute final averageRuntime   \n  averageRuntime = avgSum/nRunning;\n\n  // Compute standard deviation\n  deviationRuntime = sqrt(stdSum/nRunning-averageRuntime*averageRuntime);\n\n  // Print results\n  printf(\"(Average Elapsed time, Standard deviation) = %e usec  %e usec\\n\", averageRuntime, deviationRuntime);\n  // Print sum from assembly loop\n  printf(\"Sum = %llu\\n\", sum);\n</code></pre>\n\n<p>For example, with <code>nLoop</code> &lt; 2^32, I get correct values for <code>diff</code>, <code>avgSum</code> and <code>stdSum</code>. Indeed, the <code>printf</code> ,with <code>nLoop = 4.0e+9</code>, gives :</p>\n\n<pre><code>sizeof(unsigned long long int) = 8\nsizeof(unsigned long int) = 4\ndiff = 9.617167e+06\navgSum = 9.617167e+06\ndiff = 9.499878e+06\navgSum = 1.911704e+07\n(Average Elapsed time, Standard deviation) = 9.558522e+06 usec  5.864450e+04 usec\nSum = 4000000000\n</code></pre>\n\n<p>The code is compiled on <code>Debian Sparc 32 bits Etch</code> with <code>gcc 4.1.2</code>.</p>\n\n<p>Unfortunately, if I take for example <code>nLoop = 5.0e+9</code>, I get small and incorrect values for measured times; here's the printf output in this case :</p>\n\n<pre><code>sizeof(unsigned long long int) = 8\nsizeof(unsigned long int) = 4\ndiff = 5.800000e+01\navgSum = 5.800000e+01\ndiff = 4.000000e+00\navgSum = 6.200000e+01\n(Average Elapsed time, Standard deviation) = 3.100000e+01 usec  2.700000e+01 usec\nSum = 5000000000\n</code></pre>\n\n<p>I don't know where the issue could come from, I have done other tests using <code>uint64_t</code> but without success. </p>\n\n<p>Maybe the problem is that I handle <code>large integers (&gt; 2^32)</code> with 32 bits OS or it may be the assembly inline code which doesn't support 8 bytes integer.</p>\n\n<p>If someone could give me some clues to fix this error,</p>\n\n<p>Regards</p>\n\n<p><strong>UPDATE 1</strong> :</p>\n\n<p>Following the advice of <code>@Andrew Henle</code>, I took the same code but instead of inline Sparc Assembly snippet, I have just put a simple loop.</p>\n\n<p>Here's the program with the simple loop which has got <code>nLoop = 5.0e+9</code> (see the line \"<code>unsigned long long int nLoop = 5000000000ULL;</code>\", so above the <code>limit 2^32-1</code> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdint.h&gt;\n\nint main (int argc, char *argv[])\n{\n  // For indices of nRunning\n  int i;\n  // For indices of nRunning\n  unsigned long long int j;\n  // Set the number of executions\n  int nRunning = atoi(argv[1]);\n  // Set the sums\n  unsigned long long int avgSum = 0;\n  unsigned long long int stdSum = 0;\n  // Average of execution time\n  double averageRuntime = 0.0;\n  // Standard deviation of execution time\n  double deviationRuntime = 0.0;\n\n  // Init sum\n  unsigned long long int sum;\n  // Number of iterations\n  unsigned long long int nLoop = 5000000000ULL;\n\n  // DEBUG\n  printf(\"sizeof(unsigned long long int) = %zu\\n\",sizeof(unsigned long long int));\n  printf(\"sizeof(unsigned long int) = %zu\\n\",sizeof(unsigned long int));\n\n  // Time intervals\n  struct timeval tv1, tv2;\n  unsigned long long int diff;\n\n  // Loop for multiple executions\n  for (i=0; i&lt;nRunning; i++)\n  {\n   // Reset sum\n   sum = 0;\n\n   // Start time\n   gettimeofday (&amp;tv1, NULL);\n\n   // Loop with Sparc assembly into C source\n   /* asm volatile (\"clr %%g1\\n\\t\" \n                 \"clr %%g2\\n\\t\" \n                 \"mov %1, %%g1\\n\" // %1 = input parameter\n         \"loop:\\n\\t\" \n         \"add %%g2, 1, %%g2\\n\\t\" \n         \"subcc %%g1, 1, %%g1\\n\\t\" \n         \"bne loop\\n\\t\" \n         \"nop\\n\\t\" \n         \"mov %%g2, %0\\n\" // %0 = output parameter\n         : \"=r\" (sum)     // output\n         : \"r\" (nLoop)    // input\n         : \"g1\", \"g2\");   // clobbers\n   */\n\n   // Classic loop\n   for (j=0; j&lt;nLoop; j++)\n      sum ++;\n\n   // End time\n   gettimeofday (&amp;tv2, NULL);\n\n   // Compute runtime for loop\n   diff = (unsigned long long int) ((tv2.tv_sec - tv1.tv_sec) * 1000000 + (tv2.tv_usec - tv1.tv_usec));\n\n   // Summing diff time\n   avgSum += diff;\n   stdSum += (diff*diff);\n\n   // DEBUG\n   printf(\"diff = %llu\\n\", diff);\n   printf(\"avgSum = %llu\\n\", avgSum);\n   printf(\"stdSum = %llu\\n\", stdSum);\n   // Print sum from assembly loop\n   printf(\"Sum = %llu\\n\", sum);\n\n  }\n  // Compute final averageRuntime   \n  averageRuntime = avgSum/nRunning;\n\n  // Compute standard deviation\n  deviationRuntime = sqrt(stdSum/nRunning-averageRuntime*averageRuntime);\n\n  // Print results\n  printf(\"(Average Elapsed time, Standard deviation) = %e usec  %e usec\\n\", averageRuntime, deviationRuntime);\n\n  return 0;\n\n}\n</code></pre>\n\n<p>This code snippet is working fine, i.e the variable <code>sum</code> is printed as \n(see \"<code>printf(\"Sum = %llu\\n\", sum)</code>\";) :</p>\n\n<pre><code>Sum = 5000000000\n</code></pre>\n\n<p>So the problem comes from the version with Sparc Assembly block.</p>\n\n<p>I suspect, in this assembly code, the line <code>\"mov %1, %%g1\\n\" // %1 = input parameter</code> to badly store <code>nLoop</code> into <code>%g1 register</code> (I think that <code>%g1</code> is a 32 bits register, so can't store values above <code>2^32-1</code>).</p>\n\n<p>However, the ouput parameter (variable <code>sum</code>) at the line :</p>\n\n<pre><code>\"mov %%g2, %0\\n\" // %0 = output parameter\n</code></pre>\n\n<p>is above the limit since it is equal to 5000000000.</p>\n\n<p>I attach the vimdiff between the version with Assembly loop and without it :</p>\n\n<p><a href=\"https://i.stack.imgur.com/6rWKs.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/6rWKs.png\" alt=\"figure\"></a> </p>\n\n<p>On the left, program With Assembly, on the right, Without Assembly (just a simple loop instead</p>\n\n<p>I remind you my issue is that, for nLoop > 2^32-1 and with Assembly loop, I get a valid <code>sum</code> parameter at the end of execution but not valid (too short) <code>average</code> and <code>standard deviation</code> times (spent into loop); here's an example of output with <code>nLoop = 5000000000ULL</code> :</p>\n\n<pre><code>sizeof(unsigned long long int) = 8\nsizeof(unsigned long int) = 4\ndiff = 17\navgSum = 17\nstdSum = 289\nSum = 5000000000\ndiff = 4\navgSum = 21\nstdSum = 305\nSum = 5000000000\n(Average Elapsed time, Standard deviation) = 1.000000e+01 usec  7.211103e+00 usec\n</code></pre>\n\n<p>With taking <code>nLoop = 4.0e+9</code>, i.e <code>nLoop = 4000000000ULL</code>, there is no problem, the times values are valid.</p>\n\n<p><strong>UPDATE 2 :</strong></p>\n\n<p>I am searching more deeply by generating Assembly code. The version with <code>nLoop = 4000000000 (4.0e+9)</code> is below :</p>\n\n<pre><code>    .file   \"loop-WITH-asm-inline-4-Billions.c\"\n    .section    \".rodata\"\n    .align 8\n.LLC1:\n    .asciz  \"sizeof(unsigned long long int) = %zu\\n\"\n    .align 8\n.LLC2:\n    .asciz  \"sizeof(unsigned long int) = %zu\\n\"\n    .align 8\n.LLC3:\n    .asciz  \"diff = %llu\\n\"\n    .align 8\n.LLC4:\n    .asciz  \"avgSum = %llu\\n\"\n    .align 8\n.LLC5:\n    .asciz  \"stdSum = %llu\\n\"\n    .align 8\n.LLC6:\n    .asciz  \"Sum = %llu\\n\"\n    .global __udivdi3\n    .global __cmpdi2\n    .global __floatdidf\n    .align 8\n.LLC7:\n    .asciz  \"(Average Elapsed time, Standard deviation) = %e usec  %e usec\\n\"\n    .align 8\n.LLC0:\n    .long   0\n    .long   0\n    .section    \".text\"\n    .align 4\n    .global main\n    .type   main, #function\n    .proc   04\nmain:\n    save    %sp, -248, %sp\n    st  %i0, [%fp+68]\n    st  %i1, [%fp+72]\n    ld  [%fp+72], %g1\n    add %g1, 4, %g1\n    ld  [%g1], %g1\n    mov %g1, %o0\n    call    atoi, 0\n     nop\n    mov %o0, %g1\n    st  %g1, [%fp-68]\n    st  %g0, [%fp-64]\n    st  %g0, [%fp-60]\n    st  %g0, [%fp-56]\n    st  %g0, [%fp-52]\n    sethi   %hi(.LLC0), %g1\n    or  %g1, %lo(.LLC0), %g1\n    ldd [%g1], %f8\n    std %f8, [%fp-48]\n    sethi   %hi(.LLC0), %g1\n    or  %g1, %lo(.LLC0), %g1\n    ldd [%g1], %f8\n    std %f8, [%fp-40]\n    mov 0, %g2\n    sethi   %hi(4000000000), %g3\n    std %g2, [%fp-24]\n    sethi   %hi(.LLC1), %g1\n    or  %g1, %lo(.LLC1), %o0\n    mov 8, %o1\n    call    printf, 0\n     nop\n    sethi   %hi(.LLC2), %g1\n    or  %g1, %lo(.LLC2), %o0\n    mov 4, %o1\n    call    printf, 0\n     nop\n    st  %g0, [%fp-84]\n    b   .LL2\n     nop\n.LL3:\n    st  %g0, [%fp-32]\n    st  %g0, [%fp-28]\n    add %fp, -92, %g1\n    mov %g1, %o0\n    mov 0, %o1\n    call    gettimeofday, 0\n     nop\n    ldd [%fp-24], %o4\n    clr %g1\n    clr %g2\n    mov %o4, %g1\nloop:\n    add %g2, 1, %g2\n    subcc %g1, 1, %g1\n    bne loop\n    nop\n    mov %g2, %o4\n\n    std %o4, [%fp-32]\n    add %fp, -100, %g1\n    mov %g1, %o0\n    mov 0, %o1\n    call    gettimeofday, 0\n     nop\n    ld  [%fp-100], %g2\n    ld  [%fp-92], %g1\n    sub %g2, %g1, %g2\n    sethi   %hi(999424), %g1\n    or  %g1, 576, %g1\n    smul    %g2, %g1, %g3\n    ld  [%fp-96], %g2\n    ld  [%fp-88], %g1\n    sub %g2, %g1, %g1\n    add %g3, %g1, %g1\n    st  %g1, [%fp-12]\n    sra %g1, 31, %g1\n    st  %g1, [%fp-16]\n    ldd [%fp-64], %o4\n    ldd [%fp-16], %g2\n    addcc   %o5, %g3, %g3\n    addx    %o4, %g2, %g2\n    std %g2, [%fp-64]\n    ld  [%fp-16], %g2\n    ld  [%fp-12], %g1\n    smul    %g2, %g1, %g4\n    ld  [%fp-16], %g2\n    ld  [%fp-12], %g1\n    smul    %g2, %g1, %g1\n    add %g4, %g1, %g4\n    ld  [%fp-12], %g2\n    ld  [%fp-12], %g1\n    umul    %g2, %g1, %g3\n    rd  %y, %g2\n    add %g4, %g2, %g4\n    mov %g4, %g2\n    ldd [%fp-56], %o4\n    addcc   %o5, %g3, %g3\n    addx    %o4, %g2, %g2\n    std %g2, [%fp-56]\n    sethi   %hi(.LLC3), %g1\n    or  %g1, %lo(.LLC3), %o0\n    ld  [%fp-16], %o1\n    ld  [%fp-12], %o2\n    call    printf, 0\n     nop\n    sethi   %hi(.LLC4), %g1\n    or  %g1, %lo(.LLC4), %o0\n    ld  [%fp-64], %o1\n    ld  [%fp-60], %o2\n    call    printf, 0\n     nop\n    sethi   %hi(.LLC5), %g1\n    or  %g1, %lo(.LLC5), %o0\n    ld  [%fp-56], %o1\n    ld  [%fp-52], %o2\n    call    printf, 0\n     nop\n    sethi   %hi(.LLC6), %g1\n    or  %g1, %lo(.LLC6), %o0\n    ld  [%fp-32], %o1\n    ld  [%fp-28], %o2\n    call    printf, 0\n     nop\n    ld  [%fp-84], %g1\n    add %g1, 1, %g1\n    st  %g1, [%fp-84]\n.LL2:\n    ld  [%fp-84], %g2\n    ld  [%fp-68], %g1\n    cmp %g2, %g1\n    bl  .LL3\n     nop\n    ld  [%fp-68], %g1\n    sra %g1, 31, %g1\n    ld  [%fp-68], %g3\n    mov %g1, %g2\n    ldd [%fp-64], %o0\n    mov %g2, %o2\n    mov %g3, %o3\n    call    __udivdi3, 0\n     nop\n    mov %o0, %g2\n    mov %o1, %g3\n    std %g2, [%fp-136]\n    ldd [%fp-136], %o0\n    mov 0, %o2\n    mov 0, %o3\n    call    __cmpdi2, 0\n     nop\n    mov %o0, %g1\n    cmp %g1, 1\n    bl  .LL6\n     nop\n    ldd [%fp-136], %o0\n    call    __floatdidf, 0\n     nop\n    std %f0, [%fp-144]\n    b   .LL5\n     nop\n.LL6:\n    ldd [%fp-136], %o4\n    and %o4, 0, %g2\n    and %o5, 1, %g3\n    ld  [%fp-136], %o5\n    sll %o5, 31, %g1\n    ld  [%fp-132], %g4\n    srl %g4, 1, %o5\n    or  %o5, %g1, %o5\n    ld  [%fp-136], %g1\n    srl %g1, 1, %o4\n    or  %g2, %o4, %g2\n    or  %g3, %o5, %g3\n    mov %g2, %o0\n    mov %g3, %o1\n    call    __floatdidf, 0\n     nop\n    std %f0, [%fp-144]\n    ldd [%fp-144], %f8\n    ldd [%fp-144], %f10\n    faddd   %f8, %f10, %f8\n    std %f8, [%fp-144]\n.LL5:\n    ldd [%fp-144], %f8\n    std %f8, [%fp-48]\n    ld  [%fp-68], %g1\n    sra %g1, 31, %g1\n    ld  [%fp-68], %g3\n    mov %g1, %g2\n    ldd [%fp-56], %o0\n    mov %g2, %o2\n    mov %g3, %o3\n    call    __udivdi3, 0\n     nop\n    mov %o0, %g2\n    mov %o1, %g3\n    std %g2, [%fp-128]\n    ldd [%fp-128], %o0\n    mov 0, %o2\n    mov 0, %o3\n    call    __cmpdi2, 0\n     nop\n    mov %o0, %g1\n    cmp %g1, 1\n    bl  .LL8\n     nop\n    ldd [%fp-128], %o0\n    call    __floatdidf, 0\n     nop\n    std %f0, [%fp-120]\n    b   .LL7\n     nop\n.LL8:\n    ldd [%fp-128], %o4\n    and %o4, 0, %g2\n    and %o5, 1, %g3\n    ld  [%fp-128], %o5\n    sll %o5, 31, %g1\n    ld  [%fp-124], %g4\n    srl %g4, 1, %o5\n    or  %o5, %g1, %o5\n    ld  [%fp-128], %g1\n    srl %g1, 1, %o4\n    or  %g2, %o4, %g2\n    or  %g3, %o5, %g3\n    mov %g2, %o0\n    mov %g3, %o1\n    call    __floatdidf, 0\n     nop\n    std %f0, [%fp-120]\n    ldd [%fp-120], %f8\n    ldd [%fp-120], %f10\n    faddd   %f8, %f10, %f8\n    std %f8, [%fp-120]\n.LL7:\n    ldd [%fp-48], %f8\n    ldd [%fp-48], %f10\n    fmuld   %f8, %f10, %f8\n    ldd [%fp-120], %f10\n    fsubd   %f10, %f8, %f8\n    std %f8, [%fp-112]\n    ldd [%fp-112], %f8\n    fsqrtd  %f8, %f8\n    std %f8, [%fp-152]\n    ldd [%fp-152], %f10\n    ldd [%fp-152], %f8\n    fcmpd   %f10, %f8\n    nop\n    fbe .LL9\n     nop\n    ldd [%fp-112], %o0\n    call    sqrt, 0\n     nop\n    std %f0, [%fp-152]\n.LL9:\n    ldd [%fp-152], %f8\n    std %f8, [%fp-40]\n    sethi   %hi(.LLC7), %g1\n    or  %g1, %lo(.LLC7), %o0\n    ld  [%fp-48], %o1\n    ld  [%fp-44], %o2\n    ld  [%fp-40], %o3\n    ld  [%fp-36], %o4\n    call    printf, 0\n     nop\n    mov 0, %g1\n    mov %g1, %i0\n    restore\n    jmp %o7+8\n     nop\n    .size   main, .-main\n    .ident  \"GCC: (GNU) 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)\"\n    .section    \".note.GNU-stack\"\n</code></pre>\n\n<p>When I generate the Assembly code version with <code>nLoop = 5000000000 (5.0e+9)</code>, the differences are illustrated on the following figure (with <code>vimdiff</code>) :</p>\n\n<p><a href=\"https://i.stack.imgur.com/Cxn8f.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Cxn8f.png\" alt=\"vimdiff differences\"></a></p>\n\n<p>the block of \"4 Billions\" version :</p>\n\n<pre><code>mov     0, %g2                                                                                                                           \nsethi   %hi(4000000000), %g3\n</code></pre>\n\n<p>is replaced in \"5 Billions\" version by :</p>\n\n<pre><code> mov     1, %g2\n sethi   %hi(705032192), %g3                                                   \n or      %g3, 512, %g3                                                         \n</code></pre>\n\n<p>I can see that <code>5.0+e9</code> can't be coded on 32 bits, since the instruction </p>\n\n<pre><code>sethi   %hi(705032192), %g3\n</code></pre>\n\n<p>Paradoxically, when I compile the version \"5 Billions\" Assembly code, the ouput parameter <code>sum</code> is computed well, i.e is equal to <code>5 Billions</code>, and I can't explain it.</p>\n\n<p>Any help or comment is welcome, thanks.</p>\n"}, {"tags": ["c", "arm", "emulation", "simulator", "hex-file"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501662835, "post_id": 45455482, "comment_id": 77871611, "body": "I afraid you must start your C / C++ journey from something much much easier. After 2-3 years of the active programming you can start this project. BTW absolutely pointless task."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1501663192, "post_id": 45455482, "comment_id": 77871867, "body": "Considering it&#39;s M3, I think you need to find where interrupt vector table is located, as it should have addresses of all root functions such as startup code or interrupt handlers. I am not sure if the location of the table is standardised, so you&#39;ll need to read on your device/compiler manuals to find out."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1502298291, "post_id": 45455482, "comment_id": 78152833, "body": "having had already done this myself, more than once, it is actually a good task in a number of ways.  But if you dont know how to use fopen(), fread(), fclose() then you are not ready for any programming projects much less this one.  there are a plethera of possible file formats, all documented, including just a raw memory image, pick one or two or three, do your research, make or find a hex editor/dump program (hexdump for example) and look at the file.  Reading the arm docs although not bad docs, to do the instruction decoding is harder than reading the binary file."}], "answers": [{"tags": [], "owner": {"reputation": 68808, "user_id": 718618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9878e99dc2bbd256050b7dc4ffea820b?s=128&d=identicon&r=PG", "display_name": "C&#233;dric Julien", "link": "https://stackoverflow.com/users/718618/c%c3%a9dric-julien"}, "is_accepted": true, "score": 1, "last_activity_date": 1501663498, "creation_date": 1501663498, "answer_id": 45455830, "question_id": 45455482, "link": "https://stackoverflow.com/questions/45455482/im-trying-to-write-emulator-for-arm-cortex-m3-how-can-i-read-the-binary-file-t/45455830#45455830", "title": "I&#39;m trying to write emulator for ARM Cortex M3. How can I read the binary file then decode it?", "body": "<p>First, need to mention that writing an emulator for a processor is not an easy task, other have already spend lot of time on it, you can take a look at <a href=\"https://www.qemu.org/\" rel=\"nofollow noreferrer\">QEmu</a> for example. One project is currenlty using Qemu to emulate a Cortex M3 based board, the <a href=\"https://www.zephyrproject.org/doc/boards/arm/qemu_cortex_m3/doc/board.html\" rel=\"nofollow noreferrer\">ZephyrProject</a>.</p>\n\n<p>An intermediate step, could be to use a tool that already understand/decode hex or bin file, and <a href=\"http://www.radare.org/r/\" rel=\"nofollow noreferrer\">Radare</a> is one of those kind of tool. With it you will be abvle to disassemble many elf files and get the instructions from it (that you'll then have to emulate ;) ).</p>\n\n<p>That said, if you still really want/need to make the emulation, and start to read and understand the hex or binary files, the first thing to do will to study the Intel Hex file format (yes, even ARM is using this Intel format ;) ). \nYou can find <a href=\"http://microsym.com/editor/assets/intelhex.pdf\" rel=\"nofollow noreferrer\">the official specification here</a> or in the <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.faqs/ka9903.html\" rel=\"nofollow noreferrer\">technical support website of ARM</a>.</p>\n\n<p>Have fun ;)</p>\n"}], "owner": {"reputation": 65, "user_id": 7871493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/epYnm.jpg?s=128&g=1", "display_name": "cagta", "link": "https://stackoverflow.com/users/7871493/cagta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 748, "favorite_count": 0, "accepted_answer_id": 45455830, "answer_count": 1, "score": 1, "last_activity_date": 1501663498, "creation_date": 1501662459, "question_id": 45455482, "link": "https://stackoverflow.com/questions/45455482/im-trying-to-write-emulator-for-arm-cortex-m3-how-can-i-read-the-binary-file-t", "title": "I&#39;m trying to write emulator for ARM Cortex M3. How can I read the binary file then decode it?", "body": "<p>I'm trying to write emulator for ARM Cortex M3. How can I read the binary file then decode it? I want to use binary files as a resource of my emulator. I created a project with Atmel Studio and I compiled it. Now, I have a .hex file. I can also convert this file to binary file with hex2bin. After that, how can I use that binary file for fetching and decoding instructions ? I'm working on Visual Studio with C/C++.</p>\n"}, {"tags": ["c", "casting", "iotivity"], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 5003570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c076b36bd93429f5d269358182972c4b?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Wichmann", "link": "https://stackoverflow.com/users/5003570/mats-wichmann"}, "edited": false, "score": 0, "creation_date": 1501677238, "post_id": 45454700, "comment_id": 77882201, "body": "In this case, a look at the documentation should clarify, there were once used but no longer:       <code>ipAddr IP Address of host device. Deprecated parameter. </code>     <code>port Port of host device. Deprecated parameter.</code>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1501660274, "creation_date": 1501660274, "answer_id": 45454700, "question_id": 45454658, "link": "https://stackoverflow.com/questions/45454658/unable-to-know-the-use-of-the-statement-void-ipaddr-void-port-in-iotivit/45454700#45454700", "title": "unable to know the use of the statement &quot;(void) ipAddr; (void) port;&quot; in Iotivity framework", "body": "<p>In the code</p>\n\n<pre><code>(void) ipAddr;\n(void) port;\n</code></pre>\n\n<p>is a way to silence compiler warning about \"unused\" variables.</p>\n\n<p>It comes handy when the APIs has to follow a certain pattern to accept a number of parameters to conform to some standard, but actually, in the code you do not use the variables anyway.</p>\n"}], "owner": {"reputation": 541, "user_id": 7373699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a8e52aa20dda4ed7983eca128bd0f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath T S", "link": "https://stackoverflow.com/users/7373699/bharath-t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1501660426, "accepted_answer_id": 45454700, "answer_count": 1, "score": 1, "last_activity_date": 1501660436, "creation_date": 1501660175, "last_edit_date": 1501660436, "question_id": 45454658, "link": "https://stackoverflow.com/questions/45454658/unable-to-know-the-use-of-the-statement-void-ipaddr-void-port-in-iotivit", "closed_reason": "Duplicate", "title": "unable to know the use of the statement &quot;(void) ipAddr; (void) port;&quot; in Iotivity framework", "body": "<p>i was working on Iotivity framework, while tracing i was not able to know the use of these statements.\niotivity-1.3.0/resource/csdk/stack/src/ocstack.c</p>\n\n<p>i'm curious to know the usage...</p>\n\n<pre><code>OCStackResult OCInit(const char *ipAddr, uint16_t port, OCMode mode)\n{\n(void) ipAddr;\n(void) port;\nreturn OCInit1(mode, OC_DEFAULT_FLAGS, OC_DEFAULT_FLAGS);\n}\n</code></pre>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 3, "creation_date": 1501659808, "post_id": 45454492, "comment_id": 77869639, "body": "What is it that you don&#39;t understand? Recursion or static variables?"}, {"owner": {"reputation": 23, "user_id": 8332164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/42qHA.png?s=128&g=1", "display_name": "user8332164", "link": "https://stackoverflow.com/users/8332164/user8332164"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1501660150, "post_id": 45454492, "comment_id": 77869835, "body": "By adding static I get 0000 and that&#39;s understandable, but the problem was in loop, termination condition is not there, now I got it."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1501660810, "post_id": 45454492, "comment_id": 77870271, "body": "You may check my answer here as to what happens when we do an infinite recursive call: <a href=\"https://stackoverflow.com/questions/45427160/why-am-i-getting-segmentation-fault-in-this/45429726#45429726\" title=\"why am i getting segmentation fault in this\">stackoverflow.com/questions/45427160/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501660996, "post_id": 45454492, "comment_id": 77870405, "body": "Similar to <a href=\"https://stackoverflow.com/questions/45445745/recursion-and-static-variables\">this question</a> and <a href=\"https://stackoverflow.com/questions/45393083/unexpected-output-of-the-main-function-by-repeated-call\">this question</a>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501665926, "post_id": 45454492, "comment_id": 77873839, "body": "Compiling successfully and then failing to run is normal behaviour."}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 3, "last_activity_date": 1501661627, "last_edit_date": 1501661627, "creation_date": 1501659885, "answer_id": 45454565, "question_id": 45454492, "link": "https://stackoverflow.com/questions/45454492/why-this-program-compiled-successfully-but-failed-to-run/45454565#45454565", "title": "Why this program compiled successfully but failed to run?", "body": "<p>The variable <code>i</code> has the value <em>5</em> every time the function <code>main()</code> is entered (each call to <code>main()</code> owns its own copy of that variable on the stack). There is no <em>recursion termination</em>, because the condition for the recursion termination is never met (i.e.: <code>--i</code> never evaluates to zero).\nTherefore, <code>main()</code> is recursively called until there is no more place on the stack.</p>\n\n<p>If you however declare <code>i</code> as <code>static</code>, there is a single shared copy of the variable <code>i</code> for all calls to <code>main()</code>. The recursion termination condition is met when <code>--i</code> evaluates to zero.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 3251878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BfjTm.jpg?s=128&g=1", "display_name": "Akash Deep Sharma", "link": "https://stackoverflow.com/users/3251878/akash-deep-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1501660227, "creation_date": 1501660227, "answer_id": 45454683, "question_id": 45454492, "link": "https://stackoverflow.com/questions/45454492/why-this-program-compiled-successfully-but-failed-to-run/45454683#45454683", "title": "Why this program compiled successfully but failed to run?", "body": "<p>It runs out of space(on stack) because it is making a call to main() indefinetely</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 6728154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6QGex.png?s=128&g=1", "display_name": "Geo", "link": "https://stackoverflow.com/users/6728154/geo"}, "is_accepted": false, "score": 0, "last_activity_date": 1501660647, "creation_date": 1501660647, "answer_id": 45454845, "question_id": 45454492, "link": "https://stackoverflow.com/questions/45454492/why-this-program-compiled-successfully-but-failed-to-run/45454845#45454845", "title": "Why this program compiled successfully but failed to run?", "body": "<p>The code itself is correct, the program will compile without any problem. The problem is that the condition <code>if (--i)</code> will always evaluate to true as each time <code>main</code> is recursively called, a new local <code>i</code> variable is created and it is always worth <code>5</code>. As you stack more and more calls, the program will terminate by SIGSEGV when the stack can not grow anymore. You can observe this with Valgrind :</p>\n\n<pre><code>==10972== Memcheck, a memory error detector\n==10972== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==10972== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==10972== Command: ./a.out\n==10972==\n==10972== Stack overflow in thread #1: can't grow stack to 0xffe801000\n==10972==\n==10972== Process terminating with default action of signal 11 (SIGSEGV)\n</code></pre>\n\n<p>The reason why the program outputs <code>0000</code> when you declare <code>i</code> as a <code>static</code> variable is because <code>i</code> is not redeclared at every <code>main</code> call. So basically <code>main</code> is recursively called until <code>i</code> is worth <code>0</code>. Then, all the stacked <code>printf</code>s are executed but as <code>i</code> is worth <code>0</code> in each of these stacked calls, you will see <code>0000</code>. The <code>static</code> keyword makes all the <code>main</code> calls actually refering to the same <code>i</code> variable and not copies.</p>\n"}], "owner": {"reputation": 23, "user_id": 8332164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/42qHA.png?s=128&g=1", "display_name": "user8332164", "link": "https://stackoverflow.com/users/8332164/user8332164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1501661729, "creation_date": 1501659687, "last_edit_date": 1501661729, "question_id": 45454492, "link": "https://stackoverflow.com/questions/45454492/why-this-program-compiled-successfully-but-failed-to-run", "title": "Why this program compiled successfully but failed to run?", "body": "<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\nint i=5;\n    if(--i)\n    {\n        main();\n        printf(\"%d \",i);\n    }\n</code></pre>\n\n<p>Note that if we make <code>int i</code> as <code>static</code> then answer would be <code>0000</code>.</p>\n"}, {"tags": ["c", "arrays", "xcode"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501659508, "post_id": 45454319, "comment_id": 77869452, "body": "I doubt this has to do with the <i>array</i> ...  code looks ok. (assuming you <b>have</b> <code>#include &lt;stdio.h&gt;</code> above)"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1501659629, "post_id": 45454319, "comment_id": 77869518, "body": "your code is fine. compiles and runs on my gcc"}, {"owner": {"reputation": 13, "user_id": 8403913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986626079702c529a673206fba5a09fc?s=128&d=identicon&r=PG&f=1", "display_name": "Max Sher", "link": "https://stackoverflow.com/users/8403913/max-sher"}, "edited": false, "score": 0, "creation_date": 1501660190, "post_id": 45454319, "comment_id": 77869860, "body": "@FelixPalmenThanks for the quick response. That&#39;s why I&#39;m confused, the code is fine and runs in Terminal, but it won&#39;t run in XCode. Any idea why?"}, {"owner": {"reputation": 13, "user_id": 8403913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986626079702c529a673206fba5a09fc?s=128&d=identicon&r=PG&f=1", "display_name": "Max Sher", "link": "https://stackoverflow.com/users/8403913/max-sher"}, "edited": false, "score": 0, "creation_date": 1501660197, "post_id": 45454319, "comment_id": 77869867, "body": "@ClsForCookies Thanks for the quick response. That&#39;s why I&#39;m confused, the code is fine and runs in Terminal, but it won&#39;t run in XCode. Any idea why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1501660725, "post_id": 45454319, "comment_id": 77870216, "body": "As I said, I very much doubt your problem has <i>anything</i> to do with the actual code. In the current state, I doubt someone can reproduce your problem. You could try to add more details (like your settings, where and how the &quot;output&quot; appears, whatever might help understanding the problem) and then hope someone who knows XCode has an explanation for you."}, {"owner": {"reputation": 13, "user_id": 8403913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986626079702c529a673206fba5a09fc?s=128&d=identicon&r=PG&f=1", "display_name": "Max Sher", "link": "https://stackoverflow.com/users/8403913/max-sher"}, "edited": false, "score": 0, "creation_date": 1501661428, "post_id": 45454319, "comment_id": 77870701, "body": "@FelixPalmen Thanks, I&#39;ve added a screenshot so hopefully someone can help. Appreciate your input."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1501661740, "post_id": 45454319, "comment_id": 77870897, "body": "Looking at the screenshot, you do realise you have breakpoints set in your Xcode project, right ? What happens if you disable breakpoints and run ?"}, {"owner": {"reputation": 13, "user_id": 8403913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986626079702c529a673206fba5a09fc?s=128&d=identicon&r=PG&f=1", "display_name": "Max Sher", "link": "https://stackoverflow.com/users/8403913/max-sher"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1501661992, "post_id": 45454319, "comment_id": 77871053, "body": "@PaulR That was exactly what I needed. Thanks!"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1501662033, "post_id": 45454319, "comment_id": 77871076, "body": "Well at least you know how to use breakpoints for debugging now!"}], "answers": [{"comments": [{"owner": {"reputation": 5464, "user_id": 59527, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5728955f444a62bbba61ba09690c50ab?s=128&d=identicon&r=PG", "display_name": "Sijmen Mulder", "link": "https://stackoverflow.com/users/59527/sijmen-mulder"}, "edited": false, "score": 1, "creation_date": 1501662717, "post_id": 45455311, "comment_id": 77871543, "body": "Ough, well spotted!"}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1501662000, "creation_date": 1501662000, "answer_id": 45455311, "question_id": 45454319, "link": "https://stackoverflow.com/questions/45454319/xcode-seemingly-unable-to-use-arrays-in-c/45455311#45455311", "title": "Xcode Seemingly Unable to Use Arrays in C", "body": "<p>You have breakpoints set in your Xcode project, so the program is pausing at the first breakpoint and giving you the <code>(lldb)</code> debugger prompt. Disable the breakpoints and run and everything should behave as expected. You can either manually disable each breakpoint (by clicking on it - it should then become dimmed), or go to <code>Debug</code> => <code>Disable Breakpoints</code> in the menu bar.</p>\n"}], "owner": {"reputation": 13, "user_id": 8403913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986626079702c529a673206fba5a09fc?s=128&d=identicon&r=PG&f=1", "display_name": "Max Sher", "link": "https://stackoverflow.com/users/8403913/max-sher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 45455311, "answer_count": 1, "score": 1, "last_activity_date": 1501662175, "creation_date": 1501659172, "last_edit_date": 1501662175, "question_id": 45454319, "link": "https://stackoverflow.com/questions/45454319/xcode-seemingly-unable-to-use-arrays-in-c", "title": "Xcode Seemingly Unable to Use Arrays in C", "body": "<p>It's very likely that this is user error as I'm somewhat new to Xcode, but I can't figure this out. Hopefully one of you can. </p>\n\n<p>I'm trying to add an array using the following code:</p>\n\n<pre><code>int ArraySum (int MyArray [], int size) {\n    int sum = 0;\n    for (int i = 0; i&lt; size; i++) {\n        sum = sum + MyArray [i];\n    }\n    return sum;\n}\n\nint main (){\n    int mynumberarray [6] = {1,2,3,4,5,6};\n    int the_sum = ArraySum (mynumberarray, 6);\n    printf (\"The Sum is = %d \\n\", the_sum);\n    return 0;\n}\n</code></pre>\n\n<p>When I click the build &amp; run button in Xcode, the only output I get is (lldb). </p>\n\n<p>This would typically lead me to believe that I made a mistake somewhere, but when I run the code through Terminal it runs perfectly and gives me the correct sum.</p>\n\n<p>Can anyone help me here? This isn't an isolated incident, I've had several issues working with arrays in Xcode that are working perfectly when executed in Terminal.</p>\n\n<p>Screenshot: </p>\n\n<p><a href=\"https://i.stack.imgur.com/ougIn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ougIn.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "docker"], "comments": [{"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 1, "creation_date": 1501675150, "post_id": 45453861, "comment_id": 77880498, "body": "Try with <code>docker run --privileged ....</code> and see if it works for you"}, {"owner": {"reputation": 123, "user_id": 6458469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a76af8b44168b1375e7ee92543e9e2?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Navarro", "link": "https://stackoverflow.com/users/6458469/benjamin-navarro"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1501689629, "post_id": 45453861, "comment_id": 77892261, "body": "Tried it already, I should have mentioned it"}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1501689678, "post_id": 45453861, "comment_id": 77892295, "body": "any error code and explanation that helps?"}, {"owner": {"reputation": 123, "user_id": 6458469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a76af8b44168b1375e7ee92543e9e2?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Navarro", "link": "https://stackoverflow.com/users/6458469/benjamin-navarro"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1501769706, "post_id": 45453861, "comment_id": 77934490, "body": "Apart from what I have mentioned in the question, not really. I&#39;ll try to post a minimum example code"}, {"owner": {"reputation": 123, "user_id": 6458469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a76af8b44168b1375e7ee92543e9e2?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Navarro", "link": "https://stackoverflow.com/users/6458469/benjamin-navarro"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1503328171, "post_id": 45453861, "comment_id": 78558894, "body": "After some digging I found that the program executes just fine when started using sudo dut doesn&#39;t when run as a normal user with the setuid bit set by root (should be the normal behavior)"}], "owner": {"reputation": 123, "user_id": 6458469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a76af8b44168b1375e7ee92543e9e2?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Navarro", "link": "https://stackoverflow.com/users/6458469/benjamin-navarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 472, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503407836, "creation_date": 1501657770, "last_edit_date": 1503407836, "question_id": 45453861, "link": "https://stackoverflow.com/questions/45453861/cant-set-capabilities-inside-a-docker-container", "title": "Can&#39;t set capabilities inside a Docker container", "body": "<p>In order to run some software only compatible with Ubuntu 14.04, I want to deploy it inside a Docker container so that it has all the required dependencies.</p>\n\n<p>The problem comes when this software tries to set capabilities on an executable (cap_ipc_lock, cap_net_raw, cap_sys_nice, cap_net_admin). Upon execution, I got an <code>Failed to set capabilities on file `path_to_file' (Operation not permitted)</code> message (see code below).</p>\n\n<p>From the Docker <a href=\"https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities\" rel=\"nofollow noreferrer\">documentation</a> I found that a container runs by default with a limited set of capabilities but it's possible to specify which ones are needed. But even if I run it with <code>--cap-add=ALL</code> I still got the error. Here is the couple lines of C code setting the capabilities, if it helps:</p>\n\n<pre><code>// Create capability set\nconst char *cap_text = \"cap_ipc_lock=ep cap_net_raw=ep cap_sys_nice=ep cap_net_admin=ep\";\n  cap_t cap_d = cap_from_text(cap_text);\n  if (cap_d == NULL) {\n    perror(\"cap_from_text\");\n    return -1;\n  }\n\n  // Set file capability\n  int retval = cap_set_file(EXECUTABLE, cap_d);\n  if (retval != 0) {\n    fprintf(stderr, \"Failed to set capabilities on file `%s' (%s)\\n\", argv[1], strerror(errno));\n    return -1;\n  }\n</code></pre>\n\n<p>Any idea on how to make this work? Thanks</p>\n\n<p>Edit:\nFor those who may face the same problem, I found a solution. I didn't work because everything (source code, executables, etc) were in a host folder mounted inside the container (-v option). Copying everything directly inside the container solved the problem.</p>\n"}, {"tags": ["python", "c"], "answers": [{"tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": true, "score": 4, "last_activity_date": 1501666199, "creation_date": 1501666199, "answer_id": 45456881, "question_id": 45453773, "link": "https://stackoverflow.com/questions/45453773/how-to-set-multiple-arguments-with-pyarg-parsetuple-in-c/45456881#45456881", "title": "How to set multiple arguments with pyarg_parsetuple in C?", "body": "<p>This is an example:</p>\n\n<pre><code>const char *field = 0; PyObject *value; int typeField; size_t size = 0;\nif (!PyArg_ParseTuple(args, \"isO|n\", &amp;typeField, &amp;field, &amp;value, &amp;size)) {\n  return 0;\n}\n</code></pre>\n\n<p>The characters in the 2<sup>nd</sup> argument have to correspond to the C types of the passed pointers, of course.</p>\n\n<p>Btw. the <code>size</code> is an optional parameter.</p>\n\n<p>A complete doc. about <code>PyArg_ParseTuple()</code> can be found in the Python doc.</p>\n\n<p><a href=\"https://docs.python.org/3/c-api/arg.html\" rel=\"nofollow noreferrer\">Parsing arguments and building values</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 589, "user_id": 4635362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c0f4b9e411b01ffced29ec26e29047?s=128&d=identicon&r=PG&f=1", "display_name": "shijq73", "link": "https://stackoverflow.com/users/4635362/shijq73"}, "is_accepted": false, "score": 1, "last_activity_date": 1514081213, "creation_date": 1514081213, "answer_id": 47957544, "question_id": 45453773, "link": "https://stackoverflow.com/questions/45453773/how-to-set-multiple-arguments-with-pyarg-parsetuple-in-c/47957544#47957544", "title": "How to set multiple arguments with pyarg_parsetuple in C?", "body": "<p>Use following code to get all arguments</p>\n\n<pre><code>  vector&lt;PyObject*&gt; objects;\n  int argc = PyTuple_GET_SIZE(args);\n  objects.resize(argc);\n\n  for (int i=0; i&lt;argc ; i++) {\n    objects[i] = PyTuple_GET_ITEM(args, i);\n  }\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8208498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b7ded91076e824165fde13dfe857949?s=128&d=identicon&r=PG&f=1", "display_name": "X2E B599", "link": "https://stackoverflow.com/users/8208498/x2e-b599"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2000, "favorite_count": 1, "accepted_answer_id": 45456881, "answer_count": 2, "score": 3, "last_activity_date": 1514081213, "creation_date": 1501657538, "last_edit_date": 1501660343, "question_id": 45453773, "link": "https://stackoverflow.com/questions/45453773/how-to-set-multiple-arguments-with-pyarg-parsetuple-in-c", "title": "How to set multiple arguments with pyarg_parsetuple in C?", "body": "<p>How can I setup the <code>PyArg_ParseTuple</code> function with more than one argument?</p>\n"}, {"tags": ["c", "c99", "keil"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501657159, "post_id": 45453583, "comment_id": 77867982, "body": "<code>uint32_t</code> is a standard <a href=\"http://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\">fixed-width integer type</a>, and is defined in the <code>&lt;stdint.h&gt;</code> system header file. Because it&#39;s a standard type, it&#39;s portable between platforms."}], "answers": [{"tags": [], "owner": {"reputation": 32261, "user_id": 75652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/303ee8d24a8776dcf67b30c1d4e8b064?s=128&d=identicon&r=PG", "display_name": "janneb", "link": "https://stackoverflow.com/users/75652/janneb"}, "is_accepted": false, "score": 2, "last_activity_date": 1501657294, "creation_date": 1501657294, "answer_id": 45453688, "question_id": 45453583, "link": "https://stackoverflow.com/questions/45453583/difference-between-uint32-c-and-uint32-t/45453688#45453688", "title": "Difference between UINT32_C and uint32_t", "body": "<p>Don't know about keil, but at least in Linux UINT32_C is a macro to create a uint32_t literal.</p>\n\n<p>And as mentioned by others, uint32_t is a type defined as of C99 in stdint.h.</p>\n"}, {"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 14, "last_activity_date": 1501658983, "last_edit_date": 1501658983, "creation_date": 1501657404, "answer_id": 45453725, "question_id": 45453583, "link": "https://stackoverflow.com/questions/45453583/difference-between-uint32-c-and-uint32-t/45453725#45453725", "title": "Difference between UINT32_C and uint32_t", "body": "<p><code>UINT32_C</code> is a macro which defines integer constant of type <code>uint_least32_t</code>. For example:</p>\n\n<pre><code>UINT32_C(123) // Might expand to 123UL on system where uint_least32_t is unsigned long\n              // or just 123U, if uint_least32_t is unsigned int.\n</code></pre>\n\n<blockquote>\n  <h3>7.20.4.1 Macros for minimum-width integer constants</h3>\n  \n  <ol>\n  <li>The macro <strong>INT<em>N</em>_C(</strong><em>value</em><strong>)</strong> shall expand to an integer constant expression\n  corresponding to the type <strong>int_least<em>N</em>_t</strong>. The macro <strong>UINT<em>N</em>_C(</strong><em>value</em><strong>)</strong> shall expand\n  to an integer constant expression corresponding to the type <strong>uint_least<em>N</em>_t</strong>. For\n  example, if <code>uint_least64_t</code> is a name for the type <code>unsigned long long int</code>,\n  then <code>UINT64_C(0x123)</code> might expand to the integer constant <code>0x123ULL</code>.</li>\n  </ol>\n</blockquote>\n\n<p>It is thus possible that this constant is more than 32 bits on some rare systems.</p>\n\n<p>But if you are on a system where multiple of 8-bits 2's complement types are defined (most modern systems), and <code>uint32_t</code> exists, then this creates 32-bit constant.</p>\n\n<p>They all are defined in <code>stdint.h</code>, and have been part of the C standard since C99.</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501679689, "post_id": 45453774, "comment_id": 77884241, "body": "Interesting minus - what is wrong with this answer or maybe it is for example the revenge one"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501688509, "post_id": 45453774, "comment_id": 77891454, "body": "This answer simple says the macro appends a suffix.  No rational is provided for what suffix, no mention of the resultant type,  no mention that the value needs to be such that it is suffix-able.  Minor: In C, a constant is created, not a <i>literal</i>.  In C, its literals (string, compound) can have their address taken - constants not so."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501690351, "post_id": 45453774, "comment_id": 77892740, "body": "integer literal is in the common use. I do not think that anyone will be confused by this. See the answer below given by janneb. Another example <a href=\"https://www.tutorialspoint.com/cprogramming/c_constants.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_constants.htm</a>.  <a href=\"http://en.cppreference.com/w/cpp/language/integer_literal\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/integer_literal</a> or <a href=\"https://en.wikipedia.org/wiki/Integer_literal\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Integer_literal</a>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501691058, "post_id": 45453774, "comment_id": 77893170, "body": "@chux and in the formal language theory a literal is a notation for representing a fixed value in source code. The C standard uses term <code>constant</code> IMO improperly, not as it is usually understood in the computer science."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -2, "last_activity_date": 1501690583, "last_edit_date": 1501690583, "creation_date": 1501657539, "answer_id": 45453774, "question_id": 45453583, "link": "https://stackoverflow.com/questions/45453583/difference-between-uint32-c-and-uint32-t/45453774#45453774", "title": "Difference between UINT32_C and uint32_t", "body": "<p>It is the macro appending the suffix creating the literal  for example <code>#define UINT32_C(c) c##UL</code></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501657804, "post_id": 45453800, "comment_id": 77868409, "body": "@JonathanLeffler my bad, I checked the standard, but only searching for the exact identifier. Will update the answer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501657816, "post_id": 45453800, "comment_id": 77868419, "body": "Exactly. It is standard, but  IMO useless"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501657928, "post_id": 45453800, "comment_id": 77868494, "body": "@PeterJ I tried to explain how it is useful (and thinking about a compiler targeting 8bit &#181;Cs, I think it really is), but I indeed never needed something like this before."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501658300, "post_id": 45453800, "comment_id": 77868700, "body": "Have you seen anyone using it even on the 8bit platforms.? It is better to write numbers yourself. This makes the code unreadable as well - or maybe less than the &quot;normal&quot; numbers with the suffix"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1501658505, "post_id": 45453800, "comment_id": 77868826, "body": "@PeterJ: Imagine you write code you want to compile an a 64bit <i>LP64</i> target as well as on a 8bit target. The 8bit target will have 16bit <code>int</code>, so a constant larger than <code>32767</code> will not compile without a suffix. But the compiler for LP64 target will compile the constant with <code>UL</code> suffix into a 64bit value, not what you want."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501658767, "post_id": 45453800, "comment_id": 77868993, "body": "@Felix Palmen code which will compile and run on 8 &amp; 64 bit platforms is not worth touching. 8 bit platforms require a very specific programming as any longer than 8 bits math operations are extremely expensive. Remember - 8 bit targets often do not have even hardware multiplication"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501658835, "post_id": 45453800, "comment_id": 77869028, "body": "@PeterJ But you know that one design goal of C is to actually <i>abstract</i> from the hardware? I agree a situation needing those macros is probably rare (therefore this made-up example), but they are there to achieve exactly this abstraction properly."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1501658965, "post_id": 45453800, "comment_id": 77869104, "body": "@PeterJ - It is most certainly not useless. Sure you won&#39;t use it to initialize a variable, but what about passing an argument to a function chosen by <code>_Generic</code> selection? The type of the constant will have great effect."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501659017, "post_id": 45453800, "comment_id": 77869142, "body": "@Felix Palmen Maybe C theoreticians never had to program 8 bit targets, and their knowledge is nomen omen theoretical, with no practical value"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1501659298, "post_id": 45453800, "comment_id": 77869309, "body": "@StoryTeller same useless feature. Potential source of very difficult to locate errors. Added probably to be like C++, and say : <code>you can almost overload in C too</code>. If you need overloading write in C++"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1501659371, "post_id": 45453800, "comment_id": 77869373, "body": "@PeterJ - I take it you don&#39;t like the ISO C committee much."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1501659955, "post_id": 45453800, "comment_id": 77869728, "body": "@StoryTeller they are not fixing issues, and try to make from C a different language. Useless. Power of is C is its simplicity, not too much abstraction. I actively use both C &amp; C++ and do not see any point of implementing C++ like features in C. _Generic is one of the examples."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 8, "last_activity_date": 1501658755, "last_edit_date": 1501658755, "creation_date": 1501657585, "answer_id": 45453800, "question_id": 45453583, "link": "https://stackoverflow.com/questions/45453583/difference-between-uint32-c-and-uint32-t/45453800#45453800", "title": "Difference between UINT32_C and uint32_t", "body": "<p><code>UINT32_C</code> is a macro for writing a constant of type <code>uint_least32_t</code>. Such a constant is suitable e.g. for initializing an <code>uint32_t</code> variable. I found for example the following definition in <a href=\"http://www.nongnu.org/avr-libc/user-manual/group__avr__stdint.html\" rel=\"noreferrer\">avr-libc</a> (this is for the AVR target, just as an example):</p>\n\n<pre><code>#define     UINT32_C(value)   __CONCAT(value, UL)\n</code></pre>\n\n<p>So, when you write</p>\n\n<pre><code>UINT32_C(25)\n</code></pre>\n\n<p>it's expanded to</p>\n\n<pre><code>25UL\n</code></pre>\n\n<p><code>UL</code> is the suffix for an <code>unsigned long</code> integer constant. The macro is useful because there is no standard suffix for <code>uint32_t</code>, so you can use it without knowing that on your target, <code>uint32_t</code> is a <code>typedef</code> e.g. for <code>unsigned long</code>. With other targets, it will be defined in a different way.</p>\n"}, {"tags": [], "owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "is_accepted": false, "score": 3, "last_activity_date": 1501657666, "creation_date": 1501657666, "answer_id": 45453827, "question_id": 45453583, "link": "https://stackoverflow.com/questions/45453583/difference-between-uint32-c-and-uint32-t/45453827#45453827", "title": "Difference between UINT32_C and uint32_t", "body": "<p>These constants are defined something like this:</p>\n\n<pre><code>#define UINT32_C(value) (value##UL)\n</code></pre>\n\n<p>You can only put constant values as macro argument, otherwise it wont compile.</p>\n\n<pre><code>UINT32_C(10); // compiles\n\nuint32_t x = 10;\nUINT32_C(x); // does not compile\n</code></pre>\n"}], "owner": {"reputation": 553, "user_id": 1547253, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fdfe2800359a3f2b542d892f6e3831e9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Yousefi", "link": "https://stackoverflow.com/users/1547253/mohammad-yousefi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4114, "favorite_count": 0, "accepted_answer_id": 45453725, "answer_count": 5, "score": 8, "last_activity_date": 1501690583, "creation_date": 1501656986, "question_id": 45453583, "link": "https://stackoverflow.com/questions/45453583/difference-between-uint32-c-and-uint32-t", "title": "Difference between UINT32_C and uint32_t", "body": "<p>As far as I know the suffix <strong>t</strong> in <em>uint32_t</em> denote <strong>t</strong>ype name but I wonder to know what is the <strong>C</strong> in <em>UINT32_C</em> and what is the differences?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1501656908, "post_id": 45453506, "comment_id": 77867826, "body": "But you say that the <code>-w</code> option <i>doesn&#39;t</i> take any argument. Only the <code>-r</code> option does. Did you by mistake place the colon wrongly?"}, {"owner": {"reputation": 313, "user_id": 4194483, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VZFKoh0vUv0/AAAAAAAAAAI/AAAAAAAAABo/RJdRZ_7NyDs/photo.jpg?sz=128", "display_name": "Mobi Zaman", "link": "https://stackoverflow.com/users/4194483/mobi-zaman"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501657114, "post_id": 45453506, "comment_id": 77867954, "body": "I don&#39;t understand where i did that.."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1501657297, "post_id": 45453506, "comment_id": 77868066, "body": "With <code>&quot;wr:&quot;</code>. The colon in that string tells <code>getopt</code> that the previous option character (<code>r</code> in your case) have an argument that will be put in <code>optarg</code>. Because <code>-w</code> doesn&#39;t take an option the pointer <code>optarg</code> will be undefined and can&#39;t be used. If <code>-w</code> takes an argument but not <code>-r</code> then you should use <code>&quot;w:r&quot;</code>. Perhaps you should read a bit more about <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getopt.html\" rel=\"nofollow noreferrer\"><code>getopt</code></a>?"}, {"owner": {"reputation": 313, "user_id": 4194483, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VZFKoh0vUv0/AAAAAAAAAAI/AAAAAAAAABo/RJdRZ_7NyDs/photo.jpg?sz=128", "display_name": "Mobi Zaman", "link": "https://stackoverflow.com/users/4194483/mobi-zaman"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501657466, "post_id": 45453506, "comment_id": 77868182, "body": "Oh, this must be what i am doing wrong! Thank you so much for your help! It solved my problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1501657500, "post_id": 45453506, "comment_id": 77868207, "body": "Also a note about terminology: <a href=\"http://en.cppreference.com/w/c/string/byte/atoi\" rel=\"nofollow noreferrer\"><code>atoi</code></a> is not a &quot;command&quot; but a <i>function</i>. C doesn&#39;t have commands, it has statements and expressions, and some expressions are function calls, like e.g. <code>atoi(optarg)</code> which is a call to the <a href=\"http://en.cppreference.com/w/c/string/byte/atoi\" rel=\"nofollow noreferrer\"><code>atoi</code></a> function passing <code>optarg</code> as argument."}, {"owner": {"reputation": 313, "user_id": 4194483, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VZFKoh0vUv0/AAAAAAAAAAI/AAAAAAAAABo/RJdRZ_7NyDs/photo.jpg?sz=128", "display_name": "Mobi Zaman", "link": "https://stackoverflow.com/users/4194483/mobi-zaman"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501657809, "post_id": 45453506, "comment_id": 77868413, "body": "Can you also please explain what the function atoi(optarg) does? What exactly is optarg? Also you should post your answer in the answers for me to mark it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1501657976, "post_id": 45453506, "comment_id": 77868524, "body": "I have provided links to references for both <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getopt.html\" rel=\"nofollow noreferrer\"><code>getopt</code></a> and <a href=\"http://en.cppreference.com/w/c/string/byte/atoi\" rel=\"nofollow noreferrer\"><code>atoi</code></a>. Please read them."}, {"owner": {"reputation": 313, "user_id": 4194483, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VZFKoh0vUv0/AAAAAAAAAAI/AAAAAAAAABo/RJdRZ_7NyDs/photo.jpg?sz=128", "display_name": "Mobi Zaman", "link": "https://stackoverflow.com/users/4194483/mobi-zaman"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501658297, "post_id": 45453506, "comment_id": 77868698, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/150784/discussion-between-mobi-zaman-and-some-programmer-dude\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1801517"}, "is_accepted": true, "score": 4, "last_activity_date": 1501657509, "creation_date": 1501657509, "answer_id": 45453767, "question_id": 45453506, "link": "https://stackoverflow.com/questions/45453506/segmentation-fault-in-atoi-command/45453767#45453767", "title": "Segmentation fault in atoi command", "body": "<p>You should put colon between commandline options. </p>\n\n<pre><code>   c = getopt(argc, argv, \"w:r\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 985, "user_id": 6531241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XySrX.jpg?s=128&g=1", "display_name": "Karim Manaouil", "link": "https://stackoverflow.com/users/6531241/karim-manaouil"}, "is_accepted": false, "score": 2, "last_activity_date": 1501657690, "creation_date": 1501657690, "answer_id": 45453834, "question_id": 45453506, "link": "https://stackoverflow.com/questions/45453506/segmentation-fault-in-atoi-command/45453834#45453834", "title": "Segmentation fault in atoi command", "body": "<p>From gnu.org :</p>\n\n<blockquote>\n  <p>An option character in this string can be followed by a colon (\u2018:\u2019) to\n  indicate that it takes a required argument</p>\n</blockquote>\n\n<p>Therefore <code>wr:</code> becomes <code>w:r</code></p>\n"}], "owner": {"reputation": 313, "user_id": 4194483, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VZFKoh0vUv0/AAAAAAAAAAI/AAAAAAAAABo/RJdRZ_7NyDs/photo.jpg?sz=128", "display_name": "Mobi Zaman", "link": "https://stackoverflow.com/users/4194483/mobi-zaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 45453767, "answer_count": 2, "score": 0, "last_activity_date": 1501657690, "creation_date": 1501656798, "question_id": 45453506, "link": "https://stackoverflow.com/questions/45453506/segmentation-fault-in-atoi-command", "title": "Segmentation fault in atoi command", "body": "<p>I have the following code:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int value,direction=0;\n    char c;\n    printf (\"go\\n\");\n    while((c = getopt(argc, argv, \"wr:\")) != -1) {\n        printf (\"go\\n\");\n        printf(\"%c\\n\",c);\n        switch(c) {\n        case 'w':\n            printf (\"go\\n\");\n            value=atoi(optarg);\n            printf (\"go\\n\");\n            printf(\"The input value is %x\",value);\n            direction=1; //1 for write\n            break;\n        case 'r':\n            direction=0; // 0 for read\n            break;\n        default:\n            printf(\"invalid option: %c\\n\", (char)c);\n            usage();\n            return -1;\n        }\n\n    }\n}\n</code></pre>\n\n<p>Now when i run the program by writing</p>\n\n<pre><code> ./spicode.out -w 25\n</code></pre>\n\n<p>I need to pick the 25 after w using optarg, but its producing a segmentation fault.</p>\n\n<p>What am i doing wrong?</p>\n"}, {"tags": ["c", "swift", "swift3"], "answers": [{"tags": [], "owner": {"reputation": 1773, "user_id": 6148332, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/77f7fc0563c3d8d9b735572be993c055?s=128&d=identicon&r=PG&f=1", "display_name": "Nandin Borjigin", "link": "https://stackoverflow.com/users/6148332/nandin-borjigin"}, "is_accepted": true, "score": 1, "last_activity_date": 1501659776, "creation_date": 1501659776, "answer_id": 45454523, "question_id": 45453429, "link": "https://stackoverflow.com/questions/45453429/swift-3-1-equelent-logic-of-this-code/45454523#45454523", "title": "Swift 3.1 equelent logic of this code", "body": "<p>I don't really know about LFSR, but given the C code you present, I think the swift port might be like this:</p>\n\n<pre><code>func lfsr16_obfuscate(data: String, seed: Int) -&gt; String {\n    var scalars = Array(data.unicodeScalars).map { UInt8($0.value) }\n    let len = data.characters.count\n    var lsb: UInt\n    var lfsr = UInt(seed)\n\n    for i in (0..&lt;len*8) {\n        lsb = lfsr &amp; 1\n        lfsr &gt;&gt;= 1\n        if 1 == lsb {\n            lfsr ^= 0xB400\n            scalars[i / 8] ^= UInt8(1 &lt;&lt; (i % 8))\n        }\n    }\n\n    return String(bytes: scalars, encoding: .ascii)!\n}\n</code></pre>\n\n<p>Make sure that you won't process any String that contains characters other than ASCII characters with this function.</p>\n"}], "owner": {"reputation": 189, "user_id": 5851951, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0a85810233e853c2b3bb1d6503e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Kiran", "link": "https://stackoverflow.com/users/5851951/ravi-kiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 45454523, "answer_count": 1, "score": -1, "last_activity_date": 1501659776, "creation_date": 1501656569, "last_edit_date": 1501657477, "question_id": 45453429, "link": "https://stackoverflow.com/questions/45453429/swift-3-1-equelent-logic-of-this-code", "title": "Swift 3.1 equelent logic of this code", "body": "<p>I am Working on linear feedback shift register, I have to securely write the following logic, I have chosen swift as it is more secure compared to objective c\nis it secured if I use the following C logic with as a C file itself? if not I am trying to write the following piece of code in swift </p>\n\n<pre><code>char * lfsr16_obfuscate( char *s, unsigned int length, unsigned int seed)\n{\n    unsigned int i, lsb;\n    unsigned int lfsr = seed;\n\n    for (i = 0; i &lt; length*8; i++)          \n    {\n        lsb = lfsr &amp; 1u;                \n        lfsr &gt;&gt;= 1u;                    \n        if (lsb == 1u)\n        {\n            lfsr ^= 0xB400u;\n            s[i / 8] ^= 1 &lt;&lt; (i % 8);   \n        }\n    }\n\n    return s;\n}\n</code></pre>\n\n<p>Following is swift equelent which I tried , But it is crashing as in the following screenshot, please help me out to write the above C code in swift 3.1</p>\n\n<p><a href=\"https://i.stack.imgur.com/oC7aU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oC7aU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1501656212, "post_id": 45453291, "comment_id": 77867439, "body": "define it either to 0 or 1. You <i>cannot</i> not define it."}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1501656225, "post_id": 45453291, "comment_id": 77867451, "body": "It is not defined anywhere."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501656242, "post_id": 45453291, "comment_id": 77867463, "body": "If you use a symbol, then it must exist."}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1501656302, "post_id": 45453291, "comment_id": 77867486, "body": "so do i need to define either 0 or 1 ? @Jean-Fran&#231;oisFabre"}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1501656340, "post_id": 45453291, "comment_id": 77867501, "body": "It works with above suggestion, either 0 or 1.. thanks"}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501656363, "post_id": 45453291, "comment_id": 77867513, "body": "thanks @Someprogrammerdude"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501657955, "post_id": 45453291, "comment_id": 77868507, "body": "See <a href=\"https://stackoverflow.com/questions/1644868/c-define-macro-for-debug-printing\">C <code>#define</code> macro for debug printing</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1501664331, "post_id": 45453291, "comment_id": 77872714, "body": "<code>fprintf(stderr, &quot;%s:%d:%s(): &quot; fmt, __FILE__, __LINE__, __func__, ##__VA_ARGS__);</code> is not very flexible nor is it robust.  The macro <code>#define(fmt,...)</code> can only accept string literals for the format string.  It will fail to compile should it be passed a <code>char *</code> or <code>char[]</code> used to construct a format string at run-time."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 2, "last_activity_date": 1501656366, "creation_date": 1501656366, "answer_id": 45453387, "question_id": 45453291, "link": "https://stackoverflow.com/questions/45453291/getting-error-while-making-debug-print-macro-in-c/45453387#45453387", "title": "Getting error while making debug print macro in c", "body": "<p>The <code>if</code> instruction inside your macro is a C instruction, not a preprocessor instruction (you can't nest preprocessor instructions)</p>\n\n<p>So <code>DEBUG_ERR</code> <em>must</em> be defined even if debug must not be activated. Set it to 0 and hopefully the compiler wil optimize your statement out.</p>\n\n<p>What you could do instead is test the <code>DEBUG_ERR</code> macro outside and define empty macro if not defined:</p>\n\n<pre><code>#ifdef DEBUG_ERR\n#define print_err(fmt, ...) \\ do { fprintf(stderr, \"%s:%d:%s(): \" fmt, __FILE__, \\ __LINE__, __func__, ##__VA_ARGS__); } while (0)\n#else\n#define print_err(fmt, ...) do {} while(0)\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "is_accepted": false, "score": 0, "last_activity_date": 1501656439, "creation_date": 1501656439, "answer_id": 45453401, "question_id": 45453291, "link": "https://stackoverflow.com/questions/45453291/getting-error-while-making-debug-print-macro-in-c/45453401#45453401", "title": "Getting error while making debug print macro in c", "body": "<p>What you can do also is define DEBUG_ERR as another macro or not. Then you can get rid of the if in print_err</p>\n\n<pre><code>#ifdef DEBUG_ERR\n#define print_err(fmt, ...) \\\n    do { fprintf(stderr, \"%s:%d:%s(): \" fmt, __FILE__, \\\n         __LINE__, __func__, ##__VA_ARGS__); } while (0)\n#else\n#define print_err(fmt, ...)\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1338, "user_id": 4360353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f921d78049db0195bb3fc3cda8e0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Basya", "link": "https://stackoverflow.com/users/4360353/basya"}, "is_accepted": false, "score": 0, "last_activity_date": 1501656945, "creation_date": 1501656945, "answer_id": 45453564, "question_id": 45453291, "link": "https://stackoverflow.com/questions/45453291/getting-error-while-making-debug-print-macro-in-c/45453564#45453564", "title": "Getting error while making debug print macro in c", "body": "<p>To make a conditional on the definition/nondefinition of a preprocessor #define, you have to use #ifdef or #if defined.</p>\n\n<p>See, for example, <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Defined.html\" rel=\"nofollow noreferrer\">this description of #if defined</a></p>\n\n<p>If you want to use it in a code conditional, you can define it as 0 or 1 and then you can use it in an \"if\".</p>\n\n<p>So you can do either:</p>\n\n<pre><code>#ifdef DEBUG_ERR\n#define print_err(fmt, ...) \\\n            do {  fprintf(stderr, \"%s:%d:%s(): \" fmt, __FILE__, \\\n                           __LINE__, __func__, ##__VA_ARGS__); } while (0)\n#else\n#define print_err(fmt, ...)\n#endif\n</code></pre>\n\n<p>Or do as you have done but define DEBUG_ERR to 1 or 0 instead of defining it/leaving it undefined.</p>\n\n<p>I have generally used the first option.</p>\n"}], "owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 45453387, "answer_count": 3, "score": 0, "last_activity_date": 1501656945, "creation_date": 1501656112, "last_edit_date": 1501656270, "question_id": 45453291, "link": "https://stackoverflow.com/questions/45453291/getting-error-while-making-debug-print-macro-in-c", "title": "Getting error while making debug print macro in c", "body": "<p>Code written as follows,</p>\n\n<pre><code>#define print_err(fmt, ...) \\\n    do { if (DEBUG_ERR) fprintf(stderr, \"%s:%d:%s(): \" fmt, __FILE__, \\\n                            __LINE__, __func__, ##__VA_ARGS__); } while (0)\n</code></pre>\n\n<p>I am getting error, if not define the DEBUG_ERR macro. Compilation was done using gcc 5.4.0. There is no problem if the macro DEBUG_ERR is defined.</p>\n\n<pre><code>include/tmp.h:54:18: error: \u2018DEBUG_ERR\u2019 undeclared (first use in this function)\n         do { if (DEBUG_ERR) fprintf(stderr, \"%s:%d:%s(): \" fmt, __FILE__, \\*\n</code></pre>\n"}, {"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1501654920, "post_id": 45452870, "comment_id": 77866668, "body": "If the <code>mysql_query</code> function fail, then perhaps you should check the error? And please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us."}, {"owner": {"reputation": 124, "user_id": 4400533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-KlyzSQytH6M/AAAAAAAAAAI/AAAAAAAAABE/mL1m48pIphM/photo.jpg?sz=128", "display_name": "Iman", "link": "https://stackoverflow.com/users/4400533/iman"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1501658257, "post_id": 45452870, "comment_id": 77868676, "body": "mysql_error() just return a blank line! it&#39;s so strange for me..."}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 6728154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6QGex.png?s=128&g=1", "display_name": "Geo", "link": "https://stackoverflow.com/users/6728154/geo"}, "is_accepted": true, "score": 0, "last_activity_date": 1501658382, "last_edit_date": 1501658382, "creation_date": 1501656429, "answer_id": 45453399, "question_id": 45452870, "link": "https://stackoverflow.com/questions/45452870/mysql-c-api-mysql-query-function-dosnt-work/45453399#45453399", "title": "mysql c api mysql query function dosn&#39;t work", "body": "<pre><code>if(!mysql_query( mysql_conn , sql )){\n    PTRACE(0,0, \"mysql_query can't run\");\n}\n</code></pre>\n\n<p>This part is the problem. <code>mysql_query</code> returns <code>0</code> when it succeeds and a strictly negative value when it fails. So your condition prints an error message when the function actually succeeds. Indeed <code>if (!functionCall())</code> is actually the same as <code>if (functionCall() == 0)</code>.</p>\n\n<p>You should change it too :</p>\n\n<pre><code>if(mysql_query( mysql_conn , sql ) &lt; 0){\n    PTRACE(0,0, \"mysql_query can't run\");\n}\n</code></pre>\n"}], "owner": {"reputation": 124, "user_id": 4400533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-KlyzSQytH6M/AAAAAAAAAAI/AAAAAAAAABE/mL1m48pIphM/photo.jpg?sz=128", "display_name": "Iman", "link": "https://stackoverflow.com/users/4400533/iman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 45453399, "answer_count": 1, "score": 0, "last_activity_date": 1501658382, "creation_date": 1501654745, "question_id": 45452870, "link": "https://stackoverflow.com/questions/45452870/mysql-c-api-mysql-query-function-dosnt-work", "title": "mysql c api mysql query function dosn&#39;t work", "body": "<p>I spend 3 hours to figure out what is my problem in this code and why mysql_query doesn't work...\nthis is my query:  </p>\n\n<pre><code>`sprintf(quer, \"INSERT INTO `tblRobotProcessQueue`(ProcessId,Protocol,SRC_IP,DST_IP,SRC_Port,DST_Port,`HostName`,`URL`,`Href`,DateAdd) VALUES(%d,%d,%d,%d,%d,%d,%s,%s,%s,%d )\" ,pid*i, 6, 1234, 5345, 80, 44, \"HostName\", \"URL\", \"Href\", currentTime);` \n</code></pre>\n\n<hr>\n\n<p>and here is my customize db_query :  </p>\n\n<pre><code>int _db_query(MYSQL *mysql_conn, char* sql ) {\n    int ret = 0;\n\n    if ( 0 == ( ret = mysql_ping( mysql_conn ) ) ) {\n\n        if(!mysql_query( mysql_conn , sql )){\n            PTRACE(0,0, \"mysql_query can't run\");\n        }\n\n        printf(\"ret is : %d\\n\", ret);\n\n        //syslog ( LOG_INFO , \"db_query( %u , [%s] )\" , connection_id , sql );\n        if ( 0 != ret &amp;&amp; NULL != mysql_error( mysql_conn ) ) {\n\n            syslog ( LOG_INFO , \"Mysql query connection %s\", mysql_error( mysql_conn ) );\n            PTRACE(0,0, \"FAIL HERE IN _DB_QUERY\");\n        }\n\n    } else {\n        PTRACE( 0 , 0 , \"Mysql Ping Error connection %s\" ,mysql_error( mysql_conn ) );\n\n    }\n    PTRACE(0,0, \"reach to end of _db_query...\\n\");\n    return ret;\n}\n</code></pre>\n\n<hr>\n\n<p>when i run my program i can see some data added in my table with phpmysqladnin<br>\nbut this part execute in my terminal: <code>PTRACE(0,0, \"mysql_query can't run\");</code><br>\nhelp me guys!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1501654289, "post_id": 45452661, "comment_id": 77866361, "body": "When you enter 25 values, <code>templength</code> isn&#39;t set. It&#39;s also never initialised and therefore has an undefined garbage value. You don&#39;t need <code>templength</code>: <code>break</code> out of the loop and return <code>lcv</code>."}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1501654420, "post_id": 45452661, "comment_id": 77866416, "body": "But, in my getdata function, i did initialize templength, and I set it to the lcv when the lcv index value is -1. I have to return that value to use in the other UDFs. Im sorry, I do not understand what you are pointing out at."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1501654487, "post_id": 45452661, "comment_id": 77866449, "body": "@skyblade1234 what is <code>templength</code> if the user enters 25 values, <i>none</i> of which are <code>-1</code> ?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1501654548, "post_id": 45452661, "comment_id": 77866482, "body": "No, you don&#39;t initialise it. <code>int templength;</code> declares a local variable with undefined value. You set it when -1 is entered, but in the special case that 25 numbers are given, the variable isn&#39;t set. Try it out and print the return value of <code>getdataset</code>."}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "edited": false, "score": 0, "creation_date": 1501654796, "post_id": 45452661, "comment_id": 77866587, "body": "if(dataset[lcv] == -1 || lcv == 24)     {       templength = lcv."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501654811, "post_id": 45452661, "comment_id": 77866593, "body": "Note when I enter <code>1 2 3 -1</code> the program reports <code>3</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1501654859, "post_id": 45452661, "comment_id": 77866623, "body": "@skyblade1234 The point we made earlier was, what&#39;s wrong with <a href=\"https://pastebin.com/U8JyVQLa\" rel=\"nofollow noreferrer\">just doing something like this</a>?"}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1501654966, "post_id": 45452661, "comment_id": 77866702, "body": "I cant use break statements in if else constructs @WhozCraig"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501654997, "post_id": 45452661, "comment_id": 77866720, "body": "Do you mean the task forbids it?"}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "edited": false, "score": 0, "creation_date": 1501655052, "post_id": 45452661, "comment_id": 77866753, "body": "@M Oehm, How would i change the code such that I take into consideration the 25 values then? Do  i have to change the if statement?"}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501655101, "post_id": 45452661, "comment_id": 77866778, "body": "@Weather Vane, Yes, My course standard prohibits it. Unfortunately, I was not given a page with all the course standards else I would have pasted it here."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501655151, "post_id": 45452661, "comment_id": 77866809, "body": "<code>int templength;</code> --&gt; <code>int templength = LENGTH;</code>"}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "edited": false, "score": 0, "creation_date": 1501655389, "post_id": 45452661, "comment_id": 77866949, "body": "I set my templength to 25, now it works thanks, but I guess my getconstantvalue function is wrong because I am getting errors from that."}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "edited": false, "score": 0, "creation_date": 1501655417, "post_id": 45452661, "comment_id": 77866963, "body": "@ BLUEPIXY, oh didnt see that thanks anyways"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1501655457, "post_id": 45452661, "comment_id": 77866983, "body": "I have to say, that&#39;s nuts, A course where input validation like checking the results of <code>scanf</code> is apparently optional, but comprehendible code is off limits.  For that matter, you could just load up the continuation condition with the entire loop logic <a href=\"https://pastebin.com/6V3SUT6x\" rel=\"nofollow noreferrer\">like <b>this</b></a>. Anyway, glad you have something that works now."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1501655946, "post_id": 45452661, "comment_id": 77867278, "body": "By now, there&#39;s a good answer for your second problem. The problem with your code is that it goes on checking when it has found that two differences don&#39;t match. In that case, you should return 0 immediately. (In yourexample, the mismatch is decetcted, but later &quot;corrected&quot; again by constant differences at the end of the array.)"}], "answers": [{"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501655965, "post_id": 45453137, "comment_id": 77867291, "body": "The case where <code>templength == 1</code> is missing."}, {"owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "edited": false, "score": 0, "creation_date": 1501655972, "post_id": 45453137, "comment_id": 77867295, "body": "Yes that did it, thank you, I am going to try and modify the code so that it is easier to follow. For the first if statement, when you say return 0, does that mean the constantvalue is set  to 0? What does the return 0 mean? Ive never used it inside loops or constructs before"}, {"owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501659001, "post_id": 45453137, "comment_id": 77869129, "body": "@BLUEPIXY : if templength == 1, the loop will not be executed, leading to the correct answer"}, {"owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "reply_to_user": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "edited": false, "score": 0, "creation_date": 1501659115, "post_id": 45453137, "comment_id": 77869203, "body": "@skyblade1234: Returning early from a function is a great way to make code shorter and more concise. In this case, you used 0 to indicate that no constant was found, so when these cases are detected, just end the function indicating that no constant can be found (0)."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501659480, "post_id": 45453137, "comment_id": 77869438, "body": "<code>constantvalue = dataset[1] - dataset[0];</code> : if <code>templength == 1</code>,  <code>dataset[1]</code> should not be used. Of course the result is incorrect."}], "tags": [], "owner": {"reputation": 301, "user_id": 312686, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d181e2c0436e5d37ddae5fa4eff2e4d?s=128&d=identicon&r=PG", "display_name": "Marius", "link": "https://stackoverflow.com/users/312686/marius"}, "is_accepted": false, "score": 2, "last_activity_date": 1501659764, "last_edit_date": 1501659764, "creation_date": 1501655635, "answer_id": 45453137, "question_id": 45452661, "link": "https://stackoverflow.com/questions/45452661/why-am-i-getting-certain-errors-and-wrong-outputs/45453137#45453137", "title": "Why am i getting certain errors and wrong outputs?", "body": "<p>First, the 25 items. The first comment is correct, if you enter the maximum number of items, templength will not be set. Tracing trough the code step by step will show this.</p>\n\n<p>Regarding the bug with the output. I would avoid using too many offsets in the array index. It makes the code harder to understand, and certainly harder to debug. In this case the offsets will also give problems with very short arrays as pointed out in the comments. Why not try something like:</p>\n\n<pre><code>int findconstant(int dataset[], int templength)\n{\n    int lcv;\n    int constantvalue;\n    if (templength &lt;= 1) {\n        return 0;\n    }\n    constantvalue = dataset[1] - dataset[0];\n    for (lcv = 2; lcv &lt; templength ; lcv++) {\n        if ((dataset[lcv] - dataset[lcv-1]) != constantvalue) {\n            return 0;\n        }\n    }\n    return constantvalue;\n} \n</code></pre>\n\n<p>It's shorter, easier to read, understand and debug.</p>\n"}], "owner": {"reputation": 21, "user_id": 8174713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/187de09eca4e5ccc0d3fe6e25e88df88?s=128&d=identicon&r=PG", "display_name": "skyblade1234", "link": "https://stackoverflow.com/users/8174713/skyblade1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501726970, "creation_date": 1501653970, "last_edit_date": 1501726970, "question_id": 45452661, "link": "https://stackoverflow.com/questions/45452661/why-am-i-getting-certain-errors-and-wrong-outputs", "title": "Why am i getting certain errors and wrong outputs?", "body": "<p>I have this task to get the constant value between the inputs of an array.\nHow would i go about it? Ive used a selection sorting algorithm and searched for the value but I know thats the wrong method.</p>\n"}, {"tags": ["c", "arrays", "2d", "memcpy"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501653216, "post_id": 45452423, "comment_id": 77865867, "body": "Need copy each rows."}, {"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1501653237, "post_id": 45452423, "comment_id": 77865880, "body": "<code>float**</code> is not contiguous in memory. You can&#39;t use memcpy only once. Try to understand what <code>**</code> means. You can do this with memcpy <code>x</code> times"}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 1, "last_activity_date": 1501653667, "creation_date": 1501653667, "answer_id": 45452595, "question_id": 45452423, "link": "https://stackoverflow.com/questions/45452423/copy-two-dimensional-dynamic-arraypointers-to-a-static-array-using-memcpy/45452595#45452595", "title": "Copy two dimensional dynamic array(pointers) to a static array using memcpy", "body": "<p>Well, 2D array element's are stored in memory in a row,\n|x| == memory cell</p>\n\n<blockquote>\n  <p>1.row |x|x|x|x|x|x| 2.row |x|x|x|x|x|x| 3.row |x|x|x|x|x|x|</p>\n</blockquote>\n\n<p>while every pointer of array of pointer can point on completely different address in memory. For example first pointer points on array on adress 100, second points on adress 248, third on array on adress 2.</p>\n\n<blockquote>\n  <p>3.row |x|x|x|x|x|x| |?|?|?| 1.row |x|x|x|x|x|x| |?|?|?|?| 2.row |x|x|x|x|x|x|</p>\n</blockquote>\n\n<p>So you could use memcpy on every row of arrays separately, or copy them element by element.</p>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 0, "last_activity_date": 1501656727, "creation_date": 1501656727, "answer_id": 45453488, "question_id": 45452423, "link": "https://stackoverflow.com/questions/45452423/copy-two-dimensional-dynamic-arraypointers-to-a-static-array-using-memcpy/45453488#45453488", "title": "Copy two dimensional dynamic array(pointers) to a static array using memcpy", "body": "<p>There are 2 problems with your <code>memcpy</code>:</p>\n\n<h2>1. <code>src</code> rows are not necessarily continuous</h2>\n\n<p>Consider:</p>\n\n<pre><code>#define x 2\nfloat src_row_0[x] = { 0.0f, 0.1f };\nfloat src_row_1[x] = { 1.0f, 1.1f };\nfloat * src_rows[x] = { src_row_0, src_row_1 };\nfloat ** src = src_rows;\n</code></pre>\n\n<p>There is no guarantee that rows are next to each other in memory. So you cannot copy bytes with single <code>memcpy</code>. Same applies even if you allocated <code>src</code>rows with <code>malloc</code>.</p>\n\n<p>You'll need to copy each row separately.</p>\n\n<h2>2. Size <code>x</code> is not enough to copy all bytes</h2>\n\n<p><code>memcpy</code> copies number of bytes, not number of elements. Single <code>float</code> variable is usually more than 1 byte in size. Simply passing <code>x</code> to <code>memcpy</code> is not enough. You'll need to multiply each number of items by size of an single element.</p>\n\n<h2>Fixing the copy</h2>\n\n<p>Corrected copy would look something like this:</p>\n\n<pre><code>for(int i=0; i&lt;x; ++i) {\n    memcpy(&amp;dst[i], src[i], x * sizeof(float));\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/YuWsrD\" rel=\"nofollow noreferrer\">Example on Ideone.</a></p>\n"}], "owner": {"reputation": 3, "user_id": 4236613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d95e1d83c454692b43d4fc7c3574484b?s=128&d=identicon&r=PG&f=1", "display_name": "Niluka", "link": "https://stackoverflow.com/users/4236613/niluka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 45453488, "answer_count": 2, "score": 0, "last_activity_date": 1501656817, "creation_date": 1501652880, "last_edit_date": 1501656817, "question_id": 45452423, "link": "https://stackoverflow.com/questions/45452423/copy-two-dimensional-dynamic-arraypointers-to-a-static-array-using-memcpy", "title": "Copy two dimensional dynamic array(pointers) to a static array using memcpy", "body": "<p>I've 2D arrays as below,</p>\n\n<pre><code>float** src;\n</code></pre>\n\n<p>which is filled with some values.</p>\n\n<pre><code>float des[x][x];\n</code></pre>\n\n<p><code>x</code> is equal to the number of rows in <code>src</code> array.</p>\n\n<p>So basically i want to generate a static 2D array from a dynamic 2D array.\nI tried to use <code>memcpy(&amp;des, src, x)</code>, But it gives wrong result.</p>\n\n<p>Any suggestions??</p>\n"}, {"tags": ["c", "arrays", "string", "pointers"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 5, "creation_date": 1501651590, "post_id": 45452105, "comment_id": 77865173, "body": "If you&#39;re going to test for a null string pointer in your array of string pointers,  perhaps you should actually <i>put one at the end of the list</i>. I.e. <code>&quot;how are you&quot;, NULL</code>. Right now your code hits the last string (which is obviously non-null), then just continues marching into the ether in search of exactly what you asked it to: a NULL."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1501652525, "post_id": 45452105, "comment_id": 77865542, "body": "Or pass the number of strings as a parameter to <code>find_char</code>, e.g. <code>int find_char( char **strings, size_t n, char value);</code> and iterate with a <code>for (size_t i = 0; i &lt; n; i++)</code> loop or <code>while (n--)</code> to only iterate over the proper number of pointers."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1501652758, "post_id": 45452259, "comment_id": 77865640, "body": "Or simply <code>while (size-- &amp;&amp; (s = *strs++))</code>, or eliminate <code>s</code> and just use indexing, e.g. <code>for (int i = 0; i &lt; size &amp;&amp; strs[i]; i++)</code>. All are fine as is your answer."}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1501652965, "post_id": 45452259, "comment_id": 77865735, "body": "Yes there are many ways of doing it. C is very permissive on that regard. Thanks for completing my answer."}], "tags": [], "owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "is_accepted": true, "score": 2, "last_activity_date": 1501652165, "creation_date": 1501652165, "answer_id": 45452259, "question_id": 45452105, "link": "https://stackoverflow.com/questions/45452105/segmentation-fault-error-with-pointer-array-in-c/45452259#45452259", "title": "Segmentation fault error with pointer array in C", "body": "<p>Well your problem come from your outer while loop. It loops over the strings in the array until it finds a <code>NULL</code> string. However, you didn't terminate the array with such string, so the loop will go on after the 3rd string and end up trying to access memory it isn't supposed to.</p>\n\n<p><strong>A solution to your problem:</strong>\nYou can modify your function's signature by giving it a <code>size</code> parameter so that it becomes</p>\n\n<pre><code>int find_char(const **char strs, int size, char ch);\n</code></pre>\n\n<p>Then you need to include this size value in the looping process to find your stop condition.</p>\n\n<pre><code>char *s = NULL;\nint i = 0;\nwhile (i++ &lt; size &amp;&amp; (s = *strs++)) {\n    // ...\n}\n</code></pre>\n\n<p>The point to remember here is that, in C programming it is required to play with memory and arrays carefully. When dealing with arrays, one usually want to pass the array's size as a parameter to each processing functions.</p>\n\n<p>I hope that helped.</p>\n"}], "owner": {"reputation": 548, "user_id": 605280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3860cd300cea751e16688eca3721907c?s=128&d=identicon&r=PG", "display_name": "xczzhh", "link": "https://stackoverflow.com/users/605280/xczzhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 45452259, "answer_count": 1, "score": 1, "last_activity_date": 1501652165, "creation_date": 1501651421, "last_edit_date": 1501651639, "question_id": 45452105, "link": "https://stackoverflow.com/questions/45452105/segmentation-fault-error-with-pointer-array-in-c", "title": "Segmentation fault error with pointer array in C", "body": "<p>I am trying to test some code from \"Pointers On C\", the find_char function, which searches for a specified character. I added something of my own, that is, the main() function that calls the find_char and includes the initialized data to be searched(an array of pointers to char). I managed to fix all errors and warnings at compile time, but while trying to run the a.out file, I got the segmentation fault error.</p>\n\n<p>I know segmentation fault is mostly concerned with array and pointers which so often happens when types are incorrectly translated. But I really can't find what is wrong with my code.</p>\n\n<p>Thank you so much.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define TRUE  1\n#define FALSE 0\n\nint find_char( char **strings, char value);\n\nint main(void)\n{\n    int i;\n    char c = 'z';\n    char *pps[] = { \n            \"hello there\",\n            \"good morning\",\n            \"how are you\"\n    };  \n    i = find_char(pps, c); \n    printf(\"%d\\n\", i); \n    return 0;\n}\n\nint find_char (char **strings, char value)\n{\n    char *string;\n    while (( string = *strings++) != NULL)\n    {   \n            while (*string != '\\0')\n            {   \n                    if( *string++ == value )\n                            return TRUE;\n            }   \n    }   \n    return FALSE;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501648829, "post_id": 45451554, "comment_id": 77864162, "body": "<i>//append the diffTimestamp to ISI array</i>, where is the <code>ISI</code> array? It is just a pointer with value <code>NULL</code>."}, {"owner": {"reputation": 197, "user_id": 7660819, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/670379c837002e5ac06e4ca95cbbb1ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathracer", "link": "https://stackoverflow.com/users/7660819/deathracer"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501649084, "post_id": 45451554, "comment_id": 77864262, "body": "I have updated it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501649134, "post_id": 45451554, "comment_id": 77864278, "body": "You could use <code>fabs()</code> to simplify the condition: <code>if (fabs(diffTimeStamp) &lt;= 1.0)</code>.  You simply need to keep an index for the next slot in the <code>ISI</code> array, or equivalently the number of entries in the array at the moment: <code>int count = 0;</code>.  You add an entry with <code>ISI[count++] = diffTimeStamp;</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1501649518, "post_id": 45451554, "comment_id": 77864400, "body": "@deathracer <code>float ISI[25]</code> declares an <i>array of float [25 elements]</i>. This is created with a <i>Fixed</i> size and cannot be <code>realloc</code>ated. If you want to dynamically add to an array, you are actually just sizing the block of memory pointed to by a pointer variable. You can initially size a block of memory to hold <code>25-float</code> with something like <code>size_t size = 25; float *array = malloc (size * sizeof *array);</code> (don&#39;t forget to validate the allocation). Keep track of the number of floats added, and when 25 is reached <code>void *tmp = realloc (array, size * 2 * sizeof *array); if (tmp) array = tmp;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 7660819, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/670379c837002e5ac06e4ca95cbbb1ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathracer", "link": "https://stackoverflow.com/users/7660819/deathracer"}, "edited": false, "score": 0, "creation_date": 1501649264, "post_id": 45451616, "comment_id": 77864321, "body": "<code>ISI</code> in worst case can be double the size of <code>timestamps</code> array ie. 25"}, {"owner": {"reputation": 770, "user_id": 7342781, "user_type": "registered", "profile_image": "https://graph.facebook.com/1291429514228526/picture?type=large", "display_name": "Simon Hobbs", "link": "https://stackoverflow.com/users/7342781/simon-hobbs"}, "reply_to_user": {"reputation": 197, "user_id": 7660819, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/670379c837002e5ac06e4ca95cbbb1ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathracer", "link": "https://stackoverflow.com/users/7660819/deathracer"}, "edited": false, "score": 0, "creation_date": 1501649773, "post_id": 45451616, "comment_id": 77864483, "body": "Just declare the maximum size of ISI and keep a counter of the position that you last wrote to."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1501650691, "post_id": 45451616, "comment_id": 77864823, "body": "array <b>is</b> a data type. The problem is you can&#39;t go over it&#39;s bounds"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 197, "user_id": 7660819, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/670379c837002e5ac06e4ca95cbbb1ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathracer", "link": "https://stackoverflow.com/users/7660819/deathracer"}, "edited": false, "score": 0, "creation_date": 1501650938, "post_id": 45451616, "comment_id": 77864927, "body": "@deathracer <i>&quot;double the size of <code>timestamps</code> array&quot;</i> would be <code>2 * 5-floats = 10-floats</code> (not 25) -- or am I missing the <i>new math</i>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1501651019, "post_id": 45451616, "comment_id": 77864951, "body": "A linked list has its special usecases, but I wouldn&#39;t recomment it in general. If you need fast indexed access and inserts/appends are relatively rare (which is often the case), implement your &quot;<i>dynamic array</i>&quot; using <code>malloc()</code>  and <code>realloc()</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501664499, "post_id": 45451616, "comment_id": 77872846, "body": "@FelixPalmen or do a dry run and a single <code>malloc</code> (if dry run is possible). I usually prefer that over sequence of <code>reallocs</code>. Exponential growth of size is too much for me :)"}], "tags": [], "owner": {"reputation": 770, "user_id": 7342781, "user_type": "registered", "profile_image": "https://graph.facebook.com/1291429514228526/picture?type=large", "display_name": "Simon Hobbs", "link": "https://stackoverflow.com/users/7342781/simon-hobbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1501648928, "creation_date": 1501648928, "answer_id": 45451616, "question_id": 45451554, "link": "https://stackoverflow.com/questions/45451554/append-a-float-at-the-end-of-array-in-c/45451616#45451616", "title": "append a float at the end of array in C", "body": "<p>So when you initialize the array:</p>\n\n<pre><code>float timestamps[] = {0,3,2,1,5};\n</code></pre>\n\n<p>what you're doing is actually allocating a memory block that is exactly that size. Unlike a scripting language an array in this case is not a data type, instead it is a block of memory that has 5 floats saved contiguously.</p>\n\n<p>What should be done is you should use a <a href=\"http://www.cprogramming.com/tutorial/c/lesson15.html\" rel=\"nofollow noreferrer\">linked list</a> which would allow you to implement what you're trying here.</p>\n\n<p>Edit: you could also use malloc if you know how large the amount of memory you will need is.</p>\n"}], "owner": {"reputation": 197, "user_id": 7660819, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/670379c837002e5ac06e4ca95cbbb1ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathracer", "link": "https://stackoverflow.com/users/7660819/deathracer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 45451616, "answer_count": 1, "score": 0, "last_activity_date": 1501649996, "creation_date": 1501648506, "last_edit_date": 1501649996, "question_id": 45451554, "link": "https://stackoverflow.com/questions/45451554/append-a-float-at-the-end-of-array-in-c", "title": "append a float at the end of array in C", "body": "<p>I am trying to append a float at the end of the array in C. Here is the code used by me:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    float timestamps[] = {0,3,2,1,5};\n    float ISI[25];\n    int i,j;\n    for (i = 0; i&lt;5; i++ )\n    {\n      for (j=0;j&lt;5;j++)\n        {\n          float diffTimestamp = timestamps[j] - timestamps[i];\n          //remove points greater than 1 sec and less than -1sec\n          if((diffTimestamp&lt;=1.0)&amp;&amp;(diffTimestamp&gt;=-1.0)){\n              //append the diffTimestamp to ISI array \n          }\n          else\n            continue;\n        }\n   }\n    return 0;\n}\n</code></pre>\n\n<p>I tried googling it and came across a couple of similar questions:\n<a href=\"https://stackoverflow.com/questions/8654041/appending-a-value-to-the-end-of-a-dynamic-array?rq=1\">Appending a value to the end of a dynamic array</a>. Another thing which was common was using a structure to put a variable for size along with the array.</p>\n\n<p>But because of my limited knowledge of C, I am unable to implement the code.</p>\n"}, {"tags": ["c", "arrays", "json", "embedded", "codewarrior"], "comments": [{"owner": {"reputation": 2365, "user_id": 611117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d70f88638c52101b1f0c5d9a87a803e?s=128&d=identicon&r=PG", "display_name": "vasek", "link": "https://stackoverflow.com/users/611117/vasek"}, "edited": false, "score": 0, "creation_date": 1501651433, "post_id": 45451537, "comment_id": 77865099, "body": "What parsers have you tried so far? Have you seen <a href=\"http://zserge.com/jsmn.html\" rel=\"nofollow noreferrer\">JSMN</a>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1501652948, "post_id": 45451537, "comment_id": 77865722, "body": "Please show us your previous effort. Either with parser or with straight forward own implementation."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1501656033, "post_id": 45451537, "comment_id": 77867338, "body": "If you are asking for a recommendation, then this is OT, or if you are expecting a solution then it is too broad; either way it is unclear what you expect, so three reasons to close already!  Details of RTOS and toolchain are largely irellevant; details of precise requirements and constraints are missing. It is also not known what you have tried already, or why it was unsatisfactory."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1501657623, "post_id": 45451537, "comment_id": 77868284, "body": "Do you want a parser that can handle just that fragment, or one that parses JSON in general?  If the former, then the fact that it is JSON is perhaps also irrelevant, since you could make it specific rather then generic.  The fragment seems incomplete to me ; is that all that needs parsing?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6339656, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209386361637133/picture?type=large", "display_name": "MhdBanat", "link": "https://stackoverflow.com/users/6339656/mhdbanat"}, "edited": false, "score": 0, "creation_date": 1501741647, "post_id": 45456204, "comment_id": 77913182, "body": "this is useful @sdao.   Can you help if it is dynamic, actually I have seen many json parser and the comparisons but I didn&#39;t get the point yet.    -    Codewarrior doesn&#39;t recognize fopen keyword.   FILE *file = fopen(&quot;test.txt&quot;, &quot;r&quot;);"}], "tags": [], "owner": {"reputation": 398, "user_id": 5871187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hu64h.jpg?s=128&g=1", "display_name": "S Dao", "link": "https://stackoverflow.com/users/5871187/s-dao"}, "is_accepted": true, "score": 0, "last_activity_date": 1501817175, "last_edit_date": 1501817175, "creation_date": 1501664470, "answer_id": 45456204, "question_id": 45451537, "link": "https://stackoverflow.com/questions/45451537/strightforward-parsing-json-using-%c2%b5c-os-ii/45456204#45456204", "title": "Strightforward parsing json using \u200f&#181;C/OS-II", "body": "<p>For advance application, recommend to use <a href=\"https://github.com/cesanta/frozen\" rel=\"nofollow noreferrer\">Frozen</a>. If your application has fix data format as shown above, see below for your ref.</p>\n\n<p>Quite basic version look like below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX_PRAM    4\n\nstruct param_t {\n    int id;\n\n    // FIXME: use pointer &amp; malloc to allocate if possible\n    char data[MAX_PRAM][30];\n};\n\nstatic int parse(const char *buff, int start, const int end,\n    struct param_t *out)\n{\n    char *ptr = out-&gt;data[0];\n    int state = 0;\n    int index = 0;\n    int param_index = 0;\n\n    printf(\"\\t&gt; parse next record&lt;%d:%d&gt;\\n\", start, end);\n    while((start &lt; end) &amp;&amp; (param_index &lt; MAX_PRAM)) {\n        char ch = buff[start];\n\n        // printf(\"\\t&gt; state: %d, char '%c'\\n\", state, ch);\n        switch (state) {\n            case 0: // searching for start point\n                if ((ch &gt;= '0') &amp;&amp; (ch &lt;= '9')) {\n                    out-&gt;id = ch - '0';\n                    state++;\n                }\n\n                break;\n\n            case 1: // parse number\n                if ((ch &lt; '0') || (ch &gt; '9')) {\n                    printf (\"\\t&gt; number %d\\n\", out-&gt;id);\n\n                    state++;\n                    if (ch == '\"')\n                        state++;\n                } else\n                    out-&gt;id = (out-&gt;id * 10) + (ch - '0');\n                break;\n\n            case 2: // search string\n                if (ch == '\"') {\n                    index = 0;\n                    state++;\n                }\n\n                break;\n\n            case 3: // get string\n                if (ch == '\"') { // finish one string, parse next one if need\n                    ptr[index] = '\\0';\n\n                     printf (\"\\t&gt; string '%s', length %d\\n\",\n                        out-&gt;data[param_index], index);\n\n                    param_index++;\n                    ptr = out-&gt;data[param_index];\n                    state--;\n                } else\n                    ptr[index++] = ch;\n\n                break;\n\n            default: // EOS - exit\n                break;\n        }\n\n        start++;\n    }\n\n    return (param_index &gt;= 4) ? start : 0;\n}\n\n//\n// main entry\n//\nint main(int argc, char *argv[]) {\n    int file = open(\"test.txt\", 0 /* 0 ~ O_RDONLY in fcntl.h */ );\n\n    if (file) {\n        char buff[1024] = { 0 };\n        struct param_t param = { 0 };\n        int len = read(file, buff, 1024);\n        int pos = 0;\n\n        while((pos = parse(buff, pos, len, &amp;param)) &gt; 0) {\n            printf (\"\\t%d\\n\", param.id);\n\n            printf(\"[%4d] %d - %-10s | %-10s | %-15s | %-10s \\n\",\n                pos, param.id, param.data[0], param.data[1], param.data[2],\n                param.data[3]);\n        }\n\n        close(file);\n    }\n}\n</code></pre>\n\n<p>With input: </p>\n\n<pre><code>[[10,\"Door0\",\n\n\"Door0Drv\",\"Calculator0\",\"Alarm0\"],\n\n[15,\"Door1\",\"Door1Drv\",\"Calculator1\",\"Alarm1\"],\n\n[230,\"Door2\",\"Door2Drv\",\"Calculator2\",\n    \"Alarm2\"]]\n</code></pre>\n\n<p>Output looks like:</p>\n\n<pre><code>        &gt; number 10\n        &gt; string 'Door0', length 5\n        &gt; string 'Door0Drv', length 8\n        &gt; string 'Calculator0', length 11\n        &gt; string 'Alarm0', length 6\n        10\n[  49] 10 - Door0      | Door0Drv   | Calculator0     | Alarm0\n        &gt; number 15\n        &gt; string 'Door1', length 5\n        &gt; string 'Door1Drv', length 8\n        &gt; string 'Calculator1', length 11\n        &gt; string 'Alarm1', length 6\n        15\n[ 100] 15 - Door1      | Door1Drv   | Calculator1     | Alarm1\n        &gt; number 230\n        &gt; string 'Door2', length 5\n        &gt; string 'Door2Drv', length 8\n        &gt; string 'Calculator2', length 11\n        &gt; string 'Alarm2', length 6\n        230\n[ 158] 230 - Door2      | Door2Drv   | Calculator2     | Alarm2\n</code></pre>\n\n<p>Feel free to customize.</p>\n"}], "owner": {"reputation": 13, "user_id": 6339656, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209386361637133/picture?type=large", "display_name": "MhdBanat", "link": "https://stackoverflow.com/users/6339656/mhdbanat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 45456204, "answer_count": 1, "score": -2, "last_activity_date": 1501817175, "creation_date": 1501648417, "last_edit_date": 1501657841, "question_id": 45451537, "link": "https://stackoverflow.com/questions/45451537/strightforward-parsing-json-using-%c2%b5c-os-ii", "title": "Strightforward parsing json using \u200f&#181;C/OS-II", "body": "<p>Can anyone help in writing a C parser (using Codewarrior) to parse the following file? I tried many C language json parser, but unfortunately didn't get the idea or they make it difficult. </p>\n\n<pre><code>[\n[0,\"Door1\",\"Door1Drv\",\"Calculator\",\"Alarm\"],\n[1,\"Door3\",\"Door3Drv\",\"Calculator\",\"Alarm\"],\n[2,\"Door2\",\"Door2Drv\",\"Calculator\",\"Alarm\"]]\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 4, "creation_date": 1501640685, "post_id": 45450472, "comment_id": 77862023, "body": "Yes, you can do that. The issue is with returning pointers to things that don\u2019t exist anymore, but what you <code>malloc</code> continues to exist until you <code>free</code> it. Another option is to take an output pointer as an argument so the memory management is left to the caller."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1501640775, "post_id": 45450472, "comment_id": 77862041, "body": "<code>sizeof (char)</code> is 1 by definition."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1501640810, "post_id": 45450472, "comment_id": 77862049, "body": "<code>toupper(s[i])</code> has undefined behavior if <code>s[i]</code> is negative. You should cast it to <code>unsigned char</code>."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1501640814, "post_id": 45450472, "comment_id": 77862051, "body": "1. Did the compiler complain? 2. Did gdb complain? If 1 and 2 were both NO, you&#39;re good to go."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 6, "creation_date": 1501640890, "post_id": 45450472, "comment_id": 77862062, "body": "@c\u1d0f\u029f\u1d05s\u1d18\u1d07\u1d07\u1d05 That seems like very bad advice."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1501640922, "post_id": 45450472, "comment_id": 77862069, "body": "It&#39;s a start..."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1501641221, "post_id": 45450472, "comment_id": 77862141, "body": "@COLDSPEED. I&#39;m confused. Are you saying &quot;If a C program compiles then it can&#39;t have bugs or leaks?&quot; Are you saying &quot;You should always run your C program under a debugger&quot;?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501641569, "post_id": 45450472, "comment_id": 77862223, "body": "YunjinJang Curious: why <code>(char*)</code> cast in <code>ret = (char*)malloc(sizeof(char) * length);</code>? Why multiple by <code>sizeof(char)</code> which is 1?  Who or what text suggested that?"}, {"owner": {"reputation": 135, "user_id": 8223361, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d19a36ca8c74645da6893a6e38cf9af3?s=128&d=identicon&r=PG&f=1", "display_name": "YunjinJang", "link": "https://stackoverflow.com/users/8223361/yunjinjang"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501642345, "post_id": 45450472, "comment_id": 77862411, "body": "@chux The reason for casting is that I know that the &quot;malloc&quot; function requires casting because the return type is &quot;void *&quot;. And I use &quot;sizeof ()&quot; because I have seen a lot of things that are mainly used for other types, not char types. I was mistaken as to how to use char type like this too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501642941, "post_id": 45450472, "comment_id": 77862549, "body": "@YunjinJang In C, the cast is <i>not</i> required.  Consider <code>ret = malloc(sizeof *ret * length);</code> for its ease to code right, review and maintain."}, {"owner": {"reputation": 135, "user_id": 8223361, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d19a36ca8c74645da6893a6e38cf9af3?s=128&d=identicon&r=PG&f=1", "display_name": "YunjinJang", "link": "https://stackoverflow.com/users/8223361/yunjinjang"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501647220, "post_id": 45450472, "comment_id": 77863634, "body": "@chux Thanks for your advice."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1501649250, "post_id": 45450472, "comment_id": 77864318, "body": "@melpomene why should s[i] be negative if the input is an ascii string? wouldn&#39;t casting to unsigned char be obsolete?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1501667155, "post_id": 45450472, "comment_id": 77874783, "body": "@CIsForCookies <i>if the input is an ascii string</i> - yes, &quot;if&quot;. Why make such an assumption in a general <code>upperCase</code> function? ASCII only covers half of the possible <code>char</code> values on my system."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 8223361, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d19a36ca8c74645da6893a6e38cf9af3?s=128&d=identicon&r=PG&f=1", "display_name": "YunjinJang", "link": "https://stackoverflow.com/users/8223361/yunjinjang"}, "edited": false, "score": 0, "creation_date": 1501641241, "post_id": 45450504, "comment_id": 77862149, "body": "Thank you very much. I can understand some of the things I was not sure about. It has helped a lot."}], "tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": false, "score": 3, "last_activity_date": 1501641259, "last_edit_date": 1501641259, "creation_date": 1501640948, "answer_id": 45450504, "question_id": 45450472, "link": "https://stackoverflow.com/questions/45450472/can-i-use-malloc-for-local-variables-to-return-local-variables/45450504#45450504", "title": "Can I use &quot;malloc&quot; for local variables to return local variables?", "body": "<p>Yes, you can.</p>\n\n<p>The <code>malloc</code> memory is on the heap, so it won't release when <code>upperCase</code> end.</p>\n\n<p>But variable <code>char *ret</code> is on the stack, it will be popped out when <code>upperCase</code> end. But the value of <code>ret</code> in <code>upperCase()</code> is copied via <code>ret = upperCase(input)</code> in <code>main()</code>. That is to say, you still obtain the address of the allocated memory, which is still on the heap. You can call <code>free(ret)</code> when finished the use of this memory.</p>\n\n<hr>\n\n<p>Check <a href=\"https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap\">What and where are the stack and heap?</a> for details about stack &amp; heap.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1501651234, "post_id": 45451797, "comment_id": 77865025, "body": "There is NO need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a> and <b><i>always</i></b> validate the return of <code>malloc</code> (e.g. in <code>main()</code>  (before <code>printf</code> and <code>free</code>) you need, at minimum, <code>if (ret) {&#47;* do stuff *&#47;}</code> or <code>if (!ret) { &#47;* handle error, or exit *&#47; }</code>. Otherwise good answer and effort."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1501651485, "post_id": 45451797, "comment_id": 77865120, "body": "@DavidC.Rankin saying casting malloc is unnecessary is exactly what I meant. I&#39;ll edit to make it clearer. About the <code>if(!ret)</code>, I mentioned that <code>malloc</code> can return NULL, but I didn&#39;t want to change the OP&#39;s code"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1501651592, "post_id": 45451797, "comment_id": 77865175, "body": "Yes, it looked like a copy/paste issue from the original question, but it is always worth cleaning up so learning by the OP or many who may follow will occur <code>;)</code>"}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 5, "last_activity_date": 1501651741, "last_edit_date": 1501651741, "creation_date": 1501649943, "answer_id": 45451797, "question_id": 45450472, "link": "https://stackoverflow.com/questions/45450472/can-i-use-malloc-for-local-variables-to-return-local-variables/45451797#45451797", "title": "Can I use &quot;malloc&quot; for local variables to return local variables?", "body": "<p><strong>Short answer</strong>: Yes, it is possible</p>\n\n<p><strong>Long answer</strong>: <code>malloc(some_size)</code> allocates <code>some_size</code> space and returns a pointer to the address of the start of the allocated chunk (or <code>NULL</code> upon failure). When doing <code>ret = (char*)malloc(sizeof(char) * length);</code> ret is assigned with said pointer that points to memory chunk of <code>length</code> <code>char</code>s (note that <code>sizeof(char) == 1</code> so you can remove it).</p>\n\n<p>The memory is yours until you free it, even after the function had returned, so, after the end of <code>upperCase(...)</code> execution, that memory still belongs to you. The only problem is, the pointer <code>ret</code> was allocated on the stack with <code>(auto)</code> local storage, meaning it will <em>\"die\"</em> when it's scope (in your case - the <code>upperCase(...)</code> function's scope), and thus, you will not know where that memory is, <strong>BUT</strong> since you return <code>ret</code> from the function, the value it holds (which is the address to your allocated memory) will pass on to <code>main</code>'s <code>ret</code>, which basically means you're good to go.</p>\n\n<p>One last thing I think I should emphasize is, returning local variables is done all the time. For example <code>int increment_by_one(int x){int y = x + 1; return y;}</code>. This is a very simple function that returns the value of local <code>int y</code>. Since the value returned is all we need (i.e. the value of <code>x+1</code>) it's ok that it (the value) was stored in a local variable. The same (sort of) goes for your case - since <code>ret</code> inside <code>upperCase</code> holds the address that was allocated ,it's ok for it to <em>\"die\"</em> after <code>upperCase</code> ends, since the value it holds (the address) is passed on.</p>\n\n<pre><code>char * upperCase(const char* s)\n{\n    char * ret = NULL;                             // local variable -&gt; will die after upperCase ends\n    size_t length = strlen(s) + 1;                 // local variable -&gt; will die after upperCase ends\n    ret = (char*)malloc(sizeof(char) * length);    // ret assigned with address to memory\n    for (size_t i = 0; i &lt; length; i++) {          // local variable -&gt; will die after it's scope (the for loop) ends\n        ret[i] = toupper(s[i]);\n    }\n    return ret;                                     // said address is returned to main (local variable ret now dies peacefully after fulfilling its duty) \n}\n\nint main()\n{\n    char* ret = NULL;               // local variable -&gt; will die after main ends\n    char* input = \"HelloWorld\";     // local variable -&gt; will die after main ends\n    ret = upperCase(input);         // ret gets the address allocated in upperCase\n    printf(\"value = %s\", ret);\n    free(ret);                      // address is freed\n}\n</code></pre>\n\n<p>2 notes:</p>\n\n<ol>\n<li>There is no need casting malloc return value, meaning <code>ret = (char*)malloc(sizeof(char) * length);</code> should be <code>ret = malloc(sizeof(char) * length);</code> </li>\n<li>no need for <code>sizeof(char)</code> since it's <code>1</code>, meaning you can shorten it further to <code>ret = malloc(length);</code></li>\n<li><code>malloc</code> can fail. In that case it will return <code>NULL</code> so after every <code>ret = malloc(...);</code> you should check the value like <code>if(!ret){// handle error}</code> or <code>if(ret != NULL){// do something}</code> and such</li>\n</ol>\n"}], "owner": {"reputation": 135, "user_id": 8223361, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d19a36ca8c74645da6893a6e38cf9af3?s=128&d=identicon&r=PG&f=1", "display_name": "YunjinJang", "link": "https://stackoverflow.com/users/8223361/yunjinjang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1786, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1501651741, "creation_date": 1501640629, "last_edit_date": 1592644375, "question_id": 45450472, "link": "https://stackoverflow.com/questions/45450472/can-i-use-malloc-for-local-variables-to-return-local-variables", "title": "Can I use &quot;malloc&quot; for local variables to return local variables?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nchar * upperCase(const char* s)\n{\n    char * ret = NULL;\n    size_t length = strlen(s) + 1;\n    ret = (char*)malloc(sizeof(char) * length);\n    for (size_t i = 0; i &lt; length; i++) {\n        ret[i] = toupper(s[i]);\n    }\n    return ret;\n}\n\nint main()\n{\n    char* ret = NULL;\n    char* input = &quot;HelloWorld&quot;;\n    ret = upperCase(input);\n    printf(&quot;value = %s&quot;, ret);\n    free(ret);\n}\n</code></pre>\n<blockquote>\n<p>The above code takes a string as a parameter and copies the string. It\nthen converts each element of the copied string to uppercase and\nreturns it.</p>\n<p>Compiler = GCC 6.2</p>\n</blockquote>\n<p>If you use the malloc function, is it possible to return a local variable to terminate the function and release the memory? I do not have enough understanding of the scope that still has memory.</p>\n"}, {"tags": ["c++", "c", "package"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1501639306, "post_id": 45450291, "comment_id": 77861666, "body": "Open string.h in a text editor. Man &lt;function&gt; or Google will find documentation."}, {"owner": {"reputation": 297, "user_id": 7033055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DgO5C.png?s=128&g=1", "display_name": "yode", "link": "https://stackoverflow.com/users/7033055/yode"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1501639533, "post_id": 45450291, "comment_id": 77861734, "body": "@KenWhite You mean in the Linux,we can use <code>man</code>,but if we are in windows,how to?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1501639609, "post_id": 45450291, "comment_id": 77861748, "body": "Google or the documentation for the particular compiler you&#39;re using. This site does not help you find them. See the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1501640701, "post_id": 45450291, "comment_id": 77862029, "body": "@KenWhite &quot;Open string.h in a text editor.&quot;  That&#39;s great, if you can find the file, but it can be pretty difficult.  These days, more and more compiler installations seem to hide them in pretty obscure locations.  Also, it&#39;s more and more common for header files to include other header files which include other header files, making it a nearly impossible wild-goose chase to find the actual declarations of the functions you&#39;re interested in."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501640922, "post_id": 45450291, "comment_id": 77862068, "body": "@SteveSummit: I can find any file anywhere on my computer, including files that are marked as hidden or system. The question asked (<i>I have an include statement; how to know what functions are included by it?</i>) is too broad in scope. Clearly the written documentation would be the preferred location, but the poster doesn&#39;t seem to want to put forth the effort to locate it. SO isn&#39;t a documentation location service. I mentioned <code>man</code>, the compiler/library documentation, and Google."}, {"owner": {"reputation": 327, "user_id": 3439241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379db3ae2e8602becbff5d33238391ec?s=128&d=identicon&r=PG&f=1", "display_name": "Brad S.", "link": "https://stackoverflow.com/users/3439241/brad-s"}, "edited": false, "score": 0, "creation_date": 1501641253, "post_id": 45450291, "comment_id": 77862152, "body": "on windows use the MSDN"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1501641291, "post_id": 45450291, "comment_id": 77862158, "body": "@KenWhite Don&#39;t get me wrong, opening the file is a technique I -- used to -- love to use myself.  But it has been so frustrating and unproductive of late that I tend not to try it any more,  But thanks for reminding me, because I meant to mention <code>cpp -E</code>."}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 7033055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DgO5C.png?s=128&g=1", "display_name": "yode", "link": "https://stackoverflow.com/users/7033055/yode"}, "edited": false, "score": 0, "creation_date": 1501641456, "post_id": 45450418, "comment_id": 77862198, "body": "I realize the <i>Windows subsystem for Linux</i> can help me.Though I don&#39;t sure the <i>WSL</i> include all package function.."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 1, "last_activity_date": 1501689438, "last_edit_date": 1501689438, "creation_date": 1501640167, "answer_id": 45450418, "question_id": 45450291, "link": "https://stackoverflow.com/questions/45450291/how-to-know-which-functions-the-package-includes/45450418#45450418", "title": "How to know which functions the package includes?", "body": "<p>For the second question:</p>\n\n<p>If you're on a Unix or Linux machine, type <strong><code>man strcpy</code></strong> to get information on the <code>strcpy</code> function.</p>\n\n<p>If you're not on a Unix or Linux machine, there are websites.  One I like is die.net: <a href=\"https://linux.die.net/man/3/\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/</a> .</p>\n\n<p>For the first question, I do not know of a particularly good way to get a definitive list of the functions declared by a particular header file.  There are some decent lists at cppreference.com, e.g. <a href=\"http://en.cppreference.com/w/c/string/byte\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/string/byte</a> .</p>\n\n<p>Depending on your compiler and level of expertise, you might want to try invoking <code>cc -E</code> on a file that uses the header file(s) you're curious about.  On compilers that support it, the <code>-E</code> flag gives you the output after just the preprocessing phase of compilation, so you can see what the <code>#include</code> lines expanded to.</p>\n"}, {"comments": [{"owner": {"reputation": 297, "user_id": 7033055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DgO5C.png?s=128&g=1", "display_name": "yode", "link": "https://stackoverflow.com/users/7033055/yode"}, "edited": false, "score": 0, "creation_date": 1501641225, "post_id": 45450528, "comment_id": 77862143, "body": "Thanks very much."}], "tags": [], "owner": {"reputation": 327, "user_id": 3439241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379db3ae2e8602becbff5d33238391ec?s=128&d=identicon&r=PG&f=1", "display_name": "Brad S.", "link": "https://stackoverflow.com/users/3439241/brad-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1501641168, "last_edit_date": 1592644375, "creation_date": 1501641168, "answer_id": 45450528, "question_id": 45450291, "link": "https://stackoverflow.com/questions/45450291/how-to-know-which-functions-the-package-includes/45450528#45450528", "title": "How to know which functions the package includes?", "body": "<p>May I suggest the following books:</p>\n<ul>\n<li><p><a href=\"https://rads.stackoverflow.com/amzn/click/com/013089592X\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">&quot;C: A Reference Manual&quot; by Samuel Harbison and Guy Steele</a></p>\n</li>\n<li><p><a href=\"https://rads.stackoverflow.com/amzn/click/com/0131315099\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">&quot;The    Standard C Library&quot; by P.J. Plauger</a></p>\n</li>\n<li><p><a href=\"https://rads.stackoverflow.com/amzn/click/com/0131103628\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">&quot;The C Programming Language&quot;    by Brian Kernigan and Dennis Ritchie</a></p>\n<p>this last one is the cannonical book on C, written by the dudes who created the language. The answers to the specific questions posed here are contained in the appendix. Very, very highly recommended.</p>\n</li>\n</ul>\n"}], "owner": {"reputation": 297, "user_id": 7033055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DgO5C.png?s=128&g=1", "display_name": "yode", "link": "https://stackoverflow.com/users/7033055/yode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1501645420, "accepted_answer_id": 45450418, "answer_count": 2, "score": -3, "last_activity_date": 1501689438, "creation_date": 1501639189, "last_edit_date": 1501643665, "question_id": 45450291, "link": "https://stackoverflow.com/questions/45450291/how-to-know-which-functions-the-package-includes", "closed_reason": "Not suitable for this site", "title": "How to know which functions the package includes?", "body": "<p>For example, I have <code>#include &lt;string.h&gt;</code>. How to know which functions the <code>string.h</code> header declares? And can I have a <strong>convenient method</strong> to get the documentation about a certain function?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "kernel-module", "netfilter"], "owner": {"reputation": 361, "user_id": 6900903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1b0a0b2f7a682a7db93546eeb823ead?s=128&d=identicon&r=PG&f=1", "display_name": "MacStation", "link": "https://stackoverflow.com/users/6900903/macstation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1501638729, "creation_date": 1501638729, "question_id": 45450222, "link": "https://stackoverflow.com/questions/45450222/modifying-packet-payload-netfilter-kernel-module", "title": "Modifying packet payload netfilter kernel module", "body": "<p>As a learning experience I am trying to create a kernel module that modifies incoming packets from specific IP addresses.  My setup is as follows:</p>\n\n<p>VM1: arpspoofs VM2->VM3 and VM3->VM2, runs kernel module</p>\n\n<p>VM2: nc host</p>\n\n<p>VM3: Connects to VM2 over nc</p>\n\n<p>Right now, I am just trying to change the entire payload to a random character, say 'h', in the future though I will be changing the payload entirely to either a brand new payload or modified payload.  For now I'm just trying to get this to work.</p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>unsigned int in_hook(void *priv, struct sk_buff * skb, const struct nf_hook_state *state) {\n    struct tcphdr *tcph = tcp_hdr(skb);\n    struct iphdr *iph = ip_hdr(skb);\n    struct tcphdr *modtcph;\n    unsigned char *tail;\n    unsigned char *user_data;\n    unsigned char *it;\n    struct sk_buff * modskb;\n    char * tempPay;\n    char * payload; //Char array to store original payload before modifications\n    int lenOrig;\n    int lenNew;\n    u16 sport, dport;\n    u32 saddr, daddr;\n    tempPay = kmalloc(1500, GFP_KERNEL);\n    payload = kmalloc(1500, GFP_KERNEL);\n    if (!skb)\n            return NF_ACCEPT;\n    saddr = ntohl(iph-&gt;saddr);\n    daddr = ntohl(iph-&gt;daddr);\n    sport = ntohs(tcph-&gt;source);\n    dport = ntohs(tcph-&gt;dest);\n    tail = skb_tail_pointer(skb);\n    if (saddr == 3232249857) { //IP address of computer SSHing to VM1\n            return NF_ACCEPT;\n    }\n    user_data = (unsigned char *)((unsigned char *)tcph + (tcph-&gt;doff * 4));\n\n    if(saddr == 3232249868 || saddr == 3232249869) {  //The IP address of VM2 and VM3\n            lenOrig = 0;\n            for (it = user_data; it != tail; ++it) {\n                    char c = *(char *)it;\n                    if (c == '\\0') {\n                            break;\n                    }\n                    else {\n                            *it = 'h';\n                    }\n                    payload[lenOrig] = c;\n                    lenOrig++;\n            }\n            ip_send_check(iph);\n            payload[lenOrig] = '\\0';\n            printk(\"NETFILTER.C: DATA OF ORIGINAL SKB: %s\", payload);\n    }\n    return NF_ACCEPT;\n}\n</code></pre>\n\n<p>Now I send through either VM2 or VM3: \"hello\" or any other string, and I expect on the other VM \"hhhhh\" but the other VM still sees \"hello\", what am I doing wrong?  The for loop works fine as payload only has the original packet payload.  </p>\n\n<p>My theory is that when conducting the man in the middle attack, the original connect between VM2 and VM3 is never severed, so my module works correctly, but when it sends the new socket buffer to VM3 or VM2, it ignores it as it is not expecting another packet or it sees through the attack and still sees VM1 as VM1 instead of the VM I'm spoofing.</p>\n\n<p>Thanks for all your help!</p>\n"}, {"tags": ["c++", "c", "mbstring"], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 8402500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XZRs6.jpg?s=128&g=1", "display_name": "G.Alexander", "link": "https://stackoverflow.com/users/8402500/g-alexander"}, "edited": false, "score": 0, "creation_date": 1501642181, "post_id": 45450610, "comment_id": 77862367, "body": "Thank you. the problem was non-ASCII."}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 1, "last_activity_date": 1501641736, "creation_date": 1501641736, "answer_id": 45450610, "question_id": 45449998, "link": "https://stackoverflow.com/questions/45449998/mbstowcs-s-function-retsize-sometimes-return-input-length-1/45450610#45450610", "title": "mbstowcs_s function retsize sometimes return input length + 1", "body": "<p>The third parameter to <a href=\"https://msdn.microsoft.com/en-us/library/eyktyxsx.aspx\" rel=\"nofollow noreferrer\"><code>mbtowcs_s</code></a> should be the size of the buffer pointed to by the second parameter in <code>wchar_t</code>s, so in your case it should be <code>MAX_PATH</code>.</p>\n\n<p>The point of <code>mbtowcs_s</code> is to make sure you don't write more characters to the destination than you have space for.  That's what the third parameter is for: to tell it how much space you have.  In this case, if <code>VIT_PASSWORD</code> has no non-ASCII characters in it, the destination will need the same number of <code>wchar_t</code>s to hold the converted string.  So if <code>VIT_PASSWORD</code> is 4 characters long, plus the nul terminator, then <code>mbtowcs_s</code>'s third parameter will need to be at least 5 to successfully convert the string (4 characters plus the nul-terminator).  The problem is that <code>strlen(VIT_PASSWORD)</code> will return 4, not 5 since it doesn't count the nul-terminator.</p>\n"}], "owner": {"reputation": 754, "user_id": 8402500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XZRs6.jpg?s=128&g=1", "display_name": "G.Alexander", "link": "https://stackoverflow.com/users/8402500/g-alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 45450610, "answer_count": 1, "score": 1, "last_activity_date": 1528846523, "creation_date": 1501637059, "last_edit_date": 1528846523, "question_id": 45449998, "link": "https://stackoverflow.com/questions/45449998/mbstowcs-s-function-retsize-sometimes-return-input-length-1", "title": "mbstowcs_s function retsize sometimes return input length + 1", "body": "<p>I'm using VisualStdio 2010 on Windows 7.</p>\n\n<p>I want to decrypt password using function and display result of decryption as <code>TCHAR*</code>.</p>\n\n<p><strong>Implementation here,</strong></p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar* _decrypt_password_v1(const char* strPassword);\nchar Hash_v1(const char chhash, int nIndex);\n\n#define VIT_PASSWORD _decrypt_password_v1(\"OOWIEJFOISJDFNPPAJ\")\n\nchar* _decrypt_password_v1(const char* strPassword)\n{\n    unsigned int i = 0;\n    char* strDecrypt = (char*)malloc(strlen(strPassword) + 1);\n    memset(strDecrypt, 0x00, strlen(strPassword) + 1);\n    int nLen = strlen(strPassword) -1;\n    for (int i = 0; i &lt; nLen; i++)\n    {\n        strDecrypt[i] = Hash_v1(strPassword[nLen - i], nLen - 1);\n    }\n\n    strDecrypt[i] = NULL;\n\n    return strDecrypt;\n}\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n    TCHAR szPassword[MAX_PATH] = {0};\n    int nLen = strlen(VIT_PASSWORD);\n    _tprintf(_T(\"Input Password Len : %d\\n\"), nLen);\n\n    size_t outSize;\n    mbstowcs_s(&amp;outSize, szPassword, strlen(VIT_PASSWORD), VIT_PASSWORD, strlen(VIT_PASSWORD));\n\n    _tprintf(_T(\"Password : %s\\n\"), szPassword);\n\n    return 0;\n}\n</code></pre>\n\n<p>If I run this code, I will get an error </p>\n\n<blockquote>\n  <p>Debug Assertion Failed!</p>\n  \n  <p>File: f:\\dd\\vctools\\crt_bld\\self_x86\\crt\\src\\mbstowcs.c</p>\n  \n  <p>Line: 283</p>\n  \n  <p>Expression: retsize &lt;= sizeInWords</p>\n</blockquote>\n\n<p>So, I increased parameter 3 of <code>mbstowcs_s</code> to<code>strlen(VIT_PASSWORD) + 1</code>.</p>\n\n<p>Corrected code:</p>\n\n<pre><code>mbstowcs_s(&amp;outSize, szPassword, strlen(VIT_PASSWORD) + 1, VIT_PASSWORD, strlen(VIT_PASSWORD));\n</code></pre>\n\n<p>Then no crash and run correctly, but <code>sizeInWords</code> is <code>strlen(VIT_PASSWORD)</code>, not <code>strlen(VIT_PASSWORD) + 1</code>. </p>\n\n<p>If I use <code>mbstowcs</code> instead, there's no error. like this <code>mbstowcs(szPassword, VIT_PASSWORD, strlen(VIT_PASSWORD));</code></p>\n\n<p>Why this happens? If the answer is not clear, I have to modify this part of my entire code in this way.</p>\n\n<p><strong>I need concrete answers.</strong></p>\n"}, {"tags": ["c", "csv", "strtok"], "comments": [{"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1501636994, "post_id": 45449905, "comment_id": 77861132, "body": "Unrelated to your question, strtok can give you unexpected behavior parsing csvs.   ie  &quot;a,b,,c,d&quot; will parse as 4 values instead of 5."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1501638147, "post_id": 45449905, "comment_id": 77861395, "body": "CSV can have embedded commas in fields. For example, <code>zero,&quot;one,two&quot;,three</code> is three fields. <code>strtok()</code> isn&#39;t going to be able to deal with that."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7419946, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70a30e9747ea48d4b1adad0594b85285?s=128&d=identicon&r=PG&f=1", "display_name": "xuxin wang", "link": "https://stackoverflow.com/users/7419946/xuxin-wang"}, "edited": false, "score": 0, "creation_date": 1501777378, "post_id": 45450040, "comment_id": 77940576, "body": "Thank you for your answer, it is really helpful for me."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1501677337, "last_edit_date": 1592644375, "creation_date": 1501637383, "answer_id": 45450040, "question_id": 45449905, "link": "https://stackoverflow.com/questions/45449905/use-strtok-read-csv-file/45450040#45450040", "title": "Use strtok read csv file", "body": "<p>First, a primer on how <code>strtok()</code> works. The function will give you back a pointer to somewhere in the <em>original</em> string, said string having been modified to make it look like you only have a single token <sup>(a)</sup>.</p>\n<p>For example, the first <code>strtok</code> of <code>&quot;A,B,C&quot;</code> would turn it into <code>&quot;A\\0B,C&quot;</code> and give you back the address of the <code>A</code> character. Using it at that point would then give you <code>&quot;A&quot;</code>.</p>\n<p>Similarly, the second call would turn it into <code>&quot;A\\0B\\0C&quot;</code> and give you back the address of the <code>B</code> character.</p>\n<p>The fact that it's giving you pointers into the original string is paramount here because that original string is located in <code>buff</code>.</p>\n<p>And, you're actually <em>overwriting</em> <code>buff</code> every time you read a line from the file. So, for all those five lines, <code>Game[i].ProductID</code> will simply be the address of the first character of <code>buff</code>. After you have processed the fifth line, the line:</p>\n<pre><code>while (fgets(buff, 1024, fp) != NULL &amp;&amp; i &lt; 5)\n</code></pre>\n<p>will first read in the sixth line <em>before</em> exiting the loop.</p>\n<p>This is why the final lines you see are actually <em>not</em> the same as any of the first five. You're printing out all the C strings for <code>ProductID</code>, at the (identical) addresses of <code>buff</code>, so you only see the sixth one, and you see the <em>full</em> line because you didn't tokenise that one after reading it in.</p>\n<p>What you need to do is to make a <em>copy</em> of the tokens before overwriting the line. That can be done with something like (it's a little complex but correctly handles the case where <code>strtok</code> returns NULL):</p>\n<pre><code>if ((Game[i].ProductID = strtok(buff, &quot;,&quot;)) != NULL)\n    Game[i].ProductID = strdup(Game[i].ProductID);\n</code></pre>\n<p>remembering that you should <code>free</code> those memory allocations at some point.</p>\n<p>In the <em>incredibly</em> unlikely event your environment doesn't have a <code>strdup</code> (it's POSIX rather than ISO), see <a href=\"https://stackoverflow.com/questions/252782/strdup-what-does-it-do-in-c/252802#252802\">here</a>.</p>\n<hr />\n<p>And, just as an aside, most CSV implementations allow for embedded commas such as by enclosing them in quotes or escaping them (the latter is rare but I <em>have</em> seen them):</p>\n<pre><code>name,&quot;diablo, pax&quot;,awesome\nname,diablo\\, pax,awesome\n</code></pre>\n<p>Both of those may be expected to be three fields, <code>name</code>, <code>diablo, pax</code> and <code>awesome</code>.</p>\n<p>Simplified processing with <code>strtok</code> will not allow for such complexities but, assuming your fields do not contain embedded commas, it may be okay. If your input <em>is</em> more complex, you may be better off using a third-party CSV library (with a suitable licence of course).</p>\n<hr />\n<p><sup>(a)</sup> For the language lawyers among us, this is covered in the ISO C standard, <code>C11 7.24.5.8 The strtok function, /3 and /4</code> (my bold):</p>\n<blockquote>\n<p>3/ The first call in the sequence searches the string pointed to by <code>s1</code> for the first character that is <em>not</em> contained in the current separator string pointed to by <code>s2</code>. If no such character is found, then there are no tokens in the string pointed to by <code>s1</code> and the <code>strtok</code> function returns a null pointer. If such a character is found, <em><strong>it is the start of the first token</strong></em>.</p>\n<p>4/ The <code>strtok</code> function then searches from there for a character that <em>is</em> contained in the current separator string. If no such character is found, the current token extends to the end of the string pointed to by <code>s1</code>, and subsequent searches for a token will return a null pointer. If such a character is found, <em><strong>it is overwritten by a null character, which terminates the current token.</strong></em> The strtok function saves a pointer to the following character, from which the next search for a token will start.</p>\n</blockquote>\n"}], "owner": {"reputation": 7, "user_id": 7419946, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70a30e9747ea48d4b1adad0594b85285?s=128&d=identicon&r=PG&f=1", "display_name": "xuxin wang", "link": "https://stackoverflow.com/users/7419946/xuxin-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4400, "favorite_count": 3, "answer_count": 1, "score": 0, "last_activity_date": 1501677337, "creation_date": 1501636367, "last_edit_date": 1501638078, "question_id": 45449905, "link": "https://stackoverflow.com/questions/45449905/use-strtok-read-csv-file", "title": "Use strtok read csv file", "body": "<p>I am trying to use strtok in C to read csv file, and store the contents into array of struct Game.\nMy code is shown below:</p>\n\n<pre><code>  FILE *fp;\n  int i = 0;\n  if((fp=fopen(\"Games.csv\",\"r\"))==NULL)\n    {\n      printf(\"Can't open file.\\n\");\n      exit(1);\n    }\n  rewind(fp);\n  char buff[1024]; \n  fgets(buff,1024,fp);\n  char* delimiter = \",\";\n\n  while(fgets(buff, 1024, (FILE*)fp)!=NULL &amp;&amp; i&lt;5){\n\n    Game[i].ProductID= strtok(buff, \",\");   \n\n\n    Game[i].ProductName = strtok(NULL, delimiter);\n\n        Game[i].Publisher = strtok(NULL, delimiter);\n\n    Game[i].Genre = strtok(NULL, delimiter);\n\n    Game[i].Taxable = atoi(strtok(NULL, delimiter));\n\n    Game[i].price = strtok(NULL, delimiter);\n\n    Game[i].Quantity  = atoi(strtok(NULL, delimiter));\n\n\n       printf(\"%s\\n\", Game[i].ProductID);\n\n    i++;\n   }\n\n\n    i = 0;\n    for(i = 0; i&lt;5; i++){\n       printf(\"%s\", Game[i].ProductID);\n    }\n</code></pre>\n\n<p>The output is shown below:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>DS_25ROGVOIRY\nDS_25MMD4N2BL\nDS_258KADVNLH\nDS_25UR7M375D\nDS_25FP45CJFZ\nDS_25AN1EA3PV,Blitz I: The League,Midway Games,Sports,0,$103.03 ,2\nDS_25AN1EA3PV,Blitz I: The League,Midway Games,Sports,0,$103.03 ,2\nDS_25AN1EA3PV,Blitz I: The League,Midway Games,Sports,0,$103.03 ,2\nDS_25AN1EA3PV,Blitz I: The League,Midway Games,Sports,0,$103.03 ,2\nDS_25AN1EA3PV,Blitz I: The League,Midway Games,Sports,0,$103.03 ,2\n</code></pre>\n\n<p>The first five lines (in the while loop) are correct. However, the last five lines( outside of while loop) are wrong, it print the whole line content.</p>\n\n<p>I am so confused about it. When the array is changed and how to still print the correct answer after while loop.</p>\n"}, {"tags": ["c", "if-statement", "binary", "microchip"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3554329, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cb25ee2b255bde90315eb3b4b2ba5b90?s=128&d=identicon&r=PG&f=1", "display_name": "user3554329", "link": "https://stackoverflow.com/users/3554329/user3554329"}, "edited": false, "score": 0, "creation_date": 1501635286, "post_id": 45449790, "comment_id": 77860725, "body": "Thank you very much for the clarification :)"}], "tags": [], "owner": {"reputation": 1066, "user_id": 6804401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21097b2dd60f0774b18668330994b52d?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Olson", "link": "https://stackoverflow.com/users/6804401/jonathan-olson"}, "is_accepted": false, "score": 2, "last_activity_date": 1501635198, "creation_date": 1501635198, "answer_id": 45449790, "question_id": 45449770, "link": "https://stackoverflow.com/questions/45449770/if-condition-with-binary-argument/45449790#45449790", "title": "IF condition with binary argument", "body": "<p>It will execute if any of the 5 least significant bits are set (because of the bitwise and with 0x1F.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 3554329, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cb25ee2b255bde90315eb3b4b2ba5b90?s=128&d=identicon&r=PG&f=1", "display_name": "user3554329", "link": "https://stackoverflow.com/users/3554329/user3554329"}, "edited": false, "score": 0, "creation_date": 1501656390, "post_id": 45452617, "comment_id": 77867525, "body": "&quot;No, why should it be all 1s? If you OR the value 1 (which is 000000..0001) you only set the bits that are set in the ORed value, i.e only 1 least significant bit.&quot; Because I am stupid and thought 1 to be all ones and thus every single bit gets ORed with 1.  Thank you very much for your help!!!"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 103, "user_id": 3554329, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cb25ee2b255bde90315eb3b4b2ba5b90?s=128&d=identicon&r=PG&f=1", "display_name": "user3554329", "link": "https://stackoverflow.com/users/3554329/user3554329"}, "edited": false, "score": 0, "creation_date": 1501658755, "post_id": 45452617, "comment_id": 77868974, "body": "Please don&#39;t mix &quot;unexperienced but willing to learn&quot; and &quot;being stupid&quot;. Even for wrong assumption there might be a plausible reason."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1501653745, "creation_date": 1501653745, "answer_id": 45452617, "question_id": 45449770, "link": "https://stackoverflow.com/questions/45449770/if-condition-with-binary-argument/45452617#45452617", "title": "IF condition with binary argument", "body": "<blockquote>\n  <p>Having an address ORed with \"1\" will always result in 1111 1111, wouldn`t it?</p>\n</blockquote>\n\n<p>No, why should it be all 1s? If you OR the value 1 (which is 000000..0001) you only set the bits that are set in the ORed value, i.e only 1 least significant bit.</p>\n\n<p>Whatever value <code>xyzxyz</code> your address <code>GESTIC_I2C_ADDR</code> might be, your result is <code>xyzxyz1</code> afterwards.</p>\n\n<p>There is no reason why all the other bits would be affected as well.</p>\n\n<hr>\n\n<blockquote>\n  <p>What I do not understand, is how this if-condition works. Is it true when all the bits of the 8bit binary numbers are set to 1? </p>\n</blockquote>\n\n<p>Well, mathematically spaking: Yes. ;)\nBut not \"IF and ONLY IF\" all 5 bits are set. \nIt is also true if only one of the bits is set.</p>\n\n<blockquote>\n  <p>As far as I understand, the argument is the bit wise AND operation on the 8bit register and the binary number 0001 1111 (0x1F).</p>\n</blockquote>\n\n<p>If you understand this, and you understand the word \"bitwise\", everything should be clear.</p>\n\n<p>I wonder how you get to the question above if you already made it to understanding this meaning. </p>\n"}], "owner": {"reputation": 103, "user_id": 3554329, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cb25ee2b255bde90315eb3b4b2ba5b90?s=128&d=identicon&r=PG&f=1", "display_name": "user3554329", "link": "https://stackoverflow.com/users/3554329/user3554329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1501653745, "creation_date": 1501635021, "last_edit_date": 1501650976, "question_id": 45449770, "link": "https://stackoverflow.com/questions/45449770/if-condition-with-binary-argument", "title": "IF condition with binary argument", "body": "<p>Sorry to ask again... But I seem to struggle with binary...\nI stumbled upon the following line</p>\n\n<pre><code> MGC_SSPBUF_REG = (GESTIC_I2C_ADDR &lt;&lt; 1) | 1; // write Address to MGC3130\n</code></pre>\n\n<p>Beside the fact, that  don`t know, why one would shift the address to the left in order to save it, I cannot get my head around that OR operation.</p>\n\n<p>Having an address ORed with \"1\" will always result in 1111 1111, wouldn`t it?</p>\n\n<hr>\n\n<p>I am programming a Microchip PIC18F14K50 in C. While checking a code written\nby another company I stumbled across the following line:</p>\n\n<pre><code>if(MGC_SSPCON2_REG &amp; 0x1F) { // MSSP not idle\n...\n}\n</code></pre>\n\n<p>Now, MGC_SSPCON2_REG is implemented as follows</p>\n\n<pre><code> #define MGC_SSPCON2_REG         SSPCON2\n</code></pre>\n\n<p>Where SSPCON is the 8bit MSSP Control register (in I2C MODE).</p>\n\n<p>What I do not understand, is how this if-condition works. Is it true when all the bits of the 8bit binary numbers are set to 1?\nAs far as I understand, the argument is the bit wise AND operation on the 8bit register and the binary number 0001 1111 (0x1F).</p>\n\n<p>I hope that I provided enough code to understand the question. I didn`t want to go to much into detail about how the register works.</p>\n\n<p>Thank you in advance for your help :)</p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 0, "creation_date": 1501634258, "post_id": 45449639, "comment_id": 77860500, "body": "Would it be possible to reduce this down to only what&#39;s wrong and the code that is associated with your problem?"}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "reply_to_user": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 0, "creation_date": 1501634733, "post_id": 45449639, "comment_id": 77860597, "body": "Sorry, being a beginner I am struggling to explain myself clearly and posted too much it seems.The program up above reads the text file and stores data into the different members of the structure which is working correctly. The file has options as 1)display all american league teams 2)search by name etc. I have working pieces of code that do that for me correctly, but in the main function. I want to have different functions that do those separate options so my attempt to do that is up above the second to last piece of code."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501636188, "post_id": 45449795, "comment_id": 77860924, "body": "Don&#39;t I have to use aTeamPtr-&gt;leagueName since I passed it as pointer? I tried so many different ways at this point I just want it to work. As I showed up above I just want to be able to pass array of structures to another function and use the for loop/if statement to display the data."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501636400, "post_id": 45449795, "comment_id": 77860981, "body": "I think  you actually want <code>aTeamPtr[index].leagueName</code> (and so on) everywhere you you used <code>-&gt;</code>. @AdrianAlba"}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501636891, "post_id": 45449795, "comment_id": 77861108, "body": "I don&#39;t fully understand the code. It seems like you are using some sort of counter when calling function. In my function void americanLeague(team_t <i>aTeamPtr) instead of using the pointer I use a counter? like void americanLeague(team_t</i> i). Then I will be able to use aTeamPtr[index].leagueName?"}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501637054, "post_id": 45449795, "comment_id": 77861142, "body": "No, I&#39;m not using any additional counters than you. When you do your check, that&#39;s inside a loop. You do your work <code>if(strcmp(&quot;A&quot;, aTeamPtr[index].leagueName)== 0)</code> so the right element to print is the one at <code>index</code>. @AdrianAlba"}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501637139, "post_id": 45449795, "comment_id": 77861168, "body": "All I&#39;m doing in <code>foo</code> is showing you I can treat a pointer (that points to an array) as an array or the first element in the array. @AdrianAlba"}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501637985, "post_id": 45449795, "comment_id": 77861358, "body": "Sorry I just started using array of structures and what I have been using is limited to typedef structures.Not sure if I understood completely is when printing I switch the aTeamPtr-&gt;leaguename when displaying to aTeamPtr[index].leagueName? Also thanks a lot for tanking the time to help"}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501638604, "post_id": 45449795, "comment_id": 77861505, "body": "That&#39;s right. @AdrianAlba Once you know which one it is (could be <i>any</i> in the array at that exact moment) use that index to work with that specific team. Glad to help!"}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501638958, "post_id": 45449795, "comment_id": 77861590, "body": "I had this piece of code if(strcmp(&quot;A&quot;, aTeamPtr[index].leagueName)== 0) in my original attempt. Now I tried change the address from the print statement to aTeamPtr[index].leagueName, aTeamPtr[index].teamName,etc. It still provides no errors and just outputs lines. Thinking it has to do with parameters when calling function which the code is nationalLeague(&amp;teams[index]); and also here is code of the function header with parameters void americanLeague(team_t *aTeamPtr)."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501639404, "post_id": 45449795, "comment_id": 77861690, "body": "You&#39;re losing me now. I&#39;m not sure what to make of your last comment but it seems to be veering away from what you originally posted. Please answer the following question: <i>When you call <code>americanLeague</code> (for example) do you pass it an array of teams or a single team?</i> In your example here, you use it as an array (you iterate over it!) as well as a pointer to single team (you do <code>-&gt;</code> on the same pointer you <i>treat as an array</i>!)."}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501639775, "post_id": 45449795, "comment_id": 77861790, "body": "The program is reading 30 teams from a file into array of structures.When user selects option 1(which shows all american league teams) the americanLeague function is called. I want to show all the american league teams with all their respective information(name,address,etc). I have the piece of code that allowed me to do this successfully within the main function though."}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501640155, "post_id": 45449795, "comment_id": 77861891, "body": "when trying to replicate in another function"}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501640448, "post_id": 45449795, "comment_id": 77861963, "body": "Ok, so it&#39;s an array. There&#39;s no difference in the code that you use in main or the other function. The only difference is you tried to complicate your life by passing a pointer to a function that <i>really</i> wants an array. While that has no meaningful difference to the language, you&#39;d be better off doing things explicitly to help you (and others) reason your code. Anywho, do as I said long ago. If you have any updates for your code, ask another question or update the code in this one as you go along and have yet to receive an answer."}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501641117, "post_id": 45449795, "comment_id": 77862120, "body": "I updated the second to last piece of code to what you said and it still only outputs blank lines. Also MAX_TEAMS IS #define MAX_TEAMS 30"}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501641485, "post_id": 45449795, "comment_id": 77862204, "body": "Sorry to say but that doesn&#39;t seem possible with the code you have here and I can&#39;t spend anymore time on this. Your updated code will <b><i>at the very least</i></b> print the league name of every american league team. That is self evident by the fact you can&#39;t print unless the condition is true after resolving the same league name against what you believe to be the correct league name. Good luck; will delete this in due time @AdrianAlba."}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501643064, "post_id": 45449795, "comment_id": 77862576, "body": "Thanks a lot for the help.Anyways for what is worth in the call I replaced index for 0 americanLeague(&amp;teams[0]);.Then I switched back to -&gt; in print statement for americanLeague function.Result is now it prints out the first teams information all of it 15 times(which is the amount of American league teams in file)."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501643506, "post_id": 45449795, "comment_id": 77862664, "body": "I think you should take the time to understand what you&#39;re doing rather than finding a solution to your attempts at doing something you don&#39;t understand.  It sounds like you&#39;re headed towards that understanding but you&#39;re still referencing a call I&#39;ve yet to see in your question. As such, I bid you good luck again. This will be my last com absent a significant edit, clarification, or refutation of my answer."}, {"owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501645755, "post_id": 45449795, "comment_id": 77863227, "body": "Good news is that I figured it out and now the code is working well.You were telling me all this time.I was just tired and wasn&#39;t using my head. Apologize must&#39;ve been annoying trying to explain.Anyways updated the code and again thanks for the help."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "edited": false, "score": 0, "creation_date": 1501647377, "post_id": 45449795, "comment_id": 77863685, "body": "No problem, glad to help. If my answer helped solve it, consider upvoting it and/or accepting it as the solution. @Adrian"}], "tags": [], "owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "is_accepted": false, "score": 0, "last_activity_date": 1501657273, "last_edit_date": 1501657273, "creation_date": 1501635246, "answer_id": 45449795, "question_id": 45449639, "link": "https://stackoverflow.com/questions/45449639/passing-entire-structure-to-a-function-and-display-the-contents-c/45449795#45449795", "title": "Passing entire structure to a function and display the contents C", "body": "<p>You're apparently passing an array (or pointer) to a function that also treats it as a pointer to a single instance. You can see the difference in your code where you do <code>aTeamPtr[index].leagueName</code> but also <code>aTeamPtr-&gt;leagueName</code>.</p>\n\n<p>Which one do you want?</p>\n\n<p>Consider this code and its output:</p>\n\n<pre><code>int size = 10;\n\nstruct iint {\n    int i;\n};\n\nvoid foo(struct iint* i) {\n    for (int j = 0; j &lt; size; ++j) {\n        printf(\"%d\", i[j].i);\n    }\n    printf(\"\\n%d\\n\", i-&gt;i);\n}\n\nint main() {\n    struct iint i[size];\n    for (int j = 0; j &lt; size; ++j) {\n        i[j].i = j;\n    }\n    foo(i);\n    return 0;\n}\n\n// Output:\n// 0123456789\n// 0\n</code></pre>\n\n<p>That's because a pointer to an array points at the first element. C doesn't care if you choose to use them interchangeably.</p>\n"}], "owner": {"reputation": 31, "user_id": 8322471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2319bab87b0bda48618776aeff3035f?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Alba", "link": "https://stackoverflow.com/users/8322471/adrian-alba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1501657273, "creation_date": 1501634089, "last_edit_date": 1501645568, "question_id": 45449639, "link": "https://stackoverflow.com/questions/45449639/passing-entire-structure-to-a-function-and-display-the-contents-c", "title": "Passing entire structure to a function and display the contents C", "body": "<p>I have been stuck on this for a while now.The program reads lines from a text file into array of structures. Here is a few lines so you get an idea of what is being stored into array of structures.</p>\n\n<pre><code>A|Baltimore Orioles|Oriole Park|333 West Camden Street|Baltimore|MD|21201|(410) 685-9800|orioles.com\nN|Washington Nationals|Nationals Park|1500 South Capitol Street, SE|Washington|DC|20003-1507|(202) 675-6287|nationals.com\n</code></pre>\n\n<p>There is no problem when it comes to loading the arrays with correct data. I tested the contents using this piece of code and it displays correct data.</p>\n\n<pre><code>        scanf(\"%i\",&amp;userChoice);\n\n        if(userChoice == 1){\n        for(index=0; index&lt;count; index++)\n        {\n            if(strcmp(\"A\", teams[index].leagueName)== 0)\n                {\n\n                    americanLeague(&amp;teams[index]);\n\n\n                }\n        }\n        }\n</code></pre>\n\n<p>The program has a main menu and option 1 is to display all teams from American League or \"A\" from text file. Now I don't want the for loop/if statement to run in main function.I want it just to run the if statement for userchoice and call the americanLeague function. Here is my attempt</p>\n\n<pre><code>scanf(\"%i\",&amp;userChoice);\n\nif(userChoice == 1){\n\n                    americanLeague(&amp;teams[0]);\n\n\n        }\n</code></pre>\n\n<p>This just calls americanLeague function</p>\n\n<pre><code>void americanLeague(team_t *aTeamPtr)\n{\n        int index;\n\n        for(index=0; index&lt;=MAX_TEAMS; index++){\n        if(strcmp(\"A\", aTeamPtr[index].leagueName)== 0)\n            {\n\n                printf(\"LEAGUE:%s TEAM:%s PARKNAME:%s ADDRESS:%s CITY:%s STATE:%s ZIPCODE:%s PHONE#:%s WEBADDRESS:%s\\n\\n\",\n                                                 aTeamPtr[index].leagueName, aTeamPtr[index].teamName,\n                                                 aTeamPtr[index].parkName, aTeamPtr[index].teamAddress,\n                                                 aTeamPtr[index].teamCity, aTeamPtr[index].teamState,\n                                                 aTeamPtr[index].zipCode, aTeamPtr[index].phoneNumber,\n                                                 aTeamPtr[index].webAddress);\n\n\n            }\n        }\n}\n</code></pre>\n\n<p>Here is my attempt to try and display teams info passing array of structures into another function.The code doesn't work, but it doesn't give me any errors it just outputs blank spaces.I will also add structure and how I read file just in case.</p>\n\n<pre><code>typedef struct\n{\n    char leagueName[LEAGUE_NAME + 1];\n    char teamName[LEN_NAME + 1];\n    char parkName[PARK_NAME + 1];\n    char teamAddress[TEAM_ADDRESS + 1];\n    char teamCity[TEAM_CITY + 1];\n    char teamState[TEAM_STATE + 1];\n    char zipCode[ZIP_CODE + 1];\n    char phoneNumber[PHONE_NUMBER + 1];\n    char webAddress[WEB_ADDRESS + 1];\n\n\n} team_t;\n\nint main(void)\n{\n    FILE * filePtr;\n    int index, count;\n    char line[LEN_LINE + 1];\n    char repeat;\n    team_t teams[MAX_LINES];\n    filePtr = fopen(\"MLBteams.txt\", \"r\");\n    if(filePtr == NULL)\n    {\n        printf(\"Unable to open file.\\n\");\n    }\n    else\n    {\n        index = 0;\n        while(index&lt;MAX_LINES &amp;&amp; fgets(line, LEN_LINE, filePtr))\n        {\n            if(9 == sscanf(line,\"%5[^|]| %40[^|]| %35[^|]| %40[^|]| %30[^|]| %5[^|]| %10[^|]| %30[^|]| %25[^\\n]\", teams[index].leagueName, teams[index].teamName,\n                                                                                                                   teams[index].parkName, teams[index].teamAddress,\n                                                                                                                   teams[index].teamCity, teams[index].teamState,\n                                                                                                                   teams[index].zipCode, teams[index].phoneNumber,\n                                                                                                                   teams[index].webAddress)\n\n               )\n            {\n                index++;\n            }\n        }\n        fclose(filePtr);\n        count = index;\n</code></pre>\n\n<p>There is no problem when reading correct data into array of structures.I already tested the output several times within main function.Anyways any help would be much appreciated.</p>\n"}, {"tags": ["c", "if-statement"], "comments": [{"owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1501634085, "post_id": 45449616, "comment_id": 77860459, "body": "<a href=\"http://man7.org/linux/man-pages/man3/strchr.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/strchr.3.html</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1501634520, "post_id": 45449616, "comment_id": 77860549, "body": "If you are only inerested in ASCII encoding, directly indexing a 128-byte lookup table with the char value would be reasonably quick, and really flexible, with lower/upper case handled easily.  With a bit(!) of shifting etc. a 128-bit table could do the same job and would fit into a cache line."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1501648571, "post_id": 45449616, "comment_id": 77864087, "body": "@MartinJames Each byte can hold the value (0/1) for 8 characters. 128 / 8 = 16 bytes. Would easily fit in most cache lines. Nice solution! Even with two values in each byte, the table would fit in a 64 byte cache line."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1501654464, "post_id": 45449616, "comment_id": 77866435, "body": "@Carcigenicate That is the problem. C does not have builtin sets. You might simulate with large bitfields."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 3030870, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gUgbL.jpg?s=128&g=1", "display_name": "shmink", "link": "https://stackoverflow.com/users/3030870/shmink"}, "edited": false, "score": 0, "creation_date": 1501635046, "post_id": 45449688, "comment_id": 77860676, "body": "Good point. I feel mine is more readable but maybe that&#39;s because I don&#39;t really like using switch statements :P"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 147, "user_id": 3030870, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gUgbL.jpg?s=128&g=1", "display_name": "shmink", "link": "https://stackoverflow.com/users/3030870/shmink"}, "edited": false, "score": 0, "creation_date": 1501647848, "post_id": 45449688, "comment_id": 77863842, "body": "@Shmink use switch wherever you can. The compiler decides what is the most efficient lowering for it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 6, "last_activity_date": 1501634456, "creation_date": 1501634456, "answer_id": 45449688, "question_id": 45449616, "link": "https://stackoverflow.com/questions/45449616/can-i-make-this-if-statement-with-lots-of-ors-more-concise/45449688#45449688", "title": "Can I make this if statement with lots of ORs more concise?", "body": "<p>You can do this with a <code>switch</code> with fallthrough cases:</p>\n\n<pre><code>for(int i = 0; i &lt; length; i++) {\n    switch (input[i]) {\n    case 'a':\n    case 'e':\n    case 'i':\n    case 'o':\n    case 'u':\n        total++;\n        break;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 3030870, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gUgbL.jpg?s=128&g=1", "display_name": "shmink", "link": "https://stackoverflow.com/users/3030870/shmink"}, "edited": false, "score": 1, "creation_date": 1501634986, "post_id": 45449719, "comment_id": 77860661, "body": "True, I was considering this approach. Out of curiosity, not that it matters at these small scales but what&#39;s better for performance between a bigger if statement or a nested if statement?"}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 2, "creation_date": 1501635334, "post_id": 45449719, "comment_id": 77860737, "body": "I agree. The OP code will overcome this solution as the string grows. Not only does the OP&#39;s example run in linear time, but the OR statements will short-circuit avoiding unnecessary checks compared to this O(n^2) approach."}, {"owner": {"reputation": 822, "user_id": 4112667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i1NaX.jpg?s=128&g=1", "display_name": "haolee", "link": "https://stackoverflow.com/users/4112667/haolee"}, "reply_to_user": {"reputation": 147, "user_id": 3030870, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gUgbL.jpg?s=128&g=1", "display_name": "shmink", "link": "https://stackoverflow.com/users/3030870/shmink"}, "edited": false, "score": 0, "creation_date": 1501635359, "post_id": 45449719, "comment_id": 77860747, "body": "@Shmink I think the nesting loop will make it more obscure."}, {"owner": {"reputation": 32, "user_id": 7331793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3Nr0CU_WW98/AAAAAAAAAAI/AAAAAAAAAO8/KF7Cqv8LyiA/photo.jpg?sz=128", "display_name": "Amr H", "link": "https://stackoverflow.com/users/7331793/amr-h"}, "edited": false, "score": 0, "creation_date": 1501635635, "post_id": 45449719, "comment_id": 77860798, "body": "in my opinion : nested is better for reading , since it all depends on your starting condition for example I want to check if this char equal to( i )and (i) condition I put it in the last if condition block or in the last line among the conditions that way will take approximate the  same time"}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1501636189, "post_id": 45449719, "comment_id": 77860927, "body": "Readability really falls under opinion. As for your comment on the &quot;same time,&quot; I&#39;m not sure if I understand what you mean? In the worst case, the vowel array will have to be iterated for each character of the string, and even when a character is matched, it will still have to keep searching the vowel array causing unnecessary checks."}, {"owner": {"reputation": 32, "user_id": 7331793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3Nr0CU_WW98/AAAAAAAAAAI/AAAAAAAAAO8/KF7Cqv8LyiA/photo.jpg?sz=128", "display_name": "Amr H", "link": "https://stackoverflow.com/users/7331793/amr-h"}, "edited": false, "score": 0, "creation_date": 1501637056, "post_id": 45449719, "comment_id": 77861143, "body": "what I was meaning is it depends on your conditions order , but I get more good solution for  which will increase the performance and will save you unnecessary checks  you know that every char have asci number right what if we order each char in our array in ascendant order according to his asci number , now we have a array of asci numbers let&#39;s say it&#39;s [&#39;66&#39;,&#39;77&#39;,&#39;88&#39;,&#39;99&#39;] then we take the input transform it to asci number and check right in the center of the array if equal then you got your answer if not  see if it&#39;s bigger or smaller if bigger move to the right side and use it as new arr"}, {"owner": {"reputation": 32, "user_id": 7331793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3Nr0CU_WW98/AAAAAAAAAAI/AAAAAAAAAO8/KF7Cqv8LyiA/photo.jpg?sz=128", "display_name": "Amr H", "link": "https://stackoverflow.com/users/7331793/amr-h"}, "edited": false, "score": 0, "creation_date": 1501637266, "post_id": 45449719, "comment_id": 77861198, "body": "use it as a new array to it&#39;s center again , and if low go to the left side and do the same ,  let&#39;s say my input after transformation is 77 so I&#39;ll start with the half length of the array which is it&#39;s value is 77 ,second try my input is 99 ,I&#39;ll go to the half which is 1 equal to 77 no mu number is 99 it should be next element and so on . that used in tree algorithm and tree is a data structure ."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501648003, "post_id": 45449719, "comment_id": 77863901, "body": "<i>you can make it this way better and faster</i> - faster? you sure about that? Array accesses are always going to lead to dereference. It is much more efficient comparing against constant values. Not to mention the looping overheading (but I guess any decent  compiler would unroll it)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501648707, "post_id": 45449719, "comment_id": 77864111, "body": "<code>char *array = [&#39;i&#39;,&#39;o&#39;,&#39;a&#39;,&#39;e&#39;];</code> is not even valid C code. <code>length</code> is the wrong limit for inner loop."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1501648765, "post_id": 45449719, "comment_id": 77864135, "body": "A binary search for each element in the array still grows quicker asymptotically compared to a linear search. And with a binary search, it still becomes shadowed by the nested loop =&gt; O(n^2 + nlog(n)) &gt;= O(n). If instead one loop where to be used, it still doesn&#39;t achieve the speed of linear, O(nlogn) &gt;= O(n)"}], "tags": [], "owner": {"reputation": 32, "user_id": 7331793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3Nr0CU_WW98/AAAAAAAAAAI/AAAAAAAAAO8/KF7Cqv8LyiA/photo.jpg?sz=128", "display_name": "Amr H", "link": "https://stackoverflow.com/users/7331793/amr-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1501634658, "creation_date": 1501634658, "answer_id": 45449719, "question_id": 45449616, "link": "https://stackoverflow.com/questions/45449616/can-i-make-this-if-statement-with-lots-of-ors-more-concise/45449719#45449719", "title": "Can I make this if statement with lots of ORs more concise?", "body": "<p>you can make it this way better and faster \nmake array of the variables you want to check \nEx char  *array = ['i','o','a','e'];\nthen </p>\n\n<pre><code>for(int i = 0; i &lt; length; i++) {\n   for(int i2 = 0; i2 &lt; length; i2++){\n      if(input[i] == array[i2]){\n         total++;\n      }\n  }\n}\n</code></pre>\n\n<p>this way you can add as much as char you want to compare and less || statements and faster .</p>\n"}, {"tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": false, "score": 2, "last_activity_date": 1501635170, "creation_date": 1501635170, "answer_id": 45449788, "question_id": 45449616, "link": "https://stackoverflow.com/questions/45449616/can-i-make-this-if-statement-with-lots-of-ors-more-concise/45449788#45449788", "title": "Can I make this if statement with lots of ORs more concise?", "body": "<p>You could use the library function <code>strtok</code> to tokenize the input string, like this:</p>\n\n<pre><code>pch = strtok (input,\"aeiou\");\nwhile (pch != NULL)\n{\n    total++;\n    pch = strtok (NULL, \"aeiou\");\n}\n</code></pre>\n\n<p>Note that strtok is destructive to the input string.</p>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501648283, "post_id": 45449810, "comment_id": 77864002, "body": "How is this remotely related to what OP is asking? He needs the count of all the vowels in the input string. Boolean on whether a vowel exists doesn&#39;t help in anyway. Moreover he is trying to make his condition more succinct. Adding more conditions in your code to search for all the vowels in just going to make the condition even larger."}], "tags": [], "owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "is_accepted": false, "score": 1, "last_activity_date": 1501635389, "creation_date": 1501635389, "answer_id": 45449810, "question_id": 45449616, "link": "https://stackoverflow.com/questions/45449616/can-i-make-this-if-statement-with-lots-of-ors-more-concise/45449810#45449810", "title": "Can I make this if statement with lots of ORs more concise?", "body": "<p><strong>strchr</strong> lets you search a character string for a specific character.  It looks like a reasonable way to solve your problem.  </p>\n\n<p>Untested code:</p>\n\n<pre><code>char findMe = 'e';\nchar *vowels=\"aeiou\";\nif (strchr(vowels, findMe) != NULL)\n{\n   print(\"found\\n\");\n}\nelse\n{\n   print(\"not found\");\n}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 3030870, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gUgbL.jpg?s=128&g=1", "display_name": "shmink", "link": "https://stackoverflow.com/users/3030870/shmink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 45449688, "answer_count": 4, "score": 1, "last_activity_date": 1501635389, "creation_date": 1501633886, "question_id": 45449616, "link": "https://stackoverflow.com/questions/45449616/can-i-make-this-if-statement-with-lots-of-ors-more-concise", "title": "Can I make this if statement with lots of ORs more concise?", "body": "<p>I'm refreshing my knowledge of C by doing some random exercises. The following is an excerpt from my solution to counting how many vowels in a string. It works but there has to be a more concise way to write this if statement. Any ideas?</p>\n\n<pre><code>for(int i = 0; i &lt; length; i++) {\n    if(input[i] == 'a' || input[i] == 'e' || input[i] == 'i' || input[i] == 'o' || input[i] == 'u') {\n        total++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "object", "linker", "hex"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1501654413, "post_id": 45449515, "comment_id": 77866413, "body": "What do you mean with &quot;hex file&quot;? Do you want to dump the object files as hex(adecimal) numbers (i.e. <a href=\"https://en.wikipedia.org/wiki/Hex_dump\" rel=\"nofollow noreferrer\">Hex Dump</a>? There are existing tools for this, e.g. <a href=\"http://archive.oreilly.com/linux/cmd/cmd.csp?path=h/hexdump\" rel=\"nofollow noreferrer\"><code>hexdump</code></a> but you can easily write your own with a few number of lines... (e.g. <a href=\"https://stackoverflow.com/q/7775991/7478597\">SO: how to get hexdump of a structure data</a>)."}, {"owner": {"reputation": 409, "user_id": 4657413, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6u2Hm.jpg?s=128&g=1", "display_name": "newb7777", "link": "https://stackoverflow.com/users/4657413/newb7777"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1501654815, "post_id": 45449515, "comment_id": 77866595, "body": "@ Scheff. It is the file format of an embedded system like a PIC processor compiled with MPLAB-X tool. Usually the hex file is used to program an embedded PIC processor."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1501654904, "post_id": 45449515, "comment_id": 77866656, "body": "OK. I think it was worth to mention this. May be, you should <a href=\"https://stackoverflow.com/posts/45449515/edit\">edit</a> your question..."}], "owner": {"reputation": 409, "user_id": 4657413, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6u2Hm.jpg?s=128&g=1", "display_name": "newb7777", "link": "https://stackoverflow.com/users/4657413/newb7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501632880, "creation_date": 1501632880, "question_id": 45449515, "link": "https://stackoverflow.com/questions/45449515/will-different-object-files-but-with-same-logic-scattered-over-different-files-c", "title": "Will different object files but with same logic scattered over different files create same hex file?", "body": "<p>if you have the same end function from a product but some logic statements were shuffled around from one c file (program1.c) to another c file (program2.c)\neg</p>\n\n<pre><code>//program1.c\n...\nUINT8 VarA; //declared globally\nUINT8 VarB;\nUINT8 VarC;\n&lt;some code here \"excerpt A\"&gt;\nif (VarA &gt;= VarB){\nVarC = VarA+1;\n...\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>//program2.c\n...\n&lt;some code&gt;;\n...\n</code></pre>\n\n<p>Compared to output of these files when linker makes the final hex file.</p>\n\n<pre><code>//program1.c\n...\n&lt;some code&gt;;\n...\n</code></pre>\n\n<p>and this </p>\n\n<pre><code>//program2.c\n...\nUINT8 VarA; //declared globally\nUINT8 VarB;\nUINT8 VarC;\n&lt;some code here \"excerpt A\"&gt; \nif (VarA &gt;= VarB){\nVarC = VarA+1;\n...\n}\n</code></pre>\n\n<p>\"excerpt A\" is used to denote the exact same code the exact. assume that the only difference is whats showing between the codes.</p>\n\n<p>What is the codes were slightly different but the output hex files functioned exactly the same? Would you expect the hex file to be different?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1501633205, "post_id": 45449504, "comment_id": 77860233, "body": "your approach might work if you have 1-number integer, but you have integers which span several symbols. As a hint, you need to find out a position when the integer starts in the string. Then you can use the <code>strtol</code> function to convert the portion of the string at its start into an integer."}], "answers": [{"tags": [], "owner": {"reputation": 2622, "user_id": 1834967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Fdxei.jpg?s=128&g=1", "display_name": "Felix Guo", "link": "https://stackoverflow.com/users/1834967/felix-guo"}, "is_accepted": false, "score": 2, "last_activity_date": 1501633441, "creation_date": 1501633441, "answer_id": 45449569, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c/45449569#45449569", "title": "Count and get integers from a string using C", "body": "<p>You want to build your number incrementally until you hit a space, then put that into the array. You can do this by multiplying by 10 then adding the next digit each time.</p>\n\n<pre><code>void count_get_ints(const char *data) {\n    int buf[10000];\n    int j = 0;\n    int current_number = 0;\n\n    // Move this outside the loop to eliminate recalculating the length each time\n    int total_length = strlen(data); \n    for (int i=0; i &lt;= total_length; i++) {\n        // Go up to 1 character past the length so you \n        //   capture the last number as well\n        if (i == total_length || isspace(data[i])) {\n            // Save the number, and reset it\n            buf[j++] = current_number;\n            current_number = 0;\n        }\n        else {\n            current_number *= 10;\n            current_number += data[i] - '0';\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 347, "user_id": 4231740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9ed17f73ff0fb5c20bc38f45d930796?s=128&d=identicon&r=PG&f=1", "display_name": "Fjotten", "link": "https://stackoverflow.com/users/4231740/fjotten"}, "is_accepted": false, "score": 2, "last_activity_date": 1501633917, "creation_date": 1501633917, "answer_id": 45449622, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c/45449622#45449622", "title": "Count and get integers from a string using C", "body": "<p>I think <code>strtok</code> will provide a cleaner solution, unless you really want to iterate over every char in the string. It has been a while since I did C, so please excuse any errors in the code below, hopefully it will give you the right idea.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char str[19] = \"1 2 11 84384 0 212\";\n    const char s[2] = \" \";\n    char *token;\n    int total;\n\n    total = 0;\n    token = strtok(str, s);\n\n    while (token != NULL) {\n        printf(\"%s\\n\", token);\n        total += atoi(token);\n        token = strtok(NULL, s);\n    }\n    printf(\"%d\\n\", total);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "is_accepted": false, "score": 0, "last_activity_date": 1501634638, "last_edit_date": 1501634638, "creation_date": 1501633985, "answer_id": 45449629, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c/45449629#45449629", "title": "Count and get integers from a string using C", "body": "<p>You can check the ascii value of each character by doing <code>c-'0'</code>. If it's between [0,9], then it's an integer. By having a state variable, when you're inside an integer by checking if a given character is a number of space, you can keep track of the count by ignoring white space. Plus you don't need a buffer, <em>what happens if data is larger than 10,000, and you write pass the end of the buffer</em>?, undefined behavior will happen. This solution doesn't require a buffer. </p>\n\n<p><strong>Edit, the solution now prints the integers that are in the string</strong></p>\n\n<pre><code>void count_get_ints(const char *data) {\n   int count = 0;\n   int state = 0;\n   int start = 0;\n   int end = 0;\n   for(int i = 0; i&lt;strlen(data); i++){\n      int ascii = data[i]-'0';\n      if(ascii &gt;= 0 &amp;&amp; ascii &lt;= 9){\n         if(state == 0){\n            start = i;\n         }\n         state = 1;\n      }else{\n         //Detected a whitespace\n         if(state == 1){\n            count++;\n            state = 0;\n            end = i;\n            //Print the integer from the start to end spot in data\n            for(int j = start; j&lt;end; j++){\n                printf(\"%c\",data[j]);\n            }\n            printf(\" \");\n         }\n      }\n   }\n   //Check end\n   if(state == 1){\n      count++;\n      for(int j = start; j&lt;strlen(data); j++){\n          printf(\"%c\",data[j]);\n      }\n      printf(\" \");\n   }\n   printf(\"Number of integers %d\\n\",count);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1501649008, "post_id": 45450727, "comment_id": 77864227, "body": "The question it about reading actual space separated numbers from the string."}], "tags": [], "owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "is_accepted": false, "score": -1, "last_activity_date": 1501650381, "last_edit_date": 1501650381, "creation_date": 1501642781, "answer_id": 45450727, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c/45450727#45450727", "title": "Count and get integers from a string using C", "body": "<p>Assuming you don't have any non-numbers in your string, you can just count the number of spaces + 1 to find the number of integers in the string like so in this pseudo code:</p>\n\n<pre><code>for(i = 0; i &lt; length of string; i++) {\n   if (string x[i] == \" \") {\n      Add y to the list of strings\n      string y = \"\";\n      counter++;\n   }\n\n   string y += string x[i]\n}\n\nnumberOfIntegers =  counter + 1;\n</code></pre>\n\n<p>Also, this reads the data between the white spaces. Keep in mind this is pseudo code, so the syntax is different.</p>\n"}, {"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 0, "last_activity_date": 1501649908, "creation_date": 1501649908, "answer_id": 45451788, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c/45451788#45451788", "title": "Count and get integers from a string using C", "body": "<p>I believe the standard way of doing this would be using <code>sscanf</code> using the <code>%n</code> format specifier to keep track of how much of the string is read.</p>\n\n<p>You can start with a large array to read into -</p>\n\n<pre><code>int array[100];\n</code></pre>\n\n<p>Then you can keep reading integers from the string till you can't read anymore or you are done reading 100.</p>\n\n<pre><code>int total = 0;\nint cont = 0;\nint ret = 1;\nwhile(ret == 1 &amp;&amp; total &lt; 100) {\n    ret = sscanf(input, \"%d%n\", &amp;array[total++], &amp;cont);\n    input += cont;\n}\ntotal--;\nprintf(\"Total read = %d\\n\", total);\n</code></pre>\n\n<p>and <code>array</code> contains all the numbers read.</p>\n\n<p>Here is the <a href=\"http://ideone.com/xx912C\" rel=\"nofollow noreferrer\">DEMO</a></p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501650022, "creation_date": 1501650022, "answer_id": 45451815, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c/45451815#45451815", "title": "Count and get integers from a string using C", "body": "<p>Example using <code>strtol</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;ctype.h&gt;\n\nint count_get_ints(int output[], int output_size, const char *input) {\n    const char *p = input;\n    int cnt;\n\n    for(cnt = 0; cnt &lt; output_size &amp;&amp; *p; ++cnt){\n        char *endp;\n        long n;\n        errno = 0;\n        n = strtol(p, &amp;endp, 10);\n        if(errno == 0 &amp;&amp; (isspace((unsigned char)*endp) || !*endp) &amp;&amp; INT_MIN &lt;= n &amp;&amp; n &lt;= INT_MAX){\n            output[cnt] = n;\n            while(isspace((unsigned char)*endp))\n                ++endp;//skip spaces\n            p = endp;//next parse point\n        } else {\n            fprintf(stderr, \"invalid input '%s' in %s\\n\", p, __func__);\n            break;\n        }\n    }\n    return cnt;\n}\n\nint main(void) {\n    const char *input = \"1 2 11 84384 0 212\";\n    int data[10000];\n    int n = sizeof(data)/sizeof(*data);//number of elements of data\n\n    n = count_get_ints(data, n, input);\n    for(int i = 0; i &lt; n; ++i){\n        if(i)\n            printf(\", \");\n        printf(\"%d\", data[i]);\n    }\n    puts(\"\");\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4208785, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40edd124b330771c0983fc5b1f98b9f7?s=128&d=identicon&r=PG&f=1", "display_name": "kkard", "link": "https://stackoverflow.com/users/4208785/kkard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 0, "answer_count": 6, "score": 0, "last_activity_date": 1501650381, "creation_date": 1501632788, "question_id": 45449504, "link": "https://stackoverflow.com/questions/45449504/count-and-get-integers-from-a-string-using-c", "title": "Count and get integers from a string using C", "body": "<p>I am self teaching C programming. \nI am trying to count number of int present in given string which are separated by space.</p>\n\n<p>exp:\ninput str = \"1 2 11 84384 0 212\"\noutput should be: 1, 2, 11, 84384, 0, 212 \ntotal int = 6</p>\n\n<p>When I try. It gives me all the digits as output which make sense since I am not using a right approach here.</p>\n\n<p>I know in python I can use str.split (\" \") function which can do my job very quickly.</p>\n\n<p>But I want to try something similar in C. Trying to create my own split method.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nvoid count_get_ints(const char *data) {\n    int buf[10000];\n    int cnt = 0, j=0;\n    for (int i=0; i&lt;strlen(data); i++) {\n        if (isspace(data[i] == false)\n            buf[j] = data[i]-'0';\n            j++;\n    }\n    printf(\"%d\", j);\n\n}\n\n// when I check the buffer it includes all the digits of the numbers.\n// i.e for my example.\n// buf = {1,2,1,1,8,4,3,8,4,0,2,1,2} \n// I want buf to be following \n// buf = {1,2,11,84384,0,212}\n</code></pre>\n\n<p>I know this is not a right approach to solve this problem. One way to keep track of prev and dynamically create a memory using number of non space digits encountered. \nBut I am not sure if that approach helps.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1501632427, "post_id": 45449433, "comment_id": 77860042, "body": "basically your question is how operation system works"}, {"owner": {"reputation": 593, "user_id": 8055011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m9gmF.jpg?s=128&g=1", "display_name": "Harshit Jindal", "link": "https://stackoverflow.com/users/8055011/harshit-jindal"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1501632487, "post_id": 45449433, "comment_id": 77860052, "body": "@IlyaBursov my question is how this particular code will be handled by the compiler, not how the operating system works"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1501632550, "post_id": 45449433, "comment_id": 77860068, "body": "compiler will generate calls to functions, provided by operating system, which can either send you symbol by symbol or have internall buffer and flush it to you when decided to do so, so yes, your question is how operating system works"}, {"owner": {"reputation": 593, "user_id": 8055011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m9gmF.jpg?s=128&g=1", "display_name": "Harshit Jindal", "link": "https://stackoverflow.com/users/8055011/harshit-jindal"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1501632766, "post_id": 45449433, "comment_id": 77860126, "body": "@IlyaBursov That did not answer my question. Also why downvote? What&#39;s wrong being curious about how OS works? Isn&#39;t it the right platform to ask about that topic? I&#39;m new here, so I&#39;d be glad to have help and suggestions"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1501632833, "post_id": 45449433, "comment_id": 77860137, "body": "<a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1501633005, "post_id": 45449433, "comment_id": 77860184, "body": "actually <a href=\"https://stackoverflow.com/help/dont-ask\">stackoverflow.com/help/dont-ask</a> <code>Your questions should be reasonably scoped. If you can imagine an entire book that answers your question, you\u2019re asking too much.</code>"}, {"owner": {"reputation": 593, "user_id": 8055011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m9gmF.jpg?s=128&g=1", "display_name": "Harshit Jindal", "link": "https://stackoverflow.com/users/8055011/harshit-jindal"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1501633078, "post_id": 45449433, "comment_id": 77860202, "body": "@IlyaBursov Okay I understand. That&#39;s fair"}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 1, "creation_date": 1501633215, "post_id": 45449433, "comment_id": 77860241, "body": "@HarshitJindal: The short answer is, if you&#39;re typing at the terminal, then by default one chunk of input will be sent to your program every time you hit Enter. The &quot;balance&quot; isn&#39;t particularly relevant, since your loop will probably finish processing that input before your finger is off the Enter key again. You can confirm this by adding strategically placed output functions in your loop, so you can see when it&#39;s working."}, {"owner": {"reputation": 593, "user_id": 8055011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m9gmF.jpg?s=128&g=1", "display_name": "Harshit Jindal", "link": "https://stackoverflow.com/users/8055011/harshit-jindal"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1501633432, "post_id": 45449433, "comment_id": 77860305, "body": "@PaulGriffiths That seems to answer my question. I&#39;ll try adding output functions to see how it works and get back here if I have any further query. Thanks"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1501649586, "post_id": 45449433, "comment_id": 77864426, "body": "You might find some useful information in <a href=\"https://stackoverflow.com/questions/358342/canonical-vs-non-canonical-terminal-input\">Canonical vs non-canonical terminal input</a>."}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 8055011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m9gmF.jpg?s=128&g=1", "display_name": "Harshit Jindal", "link": "https://stackoverflow.com/users/8055011/harshit-jindal"}, "edited": false, "score": 1, "creation_date": 1501633587, "post_id": 45449555, "comment_id": 77860339, "body": "thank you. i understood that. a simple and valid answer"}], "tags": [], "owner": {"reputation": 5464, "user_id": 59527, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5728955f444a62bbba61ba09690c50ab?s=128&d=identicon&r=PG", "display_name": "Sijmen Mulder", "link": "https://stackoverflow.com/users/59527/sijmen-mulder"}, "is_accepted": true, "score": 2, "last_activity_date": 1501633327, "creation_date": 1501633327, "answer_id": 45449555, "question_id": 45449433, "link": "https://stackoverflow.com/questions/45449433/how-does-the-o-s-process-terminal-input-for-c-code/45449555#45449555", "title": "How does the o/s process terminal input for C code?", "body": "<p>As the commenters pointed out this question is essentially asking how the operating system implements input and output because your <code>getchar()</code> call will likely end up as a system call (a function in kernel space).</p>\n\n<p>A bird\u2019s eye view of how an operating system might implement such a call, without buffering, is like this: the OS will put your thread in a waiting state and run other other things on the CPU. When a key is pressed, the driver will let the OS know which will decide where to route it to, in this case your program. It will wake the program up from its waiting state and return the key code from the syscall.</p>\n\n<p>The magic here is the ability of processors to put an entire program on hold (while it waits), do something else, and restore it again later.</p>\n\n<p>Real operating systems will implement forms of buffering, perhaps in the kernel but also in the standard library where <code>getchar()</code> is implemented on top of the syscall. There will be layers of abstraction and redirection. For example, in C standard input and output streams are represented as files.</p>\n\n<p>(I\u2019m no operating system expert so please correct me if I made any grave mistakes.)</p>\n"}], "owner": {"reputation": 593, "user_id": 8055011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m9gmF.jpg?s=128&g=1", "display_name": "Harshit Jindal", "link": "https://stackoverflow.com/users/8055011/harshit-jindal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 45449555, "answer_count": 1, "score": 1, "last_activity_date": 1501649425, "creation_date": 1501632283, "last_edit_date": 1501649425, "question_id": 45449433, "link": "https://stackoverflow.com/questions/45449433/how-does-the-o-s-process-terminal-input-for-c-code", "title": "How does the o/s process terminal input for C code?", "body": "<p><strong>Introduction:</strong> I've been following K&amp;R as my guide suggested. I came across the following code and I've been trying to figure out what's actually going on in the background.</p>\n\n<p><strong>Code:</strong> <br></p>\n\n<pre><code>// Program to count lines, words and characters in input\n\n#include &lt;stdio.h&gt;\n\n#define IN 1        // inside a word\n#define OUT 0       // outside a word\n\nint main()\n{\n    int c, nl, nw, nc, state;\n\n    state = 0;\n    nl = nw = nc = 0;\n    while ((c = getchar()) != EOF)\n           {\n               ++nc;            // increment newchar count\n               if (c == '\\n')\n                   ++nl;        // increment newline count\n               if (c == ' ' || c == '\\n' || c == '\\t')\n                   state = OUT;\n               else if (state == OUT)\n               {\n                   state = IN;\n                   ++nw;        // increment newword count\n               }\n           }\n\n    printf(\"%d  %d  %d\\n\", nl, nw, nc);\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Question:</strong> I understand that after typing in the input, Ctrl+D(Linux/Mac Based OS) is needed to insert the EOF character which finally breaks the code out of the while loop to print the output, but what I'm unable to figure out is that what's happening in the background while I'm typing the input. <strong>Is the input being processed simultaneously and just waiting for Ctrl+D (EOF character) to print the output, or is all the input processed after Ctrl+D is processed.</strong></p>\n\n<p>In the former way, the processing power should the balanced but the latter way puts the entire load on the processor at once, and that's the reason I want to know how it's working.</p>\n"}, {"tags": ["c", "visual-c++", "utf-8", "wchar-t"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1501632369, "post_id": 45449346, "comment_id": 77860027, "body": "On Windows, <code>printf()</code> (and the console in general) does not support UTF-8. You could use <code>WideCharToMultiByte()</code> (or equivalent) to convert UTF-16 encoded <code>wchar_t</code> data to UTF-8, but that is still no guarantee the console will display it correctly. You really should be writing Unicode data to the console using Unicode console APIs, like the Win32 <code>WriteConsoleW()</code> function, or <code>std::wcout</code> in C++. There are plenty of questions on StackOverflow on how to output Unicode data to a Windows console. Your reputation is high enough that you should have known to do some research before asking."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1501632473, "post_id": 45449346, "comment_id": 77860050, "body": "You can also run the PowerShell IDE and navigate to your program&#39;s directory, then run your program."}, {"owner": {"reputation": 29569, "user_id": 863980, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ea08c9063ae1de86e8d576fb569d513a?s=128&d=identicon&r=PG", "display_name": "vulcan raven", "link": "https://stackoverflow.com/users/863980/vulcan-raven"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1501633181, "post_id": 45449346, "comment_id": 77860227, "body": "@RemyLebeau, thanks. I will give <code>WideCharToMultiByte()</code> and other Unicode console APIs a try. I did some research but got lost in product versioning (e.g. since VS2015, the inclusion of vsnprintf OOTB etc.). Will read some more. :)"}, {"owner": {"reputation": 29569, "user_id": 863980, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ea08c9063ae1de86e8d576fb569d513a?s=128&d=identicon&r=PG", "display_name": "vulcan raven", "link": "https://stackoverflow.com/users/863980/vulcan-raven"}, "edited": false, "score": 0, "creation_date": 1501633272, "post_id": 45449346, "comment_id": 77860259, "body": "@ChronoKitsune, the same executable outputs <code>This string should have &#39;&#196;T&#39; (e with ogonek &#47; tail) after colon:  e</code> in PS."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1501633274, "post_id": 45449346, "comment_id": 77860260, "body": "@vulcanraven: If you write to the console using Unicode APIs, you <i>don&#39;t</i> need to use <code>WideCharToMultiByte()</code> to convert your Unicode data to another encoding.  Unicode APIs on Windows take <code>wchar_t</code> data as input."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1501633696, "post_id": 45449346, "comment_id": 77860362, "body": "@vulcanraven: this is the kind of situation where you should wrap your logging code in a custom function that takes Unicode strings as input and then writes them to the console according to the needs of the underlying platform - as UTF-8 on Ubunto, as UTF-16 on Windows, etc."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501641130, "post_id": 45449346, "comment_id": 77862122, "body": "If the locale setting appears wrong the first thing to check is the return value of <code>setlocale(LC_CTYPE, &quot;en_US.UTF-8&quot;);</code>  Was that <code>NULL</code>?   &quot;If the selection cannot be honored, the setlocale function returns a null pointer and the program\u2019s locale is not changed.&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1501641254, "post_id": 45449346, "comment_id": 77862153, "body": "@RemyLebeau The lack of support with &quot;On Windows, printf() (...) does not support UTF-8.&quot; is a compiler issue, not an OS issue."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501641414, "post_id": 45449346, "comment_id": 77862190, "body": "@chux: <code>printf</code> is a C runtime function, not a compiler function, but either way it ultimately calls platform APIs for the actual output, and the console APIs on Windows simply do not support UTF-8"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1501643445, "post_id": 45449346, "comment_id": 77862649, "body": "@RemyLebeau Hmm, <code>int main() {   printf(&quot;%p\\n&quot;, setlocale(LC_CTYPE, &quot;en_US.UTF-8&quot;));   putwchar(0x0119);   puts(&quot;&quot;); }</code> prints <code>0x1801fca20 \u0119</code> on my windows machine <code>cmd.exe</code> console.  Certainly looks like UTF-8 support."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1501643789, "post_id": 45449346, "comment_id": 77862739, "body": "@chux: that does not prove UTF-8 is being used. <code>putwchar()</code> takes a <code>wchar_t</code> as input and is simply required to write it to the console, it very well could be using Microsoft&#39;s <code>wchar_t</code> based console API, which would be natural on Windows, no conversion to UTF-8 needed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1501646326, "post_id": 45449346, "comment_id": 77863385, "body": "@RemyLebeau Fair point."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1501647067, "post_id": 45449346, "comment_id": 77863589, "body": "@RemyLebeau I re-direct the program&#39;s output to a file with <code>foo &gt; t</code> and then dumped the file&#39;s 15-byte contents: <code>30 78 31 38 30 31 66 63 61 32 30 0a c4 99 0a</code>  The <code>c4 99</code> is certainly <a href=\"http://www.fileformat.info/info/unicode/char/0119/index.htm\" rel=\"nofollow noreferrer\">UTF-8</a> for LATIN SMALL LETTER E WITH OGONEK"}], "answers": [{"tags": [], "owner": {"reputation": 29569, "user_id": 863980, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ea08c9063ae1de86e8d576fb569d513a?s=128&d=identicon&r=PG", "display_name": "vulcan raven", "link": "https://stackoverflow.com/users/863980/vulcan-raven"}, "is_accepted": false, "score": 0, "last_activity_date": 1501678042, "creation_date": 1501678042, "answer_id": 45461313, "question_id": 45449346, "link": "https://stackoverflow.com/questions/45449346/wchar-t-with-utf8-chars-in-msvc/45461313#45461313", "title": "wchar_t* with UTF8 chars in MSVC", "body": "<p>Based on @RemyLebeau's comment, I modified the code to use <code>w</code> variant of the printf APIs to get the output identical with msvc on Windows, matching that of gcc on Unix.</p>\n\n<p>Additionally, instead of changing codepage, I have now used <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/setmode\" rel=\"nofollow noreferrer\"><code>_setmode</code></a> (<code>FILE</code> translation mode).</p>\n\n<pre><code>/*\n  This code is modified version of KB sample:\n  https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_73/rtref/vsnprintf.htm\n\n  The usage of `setlocale` is required by my real-world scenario,\n  but can be modified if that fixes the issue.\n*/\n\n#include &lt;wchar.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n\n#ifdef _WIN32\n#include &lt;io.h&gt; //for _setmode\n#include &lt;fcntl.h&gt; //for _O_U16TEXT\n#endif\n\nvoid vout(wchar_t *string, wchar_t *fmt, ...)\n{\n   setlocale(LC_CTYPE, \"en_US.UTF-8\");\n   va_list arg_ptr;\n\n   va_start(arg_ptr, fmt);\n   vswprintf(string, 100, fmt, arg_ptr);\n   va_end(arg_ptr);\n}\n\nint main(void)\n{\n   setlocale(LC_ALL, \"\");\n#ifdef _WIN32\n   int oldmode = _setmode(_fileno(stdout), _O_U16TEXT);\n#endif\n\n   wchar_t string[100];\n\n   wchar_t arr[] = { 0x0119, L'\\0' };\n   vout(string, L\"%ls\", arr);\n   wprintf(L\"This string should have '\u0119' (e with ogonek / tail) after colon:  %ls\\r\\n\", string);\n\n#ifdef _WIN32\n   _setmode(_fileno(stdout), oldmode);\n#endif\n   return 0;\n}\n</code></pre>\n\n<p>Alternatively, we can use <code>fwprintf</code> and provide <code>stdout</code> as first argument. To do the same with <code>fwprintf(stderr,format,args)</code> (or <code>perror(format, args)</code>), we would need to <code>_setmode</code> the <code>stderr</code> as well.</p>\n"}], "owner": {"reputation": 29569, "user_id": 863980, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ea08c9063ae1de86e8d576fb569d513a?s=128&d=identicon&r=PG", "display_name": "vulcan raven", "link": "https://stackoverflow.com/users/863980/vulcan-raven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1501678042, "creation_date": 1501631673, "question_id": 45449346, "link": "https://stackoverflow.com/questions/45449346/wchar-t-with-utf8-chars-in-msvc", "title": "wchar_t* with UTF8 chars in MSVC", "body": "<p>I am trying to format <code>wchar_t*</code> with UTF-8 characters using <code>vsnprintf</code> and then printing the buffer using <code>printf</code>.</p>\n\n<p>Given the following code:</p>\n\n<pre><code>/*\n  This code is modified version of KB sample:\n  https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_73/rtref/vsnprintf.htm\n\n  The usage of `setlocale` is required by my real-world scenario,\n  but can be modified if that fixes the issue.\n*/\n\n#include &lt;wchar.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n\n#ifdef MSVC\n#include &lt;windows.h&gt;\n#endif\n\nvoid vout(char *string, char *fmt, ...)\n{\n   setlocale(LC_CTYPE, \"en_US.UTF-8\");\n   va_list arg_ptr;\n\n   va_start(arg_ptr, fmt);\n   vsnprintf(string, 100, fmt, arg_ptr);\n   va_end(arg_ptr);\n}\n\nint main(void)\n{\n   setlocale(LC_ALL, \"\");\n#ifdef MSVC\n   SetConsoleOutputCP(65001); // with or without; no dice\n#endif\n\n   char string[100];\n\n   wchar_t arr[] = { 0x0119 };\n   vout(string, \"%ls\", arr);\n   printf(\"This string should have '\u0119' (e with ogonek / tail) after colon:  %s\\n\", string);\n   return 0;\n}\n</code></pre>\n\n<p>I compiled with gcc v5.4 on Ubuntu 16 to get the desired output in BASH:</p>\n\n<pre><code>gcc test.c -o test_vsn\n./test_vsn\nThis string should have '\u0119' (e with ogonek / tail) after colon:  \u0119\n</code></pre>\n\n<p>However, on Windows 10 with CL v19.10.25019 (VS 2017), I get weird output in CMD:</p>\n\n<pre><code>cl test.c /Fetest_vsn /utf-8\n.\\test_vsn\nThis string should have 'T' (e with ogonek / tail) after colon:  e\n</code></pre>\n\n<p>(the <code>\u0119</code> before colon becomes <code>T</code> and after the colon is <code>e</code> without ogonek)</p>\n\n<p>Note that I used CL's new <code>/utf-8</code> switch (introduced in VS 2015), which apparently has no effect with or without. Based on their <a href=\"https://blogs.msdn.microsoft.com/vcblog/2016/02/22/new-options-for-managing-character-sets-in-the-microsoft-cc-compiler/\" rel=\"nofollow noreferrer\">blog post</a>:</p>\n\n<blockquote>\n  <p>There is also a /utf-8 option that is a synonym for setting \u201c/source-charset:utf-8\u201d and \u201c/execution-charset:utf-8\u201d.</p>\n</blockquote>\n\n<p>(my source file already has BOM / utf8'ness and execution-charset is apparently not helping)</p>\n\n<p>What could be the minimal amount of changes to the code / compiler switches to make the output look identical to that of gcc?</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 2, "creation_date": 1501628127, "post_id": 45448840, "comment_id": 77858888, "body": "Initialize the mutex <code>pthread_mutex_t mutex;</code> --&gt; <code>pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1501628400, "post_id": 45448840, "comment_id": 77858960, "body": "these: <code>void *A(); void *B(); void *C();</code> are not valid thread function signatures;  They should be: void *A( void *pData ); void *B( void *pData ); void *C( void *pData );`"}, {"owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "edited": false, "score": 0, "creation_date": 1501628421, "post_id": 45448840, "comment_id": 77858966, "body": "No warnings or errors."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1501628508, "post_id": 45448840, "comment_id": 77858997, "body": "Once this kind of line: <code>pthread_exit(0);</code> is executed, no code after it in that that thread will be executed, so each thread has some unreachable code.  BTW: that parameter should be: <code>NULL</code>, not <code>0</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501628521, "post_id": 45448840, "comment_id": 77859002, "body": "For pity&#39;s sake, write the functions so that they match what <code>pthread_create()</code> expects.  They can then ignore the argument, or check that it is NULL.  The casts in the <code>pthread_create()</code> calls should be making you feel sick."}, {"owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "edited": false, "score": 0, "creation_date": 1501628602, "post_id": 45448840, "comment_id": 77859033, "body": "To be honest, they do! Haha professor&#39;s recommendation to copy format of some previous code for those create functions."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501628733, "post_id": 45448840, "comment_id": 77859064, "body": "When compiling, always enable all the warnings, then fix those warnings. (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion, -std=gnu11</code> )"}, {"owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501628878, "post_id": 45448840, "comment_id": 77859108, "body": "@user3629249 Here&#39;s how I am compiling: &#39;gcc -o scholarship scholarship.c -lpthread -lm&#39; so after that, I include those suggested warnings?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1501628907, "post_id": 45448840, "comment_id": 77859117, "body": "there is a logic problem in the posted code.  the threads call <code>pthread_exit()</code> before unlocking the mutex"}, {"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 0, "creation_date": 1501628940, "post_id": 45448840, "comment_id": 77859125, "body": "@Nathan1324 really no warnings. I don&#39;t believe so. Are you compiling with JVM!!. That return in your function A&quot;<code>printf(&quot;Thread A exited\\n&quot;);             return;</code>&quot; alone should make the gcc compiler vomit"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501630841, "post_id": 45448840, "comment_id": 77859642, "body": "the linker options need to be on the end of the command line.  Suggest: <code>gcc -c -ggdb -Wall -Wextra -pedantic -Wconversion -std=gnu11   -o scholarship.o  scholarship.c -I.</code>  to compile the code, then the next command should be: `gcc -ggdb  scholarship.o -o scholarship   -lpthread"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501630929, "post_id": 45448840, "comment_id": 77859671, "body": "Note: nothing in the <code>math.h</code> header file is being used, so should remove the statement: <code>#include &lt;math.h&gt;</code>  and when linking do not use the <code>-lm</code> option"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501631073, "post_id": 45448840, "comment_id": 77859712, "body": "@user3629249: the <code>ceil()</code> function is declared in <code>&lt;math.h&gt;</code> (so that header is needed).  The <code>sleep()</code> function is declared in <code>&lt;unistd.h&gt;</code> (so that header should be added)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501722116, "post_id": 45448840, "comment_id": 77907257, "body": "@JonathanLeffler,  Your right,  I was so enamored by all the obvious problems that (my eye) skipped right over the calls to <code>ceil()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 2, "creation_date": 1501629068, "post_id": 45448923, "comment_id": 77859158, "body": "The mutex should be unlocked before the <code>pthread_exit()</code> call (which never returns). The <code>printf()</code> and <code>return</code> are never executed in this <code>if</code> statement."}, {"owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "edited": false, "score": 0, "creation_date": 1501629270, "post_id": 45448923, "comment_id": 77859203, "body": "Thank you! This allowed the program to run to completion."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1501657551, "post_id": 45448923, "comment_id": 77868237, "body": "@hedgar2017: pthreads don&#39;t have to be terminated using <code>[thread_exit()</code> - you can simply return from the thread function.  However, regardless of how you terminate the thread, it needs to clean up any necessary resources (such as mutexes that are being held)."}], "tags": [], "owner": {"reputation": 886, "user_id": 8170773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b971ec934427a008d8b263ad4142b9?s=128&d=identicon&r=PG&f=1", "display_name": "hedgar2017", "link": "https://stackoverflow.com/users/8170773/hedgar2017"}, "is_accepted": false, "score": 2, "last_activity_date": 1501628549, "creation_date": 1501628549, "answer_id": 45448923, "question_id": 45448840, "link": "https://stackoverflow.com/questions/45448840/multithreaded-c-program-threads-not-terminating/45448923#45448923", "title": "Multithreaded (C) program threads not terminating", "body": "<p>You should unlock mutexes before returns.</p>\n\n<pre><code>if( scholarship &lt; 1){\n    pthread_exit(0);\n    printf(\"Thread A exited\\n\");\n    return;\n}\npthread_mutex_unlock(&amp;mutex);\n</code></pre>\n\n<p>Those mutexes are never unlocked. Put a</p>\n\n<pre><code>pthread_mutex_unlock(&amp;mutex);\n</code></pre>\n\n<p>before</p>\n\n<pre><code>return;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501631109, "post_id": 45449044, "comment_id": 77859721, "body": "a good step in the right direction.   In general, when programming in C, write the functions per the <code>man</code> page for the function, rather than trying to &#39;shortcut&#39; those details that your code is not using."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501631291, "post_id": 45449044, "comment_id": 77859762, "body": "these code lines `    pthread_exit(0);     return;` are wrong.  the <code>return</code> statement will never be executed as it is unreachable code.  The call to <code>pthread_exit()</code> exits the thread, so (as indicated in a previous comment) those two lines need to be reduced to <code>pthread_exit( NULL );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501631444, "post_id": 45449044, "comment_id": 77859805, "body": "As previously indicated, the prototype for a thread function is: <code>void * function( void *pData )</code>   It is best to NOT use implicit conversions nor the side effects of a function with an empty parameter list"}], "tags": [], "owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "is_accepted": false, "score": 1, "last_activity_date": 1501629477, "creation_date": 1501629477, "answer_id": 45449044, "question_id": 45448840, "link": "https://stackoverflow.com/questions/45448840/multithreaded-c-program-threads-not-terminating/45449044#45449044", "title": "Multithreaded (C) program threads not terminating", "body": "<p>As suggested, the functions were incorrectly written in a manner that prevented the threads from exiting properly and the functions were not returning. To alleviate the program from hanging before completion I put the thread exit and return statement outside of the locked mutex, which allowed the program to execute to completion. </p>\n\n<pre><code>void *A(){\n    float result;\n    while(scholarship &gt; 0){\n        sleep(2);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * PERCENTAGE;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if( result &gt;= 1){\n            printf(\"A = \");\n            printf(\"%.2f\",result);\n            printf(\"\\n\");\n        }\n        pthread_mutex_unlock(&amp;mutex);\n    }\n\n    pthread_exit(0);\n    return;\n\n}\n\nvoid *B(){\n    float result;\n    while(scholarship &gt; 0){\n        sleep(1);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * PERCENTAGE;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if( result &gt;= 1){\n            printf(\"B = \");\n            printf(\"%.2f\",result);\n            printf(\"\\n\");\n        }           \n        pthread_mutex_unlock(&amp;mutex);\n    }\n\n    pthread_exit(0);\n    return;\n}\n\nvoid *C(){\n    float result;\n    while(scholarship &gt; 0){\n        sleep(1);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * PERCENTAGE;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if( result &gt;= 1){\n            printf(\"C = \");\n            printf(\"%.2f\",result);\n            printf(\"\\n\");\n        }           \n        pthread_mutex_unlock(&amp;mutex);       \n    }\n\n    pthread_exit(0);\n    return;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "edited": false, "score": 0, "creation_date": 1501629800, "post_id": 45449061, "comment_id": 77859341, "body": "That&#39;s so much more clear than what I wrote! Thanks for the help"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501722616, "post_id": 45449061, "comment_id": 77907345, "body": "the checking of the common variable <code>scholarship</code> to be greater than 0, when the mutex is not locked, results in a race condition.  Therefore, depending on exactly the order of execution, the code could result in spending more that the total of <code>scholarship</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501728408, "post_id": 45449061, "comment_id": 77908613, "body": "@user3629249: yes, you&#39;re right.  I had an amended but not fully checked version of the code with that fix in place, and some other changes too.  I&#39;ve more fully checked the code and included it into the answer now, along with a brief discussion of why.  There are various other changes in that version of the code too."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 5, "last_activity_date": 1501728307, "last_edit_date": 1501728307, "creation_date": 1501629589, "answer_id": 45449061, "question_id": 45448840, "link": "https://stackoverflow.com/questions/45448840/multithreaded-c-program-threads-not-terminating/45449061#45449061", "title": "Multithreaded (C) program threads not terminating", "body": "<p>You should not write the same function out 3 times \u2013 you can pass an argument to the thread function to give it different things to do.</p>\n\n<ul>\n<li>You should initialize your mutex.</li>\n<li>You should use one <code>printf()</code> statement instead of three in a row.</li>\n<li>You should unlock the mutex before you exit the thread function.</li>\n<li>You should print the status before you exit the function.</li>\n<li>You should return a value from the thread function when you write <code>return</code>.</li>\n<li>There's not much virtue in the <code>totalCalc()</code> function once you've collapsed it into a single <code>printf()</code> call.</li>\n<li>The term <code>PERCENTAGE</code> is a misnomer; it is a fraction, not a percentage.</li>\n</ul>\n\n<p>I chose to use <code>return</code> instead of calling <code>pthread_exit()</code>; the difference is not crucial.</p>\n\n<h3>First set of cleanups</h3>\n\n<p>Here's a revision to your code.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\n#define FRACTION 0.25\n\nstatic pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic int scholarship = 4000;\nstatic int total = 0;\nstatic void *calculate(void *data);\n\nstruct Data\n{\n    const char *name;\n    int doze;\n};\n\nint main(void)\n{\n    pthread_t tid1;\n    pthread_t tid2;\n    pthread_t tid3;\n    struct Data a = { \"A\", 2 };\n    struct Data b = { \"B\", 1 };\n    struct Data c = { \"C\", 1 };\n\n    pthread_create(&amp;tid1, NULL, calculate, &amp;a);\n    pthread_create(&amp;tid2, NULL, calculate, &amp;b);\n    pthread_create(&amp;tid3, NULL, calculate, &amp;c);\n    pthread_join(tid1, NULL);\n    pthread_join(tid2, NULL);\n    pthread_join(tid3, NULL);\n\n    printf(\"Total given out: %d\\n\", total);\n\n    return 0;\n}\n\nstatic void *calculate(void *arg)\n{\n    struct Data *data = arg;\n    float result;\n    while (scholarship &gt; 0)\n    {\n        sleep(data-&gt;doze);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * FRACTION;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if (result &gt;= 1)\n        {\n            printf(\"%s = %.2f\\n\", data-&gt;name, result);\n        }\n        if (scholarship &lt; 1)\n        {\n            printf(\"Thread %s exited\\n\", data-&gt;name);\n            pthread_mutex_unlock(&amp;mutex);\n            return 0;\n        }\n        pthread_mutex_unlock(&amp;mutex);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And sample output (on a Mac running macOS Sierra 10.12.6, using GCC 7.1.0):</p>\n\n<pre><code>B = 1000.00\nC = 750.00\nA = 563.00\nB = 422.00\nC = 317.00\nB = 237.00\nC = 178.00\nA = 134.00\nB = 100.00\nC = 75.00\nB = 56.00\nC = 42.00\nA = 32.00\nC = 24.00\nB = 18.00\nC = 13.00\nB = 10.00\nA = 8.00\nC = 6.00\nB = 4.00\nB = 3.00\nC = 2.00\nA = 2.00\nB = 1.00\nC = 1.00\nB = 1.00\nC = 1.00\nThread C exited\nThread A exited\nThread B exited\nTotal given out: 4000\n</code></pre>\n\n<hr>\n\n<h3>First phase improvement</h3>\n\n<p>Remember: working code can usually be improved.  Here's another revision of the <code>calculate()</code> function which has cleaner handling of the termination conditions.</p>\n\n<pre><code>static void *calculate(void *arg)\n{\n    struct Data *data = arg;\n    while (scholarship &gt; 0)\n    {\n        sleep(data-&gt;doze);\n        pthread_mutex_lock(&amp;mutex);\n        float result = ceil(scholarship * FRACTION);\n        total += result;\n        scholarship -= result;\n        if (result &gt;= 1)\n            printf(\"%s = %.2f\\n\", data-&gt;name, result);\n        pthread_mutex_unlock(&amp;mutex);\n    }\n    printf(\"Thread %s exited\\n\", data-&gt;name);\n\n    return 0;\n}\n</code></pre>\n\n<p>It still uses mixed-mode arithmetic (floating point and integer).  Further improvements would involve things like modifying the <code>main()</code> function to use arrays instead of separate variables for thread ID and control structures. You could then have 2-26 threads rather easily.  You might also use sub-second sleeps, too.  You might have different threads being differently generous with what's left of the grant money \u2014 instead of a fixed fraction, you could use different fractions in different threads.</p>\n\n<hr>\n\n<h3>All-singing, all-dancing version</h3>\n\n<p>There's one problem in both the previous versions (as pointed out by <a href=\"https://stackoverflow.com/users/3629249/user3629249\">user3629249</a> in a <a href=\"https://stackoverflow.com/questions/45448840/multithreaded-c-program-threads-not-terminating#comment77907345_45449061\">comment</a> \u2014 though I already had a preliminary version of the code with the necessary fix in it; it just wasn't on SO yet).  The code in the <code>calculate()</code> function accesses the shared variable <code>scholarship</code> without holding a mutex on it.  That shouldn't really be done.  Here's a version that handles that.  It also error checks the calls to the <code>pthread_*()</code> functions, reporting the error and exiting if there's a problem.  That's dramatic but adequate for test code.  The <code>stderr.h</code> header and supporting source code <code>stderr.c</code> can be found in <a href=\"https://github.com/jleffler/soq/tree/master/src/libsoq\" rel=\"nofollow noreferrer\">https://github.com/jleffler/soq/tree/master/src/libsoq</a>.  The error handling masks the operation of the code to some extent, but it is very similar to what was shown before.  The main change is that the mutex is locked before entering the loop, unlocked after exiting the loop, and unlocked before sleeping and relocked after waking.</p>\n\n<p>This code also uses random fractions instead of one fixed fraction, and random sub-second sleep times, and it has five threads instead of just three.  It uses arrays of control structures, initializing them as it needs to.  Printing the seed (the current time) is a nicety; it would allow you to reproduce the random sequence used if the program was upgraded to process command line arguments.  (There'd still be the indeterminacy from thread scheduling issues.)</p>\n\n<p>Note that the single calls to <code>printf()</code> improve the appearance of the output compared with the triple calls in the original.  The original code could (and did) interleave parts of lines from different threads.  With each <code>printf()</code> producing an entire line, that is no longer an issue.  You can look at <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/flockfile.html\" rel=\"nofollow noreferrer\"><code>flockfile()</code></a> and its friends to see what goes on \u2014 there's a sweeping statement in the specification which covers the rest of the I/O library functions.</p>\n\n<pre><code>/* SO 4544-8840 Multithreaded C program - threads not terminating */\n\n#include \"stderr.h\"     // https://github.com/jleffler/soq/tree/master/src/libsoq\n#include &lt;errno.h&gt;\n#include &lt;math.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic int scholarship = 4000;\nstatic int total = 0;\nstatic void *calculate(void *data);\n\nenum { MAX_THREADS = 5 };\nenum { MIN_PERCENT = 10, MAX_PERCENT = 25 };\n\nstruct Data\n{\n    char name[2];\n    struct timespec doze;\n    double fraction;\n};\n\nstatic inline double random_fraction(void)\n{\n    return (double)rand() / RAND_MAX;\n}\n\nstatic inline _Noreturn void err_ptherror(int rc, const char *fmt, ...)\n{\n    errno = rc;\n    va_list args;\n    va_start(args, fmt);\n    err_print(ERR_SYSERR, ERR_STAT, fmt, args);\n    va_end(args);\n    exit(EXIT_FAILURE);\n}\n\nint main(int argc, char **argv)\n{\n    err_setarg0(argv[argc-argc]);\n    pthread_t tids[MAX_THREADS];\n    struct Data ctrl[MAX_THREADS];\n    unsigned seed = time(0);\n    printf(\"Seed: %u\\n\", seed);\n    srand(seed);\n    int rc;\n\n    for (int i = 0; i &lt; MAX_THREADS; i++)\n    {\n        ctrl[i].name[0] = 'A' + i;\n        ctrl[i].name[1] = '\\0';\n        ctrl[i].doze.tv_sec = 0;\n        ctrl[i].doze.tv_nsec = 100000000 + 250000000 * random_fraction();\n        ctrl[i].fraction = (MIN_PERCENT + (MAX_PERCENT - MIN_PERCENT) * random_fraction()) / 100;\n        if ((rc = pthread_create(&amp;tids[i], NULL, calculate, &amp;ctrl[i])) != 0)\n            err_ptherror(rc, \"Failed to create thread %d\\n\", i);\n    }\n\n    for (int i = 0; i &lt; MAX_THREADS; i++)\n    {\n        if ((rc = pthread_join(tids[i], NULL)) != 0)\n            err_ptherror(rc, \"Failed to join thread %d\\n\", i);\n    }\n\n    printf(\"Total given out: %d\\n\", total);\n\n    return 0;\n}\n\nstatic void *calculate(void *arg)\n{\n    struct Data *data = arg;\n    printf(\"Thread %s: doze = 0.%03lds, fraction = %.3f\\n\",\n           data-&gt;name, data-&gt;doze.tv_nsec / 1000000, data-&gt;fraction);\n    int rc;\n    if ((rc = pthread_mutex_lock(&amp;mutex)) != 0)\n        err_ptherror(rc, \"Failed to lock mutex (1) in %s()\\n\", __func__);\n    while (scholarship &gt; 0)\n    {\n        if ((rc = pthread_mutex_unlock(&amp;mutex)) != 0)\n            err_ptherror(rc, \"Failed to unlock mutex (1) in %s()\\n\", __func__);\n        nanosleep(&amp;data-&gt;doze, NULL);\n        if ((rc = pthread_mutex_lock(&amp;mutex)) != 0)\n            err_ptherror(rc, \"Failed to lock mutex (2) in %s()\\n\", __func__);\n        double result = ceil(scholarship * data-&gt;fraction);\n        total += result;\n        scholarship -= result;\n        if (result &gt;= 1)\n            printf(\"%s = %.2f\\n\", data-&gt;name, result);\n    }\n    if ((rc = pthread_mutex_unlock(&amp;mutex)) != 0)\n        err_ptherror(rc, \"Failed to unlock mutex (2) in %s()\\n\", __func__);\n    printf(\"Thread %s exited\\n\", data-&gt;name);\n\n    return 0;\n}\n</code></pre>\n\n<p>You could still make a case for the code to be revised so it checks the scholarship amount after sleeping, breaking an infinite loop in the body of the loop.  Such changes are left as a minor exercise for the reader. </p>\n\n<p><strong>Example run</strong></p>\n\n<pre><code>Seed: 1501727930\nThread A: doze = 0.119s, fraction = 0.146\nThread B: doze = 0.199s, fraction = 0.131\nThread C: doze = 0.252s, fraction = 0.196\nThread D: doze = 0.131s, fraction = 0.102\nThread E: doze = 0.198s, fraction = 0.221\nA = 584.00\nD = 349.00\nE = 678.00\nB = 314.00\nA = 303.00\nC = 348.00\nD = 146.00\nA = 187.00\nD = 112.00\nE = 217.00\nB = 100.00\nA = 97.00\nC = 111.00\nD = 47.00\nE = 90.00\nA = 47.00\nB = 36.00\nD = 24.00\nA = 31.00\nC = 36.00\nD = 15.00\nE = 29.00\nB = 13.00\nA = 13.00\nD = 8.00\nA = 10.00\nE = 13.00\nB = 6.00\nC = 8.00\nD = 3.00\nA = 4.00\nD = 3.00\nE = 4.00\nB = 2.00\nA = 2.00\nC = 2.00\nD = 1.00\nA = 2.00\nE = 2.00\nB = 1.00\nA = 1.00\nD = 1.00\nThread D exited\nThread C exited\nThread A exited\nThread E exited\nThread B exited\nTotal given out: 4000\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 4380090, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NzzlG.jpg?s=128&g=1", "display_name": "Nathan1324", "link": "https://stackoverflow.com/users/4380090/nathan1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 0, "accepted_answer_id": 45449061, "answer_count": 3, "score": 3, "last_activity_date": 1501728307, "creation_date": 1501627926, "last_edit_date": 1501628518, "question_id": 45448840, "link": "https://stackoverflow.com/questions/45448840/multithreaded-c-program-threads-not-terminating", "title": "Multithreaded (C) program threads not terminating", "body": "<p>I am trying to finish up a program that uses multiple threads (3) to distribute a hypothetical scholarship of $4000. Each time a thread processes, it \"locks\" the \"critical section\" and blocks the other threads from taking out their chunk from the sum. With each access, the thread is meant to take 25% of the remaining sum of \"scholarship\" money. The output is the amount that each thread takes as it gains access to the scholarship. </p>\n\n<p>My program seems to be processing proper output so far, but when it gets to the end there seems to be a catch. Each process/thread gets to a point where it doesn't terminate or exit and the program just becomes stagnant and doesn't complete. I feel like the threads are processing but not meeting a terminating condition (scholarship is all gone). The last function totalCalc() is never reached. Does anyone see anything that I don't, which could help alleviate this problem or push the program to completion? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;math.h&gt;\n\n#define PERCENTAGE 0.25\n\npthread_mutex_t mutex; // protecting critical section\nint scholarship = 4000,\n                  total = 0;\nvoid *A();\nvoid *B();\nvoid *C();\nvoid *totalCalc();\n\nint main(){ \n\n    pthread_t tid1,\n              tid2,\n              tid3;\n\n    //pthread_setconcurrency(3); \n\n    pthread_create(&amp;tid1, NULL, (void *(*)(void *))A, NULL );\n    pthread_create(&amp;tid2, NULL, (void *(*)(void *))B, NULL );\n    pthread_create(&amp;tid3, NULL, (void *(*)(void *))C, NULL );\n    pthread_join(tid1,NULL);\n    pthread_join(tid2,NULL);\n    pthread_join(tid3,NULL);\n\n    totalCalc();\n\n\n    return 0;\n\n}\n\nvoid *A(){\n    float result;\n    while(scholarship &gt; 0){\n        sleep(2);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * PERCENTAGE;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if( result &gt;= 1){\n            printf(\"A = \");\n            printf(\"%.2f\",result);\n            printf(\"\\n\");\n        }\n        if( scholarship &lt; 1){\n            pthread_exit(0);\n            printf(\"Thread A exited\\n\");\n            return;\n        }\n        pthread_mutex_unlock(&amp;mutex);\n    }\n\n    pthread_exit(0);\n\n}\n\nvoid *B(){\n    float result;\n    while(scholarship &gt; 0){\n        sleep(1);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * PERCENTAGE;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if( result &gt;= 1){\n            printf(\"B = \");\n            printf(\"%.2f\",result);\n            printf(\"\\n\");\n        }\n        if( scholarship &lt; 1){\n            pthread_exit(0);\n            printf(\"Thread B exited\\n\");\n            return;\n        }           \n        pthread_mutex_unlock(&amp;mutex);\n    }\n\n    pthread_exit(0);\n}\n\nvoid *C(){\n    float result;\n    while(scholarship &gt; 0){\n        sleep(1);\n        pthread_mutex_lock(&amp;mutex);\n        result = scholarship * PERCENTAGE;\n        result = ceil(result);\n        total = total + result;\n        scholarship = scholarship - result;\n        if( result &gt;= 1){\n            printf(\"C = \");\n            printf(\"%.2f\",result);\n            printf(\"\\n\");\n        }\n        if( scholarship &lt; 1){\n            pthread_exit(0);\n            printf(\"Thread C exited\\n\");\n            return;\n        }           \n        pthread_mutex_unlock(&amp;mutex);       \n    }\n\n    pthread_exit(0);\n}\n\nvoid *totalCalc(){\n    printf(\"Total given out: \");\n    printf(\"%d\", total);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>B = 1000.00\nC = 750.00\nA = 563.00\nB = 422.00\nC = 317.00\nB = 237.00\nC = 178.00\nA = 134.00\nB = 100.00\nC = 75.00\nB = 56.00\nC = 42.00\nA = 32.00\nB = 24.00\nC = 18.00\nB = 13.00\nC = 10.00\nA = 8.00\nB = 6.00\nC = 4.00\nB = 3.00\nC = 2.00\nA = 2.00\nB = 1.00\nC = 1.00\nB = 1.00\nC = 1.00\n^C\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1501624696, "post_id": 45448234, "comment_id": 77857758, "body": "This is a candidate for the most horrible abuse of the <code>sscanf</code> and format strings I have ever seen."}, {"owner": {"reputation": 1064, "user_id": 2856552, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1a9a2cb2960580df2a7e0724a306c2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Zilore Mumba", "link": "https://stackoverflow.com/users/2856552/zilore-mumba"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501624815, "post_id": 45448234, "comment_id": 77857812, "body": "so you can correct me, I said am getting this from a tutorial."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 2, "creation_date": 1501625405, "post_id": 45448234, "comment_id": 77858031, "body": "The <code>fgets</code> line should be <code>while (fgets(buff, sizeof(buff), f1))</code> and the <code>sscanf</code> line should be something like <code>sscanf(buff, &quot; %i %i&quot;, &amp;year, &amp;month); for (i = 0; i &lt;= 31; i++) sscanf(buff, &quot; %f&quot;, &amp;temp[i][j]);</code> instead of...that.  Both more readable and handles whitespace better.   And you <i>might</i> want to find a different tutorial.  The rest of that code isn&#39;t <i>too</i> bad, but that sscanf line..."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1501625653, "post_id": 45448234, "comment_id": 77858125, "body": "As for the actual problem, could you post a couple lines of the data file and the error/results you&#39;re getting?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1501626779, "post_id": 45448234, "comment_id": 77858493, "body": "See <a href=\"http://stackoverflow.com/questions/3975236/how-to-use-sscanf-in-loops\">Using <code>sscanf()</code> in loops</a> for a discussion of how to use <code>sscanf()</code> in a loop.  What do you do with February&#39;s data, when there are at most 29 and usually only 28 entries \u2014 assuming a full month&#39;s data?  You should check the return value from <code>sscanf()</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501626840, "post_id": 45448234, "comment_id": 77858515, "body": "the posted code does not compile!  there compiler outputs several warning message and an error message on this function signature; <code>float min(float temp[][])</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501627065, "post_id": 45448234, "comment_id": 77858588, "body": "For ease of readability and understanding,  1) Consistently format the code. You could select your code then click the &#39;{}&#39; icon/button  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501627080, "post_id": 45448234, "comment_id": 77858590, "body": "&quot;am not able to see how to attach my data file&quot; --&gt; post a few lines of it then."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501627170, "post_id": 45448234, "comment_id": 77858609, "body": "regarding these two lines: <code>float maxt;     maxt=-99.;</code>   the variable <code>maxt</code> is declared as a <code>float</code>, but the literal <code>-99,</code> is a <code>double</code>.   Suggest replacing both lines with: <code>float maxt = -99.0f;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501627277, "post_id": 45448234, "comment_id": 77858637, "body": "in the function: <code>max()</code>, the variable &#39;j&#39; is being used without having been initialized to a known value.  Such usage of a uninitialized variable is undefined behavior and can lead to a seg fault event.  The same problem is shown in the <code>min()</code> function with its&#39; &#39;j&#39; variable."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1501627597, "post_id": 45448234, "comment_id": 77858750, "body": "the posted code contains some random &#39;back ticks&#39; in column 1, for instance on the line:  &quot;`   if (f2 == NULL)&quot; and on the line: &quot;`    return 0;&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1501627827, "post_id": 45448234, "comment_id": 77858803, "body": "Note that: <code>float max(float temp[][]); float min(float temp[][]);</code> is not acceptable C.  You can only omit the first dimension of the array; the others must be specified somehow.  Possibly as part of a VLA, possibly as a fixed size."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501628044, "post_id": 45448234, "comment_id": 77858870, "body": "Note that the best way to determine an initial value for the min/max in the functions is to save the element in <code>array[0]</code> as the initial guess, and then test the other entries against that:  <code>float mint = temp[0];    for (int i = 1; i &lt; 31; i++)  {   if (temp[i] &lt; mint)      mint = temp[i];  }</code>.  It&#39;s also unclear why you&#39;re passing a 2D array to the function since you never initialize <code>j</code>, let alone increment it."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1501691560, "post_id": 45448234, "comment_id": 77893451, "body": "Come on, man. You want others to read and assist. Make an effort to format your post, code and data, so it&#39;s readable."}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501702107, "post_id": 45469208, "comment_id": 77899727, "body": "Nobody pointed out the OP&#39;s fallacy of trying to read data out of a character array with sscanf the same way as of a FILE* with fscanf. Unfortunately, a string does not keep track of a reading position (that&#39;s actually an idea...), so all the sscanf read from the string&#39;s beginning. They probably (almost) all succeed, since one can read a float from a valid int string, and often vice versa. With all due respect I must say that I find your solution to read 33 values at once ... abhorrent. I would either demand C11 with string literal concatenation, or build the format string dynamically."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501702221, "post_id": 45469208, "comment_id": 77899804, "body": "Building the format string dynamically has the advantage of catering to the different month lengths because year (leap years!) and month are known at run time at that point.-- Of course otherwise a good answer with much too much work put into it..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501702392, "post_id": 45469208, "comment_id": 77899907, "body": "The 33-at-once is what the OP had in their code \u2014 and apart from trying to pass  a non-existent element of the array to <code>sscanf()</code> when there wasn&#39;t a format letter for it (a detail I forget to note before) \u2014 it was &#39;OK&#39;.  At least the code in the answer checks for plausibility from the return value of <code>sscanf()</code> rather than blithely assuming.  What&#39;s not so obvious was that the <code>%i</code> to <code>%d</code> change was only spotted because August&#39;s minimum was 8 and September&#39;s 9, which didn&#39;t seem plausible.  There are other changes that can be made to the code; it isn&#39;t a perfect solution."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501702549, "post_id": 45469208, "comment_id": 77900005, "body": "Agree on &#39;much too much work&#39; part.  But I started on it because it was a chance to write some data generating scripts that I&#39;d been meaning to get around to writing at some point.  They&#39;re not perfect, and not germane to the answer now that the OP has provided the sample data, but the whole was an excuse to do something I&#39;d been thinking about doing for N years (where N exceeds 1 by a considerable margin)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501703327, "post_id": 45469208, "comment_id": 77900466, "body": "@PeterA.Schneider: Hmm; your comments about <code>sscanf()</code> in a loop are on target \u2014 I just hadn&#39;t noticed that the OP had modified the code in the question.  I&#39;ve now identified what I was working from \u2014 <b>Thank You</b> for pointing out the issue.  I guess that if I&#39;d not seen the original, I&#39;d have written a different program, using <code>sscanf()</code> in a loop correctly.  I&#39;m not sure I&#39;ve got the energy left to add that alternative \u2014 I&#39;ll leave it as an exercise for the OP.  At least the code was using the <code>fgets()</code> plus <code>sscanf()</code> combination; that is crucial to sane operation."}, {"owner": {"reputation": 1064, "user_id": 2856552, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1a9a2cb2960580df2a7e0724a306c2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Zilore Mumba", "link": "https://stackoverflow.com/users/2856552/zilore-mumba"}, "edited": false, "score": 0, "creation_date": 1501707022, "post_id": 45469208, "comment_id": 77902518, "body": "my very sincere thanks @Jonathan Leffler  for the time and effort to provide a very comprehensive critique of my program and for providing a working version. I am able to compile and link the program, but the exe is not giving me any output. In time I will sort that out. (I am working in Windows 10) with codeblocks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501707167, "post_id": 45469208, "comment_id": 77902602, "body": "Most likely, you are expecting it to read from your file where this code reads from standard input.  You&#39;d need to run: <code>.&#47;program &lt; temp_data.txt</code> to feed it the information.  If you prefer (but you don&#39;t), you could type the data at the command line.  At least, typing <code>1999 12 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</code> on a line would show the program was reading input.  Or you can reinsert your file opening code and change the <code>fgets()</code> to read from the file you open."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501707313, "post_id": 45469208, "comment_id": 77902676, "body": "@Jonathan Re &quot;At least the code was using the fgets() plus sscanf() combination; that is crucial to sane operation&quot;: Well... because of the trouble with sscanf reading positions I prefer reading from files directly and then obviously like data which does not rely on lines because, to me and to scanf, all whitespace was created equal ;-). The OP&#39;s &quot;record end marker value&quot; of 999.9 idea isn&#39;t that bad but should be used for every line, and it would be nice to have a better value (but which? probably something non-numeric so that a numeric conversion fails)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501707848, "post_id": 45469208, "comment_id": 77902935, "body": "Btw, has anybody ever written a &quot;string device&quot; for a *nix? That should be a no-brainer (open, read, write, close, seek are all trivial). Much weirder things have bent to fit the &quot;everything is a file&quot; paradigm. That little wrapping and book keeping would make strings really look like any other input."}, {"owner": {"reputation": 1064, "user_id": 2856552, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1a9a2cb2960580df2a7e0724a306c2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Zilore Mumba", "link": "https://stackoverflow.com/users/2856552/zilore-mumba"}, "edited": false, "score": 0, "creation_date": 1501737662, "post_id": 45469208, "comment_id": 77911223, "body": "Exactly, I did not realise the program was waiting for data from stdin. When I introduced the data,it works perfectly. Once more thanks very much, it is a fantastic program"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1501703198, "last_edit_date": 1501703198, "creation_date": 1501701263, "answer_id": 45469208, "question_id": 45448234, "link": "https://stackoverflow.com/questions/45448234/my-declarations-and-definitions-of-functions-for-my-2d-array-data-are-not-workin/45469208#45469208", "title": "My declarations and definitions of functions for my 2D array data are not working", "body": "<h3>Critique based on Revision 3</h3>\n\n<p>There are numerous problems \u2014 I may not have recorded and reported them all in the list below.</p>\n\n<ul>\n<li>You open an output file and never use it. (Code removed.)</li>\n<li>You open a fixed-name input file \u2014 don't.  Read from standard input (as in the code below), or take a file name on the command line an open that.  Fixed names are unnecessarily restrictive.</li>\n<li>You use <code>%i</code> to read integers.  That's good if you aren't reading decimal numbers with leading zeros.  However, when <code>sscanf()</code> sees <code>08</code> with <code>%i</code>, it reads that as <code>0</code> because <code>8</code> is not a valid octal number.</li>\n<li>You didn't lay out the <code>sscanf()</code> code systemtically; that makes it unreadable, and unmaintainable.</li>\n<li>Your data uses <code>999.9</code> to indicate 'non-existent date'.  That's one way to do it, but it complicates the code enormously.</li>\n<li>You use your array cack-handed (and I'm speaking as a leftie myself).  You should have 12 rows (one per month) of 31 days, not 31 rows (one per day) of 12 months.  Hence <code>temp[12][31]</code> in the code.</li>\n<li>Doing that means you can pass one month's worth of data to the aggregate functions without having to futz with 2D array notations in the functions.</li>\n<li>Your function declarations wouldn't compile because you needed <code>max(float temp[][12]);</code> in your scheme.  You must provide the sizes of all array dimensions except the first.</li>\n<li>The replacement code below gets a single month's worth of data by passing <code>temp[month]</code> to the functions.</li>\n<li>It would be possible to simply omit the non-existent days (31st September; 30th and 31st February \u2014 since the year in the data was 2012, a leap year, February had 29 days that year).  When I was generating myself some test data (before you added yours), the same code was working happily with 28 entries for February, 30 for September, April, June and November, and 31 for the rest.  (That cuts down on the complexity of handling <code>999.9</code>.)</li>\n<li>It might be sensible to call <code>cnt()</code> first, and then pass that count to the other aggregate functions.  It would allow you to omit the dummy values more easily.  You could also verify that the dummy values are only at the end of each line.</li>\n<li>For determining the minimum and maximum, the code uses the first temperature (and asserts that it is not a dummy temperature) as the initial guess, and then checks the remaining temperatures against that.  This is usually the best way to deal with the 'initial value' problem.  It fails if a count of zero is permitted \u2014 the code should (but doesn't) assert against that.</li>\n<li>I added <code>avg()</code> to calculate the average for interest's sake.</li>\n<li>I added <code>cnt()</code> because it was necessary to discount the the dummy entries.</li>\n</ul>\n\n<hr>\n\n<h3>The question morphed</h3>\n\n<p>The version of the code I started from (<a href=\"https://stackoverflow.com/revisions/32eb7c9c-368f-4ae2-a202-14ce4ad36e98/view-source\">Revision 3</a> in the history) contained the statements:</p>\n\n<pre><code>j=0;\nwhile (fgets(buff, 300, f1) != NULL)\n{\nsscanf(buff,\"%i%i%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f\",\n       &amp;year,&amp;month,&amp;temp[0][j],&amp;temp[1][j],&amp;temp[2][j],&amp;temp[3][j],&amp;temp[4][j],&amp;temp[5][j],&amp;temp[6][j],&amp;temp[7][j],&amp;temp[8][j],&amp;temp[9][j],&amp;temp[10][j],\n       &amp;temp[11][j],&amp;temp[12][j],&amp;temp[13][j],&amp;temp[14][j],&amp;temp[15][j],&amp;temp[16][j],&amp;temp[17][j],&amp;temp[18][j],&amp;temp[19][j],&amp;temp[20][j],&amp;temp[21][j],\n       &amp;temp[22][j],&amp;temp[23][j],&amp;temp[24][j],&amp;temp[25][j],&amp;temp[26][j],&amp;temp[27][j],&amp;temp[28][j],&amp;temp[29][j],&amp;temp[30][j],&amp;temp[31][j]);\n\nfor(i = 0; i &lt; 31; i++)\n{\n/* calling a function to get max value */\nfloat maxt = max(temp);\nfloat mint = min(temp);\nprintf( \" %d Min=%5.1f Max=%5.1f\\n\", j, mint, maxt);\n}\nj=j+1\n}\n</code></pre>\n\n<p>I didn't notice that the code in the question had been rewritten since I took the snapshot.</p>\n\n<p>Additional issues:</p>\n\n<ul>\n<li>The <code>sscanf()</code> statement has a reference to <code>&amp;temp[31][j]</code> which doesn't exist as part of the array.  There isn't a conversion specification (<code>%f</code>) for it anyway.</li>\n<li>This is a messy way to write the code, but I retained it.</li>\n<li>The loops after the <code>sscanf()</code> are confusing, or confused.  Iterating 31 times to find the maximum is not appropriate; ditto the minimum.  There is a simple disconnect between requirements and implementation here.</li>\n</ul>\n\n<h3>Critique of later revisions</h3>\n\n<ul>\n<li>The attempted rewrite using <code>sscanf()</code> iteratively doesn't work.  To see what's required to make it work, consult <a href=\"http://stackoverflow.com/questions/3975236/how-to-use-sscanf-in-loops\">Using <code>sscanf()</code> in loops</a>.  The <code>%n</code> conversion specification is crucial to getting it to work sanely.</li>\n<li>My code preserves the original rather than trying to do the scan-in-a-loop logic.</li>\n</ul>\n\n<hr>\n\n<h3>Revised code</h3>\n\n<p>Here's the revised code \u2014 based on the Revision 3 outline:</p>\n\n<pre><code>/* SO 4544-8234 Daily temperatures */\n#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MIN_VALID_TEMP -100.0\n#define MAX_VALID_TEMP +300.0\n\nfloat max(int ndays, float temp[]);\nfloat min(int ndays, float temp[]);\nfloat avg(int ndays, float temp[]);\nint   cnt(int ndays, float temp[]);\n\nint main(void)\n{\n    float temp[12][31];\n    char buff[1000];\n\n    for (int j = 0; fgets(buff, 300, stdin) != NULL; j++)\n    {\n        int year, month;\n        int nf = sscanf(buff, \"%d%d%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f%f\",\n                   &amp;year, &amp;month,\n                   &amp;temp[j][ 0], &amp;temp[j][ 1], &amp;temp[j][ 2], &amp;temp[j][ 3],\n                   &amp;temp[j][ 4], &amp;temp[j][ 5], &amp;temp[j][ 6], &amp;temp[j][ 7],\n                   &amp;temp[j][ 8], &amp;temp[j][ 9], &amp;temp[j][10], &amp;temp[j][11],\n                   &amp;temp[j][12], &amp;temp[j][13], &amp;temp[j][14], &amp;temp[j][15],\n                   &amp;temp[j][16], &amp;temp[j][17], &amp;temp[j][18], &amp;temp[j][19],\n                   &amp;temp[j][20], &amp;temp[j][21], &amp;temp[j][22], &amp;temp[j][23],\n                   &amp;temp[j][24], &amp;temp[j][25], &amp;temp[j][26], &amp;temp[j][27],\n                   &amp;temp[j][28], &amp;temp[j][29], &amp;temp[j][30]);\n\n        assert(nf &gt;= 28 + 2 &amp;&amp; nf &lt;= 31 + 2);   // 28-31 days, plus year plus month\n        int ndays = nf - 2;\n        float maxt = max(ndays, temp[j]);\n        float mint = min(ndays, temp[j]);\n        float avgt = avg(ndays, temp[j]);\n        int count  = cnt(ndays, temp[j]);\n        printf(\"%.4d-%.2d: days = %d, min = %6.2f, avg = %6.2f, max = %6.2f\\n\", year, month, count, mint, avgt, maxt);\n    }\n    return 0;\n}\n\nfloat max(int ndays, float temp[])\n{\n    float maxt = temp[0];\n    assert(maxt &gt; MIN_VALID_TEMP &amp;&amp; maxt &lt; MAX_VALID_TEMP);\n    for (int i = 1; i &lt; ndays; i++)\n    {\n        if (temp[i] &gt; MIN_VALID_TEMP &amp;&amp; temp[i] &lt; MAX_VALID_TEMP)\n        {\n            if (temp[i] &gt; maxt)\n                maxt = temp[i];\n        }\n    }\n    return maxt;\n}\n\nfloat min(int ndays, float temp[])\n{\n    float mint = temp[0];\n    assert(mint &gt; MIN_VALID_TEMP &amp;&amp; mint &lt; MAX_VALID_TEMP);\n    for (int i = 1; i &lt; ndays; i++)\n    {\n        if (temp[i] &gt; MIN_VALID_TEMP &amp;&amp; temp[i] &lt; MAX_VALID_TEMP)\n        {\n            if (temp[i] &lt; mint)\n                mint = temp[i];\n        }\n    }\n    return mint;\n}\n\nfloat avg(int ndays, float temp[])\n{\n    float sum = 0;\n    int count = 0;\n    for (int i = 0; i &lt; ndays; i++)\n    {\n        if (temp[i] &gt; MIN_VALID_TEMP &amp;&amp; temp[i] &lt; MAX_VALID_TEMP)\n        {\n            count++;\n            sum += temp[i];\n        }\n    }\n    return sum / ndays;\n}\n\nint cnt(int ndays, float temp[])\n{\n    int count = 0;\n    for (int i = 0; i &lt; ndays; i++)\n    {\n        if (temp[i] &gt; MIN_VALID_TEMP &amp;&amp; temp[i] &lt; MAX_VALID_TEMP)\n            count++;\n    }\n    return count;\n}\n</code></pre>\n\n<p>On your sample data, the output I get is:</p>\n\n<pre><code>2012-01: days = 31, min =  27.50, avg =  30.44, max =  32.70\n2012-02: days = 29, min =  25.00, avg =  28.08, max =  33.00\n2012-03: days = 31, min =  23.50, avg =  30.76, max =  33.60\n2012-04: days = 30, min =  24.50, avg =  28.93, max =  32.60\n2012-05: days = 31, min =  26.80, avg =  29.68, max =  31.60\n2012-06: days = 30, min =  25.30, avg =  29.21, max =  32.20\n2012-07: days = 31, min =  28.80, avg =  30.88, max =  32.60\n2012-08: days = 31, min =  27.50, avg =  32.20, max =  34.80\n2012-09: days = 30, min =  25.00, avg =  30.21, max =  34.00\n2012-10: days = 31, min =  25.00, avg =  30.96, max =  33.10\n2012-11: days = 30, min =  25.70, avg =  28.33, max =  32.70\n2012-12: days = 31, min =  23.70, avg =  29.34, max =  32.60\n</code></pre>\n"}], "owner": {"reputation": 1064, "user_id": 2856552, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1a9a2cb2960580df2a7e0724a306c2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Zilore Mumba", "link": "https://stackoverflow.com/users/2856552/zilore-mumba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 45469208, "answer_count": 1, "score": 0, "last_activity_date": 1501703198, "creation_date": 1501624281, "last_edit_date": 1501699422, "question_id": 45448234, "link": "https://stackoverflow.com/questions/45448234/my-declarations-and-definitions-of-functions-for-my-2d-array-data-are-not-workin", "title": "My declarations and definitions of functions for my 2D array data are not working", "body": "<p>I have a data file containing 12 months of daily temperatures. I want the program to get the minimum and maximum temperature for each month using functions and printing in the main function. Somehow my function declarations and definitions are not accepted (following a tutorial I have). I tried to modify the program in the post here: <a href=\"https://stackoverflow.com/questions/27592636/using-a-2d-array-in-function-error\">Using a 2D Array in Function: Error</a>, my program gets worse.\nHelp needed.\nHere is the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n  /* function declarations */\nfloat max(float temp[][]);\nfloat min(float temp[][]);\n\nint main ()\n{\n    float maxt, temp[31][12];\n    int i, j, year, month;\n    char value, buff[1000];\n\n    FILE *f1;\n    FILE *f2;\n    f1=fopen(\"temp_data.txt\", \"r\");\n    f2=fopen(\"temp_out.txt\", \"w\");\n\n    if (f1 == NULL)\n    {\n        printf(\"Can't open file\\n\",f1);\n        return 1;\n    }\n\n    if (f2 == NULL)\n    {\n        printf(\"Can't open file\\n\",f2);\n        return 1;\n    }\n\n    j=0;\n    while (fgets(buff, sizeof(buff), f1))\n    {\n        sscanf(buff, \" %i %i\", &amp;year, &amp;month);\n        for (i = 0; i &lt;= 31; i++)\n        {\n          sscanf(buff, \" %f\", &amp;temp[i][j]);\n        }\n\n        for(i = 0; i &lt; 31; i++)\n        {\n            /* calling a function to get max value */\n            float maxt = max(temp);\n            float mint = min(temp);\n            printf( \" %d Min=%5.1f Max=%5.1f\\n\", j, mint, maxt);\n        }\n        j=j+1\n    }\n    return 0;\n}\n\n/* function returning the max of 31 temperatures */\nfloat max(float temp[][])\n{\n /* local variable declaration */\n float maxt;\n maxt=-99.;\n int i,j;\n for(i = 0; i &lt; 31; i++)\n {\n  if(temp[i][j] &gt; maxt)\n  {\n     maxt=temp[i][j];\n  }\n }\n return maxt;\n }\n\n/* function returning the max of 31 temperatures */\nfloat min(float temp[][])\n{\n /* local variable declaration */\n float mint;\n mint=99.;\n int i,j;\n for(i = 0; i &lt; 31; i++)\n {\n  if(temp[i][j] &lt; mint)\n  {\n     mint=temp[i][j];\n  }\n }\n return mint;\n }\n</code></pre>\n\n<p>Here is my data</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> 2012  01    29.6    32.2    32.5    32.7    31.0    28.0    29.6    30.0    32.0    30.5    32.0    27.5    27.8    30.0    30.5    28.6    30.5    29.0    29.7    30.0    32.2    31.6    29.5    31.0    31.5    30.0    29.5    32.0    32.3    32.5    27.7\n 2012  02    32.2    30.5    32.0    32.6    30.0    32.4    33.0    29.8    32.0    33.0    30.2    29.0    29.2    31.0    27.5    31.0    28.0    25.0    25.8    28.5    32.3    31.0    29.0    31.3    30.5    28.1    30.0    29.2    26.3   999.9   999.9\n 2012  03    23.5    30.5    30.8    30.2    29.7    30.0    29.0    28.3    31.8    31.3    31.6    31.4    32.0    33.5    31.6    33.0    33.4    32.7    30.6    32.5    30.5    33.0    32.5    30.0    23.7    28.3    29.5    32.0    33.6    33.5    29.5\n 2012  04    29.8    30.5    30.3    32.1    27.5    29.0    29.6    29.7    30.5    32.6    31.8    30.5    30.1    29.7    24.5    25.6    29.6    30.2    30.0    30.4    30.0    31.1    31.2    28.4    30.2    31.2    30.0    30.6    31.8    28.3   999.9\n 2012  05    30.2    28.4    30.7    26.8    27.6    29.8    29.0    27.5    30.0    27.0    27.2    30.5    29.5    28.7    29.8    29.5    30.7    30.8    30.5    31.5    29.0    30.6    31.6    30.5    30.7    31.0    30.8    29.5    29.0    30.6    31.0\n 2012  06    30.8    30.2    30.5    28.0    29.8    30.3    30.3    31.0    31.3    32.2    31.0    30.3    30.4    30.8    31.0    29.5    30.0    30.1    30.0    30.5    30.5    31.0    31.2    31.5    31.1    26.9    25.3    30.0    30.7    29.2   999.9\n 2012  07    28.8    31.3    32.0    31.5    30.7    30.9    30.5    31.3    31.5    32.6    31.3    31.1    31.2    31.0    30.5    32.0    32.5    30.7    30.2    30.4    31.0    31.4    31.6    30.6    30.7    30.0    28.8    29.1    30.8    31.0    30.2\n 2012  08    32.0    31.6    32.4    32.2    32.5    32.7    33.8    27.5    29.5    31.6    31.7    32.0    32.3    33.0    31.8    33.4    34.0    32.8    33.0    32.4    33.0    33.2    34.1    34.3    34.6    34.8    28.0    32.2    32.5    27.5    31.8\n 2012  09    33.0    30.4    29.5    31.6    31.8    30.2    31.0    32.0    29.0    25.0    31.4    28.8    29.0    30.6    30.3    31.0    32.2    30.0    31.0    32.1    33.5    33.2    34.0    33.0    32.4    31.0    31.2    32.4    32.8    33.0   999.9\n 2012  10    30.5    31.5    32.5    32.3    33.1    32.0    31.7    31.5    32.2    30.3    31.0    28.2    31.0    30.8    33.0    31.3    31.8    31.5    28.0    30.6    31.2    30.6    31.8    31.4    25.0    30.8    30.3    31.0    32.0    31.6    29.4\n 2012  11    29.0    28.0    29.8    28.6    26.7    29.5    25.7    31.5    27.0    29.4    30.0    32.7    32.5    30.7    29.5    29.6    29.0    30.0    29.0    28.5    28.8    29.6    28.1    28.8    28.5    29.3    30.7    28.0    29.5    30.3   999.9\n 2012  12    30.8    32.6    28.6    31.3    23.7    27.3    27.0    28.5    32.1    29.5    28.7    31.0    27.3    30.1    27.8    29.2    29.5    30.0    29.3    32.4    30.0    29.3    29.5    30.1    29.4    28.8    30.4    29.5    29.2    27.3    29.3\n</code></pre>\n\n<p>errors in function declarations: \"array type has incomplete element type\"\nerrors in function definitions: \"type of forma parameter 1 is incomplete\"\n\"two few arguments to function 'min', 'max'\" and \"conflicting types for 'min', 'max'\"\nalso 'j' undeclared here (not in a function</p>\n\n<p>Help will be appreciated.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "edited": false, "score": 0, "creation_date": 1501623848, "post_id": 45448121, "comment_id": 77857441, "body": "what exactly are you trying to achieve? Oh and, can you please format your code so it can be more easily readable..."}, {"owner": {"reputation": 3960, "user_id": 855395, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d2f0d32da67f0c84e41dc8928b7ce24?s=128&d=identicon&r=PG", "display_name": "Eran Zimmerman Gonen", "link": "https://stackoverflow.com/users/855395/eran-zimmerman-gonen"}, "edited": false, "score": 0, "creation_date": 1501623913, "post_id": 45448121, "comment_id": 77857462, "body": "Did you add a return statement in the code that didn&#39;t compile?"}, {"owner": {"reputation": 8848, "user_id": 2116168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjVAe.jpg?s=128&g=1", "display_name": "Elmar Peise", "link": "https://stackoverflow.com/users/2116168/elmar-peise"}, "edited": false, "score": 0, "creation_date": 1501624209, "post_id": 45448121, "comment_id": 77857571, "body": "Your function changes <code>s</code> in place.  It seems like you want it to return something instead.  What do you want it to return? Please show us your code that doesn&#39;t compile."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1501624472, "post_id": 45448121, "comment_id": 77857669, "body": "Could you make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and demonstrate what happens? Then explain what you do not like about it, i.e. show what you want as result."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501624621, "post_id": 45448121, "comment_id": 77857725, "body": "If you declare a function differently than <code>void ....</code> then you need to have a <code>return ...;</code> at the end. But you are aware of that, are you not? So what is the compiler error you get if you &quot;return an object char*&quot; ?"}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501624626, "post_id": 45448121, "comment_id": 77857727, "body": "Hi guys, I actually wanted to simply return s (the beginning of the string) but it doesn&#39;t work here is the version that does not work:     char* EraseWSbeforethefirstword(char <i>s) { char</i> p=s, <i>q=s; /</i> I have substitiutions for s <i>/ if(*p==&#39; &#39;) { /</i> if the first character is space than I need to get to the first non-space character <i>/     while (*p==&#39; &#39;) {          p++;     }  /</i> q is still the beginning and p is the beginning of the word */     while(*p!=&#39;\\0&#39;) {*q=*p; p++; q++;} /*copying the text */     *q=&#39;\\0&#39;;  /*if I had n spaces newstring has n characters less */ } return s; }"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1501624667, "post_id": 45448121, "comment_id": 77857745, "body": "Please edit additionall information into your question instead of hiding it in a comment."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501624725, "post_id": 45448121, "comment_id": 77857770, "body": "I am aware of that...I know I must have a &quot;return&quot; in a non-void function...but it doesn&#39;t work"}, {"owner": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "edited": false, "score": 0, "creation_date": 1501624778, "post_id": 45448121, "comment_id": 77857796, "body": "Please, can you edit your first post? Reading a whole function in a comment is just terrible..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1501624792, "post_id": 45448121, "comment_id": 77857802, "body": "<b>How</b> does it not work? You know you are pretty close to being off-topic as a &quot;why does my code not work&quot; question without decent explanation..."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501625043, "post_id": 45448121, "comment_id": 77857903, "body": "I modified the code, sorry for waiting...thank you very much I hope I&#39;ll  solve this with you..."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1501625131, "post_id": 45448121, "comment_id": 77857930, "body": "@Djule  There is operator !=. It is not the same as ! = (with an intermediate blank)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1501625152, "post_id": 45448121, "comment_id": 77857941, "body": "The lacking explanation is not how you think the code works, it is a description of the symptoms how it does <b>not</b> work. Quote the error message, describe the unwanted output in contrast to the desired output, maybe share your result of finding out where it crashes (if it does)..."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501625202, "post_id": 45448121, "comment_id": 77857960, "body": "I modified the first post and gave you explicit explanations what the code does..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1501625208, "post_id": 45448121, "comment_id": 77857963, "body": "@VladfromMoscow The broken operator is by an edit, not by OP. I fixed it, thanks for finding."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501625319, "post_id": 45448121, "comment_id": 77858003, "body": "Okay...just a second I&#39;ll give you the quote of the error"}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501625475, "post_id": 45448121, "comment_id": 77858060, "body": "/usr/local/webide/runners/c_runner.sh: line 54: 20533 Segmentation fault      nice -n 10 valgrind --leak-check=full --log-file=&quot;$valgrindout&quot; &quot;$exefile&quot;"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501625688, "post_id": 45448121, "comment_id": 77858137, "body": "Does it now work or not? If you cannot reproduce the error anymore, the question will get flagged and closed."}, {"owner": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1501625842, "post_id": 45448121, "comment_id": 77858189, "body": "As @VladfromMoscow pointed out, I think you&#39;re calling your function with a pointer to a string literal somewhere, and that&#39;s wrong... I suggest you take a break, think about what you want <i>exactly</i>, search on the internet and come back to it."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "reply_to_user": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "edited": false, "score": 0, "creation_date": 1501626048, "post_id": 45448121, "comment_id": 77858255, "body": "@ZeusInTexas that&#39;s the problem...but the tests are made by an unprofessional bachelor student so...Thank you very much for helping me I hope I didn&#39;t bother you too much..."}, {"owner": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "edited": false, "score": 0, "creation_date": 1501626105, "post_id": 45448121, "comment_id": 77858279, "body": "Well, here to help anyway so... it&#39;s fine ;)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501654391, "post_id": 45448121, "comment_id": 77866398, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501625935, "post_id": 45448430, "comment_id": 77858220, "body": "It says the problem is &quot;*q=&#39;\\0&#39;;&quot; when I remove that command then it says the problem is the line &quot;while(*p==&#39; &#39;)&quot;...I know how to make the code more estetically acceptable...It says the problem is &quot;while(*q++=*p++)&quot; if I write write it instead of my three-four lines of code that do the same"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501626029, "post_id": 45448430, "comment_id": 77858247, "body": "@Djule As you see in my function implementation there are used two pairs of parentheses."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501626178, "post_id": 45448430, "comment_id": 77858298, "body": "@Djule Or you can write instead while ( ( *q++ = *p++ ) != &#39;\\0&#39; );"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501626523, "post_id": 45448430, "comment_id": 77858415, "body": "@Djule: Are you running into problems with CRLF line endings in your source code but compilation on a Unix machine, or something similar?  Your description of the problem moving as you move code around sounds like a problem with the editing of the source code more than anything else.  Showing the exact error message you&#39;re getting from the compiler would help enormously.  You&#39;d need to show your best representation of the code and the error message from compiling it.  Maybe you need to identify which compiler and which platform (o/s, and maybe IDE) you are using."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501626752, "post_id": 45448430, "comment_id": 77858486, "body": "@JonathanLeffler it&#39;s okay now obviously it works when I call the function upon a variable (type char*) instead of string literal (this is not my fault, the student who made autotests didn&#39;t know he had to use variable instead of a literal. Once again, thank you very much."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501626866, "post_id": 45448430, "comment_id": 77858524, "body": "@Djule: Now you know why it&#39;s crucial to show an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  Had we seen a string literal being passed to your function, we&#39;d have known instantaneously how to enlighten you about the problem.  Glad it&#39;s resolved, but please remember for next time."}, {"owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501626936, "post_id": 45448430, "comment_id": 77858539, "body": "@JonathanLeffler Thank you very much. I&#39;m sorry I&#39;m new here. I just made my account like an hour ago. Thank you. Greetings."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "edited": false, "score": 0, "creation_date": 1501627051, "post_id": 45448430, "comment_id": 77858584, "body": "@Djule: Once upon a time, we were all new here.  For some of us, longer ago than for others.  There&#39;s an art to asking good questions here.  And the MCVE page and the <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages both help.  But understanding takes some time too."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501627343, "post_id": 45448430, "comment_id": 77858670, "body": "For a compact variant of the code, consider: <code>char *EraseLeadingWhiteSpace(char *str) { size_t len = strlen(str); size_t spc = strspn(str, &quot; \\t&quot;); memmove(str, str + spc, len + 1 - spc); return str; }</code>.  The one downside is that it scans the string 2+ times \u2014 once for <code>strlen()</code>, once for <code>memmove()</code>, and a partial scan for <code>strspn()</code> (unless the whole string is white space \u2014 then it is a third full scan).  You can add newlines etc to the list of characters to skip if you desire."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501627793, "post_id": 45448430, "comment_id": 77858793, "body": "On second thoughts: the <code>EraseLeadingWhiteSpace()</code> function above scans the string twice.  The <code>strlen()</code> scans it once; the <code>strspn()</code> scans the first part, and the <code>memmove()</code> scans the rest in a second pass, regardless of content."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501628312, "post_id": 45448430, "comment_id": 77858932, "body": "And one other option: you could simply return a pointer to the first non-white space character and use that from here onwards: <code>char *SkipLeadingWhiteSpace(char *str) { return str + strspn(str, &quot; \\t&quot;); }</code> with no copying.  This has the additional merit of working with character string literals.  You could make it take and return <code>const char *</code> too since it does not modify the string it is passed."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1501627573, "last_edit_date": 1501627573, "creation_date": 1501625274, "answer_id": 45448430, "question_id": 45448121, "link": "https://stackoverflow.com/questions/45448121/why-doesnt-pointer-arithmetic-work-in-char-functions/45448430#45448430", "title": "Why doesn&#39;t pointer arithmetic work in char* functions", "body": "<p>Here is a function implementation that has the return type <code>char *</code> as you want.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar *  EraseWSbeforethefirstword( char *s ) \n{\n    if ( *s == ' ' || *s == '\\t' )\n    {\n        char *p = s, *q = s;\n\n        while ( *p == ' ' || *p == '\\t' ) ++p;\n\n        while ( ( *q++ = *p++ ) );\n    }\n\n    return s;\n}\n\nint main(void) \n{\n    char s[] = \"\\t Hello World\";\n\n    printf( \"\\\"%s\\\"\\n\", s );\n\n    printf( \"\\\"%s\\\"\\n\", EraseWSbeforethefirstword( s ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>\"    Hello World\"\n\"Hello World\"\n</code></pre>\n\n<p>Take into account that you may not modify string literals. So the program will have undefined behavior if instead of the array</p>\n\n<pre><code>char s[] = \"\\t Hello World\";\n</code></pre>\n\n<p>there will be declared a pointer to a string literal</p>\n\n<pre><code>char *s = \"\\t Hello World\";\n</code></pre>\n\n<p>If you want that the function could deal with string literals then the function has to allocate a new array dynamically and to return a pointer to its first element.</p>\n\n<p>If you may not use standard C string functions then the function can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *  EraseWSbeforethefirstword( const char *s )\n{\n    size_t blanks = 0;\n\n    while ( s[blanks] == ' ' || s[blanks] == '\\t' ) ++blanks;\n\n    size_t length = 0;\n\n    while ( s[length + blanks] != '\\0' ) ++length;\n\n    char *p = malloc( length + 1 );\n\n    if ( p != NULL )\n    {\n        size_t i = 0;\n        while ( ( p[i] = s[i + blanks] ) != '\\0' ) ++i;\n    }\n\n    return p;\n}\n\nint main(void) \n{\n    char *s= \"\\t Hello World\";\n\n    printf( \"\\\"%s\\\"\\n\", s );\n\n    char *p = EraseWSbeforethefirstword( s );\n\n    if ( p ) printf( \"\\\"%s\\\"\\n\", p );\n\n    free( p );\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8402127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tol1I.gif?s=128&g=1", "display_name": "Djule", "link": "https://stackoverflow.com/users/8402127/djule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501627573, "creation_date": 1501623725, "last_edit_date": 1501626325, "question_id": 45448121, "link": "https://stackoverflow.com/questions/45448121/why-doesnt-pointer-arithmetic-work-in-char-functions", "title": "Why doesn&#39;t pointer arithmetic work in char* functions", "body": "<p>THE MESSAGE:</p>\n\n<pre><code>/usr/local/webide/runners/c_runner.sh: line 54: 20533 Segmentation fault\nnice -n 10 valgrind --leak-check=full --log-file=\"$valgrindout\" \"$exefile\"\n</code></pre>\n\n<p>I can't understand why I can't use pointer arithmetic when my function type is not void. Take a look at this example:</p>\n\n<p>Let's say I have to write a function that would 'erase' all whitespaces before the first word in a string. \nFor example, if we had a char array:</p>\n\n<pre><code>\"    Hi everyone\"\n</code></pre>\n\n<p>it should produce <code>\"Hi everyone\"</code> after the function's modification.</p>\n\n<p>Here is my code which works fine when instead of\n<code>char* EraseWSbeforethefirstword()</code> I have<br>\n<code>void EraseWSbeforethefirstword</code>.  </p>\n\n<p>When the function returns an object <code>char*</code> it can't even be compiled.</p>\n\n<pre><code>char* EraseWSbeforethefirstword(char *s) {\n    char *p = s, *q = s;\n\n    if (*p == ' ') { /*first let's see if I have a string that begins with a space */\n        while (*p == ' ') {\n            p++;\n        } /*moving forward to the first non-space character*/\n\n        while (*p!= '\\0') {\n            *q = *p; \n            p++; \n            q++;\n        } /*copying the text*/\n\n        *q = '\\0'; /*If I had n spaces at the beginning the new string has n characters less */\n    }\n    return s;\n} \n</code></pre>\n"}, {"tags": ["c", "initialization", "c99"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 7, "creation_date": 1501622070, "post_id": 45447783, "comment_id": 77856706, "body": "why testing undefined behaviour? it depends on the OS/compiler/whatever. Would you bet your life on that?"}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1501622150, "post_id": 45447783, "comment_id": 77856746, "body": "@Jean-Fran&#231;oisFabre I wanted to see if initializing a bunch of integers would really have them contain unpredictable values as I was told. I said that in the first paragraph of the question, though."}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 5, "creation_date": 1501622203, "post_id": 45447783, "comment_id": 77856768, "body": "It&#39;s an implementation detail specific to your environment. That&#39;s it. You haven&#39;t been lied to and you haven&#39;t made a ground breaking discovery."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1501622211, "post_id": 45447783, "comment_id": 77856779, "body": "no that&#39;s not a good way to generate random values, no. Try that on another OS or compiler you may get a different result."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1501622224, "post_id": 45447783, "comment_id": 77856786, "body": "@UnknowableIneffible: They will generally contain <i>unpredictable</i> values (which are not guaranteed to be stable on top of that). But &quot;random&quot;? &quot;Random&quot; is not the right term to use in this case."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1501622258, "post_id": 45447783, "comment_id": 77856798, "body": "@AnT Fair enough. I&#39;ll edit the comment."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1501622294, "post_id": 45447783, "comment_id": 77856813, "body": "You will often get different results when you compile with debug flags turned on vs. off, and optimization turned on vs. off."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1501622368, "post_id": 45447783, "comment_id": 77856844, "body": "<i>not leading to unspecified behavior as expected</i> - Isn&#39;t it ringing an alarm? How can you <i>expect</i> some <i>specific</i> <i>unspecified</i> behavior?"}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1501622433, "post_id": 45447783, "comment_id": 77856863, "body": "@EugeneSh. That&#39;s fair. I was just under the impression that, at some point, these integer pointers might point to a value that isn&#39;t 0, when it doesn&#39;t seem to be happening with what I am doing."}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1501622484, "post_id": 45447783, "comment_id": 77856887, "body": "@UnknowableIneffible, and at some point (after you&#39;ve initialized and <code>free</code>&#39;d) they are pointing to non-zero values."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1501622554, "post_id": 45447783, "comment_id": 77856917, "body": "@SeanBright Right, but that doesn&#39;t seem to happen with new heap space that I hadn&#39;t freed before, which is what I was curious about."}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 1, "creation_date": 1501622660, "post_id": 45447783, "comment_id": 77856961, "body": "@UnknowableIneffible, the answer to your question relies on your compiler and OS, so that is where you should start your search."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1501622737, "post_id": 45447783, "comment_id": 77856994, "body": "@SeanBright Thanks. I&#39;ll take a look, and if I find anything interesting I&#39;ll post it as an answer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501622789, "post_id": 45447783, "comment_id": 77857017, "body": "&quot;I&#39;ve been told a thousand ways to Sunday that referencing a value that hasn&#39;t been initialized isn&#39;t safe&quot; --&gt; referencing uninitialized <code>unsigned char</code> <i>is</i> safe.  The value read may be consistent, it may  vary, but it is <i>safe</i> - not a trap."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501622845, "post_id": 45447783, "comment_id": 77857045, "body": "Just because <code>malloc</code> is not <i>required</i> to zero the data, does not mean it <i>won&#39;t</i>, and some implementations do it for security reasons, so that you can&#39;t &quot;peek&quot; some previous data from elsewhere."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501622846, "post_id": 45447783, "comment_id": 77857046, "body": "@chux That&#39;s true. I&#39;ll fix the post."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1501623106, "post_id": 45447783, "comment_id": 77857149, "body": "&quot;My question is why all of my integer pointers in the first test consistently point to 0. &quot;  --&gt; Try storing random data in the allocation and <i>then</i> free it.  Try allocating random sizes.  The test is not robust.  A key factor is that code does not write anything to the allocated memory.  Many OS simple map allocated memory to a &quot;zero&quot; page and keep it mapped there until something <i>interesting</i> is written.  See <a href=\"https://stackoverflow.com/q/19991623/2410359\">Why is malloc not \u201cusing up\u201d the memory on my computer?</a>"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1501623320, "post_id": 45447783, "comment_id": 77857240, "body": "To see what happens,  you need to examine the machine code produced by the compiler, or run the program under debugger in disassembly mode, machine code instruction by instruction."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1501624304, "post_id": 45447783, "comment_id": 77857599, "body": "Answered by <a href=\"https://stackoverflow.com/a/4105123/1505939\">What is undefined behaviour?</a>"}, {"owner": {"reputation": 327, "user_id": 3439241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379db3ae2e8602becbff5d33238391ec?s=128&d=identicon&r=PG&f=1", "display_name": "Brad S.", "link": "https://stackoverflow.com/users/3439241/brad-s"}, "edited": false, "score": 0, "creation_date": 1501625313, "post_id": 45447783, "comment_id": 77858001, "body": "The program leaks memory like mad...doesn&#39;t it crash for sufficiently large values of testnum?"}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 327, "user_id": 3439241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379db3ae2e8602becbff5d33238391ec?s=128&d=identicon&r=PG&f=1", "display_name": "Brad S.", "link": "https://stackoverflow.com/users/3439241/brad-s"}, "edited": false, "score": 0, "creation_date": 1501625887, "post_id": 45447783, "comment_id": 77858205, "body": "@BradS. Yeah, but that was sort of the point. I wanted pointer values I hadn&#39;t seen before, not ones that I had previously freed. Not that I wanted to leak a bunch of memory, but it was the only way I could think to do it."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501624437, "post_id": 45448160, "comment_id": 77857648, "body": "See my comment above. He is not reusing any memory, he is leaking memory. I do not know any modern system which exposes unzeroed memory to the started program. for security reason (memory if not zeroed may contain sensitive information like passwords or credit cards numbers left by previous programs / users"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501625865, "post_id": 45448160, "comment_id": 77858197, "body": "compilers do not clear any memories. it can be done only by the program startup routines."}, {"owner": {"reputation": 8848, "user_id": 2116168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjVAe.jpg?s=128&g=1", "display_name": "Elmar Peise", "link": "https://stackoverflow.com/users/2116168/elmar-peise"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501628736, "post_id": 45448160, "comment_id": 77859065, "body": "In his second example, where he allocs, inits, frees an array, he could well be reusing those memory locations.  Compilers are unlikely to clear memory, but is it guaranteed that they don&#39;t? I mean, they could also fill it with 0xDEADBEEF, couldn&#39;t they?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501629038, "post_id": 45448160, "comment_id": 77859150, "body": "Compilers do not. It is guaranteed. It is done by the startup code linked to the compiled files. You can write your own startup (which I do quite often in my embedded bare metal projects). Modern OSes always clear all memory accessed by the program before passing execution to it - for security reasons"}], "tags": [], "owner": {"reputation": 8848, "user_id": 2116168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjVAe.jpg?s=128&g=1", "display_name": "Elmar Peise", "link": "https://stackoverflow.com/users/2116168/elmar-peise"}, "is_accepted": false, "score": 0, "last_activity_date": 1501623871, "creation_date": 1501623871, "answer_id": 45448160, "question_id": 45447783, "link": "https://stackoverflow.com/questions/45447783/initializing-integer-pointers-in-c-not-leading-to-unspecified-behavior-as-expec/45448160#45448160", "title": "Initializing integer pointers in c, not leading to unspecified behavior as expected", "body": "<p>First off, you need to understand, that C is a language that is described in a standard and implemented by several compilers (gcc, clang, icc, ...).  In several cases, the standard mentions that certain expressions or operations result in undefined behavior.</p>\n\n<p>What is important to understand is that this means you have no guarantees on what the behavior will be.  In fact any compiler/implementation is basically free to do <em>whatever it wants!</em></p>\n\n<p>In your example, this means you cannot make any assumptions of when the uninitialized memory will contain.  So assuming it will be random or contain elements of a previously freed object are just as wrong as assuming that it is zero, because any of that could happen at any time.</p>\n\n<p>Many compilers (or OS's) will consistently do the same thing (such as the 0s you observer), but that is also not guaranteed.</p>\n\n<p>(To <em>maybe</em> see different behaviors, try using a different compiler or different flags.)</p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1501624503, "creation_date": 1501624503, "answer_id": 45448279, "question_id": 45447783, "link": "https://stackoverflow.com/questions/45447783/initializing-integer-pointers-in-c-not-leading-to-unspecified-behavior-as-expec/45448279#45448279", "title": "Initializing integer pointers in c, not leading to unspecified behavior as expected", "body": "<p>Undefined behavior does not mean \"random behavior\" nor does it mean \"the program will crash.\"  Undefined behavior means \"the compiler is allowed to assume that this never happens,\" and \"if this does happen, the program could do <em>anything</em>.\"  Anything includes doing something boring and predictable.</p>\n\n<p>Also, the implementation is allowed to <em>define</em> any instance of undefined behavior.  For instance, ISO C never mentions the header <code>unistd.h</code>, so <code>#include &lt;unistd.h&gt;</code> has undefined behavior, but on an implementation conforming to POSIX, it has well-defined and documented behavior.</p>\n\n<p>The program you wrote is <em>probably</em> observing uninitialized <code>malloc</code>ed memory to be zero because, nowadays, the system primitives for allocating memory (<code>sbrk</code> and <code>mmap</code> on Unix, <code>VirtualAlloc</code> on Windows) always zero out the memory before returning it.  That's documented behavior <em>for the primitives</em>, but it is <em>not</em> documented behavior for <code>malloc</code>, so you can only rely on it if you call the primitives directly.  (Note that only the <code>malloc</code> implementation is allowed to call <code>sbrk</code>.)</p>\n\n<p>A better demonstration is something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint\nmain(void)\n{\n    {\n        int *x = malloc(sizeof(int));\n        *x = 0xDEADBEEF;\n        free(x);\n    }\n    {\n        int *y = malloc(sizeof(int));\n        printf(\"%08X\\n\", *y);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>which has pretty good odds of printing \"DEADBEEF\" (but is <em>allowed</em> to print 00000000, or 5E5E5E5E, or make demons fly out of your nose).</p>\n\n<p>Another better demonstration would be any program that makes a control-flow decision based on the value of an uninitialized variable, e.g.</p>\n\n<pre><code>int foo(int x)\n{\n    int y;\n    if (y == 5)\n        return x;\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://godbolt.org/g/hF6cyt\" rel=\"nofollow noreferrer\">Current versions of gcc and clang will generate code that always returns 0, but the current version of ICC will generate code that returns either 0 or the value of x, depending on whether register EDX is equal to 5 when the function is called.</a>  Both possibilities are correct, and so generating code that always returns x, and so is generating code that makes demons fly out of your nose.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501625196, "last_edit_date": 1501625196, "creation_date": 1501624589, "answer_id": 45448298, "question_id": 45447783, "link": "https://stackoverflow.com/questions/45447783/initializing-integer-pointers-in-c-not-leading-to-unspecified-behavior-as-expec/45448298#45448298", "title": "Initializing integer pointers in c, not leading to unspecified behavior as expected", "body": "<p>useless deliberations, wrong assumptions, wrong test. In your test every time you malloc sizeof int of the fresh memory. To see the that UB you wanted to see you should put something in that allocated memory and then free it. Otherwise you do not reuse it, you just leak it. Most of the OS-es clear all the  memory allocated to the program before executing it for the security reasons (so when you start the program everything was zeroed or initialised to the static values).</p>\n\n<p>Change your program to:</p>\n\n<pre><code>int main(){\n    size_t counter = 0;\n    size_t testnum = 2000; //The number of ints to allocate and test.\n    for(int i = 0; i &lt; testnum; i++){\n        int* temp = malloc(sizeof(int));\n        assert(temp != NULL); //Just in case there's no space.\n        if(*temp == 0) counter++;\n        *temp = rand();\n        free(temp);\n    }\n    printf(\" %d\",counter);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "edited": false, "score": 1, "creation_date": 1501632212, "post_id": 45448376, "comment_id": 77859989, "body": "This is a great answer, I really appreciate the clarification."}], "tags": [], "owner": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "is_accepted": true, "score": 5, "last_activity_date": 1501624975, "creation_date": 1501624975, "answer_id": 45448376, "question_id": 45447783, "link": "https://stackoverflow.com/questions/45447783/initializing-integer-pointers-in-c-not-leading-to-unspecified-behavior-as-expec/45448376#45448376", "title": "Initializing integer pointers in c, not leading to unspecified behavior as expected", "body": "<p>As you already know, you are invoking undefined behavior, so all bets are off. To explain the particular results you are observing (\"why is uninitialized memory that I haven't written to all zeros?\"), you first have to understand how <code>malloc</code> works.</p>\n\n<p>First of all, <code>malloc</code> does not just directly ask the system for a page whenever you call it. It has an internal \"cache\" from which it can hand you memory. Let's say you call <code>malloc(16)</code> twice. The first time you call <code>malloc(16)</code>, it will scan the cache, see that it's empty, and request a fresh page (4KB on most systems) from the OS. It then splits this page into two chunks, gives you the smaller chunk, and saves the other chunk in its cache. The second time you call <code>malloc(16)</code>, it will see that it has a large enough chunk in its cache, and allocate memory by splitting that chunk again.</p>\n\n<p><code>free</code>ing memory simply returns it to the cache. There, it may (or may not be) be merged with other chunks to form a bigger chunk, and is then used for other allocations. Depending on the details of your allocator, it may also choose to return free pages to the OS if possible.</p>\n\n<p>Now the second piece of the puzzle -- any fresh pages you obtain from the OS are filled with <code>0</code>s. Why? Imagine it simply handed you an unused page that was previously used by some other process that has now terminated. Now you have a security problem, because by scanning that \"uninitialized memory\", your process could potentially find sensitive data such as passwords and private keys that were used by the previous process. Note that <strong>there is no guarantee by the C language that this happens</strong> (it may be guaranteed by the OS, but the C specification doesn't care). It's possible that the OS filled the page with random data, or didn't clear it at all (especially common on embedded devices).</p>\n\n<p>Now you should be able to explain the behavior you're observing. The first time, you are obtaining <em>fresh pages</em> from the OS, so they are empty (again, this is an implementation detail of your OS, not the C language). However, if you <code>malloc</code>, <code>free</code>, then <code>malloc</code> again, there is a chance that you are getting back the same memory that was in the cache. This cached memory is <strong>not</strong> wiped, since the only process that could have written to it was your own. Hence, you just get whatever data was previously there.</p>\n\n<p>Note: this explains the behavior for <strong>your particular <code>malloc</code> implementation</strong>. It doesn't generalize to all <code>malloc</code> implementations.</p>\n"}], "owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "accepted_answer_id": 45448376, "answer_count": 4, "score": 1, "last_activity_date": 1501625196, "creation_date": 1501622001, "last_edit_date": 1501622886, "question_id": 45447783, "link": "https://stackoverflow.com/questions/45447783/initializing-integer-pointers-in-c-not-leading-to-unspecified-behavior-as-expec", "title": "Initializing integer pointers in c, not leading to unspecified behavior as expected", "body": "<p>Having recently switched to c, I've been told a thousand ways to Sunday that referencing a value that hasn't been initialized isn't good practice, and leads to unexpected behavior. Specifically, (because my previous language initializes integers as 0) I was told that integers might not be equal to zero when uninitialized. So I decided to put that to the test.</p>\n\n<p>I wrote the following piece of code to test this claim:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;assert.h&gt;\n\nint main(){\n    size_t counter = 0;\n    size_t testnum = 2000; //The number of ints to allocate and test.\n    for(int i = 0; i &lt; testnum; i++){\n        int* temp = malloc(sizeof(int));\n        assert(temp != NULL); //Just in case there's no space.\n        if(*temp == 0) counter++;\n    }\n    printf(\" %d\",counter);\n    return 0;\n}\n</code></pre>\n\n<p>I compiled it like so (in case it matters): </p>\n\n<p><code>gcc -std=c99 -pedantic name-of-file.c</code></p>\n\n<p>Based on what my instructors had said, I expected temp to point to a random integer, and that the counter would not be incremented very often. However, my results blow this assumption out of the water:</p>\n\n<pre><code>testnum:  ||  code returns:\n2             2\n20            20\n200           200\n2000          2000\n20000         20000\n200000        200000\n2000000       2000000\n...           ...\n</code></pre>\n\n<p>The results go on for a couple more powers of 10 (*2), but you get the point. </p>\n\n<p>I then tested a similar version of the above code, but I initialized an integer array, set every even index to plus 1 of its previous value (which was uninitialized), freed the array, and then performed the code above, testing the same amount of integers as the size of the array (i.e. testnum). These results are much more interesting:</p>\n\n<pre><code>testnum:  ||  code returns:\n2             2\n20            20\n200           175\n2000          1750\n20000         17500\n200000        200000\n2000000       2000000\n...           ...\n</code></pre>\n\n<p>Based on this, it's reasonable to conclude that c reuses freed memory (obviously), and sets some of those new integer pointers to point to addresses which contain the previously incremented integers. My question is why all of my integer pointers in the first test consistently point to 0. Shouldn't they point to whatever empty spaces on the heap that my computer has offered the program, which could (and should, at some point) contain non-zero values? </p>\n\n<p>In other words, why does it seem like all of the new heap space that my c program has access to has been wiped to all 0s?</p>\n"}, {"tags": ["c", "byte", "i2c", "words"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1501623987, "post_id": 45447423, "comment_id": 77857486, "body": "The simplest thing to do would be to write a word-reading function in terms of your existing byte-reading function, like this: <code>void I2CReadWords(uint8_t devAddr, uint8_t regAddr, uint8_t length, uint16_t *value) { I2CReadBytes(devAddr, regAddr, length * 2, (uint8_t *)value); }</code>.  But you may have byte-ordering difficulties."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6169111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6220e27bb43ea4754c817574c1f43bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/6169111/ale"}, "edited": false, "score": 0, "creation_date": 1501682894, "post_id": 45454071, "comment_id": 77886985, "body": "b is the LSB?It should be MSB first no?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 11, "user_id": 6169111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6220e27bb43ea4754c817574c1f43bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/6169111/ale"}, "edited": false, "score": 0, "creation_date": 1501683104, "post_id": 45454071, "comment_id": 77887155, "body": "Depending on the other side of the bus. I2C is byte oriented and the other device decides what the byte order is."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501658468, "creation_date": 1501658468, "answer_id": 45454071, "question_id": 45447423, "link": "https://stackoverflow.com/questions/45447423/readwords-instead-of-bytes/45454071#45454071", "title": "ReadWords instead of Bytes", "body": "<p>bigendian</p>\n\n<pre><code>uint16_t ReadWord(void)\n{\n    uint16_t result = 0;\n    uint8_t b;\n    b = I2C_MasterReadByte(I2C_ACK_DATA);\n    result = b + I2C_MasterReadByte(I2C_ACK_DATA) &lt;&lt; 8;\n    return result; \n}\n</code></pre>\n\n<p>it does not check for any errors as I do not know if your one does</p>\n"}], "owner": {"reputation": 11, "user_id": 6169111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6220e27bb43ea4754c817574c1f43bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/6169111/ale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501658468, "creation_date": 1501620423, "question_id": 45447423, "link": "https://stackoverflow.com/questions/45447423/readwords-instead-of-bytes", "title": "ReadWords instead of Bytes", "body": "<p>I am using I2C communication and I need to read words instead of bytes but i am stuck.\nTo read bytes I do:</p>\n\n<pre><code>void I2CReadBytes(uint8_t devAddr, uint8_t regAddr, uint8_t length, uint8_t *value)\n{\n    uint8_t i=0;\n    I2C_MasterSendStart(devAddr, I2C_WRITE_XFER_MODE);\n    I2C_MasterWriteByte(regAddr);\n    I2C_MasterSendRestart(devAddr, I2C_READ_XFER_MODE);\n    while (i++ &lt; (length-1)) {\n        *value++ = I2C_MasterReadByte(I2C_ACK_DATA);\n    }\n    *value = I2C_MasterReadByte(I2C_NAK_DATA);\n    I2C_MasterSendStop();\n}\n</code></pre>\n\n<p>What if I want to readWords? I have to use int16_t *value but after that I'm stuck with </p>\n\n<pre><code>while (i++ &lt; (length-1)) {\n            *value++ = I2C_MasterReadByte(I2C_ACK_DATA);\n        }\n        *value = I2C_MasterReadByte(I2C_NAK_DATA);\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 1, "creation_date": 1501619141, "post_id": 45447007, "comment_id": 77855233, "body": "why are you returning a pointer to a static struct? C is able to return structs perfectly well."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501619387, "post_id": 45447007, "comment_id": 77855364, "body": "<code>ret = maxarr(1, len, array);</code> --&gt; <code>ret = maxarr(0, len-1, array);</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 0, "last_activity_date": 1501619812, "last_edit_date": 1501619812, "creation_date": 1501619109, "answer_id": 45447080, "question_id": 45447007, "link": "https://stackoverflow.com/questions/45447007/maximum-subarray-with-static-struct-return-types/45447080#45447080", "title": "maximum subarray with static struct return types", "body": "<p>you're using a <code>static</code> variable you're taking the address from to return to the caller.</p>\n\n<p>In that case, you're sharing a same memory area for your return value, instead of creating separate ones.</p>\n\n<p>Why not returning the <em>value</em> of the structure instead (C cannot return arrays, but can return structs, fortunately):</p>\n\n<pre><code>struct rettype maxcarr(int i, int j, int* array)\n{\n    int mid = (i + j) / 2;\n    struct rettype ret;\n    ...\n    return ret;\n}\n</code></pre>\n\n<p>(and drop <code>static</code> for an auto variable which is copied when returned)</p>\n\n<p>Note that you'll have to apply this pattern to all your routines.</p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501663139, "creation_date": 1501663139, "answer_id": 45455714, "question_id": 45447007, "link": "https://stackoverflow.com/questions/45447007/maximum-subarray-with-static-struct-return-types/45455714#45455714", "title": "maximum subarray with static struct return types", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Maximum_subarray_problem\" rel=\"nofollow noreferrer\">Maximum subarray problem</a><br>\n<a href=\"https://en.wikipedia.org/wiki/Maximum_subarray_problem#Kadane.27s_algorithm\" rel=\"nofollow noreferrer\">Kadane's algorithm</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct rettype {\n    int start;\n    int end;\n    int sum;\n};\n\nstruct rettype max_subarray(int array[], int length);\n\nint main(void){\n    int array[20];\n    int len = 0, num;\n    struct rettype ret;\n\n    printf(\"Type length in.\\n\");\n    if(scanf(\"%d\", &amp;len) != 1){\n        printf(\"invalid input.\\n\");\n        return 1;\n    }\n    if(len &gt; 20){\n        printf(\"too long.\\n\");\n        return 2;\n    }\n    for(num = 0; num &lt; len; num++){\n        printf(\"%dth element: \", num);\n        if(scanf(\"%d\", &amp;array[num]) != 1){\n            printf(\"invalid input.\\n\");\n            len = num;\n            break;\n        }\n    }\n    if(len &gt; 0){\n        ret = max_subarray(array, len);\n        printf(\"Maximum Subarray:\\nfrom element %d to element %d with sum of %d\\n\", ret.start, ret.end, ret.sum);\n    }\n    return 0;\n}\n\nstruct rettype max_subarray(int array[], int length){\n    struct rettype ret  = { .sum = array[0] };\n    struct rettype curr = { .sum = array[0] };\n\n    for(int i = 1; i &lt; length; ++i){\n        if(array[i] &lt; array[i] + curr.sum){\n            curr.sum += array[i];\n            curr.end = i;\n        } else {\n            curr.sum = array[i];\n            curr.start = curr.end = i;\n        }\n        if(ret.sum &lt; curr.sum){\n            ret = curr;\n        }\n    }\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8155764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X5jv5.jpg?s=128&g=1", "display_name": "Intelli21C", "link": "https://stackoverflow.com/users/8155764/intelli21c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501663139, "creation_date": 1501618842, "question_id": 45447007, "link": "https://stackoverflow.com/questions/45447007/maximum-subarray-with-static-struct-return-types", "title": "maximum subarray with static struct return types", "body": "<p>I made maximum subarray algorithm, which something seems to be wrong with. Since C cannot return multiple values, function \"maxarr\" OR \"maxcarr\" is supposed to return three value-(start index, end index, and sum of it) in a static struct \"rettype\". However, those return value seems to be the same one(I have checked its memory adress, which was all same). I suppose that error occurs because static type variables are only declared once and do not be initialized more than one time, but I do not know how I can correct it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct rettype\n{\n    int a;\n    int b;\n    int c;\n};\n\nstruct rettype* maxarr(int i, int j, int* array);\nstruct rettype* maxcarr(int i, int j, int* array);\nint main(void)\n{\n    int array[20];\n    int temp = 0;\n    int num = 0;\n    int len = 0;\n    struct rettype* ret;\n    printf(\"Type length in.\\n\");\n    scanf(\"%d\", &amp;len);\n    while (num&lt;len)\n    {\n        printf(\"%dth element: \", num);\n        scanf(\"%d\", &amp;array[num]);\n        num++;\n    }\n    ret = maxarr(1, len, array);\n    printf(\"Maximum Subarray:\\nfrom element %d to element %d with sum of %d\\n\", ret-&gt;a, ret-&gt;b, ret-&gt;c);\n    return 0;\n}\n\nstruct rettype* maxarr(int i, int j, int* array)\n{\n    static struct rettype retb;\n    static struct rettype ret;\n    struct rettype* fretr;\n    struct rettype* fretc;\n    struct rettype* fretl;\n    int hi=j;\n    int mid;\n    int low=i;\n    mid = ((hi + low) / 2);\n    if (i == j) {//base case\n        retb.a = i;\n        retb.b = j;\n        retb.c = *(array + i);\n        return &amp;retb;\n    }\n    fretl = maxarr(i, mid, array);\n    fretr = maxarr(mid+1, j, array);\n    fretc = maxcarr(i, j, array);\n    if (fretl-&gt;c&gt;fretr-&gt;c &amp;&amp; fretl-&gt;c&gt;fretc-&gt;c)\n    {\n        ret.a = fretl-&gt;a;\n        ret.b = fretl-&gt;b;\n        ret.c = fretl-&gt;c;\n        return &amp;ret;\n    }\n    else if (fretr-&gt;c&gt;fretl-&gt;c &amp;&amp; fretr-&gt;c&gt;fretc-&gt;c)\n    {\n        ret.a = fretr-&gt;a;\n        ret.b = fretr-&gt;b;\n        ret.c = fretr-&gt;c;\n        return &amp;ret;\n    }\n    else\n    {\n        ret.a = fretc-&gt;a;\n        ret.b = fretc-&gt;b;\n        ret.c = fretc-&gt;c;\n        return &amp;ret;\n    }\n}\nstruct rettype* maxcarr(int i, int j, int* array)\n{\n    int mid = (i + j) / 2;\n    static struct rettype ret;\n    int a = mid;\n    int b = mid+1;\n    int risum = -9999;\n    int lesum = -9999;\n    int sum = 0;\n    while (a--&gt;i)\n    {\n        sum += *(array + a);\n        if (sum&gt;lesum)\n        {\n            lesum = sum;\n        }\n    }\n    sum = 0;\n    while (b++&lt;j)\n    {\n        sum += *(array + b);\n        if (sum&gt;risum)\n        {\n            risum = sum;\n        }\n    }\n    sum = 0;\n    ret.a = a;\n    ret.b = b;\n    ret.c = risum + lesum;\n    return &amp;ret;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "malloc", "dynamic-arrays"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1501617259, "post_id": 45446573, "comment_id": 77854265, "body": "In <code>if(a != NULL)</code> and <code>if(b != NULL)</code> you are testing <i>uninitialised variables</i>. Please turn on compiler warnings. If those variables happened to be not <code>NULL</code> then the <code>free</code>ing can crash the system, since the pointers are not to memory that was allocated by <code>malloc</code> or its cousins."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501617447, "post_id": 45446573, "comment_id": 77854367, "body": "Note: Consider allocation simplification: <code>a = (int**)malloc(N_a * sizeof(int*));</code> --&gt; <code>a = malloc(sizeof *a * N_a);</code>.  Easier to code, review and maintain."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501617507, "post_id": 45446573, "comment_id": 77854406, "body": "@chux My personal preference is <code>a = malloc(N_a * sizeof *a)</code> because it mimics the order of the arguments in <code>calloc</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1501617712, "post_id": 45446573, "comment_id": 77854499, "body": "@melpomene <a href=\"https://stackoverflow.com/questions/45446573/c-code-involving-malloc-for-dynamic-allocation-of-2d-array-crashes-after-compili?noredirect=1#comment77854406_45446573\">That</a> does have that advantage.  I prefer starting with the <code>size_t</code> type as that insures the following product is calculated using <code>size_t</code> math: <code>sizeof *a * int_width * int_row)</code> that might overflow in another order.  Of course, make no product difference with only 2."}, {"owner": {"reputation": 2622, "user_id": 1834967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Fdxei.jpg?s=128&g=1", "display_name": "Felix Guo", "link": "https://stackoverflow.com/users/1834967/felix-guo"}, "edited": false, "score": 0, "creation_date": 1501617764, "post_id": 45446573, "comment_id": 77854524, "body": "Why are you freeing the array before starting the program / allocating the array?"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 2, "creation_date": 1501618336, "post_id": 45446573, "comment_id": 77854840, "body": "This is the obligatory, &quot;Don&#39;t cast the return value of Malloc because it can conceal errors&quot; comment."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501627576, "post_id": 45446573, "comment_id": 77858739, "body": "<code>The FreeArray function was provided to us, so I know it is correct.</code> wrong assumption"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1502066645, "post_id": 45446573, "comment_id": 78036067, "body": "Here is the obligatory link. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1501618107, "post_id": 45446747, "comment_id": 77854722, "body": "The reason for &quot;warning: <code>N</code> may be used uninitialized&quot; is that the return value from <code>scanf</code> is not checked, to make sure that an input was properly scanned. <i>Always</i> check the result of user input functions, and if necessary, their value is in the expected valid range."}], "tags": [], "owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1501617794, "creation_date": 1501617794, "answer_id": 45446747, "question_id": 45446573, "link": "https://stackoverflow.com/questions/45446573/c-code-involving-malloc-for-dynamic-allocation-of-2d-array-crashes-after-compili/45446747#45446747", "title": "C code involving malloc for dynamic allocation of 2D array crashes after compiling", "body": "<p>Here's what gcc reported when your code was compiled with more warnings.</p>\n\n<pre><code>gcc -o xx xx.c -Wall -Wextra -pedantic -std=c99 -O2 -Wmissing-declarations -Wmissing-prototypes -Wconversion\nxx.c: In function \u2018main\u2019:\nxx.c:26:26: warning: conversion to \u2018long unsigned int\u2019 from \u2018int\u2019 may change the sign of the result [-Wsign-conversion]\na = (int **) malloc(N_a * sizeof(int *));\n                      ^\nxx.c:25:6: warning: variable \u2018errorInAlloc\u2019 set but not used [-Wunused-but-set-variable]\nint errorInAlloc = 0;\n  ^\nxx.c:10:5: warning: \u2018a\u2019 is used uninitialized in this function [-Wuninitialized]\nif (a != NULL) {\n ^\nxx.c:13:5: warning: \u2018b\u2019 is used uninitialized in this function [-Wuninitialized]\nif (b != NULL) {\n ^\nxx.c:11:3: warning: \u2018N\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\nFreeArray(a, N);\n^\n</code></pre>\n\n<p>The formatting is a little bit off. The point is crystal clear: Let your compiler help you locate errors.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1501618742, "post_id": 45446921, "comment_id": 77855054, "body": "@WeatherVane: good catch.  I used an explicit <code>return NULL;</code> that is provably less error prone ;-)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501618772, "post_id": 45446921, "comment_id": 77855068, "body": "I notice, you usually go one better than recommendations! (mine was <code>arr = NULL;</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501619097, "post_id": 45446921, "comment_id": 77855216, "body": "@WeatherVane: Your recommendation was good, and might help produce less code and comply with local coding rules (single exit point), and it was my intent to use this approach, but I forgot the necessary <code>arr = NULL;</code> statement and ruined the error detection. An explicit <code>return NULL;</code> is less error prone and more readable for beginners..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1501619302, "post_id": 45446921, "comment_id": 77855322, "body": "I prefer the early exit, it simplifies the code structure and the need for unnecessary <code>else</code> code blocks. Might depend on any clean-up required when the proper one-exit solution will be needed."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1501627900, "post_id": 45446921, "comment_id": 77858824, "body": "One calloc for the whole array. Easier (quicker) dereferencing, smaller overhead. In the complex matrix calculations every instruction counts"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501698739, "post_id": 45446921, "comment_id": 77897823, "body": "@PeterJ: I agree, but this simplification would require a change in the <code>FreeArray</code> function.  One might as well use a C99 2D array declared and allocated in one step with <code>int (*arr)[N] = calloc(sizeof(*arr), N);</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501699582, "post_id": 45446921, "comment_id": 77898327, "body": "@chqrlie double dereferences terribly lower the quality of the optimisation. Even with single malloc and values of number of the rows and collums stored in the table - compilers do now absolutely amazing job. Just to see how it works (plain curiosity) : <a href=\"https://godbolt.org/g/V9ZjUL\" rel=\"nofollow noreferrer\">godbolt.org/g/V9ZjUL</a> - and I am amazed. Another thing which amazes me is the ARM instruction set."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501700137, "post_id": 45446921, "comment_id": 77898657, "body": "@PeterJ: amazing indeed. For consistency with <code>CreateArray()</code>, it seems the code should be: <code>inline int ArrayGet(int *p, int row, int column) {  return *(p + 2 + row * p[1] + column); }</code> and the same difference in <code>ArrayPut()</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501700459, "post_id": 45446921, "comment_id": 77898860, "body": "You right - but it is just the 5 min &quot;sketch&quot; - did not care about the consistency :)"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1501618791, "last_edit_date": 1501618791, "creation_date": 1501618477, "answer_id": 45446921, "question_id": 45446573, "link": "https://stackoverflow.com/questions/45446573/c-code-involving-malloc-for-dynamic-allocation-of-2d-array-crashes-after-compili/45446921#45446921", "title": "C code involving malloc for dynamic allocation of 2D array crashes after compiling", "body": "<p>You have multiple errors in your program:</p>\n\n<ul>\n<li><p>variables <code>a</code> and <code>b</code> are uninitialized, comparing them to <code>NULL</code> is meaningless and passing them to <code>FreeArray</code> has undefined behavior.</p></li>\n<li><p>given how the <code>FreeArray</code> function is written, allocation must be performed in 2 steps:</p>\n\n<ul>\n<li>allocate an array of of pointers, which you do.</li>\n<li>initialize each element of the array with the address of an allocated array of <code>int</code>. which you don't.</li>\n</ul></li>\n</ul>\n\n<p>Here is how a function <code>AllocArray</code> would be written:</p>\n\n<pre><code>int **AllocArray(int N) {\n    int i;\n    int **arr = calloc(sizeof(*arr), N);\n    if (arr != NULL) {\n        for (i = 0; i &lt; N; i++) {\n            arr[i] = calloc(sizeof(*arr[i]), N);\n            if (arr[i] == NULL) {\n                /* allocation failed: free allocated portion and return NULL */\n                while (i-- &gt; 0) {\n                    free(arr[i]);\n                }\n                free(arr);\n                return NULL;\n            }\n        }\n    }\n    return arr;\n}\n</code></pre>\n\n<p>Note that the <code>FreeArray</code> function can be simplified this way:</p>\n\n<pre><code>void FreeArray(int **arr, int N) {\n    int i;\n    if (arr != NULL) {\n        for (i = 0; i &lt; N; i++) {\n            free(arr[i]);\n        }\n        free(arr);\n    }\n}\n</code></pre>\n\n<p>It is OK to pass a null pointer to <code>free()</code>, and a single test on <code>arr</code> is sufficient.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4734392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zQ20y.jpg?s=128&g=1", "display_name": "Mat&#237;as Dell&#39;Oso", "link": "https://stackoverflow.com/users/4734392/mat%c3%adas-delloso"}, "is_accepted": false, "score": 1, "last_activity_date": 1501618629, "creation_date": 1501618629, "answer_id": 45446956, "question_id": 45446573, "link": "https://stackoverflow.com/questions/45446573/c-code-involving-malloc-for-dynamic-allocation-of-2d-array-crashes-after-compili/45446956#45446956", "title": "C code involving malloc for dynamic allocation of 2D array crashes after compiling", "body": "<p>First problem is that you free an unallocated pointer:</p>\n\n<pre><code> if(a != NULL)\n {\n     FreeArray(a, N);\n }\n</code></pre>\n\n<p>You've never allocated memory for <code>a</code>, so when you try to access to a position of the vector, it generates a segmetation fault (same occurs with b). If you want to make sure that your pointer is <code>NULL</code>, just use <code>a = NULL;</code>. This will fix your problem.</p>\n\n<p>There is another logical problem:</p>\n\n<pre><code>if(a != NULL)\n{\n    errorInAlloc = 1;\n}\n</code></pre>\n\n<p>You return an error in allocation if a differs from NULL. You should return an error if <code>a</code> <em>is</em> <code>NULL</code> wich means that an error occurs in the memory allocation. </p>\n"}], "owner": {"reputation": 11, "user_id": 8401659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c315d6e0ab8303255806eb77be27d7?s=128&d=identicon&r=PG&f=1", "display_name": "Reily R", "link": "https://stackoverflow.com/users/8401659/reily-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1502066499, "creation_date": 1501617151, "last_edit_date": 1502066499, "question_id": 45446573, "link": "https://stackoverflow.com/questions/45446573/c-code-involving-malloc-for-dynamic-allocation-of-2d-array-crashes-after-compili", "title": "C code involving malloc for dynamic allocation of 2D array crashes after compiling", "body": "<p>I am trying to allocate the row dimension of an array (<code>a</code>) to the size of a user input value. Here is the code I have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid FreeArray(int **arry, int N);\n\nint main() {\n    int **a;\n    int **b;\n    int N_a;\n    int N;\n    if (a != NULL) {\n        FreeArray(a, N);\n    }\n    if (b != NULL) {\n        FreeArray(b, N);\n    }\n    do {\n        printf(\"Enter the size of the NxN array:\\n\");\n        scanf(\"%d\", &amp;N);\n        if (N &lt; 2) {\n            printf(\"Error, enter correct size.\\n\");\n        }\n    } while (N &lt; 2);\n    N_a = N;\n    int errorInAlloc = 0;\n    a = (int**)malloc(N_a * sizeof(int*));\n    if (a != NULL) {\n        errorInAlloc = 1;\n    }\n    return 0;\n}\n\nvoid FreeArray(int **arr, int N) {\n    int i;\n    if (arr == NULL)\n        return;\n    if (arr != NULL) {\n        for (i = 0; i &lt; N; i++) {\n            if (arr[i] != NULL)\n                free(arr[i]);\n        }\n        free(arr);\n    }\n}\n</code></pre>\n\n<p>The <code>FreeArray</code> function was provided to us, so I know it is correct. There is other code included in this, but I omitted is since it is just a menu. When I comment out <code>a = (int**) malloc(N_a * sizeof(int*));</code> the program compiles and runs without crashing or problems. When I include this line, the program compiles, but when I put a number greater than or equal to 2, it crashes. I have also tried <code>a = malloc(N_a * sizeof(int*));</code> and <code>a = (int**)malloc(N * sizeof(int*));</code> AND <code>a = malloc(N * sizeof(int*));</code> but all do the same thing.</p>\n\n<p>I have been coding and running the program in Code::Blocks, but even when I compile it through the command prompt, it still crashes. </p>\n\n<p>I have a hard time with arrays on a good day, so dynamically allocating arrays is so confusing to me, any help is greatly appreciated!</p>\n"}, {"tags": ["c", "linux", "debugging", "assembly", "arm"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1501616082, "post_id": 45446198, "comment_id": 77853617, "body": "The <code>orig &amp; ~0xff</code> is just because on x86 you want to replace a single byte only. On arm you obviously need more than a single byte, that is <code>trap = 0x01009fef;</code> should work better."}, {"owner": {"reputation": 934, "user_id": 1136236, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5c4f2b250d57a1ebf233426012487539?s=128&d=identicon&r=PG", "display_name": "Jonathan Dewein", "link": "https://stackoverflow.com/users/1136236/jonathan-dewein"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1501616456, "post_id": 45446198, "comment_id": 77853802, "body": "@Jester I have tried that, but it still does not work. It keeps giving me <code>PTRACE_PEEKTEXT: Success</code>"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1501616575, "post_id": 45446198, "comment_id": 77853860, "body": "The code is broken, of course <code>orig</code> can be negative that doesn&#39;t mean an error. This is what <code>man ptrace</code> says about it: <i>Since the value returned by a successful PTRACE_PEEK* request may be -1, the caller must clear errno before the call, and then check it afterward to determine whether  or  not  an  error occurred.</i>"}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1501618560, "post_id": 45446198, "comment_id": 77854960, "body": "This may be relevant <a href=\"https://stackoverflow.com/questions/11345371/how-do-i-set-a-software-breakpoint-on-an-arm-processor\" title=\"how do i set a software breakpoint on an arm processor\">stackoverflow.com/questions/11345371/&hellip;</a>"}], "owner": {"reputation": 934, "user_id": 1136236, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5c4f2b250d57a1ebf233426012487539?s=128&d=identicon&r=PG", "display_name": "Jonathan Dewein", "link": "https://stackoverflow.com/users/1136236/jonathan-dewein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 940, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1501615776, "creation_date": 1501615776, "question_id": 45446198, "link": "https://stackoverflow.com/questions/45446198/how-do-i-implement-breakpoints-with-c-on-the-arm-processor", "title": "How do I implement breakpoints with C on the ARM processor?", "body": "<p>I am trying to write a debugger for my Raspberry Pi 3 as a learning exercise. It it an ARMv7.</p>\n\n<p>This section of code is how you set the breakpoint on the x86 architecture:</p>\n\n<pre><code>if ((orig = ptrace(PTRACE_PEEKTEXT, pid, h.symaddr, NULL)) &lt; 0) {\n        perror(\"PTRACE_PEEKTEXT\");\n        exit(-1);\n      }\n      trap = (orig &amp; ~0xff) | 0xcc;\n      if (ptrace(PTRACE_POKETEXT, pid, h.symaddr, trap) &lt; 0) {\n        perror(\"PTRACE_POKETEXT\");\n        exit(-1);\n      }\n</code></pre>\n\n<p>Specifically, the line <code>trap = (orig &amp; ~0xff) | 0xcc;</code> is how you change the first byte to the opcode of the <code>int 3</code> syscall. This sets a breakpoint on the x86. However, I am at a loss on how to do it for ARM. I have tried searching the GDB source files to see how they do, and I have found the *-tdep.c family of files. They have arm-linux-tdep.c and arm-tdep.c. Within these files I found:</p>\n\n<pre><code>/* Under ARM GNU/Linux the traditional way of performing a breakpoint\n   is to execute a particular software interrupt, rather than use a\n   particular undefined instruction to provoke a trap.  Upon exection\n   of the software interrupt the kernel stops the inferior with a\n   SIGTRAP, and wakes the debugger.  */\n\n\u200cstatic const gdb_byte arm_linux_arm_le_breakpoint[] = { 0x01, 0x00, 0x9f, 0xef };\n\n\u200cstatic const gdb_byte arm_linux_arm_be_breakpoint[] = { 0xef, 0x9f, 0x00, 0x01 };\n\n/* However, the EABI syscall interface (new in Nov. 2005) does not look at\n   the operand of the swi if old-ABI compatibility is disabled.  Therefore,\n   use an undefined instruction instead.  This is supported as of kernel\n   version 2.5.70 (May 2003), so should be a safe assumption for EABI\n   binaries.  */\n\n\u200cstatic const gdb_byte eabi_linux_arm_le_breakpoint[] = { 0xf0, 0x01, 0xf0, 0xe7 };\n\n\u200cstatic const gdb_byte eabi_linux_arm_be_breakpoint[] = { 0xe7, 0xf0, 0x01, 0xf0 };\n\n/* All the kernels which support Thumb support using a specific undefined\n   instruction for the Thumb breakpoint.  */\n\n\u200cstatic const gdb_byte arm_linux_thumb_be_breakpoint[] = {0xde, 0x01};\n\n\u200cstatic const gdb_byte arm_linux_thumb_le_breakpoint[] = {0x01, 0xde};\n\n/* Because the 16-bit Thumb breakpoint is affected by Thumb-2 IT blocks,\n   we must use a length-appropriate breakpoint for 32-bit Thumb\n   instructions.  See also thumb_get_next_pc.  */\n\n\u200cstatic const gdb_byte arm_linux_thumb2_be_breakpoint[] = { 0xf7, 0xf0, 0xa0, 0x00 };\n\n\u200cstatic const gdb_byte arm_linux_thumb2_le_breakpoint[] = { 0xf0, 0xf7, 0x00, 0xa0 };\n</code></pre>\n\n<p>I have tried replacing <code>trap = (orig &amp; ~0xff) | 0xcc;</code> with the values from the arm-linux-tdep.c file as so(I use little endian since my system is little endian):</p>\n\n<p><code>trap = (orig &amp; ~0xff) | 0x01009fef; // doesn't work</code>\n<code>trap = (orig &amp; ~0xff) | 0xf001f0e7; // doesn't work</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;elf.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/user.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/ptrace.h&gt;\n#include &lt;sys/mman.h&gt;\n\ntypedef struct handle {\n  Elf64_Ehdr *ehdr;\n  Elf64_Phdr *phdr;\n  Elf64_Shdr *shdr;\n  uint8_t *mem;\n  char *symname;\n  Elf64_Addr symaddr;\n  struct user_regs_struct pt_reg;\n  char *exec;\n} handle_t;\n\nElf64_Addr lookup_symbol(handle_t *, const char *);\n\nint main(int argc, char **argv, char **envp)\n{\n  int fd;\n  handle_t h;\n  struct stat st;\n  long trap, orig;\n  int status, pid;\n  char * args[2];\n  if (argc &lt; 3) {\n    printf(\"Usage: %s &lt;program&gt; &lt;function&gt;\\n\", argv[0]);\n    exit(0);\n  }\n  if ((h.exec = strdup(argv[1])) == NULL) {\n    perror(\"strdup\");\n    exit(-1);\n  }\n  args[0] = h.exec;\n  args[1] = NULL;\n  if ((h.symname = strdup(argv[2])) == NULL) {\n    perror(\"strdup\");\n    exit(-1);\n  }\n  if ((fd = open(argv[1], O_RDONLY)) &lt; 0) {\n    perror(\"open\");\n    exit(-1);\n  }\n  if (fstat(fd, &amp;st) &lt; 0) {\n    perror(\"fstat\");\n    exit(-1);\n  }\n  h.mem = mmap(NULL, st.st_size, PROT_READ, MAP_PRIVATE, fd, 0);\n  if (h.mem == MAP_FAILED) {\n    perror(\"mmap\");\n    exit(-1);\n  }\n  h.ehdr = (Elf64_Ehdr *)h.mem;\n  h.phdr = (Elf64_Phdr *)(h.mem + h.ehdr-&gt;e_phoff);\n  h.shdr = (Elf64_Shdr *)(h.mem + h.ehdr-&gt;e_shoff);\n  if+ (h.mem[0] != 0x7f || strcmp((char *)&amp;h.mem[1], \"ELF\")) {\n    printf(\"%s is not an ELF file\\n\",h.exec);\n    exit(-1);\n  }\n  if (h.ehdr-&gt;e_type != ET_EXEC) {\n    printf(\"%s is not an ELF executable\\n\", h.exec);\n    exit(-1);\n  }\n  if (h.ehdr-&gt;e_shstrndx == 0 || h.ehdr-&gt;e_shoff == 0 || h.ehdr-&gt;e_shnum == 0) {\n    printf(\"Section header table not found\\n\");\n    exit(-1);\n  }\n  if ((h.symaddr = lookup_symbol(&amp;h, h.symname)) == 0) {\n    printf(\"Unable to find symbol: %s not found in executable\\n\", h.symname);\n    exit(-1);\n  }\n  close(fd);\n  if ((pid = fork()) &lt; 0) {\n    perror(\"fork\");\n    exit(-1);\n  }\n  if (pid == 0) {\n    if (ptrace(PTRACE_TRACEME, pid, NULL, NULL) &lt; 0) {\n      perror(\"PTRACE_TRACEME\");\n      exit(-1);\n    }\n    execve(h.exec, args, envp);\n    exit(0);\n  }\n  wait(&amp;status);\n  printf(\"Beginning analysis of pid: %d at %lx\\n\", pid, h.symaddr);\n  if ((orig = ptrace(PTRACE_PEEKTEXT, pid, h.symaddr, NULL)) &lt; 0) {\n    perror(\"PTRACE_PEEKTEXT\");\n    exit(-1);\n  }\n  trap = (orig &amp; ~0xff) | 0xcc;\n  if (ptrace(PTRACE_POKETEXT, pid, h.symaddr, trap) &lt; 0) {\n    perror(\"PTRACE_POKETEXT\");\n    exit(-1);\n  }\n  trace:\n  if (ptrace(PTRACE_CONT, pid, NULL, NULL) &lt; 0) {\n    perror(\"PTRACE_CONT\");\n    exit(-1);\n  }\n  wait(&amp;status);\n  if (WIFSTOPPED(status) &amp;&amp; WSTOPSIG(status) == SIGTRAP) {\n    if (ptrace(PTRACE_GETREGS, pid, NULL, &amp;h.pt_reg) &lt; 0) {\n      perror(\"PTRACE_GETREGS\");\n      exit(-1);\n    }\n    printf(\"\\nExecutable %s (pid: %d) has hit breakpoint 0x%lx\\n\",\n    h.exec, pid, h.symaddr);\n    printf(\"%%rcx: %llx\\n%%rdx: %llx\\n%%rbx: %llx\\n\"\n    \"%%rax: %llx\\n%%rdi: %llx\\n%%rsi: %llx\\n\"\n    \"%%r8: %llx\\n%%r9: %llx\\n%%r10: %llx\\n\"\n    \"%%r11: %llx\\n%%r12 %llx\\n%%r13 %llx\\n\"\n    \"%%r14: %llx\\n%%r15: %llx\\n%%rsp: %llx\",\n    h.pt_reg.rcx, h.pt_reg.rdx, h.pt_reg.rbx,\n    h.pt_reg.rax, h.pt_reg.rdi, h.pt_reg.rsi,\n    h.pt_reg.r8, h.pt_reg.r9, h.pt_reg.r10,\n    h.pt_reg.r11, h.pt_reg.r12, h.pt_reg.r13,\n    h.pt_reg.r14, h.pt_reg.r15, h.pt_reg.rsp);\n    printf(\"\\nPlease hit any key to continue: \");\n    getchar();\n    if (ptrace(PTRACE_POKETEXT, pid, h.symaddr, orig) &lt; 0) {\n      perror(\"PTRACE_POKETEXT\");\n      exit(-1);\n    }\n    h.pt_reg.rip = h.pt_reg.rip - 1;\n    if (ptrace(PTRACE_SETREGS, pid, NULL, &amp;h.pt_reg) &lt; 0) {\n      perror(\"PTRACE_SETREGS\");\n      exit(-1);\n    }\n    if (ptrace(PTRACE_SINGLESTEP, pid, NULL, NULL) &lt; 0) {\n      perror(\"PTRACE_SINGLESTEP\");\n      exit(-1);\n    }\n    wait(NULL);\n    if (ptrace(PTRACE_POKETEXT, pid, h.symaddr, trap) &lt; 0) {\n      perror(\"PTRACE_POKETEXT\");\n      exit(-1);\n    }\n    goto trace;\n    }\n    if (WIFEXITED(status))\n    printf(\"Completed tracing pid: %d\\n\", pid);\n    exit(0);\n  }\n\n  Elf64_Addr lookup_symbol(handle_t *h, const char *symname)\n  {\n    int i, j;\n    char *strtab;\n    Elf64_Sym *symtab;\n    for (i = 0; i &lt; h-&gt;ehdr-&gt;e_shnum; i++) {\n      if (h-&gt;shdr[i].sh_type == SHT_SYMTAB) {\n        strtab = (char *)&amp;h-&gt;mem[h-&gt;shdr[h-&gt;shdr[i].sh_link].sh_offset];\n        symtab = (Elf64_Sym *)&amp;h-&gt;mem[h-&gt;shdr[i].sh_offset];\n        for (j = 0; j &lt; h-&gt;shdr[i].sh_size/sizeof(Elf64_Sym); j++) {\n          if(strcmp(&amp;strtab[symtab-&gt;st_name], symname) == 0)\n          return (symtab-&gt;st_value);\n          symtab++;\n        }\n      }\n    }\n  return 0;\n  }\n}\n</code></pre>\n\n<p>Can anyone help me implement breakpoints for ARM? I have spent hours researching but I cannot figure it out.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 15, "creation_date": 1501614145, "post_id": 45445745, "comment_id": 77852423, "body": "Calling <code>main</code> leads to undefined behavior, at least in C++. This code could set your machine on fire if it wanted."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 7, "creation_date": 1501614178, "post_id": 45445745, "comment_id": 77852440, "body": "I removed the C++ tag, because your code is either C++ <b>or</b> C. and since your code is using <code>printf</code>, and you say it&#39;s C, the C++ tag is wrong."}, {"owner": {"reputation": 562, "user_id": 3397643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2da19655be5ceac32773d3be31bae20?s=128&d=identicon&r=PG&f=1", "display_name": "J0hn", "link": "https://stackoverflow.com/users/3397643/j0hn"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1501614240, "post_id": 45445745, "comment_id": 77852473, "body": "You could try running it and see what happens, however I agree with @AndyG this code is terrible.  Good on you for questioning it though and not just blindly accepting this code was right.  Shows critical thinking."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1501614311, "post_id": 45445745, "comment_id": 77852520, "body": "I mean, even if it <i>was</i> legal to call main from itself (like it is with any other function, basically), this would not be a terrible example of recursion."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 10, "creation_date": 1501614370, "post_id": 45445745, "comment_id": 77852551, "body": "It is allowed in C"}, {"owner": {"reputation": 95903, "user_id": 314291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e155276fa30aebfcbd9280d07fd1ddf8?s=128&d=identicon&r=PG", "display_name": "StuartLC", "link": "https://stackoverflow.com/users/314291/stuartlc"}, "edited": false, "score": 2, "creation_date": 1501614377, "post_id": 45445745, "comment_id": 77852556, "body": "&#39;main&#39; legalities aside, That guy is right. Once i hits zero the code stops recursing and returns to the next statement. The static variable means that it isn&#39;t stacked hence it remains at zero."}, {"owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "edited": false, "score": 0, "creation_date": 1501614456, "post_id": 45445745, "comment_id": 77852604, "body": "yeah he told this is bad code. this was supposed to teach us about static. Im still so confused about this."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1501614503, "post_id": 45445745, "comment_id": 77852633, "body": "Entrance exam - to teach about <code>static</code>? something is not adding up..."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 3, "creation_date": 1501614774, "post_id": 45445745, "comment_id": 77852808, "body": "the <code>if (--i)</code> decrements i before the test, and if i is not zero goes inside the block and calls <code>main</code> which is legal in C.  The second (and each subsequent time) main is entered, the static variable i is not re-initialized.  So, it really is 3 the second time.  Once i is decremented all the way down to zero, the if test returns false, and the block is skipped and the most deeply recursed main returns.  That&#39;s when each <code>printf</code> statement is executed."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1501617563, "post_id": 45445745, "comment_id": 77854430, "body": "Remarkably similar to <a href=\"https://stackoverflow.com/questions/45393083/\">Unexpected output of the <code>main()</code> function by repeated calls</a>.  The  printing is different, and there&#39;s an extra local variable that is printed too, but\u2026"}, {"owner": {"reputation": 10625, "user_id": 463813, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0330196fcbc9cd35a4cb4a82a5f249a6?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/463813/patrick"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1501667657, "post_id": 45445745, "comment_id": 77875160, "body": "@MarcusM&#252;ller, if a question goes for both C and C++ it would be very appropriate to run both tags. Now you&#39;re denying all C++ only experts to see this question and possible answer it..."}, {"owner": {"reputation": 10625, "user_id": 463813, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0330196fcbc9cd35a4cb4a82a5f249a6?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/463813/patrick"}, "edited": false, "score": 0, "creation_date": 1501668012, "post_id": 45445745, "comment_id": 77875400, "body": "i is a static variable, which means it&#39;s lifetime is the entire run of the program, the recursion happens before the prinft, so on the first run i=4, it will be lowered to 3 and then main() is called again, i will be set to &#39;2&#39;, and main() is called, i is set to &#39;1&#39;, main is called, then --i=0, so the function ends, we then come back from the recursion and &#39;0&#39; is printed... then we go back from another recursion and another &#39;0&#39; is printed, etc, etc, &#39;till you&#39;re left with &#39;0000&#39;. So the guy is right"}], "answers": [{"tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 22, "last_activity_date": 1501617221, "last_edit_date": 1501617221, "creation_date": 1501614201, "answer_id": 45445775, "question_id": 45445745, "link": "https://stackoverflow.com/questions/45445745/recursion-and-static-variables/45445775#45445775", "title": "Recursion and static variables", "body": "<p>It <em>is</em> legal to recurse on <code>main</code> in C<sup>*</sup> (although <em>why would you</em>?)</p>\n\n<p>Additionally, C11 (5.1.2.2.1) states:</p>\n\n<blockquote>\n  <p>It shall be defined with a return type of <code>int</code> ... [or] If the return type is not compatible with <code>int</code>, the\n  termination status returned to the host environment is unspecified.</p>\n</blockquote>\n\n<p>(C++ states that the return type must be <code>int</code>)</p>\n\n<p>So this portion of the code is actually standard-compliant, but the actual return is implementation-defined (thanks @chux)</p>\n\n<blockquote>\n  <p>Can anyone explain why the printf executes or is that guy wrong?</p>\n</blockquote>\n\n<p>If you're compiling C with a C++ compiler, guy is wrong. Otherwise the code will compile.</p>\n\n<p>Now that this is out of the way, the <code>printf</code> will indeed execute because the <code>static</code> variable is only ever initialized once, as per 6.2.4/3 </p>\n\n<blockquote>\n  <p>An object whose identifier is declared [...]with the\n  storage-class specifier <code>static</code> has static storage duration. Its lifetime is the entire\n  execution of the program and its stored value is initialized only once, prior to program\n  startup</p>\n</blockquote>\n\n<p><sup>*It is definitely NOT legal in C++. From [basic.start.main]:\n \"The function main shall not be used within a program\". There's a lot of C++ asides in this answer because the question was originally tagged as C++ and the information is useful\n</sup> </p>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1501614434, "post_id": 45445814, "comment_id": 77852591, "body": "I can&#39;t see how omitting the header would make calling <code>printf</code> undefined behavior. It seems to me it would require a compilation error (if no other declaration of <code>printf</code> is found). Calling a function that is not declared is not UB."}, {"owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "edited": false, "score": 0, "creation_date": 1501614688, "post_id": 45445814, "comment_id": 77852750, "body": "I just didnt add printf here just cuz I thought it was implied. Let me edit it"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1501614724, "post_id": 45445814, "comment_id": 77852773, "body": "Calling a function that is not declared used to make an implicit definition for it.  <code>printf(&quot;%d&quot;, i);</code> would use an implicit declaration as <code>int printf(char *, int);</code> which is incompatible with the actual definition.  Hence undefined behavior."}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1501614747, "post_id": 45445814, "comment_id": 77852788, "body": "@Fran&#231;oisAndrieux: If the declaration and the code don&#39;t agree on calling conventions, number of args, return types, etc, you&#39;re in trouble."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501616961, "post_id": 45445814, "comment_id": 77854093, "body": "&quot;Defining main as void main() is incorrect.&quot; is allowable per 5.1.2.2.1 1 &quot;or in some other implementation-defined manner.&quot; and so is ID behavior.  Yet it  is unnecessarily so as <code>int main()</code> is unquestionably OK - and shorter too."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501617712, "post_id": 45445814, "comment_id": 77854500, "body": "@chux: yes you are correct, although I suspect <i>other implementation-defined manner</i> mostly refers to the extra <code>envp</code> argument described in annex J: <b><i>J.5.1 Environment arguments</b> In a hosted environment, the main function receives a third argument, <code>char *envp[]</code>, that points to a null-terminated array of pointers to char, each of which points to a string that provides information about the environment for this execution of the program (5.1.2.2.1).</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501617927, "post_id": 45445814, "comment_id": 77854615, "body": "@chqrlie Agree about other <i>useful</i> implementation-defined manners.  IMO, <code>void main(.....</code> should live with <code>gets()</code>."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 7, "last_activity_date": 1501617403, "last_edit_date": 1501617403, "creation_date": 1501614332, "answer_id": 45445814, "question_id": 45445745, "link": "https://stackoverflow.com/questions/45445745/recursion-and-static-variables/45445814#45445814", "title": "Recursion and static variables", "body": "<p>There are multiple problems in this code:</p>\n\n<ul>\n<li><p><code>&lt;stdio.h&gt;</code> is not included, calling <code>printf(\"%d\", i);</code> has undefined behavior.</p></li>\n<li><p>The prototype for <code>main</code> without arguments is <code>int main(void)</code>.  Defining <code>main</code> as <code>void main()</code> is non portable and incorrect on some platforms.  Always use the Standard prototypes for <code>main</code> and return a valid exit status for good style.</p></li>\n<li><p>It is bad style to call the <code>main</code> function recursively in C, and it has undefined behavior in C++.</p></li>\n</ul>\n\n<p>Ignoring the fact that undefined behavior means anything can happen, including Indian firms using horrendous programming tests, the reason the program prints <code>0000</code> is you probably mistyped the <code>if (i--)</code> test or misplaced the braces from memory, or the guy is plain wrong. The <code>main</code> function calls itself recursively 3 times decrementing the same <code>i</code> variable each time until it becomes <code>0</code> and each instance prints the value of <code>i</code>, namely <code>0</code> before it returns to its caller, including the initial invocation of <code>main()</code>.</p>\n\n<p><code>static int i = 4;</code> inside a function defines a global variable <code>i</code> with an initial value of <code>4</code> that can only be accessed inside the block where it is defined.  All recursive instances of <code>main</code> access the same variable.</p>\n"}, {"comments": [{"owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "edited": false, "score": 1, "creation_date": 1501639772, "post_id": 45445953, "comment_id": 77861789, "body": "yeah but since we call main() before printf, the printf never gets executed right. Might be the case if printf is outside the if statement. But printf is inside the if and after the main() call"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 6, "last_activity_date": 1501616078, "last_edit_date": 1501616078, "creation_date": 1501614839, "answer_id": 45445953, "question_id": 45445745, "link": "https://stackoverflow.com/questions/45445745/recursion-and-static-variables/45445953#45445953", "title": "Recursion and static variables", "body": "<p>Abstracting from the quality and the name of this function.</p>\n\n<p>All <code>static</code> variables are initialised only one time during the program startup, and remain its value. </p>\n\n<p>When the startup routine calls main for the first time the variable <code>i</code> has value 4. Then you decrease its value to 3 and call main again. This time the value of <code>i</code> is 3 Then you decrease its value to 2 ......</p>\n"}, {"comments": [{"owner": {"reputation": 1885, "user_id": 2711672, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/XZH0c.jpg?s=128&g=1", "display_name": "pasha", "link": "https://stackoverflow.com/users/2711672/pasha"}, "edited": false, "score": 3, "creation_date": 1501615365, "post_id": 45445983, "comment_id": 77853198, "body": "Technically this is the answer to his question but it drifted away I guess"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 2, "creation_date": 1501646383, "post_id": 45445983, "comment_id": 77863404, "body": "Maybe the &quot;answer&quot; shows four 0s because <i>they</i> don&#39;t understand their own &quot;entrance exam&quot;... :v"}], "tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 30, "last_activity_date": 1501628214, "last_edit_date": 1501628214, "creation_date": 1501614935, "answer_id": 45445983, "question_id": 45445745, "link": "https://stackoverflow.com/questions/45445745/recursion-and-static-variables/45445983#45445983", "title": "Recursion and static variables", "body": "<p>In the context of the question being about recursion, it will print out \"000\" (I don't know why the answer shows 4 zeros because with '--i' decrement happens before assignment). If you unroll the calls you get:</p>\n\n<pre><code>if (--i) { //i == 3\n    if (--i) { //i == 2\n        if (--i) { //i == 1\n            if (--i) { //i == 0\n                // rest does not get evaluated since the condition is false\n            }\n            printf(\"%d\", i); // i is 0 now\n        }\n        printf(\"%d\", i); //i is still 0\n    }\n    printf(\"%d\", i); //i is still 0\n}\n</code></pre>\n\n<p>However like most have mentioned this code sucks and I would advise you never consider this level of sloppiness for any software you write.</p>\n"}, {"comments": [{"owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "edited": false, "score": 0, "creation_date": 1501661244, "post_id": 45451842, "comment_id": 77870586, "body": "Thank you man. That clears everything"}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1502110032, "post_id": 45451842, "comment_id": 78053997, "body": "Just a note: in that first block, on the second run, something does happen. And that something will probably blow out the stack. (If <code>i</code> is 0, <code>--i</code> is -1.)"}], "tags": [], "owner": {"reputation": 620, "user_id": 6660678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650f0bb98fc9fde7f182cd0b810bc25b?s=128&d=identicon&r=PG&f=1", "display_name": "mdfst13", "link": "https://stackoverflow.com/users/6660678/mdfst13"}, "is_accepted": true, "score": 13, "last_activity_date": 1501650205, "creation_date": 1501650205, "answer_id": 45451842, "question_id": 45445745, "link": "https://stackoverflow.com/questions/45445745/recursion-and-static-variables/45451842#45451842", "title": "Recursion and static variables", "body": "<blockquote>\n  <p>Can anyone explain why the printf executes or is that guy wrong?</p>\n</blockquote>\n\n<p>Because <code>main</code> returns.  </p>\n\n<p><a href=\"https://stackoverflow.com/a/45445983/6660678\">This answer</a> writes out the logic, but I see that you are still asking this in comments.  So I'm going to say the same thing in a different way and hope that it is clearer to you.  </p>\n\n<p>Because the variable is <code>static</code>, prior to the first call, the variable is declared and set to 4.  Because it is <code>static</code>, the same variable will be used every time.  It just skips over the declaration and initialization if called again (or likely even the first time, as <code>static</code> variables can be allocated before running).  </p>\n\n<p>In the first call, the variable is decremented to 3.  3 is a truthy value, so we do the block of the <code>if</code>.  This calls <code>main</code> recursively.  </p>\n\n<p>In this second call, the variable is decremented to 2.  2 is still truthy in C.  We call <code>main</code> recursively again.  </p>\n\n<p>In this third call, the variable is decremented to 1.  1 is still truthy.  We recurse to <code>main</code> again.  </p>\n\n<p>In this fourth call, the variable is decremented to 0.  0 is falsey in C.  We do not enter the block of the <code>if</code>.  We do not recurse.  We do not print.  There's nothing left to do in this call to <code>main</code>.  It returns at the end.  </p>\n\n<p>Now we're back in the third call.  We just returned from the call to <code>main</code>.  We are still inside the <code>if</code> block.  The next statement is a <code>printf</code>.  The value of the variable is now 0.  So we print a 0.  Nothing left to do, we return at the end.  </p>\n\n<p>Now we're back in the second call.  Still 0, so we print another 0 and return.  </p>\n\n<p>Now we're back in the first call.  Still 0, so we print another 0 and return.  </p>\n\n<p>We printed 0 three times, so 000</p>\n\n<p>As you note, on the way down, we don't print.  We print on the way back up.  By that time, the variable is 0.  And we enter the then block of the <code>if</code> three times.  So we recurse and then print three times.  </p>\n\n<p>When you call a function recursively, you don't eliminate the previous call.  You put it on the stack.  When done, you come back to the place where you left and continue with the next statement.  </p>\n\n<p>You may want to think about how the following three pieces of code will react differently:  </p>\n\n<pre><code>void recurse() {\n    static int i = 4;\n    if (--i) {\n        recurse();\n        printf(\"%d\", i);\n    }\n}\n</code></pre>\n\n<p>Prints 000 when called the first time.  Does nothing thereafter.  </p>\n\n<pre><code>void recurse(int i) {\n    if (--i) {\n        recurse(i);\n        printf(\"%d\", i);\n    }\n}\n</code></pre>\n\n<p>Will print 123 if called as <code>recurse(4)</code>.  As a parameter, we are dealing with a different <code>i</code> each time the function is called.  </p>\n\n<pre><code>void recurse(int i) {\n    if (--i) {\n        printf(\"%d\", i);\n        recurse(i);\n    }\n}\n</code></pre>\n\n<p>Prints 321 if called as <code>recurse(4)</code>.  Printing on the way down rather than when coming back up.  </p>\n\n<pre><code>void recurse(int i) {\n    printf(\"%d\", i);\n    if (--i) {\n        recurse(i);\n    }\n}\n</code></pre>\n\n<p>Prints 4321 if called as <code>recurse(4)</code>.  It prints on the way down, rather than the way up.  </p>\n\n<pre><code>void recurse() {\n    static int i = 4;\n    printf(\"%d\", i);\n    if (--i) {\n        recurse();\n    }\n}\n</code></pre>\n\n<p>Will print 4321.  We're printing on the way down, not the way up.  Note how the parameter and the <code>static</code> variable give the same result this way.  However, if this is called a second time, it will do nothing.  The parameter would print the same thing again.  </p>\n\n<pre><code>void recurse() {\n    int i = 4;\n    if (--i) {\n        recurse();\n        printf(\"%d\", i);\n    }\n}\n</code></pre>\n\n<p>Loops forever.  Without the <code>static</code> we make a new <code>i</code> each time.  This will run until it overloads the stack and crashes.  No output because it never makes it to the <code>printf</code>.  </p>\n\n<p>The easiest way to check this is to go somewhere like ideone.com and run the code.  Asking why it prints something is reasonable for this site.  But asking what it prints is something that you should answer yourself.  </p>\n"}], "owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5605, "favorite_count": 2, "closed_date": 1501679128, "accepted_answer_id": 45451842, "answer_count": 5, "score": 14, "last_activity_date": 1501657572, "creation_date": 1501614088, "last_edit_date": 1501616680, "question_id": 45445745, "link": "https://stackoverflow.com/questions/45445745/recursion-and-static-variables", "closed_reason": "Duplicate", "title": "Recursion and static variables", "body": "<p>So I was preparing for an entrance exam here in India when I came across this piece of C code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    static int i = 4;\n    if (--i) {\n        main();\n        printf(\"%d\", i);\n    }\n}\n</code></pre>\n\n<p>I thought the <code>printf</code> statement never gets executed and the output will be blank.\nBut I saw the answer to be <code>0000</code> and that this happens due to the <code>static</code> keyword with the <code>int</code>.</p>\n\n<p>Can anyone explain why the printf executes or is that guy wrong?</p>\n"}, {"tags": ["c", "pointers", "recursion", "null", "children"], "comments": [{"owner": {"reputation": 325, "user_id": 6684651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZzVwu.png?s=128&g=1", "display_name": "mike bayko", "link": "https://stackoverflow.com/users/6684651/mike-bayko"}, "edited": false, "score": 0, "creation_date": 1501613719, "post_id": 45445597, "comment_id": 77852173, "body": "In C a pointer can be <code>NULL</code>, but a reference can not once it has been assigned."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501613763, "post_id": 45445597, "comment_id": 77852203, "body": "Could you rephrase? I don&#39;t get what you mean by &quot; set a reference pointed by a pointer to NULL&quot;. Or maybe describe a situation example and what the result should be after what you try to do has been done."}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501613848, "post_id": 45445597, "comment_id": 77852248, "body": "@Yunnosch I want to set to NULL <code>fs-&gt;child[20]</code> which is pointed by <code>el</code>"}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 325, "user_id": 6684651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZzVwu.png?s=128&g=1", "display_name": "mike bayko", "link": "https://stackoverflow.com/users/6684651/mike-bayko"}, "edited": false, "score": 0, "creation_date": 1501613907, "post_id": 45445597, "comment_id": 77852281, "body": "@mikebayko Got it thank you! Do you think there&#39;s a way to bypass this or to do it in another way?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614041, "post_id": 45445597, "comment_id": 77852353, "body": "What (within the scope of C) is a reference?"}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1501614085, "post_id": 45445597, "comment_id": 77852380, "body": "@xing Yes that&#39;s right. But I don&#39;t think that that&#39;s the reason why <code>fs-&gt;child[20]</code> is not set to NULL"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1501614110, "post_id": 45445597, "comment_id": 77852396, "body": "<code>delete(fs);     printf(&quot;Delete: %s\\n&quot;, fs-&gt;child[20]-&gt;name);</code> and <code>deleteP(fs);     printf(&quot;DeleteP: %s\\n&quot;, fs-&gt;child[20]-&gt;name);</code> :  These are UB."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614190, "post_id": 45445597, "comment_id": 77852447, "body": "After <code>el = NULL;</code> I would be surprised if <code>el != NULL</code>. What makes you think it is not NULL?"}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501614320, "post_id": 45445597, "comment_id": 77852528, "body": "@BLUEPIXY Why is that UB? Because it could execute <code>printf</code> before <code>delete</code>?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614429, "post_id": 45445597, "comment_id": 77852589, "body": "Do you expect <code>free(el);     el = NULL;</code> to do anything to the memory pointed to by <code>el</code>?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501614448, "post_id": 45445597, "comment_id": 77852600, "body": "@L.Carbini one dereference <code>NULL</code>. one using it after  <code>free</code>&#39;d."}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614576, "post_id": 45445597, "comment_id": 77852676, "body": "@Yunnosch <code>el</code> is NULL after that, but my goal was to make <code>fs-&gt;child[20]</code> become NULL too. I have to make <code>fs-&gt;child[20]</code> become NULL and I only have access to <code>el</code> in that portion of code."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614634, "post_id": 45445597, "comment_id": 77852710, "body": "And what happens with <code>*el = NULL; </code> ?"}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614642, "post_id": 45445597, "comment_id": 77852714, "body": "@Yunnosch that was my idea, but it seems wrong now :p"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614687, "post_id": 45445597, "comment_id": 77852747, "body": "It seems wrong now because...? Should not do it after free of course."}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614767, "post_id": 45445597, "comment_id": 77852803, "body": "@Yunnosch <code>error: assigning to &#39;Elem&#39; (aka &#39;struct Elem&#39;) from incompatible       type &#39;void *&#39;</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614847, "post_id": 45445597, "comment_id": 77852866, "body": "Would you like to edit that into your question? Or is it alread in there an I do not see it?"}, {"owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501614978, "post_id": 45445597, "comment_id": 77852956, "body": "@Yunnosch I just changed this function:   <code>void deleteP(FS *fs){ \tElem *el = calloc(1, sizeof (Elem)); \tel = fs-&gt;child[20];     free(el); \t*el = NULL; }</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "edited": false, "score": 1, "creation_date": 1501615127, "post_id": 45445597, "comment_id": 77853056, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/150756/discussion-between-yunnosch-and-l-carbini\">continue this discussion in chat</a>."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1501618597, "post_id": 45445597, "comment_id": 77854984, "body": "I&#39;m trying to figure out why you are calling <code>el=calloc()</code> only to set <code>el=fs-&gt;child</code> on the very next line, thus losing the reference to the memory that you just allocated.  That doesn&#39;t delete things, it creates memory leaks!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1501619136, "post_id": 45445597, "comment_id": 77855230, "body": "@DavidHoelzer Did you see the ticked comment by xing?"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1501623034, "post_id": 45445597, "comment_id": 77857120, "body": "@Yunnosch Nope. Once it&#39;s past 5 comments I&#39;m loathe to read them."}], "answers": [{"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 3, "last_activity_date": 1501652711, "last_edit_date": 1501652711, "creation_date": 1501617041, "answer_id": 45446544, "question_id": 45445597, "link": "https://stackoverflow.com/questions/45445597/how-to-free-and-write-to-null-a-pointer-in-an-array-inside-a-struct-indirectly/45446544#45446544", "title": "How to free and write to NULL a pointer in an array inside a struct, indirectly via pointer to struct?", "body": "<p>Allow me to phrase your goal in my words<br>\n(after verifying my understanding in chat):</p>\n\n<ul>\n<li>you want to free memory pointed to by a pointer which is stored in an array,\nwhich is inside a struct, which you get a pointer to</li>\n<li>you cannot access the array member directly,<br>\nonly via the pointer to the containing struct</li>\n<li>you also want to write NULL to the array member</li>\n<li>looking at your code, you attempted to do that by making a copy of the array member (which is a pointer)</li>\n<li>it mostly works, only that the array member does not end up being NULL\n(and some problems mentioned by xing and BLUEPIXY)</li>\n</ul>\n\n<p>Basically, you need a pointer to the array member, instead of a copy of the array member.</p>\n\n<p>So your function should be:</p>\n\n<pre><code>void deleteP(FS *fs){\n    Elem **el; // pointer to pointer, instead of pointer (and no calloc)\n    el = &amp;(fs-&gt;child[20]); // pointer to array member\n    free(*el); // free the pointer in the array member (not a copy of it),\n               // though the effect is the same\n    *el = NULL; // write NULL to the array member, not a copy of it,\n                // this is what changes the effect to what you want \n}\n</code></pre>\n\n<p>If I did not mistype anything, this is more or less the result of our chat.<br>\nAnd as far as I understand, it solves your problem. Cheers.</p>\n\n<p>As far as I can tell, this should also fix the memory leak found by xing inside <code>deleteP(...)</code>.<br>\nBut be careful to also fix it in <code>memoryset(...)</code>.</p>\n\n<p>This does NOT fix the problems of UB (undefined behaviour) as found by BLUEPIXY.\nFor this you need to rework your debug prints and make sure not to dereference any pointers to already freed memory (question of order of doing things) and also not to dereference any pointer which was set to NULL.</p>\n\n<p>By the way, this could be done without a local pointer variable; doing everything via the parameter <code>fs</code>. But I kept the solution closer to your own code for better clarity of what is the difference. Also in my opinion your way of doing it via local pointer is more readable. It might even be faster, but seeing how good modern compilers are, I doubt it; the actual reason is clarity and readability.</p>\n"}], "owner": {"reputation": 55, "user_id": 8099213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/86e14bcb14dde215615794de42a76f42?s=128&d=identicon&r=PG&f=1", "display_name": "L. Carbini", "link": "https://stackoverflow.com/users/8099213/l-carbini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 45446544, "answer_count": 1, "score": 1, "last_activity_date": 1501652801, "creation_date": 1501613516, "last_edit_date": 1501652801, "question_id": 45445597, "link": "https://stackoverflow.com/questions/45445597/how-to-free-and-write-to-null-a-pointer-in-an-array-inside-a-struct-indirectly", "title": "How to free and write to NULL a pointer in an array inside a struct, indirectly via pointer to struct?", "body": "<p>I have to set a reference pointed by a pointer to NULL.<br>\nBut the function <code>deleteP(...)</code> doesn't seem to work, indicated by the Output.<br>\nThe functions <code>delete()</code> and <code>memoryset()</code> work in some way, even if the latter just fills the memory (pointed to by the pointer in the array) with zeroes.<br>\nI want the pointer in the array to finally be NULL and that is not working.</p>\n\n<p>I need to do everything (i.e. set <code>fs-&gt;child[20]</code> to NULL etc.) via pointer to the struct (which is <code>el</code>in my code, a local pointer variable inside <code>deleteP(...)</code> ). This is because I am iterating over <code>fs</code> children, and their children after that, a lot of times, and I put the current child in <code>el</code>.</p>\n\n<p>How could I solve it?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define HEIGHT 255\n#define LENGTH 256\n#define MAX_CHILDREN 1024\n\ntypedef struct FS FS;\ntypedef struct Elem Elem;\n\nstruct Elem {\n    char name[LENGTH];\n    char content[256];\n    int isFile;\n    int emptyCells;\n    Elem *child[MAX_CHILDREN];\n};\n\nstruct FS {\n    int emptyCells;\n    Elem *child[MAX_CHILDREN];\n};\n\nvoid delete(FS *fs){\n    free(fs-&gt;child[20]);\n    fs-&gt;child[20] = NULL;\n}\n\nvoid deleteP(FS *fs){\n    Elem *el = calloc(1, sizeof (Elem));\n    el = fs-&gt;child[20];\n    free(el);\n    el = NULL;\n}\n\nvoid memoryset(FS *fs){\n    Elem *el = calloc(1, sizeof (Elem));\n    el = fs-&gt;child[20];\n    memset(el, 0, sizeof(Elem));\n}\n\nint main(int argc, const char * argv[]) {      \n\n    FS *fs = calloc (1, sizeof(FS));\n    fs-&gt;emptyCells = MAX_CHILDREN;\n    fs-&gt;child[20] = calloc (1, sizeof(Elem));\n    strcpy(fs-&gt;child[20]-&gt;name, \"Hello\");\n    printf(\"No delete: %s\\n\", fs-&gt;child[20]-&gt;name);\n\n    memoryset(fs);\n    printf(\"MEMSET: %s\\n\", fs-&gt;child[20]-&gt;name);\n\n    fs-&gt;child[20] = calloc (1, sizeof(Elem));\n    strcpy(fs-&gt;child[20]-&gt;name, \"Hello\");\n    delete(fs);\n    printf(\"Delete: %s\\n\", fs-&gt;child[20]-&gt;name);\n\n    fs-&gt;child[20] = calloc (1, sizeof(Elem));\n    strcpy(fs-&gt;child[20]-&gt;name, \"Hello\");\n    deleteP(fs);\n    printf(\"DeleteP: %s\\n\", fs-&gt;child[20]-&gt;name);\n\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>No delete: Hello\nMEMSET: \nDelete: (null)\nDeleteP: Hello\n</code></pre>\n"}, {"tags": ["c", "io", "temp"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1501618394, "post_id": 45445545, "comment_id": 77854881, "body": "Define your portability requirements.  The standard C library has nothing to offer.  If you need portability between Windows and non-Windows, you&#39;re going to need to define a portable interface to non-portable implementations of the function(s) \u2014 what you do on Windows will be different in detail from what you do on Unix.  I&#39;m not clear the <code>mkdir()</code> is necessary; you can simply demand that the directory be already created."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501618636, "post_id": 45445545, "comment_id": 77855009, "body": "I wrote a Unix-based set of functions: <code>extern void tfn_setdirectory(const char *dir); extern void tfn_setprefix(const char *pfx); extern int  tfn_tempfilename(const char *sfx, char *buffer, size_t bufsiz); extern int  tfn_tempdirname(const char *sfx, char *buffer, size_t bufsiz);</code> to cover a portability problem between different variants of Unix. It could be used as a basis for a Windows and Unix variant. It uses two 32-bit random numbers as part of the name \u2014 and you can control the directory and file suffix. It uses a sequence of environment variables to find the default directory."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501618690, "post_id": 45445545, "comment_id": 77855032, "body": "Shout if you would like the code \u2014 either by comment <code>@Jonathan</code> or see my profile."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1501629011, "last_edit_date": 1501629011, "creation_date": 1501628715, "answer_id": 45448943, "question_id": 45445545, "link": "https://stackoverflow.com/questions/45445545/how-to-safely-and-portably-create-temp-file-and-get-its-name/45448943#45448943", "title": "How to safely and portably create temp file AND get its name", "body": "<p>In windows  <code>GetTempFileName</code> function. In Linux if you do not more than 25 files (bug in some implementations) <code>mkstemp</code> family of functions or <code>tmpfile</code></p>\n"}], "owner": {"reputation": 163, "user_id": 5247820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f6922afa167fe9e1471e81e95df0f19?s=128&d=identicon&r=PG&f=1", "display_name": "SonicN", "link": "https://stackoverflow.com/users/5247820/sonicn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1501629011, "creation_date": 1501613292, "question_id": 45445545, "link": "https://stackoverflow.com/questions/45445545/how-to-safely-and-portably-create-temp-file-and-get-its-name", "title": "How to safely and portably create temp file AND get its name", "body": "<p>I'm working with some legacy code which passes around the name of a file. I'd like to create a temp file and give the legacy code the name of the file to be opened later using legacy functions. <code>tmpnam</code> is unsafe due to the race case between getting the name and creating the file. <code>mkdir</code> isn't portable to Windows and doesn't let me have the name of the file. How can I create a temp file safely, portably, and with retention of file name?</p>\n"}, {"tags": ["c", "singly-linked-list", "insert-update"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1501612707, "post_id": 45445328, "comment_id": 77851648, "body": "<code>head=temp-&gt;next;</code> --&gt; <code>head=temp;</code>"}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1501706067, "post_id": 45445328, "comment_id": 77902013, "body": "You need to change scanf(&quot;%c&quot;,&amp;ch); to scanf(&quot; %c&quot;,&amp;ch); at both places."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8313117"}, "is_accepted": false, "score": 1, "last_activity_date": 1501612748, "creation_date": 1501612748, "answer_id": 45445390, "question_id": 45445328, "link": "https://stackoverflow.com/questions/45445328/linked-list-error-on-inserting-new-data-in-node-or-element-in-c/45445390#45445390", "title": "linked list error on inserting new data in node or element in C", "body": "<p>Try changing head=temp->next to head=temp. You are assigning head to itself again. </p>\n"}, {"tags": [], "owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "is_accepted": false, "score": 0, "last_activity_date": 1501704845, "last_edit_date": 1501704845, "creation_date": 1501613626, "answer_id": 45445620, "question_id": 45445328, "link": "https://stackoverflow.com/questions/45445328/linked-list-error-on-inserting-new-data-in-node-or-element-in-c/45445620#45445620", "title": "linked list error on inserting new data in node or element in C", "body": "<p>Change your code as below. scanf(\"%c\",&amp;ch); to scanf(\" %c\",&amp;ch); and head=temp->next; to head=temp; For Scanf see below link\nSee link <a href=\"https://stackoverflow.com/questions/18425307/scanf-function-doesnt-work\">scanf() function doesn&#39;t work?</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct node\n{\n    int info;\n    struct node* next;\n}Node;\ntypedef Node* list;\nvoid printlist(list n)\n{\n    while(n!=NULL)\n    {\n        printf(\"%d \",n-&gt;info);\n        n=n-&gt;next;\n    }\n}\nint main()\n{\n    printf(\"Hello world!\\n\");\n    list head,temp;\n    char ch;\n    head=NULL;\n    printf(\"Want to add data:\\n\");\n    scanf(\" %c\",&amp;ch);\n    while(ch=='y'||ch=='Y')\n    {\n        temp=(list)malloc(sizeof(Node));\n        scanf(\"%d\",&amp;temp-&gt;info);\n        temp-&gt;next=head;\n        head = temp;\n        printf(\"Want to add more data:\\n\");\n        scanf(\" %c\",&amp;ch);\n    }\n    printlist(head);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8401370, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sKVFFOaxWEA/AAAAAAAAAAI/AAAAAAAAAKQ/G7ggBDBNW9U/photo.jpg?sz=128", "display_name": "Subhajit Paul", "link": "https://stackoverflow.com/users/8401370/subhajit-paul"}, "edited": false, "score": 0, "creation_date": 1501643371, "post_id": 45445920, "comment_id": 77862631, "body": "Still having same  problem"}, {"owner": {"reputation": 1, "user_id": 8401370, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sKVFFOaxWEA/AAAAAAAAAAI/AAAAAAAAAKQ/G7ggBDBNW9U/photo.jpg?sz=128", "display_name": "Subhajit Paul", "link": "https://stackoverflow.com/users/8401370/subhajit-paul"}, "edited": false, "score": 0, "creation_date": 1501643392, "post_id": 45445920, "comment_id": 77862635, "body": "Want any other suggestion"}], "tags": [], "owner": {"reputation": 1, "user_id": 7899763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ec107379ae29a51f678d7c133c3be6?s=128&d=identicon&r=PG&f=1", "display_name": "snkamal", "link": "https://stackoverflow.com/users/7899763/snkamal"}, "is_accepted": false, "score": 0, "last_activity_date": 1501614715, "creation_date": 1501614715, "answer_id": 45445920, "question_id": 45445328, "link": "https://stackoverflow.com/questions/45445328/linked-list-error-on-inserting-new-data-in-node-or-element-in-c/45445920#45445920", "title": "linked list error on inserting new data in node or element in C", "body": "<p>In addition to the above answers, if you wish to maintain the order in which the elements are added to a linked list (the head always remains fixed, only changes to point to the first element if it was NULL initially), the following adjustments take care of that. Any new element is always added to the end of the linked list with the head fixed at the first element.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node\n{\n  int info;\n  struct node* next;\n}Node;\n\ntypedef Node* list;\n\nvoid printlist(list n)\n{\n  while(n!=NULL)\n  {\n     printf(\"%d \",n-&gt;info);\n     n=n-&gt;next;\n  }\n}\n\nint main(){\n\n   printf(\"Hello world!\\n\");\n   list head,temp;\n   char ch;\n   head=NULL;\n   printf(\"Want to add data:\\n\");\n   scanf(\"%c\",&amp;ch);\n\n   while(ch=='y'||ch=='Y'){\n\n      temp=(list)malloc(sizeof(Node));\n      scanf(\"%d\",&amp;temp-&gt;info);\n      temp-&gt;next=NULL;\n      if(head == NULL){\n          head = temp;\n       }\n      else{\n          list temp2 = head;\n          while(temp2-&gt;next != NULL){\n             temp2 = temp2-&gt;next;\n          }\n          temp2-&gt;next = temp;\n      }\n    printf(\"Want to add more data:\\n\");\n    scanf(\" %c\",&amp;ch);\n    }\n   printlist(head);\n   return 0;\n  }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8401370, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sKVFFOaxWEA/AAAAAAAAAAI/AAAAAAAAAKQ/G7ggBDBNW9U/photo.jpg?sz=128", "display_name": "Subhajit Paul", "link": "https://stackoverflow.com/users/8401370/subhajit-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1501704845, "creation_date": 1501612554, "question_id": 45445328, "link": "https://stackoverflow.com/questions/45445328/linked-list-error-on-inserting-new-data-in-node-or-element-in-c", "title": "linked list error on inserting new data in node or element in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct node\n{\n    int info;\n    struct node* next;\n}Node;\ntypedef Node* list;\nvoid printlist(list n)\n{\n    while(n!=NULL)\n    {\n        printf(\"%d \",n-&gt;info);\n        n=n-&gt;next;\n    }\n}\nint main()\n{\n    printf(\"Hello world!\\n\");\n    list head,temp;\n    char ch;\n    head=NULL;\n    printf(\"Want to add data:\\n\");\n    scanf(\"%c\",&amp;ch);\n    while(ch=='y'||ch=='Y')\n    {\n        temp=(list)malloc(sizeof(Node));\n        scanf(\"%d\",&amp;temp-&gt;info);\n        temp-&gt;next=head;\n        head=temp-&gt;next;\n        printf(\"Want to add more data:\\n\");\n        scanf(\"%c\",&amp;ch);\n    }\n    printlist(head);\n    return 0;\n}\n</code></pre>\n\n<p>this is my code.\nmy problem is here that I cannot and data in my list but the node is added ...\nI think there is something wrong in my \"scanf\" function....\nplease help me to solve this problem and send me the corrected code</p>\n\n<pre><code>                                  thank u...hope I can get a reply soon\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user820304"}, "edited": false, "score": 6, "creation_date": 1501611137, "post_id": 45444918, "comment_id": 77850707, "body": "<code>&amp;</code> is a bitwise AND operator."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1501611207, "post_id": 45444918, "comment_id": 77850741, "body": "A loooong question that can be solved by a simple search through some C operators documentation."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1501611433, "post_id": 45444918, "comment_id": 77850878, "body": "<i>Unary</i> <code>&amp;</code> is address-of operator. What you see here is a <i>binary</i> <code>&amp;</code>, which is a completely different story. It has nothing to do with unary <code>&amp;</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1501613746, "post_id": 45444918, "comment_id": 77852193, "body": "<code>while ((TIFR &amp; 0x01) == 0);</code> this is something I personally hate. Who remembers what is in the bit 0 of the TIFR register. do not save your fingers <code>&amp;&amp;</code> keyboard - write something more human readable <code>while ((TIFR &amp; (1 &lt;&lt; TOV0)) == 0);</code> or <code>while (!(TIFR &amp; (1 &lt;&lt; TOV0)));</code> Avoid <code>DAC1 -&gt; CR = 0x34674534;</code> - I saw similar on the STM forum asking - what is wrong in my configuration."}], "answers": [{"tags": [], "owner": {"reputation": 5464, "user_id": 59527, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5728955f444a62bbba61ba09690c50ab?s=128&d=identicon&r=PG", "display_name": "Sijmen Mulder", "link": "https://stackoverflow.com/users/59527/sijmen-mulder"}, "is_accepted": false, "score": 4, "last_activity_date": 1501611569, "creation_date": 1501611569, "answer_id": 45445091, "question_id": 45444918, "link": "https://stackoverflow.com/questions/45444918/not-sure-about-operator/45445091#45445091", "title": "Not sure about &amp; operator", "body": "<p>It's a bitwise AND. Here, it\u2019s used to filter out all but the last bit:</p>\n\n<pre><code>nnnnnnnn\n00000001  (0x01)\n-------- &amp;\n0000000n\n</code></pre>\n\n<p>This means that <code>while ((n &amp; 0x01) == 0)</code> will loop as long as the rightmost bit is <em>not</em> set.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1501612997, "last_edit_date": 1501612997, "creation_date": 1501612591, "answer_id": 45445342, "question_id": 45444918, "link": "https://stackoverflow.com/questions/45444918/not-sure-about-operator/45445342#45445342", "title": "Not sure about &amp; operator", "body": "<p><code>&amp;</code> is the bitwise and operator: the expression <code>TIFR &amp; 1</code> evaluates to <code>1</code> if and only if the least significant bit of <code>TIFR</code> is <code>1</code>.</p>\n\n<p>The full statement <code>while ((TIFR &amp; 0x01) == 0);</code> is called a busy loop: it repeats the test as long as is fails. The body of the <code>while</code> loop is the empty statement <code>;</code>. <code>TIFR</code> should be defined as an expression that returns the value of some hardware register that will eventually have its low order bit set, typically the <code>volatile</code> qualified address for the memory mapped hardware register.</p>\n\n<p>The program will run at 100% CPU, draining the battery, waiting for this value to change, hence the expression <em>busy wait</em>.  It might be better to use a <code>nanosleep()</code> function call to wait efficiently in the body of this loop.</p>\n"}, {"tags": [], "owner": {"reputation": 977, "user_id": 5487769, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-EoZSfEaOzPk/AAAAAAAAAAI/AAAAAAAAAAw/tx0tg5WpYUw/photo.jpg?sz=128", "display_name": "adrian", "link": "https://stackoverflow.com/users/5487769/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1501612751, "creation_date": 1501612751, "answer_id": 45445391, "question_id": 45444918, "link": "https://stackoverflow.com/questions/45444918/not-sure-about-operator/45445391#45445391", "title": "Not sure about &amp; operator", "body": "<p>The <code>&amp;</code> operator has a few uses. In this case, it operates on two pieces of data. This is very similar to the AND gate. It outputs 1 if both inputs are 1, otherwise it outputs 0.</p>\n\n<p>In your example, we use the <code>&amp;</code> operator to get the status of a certain bit:</p>\n\n<pre><code>nnnnnnnn\n00000001\n-------- &amp;\n0000000n\n</code></pre>\n\n<p>An example: say the value of nnnnnnnn was 00001011. We only want the status of the last bit, so we <code>&amp;</code> this value with 00000001. Since the logical AND operation will output a 1 only if the inputs are both 1, <code>&amp;</code>ing our value with 00000001 will output 00000001 if, and only if, the last bit is 1. </p>\n\n<p>In C the <code>&amp;</code> operator can also be used in front of a pointer to indicate that you want the value of the pointer, not the value contained by the pointer (that'd be with  <code>*</code>) These two differ in syntax.</p>\n\n<pre><code>0xNN &amp; 0xKK                        /* Logical AND */\nuint32_t valueOfPointer = &amp;ptr;    /* Value of pointer */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 0, "last_activity_date": 1501639000, "last_edit_date": 1501639000, "creation_date": 1501635782, "answer_id": 45449847, "question_id": 45444918, "link": "https://stackoverflow.com/questions/45444918/not-sure-about-operator/45449847#45449847", "title": "Not sure about &amp; operator", "body": "<p>If you look at a C Operator Precedence chart such as this one, <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">C Operator Precedence</a>, you will notice that there are several symbols, and <code>&amp;</code> is one of those, which mean different things depending on the context the symbol appears.</p>\n\n<p>And in some cases more than one symbol is combined in order to create an operator for example <code>+=</code> or <code>&lt;&lt;</code> so I can understand why you might be running into some confusion.</p>\n\n<p>With a <code>while</code> statement the C compiler is going to look at what is in between the parenthesis and try its best to turn that into a statement that expresses either <code>true</code> (represented by a non-zero value though an explicitly boolean statement will return a value of one) or <code>false</code> (represented by a value of zero).</p>\n\n<p>So the statement <code>while ((TIFR &amp; 0x01) == 0);</code> is a <code>while</code> loop that has a condition but no actual body. The result is that this loop will continue looping until such time as the condition changes from non-zero (<code>true</code>) to zero (<code>false</code>). This condition will be met when the register's least significant bit becomes a one and the bitwise And between the register and the value of 0x01 becomes non-zero.</p>\n\n<p>The C compiler sees the use of the symbol ampersand (<code>&amp;</code>) in this context as the bitwise And operator. So what the machine code generated is to perform a bitwise And of the hexadecimal constant 1 with the value of what TIFR represents.</p>\n\n<p>In your case TIFR represents the Timer/Counter Interrupt Flag Register so what the condition is doing is performing a bitwise And of 0x01 with the register. I assume that the low order bit of the register, the TOV0 bit in your diagram, will be set to zero or off until some external event happens which then sets the bit to one or on. When this happens the bitwise And evaluates to non-zero and the logical equality fails exiting the loop.</p>\n\n<p>So long as the TOV0 bit is off the bitwise And with 0x01 will result in a zero value which the <code>while()</code> then compares to a value of zero. As soon as the bit is set to one or on, the bitwise And will result in a non-zero value which the <code>while()</code> compares to zero at which point the loop will exit since the compare fails.</p>\n\n<p><strong>Unary versus Binary <code>&amp;</code> Operator</strong></p>\n\n<p>The basic rule for the single ampersand (<code>&amp;</code>) is that when it is a unary operator then it is seen as being the Address Of operator. When it is seen as a binary operator then it is seen as being the bitwise And operator.</p>\n\n<p>If it is used with one of the assignment operator variations as in <code>&amp;=</code> then it is seen as evaluating the right side and then take that value and perform a bitwise And with what is on the left side of the operator and assigning the resulting value to the left side variable.</p>\n\n<p>So some examples.</p>\n\n<pre><code>int myInt = 1;\nint *pInt = &amp;myInt;      // unary operator so this is the Address Of use\nint myInt2 = myInt &amp; 3;  // binary operator so this is the bitwise And use\nint aInt[] = {1,3,2,4,5,7,8};\nint *pLast = &amp;aInt[sizeof(aInt)/sizeof(aInt[0]) - 1];  // unary operator so Address Of use\n\nwhile (pLast &gt;= &amp;aInt[0] &amp;&amp; ! (*pLast &amp; 0x01)) pLast--;\nif (pLast &gt;= aInt) {\n    *pLast &amp;= ~0x01;  // clear the least significant bit of value pointed to\n}\n</code></pre>\n\n<p>Notice in the while statement we are using the ampersand as both the Address Of operator and the bitwise And operator. Plus we are using two ampersands, <code>&amp;&amp;</code>, for the logical And operator. And we are also using the bitwise And assignment operator, <code>&amp;=</code>, in the body of the <code>if</code> statement (and there can not be any white space between one symbol and the next so <code>&amp;=</code> is valid but <code>&amp; =</code> is not).</p>\n\n<p>What this loop does is iterates through the array from the end until an odd numbered value is found, a value that does have the least significant bit set. If such a value is found then we turn the least significant bit off using the bitwise And assignment.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5910827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1501639000, "creation_date": 1501610993, "last_edit_date": 1501612184, "question_id": 45444918, "link": "https://stackoverflow.com/questions/45444918/not-sure-about-operator", "title": "Not sure about &amp; operator", "body": "<p>I tried to make a simple circuit to toggle a LED every 30 seconds. The Timer/Counter Interrupt Flag Register (TIFR) is an 8 bit register with the following spec:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ew3fe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ew3fe.png\" alt=\"image of bit layout of 8 bit Timer Interrupt Flag Register\"></a></p>\n\n<p>Note that this is a typical AVR chip that doesn't matter for the purpose of this question. When a timer overflow occurs the bit TOV0 will be set to one by hardware. This lets me know the status of the timer. Then I will clear it by writing a logic 1 to the TIFR register. Here's the code:</p>\n\n<pre><code>#include &lt;avr/io.h&gt;\n#define LED PB0\n\nint main(void)\n{\nuint16_t timerOverflowCount=0;\n\nDDRB=0xff; //configure PORTD as output  \nTCNT0=0x00; //set counter to 0\nTCCR0B=(1&lt;&lt;CS00) | (1&lt;&lt;CS02);\n\n\n   while(1)\n   {\n       while ((TIFR &amp; 0x01) == 0);\n\n       TCNT0 = 0x00;\n       TIFR=0x01;\n       timerOverflowCount++;\n\n       if (timerOverflowCount&gt;=919)\n       {\n           PORTB ^= (0x01 &lt;&lt; LED);\n           timerOverflowCount=0;\n       }\n   }\n\n}\n</code></pre>\n\n<p>What I don't understand about this code is the condition check of the second <code>while</code>:</p>\n\n<pre><code>while ((TIFR &amp; 0x01) == 0);\n</code></pre>\n\n<p>Obviously, it looks like the loop causes a delay until a counter overflow occurs. Then the control passes to the next statements.</p>\n\n<p>I'm not an experienced C user so I don't understand what the <code>&amp;</code> operand does in the <code>while</code> statement's condition check. My understanding is that in C <code>&amp;</code> is an address-of-operator which finds the address of a typical object. I am not sure of the meaning of the <code>&amp;</code> operator here. </p>\n"}, {"tags": ["python", "c++", "c", "ctypes"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1501612214, "post_id": 45444910, "comment_id": 77851343, "body": "Can <code>extern &quot;C&quot;</code> even <i>be</i> applied? A single overloaded function will break any attempt."}, {"owner": {"reputation": 885, "user_id": 17215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12db4ec634da20e46db2967a6c196fdc?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/17215/mike"}, "edited": false, "score": 0, "creation_date": 1501885388, "post_id": 45444910, "comment_id": 77993810, "body": "Don&#39;t use ctypes. Use a C++-aware wrapper (CLIF, SIP, SWIG, etc)"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1501616300, "post_id": 45445026, "comment_id": 77853723, "body": "This is a general idea, but inapplicable to the OP&#39;s problem.  Download the package and peek into the header files... be prepared."}, {"owner": {"reputation": 729, "user_id": 5942006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe054f41dc543395631acc84ac04f60?s=128&d=identicon&r=PG&f=1", "display_name": "systemcpro", "link": "https://stackoverflow.com/users/5942006/systemcpro"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1501616916, "post_id": 45445026, "comment_id": 77854061, "body": "Ah! I just did so. Oh Dear. So an entire new adaption layer unless there is some tool for it that somebody knows. I know of none :("}], "tags": [], "owner": {"reputation": 729, "user_id": 5942006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe054f41dc543395631acc84ac04f60?s=128&d=identicon&r=PG&f=1", "display_name": "systemcpro", "link": "https://stackoverflow.com/users/5942006/systemcpro"}, "is_accepted": false, "score": 1, "last_activity_date": 1501620460, "last_edit_date": 1501620460, "creation_date": 1501611355, "answer_id": 45445026, "question_id": 45444910, "link": "https://stackoverflow.com/questions/45444910/globally-apply-extern-c-when-compiling/45445026#45445026", "title": "Globally Apply extern C when compiling", "body": "<p>Do the following in your C++ file so you don't have to change <code>headerfile.h</code>:</p>\n\n<pre><code>extern \"C\" {\n#include &lt;headerfile.h&gt;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1501611711, "creation_date": 1501611711, "answer_id": 45445126, "question_id": 45444910, "link": "https://stackoverflow.com/questions/45444910/globally-apply-extern-c-when-compiling/45445126#45445126", "title": "Globally Apply extern C when compiling", "body": "<p>I would create a new header file with the library interface functions, since different OS require different function exporting attributes:</p>\n\n<pre><code>extern \"C\" {\nint __attribute__ (dllexport) ReturnSameValue(int avalue) // Linux\n{\n    return avalue\n}\n\nint __declspec(dllexport) IncreseInteger(int avalue) // Windows dll\n{\n    return avalue+1;\n}\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2842, "user_id": 1087908, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1df0b0daef7049f4aa8561e4c29fd7de?s=128&d=identicon&r=PG", "display_name": "code base 5000", "link": "https://stackoverflow.com/users/1087908/code-base-5000"}, "edited": false, "score": 0, "creation_date": 1501754645, "post_id": 45446313, "comment_id": 77922435, "body": "Thank you for the suggestion, I think I&#39;m going to try these 3 solutions.  I&#39;ve tried to follow the code.google.com solution (swig solution), but I can&#39;t get SWIG to create a workable binder using windows.  Any ideas?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1501617258, "last_edit_date": 1501617258, "creation_date": 1501616186, "answer_id": 45446313, "question_id": 45444910, "link": "https://stackoverflow.com/questions/45444910/globally-apply-extern-c-when-compiling/45446313#45446313", "title": "Globally Apply extern C when compiling", "body": "<p>Looking at the code, there is no simple solution to your problem.  The package does not have a published C binding, only C++.</p>\n\n<p>You cannot <em>just wrap the thing in global <code>extern \"C\"</code></em> to create a C binding, the types and APIs are heavily C++ oriented and the DLL has mangled C++ symbols anyway.</p>\n\n<p>You do not have source code to the library, but you could create a separate library with C callable functions that in turn call the C++ API of the original DLL.  It is non-trivial work, to say the least!</p>\n\n<p>If your goal is to get a Python binding for the ESRI File GeoDatabase API, you can take a look at these pages:</p>\n\n<p><a href=\"http://libjoe.blogspot.fr/2014/02/python-wrapper-for-esri-file.html\" rel=\"nofollow noreferrer\">http://libjoe.blogspot.fr/2014/02/python-wrapper-for-esri-file.html</a></p>\n\n<p><a href=\"https://code.google.com/archive/p/file-geodatabase-api-python-wrapper/\" rel=\"nofollow noreferrer\">https://code.google.com/archive/p/file-geodatabase-api-python-wrapper/</a></p>\n\n<p><a href=\"https://gis.stackexchange.com/questions/64864/gdal-python-bindings-and-file-geodatabase-api\">https://gis.stackexchange.com/questions/64864/gdal-python-bindings-and-file-geodatabase-api</a></p>\n"}], "owner": {"reputation": 2842, "user_id": 1087908, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1df0b0daef7049f4aa8561e4c29fd7de?s=128&d=identicon&r=PG", "display_name": "code base 5000", "link": "https://stackoverflow.com/users/1087908/code-base-5000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 1, "accepted_answer_id": 45446313, "answer_count": 3, "score": 2, "last_activity_date": 1501620460, "creation_date": 1501610957, "question_id": 45444910, "link": "https://stackoverflow.com/questions/45444910/globally-apply-extern-c-when-compiling", "title": "Globally Apply extern C when compiling", "body": "<p>I have some code I got from here: <a href=\"https://github.com/Esri/file-geodatabase-api\" rel=\"nofollow noreferrer\">https://github.com/Esri/file-geodatabase-api</a>, and I want to prevent the c++ name mangling so I can use ctypes in Python to call this DLL. </p>\n\n<p>Is there a way to globally apply extern \"C\" at the compiler level?\nIs there a way to easily apply it to the .h files in the code?</p>\n\n<p>Thank you</p>\n\n<p>(PS I'm not a c++ developer, so excuse the lack of proper terminology)</p>\n"}, {"tags": ["c", "linux", "mingw", "cross-compiling", "gtk3"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1501610868, "post_id": 45444811, "comment_id": 77850552, "body": "You probably need to cross-compile all the required dependencies of GTK3 (which you should cross-configure and cross-compile for Windows)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8102522"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1501611539, "post_id": 45444811, "comment_id": 77850930, "body": "@BasileStarynkevitch It will be so much help If you teach me how to do it cause I am the greatest noob here :("}, {"owner": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 0, "creation_date": 1501673495, "post_id": 45444811, "comment_id": 77879329, "body": "You can try the <a href=\"http://mxe.cc/\" rel=\"nofollow noreferrer\">MXE</a> cross-build environment."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8102522"}, "is_accepted": false, "score": 0, "last_activity_date": 1501662884, "creation_date": 1501662884, "answer_id": 45455632, "question_id": 45444811, "link": "https://stackoverflow.com/questions/45444811/how-to-compiling-c-gtk3-program-in-linux-mint-for-windows/45455632#45455632", "title": "How to compiling C GTK3+ program in Linux mint for windows?", "body": "<p>I've gone via <a href=\"http://www.tarnyko.net/en/?q=node/45\" rel=\"nofollow noreferrer\">this</a> tutorial 5 or maybe more times and I found what was wrong.I was exacting commands from wrong directories and downloading wrong version of <code>GTK+ 3 Windows binaries</code> .</p>\n\n<p>My version of mingw is mingw64 thus I needed to download <code>win64</code> version.</p>\n\n<p>and I was executing command <code>export PKG_CONFIG_PATH=/opt/gtk3-win64/lib/pkgconfig</code> from /opt/gtk3-win64,but I needed to execute this command via directory in which my test.c file was.</p>\n\n<p>I'll make this tutorial easy for future readers.</p>\n\n<ul>\n<li><p>Install <code>mingw cross-compiler</code> by command</p>\n\n<pre><code>sudo apt-get install mingw-w64\n</code></pre></li>\n<li><p>Then Download <code>GTK+ 3 Windows binaries</code> from here(Link in <a href=\"http://www.tarnyko.net/en/?q=node/45\" rel=\"nofollow noreferrer\">this</a> tutorial is old,here is latest link):- <a href=\"http://win32builder.gnome.org/\" rel=\"nofollow noreferrer\">http://win32builder.gnome.org/</a>\nDownload appropriate version as I was downloading wrong version.don't make the same mistake as mine.</p></li>\n<li><p>extract the zip file in <code>/opt/gtkwin</code> (recommended) by command </p>\n\n<pre><code> sudo mkdir /opt/gtkwin &amp;&amp; sudo unzip &lt;name of the zip file&gt; -d /opt/gtkwin\n</code></pre></li>\n<li><p>then Go to directory in which you have extracted the zip file.In this case I have extracted in /opt/gtkwin/ like <code>cd /opt/gtkwin</code> and execute the following command</p>\n\n<pre><code>find -name '*.pc' | while read pc; do sed -e \"s@^prefix=.*@prefix=$PWD@\" -i \"$pc\"; done\n</code></pre></li>\n<li><p>Now go to you directory in which you have .c file which you which to compile.and execute this command</p>\n\n<pre><code>export PKG_CONFIG_PATH=/opt/gtkwin/lib/pkgconfig\n</code></pre></li>\n<li><p>now compile the program by </p>\n\n<pre><code>x86_64-w64-mingw32-gcc test.c `pkg-config --cflags gtk+-3.0 --libs`\n</code></pre>\n\n<p>(for 64-bit)</p></li>\n</ul>\n\n<p>and for 32 bit </p>\n\n<pre><code>       i586-mingw32msvc-gcc test.c `pkg-config --cflags --libs gtk+-3.0`\n</code></pre>\n\n<p>Also you should visit this tutorial as I had learn this from there :- <a href=\"http://www.tarnyko.net/en/?q=node/45\" rel=\"nofollow noreferrer\">http://www.tarnyko.net/en/?q=node/45</a></p>\n\n<p>this will create <code>.exe</code> file which can't run in UNIX as it is targeted to run on DOS</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8102522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 650, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567445366, "creation_date": 1501610548, "last_edit_date": 1501612149, "question_id": 45444811, "link": "https://stackoverflow.com/questions/45444811/how-to-compiling-c-gtk3-program-in-linux-mint-for-windows", "title": "How to compiling C GTK3+ program in Linux mint for windows?", "body": "<p>I am using Linux mint and gcc-7 and mingw-w64.I want to compile a c gtk3+ program in Linux using mingw so that it will produce .exe file which can be run in windows.I am able to Compile normal c programs using mingw,But I can't compile gtk programs.I can compile gtk programs with gcc but not with mingw.</p>\n\n<p>I had installed mingw as told here :- <a href=\"https://stackoverflow.com/questions/38786014/how-to-compile-executable-for-windows-with-gcc-with-linux-subsystem\">How to compile executable for Windows with GCC with Linux Subsystem?</a></p>\n\n<p>Now I want to compile window program which I got from <a href=\"https://developer.gnome.org/gtk3/stable/gtk-getting-started.html#id-1.2.3.5\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gtk3/stable/gtk-getting-started.html#id-1.2.3.5</a></p>\n\n<pre><code> smit@smit-Aspire-5742:~/programs/c programs/test$ x86_64-w64-mingw32-gcc test.c `pkg-config --cflags gtk+-3.0 --libs`\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libgtk-3.dll.a when searching for -lgtk-3\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libgtk-3.dll.a when searching for -lgtk-3\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lgtk-3\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/li /libgdk-3.dll.a when searching for -lgdk-3\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libgdk-3.dll.a when searching for -lgdk-3\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lgdk-3\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpangocairo-1.0.dll.a when searching for -lpangocairo-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangocairo-1.0.lib when searching for -lpangocairo-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpangocairo-1.0.dll.a when searching for -lpangocairo-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangocairo-1.0.lib when searching for -lpangocairo-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangocairo-1.0.lib when searching for -lpangocairo-1.0\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lpangocairo-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpangoft2-1.0.dll.a when searching for -lpangoft2-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangoft2-1.0.lib when searching for -lpangoft2-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpangoft2-1.0.dll.a when searching for -lpangoft2-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangoft2-1.0.lib when searching for -lpangoft2-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangoft2-1.0.lib when searching for -lpangoft2-1.0\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lpangoft2-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libfreetype.dll.a when searching for -lfreetype\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libfreetype.dll.a when searching for -lfreetype\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lfreetype\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libfontconfig.dll.a when searching for -lfontconfig\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/fontconfig.lib when searching for -lfontconfig\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libfontconfig.dll.a when searching for -lfontconfig\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/fontconfig.lib when searching for -lfontconfig\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/fontconfig.lib when searching for -lfontconfig\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lfontconfig\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpangowin32-1.0.dll.a when searching for -lpangowin32-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangowin32-1.0.lib when searching for -lpangowin32-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpangowin32-1.0.dll.a when searching for -lpangowin32-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangowin32-1.0.lib when searching for -lpangowin32-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pangowin32-1.0.lib when searching for -lpangowin32-1.0\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lpangowin32-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpango-1.0.dll.a when searching for -lpango-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pango-1.0.lib when searching for -lpango-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libpango-1.0.dll.a when searching for -lpango-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pango-1.0.lib when searching for -lpango-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/pango-1.0.lib when searching for -lpango-1.0\n /usr/bin/x86_64-w64-mingw32-ld: cannot find -lpango-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libatk-1.0.dll.a when searching for -latk-1.0\n /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/atk-1.0.lib when searching for -latk-1.0\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libatk-1.0.dll.a when searching for -latk-1.0\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/atk-1.0.lib when searching for -latk-1.0\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/atk-1.0.lib when searching for -latk-1.0\n  /usr/bin/x86_64-w64-mingw32-ld: cannot find -latk-1.0\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libcairo-gobject.dll.a when searching for -lcairo-gobject\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libcairo-gobject.dll.a when searching for -lcairo-gobject\n  /usr/bin/x86_64-w64-mingw32-ld: cannot find -lcairo-gobject\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libcairo.dll.a when searching for -lcairo\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/cairo.lib when searching for -lcairo\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib/libcairo.dll.a when searching for -lcairo\n  /usr/bin/x86_64-w64-mingw32-ld: skipping incompatible /opt/gtk3-dos/lib\n</code></pre>\n\n<p>and so .......( I am pasting the last line as this output is way more big)</p>\n\n<pre><code> collect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I already went via this tutorial :-<a href=\"http://www.tarnyko.net/en/?q=node/45\" rel=\"nofollow noreferrer\">http://www.tarnyko.net/en/?q=node/45</a></p>\n\n<p>Now vis <a href=\"http://www.tarnyko.net/en/?q=node/45\" rel=\"nofollow noreferrer\">this</a> tutorail again but this time I had downloaded <code>gtk+-bundle_3.6.4-20131201_win64.zip</code> and now I am getting this output:-</p>\n\n<pre><code> smit@smit-Aspire-5742:~/programs/c programs/test$ x86_64-w64-mingw32-gcc test.c `pkg-config --cflags gtk+-3.0 --libs`\n In file included from /usr/lib/x86_64-linux-gnu/glib-2.0/include/glibconfig.h:9:0,\n             from /usr/include/glib-2.0/glib/gtypes.h:32,\n             from /usr/include/glib-2.0/glib/galloca.h:32,\n             from /usr/include/glib-2.0/glib.h:30,\n             from /usr/include/gtk-3.0/gdk/gdkconfig.h:13,\n             from /usr/include/gtk-3.0/gdk/gdk.h:30,\n             from /usr/include/gtk-3.0/gtk/gtk.h:30,\n             from test.c:1:\n  /usr/include/glib-2.0/glib/gtypes.h: In function \u2018_GLIB_CHECKED_ADD_U64\u2019:\n  /usr/include/glib-2.0/glib/gmacros.h:232:53: error: size of array \u2018_GStaticAssertCompileTimeAssertion_0\u2019 is negative\n   #define G_STATIC_ASSERT(expr) typedef char G_PASTE (_GStaticAssertCompileTimeAssertion_, __COUNTER__)[(expr) ? 1 : -1] G_GNUC_UNUSED\n                                                 ^\n   /usr/include/glib-2.0/glib/gmacros.h:229:47: note: in definition of macro \u2018G_PASTE_ARGS\u2019\n   #define G_PASTE_ARGS(identifier1,identifier2) identifier1 ## identifier2\n                                           ^\n    /usr/include/glib-2.0/glib/gmacros.h:232:44: note: in expansion of macro \u2018G_PASTE\u2019\n    #define G_STATIC_ASSERT(expr) typedef char G_PASTE (_GStaticAssertCompileTimeAssertion_, __COUNTER__)[(expr) ? 1 : -1] G_GNUC_UNUSED\n                                        ^\n    /usr/include/glib-2.0/glib/gtypes.h:422:3: note: in expansion of macro \u2018G_STATIC_ASSERT\u2019\n    G_STATIC_ASSERT(sizeof (unsigned long long) == sizeof (guint64));\n       ^\n    In file included from /usr/include/glib-2.0/gio/gio.h:46:0,\n             from /usr/include/gtk-3.0/gdk/gdkapplaunchcontext.h:28,\n             from /usr/include/gtk-3.0/gdk/gdk.h:32,\n             from /usr/include/gtk-3.0/gtk/gtk.h:30,\n             from test.c:1:\n    /usr/include/glib-2.0/gio/gcredentials.h: At top level:\n    /usr/include/glib-2.0/gio/gcredentials.h:75:1: error: unknown type name \u2018uid_t\u2019\n    uid_t            g_credentials_get_unix_user      (GCredentials    *credentials,\n     ^\n    /usr/include/glib-2.0/gio/gcredentials.h:79:52: error: unknown type name \u2018uid_t\u2019\n                                                uid_t           uid,\n                                                ^\n</code></pre>\n"}, {"tags": ["c", "execv"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1501653531, "post_id": 45444539, "comment_id": 77866019, "body": "C is not Python \u2014 or Perl, or C++, or Java, or C#, or \u2026  If you choose to try notations from other languages in C code, expect them not to work, or to work differently.  You will need to read a book on C to get an understanding of the language and its syntax."}, {"owner": {"reputation": 481, "user_id": 316892, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7b18d8ae63e309d9b19964603eef3c13?s=128&d=identicon&r=PG", "display_name": "posop", "link": "https://stackoverflow.com/users/316892/posop"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502026717, "post_id": 45444539, "comment_id": 78025097, "body": "@Jonathan Leffler I never mentioned any programming language other than C.  execv wants a <code>char *const argv[]</code>, I am asking how to use this in an argument to execv.  &quot;read a book&quot; does not answer this question.  I have read several including ANSI C.  I did not however memorize the whole standard... Mea culpa"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502027013, "post_id": 45444539, "comment_id": 78025187, "body": "The notation using square brackets around a list of arguments isn&#39;t something that a person who only codes in C would come up with.  Some of the languages I mentioned do support such notations, so I inferred that you already knew at least one other language, and that language is not Pascal, Algol, Fotran, COBOL, Basic, Modula-3, \u2026."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1501609974, "last_edit_date": 1501609974, "creation_date": 1501609670, "answer_id": 45444577, "question_id": 45444539, "link": "https://stackoverflow.com/questions/45444539/c-execv-pass-arguments-through-a-function/45444577#45444577", "title": "c execv pass arguments through a function", "body": "<p>You can use a compound literal:</p>\n\n<pre><code>execv(\"./test.sh\", (char*[]){\"test.sh\", NULL});\n</code></pre>\n\n<p>This is for C99 and later only.</p>\n"}], "owner": {"reputation": 481, "user_id": 316892, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7b18d8ae63e309d9b19964603eef3c13?s=128&d=identicon&r=PG", "display_name": "posop", "link": "https://stackoverflow.com/users/316892/posop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "accepted_answer_id": 45444577, "answer_count": 1, "score": 1, "last_activity_date": 1501609974, "creation_date": 1501609489, "question_id": 45444539, "link": "https://stackoverflow.com/questions/45444539/c-execv-pass-arguments-through-a-function", "title": "c execv pass arguments through a function", "body": "<p>I'm trying to understand this code:</p>\n\n<pre><code>char * pl[] = {\"test.sh\", NULL};\nexecv(\"./test.sh\", pl);\n</code></pre>\n\n<p>This will execute my script from a c program, but this will not:</p>\n\n<pre><code>execv(\"./test.sh\", [\"test.sh\", NULL]);\n</code></pre>\n\n<p>This delivers an error message: </p>\n\n<blockquote>\n  <p>error: expected expression before '[' token</p>\n</blockquote>\n\n<p>This doesn't work either:</p>\n\n<pre><code>execv(\"./test.sh\", (char *) [\"test.sh\", NULL]);\n</code></pre>\n\n<p>Same exact error...</p>\n\n<p>What is going on here?</p>\n\n<p>I am obviously misunderstanding the <code>char * []</code> declaration type.  Should I be able to cast the array?  Can i get this into one line of code?</p>\n\n<p>I am not understanding the {}, how would I pass this bit to a function which is the end goal of this code snippet?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1501609453, "post_id": 45444505, "comment_id": 77849749, "body": "Why can you not use <code>scanf</code>? Ps this is not a homework writing service"}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "edited": false, "score": 1, "creation_date": 1501609483, "post_id": 45444505, "comment_id": 77849765, "body": "You could count lines and &quot;,&quot; first"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501609527, "post_id": 45444505, "comment_id": 77849793, "body": "Read string upto <code>,</code> (Use <code>getdelim</code> or <code>getline</code> if available) then <code>strtold</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1501609603, "post_id": 45444505, "comment_id": 77849825, "body": "&quot;&#39;I&#39;m trying to read text file which contains numbers (long doubles) separated by &#39;,&#39;&quot; --&gt; post that code of that try."}, {"owner": {"reputation": 1, "user_id": 7919589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8eb0cdb3ea23d213ad3e8dd9358425?s=128&d=identicon&r=PG&f=1", "display_name": "Aviad Bs", "link": "https://stackoverflow.com/users/7919589/aviad-bs"}, "edited": false, "score": 0, "creation_date": 1501609780, "post_id": 45444505, "comment_id": 77849918, "body": "Ed I know it&#39;s not a homework service, I just looked a lot online and couldn&#39;t find a good way to replace scanf. I edit my message and put my code using scanf."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501611675, "post_id": 45444505, "comment_id": 77851017, "body": "Questions asking how to (a) read lines and fields and/or (b) store them in a dynamically-allocated array are among the most common on this site, asked multiple times per day.  Isn&#39;t there supposed to be a mechanism (&quot;community wiki&quot; or something like that) where we can compose a single, good, canonical answer, and simply point each new occurrence to it?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1501612399, "post_id": 45444505, "comment_id": 77851456, "body": "@SteveSummit Unfortunately this post has 1) unlimited file length, 2) unlimited line length 3) unlimited text length for a single <code>long double</code> and 40 bars use of <code>fscanf()</code>.  A canonical answer would not have all those restrictions.  Taken all together the coding goal is not reasonable."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501612726, "post_id": 45444505, "comment_id": 77851661, "body": "@chux Well, me, I&#39;d say that unlimited length and width are both utterly canonical.  Clearly it would make sense to have 3 canonical variants, for 2D arrays of string, int, and double, which would be near-identical except for calls to <code>atoi</code> and <code>atof</code> or the equivalent.  (Presumably the poster of this question could make the leap to <code>strtold</code>.)  Finally, *scanf are useless for this, so I&#39;d leave them out of my canonical answer anyway."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1501613054, "post_id": 45444505, "comment_id": 77851817, "body": "@SteveSummit Curious, what limitation do you see with <code>fscanf()</code>?  Overflow or something else?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501613478, "post_id": 45444505, "comment_id": 77852040, "body": "@chux In general, see <a href=\"https://stackoverflow.com/questions/2430303/disadvantages-of-scanf\" title=\"disadvantages of scanf\">stackoverflow.com/questions/2430303/disadvantages-of-scanf</a> and <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/scanfprobs.html</a>.  For this question: no way to scan one line for arbitrary number of fields, and if you scan one field at a time, you can&#39;t tell the difference between delimiters and newlines, so you don&#39;t know the shape of the array.  (I suppose you could tease that out somehow, but it&#39;s just not worth it.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1501613881, "post_id": 45444505, "comment_id": 77852265, "body": "I&#39;d counter that teasing out the <code>&#39;\\n&#39;</code> is not so hard <a href=\"https://stackoverflow.com/a/31666357/2410359\">example</a> and so <code>fscanf()</code> solution would be easy enough (Aside from OF).  (BTW: those links primary address difficulty in reading strings, not numbers)  Yet I agree that a canonical answer, given various set of conditions, would be useful."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1501614592, "post_id": 45444505, "comment_id": 77852688, "body": "@BLUEPIXY getdelim() and getline() aren&#39;t available on Windows, are they?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1501614868, "post_id": 45444505, "comment_id": 77852877, "body": "@BjornA. Until the question was edited, it was not known that the usage environment of the OP was the windows environment. However there is an implementation for windows."}], "answers": [{"tags": [], "owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1501614076, "creation_date": 1501614076, "answer_id": 45445741, "question_id": 45444505, "link": "https://stackoverflow.com/questions/45444505/parsing-text-file-of-unknown-size-to-array-in-c/45445741#45445741", "title": "parsing text file of unknown size to array in c", "body": "<p>Divide and conquer! See if you're able to read the file correctly without storing anything. Just read and print what you read, so you can compare your output with the input file. If they match, you're on your way.</p>\n\n<p>It's easier than you think to read the file. Use a char array as a temporary buffer for each number and read the file character by into the buffer. If the input is a ',' then you have read a complete number. Same goes for the newline '\\n'.</p>\n\n<pre><code>// untested snippet\nchar buf[1024]; // Make it big\nsize_t i = 0;\nint c;\nlong double d;\n\nwhile ((c = fgetc(fp)) != EOF) {\n    if (c == ',' || c == '\\n') {\n        buf[i] = '\\0';\n        d = strtold(buf);\n        printf(\"%lf%c\", d, c); // debugging, sanity check\n        i = 0;\n    }\n    else\n        buf[i++] = c;\n}\n</code></pre>\n\n<p>There may be uncovered corner cases which the snippet doesn't cover, like missing newline at end of file, or silly Windows \\r\\n combos. Also, string to double conversion needs proper error checking. Still, the snippet should get you going. </p>\n"}], "owner": {"reputation": 1, "user_id": 7919589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8eb0cdb3ea23d213ad3e8dd9358425?s=128&d=identicon&r=PG&f=1", "display_name": "Aviad Bs", "link": "https://stackoverflow.com/users/7919589/aviad-bs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1501614076, "creation_date": 1501609314, "last_edit_date": 1501610077, "question_id": 45444505, "link": "https://stackoverflow.com/questions/45444505/parsing-text-file-of-unknown-size-to-array-in-c", "title": "parsing text file of unknown size to array in c", "body": "<p>i'm new programmer in c and need some help. I'm trying to read text file which contains numbers (long doubles) separated by ','. My problem is that I don't know what is the size of each line and every solution I find online assume it's size. This is a part of work I got to do and I can't use scanf/fscanf. finally I would like to have array contains the numbers (without the ','), what is the best way to do it?\nThanks a lot!</p>\n\n<p>edited:</p>\n\n<pre><code> FILE *inputFile;\ninputFile = fopen(\"C:\\\\Users\\\\studies\\\\C\\\\Exe1\\\\input_example.txt\",\n                  \"r\");\n    for (int c = 0; c &lt; 7; c++) {\n        fscanf(inputFile, \"%Lf,\", &amp;params[c]);\n    }\n</code></pre>\n\n<p>any other way I tried to read just didn't go well, fgets, getchar, etc..</p>\n"}, {"tags": ["c", "checksum"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1501608126, "post_id": 45444122, "comment_id": 77849007, "body": "Magic can happen. No, actually it cannot. Where is your code?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1501608646, "post_id": 45444122, "comment_id": 77849309, "body": "<code>a=10; b = 16; printf(&quot;%u %x\\n&quot;, a,b);</code>  - at least they print the same."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1501608743, "post_id": 45444122, "comment_id": 77849372, "body": "It might be because the two numbers are actually different.  It might be because you printed them using an improper technique (<code>%d</code>, perhaps) that inadvertently made them look the same.  It might be because something changed them between the time you printed them, and compared them.  Why don&#39;t you show us your code, so we don&#39;t have to guess wildly?"}, {"owner": {"reputation": 5, "user_id": 3442059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mOY1s.jpg?s=128&g=1", "display_name": "assemblaj", "link": "https://stackoverflow.com/users/3442059/assemblaj"}, "edited": false, "score": 0, "creation_date": 1501664102, "post_id": 45444122, "comment_id": 77872553, "body": "Original post updated"}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 3442059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mOY1s.jpg?s=128&g=1", "display_name": "assemblaj", "link": "https://stackoverflow.com/users/3442059/assemblaj"}, "is_accepted": true, "score": 0, "last_activity_date": 1501757120, "last_edit_date": 1501757120, "creation_date": 1501687951, "answer_id": 45465129, "question_id": 45444122, "link": "https://stackoverflow.com/questions/45444122/why-doesnt-my-code-return-the-checksum-i-am-expecting-and-i-pre-calculated/45465129#45465129", "title": "Why doesn&#39;t my code return the checksum I am expecting and I pre-calculated?", "body": "<p>I defined my checksum variable as unsigned long int because that was typedefed as a uint4 in the library I am porting (where the basis for this code comes from). Turns out that the library was only used on 32 bit architectures, so an unsigned long int is 4 bytes whereas on my machine (64 bit) it's 8 bytes. Changing the variable to an unsigned int fixed everything, but I need to do a lot of work porting the library from 32 bit to 64 bit.</p>\n\n<p>Also I should've used %lx instead of %x.</p>\n"}], "owner": {"reputation": 5, "user_id": 3442059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mOY1s.jpg?s=128&g=1", "display_name": "assemblaj", "link": "https://stackoverflow.com/users/3442059/assemblaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 45465129, "answer_count": 1, "score": -4, "last_activity_date": 1501757120, "creation_date": 1501608090, "last_edit_date": 1501687547, "question_id": 45444122, "link": "https://stackoverflow.com/questions/45444122/why-doesnt-my-code-return-the-checksum-i-am-expecting-and-i-pre-calculated", "title": "Why doesn&#39;t my code return the checksum I am expecting and I pre-calculated?", "body": "<p>My program reads a file, calculates a 4 byte checksum by processing the file as four byte integers and summing each chunk, and then compares it to a pre-calculated checksum to check the file's validity. </p>\n\n<p>For example, hello_world.txt could contains the following.</p>\n\n<blockquote>\n  <p>hello world</p>\n</blockquote>\n\n<p>I have pre-calculated the checksum, and I know it is 0x49f247db, but the comparison at the end fails.</p>\n\n<p>What could be the issue here? Is it the way I am obtaining the 4 byte integers?</p>\n\n<p>I tried to do this by casting the buffer's pointer into an integer pointer and just iterating over the buffer with the '++' operator but it'd somehow end up skipping bytes. </p>\n\n<p>This is the code I am using.</p>\n\n<pre><code>    #include &lt;sys/stat.h&gt; \n    #include &lt;fcntl.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;errno.h&gt;\n    #include &lt;string.h&gt;\n\n\n    int main() {\n         unsigned char  buffer [1024];\n         unsigned long int        checksum = 0;\n         FILE                       *fp;\n         int                         i;\n         unsigned long int        length;\n\n         fp = open (\"hello_world.txt\", 0, 0);\n\n         if (fp == NULL) exit(0);\n\n         for (;;)\n           {\n             memset (buffer, 0, sizeof(buffer));\n             /* Read the next chunk of the file */\n             length = read (fp, &amp;buffer, 1024); \n             if (length == 0)\n               break;\n\n             printf(\"i'm here. %d %s \\n\", length, strerror(errno));\n             /* We've read a chunk of the file -- all chunks (except the last)\n              * will be '1024' bytes in length; the last chunk will \n              * probably be less than '1024' bytes.\n              */\n             for (i=0; i&lt;length; i+=4)\n               {\n                 unsigned long int a = (unsigned long int) ((unsigned char)(buffer[i]) &lt;&lt; 24 |\n                          (unsigned char)(buffer[i+1]) &lt;&lt; 16 |\n                          (unsigned char)(buffer[i+2]) &lt;&lt; 8 |\n                          (unsigned char)(buffer[i+3]));\n                 checksum += a; \n               }\n           }\n\n         printf(\"%d, %x \\n\", checksum, checksum);\n         if (0x49f247db == checksum) printf(\"CHECKSUM MATCHED\");\n         /* Close the file and return the checksum */\n         close (fp);\n        return 0; \n    }\n</code></pre>\n"}]