[{"tags": ["c", "arrays", "random", "shuffle"], "comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 1, "creation_date": 1452730054, "post_id": 34779314, "comment_id": 57303893, "body": "Your shuffling algorithm just doesn&#39;t make any sense. You&#39;re just randomly copying the elements of <code>array</code> to <code>hold</code>, sometimes you&#39;ll overwrite one you did already, other times you&#39;ll leave some elements of <code>hold</code> uninitialized. There&#39;s not an identifiable problem with your code - the logic just isn&#39;t there."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1452730101, "post_id": 34779314, "comment_id": 57303909, "body": "Your algorithm seems needlessly complicated (and broken). Search for <a href=\"https://en.wikipedia.org/wiki/Random_permutation\" rel=\"nofollow noreferrer\">\u201crandom permutation\u201d</a>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1452730995, "post_id": 34779314, "comment_id": 57304174, "body": "You can avoid the temporary array by implementing a <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm\" rel=\"nofollow noreferrer\">Fisher\u2013Yates_shuffle</a>. It&#39;s fewer lines of code than what you have, and best of all, it works."}, {"owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "edited": false, "score": 0, "creation_date": 1452731131, "post_id": 34779314, "comment_id": 57304209, "body": "what is exactly logic that I have to follow?"}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 1, "creation_date": 1452731250, "post_id": 34779314, "comment_id": 57304247, "body": "FYI, using <code>srand(b)</code> will always give you the same permutation based on length.  You should use an actual entropy source like <code>time(NULL)</code> if you want randomization."}, {"owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "edited": false, "score": 0, "creation_date": 1452732558, "post_id": 34779314, "comment_id": 57304628, "body": "thanks for everyone, I&#39;ll try to figure it out"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452790007, "post_id": 34781811, "comment_id": 57333473, "body": "<code>srand(time(NULL));&#47;</code> should not be called repeatedly in <code>shufarray()</code>.  Better to call only once in the life of the program - perhaps <code>main()</code>."}], "tags": [], "owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "is_accepted": true, "score": 0, "last_activity_date": 1452746179, "last_edit_date": 1592644375, "creation_date": 1452746179, "answer_id": 34781811, "question_id": 34779314, "link": "https://stackoverflow.com/questions/34779314/a-function-that-shuffles-an-array-passed-as-an-argument/34781811#34781811", "title": "A function that shuffles an array passed as an argument", "body": "<p><strong>THE PROBLEM</strong></p>\n<p>In the previous code, I thought that the solution is to create an array <code>hold[]</code>that holds randomly copied elements from <code>array[]</code>. than copy elements from <code>hold[]</code> back again to <code>array[]</code>.the problems are:</p>\n<blockquote>\n<ul>\n<li><p>the <code>hold[]</code> is uninitialized</p>\n</li>\n<li><p>sometimes the program will overwrite an element overwrote already</p>\n</li>\n<li><p>srand(b) will always give the same permutation based on length</p>\n</li>\n</ul>\n</blockquote>\n<p><strong>THE SOLUTION</strong></p>\n<blockquote>\n<p>I modify the code at the light of the references that are suggested in comments.</p>\n</blockquote>\n<p>the correct way to do it is to start from the last element <code>array[n-1]</code>, swap it with a randomly selected element from the whole array (including the last one). Now consider the array <code>from 0 to n-2</code> (size reduced by 1), and repeat the process till we hit the first element. Following is the detailed algorithm:</p>\n<pre><code>  for i from n - 1 downto 1 do\n       j = random integer with 0 &lt;= j &lt;= i\n       exchange a[j] and a[i] .\n</code></pre>\n<p><strong>THE CODE</strong></p>\n<pre><code>void shufarray(int* array, int b){\n    int i,k=0;\n    srand(time(NULL));//set the seed\n    /* Starting from the last element and swap one by one.\n     * NOTE: i &gt; 0 it's because there's no need to run for the first element */\n    for (i = b-1; i &gt; 0; i--){\n        int j = rand() % (i+1);\n        //swap\n        k =  array[i];\n        array[i] = array[j];\n        array[j] = k;\n    }//end for\n}//end shufarray()\n</code></pre>\n<p><strong>OUTPUT</strong></p>\n<pre><code>hold[ 0 ] = 8\nhold[ 1 ] = 11\nhold[ 2 ] = 2\nhold[ 3 ] = 15\nhold[ 4 ] = 18\nhold[ 5 ] = 10\nhold[ 6 ] = 11\nhold[ 7 ] = 17\nhold[ 8 ] = 24\nhold[ 9 ] = 21\nhold[ 10 ] = 12\nhold[ 11 ] = 2\nhold[ 12 ] = 15\nhold[ 13 ] = 9\nhold[ 14 ] = 13\nhold[ 15 ] = 1\nhold[ 16 ] = 15\nhold[ 17 ] = 1\nhold[ 18 ] = 22\nhold[ 19 ] = 11\nhold[ 20 ] = 11\nhold[ 21 ] = 18\nhold[ 22 ] = 17\nhold[ 23 ] = 4\nhold[ 24 ] = 7\nshuffled_hold[ 0 ] = 24\nshuffled_hold[ 1 ] = 9\nshuffled_hold[ 2 ] = 8\nshuffled_hold[ 3 ] = 1\nshuffled_hold[ 4 ] = 15\nshuffled_hold[ 5 ] = 11\nshuffled_hold[ 6 ] = 11\nshuffled_hold[ 7 ] = 21\nshuffled_hold[ 8 ] = 17\nshuffled_hold[ 9 ] = 7\nshuffled_hold[ 10 ] = 11\nshuffled_hold[ 11 ] = 11\nshuffled_hold[ 12 ] = 18\nshuffled_hold[ 13 ] = 10\nshuffled_hold[ 14 ] = 1\nshuffled_hold[ 15 ] = 15\nshuffled_hold[ 16 ] = 13\nshuffled_hold[ 17 ] = 2\nshuffled_hold[ 18 ] = 18\nshuffled_hold[ 19 ] = 4\nshuffled_hold[ 20 ] = 17\nshuffled_hold[ 21 ] = 2\nshuffled_hold[ 22 ] = 12\nshuffled_hold[ 23 ] = 15\nshuffled_hold[ 24 ] = 22\n</code></pre>\n<p><strong>REFERENCES:</strong>\n<a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm\" rel=\"nofollow noreferrer\">Fisher\u2013Yates shuffle</a></p>\n"}], "owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 34781811, "answer_count": 1, "score": -2, "last_activity_date": 1452746179, "creation_date": 1452729170, "last_edit_date": 1452729386, "question_id": 34779314, "link": "https://stackoverflow.com/questions/34779314/a-function-that-shuffles-an-array-passed-as-an-argument", "title": "A function that shuffles an array passed as an argument", "body": "<p>I'm working on a project at school and I want to create a function that shuffles an array passed as an argument. I tried to create one, but it didn't work as I expected...</p>\n\n<p>In this code, I'm trying to copy the elements of the passed array and set them in random order in a second array. Then, copy them again in the passed array.. </p>\n\n<p><strong>This is the source code:</strong></p>\n\n<pre><code>void shufarray(int* array, int b)\n{\n    int hold[b];  \n    int i,k;  \n    int randV=0, randHold=0;\n    srand(b);  \n    for(i=0; i&lt;b; ++i) {      \n        hold[rand() % (b-1)] = array[i]; \n        k=0;\n        do { \n            if(k==0) { \n                randHold = randV;\n                k=-1;\n            } //end if\n            randV = rand()%(b-1);         \n        } while(randHold != randV);//end of do\\while stetment \n        hold[randV] = array[i];     \n    } //end for  \n    for(i=0;i&lt;b;++i) {\n        array[i]=hold[i]; \n    } //end for \n} //end shufarray()\n</code></pre>\n\n<p><strong>And this is the output:</strong></p>\n\n<pre><code>hold[ 0 ] = 8\nhold[ 1 ] = 11\nhold[ 2 ] = 2\nhold[ 3 ] = 15\nhold[ 4 ] = 18\nhold[ 5 ] = 10\nhold[ 6 ] = 11\nhold[ 7 ] = 17\nhold[ 8 ] = 24\nhold[ 9 ] = 21\nhold[ 10 ] = 12\nhold[ 11 ] = 2\nhold[ 12 ] = 15\nhold[ 13 ] = 9\nhold[ 14 ] = 13\nhold[ 15 ] = 1\nhold[ 16 ] = 15\nhold[ 17 ] = 1\nhold[ 18 ] = 22\nhold[ 19 ] = 11\nhold[ 20 ] = 11\nhold[ 21 ] = 18\nhold[ 22 ] = 17\nhold[ 23 ] = 4\nhold[ 24 ] = 7\nshuffled_hold[ 0 ] = 7\nshuffled_hold[ 1 ] = 32561\nshuffled_hold[ 2 ] = 22\nshuffled_hold[ 3 ] = 0\nshuffled_hold[ 4 ] = 18\nshuffled_hold[ 5 ] = 8\nshuffled_hold[ 6 ] = -632114865\nshuffled_hold[ 7 ] = 32561\nshuffled_hold[ 8 ] = -628693440\nshuffled_hold[ 9 ] = 11\nshuffled_hold[ 10 ] = 15\nshuffled_hold[ 11 ] = 18\nshuffled_hold[ 12 ] = 1\nshuffled_hold[ 13 ] = 13\nshuffled_hold[ 14 ] = 15\nshuffled_hold[ 15 ] = 12\nshuffled_hold[ 16 ] = 17\nshuffled_hold[ 17 ] = 0\nshuffled_hold[ 18 ] = 4\nshuffled_hold[ 19 ] = 17\nshuffled_hold[ 20 ] = 7\nshuffled_hold[ 21 ] = 0\nshuffled_hold[ 22 ] = -1\nshuffled_hold[ 23 ] = 0\nshuffled_hold[ 24 ] = 0\n</code></pre>\n\n<p>So I'm trying to understand the principle of this operation, anyone helps me to find what is exactly the problem.. Thanks.</p>\n"}, {"tags": ["c", "syntax", "linked-list"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 4, "creation_date": 1452728490, "post_id": 34779171, "comment_id": 57303310, "body": "What is this <code>head = &amp;node_t</code> for?"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1452728537, "post_id": 34779171, "comment_id": 57303328, "body": "In addition to the syntax errors, your logic for splicing out an element is wrong."}, {"owner": {"reputation": 348, "user_id": 204276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c6df4819f2c5380079d98994ac0390?s=128&d=identicon&r=PG", "display_name": "Lee-Man", "link": "https://stackoverflow.com/users/204276/lee-man"}, "edited": false, "score": 0, "creation_date": 1452728673, "post_id": 34779171, "comment_id": 57303382, "body": "try &quot;for (; ...)&quot;, i..e leave off tghe &quot;head = &amp;node_t&quot;)"}, {"owner": {"reputation": 1011, "user_id": 3891638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pqkeX.jpg?s=128&g=1", "display_name": "cozyconemotel", "link": "https://stackoverflow.com/users/3891638/cozyconemotel"}, "edited": false, "score": 1, "creation_date": 1452728880, "post_id": 34779171, "comment_id": 57303460, "body": "so many things are wrong in this code, it&#39;s hard to pick where to start"}, {"owner": {"reputation": 179, "user_id": 5683487, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/849adc4bd3d52184f912a77ee811f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "riceman89", "link": "https://stackoverflow.com/users/5683487/riceman89"}, "edited": false, "score": 0, "creation_date": 1452729401, "post_id": 34779171, "comment_id": 57303675, "body": "I actually took this method off of a website I saw:  <a href=\"https://www.eskimo.com/~scs/cclass/int/sx8.html\" rel=\"nofollow noreferrer\">eskimo.com/~scs/cclass/int/sx8.html</a>  I&#39;ve gotten the code to work using a different approach, but am wondering why the approach shown in this website doesn&#39;t work."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1452730502, "post_id": 34779171, "comment_id": 57304026, "body": "@riceman89 Why do you conclude that the approach in the website doesn&#39;t work? It&#39;s more logical to conclude that you have not adapted the contained info correctly. In this case the (first) error has already been pointed out: you are using a type, <code>node_t</code>, as a variable."}, {"owner": {"reputation": 1040, "user_id": 2327497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001609f0e9acc8302721fe05fecbc97c?s=128&d=identicon&r=PG", "display_name": "Arlie Stephens", "link": "https://stackoverflow.com/users/2327497/arlie-stephens"}, "edited": false, "score": 0, "creation_date": 1452733454, "post_id": 34779171, "comment_id": 57304905, "body": "if node_t is a type, rather than a variable, then taking its address (&amp;node_t) doesn&#39;t make any sense at all. So the compiler chokes."}, {"owner": {"reputation": 1775, "user_id": 2401088, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8f17309b5e6b0dd44075947ce5e4283?s=128&d=identicon&r=PG", "display_name": "Pankaj Prakash", "link": "https://stackoverflow.com/users/2401088/pankaj-prakash"}, "edited": false, "score": 0, "creation_date": 1452741697, "post_id": 34779171, "comment_id": 57307163, "body": "Check out here - <a href=\"http://www.codeforwin.in/2015/09/c-program-to-create-and-traverse-singly-linked-list.html\" rel=\"nofollow noreferrer\">Linked list operations in C</a>"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 5683487, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/849adc4bd3d52184f912a77ee811f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "riceman89", "link": "https://stackoverflow.com/users/5683487/riceman89"}, "edited": false, "score": 0, "creation_date": 1452733824, "post_id": 34779554, "comment_id": 57305027, "body": "Thanks a lot for the clear explanation. Didn&#39;t realize that I was trying to perform variable calls on a typedef. Very helpful! :)"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 2, "last_activity_date": 1452730803, "creation_date": 1452730803, "answer_id": 34779554, "question_id": 34779171, "link": "https://stackoverflow.com/questions/34779171/basic-c-linked-list-syntax-error/34779554#34779554", "title": "Basic C linked list syntax error", "body": "<p>the root of the problem is that <code>node_t</code> is a type, not a variable and cannot take the address of a type.</p>\n\n<p>The following code cleanly compiles.</p>\n\n<p>be sure to check the logic, </p>\n\n<ol>\n<li>for first iteration of the loop when <code>head</code> = NULL or only one struct in linked list</li>\n<li>check logic for when desired struct is either last or next to last in the linked list</li>\n</ol>\n\n<p>here is the code:</p>\n\n<pre><code>typedef struct node\n{\n    int val;\n    struct node * next;\n} node_t;\n\n\nint remove_by_value(node_t ** head, int val)\n{\n    int retVal = -1;  // initialize to failed\n    node_t  *previousNode = *head;\n    node_t  *currentNode = *head;\n\n    for(;\n        previousNode &amp;&amp; currentNode; // assure something to test\n        previousNode = currentNode,  // update the pointers\n        currentNode = currentNode-&gt;next )\n    {\n        if (currentNode-&gt;val == val)\n        {\n            previousNode-&gt;next = currentNode-&gt;next;\n            retVal = 0; // indicate success\n            break;\n        }\n    }\n    return retVal;\n} // end function: remove_by_value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 5012958, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0777c5da05cd33431715cf1b632606b2?s=128&d=identicon&r=PG&f=1", "display_name": "Sijaan Hallak", "link": "https://stackoverflow.com/users/5012958/sijaan-hallak"}, "is_accepted": false, "score": 0, "last_activity_date": 1452730899, "creation_date": 1452730899, "answer_id": 34779568, "question_id": 34779171, "link": "https://stackoverflow.com/questions/34779171/basic-c-linked-list-syntax-error/34779568#34779568", "title": "Basic C linked list syntax error", "body": "<p>1) The error you are getting was pointed out by iharob already.\n2) I can understand that out of this head =&amp;t_node you want head to point at the head of your list. a static variable may be needed in your file to be able to use this then you can point head correctly</p>\n"}, {"comments": [{"owner": {"reputation": 179, "user_id": 5683487, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/849adc4bd3d52184f912a77ee811f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "riceman89", "link": "https://stackoverflow.com/users/5683487/riceman89"}, "edited": false, "score": 0, "creation_date": 1452735993, "post_id": 34780142, "comment_id": 57305680, "body": "What would you propose instead as a cleaner way of writing it? Thanks!"}, {"owner": {"reputation": 179, "user_id": 5683487, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/849adc4bd3d52184f912a77ee811f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "riceman89", "link": "https://stackoverflow.com/users/5683487/riceman89"}, "edited": false, "score": 0, "creation_date": 1452738376, "post_id": 34780142, "comment_id": 57306341, "body": "Thanks! This is a lot shorter, elegant, and works properly. Much appreciated!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452801818, "post_id": 34780142, "comment_id": 57340466, "body": "I wrote my answer in way I did because: 1) avoided changing the OPs function signature, 2) did not pass the selected struct pointer to free() as the OP did not specify that the linked list consists of memory allocations from the malloc() family 3) this posted answer is changing the callers&#39; pointer, even when the selected struct is NOT the first struct in the linked list."}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452804330, "post_id": 34780142, "comment_id": 57341952, "body": "@user3629249 nevertheless the result of your changes is e.g. that the first node cannot be deleted. There is a reason why the address of the listhead pointer is passed to the function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452804940, "post_id": 34780142, "comment_id": 57342269, "body": "I did say to check the algorithm for the edge cases (as it may not be correct)"}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452806364, "post_id": 34780142, "comment_id": 57343085, "body": "@user3629249 No offence mate, I simply wonder why you&#39;ve changed the original algorithm which was perfectly fine, except from the &quot;head = &amp;node_t;&quot; fragment which prevented it from compilation."}], "tags": [], "owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "is_accepted": false, "score": 1, "last_activity_date": 1452858660, "last_edit_date": 1452858660, "creation_date": 1452734564, "answer_id": 34780142, "question_id": 34779171, "link": "https://stackoverflow.com/questions/34779171/basic-c-linked-list-syntax-error/34780142#34780142", "title": "Basic C linked list syntax error", "body": "<p>Since I cannot comment on the <a href=\"/a/34779554/2599567\">accepted answer</a> written by @<a href=\"/users/3629249/user3629249\">user3629249</a>:\nThat code is even worse than the original (except that it would compile).</p>\n\n<p>I'd suggest something like this:</p>\n\n<pre><code>node_t *remove_by_value(node_t **head, int val)\n{\n    node_t *ret = NULL;\n\n    for (; *head; head = &amp;((*head)-&gt;next))\n    {\n            if ((*head)-&gt;val == val)\n            {\n                    ret = *head;\n                    *head = (*head)-&gt;next;\n                    break;\n            }\n    }\n    return ret;\n}\n</code></pre>\n\n<p>This code correctly removes the element from the beginning, middle and end of the list. In addition it gives the caller the chance to free the unlinked node.</p>\n"}], "owner": {"reputation": 179, "user_id": 5683487, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/849adc4bd3d52184f912a77ee811f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "riceman89", "link": "https://stackoverflow.com/users/5683487/riceman89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 34779554, "answer_count": 3, "score": 0, "last_activity_date": 1452858660, "creation_date": 1452728426, "last_edit_date": 1452730458, "question_id": 34779171, "link": "https://stackoverflow.com/questions/34779171/basic-c-linked-list-syntax-error", "title": "Basic C linked list syntax error", "body": "<p>Note: I already got the intended function to work with my own code, but I saw a tutorial on another website and am wondering why it doesn't work. </p>\n\n<p><a href=\"https://www.eskimo.com/~scs/cclass/int/sx8.html\" rel=\"nofollow\">https://www.eskimo.com/~scs/cclass/int/sx8.html</a></p>\n\n<p>The premise is as follows:</p>\n\n<p>I'm playing around with a very basic linked list:</p>\n\n<pre><code>typedef struct node {\n    int val;\n    struct node * next;\n} node_t;\n</code></pre>\n\n<p>I am trying to have a function remove an entry by value. It is as follows:</p>\n\n<pre><code>int remove_by_value(node_t ** head, int val) {\n    for(head = &amp;node_t; *head != NULL; head = &amp;(*head)-&gt;next){\n        if ((*head)-&gt;val == val) {\n            *head = (*head)-&gt;next;\n            break;\n        }\n    }\n}\n</code></pre>\n\n<p>However, I'm getting an error when calling this function, namely: </p>\n\n<pre><code>\"prog.c:35:17: error: expected expression before 'node_t'\n for(head = &amp;node_t; *head != NULL; head = &amp;(*head)-&gt;next){\n ^\"\n</code></pre>\n\n<p>Any ideas? Is this just a simple syntax error that I'm not seeing? Thanks!</p>\n"}, {"tags": ["c", "casting", "char", "unsigned", "signed"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1452728021, "post_id": 34779079, "comment_id": 57303132, "body": "The title is anything but self-explanatory. It&#39;s barely explanatory."}, {"owner": {"reputation": 121, "user_id": 4820394, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/972493956103073/picture?type=large", "display_name": "Pedro Gon&#231;alves", "link": "https://stackoverflow.com/users/4820394/pedro-gon%c3%a7alves"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1452728312, "post_id": 34779079, "comment_id": 57303258, "body": "@KerrekSB Ok, thanks for the edit, but can you help me or not? :)"}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1452728346, "post_id": 34779079, "comment_id": 57303268, "body": "I do not know whether it is well defined, but I thing it will not change the binary representation. Even if <code>char</code> is equal to <code>signed char</code> with your compiler."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1452728913, "post_id": 34779079, "comment_id": 57303473, "body": "Try this: <code>unsigned char b = 255; char a = (char) b; unsigned char c = (unsigned char) a; printf(&quot;%d %d %d\\n&quot;, b, a, c);</code>"}, {"owner": {"reputation": 121, "user_id": 4820394, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/972493956103073/picture?type=large", "display_name": "Pedro Gon&#231;alves", "link": "https://stackoverflow.com/users/4820394/pedro-gon%c3%a7alves"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1452729074, "post_id": 34779079, "comment_id": 57303544, "body": "@Bob__ yep, that&#39;s what I thought because of the flag in the signed one. Thanks, that helped a lot!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1452790027, "post_id": 34779079, "comment_id": 57333486, "body": "@Bob__; Trying a single example doesn&#39;t prove anything. See Kerrek SB&#39;s answer."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452806961, "post_id": 34779079, "comment_id": 57343398, "body": "@KeithThompson I know that the conversion from unrepresentable unsigned char value to char results in an implementation-defined result (and probably a bad idea), but I&#39;m not aware of any actual implementation other then two&#39;s complement for binary signed number representation. Can you, please, give us a counter example?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1452810044, "post_id": 34779079, "comment_id": 57344982, "body": "@Bob__: I don&#39;t have an actual example. I know there have been 1&#39;s-complement implementations (and in principle there could be sign-and-magnitude implementations), but I don&#39;t recall the details. My statement is based on the guarantees made (or not made) by the standard."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4820394, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/972493956103073/picture?type=large", "display_name": "Pedro Gon&#231;alves", "link": "https://stackoverflow.com/users/4820394/pedro-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1452728967, "post_id": 34779196, "comment_id": 57303497, "body": "Yes, I was aware that if the <code>char</code> was unsigned that would result in the same binary representation, my doubt was in what happens if it&#39;s signed, because that means it has less &quot;room&quot; since it has to have the flag."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452730520, "post_id": 34779196, "comment_id": 57304030, "body": "Are you sure that <code>char</code> may not have padding bits?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452730793, "post_id": 34779196, "comment_id": 57304120, "body": "@FUZxxl: C11, 6.2.6.2/1."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452789630, "post_id": 34779196, "comment_id": 57333215, "body": "Starting with C99, the conversion can also raise an implementation-defined signal (though I don&#39;t know of any implementations that do this). C11 6.3.1.3p3"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 4, "last_activity_date": 1452729157, "last_edit_date": 1452729157, "creation_date": 1452728562, "answer_id": 34779196, "question_id": 34779079, "link": "https://stackoverflow.com/questions/34779079/casting-unsigned-char-to-char-would-result-in-different-binary-representations/34779196#34779196", "title": "casting unsigned char to char would result in different binary representations?", "body": "<p>The type <code>char</code> can be either signed or unsigned. Char types have no padding, so all bits are value bits.</p>\n\n<ul>\n<li><p>If <code>char</code> is unsigned, then the value bits of <code>a</code> will be the same as those of <code>b</code>.</p></li>\n<li><p>If <code>char</code> is signed, then...</p>\n\n<ul>\n<li>if the value of <code>b</code> is representable by <code>char</code>, the common value bits of <code>a</code> and <code>b</code> will the same.</li>\n<li>otherwise, the conversion from unrepresentable <code>unsigned char</code> value to <code>char</code> results in an <em>implementation-defined</em> result.</li>\n</ul></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 4820394, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/972493956103073/picture?type=large", "display_name": "Pedro Gon&#231;alves", "link": "https://stackoverflow.com/users/4820394/pedro-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1452729750, "post_id": 34779311, "comment_id": 57303801, "body": "I&#39;ve tried it and the binary value of <code>a</code> is always the same as the <code>b</code> one. What can, and will be different if the value is 255 is the decimal representation, right? In the signed char, 255 is represented as -1."}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "reply_to_user": {"reputation": 121, "user_id": 4820394, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/972493956103073/picture?type=large", "display_name": "Pedro Gon&#231;alves", "link": "https://stackoverflow.com/users/4820394/pedro-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1452730399, "post_id": 34779311, "comment_id": 57303995, "body": "Signed chars are from -127 to 128. -1 is almost <b>always</b> an error return value. Only  unsigned are in the range 0 to 255."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1452730415, "post_id": 34779311, "comment_id": 57304001, "body": "Sorry this does not prove anything. The result is implementation defined and as a result it may just work for you but not necessarily all implementations."}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1452731243, "post_id": 34779311, "comment_id": 57304242, "body": "Yes, as always with C, that&#39;s why I put <i>in general</i>."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1452766918, "post_id": 34779311, "comment_id": 57317805, "body": "This code doesn&#39;t examine the <i>representation</i> of either object at all. To do so, you would require some kind of &quot;reinterpretation&quot;, such as <code>*(unsigned char*)(&amp;a)</code>. This code just operates on values."}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1452772349, "post_id": 34779311, "comment_id": 57321100, "body": "I used <code>static_cast</code> instead of <code>reinterpret_cast</code>, because this was specified by OP in <code>a = (char) b;</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452789879, "post_id": 34779311, "comment_id": 57333389, "body": "The phrase &quot;in general&quot; can mean either &quot;usually&quot; or &quot;always&quot;. And you&#39;re glossing over the fact that the result of the conversion is implementation-defined. <a href=\"http://stackoverflow.com/a/34779196/827263\">Kerrick SB&#39;s answer</a> is correct."}], "tags": [], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "is_accepted": true, "score": 1, "last_activity_date": 1452729164, "creation_date": 1452729164, "answer_id": 34779311, "question_id": 34779079, "link": "https://stackoverflow.com/questions/34779079/casting-unsigned-char-to-char-would-result-in-different-binary-representations/34779311#34779311", "title": "casting unsigned char to char would result in different binary representations?", "body": "<p>The answer in general, is no, there is no difference. Here you can test it yourself. Just supply the respective values for 'a' and 'b' </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nconst char *byte_to_binary(int x)\n{\n    static char b[9];\n    b[0] = '\\0';\n\n    int z;\n    for (z = 128; z &gt; 0; z &gt;&gt;= 1)\n        strcat(b, ((x &amp; z) == z) ? \"1\" : \"0\");\n    }\n\n    return b;\n}\n\n\nint main(void) {\n    unsigned char b = -7; \n    char a = -7; \n    printf(\"1. %s\\n\", byte_to_binary(a));\n    a = (char) b;\n    printf(\"2. %s\\n\", byte_to_binary(a));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4820394, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/972493956103073/picture?type=large", "display_name": "Pedro Gon&#231;alves", "link": "https://stackoverflow.com/users/4820394/pedro-gon%c3%a7alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 34779311, "answer_count": 2, "score": 0, "last_activity_date": 1452789707, "creation_date": 1452727988, "last_edit_date": 1452728095, "question_id": 34779079, "link": "https://stackoverflow.com/questions/34779079/casting-unsigned-char-to-char-would-result-in-different-binary-representations", "title": "casting unsigned char to char would result in different binary representations?", "body": "<p>I think the title is pretty self explanatory but basically what I'm saying is that, if I have the following instruction:</p>\n\n<pre><code>a = (char) b;\n</code></pre>\n\n<p>knowing that <code>a</code>'s type is <code>char</code> and <code>b</code>'s is <code>unsigned char</code>, can that instruction result in making <code>a</code> and <code>b</code> have different binary representations?</p>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452728981, "post_id": 34779049, "comment_id": 57303503, "body": "Do you know the difference between an array and a pointer?"}, {"owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452784154, "post_id": 34779049, "comment_id": 57329219, "body": "Yes. Are you saying *str fails because it is a pointer, while str[] is an array? <a href=\"http://www.lysator.liu.se/c/c-faq/c-2.html\" rel=\"nofollow noreferrer\">This link</a> says &quot;Since arrays decay immediately into pointers, an array is never actually passed to a function.&quot;. This lead me to believe that, in both cases, I am passing a pointer to strtok."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452802062, "post_id": 34779049, "comment_id": 57340609, "body": "Yes. However in the working case you are passing a pointer to <i>your array</i>, and in the non-working case you are passing a pointer to <i>a string literal</i>."}], "answers": [{"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 3, "last_activity_date": 1452730499, "creation_date": 1452730499, "answer_id": 34779514, "question_id": 34779049, "link": "https://stackoverflow.com/questions/34779049/why-does-strtok-segfault-when-given-a-string-but-not-when-given-a-string/34779514#34779514", "title": "Why does strtok segfault when given a *string but not when given a string[]?", "body": "<p>The trouble is that the type is wrong.</p>\n\n<pre><code>char *str = \"This is a test.\";\n</code></pre>\n\n<p>It may say <code>char*</code> but the thing on the right is actually <code>char const*</code> (C is very lax in allowing type punning (is that correct word)). Any attempt to modify a const is undefined behavior.</p>\n\n<p>The function <code>strtok()</code> actually modifies the underlying string (by inserting '\\0') so this is undefined behavior.</p>\n\n<p>Fix by doing.</p>\n\n<pre><code>char str[] = \"This is a test.\";\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "closed_date": 1452782643, "answer_count": 1, "score": 0, "last_activity_date": 1452730499, "creation_date": 1452727855, "question_id": 34779049, "link": "https://stackoverflow.com/questions/34779049/why-does-strtok-segfault-when-given-a-string-but-not-when-given-a-string", "closed_reason": "Duplicate", "title": "Why does strtok segfault when given a *string but not when given a string[]?", "body": "<p>Consider the following program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char *str = \"This is a test.\";\n    char *token;\n\n    token = strtok(str,\" \");\n}\n</code></pre>\n\n<p>It will segfault. But if I change *str to, say, str[80], it doesn't. Why is this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "pass-by-reference", "static-variables"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1452727756, "post_id": 34779025, "comment_id": 57303032, "body": "This question probably belongs on Code Review."}, {"owner": {"reputation": 9286, "user_id": 425756, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Jsf1p.jpg?s=128&g=1", "display_name": "Justin Meiners", "link": "https://stackoverflow.com/users/425756/justin-meiners"}, "edited": false, "score": 0, "creation_date": 1452727841, "post_id": 34779025, "comment_id": 57303073, "body": "A few issues I can think of, the semantics are a little strange, and threading."}, {"owner": {"reputation": 348, "user_id": 204276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c6df4819f2c5380079d98994ac0390?s=128&d=identicon&r=PG", "display_name": "Lee-Man", "link": "https://stackoverflow.com/users/204276/lee-man"}, "reply_to_user": {"reputation": 9286, "user_id": 425756, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Jsf1p.jpg?s=128&g=1", "display_name": "Justin Meiners", "link": "https://stackoverflow.com/users/425756/justin-meiners"}, "edited": false, "score": 1, "creation_date": 1452727978, "post_id": 34779025, "comment_id": 57303115, "body": "Yes, as @JustinMeiners says, it is not reentrant. I&#39;m more bothered by having a function who&#39;s sole purpose is side effects (function &quot;f&quot;). I&#39;d like a more realistic example before I&#39;d say it&#39;s &quot;bad&quot; in general."}, {"owner": {"reputation": 9, "user_id": 5787020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a396a4349d49ce92cae41e8be7878a2c?s=128&d=identicon&r=PG&f=1", "display_name": "E.Mac", "link": "https://stackoverflow.com/users/5787020/e-mac"}, "edited": false, "score": 0, "creation_date": 1452728393, "post_id": 34779025, "comment_id": 57303278, "body": "ok: in the project I am working on, in different parts of the function &quot;f()&quot; I have to reset some static variables declared in &quot;f()&quot; to a predefined value. And so in order to let my code more understandable I want to put this &quot;resetting&quot; of the variables inside another function. Maybe another idea is to use a macro..."}, {"owner": {"reputation": 23582, "user_id": 598289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b04c9074fed0dd215caec771c2a9ea98?s=128&d=identicon&r=PG", "display_name": "SJuan76", "link": "https://stackoverflow.com/users/598289/sjuan76"}, "edited": false, "score": 0, "creation_date": 1452728424, "post_id": 34779025, "comment_id": 57303288, "body": "For that kind of use, you may as well define a global variable; the semantics are the same (single instance accessed from multiple parts of the code) and at least it will be clearer to whoever reads the code. If you have multiple variables, try to at least put them together in a struct to limit the damage and make it clear when you are operating with the global variable."}, {"owner": {"reputation": 6639, "user_id": 1157100, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1f9W9.png?s=128&g=1", "display_name": "200_success", "link": "https://stackoverflow.com/users/1157100/200-success"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1452728446, "post_id": 34779025, "comment_id": 57303294, "body": "@KerrekSB &quot;A stupid example&quot; doesn&#39;t make good code for reviewing. It would be off-topic on Code Review."}, {"owner": {"reputation": 2135, "user_id": 4967497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0c6d09001cf39a7646ed2d22bc23352?s=128&d=identicon&r=PG", "display_name": "JojOatXGME", "link": "https://stackoverflow.com/users/4967497/jojoatxgme"}, "edited": false, "score": 0, "creation_date": 1452728993, "post_id": 34779025, "comment_id": 57303510, "body": "I do not see any problem which would not exist when you are not using it. Using static (non-const) variables can cause problems with multithreading, but this problem would exists even without using such function."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1452732519, "post_id": 34779025, "comment_id": 57304616, "body": "Strictly speaking, <a href=\"http://stackoverflow.com/questions/2229498/passing-by-reference-in-c\">C does not support pass by reference</a>.  You have to pass a pointer <b>by value</b> that refers to something else."}, {"owner": {"reputation": 231, "user_id": 995884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581e9c2c425d683ede2528c207558f1b?s=128&d=identicon&r=PG", "display_name": "Alex Measday", "link": "https://stackoverflow.com/users/995884/alex-measday"}, "edited": false, "score": 2, "creation_date": 1452739621, "post_id": 34779025, "comment_id": 57306654, "body": "Saying C does not support pass-by-reference is like the old argument (which many of you might not remember) about whether, in a proper object-oriented language, objects communicate by sending messages or by calling functions.  Logically and pragmatically, there was no difference.  Fortran passes arguments by reference by passing a pointer to the argument.  In C, passing a pointer to an argument is effectively passing the argument by reference.  (If you&#39;re feeling Algolish, you can also do pass-by-name by passing a function pointer for the thunk.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1452749987, "post_id": 34779025, "comment_id": 57309279, "body": "This is fine imo. The comments about threading would apply to any use of a static variable. You can use a thread-local variable if you want."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 231, "user_id": 995884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581e9c2c425d683ede2528c207558f1b?s=128&d=identicon&r=PG", "display_name": "Alex Measday", "link": "https://stackoverflow.com/users/995884/alex-measday"}, "edited": false, "score": 0, "creation_date": 1452791100, "post_id": 34779025, "comment_id": 57334286, "body": "@AlexMeasday, while the final effect may be very similar, the resulting source code is significantly different between passing by reference and passing the address of some object by value.  Please do not confuse the two methodologies"}, {"owner": {"reputation": 22854, "user_id": 2142994, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1bad25bebfae0b3f4bfd13b07f5d4f3b?s=128&d=identicon&r=PG", "display_name": "Ani Menon", "link": "https://stackoverflow.com/users/2142994/ani-menon"}, "edited": false, "score": 1, "creation_date": 1461903577, "post_id": 34779025, "comment_id": 61419149, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/22407964/passing-pointer-to-static-global-variable-in-c\">Passing pointer to static global variable in C</a>"}], "owner": {"reputation": 9, "user_id": 5787020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a396a4349d49ce92cae41e8be7878a2c?s=128&d=identicon&r=PG&f=1", "display_name": "E.Mac", "link": "https://stackoverflow.com/users/5787020/e-mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2261, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452728541, "creation_date": 1452727706, "last_edit_date": 1452728541, "question_id": 34779025, "link": "https://stackoverflow.com/questions/34779025/c-is-passing-static-variable-by-reference-acceptable-practice", "title": "C - Is passing static variable by reference acceptable practice?", "body": "<p>I would like to ask if there could be any problem in passing a static variable to a function by reference, in order to let that function modify the variable.\nA stupid example is:</p>\n\n<pre><code>void increment (int *b)\n{\n    *b = *b + 1;\n}\n\nvoid f()\n{\n   static int a = 4;\n   increment(&amp;a);\n   printf(\"%d\\n\", a);\n}\n\nint main()\n{\n   f();\n   f(); \n   f();\n   return 0;\n}\n</code></pre>\n\n<p>I executed it and it seems to work fine, printing</p>\n\n<pre><code>5\n6\n7\n</code></pre>\n\n<p>but I would like to understand if this is a sort of \"bad\" programming practice, that is preferable not to do.</p>\n"}, {"tags": ["c", "simulation", "microcontroller", "msp430"], "comments": [{"owner": {"reputation": 2632, "user_id": 3156046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5jWHS.jpg?s=128&g=1", "display_name": "HeadCode", "link": "https://stackoverflow.com/users/3156046/headcode"}, "edited": false, "score": 0, "creation_date": 1452736482, "post_id": 34779019, "comment_id": 57305850, "body": "Are you really programming in C, or are you using assembly?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452751992, "post_id": 34779019, "comment_id": 57309900, "body": "see the answer in electrical engineering, or maybe I will repost it here.  you shouldnt as the same question in two places."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452752357, "post_id": 34779019, "comment_id": 57310008, "body": "dont use external links in questions or answers or at least not as important portions of the question or answer since the remote link could eventually change and make this question useless to SO readers.  re-write or otherwise post the external information so that it is in/on stackoverflow in the question or answer."}, {"owner": {"reputation": 2632, "user_id": 3156046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5jWHS.jpg?s=128&g=1", "display_name": "HeadCode", "link": "https://stackoverflow.com/users/3156046/headcode"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452794994, "post_id": 34779019, "comment_id": 57336545, "body": "@dwelch My hat is off to you for even understanding the intent of the original question."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452798858, "post_id": 34779019, "comment_id": 57338748, "body": "not sure yet if I did understand which part the OP is confused about."}], "answers": [{"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452752253, "post_id": 34782815, "comment_id": 57309975, "body": "use the gnu tools.  (apt-get install gcc-msp430 msp430-libc) you can assemble then disassemble easily, the syntax might not exactly match the wikipedia page but you can figure it out (compile some very simple C programs and compile to asm or disassemble those to get clues on the syntax).  then start trying various addressing modes in asm then asseble and disassemble with the toolchain then you can disassemble or simulate with your program."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452752260, "post_id": 34782815, "comment_id": 57309977, "body": "If you are not able do all of these things (craft asm code to generate the various instruction possibilities) then you are not remotely ready to write a simulator."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": true, "score": 2, "last_activity_date": 1452752077, "creation_date": 1452752077, "answer_id": 34782815, "question_id": 34779019, "link": "https://stackoverflow.com/questions/34779019/msp430-microcontroller-how-to-check-addressing-modes/34782815#34782815", "title": "MSP430 microcontroller - how to check addressing modes", "body": "<p>so for the source if the as bits are 01 and the source register bits are a 0 which is the pc for reference then</p>\n\n<p>ADDR Symbolic. Equivalent to x(PC). The operand is in memory at address PC+x.</p>\n\n<p>if the ad bit is a 1 and the destination is a 0 then also </p>\n\n<p>ADDR Symbolic. Equivalent to x(PC). The operand is in memory at address PC+x.</p>\n\n<p>x is going to be another word that follows this instruction so the cpu will fetch the next word, add it to the pc and that is the source</p>\n\n<p>if the as bits are 11 and the source is register 0, the source is an immediate value which is in the next word after the instruction.</p>\n\n<p>if the as bits are 01 and the source is a 2 which happens to be the SR register for reference then the address is x the next word after the instruction (&amp;ADDR)</p>\n\n<p>if the ad bit is a 1 and the destination register is a 2 then it is also an &amp;ADDR</p>\n\n<p>if the as bits are 10 the source bits are a 2, then the source is the constant value 4 and we dont have to burn a word in flash after the instruction for that 4.</p>\n\n<p>it doesnt make sense to have a destination be a constant 4 so that isnt a real combination.</p>\n\n<p>repeat for the rest of the table.</p>\n\n<p>you can have both of these addressing modes at the same time</p>\n\n<pre><code>mov #0x5A80,&amp;0x0120\n</code></pre>\n\n<p>generates</p>\n\n<pre><code>c000:   b2 40 80 5a     mov #23168, &amp;0x0120 ;#0x5a80\nc004:   20 01\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>0x40b2 0x5a80 0x0120\n\n0100000010110010\n0100 opcode mov\n0000 source\n1 ad\n0 b/w\n11 as\n0010 destination\n</code></pre>\n\n<p>so we have an as of 11 with source of 0 the immediate #x, an ad of 1 with a destination 2 so the destination is &amp;ADDR.  this is an important experiment because when you have 2 x values, a three word instruction basically which one goes with the source and which the destination</p>\n\n<pre><code>0x40b2 0x5a80 0x0120\n</code></pre>\n\n<p>so the address 0x5a80 which is the destination is the first x to follow the instruction then the source 0x0120 an immediate comes after that.</p>\n\n<p>if it were just an immediate and a register then</p>\n\n<pre><code>c006:   31 40 ff 03     mov #1023,  r1  ;#0x03ff\n\n0x4031 0x03FF\n\n0100000000110001\n0100 mov\n0000 source\n0 ad\n0 b/w\n11 as\n0001 dest\n</code></pre>\n\n<p>as of 11 and source of 0 is #immediate the X is 0x03FF in this case the word that follows.  the destination is ad of 0 </p>\n\n<pre><code>Register direct. The operand is the contents of Rn \n</code></pre>\n\n<p>where destination in this case is r1</p>\n\n<p>so the first group Rn, x(Rn), @Rn and @Rn+ are the normal cases, the ones below that that you are asking about are special cases, if you get a combination that fits into a special case then you do that otherwise you do the normal case like the mov immediate to r1 example above.  the destination of r1 was a normal Rn case.</p>\n"}, {"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 1, "last_activity_date": 1452758620, "creation_date": 1452758620, "answer_id": 34784393, "question_id": 34779019, "link": "https://stackoverflow.com/questions/34779019/msp430-microcontroller-how-to-check-addressing-modes/34784393#34784393", "title": "MSP430 microcontroller - how to check addressing modes", "body": "\n\n<ul>\n<li><p>As=01, Ad=1, R0 (<strong>ADDR</strong>): This is exactly the same as <strong>x(Rn)</strong>, i.e., the operand is in memory at address R0+x.</p>\n\n<p>This is used for data that is stored near the code that uses it, when the compiler does not know at which absolute address the code will be located, but it knows that the data is, e.g., twenty words behind the instruction.</p></li>\n<li><p>As=11, R0 (<strong>#x</strong>): This is exactly the same as <strong>@R0+</strong>, and is used for instructions that need a word of data from the instruction stream. For example, this assembler instruction:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MOV #1234, R5\n</code></pre>\n\n<p>is actually encoded and implemented as:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MOV @PC+, R5\n.dw 1234\n</code></pre>\n\n<p>After the CPU has read the MOV instruction word, PC points to the data word. When reading the first MOV operand, the CPU reads the data word, and increments PC again.</p></li>\n<li><p>As=01, Ad=1, R2 (<strong>&amp;ADDR</strong>): this is exactly the same as x(Rn), but the R2 register reads as zero, so what you end up with is the value of x.</p>\n\n<p>Using the always-zero register allows to encode absolute addresses without needing a special addressing mode for this (just a special register).</p></li>\n<li><p>constants -1/0/1/2/4/8: it would not make sense to use the SR and CG registers with most addressing modes, so these encodings are used to generate special values without a separate data word, to save space:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>encoding:       what actually happens:\nMOV @SR, R5     MOV #4, R5\nMOV @SR+, R5    MOV #8, R5\nMOV CG, R5      MOV #0, R5\nMOV x(CG), R5   MOV #1, R5  (no word for x)\nMOV @CG, R5     MOV #2, R5\nMOV @CG+, R5    MOV #-1, R5\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 150, "user_id": 4082810, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wcz2a.jpg?s=128&g=1", "display_name": "ziom", "link": "https://stackoverflow.com/users/4082810/ziom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 34782815, "answer_count": 2, "score": 1, "last_activity_date": 1452758620, "creation_date": 1452727650, "question_id": 34779019, "link": "https://stackoverflow.com/questions/34779019/msp430-microcontroller-how-to-check-addressing-modes", "title": "MSP430 microcontroller - how to check addressing modes", "body": "<p>I'm programming a MSP430 in C language as a simulation of real microcontroller. I got stuck in addressing modes (<a href=\"https://en.wikipedia.org/wiki/TI_MSP430#MSP430_CPU\" rel=\"nofollow\">https://en.wikipedia.org/wiki/TI_MSP430#MSP430_CPU</a>), especially:</p>\n\n<ul>\n<li>Addressing modes using R0 (PC)</li>\n<li><p>Addressing modes using R2 (SR) and R3 (CG), special-case decoding</p>\n\n<ol>\n<li>I don't understand what does mean 0(PC), 2(SR) and 3(CG). What they are?</li>\n<li>How to check these values?</li>\n</ol></li>\n</ul>\n"}, {"tags": ["c", "macros", "global-variables", "constants", "c-preprocessor"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452726683, "post_id": 34778765, "comment_id": 57302635, "body": "<code>#define x 3</code> does <i>not</i> create a global variable."}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452726971, "post_id": 34778765, "comment_id": 57302741, "body": "@immibis What is what it does, then?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452727416, "post_id": 34778765, "comment_id": 57302901, "body": "It defines an object-like macro. Object-like macros are different from global variables."}], "answers": [{"comments": [{"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452727331, "post_id": 34778928, "comment_id": 57302863, "body": "So, is this something more related to the style of the code?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452727459, "post_id": 34778928, "comment_id": 57302918, "body": "@ClaudioCortese Imagine somewhere else you have a for loop: <code>for(int x = 5; x &lt; 10; x++) printf(&quot;%d\\n&quot;, x);</code> Guess what will happen if you use the #define?"}, {"owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "edited": false, "score": 0, "creation_date": 1452727663, "post_id": 34778928, "comment_id": 57302987, "body": "It&#39;s more than that. Say I wrote <code>#define x rand()</code>. Everywhere I use <code>x</code> in my code, it gets replaced by <code>rand()</code> and produces a new random number. If instead I use <code>const int x = rand()</code>, it will only compute <code>rand()</code> once and every time I use <code>x</code>, I&#39;ll get the same number."}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452727777, "post_id": 34778928, "comment_id": 57303048, "body": "@immibis You are right, but you can avoid this error in a simple way, this is not a real problem hence"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452728075, "post_id": 34778928, "comment_id": 57303157, "body": "@ClaudioCortese What&#39;s the simple way?"}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452728145, "post_id": 34778928, "comment_id": 57303187, "body": "@immibis Do not use int x, instead int another_name"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452728305, "post_id": 34778928, "comment_id": 57303252, "body": "@ClaudioCortese Well yeah, but that&#39;s pretty impractical if you already have 2000 different local variables called x."}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452728469, "post_id": 34778928, "comment_id": 57303301, "body": "@immibis Well, that&#39;s why I would use #define, you have a value that is repeated more than one, not only in the main, I think that it&#39;s simpler changing the name of a single variable instead of replacing the value in all the code"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452728724, "post_id": 34778928, "comment_id": 57303403, "body": "@ClaudioCortese But you could use <code>const int x = 3;</code> and then there&#39;d be no problem with existing local variables called x."}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452728940, "post_id": 34778928, "comment_id": 57303483, "body": "@immibis That&#39;s the point.. if I can use this, why should I use #define instead? Am I not seeing something that my teacher does? Is there something more than an int x that would break your code? Maybe optimisation-wise? Is it just a style thing?"}], "tags": [], "owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "is_accepted": true, "score": 1, "last_activity_date": 1452727101, "creation_date": 1452727101, "answer_id": 34778928, "question_id": 34778765, "link": "https://stackoverflow.com/questions/34778765/is-using-object-like-macros-a-good-way-to-define-global-variables/34778928#34778928", "title": "Is using object-like macros a good way to define global variables?", "body": "<p><code>#define</code> was used to create a constant, not a variable, but now it's frowned upon for that purpose. <code>#define x 3</code> is a preprocessor directive that basically means \"replace <code>x</code> with <code>3</code> everywhere in the source file\". It's like a search and replace in a code editor with the \"match whole word\" and \"case-sensitive\" options on.</p>\n\n<p><code>const</code>, on the other hand, creates a legitimate identifier with an address and scope and everything. It can be used just like a variable, even with the <code>&amp;</code> (address of) operator. It just can't be assigned to.</p>\n"}, {"comments": [{"owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "edited": false, "score": 0, "creation_date": 1452727837, "post_id": 34779010, "comment_id": 57303071, "body": "That &quot;lookup&quot; will be optimized away by any better-than-totally-horrible compiler."}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452728078, "post_id": 34779010, "comment_id": 57303159, "body": "Perhaps this is why my teacher said this is the best way to declare a global variable"}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "reply_to_user": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "edited": false, "score": 0, "creation_date": 1452728307, "post_id": 34779010, "comment_id": 57303254, "body": "@JohnSensebe Wait, did I miss something? Is using const int more optimised than #define?"}, {"owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "edited": false, "score": 0, "creation_date": 1452782476, "post_id": 34779010, "comment_id": 57327937, "body": "No, but a decent compiler will make <code>const</code> as efficient as a <code>#define</code>. It used to be said that <code>const</code> was slower for the reason in the answer, but today that is rarely the case. Plus, with <code>const</code> there is type checking and debugging can be easier."}], "tags": [], "owner": {"reputation": 11, "user_id": 5787037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZSZ4.jpg?s=128&g=1", "display_name": "Hitendra Verma", "link": "https://stackoverflow.com/users/5787037/hitendra-verma"}, "is_accepted": false, "score": 1, "last_activity_date": 1452727587, "creation_date": 1452727587, "answer_id": 34779010, "question_id": 34778765, "link": "https://stackoverflow.com/questions/34778765/is-using-object-like-macros-a-good-way-to-define-global-variables/34779010#34779010", "title": "Is using object-like macros a good way to define global variables?", "body": "<p>There is no difference for #define and Const value for this small piece of code. But if you are coding for a performance critical code , consider #define because it makes your value global, It is pre-processed by the compiler While Const have normal lookup.\nAdvantage it that #define automatically replaces every occurence of the name. \nAnd disadvantage is that it conflicts if you have same name used many times in your code.</p>\n"}], "owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 34778928, "answer_count": 2, "score": 0, "last_activity_date": 1452727587, "creation_date": 1452726423, "question_id": 34778765, "link": "https://stackoverflow.com/questions/34778765/is-using-object-like-macros-a-good-way-to-define-global-variables", "title": "Is using object-like macros a good way to define global variables?", "body": "<p>I've been told by my teacher that the preprocessor command <strong><em>#define</em></strong> is the way to go to declare a global variable. Basically I use the <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Object-like-Macros.html#Object-like-Macros\" rel=\"nofollow\">object-like macros</a></p>\n\n<pre><code>#define x 3\n</code></pre>\n\n<p>to declare <strong><em>x</em></strong> as a global variable. Now, I was used to do something like that to define these kind of variables and I have been recommended to not do that anymore :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int x = 3;\n\nint main(void){...};\n</code></pre>\n\n<p>As far as I can see (let's take in consideration that I'm new to C and programming in general), the two ways of declaring the global variables are pratically the same, if we talk about how the program works.\nAssume that I have a code like thath :</p>\n\n<pre><code>y = x * 3;\n</code></pre>\n\n<p>this code will compile and run without any problem at all, both using <code>#define x 3</code> and <code>const int x = 3;</code>. Now, I'm surely missing something here, but I really can't see a difference! Can someone gently show me what's the point of the question?</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1452726095, "post_id": 34778694, "comment_id": 57302419, "body": "You probably meant: <code>#define PASSWORD &quot;********&quot;</code>"}, {"owner": {"reputation": 35, "user_id": 5786976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be17de1d3013cb9f05e4d93f4148ac14?s=128&d=identicon&r=PG&f=1", "display_name": "Syntyche Ackerley", "link": "https://stackoverflow.com/users/5786976/syntyche-ackerley"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1452726192, "post_id": 34778694, "comment_id": 57302454, "body": "gg, no re, thank you for the quick fix"}], "answers": [{"tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": true, "score": 7, "last_activity_date": 1452769936, "last_edit_date": 1452769936, "creation_date": 1452726100, "answer_id": 34778711, "question_id": 34778694, "link": "https://stackoverflow.com/questions/34778694/error-expected-expression-before-token-char/34778711#34778711", "title": "Error: expected expression before &#39;;&#39; token char", "body": "<p><code>#define</code> directive would define a label for some primitive value.</p>\n\n<p>This implies your code will be interpreted as <code>char passwd[]=********;</code> in compile time.</p>\n\n<p>You probably need quotes around the **:</p>\n\n<pre><code>#define PASSWORD \"********\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1452726162, "creation_date": 1452726162, "answer_id": 34778720, "question_id": 34778694, "link": "https://stackoverflow.com/questions/34778694/error-expected-expression-before-token-char/34778720#34778720", "title": "Error: expected expression before &#39;;&#39; token char", "body": "<p><code>PASSWORD</code> has to be a string literal, in your code it's just multiple multiplication operators which is why the error message. To make it a string literal use double quotes like this</p>\n\n<pre><code>#define PASSWORD \"********\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "is_accepted": false, "score": 0, "last_activity_date": 1452742777, "creation_date": 1452742777, "answer_id": 34781320, "question_id": 34778694, "link": "https://stackoverflow.com/questions/34778694/error-expected-expression-before-token-char/34781320#34781320", "title": "Error: expected expression before &#39;;&#39; token char", "body": "<p>The method in _Danny_ds_ and <em>iharob</em>'s answer is correct. Also, you can use the <code>strcpy</code> function to copy the <code>constant</code> into the <code>string</code> <code>passwd</code>. Like This: <code>strcpy (passwd, PASSWORD);</code></p>\n\n<p>You can read <a href=\"http://www.programiz.com/c-programming/library-function/string.h/strcpy\" rel=\"nofollow\">this</a> tutorial on <code>strcpy</code>.</p>\n\n<p><strong>NOTE:</strong> You also have to make the changes mentioned in the above answers.</p>\n"}], "owner": {"reputation": 35, "user_id": 5786976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be17de1d3013cb9f05e4d93f4148ac14?s=128&d=identicon&r=PG&f=1", "display_name": "Syntyche Ackerley", "link": "https://stackoverflow.com/users/5786976/syntyche-ackerley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 34778711, "answer_count": 3, "score": 1, "last_activity_date": 1452769936, "creation_date": 1452726013, "last_edit_date": 1452726159, "question_id": 34778694, "link": "https://stackoverflow.com/questions/34778694/error-expected-expression-before-token-char", "title": "Error: expected expression before &#39;;&#39; token char", "body": "<p>I am experimenting with a code, I have looked through the other posts, but couldn't figure it out, could you help me out on why I am getting:</p>\n\n<pre><code>error: expected expression before ';' token\n    char passwd[] = PASSWORD;\n</code></pre>\n\n<p>=========================</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE 100\n#define PASSWORD ********\n\nint main()\n{\n    int count = 0;\n    char buff[SIZE] = \" \";\n    char passwd[] = PASSWORD;\n...\n</code></pre>\n"}, {"tags": ["c", "error-handling"], "comments": [{"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452727535, "post_id": 34778575, "comment_id": 57302943, "body": "I would have done a do-while loop instead of a while-loop, just to make the code more clear."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452727764, "post_id": 34778575, "comment_id": 57303040, "body": "Code is not consuming bad non-numeric input, causing code to error again, again...."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452727816, "post_id": 34778617, "comment_id": 57303063, "body": "Bad input still in <code>stdin</code>. --&gt; infinite loop."}, {"owner": {"reputation": 4667, "user_id": 5695504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7c8870ba24f6cb1b54dfae0521cb13?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/5695504/ilya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1452728590, "post_id": 34778617, "comment_id": 57303349, "body": "@chux yes, thanks for pointing that out. I&#39;ve just done the minimal fixes of the OP code, but it&#39;s better to post a more robust version, I&#39;ll update it."}], "tags": [], "owner": {"reputation": 4667, "user_id": 5695504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7c8870ba24f6cb1b54dfae0521cb13?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/5695504/ilya"}, "is_accepted": false, "score": 1, "last_activity_date": 1452729102, "last_edit_date": 1495535276, "creation_date": 1452725656, "answer_id": 34778617, "question_id": 34778575, "link": "https://stackoverflow.com/questions/34778575/programming-in-c-error-handling-an-integer-value/34778617#34778617", "title": "Programming in C. Error Handling an integer value", "body": "<pre><code>scanf(\"%d\", &amp;client.id);\n</code></pre>\n\n<p>You have to test the return value of scanf. If the result is 1, it has successfully scanned your integer. All you have to do next is to test that the value is >=1.</p>\n\n<p>So, something like that:</p>\n\n<pre><code>   while( 1 ) {\n\n     printf(\"Enter client Id---&gt;\");\n     int scanned = scanf(\"%d\", &amp;client.id);\n\n     if( scanned != 1 || client.id &lt; 1 ) {\n        // note: infinite loop for invalid input, see note below\n        printf(\"Invalid I.d entered\\n\");     \n     }\n     else {\n        break; // OK\n     }\n   }\n</code></pre>\n\n<p>NB(1) see <a href=\"https://stackoverflow.com/questions/1716013/why-is-scanf-causing-infinite-loop-in-this-code\">there</a> for a an explanation of why <code>scanf</code> is unsafe and ways of making it safe(r).</p>\n\n<p>NB(2) you haven't included the <code>client.id</code> declaration, but it has to be an <code>int</code> type. Even if you wanted to scan a float instead of an int, <code>x % 1 != 0</code> is a no-no.</p>\n"}, {"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1452725941, "post_id": 34778625, "comment_id": 57302364, "body": "Note that because it&#39;s an int (presumably, because it&#39;s being read with %d) it&#39;s <b><i>always</i></b> an integer."}, {"owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452726177, "post_id": 34778625, "comment_id": 57302450, "body": "Ah, yes. It has to be read in as a float or double. I&#39;ll add that to the answer."}, {"owner": {"reputation": 13, "user_id": 5415999, "user_type": "registered", "profile_image": "https://graph.facebook.com/951359724910736/picture?type=large", "display_name": "Bhana Jameelah", "link": "https://stackoverflow.com/users/5415999/bhana-jameelah"}, "edited": false, "score": 0, "creation_date": 1452728776, "post_id": 34778625, "comment_id": 57303421, "body": "yes! thank you so much your code worked except that i had to change double to float but thank you so much! :)"}, {"owner": {"reputation": 4667, "user_id": 5695504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7c8870ba24f6cb1b54dfae0521cb13?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/5695504/ilya"}, "reply_to_user": {"reputation": 13, "user_id": 5415999, "user_type": "registered", "profile_image": "https://graph.facebook.com/951359724910736/picture?type=large", "display_name": "Bhana Jameelah", "link": "https://stackoverflow.com/users/5415999/bhana-jameelah"}, "edited": false, "score": 0, "creation_date": 1452729217, "post_id": 34778625, "comment_id": 57303605, "body": "@BhanaJameelah see this comment: <a href=\"http://stackoverflow.com/questions/34778575/programming-in-c-error-handling-an-integer-value/34778617#comment57303349_34778617\" title=\"programming in c error handling an integer value\">stackoverflow.com/questions/34778575/&hellip;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452730089, "post_id": 34778625, "comment_id": 57303903, "body": "<code>double x; ... scanf(&quot;%f&quot;, &amp;x);</code> is undefined behavior.  Wrong specifier for the type."}, {"owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "edited": false, "score": 0, "creation_date": 1452782707, "post_id": 34778625, "comment_id": 57328107, "body": "Fixed. I&#39;ve rarely used <code>scanf</code>, so I didn&#39;t realize it needed a different specifier, but it makes perfect sense now that I think about it, because it&#39;s stuffing the value into a reference."}], "tags": [], "owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "is_accepted": true, "score": -1, "last_activity_date": 1452782569, "last_edit_date": 1452782569, "creation_date": 1452725697, "answer_id": 34778625, "question_id": 34778575, "link": "https://stackoverflow.com/questions/34778575/programming-in-c-error-handling-an-integer-value/34778625#34778625", "title": "Programming in C. Error Handling an integer value", "body": "<p>To check that a number is not an integer, the easiest way (the way without function calls) would be <code>client.id != (int)client.id</code>.</p>\n\n<p>But first, you must read the number as a floating-point type, precisely so you can catch that error. My code:</p>\n\n<pre><code>    double x;\n    printf(\"Enter client Id---&gt;\");\n    scanf(\"%lf\", &amp;x);\n    while((x &lt; 1.0) || (x != (int)x))\n    {\n        printf(\"Invalid I.d entered\\n\");\n        printf(\"Enter client Id---&gt;\");\n        scanf(\"%lf\",&amp;x);\n    } // endwhile\n    client.id = (int)x;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320, "user_id": 4084561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JvpDA.jpg?s=128&g=1", "display_name": "Curt", "link": "https://stackoverflow.com/users/4084561/curt"}, "is_accepted": false, "score": 0, "last_activity_date": 1452725944, "creation_date": 1452725944, "answer_id": 34778679, "question_id": 34778575, "link": "https://stackoverflow.com/questions/34778575/programming-in-c-error-handling-an-integer-value/34778679#34778679", "title": "Programming in C. Error Handling an integer value", "body": "<p>You can add a printf after the scanf to ensure scanf is working as expected.</p>\n\n<p>Still, regardless of what value is entered, the program exits without entering while() body.</p>\n\n<p>Of the two while() conditions, the first is innocuous, but the second is suspect because it is false for all values.</p>\n"}], "owner": {"reputation": 13, "user_id": 5415999, "user_type": "registered", "profile_image": "https://graph.facebook.com/951359724910736/picture?type=large", "display_name": "Bhana Jameelah", "link": "https://stackoverflow.com/users/5415999/bhana-jameelah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 34778625, "answer_count": 3, "score": 1, "last_activity_date": 1452782569, "creation_date": 1452725426, "last_edit_date": 1452727633, "question_id": 34778575, "link": "https://stackoverflow.com/questions/34778575/programming-in-c-error-handling-an-integer-value", "title": "Programming in C. Error Handling an integer value", "body": "<p>I have an integer input for my I.D. My teacher says I need to error handle all my inputs and basically display appropriate error messages if input entered is invalid. So I'm trying to get an error message to pop up if the user enters a real number or number less than one. But what I've tried is not working!</p>\n\n<pre><code>  printf(\"Enter client Id---&gt;\");\n  scanf(\"%d\", &amp;client.id);\n  while ((client.id &lt; 1) || (client.id % 1 != 0)) {\n    printf(\"Invalid I.d entered\\n\");\n    printf(\"Enter client Id---&gt;\");\n    scanf(\"%d\", &amp;client.id);\n  } // endwhile`\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "syslog", "syslog-ng"], "comments": [{"owner": {"reputation": 1736, "user_id": 418599, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QDDnf.jpg?s=128&g=1", "display_name": "Antonio Petricca", "link": "https://stackoverflow.com/users/418599/antonio-petricca"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452724921, "post_id": 34778402, "comment_id": 57301898, "body": "Could you make me an example? Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1452725867, "creation_date": 1452725867, "answer_id": 34778667, "question_id": 34778402, "link": "https://stackoverflow.com/questions/34778402/include-level-into-syslog-log-file/34778667#34778667", "title": "Include LEVEL into SysLog log file", "body": "<p>You can write a wrapper function like this</p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;syslog.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint\nmysyslog(int __level, const char *const syslogformat, ...)\n{\n    va_list args;\n    char *format;\n    size_t length;\n    char *level;\n    ssize_t result;\n\n    va_start(args,syslogformat);\n\n    level = \"?\";\n    switch (__level)\n    {\n        case LOG_ALERT:\n            level = \"LOG_ALERT\";\n            break;\n        case LOG_INFO:\n            level = \"LOG_INFO\";\n            break;\n       case LOG_EMERG:\n            level = \"LOG_EMERG\";\n            break;\n       case LOG_CRIT:\n            level = \"LOG_CRIT\";\n            break;\n       case LOG_ERR:\n            level = \"LOG_ERR\";\n            break;\n       case LOG_WARNING:\n            level = \"LOG_WARNING\";\n            break;\n       case LOG_NOTICE:\n            level = \"LOG_NOTICE\";\n            break;\n       case LOG_DEBUG:\n            level = \"LOG_DEBUG\";\n            break;\n    }\n\n    length = strlen(syslogformat) + strlen(level) + 2;\n    format = malloc(length + 1);\n    result = snprintf(format, length + 1, \"%s: %s\", level, syslogformat);\n    if ((result &lt; 0) || (result &gt;= length + 1))\n        return -1;\n    vsyslog(__level, format, args);\n    va_end(args);\n\n    return 0;\n}\n\nint main(void) \n{\n    mysyslog(LOG_NOTICE, \"This is a log message `%d' with an integer as parameter\\n\", 100);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 5940183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cdb2c5f57c2980ed7cb4d59fc0ab579?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/5940183/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1477041614, "creation_date": 1477041614, "answer_id": 40172810, "question_id": 34778402, "link": "https://stackoverflow.com/questions/34778402/include-level-into-syslog-log-file/40172810#40172810", "title": "Include LEVEL into SysLog log file", "body": "<p>Just use a template for your destination file in which you specifie how your log message will be displayed/written; something like this shows only syslog level and message:</p>\n\n<pre><code>template t_example { template(\"${LEVEL}\" \"${MSG}\"); };\n\ndestination d_example { file(\"/var/log/example.log\" template(t_example) ); };\n</code></pre>\n"}], "owner": {"reputation": 1736, "user_id": 418599, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QDDnf.jpg?s=128&g=1", "display_name": "Antonio Petricca", "link": "https://stackoverflow.com/users/418599/antonio-petricca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1477041614, "creation_date": 1452724648, "question_id": 34778402, "link": "https://stackoverflow.com/questions/34778402/include-level-into-syslog-log-file", "title": "Include LEVEL into SysLog log file", "body": "<p>Is it possibile to show the level (LOG_INFO, LOG_ERROR, ...) information passed to the \"syslog\" function into each log line?</p>\n\n<p>Thank you!\nAntonio</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 0, "creation_date": 1452724177, "post_id": 34778291, "comment_id": 57301558, "body": "<a href=\"http://stackoverflow.com/questions/11823904/subsititue-of-getchar-and-clrscr-in-c-for-linux\" title=\"subsititue of getchar and clrscr in c for linux\">stackoverflow.com/questions/11823904/&hellip;</a>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452724274, "post_id": 34778291, "comment_id": 57301608, "body": "&quot;my IDE (vmware virtual machine)&quot; - what&#39;s your <b><i>actual</i></b> IDE, and operating system? conio.h is Windows-specific."}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1452724304, "post_id": 34778291, "comment_id": 57301619, "body": "<code>&lt;conio.h&gt;</code> is windows specific - removing the <code>clrscr()</code> and <code>getch()</code> calls is indeed probably the simplest fix.  See also <a href=\"http://stackoverflow.com/questions/448944/c-non-blocking-keyboard-input/448982#448982\" title=\"c non blocking keyboard input\">stackoverflow.com/questions/448944/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 5423068, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5aff343ca08e0e3661f95292571322d9?s=128&d=identicon&r=PG&f=1", "display_name": "user8357", "link": "https://stackoverflow.com/users/5423068/user8357"}, "edited": false, "score": 0, "creation_date": 1452725765, "post_id": 34778291, "comment_id": 57302296, "body": "My system is a virtual machine in Linux. It has a C compiler."}, {"owner": {"reputation": 21, "user_id": 5423068, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5aff343ca08e0e3661f95292571322d9?s=128&d=identicon&r=PG&f=1", "display_name": "user8357", "link": "https://stackoverflow.com/users/5423068/user8357"}, "edited": false, "score": 0, "creation_date": 1452726434, "post_id": 34778291, "comment_id": 57302542, "body": "Your fix worked! Thank you."}], "owner": {"reputation": 21, "user_id": 5423068, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5aff343ca08e0e3661f95292571322d9?s=128&d=identicon&r=PG&f=1", "display_name": "user8357", "link": "https://stackoverflow.com/users/5423068/user8357"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "closed_date": 1452724268, "answer_count": 0, "score": 0, "last_activity_date": 1452724106, "creation_date": 1452724106, "question_id": 34778291, "link": "https://stackoverflow.com/questions/34778291/c-programming-substitute-for-conio-h-cursor-h-doesnt-work-either", "closed_reason": "Duplicate", "title": "C programming: Substitute for conio.h? (cursor.h doesn&#39;t work either)", "body": "<p>I'm trying to compile this code but my IDE (vmware virtual machine) doesn't recognize the header file conio.h. Does anyone know a way around this?\nThis code reads in the values of three characters from the keyboard and prints the sum.</p>\n\n<pre><code>#include&lt;stdio.h&gt; \n#include&lt;conio.h&gt; \n\nvoid main() \n{ \nint a,b,c,d,e; \nclrscr(); \n\nprintf(\"\\n Enter the three numbers:\"); \nscanf(\"%d %d %d\",&amp;a,&amp;b,&amp;c); \n\nd=a+b+c; \n\n\nprintf(\"|n The sum is %d\", d); \ngetch(); \n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1452723578, "post_id": 34778106, "comment_id": 57301315, "body": "<code>return &amp;newArr</code> should be <code>return newArr</code>. Your compiler should have warned you about that. In fact it should have given you two warnings (incorrect return type and returning address of local variable). Do not ignore compiler warnings."}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1452723613, "post_id": 34778106, "comment_id": 57301326, "body": "<code>return &amp;newArr;</code> you return an <code>int**</code> You should activate your compilator warnings"}, {"owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 0, "creation_date": 1452725584, "post_id": 34778106, "comment_id": 57302226, "body": "Wow thanks alot! first post on this forum, you helped me fix it and understand my mistakes in like 10 mins!"}], "answers": [{"tags": [], "owner": {"reputation": 1328, "user_id": 4750084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqyxW.png?s=128&g=1", "display_name": "John Sensebe", "link": "https://stackoverflow.com/users/4750084/john-sensebe"}, "is_accepted": false, "score": 3, "last_activity_date": 1452724043, "creation_date": 1452724043, "answer_id": 34778271, "question_id": 34778106, "link": "https://stackoverflow.com/questions/34778106/fails-to-print-pointer-arrays-in-c/34778271#34778271", "title": "Fails to print pointer arrays in C", "body": "<p>The end of your function:</p>\n\n<pre><code>printf(\"The new array's size is %d\\n\", *pNewSize);\nfor (i = 0; i &lt; pNewSize; i++) {\n    printf(\"The new array is %d\\n\", *(newArr + i));\n}\nreturn &amp;newArr;\n</code></pre>\n\n<p>There are two errors here. The first is that <code>pNewSize</code> is a pointer and needs to be dereferenced in the <code>for</code> loop:</p>\n\n<pre><code>for (i = 0; i &lt; *pNewSize; i++) {\n</code></pre>\n\n<p>The second, as mentioned in the comments, is that <code>newArr</code> is already a pointer, ready to be returned like so:</p>\n\n<pre><code>return newArr;\n</code></pre>\n\n<p>Also, in <code>main()</code>,</p>\n\n<pre><code>int numcase, sizeA, sizeB, *pNewSize = 0, i, *A, *B;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>int numcase, sizeA, sizeB, newSize = 0, i, *A, *B;\n</code></pre>\n\n<p>and passed by address in the function call:</p>\n\n<pre><code>symmetricDiff(A, sizeA, B, sizeB, &amp;newSize);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 996, "user_id": 2398196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3NxAD.jpg?s=128&g=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/2398196/the-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1452724242, "creation_date": 1452724242, "answer_id": 34778319, "question_id": 34778106, "link": "https://stackoverflow.com/questions/34778106/fails-to-print-pointer-arrays-in-c/34778319#34778319", "title": "Fails to print pointer arrays in C", "body": "<p>Not sure if this small bit is correct since you said you want to move the different values across, so it should be if <code>cnt != 0;</code> if I am understanding correctly.</p>\n\n<pre><code>if (cnt == 0) {\n        (*pNewSize)++;\n        newArr = (int*)realloc(newArr, (*pNewSize + 1) * sizeof(int));\n        if (newArr == NULL) {\n            printf(\"Failed to allocate memory\");\n            return 0;\n        }\n        *(newArr+k) = *(A+i);\n        k++;\n    }\n</code></pre>\n\n<p>But since you are confident in your code, other than printing, \"Ive done everything right up to the point where im trying to either print the new array inside the function or after I return it's address\".</p>\n\n<p>However, as @kaylum mentioned, you are returning a pointer to a pointer <code>return &amp;newArr;</code> where you should just do <code>return newArr;</code>. Then to print it, you will need to de-reference the return value. However, since this is actually an array, not just one value, you will need to loop over all values in the array and print them, but to do this you need to catch the return value. I.E. </p>\n\n<pre><code>int * returnArr = symmetricDiff(A, sizeA, B, sizeB, &amp;pNewSize);\nfor(i = 0; i &lt; *pNewSize; i++){\n    printf(\"%d \",returnArr[i]);\n}\n</code></pre>\n\n<p>The above code should be in main.</p>\n\n<p>Your commented print <code>printf(\"The new array is %d\\n\", *(symmetricDiff));</code> is printing the dereferenced pointer to the function symmetricDiff.</p>\n\n<p>Finally, when you declare <code>*pNewSize</code>, do not set it equal to zero. You are effectively setting the address of the variable to 0.</p>\n"}, {"comments": [{"owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "reply_to_user": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 0, "creation_date": 1452812325, "post_id": 34780783, "comment_id": 57345951, "body": "@Akra,  you&#39;re welcome :-)  I wouldn&#39;t complain if you were to select this as an answer.  Most everything I added is &quot;just&quot; printfs(), you can learn a lot about your code by printing things out.  Good luck :-)"}], "tags": [], "owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "is_accepted": true, "score": 2, "last_activity_date": 1452753803, "last_edit_date": 1452753803, "creation_date": 1452739207, "answer_id": 34780783, "question_id": 34778106, "link": "https://stackoverflow.com/questions/34778106/fails-to-print-pointer-arrays-in-c/34780783#34780783", "title": "Fails to print pointer arrays in C", "body": "<p>Keeping with your original design for symmetricDiff()\nthe biggest problem I see you are returning the\naddress of your local variable 'newArr' instead of the value.</p>\n\n<p>I would suggest polishing your mental model of stack vs. heap storage and\ndrawing a diagram of the various pointers and storage in play.\nNote: this is easier to do with pencil &amp; paper :-)</p>\n\n<p>I added a fair number of print statements to your code to help show what was happening to the variables.</p>\n\n<p>I also added a test hook - see option #9 (it just assigns some hardwired values to A and B, because I didn't want to do data entery each time every time I ran the program).</p>\n\n<p>My goal with the print statents is to give you an idea about how you can print values and addresses in various places and see what the code is actually doing (because more often than I care to admit, the code doesn't always do what we <em>think</em> it is doing :-) ).</p>\n\n<p>Browse through the actual output (below, first) and reference that against the modified source code (below, second).</p>\n\n<p>Check the values of your variables (and their addresses) and see if that helps untangle your original code.</p>\n\n<p>Good luck and happy coding :-)</p>\n\n<p>p.s. the prints are rather verbose, my apologies for that - I wanted to keep the debugging additions as simple as possible, and without wrapping things up in a struct or something it seems like \"printf\" was the way to go.</p>\n\n<p>The takehome messages here would be 1) remember you can add enough prints to show pretty much whatever is going on, and 2) once you wrap your head around addresses and pointers you won't need to go as crazy as I did here.</p>\n\n<h2>OUTPUT (from modified code)</h2>\n\n<pre><code>$ ./a.out\n\n-----\nPick a function to activate\n1 - First paragraph\n2 - Second paragraph\n3 - Third paragraph\n9 - test\n0 - Terminate the application\n9\nYou entered 9...\n\nmain(): testing.  Before we initialze too much, lets see what is going on with our local vars...\nTesting... just for illustration let's print out the address of our local vars:\ntype    varname      value      address                       sizeof\n------  ------- ----------     -----------------         ----------------\nint   numcase =          9   &amp;numcase=   BC7A898     sizeof(  numcase )=4\nint     sizeA =          0     &amp;sizeA=   BC7A894     sizeof(    sizeA )=4\nint*        A =     4012A0         &amp;A=   BC7A888     sizeof(        A )=8\nint     sizeB =         52     &amp;sizeB=   BC7A884     sizeof(    sizeB )=4\nint*        B =     4012E5     &amp;sizeB=   BC7A878     sizeof(        B )=8\nint  sizeDiff =      32766  &amp;sizeDiff=   BC7A874     sizeof( sizeDiff )=4\nint*     Diff =     40051B      &amp;Diff=   BC7A868     sizeof(     Diff )=8\nmain(): numcase should be 9 becuase we chose the 'test' option.\n      : sizeA and sizeB aren't yet initialized.\n      : Also A, B, and Diff don't point to known values (they are\n      : are not valid heap addresses yet because we haven't assigned them).\n      : Just for fun, notice on the far right that our integers are all 4 bytes (32 bit)\n      : while the pointers are all 8 bytes (64 bits).\n\n\nmain():Before symmetricDiff()... (skipping addresses and sizeofs for local vars, no changes there)\ntype    varname      value\n------  ------- ----------\nint   numcase =          9\nint     sizeA =          4\nint*        A =     A25010\nint     sizeB =          3\nint*        B =     A25030\nint  sizeDiff =      32766\nint*     Diff =     40051B\nmain():numcase should still be 9.\n      :sizeA and sizeB should now be 4 and 3 respectively.\n      :A and B should point to something on our heap - thanks, malloc().\n      :sizeDiff and Diff should still be the same (e.g. uninitialized).\n\nsymmetricDiff(): Very beginning.  Before we initialze too much, lets see what is going on with our params and local vars...\ntype    varname      value      address                       sizes\n------  ------- ----------     -----------------         ----------------\nint     sizeA =          4     &amp;sizeA=   BC7A814    sizeof(   sizeA )=4\nint*        A =     A25010         &amp;A=   BC7A818    sizeof(       A )=8\nint     sizeB =          3     &amp;sizeB=   BC7A804    sizeof(   sizeB )=4\nint*        B =     A25030         &amp;B=   BC7A808    sizeof(       B )=8\nint         i =         52         &amp;i=   BC7A83C    sizeof(       i )=4\nint         j = -943289501         &amp;j=   BC7A838    sizeof(       j )=4\nint       cnt =          0       &amp;cnt=   BC7A834    sizeof(     cnt )=4\nint*   newArr =         47    &amp;newArr=   BC7A828    sizeof(  newArr )=8\nint* pNewSize =    BC7A874  &amp;pNewSize=   BC7A7F8    sizeof(pNewSize )=8\nsymmetricDiff(): notice that sizeA, sizeB, A and B have the same values here but different addresses.\n               : IMPORTANT - note that the values of main's A and our A (here in symmetricDiff) are the same,\n               : but the ADDRESSES of main's A and symmetricDiff's A are different.\n               : Also note that the VALUE of symmetricDiff's pNewSize matches the ADDRESS of main's sizeDiff.\n               : Except for cnt, our local vars i, j, and newArr have more or less random values becuase they're\n               : not yet initialized.\n\nsymmetricDiff(): looping, i=0\nint       cnt =          0\nint*   newArr =   10637392\nsymmetricDiff(): i will change.  j should be last value assigned (dont really care about that).\n               : Also no change for sizeA, A, sizeB, B.\n               : cnt may change, if so the value (heap location) of newArray may be changed because of realloc().\n\nsymmetricDiff(): looping, i=1\nint       cnt =          0\nint*   newArr =   10637392\nsymmetricDiff(): i will change.  j should be last value assigned (dont really care about that).\n               : Also no change for sizeA, A, sizeB, B.\n               : cnt may change, if so the value (heap location) of newArray may be changed because of realloc().\n\nsymmetricDiff(): looping, i=2\nint       cnt =          1\nint*   newArr =   10637392\nsymmetricDiff(): i will change.  j should be last value assigned (dont really care about that).\n               : Also no change for sizeA, A, sizeB, B.\n               : cnt may change, if so the value (heap location) of newArray may be changed because of realloc().\n\nsymmetricDiff(): looping, i=3\nint       cnt =          2\nint*   newArr =   10637392\nsymmetricDiff(): i will change.  j should be last value assigned (dont really care about that).\n               : Also no change for sizeA, A, sizeB, B.\n               : cnt may change, if so the value (heap location) of newArray may be changed because of realloc().\n\nThe new array's size is 2\nnewArr[0]=101\nnewArr[1]=102\n\nsymmetricDiff(): Ready to return, will return newArr's value (A25050) to caller.\ntype    varname      value\n------  ------- ----------\nint     sizeA =          4\nint*        A =     A25010\nint     sizeB =          3\nint*        B =     A25030\nint         i =          2\nint         j =          3\nint       cnt =          2\nint*   newArr =     A25050\nint* pNewSize =    BC7A874\nsymmetricDiff(): no changes for values of sizeA, sizeB, A and B.\n               : i and j and cnt did change from beginning.\n               : pNewSize *looks* like id didn't change, it still has the same value.\n               : But what pNewSize *points* to did change.\n               : Now *pNewSize=2 which should be the same as 'cnt'\n\nmain():After symmetricDiff()...\ntype    varname      value\n------  ------- ----------\nint   numcase =          9\nint     sizeA =          4\nint*        A =     A25010\nint     sizeB =          3\nint*        B =     A25030\nint  sizeDiff =          2\nint*     Diff =     A25050\nmain():No change for numcase, sizeA, sizeB, A, and B\n      :sizeDiff and Diff reflect what symmetricDiff() did.\n      :Now that Diff is pointing to the new 'array' in heap storage\n      :Thank you, symmetricDiff, now we can safely print the array.\n------------------\nmain(): The new array's size is 2\n   Diff[0]=101\n   Diff[1]=102\n\n-----\nPick a function to activate\n1 - First paragraph\n2 - Second paragraph\n3 - Third paragraph\n9 - test\n0 - Terminate the application\n0\nYou entered 0...\n$ \n</code></pre>\n\n<h2>MODIFIED CODE</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n/*\n * I added some code to print pointer values and addresses... to make alingment\n * work better I'm using %10d for all memory locations as well as normal integers.\n * In my own code I tend to use %X for memory locations, but it makes it harder to\n * keep things alinged and I felt the visual benefit of slightly easier reading\n * was worth not using hex for addresses.\n */\n\nint *symmetricDiff(int *A, int sizeA\n                 , int *B, int sizeB\n                 , int *pNewSize ) {\n    int i;\n    int j;\n    int cnt = 0;\n    /* int IGNORE_k = 0; */\n    /* I changed 'k' to IGNORE_k because 'cnt' is sufficient. */\n    int *newArr; /* left uninitialized just to show beofre &amp; after values. */\n\n\n    printf(\"\\nsymmetricDiff(): Very beginning.  Before we initialze too much, lets see what is going on with our params and local vars...\\n\");\n    printf(\"type    varname %10s      address%10s             sizes\\n\",     \"value\",    \"\" );\n    printf(\"------  ------- %10s     -------%10s         ----------------\\n\", \"----------\", \"----------\" );\n    printf(\"int     sizeA = %10d     &amp;sizeA=%10X    sizeof(   sizeA )=%d\\n\", sizeA,      &amp;sizeA,     sizeof(sizeA)    );\n    printf(\"int*        A = %10X         &amp;A=%10X    sizeof(       A )=%d\\n\", A,          &amp;A,         sizeof(A)        );\n    printf(\"int     sizeB = %10d     &amp;sizeB=%10X    sizeof(   sizeB )=%d\\n\", sizeB,      &amp;sizeB,     sizeof(sizeB)    );\n    printf(\"int*        B = %10X         &amp;B=%10X    sizeof(       B )=%d\\n\", B,          &amp;B,         sizeof(B)        );\n    printf(\"int         i = %10d         &amp;i=%10X    sizeof(       i )=%d\\n\", i,          &amp;i,         sizeof(i)        );\n    printf(\"int         j = %10d         &amp;j=%10X    sizeof(       j )=%d\\n\", j,          &amp;j,         sizeof(j)        );\n    printf(\"int       cnt = %10d       &amp;cnt=%10X    sizeof(     cnt )=%d\\n\", cnt,        &amp;cnt,       sizeof(cnt)      );\n    printf(\"int*   newArr = %10X    &amp;newArr=%10X    sizeof(  newArr )=%d\\n\", newArr,     &amp;newArr,    sizeof(newArr)   );\n    printf(\"int* pNewSize = %10X  &amp;pNewSize=%10X    sizeof(pNewSize )=%d\\n\", pNewSize,   &amp;pNewSize,  sizeof(pNewSize) );\n    printf(\"symmetricDiff(): notice that sizeA, sizeB, A and B have the same values here but different addresses.\\n\");\n    printf(\"               : IMPORTANT - note that the values of main's A and our A (here in symmetricDiff) are the same,\\n\");\n    printf(\"               : but the ADDRESSES of main's A and symmetricDiff's A are different.\\n\");\n    printf(\"               : Also note that the VALUE of symmetricDiff's pNewSize matches the ADDRESS of main's sizeDiff.\\n\");\n    printf(\"               : Except for cnt, our local vars i, j, and newArr have more or less random values becuase they're\\n\");\n    printf(\"               : not yet initialized.\\n\");\n\n    newArr = (int*)malloc(sizeof(int));\n\n    for (i = 0; i &lt; sizeA; i++) {\n        printf(\"\\nsymmetricDiff(): looping, i=%d\\n\", i);\n        printf(\"int       cnt = %10d\\n\", cnt    );\n        printf(\"int*   newArr = %10d\\n\", newArr );\n        printf(\"symmetricDiff(): i will change.  j should be last value assigned (dont really care about that).\\n\");\n        printf(\"               : Also no change for sizeA, A, sizeB, B.\\n\");\n        printf(\"               : cnt may change, if so the value (heap location) of newArray may be changed because of realloc().\\n\");\n        for (j = 0; j &lt; sizeB; j++) {\n            if( A[i] == B[j] ) {\n                newArr[cnt] = A[i];\n                cnt++;\n                /* Let's wait to tell our caller about what happened until just before we return.\n                 * We can just use local var 'cnt' for now...\n                 *   (*pNewSize)++;\n                 *   newArr = (int*)realloc(newArr, (*pNewSize + 1) * sizeof(int));\n                 * After all we did increment 'cnt' just above here.\n                 */\n                newArr = (int*)realloc(newArr, cnt * sizeof(int));\n                if (newArr == NULL) {\n                    printf(\"Failed to allocate memory\");\n                    /* return 0; /* using NULL instead of 0 probalby better style here. */\n                    return NULL;\n                }\n            }\n        }\n    }\n    /* print out what we found. */\n    /* We'll use 'cnt' here... caller can use whatever pNewSize points to.\n     * OLD:   printf(\"The new array's size is %d\\n\", *pNewSize);\n     * OLD:   for (i = 0; i &lt; pNewSize; i++) {\n     * OLD:       printf(\"The new array is %d\\n\", *(newArr + i));\n     * OLD:   }\n     */\n    printf(\"\\nThe new array's size is %d\\n\", cnt );\n    for (i = 0; i &lt; cnt; i++) {\n        printf(\"newArr[%d]=%d\\n\", i, newArr[i] );\n        /* Or if you prefer:\n         *    printf(\"newArr[%d]=%d\\n\", i, *(newArr+i) );\n         *  newArr[i] is just a short hand expression for *(newArr+i)\n         */\n    }\n\n    /* Now that we are done with all the work let's tell our caller what we found.  */\n    *pNewSize = cnt;\n    /* DANGER: this way we were returning the ADDRESS of our local pointer \"newArr\".\n     *    return &amp;newArr;\n     * The address you want to return is whatever was last allocated (malloc or realloc)\n     * on the heap, which is the value of newArr.\n     */\n    printf(\"\\nsymmetricDiff(): Ready to return, will return newArr's value (%X) to caller.\\n\", newArr);\n    printf(\"type    varname %10s\\n\", \"value\" );\n    printf(\"------  ------- %10s\\n\", \"----------\" );\n    printf(\"int     sizeA = %10d\\n\", sizeA       );\n    printf(\"int*        A = %10X\\n\", A           );\n    printf(\"int     sizeB = %10d\\n\", sizeB       );\n    printf(\"int*        B = %10X\\n\", B           );\n    printf(\"int         i = %10d\\n\", i           );\n    printf(\"int         j = %10d\\n\", j           );\n    printf(\"int       cnt = %10d\\n\", cnt         );\n    printf(\"int*   newArr = %10X\\n\", newArr      );\n    printf(\"int* pNewSize = %10X\\n\", pNewSize    );\n    printf(\"symmetricDiff(): no changes for values of sizeA, sizeB, A and B.\\n\");\n    printf(\"               : i and j and cnt did change from beginning.\\n\");\n    printf(\"               : pNewSize *looks* like id didn't change, it still has the same value.\\n\");\n    printf(\"               : But what pNewSize *points* to did change.\\n\");\n    printf(\"               : Now *pNewSize=%d which should be the same as 'cnt'\\n\", *pNewSize );\n    return newArr;\n    /* To elaborate, the original code was returning the ADDRESS of local variable 'newArr'\n     * which is a problem because that address is going to evaporate the instant we\n     * return from the function (e.g. stack storage goes away; strictly speaking it won't evaporate\n     * but it will be IMMEDIATELY recycled and have a other values stored in it, and those other values\n     * are almost never going to have anything to do wiht what 'newArr' was pointing to on the heap.\n     */\n}\n\nint main() {\n    int numcase;\n    int sizeA;\n    int *A;\n    int sizeB;\n    int *B;\n    /* int *IGNORE_pNewSize = 0;  newSize should be an actual integer,  not a pointer to an integer */\n    int sizeDiff; /* name change to match sizeA convention.  we wil pass the address of this int to symmetricDiff. */\n    int *Diff;\n    int i;\n    while (1) {\n        printf(\"\\n-----\\nPick a function to activate\\n\");\n        printf(\"1 - First paragraph\\n\");\n        printf(\"2 - Second paragraph\\n\");\n        printf(\"3 - Third paragraph\\n\");\n        printf(\"9 - test\\n\"); /* NEW: added to simplify testing. */\n        printf(\"0 - Terminate the application\\n\");\n        scanf(\"%d\", &amp;numcase);\n        printf(\"You entered %d...\\n\", numcase );\n        switch (numcase) {\n        case 0:\n            return 0;\n            printf(\"\\n\\n\");\n            break;\n\n        case 1:\n            printf(\"Enter a size for the first array\\n\");\n            scanf(\"%d\", &amp;sizeA);\n            A = (int*)malloc(sizeA * sizeof(int));\n            if (A == NULL) {\n                printf(\"Failed to allocate memory\");\n                return;\n            }\n            for (i = 0; i &lt; sizeA; i++) {\n                printf(\"Enter a number for the first array\\n\");\n                scanf(\"%d\", &amp;A[i]);\n            }\n            printf(\"Enter a size for the second array\\n\");\n            scanf(\"%d\", &amp;sizeB);\n            B = (int*)malloc(sizeB * sizeof(int));\n            if (B == NULL) {\n                printf(\"Failed to allocate memory\");\n                return;\n            }\n            for (i = 0; i &lt; sizeB; i++) {\n                printf(\"Enter a number for the second array\\n\");\n                scanf(\"%d\", &amp;B[i]);\n            }\n            printf(\"check\\n\");\n        /* fix me:    symmetricDiff(A, sizeA, B, sizeB, &amp;pNewSize); */\n        /*  for (i = 0; i &lt; pNewSize; i++);\n            printf(\"The new array is %d\\n\", **(symmetricDiff));*/\n            printf(\"spcheck\\n\");\n            printf(\"\\n\\n\");\n            free(A);\n            free(B);\n            break;\n\n        case 9: /* NEW: added to simplify testing. */\n           printf(\"\\nmain(): testing.  Before we initialze too much, lets see what is going on with our local vars...\\n\");\n           printf(\"Testing... just for illustration let's print out the address of our local vars:\\n\");\n           printf(\"type    varname %10s      address%10s             sizeof\\n\",     \"value\",    \"\" );\n           printf(\"------  ------- %10s     -------%10s         ----------------\\n\", \"----------\", \"----------\" );\n           printf(\"int   numcase = %10d   &amp;numcase=%10X     sizeof(  numcase )=%d\\n\", numcase,    &amp;numcase,   sizeof(numcase)  );\n           printf(\"int     sizeA = %10d     &amp;sizeA=%10X     sizeof(    sizeA )=%d\\n\", sizeA,      &amp;sizeA,     sizeof(sizeA)    );\n           printf(\"int*        A = %10X         &amp;A=%10X     sizeof(        A )=%d\\n\", A,          &amp;A,         sizeof(A)        );\n           printf(\"int     sizeB = %10d     &amp;sizeB=%10X     sizeof(    sizeB )=%d\\n\", sizeB,      &amp;sizeB,     sizeof(sizeB)    );\n           printf(\"int*        B = %10X     &amp;sizeB=%10X     sizeof(        B )=%d\\n\", B,          &amp;B,         sizeof(B)        );\n           printf(\"int  sizeDiff = %10d  &amp;sizeDiff=%10X     sizeof( sizeDiff )=%d\\n\", sizeDiff,   &amp;sizeDiff,  sizeof(sizeDiff) );\n           printf(\"int*     Diff = %10X      &amp;Diff=%10X     sizeof(     Diff )=%d\\n\", Diff,       &amp;Diff,      sizeof(Diff)     );\n           printf(\"main(): numcase should be 9 becuase we chose the 'test' option.\\n\");\n           printf(\"      : sizeA and sizeB aren't yet initialized.\\n\");\n           printf(\"      : Also A, B, and Diff don't point to known values (they are\\n\");\n           printf(\"      : are not valid heap addresses yet because we haven't assigned them).\\n\");\n           printf(\"      : Just for fun, notice on the far right that our integers are all 4 bytes (32 bit)\\n\");\n           printf(\"      : while the pointers are all 8 bytes (64 bits).\\n\");\n           printf(\"\\n\");\n\n           sizeA = 4; A = (int*)malloc(sizeA * sizeof(int));\n\n           sizeB = 3; B = (int*)malloc(sizeB * sizeof(int));\n           if (A == NULL || B == NULL) {\n               printf(\"Failed to allocate memory\");\n               return;\n           }\n           A[0] = 100; A[1] = 101; A[2] = 102; A[3] = 103;\n           B[0] = 101; B[1] = 102; B[2] = 400;\n\n           printf(\"\\nmain():Before symmetricDiff()... (skipping addresses and sizeofs for local vars, no changes there)\\n\");\n           printf(\"type    varname %10s\\n\", \"value\" );\n           printf(\"------  ------- %10s\\n\", \"----------\" );\n           printf(\"int   numcase = %10d\\n\", numcase  );\n           printf(\"int     sizeA = %10d\\n\", sizeA    );\n           printf(\"int*        A = %10X\\n\", A        );\n           printf(\"int     sizeB = %10d\\n\", sizeB    );\n           printf(\"int*        B = %10X\\n\", B        );\n           printf(\"int  sizeDiff = %10d\\n\", sizeDiff );\n           printf(\"int*     Diff = %10X\\n\", Diff     );\n           printf(\"main():numcase should still be 9.\\n\");\n           printf(\"      :sizeA and sizeB should now be 4 and 3 respectively.\\n\");\n           printf(\"      :A and B should point to something on our heap - thanks, malloc().\\n\");\n           printf(\"      :sizeDiff and Diff should still be the same (e.g. uninitialized).\\n\");\n\n           Diff = symmetricDiff(\n               A, sizeA,\n               B, sizeB,\n               &amp;sizeDiff );\n           printf(\"\\nmain():After symmetricDiff()...\\n\");\n           printf(\"type    varname %10s\\n\", \"value\" );\n           printf(\"------  ------- %10s\\n\", \"----------\" );\n           printf(\"int   numcase = %10d\\n\", numcase  );\n           printf(\"int     sizeA = %10d\\n\", sizeA    );\n           printf(\"int*        A = %10X\\n\", A        );\n           printf(\"int     sizeB = %10d\\n\", sizeB    );\n           printf(\"int*        B = %10X\\n\", B        );\n           printf(\"int  sizeDiff = %10d\\n\", sizeDiff );\n           printf(\"int*     Diff = %10X\\n\", Diff     );\n           printf(\"main():No change for numcase, sizeA, sizeB, A, and B\\n\");\n           printf(\"      :sizeDiff and Diff reflect what symmetricDiff() did.\\n\");\n           printf(\"      :Now that Diff is pointing to the new 'array' in heap storage\\n\");\n           printf(\"      :Thank you, symmetricDiff, now we can safely print the array.\");\n           printf(\"\\n------------------\\n\");\n           printf(\"main(): The new array's size is %d\\n\", sizeDiff);\n           for (i = 0; i &lt; sizeDiff; i++) {\n               printf(\"   Diff[%d]=%d\\n\", i, Diff[i] );\n           }\n           break;\n        default:\n            printf(\"Incorrent input\\n\");\n            printf(\"\\n\\n\");\n            break;\n        }\n        /* WARNING: if you're going to run this in a loop you should\n         * probably free the heap storage owned by A, B, and Diff.\n         * Otherwise the next time through the loop will leak memory.\n         * Before doing that, go ahead and run '9' a few times and\n         * see if the memory locations stay the same for A, B, and Diff.\n         *    free( A );\n         *    free( B );\n         *    free( Diff );\n         */\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 34780783, "answer_count": 3, "score": 2, "last_activity_date": 1452753803, "creation_date": 1452723246, "last_edit_date": 1452723747, "question_id": 34778106, "link": "https://stackoverflow.com/questions/34778106/fails-to-print-pointer-arrays-in-c", "title": "Fails to print pointer arrays in C", "body": "<p>So the code Im writing (for college) is supposed to do the following -\nscan two pointer dynamic sized arrays and their sizes from a user and then send them to a function (arrays as pointers, sizes as integers) along with another pointer to an integer that will be used to determine the new array's size.\nThe function scans for numbers that are in array A but arent in array B and places such numbers in a new array, which is also dynamic and it's size is determined by the pointer ive mentioned.\nThe function then returns the new array's address.</p>\n\n<p>Now as far as im concerned, Ive done everything right up to the point where im trying to either print the new array inside the fuction or after I return it's address.\nIn the first case it seems to print all sorts of crap until the program crashes, and in the second case it prints some random number (which may be an address?).</p>\n\n<p>I hope I described it as clearly as possible (considering that wall of text), im not a native speaker and havent used english in regard to programming.</p>\n\n<p>Help would be highly appreciated!</p>\n\n<p>The code -</p>\n\n<pre><code>int *symmetricDiff(int *A, int sizeA, int *B, int sizeB, int *pNewSize) {\n    int i, j, k = 0, cnt = 0;\n    int *newArr = (int*)malloc(sizeof(int));\n    for (i = 0; i &lt; sizeA; i++) {\n        for (j = 0; j &lt; sizeB; j++) {\n            if (A[i] == B[j]) {\n                cnt++;\n            }\n        }\n        if (cnt == 0) {\n            (*pNewSize)++;\n            newArr = (int*)realloc(newArr, (*pNewSize + 1) * sizeof(int));\n            if (newArr == NULL) {\n                printf(\"Failed to allocate memory\");\n                return 0;\n            }\n            *(newArr+k) = *(A+i);\n            k++;\n        }\n    }\n    printf(\"The new array's size is %d\\n\", *pNewSize);\n    for (i = 0; i &lt; pNewSize; i++) {\n        printf(\"The new array is %d\\n\", *(newArr + i));\n    }\n    return &amp;newArr;\n}\n\nint main() {\n    int numcase, sizeA, sizeB, *pNewSize = 0, i, *A, *B;\n    while (1) {\n        printf(\"Pick a function to activate\\n 1 - First paragraph\\n 2 - Second paragraph\\n 3 - Third paragraph\\n 0 - Terminate the application\\n\\n\");\n        scanf(\"%d\", &amp;numcase);\n        switch (numcase) {\n        case 0:\n            return 0;\n            printf(\"\\n\\n\");\n            break;\n\n        case 1:\n            printf(\"Enter a size for the first array\\n\");\n            scanf(\"%d\", &amp;sizeA);\n            A = (int*)malloc(sizeA * sizeof(int));\n            if (A == NULL) {\n                printf(\"Failed to allocate memory\");\n                return;\n            }\n            for (i = 0; i &lt; sizeA; i++) {\n                printf(\"Enter a number for the first array\\n\");\n                scanf(\"%d\", &amp;A[i]);\n            }\n            printf(\"Enter a size for the second array\\n\");\n            scanf(\"%d\", &amp;sizeB);\n            B = (int*)malloc(sizeB * sizeof(int));\n            if (B == NULL) {\n                printf(\"Failed to allocate memory\");\n                return;\n            }\n            for (i = 0; i &lt; sizeB; i++) {\n                printf(\"Enter a number for the second array\\n\");\n                scanf(\"%d\", &amp;B[i]);\n            }\n            printf(\"check\\n\");\n            symmetricDiff(A, sizeA, B, sizeB, &amp;pNewSize);\n        /*  for (i = 0; i &lt; pNewSize; i++);\n            printf(\"The new array is %d\\n\", **(symmetricDiff));*/\n            printf(\"spcheck\\n\");\n            printf(\"\\n\\n\");\n            free(A);\n            free(B);\n            break;\n\n        default:\n            printf(\"Incorrent input\\n\");\n            printf(\"\\n\\n\");\n            break;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "g++"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1452722428, "post_id": 34777776, "comment_id": 57300779, "body": "Depends on optimisation? After a <code>return</code>, more code is pointless."}], "answers": [{"comments": [{"owner": {"reputation": 853, "user_id": 1464937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/YjsfO.png?s=128&g=1", "display_name": "musasabi", "link": "https://stackoverflow.com/users/1464937/musasabi"}, "edited": false, "score": 0, "creation_date": 1452722553, "post_id": 34777925, "comment_id": 57300830, "body": "To both @Jarod42 and Weather Vane: So I guess the real question is which optimization level removes it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 853, "user_id": 1464937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/YjsfO.png?s=128&g=1", "display_name": "musasabi", "link": "https://stackoverflow.com/users/1464937/musasabi"}, "edited": false, "score": 1, "creation_date": 1452723097, "post_id": 34777925, "comment_id": 57301101, "body": "@musasabi wouldn&#39;t <i>any</i> level of optimisation remove unreachable code? It&#39;s a no-brainer decision by the compiler."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1452722489, "creation_date": 1452722489, "answer_id": 34777925, "question_id": 34777776, "link": "https://stackoverflow.com/questions/34777776/does-gcc-exclude-code-after-a-return-ifdef/34777925#34777925", "title": "Does GCC exclude code after a return #ifdef", "body": "<p>Code should be compilable, and any decent compiler optimization may remove it as unreachable code.</p>\n"}, {"tags": [], "owner": {"reputation": 2363, "user_id": 4588453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/51da95e02741a304f3620d3b9697eda9?s=128&d=identicon&r=PG&f=1", "display_name": "pseyfert", "link": "https://stackoverflow.com/users/4588453/pseyfert"}, "is_accepted": true, "score": 1, "last_activity_date": 1452787427, "last_edit_date": 1452787427, "creation_date": 1452725347, "answer_id": 34778559, "question_id": 34777776, "link": "https://stackoverflow.com/questions/34777776/does-gcc-exclude-code-after-a-return-ifdef/34778559#34778559", "title": "Does GCC exclude code after a return #ifdef", "body": "<p>Just compiled this with gcc 4.9 <code>cc     test.c   -o test</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define CONDITION\n\nint test() {\n  const char* hello = \"hello world\";\n  printf(\"%s\\n\",hello);\n  return 2;\n}\n\nint main()\n{\n#ifdef CONDITION\n  const char* a_test = \"hello me\";\n  printf(\"%s\\n\",a_test);\n  return 0;\n#endif\n\n  volatile const char* hello = \"hello musasabi\";\n  printf(\"%s\\n\",hello);\n\n  return test();\n}\n</code></pre>\n\n<p>and then tested the content of the resulting binary with <code>strings test | grep hello</code>\n\"hello me\" and \"hello world\" appear, but the string \"hello musasabi\" is not in <code>test</code>.</p>\n"}], "owner": {"reputation": 853, "user_id": 1464937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/YjsfO.png?s=128&g=1", "display_name": "musasabi", "link": "https://stackoverflow.com/users/1464937/musasabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 34778559, "answer_count": 2, "score": -2, "last_activity_date": 1452787427, "creation_date": 1452721928, "question_id": 34777776, "link": "https://stackoverflow.com/questions/34777776/does-gcc-exclude-code-after-a-return-ifdef", "title": "Does GCC exclude code after a return #ifdef", "body": "<p>Say, for example, you've got the following code</p>\n\n<pre><code>#define CONDITION\n\nint conditional function();\n//...\n\nint foo()\n{\n#ifdef CONDITION\n  return conditional_function();\n#endif\n\nint value = 0;\n//...many more lines\n\nreturn value;\n}\n</code></pre>\n\n<p>Would GCC not generate code for the lines following the <code>return</code>'d <code>#ifdef</code>? or would an <code>#else</code> be required for that code to be excluded?</p>\n"}, {"tags": ["c", "inheritance", "struct"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1452721426, "post_id": 34777451, "comment_id": 57300284, "body": "Do any of these help? <a href=\"https://stackoverflow.com/questions/524033/how-can-i-simulate-oo-style-polymorphism-in-c\">How can I simulate OO-style polymorphism in C?</a>, <a href=\"https://stackoverflow.com/questions/415452/object-orientation-in-c\">Object-orientation in C</a>, <a href=\"https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c\">Can you write object-oriented code in C?</a>"}, {"owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "edited": false, "score": 0, "creation_date": 1452721556, "post_id": 34777451, "comment_id": 57300340, "body": "Why not use two <code>typedef</code>s?"}, {"owner": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "edited": false, "score": 0, "creation_date": 1452721648, "post_id": 34777451, "comment_id": 57300386, "body": "My C is a little rusty, been working with Java a lot, with the exception of working with a lot of structs of the same type and math functions.  Other than that, my experience with C is only based on my previous experience with C++ 3 years ago.  Basically, some of these things being described are unfamilliar to me.  I know typedef is used in C++ as well, but I don&#39;t remember using it often if at all."}, {"owner": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1452721844, "post_id": 34777451, "comment_id": 57300469, "body": "@kaylum they help a little, but I&#39;m being a bit more specific here in what I am asking.  The answers do help though."}, {"owner": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "edited": false, "score": 0, "creation_date": 1452721927, "post_id": 34777451, "comment_id": 57300505, "body": "I&#39;m really liking both answers so far.  They both answer my question and with different methods.  How do I choose one as the best answer if I like them both?  One answers the question perfectly, the other is a good alternative to what I am trying to do."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452722025, "post_id": 34777451, "comment_id": 57300558, "body": "If you were using a <i>single</i> <code>float</code> would you have this naming problem, and want to <code>typedef</code> other flavours of <code>float</code>? I can&#39;t see the problem: make your code clear from the variable <b>names</b> you choose (as ever)."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1452722104, "post_id": 34777451, "comment_id": 57300597, "body": "Just upvote both of them and then accept the one that applies best to you or that you found most useful. I don&#39;t think there is a way to accept more than one answer."}, {"owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452722749, "post_id": 34777451, "comment_id": 57300928, "body": "@WeatherVane <code>typedef</code>s exist for the reason of additional clarity; I have definitely seen <code>typedef</code>s used for a variable type like <code>float</code> before, and would argue that it (along with good variable names, first and foremost, of course), increase readability substantially. Most of the time."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "edited": false, "score": 0, "creation_date": 1452722942, "post_id": 34777451, "comment_id": 57301026, "body": "@dwanderson yes I have seen <code>float</code> typedeffed not to distinguish it from other <code>float</code> types, but to make the implementation of that particular item flexible, say if should you want later to use <code>double</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "edited": false, "score": 0, "creation_date": 1452721534, "post_id": 34777585, "comment_id": 57300329, "body": "Is that basically saying you have a struct that inherits from the main struct that, in addition to having x, y, and z, it has another variable called x1?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "edited": false, "score": 1, "creation_date": 1452722053, "post_id": 34777585, "comment_id": 57300573, "body": "You have a main struct containing the common fields as well as a union of the derived structs.  <code>x1</code> is a member of one of the derived structs."}, {"owner": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "edited": false, "score": 0, "creation_date": 1452722133, "post_id": 34777585, "comment_id": 57300616, "body": "So its more like merging two different structs than one inheriting the other?  But has the same effect?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "edited": false, "score": 0, "creation_date": 1452722551, "post_id": 34777585, "comment_id": 57300828, "body": "@cluemein Basically, yes."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1452721798, "last_edit_date": 1452721798, "creation_date": 1452721276, "answer_id": 34777585, "question_id": 34777451, "link": "https://stackoverflow.com/questions/34777451/is-it-possible-to-do-inheritance-from-an-abstract-base-struct-or-simulate-someth/34777585#34777585", "title": "Is it possible to do inheritance from an abstract/base struct or simulate something along those lines in C?", "body": "<p>You can use a <code>union</code> for this.  Your main <code>struct</code> would contain a <code>union</code> of the \"derived\" structs as well as a \"flag\" field telling you which member of the union is valid:</p>\n\n<pre><code>enum { DERIVED11, DERIVED2, DERIVED3 };\n\nstruct derived1 { int x1; };\nstruct derived2 { char x2; };\nstruct derived3 { float x3; };\n\nstruct ThreeDCartesianData\n{\n   float x;\n   float y;\n   float z;\n   int derivedType;\n   union {\n     struct derived1 d1;\n     struct derived2 d2;\n     struct derived3 d3;\n   } derived;\n};\n</code></pre>\n\n<p>Then you can use them like this:</p>\n\n<pre><code>struct ThreeDCartesianData data1;\ndata1.x=0;\ndata1.y=0;\ndata1.z=0;\ndata1.derivedType = DERIVED1;\ndata1.derived.d1.x1 = 4;\n</code></pre>\n\n<p>You could alternately define them like this:</p>\n\n<pre><code>struct common\n{\n   int type;\n   float x;\n   float y;\n   float z;\n};\nstruct derived1\n{\n   int type;\n   float x;\n   float y;\n   float z;\n   int x1;\n};\nstruct derived2\n{\n   int type;\n   float x;\n   float y;\n   float z;\n   char x2;\n};\nstruct derived3\n{\n   int type;\n   float x;\n   float y;\n   float z;\n   float x3;\n};\n\nunion ThreeDCartesianData {\n     struct common c;\n     struct derived1 d1;\n     struct derived2 d2;\n     struct derived3 d3;\n};    \n</code></pre>\n\n<p>And use them like this:</p>\n\n<pre><code>union ThreeDCartesianData data1;\ndata1.c.type=DERIVED1;\ndata1.d1.x=0;\ndata1.d1.y=0;\ndata1.d1.z=0;\ndata1.d1.x1 = 4;\n</code></pre>\n\n<p>If all the structs in a union have an initial list elements of the same type in the same order, the standard allows you to access those fields from any of the sub-structs safely.</p>\n"}, {"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1452721870, "post_id": 34777690, "comment_id": 57300480, "body": "It&#39;s not obvious how this answers this part of the question from the OP: &quot;A more specific struct would inherit from that and perhaps define extra variables, or use different names for the variables.&quot;"}, {"owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1452721951, "post_id": 34777690, "comment_id": 57300518, "body": "Ah, yeah, fair point. I&#39;ll work on that and edit; my offhand thought is &quot;don&#39;t think you can do that&quot; but I&#39;d rather double-check before posting a negative assertion, and if someone beats me to the solution, then at least I didn&#39;t post mistakes."}, {"owner": {"reputation": 918, "user_id": 2133905, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y4wcC.jpg?s=128&g=1", "display_name": "SGM1", "link": "https://stackoverflow.com/users/2133905/sgm1"}, "edited": false, "score": 0, "creation_date": 1452722011, "post_id": 34777690, "comment_id": 57300555, "body": "The real issue the OP was facing seems to be clarity of code without boilerplate, at least that is how I interpreted."}, {"owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "edited": false, "score": 1, "creation_date": 1452722133, "post_id": 34777690, "comment_id": 57300615, "body": "Right, so I figure <code>typedef</code>s solve most of that. Different variable names is just starting to sound like two different <code>struct</code>s that happen to have the same types - define them separately to keep it clear,; and more variables is sounding like <code>struct</code>s containing other <code>struct</code>s."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1452726906, "post_id": 34777690, "comment_id": 57302710, "body": "Not to be a nit, but in your first code block, the <code>typedef</code>s appear to be reversed [due to a typo].  Don&#39;t you want (e.g.) <code>typedef general3d position</code> instead of <code>typedef position general3d</code>?  And, shouldn&#39;t the top line of that block be preceeded by <code>typedef</code> (e.g. <code>typedef struct general3d ...</code>)?"}, {"owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1452784375, "post_id": 34777690, "comment_id": 57329408, "body": "@CraigEstey probably definitely correct - I was just writing off the top of my head, and didn&#39;t have an IDE/compiler handy. And don&#39;t worry about nit-picking - compilers are pretty nit-picky themselves and having incorrect info on SO doesn&#39;t help anyway. Thanks!"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1452811124, "post_id": 34777690, "comment_id": 57345460, "body": "It was obvious from your post/answer that you knew what you were doing. I only mentioned the typo in the interests of posterity.  A few weeks back, I noticed an answer that got a code example typo fixed by its author and the post was three years old ..."}], "tags": [], "owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "is_accepted": false, "score": 3, "last_activity_date": 1452784413, "last_edit_date": 1452784413, "creation_date": 1452721646, "answer_id": 34777690, "question_id": 34777451, "link": "https://stackoverflow.com/questions/34777451/is-it-possible-to-do-inheritance-from-an-abstract-base-struct-or-simulate-someth/34777690#34777690", "title": "Is it possible to do inheritance from an abstract/base struct or simulate something along those lines in C?", "body": "<p>What about using <code>typedef</code>s?</p>\n\n<pre><code>typedef struct general3d {\n    float x;\n    float y;\n    float z;\n} general3d_t;\n\ntypedef general3d position;\ntypedef general3d velocity;\n</code></pre>\n\n<p>This way, when you come across something that's a <code>velocity</code> type, you encode that into the variable type, but under the hood, it's still just 3 points, <code>x</code>, <code>y</code>, <code>z</code>. Then, readers of the code will know you're talking about a <code>velocity</code> and not a <code>position</code>. If you want to get really crazy with it, you hide <code>general3d</code> away in some implementation file, so a user can never instantiate a <code>general3d</code> on their own, since they should be using either <code>position</code> or <code>velocity</code> as the situation requires; this may or may not be reasonable for your task at hand/worth the extra effort.</p>\n\n<p>EDIT: I'm not positive about variable-renaming or about adding more variables directly to the same struct, but I would start to head in the direction of a different design at that point.</p>\n\n<p>On the one hand, if you have two <code>struct</code>s that have the same underlying types but require different names, you probably just have two separate <code>struct</code>s. For example:</p>\n\n<pre><code>struct point3d {\n    float x;\n    float y;\n    float z;\n};\n\nstruct person {\n    float age;\n    float weight;\n    float salary;\n};\n</code></pre>\n\n<p>Yes, those are both 3 floats, but their understanding is very different, and they should be able to vary on their own if one or the other changes. Perhaps I want to add a <code>name</code> field to the <code>person</code>, but there's no reasonable analogue for a <code>char *</code> on <code>point3d</code>. Just define them separately if they mean different things.</p>\n\n<p>As for adding more variables, that sounds like <code>struct</code>s that contain other <code>struct</code>s:</p>\n\n<pre><code>struct point3d {\n    float x;\n    float y;\n    float z;\n};\n\nstruct person {\n    point3d position;\n    float age;\n    float weight;\n    float salary;\n};\n\n// access like:\nperson.position.x;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 1, "last_activity_date": 1452745884, "creation_date": 1452745884, "answer_id": 34781775, "question_id": 34777451, "link": "https://stackoverflow.com/questions/34777451/is-it-possible-to-do-inheritance-from-an-abstract-base-struct-or-simulate-someth/34781775#34781775", "title": "Is it possible to do inheritance from an abstract/base struct or simulate something along those lines in C?", "body": "<p>I've done this sort of thing before.  I embed a copy of the base type at the front of the derived type struct. This more closely mimics what <code>c++</code> might do. Here are two methods I've used.</p>\n\n<hr>\n\n<p>Using simple type:</p>\n\n<pre><code>#define XYZDEF \\\n    int type; \\\n    float x; \\\n    float y; \\\n    float z\n\n// base type\nstruct xyzdata {\n    XYZDEF;\n};\n\n// derived type 1\nstruct vector {\n    XYZDEF;\n    int vector_info;\n    ...\n};\n\n// derived type 2\nstruct position {\n    XYZDEF;\n    int position_info;\n    ...\n};\n\n#define BASEOF(_ptr) \\\n    ((struct xyzdata *) (_ptr))\n\n// vector_rotate -- rotate a vector\nvoid\nvector_rotate(vector *ptr)\n{\n}\n\n// position_rotate -- rotate a position\nvoid\nposition_rotate(position *ptr)\n{\n}\n\n// xyzrotate -- rotate\nvoid\nxyzrotate(xyzdata *ptr)\n{\n\n    switch (ptr-&gt;type) {\n    case TYPE_POSITION:\n        vector_rotate((vector *) ptr);\n        break;\n    case TYPE_VECTOR:\n        position_rotate((position *) ptr);\n        break;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Using a virtual function table pointer:</p>\n\n<pre><code>#define XYZDEF \\\n    int type; \\\n    vtbl *vtbl; \\\n    float x; \\\n    float y; \\\n    float z\n\n// forward definitions\nstruct xyzdata;\nstruct vector;\nstruct position;\n\n// virtual function table\nstruct vtbl {\n    void (*rotate)(struct xyzdata *);\n};\n\n// base type\nstruct xyzdata {\n    XYZDEF;\n};\n\n// derived type 1\nstruct vector {\n    XYZDEF;\n    int vector_info;\n    ...\n};\n\n// derived type 2\nstruct position {\n    XYZDEF;\n    int position_info;\n    ...\n};\n\n#define BASEOF(_ptr) \\\n    ((struct xyzdata *) (_ptr))\n\n// vector_rotate -- rotate a vector\nvoid\nvector_rotate(struct xyzdata *ptr)\n{\n    struct vector *vec = (void *) ptr;\n    ...\n}\n\n// position_rotate -- rotate a position\nvoid\nposition_rotate(struct xyzdata *ptr)\n{\n    struct position *pos = (void *) ptr;\n    ...\n}\n\n// xyzrotate -- rotate\nvoid\nxyzrotate(xyzdata *ptr)\n{\n\n    ptr-&gt;vtbl-&gt;rotate(ptr);\n}\n</code></pre>\n"}], "owner": {"reputation": 880, "user_id": 2901466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/638f735abf47b48fa3cd7b43c1d72341?s=128&d=identicon&r=PG&f=1", "display_name": "cluemein", "link": "https://stackoverflow.com/users/2901466/cluemein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 34777585, "answer_count": 3, "score": 4, "last_activity_date": 1452784413, "creation_date": 1452720782, "question_id": 34777451, "link": "https://stackoverflow.com/questions/34777451/is-it-possible-to-do-inheritance-from-an-abstract-base-struct-or-simulate-someth", "title": "Is it possible to do inheritance from an abstract/base struct or simulate something along those lines in C?", "body": "<p>I am currently working with a C program that uses structs composed of xyz coordinates, but sometimes these coordinate may refer to vectors (Force/velocity type, not the data structure) while at other times it may be referring to position.  I know its possible to simply use one struct for all of these different conditions since they all use mostly the same data type (float), but to simply keep my math better organized (plus variable and struct names) and keep things from getting mixed up, is there a way to define a base struct that defines itself as having three floats, be inherited by another struct that more specifically defines what the struct is supposed to be (such as position instead of velocity, etc. etc.)?  I know C is not OOP, but it seems like it could be possible to do this Here is what the base struct would be like:</p>\n\n<pre><code>struct ThreeDCartesianData\n{\n   float x;\n   float y;\n   float z;\n};\n</code></pre>\n\n<p>A more specific struct would inherit from that and perhaps define extra variables, or use different names for the variables.  There will be multiple position structs being used, but I think only one velocity struct for each set of data.  I have seen similar questions to this, but they all seem to be referring to a higher level language (C++, C#, etc. etc.)</p>\n"}, {"tags": ["c", "graphics", "gtk", "drawing", "cairo"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1452720237, "post_id": 34777181, "comment_id": 57299713, "body": "cairo is not an animation framework; to &quot;animate&quot; things you need to queue a redraw of your drawing area at given time intervals and draw everything in the rect that changed over again. Also elements that you draw on cairo aren&#39;t &quot;objects&quot; per se; once you commit something (with <code>cairo_stroke()</code> and friends) it&#39;s on the canvas and can&#39;t be changed anymore."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1452720799, "post_id": 34777181, "comment_id": 57299975, "body": "&quot;In other frameworks I would increment the x value and change the speed with an appropriate clock() function to control FPS&#39;s, then I would paint the drawing area background and draw the object with new coordinates.&quot; - okay, what happens if you do that with Cairo?"}, {"owner": {"reputation": 77, "user_id": 5778697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b7db94d3bc25846096a2877a0645798?s=128&d=identicon&r=PG&f=1", "display_name": "tvaz", "link": "https://stackoverflow.com/users/5778697/tvaz"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452721787, "post_id": 34777181, "comment_id": 57300443, "body": "@immibis, I don&#39;t know how to do that in Cairo. I see no documentation to control programs clock, or where to put incremental functions within the loop, etc. I just don&#39;t find anything related to that topic."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452723112, "post_id": 34777181, "comment_id": 57301108, "body": "@tvaz I thought Cairo only draws stuff. Looping, incrementing x values, and timing are not drawing stuff, so Cairo doesn&#39;t do them."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1452726034, "post_id": 34777181, "comment_id": 57302396, "body": "Yes, you have to queue all that through whatever you use to display your content. For GTK+ that would be the <code>gtk_widget_queue_draw()</code> series of functions combined with <code>g_timeout_add()</code> to run on a timer. There are also dedicated animation frameworks such as Clutter (that can be used with GTK+). You&#39;ll need to figure out what is best for your needs."}], "answers": [{"tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": true, "score": 1, "last_activity_date": 1452998249, "creation_date": 1452998249, "answer_id": 34834509, "question_id": 34777181, "link": "https://stackoverflow.com/questions/34777181/make-objects-move-in-cairo/34834509#34834509", "title": "Make objects move in Cairo", "body": "<p>cairo doesn't animate things, and it doesn't have the concept of objects. Using cairo is more like using a paintbrush on a canvas: once you draw something onto the canvas, it's stuck there and you can't refer to it to change its properties at all, let alone move it around.</p>\n\n<p>Therefore, to animate things drawn with cairo, you have to wipe the part of the canvas that's being animated and draw it again. How to do that depends on what toolkit you are using to display your graphics.</p>\n\n<p>From the tags, I assume you are using GTK+. There are several methods of GtkWidget, such as <code>gtk_widget_queue_draw()</code> and <code>gtk_widget_queue_draw_area()</code>, that will schedule a redraw of your widget. Call this in a <code>g_timeout_add()</code> handler to schedule your animation. You'll get a drawing signal (the same one you're using already) for the portion of the GtkWidget that you chose to redraw (which you can get from within the draw handler with <code>cairo_clip_extents()</code>). Since the relevant portion of the canvas will be blanked already when you enter the draw handler, you can just start drawing your next frame.</p>\n\n<p>You may wish to consider using a dedicated animation framework instead if your needs are sufficiently complicated. Clutter is one specifically designed to be used with GTK+, but there are also others.</p>\n"}], "owner": {"reputation": 77, "user_id": 5778697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b7db94d3bc25846096a2877a0645798?s=128&d=identicon&r=PG&f=1", "display_name": "tvaz", "link": "https://stackoverflow.com/users/5778697/tvaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 34834509, "answer_count": 1, "score": 0, "last_activity_date": 1452998249, "creation_date": 1452719808, "question_id": 34777181, "link": "https://stackoverflow.com/questions/34777181/make-objects-move-in-cairo", "title": "Make objects move in Cairo", "body": "<p>I need to use Cairo to make geometric formulas move through the screen.</p>\n\n<p>How does one \"move\" objects (like circles) in Cairo? I did try <code>cairo_translate(cr, x, y)</code> function but it seems to change the referential for all the objects and I don't know how to produce de \"movement\". In other frameworks I would increment the <code>x</code> value and change the speed with an appropriate <code>clock()</code> function to control FPS's, then I would paint the drawing area background and draw the object with new coordinates.</p>\n\n<p>But I don't know how to produce this with Cairo and all documentation I can find does not mention how this is done.</p>\n\n<p>This is the code I have:</p>\n\n<pre><code>genRandVector(numOfBalls);\n\n/* creates big ball */\ncairo_set_line_width(cr, 5);\ncairo_set_source_rgb(cr, 0, 0, 0);\ncairo_arc(cr, balls_MAP[0].x, balls_MAP[0].y, CONF.big_rad, 0, 2 * M_PI);\n\ncairo_stroke_preserve(cr);\ncairo_set_source_rgb(cr, 0.9, 0.9, 0.9);\n\ncairo_fill(cr);\n\n/* creates other balls */\nint i;\ncairo_close_path(cr);\ncairo_set_source_rgb(cr, 0, 0, 0);\n\nfor(i = 1; i &lt; numOfBalls; i++) {\n\n    cairo_arc(cr, balls_MAP[i].x, balls_MAP[i].y, CONF.small_rad, 0, 2 * M_PI);\n    cairo_stroke_preserve(cr);\n\n    cairo_fill(cr);\n    cairo_close_path(cr);\n}\n</code></pre>\n\n<p>And my circles are still. I would like to make all of them move randomly. I just don't know how to make them \"move\".</p>\n"}, {"tags": ["c", "arrays", "file"], "comments": [{"owner": {"reputation": 2789, "user_id": 5350328, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d81b878ab7662258906d27f2877327b?s=128&d=identicon&r=PG&f=1", "display_name": "phoenix", "link": "https://stackoverflow.com/users/5350328/phoenix"}, "edited": false, "score": 0, "creation_date": 1452719712, "post_id": 34777009, "comment_id": 57299438, "body": "can you explain in detail about your problem. I could not get from the problem description."}, {"owner": {"reputation": 19, "user_id": 5786576, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bNZNT1AmYN4/AAAAAAAAAAI/AAAAAAAAArQ/TNjAoMFqxMY/photo.jpg?sz=128", "display_name": "Alex Cazacu", "link": "https://stackoverflow.com/users/5786576/alex-cazacu"}, "reply_to_user": {"reputation": 2789, "user_id": 5350328, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d81b878ab7662258906d27f2877327b?s=128&d=identicon&r=PG&f=1", "display_name": "phoenix", "link": "https://stackoverflow.com/users/5350328/phoenix"}, "edited": false, "score": 0, "creation_date": 1452719994, "post_id": 34777009, "comment_id": 57299593, "body": "The problem is that in the out file all I get is the last word repeated like wordwordwordword"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1452720155, "post_id": 34777009, "comment_id": 57299679, "body": "Welcome to Stack Overflow. Please read the <a href=\"https://stackoverflow.com/tour\">About</a> page soon. You need to use array subscripts to add data to different elements of the arrays.  Your arrays are also too small for your sample data; <code>word</code> won&#39;t fit in an array smaller than 5 without running into problems (questionable practices).  So, the second dimension should be at least 5 \u2014 more if words can be longer than just <code>word</code>.  Maybe 32 would be a reasonable upper limit?"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1452720424, "post_id": 34777232, "comment_id": 57299796, "body": "Sorta...you&#39;re right that the <code>&amp;</code> is not wanted, but the code should be using <code>rom_eng[i]</code> and then worrying about buffer overflows because the last dimension is only big enough for single letter &#39;words&#39;.  Although, having said that, the code has two levels of loop; maybe there needs to be a 3D array <code>char rom_eng[4][2][32];</code> and pass <code>rom_eng[i][j]</code> to <code>scanf()</code>.  It&#39;s all a bit unclear."}], "tags": [], "owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "is_accepted": false, "score": 1, "last_activity_date": 1452720053, "creation_date": 1452720053, "answer_id": 34777232, "question_id": 34777009, "link": "https://stackoverflow.com/questions/34777009/reading-from-a-file-putting-through-an-array-and-printing-into-file/34777232#34777232", "title": "Reading from a file, putting through an array and printing into file", "body": "<p>You define : <code>char rom_eng[4][2], fran_eng[4][2];</code>\nAnd then you read: <code>fscanf(re, \"%s\", &amp;rom_eng);</code></p>\n\n<p>You 're not supposed to put the <code>'&amp;'</code> before <code>rom_eng</code> because it is defined as a char, and chars are already pointers to adresses, so in this case you dont need to put the '&amp;' to point to the adress.</p>\n"}], "owner": {"reputation": 19, "user_id": 5786576, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bNZNT1AmYN4/AAAAAAAAAAI/AAAAAAAAArQ/TNjAoMFqxMY/photo.jpg?sz=128", "display_name": "Alex Cazacu", "link": "https://stackoverflow.com/users/5786576/alex-cazacu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452720053, "creation_date": 1452719194, "last_edit_date": 1452719455, "question_id": 34777009, "link": "https://stackoverflow.com/questions/34777009/reading-from-a-file-putting-through-an-array-and-printing-into-file", "title": "Reading from a file, putting through an array and printing into file", "body": "<p>I'm trying to make a program that translates words that are in a file and puts them in another file. Here I'm trying to read the words and put them into an array so I can search for them later and then print back into another file the translated word. </p>\n\n<p>For the moment I'm trying to read and print from the array:</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include &lt;string.h&gt;\n\nint main()\n{\n    char rom_eng[4][2], fran_eng[4][2];\n    int i, j;\n    FILE* re = fopen(\"rom_eng.txt\", \"r\");\n    FILE* out = fopen(\"out.txt\", \"w\");\n    if (re == NULL)\n    {\n        printf(\"Error\");\n        return 1;\n    }\n    for (i = 0; i &lt; 2; i++)\n    {\n         for (j = 0; j &lt; 4; j++)\n             fscanf(re, \"%s\", &amp;rom_eng);\n\n    }\n\n    for (i = 0; i &lt; 2; i++)\n    {\n        for (j = 0; j &lt; 4; j++)\n            fprintf(out, \"%s \\n\", rom_eng);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The words in the file are like this:</p>\n\n<pre><code> - word word\n - word word\n</code></pre>\n\n<p>The output is the same last word repeatedly printed in the out file.</p>\n"}, {"tags": ["c", "arrays", "pointers", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "edited": false, "score": 4, "creation_date": 1452718486, "post_id": 34776813, "comment_id": 57298884, "body": "Have you tried anything or even did a google research? There is a ton of documentation about pointers out there. If you want a detailled answer, please ask a detailed question. See <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a question</a> for more :)"}, {"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 0, "creation_date": 1452718593, "post_id": 34776813, "comment_id": 57298931, "body": "How about <a href=\"http://stackoverflow.com/q/6814533/1741542\">stackoverflow.com/q/6814533/1741542</a>?"}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1452729545, "post_id": 34776813, "comment_id": 57303712, "body": "Firstly you should read something about pointers, then you should study pointer arithmetic, that&#39;s what you are looking for"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1452718625, "creation_date": 1452718625, "answer_id": 34776868, "question_id": 34776813, "link": "https://stackoverflow.com/questions/34776813/displaying-an-array-by-using-pointer-techniques/34776868#34776868", "title": "Displaying an array by using pointer techniques", "body": "<p>The array indexing operator is a shorthand for hiding pointer arithmetic.</p>\n\n<p>So if you have an array like this:</p>\n\n<pre><code>double a[5];\n</code></pre>\n\n<p>Instead of using this expression:</p>\n\n<pre><code>a[1]\n</code></pre>\n\n<p>You can use this:</p>\n\n<pre><code>*(a + 1)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5596430, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f91fcda78f79081fc61644bb6527d2?s=128&d=identicon&r=PG&f=1", "display_name": "Takari", "link": "https://stackoverflow.com/users/5596430/takari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1452718621, "answer_count": 1, "score": -3, "last_activity_date": 1555440879, "creation_date": 1452718400, "last_edit_date": 1555440879, "question_id": 34776813, "link": "https://stackoverflow.com/questions/34776813/displaying-an-array-by-using-pointer-techniques", "closed_reason": "Needs more focus", "title": "Displaying an array by using pointer techniques", "body": "<p>I want to display the contents of an array with type double that has a length of 5 without using the [ ] indexing . I can only use a for loop and pointer techniques.</p>\n\n<p>How can you achieve that ? \nCan anyone give me a brief explanation of pointers as I have no idea how to use them exactly ?</p>\n"}, {"tags": ["c", "sockets", "encryption", "tcp"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1452718165, "post_id": 34776726, "comment_id": 57298714, "body": "Format your code. It is not readable. And provide <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 1, "creation_date": 1452718894, "post_id": 34776726, "comment_id": 57299078, "body": "<i>Encrypting with XOR</i>... Please, oh please, let that be a new cipher mode I haven&#39;t heard about."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452720823, "post_id": 34776726, "comment_id": 57299988, "body": "What does <code>write</code> return?"}, {"owner": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452722123, "post_id": 34776726, "comment_id": 57300605, "body": "@EugeneSh. - formatted"}, {"owner": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452722197, "post_id": 34776726, "comment_id": 57300641, "body": "@immibis - i added prints of its value: write succeed with 3 write succeed with 99 Read error: Bad file descriptor Read error: Bad file descriptor write succeed with 31 Read error: Bad file descriptor write succeed with 99 Read error: Bad file descriptor write succeed with 99 Read error: Bad file descriptor write succeed with 99 Read error: Bad file descriptor  error means 0 - but it is not really an error"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452722731, "post_id": 34776726, "comment_id": 57300914, "body": "@annnnnnnnnn 1) why are those read errors not concerning? and 2) if write returns 3 then it only wrote 3 bytes, so you need to try again with the rest of the bytes. Unless you were only trying to write 3 bytes at a time. How many bytes were you trying to write in each call?"}, {"owner": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "edited": false, "score": 0, "creation_date": 1452725615, "post_id": 34776726, "comment_id": 57302236, "body": "it reads every time the size of the buffer. so at the last time, it will return only some of it."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "edited": false, "score": 0, "creation_date": 1452725515, "post_id": 34778333, "comment_id": 57302198, "body": "I didnt understand you. can you explain what you suggest to do?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "edited": false, "score": 0, "creation_date": 1452733706, "post_id": 34778333, "comment_id": 57304985, "body": "@annnnnnnnnn Don&#39;t close the socket until you&#39;re done reading from it."}, {"owner": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1452863373, "post_id": 34778333, "comment_id": 57365427, "body": "@immibis Im trying to do it, but nothing works. where do you thing i need to delete a close()? do i need to add something?"}], "tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": true, "score": 2, "last_activity_date": 1452724352, "creation_date": 1452724352, "answer_id": 34778333, "question_id": 34776726, "link": "https://stackoverflow.com/questions/34776726/c-simple-encrypting-socket-with-tcp-connections-fail-to-encrypt-big-files/34778333#34778333", "title": "C - simple encrypting socket with tcp connections fail to encrypt big files", "body": "<p>One too many <code>close()</code></p>\n\n<pre><code>while (1) {\n    n = read(sockfd, inputBuffer, sizeof(inputBuffer));\n    if(n &lt; 0){\n        ....\n    }\n    close(sockfd);\n}\n</code></pre>\n\n<p>kills the socket after the very first <code>read()</code>.</p>\n\n<p>PS: shorter functions and correct formatting makes it very easy to spot.</p>\n"}], "owner": {"reputation": 61, "user_id": 5786507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/603dbf6676dacae271d907543ee0d1a0?s=128&d=identicon&r=PG&f=1", "display_name": "annnnnnnnnn", "link": "https://stackoverflow.com/users/5786507/annnnnnnnnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 34778333, "answer_count": 1, "score": 0, "last_activity_date": 1452724352, "creation_date": 1452718086, "last_edit_date": 1452721626, "question_id": 34776726, "link": "https://stackoverflow.com/questions/34776726/c-simple-encrypting-socket-with-tcp-connections-fail-to-encrypt-big-files", "title": "C - simple encrypting socket with tcp connections fail to encrypt big files", "body": "<p>Its using a blocking queue for encrypting files with XOR.</p>\n\n<p>The buffers are set to be very big, but still when i encrypt the encryption of big files (1000 chars and more) I should receive the same file, but I am receiving only the beginning. Anyone knows how to fix this?\nthanks.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;time.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;netinet/tcp.h&gt;\n#include \"os_queue.c\"\n\n\n#define BACKLOGGED_CONNECTIONS 10\n\nqueue_t new_queue;\nint i=0;\n\n\nvoid *worker_thread(void* key_path) {\n    int j = i;\n    i++;\n    printf(\"worker %d stssssart\\n\",j);\n    int rc;\n    int sockfd;\n    int key_fd;\n    if ((key_fd = open(key_path, O_RDONLY)) &lt; 0) {\n        printf(\"ERROR: open key file failed: %s\\n\",strerror(errno));\n        exit(1);\n    }\n    while (1) {\n\n        rc = queue_dequeue(&amp;new_queue,&amp;sockfd);\n\n        if (rc != 0) {\n            printf(\"error! dequeue of a client's sockfd from the shared queue failed: %d\\n\",rc);\n        }\n\n        if(cipher(sockfd,key_fd)!=0){\n            printf(\"chipher did not work\");\n            exit(1);\n        }\n    }\n    printf(\"worker %d finish\\n\",j);\n\n    close(key_fd);\n    pthread_exit((void*) &amp;key_fd);\n\n}\n\nint cipher(int sockfd,int key_fd){\n    int keyFileFD, numberOfBytes,loop,n,key_num,totalsent,nsent,i;\n    char inputBuffer[262144], keyBuffer[262144],outputBuffer[262144];\n\n    if(lseek(key_fd,0,SEEK_SET) == -1){\n        printf(\"lseek function failed %s\\n\", strerror(errno));\n        return errno;\n    }\n\n    while (1) {\n        n = read(sockfd, inputBuffer, sizeof(inputBuffer));\n        if(n &lt; 0){\n\n            if(errno ==EPIPE || errno == ENOTCONN || errno == ECONNRESET) {\n                printf(\"111\");\n                close(sockfd);\n                return 0;\n            }\n            else{\n                printf(\"Read error: %s\\n\", strerror(errno));\n                close(sockfd);\n                return 0;\n            } \n\n        }\n        key_num=read(key_fd, keyBuffer, n);\n        if (key_num &lt; 0) {\n\n            printf(\"Error reading file: %s\\n\", strerror(errno));\n            return errno;\n            }\n\n            while (key_num&lt;n) {\n                if(lseek(key_fd,0,SEEK_SET) == -1) {\n                        /*\n                        *error\n                        */\n                        printf(\"lseek function failed %s\\n\", strerror(errno));\n                        return errno;\n                }\n\n                int cont=read(key_fd, keyBuffer+key_num, n-key_num);\n                if (cont == -1) {\n                    printf(\"Error reading  file: %s\\n\", strerror(errno));\n                    return errno;\n                }\n                key_num=key_num+cont;\n            }\n\n\n            for(i=0;i&lt;n;i++){\n\n                outputBuffer[i] = (inputBuffer[i] ^ keyBuffer[i]);                                              \n            }\n\n            if(write(sockfd, outputBuffer,n)&lt;0) {\n                if(errno ==EPIPE || errno == ENOTCONN || errno == ECONNRESET) {\n                    close(sockfd);\n                    return 0;\n                } else{\n                    printf(\"Read error: %s\\n\", strerror(errno));\n                    close(sockfd);\n                    return 0;\n                } \n\n\n\n            }\n            close(sockfd);\n        }\n\n    return 0;\n    }\n\n\nint main(int argc, char *argv[]) {\n\n    int base_sockfd, new_sockfd,i, rc, keyFileFD, num_of_workers,addrsize_1,addrsize_2;\n    struct sockaddr_in serv_addr, client_addr;\n    char* key_path = argv[3];\n    addrsize_1 = sizeof(struct sockaddr);\n    num_of_workers = atoi(argv[1]);\n\n    if(argc!=4){\n        printf(\"number of args is not 4: %s\\n\",strerror(errno));\n        return errno;\n    }\n\n    if(access(key_path, R_OK)&lt;0){\n        printf(\"Key file does not exist or the file is not accessible: %s\\n\",strerror(errno));\n        return errno;\n    }\n\n    /*init data structures*/\n    rc = init_queue(&amp;new_queue,2*num_of_workers);\n    if (rc!=0) {\n        printf(\"error! shared queue init failed\\n\");\n        return 1;\n    }\n\n    pthread_t threads[num_of_workers];\n\n\n    /*create workers*/\n    for (i = 0; i &lt; num_of_workers; i++) {\n        rc = pthread_create(&amp;threads[i], NULL, worker_thread,  (void*) key_path);\n        if (rc != 0) {\n            printf(\"error! pthread_create() failed: %d\\n\", rc);\n            return 1;\n        }\n    }\n\n    memset(&amp;serv_addr, '0', sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = htons(atoi(argv[2])); // short, network byte order\n    serv_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");//INADDR_ANY;\n\n\n    if ((base_sockfd = socket(PF_INET, SOCK_STREAM, 0)) &lt; 0)\n    {\n        printf(\"error! socket() failed: %s\\n\", strerror(errno));\n        return errno;\n    }\n\n    if (bind(base_sockfd, (struct sockaddr *)&amp;serv_addr, addrsize_1) &lt; 0) {\n        printf(\"error! bind() failed: %s\\n\", strerror(errno));\n        close(base_sockfd);\n        return errno;\n    }\n\n    addrsize_2 = sizeof(struct sockaddr_in);\n\n    if (listen(base_sockfd,SOMAXCONN) &lt; 0) {\n        printf(\"error! listen() failed: %s\\n\", strerror(errno));\n        return errno;\n    }\n\n\n\n        while(1){\n        if ( (new_sockfd = accept(base_sockfd, (struct sockaddr*)&amp;client_addr, &amp;addrsize_2)) &lt;= 0) {\n            printf(\"error! accept() failed: %s\\n\", strerror(errno));\n            close(base_sockfd);\n            return errno;\n        }\n        /*we have a new valid client sockfd, so enqueue it*/\n        rc = queue_enqueue(&amp;new_queue, new_sockfd);\n        if (rc!= 0) {\n            printf(\"error! enqueue to shared queue failed withe value:%d\\n\",rc);\n            return 1;\n        }\n\n        }\n    /*clean up and close resources*/\n    rc=free_queue(&amp;new_queue);\n        if(rc!=0)\n        printf(\"error! free queue failed with value:%d\\n\",rc);\n        return 1;\n    //close(base_sockfd);\n    /*exit gracefully*/\n\n}\n</code></pre>\n\n<p>queue: </p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\n\n\ntypedef struct queue {\n    int *arr;\n    int capacity;\n    int size;\n    int in;\n    int out;\n    pthread_mutex_t mutex;\n    pthread_cond_t cond_full;\n    pthread_cond_t cond_empty;\n} queue_t;\n\n\nint queue_enqueue(queue_t *queue, int value) {\n    int rc;\n    rc = pthread_mutex_lock(&amp;(queue-&gt;mutex));\n    if(rc!=0){\n        return rc;\n    }\n    while (queue-&gt;size == queue-&gt;capacity) {\n        pthread_cond_wait(&amp;(queue-&gt;cond_full), &amp;(queue-&gt;mutex));\n    }\n    queue-&gt;arr[queue-&gt;in] = value;\n    ++ queue-&gt;size;\n    ++ queue-&gt;in;\n    queue-&gt;in %= queue-&gt;capacity;\n    rc = pthread_mutex_unlock(&amp;(queue-&gt;mutex));\n    if(rc!=0){\n        return rc;\n    }\n    rc = pthread_cond_signal(&amp;(queue-&gt;cond_empty));\n    if(rc!=0){\n      return rc;\n    }\n}\n\nint queue_dequeue(queue_t *queue,int *value){\n    int rc;\n    rc = pthread_mutex_lock(&amp;(queue-&gt;mutex));\n    if(rc!=0){\n      return rc;\n    }\n    while (queue-&gt;size == 0){\n        pthread_cond_wait(&amp;(queue-&gt;cond_empty), &amp;(queue-&gt;mutex));\n    }\n    *value = queue-&gt;arr[queue-&gt;out];\n    -- queue-&gt;size;\n    ++ queue-&gt;out;\n    queue-&gt;out %= queue-&gt;capacity;\n    rc = pthread_mutex_unlock(&amp;(queue-&gt;mutex));\n    if(rc!=0){\n        return rc;\n    }\n    rc = pthread_cond_signal(&amp;(queue-&gt;cond_full));\n    return rc;\n\n}\n\n\n\nint init_queue(queue_t *new_queue,int cnt) {\n    int rc;\n    new_queue-&gt;capacity = cnt;\n    new_queue-&gt;arr = malloc(sizeof(cnt)*sizeof(int));\n    if (new_queue-&gt;arr== NULL) {\n      return -1;\n    }\n    new_queue-&gt;size = 0;\n    new_queue-&gt;in = 0;\n    new_queue-&gt;out = 0;\n    //init shared queue lock (mutex)\n    rc =  pthread_mutex_init(&amp;(new_queue-&gt;mutex), NULL);\n    if (rc != 0) {\n        return rc;\n    }\n\n    //init shared queue conditions variable\n    rc = pthread_cond_init(&amp;(new_queue-&gt;cond_full), NULL); \n    if (rc != 0) {\n        return rc;\n    }\n    rc = pthread_cond_init(&amp;(new_queue-&gt;cond_empty), NULL); \n    if (rc != 0) {\n        return rc;\n    }\n}\n\nint free_queue(queue_t *queue_to_kill) {\n    int rc;\n    rc = pthread_mutex_destroy(&amp;(queue_to_kill-&gt;mutex));\n    if (rc) {\n        return rc;\n    }\n    rc = pthread_cond_destroy(&amp;(queue_to_kill-&gt;cond_empty));\n        if (rc) {\n        return rc;\n    }\n    rc = pthread_cond_destroy(&amp;(queue_to_kill-&gt;cond_full));\n    if (rc) {\n        return rc;\n    }\n}\n</code></pre>\n\n<p>client:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;pthread.h&gt;\n\nint connectToHostname(int sock, char* hostname, char* port);\nint main(int argc, char* argv[]){\n    int sock;\n        char* hostname;\n        char* port;\n\n\n        /* place default port if required*/\n        if(argc &lt; 3)\n        {\n            port = \"42666\";\n        }\n        else\n        {\n            port = argv[2];\n        }\n        /* place default hostname if required*/\n        if(argc == 1)\n        {\n            hostname = \"localhost\";\n        }\n        else\n        {\n            hostname = argv[1];\n        }\n\n        /* open TCP socket with IPv4*/\n        if((sock = socket(PF_INET, SOCK_STREAM, 0))&lt;0)\n        {\n            perror(\"Could not open socket\");\n            exit(errno);\n        }\n        int fd = -1;\n        int fd2 = -1;\n        if(argc &gt;= 4)\n        {\n             fd = open(argv[3], O_WRONLY|O_CREAT|O_TRUNC, 0666);\n        }\n        if(argc &gt;= 5)\n        {\n            fd2 = open(argv[4], O_RDONLY, 0);\n        }\n        connectToHostname(sock, hostname, port);\n        char buf[100];\n        while(1)\n        {\n            if(fd2 &lt;0)\n            {\n                scanf(\"%99s\",buf);\n                send(sock, buf, strlen(buf), 0);\n            }\n            else\n            {\n                int stupid = read(fd2, buf, 99);\n                if(stupid == 0)\n                {\n                    close(sock);\n                    exit(0);\n                }\n                send(sock, buf, stupid, 0);\n            }\n\n            int sz = recv(sock, buf, 99, 0);\n            buf[100] = '\\0';\n            if(fd&lt; 0)\n                {\n                printf(\"%s\\n\", buf);\n                }\n            else\n            {\n                write(fd, buf, sz);\n            }\n        }\n}\nint connectToHostname(int sock, char* hostname, char* port)\n{\n    int rv;\n    struct addrinfo hints, *servinfo, *p;\n    struct sockaddr_in *h;\n    struct sockaddr_in dest_addr;\n\n    /* server addr is IPv4*/\n    dest_addr.sin_family = AF_INET;\n    /* write server port*/\n    dest_addr.sin_port = htons((short)strtol(port, NULL,10));\n    /* zero out hints (since garbage is bad)*/\n    memset(&amp;hints, 0, sizeof(hints));\n    /* we want IPv4 address and TCP*/\n    hints.ai_family = AF_INET;\n    hints.ai_socktype = SOCK_STREAM;\n    /* try get address info*/\n    if((rv = getaddrinfo(hostname, port, &amp;hints, &amp;servinfo)) != 0)\n    {\n        fprintf(stderr, \"Error getting address info: %s\\n\", gai_strerror(rv));\n        exit(1);\n    }\n    p = servinfo;\n    while(p!= NULL)\n    {\n        /* put last address into sent pointer*/\n        h = (struct sockaddr_in *)p-&gt;ai_addr;\n        dest_addr.sin_addr = h-&gt;sin_addr;\n        if(connect(sock, (struct sockaddr*)(&amp;dest_addr), sizeof(struct sockaddr)) == 0)\n                break;/* if connection succesfull*/\n        p = p-&gt;ai_next;\n    }\n    freeaddrinfo(servinfo);\n    if(p == NULL)\n    {\n        /*We didnt find a host*/\n        perror(\"Could not connect to server\");\n        exit(errno);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>i used this script to test it:</p>\n\n<pre><code>echo niv &gt; key_file\necho is &gt; read_file_b\necho thethethethethethethethethethe &gt; read_file_c\necho se &gt; read_file_d\necho rse &gt; read_file_e\necho rse &gt; read_file_f\n\necho aaaaaaa &gt; write_file_a\necho bbbbbbb &gt; write_file_b\necho ccccccc &gt; write_file_c\necho ddddddd &gt; write_file_d\necho ddddddd &gt; write_file_e\necho ddddddd &gt; write_file_f\n\ngcc setos_server.c -pthread -o setos_server\n./setos_server 3 2 key_file &amp;\nsleep 0.1\n#printf \"\\n\\n\"\ngcc client.c -pthread -o client\n./client 127.0.0.1 2 write_file_a read_file_a &amp;\n./client 127.0.0.1 2 write_file_b read_file_b &amp;\n./client 127.0.0.1 2 write_file_c read_file_c &amp;\n./client 127.0.0.1 2 write_file_d read_file_d &amp;\n./client 127.0.0.1 2 write_file_e read_file_e &amp;\n./client 127.0.0.1 2 write_file_f read_file_f &amp;\n\n\n./client 127.0.0.1 2 final_file_a write_file_a &amp;\n./client 127.0.0.1 2 final_file_b write_file_b &amp;\n./client 127.0.0.1 2 final_file_c write_file_c &amp;\n./client 127.0.0.1 2 final_file_d write_file_d &amp;\n./client 127.0.0.1 2 final_file_e write_file_e &amp;\n./client 127.0.0.1 2 final_file_f write_file_f &amp;\n\nsleep 2\n\npkill setos_server\n</code></pre>\n\n<p>when read_file_a is a big file (more then 10000 chars).</p>\n\n<p>thank you for your help.</p>\n"}, {"tags": ["c", "makefile", "linker-errors"], "comments": [{"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452719062, "post_id": 34776543, "comment_id": 57299149, "body": "C++ name mangling issue?"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1452719308, "post_id": 34776543, "comment_id": 57299268, "body": "Try adding a call to a function from user32 and see if that links"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1452719419, "post_id": 34776543, "comment_id": 57299311, "body": "I&#39;m not entirely happy with your makefile btw. winapi.dll should depend upon winapi.o, which should depend upon winapi.c. <code>clean</code> should remove tests.exe and winapi.dll."}, {"owner": {"reputation": 464, "user_id": 2355901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a29d84772127dbbd27afb415b2ee3af?s=128&d=identicon&r=PG", "display_name": "vuolen", "link": "https://stackoverflow.com/users/2355901/vuolen"}, "reply_to_user": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1452719609, "post_id": 34776543, "comment_id": 57299390, "body": "@MartinBroadhurst I&#39;m a bit of a beginner so the makefile isn&#39;t much. I&#39;ll add those changes. I just tested it and IsWindow() from user32 doesn&#39;t return a link error."}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1452719704, "post_id": 34776543, "comment_id": 57299434, "body": "Clutching at straws, have you tried changing the case:  &quot;-liphlpapi&quot; rather than &quot;-lIphlpapi&quot;?"}, {"owner": {"reputation": 464, "user_id": 2355901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a29d84772127dbbd27afb415b2ee3af?s=128&d=identicon&r=PG", "display_name": "vuolen", "link": "https://stackoverflow.com/users/2355901/vuolen"}, "edited": false, "score": 0, "creation_date": 1452719778, "post_id": 34776543, "comment_id": 57299468, "body": "Just tried it out. Same error :/ The linker seems to find the library though. Changing its name to some random string returns with an error that it cant find the library. I don&#39;t get that error with &quot;-liphlpapi&quot;, lower case i or not"}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1452720613, "post_id": 34776543, "comment_id": 57299891, "body": "did you verify that the library has the function with the argument types that you specify? Double check the prototype definition in the include file and match it against the call."}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1452723380, "post_id": 34776543, "comment_id": 57301228, "body": "Neither <code>GetExtendedTcpTable</code>, nor <code>GetAdaptersAddresses</code> will link, although AFAICT all of the other functions in iphlpapi will. <code>objdump --syms</code> says they&#39;re both in the library. The only funny thing I can see that they have in common is that they are both in an  <code>#if (_WIN32_WINNT &gt;= 0x0501)</code> block in iphlpapi.h, and none of the other functions are."}, {"owner": {"reputation": 464, "user_id": 2355901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a29d84772127dbbd27afb415b2ee3af?s=128&d=identicon&r=PG", "display_name": "vuolen", "link": "https://stackoverflow.com/users/2355901/vuolen"}, "edited": false, "score": 0, "creation_date": 1452724285, "post_id": 34776543, "comment_id": 57301612, "body": "The libs probably came with Mingw as I did not build or download them. I tried printing out the value of _WIN32_WINNT in my case. It&#39;s 0x0400 which according to this list (<a href=\"https://msdn.microsoft.com/en-gb/library/6sehtctf%28v=vs.140%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-gb/library/6sehtctf%28v=vs.140%29.asp&zwnj;&#8203;x</a>) means I&#39;m running Windows NT 4.0. Im actually on Windows 10."}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1452725177, "post_id": 34776543, "comment_id": 57302035, "body": "That&#39;s your problem. If you put <code>#define _WIN32_WINNT 0x0A00</code>before the <code>#include Iphlpapi.h</code> it will build."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1452737041, "post_id": 34776543, "comment_id": 57306004, "body": "To even get <code>winapi.c</code> to compile, I have to add <code>#include &lt;winsock2.h&gt;</code> at the top. Just to be clear - you&#39;re getting the error when creating the <code>winapi.dll</code>, before creating the <code>tests.exe</code> program, right?  Also, can you let us know which MinGW toolchain you&#39;re using?  The one I tested with (TDM64 4.9.2) does not restrict the <code>GetExtendedTcpTable()</code> API to a particular <code>_WIN32_WINNT</code> version (rightly or wrongly). And it defaults to <code>_WIN32_WINNT==0x0502</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "is_accepted": true, "score": 2, "last_activity_date": 1452726398, "last_edit_date": 1452726398, "creation_date": 1452725892, "answer_id": 34778671, "question_id": 34776543, "link": "https://stackoverflow.com/questions/34776543/odd-undefined-reference-error/34778671#34778671", "title": "Odd &quot;undefined reference&quot; error", "body": "<p>MinGW defines <code>WINVER</code> as <code>0x400</code> (Windows NT) in windef.h, and this means that some newer features of Windows will not link.</p>\n\n<pre><code>#ifndef WINVER\n#define WINVER 0x0400\n/*\n * If you need Win32 API features newer the Win95 and WinNT then you must\n * define WINVER before including windows.h or any other method of including\n * the windef.h header.\n */\n#endif\n</code></pre>\n\n<p>So you need to define <code>WINVER</code> yourself to the version of Windows you are targeting <em>before</em> including any Windows headers.</p>\n\n<p>Use one of the following definitions:</p>\n\n<pre><code>#define WINVER 0x0500 // Windows 2000\n#define WINVER 0x0501 // Windows XP\n#define WINVER 0x0502 // Windows Server 2003\n#define WINVER 0x0600 // Windows Vista, Windows Server 2008\n#define WINVER 0x0601 // Windows 7\n#define WINVER 0x0602 // Windows 8\n#define WINVER 0x0603 // Windows 8.1\n#define WINVER 0x0A00 // Windows 10\n</code></pre>\n"}], "owner": {"reputation": 464, "user_id": 2355901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a29d84772127dbbd27afb415b2ee3af?s=128&d=identicon&r=PG", "display_name": "vuolen", "link": "https://stackoverflow.com/users/2355901/vuolen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 34778671, "answer_count": 1, "score": 6, "last_activity_date": 1452726398, "creation_date": 1452717323, "question_id": 34776543, "link": "https://stackoverflow.com/questions/34776543/odd-undefined-reference-error", "title": "Odd &quot;undefined reference&quot; error", "body": "<p>So I'm trying to make a really simple abstraction library on top of the Windows API using C. I made a simple Makefile and when I try to make the project using Msys, I get this:</p>\n\n<pre><code>winapi.o: In function `get_client_pid':\n(long path)/winapi.c:13: undefined reference to `GetExtendedTcpTable'\n(long path)/winapi.c:31: undefined reference to `GetExtendedTcpTable'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [lib] Error 1\n</code></pre>\n\n<p>and get_client_pid() is defined in winapi.c as</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;Iphlpapi.h&gt;\n\n#define true 1\n#define false 0\n\n\n    uint32_t get_client_pid()\n    {\n        MIB_TCPTABLE_OWNER_PID *tcpTable;\n        PDWORD tableSize;\n        DWORD ret = GetExtendedTcpTable(tcpTable, \n                                        tableSize, \n                                        true, \n                                        2, \n                                        TCP_TABLE_OWNER_PID_ALL,\n                                        0);\n\n        if (ret == NO_ERROR) {\n            printf(\"ERROR get_client_pid: No error with table size at 0?\\n\");\n            return 0;\n        }\n        if (ret != ERROR_INSUFFICIENT_BUFFER) {\n            printf(\"ERROR get_client_pid: No insufficient buffer with table size at 0?\\n\");\n            return 0;\n        }\n        printf(\"TABLE SIZE %d\\n\", *tableSize);\n        tcpTable = malloc(*tableSize);\n\n        ret = GetExtendedTcpTable(  tcpTable,\n                                    tableSize, \n                                    true,\n                                    2,\n                                    TCP_TABLE_OWNER_PID_ALL,\n                                    0);\n\n        if (ret != NO_ERROR) {\n            printf(\"ERROR get_client_pid: GetExtendedTcpTable error: %d\\n\", ret);\n            free(tcpTable);\n            return 0;\n        }\n\n        int i;\n        for (i = 0; i &lt; tcpTable-&gt;dwNumEntries; i++) {\n            MIB_TCPROW_OWNER_PID row = tcpTable-&gt;table[i];\n            if (row.dwRemotePort == 0x208 &amp;&amp; row.dwRemoteAddr == 0x100007F) {\n                printf(\"FOUND PROCESS: %d\\n\", row.dwOwningPid);\n                free(tcpTable);\n                return row.dwOwningPid;\n            }\n        }\n\n        free(tcpTable);\n        return 0;\n    }\n</code></pre>\n\n<p>As this is a linker error, I'll add my makefile:</p>\n\n<pre><code>current_dir = $(shell pwd)\n\nall: test\n\ntest: lib\n    gcc -c -g tests.c\n    gcc -o tests.exe tests.o -L$(current_dir) -lwinapi\n\nlib:\n    gcc -c -g winapi.c\n    gcc -shared -o winapi.dll winapi.o -lIphlpapi -luser32\n\nclean:\n    rm *.o\n</code></pre>\n\n<p>I have to say that I tried every possible place to insert \"-lIphlpapi\" in case the linking was somehow in the wrong order but that didn't help.</p>\n"}, {"tags": ["c", "arrays", "memory", "allocation", "calloc"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1452717281, "post_id": 34776498, "comment_id": 57298218, "body": "Use <code>sizeof(*WeightIH)</code> instead, or always one star less than the pointer, in the first case <code>sizeof(double *)</code>. In this particular setup it doesn&#39;t matter, but if you had a pointer like <code>double *x;</code> <code>malloc()</code>ing <code>sizeof(double *)</code> would be wrong. Also, clarify your question, be specific. And don&#39;t use <code>***</code> triple star pointers. What do you need a &quot;<i>3D array</i>&quot; for?"}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1452717378, "post_id": 34776498, "comment_id": 57298269, "body": "You don&#39;t seemt o be declaring DeltaWeightIH - try double ***WeightIH = calloc(51*20, sizeof(double **)) since ** is as pointer to a pointer and *** is a pointer to a pointer to a pointer and **** is a pointer to a pointer to a pointer to a pointer."}, {"owner": {"reputation": 73, "user_id": 5570557, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/5b0620e5bdde2f87c285d35d34692b6e?s=128&d=identicon&r=PG&f=1", "display_name": "kendall weihe", "link": "https://stackoverflow.com/users/5570557/kendall-weihe"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452717415, "post_id": 34776498, "comment_id": 57298288, "body": "@iharob I tried using <code>sizeof(*WeightIH)</code> and it still seg faults. I need a 3d array for a neural network"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1452717494, "post_id": 34776498, "comment_id": 57298335, "body": "Handling a triple star pointer is very hard. It&#39;s not a good idea. You have to think of the model that correctly represents your data. For instance, you can have a <code>struct</code> with 3 pointers, each representing 1 dimension. It would be much easier to allocate, deallocate and handle it in general. The same applies to the <code>**</code> pointer. You really only need that if the elements of the array are <i>pointers</i> otherwise it&#39;s always wise to use a <code>struct</code> instead."}, {"owner": {"reputation": 73, "user_id": 5570557, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/5b0620e5bdde2f87c285d35d34692b6e?s=128&d=identicon&r=PG&f=1", "display_name": "kendall weihe", "link": "https://stackoverflow.com/users/5570557/kendall-weihe"}, "reply_to_user": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1452717528, "post_id": 34776498, "comment_id": 57298359, "body": "@Nunchy but I need <code>WeightIH</code> to be a 2d array. also I tried <code>sizeof(double *)</code> and it still seg faults"}, {"owner": {"reputation": 73, "user_id": 5570557, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/5b0620e5bdde2f87c285d35d34692b6e?s=128&d=identicon&r=PG&f=1", "display_name": "kendall weihe", "link": "https://stackoverflow.com/users/5570557/kendall-weihe"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452717557, "post_id": 34776498, "comment_id": 57298370, "body": "@iharob ah thank you! that&#39;s what I&#39;ll use"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1452800710, "post_id": 34776498, "comment_id": 57339790, "body": "where&#39;s the rest of your code? you have to allocate each dimension when using this technique."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 4438416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ggyj-iYL43o/AAAAAAAAAAI/AAAAAAAAAGI/g_cBM1W5FIk/photo.jpg?sz=128", "display_name": "Saveliy Belkin", "link": "https://stackoverflow.com/users/4438416/saveliy-belkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1452793979, "last_edit_date": 1452793979, "creation_date": 1452722429, "answer_id": 34777905, "question_id": 34776498, "link": "https://stackoverflow.com/questions/34776498/assign-value-to-pointer-to-pointer-2d-array/34777905#34777905", "title": "Assign value to pointer to pointer 2d array", "body": "<p>A simple way to define 5x6x7 matrix hope it helps. </p>\n\n<pre><code>float ***array3D;\narray3D = malloc(5 * sizeof(float**));\nfor ( int i = 0; i &lt; 5; ++i) {\n    array3D[i] = malloc(6 * sizeof(float*));\n    for ( int j = 0; j &lt; 6; ++j) {\n         array3D[i][j] = calloc( 7, sizeof(float));\n         for ( int k = 0; k &lt; 7; ++k ) \n             array3D[i][j][k] = 1.0;  \n    }\n}\n</code></pre>\n\n<p>I wouldn't use calloc when define array of pointers since you filling them immediately in the same loop.\nDon't forget to free, it will eat your memory very quick. </p>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 5784633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rz5Ix.jpg?s=128&g=1", "display_name": "Saifeddine M", "link": "https://stackoverflow.com/users/5784633/saifeddine-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1452723294, "creation_date": 1452723294, "answer_id": 34778110, "question_id": 34776498, "link": "https://stackoverflow.com/questions/34776498/assign-value-to-pointer-to-pointer-2d-array/34778110#34778110", "title": "Assign value to pointer to pointer 2d array", "body": "<p>the easiest way is to use for loops. just like the example below</p>\n\n<pre><code>int i, j = 0;\nint rows = 5;\nint cols = 2;\n\nint rows2 = 3; // for 3d array\n\ndouble  **arr2d = (double  **)calloc(rows, sizeof(double));\ndouble  ***arr3d = (double  ***)calloc(rows, sizeof(double));\nfor (i = 0; i &lt; rows; j++)\n{\n    arr2d[i] = (double *)calloc(cols, sizeof(double));\n}\n\narr2d[1][2] = 0.0; //Or *(*(arr2d+1)+2) = 0.0;\n\n//the same thing for 3d it just need another for loop.\nfor (i = 0; i &lt; rows; j++)\n{\n    arr3d[i] = (double **)calloc(cols, sizeof(double));\n    for (j = 0; i &lt; cols; j++)\n    {\n        arr3d[i][j] = (double *)calloc(rows2, sizeof(double));\n    }\n}\n\narr3d[1][2][1] = 0.0; //Or *(*(*(arr2d+1)+2)+1) = 0.0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1452800876, "creation_date": 1452800876, "answer_id": 34798403, "question_id": 34776498, "link": "https://stackoverflow.com/questions/34776498/assign-value-to-pointer-to-pointer-2d-array/34798403#34798403", "title": "Assign value to pointer to pointer 2d array", "body": "<p>It's not clear from your question whether a contiguous array would satisfy your requirements; but if it does then you can write more simply:</p>\n\n<pre><code>double (*a)[20] = malloc( 51 * sizeof *a );\n\ndouble (*b)[20][30] = malloc( 10 * sizeof *b );\n</code></pre>\n\n<p>The innermost dimension goes on the right-hand-side, the other dimensions go on the left.</p>\n\n<p>If you really do need a jagged array you need to write separate allocations for each row.</p>\n"}], "owner": {"reputation": 73, "user_id": 5570557, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/5b0620e5bdde2f87c285d35d34692b6e?s=128&d=identicon&r=PG&f=1", "display_name": "kendall weihe", "link": "https://stackoverflow.com/users/5570557/kendall-weihe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 915, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1452800876, "creation_date": 1452717136, "last_edit_date": 1452717321, "question_id": 34776498, "link": "https://stackoverflow.com/questions/34776498/assign-value-to-pointer-to-pointer-2d-array", "title": "Assign value to pointer to pointer 2d array", "body": "<p>I believe I have a declaration incorrect. I have an array that is 2D and an array that is 3D. I'm seg faulting because I'm assigning the value 0 -- or <code>NULL</code> to one of the arrays. I know this is trying to assign the address <code>NULL</code> to the pointer which is invalid.</p>\n\n<p>Maybe I need to dereference the array before assigning? If so, how do I do this? If not, how do I need to declare the arrays?</p>\n\n<pre><code>double **WeightIH = calloc(51*20,sizeof(double **));\ndouble ***Input = calloc(51*40, sizeof(double ***));\nDeltaWeightIH[i][j] = 0.0 ;\n</code></pre>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1452717162, "post_id": 34776444, "comment_id": 57298154, "body": "Itanium and Alpha are very different platforms. About the best you can do is make statements about the memory layout used by the OS."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1452717546, "post_id": 34776444, "comment_id": 57298364, "body": "@ Flexo Well, that is already a partial answer, if the Itanium spec has something to say about it then that&#39;s a start."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1452717559, "post_id": 34776444, "comment_id": 57298372, "body": "Already vote to close? Can I ask why?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 2, "creation_date": 1452717710, "post_id": 34776444, "comment_id": 57298463, "body": "It&#39;s more likely to the <i>least</i> significant bit, not the <i>most</i>.  The long string buffer will be allocated from the heap, and will almost certainly be 8byte aligned (at least), so bottom four bits zero.  This avoids making any assumptions about overall memory layout."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1452717760, "post_id": 34776444, "comment_id": 57298490, "body": "You&#39;re mistaken in multiple ways. The short string flag doesn&#39;t overlap with a pointer at all, it overlaps with the field that holds the <i>size</i> of a long string. Even if it did overlap with a pointer, it would be the low bit of the pointer, meaning that memory <i>range</i> doesn&#39;t come into it, only alignment."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1452718540, "post_id": 34776444, "comment_id": 57298912, "body": "@MartinBonner Thanks for pointing out the size. As for the alignment, I don&#39;t think this works out. std::string is a typedef of basic_string, so SSO is implemented in basic_string. basic_string is allocator aware, so it must work with any allocator. While the standard allocater will return 8 byte aligned memory, conforming allocators are not required to. Since it&#39;s allocating chars, it can return 1 byte aligned memory."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1452718695, "post_id": 34776444, "comment_id": 57298980, "body": "@hobbs See my comment above."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1452719223, "post_id": 34776444, "comment_id": 57299229, "body": "@NirFriedman still, it means that there&#39;s nothing germane in your question."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1452719399, "post_id": 34776444, "comment_id": 57299303, "body": "@hobbs Well, actually what it means is that the motivating example was flawed. The question itself still stands, but obviously you are entitled to your opinion."}], "answers": [{"comments": [{"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1452718843, "post_id": 34776719, "comment_id": 57299051, "body": "Thanks for pointing this out, I stupidly assumed that string used 3 pointers like vector usually does, definitely a brain fart. I&#39;m accepting zneak&#39;s answer as he added more information about the heart of my question, but thanks to you as well!"}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 3, "last_activity_date": 1452718060, "creation_date": 1452718060, "answer_id": 34776719, "question_id": 34776444, "link": "https://stackoverflow.com/questions/34776444/range-of-pointer-values-on-64-bit-systems/34776719#34776719", "title": "Range of pointer values on 64 bit systems", "body": "<p>The \"long-bit\" isn't part of a pointer, but of the capacity:</p>\n\n<pre><code>struct __long\n{\n    size_type __cap_;\n    size_type __size_;\n    pointer   __data_;\n};\n</code></pre>\n\n<p>The \"trick\" is that if you always allocate an even number of characters and reserve one for the nul terminator, the resulting capacity will always be an odd number. And you get the 1-bit for free!</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1452718762, "post_id": 34776730, "comment_id": 57299008, "body": "Actually, x86-64 has canonical addresses, so the upper 16 bits are copies of bit 47, so they <i>can</i> be set."}, {"owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1452719598, "post_id": 34776730, "comment_id": 57299384, "body": "@EOF is this guaranteed then? If this is the case, then it sounds like it is actually possible to use those bits for something, and simply set the top 16 bits before dereferencing."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "edited": false, "score": 0, "creation_date": 1452719857, "post_id": 34776730, "comment_id": 57299513, "body": "@NirFriedman: Yes, canonical pointers are enforced by hardware, you get an exception if you try to dereference a non-canonical address. However, if the virtual address-space is expanded in future processor generations, code relying on those bits being unused will not work anymore. I&#39;m pretty sure canonical addresses are supposed to discourage this use."}], "tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": true, "score": 4, "last_activity_date": 1452718971, "last_edit_date": 1452718971, "creation_date": 1452718099, "answer_id": 34776730, "question_id": 34776444, "link": "https://stackoverflow.com/questions/34776444/range-of-pointer-values-on-64-bit-systems/34776730#34776730", "title": "Range of pointer values on 64 bit systems", "body": "<blockquote>\n  <p>As we know, a string typically consists of 3 pointers, which is 24 bytes on a 64 bit system.</p>\n</blockquote>\n\n<p>This is not true with libc++. The <code>__long</code> structure, for \"long strings\" is defined as:</p>\n\n<pre><code>struct __long\n{\n    size_type __cap_;\n    size_type __size_;\n    pointer   __data_;\n};\n</code></pre>\n\n<p>The short flag therefore goes into the capacity field, making the whole thing moot.</p>\n\n<p>As for pointer tagging, there is no universal guarantee about the size of a pointer. On x86_64, the data structures that the CPU uses for virtual address translation only use 48 bits (or 52 with physical address extension), so virtual addresses never use the upper 16 (or 12) bits. Additionally, most operating systems map their kernel into every process and reserve some amount of the high end of the address space for it, so in practice, user-mode pointers are even more restricted. On Windows, the most significant hardware-usable bit of a pointer tells whether it belongs to kernel-space or user-space.</p>\n\n<p>These limits can change in the future and will vary across platforms, so it would be bad form to use them in a platform-independent standard library. In general, it's much better practice to <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20150605-00/?p=45441\" rel=\"nofollow\">use the least-significant bits for pointer tagging</a>, since your application is in control of these.</p>\n"}], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "accepted_answer_id": 34776730, "answer_count": 2, "score": 2, "last_activity_date": 1452718971, "creation_date": 1452716938, "last_edit_date": 1495541046, "question_id": 34776444, "link": "https://stackoverflow.com/questions/34776444/range-of-pointer-values-on-64-bit-systems", "title": "Range of pointer values on 64 bit systems", "body": "<p>Recently I was reading about the small string optimization (SSO): <a href=\"https://stackoverflow.com/questions/21694302/what-are-the-mechanics-of-short-string-optimization-in-libc\">What are the mechanics of short string optimization in libc++?</a>. As we know, a string typically consists of 3 pointers, which is 24 bytes on a 64 bit system. The linked answer says that in libc++'s implementation, the very first bit of the first pointer is used to indicate whether the string is in \"long\" or \"short\" mode, i.e. heap allocation and external storage vs internal storage of up to some 22 characters.</p>\n\n<p>This however assumes however that the first bit of the first pointer cannot ever meaningfully be part of the address, because whenever the string is in \"long\" mode, that bit will always be set (or unset, depending which convention was chosen). This seems reasonable on its face, since with 64 bit pointers that allows 2^64 addresses, larger than 1 followed by 18 zeroes in bytes, or more than 1 billion gigabytes.</p>\n\n<p>So this is reasonable, though not certain. My question is: is this guaranteed somewhere? And if it is guaranteed, where is it guaranteed? By the architecture spec, or by something else? To take it a step further: how many bits is it safe to do this with? I have a vague recollection reading somewhere that only 48 bits are used, but I don't recall.</p>\n\n<p>If there are some number of bits, e.g. 8 or 16 that are guaranteed to be untouched, that is certainly something that could be leveraged in some interesting ways. It would be nice to exploit this, but not at the cost of having code mysteriously failure on some machine.</p>\n"}, {"tags": ["c", "doxygen"], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "edited": false, "score": 0, "creation_date": 1452723235, "post_id": 34777495, "comment_id": 57301164, "body": "Thanks, but I do wish to make the whole file excluded from the Files list in the Doxygen documentation.  I use the /cond commands to ignore parts of files already, but there are some whole files that I wish to be excluded.  I can do this easily in the doxyfile, but the other contributors to the library would prefer for me to not modify the doxyfile."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "reply_to_user": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "edited": false, "score": 0, "creation_date": 1452731820, "post_id": 34777495, "comment_id": 57304399, "body": "@BigBobby Yes that is why I suggested just excluding everything in the file using the /cond. At least that way Doxygen would exit without putting anything in to the system. If you made the /cond and /endcon the first and last lines in the file, what would happen? I do not have access to Doxygen now so I can only answer theoretically."}, {"owner": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "edited": false, "score": 0, "creation_date": 1452873724, "post_id": 34777495, "comment_id": 57372177, "body": "When I made the /cond and /endcon the first and last lines in the file, it still showed up in the Files list but the page for that file is blank."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "reply_to_user": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "edited": false, "score": 0, "creation_date": 1452881616, "post_id": 34777495, "comment_id": 57376604, "body": "@BigBobby OK thanks. Google did show certain methods but most of them involved .text or .doxy files. Otherwise it mentioned the EXCLUDE specification which you sted you cannot add to the doxyfile. Does the doxyfile have an INCLUDE specification or is it set to globally include everything?"}, {"owner": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "edited": false, "score": 1, "creation_date": 1452974026, "post_id": 34777495, "comment_id": 57404445, "body": "After I proved it was impossible with tags in the code, I was allowed to change the doxyfile."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "reply_to_user": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "edited": false, "score": 0, "creation_date": 1452987996, "post_id": 34777495, "comment_id": 57408443, "body": "@BigBobby OK that should be good. May you have sucess in the project."}], "tags": [], "owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "is_accepted": false, "score": 0, "last_activity_date": 1553601342, "last_edit_date": 1553601342, "creation_date": 1452720945, "answer_id": 34777495, "question_id": 34776315, "link": "https://stackoverflow.com/questions/34776315/doxygen-special-command-to-ignore-a-file/34777495#34777495", "title": "doxygen special command to ignore a file", "body": "<p><a href=\"http://www.doxygen.nl/manual/faq.html\" rel=\"nofollow noreferrer\">How can I make doxygen ignore some code fragment?</a> shows how this can be done. You would put the \\cond at the start and \\endcond at the end. Also see <a href=\"https://stackoverflow.com/questions/14337003/how-to-comment-out-comment-in-doxygen-documentation\">How to comment out comment in Doxygen documentation</a></p>\n\n<p>Note that while the file would still be included, the contents of that file would be ignored.</p>\n\n<blockquote>\n  <p>How can I make doxygen ignore some code fragment?</p>\n  \n  <p>The new and easiest way is to add one comment block with a \\cond\n  command at the start and one comment block with a \\endcond command at\n  the end of the piece of code that should be ignored. This should be\n  within the same file of course.</p>\n  \n  <p>But you can also use Doxygen's preprocessor for this: If you put</p>\n\n<pre><code>#ifndef DOXYGEN_SHOULD_SKIP_THIS\n\n /* code that must be skipped by Doxygen */\n\n#endif /* DOXYGEN_SHOULD_SKIP_THIS */\n</code></pre>\n  \n  <p>around the blocks that should be hidden and put:</p>\n\n<pre><code>  PREDEFINED = DOXYGEN_SHOULD_SKIP_THIS\n</code></pre>\n  \n  <p>in the config file then all blocks should be skipped by Doxygen as\n  long as <a href=\"http://www.doxygen.nl/manual/config.html#cfg_enable_preprocessing\" rel=\"nofollow noreferrer\">ENABLE_PREPROCESSING</a> is set to YES.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 433, "user_id": 4636860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh4.googleusercontent.com/-3_OR-OP6KQk/AAAAAAAAAAI/AAAAAAAAAKQ/eADyoX0Q3lM/photo.jpg?sz=128", "display_name": "Avamander", "link": "https://stackoverflow.com/users/4636860/avamander"}, "edited": false, "score": 0, "creation_date": 1499859286, "post_id": 34919532, "comment_id": 77086079, "body": "How would you go about and exclude multiple folders with totally different relative paths?"}], "tags": [], "owner": {"reputation": 635, "user_id": 2010398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnCdn.png?s=128&g=1", "display_name": "gmug", "link": "https://stackoverflow.com/users/2010398/gmug"}, "is_accepted": false, "score": 6, "last_activity_date": 1453367740, "creation_date": 1453367740, "answer_id": 34919532, "question_id": 34776315, "link": "https://stackoverflow.com/questions/34776315/doxygen-special-command-to-ignore-a-file/34919532#34919532", "title": "doxygen special command to ignore a file", "body": "<p>You can't ignore a file by a special command, but you can exclude files from the documentation in the Doxygen configuration file (generally called Doxyfile) by adding the static or relative path to the file which shall be exculded to the <code>EXCLUDE</code> tag, e.g.:</p>\n\n<pre><code>EXCLUDE =  ./../lib/stdio.h\n</code></pre>\n\n<p>This way you can also exclude whole directories from the documentation:</p>\n\n<pre><code>EXCLUDE =  ./../lib\n</code></pre>\n\n<p>You can also use the <code>EXCLUDE_PATTERNS</code> tag and use wildcard patterns, e.g.:</p>\n\n<pre><code>EXCLUDE_PATTERNS = */test/*\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 10444, "user_id": 235472, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/2RJ8I.png?s=128&g=1", "display_name": "Pietro", "link": "https://stackoverflow.com/users/235472/pietro"}, "is_accepted": false, "score": 0, "last_activity_date": 1493819324, "creation_date": 1493819324, "answer_id": 43761970, "question_id": 34776315, "link": "https://stackoverflow.com/questions/34776315/doxygen-special-command-to-ignore-a-file/43761970#43761970", "title": "doxygen special command to ignore a file", "body": "<p>BigBobby: \"since many people contribute to this library I'd prefer to avoid modifying the doxyfile.\"  </p>\n\n<p>Consider that you can have multiple doxyfiles in the same project. You could copy the one already available, add what you need, and save it with a different name (e.g. doxyfile_BigBobby). </p>\n\n<p>In particular, I usually put two doxyfiles in the projects, one for the end-user documentation (with just the interfaces), and one for the developers.</p>\n"}], "owner": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7256, "favorite_count": 2, "answer_count": 3, "score": 7, "last_activity_date": 1553601342, "creation_date": 1452716520, "question_id": 34776315, "link": "https://stackoverflow.com/questions/34776315/doxygen-special-command-to-ignore-a-file", "title": "doxygen special command to ignore a file", "body": "<p>I am adding code to a large library that is documented with Doxygen.  I wish for some of the files to not be included in the Doxygen documentation.</p>\n\n<p>The doxyfile contains many controls to include and exclude specific files, but since many people contribute to this library I'd prefer to avoid modifying the doxyfile.</p>\n\n<p>Are there any special commands that I can put into the files themselves, that instructs Doxygen to ignore the whole file?</p>\n"}, {"tags": ["c", "file", "dynamic", "malloc", "realloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1452716182, "post_id": 34776201, "comment_id": 57297597, "body": "what is that <code>char *strcat(text, buffer); </code> line?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452716527, "post_id": 34776201, "comment_id": 57297774, "body": "Your <code>calloc()</code> is wrong for 2. 1. You need to allocate 1 extra byte for the terminating <code>nul</code> byte. 2. You don&#39;t really need <code>calloc()</code> you need <code>malloc()</code>."}, {"owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452716612, "post_id": 34776201, "comment_id": 57297826, "body": "<a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_strcat.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_function_strcat.htm</a> .Am i using this completely wrong ?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452718755, "post_id": 34776571, "comment_id": 57299006, "body": "Thank you very much just for putting on the effort .This works almost perfect but from what i can see it only displays some part of the whole text ,in the txt file i have a text about 600 chars and it will only display 300 or something. I find this strange cause since it works and the buffer is 100c , why would it get stuck in such a number ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452719032, "post_id": 34776571, "comment_id": 57299137, "body": "@begginer3 I ran this source code through the program and it read and wrote the whole thing.  The way it&#39;s printing, it outputs one character per line, so it might be difficult to see.  Try taking out the <code>\\n</code> in the <code>printf</code> at the end and see what the output looks like."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1452719053, "post_id": 34776571, "comment_id": 57299145, "body": "There are a number of issues with this attempt.  (1) No error checking.  (2) long input lines are a problem. (3) main signature is wrong"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1452719354, "post_id": 34776571, "comment_id": 57299288, "body": "@JohnHascall Long lines aren&#39;t a problem.  The next call to <code>fgets</code> will pick up where it left off.  I tested with lines longer that 100 characters and it still works.  I did change the <code>main</code> signature and added errors checks to <code>fopen</code> and <code>calloc</code>/<code>realloc</code>."}, {"owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1452719381, "post_id": 34776571, "comment_id": 57299296, "body": "@JohnHascall could you please elaborate so I can fix them ?"}, {"owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452719521, "post_id": 34776571, "comment_id": 57299354, "body": "@dbush YOU ARE RIGHT .THANK YOU VERY MUCH AND HAVE A NICE DAY. its caps cause I am happy ."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452719842, "post_id": 34776571, "comment_id": 57299503, "body": "@begginer3 Glad I could help.  Feel free to <a href=\"http://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1452722865, "post_id": 34776571, "comment_id": 57300982, "body": "I think you have most of them fixed.  One remaining issue is (quoting the Linux man page) <code>... fgets() and gets() functions do not distinguish between end-of-file and error, and callers must use feof(3) and ferror(3) to determine which occurred.</code>"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1452719434, "last_edit_date": 1452719434, "creation_date": 1452717442, "answer_id": 34776571, "question_id": 34776201, "link": "https://stackoverflow.com/questions/34776201/why-wont-this-work-dynamic-memory-beginner-program/34776571#34776571", "title": "Why won&#39;t this work ? Dynamic memory beginner program", "body": "<p>There are a few issues:</p>\n\n<pre><code>char *strcat(text, buffer);\n</code></pre>\n\n<p>This is not how you call a function.  This is a function declaration, and an incorrect one at that since it doesn't define the types of the arguments.</p>\n\n<p>To call <code>strcat</code>, just do this:</p>\n\n<pre><code>strcat(text, buffer);\n</code></pre>\n\n<p>Next, you're not allocating enough space for your buffers:</p>\n\n<pre><code>text =calloc(bufflen,sizeof(char));\n</code></pre>\n\n<p>You need to add space for the null bytes that terminates the string:</p>\n\n<pre><code>text =calloc(bufflen + 1,sizeof(char));\n</code></pre>\n\n<p>Similarly here:</p>\n\n<pre><code>text =realloc(text,bufflen*sizeof(char));\n</code></pre>\n\n<p>This only reallocates a total of <code>bufflen</code> bytes.  It does not add <code>bufflen</code> bytes to what was already allocated, and <code>bufflen</code> is unchanged from when it was first set outside of the <code>while</code> loop.  Do this instead:</p>\n\n<pre><code>bufflen = strlen(buffer);\ntext =realloc(text,bufflen+fullbufflen+1);\n</code></pre>\n\n<p>This gives you enough space for the current length, the additional buffer, and the null byte.</p>\n\n<p>Finally, make sure you <code>fclose(in)</code> and <code>free(text)</code> at the end to clean up your resources, and be sure to check the return value of <code>fopen</code> to ensure that the file opened successfully, and <code>realloc</code>/<code>calloc</code> to ensure that your allocations worked.</p>\n\n<p>After the above changes, you code should look like this:</p>\n\n<pre><code>int main(void)\n{\n    //FILE *out = fopen(\"keimeno.txt\", \"w+\");\n\n    FILE *in = fopen(\"keimeno.txt\", \"r\");\n    if (in == NULL) {\n        perror(\"open failed\");\n        exit(1);\n    }\n    int fullbufflen=0 , i;\n\n    char buffer[100];\n    fgets(buffer, 100, in);\n\n    int bufflen = strlen(buffer);\n    char *text;\n    text =calloc(bufflen+1,sizeof(char));\n    if (text == NULL) {\n        perror(\"calloc failed\");\n        exit(1);\n    }\n    strcat(text, buffer);\n//  printf(\"line of \\\"keimeno.txt\\\": %s\", buffer);\n//  printf(\"size of line \\\"keimeno.txt\\\": %i\\n\\n\", bufflen);\n\n    fullbufflen = bufflen;\n\n    while(fgets(buffer, 100, in)!=NULL)\n    {\n    //  printf(\"line of \\\"keimeno.txt\\\": %s\", buffer);\n    //  printf(\"size of line \\\"keimeno.txt\\\": %i\\n\\n\", bufflen);\n        bufflen = strlen(buffer);\n        text =realloc(text,bufflen+fullbufflen+1);\n        if (text == NULL) {\n            perror(\"realloc failed\");\n            exit(1);\n        }\n        strcat(text, buffer);\n\n        fullbufflen = bufflen + fullbufflen ;\n    }\n    fclose(in);\n    for (i = 0;i&lt;fullbufflen;i++)\n    {\n        printf(\"%c\\n\",text[i]);\n    }\n    free(text);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452721598, "post_id": 34776943, "comment_id": 57300362, "body": "thanks for the effort but i feel like this would seems to much to my professor cause we have not touched at all some of the stuff you have been using. Thanks anyway."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "reply_to_user": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452723201, "post_id": 34776943, "comment_id": 57301146, "body": "Yes, if this is an assignment, you should definitely turn in your own work, but feel free to pick up some pointers for your future assignments: (1) Check for Errors, (2) Use the proper variable types, (3) Don&#39;t stick &#39;magic&#39; numbers in your code, use #defines, (4) White space aids in readability, (5) Compile with warnings turn ON"}, {"owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452724404, "post_id": 34776943, "comment_id": 57301660, "body": "thanks for the advice , but what would you mean with &#39;magic&#39; numbers ,give me an example so i can fix it."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "reply_to_user": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "edited": false, "score": 0, "creation_date": 1452731248, "post_id": 34776943, "comment_id": 57304244, "body": "Pretty much any number besides 0, 1 and infinity is &quot;magic&quot; number. Imagine reading through somebody else&#39;s code and seeing <code>ipy = 1512;</code> that&#39;s a magic number. What does it mean? Who knows? But if you see <code>ipy = INNINGS_PER_YEAR;</code> then that starts to make some sense as soon as you see it."}], "tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": false, "score": 0, "last_activity_date": 1452718905, "creation_date": 1452718905, "answer_id": 34776943, "question_id": 34776201, "link": "https://stackoverflow.com/questions/34776201/why-wont-this-work-dynamic-memory-beginner-program/34776943#34776943", "title": "Why won&#39;t this work ? Dynamic memory beginner program", "body": "<p>Here is one possible solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\n\n#define ERR     (-1) \n#define GROW    100\n\n\nstatic void die ( const char * msg ) { perror(msg); exit(1); }\n\n\nint main ( void ) {\n\n        char *  filename        = \"in.txt\";\n        size_t  buffSize        = 0;\n        size_t  buffUsed        = 0;\n        ssize_t bytesRead       = 0;\n        char *  buffer          = NULL;\n        char *  tmp;\n        int     fd;\n\n        fd = open(filename, O_RDONLY, 0);\n        if (fd == ERR) die(\"open\");\n\n        do {\n                buffUsed += (size_t)bytesRead;\n                if (buffUsed == buffSize) {\n                        tmp = realloc(buffer, buffSize += GROW);\n                        if (tmp == NULL) die(\"realloc\");\n                        buffer = tmp;\n                }\n                bytesRead = read(fd, buffer + buffUsed, buffSize - buffUsed);\n                if (bytesRead == ERR) die(\"read\");\n        } while (bytesRead &gt; 0);\n\n        if (write(STDOUT_FILENO, buffer, buffUsed) == ERR) die(\"write\");\n        free(buffer);\n        if (close(fd) == ERR) die(\"close\");\n\n        return 0;\n}\n</code></pre>\n\n<p>Like the original, the input filename is hard-coded which sub-optimal...</p>\n"}], "owner": {"reputation": 13, "user_id": 5786370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900e7a8acb64c99ebcb3787140fd821?s=128&d=identicon&r=PG&f=1", "display_name": "begginer3", "link": "https://stackoverflow.com/users/5786370/begginer3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 34776571, "answer_count": 2, "score": -3, "last_activity_date": 1452719434, "creation_date": 1452716123, "last_edit_date": 1452716964, "question_id": 34776201, "link": "https://stackoverflow.com/questions/34776201/why-wont-this-work-dynamic-memory-beginner-program", "title": "Why won&#39;t this work ? Dynamic memory beginner program", "body": "<pre><code>int main()\n{   \n    //FILE *out = fopen(\"keimeno.txt\", \"w+\");\n\n    FILE *in = fopen(\"keimeno.txt\", \"r\");\n    int fullbufflen=0 , i;\n\n    char buffer[100];\n    fgets(buffer, 100, in);\n\n    int bufflen = strlen(buffer);\n    char *text;\n    text =calloc(bufflen,sizeof(char));\n    char *strcat(text, buffer); \n    //  printf(\"line of \\\"keimeno.txt\\\": %s\", buffer);\n    //  printf(\"size of line \\\"keimeno.txt\\\": %i\\n\\n\", bufflen);\n\n    fullbufflen = bufflen;  \n\n    while(fgets(buffer, 100, in)!=NULL)\n    {         \n        //  printf(\"line of \\\"keimeno.txt\\\": %s\", buffer);\n        //  printf(\"size of line \\\"keimeno.txt\\\": %i\\n\\n\", bufflen);\n        text =realloc(text,bufflen*sizeof(char));\n        char *strcat(text, buffer);\n\n        fullbufflen = bufflen + fullbufflen ;\n    }\n    for (i = 0;i&lt;fullbufflen;i++)\n    {\n        printf(\"%c\\n\",text[i]);\n    }\n}\n</code></pre>\n\n<p>I am trying to copy the full text file (keimeno.txt) into a dynamic memory array, with a buffer of 100 character at most everytime. To test it at the end i tried to prinf the results. And i just cant get it to work. Dont know if there is a problem on the printf at the end, or the whole program is just wrong.</p>\n\n<p>Also the dynamic array is supposed to have 0 size at the beggining, so if someone could tell me how to do that too, it would be welcome.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "gcc", "compiler-warnings", "implicit-conversion"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1452714151, "post_id": 34775374, "comment_id": 57296428, "body": "IMO: errant warning, a bug.  It complains about <code>return (RGBA&gt;&gt;24) &amp; 0xFF</code>, but not <code>return (RGBA&gt;&gt;24) &amp; 0xFE</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1452714334, "post_id": 34775374, "comment_id": 57296539, "body": "The above code compiles clean on gcc 4.8.3."}, {"owner": {"reputation": 23354, "user_id": 113586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/57c59ffcc95bda165de61b15e9864e65?s=128&d=identicon&r=PG", "display_name": "wRAR", "link": "https://stackoverflow.com/users/113586/wrar"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1452714429, "post_id": 34775374, "comment_id": 57296592, "body": "@dbush with <code>-Wconversion</code>, I assume?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1452714557, "post_id": 34775374, "comment_id": 57296674, "body": "Correction:  with -Wconversion gcc 4.8.3 <b>does</b> show the same problem.  It does <i>not</i> appear in gcc 4.1.2."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1452714570, "post_id": 34775374, "comment_id": 57296685, "body": "Looks related to <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=40752\" rel=\"nofollow noreferrer\">this bug report</a> ... <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67764\" rel=\"nofollow noreferrer\">this one looks closer</a>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1452714584, "post_id": 34775374, "comment_id": 57296693, "body": "It&#39;s just plain buggy. Shifting an unsigned 32 bit value to the right by 24 guarantees a result in the range 0 to 255; the AND-ing with 255 is unnecessary.  If the AND is present, the shift is irrelevant: the uint32_t value that is being converted to unsigned char is the AND-ed one, which is in the range 0 to 255.    Without the AND, we would expect the smaller shift to produce a warning; shifting right 23 bits caps the result to 511, so it potentially doesn&#39;t fit."}, {"owner": {"reputation": 23354, "user_id": 113586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/57c59ffcc95bda165de61b15e9864e65?s=128&d=identicon&r=PG", "display_name": "wRAR", "link": "https://stackoverflow.com/users/113586/wrar"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1452714887, "post_id": 34775374, "comment_id": 57296868, "body": "@ShafikYaghmour please make it an answer"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1452717911, "creation_date": 1452717911, "answer_id": 34776683, "question_id": 34775374, "link": "https://stackoverflow.com/questions/34775374/why-24-causes-wconversion-but-23-doesnt/34776683#34776683", "title": "Why &gt;&gt;24 causes -Wconversion but &gt;&gt;23 doesn&#39;t?", "body": "<p>As mentioned by Shafik Yaghmour, this appears to be a bug in GCC:</p>\n\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=40752\" rel=\"nofollow\">GCC Bug 40752: -Wconversion generates false warnings for operands not larger than target type</a></p>\n\n<p>It appears to have been present since version 4.4.0, first reported on 2009-07-14, and has 5 duplicates.  Based on the comments in the bug report, there seems to be some debate on how to handle it.</p>\n"}, {"comments": [{"owner": {"reputation": 23354, "user_id": 113586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/57c59ffcc95bda165de61b15e9864e65?s=128&d=identicon&r=PG", "display_name": "wRAR", "link": "https://stackoverflow.com/users/113586/wrar"}, "edited": false, "score": 0, "creation_date": 1549004261, "post_id": 54451671, "comment_id": 95756094, "body": "This is not answering the question."}, {"owner": {"reputation": 592, "user_id": 2077198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbaYP.jpg?s=128&g=1", "display_name": "vvaltchev", "link": "https://stackoverflow.com/users/2077198/vvaltchev"}, "reply_to_user": {"reputation": 23354, "user_id": 113586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/57c59ffcc95bda165de61b15e9864e65?s=128&d=identicon&r=PG", "display_name": "wRAR", "link": "https://stackoverflow.com/users/113586/wrar"}, "edited": false, "score": 0, "creation_date": 1549062559, "post_id": 54451671, "comment_id": 95783129, "body": "@wRAR I know that. I just wanted to offer a workaround. I should have added a comment, probably."}], "tags": [], "owner": {"reputation": 592, "user_id": 2077198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FbaYP.jpg?s=128&g=1", "display_name": "vvaltchev", "link": "https://stackoverflow.com/users/2077198/vvaltchev"}, "is_accepted": false, "score": -1, "last_activity_date": 1548894625, "creation_date": 1548894625, "answer_id": 54451671, "question_id": 34775374, "link": "https://stackoverflow.com/questions/34775374/why-24-causes-wconversion-but-23-doesnt/54451671#54451671", "title": "Why &gt;&gt;24 causes -Wconversion but &gt;&gt;23 doesn&#39;t?", "body": "<p>At least with <code>gcc</code> <code>5.4</code>, <code>6.x</code> and <code>7.x</code> this issue has a simple work-around using a cast:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nunsigned char f(uint32_t RGBA)\n{\n  return (unsigned char) ((RGBA&gt;&gt;24) &amp; 0xFF);\n}\n</code></pre>\n"}], "owner": {"reputation": 23354, "user_id": 113586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/57c59ffcc95bda165de61b15e9864e65?s=128&d=identicon&r=PG", "display_name": "wRAR", "link": "https://stackoverflow.com/users/113586/wrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 34776683, "answer_count": 2, "score": 10, "last_activity_date": 1548894625, "creation_date": 1452713249, "last_edit_date": 1452714620, "question_id": 34775374, "link": "https://stackoverflow.com/questions/34775374/why-24-causes-wconversion-but-23-doesnt", "title": "Why &gt;&gt;24 causes -Wconversion but &gt;&gt;23 doesn&#39;t?", "body": "<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nunsigned char f(uint32_t RGBA)\n{\n  return (RGBA&gt;&gt;24) &amp; 0xFF;\n}\n</code></pre>\n\n<p>When compiled with <code>-Wconversion</code> it causes \"warning: conversion to \u2018unsigned char\u2019 from \u2018uint32_t {aka unsigned int}\u2019 may alter its value [-Wconversion]\". If I lower the shift value to 23 or less the warning disappears.</p>\n\n<p>I've looked through the C99 standard and I don't understand what happens here. If I remove the <code>&amp;</code> operator then the warning is always emitted and that is probably good, as the result of the expression (after integer promotions) is larger than <code>unsigned char</code>. My only idea is that the warning is omitted for smaller shifts only because gcc is smart and sees that the result is 8-bit anyway, as the standard doesn't make this a special case. Am I right here?</p>\n\n<p>And why does the shift value matter? Is that a GCC bug? Clang seems to not produce the warning for any shift values.</p>\n\n<p>I'm using GCC 5.3.1 on a 64-bit Linux system.</p>\n"}, {"tags": ["c", "string", "printf"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1556255644, "post_id": 34775168, "comment_id": 98382730, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10285596/how-to-store-the-resulting-formatted-c-string\">How to store the resulting formatted C string</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1452713183, "last_edit_date": 1452713183, "creation_date": 1452712570, "answer_id": 34775179, "question_id": 34775168, "link": "https://stackoverflow.com/questions/34775168/get-formatted-string-to-a-variable/34775179#34775179", "title": "get formatted string to a variable", "body": "<p>Yes, the function you're lokng for is <a href=\"http://linux.die.net/man/3/sprintf\" rel=\"nofollow\"><code>sprintf()</code>/<code>snprintf()</code></a>.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a77.21.6.5, <em>The <code>snprintf()</code> function</em></p>\n\n<blockquote>\n  <p><code>int snprintf(char * restrict s, size_t n, const char * restrict format, ...);</code></p>\n  \n  <p>The <code>snprintf</code> function is equivalent to <code>fprintf</code>, except that the output is written into\n  an array (specified by argument <code>s</code>) rather than to a stream.</p>\n</blockquote>\n\n<p>It writes the formatted string into the array supplied as the first argument to it.</p>\n\n<p>FWIW, these function do not handle the allocation (or checking, for that matter) of memory to the supplied buffer (array). While passing the array, you need to make sure the destination is long enough to hold the final result.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 4, "last_activity_date": 1452712600, "creation_date": 1452712600, "answer_id": 34775186, "question_id": 34775168, "link": "https://stackoverflow.com/questions/34775168/get-formatted-string-to-a-variable/34775186#34775186", "title": "get formatted string to a variable", "body": "<p>Use <code>sprintf</code>:</p>\n\n<pre><code>sprintf( var, \"this is %s\", \"a message\" );\n</code></pre>\n\n<p>Note that <code>var</code> must be big enough to store the final string (including the string terminator).  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452713463, "post_id": 34775192, "comment_id": 57295984, "body": "&quot;snprintf is safer&quot; hmmmm, Without showing how to detect an incomplete write, <code>char buf[8]; snprintf(buf, sizeof buf, &quot;del %s&quot;, &quot;c:\\\\junk.txt&quot;); cmd(buf);</code> does not appear safe"}, {"owner": {"reputation": 77, "user_id": 5778697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b7db94d3bc25846096a2877a0645798?s=128&d=identicon&r=PG&f=1", "display_name": "tvaz", "link": "https://stackoverflow.com/users/5778697/tvaz"}, "edited": false, "score": 0, "creation_date": 1452713487, "post_id": 34775192, "comment_id": 57296004, "body": "All answers were good, but this one was brief, gave an example and linked to documentation. Thanks!"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452713700, "post_id": 34775192, "comment_id": 57296153, "body": "@chux, that&#39;s what the documentation is for. The only thing you need to do is to check the return value. &quot;Notice that only when this returned value is non-negative and less than <code>n</code>, the string has been completely written.&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452714443, "post_id": 34775192, "comment_id": 57296603, "body": "This answer mentions &quot;safer&quot;.  The documentation does not.  IMO &quot;safer&quot; here is unsupported without demonstrating proper usage - hence the comment."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452715101, "post_id": 34775192, "comment_id": 57296995, "body": "@chux, no problem, I&#39;ve added some explanation (which&#39;s bigger than the answer itself)."}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": true, "score": 5, "last_activity_date": 1452715044, "last_edit_date": 1592644375, "creation_date": 1452712622, "answer_id": 34775192, "question_id": 34775168, "link": "https://stackoverflow.com/questions/34775168/get-formatted-string-to-a-variable/34775192#34775192", "title": "get formatted string to a variable", "body": "<p>You want either <code>sprintf</code> either <code>snprintf</code>:</p>\n<h2>Usage</h2>\n<pre><code>char str[128];\n\n//sprintf(str, &quot;hello %s&quot;, &quot;world&quot;);\nsnprintf(str, 128, &quot;hello %s&quot;,  &quot;world&quot;);\n</code></pre>\n<p>Note that <code>snprintf</code> is safer since it will cut the string to appropriate length of encountered overflow.</p>\n<h2>Documentation</h2>\n<ul>\n<li><a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_sprintf.htm\" rel=\"nofollow noreferrer\"><code>sprintf</code></a></li>\n<li><a href=\"http://www.cplusplus.com/reference/cstdio/snprintf/\" rel=\"nofollow noreferrer\"><code>snprintf</code></a></li>\n</ul>\n<hr />\n<h2>Why is <code>snprintf</code> safe</h2>\n<blockquote>\n<p><code>snprintf</code> writes output to the string <code>str</code>, under control of the format string format, that specifies how subsequent arguments are converted for output. It is similar to <code>sprintf(3)</code>, except that <code>size</code> specifies the maximum number of characters to produce. The trailing nul character is counted towards this limit, so you must allocate at least <code>size</code> characters for <code>str</code>.</p>\n<p>If <code>size</code> is zero, nothing is written and str may be null. Otherwise, output characters beyond the <code>n-1</code>st are discarded rather than being written to <code>str</code>, and a nul character is written at the end of the characters actually written to <code>str</code>. If copying takes place between objects that overlap, the behaviour is undefined.</p>\n<p>On success, returns the number of characters that would have been written had size been sufficiently large, not counting the terminating nul character. Thus, the nul-terminated output has been completely written if and only if the return value is nonnegative and less than size. On error, returns -1 (i.e. encoding error).</p>\n</blockquote>\n<p>That is, <code>snprintf</code> protects programmers from buffer overruns, while <code>sprintf</code> doesn't.</p>\n"}], "owner": {"reputation": 77, "user_id": 5778697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b7db94d3bc25846096a2877a0645798?s=128&d=identicon&r=PG&f=1", "display_name": "tvaz", "link": "https://stackoverflow.com/users/5778697/tvaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4361, "favorite_count": 1, "accepted_answer_id": 34775192, "answer_count": 3, "score": 2, "last_activity_date": 1452715044, "creation_date": 1452712514, "last_edit_date": 1452712903, "question_id": 34775168, "link": "https://stackoverflow.com/questions/34775168/get-formatted-string-to-a-variable", "title": "get formatted string to a variable", "body": "<p>Is there any C function (or a way) to get a formatted string as a normal string?</p>\n\n<p>For example:</p>\n\n<pre><code>printf(\"this is %s\", \"a message\")\n</code></pre>\n\n<p>I want <code>printf()</code>s output <code>\"this is a message\"</code> in a <code>char*</code> variable. This should be simple but I'm not coming with something besides write it to a file and read it or concatenate as many times as needed. </p>\n\n<p>So, is there a function or an easy way to put any formatted string into a single string variable in C?</p>\n"}, {"tags": ["c", "pointers", "casting", "dereference"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3681498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545c94e731a20f96425869d921baabcc?s=128&d=identicon&r=PG", "display_name": "DL-902", "link": "https://stackoverflow.com/users/3681498/dl-902"}, "edited": false, "score": 0, "creation_date": 1452713208, "post_id": 34774942, "comment_id": 57295809, "body": "Thanks.  What about the * after the volatile type qualifier? I&#39;ve seen that before, but don&#39;t understand its purpose."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 21, "user_id": 3681498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545c94e731a20f96425869d921baabcc?s=128&d=identicon&r=PG", "display_name": "DL-902", "link": "https://stackoverflow.com/users/3681498/dl-902"}, "edited": false, "score": 0, "creation_date": 1452713525, "post_id": 34774942, "comment_id": 57296042, "body": "<code>unsigned long volatile *</code> is a declaration specifier for type <i>pointer to <code>unsigned long volatile int</code></i>."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1452712423, "last_edit_date": 1452712423, "creation_date": 1452711749, "answer_id": 34774942, "question_id": 34774888, "link": "https://stackoverflow.com/questions/34774888/type-casting-pointer-dereference/34774942#34774942", "title": "Type casting pointer dereference", "body": "<blockquote>\n  <ol>\n  <li>Am I correctly calling this a type casting pointer dereference?  </li>\n  </ol>\n</blockquote>\n\n<p>Yes.  </p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>It types casts addr and then derefences it? Or the other way around? Does it matter?</li>\n  </ol>\n</blockquote>\n\n<p>The <code>*(unsigned long volatile *)(addr)</code> is typecasting <code>addr</code> and then dereferencing it.  </p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Does order matter for type qualifiers and type specifiers?  </li>\n  </ol>\n</blockquote>\n\n<p>No. Order doesn't matter. C11 section \u00a76.7.2/2  </p>\n\n<blockquote>\n  <p>[...] the type specifiers may occur in any order, possibly\n  intermixed with the other declaration specifiers. [...]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1452712511, "creation_date": 1452712511, "answer_id": 34775166, "question_id": 34774888, "link": "https://stackoverflow.com/questions/34774888/type-casting-pointer-dereference/34775166#34775166", "title": "Type casting pointer dereference", "body": "<p>The cast <code>(unsigned long volatile *)(addr)</code> happens before the dereferencing.</p>\n\n<p>And no, the order of the words <code>unsigned</code>, <code>long</code>, and <code>volatile</code> does not matter <em>as long as no further operators are mixed in</em>. I. e. <code>volatile int*</code> and <code>int volatile*</code> are the same, but <code>int * volatile</code> is something different.</p>\n\n<p>On a high level, the purpose of this macro is to take any pointer, and read the first four bytes from that memory address.</p>\n\n<p><strong>However, this invokes undefined behavior</strong> if the pointer that's passed to <code>mem32</code> is neither a pointer to <code>long</code> or <code>char</code>! This is due to strict aliasing rules. Older compilers used to safely generate the intended code for this macro, but modern compilers may just optimize the code using that macro away if they prove a type mismatch. So, don't use this in new code.</p>\n"}], "owner": {"reputation": 21, "user_id": 3681498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545c94e731a20f96425869d921baabcc?s=128&d=identicon&r=PG", "display_name": "DL-902", "link": "https://stackoverflow.com/users/3681498/dl-902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1452712511, "creation_date": 1452711545, "question_id": 34774888, "link": "https://stackoverflow.com/questions/34774888/type-casting-pointer-dereference", "title": "Type casting pointer dereference", "body": "<p>Sorting through a retired engineers code and I encountered a fairly simple macro, but my C knowledge isn't great.</p>\n\n<pre><code>#define mem32(addr) (*(unsigned long volatile *)(addr)) \n</code></pre>\n\n<ol>\n<li>Am I correctly calling this a type casting pointer dereference?  </li>\n<li>It types casts <em>addr</em> and then derefences it?  Or the other way around?  Does it matter?</li>\n<li>Does order matter for type qualifiers and type specifiers?  I had assumed (before this) type qualifiers had to precede type specifiers, but that must not be the case</li>\n<li>Syntax question.  What's the purpose of the 2nd * ?</li>\n</ol>\n"}, {"tags": ["c", "embedded", "constants"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1452711515, "post_id": 34774695, "comment_id": 57294822, "body": "Look at the differences in the <code>map</code> file. And report back :)"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1452714665, "post_id": 34774695, "comment_id": 57296743, "body": "please provide a more complete example, just enough to show the problem."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1452715982, "post_id": 34775677, "comment_id": 57297491, "body": "<code>const</code>-qualified objects are not necessarily stored in read-only memory. Consider <code>const int r = rand();</code>."}], "tags": [], "owner": {"reputation": 116, "user_id": 5760595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1331d49c394178ccf03545c368594e6?s=128&d=identicon&r=PG&f=1", "display_name": "toast", "link": "https://stackoverflow.com/users/5760595/toast"}, "is_accepted": false, "score": 0, "last_activity_date": 1452714312, "creation_date": 1452714312, "answer_id": 34775677, "question_id": 34774695, "link": "https://stackoverflow.com/questions/34774695/is-there-difference-between-these-two-expressions/34775677#34775677", "title": "Is there difference between these two expressions?", "body": "<p>consts are stored in read only memory - my guess is you are just shifting where the data is.  Hard to say 100% without seeing more information.</p>\n"}, {"tags": [], "owner": {"reputation": 26010, "user_id": 613064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3e1ee346c5ef622fa76114bdbb26c728?s=128&d=identicon&r=PG", "display_name": "Simon Richter", "link": "https://stackoverflow.com/users/613064/simon-richter"}, "is_accepted": false, "score": 3, "last_activity_date": 1452715013, "creation_date": 1452715013, "answer_id": 34775885, "question_id": 34774695, "link": "https://stackoverflow.com/questions/34774695/is-there-difference-between-these-two-expressions/34775885#34775885", "title": "Is there difference between these two expressions?", "body": "<p>There is a difference between data definitions declared <code>const</code>, and regular <code>const</code>ness, in that it becomes undefined behaviour (at least in C++) if you cast away the <code>const</code> from an object that was defined with the qualifier.</p>\n\n<p>Outside of language-lawyering, the rationale is obvious: we want these as part of the read-only image, while still permitting both people who know what they are doing to use <code>const_cast</code>, because there are <a href=\"http://digital.ni.com/public.nsf/ad0f282819902a1986256f79005462b1/5ff49186e691a2d8862579b8005f94b8/$FILE/visa.h\" rel=\"nofollow\">good reasons</a> for that as well.</p>\n\n<p>In C, we have pretty much the same motivation: put constants into read-only memory, but allow casts to work. When the qualifier is attached to the type, that is not a strong guarantee that the user intended the variable to go to read-only memory, so the compiler may err on the side of caution here.</p>\n"}, {"comments": [{"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "edited": false, "score": 0, "creation_date": 1452757740, "post_id": 34777866, "comment_id": 57312316, "body": "Yes, I found that this is a compiler specific issue. It interprets a constant to be placed in flash(ROM) memory. The real issue here is that in this compiler a <code>const</code> appears to be a specifically &#39;per variable&#39; declaration. It doesn&#39;t propagate through a type. So I kind of wasted your time, which I am sorry about. Anyway thank you all."}], "tags": [], "owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "is_accepted": true, "score": 4, "last_activity_date": 1452722276, "creation_date": 1452722276, "answer_id": 34777866, "question_id": 34774695, "link": "https://stackoverflow.com/questions/34774695/is-there-difference-between-these-two-expressions/34777866#34777866", "title": "Is there difference between these two expressions?", "body": "<p>There is some amount of freedom that the compiler can take in interpreting these declarations, but, in general, here is the difference:</p>\n\n<ul>\n<li><p>The <code>typedef</code> \"says\": this is a type that is always <code>const</code>, meaning there is no \"legal\" way to take away the <code>const</code>-nes of <em>any</em> variable of this type. Whenever you pass data of this type or pointers to it, they will be const. Sure, casting \"works\", but only to another type, and may lead to Undefined Behavior.</p></li>\n<li><p>The <code>const</code> data \"says\": This data is <code>const</code>, but, other data of this type may not be, so, at least some amount of \"taking away <code>const</code>-nes\" is OK between variables and pointers of this type. Of course, if someone casts pointer to this data to non-const and it is indeed in read-only memory, we're in trouble.</p></li>\n</ul>\n\n<p>So, the bottom line is the same, but there is a subtle difference. How the compiler interprets that is really up to the compiler. It may very well be that the <code>typedef</code> is very rare (it is in my experience), so the compiler is optimised for the more common case.</p>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 4, "accepted_answer_id": 34777866, "answer_count": 3, "score": 13, "last_activity_date": 1526868863, "creation_date": 1452710839, "last_edit_date": 1526868863, "question_id": 34774695, "link": "https://stackoverflow.com/questions/34774695/is-there-difference-between-these-two-expressions", "title": "Is there difference between these two expressions?", "body": "<p>Since my compiler gives different statistics for these two pieces of code, I am wondering what makes them different, if at all?</p>\n\n<p>First one:</p>\n\n<pre><code>typedef const struct process_data\n{\n   uint8_t *name;\n   void (*p_func)(void);\n} process_data_t;\n\nprocess_data_t processes = {15,16};\n</code></pre>\n\n<p>And the second one is:</p>\n\n<pre><code>typedef struct process_data\n{\n   uint8_t *name;\n   void (*p_func)(void);\n} process_data_t;\n\nconst process_data_t processes = {15,16};\n</code></pre>\n\n<p>Note that <code>const</code> qualifier has moved from typedefing to the definition of the structure. For me there is no difference between the two excerpts, but the compiler/linker statistic shows that less flash memory (the platform is a microcontroller with constrained resources) is consumed when the second piece of code is used.</p>\n"}, {"tags": ["c", "filesystems", "comments"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1452710785, "post_id": 34774641, "comment_id": 57294341, "body": "First you need to learn about conditions and how they work. And learn the difference between assignment <code>=</code> and comparison for equality <code>==</code>."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1452710785, "post_id": 34774641, "comment_id": 57294342, "body": "What the heck is <code>c=&#39;&#47;&#39; &amp;&amp; &#39;*&#39;</code>? That makes no sense at all. You&#39;re trying to compare <code>c</code> to multiple values, but it doesn&#39;t work like that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1452710947, "post_id": 34774641, "comment_id": 57294463, "body": "It&#39;s more complicated than you think. Comment indicators might be within a literal string, and the <code>&#47;&#47;</code> style might be commented out by the more important <code>&#47;* comment *&#47;</code>"}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1452711320, "post_id": 34774641, "comment_id": 57294711, "body": "&amp;&amp; means boolean AND the test for equality is == not =, Even if the line worked the way you think, it would always be false as you seem to test c against slash AND asterix AND new line which is impossible. You need to check against slash set a flag and check if the next character is asterix Then verify that there is a new line before the end of the comment (*/) Also see the comment below about how // can span multiple lines and check that the /* is not inside a //"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1452711431, "post_id": 34774641, "comment_id": 57294776, "body": "Don&#39;t forget that a <code>&#47;&#47;comment</code> can span more than one line if it contains the line continuation symbol `\\` (although MSVC gives a warning about such a comment)."}], "answers": [{"tags": [], "owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "is_accepted": false, "score": 0, "last_activity_date": 1452712659, "creation_date": 1452712659, "answer_id": 34775204, "question_id": 34774641, "link": "https://stackoverflow.com/questions/34774641/comments-longer-than-one-line/34775204#34775204", "title": "comments longer than one line", "body": "<p>&amp;&amp; means boolean AND the test for equality is == not =, </p>\n\n<p>You would need to have each indicator tested individually.</p>\n\n<pre><code>if ((c == '/') &amp;&amp; (c == '*') &amp;&amp; (c == '\\n'))\n</code></pre>\n\n<p><strong>Of course this would always generate FALSE as it is an impossible statement.</strong></p>\n\n<p>Even if the line worked the way you think, it would always be false as you seem to test c against slash AND asterix AND new line which is impossible. You need to check against slash set a flag and check if the next character is asterix Then verify that there is a new line before the end of the comment (*/) </p>\n\n<p>// can span multiple lines and you need to check that the /* is not inside a // and vice versa.</p>\n"}], "owner": {"reputation": 21, "user_id": 5737673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068e5e123412a75db414747768116e74?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/5737673/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1452712659, "creation_date": 1452710667, "last_edit_date": 1452711629, "question_id": 34774641, "link": "https://stackoverflow.com/questions/34774641/comments-longer-than-one-line", "title": "comments longer than one line", "body": "<p>So I was wondering if this is right; I have to count the comments longer than one line in a file:</p>\n\n<pre><code>    void commentsLongerThanOneLine(FILE* inputStream, FILE* outputStream) {\nchar c;\nint i = 0;\nwhile ((c = fgetc(inputStream) != EOF)) {\n    if (c == '/' &amp;&amp; '*' &amp;&amp; '\\n') i++;\n}\nprintf(\"Number of comments longer than one line is : %d\\n\", i);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "pointers", "callback"], "comments": [{"owner": {"reputation": 1709, "user_id": 4325016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45f0a09185dea1c14428422310a022de?s=128&d=identicon&r=PG&f=1", "display_name": "George Houpis", "link": "https://stackoverflow.com/users/4325016/george-houpis"}, "edited": false, "score": 4, "creation_date": 1452710861, "post_id": 34774530, "comment_id": 57294404, "body": "It compiles because it is doing a cast of one function pointer type to another function pointer type.  You should make the change to your function.  And you should probably avoid using &#39;write&#39; to not conflict with the standard library write function."}, {"owner": {"reputation": 2414, "user_id": 5339529, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4ecd2b15539f40fea4bbb59864ad9fc0?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStudent", "link": "https://stackoverflow.com/users/5339529/foreverstudent"}, "edited": false, "score": 1, "creation_date": 1452711124, "post_id": 34774530, "comment_id": 57294580, "body": "what is malloc(sizeof(a));"}], "answers": [{"comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 3, "creation_date": 1452711703, "post_id": 34774673, "comment_id": 57294907, "body": "The first case doesn&#39;t incur into UB as long as the calling convention let to the caller the responsibility of clearing the stack (as in <code>__cdecl</code>) but wouldn&#39;t work with a different calling convention (eg <code>__stdcall</code>) in which the callee is responsible of stack."}], "tags": [], "owner": {"reputation": 2384, "user_id": 4624683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39130cd702675dc4f741e62e64479eb6?s=128&d=identicon&r=PG&f=1", "display_name": "DBug", "link": "https://stackoverflow.com/users/4624683/dbug"}, "is_accepted": false, "score": 2, "last_activity_date": 1452710767, "creation_date": 1452710767, "answer_id": 34774673, "question_id": 34774530, "link": "https://stackoverflow.com/questions/34774530/what-happens-when-you-declare-a-callback-with-wrong-amount-of-parameters-in-c/34774673#34774673", "title": "What happens when you declare a callback with wrong amount of parameters in C?", "body": "<p>It depends on which side the mismatch is on.  If the callback expects 1 param, but 2 are passed to it, the callback will read the first and ignore the second.  Since the caller is responsible for setting up and tearing down the call, there are no problems.</p>\n\n<p>But the reverse can give you undefined behavior.  If the callback expects 2 params, but the caller only thinks it needs 1, then the second will not have been set up, so it's value is \"undefined\" (whatever happens to be in the memory location for second param).</p>\n"}, {"tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": true, "score": 4, "last_activity_date": 1452711307, "creation_date": 1452711307, "answer_id": 34774836, "question_id": 34774530, "link": "https://stackoverflow.com/questions/34774530/what-happens-when-you-declare-a-callback-with-wrong-amount-of-parameters-in-c/34774836#34774836", "title": "What happens when you declare a callback with wrong amount of parameters in C?", "body": "<p>The standard C11 at \u00a76.3.2.3 specifies:</p>\n\n<blockquote>\n  <ol start=\"8\">\n  <li>A pointer to a function of one type <strong>may be converted to a pointer to a function of another type and back again</strong>; the result shall compare equal to the original pointer. <strong>If a converted pointer is used to call a function whose type is not compatible with the referenced type, the behavior is undefined</strong>.</li>\n  </ol>\n</blockquote>\n\n<p>So you are allowed to convert between function pointers of different types, but it is clearly stated that this brings undefined behavior if the call is not compatible with the referenced pointer.</p>\n"}], "owner": {"reputation": 55, "user_id": 5243857, "user_type": "registered", "profile_image": "https://graph.facebook.com/1035940719764154/picture?type=large", "display_name": "Diogo Fenilli de Souza", "link": "https://stackoverflow.com/users/5243857/diogo-fenilli-de-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 34774836, "answer_count": 2, "score": 4, "last_activity_date": 1452711307, "creation_date": 1452710348, "question_id": 34774530, "link": "https://stackoverflow.com/questions/34774530/what-happens-when-you-declare-a-callback-with-wrong-amount-of-parameters-in-c", "title": "What happens when you declare a callback with wrong amount of parameters in C?", "body": "<p>So, I'm implementing a functionality in the Company I work for, and I'm having some doubts about callbacks and function pointers. Here is an example code:</p>\n\n<pre><code>struct callback {\n    int (*func) (int *, int);\n};\n\nstatic struct callback cbstruct;\n\nvoid install_func(struct callback *cbstruct, int (*func) (int *, int))\n{\n    cbstruct-&gt;func = func;\n}\n\nint write(int *integ)\n{\n    return *integ;\n}\n\nint main() {\n    int * a = malloc(sizeof(a));\n    *a = 5;\n\n    install_func(&amp;cbstruct, write);\n\n    printf(\"%d\\n\", (cbstruct.func)(a,3));\n    return 0;\n}\n</code></pre>\n\n<p>As you can see, this program registers a callback for a structure using a function pointer. It is expected that the function receives two parameters (int* and int), but in the example code, the \"write\" function receives only an int *.</p>\n\n<p>I would expect it to give me a compilation error, but there's only a warning:</p>\n\n<pre><code>funcpointer.c:24:26: warning: passing argument 2 of \u2018install_func\u2019 from incompatible pointer type\ninstall_func(&amp;cbstruct, write);\n                          ^\nfuncpointer.c:10:6: note: expected \u2018int (*)(int *, int)\u2019 but argument is of type \u2018int (*)(int *)\u2019\nvoid install_func(struct callback *cbstruct, int (*func) (int *, int))\n     ^\n</code></pre>\n\n<p>This program apparently runs correctly, printing 5 on the screen, but I'm not sure if it is correctly written, considering the difference in parameters amount on definition and declaration.</p>\n\n<p>Why does it compile and work (apparently)? Is there an imminent problem by doing this? I'm not sure what happens to the second argument (3) that is called from main.</p>\n\n<p>I'm asking this question because I recently changed the signature of a callback (adding a parameter), and I was expecting to see many errors from where this callback was called, but I just got some warnings and the program continued to (apparently) run correctly.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1452710399, "post_id": 34774521, "comment_id": 57294084, "body": "are you asking how hex works?"}, {"owner": {"reputation": 63, "user_id": 2795300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6e7cba374ce14670baea9782273faeb?s=128&d=identicon&r=PG&f=1", "display_name": "HakBon", "link": "https://stackoverflow.com/users/2795300/hakbon"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452710453, "post_id": 34774521, "comment_id": 57294106, "body": "No, not really. I am just confused at to why it is outputting in hex. Apologies if it is too obvious - I am fairly new to coding."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452710563, "post_id": 34774521, "comment_id": 57294181, "body": "As others have pointed out by now -- it is outputting in hex because you asked it to output in hex (even if this wasn&#39;t your intention)."}, {"owner": {"reputation": 63, "user_id": 2795300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6e7cba374ce14670baea9782273faeb?s=128&d=identicon&r=PG&f=1", "display_name": "HakBon", "link": "https://stackoverflow.com/users/2795300/hakbon"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452710666, "post_id": 34774521, "comment_id": 57294262, "body": "Yes - I got it now. I didn&#39;t know that %x or %name is different than %i. Many thanks"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2795300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6e7cba374ce14670baea9782273faeb?s=128&d=identicon&r=PG&f=1", "display_name": "HakBon", "link": "https://stackoverflow.com/users/2795300/hakbon"}, "edited": false, "score": 1, "creation_date": 1452710714, "post_id": 34774553, "comment_id": 57294290, "body": "thank you - I didn&#39;t know the difference the letter following % could cause."}, {"owner": {"reputation": 36528, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "reply_to_user": {"reputation": 63, "user_id": 2795300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6e7cba374ce14670baea9782273faeb?s=128&d=identicon&r=PG&f=1", "display_name": "HakBon", "link": "https://stackoverflow.com/users/2795300/hakbon"}, "edited": false, "score": 0, "creation_date": 1452710887, "post_id": 34774553, "comment_id": 57294429, "body": "And a shameless plug: if you don&#39;t want to worry about format specifiers use something like <a href=\"https://github.com/cppformat/cppformat\" rel=\"nofollow noreferrer\">github.com/cppformat/cppformat</a>"}], "tags": [], "owner": {"reputation": 36528, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "is_accepted": false, "score": 2, "last_activity_date": 1452710422, "creation_date": 1452710422, "answer_id": 34774553, "question_id": 34774521, "link": "https://stackoverflow.com/questions/34774521/why-does-c-code-return-numbers-greater-than-10-as-letters/34774553#34774553", "title": "Why does C code return numbers greater than 10 as letters?", "body": "<p><code>x</code> in <code>%x</code> is a <a href=\"https://en.wikipedia.org/wiki/Hexadecimal\" rel=\"nofollow\">hexadecimal</a> format specifier and <code>a</code> is 10 in hexadecimal. This has nothing to do with doubles. If you want to print a decimal number use <code>%d</code>:</p>\n\n<pre><code>printf(\"Input: %d\\n\", mins);\n</code></pre>\n\n<p>See also <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow\">printf documentation</a> for more details on format specifiers.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1452710581, "last_edit_date": 1452710581, "creation_date": 1452710437, "answer_id": 34774560, "question_id": 34774521, "link": "https://stackoverflow.com/questions/34774521/why-does-c-code-return-numbers-greater-than-10-as-letters/34774560#34774560", "title": "Why does C code return numbers greater than 10 as letters?", "body": "<p>The <code>%x</code> format specifier tells <code>printf</code> to output the given integer value in hexadecimal.</p>\n\n<p>If you want the output to be decimal, use <code>%d</code>.</p>\n\n<p>Also, you need to make sure that each format specifier is given an argument of the proper type.  So <code>%d</code>, <code>%x</code>, and %u<code>require an</code>int<code>, while</code>%f<code>required a</code>double`.  Using the wrong format specifier results in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>For more details, see the man page for <a href=\"http://man7.org/linux/man-pages/man3/printf.3.html\" rel=\"nofollow\">printf</a></p>\n"}, {"tags": [], "owner": {"reputation": 217, "user_id": 5006046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6339ab54443403b4b03e26478f4807bc?s=128&d=identicon&r=PG&f=1", "display_name": "adengle", "link": "https://stackoverflow.com/users/5006046/adengle"}, "is_accepted": true, "score": 1, "last_activity_date": 1452710510, "last_edit_date": 1452710510, "creation_date": 1452710471, "answer_id": 34774573, "question_id": 34774521, "link": "https://stackoverflow.com/questions/34774521/why-does-c-code-return-numbers-greater-than-10-as-letters/34774573#34774573", "title": "Why does C code return numbers greater than 10 as letters?", "body": "<p>You are asking <code>printf()</code> to represent the numbers as <a href=\"https://en.wikipedia.org/wiki/Hexadecimal\" rel=\"nofollow\">hexadecimal</a>.</p>\n\n<p>Try using <code>%d</code> or <code>%i</code> instead of <code>%x</code>. This will show them as decimal numbers.</p>\n"}], "owner": {"reputation": 63, "user_id": 2795300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6e7cba374ce14670baea9782273faeb?s=128&d=identicon&r=PG&f=1", "display_name": "HakBon", "link": "https://stackoverflow.com/users/2795300/hakbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 34774573, "answer_count": 3, "score": -6, "last_activity_date": 1452710581, "creation_date": 1452710331, "question_id": 34774521, "link": "https://stackoverflow.com/questions/34774521/why-does-c-code-return-numbers-greater-than-10-as-letters", "title": "Why does C code return numbers greater than 10 as letters?", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n\n    int mins = 10;\n    int formu = 6 * mins;\n\n    printf(\"Input: %x\\n\", mins);\n    printf(\"Result: %x\\n\", formu);\n}\n</code></pre>\n\n<p>Which results in the following:</p>\n\n<pre><code>Input: a\nResult: 3c\n</code></pre>\n\n<p>I believe for some reason, one of the types, if not both, is being generated as a \"Double\" and putting in an \"Int\" is causing a conflict.When I change either of the \"%x\" to \"mins\" or \"formu\" I get the following error:</p>\n\n<pre><code>error: data argument not used by format string [-Werror,-Wformat-extra-args]\n    printf(\"Input: %mins\\n\", mins);\n           ~~~~~~~~~~~~~~~~  ^\n</code></pre>\n\n<ul>\n<li>why is compiler assuming that I want a double?</li>\n<li>Is that the reason why numbers greater than 10 are resulting in a letter conversion?</li>\n</ul>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "pointers", "allocation", "memory-address"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 1, "creation_date": 1452710174, "post_id": 34774322, "comment_id": 57293921, "body": "@SergeyK.: No, I don&#39;t think it&#39;s a duplicate. No pointer is being incremented. The code is just examining the addresses of declared objects."}, {"owner": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452710499, "post_id": 34774322, "comment_id": 57294138, "body": "@KeithThompson However, the underlying machinery is the same and the explanation is fully applicable to this case."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 3, "creation_date": 1452710662, "post_id": 34774322, "comment_id": 57294259, "body": "@SergeyK.: I disagree. For <code>pointer ++</code>, the relationship is well defined. There is no defined relationship between the addresses of two separately defined objects. The addresses of <code>char x;</code> and <code>char y;</code> could easily differ by 4, for example -- or by 42."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 1, "creation_date": 1452711183, "post_id": 34774322, "comment_id": 57294622, "body": "@SergeyK.: How is this a duplicate? There is no use of <code>++</code> or any other pointer arithmetic in this question."}, {"owner": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452716448, "post_id": 34774322, "comment_id": 57297738, "body": "@KeithThompson: the question already has an answer there <a href=\"http://stackoverflow.com/q/5610298/1065190\">stackoverflow.com/q/5610298/1065190</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 3, "creation_date": 1452717395, "post_id": 34774322, "comment_id": 57298282, "body": "@SergeyK.: You already said that. I&#39;m saying this question is not a duplicate of that one. The other question asks about <code>++</code> on pointers. This one does not; it&#39;s not about pointer arithmetic at all. (There might be other reasons to close this question, but not as a duplicate of a question about <code>++</code>.)"}, {"owner": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452721038, "post_id": 34774322, "comment_id": 57300095, "body": "@KeithThompson The closing reason is explicit and says &quot;This question already has an answer here&quot;. It does not say anything if the question is duplicate or not."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 0, "creation_date": 1452722816, "post_id": 34774322, "comment_id": 57300961, "body": "@SergeyK.: Which answer to the linked question is an answer to <i>this</i> question? (IMHO, none of them.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452723323, "post_id": 34774322, "comment_id": 57301204, "body": "Hmm? Are you saying you were asking the same question as the one about <code>++</code> on pointers? I really don&#39;t think you were."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452726634, "post_id": 34774322, "comment_id": 57302615, "body": "A pointer contains a single address. Whether it&#39;s the address of a <code>char</code> or of an <code>int</code> depends on the type of the address. In C, an &quot;address&quot; is a value of pointer type. And addresses are not integers. On the other hand, each of the 4 (for example) bytes making up an <code>int</code> object is itself an object with its own unique address."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452730739, "post_id": 34774322, "comment_id": 57304106, "body": "Again: <b>In C</b>, an &quot;address&quot; is a value of pointer type. The word &quot;address&quot; is used in other ways in other contexts."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 1, "creation_date": 1471424781, "post_id": 34774322, "comment_id": 65336622, "body": "After <code>foo</code> ends, the value of <code>g_ptr</code> becomes indeterminate as the lifetime of <code>x</code> is over: <code>g_ptr</code> has value <code>&amp;x</code> which is now an invalid address. So use of <code>g_ptr</code> value produces undefined behavior after <code>foo</code> ends."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1471424967, "post_id": 34774322, "comment_id": 65336736, "body": "@SurajJain; I rollbacked to original question. Your edit made all the answers on this post invalid. If you have any other question then please ask in another post."}, {"owner": {"user_type": "does_not_exist", "display_name": "anon"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 0, "creation_date": 1471425712, "post_id": 34774322, "comment_id": 65337201, "body": "@SergeyK. Please Check The Question Again"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1471449711, "post_id": 34774322, "comment_id": 65354420, "body": "@SurajJain as haccks mentioned, do not change a question that has answers, ask a new question."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1471458084, "post_id": 34774322, "comment_id": 65359084, "body": "@SurajJain I&#39;m not the downvoters and I didn&#39;t follow this question, so I can just guess: one of these: duplicate, lack of research, bad quality question or total change of question after answers. Ask the downvoters."}, {"owner": {"user_type": "does_not_exist", "display_name": "anon"}, "reply_to_user": {"reputation": 23368, "user_id": 1065190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b5b64fdadd0d82da3cd3b9dafe7b6bb?s=128&d=identicon&r=PG", "display_name": "Sergey K.", "link": "https://stackoverflow.com/users/1065190/sergey-k"}, "edited": false, "score": 0, "creation_date": 1485864108, "post_id": 34774322, "comment_id": 71092765, "body": "@SergeyK. How is the question duplicate ?"}, {"owner": {"reputation": 4875, "user_id": 1144624, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c640c2471d507b73b93d5cb34eaebfed?s=128&d=identicon&r=PG", "display_name": "Kcvin", "link": "https://stackoverflow.com/users/1144624/kcvin"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1486052752, "post_id": 34774322, "comment_id": 71190468, "body": "I agree with @KeithThompson."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1452710883, "post_id": 34774445, "comment_id": 57294422, "body": "I&#39;m not sure what you mean by that. A <code>char</code> object is allocated exactly 1 byte. An <code>int</code> object is allocated <code>sizeof (int)</code> bytes. Objects can be allocated in any order, and there may or may not be extra padding between them."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 1, "creation_date": 1452711124, "post_id": 34774445, "comment_id": 57294581, "body": "I don&#39;t understand what you mean. An address of type <code>int*</code> refers to the location of an <code>int</code> object. That object occupies <code>sizeof (int)</code> bytes, typically 4. But when you print the value of a pointer, it typically reflects the address of the first byte of the object it points to. Is there some particular problem you&#39;re trying to solve here? In my opinion your question is not a duplicate."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1452711256, "post_id": 34774445, "comment_id": 57294667, "body": "@SurajJain: Sure, a pointer to an N-byte type will point to an N-byte object."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 1, "creation_date": 1452711515, "post_id": 34774445, "comment_id": 57294821, "body": "@SurajJain: An <code>int*</code> contains the address of an <code>int</code> object. If you convert an <code>int*</code> value to <code>char*</code>, the result contains the address of the first byte of the <code>int</code> object."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 1, "creation_date": 1452715919, "post_id": 34774445, "comment_id": 57297455, "body": "The type of a pointer tells you what type of object it points to. An <code>int*</code> points to an <code>int</code> object. You might want to read section 4 of the <a href=\"http://www.c-faq.com/\" rel=\"nofollow noreferrer\">comp.lang.c FAQ</a>."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1452731285, "post_id": 34774445, "comment_id": 57304255, "body": "@SurajJain: An pointer don&#39;t &quot;contain one byte only&quot;, it holds a value, which  is the address <i>of the start</i> of an object. An object can only start at one address, regardless of it&#39;s size.  If a pointer points at an int, then everyone knows it points at a the start of an int. If you increment it, it will then point at the subsequent int. All pointers point &quot;at the start&quot; of an object. That&#39;s what computer addresses are."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1452732574, "post_id": 34774445, "comment_id": 57304632, "body": "@SurajJain: No, a pointer holds the address of the start of an object.  Nothing to do with 1 byte.  An int takes several bytes, and the pointer points at the start of that block of bytes. (It&#39;s not always four bytes).  In a BE system, the MSB will be in the first byte, in a LE system, the LSB will be in the first byte."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452735184, "post_id": 34774445, "comment_id": 57305426, "body": "Ok, so that&#39;s the source of the confusion. You used C code in your question, and in C an &quot;address&quot; is a (typed) pointer value. In machine terms, an &quot;address&quot; typically designates a single byte. The address of a 4-byte object is the same as the address of the <i>first</i> of those 4 bytes. If that base address is, say, 1000, then addresses 1001, 1002, and 1003 will designate successive bytes within that 4-byte object."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1452807640, "post_id": 34774445, "comment_id": 57343739, "body": "@SurajJain: Ah, the compiler sets aside 4 <i>bytes</i> of memory. If you print each of these bytes individually, you&#39;ll get the bytes that make up the integer. The order of these bytes is different on each architecture. Sometimes it even changes while the machine is running. But an object will always be saved using consecutive bytes."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1485762348, "post_id": 34774445, "comment_id": 71042305, "body": "@SurajJain: I didn&#39;t downvote your question. Don&#39;t ask me why others did."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 3, "last_activity_date": 1452710137, "creation_date": 1452710137, "answer_id": 34774445, "question_id": 34774322, "link": "https://stackoverflow.com/questions/34774322/how-is-memory-allocated-to-variables-of-different-data-types/34774445#34774445", "title": "How is Memory Allocated to variables of different data types?", "body": "<p>There are no requirements on the order in which declared objects are laid out in memory. Apparently the compiler you're using happens to place <code>x</code> and <code>y</code> next to each other. It <em>could</em> have placed <code>j</code> between them, but it didn't.</p>\n\n<p>Also, the correct way to print a pointer value is to use the <code>%p</code> format and convert the pointer value to <code>void*</code>:</p>\n\n<pre><code>printf(\"%p\\n\", (void*)j);\nprintf(\"%p\\n\", (void*)t);\n</code></pre>\n\n<p>This produces an implementation-defined human-readable representation of the pointer value, typically but not always in hexadecimal.</p>\n\n<p>If you <em>care</em> about the order in which declared variables are allocated in memory, you're probably doing something wrong, or at least not useful. Let the compiler worry about where to put things. It knows what it's doing.</p>\n"}, {"tags": [], "owner": {"reputation": 5962, "user_id": 92601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c926671d6565f7a1070a2a25edc09881?s=128&d=identicon&r=PG", "display_name": "stonemetal", "link": "https://stackoverflow.com/users/92601/stonemetal"}, "is_accepted": false, "score": 2, "last_activity_date": 1452710144, "creation_date": 1452710144, "answer_id": 34774447, "question_id": 34774322, "link": "https://stackoverflow.com/questions/34774322/how-is-memory-allocated-to-variables-of-different-data-types/34774447#34774447", "title": "How is Memory Allocated to variables of different data types?", "body": "<p>Well for starters the difference isn't always four, it just happens to be four by happy coincidence.  The compiler is allowed to stick variables in memory where ever it wants to.  In this case it has put your two variables next to each other in memory and the difference can be explained as that is how big an integer is on your system(4 bytes) and how big a character is on your system(1 byte).  On other systems they may be different sizes and placed in different locations.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "anon"}, "edited": false, "score": 0, "creation_date": 1452731155, "post_id": 34774463, "comment_id": 57304215, "body": "What will happen if i printed value at addresses which lie in between them ?"}, {"owner": {"reputation": 111, "user_id": 5779285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fb6766832cf4aacb45cfd8294e192b?s=128&d=identicon&r=PG&f=1", "display_name": "Ira Rodens", "link": "https://stackoverflow.com/users/5779285/ira-rodens"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1452736879, "post_id": 34774463, "comment_id": 57305972, "body": "You will get the individual bytes composing the number. For example if the int value is 1, then it would 0x00000001 in hex which would break down into the following char array 0x00,0x00,0x00,0x01."}], "tags": [], "owner": {"reputation": 111, "user_id": 5779285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fb6766832cf4aacb45cfd8294e192b?s=128&d=identicon&r=PG&f=1", "display_name": "Ira Rodens", "link": "https://stackoverflow.com/users/5779285/ira-rodens"}, "is_accepted": false, "score": 1, "last_activity_date": 1452710189, "creation_date": 1452710189, "answer_id": 34774463, "question_id": 34774322, "link": "https://stackoverflow.com/questions/34774322/how-is-memory-allocated-to-variables-of-different-data-types/34774463#34774463", "title": "How is Memory Allocated to variables of different data types?", "body": "<p>Each integer takes up four bytes, therefore, each integer memory address is offset by 4. A char only takes up one byte, therefore its memory addresses are offset by one.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2146, "favorite_count": 1, "accepted_answer_id": 34774445, "answer_count": 3, "score": -2, "last_activity_date": 1501241055, "creation_date": 1452709701, "last_edit_date": 1501241055, "question_id": 34774322, "link": "https://stackoverflow.com/questions/34774322/how-is-memory-allocated-to-variables-of-different-data-types", "title": "How is Memory Allocated to variables of different data types?", "body": "<p>I wrote the following Code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int x = 1 ;\n    int *j = &amp;x ;\n    int y =  2 ;\n    int *t = &amp;y ;\n\n    printf(\"%p\\n\" , (void *)j);\n    printf(\"%p\" , (void *)t);\n}   \n</code></pre>\n\n<p>Output is <code>0028FF14 0028FF10</code>. </p>\n\n<p>The Point I want to make is that the difference between the addresses is `4'.</p>\n\n<p>Whereas in this case  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    char x = 't' ;\n    char *j = &amp;x ;\n    char y =  'f' ;\n    char *t = &amp;y ;\n    printf(\"%p\\n\" , (void *)j);\n    printf(\"%p\" , (void *)t);    \n\n   }   \n</code></pre>\n\n<p>Output is  <code>0028FF17 0028FF16</code></p>\n\n<p>The difference is <code>1</code>.</p>\n\n<p>Difference In First Case is <code>4</code>. Whereas in the second case it is <code>1</code>. Why is it so?  </p>\n\n<p>And What will I get if I printed value at all memory addresses individually?  </p>\n\n<p>Maybe It is really general and known, but I just started C, So the output of the program confuses me.</p>\n\n<p><strong>Update</strong><br>\nNow Using <code>%p</code> format and converted the pointer value to <code>void*</code> to print the pointer value as suggested by Keith Thompson.</p>\n"}, {"tags": ["c", "macos", "compilation", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "edited": false, "score": 0, "creation_date": 1452710873, "post_id": 34774081, "comment_id": 57294415, "body": "Thanks for your answer. I tried both <code>-std=c89</code> and <code>-std=c90</code> but it still fail in both cases."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "edited": false, "score": 0, "creation_date": 1452711128, "post_id": 34774081, "comment_id": 57294584, "body": "You still get all those warnings? Another option is <code>-std=gnu89</code>. If not, you can do declarations for the functions. That&#39;s all you need really to fix them properly."}, {"owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "edited": false, "score": 0, "creation_date": 1452711323, "post_id": 34774081, "comment_id": 57294712, "body": "I don&#39;t get the same warnings but I still get the same errors. Same with <code>-std=gnu89</code>. So I suppose, I will just have to edit the synthax of the code by myself, right?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "edited": false, "score": 0, "creation_date": 1452711792, "post_id": 34774081, "comment_id": 57294970, "body": "Yes. You need declarations for the functions."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1452708866, "creation_date": 1452708866, "answer_id": 34774081, "question_id": 34773972, "link": "https://stackoverflow.com/questions/34773972/how-should-i-compile-this-c-code/34774081#34774081", "title": "How should I compile this C code?", "body": "<p>Looks like the code doesn't conform to C99 with implicit function declrations, default return (int) etc.</p>\n\n<p>It doesn't seem to be hard to fix it. But if you don't want to or can't then you can attempt to compile in C89/C90 in which <em>implicit int</em> return is valid. This should fix most, if not all, of the warnings you get.</p>\n\n<pre><code>gcc -std=c89 -o fdist2 -O fdist.c -lm\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 5779285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fb6766832cf4aacb45cfd8294e192b?s=128&d=identicon&r=PG&f=1", "display_name": "Ira Rodens", "link": "https://stackoverflow.com/users/5779285/ira-rodens"}, "is_accepted": true, "score": 3, "last_activity_date": 1452709243, "creation_date": 1452709243, "answer_id": 34774190, "question_id": 34773972, "link": "https://stackoverflow.com/questions/34773972/how-should-i-compile-this-c-code/34774190#34774190", "title": "How should I compile this C code?", "body": "<p>The problem is not the compiler but the fact that your code does not follow the syntax. C99 requires that all variables and functions be declared ahead of time. Function and class definitions should be placed in a .h header file and then included in the .c source file in which they are referenced.</p>\n\n<p>i.e.</p>\n\n<p>mycode.h:</p>\n\n<p><code>int myFunction (int a, char * s);</code></p>\n\n<p>mycode.c</p>\n\n<pre><code>#include \"mycode.h\"\n\nint main(int argc, char **argv) {\n     int x = 2;\n     char * str = \"Hello\";\n     int r = myFunction(x,str);\n     return r;\n}\n</code></pre>\n"}], "owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1282, "favorite_count": 0, "accepted_answer_id": 34774190, "answer_count": 2, "score": 0, "last_activity_date": 1452709243, "creation_date": 1452708511, "question_id": 34773972, "link": "https://stackoverflow.com/questions/34773972/how-should-i-compile-this-c-code", "title": "How should I compile this C code?", "body": "<p>I downloaded <a href=\"http://www.maths.bris.ac.uk/~mamab/software/fdist2.zip\" rel=\"nofollow\">this source code (.zip)</a> and would like to compile it on my Mac (OSX 10.11.2) with an XCode Version 7.2 (7C68).</p>\n\n<p>I started to compile the file <code>fdist.c</code> with</p>\n\n<pre><code>gcc -o fdist2 -O fdist.c -lm\n</code></pre>\n\n<p>but it returns a long series of warnings and errors (see below). Looking at the file I see that indeed it does not quite look as the kind of code I am used to.  Typically, it appears that the type of object the functions returned are unspecified.</p>\n\n<p>The <code>README_fdist2</code> did not help much. There are guidelines on how to compile the code but there is a typo in the first line.</p>\n\n<p><strong>How should I compile this code?</strong></p>\n\n<hr>\n\n<p>Below are the errors and warnings the command <code>gcc -o fdist2 -O fdist.c -lm</code> returned</p>\n\n<pre><code>fdist2.c:42:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nmain()\n^\nfdist2.c:117:3: warning: implicit declaration of function 'sim1' is invalid in C99\n      [-Wimplicit-function-declaration]\n                sim1(init,initot,rm,mu,freq_arr,val_arr,&amp;noall);\n                ^\nfdist2.c:119:4: warning: implicit declaration of function 'my_thetacal' is invalid in C99\n      [-Wimplicit-function-declaration]\n                        my_thetacal(freq_arr,noall,init,Subs,&amp;h0,&amp;h1,&amp;fst);\n                        ^\nfdist2.c:136:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nsim1(init,initot,rm,mu,freq_arr,val_arr,noall)\n^\nfdist2.c:222:3: warning: implicit declaration of function 'dfill' is invalid in C99\n      [-Wimplicit-function-declaration]\n                dfill();\n                ^\nfdist2.c:234:4: warning: implicit declaration of function 'cnode' is invalid in C99\n      [-Wimplicit-function-declaration]\n                        cnode(k);\n                        ^\nfdist2.c:237:8: warning: implicit declaration of function 'mnode' is invalid in C99\n      [-Wimplicit-function-declaration]\n                else mnode(k); \n                     ^\nfdist2.c:252:1: warning: control may reach end of non-void function [-Wreturn-type]\n}\n^\nfdist2.c:254:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nthetacal(gen,noall,sample_size,no_of_samples,het0,het1,fst)\n^\nfdist2.c:293:1: warning: control reaches end of non-void function [-Wreturn-type]\n}\n^\nfdist2.c:301:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\ndfill()\n^\nfdist2.c:312:1: warning: control reaches end of non-void function [-Wreturn-type]\n}\n^\nfdist2.c:315:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\ncnode(sp)\n^\nfdist2.c:349:2: error: non-void function 'cnode' should return a value [-Wreturn-type]\n        return;\n        ^\nfdist2.c:353:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nmnode(sp)\n^\nfdist2.c:464:2: error: non-void function 'mnode' should return a value [-Wreturn-type]\n        return;\n        ^\nfdist2.c:489:10: warning: implicit declaration of function 'poidev' is invalid in C99\n      [-Wimplicit-function-declaration]\n        mutno = poidev(time*mu);\n                ^\nfdist2.c:491:12: warning: implicit declaration of function 'addmut' is invalid in C99\n      [-Wimplicit-function-declaration]\n                p-&gt;dna = addmut(p-&gt;dna);\n                         ^\nfdist2.c:676:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nmom(x,n,x1,x2,x3,x4,min,max)\n^\nfdist2.c:707:2: error: non-void function 'mom' should return a value [-Wreturn-type]\n        return;\n        ^\nfdist2.c:761:1: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]\nmy_thetacal(gen,noall,sample_size,no_of_samples,het0,het1,fst)\n^\n18 warnings and 3 errors generated.\n</code></pre>\n"}, {"tags": ["c", "linked-list", "stack"], "comments": [{"owner": {"reputation": 14400, "user_id": 4405757, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/96317f0778cae7e50548ce53e0029449?s=128&d=identicon&r=PG&f=1", "display_name": "user7", "link": "https://stackoverflow.com/users/4405757/user7"}, "edited": false, "score": 0, "creation_date": 1452707519, "post_id": 34773538, "comment_id": 57292296, "body": "Please tag this with a language (C/C++)"}, {"owner": {"reputation": 4301, "user_id": 423955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/21306ab5c55a1e70ae23991665941efe?s=128&d=identicon&r=PG", "display_name": "Alessandro Da Rugna", "link": "https://stackoverflow.com/users/423955/alessandro-da-rugna"}, "edited": false, "score": 0, "creation_date": 1452711865, "post_id": 34773538, "comment_id": 57295019, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14755068/understanding-stack-data-structure-and-implementing-it\">Understanding Stack Data Structure and Implementing it</a>"}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "is_accepted": false, "score": 0, "last_activity_date": 1452707741, "creation_date": 1452707741, "answer_id": 34773695, "question_id": 34773538, "link": "https://stackoverflow.com/questions/34773538/how-do-i-initialize-the-stack-using-linked-list/34773695#34773695", "title": "how do i initialize the stack using linked list", "body": "<p>In my humble opinion, you should follow this steps:</p>\n\n<p>1 - <a href=\"https://en.wikipedia.org/wiki/Data_structure\" rel=\"nofollow\">Learn data structures</a></p>\n\n<p>2 - <a href=\"https://en.wikibooks.org/wiki/Data_Structures/Stacks_and_Queues\" rel=\"nofollow\">Learn about stack and basic operations</a></p>\n\n<p>3 - <a href=\"http://www.tutorialspoint.com/cprogramming/c_pointers.htm\" rel=\"nofollow\">Learn pointers in C</a></p>\n\n<p>4 - <a href=\"http://inst.eecs.berkeley.edu/~selfpace/studyguide/9C.sg/Output/ADTs.in.C.html\" rel=\"nofollow\">Learn Abstract Data Types in C</a></p>\n\n<p>After this, build your Abstract Data Type using this Stack example and then code the basic operations: Push and Pop.</p>\n"}], "owner": {"reputation": 1, "user_id": 5785179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1192f6fec01a15f6a1e7dfac61b883?s=128&d=identicon&r=PG&f=1", "display_name": "MACK", "link": "https://stackoverflow.com/users/5785179/mack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1452708414, "creation_date": 1452707225, "last_edit_date": 1452708414, "question_id": 34773538, "link": "https://stackoverflow.com/questions/34773538/how-do-i-initialize-the-stack-using-linked-list", "title": "how do i initialize the stack using linked list", "body": "<p>How do I initialize the stack using the linked list with this statement?</p>\n\n<p>Hi, I'm new to IT world. I'm having a problem on how to start this code. We are only given with this structure:</p>\n\n<pre><code>typedef struct cell{\n   char elem;\n   struct cell * next;\n}*Stack;\n</code></pre>\n\n<p>we we're told to do the push, pop, top, initialize, empty and full.\nAs I was doing the INITIALIZE function, I was having a hard time since i am not used to the data type which is the \"*Stack\".</p>\n\n<p>can anybody help me with this.</p>\n"}, {"tags": ["c", "visual-studio-2015"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452708233, "post_id": 34773522, "comment_id": 57292723, "body": "I suggest starting a new project to get rid of old stuff. And don&#39;t rename a .c file .cpp unless it really is C++."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452708394, "post_id": 34773522, "comment_id": 57292816, "body": "I also suggest deleting <code>#include &quot;stdafx.h&quot;</code> and adding <code>#include &lt;stdio.h&gt;</code> and so on, as required. Unless your project takes an age to compile."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452708572, "post_id": 34773522, "comment_id": 57292895, "body": "Keep it simple. Make a &quot;Hello World&quot; program with two modules, one of which contains and/or prints that string. You don&#39;t need to make a DLL. The linker should combine the separate compilation units into a single .exe."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452708619, "post_id": 34773522, "comment_id": 57292924, "body": "@WeatherVane:  Thank you again.  If I don&#39;t <code>include &quot;stdafx.h&quot;</code> I get the following message: <code>Error\tC1010\tunexpected end of file while looking for precompiled header. Did you forget to add &#39;#include &quot;stdafx.h&quot;&#39; to your source?</code>  Otherwise it worked okay.  I just didn&#39;t know what I was doing."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "is_accepted": false, "score": 0, "last_activity_date": 1452708495, "creation_date": 1452708495, "answer_id": 34773964, "question_id": 34773522, "link": "https://stackoverflow.com/questions/34773522/trying-to-understand-simple-task-of-adding-files-to-vs-projects/34773964#34773964", "title": "Trying to understand simple task of adding files to VS projects", "body": "<p>I apologize for anyone wasting time on this question.  I just needed the necessary declarations in a header file, and the linker took care of the rest of it.</p>\n"}], "owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452708495, "creation_date": 1452707168, "last_edit_date": 1495540321, "question_id": 34773522, "link": "https://stackoverflow.com/questions/34773522/trying-to-understand-simple-task-of-adding-files-to-vs-projects", "title": "Trying to understand simple task of adding files to VS projects", "body": "<p>As I said before, I'm still learning.  Per the comments in <a href=\"https://stackoverflow.com/questions/34770370/getting-error-passing-a-pointer-to-file\">this previous post</a>, I'm trying to add a file into an existing project, rather than including it.  The source code is listed in the previous post.  I used <a href=\"https://msdn.microsoft.com/library/9f4t9t92(v=vs.100).aspx\" rel=\"nofollow noreferrer\">these instructions</a> to add the file to the project.  I renamed the include file from FilMst5.c to FilMst5.cpp to avoid the following error:</p>\n\n<p><code>C1853  'x64\\Debug\\CrtFil5.pch' precompiled header file is from a previous version of the compiler, or the precompiled header is C++ and you are using it from C (or vice versa)</code>   </p>\n\n<p>I also added <code>#include \"stdafx.h\"</code> to prevent another compile error message.  When I tried to compile the project files, I got 2 messages <code>'FilMstFilPtr': undeclared identifier</code> and another message <code>'Opn': identifier not found</code>.  So I know I'm doing something wrong, but I don't really understand how it's supposed to work in order to fix it.  Can someone tell me the correct way to do this?</p>\n\n<p>The C code previously compiled fine even though it has a .cpp extension, the way Visual Studio does things.</p>\n"}, {"tags": ["c", "csv", "file-io", "import-from-csv"], "comments": [{"owner": {"reputation": 93, "user_id": 5261572, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002028279282/picture?type=large", "display_name": "Frank Puk", "link": "https://stackoverflow.com/users/5261572/frank-puk"}, "edited": false, "score": 0, "creation_date": 1452706672, "post_id": 34773288, "comment_id": 57291756, "body": "Btw I tried different compliers on Linux and I still got the same error. So I don&#39;t think the above problem is related to the choice of compiler."}, {"owner": {"reputation": 499, "user_id": 5339899, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ebf68221eb3e8ff1037314f300217549?s=128&d=identicon&r=PG&f=1", "display_name": "TheQAGuy", "link": "https://stackoverflow.com/users/5339899/theqaguy"}, "edited": false, "score": 1, "creation_date": 1452706693, "post_id": 34773288, "comment_id": 57291776, "body": "read this post <a href=\"http://stackoverflow.com/q/5431941/5339899\">stackoverflow.com/q/5431941/5339899</a>"}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 1, "creation_date": 1452707370, "post_id": 34773288, "comment_id": 57292209, "body": "Please provide your CSV file. I ran you code with a CSV file created from the output and the program appeared to run as expected."}, {"owner": {"reputation": 93, "user_id": 5261572, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002028279282/picture?type=large", "display_name": "Frank Puk", "link": "https://stackoverflow.com/users/5261572/frank-puk"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1452707837, "post_id": 34773288, "comment_id": 57292489, "body": "Thank you @chqrlie for helping me re-format the code for further readability."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5261572, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002028279282/picture?type=large", "display_name": "Frank Puk", "link": "https://stackoverflow.com/users/5261572/frank-puk"}, "edited": false, "score": 0, "creation_date": 1452707282, "post_id": 34773380, "comment_id": 57292163, "body": "You are so right. The problem is solved after I reduce the value you specified by 1. Thank you ameyCU!"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 93, "user_id": 5261572, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002028279282/picture?type=large", "display_name": "Frank Puk", "link": "https://stackoverflow.com/users/5261572/frank-puk"}, "edited": false, "score": 0, "creation_date": 1452707370, "post_id": 34773380, "comment_id": 57292208, "body": "@FrankPuk Yes , that because you were writing at invalid memory location . If you declare an array of size <code>n</code> and you can access indices from <code>0</code> to <code>n-1</code> ."}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1452707409, "last_edit_date": 1452707409, "creation_date": 1452706775, "answer_id": 34773380, "question_id": 34773288, "link": "https://stackoverflow.com/questions/34773288/c-programming-reading-csv-file/34773380#34773380", "title": "C programming - Reading CSV file", "body": "<pre><code>sscanf(line, \"%f,%f,%f,%f,%[^\\n]\", &amp;feat[1][index], &amp;feat[2][index],\n         &amp;feat[3][index], &amp;feat[4][index], flowerType);\nprintf(\"%d. %f, %f, %f, %f, %s\\n\", ((int) index+1), feat[1][index], feat[2][index],\n         feat[3][index], feat[4][index], flowerType);\n</code></pre>\n\n<p>In these two line you access index out of bounds here <code>&amp;feat[4][index]</code>. This causes <em>undefined behaviour</em>. </p>\n\n<p>As declaration of array is </p>\n\n<pre><code> float feat[featSize][obsnsSize];     //where featSize is 4 \n</code></pre>\n\n<p><em>So you can access index from</em> <code>0</code> <em>to</em> <code>3</code> <em>not</em> <code>4</code> (<em>array indexing start from</em> <code>0</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 1, "last_activity_date": 1452774075, "last_edit_date": 1452774075, "creation_date": 1452707433, "answer_id": 34773594, "question_id": 34773288, "link": "https://stackoverflow.com/questions/34773288/c-programming-reading-csv-file/34773594#34773594", "title": "C programming - Reading CSV file", "body": "<p>A couple of things:</p>\n\n<ul>\n<li><p>Don't check on <code>feof</code>, check the return value <code>fgets()</code> instead.</p>\n\n<pre><code>while (!feof(fpDataFile)) {\n</code></pre></li>\n<li><p>Always check the return value of <code>sscanf()</code>.</p></li>\n<li><p>Your index should start at 0 instead of 1 (index 4 is out of bounds):</p>\n\n<pre><code>sscanf(line, \"%f,%f,%f,%f,%[^\\n]\",\n       &amp;feat[0][index], &amp;feat[1][index],\n       &amp;feat[2][index], &amp;feat[3][index], flowerType);\nprintf(\"%d. %f, %f, %f, %f, %s\\n\", ((int)index + 1),\n       feat[0][index], feat[1][index],\n       feat[2][index], feat[3][index], flowerType);\n</code></pre></li>\n<li><p>As @chqrlie stated: use <code>%19[^\\n]</code> to avoid overflow as <code>flowerType</code> size is only <code>20</code>:</p>\n\n<pre><code>sscanf(line, \"%f,%f,%f,%f,%19[^\\n]\",\n       &amp;feat[0][index], &amp;feat[1][index],\n       &amp;feat[2][index], &amp;feat[3][index], flowerType);\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452715384, "post_id": 34773932, "comment_id": 57297144, "body": "Better to use <code>&quot;%19[^\\n]&quot;</code> than <code>%[^\\n]</code> to prevent buffer overrun - although that still  does not <i>detect</i> extra text on the line."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1452756776, "post_id": 34773932, "comment_id": 57311858, "body": "Also do not use <code>while (!feof(fpDataFile))</code> in <code>checkObsnsSize()</code>, use <code>while (fgets(line, 1024, fpDataFile))</code> instead."}], "tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": false, "score": 1, "last_activity_date": 1452718120, "last_edit_date": 1452718120, "creation_date": 1452708362, "answer_id": 34773932, "question_id": 34773288, "link": "https://stackoverflow.com/questions/34773288/c-programming-reading-csv-file/34773932#34773932", "title": "C programming - Reading CSV file", "body": "<p>So to put it all together, the correct code looks like this:</p>\n\n<p>1- Use fgets() return value to determine when the file is completely read.<br>\n2- Read into arrays starting at index 0<br>\n3- Check return value of sscanf().<br></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint checkObsnsSize(char * dataFileName);\nvoid readIris ();\n\nint main () {\n    readIris();\n    return 0;\n}\n\nvoid readIris() {\n\n    int featSize = 4;\n\n    char *dataFileName = \"iris.data\";\n    int obsnsSize = checkObsnsSize(dataFileName);\n    float feat[featSize][obsnsSize];\n    int label[obsnsSize];\n    memset(feat, 0, featSize*obsnsSize*sizeof(float));\n    memset(label, 0, obsnsSize*sizeof(int));\n\n    printf(\"Obsns size is %d and feat size is %d.\\n\", obsnsSize, featSize);\n\n    FILE *fpDataFile = fopen(dataFileName,\"r\");\n\n    if (!fpDataFile) {\n        printf(\"Missing input file: %s\\n\", dataFileName);\n        exit(1);\n    }\n\n    int index = 0;\n    char line[1024]; char flowerType[20];\n\n    while (fgets(line, 1024, fpDataFile))\n    {\n        if( 5 == sscanf(line, \"%f,%f,%f,%f,%19[^\\n]\", &amp;feat[0][index], &amp;feat[1][index], &amp;feat[2][index], &amp;feat[3][index], flowerType))\n        {\n            printf(\"%d. %f, %f, %f, %f, %s\\n\", ((int) index+1), feat[0][index], feat[1][index], feat[2][index], feat[3][index], flowerType);\n            index++;\n        }\n    }\n    fclose(fpDataFile);\n}\n\nint checkObsnsSize(char * dataFileName) {\n\n    int obsnsSize = 0;\n    char line[1024];\n\n    FILE *fpDataFile = fopen(dataFileName,\"r\");\n    if (!fpDataFile) {\n            printf(\"Missing input file: %s\\n\", dataFileName);\n            exit(1);\n        }\n    while (!feof(fpDataFile)) {\n        fgets(line, 1024, fpDataFile);\n        obsnsSize++;\n    }\n    fclose(fpDataFile);\n    return obsnsSize;\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5261572, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002028279282/picture?type=large", "display_name": "Frank Puk", "link": "https://stackoverflow.com/users/5261572/frank-puk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3401, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1452774075, "creation_date": 1452706431, "last_edit_date": 1452719439, "question_id": 34773288, "link": "https://stackoverflow.com/questions/34773288/c-programming-reading-csv-file", "title": "C programming - Reading CSV file", "body": "<p>I currently have a problem of reading data from a CSV file.</p>\n\n<p>I think the code works almost fine. However, the printed output shows some weird characters as below (output 9-11).</p>\n\n<p>Do you have any idea on what is happening here? I just want to get rid of these weird characters so that I can process the imported data accordingly.</p>\n\n<p>Alternatively, if you have any feedback on my coding style, please share with me if you don't mind.</p>\n\n<p>Output:</p>\n\n<pre><code>Obsns size is 150 and feat size is 4.\n1. 5.100000, 3.500000, 1.400000, 0.200000, Iris-setosa\n2. 4.900000, 3.000000, 1.400000, 0.200000, Iris-setosa\n3. 4.700000, 3.200000, 1.300000, 0.200000, Iris-setosa\n4. 4.600000, 3.100000, 1.500000, 0.200000, Iris-setosa\n5. 5.000000, 3.600000, 1.400000, 0.200000, Iris-setosa\n6. 5.400000, 3.900000, 1.700000, 0.400000, Iris-setosa\n7. 4.600000, 3.400000, 1.400000, 0.300000, Iris-setosa\n8. 5.000000, 3.400000, 1.500000, 0.200000, Iris-setosa\n9. 4.400000, 2.900000, 1.400000, 0.200000, \ufffd\ufffdL&gt;-setosa\n10. 4.900000, 3.100000, 1.500000, 0.100000, Iris\ufffd\ufffd\ufffd=osa\n11. 5.400000, 3.700000, 1.500000, 0.200000, Iris-set\ufffd\ufffdL&gt;\n12. 4.800000, 3.400000, 1.600000, 0.200000, Iris-setosa\n13. 4.800000, 3.000000, 1.400000, 0.100000, Iris-setosa\n14. 4.300000, 3.000000, 1.100000, 0.100000, Iris-setosa\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint checkObsnsSize(char *dataFileName);\nvoid readIris();\n\nint main() {\n    readIris();\n    return 0;\n}\n\nvoid readIris() {    \n    int featSize = 4;\n    char *dataFileName = \"iris.data\";\n    int obsnsSize = checkObsnsSize(dataFileName);\n    float feat[featSize][obsnsSize];\n    int label[obsnsSize];\n    memset(feat, 0, featSize * obsnsSize * sizeof(float));\n    memset(label, 0, obsnsSize * sizeof(int));\n\n    printf(\"Obsns size is %d and feat size is %d.\\n\", obsnsSize, featSize);\n\n    FILE *fpDataFile = fopen(dataFileName, \"r\");   \n    if (!fpDataFile) {\n        printf(\"Missing input file: %s\\n\", dataFileName);\n        exit(1);\n    }\n\n    int index = 0;\n    while (!feof(fpDataFile)) {\n        char line[1024];\n        char flowerType[20];\n\n        fgets(line, 1024, fpDataFile);\n\n        sscanf(line, \"%f,%f,%f,%f,%[^\\n]\",\n               &amp;feat[1][index], &amp;feat[2][index],\n               &amp;feat[3][index], &amp;feat[4][index], flowerType);\n        printf(\"%d. %f, %f, %f, %f, %s\\n\", ((int)index + 1),\n               feat[1][index], feat[2][index],\n               feat[3][index], feat[4][index], flowerType);\n        index++;\n    }\n    fclose(fpDataFile);\n}\n\nint checkObsnsSize(char *dataFileName) {\n    int obsnsSize = 0;\n    char line[1024];\n\n    FILE *fpDataFile = fopen(dataFileName, \"r\");\n    if (!fpDataFile) {\n        printf(\"Missing input file: %s\\n\", dataFileName);\n        exit(1);\n    }\n    while (!feof(fpDataFile)) {\n        fgets(line, 1024, fpDataFile);\n        obsnsSize++;\n    }\n    fclose(fpDataFile);\n    return obsnsSize;\n}\n</code></pre>\n"}, {"tags": ["c", "random"], "comments": [{"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 3, "creation_date": 1452706478, "post_id": 34773242, "comment_id": 57291644, "body": "Function <code>int rand(void)</code> has no parameters."}], "answers": [{"tags": [], "owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "is_accepted": false, "score": 0, "last_activity_date": 1452706846, "last_edit_date": 1495542682, "creation_date": 1452706475, "answer_id": 34773301, "question_id": 34773242, "link": "https://stackoverflow.com/questions/34773242/rand-function-c-args/34773301#34773301", "title": "rand function c args", "body": "<p>As explained in <a href=\"http://www.cplusplus.com/reference/cstdlib/rand/\" rel=\"nofollow noreferrer\">this article</a> from <a href=\"http://cplusplus.com/\" rel=\"nofollow noreferrer\">cplusplus.com</a>, the <code>rand</code> function has the following prototype:</p>\n\n<pre><code>int rand (void);\n</code></pre>\n\n<p>and you get an <code>int</code> between 0 and <code>RAND_MAX</code>. You must pass no argument to the function.</p>\n\n<p>By the way, don't forget to initialize the function at the begginning of your program by calling :</p>\n\n<pre><code>srand (time(NULL));\n</code></pre>\n\n<p>If you need to choose a random element from an array, <a href=\"https://stackoverflow.com/questions/17215242/random-element-from-array-in-c\">this question</a> may be the right place to look for.</p>\n"}], "owner": {"reputation": 7, "user_id": 5285937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6de2c8d0e9ea58445330642349609f6?s=128&d=identicon&r=PG&f=1", "display_name": "Geancarlo Abich", "link": "https://stackoverflow.com/users/5285937/geancarlo-abich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1520797456, "creation_date": 1452706325, "last_edit_date": 1520797456, "question_id": 34773242, "link": "https://stackoverflow.com/questions/34773242/rand-function-c-args", "title": "rand function c args", "body": "<p>I have a multi task application based on DTW(Dynamic Time Wrapping) that has this code line:</p>\n\n<pre><code>void randPattern(int in[SIZE][SIZE]){\n    int i,j;\n\n    for(i=0; i&lt;SIZE; i++){\n        for(j=0; j&lt;SIZE; j++){\n            in[i][j] = abs(rand(23, 2, 100)%5000);\n        }\n    }\n}\n</code></pre>\n\n<p>So, when i tried to compile with \"arm-none-eabi-gcc\" this returns:</p>\n\n<pre><code>error: too many arguments to function 'rand'\n</code></pre>\n\n<p>What i can do to solve this message or what i can use instead this function.\nIf someone have an explanation...\nThanks for attention</p>\n"}, {"tags": ["c", "pic", "microchip"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452875615, "post_id": 34772630, "comment_id": 57373384, "body": "numbers like this: <code>ADCON2bits.ADCS2 = 010;</code> are octal values,  it that what you actually want?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452877248, "post_id": 34772630, "comment_id": 57374350, "body": "the posted code is not initializing the clock peripheral,  I would think that step is necessary to get accurate baud rates, delay timings, etc."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452877389, "post_id": 34772630, "comment_id": 57374441, "body": "the referenced tutorial includes the appropriate code to use the PIC81 as an echo device.  Amongst other things, the ADC peripheral needs to be disabled to be able to use the appropriate I/O pin for &#39;rx&#39; data bits.  I do not see that step being performed in the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452879053, "post_id": 34772630, "comment_id": 57375358, "body": "in the <code>Int_haute()</code> function, calling <code>getsUSART()</code> with a second parameter of 10 will cause the code to stay in that interrupt for a minimum of 10 &#39;char&#39; times.   That is a VERY long time to be sitting in an interrupt.  <code>getsUSART()</code> performs polling rather than interrupt driven I/O.  Suggest removing the interrupt code, then calling: <code>char DataRdyUSART(  void );</code> on a regular basis.  keep a status of how many bytes are currently in the input buffer.  And when that buffer is full, invoking the code to process the buffer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452879312, "post_id": 34772630, "comment_id": 57375482, "body": "the <code>char DataRdyUSART(  void );</code> can be invoked from within the <code>main() while()</code> loop and if returns true, then call getsUSART() to get one(1) char which the code appends to the input buffer.  When the input buffer is full, then process the data and indicate buffer is again empty."}, {"owner": {"reputation": 33, "user_id": 5005057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzdoP.jpg?s=128&g=1", "display_name": "kOnIdk", "link": "https://stackoverflow.com/users/5005057/konidk"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452953311, "post_id": 34772630, "comment_id": 57397441, "body": "I didn&#39;t know for the octal value. After initializing the clock peripheral and disabling ADC, it was still not working. I then changed my serial port connection from SparkFun FTDI Basic Breakout to directly RS-232 cable and it worked. Thanks for your comments"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5005057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzdoP.jpg?s=128&g=1", "display_name": "kOnIdk", "link": "https://stackoverflow.com/users/5005057/konidk"}, "edited": false, "score": 0, "creation_date": 1452713494, "post_id": 34773641, "comment_id": 57296011, "body": "I will try this by tomorrow morning in class. I&#39;ll tell you if this is the solution or not. Thank you"}, {"owner": {"reputation": 33, "user_id": 5005057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzdoP.jpg?s=128&g=1", "display_name": "kOnIdk", "link": "https://stackoverflow.com/users/5005057/konidk"}, "edited": false, "score": 0, "creation_date": 1452952158, "post_id": 34773641, "comment_id": 57397103, "body": "After adding &quot;ei();&quot; to my program, it didn&#39;t work as expected. I was using &quot;SparkFun FTDI Basic Breakout - 5V&quot; to connect through serial port. I changed my way to connect the PC and the PIC using an RS-232 cable and it worked !"}, {"owner": {"reputation": 33, "user_id": 5005057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzdoP.jpg?s=128&g=1", "display_name": "kOnIdk", "link": "https://stackoverflow.com/users/5005057/konidk"}, "edited": false, "score": 0, "creation_date": 1452952742, "post_id": 34773641, "comment_id": 57397270, "body": "So I don&#39;t really know why but I think that the FTDI board was not sending data from computer to the pic properly (even if the Rx led blinked everytime I sent an info). Thanks anyway for your reply :)"}], "tags": [], "owner": {"reputation": 2008, "user_id": 5719329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9755dd4a1942ea4a23a3c3e6dfb68171?s=128&d=identicon&r=PG&f=1", "display_name": "andreas-hofmann", "link": "https://stackoverflow.com/users/5719329/andreas-hofmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1452707570, "creation_date": 1452707570, "answer_id": 34773641, "question_id": 34772630, "link": "https://stackoverflow.com/questions/34772630/pic-18f4520-receiving-data-from-serial-using-rx-interrupt/34773641#34773641", "title": "PIC 18f4520 - Receiving data from serial using Rx interrupt", "body": "<p>Seems like you did not enable global interrupts.</p>\n\n<p>From the tutorial you posted:</p>\n\n<pre><code>ei();       //remember the master switch for interrupt?\n</code></pre>\n\n<p>This call is missing in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5005057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzdoP.jpg?s=128&g=1", "display_name": "kOnIdk", "link": "https://stackoverflow.com/users/5005057/konidk"}, "is_accepted": false, "score": 0, "last_activity_date": 1452952886, "creation_date": 1452952886, "answer_id": 34827818, "question_id": 34772630, "link": "https://stackoverflow.com/questions/34772630/pic-18f4520-receiving-data-from-serial-using-rx-interrupt/34827818#34827818", "title": "PIC 18f4520 - Receiving data from serial using Rx interrupt", "body": "<p>After adding \"ei();\" to my program, it didn't work as expected.\nI was using \"SparkFun FTDI Basic Breakout - 5V\" to connect through serial port.\nI changed my way to connect the PC and the PIC using an RS-232 cable and it worked ! \u2013 nico1717 9 mins ago   </p>\n\n<p>So I don't really know why but I think that the FTDI board was not sending data from computer to the pic properly (even if the Rx led blinked everytime I sent an info). All is OK now I both transmit and receive info (I still call ei(); in my programm).</p>\n"}], "owner": {"reputation": 33, "user_id": 5005057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WzdoP.jpg?s=128&g=1", "display_name": "kOnIdk", "link": "https://stackoverflow.com/users/5005057/konidk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1431, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1612547851, "creation_date": 1452704405, "last_edit_date": 1612547851, "question_id": 34772630, "link": "https://stackoverflow.com/questions/34772630/pic-18f4520-receiving-data-from-serial-using-rx-interrupt", "title": "PIC 18f4520 - Receiving data from serial using Rx interrupt", "body": "<p>Following <a href=\"http://singularengineer.com/programming-pic-18-using-xc8-mplab-x-usart-pic18f-serial/\" rel=\"nofollow\">this tutorial</a>, I wanted to send and receive data from PIC18f4520 to my computer. Sending data to the computer using serial port is working fine for me.\nI'm now trying to receive data from my computer using the serial port. I'm sending data from a C# app which has been created by my teacher (it's working fine for other students) so this can't be the problem.</p>\n\n<p>To receive data, I need to do it using interrupts. I changed <strong>USART_RX_INT_OFF</strong> to <strong>USART_RX_INT_ON</strong> and enabled the peripheral interrupt.</p>\n\n<p>Using the debugging tool, I noticed that my program was never entering is the interrupt (I must use the high-priority one).</p>\n\n<p>What my program does basically (this is working fine) : </p>\n\n<ul>\n<li>I'm gathering analog data from pin RA5 using ADC</li>\n<li>Sending HIGH or LOW to pin RE2 to light a bulb or to turn it off</li>\n<li>Using pin RA1 to control a servo motor</li>\n<li>Using an LCD screen to print information on it</li>\n</ul>\n\n<p>Init_Interruptions() is supposed to init the interrupts\nADC_Init() is supposed to init ADC</p>\n\n<p>Here is my code, I tried to add as much comments as possible in order to be clear. Let me know if you can help me, this would be really appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"p18f4520.h\"\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;plib/adc.h&gt;\n#include &lt;plib/usart.h&gt;\n#include &lt;plib/portb.h&gt;\n#include &lt;plib/delays.h&gt;\n#include &lt;plib/timers.h&gt;\n#include &lt;plib/pwm.h&gt;\n#include &lt;string.h&gt;\n#include &lt;xc.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"config.h\"\n#include \"hd44780/hd44780.h\"\n\n#define delay1S  for(uint8_t i = 0 ; i &lt; 20 ; i++) __delay_ms(50)\n\nint counter;\nunsigned char textTx[10];\nunsigned char JourMSG[]= \"jour\";\nunsigned char NuitMSG[]= \"nuit\";\n        /*char chaine[10]= \"\";\n        char buffer[10];\n        char * s1, * s2;\n        unsigned int i, j;*/\n\n//Servo motor signal sending functions\nvoid turn_middle() { //0\u00b0\n        PORTAbits.RA1 = 1; \n        __delay_us(1500);\n        PORTAbits.RA1 = 0; \n        __delay_us(18500);\n}\n\nvoid turn_left() { //-90\u00b0\n        PORTAbits.RA1 = 1;\n        __delay_us(1000);\n        PORTAbits.RA1 = 0; \n        __delay_us(19000);\n}\n\nvoid turn_right() { //90\u00b0\n        PORTAbits.RA1 = 1; \n        __delay_us(2000);\n        PORTAbits.RA1 = 0; \n        __delay_us(18000);\n}\n//////////////////////////////////////\n\n//Delay functions\nvoid DelayxmSecond(unsigned int tempo_ms)\n{\n    for(int i=0;i&lt;tempo_ms;i++)\n        __delay_ms(1);\n}\n\n\nvoid   DelayxSecond(unsigned int tempo_s)\n{\n\n    for(int j=0;j&lt;tempo_s;j++)\n        DelayxmSecond(1000);\n\n\n}\n////////////////////////////////////////\n\n\nvoid Init_Timer1(void)\n{\n   OpenTimer1(TIMER_INT_ON &amp; T1_16BIT_RW &amp; T1_SOURCE_EXT &amp; T1_PS_1_1 &amp; T1_OSC1EN_ON &amp; T1_SYNC_EXT_ON);\n   IPR1bits.TMR1IP=0;\n   WriteTimer1(32768);\n}\n\nvoid Init_Interruptions(void)\n{\n        PIR1bits.RCIF = 0; //reset RX pin flag\n        IPR1bits.RCIP = 1; //high priority\n        PIE1bits.RCIE = 1; //Enable RX interrupt\n        INTCONbits.PEIE = 1; //Enable pheripheral interrupt (serial port is a pheripheral)\n\n        RCONbits.IPEN = 1;\n        INTCONbits.GIEH = 1;\n        INTCONbits.GIEL = 1;\n}\n\nvoid interrupt high_priority Int_haute()\n{\n    //check if the interrupt is caused by RX pin\n    if(PIR1bits.RCIF == 1)\n    {\n        INTCONbits.GIEH = 0;\n\n        getsUSART(textTx,10);\n        PIR1bits.RCIF = 0; // clear rx flag\n\n        INTCONbits.GIEH = 1;\n    }\n}\n\nvoid interrupt low_priority Int_basse() //Not doing anything here\n{\n   INTCONbits.GIEL = 0;\n\n   INTCONbits.GIEL = 1;\n}\n\nvoid ADC_Init() //ADC init\n{\n  ADCON1bits.VCFG1 = 0; //-Vref VSS\n  ADCON1bits.VCFG0 = 0; //+Vref VDD\n  ADCON1bits.PCFG3 = 1110;\n  ADCON1bits.PCFG2 = 1110;\n  ADCON1bits.PCFG1 = 1110;\n  ADCON1bits.PCFG0 = 1110;\n\n  ADCON0bits.CHS3 = 0000;\n  ADCON0bits.CHS2 = 0000;\n  ADCON0bits.CHS1 = 0000;\n  ADCON0bits.CHS0 = 0000;\n  ADCON0bits.GODONE = 0;\n  ADCON0bits.ADON = 1;\n\n  ADCON2bits.ADFM = 0;\n  ADCON2bits.ACQT2 = 101;\n  ADCON2bits.ACQT1 = 101;\n  ADCON2bits.ACQT0 = 101;\n  ADCON2bits.ADCS2 = 010;\n  ADCON2bits.ADCS2 = 010;\n  ADCON2bits.ADCS2 = 010;\n\n  ADCON0bits.ADON = 1; //TURN ON AD MODULE\n\n  ADCON1 = 0xC0; //All pins as Analog Input\n                 //With reference voltages VDD and VSS\n}\n\nvoid main(){\n\n    TRISCbits.TRISC7 = 1;\n    TRISCbits.TRISC6 = 0;\n    OpenUSART( USART_TX_INT_OFF &amp;USART_RX_INT_ON &amp;USART_ASYNCH_MODE &amp;USART_EIGHT_BIT &amp;USART_BRGH_HIGH,12 );\n\n    Init_Interruptions();\n\n    //Set LCD pins to output\n    TRISD=0x00;\n\n    //PIC2DEMPLUS related stuffs. Not needed on board without LCD power control and with R/W wired to ground\n    LATDbits.LD7 = 1;           // LCD power on\n    __delay_ms(50);             // LCD power up delay\n    LATDbits.LD5 = 0;           // R/W set to W\n\n    //LCD init\n    LCDinit(LCD_INIT_CURSOR_DISABLED);\n    __delay_ms(2);\n\n    ADC_Init();\n\n    TRISAbits.TRISA5 = 1; // configure RA5 as analog input\n\n    ADCON0           = 0b01100000;  // Set channel select to AN5\n    ADCON1           = 0b00001011;  // Configure RA5/AN5 as analogue\n    ADCON2           = 0b10101010;  // Right justified result\n    // configure voltage reference\n    //ADCON1bits.VCFG1 = 0;      // -ve ref = Vss\n    //ADCON1bits.VCFG0 = 1;   // +ve ref = Vdd\n    // select ADC input channel\n    ADCON0bits.CHS = 100;   // input = AN5\n    ADCON2bits.ACQT = 100;   // input = AN5\n    ADCON2bits.ADCS = 100;   // input = AN5\n    ADCON2bits.ADFM = 1;\n    ADCON0bits.ADON = 1; // turn on ADC module\n\n    TRISAbits.TRISA1 = 0; //RA1 output -&gt; SERVOMOTOR\n    TRISEbits.TRISE2 = 0; //RB1 output -&gt; BULB\n    PORTBbits.RB1 = 1;\n    int compteur=0;\n    int modejour=1; //Starting with day mode\n    unsigned int N;\n    while(1)\n    {\n        ADCON0bits.GO_DONE = 1; //LAUNCH CONVERSION\n        while(ADCON0bits.GO_DONE != 0);\n        LCDpos(0,3);\n        N=(ADRESH&lt;&lt;8)+ADRESL;\n        putsUSART(textTx);\n        if(N&gt;800 &amp;&amp; modejour==0)\n        {\n            LCDpos(0,3);\n            LCDprintConst(\"PLEIN JOUR\");\n            putsUSART(JourMSG);\n            PORTEbits.RE2 = 0;\n            modejour=1;\n            compteur=0;\n            while(compteur&lt;20) \n            {\n                turn_right();\n                compteur++;\n            }\n        }\n        if(N&lt;800 &amp;&amp; modejour==1)\n        {\n            LCDpos(0,3);\n            LCDprintConst(\"MODE NUIT \");\n            putsUSART(NuitMSG);\n            PORTEbits.RE2 = 1;\n            modejour=0;\n            compteur=0;\n            while(compteur&lt;20) \n            {\n                turn_left();\n                compteur++;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["java", "c", "linker", "java-native-interface"], "answers": [{"tags": [], "owner": {"reputation": 211, "user_id": 2690730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4318bf12b23c03d55aefc912614832?s=128&d=identicon&r=PG&f=1", "display_name": "user2690730", "link": "https://stackoverflow.com/users/2690730/user2690730"}, "is_accepted": true, "score": 1, "last_activity_date": 1453522907, "creation_date": 1453522907, "answer_id": 34959562, "question_id": 34772543, "link": "https://stackoverflow.com/questions/34772543/cant-find-jni-onload-libname-in-example-program/34959562#34959562", "title": "Can&#39;t find JNI_OnLoad_libname in example program", "body": "<p>I was finally able to get the JVM to find JNI_OnLoad_hello by passing --export-dynamic to the linker.  This allows shared libraries to resolve symbols by looking for them in the executable.  Also, System.loadLibrary was throwing UnsatisfiedLikeErrors like I suspected but for some reason I have to handle them in JNI using CheckException and DescribeException.</p>\n"}], "owner": {"reputation": 211, "user_id": 2690730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4318bf12b23c03d55aefc912614832?s=128&d=identicon&r=PG&f=1", "display_name": "user2690730", "link": "https://stackoverflow.com/users/2690730/user2690730"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 34959562, "answer_count": 1, "score": 1, "last_activity_date": 1453522907, "creation_date": 1452704186, "question_id": 34772543, "link": "https://stackoverflow.com/questions/34772543/cant-find-jni-onload-libname-in-example-program", "title": "Can&#39;t find JNI_OnLoad_libname in example program", "body": "<p>How exactly do I call native static libraries from Java?  I'm using Java 8.</p>\n\n<p>It looks to me like I should be able to define a JNI_OnLoad_library in a C++ program with an embedded JVM but my VM keeps dying when I call System.loadLibrary.  The following only prints \"Hello from main\".</p>\n\n<p>main.cpp:</p>\n\n<pre><code>#include &lt;jni.h&gt;\n#include &lt;iostream&gt;\n\nextern \"C\" {\n    JNIEXPORT jint JNI_OnLoad_hello(JavaVM *vm, void *reserved) {\n        std::cout &lt;&lt; \"Hello World\" &lt;&lt; std::endl;\n        return JNI_VERSION_1_8;\n    }\n}\n\nint main(int argc, char** argv) {\n    JavaVM *jvm;\n    JNIEnv *env;\n    JavaVMInitArgs vm_args;\n    jint error;\n\n    JavaVMOption* options = new JavaVMOption[argc-1];\n    for(int i = 0;i &lt; argc-1;i++) {\n        options[i].optionString = argv[i+1];\n    }\n\n    vm_args.nOptions = argc-1;\n    vm_args.options = options;\n\n    vm_args.version = JNI_VERSION_1_8;\n\n    JNI_CreateJavaVM(&amp;jvm, (void**)&amp;env, &amp;vm_args);\n    jclass cls = env-&gt;FindClass(\"Main\");\n    jclass stringCls = env-&gt;FindClass(\"java/lang/String\");\n    jmethodID mid = env-&gt;GetStaticMethodID(cls, \"main\", \"([Ljava/lang/String;)V\");\n    jobjectArray mainArgs = env-&gt;NewObjectArray(0, stringCls, NULL);\n    env-&gt;CallStaticVoidMethod(cls, mid, mainArgs);\n    jvm-&gt;DestroyJavaVM();\n}\n</code></pre>\n\n<p>Main.java:</p>\n\n<pre><code>class Main {\n    public static void main(String[] args) {\n        try {\n            System.out.println(\"Hello from main\");\n            System.loadLibrary(\"hello\");\n            System.out.println(\"Hello after main\");\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "unix", "unix-socket"], "comments": [{"owner": {"reputation": 62673, "user_id": 492336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UjW5c.png?s=128&g=1", "display_name": "sashoalm", "link": "https://stackoverflow.com/users/492336/sashoalm"}, "edited": false, "score": 0, "creation_date": 1452704339, "post_id": 34772486, "comment_id": 57290226, "body": "I had answered a question about userspace/kernelspace buffering -  <a href=\"https://stackoverflow.com/questions/21014880/c-streams-copy-data-from-one-stream-to-another-directly-without-using-a-buffer/21016344#21016344\" title=\"c streams copy data from one stream to another directly without using a buffer\">stackoverflow.com/questions/21014880/&hellip;</a>. See if it helps you."}], "answers": [{"tags": [], "owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "is_accepted": false, "score": 2, "last_activity_date": 1534453601, "last_edit_date": 1534453601, "creation_date": 1452961488, "answer_id": 34829233, "question_id": 34772486, "link": "https://stackoverflow.com/questions/34772486/unix-domain-sockets-send-timeout-zero-copy/34829233#34829233", "title": "UNIX domain sockets, send timeout, zero copy", "body": "<p>The function <code>sendto</code> does not wait for the data to be received by the recipient before it returns. So yes, to achieve that, the data will be copied to a buffer owned by the kernel and then copied out again by the recieving process.</p>\n\n<p><strong>Why:</strong> If this wasn't the case, then it would be more-or-less impossible for two processes to exchange messages. If process P1 attempts to send a message to process P2, it would not succeed until P2 called <code>read</code>. If P2 is attempting to send a messate to P1 at the time, it cannot succeed until P1 calls <code>read</code>. But P1 is waiting in a blocking call to <code>sendto</code>. The processes will be deadlocked.</p>\n\n<p>Buffering by the kernel is the solution to that problem. </p>\n"}, {"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 1, "last_activity_date": 1452963756, "creation_date": 1452963756, "answer_id": 34829637, "question_id": 34772486, "link": "https://stackoverflow.com/questions/34772486/unix-domain-sockets-send-timeout-zero-copy/34829637#34829637", "title": "UNIX domain sockets, send timeout, zero copy", "body": "<p>Well Ben covered the primary aspect really well, but there's something else here too.</p>\n\n<p>Let us say we were going to allow zero-copy over domain sockets, and let us say that we allow sendto() to block until recvfrom() is called to get away from the kernel buffer. I see a headache coming really fast in kernel -- we would have to COW that page into the receiving process (which means it better be a whole page), and well, if everything isn't executed exactly you get copies anyway. The sender can't call free() or re-use the buffer for the obvious reasons as this would force pagefault-copy anyway.</p>\n\n<p>Ugly, just ugly. Nobody's going to bother to write all this for something so hard to use. The only user of unix domain sockets big enough to warrant is X, and X doesn't guarantee the message sizes to allow this.</p>\n"}, {"tags": [], "owner": {"reputation": 10938, "user_id": 155082, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f1316ecb725006d020998e6b8a0740c?s=128&d=identicon&r=PG", "display_name": "Lothar", "link": "https://stackoverflow.com/users/155082/lothar"}, "is_accepted": false, "score": 0, "last_activity_date": 1613734950, "creation_date": 1613734950, "answer_id": 66276960, "question_id": 34772486, "link": "https://stackoverflow.com/questions/34772486/unix-domain-sockets-send-timeout-zero-copy/66276960#66276960", "title": "UNIX domain sockets, send timeout, zero copy", "body": "<p>I just want to add that if the data you exchange is big enough and/or frequent enough for optimization than you can create an anonymous file via <code>create_memfd</code> system call and pass the file descriptor with your message. If you use a <code>mmap</code> on this temporary file you can archive zero copy data exchange.</p>\n<p>But the setup takes a lot of time, so you should measure it and only do so if you transfer lots of data or you have reasons for low memory consumption. Remember with the naive copy operation you will need three times the memory. Which might hurt more than the performance penalty of copying.</p>\n"}], "owner": {"reputation": 1517, "user_id": 3420919, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/163b2d7861ae2b7fe5d25e0b86debb11?s=128&d=identicon&r=PG&f=1", "display_name": "RootPhoenix", "link": "https://stackoverflow.com/users/3420919/rootphoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1613734950, "creation_date": 1452704013, "question_id": 34772486, "link": "https://stackoverflow.com/questions/34772486/unix-domain-sockets-send-timeout-zero-copy", "title": "UNIX domain sockets, send timeout, zero copy", "body": "<p>I am learning UNIX domain sockets and trying out some client server programs. I am using SOCK_DGRAM family of sockets.</p>\n\n<p>My doubt is:</p>\n\n<ol>\n<li>Is using UNIX domain sockets copy buffer from userspace to kernel space buffers while sending and receiving?</li>\n</ol>\n\n<p>So my call: </p>\n\n<pre><code>sendto(send_thread_socket, (void*)argData, sizeof(*argData), 0,\n                                        (struct sockaddr *)&amp;dpdkServer, sizeof(struct sockaddr_un))\n</code></pre>\n\n<p>will it copy the buffer to some kernel space buffer or will it directly be copied to user space buffer of receiving process. Since UNIX sockets work on file system namespaces I thought it shouldn't do a copy of the buffer.</p>\n\n<ol start=\"2\">\n<li>Since I am using SOCK_DGRAM, will a send timeout make any sense?</li>\n</ol>\n\n<p>Lets say I am using the same sendto() call, but the receiving side does not guarantee any timely collection of data, can I have a Send timeout.</p>\n"}, {"tags": ["c", "dos", "vga"], "comments": [{"owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "edited": false, "score": 0, "creation_date": 1452704056, "post_id": 34772441, "comment_id": 57290008, "body": "Can you add a screenshot? Might make the problem instantaneously obvious without reading the code, though what you&#39;ve already given is plenty of information. If you printed space, !, &quot;, etc in a line then an error in calculating the offset might instantly be visible."}, {"owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1452704864, "post_id": 34772441, "comment_id": 57290581, "body": "Hello, thanks for your comments. @enhzflep I have 1 byte per horizontal row. So the idea is to have 7 bytes per character bitmap."}, {"owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "reply_to_user": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "edited": false, "score": 0, "creation_date": 1452704866, "post_id": 34772441, "comment_id": 57290585, "body": "@Tommy. I,ve added a screenshot of what&#180;s displayed"}, {"owner": {"reputation": 1383, "user_id": 3229684, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/2da6303ff1d17743bc6cdea4d7cbaa83?s=128&d=identicon&r=PG&f=1", "display_name": "i336_", "link": "https://stackoverflow.com/users/3229684/i336"}, "edited": false, "score": 0, "creation_date": 1467686848, "post_id": 34772441, "comment_id": 63814129, "body": "OT, but I must ask: what program are those screenshots of?"}, {"owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "edited": false, "score": 0, "creation_date": 1467688634, "post_id": 34772441, "comment_id": 63814455, "body": "Is the one i developed"}], "answers": [{"comments": [{"owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "edited": false, "score": 0, "creation_date": 1452705599, "post_id": 34772585, "comment_id": 57291088, "body": "thanks for the help. I&#180;m almost getting it good now. I added another screenshot to show the result I have now"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1452707763, "post_id": 34772585, "comment_id": 57292449, "body": "Looking at the pixel data, the 6 pixels of each line appear to be left-shifted by 2 pixels, so change the inner <code>for</code> loop to <code>for (i = 7; i &gt;= 2; i--) {</code>."}], "tags": [], "owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "is_accepted": true, "score": 2, "last_activity_date": 1452704290, "creation_date": 1452704290, "answer_id": 34772585, "question_id": 34772441, "link": "https://stackoverflow.com/questions/34772441/plotting-a-char-in-vga-mode/34772585#34772585", "title": "Plotting a char in VGA mode", "body": "<p>Most likely you want:</p>\n\n<pre><code>char_offset = (ascii_char-32)*7;\n</code></pre>\n\n<p>If you multiply by 7 first and then subtract 32 then you won't be subtracting enough since you want to move 32 characters back, not 32 pixel rows.</p>\n"}], "owner": {"reputation": 2382, "user_id": 2370400, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5a0796d3f5a35d57f483d7d13d884007?s=128&d=identicon&r=PG", "display_name": "Pablo Estrada", "link": "https://stackoverflow.com/users/2370400/pablo-estrada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 34772585, "answer_count": 1, "score": 4, "last_activity_date": 1452705557, "creation_date": 1452703904, "last_edit_date": 1452705557, "question_id": 34772441, "link": "https://stackoverflow.com/questions/34772441/plotting-a-char-in-vga-mode", "title": "Plotting a char in VGA mode", "body": "<p>I\u00b4m working on a function to plot a character in video mode for the 256 VGA mode.\nI\u00b4m using 6x7 fonts with the set containing only the capital letters, numbers and signs. This is the data:</p>\n\n<pre><code>uint8_t  characters[455] = {\n  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x20,0x20,0x00,0x20,0x00,0x50,\n  0x50,0x00,0x00,0x00,0x00,0x00,0x50,0xf8,0x50,0x50,0xf8,0x50,0x00,0x20,0xf8,0xa0,\n  0xf8,0x28,0xf8,0x00,0xc8,0xd0,0x20,0x20,0x58,0x98,0x00,0x40,0xa0,0x40,0xa8,0x90,\n  0x68,0x00,0x20,0x40,0x00,0x00,0x00,0x00,0x00,0x20,0x40,0x40,0x40,0x40,0x20,0x00,\n  0x20,0x10,0x10,0x10,0x10,0x20,0x00,0x50,0x20,0xf8,0x20,0x50,0x00,0x00,0x20,0x20,\n  0xf8,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x60,0x20,0x40,0x00,0x00,0x00,0xf8,0x00,\n  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x60,0x00,0x00,0x08,0x10,0x20,0x40,0x80,\n  0x00,0x70,0x88,0x98,0xa8,0xc8,0x70,0x00,0x20,0x60,0x20,0x20,0x20,0x70,0x00,0x70,\n  0x88,0x08,0x70,0x80,0xf8,0x00,0xf8,0x10,0x30,0x08,0x88,0x70,0x00,0x20,0x40,0x90,\n  0x90,0xf8,0x10,0x00,0xf8,0x80,0xf0,0x08,0x88,0x70,0x00,0x70,0x80,0xf0,0x88,0x88,\n  0x70,0x00,0xf8,0x08,0x10,0x20,0x20,0x20,0x00,0x70,0x88,0x70,0x88,0x88,0x70,0x00,\n  0x70,0x88,0x88,0x78,0x08,0x70,0x00,0x30,0x30,0x00,0x00,0x30,0x30,0x00,0x30,0x30,\n  0x00,0x30,0x10,0x20,0x00,0x00,0x10,0x20,0x40,0x20,0x10,0x00,0x00,0xf8,0x00,0xf8,\n  0x00,0x00,0x00,0x00,0x20,0x10,0x08,0x10,0x20,0x00,0x70,0x88,0x10,0x20,0x00,0x20,\n  0x00,0x70,0x90,0xa8,0xb8,0x80,0x70,0x00,0x70,0x88,0x88,0xf8,0x88,0x88,0x00,0xf0,\n  0x88,0xf0,0x88,0x88,0xf0,0x00,0x70,0x88,0x80,0x80,0x88,0x70,0x00,0xe0,0x90,0x88,\n  0x88,0x90,0xe0,0x00,0xf8,0x80,0xf0,0x80,0x80,0xf8,0x00,0xf8,0x80,0xf0,0x80,0x80,\n  0x80,0x00,0x70,0x88,0x80,0x98,0x88,0x70,0x00,0x88,0x88,0xf8,0x88,0x88,0x88,0x00,\n  0x70,0x20,0x20,0x20,0x20,0x70,0x00,0x10,0x10,0x10,0x10,0x90,0x60,0x00,0x90,0xa0,\n  0xc0,0xa0,0x90,0x88,0x00,0x80,0x80,0x80,0x80,0x80,0xf8,0x00,0x88,0xd8,0xa8,0x88,\n  0x88,0x88,0x00,0x88,0xc8,0xa8,0x98,0x88,0x88,0x00,0x70,0x88,0x88,0x88,0x88,0x70,\n  0x00,0xf0,0x88,0x88,0xf0,0x80,0x80,0x00,0x70,0x88,0x88,0xa8,0x98,0x70,0x00,0xf0,\n  0x88,0x88,0xf0,0x90,0x88,0x00,0x70,0x80,0x70,0x08,0x88,0x70,0x00,0xf8,0x20,0x20,\n  0x20,0x20,0x20,0x00,0x88,0x88,0x88,0x88,0x88,0x70,0x00,0x88,0x88,0x88,0x88,0x50,\n  0x20,0x00,0x88,0x88,0x88,0xa8,0xa8,0x50,0x00,0x88,0x50,0x20,0x20,0x50,0x88,0x00,\n  0x88,0x50,0x20,0x20,0x20,0x20,0x00,0xf8,0x10,0x20,0x40,0x80,0xf8,0x00,0x60,0x40,\n  0x40,0x40,0x40,0x60,0x00,0x00,0x80,0x40,0x20,0x10,0x08,0x00,0x30,0x10,0x10,0x10,\n  0x10,0x30,0x00,0x20,0x50,0x88,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf8,\n  0x00,0xf8,0xf8,0xf8,0xf8,0xf8,0xf8};\n</code></pre>\n\n<p>For the put_char function, I\u00b4m calculating an offset for the array by multiplying the ascii code by 7 and substracting 32 (since I\u00b4m just using capital letters). Then I iterate over the width and height of the font size (i.e 6 and 7) to plot the pixel if I find a 1 and do nothing if I find a 0.</p>\n\n<pre><code>void put_char(int x,int y,int ascii_char){\n    int l,i,j,h,char_offset;\n    j,h,l,i=0;\n    char_offset = ascii_char*7-32;\n    printf(\"offset: %d\\n\",char_offset);\n    for (l = 0; l &lt; 7; l++) {\n        for (i = 6; i &gt; 0; i--) {\n            j++;\n            if ((characters[char_offset+l+j] &amp; (1 &lt;&lt; i))) { \n\n                plot_pixel(j+x, h+y, current_color);\n            }\n        }\n        h++;\n        j = 0;\n    }   \n}\n</code></pre>\n\n<p>However, I\u00b4m not getting the letter printed correctly on screen. I think I might have a problem calculating the offset, but I don\u00b4t know where it is. I\u00b4m also doubting my method to check if the number is 1 or 0 is correct. Can anyone help me out with this?</p>\n\n<p>EDIT:</p>\n\n<p>Here\u00b4s a picture of what I\u00b4m getting (note the green pixels on the drawing area, those should be the letter 'A'</p>\n\n<p><a href=\"https://i.stack.imgur.com/myhzC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/myhzC.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT 2:</p>\n\n<p>Here\u00b4s a picture of what I\u00b4m getting now that I changed </p>\n\n<pre><code> char_offset = ascii_char*7-32;\n</code></pre>\n\n<p>to</p>\n\n<pre><code> char_offset = (ascii_char-32)*7;\n</code></pre>\n\n<p>It\u00b4s almost good, however the left side of the 'A' is somehow missing on the plotting of the pixels.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bex14.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bex14.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "loops", "pointers", "dynamic-memory-allocation", "realloc"], "comments": [{"owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "edited": false, "score": 0, "creation_date": 1452703725, "post_id": 34772361, "comment_id": 57289731, "body": "you must use <code>_Buf = realloc(_Buf, size);</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1452704357, "post_id": 34772361, "comment_id": 57290242, "body": "@BLUEPIXY isn&#39;t it like returns 0 on success?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1452704519, "post_id": 34772361, "comment_id": 57290357, "body": "<code>_Buf[n++] = c;</code> will place a truncated <code>EOF</code> value as the last character in your string.  Assuming <code>EOF</code> has the <code>int</code> value of <code>-1</code> and hex value of <code>0xFFFFFFFF</code> (32-bit <code>int</code>) that will truncate down to <code>char</code> value <code>0xFF</code>, which effectively prints the same as a space at the end of your output line.  You won&#39;t see it, but if you save your output to a file or look at it with a hex editor or similar you&#39;ll be wondering where that came from."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452704115, "post_id": 34772406, "comment_id": 57290055, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 4, "last_activity_date": 1452704174, "last_edit_date": 1452704174, "creation_date": 1452703806, "answer_id": 34772406, "question_id": 34772361, "link": "https://stackoverflow.com/questions/34772361/why-realloc-doesnt-work-in-this-while-loop/34772406#34772406", "title": "Why realloc doesn&#39;t work in this while loop?", "body": "<p>You are not assinging the returned pointer of <code>realloc()</code> to a variable/pointer:</p>\n\n<pre><code>realloc(_Buf,size);\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>char * _New_Buf = realloc(_Buf,size);\nif(_New_Buf != NULL)\n    _Buf = _NewBuf;\nelse\n    ; // add some error handling here\n</code></pre>\n\n<p>Otherwise, <code>free()</code> will also be free-ing the wrong memory pointed to by a possible invalid <code>_Buf</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1452704376, "post_id": 34772418, "comment_id": 57290257, "body": "Thank you for your answer.My mistake was a total blunder.As for not casting the result of <code>malloc</code> I know that,i have seen it like million times on SO,however am using c++ compiler,so that&#39;s why i cast :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1452704643, "post_id": 34772418, "comment_id": 57290442, "body": "@machine_1 You&#39;re welcome. Just saying, stick to a C compiler for compiling C code."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1452704165, "last_edit_date": 1495542632, "creation_date": 1452703844, "answer_id": 34772418, "question_id": 34772361, "link": "https://stackoverflow.com/questions/34772361/why-realloc-doesnt-work-in-this-while-loop/34772418#34772418", "title": "Why realloc doesn&#39;t work in this while loop?", "body": "<p>Calling <code>realloc()</code> on a pointer does not <em>adjust</em> the old pointer. It deallocates the old pointer and returns a new pointer containing the new allocation. You need to make use of the returned pointer afterwards.</p>\n\n<p>From the <code>C11</code> standard, chapter \u00a77.22.3.5, <em>The <code>realloc</code> function</em></p>\n\n<blockquote>\n  <p><code>void *realloc(void *ptr, size_t size);</code></p>\n  \n  <p>The <code>realloc</code> function deallocates the old object pointed to by <code>ptr</code> and returns a\n  pointer to a new object that has the size specified by <code>size</code>. [...]</p>\n</blockquote>\n\n<p>So, you need to collect the returned pointer, check against NULL and assign it back to the previous pointer, as you may.</p>\n\n<p>That said, <a href=\"https://stackoverflow.com/q/605845/2173917\">please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>.</p>\n"}], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 34772418, "answer_count": 2, "score": 2, "last_activity_date": 1452704558, "creation_date": 1452703669, "last_edit_date": 1452704558, "question_id": 34772361, "link": "https://stackoverflow.com/questions/34772361/why-realloc-doesnt-work-in-this-while-loop", "title": "Why realloc doesn&#39;t work in this while loop?", "body": "<p>I am anxious to know why <code>realloc()</code> doesn't work in my loop.I made a <code>grep</code> function which i tested on a large text file and suddenly the program crashed telling me <em>\"corruption of the heap\"</em> so I decided to break it up and try it on a smaller scale,but the problem persist.Can someone explain what is wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid grep(const char *Pattern,FILE *file);\n\nint main(void)\n{\n    FILE *file;\n    if(fopen_s(&amp;file,\"file.txt\",\"r\"))\n        return 1;\n    grep(\"word\",file);\n    fclose(file);\n    return 0;\n}\n\nvoid grep(const char *Pattern,FILE *file)\n{\n    size_t size = 5*sizeof(char);\n    char *_Buf = (char*)malloc(size);\n    int n = 0, c;\n    while(c=getc(file))\n    {\n        _Buf[n++] = c;\n        if(c == '\\n' || c == EOF)\n        {\n            _Buf[n] = '\\0';\n            if(strstr(_Buf,Pattern))\n                printf(\"%s\",_Buf);\n            if(c == EOF)\n                break;\n            n = 0;\n        }\n        if(n == size)\n        {\n            size += 5;\n            realloc(_Buf,size);\n        }\n    }\n    free(_Buf);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "sizeof"], "comments": [{"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 3, "creation_date": 1452703685, "post_id": 34772313, "comment_id": 57289698, "body": "No, it&#39;s not valid to retrieve array size. By standard the compiler converts array passed as function parameters to qualified pointers. So you&#39;ll always get the size of a pointer."}, {"owner": {"reputation": 3717, "user_id": 1215996, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ff628cd135c5f60ce0dfda4b40ac06e?s=128&d=identicon&r=PG", "display_name": "Sumit Trehan", "link": "https://stackoverflow.com/users/1215996/sumit-trehan"}, "edited": false, "score": 0, "creation_date": 1452704397, "post_id": 34772313, "comment_id": 57290277, "body": "The array name will decay to the pointer whenever passed to the function arg. In such case sizeof() will return the size of the pointer."}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1452711176, "post_id": 34772313, "comment_id": 57294613, "body": "Arrays are not pointers. You must understand that."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1452712503, "post_id": 34772313, "comment_id": 57295392, "body": "@FISOCPP: Did anyone claim they are?"}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1452712721, "post_id": 34772313, "comment_id": 57295538, "body": "Well by the first comment and also by the OP post. I assume he thinks this because of how he stores the pointers to array first elements and then he wants to find their original size by using sizeof operator. Or maybe he doesn&#39;t but if someone does - here I pointed this fact just in-case then. By the first post - because you can in generally &#39;retrieve the size of an array&#39;."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1452713107, "post_id": 34772313, "comment_id": 57295751, "body": "@FISOCPP: OK, thanks for claryfication. But I&#39;m aware of that. And the way I&#39;m storing the pointers the way I&#39;m doing it because I know that for an array is given that <code>int arr[n];</code> the result of <code>arr == &amp;arr</code> will be true ;)"}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1452713450, "post_id": 34772313, "comment_id": 57295972, "body": "Well then I can tell you that the only way you can achieve what you want is using VM types but in this case you need to supply this information on compile-time - i.e where to fetch the array size."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1452714804, "post_id": 34772313, "comment_id": 57296823, "body": "@FISOCPP: Look my comment on accepted answer. An &quot;No it isn&#39;t possible this way&quot; Is allready satisfying my needs ^^"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452722931, "post_id": 34772313, "comment_id": 57301015, "body": "<code>#include &quot;stdio.h&quot;</code> should be <code>#include &lt;stdio.h&gt;</code>. <code>argc</code> is an <code>int</code>, not a <code>char*</code>. You don&#39;t use <code>argc</code> or <code>argv</code> anyway, so you might as well use <code>int main(void)</code>. The result of <code>sizeof</code> should be printed with <code>%zu</code>, not <code>%d</code>. The <code>\\r</code> in the format string is unnecessary and possibly harmful."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452758149, "post_id": 34772313, "comment_id": 57312518, "body": "@KeithThompson: Agrred to all points except the last one. why  \\r might be harmfull? I learned it never is harmfull but keeping it in may result in more portable code since it is ignored where it isn&#39;t needed but where you need it then you have it there. I&#39;m a bit confused since you claim \\r isn&#39;t needed without any knowledge of the enviroment on the other hand I have never seen any sources confirming what I had been tought. So could you explain this part please?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452758882, "post_id": 34772313, "comment_id": 57312891, "body": "When writing to a text file, <code>&#39;\\n&#39;</code> is translated to whatever the system&#39;s end-of-line representation happens to be (<code>\\n&#39;</code> on Unix, <code>\\r\\n</code> on Windows). Writing an extra <code>\\r</code> to a console or terminal emulator is very likely harmless. Writing it to a file could result in a malformed text file."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452759172, "post_id": 34772313, "comment_id": 57313040, "body": "@KeithThompson: Do you have any refference for reading up when exactly <code>&#39;\\n&#39;</code> translates that way and when it doesn&#39;t? Becuase I never noticed this behaving on windows. but would like to get corrected anyway :)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452786824, "post_id": 34772313, "comment_id": 57331247, "body": "The C standard (<a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a>) is not as explicit on this point as I thought it was, but see 7.21.2 paragraph 2. For a text stream, if you write <code>&quot;hello\\n&quot;</code> to the stream, you can then read back the same <code>&quot;hello\\n&quot;</code> -- but the <code>\\n</code> is translated to the operating system&#39;s end-of-line representation, whatever it happens to be. This doesn&#39;t happen for binary streams. This is more clearly explained in the <a href=\"http://www.c-faq.com/\" rel=\"nofollow noreferrer\">comp.lang.c FAQ</a>, question 12.40."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452786844, "post_id": 34772313, "comment_id": 57331264, "body": "Basically, unless you&#39;re dealing with &quot;foreign&quot; text files, you should never need to write <code>&#39;\\r&#39;</code> to a text stream."}], "answers": [{"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1452704790, "post_id": 34772358, "comment_id": 57290532, "body": "You should add that <code>arr</code> in function <code>test</code> is a pointer to <code>int</code>, i.e. pointer to first element of array passed, therefore do not expect <code>sizeof(arr)</code> will give you the size of array passed. It seem OP thinks it will give size of array passed."}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1452705609, "post_id": 34772358, "comment_id": 57291096, "body": "@haccks Thanks for the clarification. That&#39;s what I was trying to say. I made it more clear now."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1452706515, "post_id": 34772358, "comment_id": 57291669, "body": "Actually, it is possible to pass the array with <code>test(sizeof(arr), &amp;arr)</code> to a function with the signature <code>void test(size_t n, int (*arraryPtr)[n])</code>, which can then inquire the size of the array with <code>sizeof(*arrayPtr)</code>."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452706739, "post_id": 34772358, "comment_id": 57291814, "body": "@cmaster; Stil you need to specify the size."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1452711900, "post_id": 34772358, "comment_id": 57295043, "body": "@haccks Not within the body of <code>test()</code> ;-)"}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1452712440, "post_id": 34772358, "comment_id": 57295351, "body": "The point was I was trying to trick the preprocessor since if this would work it wouldn&#39;t be possible to specify the sizeof had to be replaced by an constant or it has to be evaluated. And was hoping to find some UB I wasn&#39;t aware of when array is evaluated or vla is even tryed to be set as constant. But probably this is one of the few reasons why arrays decay into pointers ;)"}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1452758302, "post_id": 34772358, "comment_id": 57312612, "body": "@Deduplicator: man I wrote this code freehanded without any IDE. I&#39;m aware of this but wasn&#39;t sure about the notation and tryed to avoid using some notation that even doesn&#39;t exist. But this isn&#39;t even the point of the post. Anyway to shut this down I&#39;ll change it."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1452777923, "post_id": 34772358, "comment_id": 57324664, "body": "@Deduplicator: what do you mean by this?"}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": true, "score": 23, "last_activity_date": 1452705975, "last_edit_date": 1495541233, "creation_date": 1452703655, "answer_id": 34772358, "question_id": 34772313, "link": "https://stackoverflow.com/questions/34772313/is-this-code-well-defined-by-using-sizeof-operator/34772358#34772358", "title": "Is this code well defined by using sizeof operator?", "body": "<p>Yes it is valid and will give the size of an <code>int</code> pointer (that's what the type of the <code>arr</code> parameter is, there are no array parameters in C) in bytes. <sup>1</sup></p>\n\n<p>To get the size of an array in bytes with <code>sizeof</code>, the argument has to be an actual array, not a pointer.</p>\n\n<p>Consequently, it's not possible to get the size of an array passed as a parameter inside a function without passing an extra parameter specifying the size.</p>\n\n<p>So,</p>\n\n<blockquote>\n  <p>is there a way to make <code>test()</code> output different values by using sizeof on function argument handed in like on array?</p>\n</blockquote>\n\n<p>no. (Without editing the function body.)</p>\n\n<p><sup>1</sup> If you're wondering how it's possible to pass an array as a pointer parameter, it's because of the implicit array-to-pointer conversion, known as <a href=\"https://stackoverflow.com/q/1461432/3425536\">array decaying</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1452707734, "post_id": 34773506, "comment_id": 57292433, "body": "<i>it is equivalent to: sizeof(int)</i>: you mean <code>sizeof(int *)</code>?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1452707866, "post_id": 34773506, "comment_id": 57292518, "body": "Also note that no overloading in C."}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1452708035, "post_id": 34773506, "comment_id": 57292616, "body": "@haccks there is something about function overloading in C here: <a href=\"http://stackoverflow.com/questions/479207/function-overloading-in-c\" title=\"function overloading in c\">stackoverflow.com/questions/479207/function-overloading-in-c</a> , but I guess it&#39;s too complex and a bit off topic ? Should I remove it?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1452708162, "post_id": 34773506, "comment_id": 57292671, "body": "I would suggest better to remove it."}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1452708262, "post_id": 34773506, "comment_id": 57292752, "body": "@haccks fair enough!  :)"}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 1, "creation_date": 1452709611, "post_id": 34773506, "comment_id": 57293562, "body": "&quot;<i><code>arr[]</code> outside the function points to the whole array</i>&quot; Nope, it doesn&#39;t point. Arrays don&#39;t point. Pointers point. Outside the function, <code>arr</code> <i>is</i> the array."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1452722583, "post_id": 34773506, "comment_id": 57300848, "body": "There is <b>not</b> an implicit conversion from <code>size_t</code> to <code>int</code> in this code, that is why it is UB.  It&#39;s hard to describe code as &quot;valid&quot; when it causes UB."}], "tags": [], "owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "is_accepted": false, "score": 6, "last_activity_date": 1480071874, "last_edit_date": 1480071874, "creation_date": 1452707108, "answer_id": 34773506, "question_id": 34772313, "link": "https://stackoverflow.com/questions/34772313/is-this-code-well-defined-by-using-sizeof-operator/34773506#34773506", "title": "Is this code well defined by using sizeof operator?", "body": "<blockquote>\n  <p>Is this:</p>\n\n<pre><code>void test(int arr[]) {\n    printf(\"%d\\r\\n\", sizeof(arr));\n}\n</code></pre>\n  \n  <p>valid?</p>\n</blockquote>\n\n<p>It is NOT a valid<sup>1</sup> code, however it is equivalent to: <code>sizeof(int*)</code>, not size of the array, <code>arr</code>, because as you pass the array as an argument it <em>decays to a pointer<sup>2</sup></em> i.e. it looses the information about the size of the whole array. The only way to convey this information into a function is through an additional, second, parameter. </p>\n\n<blockquote>\n  <p>Is there a way to make <code>test()</code> output different values by using <code>sizeof</code> on function argument handed in like on array?</p>\n</blockquote>\n\n<p>If you want to print the size of the array you are passing, you could use something like: <code>sizeof(array)</code> as an second argument of the function, where the function signature would be:</p>\n\n<pre><code>void test(int arr[], size_t size); \n</code></pre>\n\n<p>you could insert the above as second argument and get the size of the first argument.</p>\n\n<hr>\n\n<p><sup>1. There is a type mismatch between <code>size_t</code>(the returning type of <code>sizeof()</code>) and <code>int</code> (the expected type matching the specifier <code>\"%d\"</code> in the <code>printf(),</code>, which leads to undefined behaviour.</sup></p>\n\n<p><sup>2. <code>arr[]</code> outside the function represents the whole array as an object and that is why if you apply <code>sizeof()</code> you will get the size of the whole array, however, when passed as argument, <code>arr</code> decays to a pointer of the array's first element and if you apply <code>sizeof()</code> you'll get the size of the type of the pointer.</sup></p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1452723054, "post_id": 34776153, "comment_id": 57301088, "body": "While you&#39;re fixing the <code>printf</code>, you might as well drop the <code>\\r</code>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1452725390, "last_edit_date": 1452725390, "creation_date": 1452716003, "answer_id": 34776153, "question_id": 34772313, "link": "https://stackoverflow.com/questions/34772313/is-this-code-well-defined-by-using-sizeof-operator/34776153#34776153", "title": "Is this code well defined by using sizeof operator?", "body": "<blockquote>\n  <p>Is this code well defined by using sizeof operator?</p>\n</blockquote>\n\n<p>Pedantically: No</p>\n\n<p><code>sizeof()</code> returns type <code>size_t</code>.  <code>\"%d\"</code> expects type <code>int</code>.  Using mis-match type results in undefined behavior (UB).  Step 1: Use matching specifier</p>\n\n<pre><code>// printf(\"%d\\r\\n\", sizeof(arr));\nprintf(\"%zu\\r\\n\", sizeof(arr));\n// or\nprintf(\"%d\\r\\n\", (int) sizeof(arr));\n</code></pre>\n\n<hr>\n\n<p>The following prints the size of a pointer <code>arr</code>.  The code in <code>main()</code> is not relevant.</p>\n\n<pre><code>void test(int arr[]) {\n  printf(\"%zu\\r\\n\", sizeof(arr));\n}\n\n// or simply: remove (), \\r of dubious value\n  printf(\"%zu\\n\", sizeof arr);\n</code></pre>\n"}], "owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 34772358, "answer_count": 3, "score": 9, "last_activity_date": 1480071874, "creation_date": 1452703564, "last_edit_date": 1452758412, "question_id": 34772313, "link": "https://stackoverflow.com/questions/34772313/is-this-code-well-defined-by-using-sizeof-operator", "title": "Is this code well defined by using sizeof operator?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nvoid test(int arr[]);\n\nint main ()\n{\n    int *arr[3];\n    int ar1[2] = { 1, 2 };\n    int ar2[3] = { 3, 4, 5 };\n    int vla[ar2[1]];\n    arr[0] = ar1;\n    arr[1] = ar2;\n    arr[2] = vla;\n\n    for  (int i = 0; i &lt; 3; i++)\n    {\n        test(arr[i]);\n    }\n}\n\nvoid test(int arr[])\n{\n    printf(\"%zu\\r\\n\", sizeof(arr));\n}\n</code></pre>\n\n<p>As the title say: is this valid? and if so, is there a way to make <code>test()</code> output different values by using <code>sizeof</code> on function argument handed in like on array?</p>\n"}, {"tags": ["c", "avr", "bit-shift", "avr-gcc", "twos-complement"], "comments": [{"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1453909602, "post_id": 34771644, "comment_id": 57808005, "body": "Instead of <code>TCNT1H</code> and <code>TCNT1L</code> you can <a href=\"http://stackoverflow.com/questions/14161918/does-avr-gcc-properly-works-with-16-bit-avr-i-o-registers\">just use <code>TCNT1</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 7997, "user_id": 66363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd2a69d2d8c93796e3f4a55d70db00d?s=128&d=identicon&r=PG", "display_name": "uncleO", "link": "https://stackoverflow.com/users/66363/uncleo"}, "edited": false, "score": 1, "creation_date": 1452715913, "post_id": 34775825, "comment_id": 57297448, "body": "In AVR, <code>TCNT1L</code> and <code>TCNT1H</code> are hardware addresses of 8-bit values. They are defined as uint8_t, so the idiom will work even without casting to uint8_t first."}, {"owner": {"reputation": 7997, "user_id": 66363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd2a69d2d8c93796e3f4a55d70db00d?s=128&d=identicon&r=PG", "display_name": "uncleO", "link": "https://stackoverflow.com/users/66363/uncleo"}, "edited": false, "score": 3, "creation_date": 1452716247, "post_id": 34775825, "comment_id": 57297630, "body": "Actually, now that I look closer, <code>-640</code> is not unintuitive. It is clear what is meant: The overflow interrupt occurs when the count on the clock, <code>TCNT</code>, rolls over to reach 0. The interrupt handler resets the count to -640 (or 2^16 - 640) so it will fire again after another 640 cycles. (You still get an upvote, though.)"}, {"owner": {"reputation": 544, "user_id": 5483150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a7a58101fe1a12044906b3dc7a3199?s=128&d=identicon&r=PG&f=1", "display_name": "vega8", "link": "https://stackoverflow.com/users/5483150/vega8"}, "reply_to_user": {"reputation": 7997, "user_id": 66363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd2a69d2d8c93796e3f4a55d70db00d?s=128&d=identicon&r=PG", "display_name": "uncleO", "link": "https://stackoverflow.com/users/66363/uncleo"}, "edited": false, "score": 0, "creation_date": 1452717334, "post_id": 34775825, "comment_id": 57298242, "body": "Totally agree...it&#39;s actually quite elegant! I would have naively set <code>OCR1A</code> and used <code>TIMER1_COMPA_vect</code> (which would have been longer). thx for pointing that out!"}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "edited": false, "score": 0, "creation_date": 1453379924, "post_id": 34775825, "comment_id": 57581441, "body": "i would also call this bad programming. To make this elegant you should hide the adding of the &#39;-&#39; and the cast to the proper Type in a macro. with some explaining comments."}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1453909944, "post_id": 34775825, "comment_id": 57808258, "body": "@vega8 To me, the <code>OCR1A</code> approach is preferrable, because 1. that&#39;s one of the intended uses of the <code>OCR</code> interrupts and 2. <code>TCNT1</code> can be used for other purposes at the same time since <code>OCR1B</code> and the TOI can still be used independently (apart from the timer&#39;s frequency they all must share)."}], "tags": [], "owner": {"reputation": 544, "user_id": 5483150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a7a58101fe1a12044906b3dc7a3199?s=128&d=identicon&r=PG&f=1", "display_name": "vega8", "link": "https://stackoverflow.com/users/5483150/vega8"}, "is_accepted": false, "score": 5, "last_activity_date": 1452717474, "last_edit_date": 1452717474, "creation_date": 1452714778, "answer_id": 34775825, "question_id": 34771644, "link": "https://stackoverflow.com/questions/34771644/shifting-right-a-negative-number/34775825#34775825", "title": "Shifting right a negative number", "body": "<p>The answer to this question is <a href=\"https://en.wikipedia.org/wiki/Two&#39;s_complement\" rel=\"nofollow\">two's complement</a> and <a href=\"https://en.wikipedia.org/wiki/Bitwise_operation#Bit_shifts\" rel=\"nofollow\">bit shift</a>.</p>\n\n<p>In the code above, -640 is just a fancy <s>(and unintuitive)</s> way of writing the bit pattern <code>1111 1101 1000 0000</code> while the <code>&gt;&gt;8</code> part is a frequently used idiom for cutting off the lower 8 bits.</p>\n\n<hr>\n\n<p>It's probably not the cleanest way of setting the AVR timer registers in C since at least the second assignment <code>TCNT1L=(-640);</code> depends on the assumption that the compiler will discard all bits above the 8 least significant bits. (Most (?) compilers (including avr-gcc I guess) will actually do exactly that but it's not guaranteed and implementation-dependent behavior AFAIK.)</p>\n"}], "owner": {"reputation": 37, "user_id": 5768040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5288024650ec7a780a923aea40920306?s=128&d=identicon&r=PG&f=1", "display_name": "splash", "link": "https://stackoverflow.com/users/5768040/splash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452720379, "creation_date": 1452701750, "last_edit_date": 1452720379, "question_id": 34771644, "link": "https://stackoverflow.com/questions/34771644/shifting-right-a-negative-number", "title": "Shifting right a negative number", "body": "<pre><code>#include &lt;avr/io.h&gt;\n#include &lt;avr/interrupt.h&gt;\nint main()\n{           \n  DDRB|=0x82;\n  DDRC=0x00;\n  DDRD=0xFF;\n  TCNT1H=(-640)&gt;&gt;8;\n  TCNT1L=(-640);\n  TCCR1A=0X00;\n  TCCR1B=0X01;\n  TIMSK=(1&lt;&lt;TOIE0)|(1&lt;&lt;TOIE1)\n  sei();\n  PORTD=PINC;\n}\n\nISR(TIMER1_OVF_vect)\n{\n  TCNT1H=(-640)&gt;&gt;8;\n  TCNT1L=(-640);\n  PORTB^=0X80;\n}\n</code></pre>\n\n<p>Please help me out with <code>TCNT1H=(-640)&gt;&gt;8;  TCNT1L=(-640);</code> code....it's really confusing as I have been using values from 0-256....</p>\n"}, {"tags": ["c++", "c", "makefile", "mosek"], "comments": [{"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452705084, "post_id": 34771607, "comment_id": 57290748, "body": "Have you tried to find out <i>which</i> library is causing this? (Binary search through the list, etc.)"}, {"owner": {"reputation": 183, "user_id": 4926404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02495b1c89744e3ad26cce0fa7519b8?s=128&d=identicon&r=PG", "display_name": "Mohammad Fawaz", "link": "https://stackoverflow.com/users/4926404/mohammad-fawaz"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452706245, "post_id": 34771607, "comment_id": 57291496, "body": "@EtanReisner It seems that the problem is with umfpack and the libraries that come after it, but not in any particular one. I had to remove all of them for it to work. Even letting &quot;$(LIBS) = -umfpack &quot; only didn&#39;t work."}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452706621, "post_id": 34771607, "comment_id": 57291719, "body": "So using boost is ok but using any of the libraries from umfpack to the end (even one at a time) breaks this? Or does only umfpack break it?"}, {"owner": {"reputation": 183, "user_id": 4926404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02495b1c89744e3ad26cce0fa7519b8?s=128&d=identicon&r=PG", "display_name": "Mohammad Fawaz", "link": "https://stackoverflow.com/users/4926404/mohammad-fawaz"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452707198, "post_id": 34771607, "comment_id": 57292113, "body": "@EtanReisner So I tried adding the libraries separately, one at a time, and it seems that the problematic ones are umfpack, lapack, and blas."}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452707418, "post_id": 34771607, "comment_id": 57292234, "body": "It might make sense to see if those libraries have communities you can ask about this? And or see is MOSEK does. Someone here will likely have ideas about this but whether they see this question or not is the real question. I don&#39;t know anything about any of these pieces so I can&#39;t really help anymore, sorry."}, {"owner": {"reputation": 183, "user_id": 4926404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02495b1c89744e3ad26cce0fa7519b8?s=128&d=identicon&r=PG", "display_name": "Mohammad Fawaz", "link": "https://stackoverflow.com/users/4926404/mohammad-fawaz"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1452713862, "post_id": 34771607, "comment_id": 57296242, "body": "@EtanReisner Thank you anyways."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 4926404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02495b1c89744e3ad26cce0fa7519b8?s=128&d=identicon&r=PG", "display_name": "Mohammad Fawaz", "link": "https://stackoverflow.com/users/4926404/mohammad-fawaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1461011739, "creation_date": 1461011739, "answer_id": 36703810, "question_id": 34771607, "link": "https://stackoverflow.com/questions/34771607/libraries-affecting-other-libraries-in-a-makefile/36703810#36703810", "title": "Libraries affecting other libraries in a Makefile", "body": "<p>It turns out that the problem was with BLAS. Some of the libraries from SuiteSparse require BLAS and the BLAS libraries on the server messes up with OpenMP, which is apparently required by MOSEK to parallelize its code. In any case, the solution was to use OpenBLAS, compiled with the flag \"USE_OPENMP=1\".</p>\n"}], "owner": {"reputation": 183, "user_id": 4926404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02495b1c89744e3ad26cce0fa7519b8?s=128&d=identicon&r=PG", "display_name": "Mohammad Fawaz", "link": "https://stackoverflow.com/users/4926404/mohammad-fawaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1461011739, "creation_date": 1452701664, "question_id": 34771607, "link": "https://stackoverflow.com/questions/34771607/libraries-affecting-other-libraries-in-a-makefile", "title": "Libraries affecting other libraries in a Makefile", "body": "<p>I am facing a weird problem in the following Makefile:</p>\n\n<pre><code># Mosek path\nMOSEKPATH = /autofs/fs1.ece/fs1.eecg.najm/b/b1/power_grid_code/mosek\n\n# Include paths\nINCPATHS = -I$(MOSEKPATH)/7/tools/platform/linux64x86/h -I/usr/include/suitesparse -I../include\n\n# Libraries paths\nLIBPATHS = -L$(MOSEKPATH)/7/tools/platform/linux64x86/bin\n\n# Link libraries\nLIBS = -lboost_timer-mt -lboost_system -lumfpack -lamd -lcolamd -lcholmod -lccolamd -lcamd -lbtf -lcsparse -lcxsparse -lklu -lldl -lspqr -llapack -lblas\nMOSEKLIB = -lmosek64\nLDOPT = -Wl,-rpath-link,$(MOSEKPATH)/7/tools/platform/linux64x86/bin -Wl,-rpath,'/autofs/fs1.ece/fs1.eecg.najm/b/b1/power_grid_code/mosek/7/tools/platform/linux64x86/bin' -pthread -lc -lm\n\n# Specify compiler\nCC = g++-4.7 -m64\n\n# Compiler flags\nFLAGS = -O3 -Wall -g\n\nlo1: lo1.c\n    $(CC) $(FLAGS) -c $(INCPATHS)          -o lo1.o lo1.c\n    $(CC) $(FLAGS) $(LIBPATHS) lo1.o $(LIBS) $(MOSEKLIB) $(LDOPT) -o lo1 \n\nclean:\n    rm -f lo1 *.o \n</code></pre>\n\n<p>I got most of the content from the examples provided by <a href=\"https://mosek.com/\">MOSEK</a>. The Makefile works fine and the results are as expected. The issue is that, the version of MOSEK that I'm using is multi-threaded (MOSEK 7.1). MOSEK is supposed to detect the number of cores on the machine, and use all of them. When I use the Makefile as is, MOSEK only detects one core, and uses only one thread:</p>\n\n<pre><code>Computer\n  Platform               : Linux/64-X86    \n  Cores                  : 1              \n</code></pre>\n\n<p>However, when i compile without $(LIBS), MOSEK does detect 4 cores:</p>\n\n<pre><code>Computer\n  Platform               : Linux/64-X86    \n  Cores                  : 4               \n</code></pre>\n\n<p>The code that I have in lo1.c does not use $(LIBS) for now, but I will need those libraries later on, in lo1.c. How come those libraries are affecting the behavior of MOSEK?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "byte", "pic", "lcd", "embedded-control"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1452700851, "post_id": 34771317, "comment_id": 57287485, "body": "Can&#39;t read your code."}, {"owner": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452700934, "post_id": 34771317, "comment_id": 57287545, "body": "In what way? Have I excluded some important aspects? Incorrect formatting?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452700973, "post_id": 34771317, "comment_id": 57287568, "body": "Yes, 0 indentation and one-line <code>if</code> statements are also hard to read."}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1452701078, "post_id": 34771317, "comment_id": 57287645, "body": "Well, not really if you want to read it. Indent is a nice thing nevertheless and helps us to help you @James."}, {"owner": {"reputation": 298, "user_id": 4206613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc66dc117a13e548d125f627589ad817?s=128&d=identicon&r=PG", "display_name": "doppelheathen", "link": "https://stackoverflow.com/users/4206613/doppelheathen"}, "edited": false, "score": 0, "creation_date": 1452701190, "post_id": 34771317, "comment_id": 57287739, "body": "I can only assume &quot;uch&quot; is supposed to be typedef for unsigned char, even though I don&#39;t see TZ declared anywhere.  The thing is, if you&#39;re using WriteString to print the temperature, shouldn&#39;t it be converted to a string first?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1452701199, "post_id": 34771317, "comment_id": 57287746, "body": "<code>writeString</code> want as null terminated string, is quite clear..... You are passing a <code>uch</code> var, that I guess is an <code>unsigned char</code>. I don&#39;t know your framework (Microchip uP I guess), but take a look at <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_sprintf.htm\" rel=\"nofollow noreferrer\">THIS</a>"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1452701438, "post_id": 34771317, "comment_id": 57287918, "body": "@James what is the device you are using?"}, {"owner": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "reply_to_user": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1452701972, "post_id": 34771317, "comment_id": 57288324, "body": "I am using a Q200 PIC board with a PIC16F877A, with a HiTech C compiler @tinky_winky. The writeString function is of my own making, currently looking into using itoa() to change the unsigned char into ASCII"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1452702133, "post_id": 34771317, "comment_id": 57288459, "body": "this should do the thing"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452702397, "post_id": 34771317, "comment_id": 57288653, "body": "Aside: The line <code>TZ&#47;100;</code> will compile but is non-productive code (has no effect). Should be <code>TZ&#47;=100;</code> ?"}, {"owner": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "edited": false, "score": 0, "creation_date": 1452702593, "post_id": 34771317, "comment_id": 57288813, "body": "It does indeed, much appreciated folks! Odd that I would forget that this is actually similar to an error i tackled a month ago and forgot about. Thanks for your time."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1452702624, "post_id": 34771317, "comment_id": 57288837, "body": "PS don&#39;t ignore compiler warnings!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1452703079, "post_id": 34771317, "comment_id": 57289235, "body": "<i>PS don&#39;t ignore compiler warnings!</i>  Indeed.  When the authors of the compiler you&#39;re using to turn your source code into a runnable binary think you did something sketchy, <b>you need to listen to them</b>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452880094, "post_id": 34771317, "comment_id": 57375882, "body": "this loop: <code>while(*stringToLcd &gt; 0)     {         writeChar(*stringToLcd++);     }</code> would be better written as: <code>for(int i =0; stringToLcd[i]; i++)     {         writeChar(stringToLcd[i]);     }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452881755, "post_id": 34771317, "comment_id": 57376668, "body": "the calculations involving the <code>TX</code> variable are expected to result in a BCD value.  However, that is not the case.  For instance, if only the 0x40 bit were set, then <code>wd</code> is set to 2500 which is 0x94C which is not a valid BCD value.  This is because valid BCD nibbles can only contain 0b0000 through 0b1001 (0...9). and 0x9C4 is 0b0000, 0b1001, bad value, 0b0100.  Also addition of BCD values cannot be perform via <code>wd = wd+2500;</code> but take specific code algorithms."}], "answers": [{"comments": [{"owner": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "edited": false, "score": 0, "creation_date": 1452702193, "post_id": 34771554, "comment_id": 57288503, "body": "I&#39;ve added details of my write functions as I stupidly left them out, as shown my writeString function actually takes a pointer to characters, so i&#39;m not sure if thats the fix I&#39;m looking for"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "edited": false, "score": 0, "creation_date": 1452702321, "post_id": 34771554, "comment_id": 57288603, "body": "@James - Well, you certainly can&#39;t provide a <code>uch</code> as a pointer. You&#39;ll need to convert that value to a string first, perhaps by using <code>itoa()</code>."}, {"owner": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "edited": false, "score": 0, "creation_date": 1452702555, "post_id": 34771554, "comment_id": 57288775, "body": "I take it back, upon re-reading, this is EXACTLY the fix I was looking for. All summed up into a neat post. Much appreciated for the prompt answer."}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": true, "score": 2, "last_activity_date": 1452702561, "last_edit_date": 1452702561, "creation_date": 1452701516, "answer_id": 34771554, "question_id": 34771317, "link": "https://stackoverflow.com/questions/34771317/cant-extract-an-integer-from-a-thermometer-byte-reading/34771554#34771554", "title": "Can&#39;t extract an integer from a thermometer byte reading", "body": "<p><code>Temp</code> is an <code>unsigned char</code></p>\n\n<pre><code>uch Temp;\n//...\nTemp = get_temp();\nwriteString(Temp);\n</code></pre>\n\n<p>So, using <code>writeString()</code> will produce undefined results.</p>\n\n<p>You should use <code>write()</code> instead (depending on the library you're using).</p>\n\n<p>But you probably want to convert the return value of <code>get_temp()</code> to an ASCII string first, and display that using <code>writeString()</code>.</p>\n\n<p><strong>Update</strong>:</p>\n\n<pre><code>void writeString(char *stringToLcd)\n</code></pre>\n\n<p>This function needs a <code>char*</code>, so you can't provide a single <code>uch</code>.</p>\n\n<p>You need to convert <code>Temp</code> to a string first, using <code>itoa()</code> for example.</p>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1452704639, "last_edit_date": 1452704639, "creation_date": 1452702672, "answer_id": 34771985, "question_id": 34771317, "link": "https://stackoverflow.com/questions/34771317/cant-extract-an-integer-from-a-thermometer-byte-reading/34771985#34771985", "title": "Can&#39;t extract an integer from a thermometer byte reading", "body": "<p>I could suggest you to implement a new function</p>\n\n<pre><code>void writeUCH(uch value)\n{\n    unsigned char test = (value &gt;= 100) ? 100 : (value &gt;= 10) ? 10 : 1;\n\n    while(test &gt; 0)\n    {\n        writeChar((value/test)+'0');\n\n        value = value%test;\n        test /= 10;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1452880788, "last_edit_date": 1452880788, "creation_date": 1452879876, "answer_id": 34816834, "question_id": 34771317, "link": "https://stackoverflow.com/questions/34771317/cant-extract-an-integer-from-a-thermometer-byte-reading/34816834#34816834", "title": "Can&#39;t extract an integer from a thermometer byte reading", "body": "<p>this line: </p>\n\n<pre><code>TZ/100;\n</code></pre>\n\n<p>will result in no change to TZ</p>\n\n<p>what you really want is this:</p>\n\n<pre><code>TZ = TZ%100;\n</code></pre>\n\n<p>the value returned from <code>get_temp()</code> is an integer, not a ascii string.  I would expect the LCD needs ascii characters, not the binary value of the bytes of an <code>int</code> variable.</p>\n"}], "owner": {"reputation": 356, "user_id": 4707724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b5d38ea96eac24a131de33bb55015ea1?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4707724/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 34771554, "answer_count": 3, "score": 3, "last_activity_date": 1452880788, "creation_date": 1452700830, "last_edit_date": 1452702047, "question_id": 34771317, "link": "https://stackoverflow.com/questions/34771317/cant-extract-an-integer-from-a-thermometer-byte-reading", "title": "Can&#39;t extract an integer from a thermometer byte reading", "body": "<p>Afternoon all,</p>\n\n<p>Apologies if this question is in the wrong format or in the wrong place, if this is the case, please flag and I'll change it or take it elsewhere.</p>\n\n<p>I am using a development board to send a temperature reading to an LCD panel and I am really struggling to comprehend as to why the temperature at the moment that the program is run isn't being printed onto my LCD. A lot of the code is from framework given to me and is correct as far as I can tell.</p>\n\n<p>My question stems from these functions:</p>\n\n<pre><code>uch get_temp()\n{\n    int i;\n    DQ_HIGH();\n    reset();                              //reset,wait for  18b20 responsion\n    write_byte(0XCC);                     //ignore ROM matching\n    write_byte(0X44);                     //send  temperature convert command\n    for(i=20;i&gt;0;i--)\n        {\n\n            //display();                    //call some display function,insure the time of convert temperature\n        }\n    reset();                              //reset again,wait for 18b20 responsion\n    write_byte(0XCC);                     //ignore ROM matching\n    write_byte(0XBE);                     //send read temperature command\n    TLV=read_byte();                      //read temperature low byte\n    THV=read_byte();                      //read temperature high byte\n    DQ_HIGH();                            //release general line\n    TZ=(TLV&gt;&gt;4)|(THV&lt;&lt;4)&amp;0X3f;            //temperature integer\n    TX=TLV&lt;&lt;4;  //temperature decimal\n\n    if(TZ&gt;100) \n    {\n        TZ/100; \n    }                   //not display hundred bit\n\n    ge=TZ%10;                     //integer Entries bit\n    shi=TZ/10;                    //integer ten bit\n    wd=0;\n\nif (TX &amp; 0x80) \n    wd=wd+5000;\n\nif (TX &amp; 0x40) \n    wd=wd+2500;\n\nif (TX &amp; 0x20) \n    wd=wd+1250;\n\nif (TX &amp; 0x10)\n    wd=wd+625;                //hereinbefore four instructions are turn  decimal into BCD code\n\n    shifen=wd/1000;                          //ten cent bit\n    baifen=(wd%1000)/100;                    //hundred cent bit\n    qianfen=(wd%100)/10;                     //thousand cent bit\n    wanfen=wd%10;                            //myriad cent bit\n    NOP();\n    return TZ;\n}\n</code></pre>\n\n<p>I have modified this function so that it should return the temperature integer (unsigned char TZ)</p>\n\n<p>This function is then called here:</p>\n\n<pre><code>void Init_lcd(void)\n{\n    ADCON1 = 0x07; //required setting of analog to digital\n\n    uch Temp;\n\n    TRISD = 0x00;\n    TRISA1 = 0;\n    TRISA2 = 0;\n    TRISA3 = 0;\n\n    writeCommand(0x0f);\n    writeCommand(0x38); //set to two line mode\n    clearDisplay();\n\n    writeString(\"MAIN MENU\");\n    Temp = get_temp();\n    writeString(Temp);\n    writeCommand(0xC0); //change cursor line\n\n}\n</code></pre>\n\n<p>It isn't printing anything after \"MAIN MENU\", which obviously means I'm doing something wrong. I can provide further clarification/code on request.</p>\n\n<p>I should probably mention that I am NOT only simply looking for an answer of \"paste this in and it'll work\". Any feedback in which I understand my mistake and how to fix it is greatly appreciated. </p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:</p>\n\n<p>A few people are asking about my writing functions so for further clarification I'll paste them here:</p>\n\n<pre><code>void writeChar(unsigned char ch)\n{\n    lcd = ch;\n    RS = 1;\n    RW =0;\n    E = 1;\n    lcdDelay();\n    E=0;\n}\n\nvoid writeString(char *stringToLcd)\n{\n    while(*stringToLcd &gt; 0)\n    {\n        writeChar(*stringToLcd++);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1452699659, "post_id": 34770675, "comment_id": 57286545, "body": "Don&#39;t forget to check that the calls worked.  Don&#39;t forget to save the return value from <code>fread()</code>; you need it to know how many bytes to write.  You need to use a more complex <code>printf()</code> format because the string you read won&#39;t be null-terminated. If you got an <code>int nbytes = fread(\u2026);</code> then you need <code>printf(&quot;%*.*s\\n&quot;, n, n, array)</code> to write the data.  Note that newlines go at the end of the output line, not the beginning.  How big is the text file?  Less than 200 characters or bigger?  Do you need the whole file in memory?"}], "answers": [{"tags": [], "owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "is_accepted": false, "score": 0, "last_activity_date": 1452700016, "creation_date": 1452700016, "answer_id": 34770994, "question_id": 34770675, "link": "https://stackoverflow.com/questions/34770675/how-do-i-save-a-text-file-into-an-array/34770994#34770994", "title": "How do I save a text file into an array?", "body": "<p>You can also do a <code>mmap</code> and then work with the memory which reflects the content of your file. No explicit \"loading\" is required in that case. Man mmap.</p>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": true, "score": 1, "last_activity_date": 1452700753, "last_edit_date": 1452700753, "creation_date": 1452700266, "answer_id": 34771098, "question_id": 34770675, "link": "https://stackoverflow.com/questions/34770675/how-do-i-save-a-text-file-into-an-array/34771098#34771098", "title": "How do I save a text file into an array?", "body": "<p>Using <code>fscanf</code> you can read data in file and store it in a 2-d <code>char</code> array . Something like this -</p>\n\n<pre><code>char array[20][200];              // array to hold data in file\nint i=0;\nfile = fopen(\"test.txt\", \"r\");\nif(file==NULL){                   // error in opening file\n        //handle it\n }\nwhile(fscanf(file,\"%199[^\\n]%*c\",array[i])==1){\n      // handle your data \n      i++;             // increment index\n} \n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 5240796, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d43565e12ea2a7d02208cfde0ce8b4e4?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/5240796/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "closed_date": 1452700332, "accepted_answer_id": 34771098, "answer_count": 2, "score": -3, "last_activity_date": 1452700753, "creation_date": 1452699234, "question_id": 34770675, "link": "https://stackoverflow.com/questions/34770675/how-do-i-save-a-text-file-into-an-array", "closed_reason": "Needs more focus", "title": "How do I save a text file into an array?", "body": "<p>This is how I print out the text file</p>\n\n<pre><code>FILE *file;\nchar array[200];\n\nfile = fopen(\"test.txt\", \"r\");\n\nfread(array,1, 200, file);\nprintf(\"\\n%s\", array);\nfclose(file);\n</code></pre>\n\n<p>Instead I want to save the text file rows to an array so i can print out the text file with the array.</p>\n\n<p>I can only use those fopen,fprintf,fwrite,fscanf,fread,fseek,fclose. Not fget.</p>\n\n<p>How do i save the text file lines to an array?</p>\n"}, {"tags": ["c", "windows", "visual-studio-2015"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452698539, "post_id": 34770370, "comment_id": 57285651, "body": "Don&#39;t include <code>*.c</code> files!"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452698652, "post_id": 34770370, "comment_id": 57285726, "body": "and I think it has something to do with the <i>huge</i> arrays allocated.."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1452698780, "post_id": 34770370, "comment_id": 57285819, "body": "Run it with the debugger and it will tell you (and us) <i>where</i> the crash occurs."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452698911, "post_id": 34770370, "comment_id": 57285930, "body": "Thank you.  The include file isn&#39;t really a .h file, and I haven&#39;t had any problems including .c files in the past.  Like I said, when I comment any lines in the include file, like those of the arrays, the program works.  The larger program worked up until 3 days ago when I changed something and it started not working.  It&#39;s taken me this long to narrow the problem down to the smallest size that reproduces the error."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1452699063, "post_id": 34770370, "comment_id": 57286026, "body": "I will repeat: Don&#39;t include <code>*.c</code> files. Regardless of can you some how make it work or not. By &quot;any line&quot; do you mean blank lines as well? Or the ones declaring arrays only?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452699231, "post_id": 34770370, "comment_id": 57286151, "body": "Supporting @EugeneSh. If you <code>#include</code> a <code>.c</code> file, your project is set up wrong. Split the file into a header and an implementation (i.e. <code>.c</code>) file."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452699747, "post_id": 34770370, "comment_id": 57286609, "body": "@ Michael Waltz:  Well, I consistently got this message unless I commented out a line in the FilMst5.c include file.  But I just now executed the program by &quot;Start Debugging&quot; and the program worked okay.  I then tried the option to &quot;Start  Without Debugging&quot; and it still worked okay, when before I got the error message.  I tried executing the larger program with &quot;Start Debugging&quot; and still got the following message: <code>Exception thrown at 0x000000013F10942F in CrtPF.exe: 0xC0000005: Access violation writing location 0x000000012E7CDBE8.</code>."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452699911, "post_id": 34770370, "comment_id": 57286737, "body": "@Eugene Shand and Olaf:  Thank you.  Perhaps you are right.  My thinking was that I have common subroutines that several programs use.  I don&#39;t know how to create a shared library DLL, so all I can do to avoid repeated copying is include the common .c code."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452700003, "post_id": 34770370, "comment_id": 57286817, "body": "@EugeneSh:  I only commented out actual lines of code, not blank lines.  The program worked even if I only commented out a definition of a field in the FilMstStc structure.  It also worked if I commented out the large arrays."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452700084, "post_id": 34770370, "comment_id": 57286888, "body": "@J.Toran You can use the same C file in different programs, if you &quot;add&quot; it to your project as a &quot;source file&quot; without copying, but only by pointing to it as &quot;source directory&quot;. But I still think you have memory issues here. Try reducing the array sizes."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1452700275, "post_id": 34770370, "comment_id": 57287036, "body": "And as a general thing: If you don&#39;t know how to do something correctly, don&#39;t work it around incorrectly. Just learn how to do it correctly."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452700600, "post_id": 34770370, "comment_id": 57287297, "body": "@EugeneSh.:  Thank you.  I&#39;m not sure how to add the common C code as a source file, but I will give it a try.  Also I <b>decreased</b> the size from 250,000,000 to 100,000,000 and I&#39;m getting <code>Error\tLNK1248\timage size (941E1000) exceeds maximum allowable size (80000000)\tCrtPF\tC:\\$SmpSysLib\\$QsysS\\CrtPF\\CrtPF\\LINK\t1</code>.  I will work on it some more."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452700694, "post_id": 34770370, "comment_id": 57287373, "body": "Better to obtain memory from <code>malloc</code> or <code>calloc</code> than use such large static arrays."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452700935, "post_id": 34770370, "comment_id": 57287547, "body": "I am starting to think you are hitting the array size limit of the compiler"}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1452701460, "post_id": 34770370, "comment_id": 57287930, "body": "@EugeneSh.:  I decreased the arrays sizes to 10,000,000 and the program compiled okay and ran until I got a debug assertion failed message.  I probably did something stupid.  Also, I did an &quot;Add Existing Item&quot; from the Project menu and the .c files showed up as source files, but then the program wouldn&#39;t compile with strange error messages.  I&#39;ll have to work on it."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452701690, "post_id": 34770370, "comment_id": 57288103, "body": "@WeatherVane:  You&#39;re right."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452701878, "post_id": 34770370, "comment_id": 57288257, "body": "I notice you have hard coded the array lengths. How does that impact on the code&#39;s array indexing  when you change them? I would expect to see <code>#define ARRLEN 250000000</code> to be used for array definitions, loop control, bounds checking, etc."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1452703594, "post_id": 34770370, "comment_id": 57289630, "body": "@WeatherVane:  Right again.  Normally I would but hadn&#39;t for this test program."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452704880, "post_id": 34770370, "comment_id": 57290591, "body": "@user3629249 they are both in the included C file. Which has been frowned on in comment, and the resulting confusion also caused a similar answer to your comment  to be made and then deleted."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452706173, "post_id": 34770370, "comment_id": 57291450, "body": "this file: <code>FilMst5.c</code>, (which should be named: <code>FilMst5.h</code>) does not define the variable: <code>FilMstFilPtr</code>.   Also, variable declarations should never be in a #include&#39;d file, because if that that file is #include&#39;d in more that one place, then the compiler will raise &#39;flags&#39;  about duplicate definition of variables.  a function+body should never be #include&#39;d unless that function has the <code>inline</code> modifier."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452706963, "post_id": 34770370, "comment_id": 57291952, "body": "@user3629249 I repeat: &quot;FilMst5.c&quot; <b><i>does</i></b> contain <code>FILE * FilMstFilPtr;</code> and <code>FILE * Opn(char PthNam[], char OpnMod[]);</code>. See what chaos it brings?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452707619, "post_id": 34770370, "comment_id": 57292370, "body": "regarding this comment: <i>My thinking was that I have common subroutines that several programs use. I don&#39;t know how to create a shared library DLL, so all I can do to avoid repeated copying is include the common .c code</i> rather than #including the *.c file,  just use function prototypes.  (which probably should be in a header file) The linker will take care of the rest of it."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452707955, "post_id": 34770370, "comment_id": 57292565, "body": "@user3629249 and Weather Vane:  I can&#39;t manage to add the file to the project, rather than including it.  <a href=\"http://stackoverflow.com/questions/34773522/trying-to-understand-simple-task-of-adding-files-to-vs-projects\">So I asked here.</a>"}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452712592, "post_id": 34770370, "comment_id": 57295451, "body": "I don&#39;t know if anyone is still following these comments, but I was wondering if <code>typedef</code>s belong in the header or the C code?  I take it they go in the header."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452713307, "post_id": 34770370, "comment_id": 57295863, "body": "if the resultant type will be used in more than one source file, then they belong in the header file.  if the usage is limited to a single source file, then it is better to keep the typedef local to the source file."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452764108, "post_id": 34770370, "comment_id": 57315958, "body": "@user3629249 and Weather Vane and others:  Thanks for all your help.  I&#39;m still a beginner so I appreciate your patience."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452709574, "post_id": 34774017, "comment_id": 57293534, "body": "Thank you.  I&#39;m trying this out.  I got a compile warning message <code>Warning\tC4603\t&#39;_CRT_SECURE_NO_WARNINGS&#39;: macro is not defined or definition is different after precompiled header use</code> so I commented that line out.  Now I&#39;m getting something I&#39;ve never seen before.  On the opening brackets of both <code>main()</code> and <code>Opn</code> I get the following message:  <code>Error\tC2601\t&#39;main&#39;: local function definitions are illegal</code>"}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452709924, "post_id": 34774017, "comment_id": 57293760, "body": "Daggone, I just copied and pasted wrong.  I did get a <code>Error C2086 &#39;FILE *FilMstFilPtr&#39;: redefinition</code> message but I just commented one out and it worked fine."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452711783, "post_id": 34774017, "comment_id": 57294960, "body": "the <code>_CRT_SECURE_NO_WARNINGS</code> can be placed in  &quot;Preprocessor Definitions&quot; in the project settings/properties, then you can use the standard C library functions without getting any warnings"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452713038, "post_id": 34774017, "comment_id": 57295717, "body": "the &#39;local functions&#39; error message indicates some copy./paste error.   I compiled the code, on ubuntu linux, using gcc, added <code>#include &lt;errno.h&gt;</code> and commented out the <code>#include &lt;stdafx.h&gt;</code> (which only helps subsequent compiles) and the only problem is the call to <code>fopen_s()</code> which is a non-portable function from MSDN  Suggest posting your new files, as an additional text edit of the question."}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "edited": false, "score": 0, "creation_date": 1452713198, "post_id": 34774017, "comment_id": 57295805, "body": "Like I said, I just copied and pasted wrong.  It worked fine.  And I checked it as the correct answer."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1452708664, "creation_date": 1452708664, "answer_id": 34774017, "question_id": 34770370, "link": "https://stackoverflow.com/questions/34770370/getting-error-passing-a-pointer-to-file/34774017#34774017", "title": "getting error passing a pointer to file", "body": "<p>Strongly suggest writing code that is 'portable', even if it is only going to be used in a windows environment:</p>\n\n<p>This is accomplished by prefixing the file with:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n</code></pre>\n\n<p>then using the functions from the standard C libraries rather than the functions from the <code>windows.h</code> header/libraries</p>\n\n<p>the header file: FilMst5.h contents should be:</p>\n\n<pre><code>#pragma once\n\ntypedef struct {                                            \n    int                 FilRRN;\n    unsigned long long  FilOfs;\n    unsigned long long  FilID;\n    char                FilDir[10 + 1];\n    char                FilNam[10 + 1];\n    char                FilNamLcs[10 + 1];\n    char                FilDirLcs[10 + 1];\n    char                FilTypLcs[10 + 1];\n    char                FilAtr[10 + 1];\n    char                UsrID[10 + 1];\n    char                SysID[8 + 1];\n    char                FilSrcDir[10 + 1];\n    char                FilSrcMbr[10 + 1];\n} FilMstStc;\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL1OfsStc;\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL1Stc;\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL2Stc;\n\ntypedef struct {\n    unsigned long long  FilSID;\n} FilMstL3Stc;\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL4Stc;\n\nFILE * FilMstFilPtr;\n\nFILE * Opn(char PthNam[], char OpnMod[]);\n\ninline void WrtFilMstRcd(void)\n{\n}\n\n// enable other files to access the variables declared in main.c\nextern FilMstStc   FilMst;\nextern FilMstL1OfsStc  FilMstL1Ofs[250000000];\nextern FilMstL1Stc FilMstL1Key;\nextern FilMstL1Stc FilMstL1SchKey;\nextern FilMstL2Stc FilMstL2[250000000];\nextern FilMstL3Stc FilMstL3Key;\nextern FilMstL3Stc FilMstL3SchKey;\nextern FilMstL4Stc FilMstL4[250000000];\nextern FILE    * FilMstFilPtr;\n</code></pre>\n\n<hr>\n\n<p>the file: (lets call it <code>main.c</code>)</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include \"stdafx.h\"\n\n#include &lt;stdio.h&gt;\n\n#include \"FilMst5.h\"\n\nFilMstStc   FilMst;\nFilMstL1OfsStc  FilMstL1Ofs[250000000];\nFilMstL1Stc FilMstL1Key;\nFilMstL1Stc FilMstL1SchKey;\nFilMstL2Stc FilMstL2[250000000];\nFilMstL3Stc FilMstL3Key;\nFilMstL3Stc FilMstL3SchKey;\nFilMstL4Stc FilMstL4[250000000];\nFILE    * FilMstFilPtr;\n\n\nint main( void )\n{\n    FilMstFilPtr = Opn(\"\\\\temp\\\\test.file\", \"wb\");  // &lt;- error occurs here\n    printf(\"filptr=0x%p\\n\", FilMstFilPtr);\n    return 0;\n}\n\n//******************************************************************************\n//  Open a file\n//******************************************************************************\nFILE * Opn(char PthNam[], char OpnMod[])\n{\nFILE    * FilPtr = NULL;\n\n    errno = fopen_s(&amp;FilPtr, PthNam, OpnMod);\n    if (errno != 0) {\n        printf(\"%s\\n\", PthNam);\n        perror(\"Could not open file\");\n        return NULL;\n    }\n    printf(\"file opened for mode %s\\n\", OpnMod);\n    return FilPtr;\n}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 34774017, "answer_count": 1, "score": 0, "last_activity_date": 1452708664, "creation_date": 1452698414, "question_id": 34770370, "link": "https://stackoverflow.com/questions/34770370/getting-error-passing-a-pointer-to-file", "title": "getting error passing a pointer to file", "body": "<p>I'm still learning C, so please bear with me.  I'm getting an unusual error passing a pointer to file back from a function to <code>main()</code>.</p>\n\n<p>The code follows:</p>\n\n<pre><code>#include \"stdafx.h\"\n\n#include \"FilMst5.c\"\n\nint main() \n{\n    FilMstFilPtr = Opn(\"\\\\temp\\\\test.file\", \"wb\");  // &lt;- error occurs here\n    printf(\"filptr=0x%p\\n\", FilMstFilPtr);  \n    return 0;\n}\n\n//****************************************************************************** \n//  Open a file  \n//****************************************************************************** \nFILE * Opn(char PthNam[], char OpnMod[]) \n{\nFILE    * FilPtr = NULL;\n\n    errno = fopen_s(&amp;FilPtr, PthNam, OpnMod);\n    if (errno != 0) {\n        printf(\"%s\\n\", PthNam);\n        perror(\"Could not open file\");\n        return NULL;\n    }\n    printf(\"file opened for mode %s\\n\", OpnMod);\n    return FilPtr; \n}\n</code></pre>\n\n<p>The FilMst5.c include file is:</p>\n\n<pre><code>#pragma once\n\ntypedef struct {                                            \n    int                 FilRRN;\n    unsigned long long  FilOfs;\n    unsigned long long  FilID;\n    char                FilDir[10 + 1];\n    char                FilNam[10 + 1];\n    char                FilNamLcs[10 + 1];\n    char                FilDirLcs[10 + 1];\n    char                FilTypLcs[10 + 1];\n    char                FilAtr[10 + 1];\n    char                UsrID[10 + 1];\n    char                SysID[8 + 1];\n    char                FilSrcDir[10 + 1];\n    char                FilSrcMbr[10 + 1];\n} FilMstStc;\nFilMstStc   FilMst;\n\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL1OfsStc;\nFilMstL1OfsStc  FilMstL1Ofs[250000000];\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL1Stc;\nFilMstL1Stc FilMstL1Key, FilMstL1SchKey;\n\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL2Stc;\nFilMstL2Stc FilMstL2[250000000];\n\n\ntypedef struct {\n    unsigned long long  FilSID;\n} FilMstL3Stc;\nFilMstL3Stc FilMstL3Key, FilMstL3SchKey;\n\n\ntypedef struct {\n    unsigned long long  RcdOfs;\n} FilMstL4Stc;\nFilMstL4Stc FilMstL4[250000000];\n\n\nFILE    * FilMstFilPtr;\n\nFILE * Opn(char PthNam[], char OpnMod[]);\n\nvoid WrtFilMstRcd(void)\n{\n}\n</code></pre>\n\n<p>The error I get, on returning from the function is:</p>\n\n<pre><code>Unhandled exception at 0x000000013FA41971 in CrtFil5.exe: 0xC0000005:\nAccess violation writing location 0x000000012E0FEA08.\n</code></pre>\n\n<p>The output I expected to get would be:</p>\n\n<pre><code>file opened for mode wb\nfilptr=0x00000000########  &lt;- pointer to file\n</code></pre>\n\n<p>I only get the first line, so there's some error between the return statement in the function and the actual return.</p>\n\n<p>What is really strange is that if you delete any of the lines in the FilMst5.c include file, the program works as desired.  But I have a larger program that uses the routines and I can't delete random lines to try to get it working.</p>\n\n<p>What could cause this problem?</p>\n\n<p>I'm using Visual Studio Community Edition 2015 with Update 1, compiled in x64 mode.  Please let me know any additional info that would be helpful.</p>\n"}, {"tags": ["c", "pointers", "char", "edit"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452698227, "post_id": 34770258, "comment_id": 57285394, "body": "A <code>char *</code> is neither a string, nor an array., It is a pointer to <code>char</code>. C does not have a string type. It is all convention."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1452698288, "post_id": 34770258, "comment_id": 57285449, "body": "Why &quot;correctly&quot; in Dr Evil quotes? Do you have some weird interpretation of &quot;correct&quot; that differs from the common one?"}, {"owner": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "edited": false, "score": 0, "creation_date": 1452698401, "post_id": 34770258, "comment_id": 57285551, "body": "Because apparently we have a &quot;wrong&quot; conception of how it should be copied ;)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452698469, "post_id": 34770258, "comment_id": 57285596, "body": "You better had put the &quot;we&quot; in quotes. It definitively does not include <b>me</b>."}, {"owner": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "edited": false, "score": 0, "creation_date": 1452698622, "post_id": 34770258, "comment_id": 57285707, "body": "Sorry, I meant I and my colleague!"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "edited": false, "score": 0, "creation_date": 1452698870, "post_id": 34770283, "comment_id": 57285887, "body": "Thank you! Okay, but one question: before the while loop, the pointers &quot;text&quot; and &quot;ptr1&quot; do have the same address. Only after the loop, they point at different addresses? So how is it really different?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "edited": false, "score": 0, "creation_date": 1452698962, "post_id": 34770283, "comment_id": 57285955, "body": "Because when you do pointer arithmetic you change the address stored in the pointer, that&#39;s the point. After <code>ptr1++</code> <code>ptr1</code> points to the second character in <code>text</code>."}, {"owner": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "edited": false, "score": 0, "creation_date": 1452700791, "post_id": 34770283, "comment_id": 57287441, "body": "It&#39;s getting clearer and clearer! One last question though: if I have a &quot;char* test;&quot; (so it is not initialized with malloc) I cannot change the contents afterwards? Because even with a second pointer that points to &quot;test&quot; the program ends in a segmentation fault! Is it because we are allowed to modify in the heap? And otherwise it&#39;s read-only?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "edited": false, "score": 0, "creation_date": 1452700836, "post_id": 34770283, "comment_id": 57287472, "body": "<code>char *test;</code> does not point to valid memory, you can&#39;t try to access it."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 0, "last_activity_date": 1452701492, "last_edit_date": 1452701492, "creation_date": 1452698173, "answer_id": 34770283, "question_id": 34770258, "link": "https://stackoverflow.com/questions/34770258/how-to-edit-values-of-a-char-string-in-c/34770283#34770283", "title": "How to edit values of a char* string in C?", "body": "<p>You should pass to <code>free()</code> the pointer returned by <code>malloc()</code> (<em>the same address</em>). You are passing the incremented pointer i.e. the <code>text</code> pointer now doesn't have the address of the pointer returned by <code>malloc()</code> instead it's an the address of the last element of <code>text</code>, use another pointer to copy the data, or better an index</p>\n\n<pre><code>size_t i;\nfor (i = 0 ; othertext[i] != '\\0' ; ++i)\n    text[i] = othertext[i];\ntext[i] = '\\0';\n</code></pre>\n\n<p>You say</p>\n\n<blockquote>\n  <p>But both pointers have basically the same address!</p>\n</blockquote>\n\n<p>This is not true, try this</p>\n\n<pre><code>printf(\"%p -- %p\\n\", (void *) text, (void *) ptr1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1452698298, "creation_date": 1452698298, "answer_id": 34770324, "question_id": 34770258, "link": "https://stackoverflow.com/questions/34770258/how-to-edit-values-of-a-char-string-in-c/34770324#34770324", "title": "How to edit values of a char* string in C?", "body": "<p>You modify the value of the <code>text</code> pointer in your loop, such that at the end it's not pointing to the beginning of the memory region you allocated; that's (part of) why you don't see the text, and why the <code>free</code> crashes.</p>\n\n<p>You need to preserve that original pointer value (which you do in your second snippet).</p>\n"}, {"tags": [], "owner": {"reputation": 1275, "user_id": 2094953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb71128e8388f91bef3ca5d383449136?s=128&d=identicon&r=PG", "display_name": "MrHug", "link": "https://stackoverflow.com/users/2094953/mrhug"}, "is_accepted": false, "score": 0, "last_activity_date": 1452698385, "creation_date": 1452698385, "answer_id": 34770357, "question_id": 34770258, "link": "https://stackoverflow.com/questions/34770258/how-to-edit-values-of-a-char-string-in-c/34770357#34770357", "title": "How to edit values of a char* string in C?", "body": "<p>You are actually changing the address that <code>text</code> is pointing too.</p>\n\n<p>Consider a very simple memory in which <code>text</code> points to address <code>5</code> and <code>othertext</code> points to address <code>42</code> on which the <code>T</code> of  <code>TestString</code> has been placed.</p>\n\n<p>You now copy the character found at address <code>42</code> to address <code>5</code>, so that address <code>5</code> also contains a <code>T</code>. However, you now increment the address that <code>text</code> is pointing too. In other words, <code>text</code> now points at address <code>6</code>. You also increment <code>othertext</code> which now points to address <code>43</code>.</p>\n\n<p>In the next round you copy the <code>e</code> found at address <code>43</code> to address <code>6</code> and increment both again. This is all fine. </p>\n\n<p>However after you are done copying <code>text</code> will point to <code>5 + 10 = 15</code>. On address <code>15</code> however you can not print anything, nor can you remove what is there.</p>\n\n<p>In your second piece of code there are no problems because <code>text</code> keeps pointing to address <code>5</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 386, "user_id": 5089102, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WIyTy.jpg?s=128&g=1", "display_name": "Yousuf Azad", "link": "https://stackoverflow.com/users/5089102/yousuf-azad"}, "is_accepted": false, "score": 0, "last_activity_date": 1452700909, "creation_date": 1452700909, "answer_id": 34771345, "question_id": 34770258, "link": "https://stackoverflow.com/questions/34770258/how-to-edit-values-of-a-char-string-in-c/34771345#34771345", "title": "How to edit values of a char* string in C?", "body": "<p>do this printf inside the loop after the assignment line. I think you will see why it's not working  ;) </p>\n\n<pre><code>printf(\"%s\\n\", text);\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5509990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462423964474ded343b939d83bd82219?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Wakeman", "link": "https://stackoverflow.com/users/5509990/daniel-wakeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 34770283, "answer_count": 4, "score": 0, "last_activity_date": 1452703235, "creation_date": 1452698108, "last_edit_date": 1452703235, "question_id": 34770258, "link": "https://stackoverflow.com/questions/34770258/how-to-edit-values-of-a-char-string-in-c", "title": "How to edit values of a char* string in C?", "body": "<p>I just started learning C and I'm quite unsure of how to \"correctly\" access and edit values of a character pointer.</p>\n\n<p>For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n  char* text = malloc(20);\n  char* othertext = \"Teststring\";\n\n  do\n  {\n    *text++ = *othertext++;\n  } while (*othertext != '\\0');\n\n  printf(\"%s\\n\", text + 3);\n  free(text);\n  return 0;\n}\n</code></pre>\n\n<p>Firstly, why does the do-while function not work? The content of \"othertext\" doesn't get copied to the \"text\" pointer. Furthermore, the program crashes when free(text) is being executed!</p>\n\n<p>We know that this code works if we add a second pointer:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n  char* text = malloc(20);\n  char* othertext = \"Teststring\";\n\n  char *ptr1 = text;\n  char *ptr2 = othertext;\n\n  do\n  {\n    *ptr1++ = *ptr2++;\n  } while (*ptr2 != '\\0');\n\n  printf(\"%s\\n\", text + 3);\n  free(text);\n  return 0;\n}\n</code></pre>\n\n<p>But both pointers have basically the same address! They have the same values in the debugger, so how does a second pointer make any difference?</p>\n\n<p>As a final note: We are not allowed to use string.h. And we do know there's a subtle difference between arrays and pointers. But we need to specifically understand how char* works!</p>\n"}, {"tags": ["c", "arrays", "function", "dynamic-arrays"], "comments": [{"owner": {"reputation": 143, "user_id": 4060915, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9696b6526fb94e424bb7053fe06cce4b?s=128&d=identicon&r=PG&f=1", "display_name": "alik33", "link": "https://stackoverflow.com/users/4060915/alik33"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1452697763, "post_id": 34769986, "comment_id": 57285037, "body": "My input are words that are &quot;imported&quot; into vocabulary.. so for example: car\\nbird\\npen"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1452697813, "post_id": 34769986, "comment_id": 57285074, "body": "I mean specifically.  What is the exact input to program 2) that caused it to segfault?  And please update your question with this info."}, {"owner": {"reputation": 143, "user_id": 4060915, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9696b6526fb94e424bb7053fe06cce4b?s=128&d=identicon&r=PG&f=1", "display_name": "alik33", "link": "https://stackoverflow.com/users/4060915/alik33"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1452697910, "post_id": 34769986, "comment_id": 57285147, "body": "for example those words... you can put there any word, press enter and then ctrl-D(EOF)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1452698043, "post_id": 34769986, "comment_id": 57285258, "body": "@alik33 please <b>update</b> your question and state <b>exactly</b> what your input is."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1452698435, "post_id": 34770209, "comment_id": 57285569, "body": "yes, much better, but your answer is actually not an answer to the OP&#39;s question."}, {"owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1452698472, "post_id": 34770209, "comment_id": 57285598, "body": "LOL =) Have a nice day"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1452698499, "post_id": 34770209, "comment_id": 57285617, "body": "While this demonstrates the use of global variables, it does not address OP&#39;s issue."}], "tags": [], "owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "is_accepted": false, "score": -1, "last_activity_date": 1452698207, "last_edit_date": 1452698207, "creation_date": 1452697959, "answer_id": 34770209, "question_id": 34769986, "link": "https://stackoverflow.com/questions/34769986/malloc-and-realloc-of-global-variable-in-function/34770209#34770209", "title": "Malloc and realloc of global variable in function", "body": "<p>In the code number 2) you are not declaring a global variable. You should declare your global variable before main scope, example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic int shared = 3;\n\nvoid add(void){\n     shared++;\n}\n\nint main(void){\n     printf(\"%d\", shared)// will print 3\n     add();\n     printf(\"%d\", shared)// will print 4\n\n     return 0;\n}\n</code></pre>\n\n<p>This is just an example to achieve what you want, for education purpose only. You should be very carefully about global variables.</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 4060915, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9696b6526fb94e424bb7053fe06cce4b?s=128&d=identicon&r=PG&f=1", "display_name": "alik33", "link": "https://stackoverflow.com/users/4060915/alik33"}, "edited": false, "score": 0, "creation_date": 1452700353, "post_id": 34770298, "comment_id": 57287103, "body": "thank you very much, this was helpful (y).. by the way ye, I am aware of freeing the memory. I am just going to continue in this so I havent done it yet"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1452698596, "last_edit_date": 1452698596, "creation_date": 1452698232, "answer_id": 34770298, "question_id": 34769986, "link": "https://stackoverflow.com/questions/34769986/malloc-and-realloc-of-global-variable-in-function/34770298#34770298", "title": "Malloc and realloc of global variable in function", "body": "<p>You should be passing the address of <code>slovnik</code> to your <code>nacitaj</code> function.  Otherwise, updates to the variable in <code>nacitaj</code> are not visible in main.</p>\n\n<p>Also, always remember to <code>free</code> any dynamically allocated memory.</p>\n\n<pre><code>void nacitaj( int *pocet_slov, char ***slovnik ){\n\n  char buffer[60];\n  int size = 60;\n\n  while( fgets( buffer, size, stdin ) != NULL ){\n      *pocet_slov = *pocet_slov + 1; \n      // dereference slovnik to update the variable in main\n      // don't cast the return value of malloc or realloc\n      *slovnik = realloc( *slovnik, (*pocet_slov+1) * sizeof(char*) );\n      (*slovnik)[*pocet_slov-1] = (char*) malloc( strlen(buffer) * sizeof(char) );\n      buffer[strlen(buffer)-1] = '\\0';\n      strcpy( (*slovnik)[*pocet_slov-1], buffer );\n  }\n\n  for( int i = 0; i &lt; *pocet_slov; i ++ ){\n      printf( \"%d. %s\\n\", i+1, (*slovnik)[i] );\n  }\n}\n\nint main(){\n  char **slovnik = NULL;\n\n  int pocet_slov = 0;\n\n  int i;\n\n  printf( \"Zadavaj slova do slovniku:\\n\" );\n  // pass the address of slovnik \n  nacitaj( &amp;pocet_slov, &amp;slovnik );   \n\n  for( i = 0; i &lt; pocet_slov; i ++ ){\n      printf( \"%d. %s\\n\", i+1, slovnik[i] );\n  }\n\n  // free the allocated memory\n  for( i = 0; i &lt; pocet_slov; i ++ ){\n      free(slovnik[i]);\n  }\n  free(slovnik);\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4060915, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9696b6526fb94e424bb7053fe06cce4b?s=128&d=identicon&r=PG&f=1", "display_name": "alik33", "link": "https://stackoverflow.com/users/4060915/alik33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "accepted_answer_id": 34770298, "answer_count": 2, "score": 1, "last_activity_date": 1452698596, "creation_date": 1452697330, "last_edit_date": 1452698573, "question_id": 34769986, "link": "https://stackoverflow.com/questions/34769986/malloc-and-realloc-of-global-variable-in-function", "title": "Malloc and realloc of global variable in function", "body": "<p>I was trying to make reading of input from stdin with dynamic allocation in two different ways:</p>\n\n<p><strong>1)</strong> I read from stdin, malloc, realloc and write into array in main. Then when I printf those elements of array, everything is ok.</p>\n\n<p><strong>2)</strong> I declare global variable in main, then I throw it into function in which I read from stdin, malloc, realloc and write into that array. When I printf these elements in the function, it works fine but when I do that outside of function, it gives me Segmentation fault.</p>\n\n<p>Can you check these codes and help me how to solve this problem?</p>\n\n<p><strong>2)</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n/*--------------------------------------------------------------------------*/\n\nvoid nacitaj( int *pocet_slov, char **slovnik ){\n\n  char buffer[60];\n  int size = 60;\n\n  while( fgets( buffer, size, stdin ) != NULL ){\n      *pocet_slov = *pocet_slov + 1;\n      slovnik = (char**) realloc( slovnik, (*pocet_slov+1) * sizeof(char*) );\n      slovnik[*pocet_slov-1] = (char*) malloc( strlen(buffer) * sizeof(char) );\n      buffer[strlen(buffer)-1] = '\\0';\n      strcpy( slovnik[*pocet_slov-1], buffer );\n  }\n\n  for( int i = 0; i &lt; *pocet_slov; i ++ ){\n      printf( \"%d. %s\\n\", i+1, slovnik[i] );\n  } \n}\n\n/*---------------------------------------------------------------------------*/\n\nint main(){\n  char **slovnik = NULL;\n\n  int pocet_slov = 0;\n\n  int i;\n\n  printf( \"Zadavaj slova do slovniku:\\n\" );\n  nacitaj( &amp;pocet_slov, slovnik );\n\n  for( i = 0; i &lt; pocet_slov; i ++ ){\n      printf( \"%d. %s\\n\", i+1, slovnik[i] );\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p><strong>1)</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n  char **slovnik = NULL;\n\n  int pocet_slov = 0;\n\n  char buffer[60];\n  int size = 60;    \n  int i;\n\n  printf( \"Zadavaj slova do slovniku:\\n\" );\n\n  while( fgets( buffer, size, stdin ) != NULL ){\n      pocet_slov ++;\n      slovnik = (char**) realloc( slovnik, (pocet_slov+1) * sizeof(char*) );\n      slovnik[pocet_slov-1] = (char*) malloc( strlen(buffer) * sizeof(char) );\n      buffer[strlen(buffer)-1] = '\\0';\n      strcpy( slovnik[pocet_slov-1], buffer );\n  }\n\n  for( i = 0; i &lt; pocet_slov; i ++ ){\n      printf( \"%d. %s\\n\", i+1, slovnik[i] );\n  } \n\n  return 0;\n}\n</code></pre>\n\n<p>Example of input:</p>\n\n<pre><code>car\nbird\npen\n</code></pre>\n"}, {"tags": ["c", "time-complexity", "complexity-theory"], "comments": [{"owner": {"reputation": 792, "user_id": 2508468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/767532940df8fe6804390e133118badc?s=128&d=identicon&r=PG", "display_name": "vdolez", "link": "https://stackoverflow.com/users/2508468/vdolez"}, "edited": false, "score": 0, "creation_date": 1452697447, "post_id": 34769879, "comment_id": 57284791, "body": "Your variable i follows an arithmetic progession : <a href=\"https://en.wikipedia.org/wiki/Arithmetic_progression\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Arithmetic_progression</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1452709750, "post_id": 34769879, "comment_id": 57293631, "body": "Actually, it&#39;s an <i>arithmetic series</i>, or a <i>quadratic sequence</i>."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5784943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cd5d42f74b442843262c4d27dcd6ce1?s=128&d=identicon&r=PG&f=1", "display_name": "w.kovacs", "link": "https://stackoverflow.com/users/5784943/w-kovacs"}, "edited": false, "score": 0, "creation_date": 1452697923, "post_id": 34770022, "comment_id": 57285162, "body": "Thanks for the correction and confirming my suspicion. What about if the counter increased geometrically instead?"}, {"owner": {"reputation": 792, "user_id": 2508468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/767532940df8fe6804390e133118badc?s=128&d=identicon&r=PG", "display_name": "vdolez", "link": "https://stackoverflow.com/users/2508468/vdolez"}, "edited": false, "score": 0, "creation_date": 1452697970, "post_id": 34770022, "comment_id": 57285202, "body": "Please include the proof ! i = S(n) = n*(n+1) / 2"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 49, "user_id": 5784943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cd5d42f74b442843262c4d27dcd6ce1?s=128&d=identicon&r=PG&f=1", "display_name": "w.kovacs", "link": "https://stackoverflow.com/users/5784943/w-kovacs"}, "edited": false, "score": 0, "creation_date": 1452697994, "post_id": 34770022, "comment_id": 57285217, "body": "@w.kovacs Then you have an inversely geometric number of operations performed."}, {"owner": {"reputation": 49, "user_id": 5784943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cd5d42f74b442843262c4d27dcd6ce1?s=128&d=identicon&r=PG&f=1", "display_name": "w.kovacs", "link": "https://stackoverflow.com/users/5784943/w-kovacs"}, "edited": false, "score": 0, "creation_date": 1452698645, "post_id": 34770022, "comment_id": 57285721, "body": "@Servy How do you express that in Big O notation?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 49, "user_id": 5784943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cd5d42f74b442843262c4d27dcd6ce1?s=128&d=identicon&r=PG&f=1", "display_name": "w.kovacs", "link": "https://stackoverflow.com/users/5784943/w-kovacs"}, "edited": false, "score": 0, "creation_date": 1452699034, "post_id": 34770022, "comment_id": 57286009, "body": "@w.kovacs That would be logarithms."}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 6, "last_activity_date": 1452697442, "creation_date": 1452697442, "answer_id": 34770022, "question_id": 34769879, "link": "https://stackoverflow.com/questions/34769879/time-complexity-of-loop/34770022#34770022", "title": "Time complexity of loop", "body": "<blockquote>\n  <p>I am aware that loops whose counter gets increased by a constant amount every iteration generally have a complexity of O(sqrt(n))</p>\n</blockquote>\n\n<p>That's false.  A loop whose counter gets increased by a constant amount every iteration is O(N).</p>\n\n<p>A loop whose counter increases by an amount that increases linearly on each iteration is O(sqrt(N)).</p>\n\n<p>In this case, <code>N</code> here is <code>n * n</code>, as that's what your loop is looping until, so that simple replacement tells you that, yes, the operation is O(sqrt(n^2)) or O(n).</p>\n"}, {"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 3, "last_activity_date": 1452697765, "last_edit_date": 1452697765, "creation_date": 1452697443, "answer_id": 34770023, "question_id": 34769879, "link": "https://stackoverflow.com/questions/34769879/time-complexity-of-loop/34770023#34770023", "title": "Time complexity of loop", "body": "<blockquote>\n  <p>I am aware that loops whose counter gets increased by a constant amount every iteration generally have a complexity of O(sqrt(n))</p>\n</blockquote>\n\n<p><strong>Nope!</strong> That is not true. Take for instance this loop</p>\n\n<pre><code>for(i = 0; i &lt; n; i++)\n</code></pre>\n\n<p>Its variable <code>i</code> is increasing by constant amount, i.e <code>1</code>. But the complexity of this loop is <code>O(n)</code></p>\n\n<hr>\n\n<p>If you see the series closely, the values <code>i</code> will get are</p>\n\n<pre><code>0, 3, 8, 15, 24, 35, ...\n</code></pre>\n\n<p>Its an arithmetic series. It can also be written as</p>\n\n<pre><code>0^2 - 1, 1^2 - 1, 2^2 - 1, 3^2 - 1, 4^2 - 1, 5^2 - 1, 6^2 - 1, ...\n</code></pre>\n\n<hr>\n\n<p>Now the loop will run until <code>i</code> reaches <code>n^2</code>, (<code>i &lt; n*n</code>)</p>\n\n<p>So you can deduce from that, that the loop will run for <code>O(n)</code>.</p>\n\n<p>Therefore the complexity is <code>O(n)</code></p>\n"}, {"comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1452697591, "post_id": 34770028, "comment_id": 57284895, "body": "It will <i>not</i> iterate exactly n times.  It <i>is</i> O(n), but there is a coefficient there."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 2, "creation_date": 1452697791, "post_id": 34770028, "comment_id": 57285059, "body": "@Servy, it will iterate exactly <code>n</code> times, you can verify that."}], "tags": [], "owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "is_accepted": false, "score": 1, "last_activity_date": 1452699155, "last_edit_date": 1452699155, "creation_date": 1452697457, "answer_id": 34770028, "question_id": 34769879, "link": "https://stackoverflow.com/questions/34769879/time-complexity-of-loop/34770028#34770028", "title": "Time complexity of loop", "body": "<p>It is O(n), because the loop will iterate exactly <code>n</code> times.</p>\n\n<p>On interation 1: the value of <code>i</code> would be <code>1 * 1 - 1</code> which is <code>0</code></p>\n\n<p>On interation 2: the value of <code>i</code> would be <code>2 * 2 - 1</code> which is <code>3</code></p>\n\n<p>On interation 3: the value of <code>i</code> would be <code>3 * 3 - 1</code> which is <code>8</code></p>\n\n<p>...</p>\n\n<p>On interation n: the value of <code>i</code> would be <code>n * n - 1</code>. This causes the loop to terminate.</p>\n\n<p>In summary, <code>i</code> grows fast enough to reach <code>n * n - 1</code> in <code>n</code> iterations.</p>\n"}], "owner": {"reputation": 49, "user_id": 5784943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cd5d42f74b442843262c4d27dcd6ce1?s=128&d=identicon&r=PG&f=1", "display_name": "w.kovacs", "link": "https://stackoverflow.com/users/5784943/w-kovacs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 34770022, "answer_count": 3, "score": 3, "last_activity_date": 1452699155, "creation_date": 1452697086, "last_edit_date": 1452697178, "question_id": 34769879, "link": "https://stackoverflow.com/questions/34769879/time-complexity-of-loop", "title": "Time complexity of loop", "body": "<p>I'm unsure as to the complexity of the following block of C:</p>\n\n<pre><code>int i = 0, j = 1;\nfor ( i = 0; i &lt; n * n; i += j )\n{\n    O1();\n    j += 2;\n}\n</code></pre>\n\n<p>where O1 is a function that obviously takes constant time to execute. Now, I am aware that loops whose counter gets increased by a constant amount every iteration generally have a complexity of <code>O(sqrt(n))</code>, but is this the case here as well? Or is it <code>O(sqrt(n^2))</code>, that is <code>O(n)</code>?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["javascript", "c", "function", "parameters", "console"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1452697974, "post_id": 34769805, "comment_id": 57285207, "body": "<a href=\"http://stackoverflow.com/questions/610406/javascript-equivalent-to-printf-string-format\" title=\"javascript equivalent to printf string format\">stackoverflow.com/questions/610406/&hellip;</a>"}, {"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1452698381, "post_id": 34769805, "comment_id": 57285531, "body": "@BLUEPIXY, omg i cant believe that i just didnt search JavaScript spring. Thanks !!!"}], "answers": [{"comments": [{"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452697855, "post_id": 34769896, "comment_id": 57285112, "body": "Sorry i meant, i wanted to created something that i can do this with. console.log(&quot;number:%d text:%s&quot;par1,par2);"}], "tags": [], "owner": {"reputation": 3293, "user_id": 3959161, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Rdd6h.jpg?s=128&g=1", "display_name": "Sing", "link": "https://stackoverflow.com/users/3959161/sing"}, "is_accepted": false, "score": 1, "last_activity_date": 1452697444, "last_edit_date": 1452697444, "creation_date": 1452697121, "answer_id": 34769896, "question_id": 34769805, "link": "https://stackoverflow.com/questions/34769805/javascript-how-to-pass-mutliple-parameters/34769896#34769896", "title": "Javascript how to pass mutliple parameters", "body": "<p>console log can take multi arguments, so you can use like :</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>    var a = function(parm1,parm2,parm3,param4,param5){\r\n      console.log(parm1,parm2,parm3); \r\n    }\r\n    \r\n    a(1,2,3)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>you could run the snippets and see in your dev tool.</p>\n"}, {"comments": [{"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452697820, "post_id": 34769917, "comment_id": 57285079, "body": "Yeah but i cant do stuff like this console.log(&quot;number:%d text:%s&quot;par1,par2);"}, {"owner": {"reputation": 10578, "user_id": 3233827, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LVngi.jpg?s=128&g=1", "display_name": "ssc-hrep3", "link": "https://stackoverflow.com/users/3233827/ssc-hrep3"}, "reply_to_user": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452698345, "post_id": 34769917, "comment_id": 57285500, "body": "You can. See my updated answer."}, {"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452698691, "post_id": 34769917, "comment_id": 57285755, "body": "Awesome. thanks BLUEPIXY also gave a good answer, i was trying to recreate my own console.log method, but this method works as well. Thanks, i wish i could have two answers."}], "tags": [], "owner": {"reputation": 10578, "user_id": 3233827, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LVngi.jpg?s=128&g=1", "display_name": "ssc-hrep3", "link": "https://stackoverflow.com/users/3233827/ssc-hrep3"}, "is_accepted": false, "score": 2, "last_activity_date": 1452698188, "last_edit_date": 1452698188, "creation_date": 1452697175, "answer_id": 34769917, "question_id": 34769805, "link": "https://stackoverflow.com/questions/34769805/javascript-how-to-pass-mutliple-parameters/34769917#34769917", "title": "Javascript how to pass mutliple parameters", "body": "<p>Just use the default implementation of <code>console.log()</code>, because it <em>does</em> support multiple arguments, like it is described in the <a href=\"https://developer.mozilla.org/de/docs/Web/API/Console/log\" rel=\"nofollow\">reference guide of the Mozilla Developer Network</a> and in the <a href=\"https://developer.chrome.com/devtools/docs/console-api#consolelogobject-object\" rel=\"nofollow\">reference guide of Google Chrome</a>.</p>\n\n<p>Your example does also work with console.log (taken from the <a href=\"https://developer.chrome.com/devtools/docs/console-api#consolelogobject-object\" rel=\"nofollow\">official developer page of Google Chrome</a>):</p>\n\n<pre><code>console.log(\"User %s has %d points\", userName, userPoints);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452698446, "post_id": 34770039, "comment_id": 57285578, "body": "Yup this works. Ill try to turn it into my own printf statement before downloading. <a href=\"https://github.com/alexei/sprintf.js\" rel=\"nofollow noreferrer\">github.com/alexei/sprintf.js</a>"}, {"owner": {"reputation": 10578, "user_id": 3233827, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LVngi.jpg?s=128&g=1", "display_name": "ssc-hrep3", "link": "https://stackoverflow.com/users/3233827/ssc-hrep3"}, "edited": false, "score": 0, "creation_date": 1452698561, "post_id": 34770039, "comment_id": 57285666, "body": "Why would you do that if it is initially supported by the browser (e.g. Google Chrome)?"}, {"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452698777, "post_id": 34770039, "comment_id": 57285818, "body": "However, i would like to create my own sprinf method not use another persons code."}, {"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "reply_to_user": {"reputation": 10578, "user_id": 3233827, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LVngi.jpg?s=128&g=1", "display_name": "ssc-hrep3", "link": "https://stackoverflow.com/users/3233827/ssc-hrep3"}, "edited": false, "score": 1, "creation_date": 1452698815, "post_id": 34770039, "comment_id": 57285842, "body": "@ssc-hrep3 I&#39;m creating my own function."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 1, "last_activity_date": 1452702215, "last_edit_date": 1452702215, "creation_date": 1452697497, "answer_id": 34770039, "question_id": 34769805, "link": "https://stackoverflow.com/questions/34769805/javascript-how-to-pass-mutliple-parameters/34770039#34770039", "title": "Javascript how to pass mutliple parameters", "body": "<p>use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments\" rel=\"nofollow\">arguments object</a>. like this</p>\n\n<pre><code>function p(){\n    for(var i = 0; i &lt; arguments.length; ++i)\n        console.log(arguments[i]);\n}\n\np(1,2,3);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "edited": false, "score": 0, "creation_date": 1452697939, "post_id": 34770144, "comment_id": 57285176, "body": "Yeah i know i can do that. I don\u2019t want to do it that way. I want to do it like printf, console.log(&quot;number:%d text:%s&quot;par1,par2);"}], "tags": [], "owner": {"reputation": 846, "user_id": 5177969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada7d97fce49402439073b2eeaf051b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Kor", "link": "https://stackoverflow.com/users/5177969/mike-kor"}, "is_accepted": false, "score": 0, "last_activity_date": 1452697793, "creation_date": 1452697793, "answer_id": 34770144, "question_id": 34769805, "link": "https://stackoverflow.com/questions/34769805/javascript-how-to-pass-mutliple-parameters/34770144#34770144", "title": "Javascript how to pass mutliple parameters", "body": "<p>You can use similar output </p>\n\n<pre><code>console.log('param1 = ' + param1 = ' param2 = ' + param2);\n</code></pre>\n\n<p>Also there is debug mode in most of browsers where you can use breakpoints.</p>\n"}], "owner": {"reputation": 2677, "user_id": 5244950, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/8iSIn.png?s=128&g=1", "display_name": "AJ_", "link": "https://stackoverflow.com/users/5244950/aj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "closed_date": 1452698253, "accepted_answer_id": 34770039, "answer_count": 4, "score": 0, "last_activity_date": 1452702215, "creation_date": 1452696885, "last_edit_date": 1452698975, "question_id": 34769805, "link": "https://stackoverflow.com/questions/34769805/javascript-how-to-pass-mutliple-parameters", "closed_reason": "Duplicate", "title": "Javascript how to pass mutliple parameters", "body": "<p>So as a C user, I really love using <code>printf</code>. Now that I'm doing js applications I'm forced to use <code>console.log()</code>. You can use <code>console.log(\"User %s has %d points\", userName, userPoints);</code>, but i want to create my own function to do the job, because im making a few changes. So I want to create a function that takes multiple parameters, and print them out accordingly.</p>\n\n<p>Example of what i want to do</p>\n\n<pre><code>function(parm1,parm2,parm3...){\n  //Stuff\n}\nconsole.log(\"number:%d text:%s\"par1,par2);\n</code></pre>\n"}, {"tags": ["c", "memory-management", "malloc"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452695997, "post_id": 34769428, "comment_id": 57283729, "body": "Why would <code>malloc()</code> fail? And why wouldn&#39;t it succeed after some other process has &quot;<code>free</code>d&quot; memory? Please explain <i>exactly the same result</i>?"}, {"owner": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452696215, "post_id": 34769428, "comment_id": 57283896, "body": "@iharob <code>malloc</code> would fail if it couldn&#39;t allocate the required amount of memory (out of memory). The virtual memory model (if I understand it correctly) means that my programs memory allocations are completely isolated from other programs&#39;."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452696456, "post_id": 34769428, "comment_id": 57284079, "body": "That will likely not work on modern OS (see &quot;optimistic allocation&quot;). Even if, it does not guarantee it will be available lateron. Just allocate what you need and fail if not available. Don&#39;t try to outsmart your OS."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1452698353, "post_id": 34769428, "comment_id": 57285505, "body": "You should modify your program to write to the newly allocated memory and then rerun your program.  The memory writing forces the system to allocate the actual pages.  It may alter the behaviour if the system has an optimistic allocation strategy."}, {"owner": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1452698843, "post_id": 34769428, "comment_id": 57285864, "body": "@JonathanLeffler No change. Still weird, though much slower"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1452699363, "post_id": 34769428, "comment_id": 57286270, "body": "It takes a while to write to 28 GiB of memory, which is roughly what your numbers say it is using.  It might be having to write the data to disk to cover for the difference between your virtual memory and the physical memory.  Your code clearly leaks memory \u2014 if you kept a record of previous allocations (start pointer and block size) and scribbled on each block each time you allocated space, you&#39;d probably see an even more dramatic slowdown. The usable space is a lot smaller than the allocatable space \u2014 unless you have the luxury of 32 GiB main memory on your machine (which is not impossible)."}, {"owner": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1452699655, "post_id": 34769428, "comment_id": 57286539, "body": "@JonathanLeffler I know this. This is why I am confused, since the whole thing is only virtual address space."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1452696681, "post_id": 34769657, "comment_id": 57284239, "body": "No, the OS will not &quot;free&quot; (i.e. reclaim&quot; memory really used by a process. But it might reserve more memory than actually even available in the system on the optimistic approach the process will not really need all pages. Even <code>calloc</code> might not help (e.g. copy on write). Modern OSes are quite smart."}, {"owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452696852, "post_id": 34769657, "comment_id": 57284362, "body": "I guess I will disagree a little bit. I was not saying a real free, I said something similar a free, doing a swap for example. It is not a free but is similar."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452697951, "post_id": 34769657, "comment_id": 57285188, "body": "Swapping is something completely different. The question is about logical address space of a process. Swapping about physical memory. And after a swap-out, the memory still exists and is allocated to a process. Basically, swap-space is just a different storage-medium, but still part of the physical memory. A modern OS will not even allocate physical memory if a process just requests it. Instead it just sets up the page-tables, tagging the mapped area as not allocated. Only once the process truely accesses the address-space of such a page physical memory is allocated for that page."}, {"owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452698353, "post_id": 34769657, "comment_id": 57285506, "body": "Man, you are trying to explain something that I already know. I am just trying to explain the things in a didatical way."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452698742, "post_id": 34769657, "comment_id": 57285785, "body": "1) Mind your words! I did not offend you, so don&#39;t &quot;man&quot; me. 2) From what you wrote it is not clear you really know these details. Maybe you just need to use the correct terms. It is not very didactically to be unclear. Maybe you just oversimplificated."}, {"owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452698820, "post_id": 34769657, "comment_id": 57285846, "body": "Have a nice day, bro. I was not intended to be offensive. I oversimplificated, indeed."}], "tags": [], "owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "is_accepted": false, "score": 1, "last_activity_date": 1452697928, "last_edit_date": 1452697928, "creation_date": 1452696552, "answer_id": 34769657, "question_id": 34769428, "link": "https://stackoverflow.com/questions/34769428/malloc-succeeds-after-failing-with-no-free/34769657#34769657", "title": "malloc succeeds after failing with no free", "body": "<p>Since the Operating System has the responsibility to manage the available memory for the user, you cannot expect a linear behaviour of the quantity of memory available at the moment you call your malloc. Between two steps, OS can free an amount of memory doing a swap to the Hard Disk or to another area of the RAM Memory, even if you don't call free explcitly. That's why you expect a failure but malloc is executed with success.</p>\n\n<p>Short answer: OS can free the available memory even if you do not call it.</p>\n"}, {"comments": [{"owner": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "edited": false, "score": 1, "creation_date": 1452699563, "post_id": 34770603, "comment_id": 57286455, "body": "I am aware of this, and that is exactly why I am confused. Since calling <code>malloc</code> does not actually reserve physical memory, only a part of the process&#39;s virtual address space, so this address space should be 100% available to my process. How then is a new chunk of virtual address space suddenly &quot;found&quot;?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "edited": false, "score": 0, "creation_date": 1452701590, "post_id": 34770603, "comment_id": 57288025, "body": "@baruch: The address space needn&#39;t be 100% available. It can be lazily allocated and mapped to physical memory, too. If you use the virtual memory, but not enough <i>actual</i> memory is available, the OOM killer will pay a visit to some (most likely your) process (OOM = Out Of Memory). That&#39;s the downside of using optimistic allocation"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "edited": false, "score": 0, "creation_date": 1452701774, "post_id": 34770603, "comment_id": 57288174, "body": "What and how your virtual memory is actually mapped onto physical memory is something that is hard to predict, or even accurately explain, given you&#39;re on a windows machine. The kernel can swap pages, or simply move change the physical address because it&#39;s trying to create a contiguous block of available memory for some process. These things are both implementation defined (the <code>malloc</code> implementation details), and platform specific (ie the kernel&#39;s memory management model)"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "edited": false, "score": 0, "creation_date": 1452702028, "post_id": 34770603, "comment_id": 57288362, "body": "glibc&#39;s implementation of <code>malloc</code> for example will allocate large chunks of memory (&gt; a page) via <code>mmap</code>, and <code>free</code>&#39;ing these blocks <i>will</i> return the memory to the system directly to avoid locking large chunks of memory. But again: this is just one possible implementation, there&#39;s no way of knowing how other implementations behave in similar situations"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 2, "creation_date": 1452707317, "post_id": 34770603, "comment_id": 57292183, "body": "Windows doesn&#39;t use optimistic allocation.  It requires that the space being committed can be backed by space in the paging file."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1452771850, "post_id": 34770603, "comment_id": 57320792, "body": "@AdrianMcCarthy: +1 your answer. It&#39;s true that I don&#39;t know anything about memory management on windows on a system level, and my rambling about linux&#39; optimistic allocation doesn&#39;t really answer the question. I posted it because I figured it might be useful for future reference and it does at least demonstrate that <code>malloc</code>&#39;s internal behaviour is strongly platform and implementation dependant. That being said: do you happen to know when, on windows, the allocated memory is actually committed? Does this happen <i>before</i> the allocated memory is written to?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1452772275, "post_id": 34770603, "comment_id": 57321055, "body": "Just out of curiosity: from MSDN: <i>&quot;Memory can be committed as little as one page at a time. The maximum amount of memory that can be committed is based solely on the maximum range of contiguous free or reserved addresses (but not a combination of both), regardless of the amount of physical memory available to the system.&quot;</i> would that allow you to reserve a block of virtual memory that is then later committed in chunks (mapping the virtual pointer to new physical address until a contiguous block of physical memory is available)?"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1452792918, "post_id": 34770603, "comment_id": 57335388, "body": "@Elias Van Ootegem:  It depends how you define committed.  In Windows, &quot;committed&quot; means the system has set aside space in the pagefile; it doesn&#39;t mean that it&#39;s in yet.  In this sense, anything you get back from HeapAlloc or malloc will be committed.  When you first access an allocation, it might not be in RAM, but the system will handle the page fault and make RAM available.  To reserve VM address space without committing, you use VirtualAlloc.  To later access that VM, you first need to commit the page(s) you plan to access, but that commit requires pagefile space, so it can fail."}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 3, "last_activity_date": 1452699037, "creation_date": 1452699037, "answer_id": 34770603, "question_id": 34769428, "link": "https://stackoverflow.com/questions/34769428/malloc-succeeds-after-failing-with-no-free/34770603#34770603", "title": "malloc succeeds after failing with no free", "body": "<p>When you call <code>malloc</code>, what actually happens is that you're allocating virtual memory. Once you try to access that memory, it triggers the OS (kernel) to allocate the actual, physical memory and map the <em>actual</em> memory address onto that virtual address (your pointer).<br>\nMost, if not all, modern systems will gladly return a pointer even though the memory is, at the time you call <code>malloc</code> not available. Or at least: not available in its required form (ie as a contiguous block of memory).</p>\n\n<p><code>malloc</code> <em>has</em> to return a pointer to a contiguous block of memory (if not, pointer arithmetic wouldn't be possible). So say you have 2gigs of memory available, it's very likely that that memory won't be available as a contiguous block, whereas allocating 2 gigs in chunks will work perfectly fine. This can, in part, explain why you see memory being allocated in larger chunks, then all of a sudden, you're allocating the same amount of memory as 2 chunks (because of your dividing the size by 2).</p>\n\n<p>Now, at no particular point are you actually writing to that memory. What you need to understand is that, unless you access this allocated virtual memory, it needn't be mapped to physical memory. Some systems, like Linux, will not allocate physical memory until you actually access the <code>malloc</code>'ed block. When this happens, it triggers the kernel to actually go in and allocate physical memory. That physical memory address is than mapped onto the virtual address. This is called <em>optimistic allocation</em>.</p>\n\n<p>Because most (if not all) modern system use optimistic allocation, they can allow processes to allocate more memory than is actually available at the time. What matters is that this memory is available by the time the process is actually starting to use it. Something you don't do.</p>\n\n<p>When you call <code>free</code> on <code>malloc</code>'ed memory that you've never used, all that you actually release is virtual memory. The physical memory remains untouched. If you have written to heap memory, and then call <code>free</code>, it's likely that block of memory is not always returned to the system directly (that's not really the job of <code>free</code>). Next time you call <code>malloc</code>, it's very possible that the newly allocated memory will be taken from the block you just <code>free</code>'d. But these are implementation details that would take us too far.</p>\n\n<p>In cases like this, I like to use silly analogies using real-world situations:</p>\n\n<p><code>malloc</code> isn't like planting a flag in a chunk of memory so that nothing else, in any way shape or form is allowed to access that memory. It's more like booking a reservation in a restaurant. Restaurants often over-book, because they expect people not to show up, or to cancel. 99.99% of the time, when you arrive at the restaurant, there will be a table available for you. (the restaurant allocated the table optimistically).</p>\n\n<p>If you don't show up (ie you don't access the memory), the table is available for other people to use. If you did arrive, sat down and ate your dinner (write to memory), you <code>free</code> the table by paying the bill and leaving. What the restaurant owner does with the table is not your concern. They might have an outstanding reservation for someone else who will arrive 10 minutes after you left. If so, the restauranteurs allocated the same resource twice, but that didn't cause problems simply because the resource was <code>free</code>'d by the time it was needed elsewhere.</p>\n\n<p>This elaborate analogy is, essentially, how and why optimistic allocation works.</p>\n"}, {"tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": true, "score": 7, "last_activity_date": 1452959733, "last_edit_date": 1452959733, "creation_date": 1452707090, "answer_id": 34773500, "question_id": 34769428, "link": "https://stackoverflow.com/questions/34769428/malloc-succeeds-after-failing-with-no-free/34773500#34773500", "title": "malloc succeeds after failing with no free", "body": "<p>On Windows, a memory allocation (commit) will succeed if there is enough paging file space to back it.  The amount of space available in the paging file can change due to actions by other processes reserving and releasing memory.</p>\n\n<p>On Windows, malloc is a thin wrapper around HeapAlloc, which is built on VirtualAlloc.</p>\n\n<p>VirtualAlloc will allow you to reserve and/or commit memory.</p>\n\n<ul>\n<li><p><strong>Reserving</strong> means setting aside a range of the process's virtual address space.  A reservation succeeds if the range of virtual addresses is available.  It doesn't mean that memory is available, just that those addresses won't be used for anything else.</p></li>\n<li><p><strong>Committing</strong> means setting aside spacing in the paging file.  A commit succeeds if the paging file has enough free space to back the commit.</p></li>\n</ul>\n\n<p>Accessing reserved but not-yet-committed memory is an error and will probably crash.</p>\n\n<p>Accessing committed memory may trigger page faults, which the system handles by mapping those pages to actual RAM.  If necessary, some RAM will be copied out to the paging file (which is guaranteed to have enough space because the commit succeeded), and then that RAM is re-purposed for the access that originally triggered the page fault.  Thus accessing committed memory always succeeds.</p>\n\n<p>Windows Heaps use VirtualAlloc (and related functions) under the hood.  Internally, a heap starts with an initial reservation, only part of which is committed.  A HeapAlloc can fail if:  (1) it exhausts its initial reservation or (2) it can't commit more pages because there isn't enough free space in the paging file.  When it succeeds, HeapAlloc returns pointers to committed memory, so accessing memory from a successful HeapAlloc always succeeds.</p>\n\n<p>Since malloc is just a thin wrapper on HeapAlloc, the preceding paragraph applies to malloc as well.</p>\n\n<p>There's an extra wrinkle in that HeapAlloc handles large allocations separately.  I'm not sure if these come from its initial reservation or if they're distinct blocks.</p>\n\n<p>The behavior of baruch's program suggests that it's running into the limit of available memory in the paging file.  The available space in the paging file normally varies as other processes go about their business, so it's not surprising to seem some allocations fail and others succeed as you're near this limit.</p>\n\n<p>Also, the system might adjust the size of the paging file based on perceived demand, policy, and available disk space.  So if you hit the limit once, but try again later, you might find that the limit is higher.</p>\n"}], "owner": {"reputation": 17841, "user_id": 331785, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5348f77500c08a662088203ef1b4be27?s=128&d=identicon&r=PG", "display_name": "Baruch", "link": "https://stackoverflow.com/users/331785/baruch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 34773500, "answer_count": 3, "score": 7, "last_activity_date": 1452959733, "creation_date": 1452695878, "last_edit_date": 1452706522, "question_id": 34769428, "link": "https://stackoverflow.com/questions/34769428/malloc-succeeds-after-failing-with-no-free", "title": "malloc succeeds after failing with no free", "body": "<p>I wrote a tiny program to get a rough estimate of the heap size (I know I could probably have just googled it, but this seemed more fun and I thought it would be a quick simple thing).</p>\n\n<p>This is the whole program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid main()\n{\n    unsigned long long alloc_size = 1024;\n    unsigned long long total = 0;\n    unsigned int i = 0;\n    void* p = 0;\n\n    while(alloc_size &gt;= 16) {\n        p = malloc(alloc_size);\n        if (p) {\n            total += alloc_size;\n            i++;\n            printf(\"%u)\\tAllocated %llu bytes\\tTotal so far %llu\\n\", i, alloc_size, total);\n            alloc_size *= 2;\n        }\n        else {\n            alloc_size /= 2;\n        }\n    }\n    printf(\"Total alloctions: %llu bytes in %u allocations\", total, i);\n}\n</code></pre>\n\n<p>I ran this, and was surprised by 2 things:</p>\n\n<ol>\n<li>The results were inconsistent. If I run it multiple times, I don't get exactly the same result. Thanks to the virtual memory model (or whatever it is called), shouldn't this be deterministic?</li>\n<li>Since the program never frees memory, I would expect that if a malloc for a certain size fails once, it will not suddenly succeed later, but - surprise! Here is a sample from one run of the program, Other times I got different (see #1) but similar results:</li>\n</ol>\n\n\n\n<pre><code>42)     Allocated 65536 bytes   Total so far 28337044480\n43)     Allocated 16384 bytes   Total so far 28337060864\n44)     Allocated 16384 bytes   Total so far 28337077248\n45)     Allocated 16384 bytes   Total so far 28337093632\n46)     Allocated 16384 bytes   Total so far 28337110016\n47)     Allocated 32768 bytes   Total so far 28337142784\n48)     Allocated 8192 bytes    Total so far 28337150976\n49)     Allocated 8192 bytes    Total so far 28337159168\n50)     Allocated 16384 bytes   Total so far 28337175552\n51)     Allocated 32768 bytes   Total so far 28337208320\n52)     Allocated 65536 bytes   Total so far 28337273856\n53)     Allocated 131072 bytes  Total so far 28337404928\n54)     Allocated 262144 bytes  Total so far 28337667072\n55)     Allocated 16384 bytes   Total so far 28337683456\n56)     Allocated 8192 bytes    Total so far 28337691648\n57)     Allocated 4096 bytes    Total so far 28337695744\n</code></pre>\n\n<p>As you can see, this is after it already reached the peak allocation size and is on it's way down. Between allocations #42 and #43, it would have tried to allocate 32768 bytes and failed. Same after each of allocations #43 - #45. So how did it suddenly manage it at #47? You can see the same thing at #50 - #54. And this is only a sample. This same behavior happened multiple times in the total of 272 allocations in this particular run.</p>\n\n<p>I hope this was not to long, but I am really confused and would be glad for any light shed on this.</p>\n\n<p><strong>EDIT</strong><br>\nI should add that this is on a Win7 64bit machine with mingw-w64 64bit gcc compiler, no compiler flags</p>\n"}, {"tags": ["css", "c", "properties", "gtk"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694214, "post_id": 34768828, "comment_id": 57282452, "body": "It seems that the property lacks the units, try appending <i>px</i> to <code>20</code>. Also, you can do it directly with <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> code instead of setting it here, but of course it is preferrable to do it like you want because it&#39;s more maintainable."}, {"owner": {"reputation": 235, "user_id": 5744158, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2bb9e0ef16404a5e0c90ee136aa32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Red Star", "link": "https://stackoverflow.com/users/5744158/red-star"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694277, "post_id": 34768828, "comment_id": 57282497, "body": "style properties don&#39;t take units, this one takes a <code>gint</code> or <code>guint</code> (and it doesn&#39;t work even if I add <code>px</code>)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694393, "post_id": 34768828, "comment_id": 57282582, "body": "Are you sure, that is a <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> type for <i>glib</i>, css might work a little different. What does the documentation say?"}, {"owner": {"reputation": 235, "user_id": 5744158, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2bb9e0ef16404a5e0c90ee136aa32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Red Star", "link": "https://stackoverflow.com/users/5744158/red-star"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694556, "post_id": 34768828, "comment_id": 57282698, "body": "yes I can use <code>gint</code> fine in the .c file, since I am including Gtk libraries,, the documentation says to use a style property you just do <code>-namespace-styleproperty: value;</code> in the css file, but it doesn&#39;t work"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1452705906, "post_id": 34768828, "comment_id": 57291280, "body": "How did you load the CSS file?"}, {"owner": {"reputation": 235, "user_id": 5744158, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2bb9e0ef16404a5e0c90ee136aa32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Red Star", "link": "https://stackoverflow.com/users/5744158/red-star"}, "edited": false, "score": 0, "creation_date": 1453327434, "post_id": 34768828, "comment_id": 57558618, "body": "<code>provider = gtk_css_provider_new ();     display = gdk_display_get_default ();     screen = gdk_display_get_default_screen (display);     gtk_style_context_add_provider_for_screen (screen, GTK_STYLE_PROVIDER (provider), GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);      gtk_css_provider_load_from_path (provider,&quot;style.css&quot;,NULL);     g_object_unref (provider);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 5744158, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2bb9e0ef16404a5e0c90ee136aa32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Red Star", "link": "https://stackoverflow.com/users/5744158/red-star"}, "edited": false, "score": 0, "creation_date": 1453327360, "post_id": 34848084, "comment_id": 57558586, "body": "I am loading the CSS file with the css provider, display and screen ... and It&#39;s not just about the child-displacement-y , it&#39;s about ALL the widget style properties, they do not work.. Also the margins in CSS doesn&#39;t work in GTK 3.18.6 .... :/"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 235, "user_id": 5744158, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2bb9e0ef16404a5e0c90ee136aa32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Red Star", "link": "https://stackoverflow.com/users/5744158/red-star"}, "edited": false, "score": 0, "creation_date": 1488231837, "post_id": 34848084, "comment_id": 72131848, "body": "@RedStar It took a while for widgets to be converted across to the new &quot;CSS gadget&quot;/&quot;indirect&quot; rendering model, which is what makes CSS margins and so on work at all. Most of the typical widgets should work now, but if you still find any that don&#39;t, then file a bug (and maybe even submit a patch!) requesting to have it converted."}], "tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": false, "score": 0, "last_activity_date": 1453096410, "creation_date": 1453096410, "answer_id": 34848084, "question_id": 34768828, "link": "https://stackoverflow.com/questions/34768828/unable-to-set-style-property-in-gtk3/34848084#34848084", "title": "Unable to set &quot;style property&quot; in GTK3", "body": "<p><code>GtkButton::child-displacement-y</code> is now ignored as of GTK+ 3.20. Your CSS won't work anymore anyway. It may have already been broken in 3.18. Sorry. :/ The documentation suggests using CSS margins and padding instead.</p>\n\n<p>That being said, otherwise your CSS is correct. I presume you simply are not loading it correctly. You can't just drop a random .css file and expect it to work; you need to explicitly load it using GtkCssProvider into a GtkStyleContext (either one that belongs to a widget or to the default GdkScreen to have it apply to all widgets). (If you are instead modifying the theme file directly, then see the first paragraph.)</p>\n"}], "owner": {"reputation": 235, "user_id": 5744158, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2bb9e0ef16404a5e0c90ee136aa32d5?s=128&d=identicon&r=PG&f=1", "display_name": "Red Star", "link": "https://stackoverflow.com/users/5744158/red-star"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453096410, "creation_date": 1452694171, "last_edit_date": 1452694217, "question_id": 34768828, "link": "https://stackoverflow.com/questions/34768828/unable-to-set-style-property-in-gtk3", "title": "Unable to set &quot;style property&quot; in GTK3", "body": "<p>I am trying to set widgets' style properties (coding with C on windows) but it doesn't work:</p>\n\n<p>I tried putting in in the css file</p>\n\n<pre><code>* {\n    -GtkButton-child-displacement-y: 20;\n}\n</code></pre>\n\n<p>and it didn't work, I also tried setting it inside the xml file adding this property to a GtkButton</p>\n\n<pre><code>&lt;property name='child-displacement-y'&gt;20&lt;/property&gt;\n</code></pre>\n\n<p>an it doesn't work (invalide property) I suppose style properties can't be set along with properties</p>\n\n<p>So, what am I doing wrong? why the css file ignores widget specific style properties ?</p>\n\n<p>(GTK+ version 3.18 on windows)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694146, "post_id": 34768771, "comment_id": 57282402, "body": "Please post the whole code, this snippet by it&#39;s own could not possible reproduce the issue. <a href=\"http://stackoverflow/help/mcve\" rel=\"nofollow noreferrer\">Post a minimal example that reproduces the problem, or a MCVE</a>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694406, "post_id": 34768771, "comment_id": 57282592, "body": "Why are you trying to do that? Why the struct?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452694628, "post_id": 34768771, "comment_id": 57282747, "body": "Initialisers in C have to go after the definition of an object, not inside a type definition. Anyway, if the strings are constant, better use a <code>const char *bread[]</code>."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1452696121, "post_id": 34768771, "comment_id": 57283811, "body": "<code>&quot;5. Flatbread (not baked in restaurant)&quot;</code> is too big for <code>char bread[9][35]</code>. It&#39;s 39 char&#39;s in size (38 + terminating nul character)"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 4, "creation_date": 1452694315, "post_id": 34768861, "comment_id": 57282519, "body": "While this seems to be true, it&#39;s not what the OP is asking about. Could you put this as a comment?"}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 1, "last_activity_date": 1452695691, "last_edit_date": 1452695691, "creation_date": 1452694252, "answer_id": 34768861, "question_id": 34768771, "link": "https://stackoverflow.com/questions/34768771/expected-at-end-of-declaration-list-c-when-i-have-one-already/34768861#34768861", "title": "expected &#39;;&#39; at end of declaration list c when i have one already", "body": "<p>Your strings are too long - turn on compiler warnings (highest level)</p>\n\n<pre><code>'bread' : array bounds overflow\n</code></pre>\n\n<p>Try</p>\n\n<pre><code>char bread[9][40] = {\n</code></pre>\n\n<p>instead.</p>\n\n<p><strong>Updated question</strong>:</p>\n\n<p>No need to put that single array inside a struct. If you really need to use this inside a typedef, only use <code>char bread[9][40];</code>, and initialize the array outside the typedef:</p>\n\n<pre><code>typedef struct\n{\n   char bread[9][40];\n} subway;\n\nsubway mySubway = { /* initialize strings here */ };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1452695265, "last_edit_date": 1452695265, "creation_date": 1452694611, "answer_id": 34768999, "question_id": 34768771, "link": "https://stackoverflow.com/questions/34768771/expected-at-end-of-declaration-list-c-when-i-have-one-already/34768999#34768999", "title": "expected &#39;;&#39; at end of declaration list c when i have one already", "body": "<p>You can't initialize a structure in a <code>typedef</code>. You have to do it when you define a variable of that type:</p>\n\n<pre><code>typedef struct\n{\n   char bread[9][50];   // the longest string is 38 characters, so the second dimension \n                        // should be at least 39 (38 plus the null terminating byte)\n                        // we'll round up to 50 to leave space for expansion\n} subway;\n\nsubway s = {{\n   \"1. 9-Grain Wheat\",\n   \"2. 9-Grain Honey Oat\",\n   \"3. Italian\",\n   \"4. Italian Herbs &amp; Cheese\",\n   \"5. Flatbread (not baked in restaurant)\",\n   \"6. Cheese Bread\",\n   \"7. Hearty Italian\",\n   \"8. Parmesan Oregano\",\n   \"9. Roasted Garlic\"\n}};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694968, "post_id": 34769003, "comment_id": 57283013, "body": "There is absolutely no need to change the type name to <code>subway_t</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452695007, "post_id": 34769003, "comment_id": 57283042, "body": "@iharob Personal preference. You can call it <code>metro</code> for all I care :)"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1452694895, "last_edit_date": 1452694895, "creation_date": 1452694625, "answer_id": 34769003, "question_id": 34768771, "link": "https://stackoverflow.com/questions/34768771/expected-at-end-of-declaration-list-c-when-i-have-one-already/34769003#34769003", "title": "expected &#39;;&#39; at end of declaration list c when i have one already", "body": "<p>A <code>typedef</code> is a type definition, it is not a variable declaration. It does not make any sense to initialize a type. </p>\n\n<p>You should be doing this:</p>\n\n<pre><code>typedef struct\n{\n   char bread[9][LARGE_ENOUGH];\n} subway_t;\n\n...\n\nsubway_t sub = { /* initialization */ };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1452694759, "post_id": 34769006, "comment_id": 57282844, "body": "Initialization is not done with strcpy functions... and this is not the problem here... and  <a href=\"http://stackoverflow.com/questions/2114896/why-are-strlcpy-and-strlcat-considered-insecure\"><code>strncpy</code> is a dangerous function that should not be used</a>.. and there is no <code>char(*)[]</code> in the code..."}], "tags": [], "owner": {"reputation": 119, "user_id": 4546563, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9WMq6SMYjzk/AAAAAAAAAAI/AAAAAAAAAH4/f7qdMMxHx1w/photo.jpg?sz=128", "display_name": "gRRosminet", "link": "https://stackoverflow.com/users/4546563/grrosminet"}, "is_accepted": false, "score": -2, "last_activity_date": 1452694646, "creation_date": 1452694646, "answer_id": 34769006, "question_id": 34768771, "link": "https://stackoverflow.com/questions/34768771/expected-at-end-of-declaration-list-c-when-i-have-one-already/34769006#34769006", "title": "expected &#39;;&#39; at end of declaration list c when i have one already", "body": "<p>Your initialization is false : you're trying to initialize a char [][] with a (char *) [].\nyou should use strncpy to initilize such an array</p>\n"}], "owner": {"reputation": 69, "user_id": 5534654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34672592f794d0160b175befcb7ac4f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Russo", "link": "https://stackoverflow.com/users/5534654/andrew-russo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9068, "favorite_count": 1, "accepted_answer_id": 34768999, "answer_count": 4, "score": 4, "last_activity_date": 1452695691, "creation_date": 1452693992, "last_edit_date": 1452694302, "question_id": 34768771, "link": "https://stackoverflow.com/questions/34768771/expected-at-end-of-declaration-list-c-when-i-have-one-already", "title": "expected &#39;;&#39; at end of declaration list c when i have one already", "body": "<p>Im trying to declare and array in a structure called bread, but it keeps giving me the error expected ';' at end of declaration list when i already have one. </p>\n\n<pre><code>typedef struct\n{\n   char bread[9][35] = {\n   \"1. 9-Grain Wheat\", \n   \"2. 9-Grain Honey Oat\", \n   \"3. Italian\", \n   \"4. Italian Herbs &amp; Cheese\",\n   \"5. Flatbread (not baked in restaurant)\", \n   \"6. Cheese Bread\", \n   \"7. Hearty Italian\", \n   \"8. Parmesan Oregano\", \n   \"9. Roasted Garlic\" };        \n} subway;\n</code></pre>\n\n<p>this is the contents of the header file the structure is in</p>\n"}, {"tags": ["android", "c", "sockets"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452693853, "post_id": 34768695, "comment_id": 57282193, "body": "On android the application needs to have network access permission, how are you installing it? It has to be present in the manifest file."}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 1, "creation_date": 1452693951, "post_id": 34768695, "comment_id": 57282264, "body": "+ network io should not be done on main thread ..."}, {"owner": {"reputation": 51, "user_id": 4908911, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/04076e7a682cc9fb89047d5b10393fd7?s=128&d=identicon&r=PG&f=1", "display_name": "EmanueleRiso", "link": "https://stackoverflow.com/users/4908911/emanueleriso"}, "edited": false, "score": 0, "creation_date": 1452694033, "post_id": 34768695, "comment_id": 57282315, "body": "i didn&#39;t write an Android app, it&#39;s just a .c file"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452694532, "post_id": 34768695, "comment_id": 57282680, "body": "The process must run as <code>root</code>, only root is allowed to open a raw socket. @iharob This applies only to android apps (java)"}, {"owner": {"reputation": 51, "user_id": 4908911, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/04076e7a682cc9fb89047d5b10393fd7?s=128&d=identicon&r=PG&f=1", "display_name": "EmanueleRiso", "link": "https://stackoverflow.com/users/4908911/emanueleriso"}, "edited": false, "score": 0, "creation_date": 1452694701, "post_id": 34768695, "comment_id": 57282803, "body": "in c4droid there is the option &quot;Run program as a root&quot;. this option in checked, so i don&#39;t know why c4droid don&#39;t execute the program"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1452694831, "post_id": 34768695, "comment_id": 57282900, "body": "@EmanueleRiso You might want to double-check if the process really runs as root by outputting the effective uid in your error message (<code>geteuid()</code>)."}, {"owner": {"reputation": 51, "user_id": 4908911, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/04076e7a682cc9fb89047d5b10393fd7?s=128&d=identicon&r=PG&f=1", "display_name": "EmanueleRiso", "link": "https://stackoverflow.com/users/4908911/emanueleriso"}, "edited": false, "score": 0, "creation_date": 1452695369, "post_id": 34768695, "comment_id": 57283299, "body": "it gives me number 10133, i suppose that is not in root mode"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1452695824, "post_id": 34768695, "comment_id": 57283607, "body": "@EmanueleRiso correctamundo ;) maybe you can get a root shell via <code>adb</code> and execute it manually?"}], "owner": {"reputation": 51, "user_id": 4908911, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/04076e7a682cc9fb89047d5b10393fd7?s=128&d=identicon&r=PG&f=1", "display_name": "EmanueleRiso", "link": "https://stackoverflow.com/users/4908911/emanueleriso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452693831, "creation_date": 1452693770, "last_edit_date": 1452693831, "question_id": 34768695, "link": "https://stackoverflow.com/questions/34768695/c4droid-error-create-socket", "title": "c4droid error create socket", "body": "<p>I wrote a simple networking program in C language, i tested it on my PC and everything is ok but when i try to execute this program on my smartphone android (i used c4droid to compile and execute c program on my smartphone) the terminal gives me this error: \"error creating socket: Operation not permitted\".</p>\n\n<p>this is the code of socket</p>\n\n<pre><code>int sock;\nsock = socket(AF_INET,SOCK_RAW, IPPROTO_ICMP);\nif (sock &lt; 0) {\n    printf(\"error creating socket\\n\");\n}\n</code></pre>\n\n<p>what is problem? Is there somebody using c4droid to develop networking program in c language?</p>\n"}, {"tags": ["c++", "c", "arm"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1452692916, "post_id": 34768346, "comment_id": 57281508, "body": "What don&#39;t you understand specifically the <code>0x40000000</code> or what <code>volatile uint32_t *</code> means?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 4, "creation_date": 1452693180, "post_id": 34768346, "comment_id": 57281693, "body": "Please chose one of the <code>C</code> and <code>C++</code> tags, unless you&#39;re asking specifically about an interaction between these two languages."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1452693335, "post_id": 34768346, "comment_id": 57281822, "body": "You might also benefit from reading <a href=\"http://stackoverflow.com/q/4166201/212858\">this question</a> which ends up with similar code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1452693445, "post_id": 34768346, "comment_id": 57281894, "body": "Possible duplicate <a href=\"http://stackoverflow.com/questions/15267001/how-to-store-a-variable-at-a-specific-memory-location/15268780#15268780\">1</a> <a href=\"http://stackoverflow.com/questions/5029938/c-pointers-and-the-physical-address/5031056#5031056\">2</a> and <a href=\"http://stackoverflow.com/questions/31262865/what-does-port-0x41004400ul-mean-here/31266754#31266754\">3</a>. And so on. Please do some research."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1452693866, "post_id": 34768346, "comment_id": 57282203, "body": "@Lundin I choose 2 here as coming closest to resemble. Well, to be fair it might be hard to find these dupes, unless you have answered them yourselves ;-) ..."}, {"owner": {"reputation": 59, "user_id": 4679915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f376eddead81dc281e430f1e6fbeeda8?s=128&d=identicon&r=PG&f=1", "display_name": "DombleMaza", "link": "https://stackoverflow.com/users/4679915/domblemaza"}, "edited": false, "score": 0, "creation_date": 1452694752, "post_id": 34768346, "comment_id": 57282839, "body": "If i tell frankly in simple words than i am not able to understand why there is two &#39;*&#39; in right-side statement? I mean we are declaring a pointer to that particular memory address like <code>volatile uint32_t *ptr = 0x40000000</code>. What is the purpose of another pointer?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1452695043, "post_id": 34768346, "comment_id": 57283069, "body": "@DombleMaza To clarify finally: The outer <code>*</code> is not <i>a pointer</i>, but used to dereference that formerly declared (casted) pointer, thus the memory address is accessed to read/write a value from/to it."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1452695093, "post_id": 34768346, "comment_id": 57283108, "body": "The purpose is to use that macro as: <code>WATCHDOG0_LOAD_R= 0xAA55AA55</code> or <code>uint32_t reg_value = WATCHDOG0_LOAD_R;</code> In other words you directly access the content of the resister to set or read it."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 59, "user_id": 4679915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f376eddead81dc281e430f1e6fbeeda8?s=128&d=identicon&r=PG&f=1", "display_name": "DombleMaza", "link": "https://stackoverflow.com/users/4679915/domblemaza"}, "edited": false, "score": 0, "creation_date": 1452693716, "post_id": 34768441, "comment_id": 57282087, "body": "@DombleMaza refering to your comment: which &quot;following syntax&quot; ?"}, {"owner": {"reputation": 59, "user_id": 4679915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f376eddead81dc281e430f1e6fbeeda8?s=128&d=identicon&r=PG&f=1", "display_name": "DombleMaza", "link": "https://stackoverflow.com/users/4679915/domblemaza"}, "edited": false, "score": 1, "creation_date": 1452694435, "post_id": 34768441, "comment_id": 57282616, "body": "Thanks a lot. But i am still not able to understand the purpose of making this whole this as a pointer. <code>(volatile uint32_t *)0x40000000</code> is not a pointer itself?  May i write a same code as <code>volatile uint32_t *ptr = 0x40000000; #define WATCHDOG0_LOAD_R     *ptr </code>?"}], "tags": [], "owner": {"reputation": 5259, "user_id": 482317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baddc1ebd4dbe1bdb3fa853c18fe155f?s=128&d=identicon&r=PG", "display_name": "Andrea Bergia", "link": "https://stackoverflow.com/users/482317/andrea-bergia"}, "is_accepted": false, "score": 17, "last_activity_date": 1452693139, "last_edit_date": 1452693139, "creation_date": 1452693029, "answer_id": 34768441, "question_id": 34768346, "link": "https://stackoverflow.com/questions/34768346/pointer-to-volatile-data-volatile-uint32-t-0x40000000/34768441#34768441", "title": "Pointer to volatile data (*((volatile uint32_t *)0x40000000))", "body": "<p>Let's take it one step at the time:</p>\n\n<pre><code>0x40000000\n</code></pre>\n\n<p>is your memory address.</p>\n\n<pre><code>(uint32_t *)0x40000000\n</code></pre>\n\n<p>casts this to a pointer to that memory address, of type <code>uint32_t</code>, meaning 32 bit without sign. </p>\n\n<pre><code>(volatile uint32_t *)0x40000000\n</code></pre>\n\n<p><code>volatile</code> means, basically, \"hey compiler, don't do any optimization; I really want to go every time to that memory address and fetch it, without any prefetch or anything particular\".</p>\n\n<pre><code>*((volatile uint32_t *)0x40000000)\n</code></pre>\n\n<p>means: take the value contained at the address identified by that pointer, so the four bytes starting at <code>0x40000000</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3703887"}, "edited": false, "score": 2, "creation_date": 1452693125, "post_id": 34768445, "comment_id": 57281654, "body": "Note also the dereference. Assigning this definition to an integer will load the value at the address."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1452693313, "post_id": 34768445, "comment_id": 57281800, "body": "@TruthSerum True, I edited. I was hoping that OP understand that on his/her own, at least."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 8, "last_activity_date": 1452695158, "last_edit_date": 1452695158, "creation_date": 1452693043, "answer_id": 34768445, "question_id": 34768346, "link": "https://stackoverflow.com/questions/34768346/pointer-to-volatile-data-volatile-uint32-t-0x40000000/34768445#34768445", "title": "Pointer to volatile data (*((volatile uint32_t *)0x40000000))", "body": "<p>Analyzing <code>(*((volatile uint32_t *)0x40000000))</code></p>\n\n<ul>\n<li><code>0x40000000</code> is the address of register in your micro memory map</li>\n<li>the register is 32 bits wide, that means must be <code>uint32_t *</code></li>\n<li><code>volatile</code> is added to tell compile to avoid to optimize that variable because of could change, for example, in an interrupt routine.</li>\n<li>last: the <code>*</code> dereference the pointer: make you able to access the content of that specific register.</li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 4679915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f376eddead81dc281e430f1e6fbeeda8?s=128&d=identicon&r=PG&f=1", "display_name": "DombleMaza", "link": "https://stackoverflow.com/users/4679915/domblemaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5818, "favorite_count": 3, "closed_date": 1452693827, "answer_count": 2, "score": 3, "last_activity_date": 1452695158, "creation_date": 1452692782, "last_edit_date": 1452693140, "question_id": 34768346, "link": "https://stackoverflow.com/questions/34768346/pointer-to-volatile-data-volatile-uint32-t-0x40000000", "closed_reason": "Duplicate", "title": "Pointer to volatile data (*((volatile uint32_t *)0x40000000))", "body": "<p>I am analyzing a peripheral driver's files and found some register mapping code. I have basic knowledge about pointers, but am unable to understand the below code. </p>\n\n<pre><code>#define WATCHDOG0_LOAD_R        (*((volatile uint32_t *)0x40000000))\n</code></pre>\n\n<p>I have understood that it defines the identifier <code>WATCHDOG0_LOAD_R</code> to the register's memory address. But I am not able to understand the syntax on the right side. Could anyone explain me in detail why this pointer is written in such a way?</p>\n"}, {"tags": ["c", "string", "text", "awk"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1452692254, "post_id": 34768162, "comment_id": 57281045, "body": "<i>&quot;There are either too many possible answers, or good answers would be too long for this format. Please add details to narrow the answer set or to isolate an issue that can be answered in a few paragraphs.&quot;</i>"}, {"owner": {"reputation": 64845, "user_id": 2088135, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YB10Q.jpg?s=128&g=1", "display_name": "Tom Fenech", "link": "https://stackoverflow.com/users/2088135/tom-fenech"}, "edited": false, "score": 0, "creation_date": 1452693149, "post_id": 34768162, "comment_id": 57281672, "body": "<i>a file with some number</i> is not an adequate description of your data. Please show us a representative sample of it."}], "answers": [{"comments": [{"owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 0, "creation_date": 1452692881, "post_id": 34768333, "comment_id": 57281477, "body": "Actually, it is sufficient to remove only the first quote: awk will treat the value <code>123abc</code> as the number 123 in a numeric context."}], "tags": [], "owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "is_accepted": true, "score": 1, "last_activity_date": 1452692745, "creation_date": 1452692745, "answer_id": 34768333, "question_id": 34768162, "link": "https://stackoverflow.com/questions/34768162/string-manipulation-in-awk-or-in-c/34768333#34768333", "title": "string manipulation in AWK or in C", "body": "<p>In awk, you'll have to strip off the quotes manually</p>\n\n<pre><code>$ echo '\"2134\"' | awk '{gsub(/(^\")|(\"$)/,\"\",$1); print $1+2}'\n2136\n</code></pre>\n\n<p>Obviously, this is not a C answer.</p>\n"}], "owner": {"reputation": 21, "user_id": 5551329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc20cb909e98565662065acddddcbfac?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/5551329/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1452693159, "accepted_answer_id": 34768333, "answer_count": 1, "score": -4, "last_activity_date": 1452695371, "creation_date": 1452692229, "last_edit_date": 1452695371, "question_id": 34768162, "link": "https://stackoverflow.com/questions/34768162/string-manipulation-in-awk-or-in-c", "closed_reason": "Needs details or clarity", "title": "string manipulation in AWK or in C", "body": "<p>I have a problem, I have a file with some number delimited by \"\". For example \"125\" etc.</p>\n\n<p>An example of the file is:</p>\n\n<pre><code>10.0.0.0 11.0.0.0 \"1200\"\n10.0.0.1 11.0.0.0.1 \"200\"\n11.0.0.1 11.0.0.2 \"320\"\n</code></pre>\n\n<p>I use <code>AWK</code> for take the data but my problem is that I have to take only the integer value of the third column without \"\" because after I need to have some calculation with this numbers.\nThe solution is good also in <code>C</code> language.\nSomeone can help me?\nThanks</p>\n"}, {"tags": ["c", "binary", "complement"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1452692200, "post_id": 34768121, "comment_id": 57281009, "body": "I don&#39;t understand. 2&#39;s complement is binary. And how do you &quot;make&quot; using logic gates in C?"}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1452692251, "post_id": 34768121, "comment_id": 57281043, "body": "@unwind, you just simulate the logic gates. This is because making circuits needs lots of time and is difficult."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1452692317, "post_id": 34768121, "comment_id": 57281087, "body": "@unwind, 2&#39;s complement is a bit different than binary. I agree it&#39;s binary, but it isn&#39;t exactly binary."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1452692429, "post_id": 34768121, "comment_id": 57281170, "body": "I still don&#39;t understand what you mean. And I believe the answer is &quot;no&quot;, it&#39;s not possible unless you want to add an extra bit that holds this information."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1452692464, "post_id": 34768121, "comment_id": 57281206, "body": "It&#39;s a quite unclear whether you&#39;re talking about binary and 2s complement  in C, or whether you&#39;re talking about the output of your simulated binary adder, or a mix thereof - and in that case what anyone can do to help. Start with some code rather, and tell us where you got stuck. However, just by looking at a number, a computer can&#39;t tell you if it&#39;s binary or 2s complement, it&#39;s the other way around, you need to tell the computer how to interpret it."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452692486, "post_id": 34768121, "comment_id": 57281215, "body": "By <i>2&#39;s complement</i> vs <i>binary</i>, do you mean <i>signed</i> vs <i>unsigned</i>?"}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452692510, "post_id": 34768121, "comment_id": 57281235, "body": "@user694733, I mean signed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1452692517, "post_id": 34768121, "comment_id": 57281246, "body": "Binary is just something fundamental: a raw collection of one&#39;s and zeroes. The computer has no idea what those ones and zeroes represent: it could be a signed number or it could be a picture of a cat. It is the job of the programmer to write a program that tells the computer what to do with the binary. It doesn&#39;t make sense to go the other way around. You can&#39;t have the computer telling you what your program is supposed to do."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1452692536, "post_id": 34768121, "comment_id": 57281261, "body": "@nos, I&#39;ll post my code. Just give me a few minutes."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452692595, "post_id": 34768121, "comment_id": 57281294, "body": "I&#39;m very interested to get a link to a <b>current</b> non-binary computer with more functionality than an Op-Amp."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452692742, "post_id": 34768121, "comment_id": 57281388, "body": "@AshishAhuja: 2s complement - as any other value in a computer is very well binary. There is no &quot;more or less binary&quot;. Todays computers are all binary. Any value representation is just an encoding. For unsigned, there are also other encodings than the simple <code>2**n</code> representation. E.g gray-code."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1452695079, "post_id": 34768121, "comment_id": 57283103, "body": "@nos. I have posted code and my design. Hope this is enough. If you want anything more, tell me."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452695898, "post_id": 34768121, "comment_id": 57283656, "body": "Now it becomes more clear. Note: If you only use boolean values, use the appropriate type. C supports <code>_Bool</code> (you can use the more common <code>boll</code> if you <code>#include &lt;stdbool.h&gt;</code>). Also it is not necessary to compare with boolean values. You can simply e.g. write <code>a = !a</code> for <code>not</code>. This works also for normal integer types and is more readable than the explicit comparisons."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452696292, "post_id": 34768121, "comment_id": 57283960, "body": "Correction: It is <code>bool</code> of course."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1456046528, "post_id": 34768121, "comment_id": 58757368, "body": "A number cannot be binary or 2&#39;s complement. Binary is a way of representing a number. 2&#39;s complement is a way of representing a number. A number is the number of cars I own, which can be represented in Roman numbers, decimal digits, binary, or any other representation and it will still be the same number. The distinction between numbers and representations is extremely important for programmers to understand."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452692813, "post_id": 34768211, "comment_id": 57281449, "body": "There are various other representations which use the MSB as signe, but are not 2&#39;s complement. And &quot;a positive number setting ...&quot; is not possible. Because then the encoding does not represent a positive number anymore. An <i>operation</i> OTOH which <i>would</i> change that bit <b>incorrectly</b> generates overflow. In C, overflow of signed integers is undefined behaviour - no further research required."}, {"owner": {"reputation": 548, "user_id": 2229835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXQjN.jpg?s=128&g=1", "display_name": "Kellerspeicher", "link": "https://stackoverflow.com/users/2229835/kellerspeicher"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452692951, "post_id": 34768211, "comment_id": 57281540, "body": "Yes. But not relevant for the question here. Otherwise it will be very complicate for an obvious beginner here."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452693086, "post_id": 34768211, "comment_id": 57281621, "body": "A beginner starting with such a project as OP has to know about these facts. If he does not understand, he should backup and get the basics right first. Anyway, an answer should be correct and use the correct terms. Notive this will not only be read by OP. To detect if a signed integer is negative, just compare with <code>0</code>. No bit-fiddling needed."}, {"owner": {"reputation": 548, "user_id": 2229835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXQjN.jpg?s=128&g=1", "display_name": "Kellerspeicher", "link": "https://stackoverflow.com/users/2229835/kellerspeicher"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452693226, "post_id": 34768211, "comment_id": 57281738, "body": "You are free to provide an educational better adapted answer. The questioner obviously what to fiddle bits: &quot;using only logic gates&quot;"}], "tags": [], "owner": {"reputation": 548, "user_id": 2229835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXQjN.jpg?s=128&g=1", "display_name": "Kellerspeicher", "link": "https://stackoverflow.com/users/2229835/kellerspeicher"}, "is_accepted": false, "score": 3, "last_activity_date": 1452692833, "last_edit_date": 1452692833, "creation_date": 1452692393, "answer_id": 34768211, "question_id": 34768121, "link": "https://stackoverflow.com/questions/34768121/how-to-check-whether-a-number-is-binary-or-2s-complement-in-c/34768211#34768211", "title": "How to check whether a number is binary or 2&#39;s complement in C?", "body": "<p>Both are <em>binary</em>. The difference is <code>signed</code> or <code>unsigned</code>. For <code>&gt;0</code> this is the same. For <code>&lt;0</code> you can see that it is a negative number just by looking at the highest bit. Using the same function for output can easily be done by looking at the highest bit, if it is set output '-' and convert the negative two's complement to its <code>abs()</code> which can easily be done bitwise.</p>\n\n<p><strong>CAUTION</strong>: If a positive number is big enough to set the highest bit, it can no longer be distinguished from negative two's complement. That is the reason why programming languages do need separate types for this (e.g. in C <code>int</code> and <code>unsigned</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452695148, "post_id": 34768614, "comment_id": 57283150, "body": "What do you mean by <i>&quot;asymmetric&quot;</i>?"}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452695627, "post_id": 34768614, "comment_id": 57283478, "body": "Hmm, I have got it. Now I have posted code in the question. Is this enough to make it readable and understandable? Also, I just noticed that you have typed separately wrongly. Can you edit it for future viewers."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452695983, "post_id": 34768614, "comment_id": 57283719, "body": "Thanks, edited. Feel free to correct such typos yourself next time. Just a hint: do some research for a &quot;full adder&quot; and &quot;half adder&quot;. These are typical logic building blocks of few gates which add two bits and are meant to be cascaded for arbitrary bit-width. Also search for &quot;serial adder&quot;. These come from hardware-development. There are also chips available with these functions (74XXyy TTL-logic series)."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452696200, "post_id": 34768614, "comment_id": 57283886, "body": "no I couldn&#39;t. As the minimum edit limit is 6 characters, and  there was nothing else to correct, I only could have contacted you. the author of the post."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452696244, "post_id": 34768614, "comment_id": 57283918, "body": "@AshishAhuja: There is a trick: The systems does not notice if you cut/paste the same text ... ;-)"}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452698255, "post_id": 34768614, "comment_id": 57285419, "body": "that&#39;s nice. I&#39;ll surely do the edit myself next time."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452698514, "post_id": 34768614, "comment_id": 57285630, "body": "I know what a half-adder and a full-adder is. Although, I&#39;ll check what a serial adder is. this is all covered in the book - Digital Logic and Computer Design: Morris Mano. This is the book I am using. Although, do you know any internet projects, which are based on hardware circuit simulations, such as this: <a href=\"https://www.coursera.org/course/nand2tetris1\" rel=\"nofollow noreferrer\">coursera.org/course/nand2tetris1</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1452698970, "post_id": 34768614, "comment_id": 57285958, "body": "@AshishAhuja: I have some homebrew self-built hardware and computers already here from the 70ies and 80ies. I learned that from the diode. So I had my fair amount of burnt fingers from a soldering iron or zaps from self-constructed power supplies. Happy now to use 32 bit MCUs and a good toolchain :-)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 0, "last_activity_date": 1452695948, "last_edit_date": 1592644375, "creation_date": 1452693507, "answer_id": 34768614, "question_id": 34768121, "link": "https://stackoverflow.com/questions/34768121/how-to-check-whether-a-number-is-binary-or-2s-complement-in-c/34768614#34768614", "title": "How to check whether a number is binary or 2&#39;s complement in C?", "body": "<p>Fun fact about 2s complement - and reason it has become so widely used is:</p>\n<blockquote>\n<p>For addition you don't need to know if it is negative or positive. Just add as unsigned.</p>\n<p>Subtraction is similar, but you have to negate the second operand (see below).</p>\n</blockquote>\n<p>The only thing you might have to care about is overflow. For that you have to check if the sign of the result can actually result from the signs of the two inputs and a addition-overflow from the pre-most to the most signigficant bit.</p>\n<p>Negation of <code>int n</code> is simply done by <code>0 - n</code>. Alternatively, you can invert all bits and add <code>1</code> - that's what a CPU or hardware subtracter basically does.</p>\n<p>Note that 2's complement binaries have an asymmetric range: <code>-(N+1) ... N</code>.</p>\n<p>For conversion, just check for the minimum value (must be treated seperately) and output directly, otherwise get the sign (<code>if ( n &lt; 0 )</code>) and negate the value (<code>n = -n</code>) and finally convert the -then unsigned/positive - value to a string or character stream.</p>\n"}], "owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 0, "accepted_answer_id": 34768614, "answer_count": 2, "score": -4, "last_activity_date": 1452695948, "creation_date": 1452692127, "last_edit_date": 1452695003, "question_id": 34768121, "link": "https://stackoverflow.com/questions/34768121/how-to-check-whether-a-number-is-binary-or-2s-complement-in-c", "title": "How to check whether a number is binary or 2&#39;s complement in C?", "body": "<p>I was making a binary adder in C using only logic gates. Now for example, I wanted to add <code>4 + (-5)</code> so I would get the answer in 2's complement and then convert it to decimal. In the same way, if I do, <code>4 + (-3)</code> I would get the answer in binary and would like to use the same function to convert it to decimal.</p>\n\n<p>Now, I know how to convert a 2's complement number into decimal, convert binary into decimal. But I want to use the same function to convert both 2's complement and binary into decimal. To do that, I have to figure out if the number is binary or 2's complement. It is where I am stuck.</p>\n\n<p>Can someone give me an idea, algorithm or code in C to find out whether a number is 2's complement or normal binary?</p>\n\n<p><strong>SOURCE CODE</strong></p>\n\n<p><strong>Chips</strong></p>\n\n<pre><code>// Author: Ashish Ahuja\n// Date created: 8-1-2016\n// Descriptions: This file stores all the chips for\n//               the nand2tetris project.\n// Links: www.nand2tetris.org\n//        class.coursera.org/nand2tetris1-001\n// Files needed to compile successfully: ourhdr.h\n\nint not (unsigned int a) {\n    if (a == 1) {\n          return 0;\n    }\n    else if (a == 0) {\n          return 1;\n    }\n}\n\nint and (unsigned int a, unsigned int b) {\n    if (a == 1 &amp;&amp; b == 1)\n          return 1;\n    else if ((a == 1 &amp;&amp; b == 0) || (a == 0 &amp;&amp; b == 1) || (a == 0 &amp;&amp; b == 0))\n          return 0;\n}\n\nint nand (unsigned int a, unsigned int b) {\n    unsigned int ans = 10;\n    ans = and (a, b);\n    unsigned int ack = not (ans);\n    return ack;\n}\n\nint or (unsigned int a, unsigned int b) {\n    return (nand (not (a), not (b)));\n}\n\nint nor (unsigned int a, unsigned int b) {\n    return (not (or (a, b)));\n}\n\nint xor (unsigned int a, unsigned int b) {\n    unsigned int a_r;\n    unsigned int b_r;\n    unsigned int sra;\n    unsigned int srb;\n    a_r = not (a);\n    b_r = not (b);\n    sra = nand (a_r, b);\n    srb = nand (b_r, a);\n    return nand (sra, srb);\n}\n\nint xnor (unsigned int a, unsigned int b) {\n    return (not (xor (a,b)));\n}\n</code></pre>\n\n<p><strong>Ourhdr.h</strong></p>\n\n<pre><code>include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;my/signal.h&gt;\n#include &lt;my/socket.h&gt;\n#include &lt;my/io.h&gt;\n#include &lt;my/lib.h&gt;\n#include &lt;my/tree.h&gt;\n#include &lt;my/bits.h&gt;\n#include &lt;my/binary.h&gt;\n//#include &lt;my/error.h&gt;\n\n#define MAXLINE 4096\n#define BUFF_SIZE 1024\n</code></pre>\n\n<p>Note: I am gonna only show headers needed by this project. So just think that the other headers are of no use.</p>\n\n<p><strong>Function to Convert array to integer</strong></p>\n\n<pre><code>int array_num (int arr [], int n) {\n    char str [6] [2];\n    int i;\n    char number [13] = {'\\n'};\n    for (i = 0; i &lt; n; i ++)\n        sprintf (str [i], \"%d\", arr [i]);\n    for (i = 0; i &lt; n; i ++)\n        strcat (number, str [i]);\n    i = atoi (number);\n    return i;\n}\n</code></pre>\n\n<p><strong>Function to get bits of an int, and return an pointer to an array containing bits</strong></p>\n\n<pre><code>int *get_bits (int n, int bitswanted) {\n    int *bits = malloc (sizeof (int) * bitswanted);\n    int k;\n    int mask;\n    int masked_n;\n    int thebit;\n    for (k = 0; k &lt; bitswanted; k ++) {\n        mask = 1 &lt;&lt; k;\n        masked_n = n &amp; mask;\n        thebit = masked_n &gt;&gt; k;\n        bits [k] = thebit;\n    }\n    return bits;\n}\n</code></pre>\n\n<p><strong>Function to convert binary to decimal, and vice-versa</strong></p>\n\n<pre><code>int convert_num (int n, int what) {\n    int rem;\n    int i;\n    int binary = 0;\n    int decimal = 0;\n\n    switch (what) {\n        case 0:                    // Convert decimal to binary\n             i = 0;\n             rem = 0;\n             while (n != 0) {\n                   rem = n % 2;\n                   n /= 2;\n                   binary += rem * i;\n                   i *= 10;\n             }\n             return binary;\n             break;\n        case 1:                   // Convert binary to decimal\n             i = 0;\n             rem = 0;\n             while (n != 0) {\n                   rem = n % 10;\n                   n /= 10;\n                   decimal += rem*pow (2, i);\n                   i ++;\n             }\n             return decimal;\n             break;\n    }\n}\n</code></pre>\n\n<p><strong>Main program design</strong></p>\n\n<ul>\n<li>Read two numbers <code>n1</code> and <code>n2</code> from user</li>\n<li>Get an pointer <code>bits1</code> and <code>bits2</code> which point to an array which have the bits of <code>n1</code> and <code>n2</code>. Note, that the array will be in reverse order, i.e, the last bit will be in the <code>0th</code> variable of the array.</li>\n<li>Put a for loop in which you will pass three variables, i.e, the bits you want to add and carry from the last adding of bits operation.</li>\n<li>The return value will be the the addition of the three bits and carry, will be changed to the carry after the addition (if any). Eg- You pass <code>1</code> and <code>0</code>, and carry is <code>1</code>, so, the return will be <code>0</code> and carry will be again changed to <code>1</code>.</li>\n<li>The return will be stored in another array called <code>sum</code>.</li>\n<li>The array <code>sum</code> will be converted to an int using the function I have given above.</li>\n<li>Now this is where I am stuck. I now want to change the int into a decimal number. But to do that, I must know whether, it is in form of a 2's compliment number, or just a normal binary. I do not know how to do that.</li>\n</ul>\n\n<p><strong>NOTE:</strong> The <code>nand2tetris</code> project is done in <code>hdl</code> but I was familiar to do it with C. Also, many of the function I have mentioned above have been taken from <code>stackoverflow</code>. Although, the design is my own.  </p>\n"}, {"tags": ["c", "procedural-generation", "world-map"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1452692161, "post_id": 34768039, "comment_id": 57280985, "body": "Of course: <code>int world[1000][1000] = { {1, 1, 1, 0, 0, ...},{0, 0, 0, 1, ...}, ...};</code>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1452692173, "post_id": 34768039, "comment_id": 57280993, "body": "You mean terrain generation? A simple and okay-ish way is the <a href=\"https://en.wikipedia.org/wiki/Diamond-square_algorithm\" rel=\"nofollow noreferrer\">Diamond-Square algorithm</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1452692809, "post_id": 34768039, "comment_id": 57281444, "body": "You only need 1000*1000/8 bytes. One byte is 8 bits."}, {"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1452695822, "post_id": 34768039, "comment_id": 57283602, "body": "have you looked at: <a href=\"http://sourceforge.net/projects/platec/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/platec</a>; <a href=\"https://github.com/bapt/cplanet\" rel=\"nofollow noreferrer\">github.com/bapt/cplanet</a> or <a href=\"https://github.com/Mindwerks/worldengine\" rel=\"nofollow noreferrer\">github.com/Mindwerks/worldengine</a> ?"}], "answers": [{"tags": [], "owner": {"reputation": 344, "user_id": 4618003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e8f098af732d64e92365592e685a3c?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4618003/bernhard"}, "is_accepted": false, "score": 4, "last_activity_date": 1452749390, "last_edit_date": 1452749390, "creation_date": 1452693159, "answer_id": 34768486, "question_id": 34768039, "link": "https://stackoverflow.com/questions/34768039/how-to-create-a-world-map-using-c-language/34768486#34768486", "title": "How to create a world map using C language?", "body": "<p>Obviously, there's no algorithm which describes the shape of the coastline of the continents ;)</p>\n\n<p>But you could use e.g. Smrender (<a href=\"http://www.abenteuerland.at/smrender/\" rel=\"nofollow\">http://www.abenteuerland.at/smrender/</a>), feed it with the coastline of e.g. OpenStreetMap or Naturalearthdata and a single rule. Let it create a PNG image with 1000x1000 pixels.</p>\n\n<p>EDIT:\nWith ImageMagick (convert) you can directly convert a PNG into a C header file as an array.\nGo to Openstreetmap.org (or Googlemaps), zoom out until you see the whole world, make a screenshot, open it in your favorite image manipulation program and cut and resize it to 1000x1000, then run <code>convert input.png output.h</code>.</p>\n\n<p>Bernhard</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1452694011, "creation_date": 1452694011, "answer_id": 34768776, "question_id": 34768039, "link": "https://stackoverflow.com/questions/34768039/how-to-create-a-world-map-using-c-language/34768776#34768776", "title": "How to create a world map using C language?", "body": "<p>You could have some program or script (taking as input some representation of some image of the Earth) which generates a long C file like</p>\n\n<pre><code>const char map[1000][1000] = {\n  {'0', '1', //.... etc for the first fow\n  },\n  {'0', '0', '0', '1', //... etc\n  }\n  /// etc for other rows\n}; \n</code></pre>\n\n<p>See also <a href=\"https://en.wikipedia.org/wiki/X_BitMap\" rel=\"nofollow\">XBM</a> for an example.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 3706886, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001892535248/picture?type=large", "display_name": "user3706886", "link": "https://stackoverflow.com/users/3706886/user3706886"}, "edited": false, "score": 0, "creation_date": 1452695593, "post_id": 34768820, "comment_id": 57283454, "body": "Thanku sir.. Is there any more simple way to create?"}, {"owner": {"reputation": 649, "user_id": 3159055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f9fdc5512fa6669685c7d6300cb65a4?s=128&d=identicon&r=PG", "display_name": "PRDeving", "link": "https://stackoverflow.com/users/3159055/prdeving"}, "reply_to_user": {"reputation": 21, "user_id": 3706886, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001892535248/picture?type=large", "display_name": "user3706886", "link": "https://stackoverflow.com/users/3706886/user3706886"}, "edited": false, "score": 0, "creation_date": 1452695674, "post_id": 34768820, "comment_id": 57283500, "body": "Indeed, the technique is really simple, the implementation that i did is really tricky, it was a test, so its hard to understand. You only have to populate the map with 0&#39;s, choose a random init poiint, loop lot of times (20000 in the example), in each loop the script has to choose a random direction, set a land tile in that position and update that position as the &quot;current&quot;, that will give you what you saw in the demo"}], "tags": [], "owner": {"reputation": 649, "user_id": 3159055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f9fdc5512fa6669685c7d6300cb65a4?s=128&d=identicon&r=PG", "display_name": "PRDeving", "link": "https://stackoverflow.com/users/3159055/prdeving"}, "is_accepted": false, "score": 1, "last_activity_date": 1452696441, "last_edit_date": 1492085921, "creation_date": 1452694141, "answer_id": 34768820, "question_id": 34768039, "link": "https://stackoverflow.com/questions/34768039/how-to-create-a-world-map-using-c-language/34768820#34768820", "title": "How to create a world map using C language?", "body": "<p>I wrote a answer in game development some hours ago that can help you, heres the <a href=\"https://gamedev.stackexchange.com/questions/114767/procedural-dungeon-generation-connect-rooms-with-passageways\">topic</a>, it's written in javascript, but it won't be hard to translate to c.</p>\n\n<p>In the example you fill the whole map of 0's and then you trace a path randomly, if you want to smooth the map later you can make a snippet that loops all the watter tiles and converts them to land if there are 3 or more land tiles adjacent to it, do it 40-60 times and you will get a smoother shore and no \"holes\" in the continent.</p>\n\n<p>EDIT\nUpdating the answer with a demo in C.\nI've not tested it, but if you include the headers and checks the code, this is the answer.</p>\n\n<pre><code>//Create and populate the map\nint mapsize = 100;\nint map[mapsize*mapsize];\n\nfor(int t = 0; t &lt; mapsize*mapsize; t++) map[t] = 0;\n\n//make the path\nint currPos[2] = {0,50};\nmap[currPos[0]+(currPos[1]*mapSize)] = 1;\nint landTiles = 20000;\n\nfor(var l = 0; l &lt; landTiles; l++){\n    int dir[2] = {RANDOM_BETWEEN_-1_AND_1, RANDOM_BETWEEN_-1_AND_1};\n    int next[2] = {currPos[0]+dir[0], currPos[1]+dir[1]};\n\n    map[next[0]+(next[1]*mapSize)] = 1;\n    currPos = next;\n}\n\n//Draw the map\nfor(var row = 0; row &lt; mapSize; row++){\n    for(var col = 0; col &lt; mapSize; col++){\n        cout &lt;&lt; map[col+(row*mapSize)];\n    }\n    cout &lt;&lt; endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3706886, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001892535248/picture?type=large", "display_name": "user3706886", "link": "https://stackoverflow.com/users/3706886/user3706886"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2102, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1452749390, "creation_date": 1452691864, "last_edit_date": 1452693651, "question_id": 34768039, "link": "https://stackoverflow.com/questions/34768039/how-to-create-a-world-map-using-c-language", "title": "How to create a world map using C language?", "body": "<p>How to create a world map using C language?</p>\n\n<p>Here, I want to generate a 1000*1000 two dimensional array of world map. Within the array, the land part is marked with value 1 and the sea part is marked with value 0. Is there any simple way to create?</p>\n"}, {"tags": ["c", "arrays", "string", "segmentation-fault"], "comments": [{"owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "edited": false, "score": 0, "creation_date": 1452691441, "post_id": 34767797, "comment_id": 57280514, "body": "You should compile with some warning flags: <code>-W -Wall</code> by example. Then you&#39;ll see your errors."}, {"owner": {"reputation": 726, "user_id": 5699135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELexL.png?s=128&g=1", "display_name": "birdoftheday", "link": "https://stackoverflow.com/users/5699135/birdoftheday"}, "edited": false, "score": 0, "creation_date": 1452691572, "post_id": 34767797, "comment_id": 57280600, "body": "It looks like you&#39;re only holding one char for <code>option</code> and <code>nickname</code> whilst you&#39;re comparing them with multiple character strings. That might be the problem."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1452691917, "post_id": 34767797, "comment_id": 57280827, "body": "Compile with all warnings &amp; debug info (<code>gcc -Wall -Wextra -g</code>). <b>Use the debugger</b> (<code>gdb</code>) &amp; <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>. BTW <code>gets</code> is <i>obsolete</i> and should <i>never</i> be used. Use <code>fgets</code>, <code>getline</code>, <code>readline</code>"}], "answers": [{"tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 1, "last_activity_date": 1452691646, "last_edit_date": 1452691646, "creation_date": 1452691315, "answer_id": 34767843, "question_id": 34767797, "link": "https://stackoverflow.com/questions/34767797/segmentation-fault-while-operating-on-user-input-string/34767843#34767843", "title": "Segmentation fault while operating on user input string", "body": "<p>There is no memory allocated for the strings.</p>\n\n<p>You need someting like this:</p>\n\n<pre><code>char option[50];\nchar nickname[50];\n</code></pre>\n\n<p>and use <a href=\"http://www.cplusplus.com/reference/cstring/strcpy/\" rel=\"nofollow\"><code>strcpy()</code></a> here:</p>\n\n<pre><code>nickname = \"Anonymous\";\n</code></pre>\n\n<p>and check the string with <a href=\"http://www.cplusplus.com/reference/cstring/strlen/\" rel=\"nofollow\"><code>strlen()</code></a> for example.</p>\n\n<pre><code>if(!nickname){\n</code></pre>\n\n<p>It is also safer to use <a href=\"http://www.cplusplus.com/reference/cstdio/fgets/\" rel=\"nofollow\">fgets()</a> with a length parameter to prevent buffer overflow.</p>\n\n<pre><code>while (gets(option)) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "is_accepted": false, "score": 0, "last_activity_date": 1452691350, "creation_date": 1452691350, "answer_id": 34767858, "question_id": 34767797, "link": "https://stackoverflow.com/questions/34767797/segmentation-fault-while-operating-on-user-input-string/34767858#34767858", "title": "Segmentation fault while operating on user input string", "body": "<p><code>option</code> needs to be <code>char[???]</code></p>\n\n<p>Not sure about nickname but it also needs memory allocated and/or initialisation.  How do you set it? What value do you use?</p>\n\n<p>You'll also need to check for <code>strlen(nickname)&gt;0</code> rather than <code>!nickname</code> which will test for a null pointer, not an empty string.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1452691928, "last_edit_date": 1452691928, "creation_date": 1452691627, "answer_id": 34767959, "question_id": 34767797, "link": "https://stackoverflow.com/questions/34767797/segmentation-fault-while-operating-on-user-input-string/34767959#34767959", "title": "Segmentation fault while operating on user input string", "body": "<p>There are many issues with the code. Let's discuss them one by one.</p>\n\n<ul>\n<li><p>First of all, a <code>char</code> is not sufficient to hold a <em>string</em>, you need either</p>\n\n<ul>\n<li>an array</li>\n<li>a pointer with proper (dynamic) memory allocation.</li>\n</ul>\n\n<p>Using the first approach, you need to change</p>\n\n<pre><code>char option;\nchar nickname;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>#define SIZ 64\n\nchar option[SIZ] = {0};\nchar nicknamep[SIZ] = {0};\n</code></pre></li>\n<li><p>Then, instead of using <code>gets()</code>, you should be using <a href=\"http://linux.die.net/man/3/fgets\" rel=\"nofollow\"><code>fgets()</code></a> to avoid the possibility of buffer overflow. Something like</p>\n\n<pre><code>fgets(option, SIZ, stdin);\n</code></pre>\n\n<p>will do.</p></li>\n<li><p>That said, once <code>option</code>  becomes an array, you cannot <em>assign</em> to it. You need to use <a href=\"http://linux.die.net/man/3/strcpy\" rel=\"nofollow\"><code>strcpy()</code></a> to copy the content into the array. For example,</p>\n\n<pre><code>strcpy(nickname, \"Anonymous\");\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1079, "user_id": 4472848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bc7b33199a0a5e067e1a33265cf88d1?s=128&d=identicon&r=PG", "display_name": "Wouter Verhelst", "link": "https://stackoverflow.com/users/4472848/wouter-verhelst"}, "is_accepted": false, "score": 0, "last_activity_date": 1452692386, "creation_date": 1452692386, "answer_id": 34768208, "question_id": 34767797, "link": "https://stackoverflow.com/questions/34767797/segmentation-fault-while-operating-on-user-input-string/34768208#34768208", "title": "Segmentation fault while operating on user input string", "body": "<p>Never <em>ever</em> use <code>gets</code>; it cannot be used correctly. Instead, use <code>fgets</code>, with <code>stdin</code> as the third parameter.</p>\n\n<p>You will notice that <code>fgets</code> takes the length of the storage you want to assign as its second parameter. The lack of this parameter in the <code>gets</code> function is why it cannot be used correctly. You should pass it the value 1 in your case, and pass it the address of your <code>char</code> variable. <code>fgets</code> will then read one character into your variable.</p>\n\n<p>If you want to read more, you need to start by allocating more storage for the data you'll read. For instance, you could allocate space for 80 characters:</p>\n\n<pre><code>char string[80];\n</code></pre>\n\n<p>You can now use <code>fgets</code> with <code>string</code> as the first character, 80 as the second, and <code>stdin</code> as the third. <code>fgets</code> will then read up to 80 characters from <code>stdin</code>.</p>\n\n<p>If you don't want to store that number in two locations in your source code, you can use the <code>sizeof</code> operator instead, or use a macro to predefine the size of your buffer.</p>\n"}], "owner": {"reputation": 59, "user_id": 5143049, "user_type": "registered", "profile_image": "https://graph.facebook.com/814575121971894/picture?type=large", "display_name": "Zsolt B&#237;r&#243;", "link": "https://stackoverflow.com/users/5143049/zsolt-b%c3%adr%c3%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 34767959, "answer_count": 4, "score": 1, "last_activity_date": 1452692386, "creation_date": 1452691175, "last_edit_date": 1452692101, "question_id": 34767797, "link": "https://stackoverflow.com/questions/34767797/segmentation-fault-while-operating-on-user-input-string", "title": "Segmentation fault while operating on user input string", "body": "<p>Hi Im new to coding in C and I can't seem to find the problem which causes a segfault after the while loop starts.</p>\n\n<pre><code>int main() {\n    char option;\n    char nickname;\n\n    printf(\"Welcome to our chat program. Please select mode (Send,Nickname,Exit): \");\n\n    while (gets(option)) {\n\n        if(!strncmp(option, \"Exit\", 4)) {\n            break;\n        }\n\n        if(!strncmp(option, \"Nickname\", 8)){\n            set_nickname(nickname);\n        }\n\n        if(!strncmp(option, \"Send\", 4)){\n            if(!nickname){\n            nickname = \"Anonymous\";\n            printf(\"Your nickname was set to Anonymous!\");\n            }\n            send_message(nickname);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "floating-point", "division", "modulo"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691268, "post_id": 34767710, "comment_id": 57280391, "body": "Are you talking about C or C++? They are different languages."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691476, "post_id": 34767710, "comment_id": 57280534, "body": "@Olaf This is a C function I&#39;m asking about and is implemented the same in both languages. If you can explain it to me in C you&#39;ve explained it to me in C++. Alternatively if you can explain it to me in C++ you&#39;re explained it to me in C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691513, "post_id": 34767710, "comment_id": 57280563, "body": "You are not citing the C standard, but the C++ standard."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691650, "post_id": 34767710, "comment_id": 57280656, "body": "@Olaf It&#39;s the same as the C documentation: <a href=\"http://en.cppreference.com/w/c/numeric/math/remquo\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/numeric/math/remquo</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1452691939, "post_id": 34767710, "comment_id": 57280843, "body": "@JonathanMee Possibly related: <a href=\"http://stackoverflow.com/questions/11630321/why-does-c-output-negative-numbers-when-using-modulo\" title=\"why does c output negative numbers when using modulo\">stackoverflow.com/questions/11630321/&hellip;</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452692208, "post_id": 34767710, "comment_id": 57281014, "body": "It is not and clearly cannot be, because there is no <code>std::</code> in C. However, it is congruent. But note that cppreference is no authoritative ressource. As far as I understand, for <code>r = remquo(x, y, &amp;q)</code> it should be <code>x == q * y + r</code>. That is the same as for the remainder in general. It just seems <code>q</code> is somehow modulo <code>pow(2, n)</code> (I&#39;m not sure about that part in the spec). It might become more surprisingly with larger <code>x</code> and/or non-power of two values."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452694317, "post_id": 34767710, "comment_id": 57282523, "body": "@Olaf The spec cannot say that <code>*quot</code> receives the integral quotient because the integral quotient of two <code>float</code>s does not in general fit in an <code>int</code>. Instead, only the low bits of the integral quotient are provided. The spec is just saying that at least 3 of the least significant bits will be shown, in an unclear manner."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1452694458, "post_id": 34767710, "comment_id": 57282630, "body": "@PascalCuoq: I had not problems about the &quot;integral&quot; part, but the modulo. While understood what it does, the reason was not clear to me. A short footnote would have been very welcome. But maybe one has to know  IEC 60559 to understand this fully."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452694203, "post_id": 34768680, "comment_id": 57282440, "body": "Thanks for clarification about that &quot;congruent&quot; part. The standards (C and C++) really could have been more clear about that it is just to fit the value into an integer. I just wonder why they just use three bits, because an <code>int</code> has at least 15 magnitude bits."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452694750, "post_id": 34768680, "comment_id": 57282834, "body": "@Olaf The sort of people who would use <code>remquo</code> often only care about the last few bits of the integral quotient. Consider <code>remquo(\u2026, M_PI_2, \u2026)</code> (and that&#39;s a bit of a bad example because you might really be more interested in the remainder in the division by the real \u03c0, not the floating-point approximation of it, but bear with me): you might want to know if the integer quotient is even or odd, perhaps if it&#39;s congruent to 0, 1, 2 or 3 modulo 4, but not care so much about the higher-order bits."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452694869, "post_id": 34768680, "comment_id": 57282932, "body": "Thanks for explaining. I actually try to avoid floating point when possible (and until now, I was lucky in my C projects;-)"}], "tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": true, "score": 1, "last_activity_date": 1452694019, "last_edit_date": 1495539897, "creation_date": 1452693710, "answer_id": 34768680, "question_id": 34767710, "link": "https://stackoverflow.com/questions/34767710/remquo-results-not-making-sense/34768680#34768680", "title": "remquo Results Not Making Sense", "body": "<p>Since your question is about the value returned by <code>remquo</code>, it is entirely about <code>std::remainder</code>, since that part of <code>remquo</code>'s behavior is defined directly as identical to that of <code>std::remainder</code>.</p>\n\n<p><code>std::remainder</code> provides the IEEE 754 remainder operation, which is different from <code>fmod</code> in that the <code>fmod</code> of two positive values can be expected to be always positive, whereas the IEEE 754 remainder is defined with respect to the integral quotient <code>q</code> as the <strong>nearest</strong> integer to the mathematical quotient x/y, so that <code>remainder = x - y*q</code> produces a negative result each time the mathematical quotient rounds <strong>up</strong> to the next integer.</p>\n\n<p>The IEEE 754 remainder operation is the one being discussed in the <a href=\"https://stackoverflow.com/questions/158120/math-ieeeremainder-returns-negative-results-why\">question \u201cMath.IEEERemainder returns negative results.\u201d</a> so you might want to read it and the accepted answer although they are about a different programming language.</p>\n\n<p>Note: the part of the specification about the quotient being \u201ccongruent modulo 2<sup>n</sup> to the magnitude of the integral quotient\u201d simply means that you do not get the entire integral quotient, which indeed might not fit an <code>int</code> type (think of <code>remquo(FLT_MAX, 1.0f, ...)</code>. Instead, you get an implementation-defined number of the least significant bits of the integral quotient. The implementation-defined number of bits that you get must be at least three, but can be more.</p>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 5783981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZkO3o.jpg?s=128&g=1", "display_name": "Luca Pizzamiglio", "link": "https://stackoverflow.com/users/5783981/luca-pizzamiglio"}, "is_accepted": false, "score": 1, "last_activity_date": 1452693962, "creation_date": 1452693962, "answer_id": 34768762, "question_id": 34767710, "link": "https://stackoverflow.com/questions/34767710/remquo-results-not-making-sense/34768762#34768762", "title": "remquo Results Not Making Sense", "body": "<p>The behavior is correct; as stated in std::remainder, the quotient is rounded to nearest integer, then the remainder could be negative.</p>\n\n<p>If you are working with integer, I suggest you the C function div()</p>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 34768680, "answer_count": 2, "score": 0, "last_activity_date": 1452694019, "creation_date": 1452690941, "question_id": 34767710, "link": "https://stackoverflow.com/questions/34767710/remquo-results-not-making-sense", "title": "remquo Results Not Making Sense", "body": "<p>I read <a href=\"http://en.cppreference.com/w/cpp/numeric/math/remquo\" rel=\"nofollow\">here</a> that <code>remquo</code> should return:</p>\n\n<blockquote>\n  <p>If successful, returns the floating-point remainder of the division <code>x/y</code> as defined in std::remainder, and a value whose sign is the sign of <code>x/y</code> and whose magnitude is congruent <em>modulo 2<sup>n</sup></em>\n   to the magnitude of the integral quotient of <code>x/y</code>, where <em>n</em> is an implementation-defined integer greater than or equal to <em>3</em>.</p>\n</blockquote>\n\n<p>Now clearly I've misunderstood all that techno-speak cause I thought that I was going to get back the fractional result of the division. Instead this operation:</p>\n\n<pre><code>int quot;\nconst float rem = remquo(7.0F, 4.0F, &amp;quot);\n</code></pre>\n\n<p>Sets <code>quot</code> to <em>2</em> and <code>rem</code> to <em>-1.0</em>! I can see how that is valid because <em>4.0 * 2 = 8.0</em> and <em>7.0 - 8.0 = -1.0</em>. But why are we using a <code>quot</code> that will result in a negative <code>rem</code>? Shouldn't I be getting back a <code>quot</code> of <em>1</em> and a <code>rem</code> of <em>3.0</em>?</p>\n"}, {"tags": ["c", "pointers", "memory-management", "malloc"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452691076, "post_id": 34767665, "comment_id": 57280266, "body": "<code>size_t</code> is not necessarily <code>unsigned int</code>. Do not rely on it. E.g. on systems with 16 bit <code>int</code>, but 32 pointers, it is likely <code>unsigned long</code>. On x64 it is likely either <code>unsigned long long</code> (Windows, LLP64) or <code>unsigned long</code> (POSIX64, LP64)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691137, "post_id": 34767665, "comment_id": 57280302, "body": "You actually answered your question already. Read again and see where you think wrong. Remember C does not hinder you (much) to shoot your foot."}, {"owner": {"reputation": 165, "user_id": 5231956, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/485ec02e65487d6f4e1bce60a674bef2?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/5231956/lincoln"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691160, "post_id": 34767665, "comment_id": 57280317, "body": "i m more concerned for second half of question"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1452691166, "post_id": 34767665, "comment_id": 57280320, "body": "When would you expect an error?"}, {"owner": {"reputation": 165, "user_id": 5231956, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/485ec02e65487d6f4e1bce60a674bef2?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/5231956/lincoln"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452691246, "post_id": 34767665, "comment_id": 57280372, "body": "@Olaf i don&#39;t get it. I&#39;ve tried this with float values but there is no loss of data"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1452691313, "post_id": 34767665, "comment_id": 57280420, "body": "So you expect the compiler to see the connection between the cast or the type of the pointer and the insufficient storage?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1452691926, "post_id": 34767665, "comment_id": 57280834, "body": "Some static analysers such as <a href=\"http://clang-analyzer.llvm.org/available_checks.html\" rel=\"nofollow noreferrer\">Clang&#39;s</a> can perhaps detect this type of bug.  At the end of the linked document is an example where <code>long *p = malloc(sizeof(short))</code> is detected, which yould help you in your case."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452692400, "post_id": 34767665, "comment_id": 57281155, "body": "Think about the implications of the word <b>undefined</b>. Like in <i>undefined behaviour</i>. Remember that phrase, you will eventually encounter it a lot."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452691418, "post_id": 34767798, "comment_id": 57280496, "body": "<i>&quot;the size of the pointer is the same whether it points to a short or a float&quot;</i> Not necessarily. They are allowed to have different internal representations. Here the <code>void*</code> is <i>converted</i> to <code>float*</code>."}, {"owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452691623, "post_id": 34767798, "comment_id": 57280641, "body": "@user694733 pointers themselves are memory addresses, so they have the same size on the same machine regardless of what they point to. The explicit cast can be -and in my opinion should be- dropped."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452691931, "post_id": 34767798, "comment_id": 57280837, "body": "Explicit casting should be dropped, because C does <i>implicit casting</i> when <code>void*</code> is assigned to other pointer type. Many modern systems use same presenstation for all pointers types, but it is not required by the C standard: There may still be implicit conversion."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1452692106, "post_id": 34767798, "comment_id": 57280943, "body": "N1570 6.2.5 p28: <i>&quot;A pointer to void shall have the same representation and alignment requirements as a pointer to a character type. 48) Similarly, pointers to qualified or unqualified versions of compatible types shall have the same representation and alignment requirements. All pointers to structure types shall have the same representation and alignment requirements as each other. All pointers to union types shall have the same representation and alignment requirements as each other. <b>Pointers to other types need not have the same representation or alignment requirements.</b>&quot;</i>"}, {"owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452692562, "post_id": 34767798, "comment_id": 57281277, "body": "I see your point, I never said that they have the same representation, i said they have the same size, i really like that you pointed that out, and i respect your tenacity"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452692743, "post_id": 34767798, "comment_id": 57281389, "body": "My point is that <b>representation includes the size too</b>. That is what I am trying to correct: Not all pointers are necessarily the same size!"}, {"owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452693132, "post_id": 34767798, "comment_id": 57281660, "body": "I&#39;m mind blown, I have been programming using c for 5 years -on different platforms- and I have never encountered a case where 2 pointers had different sizes on the same machine, but apparently the standard doesn&#39;t require it. Thank you for teaching me something new."}], "tags": [], "owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "is_accepted": false, "score": 1, "last_activity_date": 1452693256, "last_edit_date": 1452693256, "creation_date": 1452691175, "answer_id": 34767798, "question_id": 34767665, "link": "https://stackoverflow.com/questions/34767665/compatibility-of-data-size-while-using-malloc/34767798#34767798", "title": "Compatibility of data size while using malloc()", "body": "<p>This can be problematic if you try to use that pointer -actually the pointer is fine, it's the allocated memory it points to that's too small-, the reason the compiler doesn't recognize it as an error is the fact that the pointer isn't \"aware\" of what it points to , actually pointers are variables that contain memory addresses, so basically they're just a number, and in most cases ( as user694733 pointed out) the size of the pointer is the same whether it points to a short or a float.\nwhat the compiler sees is a cast from (void*) to (float*) and to the compiler it's a totally valid cast.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1452691183, "creation_date": 1452691183, "answer_id": 34767799, "question_id": 34767665, "link": "https://stackoverflow.com/questions/34767665/compatibility-of-data-size-while-using-malloc/34767799#34767799", "title": "Compatibility of data size while using malloc()", "body": "<p>In the example you give, if you only allocate 2 bytes for a <code>float *</code> and then attempt to write to that location by dereferencing the pointer, you'll be writing to memory that hasn't been allocated.  This results in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.  That means it might work, it might core dump, or it might behave in unpredictable ways.</p>\n\n<p>If you want to allocate memory for one or more floats, you would do it like this:</p>\n\n<pre><code>// allocates space for an array of 5 floats\n// don't cast the result of malloc\nint arrayLen = 5;\nfloat *f = malloc(sizeof(float) * arrayLen);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "is_accepted": false, "score": 0, "last_activity_date": 1452691299, "creation_date": 1452691299, "answer_id": 34767835, "question_id": 34767665, "link": "https://stackoverflow.com/questions/34767665/compatibility-of-data-size-while-using-malloc/34767835#34767835", "title": "Compatibility of data size while using malloc()", "body": "<p>Your question has actually nothing to do with the malloc, but rather to the data casting. In this case you have casted the bytes located starting from the address returned by malloc to float. Thus, if you later say <code>*p = 0.0f;</code> you will actually write 4 bytes to the mentioned memory area, but only 2 bytes are ligal to you to use since you have allocated only 2 bytes. Therefore, your code will compile and run with memory corruption (this either will result in crash, or in an unexpected runtime behavior later)</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1452692209, "creation_date": 1452692209, "answer_id": 34768155, "question_id": 34767665, "link": "https://stackoverflow.com/questions/34767665/compatibility-of-data-size-while-using-malloc/34768155#34768155", "title": "Compatibility of data size while using malloc()", "body": "<p>You're encountering an implementation-specific result of the requirements of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">C Standard</a>:</p>\n\n<blockquote>\n  <p><strong>7.22.3 Memory management functions</strong></p>\n  \n  <p>The order and contiguity of storage allocated by successive calls to\n  the <code>aligned_alloc</code> , <code>calloc</code> , <code>malloc</code> ,  and <code>realloc</code> functions\n  is unspecified.   <strong>The pointer returned if the allocation succeeds is\n  suitably aligned so that it may be assigned to a pointer to any type\n  of object with a fundamental alignment requirement</strong> and then used to\n  access such an object or an array of such objects in the space\n  allocated (until the space is explicitly deallocated).</p>\n</blockquote>\n\n<p>In order to provide storage \"suitably aligned so that it may be assigned to a pointer to any type of object with a fundamental alignment requirement\", an implementation has to return memory from <code>malloc()</code> <em>et al</em> at specific offsets that are multiples of the most restrictive alignment requirement for the system.  That's usually something like 8 or 16 bytes.</p>\n\n<p>Given that each and every block returned has to be aligned that way, most implementations internally create blocks of memory in multiples of the alignment requirement.</p>\n\n<p>So if your system has an 8-byte alignment requirement, your <code>malloc()</code> implementation is likely to actually give you an 8-byte block of memory even though you requested two bytes.  Likewise, ask for 19 bytes and you'll likely get something like 24 in reality.</p>\n\n<p>It's still undefined behavior to go beyond what you asked for, though.  And undefined behavior does unfortunately include \"works just fine\".</p>\n"}], "owner": {"reputation": 165, "user_id": 5231956, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/485ec02e65487d6f4e1bce60a674bef2?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/5231956/lincoln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 34767799, "answer_count": 4, "score": -1, "last_activity_date": 1452693256, "creation_date": 1452690776, "last_edit_date": 1452691413, "question_id": 34767665, "link": "https://stackoverflow.com/questions/34767665/compatibility-of-data-size-while-using-malloc", "title": "Compatibility of data size while using malloc()", "body": "<p>I recently studied about  <b>malloc()</b> in C with declaration as follows:</p>\n\n<pre><code>void *malloc(size_t size)\n</code></pre>\n\n<p>where <code>size_t</code> is unsigned int and <code>size</code> defines the no. of bytes to be reserved. \nQuestion is that on my system <i>float</i> values occupy 4bytes of memory. So if i make memory pointer(of float type) using malloc of 2bytes, </p>\n\n<pre><code>float *p;  \np = (float *)malloc(2);\n</code></pre>\n\n<p>then how come it does not give any error? Because what i think is that float data required 4 bytes so if i issue only 2 bytes to it then it may lead to some data loss.</p>\n\n<p>or is it that i m understanding malloc() incorrrectly? </p>\n"}, {"tags": ["c", "mongodb", "bson", "mongo-c-driver"], "answers": [{"tags": [], "owner": {"reputation": 1711, "user_id": 3093018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/891cb1871d92c0260b98bd5c7ddd1cd4?s=128&d=identicon&r=PG&f=1", "display_name": "bauman.space", "link": "https://stackoverflow.com/users/3093018/bauman-space"}, "is_accepted": true, "score": 2, "last_activity_date": 1454464483, "last_edit_date": 1454464483, "creation_date": 1454449617, "answer_id": 35164390, "question_id": 34767605, "link": "https://stackoverflow.com/questions/34767605/does-order-matter-in-bson-iter-find-in-mongo-c-driver/35164390#35164390", "title": "Does order matter in bson_iter_find in mongo c driver", "body": "<p>to directly answer your question, you should call bson_iter_init (<a href=\"http://api.mongodb.org/libbson/current/bson_iter_init.html\" rel=\"nofollow\">http://api.mongodb.org/libbson/current/bson_iter_init.html</a>) for every single \"new\" query you're making against the data.   </p>\n\n<p>Presumably you have a single bson_iter_init call on a bson_t object. You just need another.</p>\n\n<pre><code>   bson_iter_t iterator1;\n   bson_iter_t iterator2;\n\n   if (bson_iter_init (&amp;iterator1, doc) &amp;&amp;\n       bson_iter_find (&amp;iterator1, \"fieldA\") ) {\n       //Do something with fieldA\n    }\n\n   if (bson_iter_init (&amp;iterator2, doc) &amp;&amp;\n       bson_iter_find (&amp;iterator2, \"fieldB\") ) {\n       //Do something with fieldB\n    }\n    bson_free(doc); //DONT FORGET TO DESTROY THE BSON_T object at the end.\n</code></pre>\n\n<p>or, just use the combined command bson_iter_init_find (<a href=\"http://api.mongodb.org/libbson/current/bson_iter_init_find.html\" rel=\"nofollow\">http://api.mongodb.org/libbson/current/bson_iter_init_find.html</a>) if you don't want to deal with the internals.</p>\n\n<pre><code>   bson_iter_t iterator1;\n   bson_iter_t iterator2;\n\n   if (bson_iter_init_find (&amp;iterator1, doc, \"fieldA\") ) {\n       //Do something with fieldA\n    }\n\n   if (bson_iter_init_find (&amp;iterator2, doc,\"fieldB\") ) {\n       //Do something with fieldB\n    }\n    bson_free(doc); //DONT FORGET TO DESTROY THE BSON_T object at the end.\n</code></pre>\n\n<p>If you're interested in why, I work on the bsonsearch (<a href=\"https://github.com/bauman/bsonsearch\" rel=\"nofollow\">https://github.com/bauman/bsonsearch</a>) library and have similar problems.</p>\n\n<p>Be very cautious on how you're dealing with pointers.  Nearly everything under the hood in libbson is manipulating pointers to an area in memory.</p>\n\n<p>The reason ordering maters is because you initialized once, when you called iter_find, libbson would <strong>seek past B to locate A</strong>.  The subsequent call to find B would seek to the end of the buffer and miss it.  You avoid that problem by reinitializing the iterator back to position 0 and start the seek from there.</p>\n\n<p>Unless you know exactly what you're doing and want to optimize seeks around the buffer, it's probably best to just reinitialize the iterator for every find.  </p>\n"}], "owner": {"reputation": 288, "user_id": 4030580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9180b9eb22269ef014d6563e68035344?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Shahid", "link": "https://stackoverflow.com/users/4030580/ahmed-shahid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 1, "accepted_answer_id": 35164390, "answer_count": 1, "score": 2, "last_activity_date": 1454464483, "creation_date": 1452690591, "question_id": 34767605, "link": "https://stackoverflow.com/questions/34767605/does-order-matter-in-bson-iter-find-in-mongo-c-driver", "title": "Does order matter in bson_iter_find in mongo c driver", "body": "<p>I am using mongo c driver 1.1 with mongo version 3.0. Libbson version 1.1. \nI am using an iterator to look for certain fields in a document. The following code only works when \"fieldA\" is above \"fieldB\" in mongodb. If i change the order bson_iter_find returns false. </p>\n\n<pre><code>if(bson_iter_find(&amp;iterator,\"fieldA\")){\n    pintf(\"fieldA\");\n}\nif(bson_iter_find(&amp;iterator,\"fieldB\")){\n    pintf(\"fieldB\");\n}\n</code></pre>\n\n<p>In older versions of the libbson(0.4) I was able to use bson_find(), to look for fields in a doc. Is there something similar i can use in the new libbson library?</p>\n\n<p>Link to new libbson library\n<a href=\"https://api.mongodb.org/libbson/current/\" rel=\"nofollow\">https://api.mongodb.org/libbson/current/</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1258, "user_id": 815227, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/qMjpi.png?s=128&g=1", "display_name": "kazbeel", "link": "https://stackoverflow.com/users/815227/kazbeel"}, "edited": false, "score": 0, "creation_date": 1452690304, "post_id": 34767434, "comment_id": 57279757, "body": "Take a look at this as a first step: <a href=\"http://www.cplusplus.com/reference/cstdlib/atol/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdlib/atol</a>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1452690392, "post_id": 34767434, "comment_id": 57279820, "body": "How would you do on paper? btw use <code>scanf(&quot;%s&quot;, input)</code>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1452690393, "post_id": 34767434, "comment_id": 57279821, "body": "You should start checking if inserted char is <code>&gt;=&#39;0&#39;</code> (0x30) and <code>&lt;=&#39;9&#39;</code> (0x39)"}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452690440, "post_id": 34767434, "comment_id": 57279855, "body": "sorry I edited it now, I am not allowed to use any library functions"}, {"owner": {"reputation": 786, "user_id": 5022365, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec8cb396d26f840b7b772382d8e3ff70?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar Patel", "link": "https://stackoverflow.com/users/5022365/sagar-patel"}, "edited": false, "score": 0, "creation_date": 1452691574, "post_id": 34767434, "comment_id": 57280602, "body": "what you mean by String will be converted to an integer? Means you want like this: (input-Death and output will be 68 101 97 116 104).?"}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691837, "post_id": 34767434, "comment_id": 57280771, "body": "sorry for the misunderstanding, I meant like: the user types in 2A8B Then it checks if there are only numbers, and of course 2A8B is not a real number. So the user has to write 28 as example. after he wrote it, the program converts the string &quot;28&quot; into an full integer 28."}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1452690465, "post_id": 34767539, "comment_id": 57279866, "body": "<code>scanf(&quot;%c, &amp;input&quot;);</code> --&gt; <code>scanf(&quot;%c&quot;, &amp;input);</code> and in your case should be <code>scanf(&quot;%s&quot;, &amp;input);</code>"}, {"owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "edited": false, "score": 1, "creation_date": 1452690525, "post_id": 34767539, "comment_id": 57279907, "body": "its <code>scanf(&quot;%s&quot;,input);</code> Input a string not a character"}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691611, "post_id": 34767539, "comment_id": 57280632, "body": "I tried it but it crashed"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1452691921, "post_id": 34767539, "comment_id": 57280831, "body": "<code>input[i] - &#39;0&#39;</code> will work on <i>any</i> compliant implementation (see my answer for standard quotation). The same is not true for letters, though."}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452692103, "post_id": 34767539, "comment_id": 57280939, "body": "well this time it didn&#39;t crash but how do I make an output for this one? I appreciate your help, thanks"}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452692476, "post_id": 34767539, "comment_id": 57281211, "body": "Oh thanks a lot! It worked!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452699204, "post_id": 34767539, "comment_id": 57286131, "body": "Fails for negative numbers."}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 2, "last_activity_date": 1452700453, "last_edit_date": 1452700453, "creation_date": 1452690384, "answer_id": 34767539, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767539#34767539", "title": "Convert String to Integer without library function in C", "body": "<p>Take hightes digit and add it to number, multiply the number by 10 and add the next digit. And so on:</p>\n\n<pre><code>#include &lt;stdio.h&gt; // scanf, printf\n\nvoid main()\n{\n    char input[100];\n    printf(\"Type a String which will be converted to an Integer: \");\n    scanf(\"%s\", input);\n\n    int number = 0;\n    int neg = input[0] == '-';\n    int i = neg ? 1 : 0;\n    while ( input[i] &gt;= '0' &amp;&amp; input[i] &lt;= '9' )\n    {\n      number *= 10;             // multiply number by 10\n      number += input[i] - '0'; // convet ASCII '0'..'9' to digit 0..9 and add it to number           \n      i ++;                     // step one digit forward\n    }\n    if ( neg )\n       number *= -1;\n\n    printf( \"string %s -&gt; number %d\", input, number );\n}\n</code></pre>\n\n<p><code>input[i] - '0'</code> works, because ASCII characters '0'..'9' have ascending ASCII codes from 48 to 57.</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691549, "post_id": 34767569, "comment_id": 57280585, "body": "I am sorry but I am not allowed to use library functions like string.h"}, {"owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691796, "post_id": 34767569, "comment_id": 57280736, "body": "How big of a deal is it to calculate the length of that string?"}], "tags": [], "owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "is_accepted": false, "score": 0, "last_activity_date": 1452691090, "last_edit_date": 1452691090, "creation_date": 1452690479, "answer_id": 34767569, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767569#34767569", "title": "Convert String to Integer without library function in C", "body": "<p>Lot of things which are missed. Firstly taking a string in is done by <code>scanf(\"%s\",input);</code> By the way in which you are receiving it, it only stores a character, secondly run the loop till the length of the string recieved. Check the below code. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid main()\n{\n    char input[100];\n    int i;\n    int sum = 0;\n    printf(\"Type a String which will be converted to an Integer: \");\n    scanf(\"%s\", input);\n\n    for (i = 0; i &lt; strlen(input); i++)\n    {\n        if(input[i]&gt;=48 &amp;&amp; input[i]&lt;=57)\n        {\n             //do something, it is a digit\n             printf(\"%d\",input[i]-48);\n             //48 is ascii value of 0\n    }\n}  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": false, "score": 0, "last_activity_date": 1452690541, "creation_date": 1452690541, "answer_id": 34767587, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767587#34767587", "title": "Convert String to Integer without library function in C", "body": "<p>So basically you want to know how something like the standard library <code>atoi</code> works. In order to do this, you need to consider how strings represent numbers.</p>\n\n<p>Basically, a string (that represents a number) is a list o digits from 0 to 9. The string abcd (where a, b, c, d are placeholders for any digit) represents the number a*10 ^ 3 + b*10^2 + c * 10 + d (considering base 10 here, similar for other bases). So basically you need to decompose the string as shown above and perform the required arhitmetic operations:</p>\n\n<pre><code>// s - the string to convert\nint result = 0;\nfor (int index = 0; index &lt; strlen(s); index++) {\n    result = result * 10 + s[index] - '0';\n}\n</code></pre>\n\n<p>The operation <code>s[index] - '0'</code> converts the character that represent a digit to its value. </p>\n"}, {"tags": [], "owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1452690859, "creation_date": 1452690859, "answer_id": 34767690, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767690#34767690", "title": "Convert String to Integer without library function in C", "body": "<pre><code>//  the function returns true for success , and false for failure\n// the result is stored in result parameter\n// nb: overflow not handled\n\nint charToInt(char *buff,int *result){\n    *result=0;\n    char c;\n    while(c=*buff++){\n        if((c &lt; '0') || (c &gt;'9')) // accept only digits;\n            return 0;\n        *result *= 10;\n        *result += c-'0';\n    }\n    return 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691330, "post_id": 34767704, "comment_id": 57280434, "body": "Don&#39;t I need an output for this? It crashed."}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691514, "post_id": 34767704, "comment_id": 57280566, "body": "@Death Toxic which compiler use?"}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691597, "post_id": 34767704, "comment_id": 57280619, "body": "It is successfully run in GCC compiler."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1452692143, "post_id": 34767704, "comment_id": 57280973, "body": "Cummulative -1 for: 1) using <code>scanf()</code> on user input; 2) not checking <code>scanf()</code> return code, and 3) assuming ASCII."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": -1, "last_activity_date": 1452690924, "creation_date": 1452690924, "answer_id": 34767704, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767704#34767704", "title": "Convert String to Integer without library function in C", "body": "<p>Try it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main()\n{\n  char input[100];\n  int i,j;\n  int val = 0;\n  printf(\"Type a String which will be converted to an Integer: \");\n  scanf(\"%s\",input);\n\n    for(j=0; input[j] != '\\0'; j++); // find string size\n    for (i = 0; i &lt; j; i++)\n    {\n        val = val * 10 + input[i] - 48;\n    }   \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452691514, "post_id": 34767716, "comment_id": 57280564, "body": "and this works without library function? well I am gonna try it later, thanks"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452692640, "post_id": 34767716, "comment_id": 57281321, "body": "@DeathToxic: Well, what happened to you trying it? The accepted answer does not fit your requirements (program with no library functions). None of the other answers do. This one does."}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452693075, "post_id": 34767716, "comment_id": 57281613, "body": "If I try to run it it doesn&#39;t show anything, it&#39;s just an empty console"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452693151, "post_id": 34767716, "comment_id": 57281673, "body": "@DeathToxic: But you do know what a return code is? If you don&#39;t, please read the answer again. There is no way to print to the console without using library functions. (Unless I&#39;d start hacking the hardware addresses or use the BIOS in text mode. :-D )"}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452693326, "post_id": 34767716, "comment_id": 57281811, "body": "oh okay well I was told that the only one I could use would be the &lt;stdio.h&gt; function since I heard there are some header informations, that&#39;s why I accepted the other one, but so basically this one would be comepletely without header function?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452693351, "post_id": 34767716, "comment_id": 57281835, "body": "@DeathToxic: Indeed. And if you&#39;re allowed to use <code>&lt;stdio.h&gt;</code> (why didn&#39;t you tell us?), <code>scanf( &quot;%d&quot;, &amp;number )</code> would be <i>much</i> easier. Tell your instructor hi from me, and his assignments could use some thinking through. ;-)"}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452693533, "post_id": 34767716, "comment_id": 57281966, "body": "good to know, I always wondered how it would look like without header informations, I am just not sure what the argv does"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452693736, "post_id": 34767716, "comment_id": 57282104, "body": "@DeathToxic: Oh, gosh... you haven&#39;t been told? You can define <code>int main()</code> and not take any arguments from the command line. Or you define <code>int main( int argc, char * argv[] )</code>, and get the <i>number</i> of command-line arguments in <code>argc</code>, and (if <code>argc</code> is not zero for some reason) a list of the argument strings in <code>argv</code> (the first being the name of the program itself, which might be empty). The value of <code>argv[argc]</code> is always a null pointer. The name of the variables doesn&#39;t actually matter, but it is canonical to call them <code>argc</code> and <code>argv</code>."}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452694307, "post_id": 34767716, "comment_id": 57282516, "body": "actually all my teachers do are just telling me to go look in the internet. bad school here, well. But thanks got a better picture of that now."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452694415, "post_id": 34767716, "comment_id": 57282602, "body": "@DeathToxic: I strongly suggest getting <a href=\"http://stackoverflow.com/questions/562303\">a good C book</a>. About 90% of the code you will see &quot;on the internet&quot; displays pretty dismal coding style, and usually next to no (or, worse, downright wrong) explanations."}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1452694815, "post_id": 34767716, "comment_id": 57282893, "body": "yeah I thought this too, but I almost don&#39;t have time for this. Like I had to learn php, I saw php for first time, all they told me was that you define a variable with the $ symbol and then I had 10 hours time in the lession to create a whole blog site... I only use this site here if I really can&#39;t go further anymore"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452699650, "post_id": 34767716, "comment_id": 57286537, "body": "It is in C11. &#167;5.2.1 3"}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 3, "last_activity_date": 1452692319, "last_edit_date": 1452692319, "creation_date": 1452690972, "answer_id": 34767716, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767716#34767716", "title": "Convert String to Integer without library function in C", "body": "<p>The conversion is the easy part...</p>\n\n<p>But if you must not use library functions,</p>\n\n<ul>\n<li>there is only one way to <em>take</em> a string, and that is <code>argv</code>;</li>\n<li>there is only one way to <em>give</em> an integer, and that is the exit code of the program.</li>\n</ul>\n\n<p>So, without much ado:</p>\n\n<pre><code>int main( int argc, char * argv[] )\n{\n    int rc = 0;\n    if ( argc == 2 ) // one, and only one parameter given\n    {\n        unsigned i = 0;\n        // C guarantees that '0'-'9' have consecutive values\n        while ( argv[1][i] &gt;= '0' &amp;&amp; argv[1][i] &lt;= '9' )\n        {\n            rc *= 10;\n            rc += argv[1][i] - '0';\n            ++i;\n        }\n    }\n    return rc;\n}\n</code></pre>\n\n<p>I did not implement checking for <code>'+'</code> or <code>'-'</code>, and did not come up with a way to signal \"input is not a number\". I also just stop parsing at the first non-digit. All this could probably be improved upon, but this should give you an idea of how to work around the \"no library functions\" restriction.</p>\n\n<p>(Since this sounds like a homework, you <em>should</em> have to write some code of your own. I already gave you three <em>big</em> spoons of helping regarding <code>argv</code>, the <code>'0'-'9'</code>, and the conversion itself.)</p>\n\n<hr>\n\n<p>Call as:</p>\n\n<pre><code>&lt;program name&gt; &lt;value&gt;\n</code></pre>\n\n<p>(E.g. <code>./myprogram 28</code>)</p>\n\n<p>Check return code with (for Linux shell):</p>\n\n<pre><code>echo $?\n</code></pre>\n\n<p>On Windows it's something about <code>echo %ERRORLEVEL%</code> or somesuch... perhaps a helpful Windows user will drop a comment about this.</p>\n\n<hr>\n\n<p>Source for the \"<code>'0'-'9'</code> consecutive\" claim: ISO/IEC 9899:1999 5.2.1 Character sets, paragraph 3:</p>\n\n<blockquote>\n  <p>In both the source and execution basic character sets, the value of each character after <code>0</code> in the above list of decimal digits shall be one greater than the value of the previous.</p>\n</blockquote>\n\n<p>I'm sure this is preserved in C11, but I only have the older C99 paper available.</p>\n"}, {"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1452691115, "post_id": 34767727, "comment_id": 57280287, "body": "Actually, C guarantees that the integer values of <code>&#39;0&#39;</code> through <code>&#39;9&#39;</code> are consecutive."}, {"owner": {"reputation": 1079, "user_id": 4472848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bc7b33199a0a5e067e1a33265cf88d1?s=128&d=identicon&r=PG", "display_name": "Wouter Verhelst", "link": "https://stackoverflow.com/users/4472848/wouter-verhelst"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1452691297, "post_id": 34767727, "comment_id": 57280407, "body": "@DevSolar -- do you have a source on that?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452699529, "post_id": 34767727, "comment_id": 57286417, "body": "&quot;... In both the source and execution basic character sets, the value of each character after 0 in the above list of decimal digits shall be one greater than the value of the previous. ...&quot;   C11 &#167;5.2.1 3"}], "tags": [], "owner": {"reputation": 1079, "user_id": 4472848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bc7b33199a0a5e067e1a33265cf88d1?s=128&d=identicon&r=PG", "display_name": "Wouter Verhelst", "link": "https://stackoverflow.com/users/4472848/wouter-verhelst"}, "is_accepted": false, "score": -1, "last_activity_date": 1452691009, "creation_date": 1452691009, "answer_id": 34767727, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c/34767727#34767727", "title": "Convert String to Integer without library function in C", "body": "<p>If you want your code to be portable to systems that don't use ASCII, you'll have to loop over your <code>char</code> array and compare each individual character in the source against each possible number character, like so:</p>\n\n<pre><code>int digit;\nswitch(arr[i]) {\n    case '0':\n        digit=0; break;\n    case '1':\n        digit=1; break;\n    // etc\n    default:\n        // error handling\n}\n</code></pre>\n\n<p>Then, add the digit to your result variable (after multiplying it by 10).</p>\n\n<p>If you can assume ASCII, you can replace the whole switch statement by this:</p>\n\n<pre><code>if(isdigit(arr[i])) {\n    digit=arr[i] - '0';\n} else {\n    // error handling\n}\n</code></pre>\n\n<p>This works because in the ASCII table, all digits are found in a single range, in ascending order. By subtracting the ordinal value of the zero character, you get the value of that digit. By adding the <code>isdigit()</code> macro, you additionally ensure that only digit characters are converted in this manner.</p>\n"}], "owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6558, "favorite_count": 0, "closed_date": 1452699754, "accepted_answer_id": 34767539, "answer_count": 7, "score": 0, "last_activity_date": 1452700453, "creation_date": 1452690029, "last_edit_date": 1452690407, "question_id": 34767434, "link": "https://stackoverflow.com/questions/34767434/convert-string-to-integer-without-library-function-in-c", "closed_reason": "Needs more focus", "title": "Convert String to Integer without library function in C", "body": "<p>I have to write a program that converts an user input (which is a string) to an Integer. In the same time it should check, if the user input really is a number.\nAnd also everything in one method.</p>\n\n<p>and NO LIBRARY FUNCTIONS allowed.</p>\n\n<p>I can't figure any idea how to do it. All I got for the beginning is just this pathetic structure</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main()\n{\n  char input[100];\n  int i;\n  int sum = 0;\n  printf(\"Type a String which will be converted to an Integer: \");\n  scanf(\"%c, &amp;input\");\n\n  for (i = 0; i &lt; 100; i++)\n   {\n\n   }\n}\n</code></pre>\n\n<p>I appreciate any help, thanks</p>\n"}, {"tags": ["c", "linux", "networking"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1452689934, "post_id": 34767366, "comment_id": 57279507, "body": "What language is this?  If this is C or C++ you should use the correct syntax."}, {"owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1452689995, "post_id": 34767366, "comment_id": 57279549, "body": "It is C code used to get address of  a host in network"}, {"owner": {"reputation": 12594, "user_id": 2491746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4432131c9d27a81503f25956bc8b9c?s=128&d=identicon&r=PG", "display_name": "Simple", "link": "https://stackoverflow.com/users/2491746/simple"}, "edited": false, "score": 1, "creation_date": 1452690096, "post_id": 34767366, "comment_id": 57279603, "body": "This isn&#39;t legal code. Show us the correct code."}, {"owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "edited": false, "score": 0, "creation_date": 1452691230, "post_id": 34767366, "comment_id": 57280361, "body": "This is part of a working project. I think to illustrate my question about initializing constant struct object with a static array this code portion  will suffice."}, {"owner": {"reputation": 548, "user_id": 2229835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXQjN.jpg?s=128&g=1", "display_name": "Kellerspeicher", "link": "https://stackoverflow.com/users/2229835/kellerspeicher"}, "edited": false, "score": 0, "creation_date": 1452691834, "post_id": 34767366, "comment_id": 57280770, "body": "If you want to discus details of a language you should provide syntactic correct code. Even if it is just an example. It is otherwise hart to distinguish between simplification and real syntactic error. E.g. the declaration of the struct needs no <code>=</code>."}, {"owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "edited": false, "score": 0, "creation_date": 1452698637, "post_id": 34767366, "comment_id": 57285716, "body": "Provided the actual working piece :D"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452699472, "post_id": 34767366, "comment_id": 57286364, "body": "Don&#39;t add unrealtred tags. This is not releated to embedded devices."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1452700019, "post_id": 34767366, "comment_id": 57286832, "body": "The line: <code>int func{</code> is not legal C.  I guess this is supposed to be a function, but a function needs <code>int func(void){</code> at least."}], "answers": [{"tags": [], "owner": {"reputation": 548, "user_id": 2229835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXQjN.jpg?s=128&g=1", "display_name": "Kellerspeicher", "link": "https://stackoverflow.com/users/2229835/kellerspeicher"}, "is_accepted": true, "score": 1, "last_activity_date": 1452691602, "last_edit_date": 1452691602, "creation_date": 1452690644, "answer_id": 34767620, "question_id": 34767366, "link": "https://stackoverflow.com/questions/34767366/use-of-static-array-to-initialize-constant-struct-object/34767620#34767620", "title": "use of static array to initialize constant struct object", "body": "<p><code>file.c</code> seems to be a C file. Using <code>static</code> in C has two meanings:</p>\n\n<ol>\n<li>Not on the stack (e.g. for variables inside functions that shall keep their value across several calls of the function)</li>\n<li>Not exported from this module (for variables that shall not be provided as a symbol to the linker)</li>\n</ol>\n\n<p>In this case it seems to be the second one. The variable <code>gaih</code> shall not be exported (visible for the linker) <code>static</code> and it shall not be changed <code>const</code>. There is nothing crude.</p>\n\n<p>But to clarify further details the complete valid code would be needed. It seems to be a constant and static initialisation of an array of structs with just one entry. The variable <code>g</code> is just a pointer to this single entry.</p>\n\n<p>This example has some similarity with the <code>struct gaih_addrtuple</code> in <code>nss.h</code> which is a linked list of host names and IP addresses used for <code>gethostbyname</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1452700560, "post_id": 34771014, "comment_id": 57287267, "body": "What is <code>int func{ const struct gaih *g = gaih;  }</code> ?   It is certainly not a function...  Would it not need at least <code>int func(void){...return 0; }</code> to make it compile in C?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1452700329, "last_edit_date": 1452700329, "creation_date": 1452700046, "answer_id": 34771014, "question_id": 34767366, "link": "https://stackoverflow.com/questions/34767366/use-of-static-array-to-initialize-constant-struct-object/34771014#34771014", "title": "use of static array to initialize constant struct object", "body": "<p>The global variable <code>gaih</code> is defined as <code>static</code>, which means it is only visible in the current file, and <code>const</code>, which means it can't be modified once initialized.</p>\n\n<p>The local variable <code>g</code> is also defined as <code>const</code>, meaning it can't be changed.  It is initialized with the address of the global <code>gaih</code> array, so <code>g</code> can be treated as an array in this context.  </p>\n\n<p><code>g</code> can also be passed to another function, possibly in a different file.  This allows the contents of <code>gaih</code> to be read outside of the current file which would not be allowed by attempting to reference <code>gaih</code> directly.</p>\n"}], "owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 34767620, "answer_count": 2, "score": 0, "last_activity_date": 1452700329, "creation_date": 1452689818, "last_edit_date": 1452699722, "question_id": 34767366, "link": "https://stackoverflow.com/questions/34767366/use-of-static-array-to-initialize-constant-struct-object", "title": "use of static array to initialize constant struct object", "body": "<p>I recently came across the following code: </p>\n\n<pre><code>    static const struct gaih gaih[] = {    \n#if defined __UCLIBC_HAS_IPV6__    \n    { PF_INET6, gaih_inet },    \n#endif    \n    { PF_INET, gaih_inet },    \n#if 0   \n    { PF_LOCAL, gaih_local },    \n#endif    \n    { PF_UNSPEC, NULL }    \n};    \n\n\n\n     struct gaih {    \n            int family;    \n            int (*gaih)(const char *name, const struct gaih_service *service,    \n                    const struct addrinfo *req, struct addrinfo **pai);    \n        };    \n\n\nint func{    \n\nconst struct gaih *g = gaih;    \n\n    }    \n</code></pre>\n\n<p>I understand the meaning of constant and static .\nBut I able to decipher the logic behind static initialization of the constant object in such a crude way.\nplease clarify the reason or use of doing it this way </p>\n"}, {"tags": ["c", "gcc", "assembly", "interrupt", "real-mode"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1452690261, "post_id": 34767342, "comment_id": 57279730, "body": "The compiler isn&#39;t really <b>insulting</b> you, is he?"}, {"owner": {"reputation": 3, "user_id": 5784246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbfb1ec603feb0a7b0f65030269eddc2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/5784246/matthieu"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1452804342, "post_id": 34767342, "comment_id": 57341957, "body": "not really indeed but its response was not very explicit, was it ? :P"}], "answers": [{"tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 1, "last_activity_date": 1452690628, "last_edit_date": 1452690628, "creation_date": 1452690316, "answer_id": 34767522, "question_id": 34767342, "link": "https://stackoverflow.com/questions/34767342/difficulties-with-extended-assembly-syntax-to-call-a-bios-service-in-real-mode/34767522#34767522", "title": "Difficulties with extended assembly syntax to call a bios service in real mode", "body": "<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#GotoLabels\" rel=\"nofollow\">Section 6.44.3.3 Goto Labels</a> in the documentation you linked says:</p>\n\n<blockquote>\n  <p>An asm goto statement cannot have outputs.</p>\n</blockquote>\n\n<p>The compiler error is trying to tell you that, albeit not in a very clear way.\nSince in this case you don't need the label to be in the C code, the simple fix is to put it into the asm block and use plain old <code>goto</code>-less inline asm. To avoid collisions, use a local label.</p>\n\n<p>PS: you don't need to <code>mov</code> the result, you can use an <code>\"=a\"</code> constraint. The <code>bios_service</code> doesn't need to be a register either, and you don't need the <code>clc</code>. This should be all you need:</p>\n\n<pre><code>char keyboard_getc(void)\n{\n    char user_input;\n\n    __asm__ __volatile__(\"1: movb %[bios_service], %%ah;\"\n                               \"int $0x16;\"\n                               \"jnc 1b;\"\n                               : \"=a\" (user_input)\n                               : [bios_service] \"i\" (0x00)\n                               : \"cc\"\n                               );\n\n   return user_input;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5784246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbfb1ec603feb0a7b0f65030269eddc2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/5784246/matthieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1452693322, "creation_date": 1452693322, "answer_id": 34768544, "question_id": 34767342, "link": "https://stackoverflow.com/questions/34767342/difficulties-with-extended-assembly-syntax-to-call-a-bios-service-in-real-mode/34768544#34768544", "title": "Difficulties with extended assembly syntax to call a bios service in real mode", "body": "<p>Thanks for your good advice Jester. Finally, the code I was trying to implement is the following :</p>\n\n<pre><code>char keyboard_getc(void)\n{\n    char user_input;\n\n    __asm__ __volatile__(\"wait_keystroke: movb %[bios_service_wait_key_stroke], %%ah;\"\n                         \"int $0x16;\"\n                         \"jc wait_keystroke;\"\n                         \"movb %[bios_service_read_buffer], %%ah;\"\n                         \"int $0x16;\"\n                         : \"=a\" (user_input)\n                         : [bios_service_wait_key_stroke] \"i\" (0x01),\n                           [bios_service_read_buffer] \"i\" (0x00)\n                         : \"cc\"\n                         );\n\n    return user_input;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5784246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbfb1ec603feb0a7b0f65030269eddc2?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/5784246/matthieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 34767522, "answer_count": 2, "score": 0, "last_activity_date": 1452693322, "creation_date": 1452689756, "question_id": 34767342, "link": "https://stackoverflow.com/questions/34767342/difficulties-with-extended-assembly-syntax-to-call-a-bios-service-in-real-mode", "title": "Difficulties with extended assembly syntax to call a bios service in real mode", "body": "<p>I am programming a boot loader, the boot sector has already handed over to the second stage. From now on, I am programming in C instead of programming everything in x86 assembly. My final goal is to make something simpler than u-boot but something that can look at the multiboot header and launch the kernel. Most of the operation are done in real mode.</p>\n\n<p>I am struggling with this piece of code. I aim at waiting a key stroke and getting the corresponding ASCII char that was pressed.</p>\n\n<pre><code>#include \"keyboard.h\"\n\nchar keyboard_getc(void)\n{\n    char user_input;\n\nwait_keystroke:\n    __asm__ __volatile__ goto (\"clc;\"\n                               \"movb %[bios_service], %%ah;\"\n                               \"int $0x16;\"\n                               \"jnc %l[wait_keystroke];\"\n                               \"movb %%al, %[char_input]\"\n                               : [char_input] \"=rm\" (user_input)\n                               : [bios_service] \"r\" (0x00)\n                               : \"%ax\", \"cc\"\n                               : wait_keystroke\n                               );\n\n   return user_input;\n}\n</code></pre>\n\n<p>The compiler is insulting me as below :</p>\n\n<pre><code>i386-elf-gcc -std=c99 -DDEBUG -O1 -c -g -march=i386 -m16 -ffreestanding -Wall -W -I../inc -o keyboard.o keyboard.c\nkeyboard.c: In function \u2018keyboard_getc\u2019:\nkeyboard.c:13:34: error: expected \u2018:\u2019 before \u2018[\u2019 token\n                                : [char_input] \"=rm\" (user_input)\n                                  ^\nkeyboard.c:7:1: warning: label \u2018wait_keystroke\u2019 defined but not used [-Wunused-label]\n wait_keystroke:\n ^\nmake: *** [keyboard.o] Error 1\n</code></pre>\n\n<p>I tried to follow this documentation <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html</a> but I didn't find the answer.</p>\n\n<p>Does somebody have an idea why ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1258, "user_id": 815227, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/qMjpi.png?s=128&g=1", "display_name": "kazbeel", "link": "https://stackoverflow.com/users/815227/kazbeel"}, "edited": false, "score": 0, "creation_date": 1452689958, "post_id": 34767233, "comment_id": 57279523, "body": "What about &quot;playing&quot; with an offset taking as base <code>str</code> direction?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 3, "creation_date": 1452690159, "post_id": 34767233, "comment_id": 57279650, "body": "It would take <code>const char **endptr</code> and have an otherwise equal implementation, but see <a href=\"http://stackoverflow.com/questions/993700/are-strtol-strtod-unsafe\" title=\"are strtol strtod unsafe\">stackoverflow.com/questions/993700/are-strtol-strtod-unsafe</a> why it doesn&#39;t."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 2, "creation_date": 1452690428, "post_id": 34767233, "comment_id": 57279839, "body": "The answer is &quot;it cannot&quot;. This has been answered in another more general question, though."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452705230, "post_id": 34767233, "comment_id": 57290838, "body": "C doesn&#39;t have <code>const_cast</code>."}, {"owner": {"reputation": 11672, "user_id": 3840170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L9NB3.png?s=128&g=1", "display_name": "user3840170", "link": "https://stackoverflow.com/users/3840170/user3840170"}, "edited": false, "score": 1, "creation_date": 1617462465, "post_id": 34767233, "comment_id": 118312795, "body": "There was a proposal addressing this &lt;<a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2068.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/n2068.pdf</a>&gt;, but it apparently wasn\u2019t successful."}], "answers": [{"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 2, "last_activity_date": 1452690254, "creation_date": 1452690254, "answer_id": 34767506, "question_id": 34767233, "link": "https://stackoverflow.com/questions/34767233/how-do-you-implement-strtol-under-const-correctness/34767506#34767506", "title": "How do you implement strtol under const-correctness?", "body": "<p>Most likely it just uses casting. </p>\n\n<p>There are numerious functions that have this same property in standard library. Sacrifiying type safety over simplicity is likely reason, since you cannot overload functions as in C++.</p>\n\n<p>They expect that programmer takes responsibility, and doesn't edit <code>endptr</code> if <code>str</code> is, for example, a string literal.</p>\n\n<p>With it's limited type system, C is practical language for practical people.</p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452709028, "post_id": 34767519, "comment_id": 57293164, "body": "Not everything is fine. It&#39;s possible to pass a pointer to a const array to <code>strtol</code>, and use the resulting <code>*endptr</code> pointer to (attempt to) modify that array, all without using a cast. It&#39;s a flaw in the C standard library."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452720526, "post_id": 34767519, "comment_id": 57299842, "body": "@KeithThompson a tradeoff has been made, and a bit of type-safety has been chipped away in favour of a better interface. Still, from the standard&#39;s perspective, everything is fine indeed : no UB or other dangers."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452722666, "post_id": 34767519, "comment_id": 57300889, "body": "Look at the example program in my answer. The function itself doesn&#39;t violate <code>const</code> safety, but it enables user code that uses it to do so without a cast or a warning. A better interface would provide two different functions, one for <code>const</code> data and one for non-<code>const</code> data."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1452722870, "post_id": 34767519, "comment_id": 57300986, "body": "@KeithThompson I did understand what you meant. C has no function overloading, so two differently named functions would have had to be created. In hindsight I don&#39;t think this <code>const</code>ness loophole is better than two separate functions, but the choice that has been made does make sense."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452723195, "post_id": 34767519, "comment_id": 57301141, "body": "Which is why I suggested using two functions with different names. My point is this: you say &quot;everything is fine&quot;, but it isn&#39;t. The standard library creates a loophole that makes it too easy to break <code>const</code> correctness. (The lack of <code>const</code>ness for string literals is a similar loophole.)"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452723548, "post_id": 34767519, "comment_id": 57301303, "body": "@KeithThompson My answer is just : <code>const_cast</code> is not a cheat, and would be the right tool to achieve <code>strtol</code>&#39;s interface. Whether such an interface is a good idea in the first place is both out of scope of the question, and a point we both agree on (and our answer is &quot;no&quot;)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452726403, "post_id": 34767519, "comment_id": 57302527, "body": "<code>const_cast</code>? In C? But my point is that your statement that &quot;everything is fine&quot; seems to go beyond the scope of the question. Sure, the <code>const char*</code> pointer to <code>char*</code> inside <code>strtol()</code> is the sensible thing to do. If you removed the last 4 words of your answer I&#39;d have no objection."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1452726521, "post_id": 34767519, "comment_id": 57302572, "body": "@KeithThompson &quot;<code>const_cast</code>&quot; to echo the question&#39;s wording, &quot;or equivalent&quot; to acknowledge it&#39;s not actually a <code>const_cast</code> because we&#39;re in C."}, {"owner": {"reputation": 1474, "user_id": 30404, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a9a07653c487e7b8c61b0e601bb0bfc0?s=128&d=identicon&r=PG", "display_name": "Enno", "link": "https://stackoverflow.com/users/30404/enno"}, "edited": false, "score": 1, "creation_date": 1452943756, "post_id": 34767519, "comment_id": 57394618, "body": "Good points made here. The way I understand Quentin, it&#39;s because as a caller to strol, I might have a <code>char *</code> and want to get an offset into it that I can write to, but if strtol was defined to work on a <code>char *</code>, it wouldn&#39;t accept a <code>const char *</code> as its first argument. You can&#39;t have it both ways, because there&#39;s no function overloading, and writing two separate functions is just making the libc even bigger for very little gain. Thanks, my understanding has broadened!"}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": false, "score": 1, "last_activity_date": 1452690306, "creation_date": 1452690306, "answer_id": 34767519, "question_id": 34767233, "link": "https://stackoverflow.com/questions/34767233/how-do-you-implement-strtol-under-const-correctness/34767519#34767519", "title": "How do you implement strtol under const-correctness?", "body": "<p><code>strtol</code> does do a <code>const_cast</code> (or equivalent). Casting a <code>const</code> away is not a problem, using the resulting pointer to modify the originally-<code>const</code> pointee may be.</p>\n\n<p>But <code>strtol</code> just returns this pointer to you without tampering with it, so everything is fine.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1452727222, "last_edit_date": 1452727222, "creation_date": 1452700294, "answer_id": 34771108, "question_id": 34767233, "link": "https://stackoverflow.com/questions/34767233/how-do-you-implement-strtol-under-const-correctness/34771108#34771108", "title": "How do you implement strtol under const-correctness?", "body": "<blockquote>\n  <p>How do you implement strtol under const-correctness?</p>\n</blockquote>\n\n<p>Use of C11  <code>_Generic</code> would allow code to call either of </p>\n\n<pre><code>// when passed argument for `str` is `char *` and for `endptr` is `char **`\nlong strotol(const char* str, char** endptr, int base);\n// or\n// when passed argument for `str` is `const char *` and for `endptr` is `const char **`\nlong strotol_c(const char* str, const char** endptr, int base);\n// and warn/error otherwise\n</code></pre>\n\n<p>An implementation, as below would be identical as only the function signature preservation is needed.  Since this differs from <code>strtol()</code>, it should be called something else such as <code>strtol_s()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nlong int strtol_c(const char * restrict nptr, const char ** restrict endptr, int base) {\n  return strtol((char *) nptr, (char **) endptr, base);\n}\n\n#define strtol_s(n,e,b) _Generic(n, \\\n  char *: strtol((n), (e), (b)), \\\n  const char *: strtol_c((n), (e), (b)), \\\n  default: 0 \\\n  )\n\nint main(void) {\n  char *src = malloc(100);\n  strcpy(src, \"456\");\n  const char *srcc = \"123\";\n  char *endptr;\n  const char *endcptr;\n  long L[6] = { 0 };\n\n  // OK - matching str and *endptr\n  L[0] = strtol_s(src,  &amp;endptr, 0);\n\n  // warning: passing argument 2 of 'strtol' from incompatible pointer type\n  L[1] = strtol_s(src,  &amp;endcptr, 0);\n\n  // warning: passing argument 2 of 'strtol_c' from incompatible pointer type\n  L[2] = strtol_s(srcc, &amp;endptr, 0);\n\n  // OK - matching str and *endptr\n  L[3] = strtol_s(srcc, &amp;endcptr, 0);\n\n  L[4] = strtol(src, &amp;endptr, 0);\n  // warning passing argument 2 of 'strtol' from incompatible pointer type\n\n  // OK\n  L[5] = strtol(src, &amp;endcptr, 0);\n  return !L[0];\n}\n</code></pre>\n\n<p>What is lost: <code>strtol_s()</code> is not a true function, so a pointer to it can not be made.</p>\n\n<blockquote>\n  <p>how does it manage to turn that into a non-const pointer to the first unprocessed character without cheating?</p>\n</blockquote>\n\n<p><code>strtol()</code>, although it takes a <code>char **endptr</code> as the second argument, does not modify <code>*endptr</code>.  </p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 7, "last_activity_date": 1452709607, "creation_date": 1452709607, "answer_id": 34774296, "question_id": 34767233, "link": "https://stackoverflow.com/questions/34767233/how-do-you-implement-strtol-under-const-correctness/34774296#34774296", "title": "How do you implement strtol under const-correctness?", "body": "<blockquote>\n  <p><strong>How do you implement <code>strtol</code> under const-correctness?</strong></p>\n</blockquote>\n\n<p>You don't, because <code>strtol</code>'s definition is inherently not <code>const</code>-correct.</p>\n\n<p>This is a flaw in the C standard library.</p>\n\n<p>There are several standard functions that take a <code>const char*</code> argument (expected to point the beginning of a character array) and give back a non-<code>const</code> <code>char*</code> pointer that can be used to modify that array.</p>\n\n<p><code>strchr</code> is one example:</p>\n\n<pre><code>char *strchr(const char *s, int c);\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>#include &lt;string.h&gt;\nint main(void) {\n    const char *s = \"hello\";\n    char *ptr = strchr(s, 'h');\n    *ptr = 'H';\n}\n</code></pre>\n\n<p>This program has undefined behavior. On my system, it dies with a segmentation fault.</p>\n\n<p>The problem doesn't occur in <code>strchr</code> itself. It promises not to modify the string you pass to it, and it doesn't. But it returns a pointer that the caller can then use to modify it.</p>\n\n<p>The ANSI C committee, back in the late 1980s, <em>could</em> have split each such function into two versions, one that acts on <code>const</code> character arrays and another for non-<code>const</code> arrays:</p>\n\n<pre><code>char *strchr(char *s, int c);\nconst char *strcchr(const char *s, int c);\n</code></pre>\n\n<p>But that would have broken existing pre-ANSI code, written before <code>const</code> existed. This is the same reason C has not made string literals <code>const</code>.</p>\n\n<p>C++, which inherits most of C's standard library, deals with this by providing overloaded versions of some functions.</p>\n\n<p>The bottom line is that <em>you</em>, as a C programmer, are responsible for not modifying objects you've defined as <code>const</code>. In most cases, the language helps you enforce this, but not always.</p>\n\n<p>As for how these functions manage to return a non-<code>const</code> pointer to <code>const</code> data, they probably just use a cast internally (not a <code>const_cast</code>, which exists only in C++). That's assuming they're implemented in C, which is likely but not required.</p>\n"}], "owner": {"reputation": 1474, "user_id": 30404, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a9a07653c487e7b8c61b0e601bb0bfc0?s=128&d=identicon&r=PG", "display_name": "Enno", "link": "https://stackoverflow.com/users/30404/enno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 1, "answer_count": 4, "score": 14, "last_activity_date": 1452727222, "creation_date": 1452689453, "question_id": 34767233, "link": "https://stackoverflow.com/questions/34767233/how-do-you-implement-strtol-under-const-correctness", "title": "How do you implement strtol under const-correctness?", "body": "<p>According to <a href=\"http://www.cplusplus.com/reference/cstdlib/strtol/\">http://www.cplusplus.com/reference/cstdlib/strtol/</a> this function has a signature of <code>long int strtol (const char* str, char** endptr, int base)</code>.</p>\n\n<p>I wonder, though: If it gets passed a <code>const char *</code> to the beginning of the string, how does it manage to turn that into a non-const pointer to the first unprocessed character without cheating? What would an implementation of strtol look like that doesn't perform a const_cast?</p>\n"}, {"tags": ["c", "operating-system", "shared-libraries", "executable", "x86-64"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452689139, "post_id": 34767048, "comment_id": 57278986, "body": "What platform are you trying to do this on?"}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452689448, "post_id": 34767048, "comment_id": 57279175, "body": "added the platform and kernel version"}], "answers": [{"comments": [{"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 0, "creation_date": 1452690898, "post_id": 34767546, "comment_id": 57280153, "body": "I am trying to write reference monitor that loads binary in idiosyncratic way. shared library is a sensible solution in this situation. Am I right? yes you are right shared library will generate daemon to further restrict the execution of loaded process."}], "tags": [], "owner": {"reputation": 881, "user_id": 5635258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69b37f21456c0333195948af74563b9?s=128&d=identicon&r=PG&f=1", "display_name": "StephenG", "link": "https://stackoverflow.com/users/5635258/stepheng"}, "is_accepted": false, "score": 3, "last_activity_date": 1452690407, "creation_date": 1452690407, "answer_id": 34767546, "question_id": 34767048, "link": "https://stackoverflow.com/questions/34767048/how-to-make-shared-library-an-executable/34767546#34767546", "title": "how to make shared library an executable", "body": "<p>This is fundamentally not sensible.</p>\n\n<p>A shared library generally has no task it performs that can be used as it's equivalent of a <code>main()</code> function.  The primary goal is to allow separate management and implementation of common code operations, and on systems that operate that way to allow a single code file to be loaded and shared, thereby reducing memory overhead for application code that uses it.</p>\n\n<p>An executable file is designed to have a single point of entry from which it performs all the operations related to completing a well defined task.  Different OSes have different requirements for that entry point.  A shared library normally has no similar underlying function.</p>\n\n<p>So in order to (usefully) convert a shared library to an executable you must also define ( and generate code for ) a task which can be started from a single entry point.</p>\n\n<p>The code you linked to is starting with the source code to the library and explicitly codes a main() which it invokes via the entry point function.  If you did not have the source code for a library you could, in theory, hack a new file from a shared library ( in the absence of security features to prevent this in any given OS ), but it would be an odd thing to do.</p>\n\n<p>But in practical terms you would not deploy code in this manner.  Instead you would code a shared library as a shared library.  If you wanted to perform some task you would code a separate executable that linked to that library and code.  Trying to tie the two together defeats the purpose of writing the library and distorts the structure, implementation and maintenance of that library and the application.  Keep the application and the library apart.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5739672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuG9K.jpg?s=128&g=1", "display_name": "Devang Kubavat", "link": "https://stackoverflow.com/users/5739672/devang-kubavat"}, "is_accepted": false, "score": 0, "last_activity_date": 1452691551, "last_edit_date": 1592644375, "creation_date": 1452691551, "answer_id": 34767928, "question_id": 34767048, "link": "https://stackoverflow.com/questions/34767048/how-to-make-shared-library-an-executable/34767928#34767928", "title": "how to make shared library an executable", "body": "<ul>\n<li>To create shared Dynamic Library with Example.</li>\n</ul>\n<blockquote>\n<p>Suppose with there are three files are : sum.o mul.o and print.o</p>\n<p>Shared library name &quot; libmno.so &quot;</p>\n</blockquote>\n<pre><code>cc -shared -o libmno.so sum.o mul.o print.o\n</code></pre>\n<blockquote>\n<p>and compile with</p>\n</blockquote>\n<pre><code>cc main.c ./libmno.so\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 1, "last_activity_date": 1452740349, "creation_date": 1452740349, "answer_id": 34780942, "question_id": 34767048, "link": "https://stackoverflow.com/questions/34767048/how-to-make-shared-library-an-executable/34780942#34780942", "title": "how to make shared library an executable", "body": "<p>I don't see how this is useful for anything.  You could always achieve the same functionality from having a <code>main</code> in a separate binary that links against that library.  Making a single file that works as both is solidly in the realm of \"silly computer tricks\".  There's no benefit I can see to having a <code>main</code> embedded in the library, even if it's a test harness or something.</p>\n\n<p>There might possible be some performance reasons, like not having function calls go through the indirection of the PLT.</p>\n\n<hr>\n\n<p>In that example, the shared library is also a valid ELF executable, because it has a quick-and-dirty entry-point that grabs the args for <code>main</code> from where <a href=\"http://www.x86-64.org/documentation/abi.pdf\" rel=\"nofollow\">the ABI</a> says they go (i.e. copies them from the stack into registers).  It also arranges for the ELF interpreter to be set correctly.  It will only work on x86-64, because no definition is provided for <code>init_args</code> for other platforms.</p>\n\n<p>I'm surprised it actually works; I thought all the crap the usual CRT (startup) code does was actually needed for stdio to work properly.  It looks like it doesn't initialize <code>extern char **environ;</code>, since it only gets <code>argc</code> and <code>argv</code> from the stack, not <code>envp</code>.</p>\n\n<p>Anyway, when run as an executable, it has everything needed to be a valid dynamically-linked executable: an entry-point which runs some code and exits, an interpreter, and a dependency on libc.  (ELF shared libraries can depend on (i.e. link against) other ELF shared libraries, in the same way that executables can).</p>\n\n<hr>\n\n<p>When used as a library, it just works as a normal library containing some function definitions.  None of the stuff that lets it work as an executable (entry point and interpreter) is even looked at.</p>\n\n<p>I'm not sure why you don't get an error for multiple definitions of <code>main</code>, since it isn't declared as a <a href=\"https://en.wikipedia.org/wiki/Weak_symbol\" rel=\"nofollow\">\"weak\" symbol</a>.  I guess shared-lib definitions are only looked for when there's a reference to an undefined symbol.  So <code>main()</code> from <code>call.c</code> is used instead of <code>main()</code> from <code>libtest.so</code> because <code>main</code> already has a definition before the linker looks at <code>libtest</code>.</p>\n"}], "owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1517, "favorite_count": 0, "accepted_answer_id": 34780942, "answer_count": 3, "score": 2, "last_activity_date": 1452740349, "creation_date": 1452688937, "last_edit_date": 1452691785, "question_id": 34767048, "link": "https://stackoverflow.com/questions/34767048/how-to-make-shared-library-an-executable", "title": "how to make shared library an executable", "body": "<p>I was searching for asked question. i saw this link <a href=\"https://hev.cc/2512.html\" rel=\"nofollow\">https://hev.cc/2512.html</a> which is doing exactly the same thing which I want. But there is no explanation of whats going on. I am also confused whether shared library with out main() can be made executable if yes how? I can guess i have to give global main() but know no details. Any further easy reference and guidance is much appreciated  </p>\n\n<p>I am working on x86-64 64 bit Ubuntu with kernel 3.13</p>\n"}, {"tags": ["c", "gdb", "valgrind"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1452688116, "post_id": 34766748, "comment_id": 57278323, "body": "Not necessarily it&#39;s double free or <b>corruption</b>, please post the code if you want help."}, {"owner": {"reputation": 1446, "user_id": 5411628, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1b3eebf82dacd8e7d2498c286631ce3e?s=128&d=identicon&r=PG&f=1", "display_name": "nadavgam", "link": "https://stackoverflow.com/users/5411628/nadavgam"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1452688271, "post_id": 34766748, "comment_id": 57278442, "body": "@iharob umm its kind of a big program to post here, but lets say it is double free , is there a way to do what I asked"}], "answers": [{"tags": [], "owner": {"reputation": 33210, "user_id": 211659, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31c59c3ebec3e38517c37e8b1d5cb9de?s=128&d=identicon&r=PG", "display_name": "\u0160imon T&#243;th", "link": "https://stackoverflow.com/users/211659/%c5%a0imon-t%c3%b3th"}, "is_accepted": false, "score": 3, "last_activity_date": 1452688354, "creation_date": 1452688354, "answer_id": 34766853, "question_id": 34766748, "link": "https://stackoverflow.com/questions/34766748/can-i-check-with-valgrind-or-gdb-if-another-pointer-holds-the-same-address/34766853#34766853", "title": "can I check with Valgrind or Gdb if another pointer holds the same address?", "body": "<p>Valgrind will tell you where you tried to dealocate the block for the second time and where you initially deallocated it:</p>\n\n<pre><code>==21347== Invalid free() / delete / delete[] / realloc()\n==21347==    at 0x4C2A37C: free (in /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so)\n==21347==    by 0x4005CA: main (test.c:7)\n==21347==  Address 0x51dc040 is 0 bytes inside a block of size 1,000 free'd\n==21347==    at 0x4C2A37C: free (in /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so)\n==21347==    by 0x4005BE: main (test.c:6)\n</code></pre>\n\n<p>Code that generate this:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char * x = malloc(1000);\n    free(x);\n    free(x);\n}\n</code></pre>\n"}], "owner": {"reputation": 1446, "user_id": 5411628, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1b3eebf82dacd8e7d2498c286631ce3e?s=128&d=identicon&r=PG&f=1", "display_name": "nadavgam", "link": "https://stackoverflow.com/users/5411628/nadavgam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452688354, "creation_date": 1452688072, "last_edit_date": 1452688137, "question_id": 34766748, "link": "https://stackoverflow.com/questions/34766748/can-i-check-with-valgrind-or-gdb-if-another-pointer-holds-the-same-address", "title": "can I check with Valgrind or Gdb if another pointer holds the same address?", "body": "<p>Im doing tests to a program I wrote for school and I got a <strong>segmentation fault</strong> with this msg </p>\n\n<pre><code>double free or corruption (out)\n</code></pre>\n\n<p>after I try to free an adress.</p>\n\n<p>So I guess I had released this address before , So my question is - can valgrind/gdb tell me if an address is being pointed out by two different pointers ? or  given an address Can they tell me how many pointers point to it?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "is_accepted": false, "score": 2, "last_activity_date": 1452688002, "last_edit_date": 1495542682, "creation_date": 1452688002, "answer_id": 34766721, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32/34766721#34766721", "title": "C programming, pad a block to the nearest 32", "body": "<p>36/32 will perform integer division and will result in dbl being equal to 1. Try using (36.0 / 32.0).\nAlso, try to avoid using magic numbers <a href=\"https://stackoverflow.com/questions/47882/what-is-a-magic-number-and-why-is-it-bad\">What is a magic number, and why is it bad?</a></p>\n"}, {"tags": [], "owner": {"reputation": 2008, "user_id": 5719329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9755dd4a1942ea4a23a3c3e6dfb68171?s=128&d=identicon&r=PG&f=1", "display_name": "andreas-hofmann", "link": "https://stackoverflow.com/users/5719329/andreas-hofmann"}, "is_accepted": true, "score": 4, "last_activity_date": 1452688009, "creation_date": 1452688009, "answer_id": 34766722, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32/34766722#34766722", "title": "C programming, pad a block to the nearest 32", "body": "<p>When you call <code>ceil(36/32)</code> you're dividing two integers, so you get an integer as a result (1 in this case). Try dividing doubles: <code>ceil(36.0/32.0)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1452688145, "post_id": 34766728, "comment_id": 57278345, "body": "Maybe <code>block_size = ( block_size + 31 ) &amp; ~0x1F;</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452688250, "post_id": 34766728, "comment_id": 57278419, "body": "No need to use bitops. Any half-way recent compiler will optimise multiplication properly. That also makes the code more clear and allows arbitrary alignment."}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 2, "last_activity_date": 1452688643, "last_edit_date": 1452688643, "creation_date": 1452688022, "answer_id": 34766728, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32/34766728#34766728", "title": "C programming, pad a block to the nearest 32", "body": "<p>If you like to allign to 32 (= 2^5) do this:</p>\n\n<pre><code>int block_size;\n...\nblock_size = block_size+31 &amp; ~31;\n</code></pre>\n\n<p>First add 31 and then mask all bits except the first 5 bits.</p>\n\n<p>(32 + 31) &amp; ~31 = 32</p>\n\n<p>(33 + 31) &amp; ~31 = 64</p>\n"}, {"tags": [], "owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "is_accepted": false, "score": 2, "last_activity_date": 1452688182, "creation_date": 1452688182, "answer_id": 34766786, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32/34766786#34766786", "title": "C programming, pad a block to the nearest 32", "body": "<p>The values '36' and '32' in the line 'dbl = ceil(36/32);' are integers.  This means the result of '36/32' 32 is 1, and 'ceil(1)' is 1.</p>\n\n<p>Make them floating point values to get the correct answer:</p>\n\n<pre><code>dbl = ceil(36.0/32.0);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452688754, "post_id": 34766865, "comment_id": 57278725, "body": "I think you forgot to multiply by alignment."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 2, "last_activity_date": 1452690325, "last_edit_date": 1452690325, "creation_date": 1452688390, "answer_id": 34766865, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32/34766865#34766865", "title": "C programming, pad a block to the nearest 32", "body": "<p>Try</p>\n\n<pre><code>#define ALIGNMENT 32\n\n...\n\nint input = 36;\nint rounded_up = ((input + (ALIGNMENT - 1)) / ALIGNMENT) * ALIGNMENT;\n</code></pre>\n\n<p>Don't use floating point unless absolutely necessary. They cause more trouble and are likely slower than integers. The compiler will likely use masking for this pattern if it uses powers of two.</p>\n\n<p>And avoid magic numbers in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1452689678, "creation_date": 1452689678, "answer_id": 34767308, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32/34767308#34767308", "title": "C programming, pad a block to the nearest 32", "body": "<p>All previous answers are correct, but they missed casting.\nIf the values you have <strong>are</strong> integers, i.e you get the value to round from a function or an integer variable, you can use:</p>\n\n<pre><code>int MyRoundedValue = ceil((double)MyInputInteger/32.0);\n</code></pre>\n\n<p>Note the casting to double of your int variable and the divisor, 32.0, expressed as a double.<br>\nAnyway using the <code>ceil()</code> function is an heavy job for such simple problem, it is more simple to act on solutions that avoid the use of ceil and floats (as many of that above).</p>\n"}], "owner": {"reputation": 587, "user_id": 515963, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iZoju.png?s=128&g=1", "display_name": "TSUK", "link": "https://stackoverflow.com/users/515963/tsuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 34766722, "answer_count": 6, "score": 0, "last_activity_date": 1452690325, "creation_date": 1452687777, "question_id": 34766639, "link": "https://stackoverflow.com/questions/34766639/c-programming-pad-a-block-to-the-nearest-32", "title": "C programming, pad a block to the nearest 32", "body": "<p>I wish to use a block size that is padded to the nearest 32 so my function below I thought would be 36/32 = 1.125, ceil = 2, 2*32 = 64 however somewhere from converting from double to int I am getting the answer of 32.</p>\n\n<pre><code>double dbl;\nint block_size;\n\ndbl = ceil(36/32);\nblock_size = (int)dbl*32; // equals 32\n</code></pre>\n"}, {"tags": ["c", "linux", "fanotify"], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1452689233, "post_id": 34766799, "comment_id": 57279035, "body": "Good find. That would be e.g. <code>fanotify_mark(-1, FAN_MARK_FLUSH, FAN_ALL_PERM_EVENTS, -1, NULL)</code> C library call yielding -1 with <code>errno == ENOSYS</code> if no fanotify support, <code>errno == EINVAL</code> if no access permissions event support, and <code>errno == EBADF</code> if fanotify support with access permissions support was available. But, can you rely on such undocumented behaviour? Is it likely to change in the future? I do not know; I myself probably would not trust this. It might be worth a query at linux-fsdevel mailing list, though."}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1452689765, "post_id": 34766799, "comment_id": 57279392, "body": "@NominalAnimal, yeah, totally undocumented, but I see no reasons why this check may be removed in future; it&#39;s logical to check if user&#39;s request is supported."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1452691846, "post_id": 34766799, "comment_id": 57280780, "body": "I&#39;m more worried about the checks being reordered at some point, actually. There are many ways the various checks <a href=\"https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/fs/notify/fanotify/fanotify_user.c\" rel=\"nofollow noreferrer\">in that function</a> could be reordered that would disable the detection. For example, if the file descriptor was checked prior to the mask check."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1452692230, "post_id": 34766799, "comment_id": 57281031, "body": "D&#39;oh! I&#39;m an idiot. If you make sure the fanotify mark is otherwise proper and correct -- instead of using the stupid will-always-fail check in my comment above --, then there is no risk, as the only reason such a mark would fail is because of lack of support. In short: just make sure the <code>fanotify_mark()</code> call is doing a valid operation, with at least some of <code>FAN_ALL_PERM_EVENTS</code> in the mask."}], "tags": [], "owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "is_accepted": true, "score": 3, "last_activity_date": 1452688219, "creation_date": 1452688219, "answer_id": 34766799, "question_id": 34766479, "link": "https://stackoverflow.com/questions/34766479/how-to-find-out-whether-config-fanotify-access-permissions-is-enabled/34766799#34766799", "title": "How to find out whether CONFIG_FANOTIFY_ACCESS_PERMISSIONS is enabled?", "body": "<p>It seems that <code>fanotify_mark()</code> returns <code>EINVAL</code> when <code>FAN_ALL_PERM_EVENTS</code> is passed but <code>CONFIG_FANOTIFY_ACCESS_PERMISSIONS</code> is disabled.</p>\n\n<p>See <a href=\"http://lxr.free-electrons.com/source/fs/notify/fanotify/fanotify_user.c#L843\" rel=\"nofollow\"><code>fs/notify/fanotify/fanotify_user.c</code></a> in kernel sources:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>SYSCALL_DEFINE5(fanotify_mark, int, fanotify_fd, unsigned int, flags,\n                              __u64, mask, int, dfd,\n                              const char  __user *, pathname)\n{\n...\n\n#ifdef CONFIG_FANOTIFY_ACCESS_PERMISSIONS\n        if (mask &amp; ~(FAN_ALL_EVENTS | FAN_ALL_PERM_EVENTS | FAN_EVENT_ON_CHILD))\n#else\n        if (mask &amp; ~(FAN_ALL_EVENTS | FAN_EVENT_ON_CHILD))\n#endif\n                return -EINVAL;\n</code></pre>\n"}], "owner": {"reputation": 18122, "user_id": 476371, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1798dbdad64383304a00c178ad458830?s=128&d=identicon&r=PG", "display_name": "0xC0000022L", "link": "https://stackoverflow.com/users/476371/0xc0000022l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 1, "accepted_answer_id": 34766799, "answer_count": 1, "score": 3, "last_activity_date": 1452688219, "creation_date": 1452687333, "question_id": 34766479, "link": "https://stackoverflow.com/questions/34766479/how-to-find-out-whether-config-fanotify-access-permissions-is-enabled", "title": "How to find out whether CONFIG_FANOTIFY_ACCESS_PERMISSIONS is enabled?", "body": "<p>I want to make use of <a href=\"http://man7.org/linux/man-pages/man7/fanotify.7.html\" rel=\"nofollow\"><code>fanotify(7)</code></a> and the problem I run into is that on some kernels <code>CONFIG_FANOTIFY_ACCESS_PERMISSIONS</code> does not work, although <code>CONFIG_FANOTIFY</code> is configured.</p>\n\n<p>At the very least I'd like to report this condition.</p>\n\n<p>Now on Debian and Ubuntu I could use the equivalent of <code>grep CONFIG_FANOTIFY_ACCESS_PERMISSIONS /boot/config-$(uname -r)</code> to verify that the feature is available. On some other systems I could use the equivalent of <code>zgrep CONFIG_FANOTIFY_ACCESS_PERMISSIONS /proc/config.gz</code>, but there are probably some more systems that are not covered by these two methods.</p>\n\n<p>Is there a way to figure out in any of the <code>fanotify(7)</code> functions whether or not fanotify permission handling is available on the kernel currently running?</p>\n\n<p>I was thinking of a method similar to the returned <code>ENOSYS</code> when <code>fanotify_mark()</code> is not implemented (<a href=\"http://man7.org/linux/man-pages/man2/fanotify_mark.2.html\" rel=\"nofollow\"><code>fanotify_mark(2)</code></a>), but could not find anything like that in the documentation.</p>\n"}, {"tags": ["c", "linux", "sockets", "ip-address", "freebsd"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1452704505, "post_id": 34766075, "comment_id": 57290347, "body": "Where did you get <code>IP_RECVDSTADDR</code> from? AFAIK, it is a BSD/Darwin-only feature. <a href=\"http://man7.org/linux/man-pages/man7/ip.7.html\" rel=\"nofollow noreferrer\"><code>IP_RECVORIGDSTADDR</code></a> is what&#39;s used in Linux. I could probably whip up a Linux example, if you&#39;ll verify the code also works in FreeBSD."}, {"owner": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1452708654, "post_id": 34766075, "comment_id": 57292937, "body": "Your right, IP_RECVDSTADDR is for BSD. The code that i posted indeed works on FreeBSD but i need to make in work on Linux. So changed to IP_RECVORIGDSTADDR as u suggested but still it doesnt work."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1452708817, "post_id": 34766075, "comment_id": 57293034, "body": "The socket option is <code>IP_RECVORIGDSTADDR</code> and the ancillary message type is <code>IP_ORIGDSTADDR</code> in Linux, not <code>IP_RECVDSTADDR</code>. You&#39;re also supposed to use the <code>CMSG_()</code> macros. See my (lightly tested to work) example code in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "edited": false, "score": 0, "creation_date": 1452694768, "post_id": 34768872, "comment_id": 57282858, "body": "can you show me a code snipet that does this check and prints the error?"}, {"owner": {"reputation": 344, "user_id": 4618003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e8f098af732d64e92365592e685a3c?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4618003/bernhard"}, "reply_to_user": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "edited": false, "score": 0, "creation_date": 1453643249, "post_id": 34768872, "comment_id": 57682454, "body": "<code>if (!cmsg-&gt;cmsg_len) { &#47;* handle error here... *&#47; }</code> Have a look at the man page recv(2) for further details."}], "tags": [], "owner": {"reputation": 344, "user_id": 4618003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e8f098af732d64e92365592e685a3c?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4618003/bernhard"}, "is_accepted": false, "score": 0, "last_activity_date": 1452694279, "creation_date": 1452694279, "answer_id": 34768872, "question_id": 34766075, "link": "https://stackoverflow.com/questions/34766075/i-ported-code-from-freebsd-to-linux-but-it-doesnt-extract-destination-address/34768872#34768872", "title": "I ported code from FreeBSD to Linux but it doesn&#39;t extract destination address", "body": "<p>Check the cmsg_len field. According to the recv(2) man page it doesn't return an address in case of a local error.</p>\n"}, {"comments": [{"owner": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "edited": false, "score": 0, "creation_date": 1452710906, "post_id": 34774002, "comment_id": 57294443, "body": "This is exactly what i needed. it works. thanks a lot!"}, {"owner": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "edited": false, "score": 0, "creation_date": 1452711046, "post_id": 34774002, "comment_id": 57294531, "body": "just a last question. i need to pass on a datagram which has this structure:  typedef struct { \tstruct sockaddr_in source; \tstruct sockaddr_in destination; \tuint8_t* payload; \tint payload_len; } ipv4_datagram;  -- how can i pass the information that (thanks to you) i just extracted to a ipv4_datagram datagram? because there will be another function that proccess ipv4_datagrams. its called at the end of my original code: process_ipv4_datagram(&amp;datagram);"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "edited": false, "score": 0, "creation_date": 1452712613, "post_id": 34774002, "comment_id": 57295467, "body": "@Pheonix7: The <code>payload</code> member needs to point to the data buffer the <code>iov</code> references, the <code>payload_len</code> member is the return value from <code>recvmsg()</code>, the <code>msg.name</code> and <code>msg.name_len</code> should point to <code>source</code> in the <code>ipv4_datagram</code> structure, and the <code>destination</code> is copied from the ancillary buffer in the <code>CMSG()</code> for loop. I modified the above example code to make these explicit."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 4, "last_activity_date": 1452712458, "last_edit_date": 1452712458, "creation_date": 1452708606, "answer_id": 34774002, "question_id": 34766075, "link": "https://stackoverflow.com/questions/34766075/i-ported-code-from-freebsd-to-linux-but-it-doesnt-extract-destination-address/34774002#34774002", "title": "I ported code from FreeBSD to Linux but it doesn&#39;t extract destination address", "body": "<p>In Linux, the socket option is <a href=\"http://man7.org/linux/man-pages/man7/ip.7.html\" rel=\"nofollow\"><code>IP_RECVORIGDSTADDR</code></a>. (Your code fails to initialize <code>iov</code> as well.)</p>\n\n<p>Here is a lightly-tested example that works in Linux (if using 2.6.29, 3.x, or later kernel).</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n\n\ntypedef struct {\n    struct sockaddr_in  source;\n    struct sockaddr_in  destination;\n    uint8_t            *payload;\n    int                 payload_len;        \n} ipv4_datagram;\n\nvoid process_ipv4_datagram(ipv4_datagram *const datagram)\n{\n    char  src_host[128], src_port[32];\n    char  dst_host[128], dst_port[32];\n    int   result, i;\n\n    src_host[0] = src_port[0] = '\\0';\n    dst_host[0] = dst_port[0] = '\\0';\n\n    result = getnameinfo((const struct sockaddr *)(&amp;datagram-&gt;source),\n                         sizeof (struct sockaddr_in),\n                         src_host, sizeof src_host,\n                         src_port, sizeof src_port,\n                         NI_NUMERICHOST | NI_NUMERICSERV);\n    if (result) {\n        fprintf(stderr, \"Warning: Cannot translate source address: %s.\\n\", gai_strerror(result));\n        fflush(stderr);\n    }\n\n    result = getnameinfo((const struct sockaddr *)(&amp;datagram-&gt;destination),\n                         sizeof (struct sockaddr_in),\n                         dst_host, sizeof dst_host,\n                         dst_port, sizeof dst_port,\n                         NI_NUMERICHOST | NI_NUMERICSERV);\n    if (result) {\n        fprintf(stderr, \"Warning: Cannot translate destination address: %s.\\n\", gai_strerror(result));\n        fflush(stderr);\n    }\n\n    printf(\"Received %d bytes,\\n\", datagram-&gt;payload_len);\n    printf(\"  From %s port %s\\n\", src_host, src_port);\n    printf(\"    To %s port %s\", dst_host, dst_port);\n    for (i = 0; i &lt; datagram-&gt;payload_len; i++)\n        if (i &amp; 15)\n            printf(\" %02x\", datagram-&gt;payload[i]);\n        else\n            printf(\"\\n\\t%02x\", datagram-&gt;payload[i]);\n    printf(\"\\n\");\n    fflush(stdout);\n}\n\nstatic volatile sig_atomic_t  done = 0;\n\nstatic void handle_done(int signum)\n{\n    __sync_bool_compare_and_swap(&amp;done, (sig_atomic_t)0, (sig_atomic_t)signum);\n}\n\nstatic int install_done(int signum)\n{\n    struct sigaction act;\n    memset(&amp;act, 0, sizeof act);\n    sigemptyset(&amp;act.sa_mask);\n    act.sa_handler = handle_done;\n    act.sa_flags = 0;\n    if (sigaction(signum, &amp;act, NULL) == -1)\n        return errno;\n    return 0;\n}\n\n\nint main(int argc, char *argv[])\n{\n    int socketfd = -1;\n\n    /* Verify command line parameters, and print usage if necessary.\n    */\n    if (argc &lt; 2 || argc &gt; 3 || !strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\")) {\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"Usage: %s [ -h | --help ]\\n\", argv[0]);\n        fprintf(stderr, \"       %s [ ADDRESS/HOST ] PORT\\n\", argv[0]);\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"This listens on IPv4 UDP connections, and reports on them.\\n\");\n        fprintf(stderr, \"Send INT (Ctrl+C), HUP, or TERM signal to exit.\\n\");\n        fprintf(stderr, \"\\n\");\n        return EXIT_FAILURE;\n    }\n\n    /* Install INT, TERM, and HUP signal handlers.\n     * They all set the 'done' flag if caught.\n    */\n    if (install_done(SIGINT) ||\n        install_done(SIGTERM) ||\n        install_done(SIGHUP)) {\n        fprintf(stderr, \"Cannot install signal handlers: %s.\\n\", strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    /* Open the listening socket. */\n    {\n        struct addrinfo *list = NULL, *curr, hints; \n        const char *node, *serv;\n        int result;\n\n        /* Empty or \"-\" or \"*\" address is the wildcard address. */\n        if (argc == 3) {\n            node = argv[1];\n            serv = argv[2];\n            if (node[0] == '\\0' || !strcmp(node, \"-\") || !strcmp(node, \"*\"))\n                node = NULL;\n        } else {\n            node = NULL;\n            serv = argv[1];\n        }\n\n        memset(&amp;hints, 0, sizeof hints);\n        hints.ai_family = AF_INET;\n        hints.ai_socktype = SOCK_DGRAM;\n        hints.ai_flags = AI_PASSIVE;\n        hints.ai_protocol = 0;\n        hints.ai_canonname = NULL;\n        hints.ai_addr = NULL;\n        hints.ai_next = NULL;\n        result = getaddrinfo(node, serv, &amp;hints, &amp;list);\n        if (result) {\n            if (node)\n                fprintf(stderr, \"%s %s: %s.\\n\", node, serv, gai_strerror(result));\n            else\n                fprintf(stderr, \"%s: %s.\\n\", serv, gai_strerror(result));\n            return EXIT_FAILURE;\n        }\n\n        result = 0;\n        socketfd = -1;\n        for (curr = list; curr != NULL; curr = curr-&gt;ai_next) {\n            socketfd = socket(curr-&gt;ai_family, curr-&gt;ai_socktype, curr-&gt;ai_protocol);\n            if (socketfd == -1)\n                continue;\n\n            if (bind(socketfd, curr-&gt;ai_addr, curr-&gt;ai_addrlen) == 0)\n                break;\n\n            result = errno;\n            close(socketfd);\n            socketfd = -1;\n        }\n\n        freeaddrinfo(list);\n\n        if (socketfd == -1) {\n            if (result)\n                fprintf(stderr, \"%s.\\n\", strerror(result));\n            else\n                fprintf(stderr, \"Cannot bind to socket.\\n\");\n            return EXIT_FAILURE;\n        }\n    }\n\n    /* Enable the IP_RECVORIGDSTADDR socket option. */\n    {\n        int flag = 1;\n        if (setsockopt(socketfd, IPPROTO_IP, IP_RECVORIGDSTADDR, &amp;flag, sizeof flag) == -1) {\n            fprintf(stderr, \"IP_RECVORIGDSTADDR not supported: %s.\\n\", strerror(errno));\n            close(socketfd);\n            return EXIT_FAILURE;\n        }\n    }\n\n    /* Receive datagram messages, until signaled.\n     * Note that signal delivery causes recvmsg() to return with -1, errno == EINTR.\n    */\n    while (!done) {\n        char    data_buffer[1024];\n        char    ancillary_buffer[1024];\n        ssize_t data_bytes;\n\n        ipv4_datagram   dgram;\n        struct msghdr   msg;\n        struct iovec    iov;\n        struct cmsghdr *cmsg;\n\n        iov.iov_base = data_buffer;\n        iov.iov_len = sizeof data_buffer;\n\n        msg.msg_name = &amp;(dgram.source);\n        msg.msg_namelen = sizeof dgram.source;\n        msg.msg_iov = &amp;iov;\n        msg.msg_iovlen = 1;\n        msg.msg_control = ancillary_buffer;\n        msg.msg_controllen = sizeof ancillary_buffer;\n        msg.msg_flags = 0;\n\n        memset(&amp;(dgram.source), 0, sizeof dgram.source);\n        memset(&amp;(dgram.destination), 0, sizeof dgram.destination);\n\n        data_bytes = recvmsg(socketfd, &amp;msg, 0);\n        if (data_bytes == (ssize_t)-1) {\n\n            /* Interrupted by a signal? */\n            if (errno == EINTR)\n                continue;\n\n            /* Other errors we can ignore? */\n            if (errno == EAGAIN || errno == EWOULDBLOCK ||\n                errno == ECONNREFUSED)\n                continue;\n\n            fprintf(stderr, \"Error receiving data: %s.\\n\", strerror(errno));\n            fflush(stderr);\n            break;\n        }\n\n        dgram.payload = (void *)data_buffer;\n        dgram.payload_len = data_bytes;\n\n        /* Find IP_ORIGDSTADDR ancillary message. */\n        for (cmsg = CMSG_FIRSTHDR(&amp;msg); cmsg != NULL; cmsg = CMSG_NXTHDR(&amp;msg, cmsg))\n            if (cmsg-&gt;cmsg_level == IPPROTO_IP &amp;&amp;\n                cmsg-&gt;cmsg_type == IP_ORIGDSTADDR)\n                memmove(&amp;dgram.destination, CMSG_DATA(cmsg), sizeof dgram.destination);\n\n        process_ipv4_datagram(&amp;dgram);\n    }\n\n    close(socketfd);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>This is an edited version to illustrate the use of the desired <code>ipv4_datagram</code> structure and <code>process_ipv4_datagram()</code> function.</p>\n\n<p>Compile it using e.g.</p>\n\n<pre><code>gcc -Wall -Wextra -O2 example.c -o example\n</code></pre>\n\n<p>If you run e.g.</p>\n\n<pre><code>./example host port\n</code></pre>\n\n<p>you can use Ctrl+C to instruct it to exit cleanly.\nUse e.g. netcat to test connections (from other machines on the same local network) using e.g.</p>\n\n<pre><code>date | nc -q 1 -u host port\n</code></pre>\n"}], "owner": {"reputation": 1931, "user_id": 1293036, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc6cb7617cbacf51bb5d11870f4e3d5c?s=128&d=identicon&r=PG", "display_name": "Pheonix7", "link": "https://stackoverflow.com/users/1293036/pheonix7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 34774002, "answer_count": 2, "score": 0, "last_activity_date": 1452712458, "creation_date": 1452686145, "last_edit_date": 1452686341, "question_id": 34766075, "link": "https://stackoverflow.com/questions/34766075/i-ported-code-from-freebsd-to-linux-but-it-doesnt-extract-destination-address", "title": "I ported code from FreeBSD to Linux but it doesn&#39;t extract destination address", "body": "<p>This C code extracts source and destination IPv4 addresses on a FreeBSD system from a socket. I ported it to Linux and it works only partially. It prints the source address of the pk correctly but not the destination address of the pk (which would be the IP address of my machine). I always get a destination address of <code>0.0.0.0</code>.</p>\n\n<p>How do I change the code to make it also extract/print the destination address?</p>\n\n<pre><code>static void* start_controlpackets_demuxer_ipv4(void* arg) {\n    int r;\n\n    struct addrinfo hints;\n    memset(&amp;hints, 0, sizeof(hints));\n    hints.ai_family = AF_INET;\n    hints.ai_socktype = SOCK_DGRAM;\n    hints.ai_flags = AI_PASSIVE;\n\n    struct addrinfo* sorter_addr;\n    r = getaddrinfo(NULL, LISP_CONTROL_PORT, &amp;hints, &amp;sorter_addr);\n    if (r != 0) {\n        fatalr(\"Unable to get westbound IPv4 listener address\", r);\n    }\n\n    struct addrinfo* curr_addr;\n    int s;\n    for (curr_addr = sorter_addr; curr_addr != NULL; curr_addr = curr_addr-&gt;ai_next) {\n        s = socket(curr_addr-&gt;ai_family, curr_addr-&gt;ai_socktype, curr_addr-&gt;ai_protocol);\n        if (s == -1) {\n            continue;\n        }\n\n        r = bind(s, curr_addr-&gt;ai_addr, curr_addr-&gt;ai_addrlen);\n        if (r == -1) {\n            continue;\n        }\n\n        freeaddrinfo(sorter_addr);\n        break;\n    }\n\n    if (curr_addr == NULL) {\n        fatal(\"Unable to bind westbound IPv4 listener\");\n    }\n\n    ipv4_controlpackets_socket = s;\n\n    debug_printf(\"IPv4 westbound server is listening\");\n\n    /*\n     * The datagram is kept in the stack space. Should the processing be offloaded to a pool of worker threads,\n     * it will be necessary to move it to the heap.\n     */\n    uint8_t buf[IP_MAXLEN];\n    char control_buf[SOCK_MSG_CONTROL_LEN];\n\n    int opt = 1;\n    setsockopt(s, IPPROTO_IP, IP_RECVDSTADDR, &amp;opt, sizeof(opt));\n\n    while (1) {\n        ipv4_datagram datagram;\n        datagram.payload = buf;\n\n        struct msghdr raw_msg;\n        struct iovec iov;\n\n        raw_msg.msg_name = &amp;(datagram.source);\n        raw_msg.msg_namelen = sizeof(datagram.source);\n        raw_msg.msg_iov = &amp;iov;\n        raw_msg.msg_iovlen = 1;\n        raw_msg.msg_iov-&gt;iov_base = datagram.payload;\n        raw_msg.msg_iov-&gt;iov_len = IP_MAXLEN;\n        raw_msg.msg_control = (caddr_t) &amp;control_buf;\n        raw_msg.msg_controllen = SOCK_MSG_CONTROL_LEN;\n        raw_msg.msg_flags = 0;\n\n        datagram.payload_len = recvmsg(s, &amp;raw_msg, 0);\n\n        if (datagram.payload_len &lt; 0) {\n            fatal(\"Error reading from westbound IPv4 socket\");\n        }\n\n        for (struct cmsghdr *c = CMSG_FIRSTHDR(&amp;raw_msg); c != NULL; c = CMSG_NXTHDR(&amp;raw_msg, c)) {\n            if (c-&gt;cmsg_level != IPPROTO_IP || c-&gt;cmsg_type != IP_RECVDSTADDR) {\n                continue;\n            }\n\n            struct in_addr* tmp_destination = (struct in_addr*) CMSG_DATA(c);\n\n            memset(&amp;(datagram.destination), 0, sizeof(datagram.destination));\n#ifndef LINUX_OS\n            datagram.destination.sin_len = sizeof(datagram.destination);\n#endif\n            datagram.destination.sin_family = AF_INET;\n            datagram.destination.sin_addr = *tmp_destination;\n        }\n\n        char src[INET_ADDRSTRLEN];\n        inet_ntop(AF_INET, &amp;(datagram.source.sin_addr), src, INET_ADDRSTRLEN);\n        char dst[INET_ADDRSTRLEN];\n        inet_ntop(AF_INET, &amp;(datagram.destination.sin_addr), dst, INET_ADDRSTRLEN);\n        debug_printf(\"Processing UDPv4 datagram from %s to %s\", src, dst);\n\n        process_ipv4_datagram(&amp;datagram);\n    }\n\n    pthread_exit(0);\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "cs50"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1452684943, "post_id": 34765495, "comment_id": 57276237, "body": "<code>int array[2][2] = {{1,2,3},{4,5,6},{7,8,9}};</code> is just wrong, use <code>int array[3][3] = {{1,2,3},{4,5,6},{7,8,9}};</code> (you&#39;re declaring an array of 3 <code>int[3]</code> arrays. arrays decay into pointers when passed to functions, so you&#39;re passing an argument of the type <code>int (*)[]</code> (pointer to an array of ints), not an <code>int[]</code> or <code>int *</code>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1452685647, "post_id": 34765661, "comment_id": 57276678, "body": "Since the rule for function parameters is that &quot;array of type will decay into pointer to type, pointing at first element&quot;, I think it is more readable to declare the parameter as <code>int array[3][3]</code>. It will decay into a pointer to first element <code>int(*)[3]</code> anyhow."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1452685848, "post_id": 34765661, "comment_id": 57276800, "body": "I always write what it is i.e. <code>void func( int *a) {..}</code> not <code>void func( int a[]) {..}</code> despite both of them are equivalent. I suppose it&#39;s a matter of taste."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1452686304, "post_id": 34765661, "comment_id": 57277105, "body": "Specifying the inner-most dimension has one advantage though: it creates self-documenting code saying &quot;this function will handle a 3x3 array&quot;, which is more specific. It could also help with static analysis beyond what&#39;s required of the C compiler - suppose someone passes a 4x3 array to the function. A static code analyser could then tell that something is fishy, which it wouldn&#39;t be able to otherwise."}, {"owner": {"reputation": 4045, "user_id": 2809288, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/490f0f474e998feb911ab7aaf948609b?s=128&d=identicon&r=PG&f=1", "display_name": "Wet Feet", "link": "https://stackoverflow.com/users/2809288/wet-feet"}, "edited": false, "score": 0, "creation_date": 1452689617, "post_id": 34765661, "comment_id": 57279294, "body": "Thanks for the answer! One more question, when I try to create the array in main by doing <code>int array[size][size] = {{1,2,3},{4,5,6},{7,8,9}};</code>, I get an error saying ` error: variable-sized object may not be initialized`. Why is that so?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 4045, "user_id": 2809288, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/490f0f474e998feb911ab7aaf948609b?s=128&d=identicon&r=PG&f=1", "display_name": "Wet Feet", "link": "https://stackoverflow.com/users/2809288/wet-feet"}, "edited": false, "score": 1, "creation_date": 1452691032, "post_id": 34765661, "comment_id": 57280237, "body": "@WetFeet 1) You need a C99 compiler. E.g. With gcc you can do with <code>gcc -std=c99 file.c</code>. 2) You can&#39;t <i>initialize</i> a <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">VLA</a>. You can define it: <code>int size = 3; int a[size][size];</code> and then use a loop to assign values."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1452684957, "creation_date": 1452684957, "answer_id": 34765661, "question_id": 34765495, "link": "https://stackoverflow.com/questions/34765495/passing-multidimensional-arrays-as-arguments-in-functions-in-c/34765661#34765661", "title": "Passing multidimensional arrays as arguments in functions in C", "body": "<p>The function <code>func()</code> expects a <em>pointer to int</em> but you are passing a <em>pointer to an array</em>. Hence, the errrors.\nIt's because an array gets converted into a pointer to its first element when you pass it to a function.</p>\n\n<p>You can change the function prototype and definition to receive a pointer to an array:</p>\n\n<pre><code>void func(int (*array)[3], int size);\n\nint main()\n{\n    int size = 3;\n    int array[3][3] = {{1,2,3},{4,5,6},{7,8,9}};\n    func(array,size);\n    printf(\"Done\");\n}\n\nvoid func(int (*array)[3], int size) {\n  ...\n}\n</code></pre>\n\n<p>Note that your array is initialized with size 3x3. So the array size has to 3x3 at least.</p>\n\n<hr>\n\n<p>C99 allows to you pass dimensions. So you can write it like this too:</p>\n\n<pre><code>void func(int x, int y, int a[x][y]);\n\nint main()\n{\n    int size = 3;\n    int array[3][3] = {{1,2,3},{4,5,6},{7,8,9}};\n    func(3, 3, array);\n    printf(\"Done\");\n}\n\nvoid func(int x, int y, int array[x][y])\n{\n    printf(\"%i %i %i\\n\", array[0][0],array[1][1], array[2][2]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 0, "last_activity_date": 1584885053, "last_edit_date": 1584885053, "creation_date": 1452684993, "answer_id": 34765678, "question_id": 34765495, "link": "https://stackoverflow.com/questions/34765495/passing-multidimensional-arrays-as-arguments-in-functions-in-c/34765678#34765678", "title": "Passing multidimensional arrays as arguments in functions in C", "body": "<p>You need to specify size of array <em>when declaring prototype as well as while defining function</em> . Right now it is of incomplete type . </p>\n\n<p>Try this instead -</p>\n\n<pre><code>void func(int array[][3], int size)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 0, "last_activity_date": 1452685248, "creation_date": 1452685248, "answer_id": 34765789, "question_id": 34765495, "link": "https://stackoverflow.com/questions/34765495/passing-multidimensional-arrays-as-arguments-in-functions-in-c/34765789#34765789", "title": "Passing multidimensional arrays as arguments in functions in C", "body": "<p>A declaration like <code>int a[][]</code> isn't sensible, since the compiler must know the size of all dimensions (except of the outermost) to calculate the memory address on access.</p>\n\n<p>I.e. if an array is declared as</p>\n\n<pre><code>int array[][a][b];\n</code></pre>\n\n<p>The memory address for access to</p>\n\n<pre><code>array[2][1][3];\n</code></pre>\n\n<p>is calculated by</p>\n\n<pre><code>base_address + (2*a*b + 1*b + 3) * sizeof int\n</code></pre>\n\n<p>Without knowing a and/or b, this calculation would not be possible.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1452685307, "creation_date": 1452685307, "answer_id": 34765812, "question_id": 34765495, "link": "https://stackoverflow.com/questions/34765495/passing-multidimensional-arrays-as-arguments-in-functions-in-c/34765812#34765812", "title": "Passing multidimensional arrays as arguments in functions in C", "body": "<p>Simply tell the function to expect a multi-dimensional array:</p>\n\n<pre><code>void func (int array[3][3], int size);\n</code></pre>\n\n<p>Or if you want the function to be completely flexible:</p>\n\n<pre><code>void func (int x, int y, int array[x][y]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 344, "user_id": 4618003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e8f098af732d64e92365592e685a3c?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4618003/bernhard"}, "edited": false, "score": 0, "creation_date": 1453643454, "post_id": 34769320, "comment_id": 57682520, "body": "You may read my article on this topic which explains the problem and the solution in detail: <a href=\"https://www.cypherpunk.at/2016/01/passing-arrays-as-parameter-in-c/\" rel=\"nofollow noreferrer\">Passing Arrays in C</a>."}], "tags": [], "owner": {"reputation": 344, "user_id": 4618003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e8f098af732d64e92365592e685a3c?s=128&d=identicon&r=PG", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4618003/bernhard"}, "is_accepted": false, "score": 1, "last_activity_date": 1452695525, "creation_date": 1452695525, "answer_id": 34769320, "question_id": 34765495, "link": "https://stackoverflow.com/questions/34765495/passing-multidimensional-arrays-as-arguments-in-functions-in-c/34769320#34769320", "title": "Passing multidimensional arrays as arguments in functions in C", "body": "<p>An array is not a type in C! Internally, it is always handled as a pointer, hence, a pointer to the array is passed as argument and not the array itself.</p>\n\n<p>If you intend to pass arrays as arguments (and not just pointers), you should rethink your design!</p>\n\n<p>If you still need to do this wrap the array into a structure and pass the structure.</p>\n\n<pre><code>struct astruct\n{\n   int size;\n   int array[3];\n};\n</code></pre>\n"}], "owner": {"reputation": 4045, "user_id": 2809288, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/490f0f474e998feb911ab7aaf948609b?s=128&d=identicon&r=PG&f=1", "display_name": "Wet Feet", "link": "https://stackoverflow.com/users/2809288/wet-feet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 34765661, "answer_count": 5, "score": 0, "last_activity_date": 1584885053, "creation_date": 1452684508, "last_edit_date": 1584884994, "question_id": 34765495, "link": "https://stackoverflow.com/questions/34765495/passing-multidimensional-arrays-as-arguments-in-functions-in-c", "title": "Passing multidimensional arrays as arguments in functions in C", "body": "<p>I am currently doing the fifteen exercise in CS50's Problem set 3. However, I am stuck in figuring out the syntax to pass a multi-dimensional array as an argument to a function. For instance, the following code (which prints out some numbers in an array) compiles and works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(int array[], int size);\n\nint main()\n{\n    int size = 3;\n    int array[3] = {1,2,3};\n    func(array,size);\n    printf(\"Done\\n\");\n}\n\nvoid func(int array[], int size)\n{\n    printf(\"%i %i %i\\n\", array[0],array[1], array[2]);\n}\n</code></pre>\n\n<p>But this doesn't:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(int array[][], int size);\n\nint main()\n{\n    int size = 3;\n    int array[3][3] = {{1,2,3},{4,5,6},{7,8,9}};\n    func(array,size);\n    printf(\"Done\");\n}\n\nvoid func(int array[][], int size)\n{\n    printf(\"%i %i %i\\n\", array[0][0],array[1][1], array[2][2]);\n}\n</code></pre>\n\n<p>This is the error provided by clang:</p>\n\n<pre><code>test.c:3:20: error: array has incomplete element type 'int []'\nvoid func(int array[][], int size);\n                   ^\ntest.c:13:20: error: array has incomplete element type 'int []'\nvoid func(int array[][], int size)\n</code></pre>\n\n<p>Can anyone explain to me what's wrong with my syntax? I don't quite understand the error messages given to me by clang.</p>\n"}, {"tags": ["c", "visual-studio", "main"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452683827, "post_id": 34765207, "comment_id": 57275464, "body": "Two files with <i>exactly</i> same source....what you&#39;re upto?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452685875, "post_id": 34765207, "comment_id": 57276818, "body": "Don&#39;t post images. And think about why it is called &quot;<b>one</b> project&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1452683771, "creation_date": 1452683771, "answer_id": 34765232, "question_id": 34765207, "link": "https://stackoverflow.com/questions/34765207/main-function-already-defined-in-visual-studio-project/34765232#34765232", "title": "Main function already defined in visual studio project", "body": "<p>Yes, you are wrong. IIRC, the whole <em>project</em> is compiled and then linked to form a single executable.</p>\n\n<p>In a single executable, there can be only one <code>main()</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 5356383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sIrMI.jpg?s=128&g=1", "display_name": "yasserkabbout", "link": "https://stackoverflow.com/users/5356383/yasserkabbout"}, "is_accepted": false, "score": 1, "last_activity_date": 1452683936, "creation_date": 1452683936, "answer_id": 34765283, "question_id": 34765207, "link": "https://stackoverflow.com/questions/34765207/main-function-already-defined-in-visual-studio-project/34765283#34765283", "title": "Main function already defined in visual studio project", "body": "<p>These two <code>main</code> functions are within the same Project. You should have only one <code>main</code> function in your program. </p>\n\n<p>Try to implement a <code>new project</code>, and then add the <code>main</code> function in there.</p>\n"}], "owner": {"reputation": 1, "user_id": 5649496, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eZOFRTIME-0/AAAAAAAAAAI/AAAAAAAAFlY/LJJz_1QjLzM/photo.jpg?sz=128", "display_name": "Hyensoo Choi", "link": "https://stackoverflow.com/users/5649496/hyensoo-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 34765232, "answer_count": 2, "score": -1, "last_activity_date": 1452910364, "creation_date": 1452683662, "last_edit_date": 1452910364, "question_id": 34765207, "link": "https://stackoverflow.com/questions/34765207/main-function-already-defined-in-visual-studio-project", "title": "Main function already defined in visual studio project", "body": "<p>I created windows console program project in visual studio, and made two c language files. Both has same source:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main() {\n    printf(\"hello\");\n}\n</code></pre>\n\n<p>When I try to compile, compiler screams about having two <code>main()</code>s. See below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aUt2M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aUt2M.png\" alt=\"enter image description here\"></a></p>\n\n<p>I can't understand. I thought two files in one project works separately. Am I wrong?</p>\n"}, {"tags": ["c", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452683659, "post_id": 34765179, "comment_id": 57275345, "body": "Welcome to Stack Overflow! You mind creating an <a href=\"http://stackoverflow.com/help/mcve\"><b><i>MCVE</i></b></a>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452683856, "post_id": 34765179, "comment_id": 57275494, "body": "Also, learn to use a debugger like <code>gdb</code> and step through your code to pinpoint the errorneous instruction."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1452683893, "post_id": 34765179, "comment_id": 57275524, "body": "Learn how to use a debugger. When you run in a debugger it will stop at the location of the crash, and let you examine (and walk up) the function call stack, and let you examine the values of involved variables. At the very least please edit your question to show us where the crash actually happens in <i>your</i> code."}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1452684329, "post_id": 34765179, "comment_id": 57275808, "body": "@PelZa I wouldn&#39;t focus on makeRandomTree(), with <i>random</i> numbers you may have <i>unexpected</i> sequences..."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1452685220, "post_id": 34765179, "comment_id": 57276419, "body": "All of the above + <i>Please don&#39;t cast the return of <code>malloc</code> &amp; co</i>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1452685851, "post_id": 34765179, "comment_id": 57276804, "body": "If your question is &#39;how do you debug a segmentation fault&quot;, why post all that code?"}], "answers": [{"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1452684659, "post_id": 34765492, "comment_id": 57276022, "body": "Yep, confirmed with a Valgrind run-through. Now quick, what is the chance of all nine child node valuess being either smaller or bigger than the root value. <code>;)</code>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1452684730, "post_id": 34765492, "comment_id": 57276076, "body": "Repost to math.stackexchange.com ;)"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 4, "last_activity_date": 1452684502, "creation_date": 1452684502, "answer_id": 34765492, "question_id": 34765179, "link": "https://stackoverflow.com/questions/34765179/malloc-call-in-function-segmentation-fault-11/34765492#34765492", "title": "malloc() call in function - segmentation fault: 11", "body": "<p>The tree handling code looks ok in general, but this could be a problem:</p>\n\n<pre><code>printf(\"'NodeValue' of left child of root is %i\\n\", tree-&gt;leftChild-&gt;nodeValue);\nprintf(\"'NodeValue' of right child of root is %i\\n\", tree-&gt;rightChild-&gt;nodeValue);\n</code></pre>\n\n<p>If the tree by chance does not have a left or right child, you try to dereference a <code>NULL</code>-pointer.\nGuard it by <code>if (tree-&gt;leftChild) ...</code></p>\n"}], "owner": {"reputation": 11, "user_id": 5783830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5197420c290ab966150581cd1bcb1cc3?s=128&d=identicon&r=PG&f=1", "display_name": "PelZa", "link": "https://stackoverflow.com/users/5783830/pelza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 34765492, "answer_count": 1, "score": 0, "last_activity_date": 1452684502, "creation_date": 1452683607, "question_id": 34765179, "link": "https://stackoverflow.com/questions/34765179/malloc-call-in-function-segmentation-fault-11", "title": "malloc() call in function - segmentation fault: 11", "body": "<p>I'm a C-beginner and have just tried to implement a makeRandomTree()-function to randomly create a binary tree.</p>\n\n<p>Although compilation was successful sometimes (not always!) the program exits with error \"Segmentation fault: 11\" at runtime. I presume the error is located in makeRandomNode()-function, where the dynamic memory allocation with malloc() is situated. Unfortunately I wasn't able to find the error yet.</p>\n\n<p>I hope someone could help me =)</p>\n\n<p>Here's the source code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define NUMBER_OF_NODES 10\n#define RANDOM_NUMBER_MAX 99\n\nstruct node {\n    int nodeValue;\n    struct node *parentNode;\n    struct node *leftChild;\n    struct node *rightChild;\n};\n\ntypedef struct node node;\n\nnode* makeRandomNode(unsigned int *randomSeed) {\n    //random number in the range [0;RANDOM_NUMBER_MAX]\n    int random = (rand_r(randomSeed) % (RANDOM_NUMBER_MAX + 1));\n\n    node *newNode = (node *) malloc(sizeof(node));\n\n    newNode-&gt;nodeValue = random;\n    newNode-&gt;parentNode = NULL;\n    newNode-&gt;leftChild = NULL;\n    newNode-&gt;rightChild = NULL;\n\n    return newNode;\n}\n\nvoid insertNode(node *root, node *newNode) {\n    if (newNode-&gt;nodeValue &lt;= root-&gt;nodeValue) {\n        if (root-&gt;leftChild == NULL) {\n            root-&gt;leftChild = newNode;\n            newNode-&gt;parentNode = root;\n        }\n        else {\n            insertNode(root-&gt;leftChild, newNode);\n        }\n    }\n    else {\n        if (root-&gt;rightChild == NULL) {\n            root-&gt;rightChild = newNode;\n            newNode-&gt;parentNode = root;\n        }\n        else {\n            insertNode(root-&gt;rightChild, newNode);\n        }\n    }\n}\n\nnode* makeRandomTree(int numberOfNodes) {\n    int i;\n    unsigned int randomSeed;\n    node *root;\n    node *newNode;\n\n    randomSeed = time(NULL);\n    root = makeRandomNode(&amp;randomSeed);\n\n    for (i = 1; i &lt; numberOfNodes; i++) {\n        newNode = makeRandomNode(&amp;randomSeed);  \n        insertNode(root, newNode);\n    }\n\n    return root;\n}\n\nint main(int argc, char *argv[]) {\n    node *tree = makeRandomTree(NUMBER_OF_NODES);\n\n    printf(\"A random-binary-tree with %i nodes was created successfully!!!\\n\", NUMBER_OF_NODES);\n    printf(\"'NodeValue' of root is %i\\n\", tree-&gt;nodeValue);\n    printf(\"'NodeValue' of left child of root is %i\\n\", tree-&gt;leftChild-&gt;nodeValue);\n    printf(\"'NodeValue' of right child of root is %i\\n\", tree-&gt;rightChild-&gt;nodeValue);\n    printf(\"etc.\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "function", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1452683576, "post_id": 34765135, "comment_id": 57275292, "body": "Please read a book on C for how to call a C function. Thanks."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1452683618, "post_id": 34765135, "comment_id": 57275316, "body": "<code>fflush(stdin);</code> is undefined behaviour."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1452683630, "post_id": 34765135, "comment_id": 57275324, "body": "<code>gets()</code> is dangeroous, use <code>fgets()</code> instead."}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 5, "creation_date": 1452683655, "post_id": 34765135, "comment_id": 57275343, "body": "<code>for (i=0; i = 10; i++)</code> is very strange"}, {"owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 1, "creation_date": 1452685490, "post_id": 34765135, "comment_id": 57276579, "body": "It would be better if the output statements are written in english. Can&#39;t understand whats happening.:("}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1452688579, "creation_date": 1452688579, "answer_id": 34766932, "question_id": 34765135, "link": "https://stackoverflow.com/questions/34765135/c-function-to-write-data-with-for-and-scanf/34766932#34766932", "title": "C function to write data with for and scanf", "body": "<pre><code>case 4:\n    QuantidadeMusicos;  \n    break; \n</code></pre>\n\n<p>doesn't call the function.</p>\n\n<p>To call the function do</p>\n\n<pre><code>case 4:\n    QuantidadeMusicos(elemento);  \n    break; \n</code></pre>\n\n<p>and also fix:</p>\n\n<pre><code>for (i=0; i = 10; i++)  // endless loop !!\n</code></pre>\n\n<p>to be</p>\n\n<pre><code>for (i=0; i &lt; 10; i++)  // Loop will repeat 10 times\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4972993, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c797d3ac70ab7b0b8a24e39c30b58c3c?s=128&d=identicon&r=PG&f=1", "display_name": "BugaDroid", "link": "https://stackoverflow.com/users/4972993/bugadroid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1452688579, "creation_date": 1452683467, "last_edit_date": 1452688290, "question_id": 34765135, "link": "https://stackoverflow.com/questions/34765135/c-function-to-write-data-with-for-and-scanf", "title": "C function to write data with for and scanf", "body": "<p>I have a case where if \"5\" is selected then a function is called to write a field from a struct, in this case the name.</p>\n\n<p><strong>Variable:</strong></p>\n\n<pre><code>void QuantidadeMusicos (Elementos *elementos);\n</code></pre>\n\n<p><strong>CASE</strong></p>\n\n<pre><code>case 4:\n                QuantidadeMusicos;  \n                break;  \n</code></pre>\n\n<p><strong>FUNCTION:</strong></p>\n\n<pre><code>void QuantidadeMusicos (Elementos *elementos) {\nfor (i=0; i = 10; i++)\n{\n    //if\n    printf (\"Elemento %d: %s\", i, elementos[i].nome);\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>FULL CODE</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* run this program using the console pauser or add your own getch,\n    system(\"pause\") or input loop */\n\n//Estrutura para recolher os elementos\n\ntypedef struct elementos\n{\n  char nome [30 + 1];\n  int idade;\n  char PapelNaBanda [30 + 1];\n}Elementos;\n\n//Estrutura para recolher as musicas\n\ntypedef struct musicas\n{\n  char nome [30 + 1];\n  int AnoLancamento;\n  char album [30 + 1];\n}Musicas;\n\nint opcao;\nElementos elemento[1000];\nint i,n;\nchar nomeProcurar[100];\nint posicaoEncontrada;\nint menuElementos;\nvoid QuantidadeMusicos (Elementos *elementos);\nvoid QuantidadeMusicas (Musicas *musica);\nint GetPosicao(int *array, int nomeProcurar, int n);\n\nint main(int argc, char *argv[]) {\n  do\n  {\n    //Menu\n    system(\"cls\");\n    printf(\"1 - Inserir elemento\\n\");\n    printf(\"2 - Alterar elemento\\n\");\n    printf(\"3 - Remover elemento\\n\");\n    printf(\"4 - Quantidade de musicos que compoem a banda\\n\");\n    printf(\"5 - Quantidade de musicas\\n\");\n    printf(\"6 - Media das idades dos elementos\\n\");\n    printf(\"7 - Musico mais novo e mais velho\\n\");\n    printf(\"8 - Pesquisa por elemento (nome)\\n\");\n    printf(\"9 - Pesquisa de elementos por papel desempenhado na banda\\n\");\n    printf(\"10 - Relatorio de elementos ordenado ascendentemente pelo nome\\n\");\n    printf(\"11 - Relatorio de elementos com idade superior a media\\n\");\n    printf(\"12 - Relatorio de musicas com agrupamento por ano de lancamento\\n\");\n    printf(\"13 - Relatorio de musicas ordenadas descendentemente pelo nome\\n\");\n    printf(\"14 - Datas dos concertos\\n\");\n    printf(\"15 - Despesas e lucros\\n\");\n    printf(\"Qual a opcao: ?\");  \n    scanf(\"%d\", &amp;opcao);\n    system(\"cls\");\n\n\n    switch(opcao)\n    {\n      case 1:\n          printf(\"1- Inserir elemento\\n\");\n          printf(\"2- Alterar elemento\\n\");\n          printf(\"1- Remover elemento\\n\");\n          printf(\"Escolha uma op\u00e7\u00e3o:\");\n          scanf (\"%d\", &amp;menuElementos);\n          system(\"cls\");\n          fflush(stdin);\n\n          switch(menuElementos)\n          {\n            case 1:\n                printf(\"Quantos elementos a inserir: ?\");\n                scanf(\"%d\", &amp;n);\n\n                for (i = 0; i &lt; n; i++)\n                {\n                  printf(\"Nome do %d elemento: \", i + 1 );\n                  fflush(stdin);\n                  gets(elemento[i].nome);\n                  fflush(stdin);\n                  printf(\"Idade: \");\n                  scanf(\"%d\",&amp;elemento[i].idade);\n                  fflush(stdin);\n                  printf(\"Papel na banda: \");\n                  gets(elemento[i].PapelNaBanda);\n                  fflush(stdin);  \n                } break;\n\n            case 4:\n                QuantidadeMusicos;\n                break;\n\n            case 5:\n                QuantidadeMusicas;  \n                break;  \n          }\n    }\n  }while(opcao != 0);  \n} \n\n\n\nint GetPosicao ( int *array, int nomeProcurar, int n)\n{\n  int posicaoEncontrada = -1, i;\n\n  for(i = 0; i &lt; n; i++)\n  {\n    if(array[i] == nomeProcurar)\n    {\n      posicaoEncontrada = i;\n      break;\n    }\n  }\n  return posicaoEncontrada;\n}\n\n// FUN\u00c7\u00d5ES\n\n\nvoid QuantidadeMusicos (Elementos *elementos) {\n  for (i=0; i = 10; i++)\n  {\n    //if\n    printf (\"Elemento %d: %s\", i, elementos[i].nome);\n  }\n}\n\nvoid QuantidadeMusicas (Musicas *musicas) {\n  for (i=0; i = 50; i++)\n  {\n    // if\n    printf (\"Elemento %d: %s\",i, musicas[i].nome);\n  }\n}   \n</code></pre>\n\n<p>It does nothing.</p>\n"}, {"tags": ["c", "getopt-long"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683084, "post_id": 34764923, "comment_id": 57274916, "body": "Is the number of arguments for the <code>--command</code> option fixed?"}, {"owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683188, "post_id": 34764923, "comment_id": 57274997, "body": "Lets say it is not. I feel like it can work with fixed number of arguments, but  it might cause some troubles later on."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683242, "post_id": 34764923, "comment_id": 57275037, "body": "If the number of arguments is unbounded, how do you tell an argument to <code>--command</code> from the next option or operand?"}, {"owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683465, "post_id": 34764923, "comment_id": 57275215, "body": "Not entirely sure, I was thinking since the input will look something like this  ./testProgram --option1 a --command z x c v --option2 b  there must be a way to get the arguments of command option since they do not start with -- and the next thing after arguments start with -- ."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683541, "post_id": 34764923, "comment_id": 57275270, "body": "Are you sure they can&#39;t start with <code>--</code>? It might be better to make <code>--command</code> so it has a terminator. Also, what happens if operands (non-options) follow <code>--command</code>?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683844, "post_id": 34764923, "comment_id": 57275481, "body": "Does your program take operands in addition to options? If it doesn&#39;t, you can just put the arguments to <code>--command</code> as operands to the program."}, {"owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452683923, "post_id": 34764923, "comment_id": 57275542, "body": "Not sure I understood what you said. My options( such as command and so on) will always start with --(like --command --pipe and so on) their arguments however do not have dashes in front. so when non-options follow --command they are the arguments for that option. So yes, my program takes operands in addition to options."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452684057, "post_id": 34764923, "comment_id": 57275633, "body": "\u201coperands\u201d are non-options. For example, when I type <code>ls -l -a &#47;home&#47;fuz &#47;var&#47;log</code>, then <code>-l</code> and <code>-a</code> are options, <code>&#47;home&#47;fuz</code> and <code>&#47;var&#47;log</code> are operands. GNU getopt_long has the quirk that it likes to reorder the argument list. This is going to make implementing what you want somewhat tricky, which is why I&#39;m trying to find different ways to get the desired functionality."}, {"owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452684602, "post_id": 34764923, "comment_id": 57275977, "body": "I do not think I can accept options and operands in any other form than that. If possible please elaborate a little more about the info that it reorder the argument list. Also if possible tell me about a possible solution or point to somewhere where I can read about this. I read the man page for 3 times at this point and still no luck with options with multiple operands."}, {"owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452684906, "post_id": 34764923, "comment_id": 57276202, "body": "Also if it is much simpler to assume that command option will have constant number of arguments, I will be quite happy with that as well at this poing."}, {"owner": {"reputation": 808, "user_id": 3867500, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CusjO.png?s=128&g=1", "display_name": "Abhishek Choubey", "link": "https://stackoverflow.com/users/3867500/abhishek-choubey"}, "edited": false, "score": 0, "creation_date": 1452685186, "post_id": 34764923, "comment_id": 57276398, "body": "you can pass all the arguments in a string separated by some character (-, +, space....). Something like :        --command &quot;arg1-arg2-arg3&quot;,......... and then parse the string in your program."}, {"owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "edited": false, "score": 0, "creation_date": 1452685344, "post_id": 34764923, "comment_id": 57276479, "body": "Abhishek the problem here is that the input to a program is well defined and I cannot call the program in the way that you described..."}, {"owner": {"reputation": 1, "user_id": 5780009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd377f295f5e95ce09cacc4b858f6411?s=128&d=identicon&r=PG&f=1", "display_name": "deviouswhisperingchicken", "link": "https://stackoverflow.com/users/5780009/deviouswhisperingchicken"}, "edited": false, "score": 0, "creation_date": 1464094480, "post_id": 34764923, "comment_id": 62334621, "body": "I believe this is a duplicate question. You can find answers <a href=\"http://stackoverflow.com/a/37414143/5780009\">here</a>"}], "owner": {"reputation": 703, "user_id": 5602142, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c9ecc1e4538ad23866326a47ca13be83?s=128&d=identicon&r=PG&f=1", "display_name": "Saik", "link": "https://stackoverflow.com/users/5602142/saik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 593, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452682873, "creation_date": 1452682873, "question_id": 34764923, "link": "https://stackoverflow.com/questions/34764923/c-parsing-command-line-options-with-multiple-arguments-with-getopt-long", "title": "c- parsing command line options with multiple arguments with getopt_long", "body": "<p>I am new to c programming using command line arguments so despite finding few simmilar posts I am still stuck on this problem.</p>\n\n<p>I need to pass a command line option that have more than 1 argument, for example</p>\n\n<p>./testProgram --command arg1 arg2 arg3</p>\n\n<p>here is my code </p>\n\n<pre><code> static struct option long_options[] = {\n        {\"rdonly\",     required_argument, 0,   'a'},\n        {\"wronly\",     required_argument, 0,   'b'},\n        {\"command\",    required_argument, 0,   'c'},\n        {\"verbose\",    no_argument,       0,   'd'},\n        {0,0,0,0}\n      };\n\n\n c=getopt_long(argc,argv, \"\", long_options, &amp;option_index);\n\n      if(c == -1)\n        break;\n\n      switch(c) {\n      case 'a':\n          rdonly(fd,optarg);\n        break;\n\n      case 'b':\n        wronly(fd,optarg);\n        break;\n\n      case 'c':\n        command(optind,optarg,argc,argv);\n        break;\n\n      case 'd':\n        printf(\"its verbose\\n\");\n        break;\n\n      default:\n        printf(\"WRONG OPTION\\n\");\n      }\n    }\n\n\n//command function\n\nint command(int optind, char *optarg, int argc, char* argv)\n{\n\n  printf(\"Its option command with argument %s\\n\",optarg);\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1452682841, "post_id": 34764892, "comment_id": 57274737, "body": "<code>convert</code>???? or represent? or print???"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452682852, "post_id": 34764892, "comment_id": 57274747, "body": "Please show your research effort till time. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 497, "user_id": 2152227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d5322aa9740e50072fd2cca9db64a28?s=128&d=identicon&r=PG", "display_name": "Ronnie", "link": "https://stackoverflow.com/users/2152227/ronnie"}, "edited": false, "score": 0, "creation_date": 1452683134, "post_id": 34764892, "comment_id": 57274954, "body": "printf(&quot;%0.1f&quot;, var_flt);"}, {"owner": {"reputation": 45, "user_id": 4783547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00677b8d9049ebf0df786f301270c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Mohamed Ashraf", "link": "https://stackoverflow.com/users/4783547/ahmed-mohamed-ashraf"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452683455, "post_id": 34764892, "comment_id": 57275208, "body": "@SouravGhosh  just convert i&#39;m working with microcontroller no need to print."}], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1452683826, "last_edit_date": 1452683826, "creation_date": 1452683452, "answer_id": 34765123, "question_id": 34764892, "link": "https://stackoverflow.com/questions/34764892/converting-a-float-with-many-decimal-places-to-a-float-with-one-decimal-place-on/34765123#34765123", "title": "Converting a float with many decimal places to a float with one decimal place only", "body": "<p>You can use the <a href=\"http://en.cppreference.com/w/c/numeric/math/fmod\" rel=\"nofollow\"><code>fmodf</code></a> function in the standard <code>math.h</code> header.  </p>\n\n<p><a href=\"https://ideone.com/aWD1gt\" rel=\"nofollow\">Then subtract the result from the original</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main(void) {\n    float f = 4.9182;\n    printf(\"%f\", f - fmodf(f, 0.1));\n    return 0;\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>I see from your comment that you are on a freestanding environment. So no standard library. But you can probably whip up you own function by consulting the example implementation on the reference site, and doing some inline assembly.</p>\n"}, {"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1452685083, "last_edit_date": 1452685083, "creation_date": 1452683512, "answer_id": 34765149, "question_id": 34764892, "link": "https://stackoverflow.com/questions/34764892/converting-a-float-with-many-decimal-places-to-a-float-with-one-decimal-place-on/34765149#34765149", "title": "Converting a float with many decimal places to a float with one decimal place only", "body": "<p>Convert it to an integer type and back again:</p>\n\n<pre><code>float myRound(float f, int num_places) {\n    float factor = 1f;\n    for (i = 0; i &lt; num_places; i++) {\n        factor *= 10f;\n    return ((long long)(factor * (f + .5f)))/factor;\n}\n</code></pre>\n\n<p>Note that the code above is subject to the usual precision/range problems regarding floating point numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "is_accepted": false, "score": 1, "last_activity_date": 1452684221, "creation_date": 1452684221, "answer_id": 34765381, "question_id": 34764892, "link": "https://stackoverflow.com/questions/34764892/converting-a-float-with-many-decimal-places-to-a-float-with-one-decimal-place-on/34765381#34765381", "title": "Converting a float with many decimal places to a float with one decimal place only", "body": "<p>Just multiply by 10 and divide by 10, do this</p>\n\n<pre><code>float a = 4.91820238;\nint i;\ni = a*10;\nnum = i/10.0;\n// num has 4.9 now\n</code></pre>\n\n<p>Remember the <code>10.0</code> during the divison, if you just divide it by 10 you'll just get the integer quotient of it.</p>\n"}], "owner": {"reputation": 45, "user_id": 4783547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00677b8d9049ebf0df786f301270c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Mohamed Ashraf", "link": "https://stackoverflow.com/users/4783547/ahmed-mohamed-ashraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1452685613, "answer_count": 3, "score": -3, "last_activity_date": 1452685083, "creation_date": 1452682789, "last_edit_date": 1452683584, "question_id": 34764892, "link": "https://stackoverflow.com/questions/34764892/converting-a-float-with-many-decimal-places-to-a-float-with-one-decimal-place-on", "closed_reason": "Needs details or clarity", "title": "Converting a float with many decimal places to a float with one decimal place only", "body": "<p>i want to know if there is a code that can convert float number like : 4.91820238 to a float with one decimal place only : 4.9 in C without using any libraries\nP.S: I don't use print() function , I want to convert it and sotre its value ?</p>\n"}, {"tags": ["c", "gcc", "clang", "main"], "comments": [{"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 1, "creation_date": 1452682859, "post_id": 34764796, "comment_id": 57274750, "body": "It <b>doesn&#39;t</b> compile. ISO C forbids zero sized arrays."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 8, "creation_date": 1452683211, "post_id": 34764796, "comment_id": 57275015, "body": "It&#39;s not allowed by the C specification. Compilers often implement stuff not covered by the specification."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1475785279, "post_id": 34764796, "comment_id": 67095408, "body": "Related question: <a href=\"http://stackoverflow.com/q/32851184/1708801\">How can a program with a global variable called main instead of a main function work?</a>. I think also inspired by a codegolf question."}, {"owner": {"reputation": 1362, "user_id": 9642811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U2NFN.jpg?s=128&g=1", "display_name": "MilkyWay90", "link": "https://stackoverflow.com/users/9642811/milkyway90"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1561154178, "post_id": 34764796, "comment_id": 99984865, "body": "@M.M Especially in the case of <a href=\"http://web.archive.org/web/20000815230017/http:/www.mines.edu/students/b/bolmstea/malbolge/\" rel=\"nofollow noreferrer\">Malbolge</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452683113, "post_id": 34764930, "comment_id": 57274940, "body": "This compiles and links fine (well, with a warning)  with gcc 4.9.3 on cygwin: <code>int f(int argc,char **argv) { \treturn 0; }  char *main = (char *)f;</code>"}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452683496, "post_id": 34764930, "comment_id": 57275236, "body": "@PeterA.Schneider But if it runs OK it&#39;s just pure luck. The CRT-init will try to call <code>main</code> which is where the pointer is stored and not what it points at."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452683660, "post_id": 34764930, "comment_id": 57275348, "body": "It links but segfaults. Btw, I don&#39;t think the question has much to do with &quot;freestanding&quot;. For example, the following compiles and links (to a dll) in VS13: <code>namespace Main_abused {     class Program     {         int Main = 0;     } } </code>. It&#39;s rather that main (and Main in C#) are not keywords, and the C linkers are dumb, err, simple."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452684321, "post_id": 34764930, "comment_id": 57275805, "body": "@PeterA.Schneider I disagree, a program with <code>main</code> not being defined in a way different from what&#39;s required by the standard (or implementation specified) is malformed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463131603, "post_id": 34764930, "comment_id": 61943818, "body": "This isn&#39;t really accurate. The hosted section of C99/C11 has a retarded sentence &quot;or in some other implementation-defined manner&quot;, which is completely unclear. So nobody really knows what forms of main that are allowed... <a href=\"http://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c/31263079#31263079\">Discussed in detail here</a>."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1463134139, "post_id": 34764930, "comment_id": 61945586, "body": "I really don&#39;t see the ambiguity in that sentence (except possibly whether you need to document the lack of additional forms). You mention that the rationale is not normative and neither is section 5.1.2.2.3 (regarding the signature of main) - so that they points in different directions does not mean an ambiguity."}], "tags": [], "owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "is_accepted": true, "score": 42, "last_activity_date": 1452684562, "last_edit_date": 1452684562, "creation_date": 1452682881, "answer_id": 34764930, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile/34764930#34764930", "title": "Why does declaring main as an array compile?", "body": "<p>It's because C allows for \"non-hosted\" or freestanding environment which doesn't require the <code>main</code> function. This means that the name <code>main</code> is freed for other uses. This is why the language as such allows for such declarations. Most compilers are designed to support both (the difference is mostly how linking is done) and therefore they don't disallow constructs that would be illegal in hosted environment.</p>\n\n<p>The section you refers to in the standard refers to hosted environment, the corresponding for freestanding is:</p>\n\n<blockquote>\n  <p>in a freestanding environment (in which C program execution may take place without any\n  benefit of an operating system), the name and type of the function called at program\n  startup are implementation-defined.   Any  library facilities available to a freestanding\n  program, other than the minimal set required by clause 4, are implementation-defined.</p>\n</blockquote>\n\n<p>If you then link it as usual it will go bad since the linker normally has little knowledge about the nature of the symbols (what type it has or even if it's a function or variable). In this case the linker will happily resolve calls to <code>main</code> to the variable named <code>main</code>. If the symbol is not found it will result in link error. </p>\n\n<p>If you're linking it as usual you're basically trying to use the compiler in hosted operation and then not defining <code>main</code> as you're supposed to means undefined behavior as per appendix J.2:</p>\n\n<blockquote>\n  <p>the behavior is undefined in the following circumstances:</p>\n  \n  <ul>\n  <li>...</li>\n  <li>program in a hosted environment does not define a function named\n  main\n  using one\n  of the specified forms (5.1.2.2.1)</li>\n  </ul>\n</blockquote>\n\n<p>The purpose of the freestanding possibility is to be able to use C in environments where (for example) standard libraries or CRT initialization is not given. This means that the code that is run before <code>main</code> is called (that's the CRT initialization that initializes the C runtime) might not provided and you would be expected to provide that yourself (and you may decide to have a <code>main</code> or may decide not to).</p>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452683381, "post_id": 34764999, "comment_id": 57275142, "body": "The minimal example I posted as a comment to skyking&#39;s answer links but segfaults. Any tweak to make that work, say with inline assembler or such?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452683540, "post_id": 34764999, "comment_id": 57275267, "body": "@PeterA.Schneider It segfaults because it will jump to the <i>address</i> of the pointer and not to it&#39;s content."}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 0, "creation_date": 1452684003, "post_id": 34764999, "comment_id": 57275598, "body": "Thanks! I guess I still expected the C frontend of these toolchains to throw, even if the linker doesn&#39;t care when it sees the object files."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 8, "last_activity_date": 1452683056, "creation_date": 1452683056, "answer_id": 34764999, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile/34764999#34764999", "title": "Why does declaring main as an array compile?", "body": "<p><code>main</code> is - after compiling - just another symbol in an object file like many others (global functions, global variables, etc).</p>\n\n<p>The linker will link the symbol <code>main</code> regardless of its type. Indeed, the linker cannot see the type of the symbol at all (he <em>can</em> see, that it isn't in the <code>.text</code>-section however, but he doesn't care ;))</p>\n\n<p>Using gcc, the standard entry point is _start, which in turn calls main() after preparing the runtime environment. So it will jump to the address of the integer array, which usually will result in a bad instruction, segfault or some other bad behaviour.</p>\n\n<p>This all of course has nothing to do with the C-standard.</p>\n"}, {"comments": [{"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 2, "creation_date": 1452683693, "post_id": 34765008, "comment_id": 57275371, "body": "It still compiles and links. The only difference is that it warns you about that <code>main</code> is usually a function (then it continues and links anyway)."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "reply_to_user": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 1, "creation_date": 1452687776, "post_id": 34765008, "comment_id": 57278081, "body": "@skyking You want the compile/link to fail? Add <code>-Werror</code> then."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1452688381, "post_id": 34765008, "comment_id": 57278516, "body": "But then (other) valid C programs would fail to compile as well."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "reply_to_user": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1452689134, "post_id": 34765008, "comment_id": 57278981, "body": "@skyking Then add <code>-Wno-*</code> for the warnings you chose to accept. More often than not, warnings are easy to fix and if they aren&#39;t, something is wrong with the code, IMNSHO. I use <code>-Werror</code> for years now and it has been proven valuable. New warnings are impossible to miss and must be fixed to continue."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 1, "creation_date": 1452689213, "post_id": 34765008, "comment_id": 57279026, "body": "I agree that <code>-Werror</code> and enabling warnings is a good idea, but that doesn&#39;t contradict the fact that doing so will cause the compiler failing to compile valid C programs."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "reply_to_user": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1546908056, "post_id": 34765008, "comment_id": 95000856, "body": "@skyking Can you give an example of a valid C program that fails to compile? The GCC developers might want to have a look at it."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1546986153, "post_id": 34765008, "comment_id": 95034047, "body": "The whole idea of <code>-Werror</code> is to fail compilation if a warning is issued. Warnings can be issued on valid C programs. I&#39;m quite sure the GCC developers don&#39;t want to have a look at that."}], "tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 3, "last_activity_date": 1452683074, "creation_date": 1452683074, "answer_id": 34765008, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile/34765008#34765008", "title": "Why does declaring main as an array compile?", "body": "<p>It only compiles because you don't use the proper options (and works because linkers sometimes only care for the <em>names</em> of symbols, not their <em>type</em>).</p>\n\n<pre><code>$ gcc -std=c89 -pedantic -Wall x.c\nx.c:1:5: warning: ISO C forbids zero-size array \u2018main\u2019 [-Wpedantic]\n int main[0];\n     ^\nx.c:1:5: warning: \u2018main\u2019 is usually a function [-Wmain]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 5783977, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6de9e0c82068c79a1f01c1592a71acfa?s=128&d=identicon&r=PG", "display_name": "tymmej", "link": "https://stackoverflow.com/users/5783977/tymmej"}, "is_accepted": false, "score": 24, "last_activity_date": 1452685267, "last_edit_date": 1452685267, "creation_date": 1452683924, "answer_id": 34765279, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile/34765279#34765279", "title": "Why does declaring main as an array compile?", "body": "<p>If you are interested how to create program in main array: <a href=\"https://jroweboy.github.io/c/asm/2015/01/26/when-is-main-not-a-function.html\">https://jroweboy.github.io/c/asm/2015/01/26/when-is-main-not-a-function.html</a>. The example source there just contains a char (and later int) array called <code>main</code> which is filled with machine instructions.</p>\n\n<p>The main steps and problems were: </p>\n\n<ul>\n<li>Obtain the machine instructions of a main function from a gdb memory dump and copy it into the array </li>\n<li>Tag the data in <code>main[]</code> executable by declaring it const (data is apparently either writable or executable)</li>\n<li>Last detail: Change an address for actual string data.</li>\n</ul>\n\n<p>The resulting C code is just</p>\n\n<pre><code>const int main[] = {\n    -443987883, 440, 113408, -1922629632,\n    4149, 899584, 84869120, 15544,\n    266023168, 1818576901, 1461743468, 1684828783,\n    -1017312735\n};\n</code></pre>\n\n<p>but results in an executable program on a 64 bit PC:</p>\n\n<pre><code>$ gcc -Wall final_array.c -o sixth\nfinal_array.c:1:11: warning: \u2018main\u2019 is usually a function [-Wmain]\n const int main[] = {\n           ^\n$ ./sixth \nHello World!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 9, "last_activity_date": 1463132868, "last_edit_date": 1463132868, "creation_date": 1463132539, "answer_id": 37206584, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile/37206584#37206584", "title": "Why does declaring main as an array compile?", "body": "<p>The problem is that <code>main</code> is not a reserved identifier. The C standard only says that in hosted systems there is usually a function called main. But nothing in the standard prevents you from abusing the same identifier for other sinister purposes.</p>\n\n<p>GCC gives you a smug warning \"main is usually a function\", hinting that the use of the identifier <code>main</code> for other unrelated purposes isn't a brilliant idea.</p>\n\n<hr>\n\n<p>Silly example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n  int main = 5;\n  main:\n\n  printf(\"%d\\n\", main);\n  main--;\n\n  if(main)\n  {\n    goto main;\n  }\n  else\n  {\n    int main (void);\n    main();\n  }\n}\n</code></pre>\n\n<p>This program will repeatedly print the numbers 5,4,3,2,1 until it gets a stack overflow and crashes (don't try this at home). Unfortunately, the above program is a strictly conforming C program and the compiler can't stop you from writing it.</p>\n"}, {"comments": [{"owner": {"reputation": 254, "user_id": 8365799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKnai.png?s=128&g=1", "display_name": "SilverWolf", "link": "https://stackoverflow.com/users/8365799/silverwolf"}, "edited": false, "score": 0, "creation_date": 1537393595, "post_id": 50016895, "comment_id": 91772977, "body": "Interesting, how does it work? Does it still work with ASLR?"}, {"owner": {"reputation": 6976, "user_id": 236062, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63c7436d6b05ba912a5cb0b0bf254c93?s=128&d=identicon&r=PG", "display_name": "Zibri", "link": "https://stackoverflow.com/users/236062/zibri"}, "reply_to_user": {"reputation": 254, "user_id": 8365799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKnai.png?s=128&g=1", "display_name": "SilverWolf", "link": "https://stackoverflow.com/users/8365799/silverwolf"}, "edited": false, "score": 1, "creation_date": 1538035504, "post_id": 50016895, "comment_id": 92003742, "body": "C3 is just a return. So it executes and returns."}], "tags": [], "owner": {"reputation": 6976, "user_id": 236062, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63c7436d6b05ba912a5cb0b0bf254c93?s=128&d=identicon&r=PG", "display_name": "Zibri", "link": "https://stackoverflow.com/users/236062/zibri"}, "is_accepted": false, "score": 1, "last_activity_date": 1524642981, "creation_date": 1524642981, "answer_id": 50016895, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile/50016895#50016895", "title": "Why does declaring main as an array compile?", "body": "<pre><code>const int main[1] = { 0xc3c3c3c3 };\n</code></pre>\n\n<p>This compiles and executes on x86_64... does nothing just return :D</p>\n"}], "owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10657, "favorite_count": 11, "accepted_answer_id": 34764930, "answer_count": 6, "score": 61, "last_activity_date": 1524642981, "creation_date": 1452682504, "last_edit_date": 1492087139, "question_id": 34764796, "link": "https://stackoverflow.com/questions/34764796/why-does-declaring-main-as-an-array-compile", "title": "Why does declaring main as an array compile?", "body": "<p>I saw <a href=\"https://codegolf.stackexchange.com/a/69193/13441\">a snippet of code on CodeGolf</a> that's intended as a compiler bomb, where <code>main</code> is declared as a huge array. I tried the following (non-bomb) version:</p>\n\n<pre><code>int main[1] = { 0 };\n</code></pre>\n\n<p>It seems to compile fine under Clang and with only a warning under GCC:</p>\n\n<blockquote>\n  <p>warning: 'main' is usually a function [-Wmain]</p>\n</blockquote>\n\n<p>The resulting binary is, of course, garbage.</p>\n\n<p>But why does it compile at all? Is it even allowed by the C specification? The section that I think is relevant says:</p>\n\n<blockquote>\n  <p>5.1.2.2.1 Program startup</p>\n  \n  <p>The function called at program startup is named main. The implementation declares no prototype for this function. It shall be defined with a return type of int and with no parameters [...] or with two parameters [...] or in some other implementation-defined manner.</p>\n</blockquote>\n\n<p>Does \"some other implementation-defined manner\" include a global array? (It seems to me that the spec still refers to a <em>function</em>.)</p>\n\n<p>If not, is it a compiler extension? Or a feature of the toolchains, that serves some other purpose and they decided to make it available through the frontend?</p>\n"}, {"tags": ["c", "pointers", "struct", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452682228, "post_id": 34764671, "comment_id": 57274351, "body": "<code>scanf(&quot;%s&quot;, &amp;authorChar);</code>  --&gt; <code>scanf(&quot;%9s&quot;, authorChar);</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452682249, "post_id": 34764671, "comment_id": 57274366, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5524648, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/351848e19277036e724ea51d237dc40f?s=128&d=identicon&r=PG&f=1", "display_name": "Moshe", "link": "https://stackoverflow.com/users/5524648/moshe"}, "edited": false, "score": 0, "creation_date": 1452684507, "post_id": 34764735, "comment_id": 57275920, "body": "thank you for your answer ! , my mistake really began when i defined <code>b</code> to be a pointer-to-type, without initialize it. (i did it because in the further future, book struct will be just one of - books array...)."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1452683999, "last_edit_date": 1452683999, "creation_date": 1452682322, "answer_id": 34764735, "question_id": 34764671, "link": "https://stackoverflow.com/questions/34764671/failed-while-trying-to-reach-pointer-in-struct/34764735#34764735", "title": "failed while trying to reach pointer in struct", "body": "<p>The problem is in the following line</p>\n\n<pre><code>  b-&gt;author = authorName;\n</code></pre>\n\n<p>at this point, <code>b</code> is not allocated memory, i.e., <code>b</code> is an uninitialized pointer. It points to some random memory location which is not a <em>valid</em> one. Any attempt to access invalid memory invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>You can use either of the following approach to resolve the issue:</p>\n\n<ul>\n<li><p>allocate memory to <code>b</code> dynamically before using it, like <code>b = malloc(sizeof*b);</code> and a check for success.</p></li>\n<li><p>define <code>b</code> as a variable of type <code>book</code>, instead of a pointer-to-type.</p></li>\n</ul>\n\n<p>That said, <code>int main()</code> should be <code>int main(void)</code> at least, to conform to the standards.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452682921, "post_id": 34764825, "comment_id": 57274790, "body": "^^ \t Please see the comment under the question on why not to cast the return value of <code>malloc()</code> and family in C."}, {"owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452682965, "post_id": 34764825, "comment_id": 57274820, "body": "Thank you. There is a looong time I do not code in C. More than 4 years."}], "tags": [], "owner": {"reputation": 471, "user_id": 2034245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h2y1r.jpg?s=128&g=1", "display_name": "Victor Viola", "link": "https://stackoverflow.com/users/2034245/victor-viola"}, "is_accepted": false, "score": 1, "last_activity_date": 1452682926, "last_edit_date": 1452682926, "creation_date": 1452682561, "answer_id": 34764825, "question_id": 34764671, "link": "https://stackoverflow.com/questions/34764671/failed-while-trying-to-reach-pointer-in-struct/34764825#34764825", "title": "failed while trying to reach pointer in struct", "body": "<p>You are forgetting to do the memory allocation for <code>b</code> variable.</p>\n\n<pre><code>b = malloc(sizeof(book));\nb-&gt;author = malloc(sizeof(100000)); // replace value for the size you want\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5524648, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/351848e19277036e724ea51d237dc40f?s=128&d=identicon&r=PG&f=1", "display_name": "Moshe", "link": "https://stackoverflow.com/users/5524648/moshe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 34764735, "answer_count": 2, "score": 3, "last_activity_date": 1452683999, "creation_date": 1452682137, "last_edit_date": 1452682767, "question_id": 34764671, "link": "https://stackoverflow.com/questions/34764671/failed-while-trying-to-reach-pointer-in-struct", "title": "failed while trying to reach pointer in struct", "body": "<p>my project is to build book structure - and fill it with users parameters.</p>\n\n<p>involving dynamic allocation, arrays and pointers.</p>\n\n<p>my <code>book</code> structure has the following:</p>\n\n<pre><code>struct BOOK\n{\n    char* author;\n    char** genders;\n    int totalGenders;\n    char* name;\n    int* chapterPages;\n    int totalChapters;\n\n}typedef book;\n</code></pre>\n\n<p>when I tried reaching author name, line 1 in structure:</p>\n\n<pre><code>struct BOOK\n{\n    char* author;\n</code></pre>\n\n<p>I failed doing that.. my code in main :</p>\n\n<pre><code>int main()\n{\n    book* b;\n    char authorChar[10] = { 0 };\n    int authorLen;\n    char* authorName;\n\n\n    // get author name\n    puts(\"please enter the name of the author\");\n    scanf(\"%s\", &amp;authorChar);\n    authorLen = strlen(authorChar);\n    printf(\"%d\", authorLen);    //print to see that lentgh is correct.\n\n    authorName = (char*)calloc(authorLen, sizeof(char));\n    strcpy(authorName, authorChar);\n    puts(\"\\n\");\n    b-&gt;author = authorName;\n\n    printf(\"%d\", b-&gt;author);\n</code></pre>\n\n<p><strong>when i have debugged i got a problem in this line :</strong></p>\n\n<pre><code>b-&gt;author = authorName;\n</code></pre>\n\n<p><strong>ideas please? :)</strong></p>\n"}, {"tags": ["c", "portability", "diskspace"], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1452686971, "post_id": 34764715, "comment_id": 57277524, "body": "<code>sys&#47;statvfs</code> is <a href=\"http://pubs.opengroup.org/onlinepubs/009604599/basedefs/sys/statvfs.h.html\" rel=\"nofollow noreferrer\">standard POSIX</a>, so it&#39;s pretty portable.  Microsoft is more the outlier in this case."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1452682281, "creation_date": 1452682281, "answer_id": 34764715, "question_id": 34764574, "link": "https://stackoverflow.com/questions/34764574/how-do-i-check-if-i-can-use-sys-statvfs-h/34764715#34764715", "title": "How do I check if I can use &lt;sys/statvfs.h&gt;?", "body": "<p>Generally, you would use autotools for stuff like that. <code>autoconf</code> creates a <code>config.h</code> header which defines a <code>HAVE_STATVFS</code> or so macro if you define a suitable configuration test.</p>\n\n<p>However, due to the otherwise huge availability of <code>&lt;sys/statvfs.h&gt;</code>, you can also less portably simply test for <code>_MSC_VER</code>, as you just did.</p>\n"}], "owner": {"reputation": 3405, "user_id": 4675398, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f82f90aae5005af1ffe060462dd87482?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/4675398/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "accepted_answer_id": 34764715, "answer_count": 1, "score": 2, "last_activity_date": 1452682281, "creation_date": 1452681868, "question_id": 34764574, "link": "https://stackoverflow.com/questions/34764574/how-do-i-check-if-i-can-use-sys-statvfs-h", "title": "How do I check if I can use &lt;sys/statvfs.h&gt;?", "body": "<p>I want to write a portable way to get the free disk space. On Windows, I use <code>GetDiskFreeSpaceEx</code>, and on Linux, the header <code>&lt;sys/statvfs.h&gt;</code> contains the function <code>statvfs64()</code> I can use.</p>\n\n<p>My question is, on which systems I can assume that this header exists. Is there a macro I can check? Something like</p>\n\n<pre><code>#ifdef _MSC_VER\n#include &lt;windows.h&gt;\n#else\n  #ifdef STATVFS_IS_AVAILABLE\n  #include &lt;sys/statvfs.h&gt;\n  #endif\n#endif\n</code></pre>\n"}, {"tags": ["c", "pointers", "dynamic-memory-allocation", "realloc", "off-by-one"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1452681431, "post_id": 34764384, "comment_id": 57273757, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1452681524, "post_id": 34764384, "comment_id": 57273819, "body": "Does your question concern C++? How?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1452681619, "post_id": 34764384, "comment_id": 57273892, "body": "Isn&#39;t it like after the <code>realloc()</code>,  <code>*(res + i) = NULL;</code> should be <code>*(res + i -1) = NULL;</code> or am I missing something?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452682312, "post_id": 34764384, "comment_id": 57274406, "body": "What do you mean with &quot;null value&quot;? The value <code>0x0</code>? A <i>null pointer</i>?"}, {"owner": {"reputation": 11, "user_id": 5783732, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1RlQVr5l7iI/AAAAAAAAAAI/AAAAAAAAALo/7BM_imHQ18Y/photo.jpg?sz=128", "display_name": "Joebert Bisenio", "link": "https://stackoverflow.com/users/5783732/joebert-bisenio"}, "edited": false, "score": 0, "creation_date": 1452827792, "post_id": 34764384, "comment_id": 57350483, "body": "When I use *(res + i) = NULL i got an error of Dereference of out of bound but when I use *(res + i -1) = NULL if my last data inside the res[2] = C it will become null value, the only retain data will be in res[0] = A, res[1] = B. Then for the res[3]=NULL, because this *(res + i -1) = NULL will delete the last value of my array. That&#39;s what I get when I use this *(res + i -1) = NULL"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5783732, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1RlQVr5l7iI/AAAAAAAAAAI/AAAAAAAAALo/7BM_imHQ18Y/photo.jpg?sz=128", "display_name": "Joebert Bisenio", "link": "https://stackoverflow.com/users/5783732/joebert-bisenio"}, "edited": false, "score": 0, "creation_date": 1452732873, "post_id": 34764517, "comment_id": 57304720, "body": "Thanks for the answer but if I will do this *(res + i -1) = NULL; the last data inside the array will be deleted. example:  when: *(res + i) = NULL; res[0] = A res[1] = B res[2] = C res[3] = D  but when *(res + i - 1) = NULL; res[0] = A res[1] = B res[2] = C res[3] = NULL"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1452682191, "last_edit_date": 1495542208, "creation_date": 1452681726, "answer_id": 34764517, "question_id": 34764384, "link": "https://stackoverflow.com/questions/34764384/how-can-i-put-a-null-value-for-char-str/34764517#34764517", "title": "How can I put a null value for char** str", "body": "<p>In this part of code</p>\n\n<pre><code>res = (char**)realloc(res, i * sizeof(char*));\n*(res + i) = NULL;\n</code></pre>\n\n<p>by trying to access <code>*(res + i)</code>, you're going <a href=\"https://en.wikipedia.org/wiki/Off-by-one_error\" rel=\"nofollow noreferrer\">off-by-one</a>. You should write</p>\n\n<pre><code>*(res + i -1) = NULL;\n</code></pre>\n\n<p>Having said that,</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>.</li>\n<li>A statement like <code>pointerP = realloc (pointerP, .....)</code> is considered very unsafe, as in case, if <code>realloc()</code> fails, you'll end up losing the actual pointer, too.</li>\n<li>Always check for the return value of <code>malloc()</code> and family of functions against <code>NULL</code> to ensure the success.</li>\n<li>Also, put a NULL check for the return value of <code>strtok()</code>, too before passing that to <code>strdup()</code>.</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 5783732, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1RlQVr5l7iI/AAAAAAAAAAI/AAAAAAAAALo/7BM_imHQ18Y/photo.jpg?sz=128", "display_name": "Joebert Bisenio", "link": "https://stackoverflow.com/users/5783732/joebert-bisenio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452682810, "creation_date": 1452681388, "last_edit_date": 1452682810, "question_id": 34764384, "link": "https://stackoverflow.com/questions/34764384/how-can-i-put-a-null-value-for-char-str", "title": "How can I put a null value for char** str", "body": "<p>How can I put a null value for char** str because im having and Error of \"Dereference of out of bound pointer: 1 bytes(1element) past end of array im using C language\"</p>\n\n<pre><code>while(part)\n    {\n        res = (char**)realloc(res, (i + 1) * sizeof(char*));\n        *(res + i) = mystrdup(part);\n\n        part = mystrdup(strtok(NULL, delim));\n        i++;\n    }\n    res = (char**)realloc(res, i * sizeof(char*));\n    *(res + i) = NULL; // This is where I Encounter the ERROR\n</code></pre>\n"}, {"tags": ["android", "c", "file", "java-native-interface", "computer-forensics"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1452697720, "post_id": 34764263, "comment_id": 57285004, "body": "<code>lseek()</code> to the end of a file followed by <code>write()</code> does not guarantee that you write to the end of the file - the calls are not atomic.  Call <code>open()</code> with the <code>O_APPEND</code> flag set.  And your code <i>won&#39;t</i> work if you call <code>free()</code> on the <code>char *</code> returned from <code>GetStringUTFChars()</code>.  See <a href=\"http://stackoverflow.com/questions/5859673/should-you-call-releasestringutfchars-if-getstringutfchars-returned-a-copy?rq=1\" title=\"should you call releasestringutfchars if getstringutfchars returned a copy\">stackoverflow.com/questions/5859673/&hellip;</a>.  Also, <code>read()</code> and <code>write()</code> both return <code>ssize_t</code>, not <code>int</code>.  They are not the same.  JNI is <b>extremely</b> unforgiving."}, {"owner": {"reputation": 180, "user_id": 2484017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZzoGo.png?s=128&g=1", "display_name": "hengsti", "link": "https://stackoverflow.com/users/2484017/hengsti"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1452767808, "post_id": 34764263, "comment_id": 57318335, "body": "Clearification: the code above complies and runs. Just not the way I intent it to. @AndrewHenle 1. <b>lseek()</b> and <b>write()</b> works fine for my purposes. 2. Thank you for pointing out the <b>GetStringUTFChars()</b> this may make my program more stable. 3. As defined in <b>types.h</b> for C ssize_t is in fact a int. I accept the improvement though. And I agree in to the unforgivingness of JNI. Thank you for the comment"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1452769633, "post_id": 34764263, "comment_id": 57319445, "body": "<i>As defined in types.h for C ssize_t is in fact a int</i>  <a href=\"https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models\" rel=\"nofollow noreferrer\">Oh really?</a>  Types in standards - such as <code>read()</code>/<code>write()</code> returning the type <code>ssize_t</code> - are done for a <b>reason</b>.  But if you think you&#39;re more knowledgeable about such things than the authors of those standards and you know better because you looked in <code>types.h</code> on <b>one</b> platform for <b>one</b> implementation and saw <i>ssize_t is in fact an int</i>, go right ahead."}, {"owner": {"reputation": 180, "user_id": 2484017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZzoGo.png?s=128&g=1", "display_name": "hengsti", "link": "https://stackoverflow.com/users/2484017/hengsti"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1452800982, "post_id": 34764263, "comment_id": 57339956, "body": "I already agreed to use ssize_t because <b>read() / write ()</b> do return ssize_t and not int. This is a topic secondary to my problem. Let&#39;s focus at a solution - How to read and write to the file slack. Shall we?"}, {"owner": {"reputation": 180, "user_id": 2484017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZzoGo.png?s=128&g=1", "display_name": "hengsti", "link": "https://stackoverflow.com/users/2484017/hengsti"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1452802922, "post_id": 34764263, "comment_id": 57341096, "body": "for your reference that wikipedia is not always right check the <a href=\"https://android.googlesource.com/platform/bionic/+/b6e2248%5E!/\" rel=\"nofollow noreferrer\">android source code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 180, "user_id": 2484017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZzoGo.png?s=128&g=1", "display_name": "hengsti", "link": "https://stackoverflow.com/users/2484017/hengsti"}, "is_accepted": true, "score": 0, "last_activity_date": 1455040625, "creation_date": 1455040625, "answer_id": 35298878, "question_id": 34764263, "link": "https://stackoverflow.com/questions/34764263/how-to-read-write-file-slacks-in-android-with-jni/35298878#35298878", "title": "How to read/write file slacks in Android with JNI?", "body": "<p>Apparently this way is impossible. But with root it is possible to write file slack via mounting a loop back device. Still, ignoring EOF is not possible without changing the driver or implementing your own kernel module. </p>\n"}], "owner": {"reputation": 180, "user_id": 2484017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZzoGo.png?s=128&g=1", "display_name": "hengsti", "link": "https://stackoverflow.com/users/2484017/hengsti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 1, "accepted_answer_id": 35298878, "answer_count": 1, "score": 0, "last_activity_date": 1455040625, "creation_date": 1452680996, "last_edit_date": 1453750970, "question_id": 34764263, "link": "https://stackoverflow.com/questions/34764263/how-to-read-write-file-slacks-in-android-with-jni", "title": "How to read/write file slacks in Android with JNI?", "body": "<p>I am building a forensic tool, that shall read and write from file slacks. At the moment I use JNI to call the C functions <strong>read()</strong> and <strong>write()</strong> to write a buffer to the FAT SD card (also EXT4 internal memory would be nice). I use those because you can pass the length to read/write thus ignoring EOF.\nI already tried writing by using a standard write and then <strong>truncate</strong> it in order to write in the file slack, which works on ubuntu 14.04 but not on Android (API 21). \nReading more from a file than the actuall file size does not reflect the flie slack on the SD-card. \nThere are tools e.g. \"bmap\" or \"slacker.exe\" (for NTFS) that manage to access file slacks. I am in need of a way to ignore EOF or handle it myself. I would prefere not to change existing file system drivers.\nI appreciate any suggestions.</p>\n\n<p>here is some sample code (that does not work yet): </p>\n\n<pre><code>jstring\nJava_com_example_hellojni_HelloJni_write(JNIEnv *env, jobject thiz, jstring path)\n{\nchar *cpath = (*env)-&gt;GetStringUTFChars(env, path, NULL);\nint raw_file_descriptor = open(cpath,O_WRONLY,0);\nlseek(raw_file_descriptor,0,SEEK_END);\nchar block_buffer [4096] = \"hidden\";\nint buffer_length = 6;\nint wret = write(raw_file_descriptor,block_buffer,buffer_length); // increases file size and moves EOF - I don't want that\nLOGD(\" char written: %d\", wret);\nfree(cpath);\nreturn (*env)-&gt;NewStringUTF(env, \"write ok \");\n}\n\njbyteArray\nJava_com_example_hellojni_HelloJni_read2(JNIEnv *env, jobject thiz, jstring path) {\n\nchar *cpath = (*env)-&gt;GetStringUTFChars(env, path, NULL);\nLOGD(\"open %s with \", cpath);\nint raw_file_descriptor = open(cpath,O_RDONLY,0);\nchar buffer [4096];\nint readretval = read(raw_file_descriptor, buffer, 50); // stops at EOF - I want it to continue reading all 50 bytes from the SD-card - This gives me the file content until EOF and then I get some random characters from the uninitialized buffer. \nLOGD(\"read (%d) buffer with length  %d: %s\", readretval, sizeof(buffer), buffer);\nint i; // Debug code\nfor (i=0; i &lt; 49; ++i) {\n    LOGD(\"%c\",buffer[i]);\n}\n\nclose(raw_file_descriptor);\nfree(cpath);\nreturn NULL;\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 2, "creation_date": 1452681780, "post_id": 34764239, "comment_id": 57273998, "body": "Nope, not that I&#39;m aware of. Without using a user-defined function, how do you imagine that a generic function would have any idea of <b>(a)</b> which member to use for the comparison and <b>(b)</b> whether any given node should come before or after any other arbitrary node? If you look at the <code>qsort</code> function (as found in stdlib.h) you can see that it requires a compare function to be defined. It will sort an array of whatever you like, but you have to tell it (a) how large each element is and (b) which function to use to compare 2 elements."}, {"owner": {"reputation": 12521, "user_id": 4498329, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b1bf128245aa5bcb1b740e8154296900?s=128&d=identicon&r=PG&f=1", "display_name": "skyking", "link": "https://stackoverflow.com/users/4498329/skyking"}, "edited": false, "score": 0, "creation_date": 1452682020, "post_id": 34764239, "comment_id": 57274185, "body": "If it is to be truly generic you would have to supply a function to compare nodes, but you also have to handle different possible layouts of the nodes (the pointer to the next node could have different offset). Otherwise it should be possible to use a algorithm with <code>O(N log N)</code> complexity, even for singly linked lists."}, {"owner": {"reputation": 83, "user_id": 5356240, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4290328ea97eb1aed7a77a5c2e964ffb?s=128&d=identicon&r=PG&f=1", "display_name": "jakline nataly", "link": "https://stackoverflow.com/users/5356240/jakline-nataly"}, "edited": false, "score": 0, "creation_date": 1452682155, "post_id": 34764239, "comment_id": 57274300, "body": "I mean a user defined function. Not a function built in with c... but the function can solve the problem in a general way. Lets say it&#39;s sorting in ascending order, so i can changed it to sort in descending. Furthermore, i can edit some fields, to get the required output."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1452687219, "post_id": 34764239, "comment_id": 57277679, "body": "The problem with your concept of &quot;<i>general</i>&quot; function, is there are many types of <i>linked-lists</i> (e.g. <i>head/tail</i> (with or without a dummy first node), circular linked lists (all nodes hold data and <i>last-&gt;next = first</i>), single/double linked, etc...) The given <code>struct node</code> would fit in any of those (except double -- which needs an additional <code>struct node *prev;</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 2, "creation_date": 1452682247, "post_id": 34764346, "comment_id": 57274363, "body": "A fairy, 10 puppies and 3 angels just died. :p For the sake of both others and yourself (in the future) I <b>strongly</b> suggest that you get into the habit of giving variable meaningful names. <code>temp1</code>, <code>temp2</code>, <code>temp3</code>, <code>temp4</code> and <code>temp5</code> are <i>really</i> nasty names and make it unnecessarily hard to read the code. You&#39;ll thank yourself when you go back to look at old code. :)"}], "tags": [], "owner": {"reputation": 201, "user_id": 5356383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sIrMI.jpg?s=128&g=1", "display_name": "yasserkabbout", "link": "https://stackoverflow.com/users/5356383/yasserkabbout"}, "is_accepted": true, "score": 2, "last_activity_date": 1452682948, "last_edit_date": 1452682948, "creation_date": 1452681263, "answer_id": 34764346, "question_id": 34764239, "link": "https://stackoverflow.com/questions/34764239/general-function-for-sorting-a-linked-list/34764346#34764346", "title": "General function for sorting a linked list", "body": "<p>For your case, you can use an edited version of the function that you have provided. <strong>The swap function was omitted in here</strong>.</p>\n\n<pre><code>//Sorting according to the data, ascending order\nvoid bubbleSortLL(struct node *header){\n\nstruct node *temp1, *temp2, *temp3, *temp4, *temp5;\n\ntemp4=NULL;\n\nwhile(temp4!=header-&gt;next)\n{\n    temp3=temp1=header;\n    temp2=temp1-&gt;next;\n\n    while(temp1!=temp4)\n    {\n        if(temp1-&gt;data &gt; temp2-&gt;data)\n        {\n            if(temp1==header)\n            {\n                temp5=temp2-&gt;next;\n                temp2-&gt;next=temp1;\n                temp1-&gt;next=temp5;\n                header=temp2;\n                temp3=temp2;\n            }\n            else\n            {\n                temp5=temp2-&gt;next;\n                temp2-&gt;next=temp1;\n                temp1-&gt;next=temp5;\n                temp3-&gt;next=temp2;\n                temp3=temp2;\n            }\n        }\n        else\n        {\n            temp3=temp1;\n            temp1=temp1-&gt;next;\n        }\n\n        temp2=temp1-&gt;next;\n        if(temp2==temp4)\n            temp4=temp1;\n\n        }\n    }\n}\n</code></pre>\n\n<p>This will work by passing your specified list as an argument. Nevertheless, i don't understand why you can't use the swap function.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 5356240, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4290328ea97eb1aed7a77a5c2e964ffb?s=128&d=identicon&r=PG&f=1", "display_name": "jakline nataly", "link": "https://stackoverflow.com/users/5356240/jakline-nataly"}, "edited": false, "score": 0, "creation_date": 1452681912, "post_id": 34764397, "comment_id": 57274096, "body": "Thank you a lot. This one should work, but we were asked not to define any new variables, other than temp structs within the function. So i can&#39;t use the integer &quot;swapped&quot; or the integer &quot;temp&quot;."}], "tags": [], "owner": {"reputation": 3012, "user_id": 1182783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/057cdd9cf7b633503dee43ba597c64e7?s=128&d=identicon&r=PG", "display_name": "jofel", "link": "https://stackoverflow.com/users/1182783/jofel"}, "is_accepted": false, "score": 2, "last_activity_date": 1452682150, "last_edit_date": 1452682150, "creation_date": 1452681417, "answer_id": 34764397, "question_id": 34764239, "link": "https://stackoverflow.com/questions/34764239/general-function-for-sorting-a-linked-list/34764397#34764397", "title": "General function for sorting a linked list", "body": "<p>To get rid of the call of the swap function, replace the\nfunction call with its content:</p>\n\n<p>Instead of </p>\n\n<pre><code> swap(ptr1, ptr1-&gt;next);\n</code></pre>\n\n<p>write</p>\n\n<pre><code>int temp = ptr1-&gt;data;\nptr1-&gt;data = ptr1-&gt;next-&gt;data;\nptr1-&gt;next-&gt;data = temp;\n</code></pre>\n\n<hr>\n\n<p>To swap the elements and not the data, you need\nto to track the previous element.</p>\n\n<p>Here a suggestion for the swap of the elements(without maybe needed NULL checks)</p>\n\n<pre><code> previous-&gt;next = ptr1-&gt;next;\n previous-&gt;next-&gt;next=ptr1;\n</code></pre>\n\n<p>Instead of <code>ptr1=ptr1-&gt;next</code> you need:</p>\n\n<pre><code>     previous=previous-&gt;next;\n     ptr1=previous-&gt;next;\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5356240, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4290328ea97eb1aed7a77a5c2e964ffb?s=128&d=identicon&r=PG&f=1", "display_name": "jakline nataly", "link": "https://stackoverflow.com/users/5356240/jakline-nataly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 34764346, "answer_count": 2, "score": 2, "last_activity_date": 1452683316, "creation_date": 1452680947, "last_edit_date": 1452683316, "question_id": 34764239, "link": "https://stackoverflow.com/questions/34764239/general-function-for-sorting-a-linked-list", "title": "General function for sorting a linked list", "body": "<p>Is there any general user defined function that can be used to sort any given linked list, given that it has a pointer field and a data field.</p>\n\n<p>The function should not swap the data between the nodes. The swapping should be done by using the <code>pointers</code>.</p>\n\n<p>I found one online, but it is using a user defined function. I'm not allowed to use any other functions, but the bubble sort one.</p>\n\n<p>We were asked not to initialize any new variables, other than <code>temp structs</code> within the function. So, i can't use integers or variables like <code>swapped</code>.</p>\n\n<p><strong>The one that i was using is as follows:</strong></p>\n\n<pre><code>/* Bubble sort the given linked lsit */\nvoid bubbleSort(struct node *start)\n{\n    int swapped, i;\n    struct node *ptr1;\n    struct node *lptr = NULL;\n\n    /* Checking for empty list */\n    if (ptr1 == NULL)\n        return;\n\n    do\n    {\n        swapped = 0;\n        ptr1 = start;\n\n        while (ptr1-&gt;next != lptr)\n        {\n            if (ptr1-&gt;data &gt; ptr1-&gt;next-&gt;data)\n            { \n                swap(ptr1, ptr1-&gt;next);\n                swapped = 1;\n            }\n            ptr1 = ptr1-&gt;next;\n        }\n        lptr = ptr1;\n    }\n    while (swapped);\n}\n\n/* function to swap data of two nodes a and b*/\nvoid swap(struct node *a, struct node *b)\n{\n    int temp = a-&gt;data;\n    a-&gt;data = b-&gt;data;\n    b-&gt;data = temp;\n}\n</code></pre>\n\n<p><strong>Given that my linked list structure is as follows:</strong></p>\n\n<pre><code>struct node\n{\n    int data;\n    struct node *next;\n};\n</code></pre>\n"}, {"tags": ["android", "c", "opengl-es", "android-ndk"], "comments": [{"owner": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1452850753, "post_id": 34764238, "comment_id": 57358477, "body": "Does the glTexSubImage2D report error on each of the 3 calls? Note you are using (++i) which then ranges [1, 3] instead in [0, 2]. yuv_width[3] does not seem to be defined so the last call should most definitely be wrong (for i=3). Also you should know that glGetError returns the top value from the error stack and pops it. What that means is you generally need a while loop to get all the errors from the stack. Since you do not do that you may get the error reported on the next glGetError call although it was generated by a previous line."}, {"owner": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1452850954, "post_id": 34764238, "comment_id": 57358601, "body": "As I look at the shader it does not seem you are using color components as YUV but rather as RGB and then transform them to RGB. This seems ok to me but you should then use GL_RGB instead of GL_LUMINANCE and treat the RGB values in the shader as YUV which you already seem to be doing (or not, the fragment shader seems a bit strange. Maybe some comments in the code would help)."}, {"owner": {"reputation": 251, "user_id": 5783570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f637b8680772d43c98ab99cd3d12272?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel B.", "link": "https://stackoverflow.com/users/5783570/lionel-b"}, "reply_to_user": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1452870734, "post_id": 34764238, "comment_id": 57370129, "body": "I edited the post to add comments and add the output of my Android Monitor.  To begin, glTexSubImage2D report error on the first call, and on the last call. The increment before statement i use in my for loop is correct. In this case, it will no start from 1 to 3 but 0 to 2. Some compiles use a temporary attribute if you use increment after statement, i have gotten use to write for loop this way because it will not use a temporary attribute (it&#39;s a little bit faster). I had a log before i get my Android Monitor output to show you that it&#39;s correct."}, {"owner": {"reputation": 251, "user_id": 5783570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f637b8680772d43c98ab99cd3d12272?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel B.", "link": "https://stackoverflow.com/users/5783570/lionel-b"}, "reply_to_user": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1452871219, "post_id": 34764238, "comment_id": 57370473, "body": "During my research, i understand the &quot;problem&quot; with glGetError() so i had a log after each gl call to be sure of which line goes wrong. I thought it was sufficient, i will had a while loop to see if it the error came from an other line.  I tried using GL_RGB instead of GL_LUMINANCE, but i get the same result. I thought GL_LUMINANCE was the good &quot;type&quot; because i upload each planes in 3 different textures, am I wrong ?  Is it possible that it comes from the input image size ? (no power of two), i read somewhere that it&#39;s no more an obligation in opengles 2.0 to use power of two texture."}, {"owner": {"reputation": 251, "user_id": 5783570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f637b8680772d43c98ab99cd3d12272?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel B.", "link": "https://stackoverflow.com/users/5783570/lionel-b"}, "reply_to_user": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1452871321, "post_id": 34764238, "comment_id": 57370541, "body": "I tried to force the input size to a power of two (by adding padding to each planes to add a correct size) to check if it was the reason but that did not work either."}, {"owner": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1452878049, "post_id": 34764238, "comment_id": 57374800, "body": "What about the log from setupYUVTexture? Is it even called? I tried just a simple test which is creating a luminance texture and attach it to the frame buffer and the result status was &quot;unsupported&quot; GL_FRAMEBUFFER_UNSUPPORTED 0x8CDD."}, {"owner": {"reputation": 251, "user_id": 5783570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f637b8680772d43c98ab99cd3d12272?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel B.", "link": "https://stackoverflow.com/users/5783570/lionel-b"}, "reply_to_user": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1453126464, "post_id": 34764238, "comment_id": 57452910, "body": "I edit my post to add more information. I did a method to display opengl error correctly, and now it display any error message. I give you the detail of the call order, and of course setupYUVTexture is call. Now it display nothing and i haven&#39;t any error code, the only weird log is &quot;new_window_surface return 0x3000&quot;"}, {"owner": {"reputation": 251, "user_id": 5783570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f637b8680772d43c98ab99cd3d12272?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel B.", "link": "https://stackoverflow.com/users/5783570/lionel-b"}, "reply_to_user": {"reputation": 14257, "user_id": 526828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y7Ru.png?s=128&g=1", "display_name": "Matic Oblak", "link": "https://stackoverflow.com/users/526828/matic-oblak"}, "edited": false, "score": 0, "creation_date": 1453127030, "post_id": 34764238, "comment_id": 57453267, "body": "On the java side, i don&#39;t use the glSurfaceView, but i pass the surface to the jni to use the reference in initContext() in the method eglCreateWindowSurface(), is it possible that the probleme came from this ?  And i am sorry but in my side i don&#39;t have any GL_FRAMEBUFFER_UNSUPPORTED  for using GL_LUMINANCE .. I don&#39;t understand why it seems to work on my device and it doesn&#39;t on yours."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1453937424, "post_id": 34764238, "comment_id": 57824657, "body": "Not sure where the error is, but when U and V are 0, the color is green. So either you have a math error with U and V, or the actual input values for U and V are 0."}, {"owner": {"reputation": 346, "user_id": 706634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa8ad3c1c40b349d3df4c67b0c8b51f?s=128&d=identicon&r=PG", "display_name": "Reality Pixels", "link": "https://stackoverflow.com/users/706634/reality-pixels"}, "edited": false, "score": 0, "creation_date": 1460453298, "post_id": 34764238, "comment_id": 60737138, "body": "I&#39;m not sure why you are halving the chrominance coordinates. Shouldn&#39;t they be the same as that for chrominance? They all range from 0...1, right? And personally, I would use GL_LINEAR instead of GL_NEAREST to get interpolation."}], "answers": [{"tags": [], "owner": {"reputation": 6120, "user_id": 752630, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/117edb11a37a9ee948002a3f68e54a2e?s=128&d=identicon&r=PG&f=1", "display_name": "mbonnin", "link": "https://stackoverflow.com/users/752630/mbonnin"}, "is_accepted": false, "score": 1, "last_activity_date": 1458770642, "creation_date": 1458770642, "answer_id": 36189575, "question_id": 34764238, "link": "https://stackoverflow.com/questions/34764238/yuv-to-rgb-conversion-and-display-using-opengl-es-2-0-from-android-ndk-using-sha/36189575#36189575", "title": "YUV to RGB conversion and display using opengl es 2.0 from android ndk using shaders", "body": "<p>That's a lot of code to go through and a lot of things that can go wrong ;). To debug these kind of issues, I would go step by step.</p>\n\n<ol>\n<li>just output red (<code>gl_FragColor = vec4(1.0, 0.5, 0.5, 1.0)</code>) to make sure your configuration is working properly.</li>\n<li>try to output every texture in grayscale. (<code>gl_FragColor = vec4(y, y, y, 1.0)</code>)</li>\n<li>If all that is working then it most likely means your yuv => rgb conversion is wrong somewhere.</li>\n<li>If that's not working, then I would suspect something in the texture mapping. Double check your <code>glTexSubImage2D</code> call. You might need to pass a different stride or use a different coordinate system.</li>\n</ol>\n"}], "owner": {"reputation": 251, "user_id": 5783570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f637b8680772d43c98ab99cd3d12272?s=128&d=identicon&r=PG&f=1", "display_name": "Lionel B.", "link": "https://stackoverflow.com/users/5783570/lionel-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3269, "favorite_count": 2, "answer_count": 1, "score": 25, "last_activity_date": 1458770642, "creation_date": 1452680943, "last_edit_date": 1453792642, "question_id": 34764238, "link": "https://stackoverflow.com/questions/34764238/yuv-to-rgb-conversion-and-display-using-opengl-es-2-0-from-android-ndk-using-sha", "title": "YUV to RGB conversion and display using opengl es 2.0 from android ndk using shaders", "body": "<p>I am currently working on a rtsp player on android using ffmpeg to connect and decode the video stream. I would like to use OpenGL es 2.0 to convert the YUV frame to RGB frame and display it but i am blocked (it's the first time i use opengl).</p>\n\n<p>I will try to explain clearly what is my problem.</p>\n\n<p>From the NDK android i initialize an opengl context (from the thread i want to use to display images) using this method : </p>\n\n<pre><code>    //\nEGLint attribs[] = {\n        EGL_SURFACE_TYPE, EGL_WINDOW_BIT,\n        EGL_RENDERABLE_TYPE, EGL_OPENGL_ES2_BIT,\n        EGL_BLUE_SIZE, 8,\n        EGL_GREEN_SIZE, 8,\n        EGL_RED_SIZE, 8,\n        EGL_ALPHA_SIZE, 8,\n        EGL_NONE\n};\nEGLint contextAttrs[] = {\n        EGL_CONTEXT_CLIENT_VERSION, 2,\n        EGL_NONE\n};\n\nLOGI(\"Initializing context\");\n\nif((display = eglGetDisplay(EGL_DEFAULT_DISPLAY)) == EGL_NO_DISPLAY)\n{\n    closeContext();\n    return;\n}\n\nif(!eglInitialize(display, 0, 0))\n{\n    closeContext();\n    return;\n}\n\nif(!eglChooseConfig(display, attribs, &amp;config, 1, &amp;numConfigs))\n{\n    closeContext();\n    return;\n}\n\nif(!eglGetConfigAttrib(display, config, EGL_NATIVE_VISUAL_ID, &amp;format))\n{\n    closeContext();\n    return;\n}\n\nANativeWindow_setBuffersGeometry(window, 0, 0, format);\n\nif(!(surface = eglCreateWindowSurface(display, config, window, 0)))\n{\n    closeContext();\n    return;\n}\n\nif(!(context = eglCreateContext(display, config, 0, contextAttrs)))\n{\n    closeContext();\n    return;\n}\n\nif(!eglMakeCurrent(display, surface, surface, context))\n{\n    closeContext();\n    return;\n}\n\nif(!eglQuerySurface(display, surface, EGL_WIDTH, &amp;width) || !eglQuerySurface(display, surface, EGL_HEIGHT, &amp;height))\n{\n    closeContext();\n    return;\n}\n\nLOGI(\"EGLWIDTH : %d EGLHEIGHT : %d \", (int)width, (int)height);\n\nisInitEGLContext = 1;\n</code></pre>\n\n<p>Then i setup the graphics using this method : </p>\n\n<pre><code>    //\n//Load Vertex and Fragment Shader, attach shader and link program\n programId = createProgram(kVertexShader, kFragmentShader);\n LOGI(\"Program id : %d error :  %d\",(int) programId, glGetError());\n\n\nif(!programId)\n{\n    LOGI(\"Could not create program\");\n    return;\n}\n// get index of the generic vertex attribute bound to vPosition\npositionObject = (int) glGetAttribLocation(programId, \"vPosition\");\n\n // get index of the generic vertex attribute bound to vTexCoord\ntexturePosition = (int) glGetAttribLocation(programId, \"vTexCoord\");\n\n// get the location of yTexture within the program (corresponding to   program id)\nyuv_texture_object[0] = glGetUniformLocation(programId, \"yTexture\");\n\n// get the location of uTexture within the program\nyuv_texture_object[1] = glGetUniformLocation(programId, \"uTexture\");\n\n// get the location of vTexture within the program\nyuv_texture_object[2] = glGetUniformLocation(programId, \"vTexture\");\n\n// Setup width of each planes (display size)\nstream_yuv_width[0] = 800;\nstream_yuv_width[1] = 400;\nstream_yuv_width[2] = 400;\n\n// Setup height of each planes (display size)\nstream_yuv_height[0] = 600;\nstream_yuv_height[1] = 300;\nstream_yuv_height[2] = 300;\n\n//set the view port\nglViewport(0,0,stream_yuv_width[0],stream_yuv_height[0]);\nLOGI(\"glViewPort() %d \", glGetError());\n</code></pre>\n\n<p>I have hardcoded the display size (for now) until i get something that work.</p>\n\n<p>The createProgram method, load the shaders, create the program, compile and link the shaders successfully. </p>\n\n<p>Here are my shaders : </p>\n\n<pre><code>const char kVertexShader[] =\n\"attribute vec4 vPosition;\\n\"\n\"attribute vec2 vTexCoord;\\n\"\n\"varying vec2 v_vTexCoord;\\n\"\n\"void main() {\\n\"\n\"gl_Position = vPosition;\\n\"\n\"v_vTexCoord = vTexCoord;\\n\"\n\"}\\n\";\n\nconst char kFragmentShader[] =\n\"precision mediump float; \\n\"\n\"varying vec2 v_vTexCoord;\\n\"\n\"uniform sampler2D yTexture;\\n\"\n\"uniform sampler2D uTexture;\\n\"\n\"uniform sampler2D vTexture;\\n\"\n\"void main() {\\n\"\n\"float nx, ny; \\n\"\n\"nx = v_vTexCoord.x; \\n\"\n\"ny = v_vTexCoord.y; \\n\"\n\"float y=texture2D(yTexture, v_vTexCoord).r;\\n\"\n\"float u=texture2D(uTexture, vec2(nx / 2.0, ny / 2.0)).r;\\n\"\n\"float v=texture2D(vTexture, vec2(nx / 2.0, ny / 2.0)).r;\\n\"\n\"y = 1.1643 * (y - 0.0625);\\n\"\n\"u = u - 0.5; \\n\"\n\"v = v - 0.5; \\n\"\n\"float r=y + 1.5958 * v;\\n\"\n\"float g=y - 0.39173 * u - 0.81290 * v;\\n\"\n\"float b=y + 2.017 * u;\\n\"\n\"gl_FragColor = vec4(r, g, b, 1.0);\\n\"\n\"}\\n\";\n\nconst GLfloat kVertexInformation[] = {\n    -1.0f, 1.0f,           // TexCoord 0 top left\n    -1.0f,-1.0f,           // TexCoord 1 bottom left\n    1.0f,-1.0f,           // TexCoord 2 bottom right\n    1.0f, 1.0f            // TexCoord 3 top right\n};\nconst GLshort kTextureCoordinateInformation[] = {\n    0, 0,         // TexCoord 0 top left\n    0, 1,         // TexCoord 1 bottom left\n    1, 1,         // TexCoord 2 bottom right\n    1, 0          // TexCoord 3 top right  \n};\nconst GLuint kStride = 0;//COORDS_PER_VERTEX * 4;\nconst GLshort kIndicesInformation[] = {\n    0, 1, 2,\n    0, 2, 3\n};\n</code></pre>\n\n<p>Then i setup the yuv textures and the render to textures, at this moment yuv_width[i] and yuv_height[i] are set to correct value: </p>\n\n<pre><code>void setupYUVTexture()\n{\n//Setup the pixel alignement\nglPixelStorei(GL_UNPACK_ALIGNMENT, 1);\nLOGI(\"glPixelStorei() : %d \", glGetError());\nint i = 0;\n\nfor(i = 0 ; i &lt; 3 ; ++i)\n{\n    //Check if the texture already setup\n    if(yuv_texture_id[i] != 0)\n    {\n        glDeleteTextures(1, &amp;yuv_texture_id[i]);\n        yuv_texture_id[i] = 0;\n    }\n    // Active the i texture\n    glActiveTexture(GL_TEXTURE0 + i);\n\n    //Generate the texture name\n    glGenTextures(1, &amp;yuv_texture_id[i]);\n\n    // Bind the texture\n    glBindTexture(GL_TEXTURE_2D, yuv_texture_id[i]);\n\n   // Setup the texture parameters\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);  \n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);   \n    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n\n\n    //Define the texture image\n    glTexImage2D(GL_TEXTURE_2D, 0, GL_LUMINANCE, yuv_width[i], yuv_height[i], 0, GL_LUMINANCE, GL_UNSIGNED_BYTE, NULL);\n    LOGI(\"glTexImage2D() %d \", glGetError());\n}\n}\n\nvoid renderToTexture()\n{\n // Generate framebuffer object name\n    glGenFramebuffers(1, &amp;frameBufferObject);\n    //Bind the framebuffer\n    glBindFramebuffer(GL_FRAMEBUFFER, frameBufferObject);\n\n\n    //Generate render buffer object name\n    glGenRenderbuffers(1, &amp;renderBufferObject);\n\n    //Bind render buffer\n    glBindRenderbuffer(GL_RENDERBUFFER, renderBufferObject);\n\n   //Create and initialize render buffer for display RGBA with the same size of the viewport\n    glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA4, 800, 600);\n\n    //Attach render buffer to frame buffer object\n    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, renderBufferObject);\n\n    //Attach y plane to frame buffer object\n    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, yuv_texture_id[0], 0);\n\n   //Attach u plane to frame buffer object\n    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, yuv_texture_id[1], 0);\n\n     //Attach v plane to frame buffer object\n    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, yuv_texture_id[2], 0);\n\n    // Bind the framebuffer\n    glBindFramebuffer(GL_FRAMEBUFFER, 0);\n\n    //Check if the framebuffer is correctly setup\n    GLint status = glCheckFramebufferStatus(GL_FRAMEBUFFER);\n\n    if(status != GL_FRAMEBUFFER_COMPLETE)\n    {\n        LOGI(\" FBO setting fault : %d \", status);\n        return;\n    }\n}\n</code></pre>\n\n<p>To finish, my draw frame method : </p>\n\n<pre><code>void drawFrame()\n{\nLOGI(\"DrawFrame\");\nglBindFramebuffer(GL_FRAMEBUFFER, frameBufferObject);\nprintGLError(\"glBindFramebuffer\");\nglUseProgram(programId);\nprintGLError(\"glUseProgram\");\nint i = 0;\nfor(i = 0 ; i &lt; 3 ; ++i)\n{\n    glActiveTexture(GL_TEXTURE0 + i);\n    printGLError(\"glActiveTexture\");\n\n    glBindTexture(GL_TEXTURE_2D, yuv_texture_object[i]);\n    printGLError(\"glBindTexture\");\n\n    glUniform1i(yuv_texture_object[i], i);\n    printGLError(\"glUniform1i\");            \n    LOGI(\"Plan : %d Largeur : %d Hauteur : %d \", i, yuv_width[i], yuv_height[i]);\n    glTexSubImage2D(GL_TEXTURE_2D, 0, 0, 0,yuv_width[i], yuv_height[i], GL_LUMINANCE, GL_UNSIGNED_BYTE, yuv_planes[i]);\n            printGLError(\"glTexSubImage2D\");\n\n    }\n\n    glVertexAttribPointer(positionObject, 2, GL_FLOAT, GL_FALSE, kStride, kVertexInformation);\n    printGLError(\"glVertexAttribPointer\");\n\n    glVertexAttribPointer(texturePosition, 2, GL_SHORT, GL_FALSE, kStride, kTextureCoordinateInformation);\n    printGLError(\"glVertexAttribPointer\");\n\n    glEnableVertexAttribArray(positionObject);      \n    printGLError(\"glVertexAttribArray\");\n\n    glEnableVertexAttribArray(texturePosition);\n    printGLError(\"glVertexAttribArray\");\n\n    glBindFramebuffer(GL_FRAMEBUFFER, 0);\n    printGLError(\"glBindFramebuffer\");\n\n    glDrawElements(GL_TRIANGLE_STRIP, 6, GL_UNSIGNED_SHORT, kIndicesInformation);\n    printGLError(\"glDrawElements\");\n\n    eglSwapBuffers(display, surface);\n    printGLError(\"eglSwapBuffers\");\n\n}\n</code></pre>\n\n<p>I initialize once the opengl textures and other attributes which are necessary, then when a frame is decode i recopy y buffer into <code>yuv_planes[0]</code>, u buffer in <code>yuv_planes[ 1]</code> and v buffer in <code>yuv_planes[2]</code>.</p>\n\n<p>Once a frame is correctly decoded using ffmpeg i call in this order :<br>\n- <code>initContext()</code><br>\n- <code>setupGraphics()</code><br>\n- <code>setupYUVTexture()</code><br>\n- <code>renderToTexture()</code>  </p>\n\n<p>then i call <code>drawFrame</code>. Of course, when everything is initialize i call directly drawFrame after each decoded frame.</p>\n\n<p>There is the output i have now.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dKDV5.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/dKDV5.png\" alt=\"Video display by opengl\"></a></p>\n\n<p>The size of the image is correct, but now i am block here. I don't understand why the image display is green !\nAny ideas</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1452681572, "post_id": 34763941, "comment_id": 57273856, "body": "Only start the producer thread, wait until it is blocked, then start the consumer?"}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452681711, "post_id": 34763941, "comment_id": 57273948, "body": "Are there any API functions which lets you just test whenever the queue is full?"}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1452681753, "post_id": 34763941, "comment_id": 57273976, "body": "@EOF - How do I programmatically find out that the producer thread is now blocked? (I am looking for something beyond &quot;<i>wait for an adequate amount of time</i>&quot;)"}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452681779, "post_id": 34763941, "comment_id": 57273996, "body": "@Superlokkus - There is."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452681952, "post_id": 34763941, "comment_id": 57274127, "body": "So what&#39;s the signature of the testing function? Would help very much for referring in an answer."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452682212, "post_id": 34763941, "comment_id": 57274338, "body": "@Superlokkus - You mean the queue write API? Or did you actually mean testing function? (TBH, I don&#39;t see how it would help)."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1452682274, "post_id": 34763941, "comment_id": 57274379, "body": "@work.bin: Have the producer <code>pthread_cond_signal()</code> a thread <code>_cond_wait()</code>ing to become the consumer as it blocks?"}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452682506, "post_id": 34763941, "comment_id": 57274524, "body": "I mean something like <code>bool is_queue_full(const my_queue*)</code>"}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1452682965, "post_id": 34763941, "comment_id": 57274819, "body": "@EOF - Isn&#39;t there a posibility that the <code>_cond_wait() ing</code> thread could commence the read without the producer thread proceeding from the pthread_cond_signal() to the subsequent pthread_cond_wait()? (I am not sure). Anyway, ideally I would like to keep the API function untouched, this _cond_signal() will have to be under same mutex lock used for cond_wait() inside the producer write API."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452683028, "post_id": 34763941, "comment_id": 57274870, "body": "@Superlokkus - There is a similar function which returns a boolean."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1453221282, "post_id": 34763941, "comment_id": 57502071, "body": "As I said in a comment to my answer and due to the new bounty: I would really appreciate if you could name all mutexes and condition variables you use."}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "reply_to_user": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1453222750, "post_id": 34763941, "comment_id": 57503071, "body": "@Superlokkus - Edited the question to provide more details. Pray do tell if this is enough information."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1453374649, "post_id": 34763941, "comment_id": 57577980, "body": "Checkout the edit of my answer"}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1453665678, "post_id": 34763941, "comment_id": 57690626, "body": "An accepted mark for either jxh or my answer would be nice. Or in other words: gimme that sweet reputation, now! :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1452687755, "post_id": 34766121, "comment_id": 57278063, "body": "I have considered this but abandoned this idea since I thought this was CPU intensive. I wanted a cleaner way to achieve this i.e. not busy-read the queue status."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1452688336, "post_id": 34766121, "comment_id": 57278492, "body": "This is only achievable if you can want to or are allowed to or able to write your own <code>is_queue_full</code>. Also that busy-waiting shouldn&#39;t be that bad in your non-productive test-code. But since this seems to be your own queue, we could write an async approach. Could you give me the names of your mutexes and condition to check the &quot;fullness&quot;?"}, {"owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1452758363, "post_id": 34766121, "comment_id": 57312656, "body": "I am kind of arriving at the conclusion that there is no proper way of doing this without having to modify the Queue APIs itself. Therefore I would prefer the above method. However I want to consider your opinion on <code>while (!is_queue_full(q)) pthread_yield();</code> - is this an improvement?"}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1453118296, "post_id": 34766121, "comment_id": 57447797, "body": "@work.bin Could be, but I guess it actually depends on your system, because it has a advantage but also one disadvantage. Pro: Gives the schedeuler a hint to give the CPU to other tasks, i.e. your producers Con: You will call a whole function every loop iteration. The overhead to call a function alone are a handfull machine instructions, yet the maybe complex <code>pthread_yield()</code> body.  I personally would just stick to <code>while (!is_queue_full(q));</code> because the next logical step would be just to avoid busy waiting. But it&#39;s worth to profile/measure."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "edited": false, "score": 0, "creation_date": 1453129922, "post_id": 34766121, "comment_id": 57455302, "body": "I changed my default advice to recommend your way, with <code>while (!is_queue_full(q)) pthread_yield();</code>,due this approach is AFAIK more likely to prevent <i>priority inversion</i>"}], "tags": [], "owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "is_accepted": false, "score": 1, "last_activity_date": 1453377250, "last_edit_date": 1453377250, "creation_date": 1452686283, "answer_id": 34766121, "question_id": 34763941, "link": "https://stackoverflow.com/questions/34763941/how-do-i-schedule-a-pthread-cond-signal-such-that-it-always-follows-a-pthread/34766121#34766121", "title": "How do I schedule a pthread_cond_signal() such that it always follows a pthread_cond_wait() on another thread?", "body": "<p><strong>Edited</strong> (Be aware that error handling of the pthread calls were omitted) </p>\n\n<p>You can achieve this by testing if the queue is full, with the function you mentioned in the comments. For this answer I will assume it's <code>bool is_queue_full(const queue*)</code>.</p>\n\n<p>In your test case you can guarantee scenario 3, by creating the producer and create a consumer, if and only if, after the queue is full. Like\n    bool is_queue_full(queue*); //Must not use the mutex itself, maybe mark it just for intern use</p>\n\n<pre><code>struct queue {\n    /* Actual queue stuff */\n    pthread_mutex_t queue_mutex;\n    pthread_cond_t read_condvar;\n    pthread_cond_t write_condvar;\n};\n\nvoid wait_until_queue_is_full (queue *q) {\n\n    pthread_mutex_lock(&amp;q-&gt;queue_mutex);\n    while (!is_queue_full(q)){ //Use in loop because of Spurious wakeups\n        pthread_cond_wait(&amp;q-&gt;write_condvar,&amp;q-&gt;queue_mutex);\n    }\n    pthread_mutex_unlock(&amp;q-&gt;queue_mutex);\n}\n\nbool test_writer_woke_up(queue *q);\n\nbool test_case(){\n    queue *q = create_queue();\n    producer *p = create_producer(q);\n\n    wait_until_queue_is_full(q);\n\n    return test_writer_woke_up(q); //or cache the result and destroy your queue, but if your testrunner process will quit anyway...\n}\n</code></pre>\n\n<p><code>wait_until_queue_is_full</code> will just check if the queue is full, and if not, will wait, like any reader, until your writer aka producer has made it full. Then your testcase can produce the consumers with something like <code>test_writer_woke_up</code>\n    void intern_consume_stuff(queue <em>q); /</em> Your intern function that takes stuff from the queue, \n    but doesen't care about the sychronization aka mutexes and condvar*/</p>\n\n<pre><code>bool test_writer_woke_up(queue *q){\n    pthread_mutex_lock(&amp;q-&gt;queue_mutex); //Could be omitted in this testcase (together with the 1 unlock below of course)\n    void intern_consume_stuff(queue *q);\n    pthread_mutex_unlock(&amp;q-&gt;queue_mutex); //Could be omitted in this testcase (together with the 1 lock above of course)\n    pthread_cond_signal(&amp;q-&gt;read_condvar);\n\n    /* Adjust these as you like to give your producer/writer time to wake up and produce something \n    */\n    unsigned retry_count = 5;\n    unsigned sleep_time = 1; \n\n    //timed cond wait approach\n    for (; retry_count &gt; 0; --retry_count){\n        pthread_mutex_lock(&amp;q-&gt;queue_mutex);\n        struct timespec ts;\n        clock_gettime(CLOCK_REALTIME, &amp;ts);\n        ts.tv_sec += sleep_time;\n        int timed_cond_rc = 0;\n        while (!is_queue_full(q) &amp;&amp; timed_cond_rc == 0) {\n            timed_cond_rc = pthread_cond_timedwait(&amp;q-&gt;write_condvar, &amp;q-&gt;queue_mutex, &amp;ts);\n        }\n        if (is_queue_full(q)) {\n            pthread_mutex_unlock(&amp;q-&gt;queue_mutex);\n            return true;\n        }\n        assert(timed_cond_rc == ETIMEDOUT);\n        continue;\n    }\n    return false;\n}\n</code></pre>\n\n<p>If have used the absolute time waiting, because you had to recompute relative timings, or to simplify things you could replace the for loop with this naive approach</p>\n\n<pre><code>//naive busy approach\nfor (; retry_count &gt; 0; --retry_count){\n    pthread_mutex_lock(q-&gt;queue_mutex);\n    const bool queue_full_result = is_queue_full(q);\n    pthread_mutex_unlock(q-&gt;queue_mutex);\n\n    if (queue_full_result){\n        return true;\n    } else {\n        pthread_yield();\n        sleep(sleep_time);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 2, "last_activity_date": 1453231342, "last_edit_date": 1453231342, "creation_date": 1453216522, "answer_id": 34880397, "question_id": 34763941, "link": "https://stackoverflow.com/questions/34763941/how-do-i-schedule-a-pthread-cond-signal-such-that-it-always-follows-a-pthread/34880397#34880397", "title": "How do I schedule a pthread_cond_signal() such that it always follows a pthread_cond_wait() on another thread?", "body": "<p>Since your queue uses <code>pthread_cond_signal</code>, it must be holding a lock as well. So your test case should simply hold the lock, create the producer, and then wait for the signal. After the producer generates the signal, release the lock, and create a consumer.</p>\n\n<pre><code>void test () {\n    pthread_mutex_lock(q_lock);\n    //     Blocks on the same queue lock the producer and\n    //     consumer would use.\n    create_producer();\n    //     The producer will block on the queue lock when\n    //     it tries to write to the queue.\n    do {\n        pthread_cond_wait(q_write_cond, q_lock);\n        // Mimic a blocked queue_read, and wait for the\n        // producer to signal. This will release the lock\n        // and allow the producer to progress.\n    } while (!q_is_full());\n    //     The queue is now full, lock is held since\n    //     pthread_cond_wait returned.\n    pthread_mutex_unlock(q_lock);\n    //     Release the queue lock, allow the consumer to\n    //     operate unhindered.\n    create_consumer();\n    //     The consumer will proceed to drain the queue.\n}\n</code></pre>\n"}], "owner": {"reputation": 1038, "user_id": 3789460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f5f2abcd560dd9936127551eb8b67d42?s=128&d=identicon&r=PG&f=1", "display_name": "work.bin", "link": "https://stackoverflow.com/users/3789460/work-bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 1, "answer_count": 2, "score": 12, "last_activity_date": 1453377250, "creation_date": 1452680136, "last_edit_date": 1453222686, "question_id": 34763941, "link": "https://stackoverflow.com/questions/34763941/how-do-i-schedule-a-pthread-cond-signal-such-that-it-always-follows-a-pthread", "title": "How do I schedule a pthread_cond_signal() such that it always follows a pthread_cond_wait() on another thread?", "body": "<p>I am testing a producer-consumer scenario where the producer blocks when it tries to write on a queue which is full. I want to test that the producer thread wakes up properly and works as per expectation after the consumer reads from the full queue*. The queue write API calls pthread_cond_wait() on detecting queue full and the read API signals the conditional variable after reading from the queue.</p>\n\n<p>How do I ensure the occurrence of <strong>Sequence 3</strong> over any other sequence of operations in my test environment?</p>\n\n<p><a href=\"https://i.stack.imgur.com/InQ3G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/InQ3G.png\" alt=\"enter image description here\"></a></p>\n\n<p>* <em>Yes I want to test this limited scenario separately; there are other tests which do test the functionality of the whole queue, this test is in addition to those.</em></p>\n\n<blockquote>\n  <p>More details -<br>\n  There is a single mutex governing the queue. There\n  are 2 conditional variables - one to signal write (all writes), one to\n  signal read (all reads). The <strong>queue_write API blocks on the read\n  condvar</strong> if the queue is full. The <strong>queue_read API blocks on the\n  write condvar</strong> if the queue is empty. All signalling happens under\n  the aegis of the mutex.<br>\n  <em>There is a lot more nuance in the queue but\n  for the purpose of setting context for this question this is an\n  adequate summary of the queue's functioning.</em></p>\n</blockquote>\n"}, {"tags": ["c", "linux", "recursion", "directory"], "comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 4, "creation_date": 1452679737, "post_id": 34763491, "comment_id": 57272564, "body": "Is this a &quot;please debug my code&quot; question? You could, for instance, tell what happens when you run it, and what you expect to happen. You could also comment the code a little, so the reader doesn&#39;t have to guess. Is this code using nested functions, or what is this? And you could try to format your code. It is not easily readable."}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1452680182, "post_id": 34763491, "comment_id": 57272887, "body": "you are writing functions block inside main.!!!!"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1452681106, "post_id": 34763491, "comment_id": 57273511, "body": "Look at the <code>nftw()</code> function, it&#39;s going to be super useful for your purpose."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452681175, "post_id": 34763491, "comment_id": 57273566, "body": "Also, <code>(buf.st_mode &amp; S_IFDIR)</code> is wrong. Write <code>S_ISDIR(buf.st_mode)</code> instead."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1452681597, "post_id": 34763491, "comment_id": 57273880, "body": "First of all you should indent your program properly."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1452681682, "post_id": 34763491, "comment_id": 57273929, "body": "Did you even try to debug your code, for example by in serting <code>printf</code>s at strategic points ? And your statement &quot;it doesn&#39;t seem to work&quot; is nonsense. Either it works or it doesn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 3012, "user_id": 1182783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/057cdd9cf7b633503dee43ba597c64e7?s=128&d=identicon&r=PG", "display_name": "jofel", "link": "https://stackoverflow.com/users/1182783/jofel"}, "is_accepted": true, "score": 1, "last_activity_date": 1452680120, "last_edit_date": 1452680120, "creation_date": 1452679807, "answer_id": 34763822, "question_id": 34763491, "link": "https://stackoverflow.com/questions/34763491/recursively-delete-a-directory-in-c/34763822#34763822", "title": "Recursively delete a directory in C", "body": "<p>You are missing a call to the function you implement:\nyour <code>main()</code> functions does nothing except checking the argument count.</p>\n\n<p>You need something like <code>delete_dir(argv[1]);</code> in the main function.</p>\n\n<p>There is also a mistake with a space:</p>\n\n<p>It need to be </p>\n\n<pre><code>snprintf (chBuf, 256, \"%s/%s\", dirname, ptr-&gt; d_name);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>snprintf (chBuf, 256, \"%s /%s\", dirname, ptr-&gt; d_name);\n</code></pre>\n\n<p>Nesting functions is usually not a good style in C\nalthough it works with some compilers.</p>\n\n<p>In general, a easy way to debug your code is add <code>printf</code> statements.</p>\n"}], "owner": {"reputation": 71, "user_id": 5601134, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/196a6eb328c1847657514adfbec08f89?s=128&d=identicon&r=PG&f=1", "display_name": "locket23", "link": "https://stackoverflow.com/users/5601134/locket23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 34763822, "answer_count": 1, "score": 0, "last_activity_date": 1452680120, "creation_date": 1452679031, "last_edit_date": 1452679988, "question_id": 34763491, "link": "https://stackoverflow.com/questions/34763491/recursively-delete-a-directory-in-c", "title": "Recursively delete a directory in C", "body": "<p>I have to delete recursively a directory which is not necessarily empty in C for my OS class. I tried to do so ,but it doesn't seem to work . I don't have errors in my code when I compile it though. Any suggestions would help me a lot .    </p>\n\n<pre><code> #include &lt;stdio.h&gt; \n #include &lt;sys/stat.h&gt;\n #include &lt;dirent.h&gt; \n\n\nint main(int argc,char* argv[])\n{ \n\n\n   if (argc&lt;2) {\n              printf(\"Wrong numer of arguments\\n\");\n              return 1;\n               }\n\n\n int is_dir (char * filename) \n  { \n    struct stat buf; \n    int ret = stat (filename, &amp; buf); \n    if (0 == ret) \n     { \n       if (buf.st_mode &amp; S_IFDIR) \n        { \n          return 0; \n        } \n      else \n       { \n         return 1; \n       } \n    } \n     return -1; \n  }\n\n  int delete_dir (char * dirname) \n   { \n      char chBuf [256]; \n      DIR * dir = NULL; \n      struct dirent * ptr; \n      int ret = 0; \n     dir = opendir (dirname); \n     if (NULL == dir) \n      { \n        return -1; \n} \n   while ((ptr = readdir (dir))!= NULL) \n    { \n      ret = strcmp (ptr-&gt; d_name, \".\"); \n      if (0 == ret) \n   { \n    continue; \n   } \n   ret = strcmp (ptr-&gt; d_name, \"..\"); \n   if (0 == ret) \n    { \n      continue; \n    } \n     snprintf (chBuf, 256, \"%s /%s\", dirname, ptr-&gt; d_name); \n     ret = is_dir (chBuf); \n     if (0 == ret) \n     {   \n       ret = delete_dir(chBuf); \n      if (0!=ret) \n       { \n         return -1; \n    } \n} \n    else if (1 == ret) \n     {  \n      ret = remove (chBuf); \n     if (0!=ret)  \n      { \n        return -1; \n    }  \n  } \n}\n  closedir (dir); \n\n  ret = remove (dirname); \n  if (0!= ret) \n   { \n    return -1; \n   } \n  return 0; \n } \n}\n</code></pre>\n\n<p>Thanks !                                                                                      </p>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array", "malloc"], "comments": [{"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1452678825, "post_id": 34763295, "comment_id": 57271902, "body": "Multiply <code>M * N * sizeof (int)</code> and do <code>malloc</code> for such memory block. M and N are number of elements in each dimension."}], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1452681053, "post_id": 34763412, "comment_id": 57273471, "body": "Really cool idea using variable length arrays like this. For those who don&#39;t know, \u201cancient compiler\u201d means \u201cpre C99 compiler\u201d such as MSVC."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1452681001, "last_edit_date": 1452681001, "creation_date": 1452678821, "answer_id": 34763412, "question_id": 34763295, "link": "https://stackoverflow.com/questions/34763295/allocate-memory-for-two-dimensional-array-of-integers-but-it-should-be-continuou/34763412#34763412", "title": "Allocate memory for two dimensional array of integers but it should be continuous", "body": "<p>Formally, it is done like this:</p>\n\n<pre><code>int (*arr_ptr) [x][y] = malloc( sizeof(int[x][y]) );\n\n(*arr_ptr)[i][j] = something; // access one element\n\nfree(arr_ptr);\n</code></pre>\n\n<p>However, this makes access of the elements a bit inconvenient: <code>(*arr_ptr)[i][j]</code> is a bit hard to read. A trick to avoid this, is to leave out one dimension of the array pointer and instead regard it as an array of one-dimensional arrays:</p>\n\n<pre><code>int (*arr_ptr) [y] = malloc( sizeof(int[x][y]) );\n\narr_ptr[i][j] = something; // access one element\n\nfree(arr_ptr);\n</code></pre>\n\n<p>If you have an ancient compiler, you must create a more ugly, \"mangled\" 2D array:</p>\n\n<pre><code>int* ptr = malloc( sizeof(int) * x * y );\n\nptr[i*y + j] = something; // access one element\n\nfree(ptr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1452679088, "creation_date": 1452679088, "answer_id": 34763521, "question_id": 34763295, "link": "https://stackoverflow.com/questions/34763295/allocate-memory-for-two-dimensional-array-of-integers-but-it-should-be-continuou/34763521#34763521", "title": "Allocate memory for two dimensional array of integers but it should be continuous", "body": "<p>If your compiler supports Variable Length Arrays (VLAs) then you can write the following way</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main( void )\n{\n    size_t m = 3;\n    size_t n = 4;\n\n    int ( *a )[n] = malloc( m * n * sizeof( int ) );\n\n    for ( size_t i = 0; i &lt; m; i++ )\n    {\n        for ( size_t j = 0; j &lt; n; j++ ) a[i][j] = i * n + j;\n    }        \n\n    for ( size_t i = 0; i &lt; m; i++ )\n    {\n        for ( size_t j = 0; j &lt; n; j++ ) printf( \"%2d \", a[i][j] );\n        printf( \"\\n\" );\n    }        \n\n    free( a );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code> 0  1  2  3 \n 4  5  6  7 \n 8  9 10 11 \n</code></pre>\n\n<p>Otherwise <code>n</code> must be a constant. For example</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define N 4\n\nint main( void )\n{\n    size_t m = 3;\n\n    int ( *a )[N] = malloc( m * N * sizeof( int ) );\n\n    for ( size_t i = 0; i &lt; m; i++ )\n    {\n        for ( size_t j = 0; j &lt; N; j++ ) a[i][j] = i * N + j;\n    }        \n\n    for ( size_t i = 0; i &lt; m; i++ )\n    {\n        for ( size_t j = 0; j &lt; N; j++ ) printf( \"%2d \", a[i][j] );\n        printf( \"\\n\" );\n    }        \n\n    free( a );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "is_accepted": false, "score": 0, "last_activity_date": 1452761009, "last_edit_date": 1452761009, "creation_date": 1452680024, "answer_id": 34763894, "question_id": 34763295, "link": "https://stackoverflow.com/questions/34763295/allocate-memory-for-two-dimensional-array-of-integers-but-it-should-be-continuou/34763894#34763894", "title": "Allocate memory for two dimensional array of integers but it should be continuous", "body": "<p>Another possibility is to use a one dimensional array as a two dimensional one, like in the following example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define N 2\n#define M 3\n\n/*\n   array has N * M elemts:\n\n   |    N    |    N    |    N    |\n   v         v         v         v\n   |----|----|----|----|----|----|\n\n\n   array[i][j] == array[i*N + j]\n*/\n\n#define GET(i,j) (i*N + j)\n\n\nint main(int argc, char **argv) {\n\n    int *array;\n    int i, j;\n\n    array = malloc(N * M *sizeof(int));\n\n\n    for (i = 0; i &lt; N; i++)\n        for (j = 0; j &lt; M; j++)\n            array[i*N + j] = i+j;\n\n    for (i = 0; i &lt; N; i++)\n        for (j = 0; j &lt; M; j++)\n            printf(\"array[%d][%d] = %d\\n\", i, j, array[i*N + j]);\n\n    printf(\"Using the macro:\\n\");\n    for (i = 0; i &lt; N; i++)\n        for (j = 0; j &lt; M; j++)\n            printf(\"array[%d][%d] = %d\\n\", i, j, array[GET(i,j)]);\n\n    free(array);\n\n    return 0;\n}\n</code></pre>\n\n<p>I also defined a macro <code>GET(i,j)</code> so that the code will be more readable, actually this is really needed only to handle more complex cases then the two dimensional one.</p>\n"}], "owner": {"reputation": 37, "user_id": 4291124, "user_type": "registered", "profile_image": "https://graph.facebook.com/1052490737/picture?type=large", "display_name": "Ravinder Patel", "link": "https://stackoverflow.com/users/4291124/ravinder-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1452761009, "creation_date": 1452678534, "last_edit_date": 1452684617, "question_id": 34763295, "link": "https://stackoverflow.com/questions/34763295/allocate-memory-for-two-dimensional-array-of-integers-but-it-should-be-continuou", "title": "Allocate memory for two dimensional array of integers but it should be continuous", "body": "<p>I want to allocate memory to two dimensional array of type <code>int</code> but, the memory should be continuous.</p>\n\n<p>it should be freed by just making one call to <code>free( ptr )</code>. I should need not to call free to each block of memory.</p>\n"}, {"tags": ["c", "tcp", "serversocket"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1452678117, "post_id": 34763014, "comment_id": 57271371, "body": "Your client should close the corresponding socket file descriptor either explicitly (by calling <code>close(fd)</code>) or implicitly (by terminating) to move the connection out of <code>CLOSE_WAIT</code>.  However, this is unrelated to the crash. For your server the connection is completely finished after closing it. You need to provide more context to analyze the crash"}, {"owner": {"reputation": 149, "user_id": 5335302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/966601076714268/picture?type=large", "display_name": "user5335302", "link": "https://stackoverflow.com/users/5335302/user5335302"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1452679146, "post_id": 34763014, "comment_id": 57272154, "body": "@Ctx after the timeout is reached, the server fd is terminated. next i started the client, server accepts the msg and same msg is checked twice and enters in recv() 0 to terminate the server"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452709267, "post_id": 34763014, "comment_id": 57293333, "body": "the posted code fails to &#39;clear&#39; the array: <code>value_data</code>,  That would be where I would start.  After calling <code>AFREE()</code> (what is that function?) then need to set any left over pointer(s) to those `AFREE&#39;d areas to NULL, so they can be checked and not accessed again."}], "owner": {"reputation": 149, "user_id": 5335302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/966601076714268/picture?type=large", "display_name": "user5335302", "link": "https://stackoverflow.com/users/5335302/user5335302"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452678250, "creation_date": 1452677782, "last_edit_date": 1452678250, "question_id": 34763014, "link": "https://stackoverflow.com/questions/34763014/closing-the-client-after-the-file-descriptor-in-server-is-closed-using-closefd", "title": "closing the client after the file descriptor in server is closed using close(fd) in server", "body": "<p>I have a scenario to close the connection in server if the client is inactive for say about 120 sec.  It is intended such that I could reuse the fd after certain time inactivity.so I wrote a code to close the file descripter using</p>\n\n<pre><code> if ((int)time(NULL) - (int)value_data-&gt;timeout &gt; 120)\n        {\n\n          zlog_warn(_c,\"timeout of 120s for  device = %s\",key);\n          close(value_data-&gt;fd);\n\n          g_hash_table_iter_remove (&amp;iter);\n          (*_collector_free_tcp_cache_cb)(value_data-&gt;device_ip, value_data-&gt;fd); \n\n          AFREE(value_data-&gt;device_ip);\n          AFREE(value_data);\n\n\n\n        }\n</code></pre>\n\n<p>using close(fd), in server side the connection fd is closed. The problem I am facing is after next time the client is connected, the server is crashed. The client is not able to send the data. While looking in the tcp client side, it gives information that the Tcp is in </p>\n\n<pre><code>TCP 192.168.2.138:50296-&gt;192.168.2.161:shell (CLOSE_WAIT)\n</code></pre>\n\n<p>how can i send the data starting  next client again? is there certain time I need to wait such  that the same fd can be reused to send the data.?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 2, "creation_date": 1452677324, "post_id": 34762801, "comment_id": 57270798, "body": "<code>scanf()</code> will not work for this. Better read the whole line using <code>fgets()</code> and then process it."}, {"owner": {"reputation": 556, "user_id": 5716914, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/837f60330638e77a84db717f31aa32de?s=128&d=identicon&r=PG&f=1", "display_name": "Johnyb", "link": "https://stackoverflow.com/users/5716914/johnyb"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1452678273, "post_id": 34762801, "comment_id": 57271479, "body": "how could i process is? Thats the main question , thats why i used scanf so bcs nothing came to my mind."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1452678542, "post_id": 34762801, "comment_id": 57271693, "body": "after you read the line in a <code>char</code> array, go through the characters one by one and store them in the array when you encounter a number."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452883717, "post_id": 34762801, "comment_id": 57377683, "body": "are their multiple lines of input or only a single line? Do you want the saved array to contain text values or <code>int</code> values?  Can you assume the input is formatted correctly?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1452884214, "post_id": 34762801, "comment_id": 57377949, "body": "you could use <code>getline()</code> or <code>readline()</code> to input the whole line at once.  Then implement a state machine that has states like: <code>find{</code> <code>find[</code> <code>findint</code> <code>find,</code> <code>find]</code> and <code>find}</code>  <code>extractint</code> then link those states together with appropriate state transition code.  the code would scan the line, char by char.   be sure to handle errors, like when the expected next state is not foundThe rest should be easy."}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 4621761, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/OeIZl.jpg?s=128&g=1", "display_name": "sharp_c-tudent", "link": "https://stackoverflow.com/users/4621761/sharp-c-tudent"}, "is_accepted": false, "score": 1, "last_activity_date": 1452679696, "last_edit_date": 1452679696, "creation_date": 1452678964, "answer_id": 34763470, "question_id": 34762801, "link": "https://stackoverflow.com/questions/34762801/load-numbers-from-input-into-array/34763470#34763470", "title": "Load numbers from input into array", "body": "<p>You should use gets instead of scanf. gets will return the entire string wich will be easear. Then you ahould read about strtok wich can be used to separate a string. For example: strtok(s,\",\") will separate your string into smaller strings. For the input {[12,4], [8,9]} will divide into: first string: {[12  second string: 4]  third string [8 and fourth string 9]}. Now you will just have to remove the characters that are not numbers like { } and []. After that you will have strings only with the numbers so you can use another predefined fuction you should read abput called atoi. It recieves a string and turns it into an int (ascci to int). There is also an atof (ascci to float) if you need it. Tuturialpoints is a good place to look for examples on how to use these functions i mentioned.</p>\n"}, {"comments": [{"owner": {"reputation": 726, "user_id": 5699135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELexL.png?s=128&g=1", "display_name": "birdoftheday", "link": "https://stackoverflow.com/users/5699135/birdoftheday"}, "edited": false, "score": 0, "creation_date": 1452691464, "post_id": 34763839, "comment_id": 57280528, "body": "How do you know they are using Visual Studio?"}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 726, "user_id": 5699135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELexL.png?s=128&g=1", "display_name": "birdoftheday", "link": "https://stackoverflow.com/users/5699135/birdoftheday"}, "edited": false, "score": 0, "creation_date": 1452693161, "post_id": 34763839, "comment_id": 57281682, "body": "I don&#39;t understand the down vote on the question.  I actually don&#39;t think they are using Visual Studio, but that&#39;s what I have to test the solution.  There are relatively few changes to make to use in some other environment.  Like the quotes around the include files may need to replaced by angle brackets.  The &quot;strtok_s&quot; needs to be replaced with &quot;strtok&quot; and the &amp;NxtTok variable needs to be removed.  I don&#39;t know other environments to say for certain these are the only changes, but it should be close enough for government work."}, {"owner": {"reputation": 726, "user_id": 5699135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELexL.png?s=128&g=1", "display_name": "birdoftheday", "link": "https://stackoverflow.com/users/5699135/birdoftheday"}, "edited": false, "score": 0, "creation_date": 1452694029, "post_id": 34763839, "comment_id": 57282312, "body": "So then why not use standard C?"}, {"owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "reply_to_user": {"reputation": 726, "user_id": 5699135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELexL.png?s=128&g=1", "display_name": "birdoftheday", "link": "https://stackoverflow.com/users/5699135/birdoftheday"}, "edited": false, "score": 0, "creation_date": 1452694277, "post_id": 34763839, "comment_id": 57282498, "body": "I don&#39;t have a standard C compiler, just a Visual Studio compiler.  That&#39;s what I used to test the solution.  So I don&#39;t understand the down vote on the answer."}], "tags": [], "owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "is_accepted": false, "score": 1, "last_activity_date": 1452693359, "last_edit_date": 1452693359, "creation_date": 1452679867, "answer_id": 34763839, "question_id": 34762801, "link": "https://stackoverflow.com/questions/34762801/load-numbers-from-input-into-array/34763839#34763839", "title": "Load numbers from input into array", "body": "<p>I'm relatively new to C and SO.  Maybe I shouldn't give you the solution, but I did.  It follows the advice of sharp c student.</p>\n\n<p>You could try to do it like this:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"string.h\"\n#include \"stdlib.h\"\n\n#define MAXNBRELM 10    //  maximum number of elements; adjust as needed\n\nint main()\n{\n    int     IntArr[MAXNBRELM][2];   //  integer array to hold results\n    int     s = 0;                  //  subscript\n    int     NbrElm;                 //  number of elements found\n    char    Buf[81];                //  buffer to hold input\n    char    * StrPtr;               //  pointer to string for fgets         \n    char    * TknChr;               //  each individual token\n    char    * NxtTkn;               //  next token position (only needed for Visual C++)\n\n    StrPtr = fgets(Buf, 80, stdin);\n\n    TknChr = strtok_s(Buf, \" {[,]}\", &amp;NxtTkn);\n    while (s &lt;= MAXNBRELM &amp;&amp; TknChr != NULL) {\n        IntArr[s][0] = atoi(TknChr);\n        TknChr = strtok_s(NULL, \" {[,]}\", &amp;NxtTkn);\n        if (TknChr != NULL) {\n            IntArr[s][1] = atoi(TknChr);\n            TknChr = strtok_s(NULL, \" {[,]}\", &amp;NxtTkn);\n            s++;\n        }\n    }\n\n    NbrElm = s;\n    for (s = 0; s &lt; NbrElm; s++)\n        printf(\"%d %d\\n\", IntArr[s][0], IntArr[s][1]);\n\n    return 0;\n}\n</code></pre>\n\n<p>This is for Visual Studio, is why I needed to use strtok<strong>_s</strong> and &amp;NxtTkn.</p>\n"}], "owner": {"reputation": 556, "user_id": 5716914, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/837f60330638e77a84db717f31aa32de?s=128&d=identicon&r=PG&f=1", "display_name": "Johnyb", "link": "https://stackoverflow.com/users/5716914/johnyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1452693359, "creation_date": 1452677199, "last_edit_date": 1452678947, "question_id": 34762801, "link": "https://stackoverflow.com/questions/34762801/load-numbers-from-input-into-array", "title": "Load numbers from input into array", "body": "<p>I have given input which contains data that I am going to process and saved into an array. The input looks like this :</p>\n\n<pre><code>{ [1, 10], [2,1] , [-10, 20] }\n</code></pre>\n\n<p>it can have more elements in it. I need to process it that I can load all numbers from [ number , number ] into 2d array , first number should be at 0th and second number should be at 1st index so this array should look like</p>\n\n<pre><code>[[1,10],[2,1],[-10,20]]\n</code></pre>\n\n<p>But I've failed to find the solution, how to process this input into my desired array. What is the right way to do it?\nI tried to do as following:</p>\n\n<pre><code>   int main()\n{\n    long long int cisla[10][2];\n    int x;\n    int y;\n    int i;\n    int index=0;\n    int counter=0;\n    char c;\n    char zatvorka_one;\n    char zatvorka_three;\n    char ciarka;\n    char ciarka_two;\n    printf(\"Pozicia nepriatela\\n\");\n    c=getchar();\n    if(c!='{'){\n           return 0;\n    }\n    scanf(\" %c%d,%d%c\",&amp;ciarka,&amp;x,&amp;y,&amp;zatvorka_one);\n    cisla[index][0]=x;\n    cisla[index][1]=y;\n    index++;\n    while(1){\n        scanf(\"%c\",&amp;ciarka);\n        if(ciarka=='}'){\n            break;\n        }\n       scanf(\" %c%d%,%d%c\",&amp;ciarka,&amp;x,&amp;y,&amp;zatvorka_one);\n       cisla[index][0]=x;\n       cisla[index][1]=y;\n       index++;\n    }\n    for ( i = 0; i &lt; index; i++){\n    printf(\"%d %d\\n\",cisla[i][0],cisla[i][1]);\n}\n}\n</code></pre>\n\n<p>But somehow it returns unexpected result, how can i fix it?</p>\n"}, {"tags": ["c++", "c", "auto"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1452677124, "post_id": 34762708, "comment_id": 57270655, "body": "The meaning of the <code>auto</code> keyword changed in C++11, it&#39;s no longer a storage-class, but is used for type deduction."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1452677356, "post_id": 34762708, "comment_id": 57270816, "body": "its the first time I hear about <code>auto</code> in C, thus I was curious and found this <a href=\"http://stackoverflow.com/a/2192761/4117728\">answer</a> that basically states, that in C you actually never use the keyword. Thus i guess it is not such a big deal that C++11 changed its meaning."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1452677456, "post_id": 34762708, "comment_id": 57270887, "body": "It&#39;s a completely retarded decision, really. Why couldn&#39;t they just come up with a new keyword?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1452677552, "post_id": 34762708, "comment_id": 57270964, "body": "@Lundin C and C++ are two different languages, so why should they? And new keywords can break existing program so the Standard Committee tries to avoid introducing them whenever possible. Reusing a keyword that was hardy ever used was expedient."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1452677592, "post_id": 34762708, "comment_id": 57270995, "body": "@RichardCritten Because <code>auto</code> has a different meaning in C++ prior C++11? It has nothing to do with C. How does <i>changing the meaning</i> of a keyword break the program less than introducing a completely new one?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1452677779, "post_id": 34762708, "comment_id": 57271127, "body": "@Lundin: Adding a new keyword is not easy as it may broke existing code in <i>unpredictable</i> way (the new keyword may be already used by user as variable, type, macro, ...), whereas reusing <code>auto</code>, it may still break code but in a predictable way."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1452677869, "post_id": 34762708, "comment_id": 57271186, "body": "@Lundin Introducing a new keyword could break existing, valid C++ code. Changing the meaning or <code>auto</code> is much less likely, easy to detect, and easy to fix. <code>auto</code> really had no use in C++ and was deprecated."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1452677997, "post_id": 34762708, "comment_id": 57271271, "body": "@tobi303: But it is not invalid if you would use auto. even if I aggree no one actually should. But if some one did in a valid way and then changes to the newer version without noticing, the behavior of the code may silently change, thats what I&#39;m wondering about. see: <a href=\"http://stackoverflow.com/a/34763081/2003898\">stackoverflow.com/a/34763081/2003898</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1452678052, "post_id": 34762708, "comment_id": 57271312, "body": "But C++11 does not seem the slightest concerned about backwards-compatible anywhere else, so why here? So I think that rationale is complete nonsense. The need for the C++11 <code>auto</code> feature to begin with is very questionable. They just like to come up with new features for the sake of doing so."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1452678103, "post_id": 34762708, "comment_id": 57271353, "body": "@tobi303: additional, there are so many keywords reserved by all the multiple isntances of <code>_</code> could just take one of these."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1452678150, "post_id": 34762708, "comment_id": 57271388, "body": "C++11 was very concerned about backwards compatibility.  In practise, &quot;auto&quot; was very, <i>very</i>, <i>VERY</i> rarely used in C++ code, and any new keyword would be much more likely to conflict with user code.  Any other examples of backwards incompatability?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1452678332, "post_id": 34762708, "comment_id": 57271534, "body": "@MartinBonner Pick some random C++ feature and search cplusplus.com. You&#39;ll likely find numerous different tabs for different versions of the C++ language, because they are non-compatible. <a href=\"http://www.cplusplus.com/reference/functional/less/\" rel=\"nofollow noreferrer\">Random example</a>."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1452679906, "post_id": 34762708, "comment_id": 57272685, "body": "New library functions are not backwards-incompatible.  Old code continues to work with new libraries.  As to your example, artificially constructed code can distinguish the new and old definitions - but real code will continue to work."}, {"owner": {"reputation": 180, "user_id": 4622036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7017ff0e3d771241de81c957caface9e?s=128&d=identicon&r=PG", "display_name": "Kryssel Tillada", "link": "https://stackoverflow.com/users/4622036/kryssel-tillada"}, "edited": false, "score": 0, "creation_date": 1452682927, "post_id": 34762708, "comment_id": 57274797, "body": "dont confuse with auto in c and c++ auto in c automatic storage and in c++ it deduces a the value of what type it can be"}], "answers": [{"tags": [], "owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "is_accepted": false, "score": 8, "last_activity_date": 1452677553, "creation_date": 1452677553, "answer_id": 34762931, "question_id": 34762708, "link": "https://stackoverflow.com/questions/34762708/does-auto-do-something-complete-different-in-c-as-in-c/34762931#34762931", "title": "Does auto do something complete different in C++ as in C?", "body": "<p>As of c++11 auto means to infer the type. It was used because adding a new keyword would have caused more c++ programs to break. As a storage specifier, auto is useless because it is the default if no specifier is added.</p>\n\n<p>The only alternative was to follow the approach used in C generics of using a name starting with an underscore. This would have lead to an ugly keyword, that is meant to be regularly used.</p>\n"}], "owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452677553, "creation_date": 1452676925, "last_edit_date": 1495542213, "question_id": 34762708, "link": "https://stackoverflow.com/questions/34762708/does-auto-do-something-complete-different-in-c-as-in-c", "title": "Does auto do something complete different in C++ as in C?", "body": "<p>After reading this post: <a href=\"https://stackoverflow.com/q/34758042/2003898\">Is there a downside to declaring variables with auto in C++?</a>\nI was asking myself: Is really no one of the answerers aware of <code>auto</code> not beeing a type but a storage-class specifier.</p>\n\n<p>Or is <code>auto</code> since C++11 something different as the storage-class specifier in plain C?</p>\n\n<p>If so, does this break the compability between C and C++?</p>\n\n<p>(I'm aware that they official never were supporting each other in anyway, but my experience was that the C++ comittee tryed to stay as close to C as possible when evver it was acceptable. But now changing an obsolete, but abyway existing keyword instead of just adding a new one. Why here doing such a break of consistens?)</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 1332, "user_id": 5396597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5bc24f12645783a5fef2e275831dfc6?s=128&d=identicon&r=PG&f=1", "display_name": "mnille", "link": "https://stackoverflow.com/users/5396597/mnille"}, "edited": false, "score": 0, "creation_date": 1452676760, "post_id": 34762556, "comment_id": 57270402, "body": "It would be helpful if you would post your code (at least the beginning) and more of the output / error messages."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1452676857, "post_id": 34762556, "comment_id": 57270468, "body": "If you just care about getting gcc to work you could use the installer from <a href=\"http://www.qt.io/download\" rel=\"nofollow noreferrer\">Qt Creator</a>. It will install gcc via mingw and set up everything so it just works. You don&#39;t have to install Qt or Qt Creator."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1452677132, "post_id": 34762556, "comment_id": 57270658, "body": "&quot;I am trying to compile this code&quot;.  Which code?  Shows us the #include line.  Also, show us your gcc command line and your environment."}, {"owner": {"reputation": 107, "user_id": 1858851, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/5c81e6dec1b3dfa4a6c718cca5d96671?s=128&d=identicon&r=PG", "display_name": "user1858851", "link": "https://stackoverflow.com/users/1858851/user1858851"}, "edited": false, "score": 0, "creation_date": 1452678587, "post_id": 34762556, "comment_id": 57271734, "body": "This is the code :#include &lt;iostream&gt; using namespace std;  char result[10][10] = {&quot;zero&quot;,&quot;one&quot;,&quot;two&quot;,&quot;three&quot;,&quot;four&quot;,&quot;five&quot;,&quot;six&quot;,&quot;seven&quot;,&quot;eig&zwnj;&#8203;ht&quot;,&quot;nine&quot;};  int main() {     int num;     cin &gt;&gt; num;      int temp = num;     cout&lt;&lt;temp;     int numDigits = 1; ;     while (temp &gt; 0) {temp = temp/10; numDigits = numDigits*10;}     while (num &gt;0)     {         numDigits /=10;         cout &lt;&lt; result[num/numDigits]&lt;&lt;&quot; &quot;;         num = num%numDigits;     } }"}, {"owner": {"reputation": 827, "user_id": 535071, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4e4c10f290b8ad284a353dc76a8297ab?s=128&d=identicon&r=PG", "display_name": "drkvogel", "link": "https://stackoverflow.com/users/535071/drkvogel"}, "edited": false, "score": 0, "creation_date": 1487550036, "post_id": 34762556, "comment_id": 71821638, "body": "Have you tried Babun? <a href=\"http://stackoverflow.com/questions/31600600/compilation-error-stddef-h-no-such-file-or-directory\" title=\"compilation error stddef h no such file or directory\">stackoverflow.com/questions/31600600/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 1858851, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/5c81e6dec1b3dfa4a6c718cca5d96671?s=128&d=identicon&r=PG", "display_name": "user1858851", "link": "https://stackoverflow.com/users/1858851/user1858851"}, "edited": false, "score": 0, "creation_date": 1452678508, "post_id": 34762863, "comment_id": 57271667, "body": "I updated the gcc-core and gcc-g++ packages,It still gives me the same error.gcc --version gives : gcc (GCC) 5.2.0 and g++ --version gives : g++ (GCC) 4.9.3. How do I know what packages to update?cygcheck -p g\\+\\+ does not search for g++ packages."}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1493140005, "post_id": 34762863, "comment_id": 74282764, "body": "Since the DMCA takedown has been resolved again (see <a href=\"https://github.com/transcode-open/apt-cyg/issues/73#issuecomment-225156152\" rel=\"nofollow noreferrer\">this issue post</a> for background), I&#39;ve rolled back the edit."}], "tags": [], "owner": {"reputation": 2126, "user_id": 1782481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/943e0d939908f921b8bba7f0ad7b0e31?s=128&d=identicon&r=PG", "display_name": "varevarao", "link": "https://stackoverflow.com/users/1782481/varevarao"}, "is_accepted": false, "score": 0, "last_activity_date": 1493139928, "last_edit_date": 1493139928, "creation_date": 1452677391, "answer_id": 34762863, "question_id": 34762556, "link": "https://stackoverflow.com/questions/34762556/cygwin-g-compilation-fails/34762863#34762863", "title": "Cygwin g++ compilation fails", "body": "<p>The link you mentioned was the solution I'd used when I came across the same error.\nFor the second part of the question, if you've worked with Ubuntu et al. you've heard of apt-get, and know how awesome it is. These guys made just that for Cygwin. :) <a href=\"https://github.com/transcode-open/apt-cyg\" rel=\"nofollow noreferrer\">Link to apt-cyg on GitHub</a>.</p>\n\n<p>After that, it's as simple as:</p>\n\n<pre><code>apt-cyg update &lt;your packages&gt;\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 1858851, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/5c81e6dec1b3dfa4a6c718cca5d96671?s=128&d=identicon&r=PG", "display_name": "user1858851", "link": "https://stackoverflow.com/users/1858851/user1858851"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1551, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1493139928, "creation_date": 1452676453, "last_edit_date": 1495541869, "question_id": 34762556, "link": "https://stackoverflow.com/questions/34762556/cygwin-g-compilation-fails", "title": "Cygwin g++ compilation fails", "body": "<p>I am trying to compile a c++ file using cygwin. I get the following error :</p>\n\n<blockquote>\n  <p>fatal error: stddef.h: No such file or directory #include </p>\n</blockquote>\n\n<p>This link provides a solution : <a href=\"https://stackoverflow.com/questions/31600600/compilation-error-stddef-h-no-such-file-or-directory\">link</a>.</p>\n\n<p>But even if I upgrade gcc and g++ package from the UI(setup.exe) it still gives me the same error.How to fix this? How to upgrade it from the cygwin command line?</p>\n"}, {"tags": ["c", "rust", "translate"], "comments": [{"owner": {"reputation": 22583, "user_id": 1103681, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/rMUo3.png?s=128&g=1", "display_name": "oli_obk", "link": "https://stackoverflow.com/users/1103681/oli-obk"}, "edited": false, "score": 3, "creation_date": 1452679331, "post_id": 34762541, "comment_id": 57272271, "body": "Please provide an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> of what you already tried. Also you did neither specify types nor start values, that makes the solution space quite amusing, but not useful to you."}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1452682219, "post_id": 34762541, "comment_id": 57274341, "body": "As ker noted, please provide a <b>Rust</b> example; even a naive translation is fine as long as it compiles and is functionally correct. Rust supports the <code>break</code> statement and can iterate over integer ranges, so it seems that it has everything you need..."}, {"owner": {"reputation": 2296, "user_id": 911646, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d9182e8f594a3d77c079eab5210574a3?s=128&d=identicon&r=PG", "display_name": "Markus", "link": "https://stackoverflow.com/users/911646/markus"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1452685726, "post_id": 34762541, "comment_id": 57276727, "body": "@MatthieuM. I&#39;ve added my na&#239;ve implementation, but I do have some questions about it. And I was really hoping to see how a more experienced Rust programmer would implement the solution. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "is_accepted": false, "score": 0, "last_activity_date": 1452692359, "creation_date": 1452692359, "answer_id": 34768198, "question_id": 34762541, "link": "https://stackoverflow.com/questions/34762541/translate-performance-critical-loop-from-c-to-rust/34768198#34768198", "title": "Translate performance critical loop from C to Rust", "body": "<p>Since it is critical to keep looking from both sides simultaneously, I don\u2019t think there is an easy way to avoid having mutable variables. </p>\n\n<p>One thing that can improve readability is to use <a href=\"https://doc.rust-lang.org/std/option/\" rel=\"nofollow\"><code>option</code></a> instead of negative numbers. Otherwise the code is fine.</p>\n\n<p>(Another thing you probably could do is to break the loop when the indices meet in the middle, if this means that there is no solution for your problem, but that\u2019s not Rust specific.)</p>\n"}, {"comments": [{"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 0, "creation_date": 1452709455, "post_id": 34773796, "comment_id": 57293445, "body": "While making the variable an <code>Option</code> is likely to make the value larger, it may or may not have any perceived speed difference. I&#39;d certainly use the <code>Option</code> first and benchmark it without it. Especially as the size of <code>i</code> might already be larger than needed in order to leave room for <code>-1</code> as a sentinel value without taking up real values."}], "tags": [], "owner": {"reputation": 9509, "user_id": 257568, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c736aafc7e3bfcf9f924d09bde3aa99?s=128&d=identicon&r=PG", "display_name": "ArtemGr", "link": "https://stackoverflow.com/users/257568/artemgr"}, "is_accepted": false, "score": 2, "last_activity_date": 1452707971, "last_edit_date": 1495541899, "creation_date": 1452707971, "answer_id": 34773796, "question_id": 34762541, "link": "https://stackoverflow.com/questions/34762541/translate-performance-critical-loop-from-c-to-rust/34773796#34773796", "title": "Translate performance critical loop from C to Rust", "body": "<p><code>cond_left</code> and <code>cond_right</code> are important to answer the performance question. For example, will replacing an index with an iterator help? Not going to tell without knowing what <code>cond_left</code> does.</p>\n\n<p>The other concern you have is that <code>first_edge</code> and <code>first_edge_right</code> are mutable. The proposed <a href=\"https://github.com/rust-lang/rfcs/issues/961\" rel=\"nofollow noreferrer\">RFC allowing loops to return a value</a> could be an elegant way to solve this problem. Right now you could emulate the loop return with a closure:</p>\n\n<pre><code>let (_first_edge, _first_edge_right): (i32, i32) = (||{\n    let (mut first_edge, mut first_edge_right) = (None, None);\n    // ...\n    return (first_edge.unwrap(), first_edge_right.unwrap());\n})();\n</code></pre>\n\n<p>(<a href=\"http://is.gd/G3NCjL\" rel=\"nofollow noreferrer\">In Playground</a>).</p>\n\n<p>Replacing <code>-1</code> with <code>None</code> will likely make the variable larger. See <a href=\"https://stackoverflow.com/questions/30414068/can-i-use-the-null-pointer-optimization-for-my-own-non-pointer-types\">Can I use the &quot;null pointer optimization&quot; for my own non-pointer types?</a>.</p>\n\n<p>Splitting this loop into two loops, one getting the <code>first_edge</code> and another examining the remaining range to get the <code>first_edge_right</code> seems like the right thing to do, but the CPU branch prediction will likely minimize the impact.</p>\n"}, {"comments": [{"owner": {"reputation": 2296, "user_id": 911646, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d9182e8f594a3d77c079eab5210574a3?s=128&d=identicon&r=PG", "display_name": "Markus", "link": "https://stackoverflow.com/users/911646/markus"}, "edited": false, "score": 0, "creation_date": 1452803502, "post_id": 34777002, "comment_id": 57341463, "body": "Thank you a lot! That was very helpful."}], "tags": [], "owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "is_accepted": true, "score": 5, "last_activity_date": 1452719180, "creation_date": 1452719180, "answer_id": 34777002, "question_id": 34762541, "link": "https://stackoverflow.com/questions/34762541/translate-performance-critical-loop-from-c-to-rust/34777002#34777002", "title": "Translate performance critical loop from C to Rust", "body": "<p>You need to be prepared to make a choice:</p>\n\n<ol>\n<li><blockquote>\n  <p>How would you translate that into Rust in a performant way?</p>\n</blockquote></li>\n<li><blockquote>\n  <p>while performance is important, readability is of course even more important</p>\n</blockquote></li>\n</ol>\n\n<p>Which is actually more important to you? Here's how I would write the code, assuming that I've understood what you are asking for:</p>\n\n<pre><code>fn left_condition(i: usize) -&gt; bool {\n    i &gt; 1000\n}\n\nfn right_condition(i: usize) -&gt; bool {\n    i % 73 == 0\n}\n\nfn main() {\n    let start_index = 300;\n    let asize = 10000000;\n\n    let left = (start_index..asize).position(left_condition);\n    let right = (start_index..asize).rev().position(right_condition);\n\n    println!(\"{:?}, {:?}\", left, right);\n}\n</code></pre>\n\n<p>We iterate once from left-to-right and once from right-to-left. My <em>gut</em> tells me that this will provide code with simple branch prediction that accesses memory in a linear manner, both of which should be optimizable.</p>\n\n<p>However, the variable name <code>asize</code> gives me pause. It certainly <em>sounds</em> like an abbreviation of \"array size\". If that's the case, then I would 100% recommend using slices instead of array indices. Why? Because array access (<code>foo[0]</code>) usually has overhead of bounds checking. I'd write something with slices:</p>\n\n<pre><code>let data = vec![0; 10_000_000];\nlet start_index = 300;\n\nlet slice = &amp;data[start_index..];\n\nlet left = slice.iter().position(|&amp;i| left_condition(i));\nlet right = slice.iter().rev().position(|&amp;i| right_condition(i));\n</code></pre>\n\n<p>However, there's only one possible true answer to your question:</p>\n\n<p>Use a profiler</p>\n\n<h3>Use a profiler</h3>\n\n<h2>Use a profiler</h2>\n\n<h1>Use a profiler</h1>\n\n<p>Only knowing your actual data, your actual implementations of the conditions, <em>the rest of the code you are running</em>, etc., can you actually know how fast something will be.</p>\n\n<blockquote>\n  <p>Therefore it has been a good thing to only have one loop instead of two - in order to avoid search from the beginning again</p>\n</blockquote>\n\n<p>This is nonintuitive to me, so I'd want to see profiling results that back up the claim.</p>\n"}], "owner": {"reputation": 2296, "user_id": 911646, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d9182e8f594a3d77c079eab5210574a3?s=128&d=identicon&r=PG", "display_name": "Markus", "link": "https://stackoverflow.com/users/911646/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 34777002, "answer_count": 3, "score": 1, "last_activity_date": 1459882344, "creation_date": 1452676405, "last_edit_date": 1459882344, "question_id": 34762541, "link": "https://stackoverflow.com/questions/34762541/translate-performance-critical-loop-from-c-to-rust", "title": "Translate performance critical loop from C to Rust", "body": "<p>I'm experimenting with rewriting some old C code into Rust - which I'm new to. One recurring issue I have is that the C code has a lot of loops like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>for (i = startIndex; i &lt; asize; i++)   \n{\n    if (firstEdge &lt; 0 &amp;&amp; condLeft(i))\n    {\n        firstEdge = i;\n    }\n\n    RightIndex = asize-1-i;\n    if (firstEdgeRight &lt; 0 &amp;&amp; condRight(RightIndex))\n    {\n        firstEdgeRight = RightIndex;\n    }\n\n    // Found both edges\n    if (firstEdge &gt;= 0 &amp;&amp; firstEdgeRight &gt;= 0) {\n        break;  \n    }\n}\n</code></pre>\n\n<p>How would you translate that into Rust in a performant way? My issue is that while I could probably get the functionality I want I'm not sure how to do it obtain (roughly) the same speed.</p>\n\n<p>This part of the code is the main bottleneck in our code (this part of the code at least) and when translating it would like to keep the following properties.</p>\n\n<ol>\n<li>The loop should break ASAP since <code>asize</code> can be very large.</li>\n<li>Both <code>firstEdge</code> and <code>firstEdgeRight</code> are found roughly at the same time. Therefore it has been a good thing to only have one loop instead of two - in order to avoid search from the beginning again (even though I think this solution kills the prefetcher (but I'm not sure, maybe the old machine running the code doesn't even have a prefetcher)).</li>\n</ol>\n\n<p>While performance is important, readability is of course even more important :)</p>\n\n<p><strong>EDIT</strong> Ok, here is a possible Rust implementation by me (<code>cond_right()</code> and <code>cond_left()</code> are left out).\nThe things I think about is:</p>\n\n<ol>\n<li>Is this how other people would write it if they had to implement it from scratch?</li>\n<li>Do I really need to make <code>first_edge</code> and <code>first_edge_right</code> mutable? They are in my implementation, but it feels wrong to me since they are only assigned once.</li>\n</ol>\n\n<pre class=\"lang-rust prettyprint-override\"><code>let mut first_edge = -1;\nlet mut first_edge_right = -1;\n\n// Find first edge\n\nlet start_index = 300; // or something\nlet asize = 10000000;\n\nfor i in start_index..asize {\n    if first_edge &lt; 0 &amp;&amp; cond_left(i) {\n        first_edge = i;\n    }\n\n    let right_index = asize - i -1;\n    if first_edge_right &lt; 0 &amp;&amp; cond_right(right_index) {\n        first_edge_right = right_index;\n    }\n\n    if (first_edge &gt;= 0 &amp;&amp; first_edge_right &gt;= 0) {\n        break;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1452676477, "post_id": 34762319, "comment_id": 57270187, "body": "And what is the problem with the code you show? What is your question? Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5783242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eb5bcf09bf738f6ec6eae93ffaeb61?s=128&d=identicon&r=PG&f=1", "display_name": "avinoor", "link": "https://stackoverflow.com/users/5783242/avinoor"}, "edited": false, "score": 0, "creation_date": 1452678751, "post_id": 34762513, "comment_id": 57271851, "body": "the problem is that if i input 1 2 1 3 1 3"}, {"owner": {"reputation": 33, "user_id": 5783242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eb5bcf09bf738f6ec6eae93ffaeb61?s=128&d=identicon&r=PG&f=1", "display_name": "avinoor", "link": "https://stackoverflow.com/users/5783242/avinoor"}, "edited": false, "score": 0, "creation_date": 1452678844, "post_id": 34762513, "comment_id": 57271915, "body": "whereas if all the ones are consecutive the output is correct"}, {"owner": {"reputation": 33, "user_id": 5783242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eb5bcf09bf738f6ec6eae93ffaeb61?s=128&d=identicon&r=PG&f=1", "display_name": "avinoor", "link": "https://stackoverflow.com/users/5783242/avinoor"}, "edited": false, "score": 0, "creation_date": 1452679194, "post_id": 34762513, "comment_id": 57272184, "body": "the output for the input 121313 is the majority element is 1 the majority element is 2 and so on"}, {"owner": {"reputation": 33, "user_id": 5783242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eb5bcf09bf738f6ec6eae93ffaeb61?s=128&d=identicon&r=PG&f=1", "display_name": "avinoor", "link": "https://stackoverflow.com/users/5783242/avinoor"}, "edited": false, "score": 0, "creation_date": 1452679211, "post_id": 34762513, "comment_id": 57272195, "body": "i expected it to be 1"}, {"owner": {"reputation": 33, "user_id": 5783242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eb5bcf09bf738f6ec6eae93ffaeb61?s=128&d=identicon&r=PG&f=1", "display_name": "avinoor", "link": "https://stackoverflow.com/users/5783242/avinoor"}, "edited": false, "score": 0, "creation_date": 1452679942, "post_id": 34762513, "comment_id": 57272709, "body": "pls can u suggest any books or sites where i could brush up my coding skills"}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 1, "last_activity_date": 1536078669, "last_edit_date": 1536078669, "creation_date": 1452676328, "answer_id": 34762513, "question_id": 34762319, "link": "https://stackoverflow.com/questions/34762319/majority-element-it-would-be-very-helpful-if-someone-could-point-out-the-fault/34762513#34762513", "title": "majority element . it would be very helpful if someone could point out the fault", "body": "<p>If you like to assigned the an element to <code>j</code> as you meant in your comment: </p>\n\n<blockquote>\n  <p>// the 1st element is assigned to j</p>\n</blockquote>\n\n<p>you have to write it like this: <code>j = arr[i];</code></p>\n\n<p>Apart from this you can stop searching if you found the majority. Adapt your code like this:</p>\n\n<pre><code>for(i=0;i&lt;=5;i++)\n{\n   j = arr[i];\n   for(k=0;k&lt;=5;k++)\n   {\n       if(arr[k]==j)\n           count++;  //whenever the required element is found in the array count is increased\n   }\n   if(count&gt;=3)\n   {\n       printf(\"the majority elt is %d\",j); \n       break; // &lt;- you are finished\n   }\n   else\n     count = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5783242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eb5bcf09bf738f6ec6eae93ffaeb61?s=128&d=identicon&r=PG&f=1", "display_name": "avinoor", "link": "https://stackoverflow.com/users/5783242/avinoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34762513, "answer_count": 1, "score": -1, "last_activity_date": 1536078669, "creation_date": 1452675731, "last_edit_date": 1452678442, "question_id": 34762319, "link": "https://stackoverflow.com/questions/34762319/majority-element-it-would-be-very-helpful-if-someone-could-point-out-the-fault", "title": "majority element . it would be very helpful if someone could point out the fault", "body": "<p>I have provided only for an array of size 6. the first element is copied into a variable the variable is matched with other elements of the array  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int arr[6],i,j,k,count=0;\n    printf(\"enter the nos\");\n    for(i=0;i&lt;=5;i++)         //loop to accept values from the user\n    {\n        scanf(\"%d\",&amp;arr[i]);\n    }\n    for(i=0;i&lt;=5;i++)\n    {\n    arr[i]=j;             //the 1st element is assigned to j\n        for(k=0;k&lt;=5;k++)\n        {\n            if(arr[k]==j)\n            {\n                count++;  //whenever the required element is found in the array count is increased\n            }\n        }\n        if(count&gt;=3)\n        {\n            printf(\"the majority elt is %d\",j);\n        }\n        else\n        {\n            count=0;  //if above conditions dont satisfy the count is again set to 0\n        }  \n    //the inner loop after completing its iterations gives control to the outer loop\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "lua", "c-api"], "comments": [{"owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1452693269, "post_id": 34762287, "comment_id": 57281774, "body": "Lua is a proper name, not an acronym. So no need for ALL CAPS."}], "answers": [{"comments": [{"owner": {"reputation": 4735, "user_id": 1570711, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f3242be5e2827fc993543819c3e74ab4?s=128&d=identicon&r=PG", "display_name": "Claudix", "link": "https://stackoverflow.com/users/1570711/claudix"}, "edited": false, "score": 0, "creation_date": 1452677949, "post_id": 34762953, "comment_id": 57271234, "body": "I was about to answer myself after further analysis!! You got the prize though! Thank you!"}, {"owner": {"reputation": 4735, "user_id": 1570711, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f3242be5e2827fc993543819c3e74ab4?s=128&d=identicon&r=PG", "display_name": "Claudix", "link": "https://stackoverflow.com/users/1570711/claudix"}, "edited": false, "score": 0, "creation_date": 1452678118, "post_id": 34762953, "comment_id": 57271374, "body": "I&#39;ve just edited the answer to add the &quot;@&quot; sign. Otherwise LUA&#39;s runtime would enclose the filename between brackets [] as it were code. In our example, it&#39;d be shown as [&quot;my.lua&quot;]"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 5, "last_activity_date": 1452678049, "last_edit_date": 1452678049, "creation_date": 1452677631, "answer_id": 34762953, "question_id": 34762287, "link": "https://stackoverflow.com/questions/34762287/lua-c-api-setting-error-source-information/34762953#34762953", "title": "Lua C API: setting error source information", "body": "<p>This should be possible with <code>luaL_loadbuffer()</code>:</p>\n\n<pre><code>int luaL_loadbuffer (lua_State *L,\n                 const char *buff,\n                 size_t sz,\n                 const char *name);\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>luaL_loadbuffer(L, code, code_length, \"@my.lua\");\n</code></pre>\n\n<p><strong>EDIT</strong>\nThe '@' before the name is required to tell LUA the chunk's name is actually the name of a script, not the script code itself.</p>\n\n<p>It should load the buffer as a lua-chunk and use the name in the fourth argument for debug information and error messages.</p>\n"}], "owner": {"reputation": 4735, "user_id": 1570711, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f3242be5e2827fc993543819c3e74ab4?s=128&d=identicon&r=PG", "display_name": "Claudix", "link": "https://stackoverflow.com/users/1570711/claudix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 34762953, "answer_count": 1, "score": 3, "last_activity_date": 1453110226, "creation_date": 1452675613, "last_edit_date": 1453110226, "question_id": 34762287, "link": "https://stackoverflow.com/questions/34762287/lua-c-api-setting-error-source-information", "title": "Lua C API: setting error source information", "body": "<p>I'm implementing a simple LUA online interpreter which takes multiple LUA scripts from plain text (i.e. C strings) and runs them. Everything is working OK but now I'm testing my program's response when syntax or runtime errors occur from those scripts. </p>\n\n<p>So far, when an error occurs, after calling <code>lua_pcall</code> I'm getting from the stack message errors like this:</p>\n\n<pre><code>[string \"...\"]:7: attempt to call field 'push' (a nil value)\n</code></pre>\n\n<p>Now, what I want is LUA's runtime to replace the token <code>[string \"...\"]</code> by a virtual file name (remember that the interpreter takes LUA code from strings), so that if the user submits a virtual script using the name \"my.lua\", then error messages raised from LUA's runtime for that script would be formatted as:</p>\n\n<pre><code>my.lua:7: attempt to call field 'push' (a nil value)\n</code></pre>\n\n<p>I've tried to analyze LUA's source code to find out how the LUA interpreter succeeds in this purpose. So far all I have found is that <code>lua_loadstring()</code> and <code>lua_loadfile()</code> differ in that the latter pushes into the stack the name of the file prepended with \"@\". From LUA's source code (<code>lauxlib.c</code>):</p>\n\n<pre><code>LUALIB_API int luaL_loadfilex (lua_State *L, const char *filename,\n                                         const char *mode) {\n  LoadF lf;\n  int status, readstatus;\n  int c;\n  int fnameindex = lua_gettop(L) + 1; /* index of filename on the stack */\n  if (filename == NULL) {\n    lua_pushliteral(L, \"=stdin\");\n    lf.f = stdin;\n  }\n  else {\n    lua_pushfstring(L, \"@%s\", filename);\n    lf.f = fopen(filename, \"r\");\n    if (lf.f == NULL) return errfile(L, \"open\", fnameindex);\n  }\n  //...\n  status = lua_load(L, getF, &amp;lf, lua_tostring(L, -1), mode);\n  //...\n\n}\n\nLUALIB_API int luaL_loadstring (lua_State *L, const char *s) {\n  return luaL_loadbuffer(L, s, strlen(s), s); //eventually calls lua_load\n}\n</code></pre>\n\n<p>Both functions, <code>luaL_loadfilex()</code> and <code>luaL_loadstring()</code> end up calling <code>lua_load()</code>, so the difference between both is that the former pushes either \"=stdin\" or the filename into the stack before calling <code>lua_load()</code>. \nMy code just calls <code>luaL_loadstring()</code>, so I thought that pushing the virtual filename before calling it would have the same effect, but it doesn't. </p>\n\n<p>Am I missing some point? Thank you.</p>\n"}, {"tags": ["c", "malloc", "strtok"], "answers": [{"tags": [], "owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "is_accepted": false, "score": 1, "last_activity_date": 1452674810, "creation_date": 1452674810, "answer_id": 34762018, "question_id": 34761947, "link": "https://stackoverflow.com/questions/34761947/freeing-memory-after-calling-strtok-causes-an-error/34762018#34762018", "title": "Freeing memory after calling strtok() causes an error", "body": "<pre><code> filename = malloc(strlen(argv));\n strk_ptr = malloc(sizeof(filename));\n</code></pre>\n\n<p>strk_ptr gets some memory, which you then go leave dangling by pointing strk_ptr to filenames memory, you then end up double freeing filename.</p>\n\n<p>So don't malloc strk_ptr.  Just leave it as char* then only free filename at the end</p>\n"}, {"comments": [{"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1452675075, "post_id": 34762035, "comment_id": 57269298, "body": "they aren&#39;t asking about freeing strtok memory, they are asking about freeing their memory after using strtok."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "reply_to_user": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1452675643, "post_id": 34762035, "comment_id": 57269656, "body": "@KeithNicholas Thanks, reworded a bit"}], "tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": false, "score": 3, "last_activity_date": 1452676546, "last_edit_date": 1452676546, "creation_date": 1452674868, "answer_id": 34762035, "question_id": 34761947, "link": "https://stackoverflow.com/questions/34761947/freeing-memory-after-calling-strtok-causes-an-error/34762035#34762035", "title": "Freeing memory after calling strtok() causes an error", "body": "<p>This line:</p>\n\n<pre><code>filename = malloc(sizeof(argv));\n</code></pre>\n\n<p>should be this:</p>\n\n<pre><code>filename = malloc(strlen(argv) + 1);     /* +1 for the '\\0' at the end */\nif (filename == NULL) { /* take some action */ }\n</code></pre>\n\n<p>And this line:</p>\n\n<pre><code>strk_ptr = malloc(sizeof(filename));\n</code></pre>\n\n<p>is only creating a memory leak since it is followed by:</p>\n\n<pre><code>strk_ptr = strtok(filename,\".\");\n</code></pre>\n\n<p>And you should check the return value:</p>\n\n<pre><code>strk_ptr = strtok(filename,\".\");\nif (strk_ptr == NULL) { /* take some action */ }\n</code></pre>\n\n<p>BTW, the <code>strtok()</code> function returns a pointer to a token inside the string passed in the initial call to it (<code>filename</code> in your example).   It does not allocate memory, so its return value should NOT be freed (which your program avoids, but it's a common mistake).  While I'm grousing about <code>strtok()</code>, I'll mention that you can't (directly or indirectly) pass it a literal string to tokenize, since it modifies the string and literal strings are readonly.  That is, doing: <code>strtok(\"sample.txt\", \".\")</code> is a no-go.</p>\n\n<p>And finally, this kind of implicit condition is not great form:</p>\n\n<pre><code>while (strk_ptr = strtok(NULL,\".\")) { ... }\n</code></pre>\n\n<p>Better is:</p>\n\n<pre><code>while ((strk_ptr = strtok(NULL,\".\")) != NULL) { ... }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": false, "score": 0, "last_activity_date": 1452676139, "last_edit_date": 1452676139, "creation_date": 1452675131, "answer_id": 34762112, "question_id": 34761947, "link": "https://stackoverflow.com/questions/34761947/freeing-memory-after-calling-strtok-causes-an-error/34762112#34762112", "title": "Freeing memory after calling strtok() causes an error", "body": "<pre><code>strk_ptr = malloc(sizeof(filename));\nstrk_ptr = strtok(filename,\".\");//\n...\nfree(strk_ptr);\n</code></pre>\n\n<p>Doesn't work. At first, <code>strk_ptr</code> points to the malloc'd memory but then the pointer is immediately overwritten with some other value, so basically you lose the pointer to the malloc'd memory and hence cannot <code>free</code> that memory any more.</p>\n\n<p>Edit:</p>\n\n<p>Seeing <code>malloc(sizeof(filename))</code>, I should add that you <em>do not</em> have to allocate memory for the pointer variable itself. The declaration <code>char* strk_ptr;</code> makes the compiler implicitly allocate memory for that pointer (i.e. 4 or 8 bytes). So you can just use the pointer directly like any other variable, and you won't have to <code>free</code> that variable's memory.</p>\n\n<pre><code>char* strk_ptr;\nstrk_ptr = strtok(filename,\".\");\n</code></pre>\n\n<p>Or, if that wasn't your intention then note that <code>sizeof(filename)</code> does <em>not</em> return the length of the string, but just the size of the pointer variable <code>filename</code>, i.e. usually 4 or 8, independent of what string <code>filename</code> points to. See also <a href=\"http://www.gnu.org/software/libc/manual/html_node/String-Length.html\" rel=\"nofollow\">http://www.gnu.org/software/libc/manual/html_node/String-Length.html</a>:</p>\n\n<pre><code>char string[32] = \"hello, world\";\nchar *ptr = string;\nsizeof (string)\n    \u21d2 32\nsizeof (ptr)\n    \u21d2 4  /* (on a machine with 4 byte pointers) */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "is_accepted": false, "score": 2, "last_activity_date": 1452678653, "last_edit_date": 1452678653, "creation_date": 1452676425, "answer_id": 34762549, "question_id": 34761947, "link": "https://stackoverflow.com/questions/34761947/freeing-memory-after-calling-strtok-causes-an-error/34762549#34762549", "title": "Freeing memory after calling strtok() causes an error", "body": "<p><strong>You don't need to allocate memory when using strtok()</strong></p>\n\n<p>There is no problem in freeing <strong>filename</strong> as it is correctly allocated by <strong>malloc()</strong>, however there are many other problems and memory leaks. \nBasically you first allocate memory for <strong>str_ptr</strong>:</p>\n\n<pre><code>strk_ptr = malloc(sizeof(filename));\n</code></pre>\n\n<p>Here <strong>malloc()</strong> return a pointer which is stored in <strong>strk_ptr</strong>.\nAnd then you call <strong>strtok()</strong> which also return a pointer, inside <strong>filename</strong>:</p>\n\n<pre><code>strk_ptr = strtok(filename,\".\");\n</code></pre>\n\n<p>So you lost the original pointer returned by <strong>malloc()</strong> and now <strong>strk_ptr</strong> points somewhere in <strong>filename</strong>. When you call <code>free(str_ptr)</code> you are freeing a memory inside <strong>filename</strong>. The subsequent call to <code>free(filename)</code> report the error. The solution is simply that don't need to allocate memory for <strong>strk_ptr</strong>.</p>\n\n<p>I wrote a working minimal code to show you how to correctly use <strong>strtok</strong>. Please remember that, when asking a question, posting a minimal working code is alway better.</p>\n\n<pre><code>int main(int argc, char **argv) {\n\n    char *strk_ptr;\n    char *filename = malloc(strlen(argv[0]) + 1);\n\n    strcpy(filename, argv[0]);\n\n    printf(\"filename = %s, size = %zu\\n\", filename, sizeof(filename));\n\n    // Do not malloc this\n    //strk_ptr = malloc(strlen(filename) + 1);\n    strk_ptr = strtok(filename,\".\");//\n    printf(\"%s\\n\", strk_ptr);\n\n    while( (strk_ptr = strtok(NULL,\".\")) )\n    {\n        printf(\"%s\\n\", strk_ptr);\n    }\n    free(filename);\n\n    return 0;\n}\n</code></pre>\n\n<p>First of all <strong>argv</strong> is a char** so if you want to copy the content of the first argument passed as input you have to use <strong>argv[0]</strong>, which is always the executable file name.</p>\n\n<p>then, <code>sizeof(filename)</code> returns the size of the pointer not the size of the content as <strong>filename</strong> is not an array. you have to use <code>strlen(filename) + 1</code>.</p>\n\n<p><strong>strtok</strong> return a pointer inside the object (<strong>filename</strong>) which is already allocated so you <em>don't need</em> to allocate memory for <strong>strk_ptr</strong>.</p>\n\n<p>When using strtok in a loop consider to take the following approach:</p>\n\n<pre><code>   for (strk_ptr = strtok(filename, \".\"); strk_ptr; strk_ptr = strtok(NULL, \".\"))\n    {\n        printf(\"%s\\n\", strk_ptr);\n    }\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5783004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34f816c4463f94a9acd15b45d9dd8388?s=128&d=identicon&r=PG&f=1", "display_name": "wh.Kwon", "link": "https://stackoverflow.com/users/5783004/wh-kwon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1452678653, "creation_date": 1452674577, "last_edit_date": 1452678385, "question_id": 34761947, "link": "https://stackoverflow.com/questions/34761947/freeing-memory-after-calling-strtok-causes-an-error", "title": "Freeing memory after calling strtok() causes an error", "body": "<p>Could you please help me? My code does tokenizing, so I created code like this:</p>\n\n<ol>\n<li>I allocate some memory,</li>\n<li>I <code>strcpy(malloced_memory, argv)</code></li>\n<li>I execute <code>strtok(mallocted_memory, \".\")</code></li>\n<li><p>Try <code>free(mallocted_memory)</code>.</p>\n\n<pre><code>filename = malloc(strlen(argv));\n\nstrcpy(filename, argv);\nstrk_ptr = malloc(sizeof(filename));\nstrk_ptr = strtok(filename,\".\");//\ni++;\nsprintf(in-&gt;file_name,\"%s\",strk_ptr);\n\nwhile(strk_ptr = strtok(NULL,\".\"))//\n{\n    i++;\n    sprintf(in-&gt;file_name,\"%s.%s\",in-&gt;file_name,strk_ptr);\n    sprintf(in-&gt;file_ext ,\"%s\",strk_ptr);\n}\nfree(strk_ptr);\nfree(filename);\n</code></pre></li>\n</ol>\n\n<p>That code has the problem that I can't <code>free(filename)</code>. If I try <code>free(filename)</code>, then program get <code>SIGTRAP</code>. But program is working.</p>\n\n<p>I want fix that problem. What should I do?</p>\n"}, {"tags": ["c", "pointers", "malloc", "constants"], "comments": [{"owner": {"reputation": 95, "user_id": 5739672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuG9K.jpg?s=128&g=1", "display_name": "Devang Kubavat", "link": "https://stackoverflow.com/users/5739672/devang-kubavat"}, "reply_to_user": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452674693, "post_id": 34761795, "comment_id": 57269069, "body": "Okay but compiler should not give me output. its should give an error....."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1452674709, "post_id": 34761795, "comment_id": 57269082, "body": "Olaf gave you the correct answer. However on most microcontrollers, const variables belongs to ROM memory, that is a real read only memory."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1452674775, "post_id": 34761795, "comment_id": 57269114, "body": "<code>GCC</code> talking use <code>-Wall</code> option, and errors will be shown."}, {"owner": {"reputation": 95, "user_id": 5739672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuG9K.jpg?s=128&g=1", "display_name": "Devang Kubavat", "link": "https://stackoverflow.com/users/5739672/devang-kubavat"}, "edited": false, "score": 0, "creation_date": 1452674777, "post_id": 34761795, "comment_id": 57269116, "body": "then why it gave me output....? it should display error..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "edited": false, "score": 0, "creation_date": 1452675675, "post_id": 34761795, "comment_id": 57269688, "body": "@Superlokkus: Please point me at where the standard requires the compiler to detect the type of a <b>variadic</b> function argument! In my answer I elaborated this (the reason I withdrew my comment)."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1452676421, "post_id": 34761795, "comment_id": 57270146, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1452677942, "post_id": 34761795, "comment_id": 57271230, "body": "You should have gotten a warning from your compiler for the call to <code>scanf</code>.  I just tried it with <code>gcc</code>, just using the default options, and it gave a warning.  Are you using a different compiler?  Whatever compiler you&#39;re using should have warned about it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1452678392, "post_id": 34761795, "comment_id": 57271575, "body": "@TomKarzes: While I agree a compiler should warn, it is not required by the standard. Warning about wrong types for variadic functions is hard to accomplish anyway, as the actual type is determined programatically. C ist just not designed for dynamic typing, as it does not include type-information in the code, thus looses all type-safety. For <code>scanf</code>/<code>prinf</code>, the compiler just &quot;knows&quot; the syntax of the format string. Note that anything tha using a <i>string literal</i> directly likely inhibits the check, too."}, {"owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452678504, "post_id": 34761795, "comment_id": 57271664, "body": "@Olaf I must confess, my statement &quot;plain wrong&quot; is over the edge, I should have written e.g. &quot;not entirely true&quot;, because to let the compiler check that I don&#39;t change my value unintended, was AFAIK one of the two (also AFAIK) primary goals behind <code>const</code>. The other should be optimization. But I overlooked the <code>scanf</code> usage, so you&#39;re right, variadic argument functions are relevant too. I forgot how &quot;soft&quot; C is in comparison to C++, which I was think in to much. So: I&#39;m sorry, you wrote an excellent answer."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452678685, "post_id": 34761795, "comment_id": 57271811, "body": "@Olaf Yes, I agree that the warning isn&#39;t required.  In order to issue warnings about argument types to variable argument library functions like <code>printf</code> and <code>scanf</code> requires the compiler to be able to parse the format strings.  But <code>gcc</code> seems to do a good job at it provided the format arguments are string constants."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1452682217, "post_id": 34761795, "comment_id": 57274340, "body": "@TomKarzes: See the headers. gcc actually provides an attribute to tag such functions and allow your own functions to be checked. Althought you have to follow mostly the <code>printf</code> syntax."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1452676819, "post_id": 34761958, "comment_id": 57270447, "body": "Assigning an <code>int *</code> to a <code>const int *</code> is valid in C. The fault is <code>scanf</code> only."}], "tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 1, "last_activity_date": 1452674618, "creation_date": 1452674618, "answer_id": 34761958, "question_id": 34761795, "link": "https://stackoverflow.com/questions/34761795/pointer-to-const-int-but-still-it-modify-data/34761958#34761958", "title": "Pointer to const int but still it modify data", "body": "<p>It is quite evident that you have turned off all compiler warnings. </p>\n\n<p>Your program invokes undefined behaviour by assigning the result of a function returning int to const int*. The compiler should have told you, maybe you ignored it, but from then on all odds are off. </p>\n\n<p>You pass a const int* to scanf. Again, the compiler should have warned you, maybe you ignored it, but again all odds are off. </p>\n\n<p>const int* doesn't make the object pointed to unmodifiable. It tells the compiler to not let you modify anything through that pointer, that's all. The storage area returned by malloc is never unmodifiable. </p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 95, "user_id": 5739672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuG9K.jpg?s=128&g=1", "display_name": "Devang Kubavat", "link": "https://stackoverflow.com/users/5739672/devang-kubavat"}, "edited": false, "score": 1, "creation_date": 1452675931, "post_id": 34762055, "comment_id": 57269848, "body": "@DevangKubavat: Yes, there is a lot to know as a good developer. Even if you might not understand everything, you can do some reserarch about the terms I used. Either way, you really should keep that in the backyard of your mind. If you continue learning, you likely will notice some of the issues I mentioned."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1452676016, "post_id": 34762055, "comment_id": 57269893, "body": "Can you elaborate (give arguments in favor) what is causing undefined behavior?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452676591, "post_id": 34762055, "comment_id": 57270285, "body": "@2501 What do you mean? If you want a list: that is given in annex J of the C standard (while informative, it is mandatory, as it just summarises causes included in other sections). <b>No reason for a downvote!</b>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1452677419, "post_id": 34762055, "comment_id": 57270859, "body": "You can list the reasons from the annex J, but I would prefer actual quotes. (Don&#39;t forget that downvotes are anonymous. Bringing them up in a debate is unproductive, as is <i>guessing</i> who downvoted)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452677841, "post_id": 34762055, "comment_id": 57271170, "body": "@2501: Downvoting without leaving a statement or a clear reason is too. However, you do know Annex J.2 according to your highest-voted answer. So you should already know the answer. Anyway, I added the quote."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452678296, "post_id": 34762055, "comment_id": 57271497, "body": "The object is not defined with const. <code>int* p=(int *)malloc(*psize *sizeof(int));</code> The quote is not relevant. The behavior is defined."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452678503, "post_id": 34762055, "comment_id": 57271663, "body": "I have to agree with 2501 here partially. Quoted part of standard would be relevant <i>if</i> <code>malloc</code> would returned <code>const void *</code>. UB comes from passing the <code>const char *</code> to <code>scanf</code> expecting <code>char *</code>. <code>scanf(&quot;%d&quot;,(char*)&amp;arr[i]);</code> would make this code legal again, since the original address is not <code>const</code> qualifed."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452678544, "post_id": 34762055, "comment_id": 57271696, "body": "@2501: The object is very well <i>declared</i> <code>const</code> qualified: <code>const int * = </code>func(&amp;size)` in <code>main</code>. Assignment of an <code>int *</code> to a <code>const int *</code> is allowed in C."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452678627, "post_id": 34762055, "comment_id": 57271761, "body": "Objects are not defined by what points to them, but in this case, what is written into them. Please read: 6.5.6."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452678760, "post_id": 34762055, "comment_id": 57271855, "body": "Effective type is my argument here. scanf writes an int into the object giving it the type int."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1452679396, "post_id": 34762055, "comment_id": 57272318, "body": "The only UB here is passing <code>const int *</code> to scanf when it expects an <code>int *</code>. The object itself is writable. A simple cast in scanf (as user694733 said)  or <code>const int p*=func(&amp;size); int *arr = (int*) p;</code> would make the code perfectly legal."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1452680066, "post_id": 34762055, "comment_id": 57272804, "body": "@l3x Where does is specify that %d must be an int*? It only says: <i>The corresponding argument shall be a pointer to signed integer.</i> const int* is compatible with int* and is a pointer to a signed integer. I would really like to refute my arguments, but I can&#39;t find anything in the Standard."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1452680073, "post_id": 34762055, "comment_id": 57272814, "body": "@l3x Whoops, I accidentally used <code>char</code> instead of <code>int</code>, but we agree. You can cast pointer-to-const to pointer-to-non-const as long as memory pointed at was non-const. Without it, I think that some standard functions, like <code>char *strchr(const char *s, int c);</code> would have been impossible."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452680307, "post_id": 34762055, "comment_id": 57272986, "body": "@2501 Because <code>int *x; const int * p = x;</code> is fine but <code>const int *x; int *p = x;</code> is <i>not</i> valid. &quot;Compatible&quot; is not applied in both ways."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452680799, "post_id": 34762055, "comment_id": 57273285, "body": "@Olaf I&#39;m glad you listened to my arguments. I gave you an upvote."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1452680876, "post_id": 34762055, "comment_id": 57273344, "body": "@l3x They are compatible both ways. Standard only states that modification is undefined. This is the best answer I could find in a short time: <a href=\"https://stackoverflow.com/questions/14437699/does-removing-const-from-a-pointer-to-const-obey-strict-aliasing-in-c-and-refer\" title=\"does removing const from a pointer to const obey strict aliasing in c and refer\">stackoverflow.com/questions/14437699/&hellip;</a> There are other (better) ones."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1452681210, "post_id": 34762055, "comment_id": 57273598, "body": "All: See my edit. After the discussion I had to change my mind."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452681489, "post_id": 34762055, "comment_id": 57273796, "body": "@2501 I don&#39;t remember exactly where it&#39;s mentioned in C std. Note the linked answer doesn&#39;t say/imply it&#39;s valid. There&#39;s a cast that makes it valid (linked question). i.e. <code>const int *x; int *p = (int*) x;</code> is fine (whether <code>*p=42;</code> is valid depends on whether the object pointed to by <code>x</code> is modifiable)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1452681529, "post_id": 34762055, "comment_id": 57273825, "body": "@2501: I fight against it, but I am very well able to change my mind if I&#39;m proved wrong or get enough reasons to verify my claims. Had to dig quite dep in the standard to see the line of argument. The question is much more complicated than initially thought. However, I&#39;m still not sure about the &quot;compatible type&quot; for the pointer (resp. the object it points to). I suspect they are not compatible, but as a non-native speaker the previous research has exhausted me. I need some rest to get my mind clear."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1452681744, "post_id": 34762055, "comment_id": 57273969, "body": "@l3x: As a cast tells the compiler to shut up, it is useless as an argument. Without the cast it is UB. But the other direction is ok. Problems arise with more indirection. C is a minefield with qualifier-correctness and pointers."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452681953, "post_id": 34762055, "comment_id": 57274128, "body": "@user694733: You can basically cast anything you want. Problem is not all are valid. Some are implementation defined, some invoke undefined behaviour. That&#39;s why one should use a cast only iff(!) 1) it is really necessary and 2) <b>all</b> implications are understood and 3) accepted. FYI: I changed my answer. Welcome to read."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452683542, "post_id": 34762055, "comment_id": 57275272, "body": "Standard says that <i>&quot;For two pointer types to be compatible, both shall be identically qualified and both shall be pointers to compatible types.&quot;</i>, which would imply that casting const away before <code>scanf</code> is required. However, it also says <i>&quot;pointers to qualified or unqualified versions of compatible types shall have the same representation and alignment requirements&quot;</i>, which means that means that in practice on existing systems, even if you don&#39;t cast it, it most probably just works. C is so much fun."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1452685700, "post_id": 34762055, "comment_id": 57276709, "body": "@user694733: As I see the types are actually not compatible. Thus UB. One reson for UB is enough. But yes, C is very incomplete here. OTOH this allows very low-level manipulations, which are - strictly skeking UB, but work nevertheless. Sometimes you have to - just know what you do."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 7, "last_activity_date": 1452681197, "last_edit_date": 1452681197, "creation_date": 1452674940, "answer_id": 34762055, "question_id": 34761795, "link": "https://stackoverflow.com/questions/34761795/pointer-to-const-int-but-still-it-modify-data/34762055#34762055", "title": "Pointer to const int but still it modify data", "body": "<p>You just encountered one of the many cases C allows you to shoot your foot - for good and bad.</p>\n\n<p>Some general remarks about your assumptions: <code>const</code> is a guarantee <strong>you</strong> give to the compiler. So <strong>you</strong> have to make sure not to violate the contract. C does not have true constants [1]. Semantically <code>const</code> is a qualifier` which allows the compiler additional error-checking. But that requires the type of the argument to be known to the compiler. This is true for functions with a proper <em>prototype</em>, but (normally [2]) not for those with a variable number of argument (\"variadic functions\"), as their types are not given at compile-time (and not explicitly available at run-time).</p>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>scanf(\"%d\",&amp;arr[i]);\n</code></pre>\n</blockquote>\n\n<p>You actually pass a problematic (see below) pointer type to <code>scanf</code>. The function itself does not check, but just expects the correct type. It cannot, because C does not provide the type of an object at run-time.</p>\n\n<p>A modern compiler should warn about argument type missmatch for <code>printf</code> and <code>scanf</code>. Always enable warnings (for gcc at least use <code>-Wall -Wextra -Wconversions</code>) and pay heed to them.</p>\n\n<p><strong>Edit:</strong> After heavy discussion, I have to change my mind. It seems to be <strong>not</strong> undefined behaviour [3] for the reason given initially: passing a <code>const int *</code> to <code>scanf</code> which expects a <code>int *</code>.</p>\n\n<p>This because the object <code>malloc</code>ed in <code>func</code> has no <em>effective type</em> until the first <strong>write</strong> (6.5p6). That occurs in <code>scanf</code> using an <code>int *</code>. Thus the object has type <code>int</code> - no <code>const</code>. However, your further accesses through a <code>const int *</code> are valid. 6.7.3p6 only makes the other direction undefined behaviour (for good reason).</p>\n\n<p>Getting through undetected is only possible for variadic functions, because there is no information about the expected type available in the function declaration. Consinder something like:</p>\n\n<pre><code>void f(int *p)\n{\n    *p = 0;\n}\n\nint main(void)\n{\n    const int *p = ...;\n    f(p);\n}\n</code></pre>\n\n<p>Here the compiler will generate a warning. Variadic functions are of the cases C cannot check for qualifier-correctness (this includes e.g. <code>volatile</code>, too). There are more and some are quite subtle.</p>\n\n<p>The only case of undefined behaviour here is to pass an incompatible differently qualified pointer than expected (6.7.6.1p2).</p>\n\n<p><strong>Recomendation:</strong> Enable warnings, but do not rely on the compiler detecting all flaws (not only true for const-correctness). If you need more saffety, C is not the right language. There are good reasons higher-level languages like Python, Java, etc. exist (C++ is somewhere in-between). OTOH the open ends in C allow things very hard to accomplish (if at all) in these languages where required. As allways: know your tools.</p>\n\n<hr>\n\n<p>Note: You should not cast the result of <code>malloc</code> &amp; friends in C. And <code>sizeof(char)</code> is useless. It is defined by the standard to yield <code>1</code>.</p>\n\n<hr>\n\n<p>[1] As violating the contract is <em>undefined behaviour</em>, the compiler is actually free to store such data in read-only memory. This is vital for microcontrollers which run code and read some data straight from ROM, for example.</p>\n\n<p>[2] Modern compilers can parse the format-string of <code>printf</code> and <code>scanf</code> family for the argument types and warn about missmatch. That requires this string to be a <em>string literal</em> (not a variable), though. That is a courtesy of the compiler writes a these functions are widely used.</p>\n\n<p>[3] Basically <em>undefined behaviour</em> means anything can happen - Your computer might run away, nasal daemons may appear, or it might work. But all not guaranteed reliable or deterministic. So next time you start something else might happen.</p>\n"}], "owner": {"reputation": 95, "user_id": 5739672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuG9K.jpg?s=128&g=1", "display_name": "Devang Kubavat", "link": "https://stackoverflow.com/users/5739672/devang-kubavat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 34762055, "answer_count": 2, "score": 0, "last_activity_date": 1452681197, "creation_date": 1452674010, "last_edit_date": 1452674562, "question_id": 34761795, "link": "https://stackoverflow.com/questions/34761795/pointer-to-const-int-but-still-it-modify-data", "title": "Pointer to const int but still it modify data", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint *func(int *);\nint main(void)\n{\n        int i,size;\n        const int *arr=func(&amp;size);\n        for(i=0;i&lt;size;i++)\n        {\n                printf(\"Enter a[%d] : \",i);\n                scanf(\"%d\",&amp;arr[i]);\n        }\n\n        for(i=0;i&lt;size;i++)\n        {\n                printf(\"%d\\t\",arr[i]);\n        }\n        return 0;\n}\nint *func(int *psize)\n{\n        int *p;\n        printf(\"Enter the size: \");\n        scanf(\"%d\",psize);\n\n        p=(int *)malloc(*psize *sizeof(int));\n        return p;\n}\n</code></pre>\n\n<blockquote>\n  <p>Enter the size: 3</p>\n  \n  <p>Enter a[0] : 1</p>\n  \n  <p>Enter a[1] : 2</p>\n  \n  <p>Enter a[2] : 3</p>\n  \n  <p>1  2  3</p>\n</blockquote>\n\n<ul>\n<li>Here, in this code, i use const keyword to not modify data which is pointed by 'arr' pointer.</li>\n<li>if i use const keyword they why its give me output ?</li>\n</ul>\n"}, {"tags": ["c", "codeblocks"], "comments": [{"owner": {"reputation": 2002, "user_id": 3315583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61b5a385f6062f633e426f095c3a792?s=128&d=identicon&r=PG", "display_name": "Rishit Sanmukhani", "link": "https://stackoverflow.com/users/3315583/rishit-sanmukhani"}, "edited": false, "score": 0, "creation_date": 1452672111, "post_id": 34761214, "comment_id": 57267512, "body": "Can you include the files as well?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1452672177, "post_id": 34761214, "comment_id": 57267557, "body": "The important file to show us is the header file. You must define some symbol (which one we don&#39;t know since you don&#39;t show us the complete and unedited error output) in the header file, not only declaring it. Please <i>edit your question</i> to include the header file and the complete and unedited error log. Could also be good to show us the outline of the <code>test.c</code> file."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1452672502, "post_id": 34761214, "comment_id": 57267728, "body": "Also, do <i>both</i> the <code>link.c</code> and <code>hash.c</code> source files define the same functions?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1452674037, "post_id": 34761214, "comment_id": 57268682, "body": "As I answered, you couldn&#39;t implement a function twice in your code. Pick one between <code>hash.c</code> and <code>link.c</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1452676385, "post_id": 34761214, "comment_id": 57270117, "body": "You should <i>not</i> undefine the header inclusion guard macro, that actually defeats the purpose of having include guards."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1452673591, "last_edit_date": 1452673591, "creation_date": 1452673227, "answer_id": 34761556, "question_id": 34761214, "link": "https://stackoverflow.com/questions/34761214/multiple-definition-of-error-codeblocks/34761556#34761556", "title": "Multiple definition of error - CodeBlocks", "body": "<p>I guess the key point is</p>\n\n<pre><code>link.c - implements ALL methods in table.h\nhash.c - implements ALL methods in table.h\n</code></pre>\n\n<p>Those files could not be linked to the same output: I mean, each function must be implemented unique.</p>\n\n<p>You could implement all functions in a single/multiple <code>c</code> file/s and than <code>#include \"table.h\"</code> in files where functions are used. The important thing is that each function must be implemented 1 time only in source files.</p>\n"}], "owner": {"reputation": 19, "user_id": 2000519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cfeaa3f40dd9b86f0a480e4830c83cf?s=128&d=identicon&r=PG", "display_name": "Bhavna Hari", "link": "https://stackoverflow.com/users/2000519/bhavna-hari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 1, "closed_date": 1452677304, "answer_count": 1, "score": 0, "last_activity_date": 1452673605, "creation_date": 1452671965, "last_edit_date": 1452673605, "question_id": 34761214, "link": "https://stackoverflow.com/questions/34761214/multiple-definition-of-error-codeblocks", "closed_reason": "Not suitable for this site", "title": "Multiple definition of error - CodeBlocks", "body": "<p>I have the the following files in my project:</p>\n\n<pre><code>table.h - signatures of methods used in link.c and hash.c\nlink.c - implements ALL methods in table.h\nhash.c - implements ALL methods in table.h\ntest.c - unit tests for link.c and hash.c\n</code></pre>\n\n<p>I've used guards in my header file. Both link.c and hash.c have different implementations of the same set of methods.</p>\n\n<p>When I build and run my project, I get errors thrown for each method which says: \"multiple definition of \"</p>\n\n<p>I've tried declaring the methods extern, it does not solve the issue. </p>\n\n<p>table.h</p>\n\n<pre><code>#ifndef TABLE_H_INCLUDED\n#define TABLE_H_INCLUDED\n\ntypedef struct Table *Table_t;\n\nTable_t Table_new(void);\n\nvoid Table_free(Table_t oTable);\n\nint Table_getLength(Table_t oTable);\n\nint SymTable_put(SymTable_t oSymTable,\n                 const char *pcKey,\n                 const void *pvValue);\n\nvoid *Table_get(Table_t oTable,\n                   const char *key);\n\nint Table_contains(Table_t oTable,\n                      const char *key);\n\n\nvoid *Table_remove(Table_t oTable,\n                    const char *key);\n\n\nvoid *Table_replace(Table_t oTable,\n                       const char *key,\n                       const void *value);\n#undef TABLE_H_INCLUDED\n#endif\n</code></pre>\n\n<p>Error log:</p>\n\n<p>obj\\Debug\\table_link.o||In function `Table_new':|</p>\n\n<p>E:\\symbolTableProject\\table_link.c|33|multiple definition of `Table_new'|</p>\n\n<p>obj\\Debug\\table_hash.o:E:\\symbolTableProject\\table_hash.c|36|first defined here|</p>\n\n<p>How do I resolve this? </p>\n"}, {"tags": ["c", "lua"], "comments": [{"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 1, "creation_date": 1452671064, "post_id": 34760909, "comment_id": 57267019, "body": "I don&#39;t know that there is a way to directly do what you want to do. I ran into the same problem a few months ago and ended up settling for a table/userdata with a metatable that had  the <code>__index</code> and <code>__newindex</code> metamethods defined as accessor functions"}, {"owner": {"reputation": 9307, "user_id": 705086, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fbeee3d76a35f9de8847f36ee51c28a2?s=128&d=identicon&r=PG", "display_name": "Dima Tisnek", "link": "https://stackoverflow.com/users/705086/dima-tisnek"}, "edited": false, "score": 0, "creation_date": 1452671539, "post_id": 34760909, "comment_id": 57267257, "body": "My guess is -- an integer in Lua is an object, thus C code should be able to see and modify it&#39;s internal repsentation (may not map to a 32-bit int). If you ever change the value in Lua, new value will have a new address. A better approach would be to access C&#39;s <code>int</code> via <code>FFI</code> --- the foreign function interface. That requires, at least, that C code exports given data item as a symbol. Please follow <a href=\"http://luajit.org/ext_ffi_tutorial.html\" rel=\"nofollow noreferrer\">luajit.org/ext_ffi_tutorial.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 1, "creation_date": 1452706465, "post_id": 34768451, "comment_id": 57291638, "body": "Even with the LuaJIT FFI, I think that (global) key assignment will rebind the variable."}, {"owner": {"reputation": 9733, "user_id": 108238, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dda5a214457332e974f7053ab77d7069?s=128&d=identicon&r=PG", "display_name": "schoetbi", "link": "https://stackoverflow.com/users/108238/schoetbi"}, "edited": false, "score": 3, "creation_date": 1452769797, "post_id": 34768451, "comment_id": 57319541, "body": "I ended up with LuaJIT as the fastest way. But still too slow to beat exprTK."}], "tags": [], "owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 2, "last_activity_date": 1452693056, "creation_date": 1452693056, "answer_id": 34768451, "question_id": 34760909, "link": "https://stackoverflow.com/questions/34760909/bind-c-integer-to-lua-global-variable/34768451#34768451", "title": "Bind C Integer to Lua global variable", "body": "<p>The best you're going to be able to get is the ability to create a piece of userdata (regular, not light) that has a <code>__call</code> metamethod that will get/set the C value for you.</p>\n\n<p>So your function would look like:</p>\n\n<pre><code>function myFunction()\n  return x() + 3\nend\n</code></pre>\n\n<p>It could also have operator metamethods defined so that things like <code>x + 3</code> could work. But there's no way for a naked <code>x</code> to resolve to the value you want.</p>\n\n<p>Setting the value would look like:</p>\n\n<pre><code>x(3)\n</code></pre>\n\n<p>There's no way to make something like <code>x = 3</code> work the way you want it to. This will always overwrite the value in question.</p>\n\n<p>Using <code>__newindex</code> and <code>__index</code> metamethods wouldn't work because you want the variable to be <em>global</em>.</p>\n\n<p>Alternatively, you could use LuaJIT and its FFI interface.</p>\n"}, {"comments": [{"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1452706116, "post_id": 34772759, "comment_id": 57291415, "body": "Will this affect the default behavior for accessing globals in an undesirable way?"}, {"owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1452747978, "post_id": 34772759, "comment_id": 57308744, "body": "It will affect the behavior for accessing <i>undefined</i> globals. Most globals you work with have non-nil values. Those aren&#39;t affected at all. Accessing nil-valued globals will incur an extra metamethod call."}], "tags": [], "owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "is_accepted": false, "score": 2, "last_activity_date": 1452704787, "creation_date": 1452704787, "answer_id": 34772759, "question_id": 34760909, "link": "https://stackoverflow.com/questions/34760909/bind-c-integer-to-lua-global-variable/34772759#34772759", "title": "Bind C Integer to Lua global variable", "body": "<p>If you only have a few C variables that you want to access from Lua, you can set a metatable with <code>__index</code> and <code>__newindex</code> metamethods on the globals table. When a non-existent global variable is accessed (get or set), those metamethods are called, and you have to figure out what to do by looking at the second parameter to those metamethods (the variable name).</p>\n\n<p>Sample code for a module that exports a single variable:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;lua.h&gt;\n#include &lt;lauxlib.h&gt;\n\n\nstatic int x = 0;\n\n\nstatic int myvar_index( lua_State* L ) {\n  char const* key = lua_tostring( L, 2 );\n  if( key != NULL &amp;&amp; strcmp( key, \"x\" ) == 0 )\n    lua_pushinteger( L, x );\n  else\n    lua_pushnil( L );\n  return 1;\n}\n\n\nstatic int myvar_newindex( lua_State* L ) {\n  char const* key = lua_tostring( L, 2 );\n  if( key != NULL &amp;&amp; strcmp( key, \"x\" ) == 0 ) {\n    lua_Integer i = luaL_checkinteger( L, 3 );\n    if( i &gt; INT_MAX || i &lt; INT_MIN )\n      luaL_error( L, \"variable value out of range\" );\n    x = i;\n  } else\n    lua_rawset( L, 1 );\n  return 0;\n}\n\n\nint luaopen_myvar( lua_State* L ) {\n  luaL_Reg const metamethods[] = {\n    { \"__index\", myvar_index },\n    { \"__newindex\", myvar_newindex },\n    { NULL, NULL }\n  };\n#if LUA_VERSION_NUM &lt; 502\n  lua_pushvalue( L, LUA_GLOBALSINDEX );\n  lua_newtable( L );\n  luaL_register( L, NULL, metamethods );\n#else\n  lua_pushglobaltable( L );\n  luaL_newlib( L, metamethods );\n#endif\n  lua_setmetatable( L, -2 );\n  return 0;\n}\n</code></pre>\n\n<p>The more C variables you export, the more complicated the metamethod implementations get, and you are probably better off using one of the other suggested approaches.</p>\n\n<p>Also note that the globals table is a shared resource, so you have to avoid/handle conflicts with other code that modifies its metatable. (I.e. reusable modules simply shouldn't modify shared resources -- but I guess the same applies to global variables in C ...)</p>\n"}], "owner": {"reputation": 9733, "user_id": 108238, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dda5a214457332e974f7053ab77d7069?s=128&d=identicon&r=PG", "display_name": "schoetbi", "link": "https://stackoverflow.com/users/108238/schoetbi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 4, "accepted_answer_id": 34768451, "answer_count": 2, "score": 4, "last_activity_date": 1489383759, "creation_date": 1452670696, "last_edit_date": 1489383759, "question_id": 34760909, "link": "https://stackoverflow.com/questions/34760909/bind-c-integer-to-lua-global-variable", "title": "Bind C Integer to Lua global variable", "body": "<p>In C I want to call a lua function myFunction() that uses a global variable x. I want to be able to register a c (integer) variable directly as this global variable x. </p>\n\n<p>Something along the lines:</p>\n\n<h1>demo.lua:</h1>\n\n<pre><code>function myFunction()\n  return x + 3\nend\n</code></pre>\n\n<h1>demo.c:</h1>\n\n<pre><code>int x = 0;\nlua_bindglob(L, \"x\", &amp;x);\n\nfor (x = 0; x &lt; 100; ++x)\n{\n  lua_getglobal(L, \"myFunction\");\n\n  // here I call the function and it should evaluate\n  // to the current value of x (in c)\n  lua_pcall(L, 0, 1, 0);      \n  int result = lua_tonumber(L, -1);  \n\n  lua_pop(L, 1);\n}\n</code></pre>\n\n<p>I know that I can modify lua global variables by this:</p>\n\n<pre><code>lua_pushnumber(L, 3);\nlua_setglobal(L, \"x\");\n</code></pre>\n\n<p>But I need to have a more direct/faster way of doing this. I got a hint that LUA ligthuserdata might help here but I couldn't find any examples for plain variables.</p>\n\n<p>EDIT:\nSince I get the expressions from a benchmark I do not want to alter them:\nSee examples <a href=\"https://github.com/ArashPartow/math-parser-benchmark-project/blob/master/bench_expr_complete.txt\" rel=\"nofollow noreferrer\">here</a>:</p>\n"}, {"tags": ["c", "linux", "onvif"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 4377632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b214058fb375f13c5946e3a768586cb?s=128&d=identicon&r=PG&f=1", "display_name": "bkbilly", "link": "https://stackoverflow.com/users/4377632/bkbilly"}, "edited": false, "score": 1, "creation_date": 1589586378, "post_id": 34763095, "comment_id": 109362666, "body": "The project you suggested has compilation problems, at least for my linux distro. Better use this fork: <a href=\"https://github.com/paullouisageneau/gsoap-onvif\" rel=\"nofollow noreferrer\">github.com/paullouisageneau/gsoap-onvif</a>"}], "tags": [], "owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "is_accepted": true, "score": 1, "last_activity_date": 1452678032, "creation_date": 1452678032, "answer_id": 34763095, "question_id": 34760773, "link": "https://stackoverflow.com/questions/34760773/retrieve-network-camera-stream-url-in-linux/34763095#34763095", "title": "Retrieve network camera stream URL in Linux", "body": "<p>I was able to find a gsoap-onvif solution from <a href=\"https://github.com/tonyhu/gsoap-onvif\" rel=\"nofollow\">https://github.com/tonyhu/gsoap-onvif</a>. This programs successfully retrieves parameters from most of the Onvif complaint cameras.</p>\n"}, {"comments": [{"owner": {"reputation": 493, "user_id": 6114950, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-u2HIwsbrX18/AAAAAAAAAAI/AAAAAAAAAkg/M6ezW1MOyZ8/photo.jpg?sz=128", "display_name": "Christian Rodriguez", "link": "https://stackoverflow.com/users/6114950/christian-rodriguez"}, "edited": false, "score": 0, "creation_date": 1499270188, "post_id": 41164207, "comment_id": 76837646, "body": "I&#39;ve tried python onvif, and for some reason it&#39;s not working (it crashes my IP camera). :S"}], "tags": [], "owner": {"reputation": 129, "user_id": 1265407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289e61d613c7dd5f6f30a9269d07d216?s=128&d=identicon&r=PG", "display_name": "zzlyzq", "link": "https://stackoverflow.com/users/1265407/zzlyzq"}, "is_accepted": false, "score": 0, "last_activity_date": 1481804920, "creation_date": 1481804920, "answer_id": 41164207, "question_id": 34760773, "link": "https://stackoverflow.com/questions/34760773/retrieve-network-camera-stream-url-in-linux/41164207#41164207", "title": "Retrieve network camera stream URL in Linux", "body": "<p>you can have a try with python onvif, some feature you can use, may be other feature such as PTZ you can use .</p>\n\n<p>also, you can have a try with opencvr's another project, <a href=\"https://github.com/veyesys/h5stream\" rel=\"nofollow noreferrer\">https://github.com/veyesys/h5stream</a>, if you can't compile,you can download from sourceforge.</p>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6645, "favorite_count": 0, "accepted_answer_id": 34763095, "answer_count": 2, "score": 2, "last_activity_date": 1512376121, "creation_date": 1452670220, "last_edit_date": 1454160098, "question_id": 34760773, "link": "https://stackoverflow.com/questions/34760773/retrieve-network-camera-stream-url-in-linux", "title": "Retrieve network camera stream URL in Linux", "body": "<p>I am trying to retrieve rtsp URLs of cameras on my network. I can do this using Onvif Device Manager on Windows but how to do this on Linux using C/C++ or command line tool. I have tried various libs e.g. <a href=\"https://github.com/xsmart/onvifc\" rel=\"nofollow\">onvifc</a> (OpenCVR) and <a href=\"https://github.com/xsmart/onvifcpplib\" rel=\"nofollow\">onvifcpplib</a> but none of them could compile on Linux, neither they have API documentation. Any suggestions please!</p>\n"}]